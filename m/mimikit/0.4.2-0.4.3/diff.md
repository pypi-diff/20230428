# Comparing `tmp/mimikit-0.4.2-py3-none-any.whl.zip` & `tmp/mimikit-0.4.3-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,30 +1,30 @@
-Zip file size: 115927 bytes, number of entries: 73
--rw-r--r--  2.0 unx      568 b- defN 23-Apr-26 21:00 mimikit/__init__.py
+Zip file size: 116074 bytes, number of entries: 73
+-rw-r--r--  2.0 unx      568 b- defN 23-Apr-28 03:45 mimikit/__init__.py
 -rw-r--r--  2.0 unx     4682 b- defN 23-Apr-26 20:32 mimikit/checkpoint.py
 -rw-r--r--  2.0 unx     4681 b- defN 23-Apr-26 20:32 mimikit/config.py
 -rw-r--r--  2.0 unx     9272 b- defN 23-Apr-26 20:32 mimikit/io_spec.py
 -rw-r--r--  2.0 unx      798 b- defN 23-Apr-26 20:32 mimikit/utils.py
 -rw-r--r--  2.0 unx      226 b- defN 23-Apr-26 20:32 mimikit/demos/__init__.py
 -rw-r--r--  2.0 unx     1409 b- defN 23-Apr-26 20:32 mimikit/demos/checkpoint_k_bests.py
--rw-r--r--  2.0 unx     1283 b- defN 23-Apr-26 20:32 mimikit/demos/clusterizer_app.py
+-rw-r--r--  2.0 unx     1340 b- defN 23-Apr-28 03:16 mimikit/demos/clusterizer_app.py
 -rw-r--r--  2.0 unx     2160 b- defN 23-Apr-26 20:32 mimikit/demos/ensemble_generator.py
 -rw-r--r--  2.0 unx     2739 b- defN 23-Apr-26 20:32 mimikit/demos/freqnet.py
 -rw-r--r--  2.0 unx      663 b- defN 23-Apr-26 20:32 mimikit/demos/generate_from_checkpoint.py
 -rw-r--r--  2.0 unx     2764 b- defN 23-Apr-26 20:32 mimikit/demos/seq2seq.py
 -rw-r--r--  2.0 unx     2868 b- defN 23-Apr-26 20:32 mimikit/demos/srnn.py
 -rw-r--r--  2.0 unx      157 b- defN 23-Apr-26 20:32 mimikit/extract/__init__.py
--rw-r--r--  2.0 unx    10372 b- defN 23-Apr-26 20:32 mimikit/extract/clusters.py
+-rw-r--r--  2.0 unx    10430 b- defN 23-Apr-27 16:38 mimikit/extract/clusters.py
 -rw-r--r--  2.0 unx     2176 b- defN 23-Apr-26 20:32 mimikit/extract/from_neighbors.py
 -rw-r--r--  2.0 unx     9120 b- defN 23-Apr-26 20:32 mimikit/extract/samplify.py
 -rw-r--r--  2.0 unx     6546 b- defN 23-Apr-26 20:32 mimikit/extract/segment.py
 -rw-r--r--  2.0 unx      155 b- defN 23-Apr-26 20:32 mimikit/features/__init__.py
--rw-r--r--  2.0 unx     1550 b- defN 23-Apr-26 20:32 mimikit/features/dataset.py
+-rw-r--r--  2.0 unx     1964 b- defN 23-Apr-28 03:45 mimikit/features/dataset.py
 -rw-r--r--  2.0 unx     1670 b- defN 23-Apr-26 20:32 mimikit/features/extractor.py
--rw-r--r--  2.0 unx    31438 b- defN 23-Apr-26 20:32 mimikit/features/functionals.py
+-rw-r--r--  2.0 unx    31355 b- defN 23-Apr-27 16:44 mimikit/features/functionals.py
 -rw-r--r--  2.0 unx     3758 b- defN 23-Apr-26 20:32 mimikit/features/item_spec.py
 -rw-r--r--  2.0 unx      177 b- defN 23-Apr-26 20:32 mimikit/loops/__init__.py
 -rw-r--r--  2.0 unx     5118 b- defN 23-Apr-26 20:32 mimikit/loops/callbacks.py
 -rw-r--r--  2.0 unx    12832 b- defN 23-Apr-26 20:32 mimikit/loops/generate.py
 -rw-r--r--  2.0 unx     2493 b- defN 23-Apr-26 20:32 mimikit/loops/generate_chunks.py
 -rw-r--r--  2.0 unx     6839 b- defN 23-Apr-26 20:32 mimikit/loops/logger.py
 -rw-r--r--  2.0 unx     2655 b- defN 23-Apr-26 20:32 mimikit/loops/samplers.py
@@ -62,14 +62,14 @@
 -rw-r--r--  2.0 unx     6777 b- defN 23-Apr-26 20:32 mimikit/views/clusters.py
 -rw-r--r--  2.0 unx     3329 b- defN 23-Apr-26 20:32 mimikit/views/dataset.py
 -rw-r--r--  2.0 unx    11570 b- defN 23-Apr-26 20:32 mimikit/views/functionals.py
 -rw-r--r--  2.0 unx     2398 b- defN 23-Apr-26 20:32 mimikit/views/io_spec.py
 -rw-r--r--  2.0 unx     2485 b- defN 23-Apr-26 20:32 mimikit/views/sample_rnn.py
 -rw-r--r--  2.0 unx     8200 b- defN 23-Apr-26 20:32 mimikit/views/train_arm.py
 -rw-r--r--  2.0 unx     3260 b- defN 23-Apr-26 20:32 mimikit/views/wavenet.py
--rw-r--r--  2.0 unx    35128 b- defN 23-Apr-26 21:02 mimikit-0.4.2.dist-info/LICENSE
--rw-r--r--  2.0 unx     3107 b- defN 23-Apr-26 21:02 mimikit-0.4.2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-26 21:02 mimikit-0.4.2.dist-info/WHEEL
--rw-r--r--  2.0 unx      264 b- defN 23-Apr-26 21:02 mimikit-0.4.2.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        8 b- defN 23-Apr-26 21:02 mimikit-0.4.2.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     6108 b- defN 23-Apr-26 21:02 mimikit-0.4.2.dist-info/RECORD
-73 files, 379535 bytes uncompressed, 106335 bytes compressed:  72.0%
+-rw-r--r--  2.0 unx    35128 b- defN 23-Apr-28 03:52 mimikit-0.4.3.dist-info/LICENSE
+-rw-r--r--  2.0 unx     3107 b- defN 23-Apr-28 03:52 mimikit-0.4.3.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-28 03:52 mimikit-0.4.3.dist-info/WHEEL
+-rw-r--r--  2.0 unx      264 b- defN 23-Apr-28 03:52 mimikit-0.4.3.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        8 b- defN 23-Apr-28 03:52 mimikit-0.4.3.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     6108 b- defN 23-Apr-28 03:52 mimikit-0.4.3.dist-info/RECORD
+73 files, 379981 bytes uncompressed, 106482 bytes compressed:  72.0%
```

## zipnote {}

```diff
@@ -195,26 +195,26 @@
 
 Filename: mimikit/views/train_arm.py
 Comment: 
 
 Filename: mimikit/views/wavenet.py
 Comment: 
 
-Filename: mimikit-0.4.2.dist-info/LICENSE
+Filename: mimikit-0.4.3.dist-info/LICENSE
 Comment: 
 
-Filename: mimikit-0.4.2.dist-info/METADATA
+Filename: mimikit-0.4.3.dist-info/METADATA
 Comment: 
 
-Filename: mimikit-0.4.2.dist-info/WHEEL
+Filename: mimikit-0.4.3.dist-info/WHEEL
 Comment: 
 
-Filename: mimikit-0.4.2.dist-info/entry_points.txt
+Filename: mimikit-0.4.3.dist-info/entry_points.txt
 Comment: 
 
-Filename: mimikit-0.4.2.dist-info/top_level.txt
+Filename: mimikit-0.4.3.dist-info/top_level.txt
 Comment: 
 
-Filename: mimikit-0.4.2.dist-info/RECORD
+Filename: mimikit-0.4.3.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mimikit/__init__.py

```diff
@@ -1,8 +1,8 @@
-__version__ = '0.4.2'
+__version__ = '0.4.3'
 
 from . import config
 from . import features
 from . import loops
 from . import checkpoint
 from . import modules
 from . import extract
```

## mimikit/demos/clusterizer_app.py

```diff
@@ -1,18 +1,18 @@
 def demo():
     """### Launch the app"""
-    try:
-        from google.colab import output
-        output.enable_custom_widget_manager()
-    except ImportError:
-        pass
     import mimikit as mmk
     from ipywidgets import widgets as W
     import IPython.display as ipd
 
+    # *************** MacOS user with M1 *****************
+    # if creating a dataset hang, uncomment the next 2 lines:
+    # import multiprocess as mp
+    # mp.set_start_method("spawn")
+
     ipd.display(mmk.MMK_STYLE_SHEET)
     ipd.display(W.HTML(
         """
         <style>
         .container {
             width: 95% !important;
         }
```

## mimikit/extract/clusters.py

```diff
@@ -36,14 +36,15 @@
         self.n_neighbs = self.n_neighbors
         self.k = self.core_neighborhood_size
         self.is_core_ = None
         self.labels_ = None
         self.K_ = None
 
     def fit(self, x):
+        self.__post_init__()
         N = x.shape[0]
         if self.n_neighbs is None:
             self.n_neighbs = int(np.sqrt(N))
         if self.k is None:
             self.k = int(self.qe * self.n_neighbs)
 
         n_neighbs = self.n_neighbs
@@ -109,14 +110,15 @@
         self.d_func = dict(euclidean=torch.cdist,
                            cosine=AngularDistance(eps=self.eps))[self.metric]
         self.K_ = None
         self.labels_ = None
         self.losses_ = None
 
     def fit(self, x):
+        self.__post_init__()
         X = torch.from_numpy(x)
         H = nn.Parameter(X[torch.randint(0, X.shape[0], (self.n_means,))].clone())
         opt = torch.optim.Adam([H], lr=self.lr, betas=self.betas)
         losses = []
         for _ in range(self.n_iter):
             opt.zero_grad()
             L = self.d_func(H, X).mean()
```

## mimikit/features/dataset.py

```diff
@@ -22,20 +22,31 @@
             self.filename = os.path.abspath(self.filename)
 
     @property
     def schema(self):
         return {e.name: e for e in self.extractors}
 
     def create(self, **kwargs) -> h5m.TypedFile:
+        self.__post_init__()
         cls = self._typed_file_class()
-        db = cls.create(self.filename, self.sources, **kwargs)
+        # fix loading files in a foreign system
+        fixed_sources = []
+        cwd = os.getcwd()
+        for src in self.sources:
+            if not os.path.isfile(src):
+                fixed_sources += [*h5m.FileWalker(os.path.split(src)[-1], cwd)]
+            else:
+                fixed_sources += [src]
+        self.sources = tuple(fixed_sources)
+        db = cls.create(self.filename, fixed_sources, **kwargs)
         db.attrs["config"] = self.serialize()
         return db
 
     def get(self, **kwargs) -> h5m.TypedFile:
+        self.__post_init__()
         cls = self._typed_file_class()
         return cls(self.filename, **kwargs)
 
     def _typed_file_class(self):
         def reduce(self):
             return h5m.TypedFile, (self.filename,), {}
         if os.path.exists(self.filename):
```

## mimikit/features/functionals.py

```diff
@@ -3,15 +3,15 @@
 import librosa
 import torch
 import torchaudio.functional as F
 import torchaudio.transforms as T
 import numpy as np
 from scipy.signal import lfilter
 from scipy.interpolate import interp1d
-from sklearn.decomposition import PCA as skPCA,\
+from sklearn.decomposition import PCA as skPCA, \
     FactorAnalysis as skFactorAnalysis, NMF as skNMF
 from sklearn.preprocessing import StandardScaler
 from numba import njit, prange, float32, intp
 import dataclasses as dtc
 import abc
 
 from .item_spec import Sample, Frame, Unit
@@ -551,36 +551,33 @@
     n_fft: int = N_FFT
     hop_length: int = HOP_LENGTH
     center: bool = True
     window: Optional[str] = "hann"
     pad_mode: str = "constant"
 
     @property
+    def stft(self):
+        return STFT(self.n_fft, self.hop_length, "mag",
+                    self.center, self.window, self.pad_mode)
+
+    @property
     def unit(self) -> Optional[Unit]:
         return Frame(self.n_fft, self.hop_length, padding=self.center)
 
     @property
     def elem_type(self) -> Optional[EventType]:
         return Continuous(0., float("inf"), 1 + self.n_fft // 2)
 
-    def __post_init__(self):
-        self.stft = STFT(self.n_fft, self.hop_length, "mag",
-                         self.center, self.window, self.pad_mode)
-
     def np_func(self, inputs):
         return self.stft.np_func(inputs)
 
     def torch_func(self, inputs):
         return self.stft.torch_func(inputs)
 
     @property
-    def functions(self):
-        return self.stft.functions
-
-    @property
     def inv(self):
         return GLA(self.n_fft, self.hop_length, self.center, self.window, self.pad_mode)
 
 
 @dtc.dataclass
 class GLA(Functional):
     n_fft: int = N_FFT
@@ -762,17 +759,18 @@
 @dtc.dataclass
 class Envelop(Functional):
     n_fft: int = N_FFT
     hop_length: int = HOP_LENGTH
     normalize: bool = True
     interp_to_time_domain: bool = True
 
-    def __post_init__(self):
-        self.fft = MagSpec(self.n_fft, self.hop_length, center=True,
-                           window="hann", pad_mode="reflect")
+    @property
+    def fft(self):
+        return MagSpec(self.n_fft, self.hop_length, center=True,
+                       window="hann", pad_mode="reflect")
 
     @property
     def unit(self) -> Optional[Unit]:
         return Sample(None) if self.interp_to_time_domain else self.fft.unit
 
     @property
     def elem_type(self) -> Optional[EventType]:
@@ -798,17 +796,18 @@
 
 @dtc.dataclass
 class EnvelopBank(Functional):
     n_fft: Tuple[int] = (N_FFT,)
     hop_length: Tuple[int] = (HOP_LENGTH,)
     normalize: bool = True
 
-    def __post_init__(self):
+    @property
+    def envelops(self):
         # always interp to time domain!
-        self.envelops = tuple(
+        return tuple(
             Envelop(n_fft, hop, self.normalize, True)
             for n_fft, hop in zip(self.n_fft, self.hop_length)
         )
 
     @property
     def unit(self) -> Optional[Unit]:
         return Sample(None)
```

## Comparing `mimikit-0.4.2.dist-info/LICENSE` & `mimikit-0.4.3.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `mimikit-0.4.2.dist-info/METADATA` & `mimikit-0.4.3.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mimikit
-Version: 0.4.2
+Version: 0.4.3
 Summary: Python package for generating audio with neural networks
 Home-page: https://github.com/ktonal/mimikit
 Author: Antoine Daurat
 Author-email: ktonalberlin@gmail.com
 License: GNU General Public License v3 (GPLv3)
 Download-URL: https://github.com/ktonal/mimikit
 Keywords: audio music sound deep-learning
```

## Comparing `mimikit-0.4.2.dist-info/RECORD` & `mimikit-0.4.3.dist-info/RECORD`

 * *Files 11% similar despite different names*

```diff
@@ -1,29 +1,29 @@
-mimikit/__init__.py,sha256=-fPMuElY1pNEicTIpYWwvb6botHz-rColg_AYRDJRog,568
+mimikit/__init__.py,sha256=_QjW9FXfRackoiHegpMWwNqLSRmxTk8alPdnHF1kauc,568
 mimikit/checkpoint.py,sha256=Qxb9OOLqtoEY3UYNCyQ8HTpjTyJA2EIRDT7HSC52fms,4682
 mimikit/config.py,sha256=LmcBIcovJbBS9YACO4F19GCR6YEBmfpwWTRIK2lZruk,4681
 mimikit/io_spec.py,sha256=tkB7K19IsSRWAzgEFtWq4h3j372iwPVEs-u6JdLShYU,9272
 mimikit/utils.py,sha256=cfGUqPHfZBn6w5ZnsKsCZE8ukKPmHazaJtIrNaF0xcU,798
 mimikit/demos/__init__.py,sha256=n0QVtCnI5E7Lb_IpqXRXbMdDAV05tFQdKfrQBDFNNLc,226
 mimikit/demos/checkpoint_k_bests.py,sha256=Az7klZdWKqVpx7FjcRJ4f25_xoZS6YZrcoAbLLVmWFA,1409
-mimikit/demos/clusterizer_app.py,sha256=iaIeJRzl6UoL4SMXUxYIXqvMR5OpZPes9vXjqvsnMCA,1283
+mimikit/demos/clusterizer_app.py,sha256=YjRi-nz39a4LsAuLG82olP0yGOZXNOzbwMm0UyWpCiQ,1340
 mimikit/demos/ensemble_generator.py,sha256=SS5uKTMo8F1QrTc_xBSVzdBRRaMa1txzJROqjWzND9g,2160
 mimikit/demos/freqnet.py,sha256=z-Wmomy97f8S2Hh_lE5H0dwyvb1dI6IZVGB2_5CqmnY,2739
 mimikit/demos/generate_from_checkpoint.py,sha256=rVN17YjG6L4MrT0rtcMtxTFXconMuXkk1RSXkVLMzJ0,663
 mimikit/demos/seq2seq.py,sha256=40v64ssG9be8kJpPeq675C2DDzxcLe2vK9X0242jCcE,2764
 mimikit/demos/srnn.py,sha256=F5zclutj8JpgLFAOkcHf5aF-9UORZr9EvfutObJ5TxA,2868
 mimikit/extract/__init__.py,sha256=ZeD_JZVXVOGuJ5KE7Z2EjltgawI2p_fYcvDFuljGGCE,157
-mimikit/extract/clusters.py,sha256=u_eEuY8v2GkxMb1d6I7oPAwpdMLR_LEVx6Kh692Fwgo,10372
+mimikit/extract/clusters.py,sha256=TiJm5ew2Js_J0x4RSf_hy5Af0UnQFj97Sn1kUgOP63Y,10430
 mimikit/extract/from_neighbors.py,sha256=LzNnP1ItKT_E2DSMetZVlmfz3ggP3_4VsQqNh7dHE4I,2176
 mimikit/extract/samplify.py,sha256=NMNdfMWAk8ua22skkdd8NqKcYLPZb5Feo0v3kZamdkQ,9120
 mimikit/extract/segment.py,sha256=oZHlQZL4i3ecFLa_RxSR36QMD5TsRrQq4vC_O3brjlA,6546
 mimikit/features/__init__.py,sha256=wQez-GnYZUK8HW4bfsxeDUyp0xZq1t91Xerel4OeQ6s,155
-mimikit/features/dataset.py,sha256=UgiPFZ_g9vZeAQ0h7ejl0E_AdrKN1fnIcocg1l_t368,1550
+mimikit/features/dataset.py,sha256=WhH6tLjMHNBLZV_WbH6cNJJYmmHOlvUMA6Vow6gSUSg,1964
 mimikit/features/extractor.py,sha256=phrSMqZttG7TKd1RD3W-QnVyYFw9s6LgqQwWGEumUPw,1670
-mimikit/features/functionals.py,sha256=7Q751AiBX-3KYOEIy6PlkjSX_1qUYf_VEEn4SWI8IOE,31438
+mimikit/features/functionals.py,sha256=Cej8_zvcyhgt7XZX87pTxKG-Z8nITqfthgOblZyPTqY,31355
 mimikit/features/item_spec.py,sha256=AlbGZUldeGVcpbCh4iPJkJUtp_8h3lRp8cqVQH83k2M,3758
 mimikit/loops/__init__.py,sha256=l2dGY2kysWiBWpt8fz8uWWLroyxdqU1KmW-Z5SH3txE,177
 mimikit/loops/callbacks.py,sha256=jiVEymg7TV38_CcReOJ6SC8DAMJgtcBpDZCVriUH474,5118
 mimikit/loops/generate.py,sha256=3pG1fDGOEvMImcSrH6EAb8iTzo6uTrK-cb5bRkgHgwY,12832
 mimikit/loops/generate_chunks.py,sha256=9dl3zAK537NNE1BvrVE-YxrCtGmB__Mf-UvQpQ4_8xs,2493
 mimikit/loops/logger.py,sha256=zyo5F0Hvx7FIjHImOt3lOBlR_bQ3DPzgiso9ZsXwXAk,6839
 mimikit/loops/samplers.py,sha256=5beqjN3Su6NulgZtmHPrAzBzxxgE5g2KN6psi74rSKI,2655
@@ -61,13 +61,13 @@
 mimikit/views/clusters.py,sha256=fgbmY_MV3z8P0eql9J0kTNoifu4ZPdKQc6MRBgo4FKg,6777
 mimikit/views/dataset.py,sha256=H0ceL24CbDV0SUFogSjj7q0nN47sr8A2J5LEDdmIWl8,3329
 mimikit/views/functionals.py,sha256=qqCJJp6gIyJHJqyHOcl9tVqX1h0lFTsNEDaH6Ylo8ZE,11570
 mimikit/views/io_spec.py,sha256=yIdXul_-7ETLlm1e5pufDMGMorA1tvxaHx0EREUkEqI,2398
 mimikit/views/sample_rnn.py,sha256=CyY3rOhiGTrdDs2uO80-BJI9JeG4-2yOAT_ILEnIAjQ,2485
 mimikit/views/train_arm.py,sha256=wWo8YYVpuLx2VzlMw7cfpAy1q50ARdLpM7iP1Ig27kc,8200
 mimikit/views/wavenet.py,sha256=QexZMtoL1dBTwyrwmXTlbJID4WWpIcZ999k0yuQVptU,3260
-mimikit-0.4.2.dist-info/LICENSE,sha256=N0P3pKtRMvfb64jmgJdlerg3TnS0a2QC776AzPsbZIg,35128
-mimikit-0.4.2.dist-info/METADATA,sha256=3JjXqF-Yjgmck9GoDbNrYMkAymchSMfv0_C4oudShV4,3107
-mimikit-0.4.2.dist-info/WHEEL,sha256=OqRkF0eY5GHssMorFjlbTIq072vpHpF60fIQA6lS9xA,92
-mimikit-0.4.2.dist-info/entry_points.txt,sha256=iN7nsVBU7hoqeyzNa7x30Jbs21efT3E26uwPmPulG7I,264
-mimikit-0.4.2.dist-info/top_level.txt,sha256=SCAQLCpXOCpNuPC9f57wYkn_qdwSfcFP0nIVYjUKCz4,8
-mimikit-0.4.2.dist-info/RECORD,,
+mimikit-0.4.3.dist-info/LICENSE,sha256=N0P3pKtRMvfb64jmgJdlerg3TnS0a2QC776AzPsbZIg,35128
+mimikit-0.4.3.dist-info/METADATA,sha256=1PyVZL9kLeNdHJj8oRqNAZdySf6AzI3xJSt1uRwOo04,3107
+mimikit-0.4.3.dist-info/WHEEL,sha256=OqRkF0eY5GHssMorFjlbTIq072vpHpF60fIQA6lS9xA,92
+mimikit-0.4.3.dist-info/entry_points.txt,sha256=iN7nsVBU7hoqeyzNa7x30Jbs21efT3E26uwPmPulG7I,264
+mimikit-0.4.3.dist-info/top_level.txt,sha256=SCAQLCpXOCpNuPC9f57wYkn_qdwSfcFP0nIVYjUKCz4,8
+mimikit-0.4.3.dist-info/RECORD,,
```

