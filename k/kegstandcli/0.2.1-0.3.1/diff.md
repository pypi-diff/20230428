# Comparing `tmp/kegstandcli-0.2.1.tar.gz` & `tmp/kegstandcli-0.3.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "kegstandcli-0.2.1.tar", max compression
+gzip compressed data, was "kegstandcli-0.3.1.tar", max compression
```

## Comparing `kegstandcli-0.2.1.tar` & `kegstandcli-0.3.1.tar`

### file list

```diff
@@ -1,19 +1,20 @@
--rw-r--r--   0        0        0     1077 2023-04-05 20:27:48.722735 kegstandcli-0.2.1/LICENSE
--rw-r--r--   0        0        0     1531 2023-04-05 21:53:25.704867 kegstandcli-0.2.1/pyproject.toml
--rw-r--r--   0        0        0        0 2023-04-03 20:22:59.696056 kegstandcli-0.2.1/src/kegstandcli/__init__.py
--rw-r--r--   0        0        0        0 2023-04-03 20:23:08.893322 kegstandcli-0.2.1/src/kegstandcli/cli/__init__.py
--rw-r--r--   0        0        0    16109 2023-04-05 21:42:28.200399 kegstandcli-0.2.1/src/kegstandcli/cli/__main__.py
--rw-r--r--   0        0        0     2904 2023-04-05 21:42:34.236472 kegstandcli-0.2.1/src/kegstandcli/cli/build.py
--rw-r--r--   0        0        0     1873 2023-04-05 21:42:40.218074 kegstandcli-0.2.1/src/kegstandcli/cli/config.py
--rw-r--r--   0        0        0      150 2023-04-05 21:42:45.939102 kegstandcli-0.2.1/src/kegstandcli/cli/default_lambda.py
--rw-r--r--   0        0        0     1659 2023-04-05 21:42:50.556460 kegstandcli-0.2.1/src/kegstandcli/cli/deploy.py
--rw-r--r--   0        0        0     1096 2023-04-05 21:42:54.993995 kegstandcli-0.2.1/src/kegstandcli/cli/new.py
--rw-r--r--   0        0        0      783 2023-04-04 19:34:35.784568 kegstandcli-0.2.1/src/kegstandcli/cli/teardown.py
--rw-r--r--   0        0        0        0 2023-04-03 20:23:36.547617 kegstandcli-0.2.1/src/kegstandcli/infra/__init__.py
--rw-r--r--   0        0        0     2276 2023-04-05 21:42:59.814285 kegstandcli-0.2.1/src/kegstandcli/infra/app.py
--rw-r--r--   0        0        0      287 2023-04-05 21:43:08.121464 kegstandcli-0.2.1/src/kegstandcli/infra/cdk.json
--rw-r--r--   0        0        0        0 2023-04-03 20:23:50.899135 kegstandcli-0.2.1/src/kegstandcli/infra/stacks/__init__.py
--rw-r--r--   0        0        0     3861 2023-04-05 21:43:15.647886 kegstandcli-0.2.1/src/kegstandcli/infra/stacks/lambda_rest_api.py
--rw-r--r--   0        0        0     1409 2023-04-05 21:42:19.708487 kegstandcli-0.2.1/src/kegstandcli/utils.py
--rw-r--r--   0        0        0     1296 1970-01-01 00:00:00.000000 kegstandcli-0.2.1/setup.py
--rw-r--r--   0        0        0     1399 1970-01-01 00:00:00.000000 kegstandcli-0.2.1/PKG-INFO
+-rw-r--r--   0        0        0     1077 2023-04-23 18:42:25.686572 kegstandcli-0.3.1/LICENSE
+-rw-r--r--   0        0        0     6568 2023-04-26 17:38:00.759465 kegstandcli-0.3.1/README.md
+-rw-r--r--   0        0        0     1607 2023-04-27 22:50:56.415214 kegstandcli-0.3.1/pyproject.toml
+-rw-r--r--   0        0        0        0 2023-04-03 20:22:59.696056 kegstandcli-0.3.1/src/kegstandcli/__init__.py
+-rw-r--r--   0        0        0        0 2023-04-03 20:23:08.893322 kegstandcli-0.3.1/src/kegstandcli/cli/__init__.py
+-rw-r--r--   0        0        0    16328 2023-04-12 22:03:29.066576 kegstandcli-0.3.1/src/kegstandcli/cli/__main__.py
+-rw-r--r--   0        0        0     3158 2023-04-12 22:03:29.067785 kegstandcli-0.3.1/src/kegstandcli/cli/build.py
+-rw-r--r--   0        0        0     1995 2023-04-23 18:42:31.185993 kegstandcli-0.3.1/src/kegstandcli/cli/config.py
+-rw-r--r--   0        0        0      154 2023-04-12 22:03:29.068379 kegstandcli-0.3.1/src/kegstandcli/cli/default_lambda.py.tmpl
+-rw-r--r--   0        0        0     1887 2023-04-12 22:03:29.068881 kegstandcli-0.3.1/src/kegstandcli/cli/deploy.py
+-rw-r--r--   0        0        0     1179 2023-04-25 19:33:46.541089 kegstandcli-0.3.1/src/kegstandcli/cli/new.py
+-rw-r--r--   0        0        0      985 2023-04-27 20:31:45.006926 kegstandcli-0.3.1/src/kegstandcli/cli/teardown.py
+-rw-r--r--   0        0        0        0 2023-04-03 20:23:36.547617 kegstandcli-0.3.1/src/kegstandcli/infra/__init__.py
+-rw-r--r--   0        0        0     2482 2023-04-26 17:37:46.125480 kegstandcli-0.3.1/src/kegstandcli/infra/app.py
+-rw-r--r--   0        0        0      275 2023-04-27 20:31:57.718526 kegstandcli-0.3.1/src/kegstandcli/infra/cdk.json
+-rw-r--r--   0        0        0        0 2023-04-03 20:23:50.899135 kegstandcli-0.3.1/src/kegstandcli/infra/stacks/__init__.py
+-rw-r--r--   0        0        0     4193 2023-04-12 22:03:29.071990 kegstandcli-0.3.1/src/kegstandcli/infra/stacks/lambda_rest_api.py
+-rw-r--r--   0        0        0     1491 2023-04-12 22:03:29.073183 kegstandcli-0.3.1/src/kegstandcli/utils.py
+-rw-r--r--   0        0        0     7887 1970-01-01 00:00:00.000000 kegstandcli-0.3.1/setup.py
+-rw-r--r--   0        0        0     7946 1970-01-01 00:00:00.000000 kegstandcli-0.3.1/PKG-INFO
```

### Comparing `kegstandcli-0.2.1/LICENSE` & `kegstandcli-0.3.1/LICENSE`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 The MIT License (MIT)
-Copyright (c) 2022 Jens Roland
+Copyright (c) 2023 Jens Roland
 
 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:
```

### Comparing `kegstandcli-0.2.1/pyproject.toml` & `kegstandcli-0.3.1/pyproject.toml`

 * *Files 17% similar despite different names*

```diff
@@ -1,15 +1,16 @@
 [tool.poetry]
 name = "kegstandcli"
-version = "0.2.1"
+version = "0.3.1"
 description = "The Developer's Toolbelt For Accelerating Mean-Time-To-Party on AWS"
 authors = ["JensRoland <mail@jensroland.com>"]
 license = "MIT"
-repository = "https://github.com/jensroland/kegstand-cli"
+repository = "https://github.com/jensroland/kegstand"
 homepage = "https://kegstand.dev"
+readme = "README.md"
 packages = [
     { include = "kegstandcli", from = "src" },
 ]
 # Keywords description https://python-poetry.org/docs/pyproject/#keywords
 keywords = []  #! Update me
 
 # Pypi classifiers: https://pypi.org/classifiers/
@@ -30,20 +31,21 @@
 [tool.poetry.dependencies]
 aws-cdk-lib = "^2.67.0"
 aws-solutions-constructs-aws-apigateway-lambda = "^2.36.0"
 boto3 = "^1.17.113"
 click = "^8.0.3"
 constructs = ">=10.0.0,<11.0.0"
 copier = "^6.2.0"  # 7.0.1 has a bug that deletes the template folder, see https://github.com/copier-org/copier/issues/1029
-flask = "^2.1.0"
 pyjwt = "^2.1.0"
 python = "^3.9"
-tomli = { version = "^2.0.1", python = "<3.11" }
+tomlkit = "^0.11.7"
 xxhash = "^3.2.0"
 
 [tool.poetry.group.dev.dependencies]
-coverage = "^6.0"
-pytest = "^6.2.5"
+coverage = "^7.2.3"
+pytest = "^7.3.0"
+pytest-subprocess = "^1.5.0"
+sentient-switchblade = {path = "../sentient-switchblade", develop = true}
 
 [build-system]
 requires = ["poetry-core>=1.0.0"]
 build-backend = "poetry.core.masonry.api"
```

### Comparing `kegstandcli-0.2.1/src/kegstandcli/cli/__main__.py` & `kegstandcli-0.3.1/src/kegstandcli/cli/__main__.py`

 * *Files 7% similar despite different names*

```diff
@@ -1,88 +1,89 @@
-import os
-import click
-
-
-from kegstandcli.cli.new import new
-from kegstandcli.cli.build import build
-from kegstandcli.cli.deploy import deploy
-from kegstandcli.cli.teardown import teardown
-
-ALIASES = {
-    'init': new,
-    'up': deploy,
-    'party': deploy,
-    'down': teardown
-}
-
-CONFIG_FILE_NAMES = ['kegstand.toml', '.kegstand', 'pyproject.toml']
-
-class AliasedGroup(click.Group):
-    def get_command(self, ctx, cmd_name):
-        try:
-            cmd_name = ALIASES[cmd_name].name
-        except KeyError:
-            pass
-        return super().get_command(ctx, cmd_name)
-
-
-# We pass the project directory to all subcommands via the context
-# so they can use it to find the kegstand.toml file
-@click.group(cls=AliasedGroup)
-@click.option('--config', help='Path to Kegstand configuration file.')
-@click.option('--verbose', is_flag=True, default=False, help='Show verbose output')
-@click.pass_context
-def kegstandcli(ctx, config, verbose):  # ANSI art generated with https://dom111.github.io/image-to-ansi/
-    """\b
-\033[49m                        \033[38;5;232;48;5;52m▄\033[38;5;234;48;5;52m▄\033[38;5;232;49m▄▄▄\033[38;5;236;48;5;52m▄\033[38;5;245;48;5;233m▄\033[38;5;252;48;5;232m▄\033[38;5;230;48;5;233m▄\033[38;5;230;48;5;234m▄\033[38;5;230;48;5;233m▄\033[38;5;253;48;5;232m▄\033[38;5;248;48;5;232m▄\033[38;5;59;48;5;52m▄\033[38;5;233;49m▄\033[38;5;232;49m▄\033[49m     \033[38;5;52;49m▄\033[49m       \033[m
-\033[49m                        \033[49;38;5;52m▀\033[38;5;52;48;5;236m▄\033[38;5;237;48;5;188m▄\033[38;5;254;48;5;252m▄\033[38;5;230;48;5;253m▄\033[38;5;230;48;5;230m▄\033[38;5;222;48;5;223m▄\033[38;5;222;48;5;222m▄▄▄▄▄▄\033[38;5;222;48;5;229m▄\033[38;5;222;48;5;253m▄\033[38;5;229;48;5;242m▄\033[38;5;249;48;5;232m▄\033[38;5;234;48;5;52m▄\033[38;5;52;49m▄\033[49m  \033[38;5;52;48;5;233m▄\033[38;5;239;48;5;232m▄\033[38;5;234;48;5;52m▄\033[38;5;52;49m▄\033[49m    \033[m
-\033[49m                        \033[38;5;52;49m▄\033[38;5;232;49m▄\033[38;5;240;48;5;52m▄\033[38;5;144;48;5;236m▄\033[38;5;101;48;5;186m▄\033[38;5;180;48;5;222m▄\033[38;5;222;48;5;222m▄▄▄▄▄▄\033[48;5;222m \033[38;5;222;48;5;222m▄▄▄▄\033[38;5;222;48;5;252m▄\033[38;5;187;48;5;235m▄\033[38;5;235;48;5;52m▄\033[38;5;52;49m▄\033[38;5;236;48;5;233m▄\033[38;5;254;48;5;102m▄\033[38;5;221;48;5;143m▄\033[38;5;237;48;5;232m▄\033[38;5;52;49m▄\033[49m   \033[m
-\033[49m                       \033[38;5;233;48;5;52m▄\033[38;5;250;48;5;234m▄\033[38;5;222;48;5;249m▄\033[38;5;185;48;5;229m▄\033[38;5;221;48;5;221m▄\033[38;5;179;48;5;221m▄\033[38;5;179;48;5;137m▄\033[38;5;137;48;5;180m▄\033[38;5;143;48;5;222m▄\033[38;5;222;48;5;222m▄▄▄\033[48;5;222m \033[38;5;222;48;5;222m▄▄▄▄▄▄▄\033[38;5;249;48;5;144m▄\033[38;5;230;48;5;238m▄\033[38;5;222;48;5;253m▄\033[38;5;222;48;5;222m▄\033[38;5;179;48;5;221m▄\033[38;5;137;48;5;95m▄\033[38;5;232;48;5;233m▄\033[49m   \033[m
-\033[49m                      \033[38;5;234;48;5;233m▄\033[38;5;187;48;5;243m▄\033[38;5;221;48;5;222m▄\033[38;5;221;48;5;215m▄\033[38;5;221;48;5;179m▄\033[38;5;222;48;5;179m▄▄\033[38;5;179;48;5;137m▄\033[38;5;101;48;5;143m▄\033[38;5;143;48;5;101m▄\033[38;5;180;48;5;101m▄\033[38;5;101;48;5;222m▄\033[38;5;222;48;5;222m▄▄▄\033[38;5;179;48;5;186m▄\033[38;5;186;48;5;222m▄\033[38;5;222;48;5;222m▄▄▄▄▄▄▄\033[38;5;221;48;5;222m▄\033[38;5;143;48;5;179m▄\033[38;5;101;48;5;137m▄\033[38;5;232;48;5;232m▄\033[49m   \033[m
-\033[49m                     \033[38;5;232;48;5;52m▄\033[38;5;250;48;5;242m▄\033[38;5;221;48;5;221m▄\033[38;5;222;48;5;221m▄\033[38;5;222;48;5;222m▄▄▄\033[38;5;137;48;5;221m▄\033[38;5;223;48;5;101m▄\033[38;5;223;48;5;223m▄\033[38;5;223;48;5;222m▄\033[38;5;222;48;5;222m▄\033[38;5;222;48;5;216m▄\033[38;5;222;48;5;101m▄\033[38;5;95;48;5;186m▄\033[38;5;137;48;5;222m▄\033[38;5;222;48;5;222m▄\033[38;5;222;48;5;179m▄\033[38;5;179;48;5;186m▄\033[38;5;180;48;5;222m▄\033[38;5;222;48;5;222m▄▄▄\033[38;5;221;48;5;222m▄\033[38;5;143;48;5;221m▄\033[38;5;179;48;5;137m▄\033[38;5;179;48;5;221m▄\033[38;5;143;48;5;95m▄\033[38;5;236;48;5;233m▄\033[49m   \033[m
-\033[49m                    \033[38;5;52;49m▄\033[38;5;235;48;5;235m▄\033[38;5;235;48;5;179m▄\033[38;5;221;48;5;179m▄\033[38;5;222;48;5;222m▄▄▄▄\033[38;5;246;48;5;101m▄\033[38;5;138;48;5;223m▄\033[38;5;223;48;5;223m▄▄▄▄\033[38;5;180;48;5;222m▄\033[38;5;144;48;5;137m▄\033[38;5;95;48;5;180m▄\033[38;5;238;48;5;95m▄\033[38;5;234;48;5;137m▄\033[38;5;240;48;5;221m▄\033[38;5;137;48;5;221m▄\033[38;5;137;48;5;179m▄\033[38;5;179;48;5;221m▄\033[38;5;221;48;5;179m▄▄\033[38;5;179;48;5;179m▄\033[38;5;101;48;5;215m▄\033[38;5;179;48;5;101m▄\033[38;5;221;48;5;221m▄\033[38;5;236;48;5;237m▄\033[38;5;52;48;5;233m▄\033[49m  \033[m
-\033[49m                    \033[49;38;5;52m▀\033[38;5;52;48;5;232m▄\033[38;5;232;48;5;234m▄\033[38;5;179;48;5;221m▄\033[38;5;222;48;5;222m▄\033[38;5;221;48;5;222m▄\033[38;5;222;48;5;222m▄\033[38;5;236;48;5;222m▄\033[38;5;235;48;5;144m▄\033[38;5;238;48;5;223m▄\033[38;5;238;48;5;144m▄\033[38;5;223;48;5;223m▄▄\033[38;5;144;48;5;138m▄\033[38;5;181;48;5;238m▄\033[38;5;188;48;5;102m▄\033[38;5;242;48;5;242m▄\033[38;5;239;48;5;235m▄\033[38;5;95;48;5;59m▄\033[38;5;221;48;5;221m▄▄\033[38;5;179;48;5;179m▄\033[38;5;221;48;5;137m▄▄\033[38;5;179;48;5;101m▄\033[38;5;143;48;5;95m▄\033[38;5;179;48;5;179m▄\033[38;5;221;48;5;221m▄\033[38;5;137;48;5;179m▄\033[38;5;232;48;5;233m▄\033[49m   \033[m
-\033[49m                      \033[49;38;5;52m▀\033[38;5;233;48;5;237m▄\033[38;5;95;48;5;222m▄\033[38;5;222;48;5;179m▄\033[38;5;179;48;5;179m▄\033[38;5;179;48;5;221m▄\033[38;5;137;48;5;137m▄\033[38;5;243;48;5;102m▄\033[38;5;243;48;5;238m▄\033[38;5;180;48;5;223m▄\033[38;5;223;48;5;223m▄\033[48;5;223m \033[38;5;223;48;5;223m▄\033[38;5;255;48;5;251m▄\033[38;5;181;48;5;242m▄\033[38;5;180;48;5;242m▄\033[38;5;137;48;5;137m▄\033[38;5;221;48;5;221m▄\033[38;5;137;48;5;221m▄\033[38;5;179;48;5;137m▄\033[38;5;179;48;5;221m▄\033[38;5;238;48;5;221m▄\033[38;5;245;48;5;101m▄\033[38;5;223;48;5;187m▄\033[38;5;223;48;5;138m▄\033[38;5;180;48;5;137m▄\033[38;5;234;48;5;235m▄\033[49;38;5;52m▀\033[49m   \033[m
-\033[49m                        \033[38;5;232;48;5;233m▄\033[38;5;221;48;5;222m▄\033[38;5;222;48;5;222m▄\033[38;5;101;48;5;143m▄\033[38;5;223;48;5;181m▄\033[38;5;223;48;5;223m▄▄\033[38;5;181;48;5;144m▄\033[38;5;247;48;5;223m▄\033[38;5;246;48;5;223m▄\033[38;5;223;48;5;223m▄▄\033[38;5;181;48;5;187m▄\033[38;5;180;48;5;95m▄\033[38;5;180;48;5;137m▄\033[38;5;137;48;5;101m▄\033[38;5;95;48;5;179m▄\033[38;5;131;48;5;179m▄\033[38;5;101;48;5;236m▄\033[38;5;187;48;5;59m▄\033[38;5;240;48;5;101m▄\033[38;5;237;48;5;144m▄\033[38;5;101;48;5;223m▄\033[38;5;241;48;5;223m▄\033[38;5;243;48;5;138m▄\033[38;5;234;48;5;233m▄\033[49m   \033[m
-\033[49m                       \033[38;5;232;48;5;52m▄\033[38;5;232;48;5;237m▄\033[38;5;232;48;5;101m▄\033[38;5;232;48;5;235m▄\033[38;5;235;48;5;233m▄\033[38;5;239;48;5;144m▄\033[38;5;234;48;5;223m▄\033[38;5;180;48;5;223m▄\033[38;5;138;48;5;245m▄\033[38;5;132;48;5;248m▄\033[38;5;132;48;5;240m▄\033[38;5;223;48;5;223m▄▄▄\033[38;5;222;48;5;223m▄\033[38;5;137;48;5;216m▄\033[38;5;131;48;5;89m▄\033[38;5;167;48;5;167m▄▄\033[38;5;236;48;5;95m▄\033[38;5;137;48;5;180m▄\033[38;5;221;48;5;95m▄\033[38;5;179;48;5;234m▄\033[38;5;95;48;5;233m▄\033[38;5;236;48;5;233m▄\033[38;5;234;48;5;233m▄\033[38;5;233;48;5;234m▄\033[38;5;232;48;5;233m▄\033[49m  \033[m
-\033[49m                    \033[38;5;233;49m▄\033[38;5;235;48;5;52m▄\033[38;5;8;48;5;232m▄\033[38;5;246;48;5;233m▄\033[38;5;102;48;5;233m▄\033[38;5;102;48;5;232m▄\033[38;5;245;48;5;232m▄\033[38;5;240;48;5;243m▄\033[38;5;235;48;5;236m▄\033[38;5;232;48;5;234m▄\033[38;5;234;48;5;237m▄\033[38;5;236;48;5;180m▄\033[38;5;236;48;5;132m▄\033[38;5;239;48;5;138m▄\033[38;5;101;48;5;187m▄\033[38;5;137;48;5;180m▄\033[38;5;239;48;5;101m▄\033[38;5;1;48;5;238m▄\033[38;5;89;48;5;235m▄\033[38;5;167;48;5;167m▄▄\033[38;5;125;48;5;167m▄\033[38;5;233;48;5;234m▄\033[38;5;179;48;5;179m▄\033[38;5;221;48;5;221m▄▄▄\033[38;5;179;48;5;221m▄\033[38;5;238;48;5;179m▄\033[38;5;232;48;5;234m▄\033[49m   \033[m
-\033[49m                   \033[38;5;233;49m▄\033[38;5;59;48;5;233m▄\033[38;5;247;48;5;102m▄\033[38;5;168;48;5;248m▄\033[38;5;167;48;5;174m▄\033[38;5;167;48;5;175m▄\033[38;5;167;48;5;102m▄\033[38;5;174;48;5;239m▄\033[38;5;239;48;5;239m▄\033[38;5;233;48;5;233m▄\033[38;5;232;48;5;232m▄\033[38;5;233;48;5;52m▄\033[38;5;234;48;5;125m▄\033[38;5;180;48;5;137m▄\033[38;5;223;48;5;222m▄▄\033[38;5;138;48;5;222m▄\033[38;5;235;48;5;239m▄\033[38;5;234;48;5;1m▄\033[38;5;125;48;5;125m▄\033[38;5;52;48;5;125m▄\033[38;5;233;48;5;125m▄▄\033[38;5;233;48;5;233m▄\033[38;5;58;48;5;179m▄\033[38;5;179;48;5;221m▄\033[38;5;179;48;5;137m▄\033[38;5;237;48;5;137m▄\033[38;5;233;48;5;101m▄\033[38;5;232;48;5;233m▄\033[49m    \033[m
-\033[49m                  \033[38;5;232;48;5;52m▄\033[38;5;241;48;5;235m▄\033[38;5;174;48;5;246m▄\033[38;5;174;48;5;168m▄\033[38;5;251;48;5;174m▄\033[38;5;174;48;5;167m▄\033[38;5;175;48;5;167m▄\033[38;5;167;48;5;167m▄▄\033[38;5;125;48;5;131m▄\033[38;5;52;48;5;232m▄\033[38;5;0;48;5;232m▄\033[38;5;232;48;5;233m▄\033[38;5;236;48;5;236m▄▄\033[38;5;236;48;5;239m▄\033[38;5;236;48;5;236m▄▄▄\033[38;5;233;48;5;234m▄\033[38;5;233;48;5;52m▄\033[49;38;5;232m▀\033[49;38;5;233m▀\033[49m  \033[38;5;232;48;5;236m▄\033[38;5;237;48;5;137m▄\033[38;5;239;48;5;95m▄\033[38;5;52;48;5;233m▄\033[49m      \033[m
-\033[49m                 \033[38;5;233;48;5;233m▄\033[38;5;145;48;5;239m▄\033[38;5;238;48;5;8m▄\033[38;5;95;48;5;167m▄\033[38;5;167;48;5;175m▄\033[38;5;167;48;5;224m▄\033[38;5;174;48;5;15m▄\033[38;5;254;48;5;188m▄\033[38;5;255;48;5;167m▄\033[38;5;131;48;5;125m▄\033[38;5;125;48;5;125m▄\033[38;5;232;48;5;52m▄\033[38;5;232;48;5;232m▄▄\033[38;5;233;48;5;233m▄\033[38;5;236;48;5;236m▄▄▄\033[38;5;236;48;5;235m▄\033[38;5;235;48;5;234m▄\033[38;5;232;48;5;232m▄\033[49m     \033[38;5;233;48;5;52m▄\033[38;5;232;48;5;235m▄\033[38;5;232;48;5;234m▄\033[49m       \033[m
-\033[49m               \033[38;5;52;49m▄\033[38;5;235;48;5;233m▄\033[38;5;248;48;5;243m▄\033[38;5;239;48;5;242m▄\033[38;5;245;48;5;8m▄\033[38;5;238;48;5;239m▄\033[38;5;237;48;5;237m▄\033[38;5;235;48;5;131m▄\033[38;5;1;48;5;125m▄\033[38;5;125;48;5;125m▄\033[38;5;125;48;5;174m▄\033[38;5;52;48;5;125m▄\033[38;5;0;48;5;233m▄\033[38;5;239;48;5;232m▄\033[38;5;175;48;5;233m▄\033[38;5;167;48;5;242m▄\033[38;5;167;48;5;138m▄\033[38;5;167;48;5;89m▄\033[38;5;167;48;5;236m▄▄▄▄\033[38;5;131;48;5;233m▄\033[38;5;236;48;5;232m▄\033[38;5;233;49m▄▄\033[49m  \033[49;38;5;52m▀\033[49;38;5;232m▀\033[49m        \033[m
-\033[49m               \033[38;5;232;48;5;233m▄\033[38;5;238;48;5;245m▄\033[38;5;235;48;5;239m▄\033[38;5;237;48;5;240m▄\033[38;5;238;48;5;238m▄▄\033[38;5;236;48;5;237m▄\033[38;5;234;48;5;235m▄\033[38;5;234;48;5;234m▄\033[38;5;232;48;5;233m▄\033[38;5;0;48;5;232m▄\033[38;5;239;48;5;0m▄\033[38;5;174;48;5;242m▄\033[38;5;167;48;5;174m▄\033[48;5;167m \033[38;5;167;48;5;167m▄\033[48;5;167m   \033[38;5;167;48;5;167m▄▄▄\033[48;5;167m \033[38;5;167;48;5;167m▄\033[38;5;167;48;5;131m▄\033[38;5;167;48;5;52m▄\033[38;5;131;48;5;232m▄\033[38;5;232;48;5;233m▄\033[38;5;233;49m▄\033[49m         \033[m
-\033[49m               \033[49;38;5;52m▀\033[38;5;233;48;5;232m▄\033[38;5;232;48;5;232m▄\033[38;5;233;48;5;232m▄\033[38;5;233;48;5;234m▄\033[38;5;232;48;5;237m▄\033[38;5;234;48;5;234m▄▄\033[38;5;0;48;5;233m▄\033[38;5;0;48;5;0m▄\033[38;5;232;48;5;0m▄\033[38;5;232;48;5;243m▄\033[38;5;235;48;5;167m▄\033[38;5;89;48;5;167m▄\033[38;5;167;48;5;167m▄▄▄\033[48;5;167m \033[38;5;167;48;5;167m▄▄▄▄▄▄\033[38;5;89;48;5;167m▄\033[38;5;233;48;5;131m▄\033[38;5;232;48;5;233m▄\033[49;38;5;232m▀\033[49m          \033[m
-\033[49m                 \033[49;38;5;233m▀\033[38;5;52;48;5;232m▄\033[38;5;232;48;5;232m▄\033[38;5;0;48;5;0m▄▄\033[38;5;0;48;5;232m▄\033[38;5;0;48;5;0m▄\033[38;5;232;48;5;232m▄\033[49;38;5;52m▀\033[49;38;5;233m▀\033[38;5;232;48;5;232m▄\033[38;5;234;48;5;234m▄\033[38;5;234;48;5;235m▄\033[38;5;234;48;5;131m▄\033[38;5;125;48;5;167m▄\033[38;5;167;48;5;167m▄▄▄▄\033[38;5;89;48;5;167m▄\033[38;5;234;48;5;131m▄\033[38;5;233;48;5;235m▄\033[38;5;233;48;5;233m▄\033[49;38;5;232m▀\033[49m            \033[m
-\033[49m                    \033[49;38;5;233m▀\033[49;38;5;232m▀▀▀\033[49m  \033[38;5;52;49m▄\033[38;5;239;48;5;232m▄\033[38;5;239;48;5;234m▄\033[38;5;234;48;5;234m▄▄\033[38;5;232;48;5;233m▄\033[38;5;233;48;5;234m▄\033[38;5;233;48;5;236m▄▄\033[38;5;52;48;5;234m▄\033[38;5;237;48;5;233m▄\033[38;5;187;48;5;234m▄\033[38;5;101;48;5;233m▄\033[38;5;233;48;5;233m▄\033[49m             \033[m
-\033[49m                          \033[38;5;233;48;5;52m▄\033[38;5;8;48;5;242m▄\033[38;5;223;48;5;223m▄\033[38;5;222;48;5;144m▄\033[38;5;239;48;5;240m▄\033[38;5;233;48;5;232m▄\033[49m    \033[38;5;52;48;5;233m▄\033[38;5;237;48;5;101m▄\033[38;5;236;48;5;95m▄\033[38;5;233;48;5;233m▄\033[38;5;233;49m▄\033[49m            \033[m
-\033[49m                          \033[38;5;232;48;5;233m▄\033[38;5;249;48;5;247m▄\033[38;5;223;48;5;223m▄\033[38;5;137;48;5;216m▄\033[38;5;232;48;5;233m▄\033[49m      \033[38;5;233;48;5;237m▄\033[38;5;234;48;5;238m▄\033[38;5;232;48;5;234m▄\033[49;38;5;233m▀\033[49m            \033[m
-\033[49m                         \033[38;5;232;48;5;52m▄\033[38;5;245;48;5;239m▄\033[38;5;236;48;5;236m▄\033[38;5;235;48;5;238m▄\033[38;5;232;48;5;235m▄\033[38;5;52;48;5;52m▄\033[49m                      \033[m
-\033[49m                         \033[38;5;233;48;5;233m▄\033[38;5;8;48;5;138m▄\033[38;5;235;48;5;236m▄\033[38;5;233;48;5;234m▄\033[38;5;232;48;5;232m▄\033[49m                       \033[m
-\033[38;5;167m██   ██ ███████  ██████  ███████ ████████  █████  ███    ██ ██████             
-██  ██  ██      ██       ██         ██    ██   ██ ████   ██ ██   ██            
-█████   █████   ██   ███ ███████    ██    ███████ ██ ██  ██ ██   ██            
-██  ██  ██      ██    ██      ██    ██    ██   ██ ██  ██ ██ ██   ██            
-██   ██ ███████  ██████  ███████    ██    ██   ██ ██   ████ ██████             
-===================================================================            
-The Developer's Toolbelt For Accelerating Mean-Time-To-Party on AWS\033[m"""
-    # Locate the correct Kegstand configuration file
-    if config is None:
-        for name in CONFIG_FILE_NAMES:
-            if os.path.exists(name):
-                config = name
-                break
-
-    if not os.path.exists(config):
-        raise click.ClickException(f'Configuration file not found: {config}')
-
-    project_dir = os.path.abspath(os.path.dirname(config))
-    ctx.obj = {
-        'config': os.path.abspath(config),
-        'project_dir': project_dir,
-        'verbose': verbose
-    }
-
-for command in [new, build, deploy, teardown]:
-    kegstandcli.add_command(command)
-
-if __name__ == '__main__':
-    kegstandcli(obj={})
+import os
+
+import click
+
+from kegstandcli.cli.build import build
+from kegstandcli.cli.deploy import deploy
+from kegstandcli.cli.new import new
+from kegstandcli.cli.teardown import teardown
+
+ALIASES = {"init": new, "up": deploy, "party": deploy, "down": teardown}
+
+CONFIG_FILE_NAMES = ["kegstand.toml", ".kegstand", "pyproject.toml"]
+
+
+class AliasedGroup(click.Group):
+    def get_command(self, ctx, cmd_name):
+        try:
+            cmd_name = ALIASES[cmd_name].name
+        except KeyError:
+            pass
+        return super().get_command(ctx, cmd_name)
+
+
+# pylint: disable=line-too-long
+# We pass the project directory to all subcommands via the context
+# so they can use it to find the kegstand.toml file
+@click.group(cls=AliasedGroup)
+@click.option("--config", help="Path to Kegstand configuration file.")
+@click.option("--verbose", is_flag=True, default=False, help="Show verbose output")
+@click.pass_context
+def kegstandcli(
+    ctx, config, verbose
+):  # ANSI art generated with https://dom111.github.io/image-to-ansi/
+    """\b
+    \033[49m                        \033[38;5;232;48;5;52m▄\033[38;5;234;48;5;52m▄\033[38;5;232;49m▄▄▄\033[38;5;236;48;5;52m▄\033[38;5;245;48;5;233m▄\033[38;5;252;48;5;232m▄\033[38;5;230;48;5;233m▄\033[38;5;230;48;5;234m▄\033[38;5;230;48;5;233m▄\033[38;5;253;48;5;232m▄\033[38;5;248;48;5;232m▄\033[38;5;59;48;5;52m▄\033[38;5;233;49m▄\033[38;5;232;49m▄\033[49m     \033[38;5;52;49m▄\033[49m       \033[m
+    \033[49m                        \033[49;38;5;52m▀\033[38;5;52;48;5;236m▄\033[38;5;237;48;5;188m▄\033[38;5;254;48;5;252m▄\033[38;5;230;48;5;253m▄\033[38;5;230;48;5;230m▄\033[38;5;222;48;5;223m▄\033[38;5;222;48;5;222m▄▄▄▄▄▄\033[38;5;222;48;5;229m▄\033[38;5;222;48;5;253m▄\033[38;5;229;48;5;242m▄\033[38;5;249;48;5;232m▄\033[38;5;234;48;5;52m▄\033[38;5;52;49m▄\033[49m  \033[38;5;52;48;5;233m▄\033[38;5;239;48;5;232m▄\033[38;5;234;48;5;52m▄\033[38;5;52;49m▄\033[49m    \033[m
+    \033[49m                        \033[38;5;52;49m▄\033[38;5;232;49m▄\033[38;5;240;48;5;52m▄\033[38;5;144;48;5;236m▄\033[38;5;101;48;5;186m▄\033[38;5;180;48;5;222m▄\033[38;5;222;48;5;222m▄▄▄▄▄▄\033[48;5;222m \033[38;5;222;48;5;222m▄▄▄▄\033[38;5;222;48;5;252m▄\033[38;5;187;48;5;235m▄\033[38;5;235;48;5;52m▄\033[38;5;52;49m▄\033[38;5;236;48;5;233m▄\033[38;5;254;48;5;102m▄\033[38;5;221;48;5;143m▄\033[38;5;237;48;5;232m▄\033[38;5;52;49m▄\033[49m   \033[m
+    \033[49m                       \033[38;5;233;48;5;52m▄\033[38;5;250;48;5;234m▄\033[38;5;222;48;5;249m▄\033[38;5;185;48;5;229m▄\033[38;5;221;48;5;221m▄\033[38;5;179;48;5;221m▄\033[38;5;179;48;5;137m▄\033[38;5;137;48;5;180m▄\033[38;5;143;48;5;222m▄\033[38;5;222;48;5;222m▄▄▄\033[48;5;222m \033[38;5;222;48;5;222m▄▄▄▄▄▄▄\033[38;5;249;48;5;144m▄\033[38;5;230;48;5;238m▄\033[38;5;222;48;5;253m▄\033[38;5;222;48;5;222m▄\033[38;5;179;48;5;221m▄\033[38;5;137;48;5;95m▄\033[38;5;232;48;5;233m▄\033[49m   \033[m
+    \033[49m                      \033[38;5;234;48;5;233m▄\033[38;5;187;48;5;243m▄\033[38;5;221;48;5;222m▄\033[38;5;221;48;5;215m▄\033[38;5;221;48;5;179m▄\033[38;5;222;48;5;179m▄▄\033[38;5;179;48;5;137m▄\033[38;5;101;48;5;143m▄\033[38;5;143;48;5;101m▄\033[38;5;180;48;5;101m▄\033[38;5;101;48;5;222m▄\033[38;5;222;48;5;222m▄▄▄\033[38;5;179;48;5;186m▄\033[38;5;186;48;5;222m▄\033[38;5;222;48;5;222m▄▄▄▄▄▄▄\033[38;5;221;48;5;222m▄\033[38;5;143;48;5;179m▄\033[38;5;101;48;5;137m▄\033[38;5;232;48;5;232m▄\033[49m   \033[m
+    \033[49m                     \033[38;5;232;48;5;52m▄\033[38;5;250;48;5;242m▄\033[38;5;221;48;5;221m▄\033[38;5;222;48;5;221m▄\033[38;5;222;48;5;222m▄▄▄\033[38;5;137;48;5;221m▄\033[38;5;223;48;5;101m▄\033[38;5;223;48;5;223m▄\033[38;5;223;48;5;222m▄\033[38;5;222;48;5;222m▄\033[38;5;222;48;5;216m▄\033[38;5;222;48;5;101m▄\033[38;5;95;48;5;186m▄\033[38;5;137;48;5;222m▄\033[38;5;222;48;5;222m▄\033[38;5;222;48;5;179m▄\033[38;5;179;48;5;186m▄\033[38;5;180;48;5;222m▄\033[38;5;222;48;5;222m▄▄▄\033[38;5;221;48;5;222m▄\033[38;5;143;48;5;221m▄\033[38;5;179;48;5;137m▄\033[38;5;179;48;5;221m▄\033[38;5;143;48;5;95m▄\033[38;5;236;48;5;233m▄\033[49m   \033[m
+    \033[49m                    \033[38;5;52;49m▄\033[38;5;235;48;5;235m▄\033[38;5;235;48;5;179m▄\033[38;5;221;48;5;179m▄\033[38;5;222;48;5;222m▄▄▄▄\033[38;5;246;48;5;101m▄\033[38;5;138;48;5;223m▄\033[38;5;223;48;5;223m▄▄▄▄\033[38;5;180;48;5;222m▄\033[38;5;144;48;5;137m▄\033[38;5;95;48;5;180m▄\033[38;5;238;48;5;95m▄\033[38;5;234;48;5;137m▄\033[38;5;240;48;5;221m▄\033[38;5;137;48;5;221m▄\033[38;5;137;48;5;179m▄\033[38;5;179;48;5;221m▄\033[38;5;221;48;5;179m▄▄\033[38;5;179;48;5;179m▄\033[38;5;101;48;5;215m▄\033[38;5;179;48;5;101m▄\033[38;5;221;48;5;221m▄\033[38;5;236;48;5;237m▄\033[38;5;52;48;5;233m▄\033[49m  \033[m
+    \033[49m                    \033[49;38;5;52m▀\033[38;5;52;48;5;232m▄\033[38;5;232;48;5;234m▄\033[38;5;179;48;5;221m▄\033[38;5;222;48;5;222m▄\033[38;5;221;48;5;222m▄\033[38;5;222;48;5;222m▄\033[38;5;236;48;5;222m▄\033[38;5;235;48;5;144m▄\033[38;5;238;48;5;223m▄\033[38;5;238;48;5;144m▄\033[38;5;223;48;5;223m▄▄\033[38;5;144;48;5;138m▄\033[38;5;181;48;5;238m▄\033[38;5;188;48;5;102m▄\033[38;5;242;48;5;242m▄\033[38;5;239;48;5;235m▄\033[38;5;95;48;5;59m▄\033[38;5;221;48;5;221m▄▄\033[38;5;179;48;5;179m▄\033[38;5;221;48;5;137m▄▄\033[38;5;179;48;5;101m▄\033[38;5;143;48;5;95m▄\033[38;5;179;48;5;179m▄\033[38;5;221;48;5;221m▄\033[38;5;137;48;5;179m▄\033[38;5;232;48;5;233m▄\033[49m   \033[m
+    \033[49m                      \033[49;38;5;52m▀\033[38;5;233;48;5;237m▄\033[38;5;95;48;5;222m▄\033[38;5;222;48;5;179m▄\033[38;5;179;48;5;179m▄\033[38;5;179;48;5;221m▄\033[38;5;137;48;5;137m▄\033[38;5;243;48;5;102m▄\033[38;5;243;48;5;238m▄\033[38;5;180;48;5;223m▄\033[38;5;223;48;5;223m▄\033[48;5;223m \033[38;5;223;48;5;223m▄\033[38;5;255;48;5;251m▄\033[38;5;181;48;5;242m▄\033[38;5;180;48;5;242m▄\033[38;5;137;48;5;137m▄\033[38;5;221;48;5;221m▄\033[38;5;137;48;5;221m▄\033[38;5;179;48;5;137m▄\033[38;5;179;48;5;221m▄\033[38;5;238;48;5;221m▄\033[38;5;245;48;5;101m▄\033[38;5;223;48;5;187m▄\033[38;5;223;48;5;138m▄\033[38;5;180;48;5;137m▄\033[38;5;234;48;5;235m▄\033[49;38;5;52m▀\033[49m   \033[m
+    \033[49m                        \033[38;5;232;48;5;233m▄\033[38;5;221;48;5;222m▄\033[38;5;222;48;5;222m▄\033[38;5;101;48;5;143m▄\033[38;5;223;48;5;181m▄\033[38;5;223;48;5;223m▄▄\033[38;5;181;48;5;144m▄\033[38;5;247;48;5;223m▄\033[38;5;246;48;5;223m▄\033[38;5;223;48;5;223m▄▄\033[38;5;181;48;5;187m▄\033[38;5;180;48;5;95m▄\033[38;5;180;48;5;137m▄\033[38;5;137;48;5;101m▄\033[38;5;95;48;5;179m▄\033[38;5;131;48;5;179m▄\033[38;5;101;48;5;236m▄\033[38;5;187;48;5;59m▄\033[38;5;240;48;5;101m▄\033[38;5;237;48;5;144m▄\033[38;5;101;48;5;223m▄\033[38;5;241;48;5;223m▄\033[38;5;243;48;5;138m▄\033[38;5;234;48;5;233m▄\033[49m   \033[m
+    \033[49m                       \033[38;5;232;48;5;52m▄\033[38;5;232;48;5;237m▄\033[38;5;232;48;5;101m▄\033[38;5;232;48;5;235m▄\033[38;5;235;48;5;233m▄\033[38;5;239;48;5;144m▄\033[38;5;234;48;5;223m▄\033[38;5;180;48;5;223m▄\033[38;5;138;48;5;245m▄\033[38;5;132;48;5;248m▄\033[38;5;132;48;5;240m▄\033[38;5;223;48;5;223m▄▄▄\033[38;5;222;48;5;223m▄\033[38;5;137;48;5;216m▄\033[38;5;131;48;5;89m▄\033[38;5;167;48;5;167m▄▄\033[38;5;236;48;5;95m▄\033[38;5;137;48;5;180m▄\033[38;5;221;48;5;95m▄\033[38;5;179;48;5;234m▄\033[38;5;95;48;5;233m▄\033[38;5;236;48;5;233m▄\033[38;5;234;48;5;233m▄\033[38;5;233;48;5;234m▄\033[38;5;232;48;5;233m▄\033[49m  \033[m
+    \033[49m                    \033[38;5;233;49m▄\033[38;5;235;48;5;52m▄\033[38;5;8;48;5;232m▄\033[38;5;246;48;5;233m▄\033[38;5;102;48;5;233m▄\033[38;5;102;48;5;232m▄\033[38;5;245;48;5;232m▄\033[38;5;240;48;5;243m▄\033[38;5;235;48;5;236m▄\033[38;5;232;48;5;234m▄\033[38;5;234;48;5;237m▄\033[38;5;236;48;5;180m▄\033[38;5;236;48;5;132m▄\033[38;5;239;48;5;138m▄\033[38;5;101;48;5;187m▄\033[38;5;137;48;5;180m▄\033[38;5;239;48;5;101m▄\033[38;5;1;48;5;238m▄\033[38;5;89;48;5;235m▄\033[38;5;167;48;5;167m▄▄\033[38;5;125;48;5;167m▄\033[38;5;233;48;5;234m▄\033[38;5;179;48;5;179m▄\033[38;5;221;48;5;221m▄▄▄\033[38;5;179;48;5;221m▄\033[38;5;238;48;5;179m▄\033[38;5;232;48;5;234m▄\033[49m   \033[m
+    \033[49m                   \033[38;5;233;49m▄\033[38;5;59;48;5;233m▄\033[38;5;247;48;5;102m▄\033[38;5;168;48;5;248m▄\033[38;5;167;48;5;174m▄\033[38;5;167;48;5;175m▄\033[38;5;167;48;5;102m▄\033[38;5;174;48;5;239m▄\033[38;5;239;48;5;239m▄\033[38;5;233;48;5;233m▄\033[38;5;232;48;5;232m▄\033[38;5;233;48;5;52m▄\033[38;5;234;48;5;125m▄\033[38;5;180;48;5;137m▄\033[38;5;223;48;5;222m▄▄\033[38;5;138;48;5;222m▄\033[38;5;235;48;5;239m▄\033[38;5;234;48;5;1m▄\033[38;5;125;48;5;125m▄\033[38;5;52;48;5;125m▄\033[38;5;233;48;5;125m▄▄\033[38;5;233;48;5;233m▄\033[38;5;58;48;5;179m▄\033[38;5;179;48;5;221m▄\033[38;5;179;48;5;137m▄\033[38;5;237;48;5;137m▄\033[38;5;233;48;5;101m▄\033[38;5;232;48;5;233m▄\033[49m    \033[m
+    \033[49m                  \033[38;5;232;48;5;52m▄\033[38;5;241;48;5;235m▄\033[38;5;174;48;5;246m▄\033[38;5;174;48;5;168m▄\033[38;5;251;48;5;174m▄\033[38;5;174;48;5;167m▄\033[38;5;175;48;5;167m▄\033[38;5;167;48;5;167m▄▄\033[38;5;125;48;5;131m▄\033[38;5;52;48;5;232m▄\033[38;5;0;48;5;232m▄\033[38;5;232;48;5;233m▄\033[38;5;236;48;5;236m▄▄\033[38;5;236;48;5;239m▄\033[38;5;236;48;5;236m▄▄▄\033[38;5;233;48;5;234m▄\033[38;5;233;48;5;52m▄\033[49;38;5;232m▀\033[49;38;5;233m▀\033[49m  \033[38;5;232;48;5;236m▄\033[38;5;237;48;5;137m▄\033[38;5;239;48;5;95m▄\033[38;5;52;48;5;233m▄\033[49m      \033[m
+    \033[49m                 \033[38;5;233;48;5;233m▄\033[38;5;145;48;5;239m▄\033[38;5;238;48;5;8m▄\033[38;5;95;48;5;167m▄\033[38;5;167;48;5;175m▄\033[38;5;167;48;5;224m▄\033[38;5;174;48;5;15m▄\033[38;5;254;48;5;188m▄\033[38;5;255;48;5;167m▄\033[38;5;131;48;5;125m▄\033[38;5;125;48;5;125m▄\033[38;5;232;48;5;52m▄\033[38;5;232;48;5;232m▄▄\033[38;5;233;48;5;233m▄\033[38;5;236;48;5;236m▄▄▄\033[38;5;236;48;5;235m▄\033[38;5;235;48;5;234m▄\033[38;5;232;48;5;232m▄\033[49m     \033[38;5;233;48;5;52m▄\033[38;5;232;48;5;235m▄\033[38;5;232;48;5;234m▄\033[49m       \033[m
+    \033[49m               \033[38;5;52;49m▄\033[38;5;235;48;5;233m▄\033[38;5;248;48;5;243m▄\033[38;5;239;48;5;242m▄\033[38;5;245;48;5;8m▄\033[38;5;238;48;5;239m▄\033[38;5;237;48;5;237m▄\033[38;5;235;48;5;131m▄\033[38;5;1;48;5;125m▄\033[38;5;125;48;5;125m▄\033[38;5;125;48;5;174m▄\033[38;5;52;48;5;125m▄\033[38;5;0;48;5;233m▄\033[38;5;239;48;5;232m▄\033[38;5;175;48;5;233m▄\033[38;5;167;48;5;242m▄\033[38;5;167;48;5;138m▄\033[38;5;167;48;5;89m▄\033[38;5;167;48;5;236m▄▄▄▄\033[38;5;131;48;5;233m▄\033[38;5;236;48;5;232m▄\033[38;5;233;49m▄▄\033[49m  \033[49;38;5;52m▀\033[49;38;5;232m▀\033[49m        \033[m
+    \033[49m               \033[38;5;232;48;5;233m▄\033[38;5;238;48;5;245m▄\033[38;5;235;48;5;239m▄\033[38;5;237;48;5;240m▄\033[38;5;238;48;5;238m▄▄\033[38;5;236;48;5;237m▄\033[38;5;234;48;5;235m▄\033[38;5;234;48;5;234m▄\033[38;5;232;48;5;233m▄\033[38;5;0;48;5;232m▄\033[38;5;239;48;5;0m▄\033[38;5;174;48;5;242m▄\033[38;5;167;48;5;174m▄\033[48;5;167m \033[38;5;167;48;5;167m▄\033[48;5;167m   \033[38;5;167;48;5;167m▄▄▄\033[48;5;167m \033[38;5;167;48;5;167m▄\033[38;5;167;48;5;131m▄\033[38;5;167;48;5;52m▄\033[38;5;131;48;5;232m▄\033[38;5;232;48;5;233m▄\033[38;5;233;49m▄\033[49m         \033[m
+    \033[49m               \033[49;38;5;52m▀\033[38;5;233;48;5;232m▄\033[38;5;232;48;5;232m▄\033[38;5;233;48;5;232m▄\033[38;5;233;48;5;234m▄\033[38;5;232;48;5;237m▄\033[38;5;234;48;5;234m▄▄\033[38;5;0;48;5;233m▄\033[38;5;0;48;5;0m▄\033[38;5;232;48;5;0m▄\033[38;5;232;48;5;243m▄\033[38;5;235;48;5;167m▄\033[38;5;89;48;5;167m▄\033[38;5;167;48;5;167m▄▄▄\033[48;5;167m \033[38;5;167;48;5;167m▄▄▄▄▄▄\033[38;5;89;48;5;167m▄\033[38;5;233;48;5;131m▄\033[38;5;232;48;5;233m▄\033[49;38;5;232m▀\033[49m          \033[m
+    \033[49m                 \033[49;38;5;233m▀\033[38;5;52;48;5;232m▄\033[38;5;232;48;5;232m▄\033[38;5;0;48;5;0m▄▄\033[38;5;0;48;5;232m▄\033[38;5;0;48;5;0m▄\033[38;5;232;48;5;232m▄\033[49;38;5;52m▀\033[49;38;5;233m▀\033[38;5;232;48;5;232m▄\033[38;5;234;48;5;234m▄\033[38;5;234;48;5;235m▄\033[38;5;234;48;5;131m▄\033[38;5;125;48;5;167m▄\033[38;5;167;48;5;167m▄▄▄▄\033[38;5;89;48;5;167m▄\033[38;5;234;48;5;131m▄\033[38;5;233;48;5;235m▄\033[38;5;233;48;5;233m▄\033[49;38;5;232m▀\033[49m            \033[m
+    \033[49m                    \033[49;38;5;233m▀\033[49;38;5;232m▀▀▀\033[49m  \033[38;5;52;49m▄\033[38;5;239;48;5;232m▄\033[38;5;239;48;5;234m▄\033[38;5;234;48;5;234m▄▄\033[38;5;232;48;5;233m▄\033[38;5;233;48;5;234m▄\033[38;5;233;48;5;236m▄▄\033[38;5;52;48;5;234m▄\033[38;5;237;48;5;233m▄\033[38;5;187;48;5;234m▄\033[38;5;101;48;5;233m▄\033[38;5;233;48;5;233m▄\033[49m             \033[m
+    \033[49m                          \033[38;5;233;48;5;52m▄\033[38;5;8;48;5;242m▄\033[38;5;223;48;5;223m▄\033[38;5;222;48;5;144m▄\033[38;5;239;48;5;240m▄\033[38;5;233;48;5;232m▄\033[49m    \033[38;5;52;48;5;233m▄\033[38;5;237;48;5;101m▄\033[38;5;236;48;5;95m▄\033[38;5;233;48;5;233m▄\033[38;5;233;49m▄\033[49m            \033[m
+    \033[49m                          \033[38;5;232;48;5;233m▄\033[38;5;249;48;5;247m▄\033[38;5;223;48;5;223m▄\033[38;5;137;48;5;216m▄\033[38;5;232;48;5;233m▄\033[49m      \033[38;5;233;48;5;237m▄\033[38;5;234;48;5;238m▄\033[38;5;232;48;5;234m▄\033[49;38;5;233m▀\033[49m            \033[m
+    \033[49m                         \033[38;5;232;48;5;52m▄\033[38;5;245;48;5;239m▄\033[38;5;236;48;5;236m▄\033[38;5;235;48;5;238m▄\033[38;5;232;48;5;235m▄\033[38;5;52;48;5;52m▄\033[49m                      \033[m
+    \033[49m                         \033[38;5;233;48;5;233m▄\033[38;5;8;48;5;138m▄\033[38;5;235;48;5;236m▄\033[38;5;233;48;5;234m▄\033[38;5;232;48;5;232m▄\033[49m                       \033[m
+    \033[38;5;167m██   ██ ███████  ██████  ███████ ████████  █████  ███    ██ ██████
+    ██  ██  ██      ██       ██         ██    ██   ██ ████   ██ ██   ██
+    █████   █████   ██   ███ ███████    ██    ███████ ██ ██  ██ ██   ██
+    ██  ██  ██      ██    ██      ██    ██    ██   ██ ██  ██ ██ ██   ██
+    ██   ██ ███████  ██████  ███████    ██    ██   ██ ██   ████ ██████
+    ===================================================================
+    The Developer's Toolbelt For Accelerating Mean-Time-To-Party on AWS\033[m"""  # noqa: E501
+    # Locate the correct Kegstand configuration file
+    if config is None:
+        for name in CONFIG_FILE_NAMES:
+            if os.path.exists(name):
+                config = name
+                break
+
+    if not os.path.exists(config):
+        raise click.ClickException(f"Configuration file not found: {config}")
+
+    project_dir = os.path.abspath(os.path.dirname(config))
+    ctx.obj = {
+        "config": os.path.abspath(config),
+        "project_dir": project_dir,
+        "verbose": verbose,
+    }
+
+
+for command in [new, build, deploy, teardown]:
+    kegstandcli.add_command(command)
+
+
+if __name__ == "__main__":
+    kegstandcli(obj={})  # pylint: disable=no-value-for-parameter
```

### Comparing `kegstandcli-0.2.1/src/kegstandcli/cli/config.py` & `kegstandcli-0.3.1/src/kegstandcli/cli/config.py`

 * *Files 24% similar despite different names*

```diff
@@ -1,47 +1,52 @@
-import os
-import re
-
-import click
-import tomli
-
-
-def get_kegstand_config(verbose, project_dir: str, config_file: str):
-    config_file = os.path.join(project_dir, config_file)
-    if verbose:
-        click.echo(f'Loading configuration from {config_file}')
-    with open(config_file, "rb") as f:
-        parsed_toml_config = tomli.load(f)
-        # If the config file is pyproject.toml, the config will be under the 'tool.kegstand' key
-        if config_file.endswith('pyproject.toml'):
-            config = parsed_toml_config.get('tool', {}).get('kegstand', {})
-            # Some keys are used from the [tool.poetry] section if not specified in [tool.kegstand]
-            properties_from_poetry = ['name', 'description', 'version']
-            if 'project' not in config:
-                config['project'] = {}
-            for property in properties_from_poetry:
-                if property not in config['project']:
-                    config['project'][property] = parsed_toml_config.get('tool', {}).get('poetry', {}).get(property)
-
-    # Validate that the name follows PEP 508
-    name_regex = r'^([A-Z0-9]|[A-Z0-9][A-Z0-9._-]*[A-Z0-9])$'
-    if not re.match(name_regex, config['project']['name'], flags=re.IGNORECASE):
-        raise click.BadParameter(f"Name '{config['project']['name']}' is not following PEP 508 naming conventions.")
-
-    config['project_dir'] = project_dir
-    config['config_file'] = config_file
-
-    # Set defaults where missing
-    config_defaults = {
-        'api': {
-            'name': 'Untitled API',
-            'entrypoint': 'api.lambda.handler'
-        }
-    }
-    for section, defaults in config_defaults.items():
-        if section not in config:
-            config[section] = {}
-        for key, default in defaults.items():
-            if key not in config[section]:
-                config[section][key] = default
-
-    return config
+import os
+import re
+from pathlib import Path
+
+import click
+from tomlkit import loads
+
+
+def get_kegstand_config(verbose, project_dir: str, config_file: str):
+    config_file = os.path.join(project_dir, config_file)
+    if verbose:
+        click.echo(f"Loading configuration from {config_file}")
+
+    parsed_toml_config = loads(Path(config_file).read_text(encoding="utf-8"))
+
+    # If the config file is pyproject.toml, the config will be under the 'tool.kegstand' key
+    if config_file.endswith("pyproject.toml"):
+        config = parsed_toml_config.get("tool", {}).get("kegstand", {})
+        # Some keys are used from the [tool.poetry] section if not specified in [tool.kegstand]
+        properties_from_poetry = ["name", "description", "version"]
+        if "project" not in config:
+            config["project"] = {}
+        for property in properties_from_poetry:
+            if property not in config["project"]:
+                config["project"][property] = (
+                    parsed_toml_config.get("tool", {}).get("poetry", {}).get(property)
+                )
+    else:
+        config = parsed_toml_config
+
+    # Validate that the name follows PEP 508
+    name_regex = r"^([A-Z0-9]|[A-Z0-9][A-Z0-9._-]*[A-Z0-9])$"
+    if not re.match(name_regex, config["project"]["name"], flags=re.IGNORECASE):
+        raise click.BadParameter(
+            f"Name '{config['project']['name']}' is not following PEP 508 naming conventions."
+        )
+
+    config["project_dir"] = project_dir
+    config["config_file"] = config_file
+
+    # Set defaults where missing
+    config_defaults = {
+        "api": {"name": "Untitled API", "entrypoint": "api.lambda.handler"}
+    }
+    for section, defaults in config_defaults.items():
+        if section not in config:
+            config[section] = {}
+        for key, default in defaults.items():
+            if key not in config[section]:
+                config[section][key] = default
+
+    return config
```

### Comparing `kegstandcli-0.2.1/src/kegstandcli/cli/deploy.py` & `kegstandcli-0.3.1/src/kegstandcli/cli/deploy.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,45 +1,69 @@
-import os
-import subprocess
-
-import click
-
-from kegstandcli.cli.build import build_command
-
-@click.command()
-@click.pass_context
-@click.option('--region', default='eu-west-1', help='AWS region to deploy to')
-@click.option('--hotswap', is_flag=True, default=False, help='Attempt to deploy without creating a new CloudFormation stack')
-@click.option('--skip-build', is_flag=True, default=False, help='Skip building the project before deploying')
-def deploy(ctx, region, hotswap, skip_build):
-    project_dir = ctx.obj['project_dir']
-    config_file = ctx.obj['config']
-    verbose = ctx.obj['verbose']
-    if not skip_build:
-        build_command(verbose, project_dir, config_file)
-    deploy_command(verbose, project_dir, config_file, region, hotswap)
-
-
-def deploy_command(verbose, project_dir, config_file, region, hotswap):
-    # Get the dir of the kegstandcli package (one level up from here)
-    kegstandcli_dir = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
-
-    click.echo('Deploying...')
-    command = [
-        'cdk',
-        'deploy',
-        '--app', 'python infra/app.py',
-        '--output', f'{project_dir}/cdk.out',
-        '--all',
-        '--context', f'region={region}',
-        '--context', f'project_dir={project_dir}',
-        '--context', f'config_file={config_file}',
-        '--context', f'verbose={verbose}',
-        '--require-approval', 'never'
-    ]
-    if hotswap:
-        command.append('--hotswap')
-    if verbose:
-        command.append('--verbose')
-
-    subprocess.run(command, cwd=kegstandcli_dir, check=True, stdout=subprocess.DEVNULL if not verbose else None)
-    click.echo('Finished deploying application!')
+import os
+import subprocess  # nosec
+
+import click
+
+from kegstandcli.cli.build import build_command
+
+
+@click.command()
+@click.pass_context
+@click.option("--region", default="eu-west-1", help="AWS region to deploy to")
+@click.option(
+    "--hotswap",
+    is_flag=True,
+    default=False,
+    help="Attempt to deploy without creating a new CloudFormation stack",
+)
+@click.option(
+    "--skip-build",
+    is_flag=True,
+    default=False,
+    help="Skip building the project before deploying",
+)
+def deploy(ctx, region, hotswap, skip_build):
+    project_dir = ctx.obj["project_dir"]
+    config_file = ctx.obj["config"]
+    verbose = ctx.obj["verbose"]
+    if not skip_build:
+        build_command(verbose, project_dir, config_file)
+
+    deploy_command(verbose, project_dir, config_file, region, hotswap)
+
+
+def deploy_command(verbose, project_dir, config_file, region, hotswap):
+    # Get the dir of the kegstandcli package (one level up from here)
+    kegstandcli_dir = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
+
+    click.echo("Deploying...")
+    command = [
+        "cdk",
+        "deploy",
+        "--app",
+        "python infra/app.py",
+        "--output",
+        f"{project_dir}/cdk.out",
+        "--all",
+        "--context",
+        f"region={region}",
+        "--context",
+        f"project_dir={project_dir}",
+        "--context",
+        f"config_file={config_file}",
+        "--context",
+        f"verbose={verbose}",
+        "--require-approval",
+        "never",
+    ]
+    if hotswap:
+        command.append("--hotswap")
+    if verbose:
+        command.append("--verbose")
+
+    subprocess.run(
+        command,
+        cwd=kegstandcli_dir,
+        check=True,
+        stdout=subprocess.DEVNULL if not verbose else None,
+    )  # nosec B603
+    click.echo("Finished deploying application!")
```

### Comparing `kegstandcli-0.2.1/src/kegstandcli/infra/app.py` & `kegstandcli-0.3.1/src/kegstandcli/infra/app.py`

 * *Files 13% similar despite different names*

```diff
@@ -1,70 +1,78 @@
-#!/usr/bin/env python3
-import logging
-import os
-import sys
-
-import aws_cdk as cdk
-from aws_cdk import (
-    aws_cognito as cognito,
-)
-
-from kegstandcli.infra.stacks.lambda_rest_api import (
-    LambdaRestApi
-)
-from kegstandcli.cli.config import get_kegstand_config
-
-logger = logging.getLogger()
-logger.setLevel(logging.INFO)
-
-app = cdk.App()
-
-# Get the passed context
-region = app.node.try_get_context('region')
-project_dir = app.node.try_get_context('project_dir')
-config_file = app.node.try_get_context('config_file') or 'kegstand.toml'
-verbose = app.node.try_get_context('config_file') or False
-
-# Get the Kegstand config
-config = get_kegstand_config(verbose, project_dir, config_file)
-
-logger.info(f"Creating app with config: {config}")
-
-parent_stack_name = config['project']['name'].replace(' ', '-')
-parent_stack = cdk.Stack(
-    app, parent_stack_name,
-    description=f"{config['project']['name']} v.{config['project']['version']}",
-    env={'region': region})
-
-# Create stacks
-modules = {}
-
-if "cdk" in config:
-    logger.info("Creating additional resources [cdk]...")
-    # Import the project's infra module
-    project_infra_path = os.path.join(project_dir, config['cdk']['path_to_infra'])
-    sys.path.append(project_infra_path)
-    from main import custom_infra
-    custom_infra_config = custom_infra(parent_stack, region)
-    modules['custom_infra'] = custom_infra_config
-
-if "api" in config:
-    logger.info("Creating stack for [api]...")
-
-    user_pool = cognito.UserPool.from_user_pool_id(parent_stack, "UserPool", config['api']['user_pool_id']) if "user_pool_id" in config['api'] else None
-
-    api_construct_name = config['api']['name'].replace(' ', '-')
-    api_construct = LambdaRestApi(parent_stack, api_construct_name, config, user_pool=user_pool)
-
-    # Add custom environment variables if provided
-    if "custom_infra" in modules and "environment_variables" in modules['custom_infra']:
-        for key, value in modules['custom_infra']['environment_variables'].items():
-            api_construct.lambda_function.add_environment(key, value)
-
-    modules['api'] = api_construct
-
-# Finally, we can set custom permissions between stacks if needed
-if "cdk" in config:
-    from main import permissions
-    permissions(parent_stack, **modules)
-
-app.synth()
+#!/usr/bin/env python3
+import logging
+import os
+import sys
+
+import aws_cdk as cdk
+from aws_cdk import aws_cognito as cognito
+
+from kegstandcli.cli.config import get_kegstand_config
+from kegstandcli.infra.stacks.lambda_rest_api import LambdaRestApi
+
+logger = logging.getLogger()
+logger.setLevel(logging.INFO)
+
+app = cdk.App()
+
+# Get the passed context
+region = app.node.try_get_context("region")
+project_dir = app.node.try_get_context("project_dir")
+config_file = app.node.try_get_context("config_file") or "kegstand.toml"
+verbose = app.node.try_get_context("verbose") or False
+
+# Get the Kegstand config
+config = get_kegstand_config(verbose, project_dir, config_file)
+
+logger.info("Creating app with config: %s", config)
+
+parent_stack_name = config["project"]["name"].replace(" ", "-")
+parent_stack = cdk.Stack(
+    app,
+    parent_stack_name,
+    description=f"{config['project']['name']} v.{config['project']['version']}",
+    env={"region": region},
+)
+
+# Create stacks/modules
+modules = {}
+
+if "cdk" in config:
+    logger.info("Creating additional resources [cdk]...")
+    # Import the project's infra module
+    project_infra_path = os.path.join(project_dir, config["cdk"]["path_to_infra"])
+    sys.path.append(project_infra_path)
+    from main import custom_infra  # pylint: disable=import-error
+
+    custom_infra_config = custom_infra(parent_stack, region)
+    modules["custom_infra"] = custom_infra_config
+
+if "api" in config:
+    logger.info("Creating stack for [api]...")
+
+    user_pool = (
+        cognito.UserPool.from_user_pool_id(
+            parent_stack, "UserPool", config["api"]["user_pool_id"]
+        )
+        if "user_pool_id" in config["api"]
+        else None
+    )
+
+    api_construct_name = config["api"]["name"].replace(" ", "-")
+    api_construct = LambdaRestApi(
+        parent_stack, api_construct_name, config, user_pool=user_pool
+    )
+
+    # Add custom environment variables if provided
+    if "custom_infra" in modules and "environment_variables" in modules["custom_infra"]:
+        for key, value in modules["custom_infra"]["environment_variables"].items():
+            api_construct.lambda_function.add_environment(key, value)
+
+    modules["api"] = api_construct
+
+# Finally, we can set custom permissions between stacks if needed
+if "cdk" in config:
+    from main import permissions  # pylint: disable=import-error
+
+    permissions(parent_stack, **modules)
+
+app.synth()
```

### Comparing `kegstandcli-0.2.1/src/kegstandcli/infra/stacks/lambda_rest_api.py` & `kegstandcli-0.3.1/src/kegstandcli/infra/stacks/lambda_rest_api.py`

 * *Files 25% similar despite different names*

```diff
@@ -1,82 +1,93 @@
-from aws_cdk import (
-    Stack,
-    aws_lambda as lambda_,
-    aws_apigateway as apigw,
-)
-from aws_solutions_constructs import aws_apigateway_lambda as apigw_lambda
-from constructs import Construct
-
-from kegstandcli.utils import find_resource_modules
-
-class LambdaRestApi(Construct):
-    def __init__(self, scope: Construct, id: str, config: dict, user_pool) -> None:
-        super().__init__(scope, id)
-
-        provision_with_authorizer = user_pool is not None
-
-        # Find all the resource modules in the API source directory
-        resource_modules = find_resource_modules(f'{config["project_dir"]}/dist/api_src/api')
-
-        powertools_layer_package = "AWSLambdaPowertoolsPythonV2:25"  # For ARM architecture, use AWSLambdaPowertoolsPythonV2-Arm64:25
-
-        # Official AWS Solution Construct: https://docs.aws.amazon.com/solutions/latest/constructs/aws-apigateway-lambda.html
-        api_gateway_to_lambda = apigw_lambda.ApiGatewayToLambda(
-            self, f"{id}-ApiGatewayConstruct",
-            lambda_function_props=lambda_.FunctionProps(
-                function_name=f"{id}-Function",
-                runtime=lambda_.Runtime.PYTHON_3_9,
-                handler=config["api"]["entrypoint"],
-                code=lambda_.Code.from_asset(f'{config["project_dir"]}/dist/api_src'),
-                layers=[  # Lambda Powertools: https://awslabs.github.io/aws-lambda-powertools-python/2.4.0/
-                    lambda_.LayerVersion.from_layer_version_arn(
-                        self, "PowertoolsLayer",
-                        layer_version_arn=f"arn:aws:lambda:{Stack.of(self).region}:017000801446:layer:{powertools_layer_package}",
-                    )
-                ],
-                memory_size=256,
-                tracing=lambda_.Tracing.ACTIVE,
-                environment={
-                    "LOG_LEVEL": "INFO",
-                    "POWERTOOLS_LOGGER_SAMPLE_RATE": "0.1",
-                    "POWERTOOLS_LOGGER_LOG_EVENT": "true",
-                    "POWERTOOLS_SERVICE_NAME": "authie-token-function",
-                },
-            ),
-            api_gateway_props=apigw.RestApiProps(
-                rest_api_name=f"{id}-RestApi",
-                default_method_options=apigw.MethodOptions(authorization_type=apigw.AuthorizationType.NONE),
-                deploy_options=apigw.StageOptions(
-                    logging_level=apigw.MethodLoggingLevel.INFO,
-                    metrics_enabled=True,
-                    tracing_enabled=True,
-                ),
-            ),
-        )
-        self.api = api_gateway_to_lambda.api_gateway
-        self.lambda_function = api_gateway_to_lambda.lambda_function
-
-        self.authorizer = None
-        if provision_with_authorizer:
-            self.authorizer = apigw.CognitoUserPoolsAuthorizer(
-                self, f"{id}-Authorizer", cognito_user_pools=[user_pool]
-            )
-
-        # For each resource, create API Gateway endpoints with the Lambda integration
-        for resource in resource_modules:
-            resource_root = self.api.root.add_resource(resource["name"])
-            if provision_with_authorizer:
-                # Private, auth required endpoints
-                resource_root.add_proxy(
-                    default_integration=apigw.LambdaIntegration(self.lambda_function),
-                    default_method_options=apigw.MethodOptions(
-                        authorization_type=apigw.AuthorizationType.COGNITO,
-                        authorizer=self.authorizer,  # Apply the authorizer
-                    ),
-                )
-            else:
-                # Public, no auth required endpoints, public endpoints
-                resource_root.add_proxy(
-                    default_integration=apigw.LambdaIntegration(self.lambda_function)
-                )
-
-        self.deployment = apigw.Deployment(self, f"{id}-Deployment", api=self.api)
+from aws_cdk import Stack
+from aws_cdk import aws_apigateway as apigw
+from aws_cdk import aws_lambda as lambda_
+from aws_solutions_constructs import aws_apigateway_lambda as apigw_lambda
+from constructs import Construct
+
+from kegstandcli.utils import find_resource_modules
+
+
+class LambdaRestApi(Construct):
+    def __init__(self, scope: Construct, id: str, config: dict, user_pool) -> None:
+        super().__init__(scope, id)
+
+        provision_with_authorizer = user_pool is not None
+
+        # Find all the resource modules in the API source directory
+        resource_modules = find_resource_modules(
+            f'{config["project_dir"]}/dist/api_src/api'
+        )
+
+        powertools_layer_package = {
+            "x86_64": "AWSLambdaPowertoolsPythonV2:25",
+            "arm64": "AWSLambdaPowertoolsPythonV2-Arm64:25",
+        }[
+            "x86_64"
+        ]  # TODO: make this configurable
+
+        # Official 'ApiGatewayToLambda' AWS Solution Construct
+        # https://docs.aws.amazon.com/solutions/latest/constructs/aws-apigateway-lambda.html
+        api_gateway_to_lambda = apigw_lambda.ApiGatewayToLambda(
+            self,
+            f"{id}-ApiGatewayConstruct",
+            lambda_function_props=lambda_.FunctionProps(
+                function_name=f"{id}-Function",
+                runtime=lambda_.Runtime.PYTHON_3_9,
+                handler=config["api"]["entrypoint"],
+                code=lambda_.Code.from_asset(f'{config["project_dir"]}/dist/api_src'),
+                layers=[  # Lambda Powertools: https://awslabs.github.io/aws-lambda-powertools-python/2.4.0/
+                    lambda_.LayerVersion.from_layer_version_arn(
+                        self,
+                        "PowertoolsLayer",
+                        layer_version_arn=f"arn:aws:lambda:{Stack.of(self).region}:017000801446:layer:{powertools_layer_package}",  # noqa: E501
+                    )
+                ],
+                memory_size=256,
+                tracing=lambda_.Tracing.ACTIVE,
+                environment={
+                    "LOG_LEVEL": "INFO",
+                    "POWERTOOLS_LOGGER_SAMPLE_RATE": "0.1",
+                    "POWERTOOLS_LOGGER_LOG_EVENT": "true",
+                    "POWERTOOLS_SERVICE_NAME": "authie-token-function",
+                },
+            ),
+            api_gateway_props=apigw.RestApiProps(
+                rest_api_name=f"{id}-RestApi",
+                default_method_options=apigw.MethodOptions(
+                    authorization_type=apigw.AuthorizationType.NONE
+                ),
+                deploy_options=apigw.StageOptions(
+                    logging_level=apigw.MethodLoggingLevel.INFO,
+                    metrics_enabled=True,
+                    tracing_enabled=True,
+                ),
+            ),
+        )
+        self.api = api_gateway_to_lambda.api_gateway
+        self.lambda_function = api_gateway_to_lambda.lambda_function
+
+        self.authorizer = None
+        if provision_with_authorizer:
+            self.authorizer = apigw.CognitoUserPoolsAuthorizer(
+                self, f"{id}-Authorizer", cognito_user_pools=[user_pool]
+            )
+
+        # For each resource, create API Gateway endpoints with the Lambda integration
+        for resource in resource_modules:
+            resource_root = self.api.root.add_resource(resource["name"])
+            if provision_with_authorizer:
+                # Private, auth required endpoints
+                resource_root.add_proxy(
+                    default_integration=apigw.LambdaIntegration(self.lambda_function),
+                    default_method_options=apigw.MethodOptions(
+                        authorization_type=apigw.AuthorizationType.COGNITO,
+                        authorizer=self.authorizer,  # Apply the authorizer
+                    ),
+                )
+            else:
+                # Public (no auth required) endpoints
+                resource_root.add_proxy(
+                    default_integration=apigw.LambdaIntegration(self.lambda_function)
+                )
+
+        self.deployment = apigw.Deployment(self, f"{id}-Deployment", api=self.api)
```

