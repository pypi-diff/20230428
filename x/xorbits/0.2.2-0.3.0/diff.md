# Comparing `tmp/xorbits-0.2.2.tar.gz` & `tmp/xorbits-0.3.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "xorbits-0.2.2.tar", last modified: Mon Apr  3 04:21:33 2023, max compression
+gzip compressed data, was "xorbits-0.3.0.tar", last modified: Fri Apr 28 11:46:04 2023, max compression
```

## Comparing `xorbits-0.2.2.tar` & `xorbits-0.3.0.tar`

### file list

```diff
@@ -1,1280 +1,1264 @@
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.164852 xorbits-0.2.2/
--rw-r--r--   0 runner    (1001) docker     (123)      487 2023-04-03 04:18:39.000000 xorbits-0.2.2/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (123)     9363 2023-04-03 04:21:33.164852 xorbits-0.2.2/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     1577 2023-04-03 04:18:39.000000 xorbits-0.2.2/pyproject.toml
--rw-r--r--   0 runner    (1001) docker     (123)     4384 2023-04-03 04:21:33.164852 xorbits-0.2.2/setup.cfg
--rw-r--r--   0 runner    (1001) docker     (123)     7198 2023-04-03 04:18:39.000000 xorbits-0.2.2/setup.py
--rw-r--r--   0 runner    (1001) docker     (123)    83196 2023-04-03 04:18:39.000000 xorbits-0.2.2/versioneer.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.164852 xorbits-0.2.2/xorbits/
--rw-r--r--   0 runner    (1001) docker     (123)     1001 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.048847 xorbits-0.2.2/xorbits/_mars/
--rw-r--r--   0 runner    (1001) docker     (123)     1005 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2443 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/_resource.pyx
--rw-r--r--   0 runner    (1001) docker     (123)      720 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/_utils.pxd
--rw-r--r--   0 runner    (1001) docker     (123)    11626 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/_utils.pyx
--rw-r--r--   0 runner    (1001) docker     (123)    23710 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/_version.py
--rw-r--r--   0 runner    (1001) docker     (123)    13421 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/config.py
--rw-r--r--   0 runner    (1001) docker     (123)       45 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/config.yml
--rw-r--r--   0 runner    (1001) docker     (123)     1123 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/constants.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.048847 xorbits-0.2.2/xorbits/_mars/contrib/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/contrib/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.048847 xorbits-0.2.2/xorbits/_mars/contrib/dask/
--rw-r--r--   0 runner    (1001) docker     (123)      936 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/contrib/dask/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1859 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/contrib/dask/converter.py
--rw-r--r--   0 runner    (1001) docker     (123)     3518 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/contrib/dask/scheduler.py
--rw-r--r--   0 runner    (1001) docker     (123)     2048 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/contrib/dask/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.052847 xorbits-0.2.2/xorbits/_mars/core/
--rw-r--r--   0 runner    (1001) docker     (123)     1752 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4375 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/base.py
--rw-r--r--   0 runner    (1001) docker     (123)     7114 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/context.py
--rw-r--r--   0 runner    (1001) docker     (123)     5649 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/custom_log.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.052847 xorbits-0.2.2/xorbits/_mars/core/entity/
--rw-r--r--   0 runner    (1001) docker     (123)     1400 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/entity/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2179 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/entity/chunks.py
--rw-r--r--   0 runner    (1001) docker     (123)     4068 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/entity/core.py
--rw-r--r--   0 runner    (1001) docker     (123)    11156 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/entity/executable.py
--rw-r--r--   0 runner    (1001) docker     (123)     2324 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/entity/fuse.py
--rw-r--r--   0 runner    (1001) docker     (123)     3083 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/entity/objects.py
--rw-r--r--   0 runner    (1001) docker     (123)     3013 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/entity/output_types.py
--rw-r--r--   0 runner    (1001) docker     (123)    14913 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/entity/tileables.py
--rw-r--r--   0 runner    (1001) docker     (123)     3402 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/entity/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)     1702 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/entrypoints.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.052847 xorbits-0.2.2/xorbits/_mars/core/graph/
--rw-r--r--   0 runner    (1001) docker     (123)      851 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/graph/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.052847 xorbits-0.2.2/xorbits/_mars/core/graph/builder/
--rw-r--r--   0 runner    (1001) docker     (123)      749 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/graph/builder/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2595 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/graph/builder/base.py
--rw-r--r--   0 runner    (1001) docker     (123)    16231 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/graph/builder/chunk.py
--rw-r--r--   0 runner    (1001) docker     (123)     1277 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/graph/builder/tileable.py
--rw-r--r--   0 runner    (1001) docker     (123)     1570 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/graph/builder/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    15725 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/graph/core.pyx
--rw-r--r--   0 runner    (1001) docker     (123)     5564 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/graph/entity.py
--rw-r--r--   0 runner    (1001) docker     (123)     3043 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/mode.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.052847 xorbits-0.2.2/xorbits/_mars/core/operand/
--rw-r--r--   0 runner    (1001) docker     (123)     1167 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/operand/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    13138 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/operand/base.py
--rw-r--r--   0 runner    (1001) docker     (123)    17614 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/operand/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     1792 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/operand/fetch.py
--rw-r--r--   0 runner    (1001) docker     (123)     1307 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/operand/fuse.py
--rw-r--r--   0 runner    (1001) docker     (123)     2654 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/operand/objects.py
--rw-r--r--   0 runner    (1001) docker     (123)     5727 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/core/operand/shuffle.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.052847 xorbits-0.2.2/xorbits/_mars/dataframe/
--rw-r--r--   0 runner    (1001) docker     (123)     3047 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    38074 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/align.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.060848 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/
--rw-r--r--   0 runner    (1001) docker     (123)    12350 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1047 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/abs.py
--rw-r--r--   0 runner    (1001) docker     (123)     1770 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/add.py
--rw-r--r--   0 runner    (1001) docker     (123)      994 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/arccos.py
--rw-r--r--   0 runner    (1001) docker     (123)      999 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/arccosh.py
--rw-r--r--   0 runner    (1001) docker     (123)      994 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/arcsin.py
--rw-r--r--   0 runner    (1001) docker     (123)      999 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/arcsinh.py
--rw-r--r--   0 runner    (1001) docker     (123)      994 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/arctan.py
--rw-r--r--   0 runner    (1001) docker     (123)      999 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/arctanh.py
--rw-r--r--   0 runner    (1001) docker     (123)     4649 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/around.py
--rw-r--r--   0 runner    (1001) docker     (123)     1491 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/bitwise_and.py
--rw-r--r--   0 runner    (1001) docker     (123)     2239 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/bitwise_or.py
--rw-r--r--   0 runner    (1001) docker     (123)     1490 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/bitwise_xor.py
--rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/ceil.py
--rw-r--r--   0 runner    (1001) docker     (123)    31764 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/core.py
--rw-r--r--   0 runner    (1001) docker     (123)      979 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/cos.py
--rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/cosh.py
--rw-r--r--   0 runner    (1001) docker     (123)      999 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/degrees.py
--rw-r--r--   0 runner    (1001) docker     (123)    12554 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/docstring.py
--rw-r--r--   0 runner    (1001) docker     (123)     9694 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/dot.py
--rw-r--r--   0 runner    (1001) docker     (123)     1527 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/equal.py
--rw-r--r--   0 runner    (1001) docker     (123)      979 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/exp.py
--rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/exp2.py
--rw-r--r--   0 runner    (1001) docker     (123)      989 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/expm1.py
--rw-r--r--   0 runner    (1001) docker     (123)      989 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/floor.py
--rw-r--r--   0 runner    (1001) docker     (123)     1891 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/floordiv.py
--rw-r--r--   0 runner    (1001) docker     (123)     1557 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/greater.py
--rw-r--r--   0 runner    (1001) docker     (123)     1582 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/greater_equal.py
--rw-r--r--   0 runner    (1001) docker     (123)     1049 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/invert.py
--rw-r--r--   0 runner    (1001) docker     (123)     1806 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/is_ufuncs.py
--rw-r--r--   0 runner    (1001) docker     (123)     1542 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/less.py
--rw-r--r--   0 runner    (1001) docker     (123)     1567 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/less_equal.py
--rw-r--r--   0 runner    (1001) docker     (123)      979 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/log.py
--rw-r--r--   0 runner    (1001) docker     (123)      989 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/log10.py
--rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/log2.py
--rw-r--r--   0 runner    (1001) docker     (123)     1766 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/mod.py
--rw-r--r--   0 runner    (1001) docker     (123)     1797 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/multiply.py
--rw-r--r--   0 runner    (1001) docker     (123)     1071 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/negative.py
--rw-r--r--   0 runner    (1001) docker     (123)     1543 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/not_equal.py
--rw-r--r--   0 runner    (1001) docker     (123)     1875 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/power.py
--rw-r--r--   0 runner    (1001) docker     (123)      999 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/radians.py
--rw-r--r--   0 runner    (1001) docker     (123)      979 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/sin.py
--rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/sinh.py
--rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/sqrt.py
--rw-r--r--   0 runner    (1001) docker     (123)     1844 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/subtract.py
--rw-r--r--   0 runner    (1001) docker     (123)      979 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/tan.py
--rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/tanh.py
--rw-r--r--   0 runner    (1001) docker     (123)     1872 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/truediv.py
--rw-r--r--   0 runner    (1001) docker     (123)    28791 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/arrays.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.064848 xorbits-0.2.2/xorbits/_mars/dataframe/base/
--rw-r--r--   0 runner    (1001) docker     (123)     6006 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    15056 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/_duplicate.py
--rw-r--r--   0 runner    (1001) docker     (123)    10091 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/accessor.py
--rw-r--r--   0 runner    (1001) docker     (123)    29655 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/apply.py
--rw-r--r--   0 runner    (1001) docker     (123)    14553 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/astype.py
--rw-r--r--   0 runner    (1001) docker     (123)    10468 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/bloom_filter.py
--rw-r--r--   0 runner    (1001) docker     (123)     9487 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/cartesian_chunk.py
--rw-r--r--   0 runner    (1001) docker     (123)     5283 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/check_monotonic.py
--rw-r--r--   0 runner    (1001) docker     (123)     2188 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/core.py
--rw-r--r--   0 runner    (1001) docker     (123)    21345 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/cut.py
--rw-r--r--   0 runner    (1001) docker     (123)     4481 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/datetimes.py
--rw-r--r--   0 runner    (1001) docker     (123)     9286 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/describe.py
--rw-r--r--   0 runner    (1001) docker     (123)     8693 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/diff.py
--rw-r--r--   0 runner    (1001) docker     (123)    16542 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/drop.py
--rw-r--r--   0 runner    (1001) docker     (123)    14040 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/drop_duplicates.py
--rw-r--r--   0 runner    (1001) docker     (123)    17338 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/duplicated.py
--rw-r--r--   0 runner    (1001) docker     (123)    27235 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/eval.py
--rw-r--r--   0 runner    (1001) docker     (123)     6459 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/explode.py
--rw-r--r--   0 runner    (1001) docker     (123)    13280 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/get_dummies.py
--rw-r--r--   0 runner    (1001) docker     (123)    14330 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/isin.py
--rw-r--r--   0 runner    (1001) docker     (123)    10224 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/map.py
--rw-r--r--   0 runner    (1001) docker     (123)    12851 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/map_chunk.py
--rw-r--r--   0 runner    (1001) docker     (123)     7314 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/melt.py
--rw-r--r--   0 runner    (1001) docker     (123)    16959 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/memory_usage.py
--rw-r--r--   0 runner    (1001) docker     (123)     4629 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/pct_change.py
--rw-r--r--   0 runner    (1001) docker     (123)     3780 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/qcut.py
--rw-r--r--   0 runner    (1001) docker     (123)     3267 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/rebalance.py
--rw-r--r--   0 runner    (1001) docker     (123)     8052 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/rechunk.py
--rw-r--r--   0 runner    (1001) docker     (123)     3187 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/select_dtypes.py
--rw-r--r--   0 runner    (1001) docker     (123)    18171 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/shift.py
--rw-r--r--   0 runner    (1001) docker     (123)    10392 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/stack.py
--rw-r--r--   0 runner    (1001) docker     (123)     1643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/standardize_range_index.py
--rw-r--r--   0 runner    (1001) docker     (123)    14951 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/string_.py
--rw-r--r--   0 runner    (1001) docker     (123)     1334 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/to_cpu.py
--rw-r--r--   0 runner    (1001) docker     (123)     1450 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/to_gpu.py
--rw-r--r--   0 runner    (1001) docker     (123)     7824 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/to_numeric.py
--rw-r--r--   0 runner    (1001) docker     (123)    17446 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/transform.py
--rw-r--r--   0 runner    (1001) docker     (123)     4724 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/transpose.py
--rw-r--r--   0 runner    (1001) docker     (123)     9365 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/base/value_counts.py
--rw-r--r--   0 runner    (1001) docker     (123)   100243 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.064848 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     8560 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     4564 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/dataframe.py
--rw-r--r--   0 runner    (1001) docker     (123)    20750 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/date_range.py
--rw-r--r--   0 runner    (1001) docker     (123)     3335 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/from_index.py
--rw-r--r--   0 runner    (1001) docker     (123)     5932 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/from_records.py
--rw-r--r--   0 runner    (1001) docker     (123)    27087 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/from_tensor.py
--rw-r--r--   0 runner    (1001) docker     (123)     9329 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/from_vineyard.py
--rw-r--r--   0 runner    (1001) docker     (123)     9250 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/index.py
--rw-r--r--   0 runner    (1001) docker     (123)    33386 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/read_csv.py
--rw-r--r--   0 runner    (1001) docker     (123)    24931 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/read_parquet.py
--rw-r--r--   0 runner    (1001) docker     (123)    34972 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/read_sql.py
--rw-r--r--   0 runner    (1001) docker     (123)     3666 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/series.py
--rw-r--r--   0 runner    (1001) docker     (123)     1220 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datasource/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.064848 xorbits-0.2.2/xorbits/_mars/dataframe/datastore/
--rw-r--r--   0 runner    (1001) docker     (123)     1197 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datastore/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    18874 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datastore/to_csv.py
--rw-r--r--   0 runner    (1001) docker     (123)     8737 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datastore/to_parquet.py
--rw-r--r--   0 runner    (1001) docker     (123)    11738 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datastore/to_sql.py
--rw-r--r--   0 runner    (1001) docker     (123)     6801 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/datastore/to_vineyard.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.064848 xorbits-0.2.2/xorbits/_mars/dataframe/fetch/
--rw-r--r--   0 runner    (1001) docker     (123)      700 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/fetch/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3746 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/fetch/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.068848 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/
--rw-r--r--   0 runner    (1001) docker     (123)     3596 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    48523 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/aggregation.py
--rw-r--r--   0 runner    (1001) docker     (123)    13267 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/apply.py
--rw-r--r--   0 runner    (1001) docker     (123)    18103 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     6403 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/cum.py
--rw-r--r--   0 runner    (1001) docker     (123)     2254 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/custom_aggregation.py
--rw-r--r--   0 runner    (1001) docker     (123)     7312 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/fill.py
--rw-r--r--   0 runner    (1001) docker     (123)     4889 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/getitem.py
--rw-r--r--   0 runner    (1001) docker     (123)     7871 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/head.py
--rw-r--r--   0 runner    (1001) docker     (123)     5703 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/nunique.py
--rw-r--r--   0 runner    (1001) docker     (123)    22167 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/sample.py
--rw-r--r--   0 runner    (1001) docker     (123)     5382 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/sort.py
--rw-r--r--   0 runner    (1001) docker     (123)    12518 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/groupby/transform.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.068848 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/
--rw-r--r--   0 runner    (1001) docker     (123)     3312 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3009 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/add_prefix_suffix.py
--rw-r--r--   0 runner    (1001) docker     (123)    19726 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/align.py
--rw-r--r--   0 runner    (1001) docker     (123)     2260 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/at.py
--rw-r--r--   0 runner    (1001) docker     (123)    25306 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/getitem.py
--rw-r--r--   0 runner    (1001) docker     (123)     1174 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/iat.py
--rw-r--r--   0 runner    (1001) docker     (123)    27407 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/iloc.py
--rw-r--r--   0 runner    (1001) docker     (123)    45797 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/index_lib.py
--rw-r--r--   0 runner    (1001) docker     (123)     6270 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/insert.py
--rw-r--r--   0 runner    (1001) docker     (123)    20171 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/loc.py
--rw-r--r--   0 runner    (1001) docker     (123)    32379 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/reindex.py
--rw-r--r--   0 runner    (1001) docker     (123)    16285 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/rename.py
--rw-r--r--   0 runner    (1001) docker     (123)     8480 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/rename_axis.py
--rw-r--r--   0 runner    (1001) docker     (123)    20487 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/reset_index.py
--rw-r--r--   0 runner    (1001) docker     (123)    21722 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/sample.py
--rw-r--r--   0 runner    (1001) docker     (123)     9039 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/set_axis.py
--rw-r--r--   0 runner    (1001) docker     (123)     7238 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/set_index.py
--rw-r--r--   0 runner    (1001) docker     (123)    13222 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/setitem.py
--rw-r--r--   0 runner    (1001) docker     (123)     1790 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    11903 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/indexing/where.py
--rw-r--r--   0 runner    (1001) docker     (123)     9563 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/initializer.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.068848 xorbits-0.2.2/xorbits/_mars/dataframe/merge/
--rw-r--r--   0 runner    (1001) docker     (123)     1100 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/merge/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     8476 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/merge/append.py
--rw-r--r--   0 runner    (1001) docker     (123)    22331 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/merge/concat.py
--rw-r--r--   0 runner    (1001) docker     (123)    49469 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/merge/merge.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.072848 xorbits-0.2.2/xorbits/_mars/dataframe/missing/
--rw-r--r--   0 runner    (1001) docker     (123)     1780 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/missing/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     9113 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/missing/checkna.py
--rw-r--r--   0 runner    (1001) docker     (123)    13659 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/missing/dropna.py
--rw-r--r--   0 runner    (1001) docker     (123)    22082 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/missing/fillna.py
--rw-r--r--   0 runner    (1001) docker     (123)    19567 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/missing/replace.py
--rw-r--r--   0 runner    (1001) docker     (123)    15685 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/operands.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.072848 xorbits-0.2.2/xorbits/_mars/dataframe/plotting/
--rw-r--r--   0 runner    (1001) docker     (123)     1173 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/plotting/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2294 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/plotting/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.072848 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/
--rw-r--r--   0 runner    (1001) docker     (123)     4259 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    39952 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/aggregation.py
--rw-r--r--   0 runner    (1001) docker     (123)     3767 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/all.py
--rw-r--r--   0 runner    (1001) docker     (123)     3771 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/any.py
--rw-r--r--   0 runner    (1001) docker     (123)    43305 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     2187 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/count.py
--rw-r--r--   0 runner    (1001) docker     (123)     1199 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/cummax.py
--rw-r--r--   0 runner    (1001) docker     (123)     1199 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/cummin.py
--rw-r--r--   0 runner    (1001) docker     (123)     1204 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/cumprod.py
--rw-r--r--   0 runner    (1001) docker     (123)     1199 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/cumsum.py
--rw-r--r--   0 runner    (1001) docker     (123)     1621 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/custom_reduction.py
--rw-r--r--   0 runner    (1001) docker     (123)     3433 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/kurtosis.py
--rw-r--r--   0 runner    (1001) docker     (123)     2146 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/max.py
--rw-r--r--   0 runner    (1001) docker     (123)     2004 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/mean.py
--rw-r--r--   0 runner    (1001) docker     (123)     2146 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/min.py
--rw-r--r--   0 runner    (1001) docker     (123)     7583 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/nunique.py
--rw-r--r--   0 runner    (1001) docker     (123)     2430 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/prod.py
--rw-r--r--   0 runner    (1001) docker     (123)     1182 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/reduction_size.py
--rw-r--r--   0 runner    (1001) docker     (123)     2378 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/sem.py
--rw-r--r--   0 runner    (1001) docker     (123)     3035 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/skew.py
--rw-r--r--   0 runner    (1001) docker     (123)     1528 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/std.py
--rw-r--r--   0 runner    (1001) docker     (123)     1908 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/str_concat.py
--rw-r--r--   0 runner    (1001) docker     (123)     2430 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/sum.py
--rw-r--r--   0 runner    (1001) docker     (123)     3232 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/unique.py
--rw-r--r--   0 runner    (1001) docker     (123)     2523 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/reduction/var.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.072848 xorbits-0.2.2/xorbits/_mars/dataframe/sort/
--rw-r--r--   0 runner    (1001) docker     (123)     1207 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/sort/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4491 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/sort/core.py
--rw-r--r--   0 runner    (1001) docker     (123)    25930 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/sort/psrs.py
--rw-r--r--   0 runner    (1001) docker     (123)     9239 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/sort/sort_index.py
--rw-r--r--   0 runner    (1001) docker     (123)    11808 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/sort/sort_values.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.072848 xorbits-0.2.2/xorbits/_mars/dataframe/statistics/
--rw-r--r--   0 runner    (1001) docker     (123)     1172 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/statistics/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    14688 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/statistics/corr.py
--rw-r--r--   0 runner    (1001) docker     (123)    16373 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/statistics/quantile.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.076848 xorbits-0.2.2/xorbits/_mars/dataframe/tseries/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/tseries/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    13620 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/tseries/to_datetime.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.076848 xorbits-0.2.2/xorbits/_mars/dataframe/ufunc/
--rw-r--r--   0 runner    (1001) docker     (123)      936 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/ufunc/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1665 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/ufunc/tensor.py
--rw-r--r--   0 runner    (1001) docker     (123)     1695 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/ufunc/ufunc.py
--rw-r--r--   0 runner    (1001) docker     (123)    50455 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.076848 xorbits-0.2.2/xorbits/_mars/dataframe/window/
--rw-r--r--   0 runner    (1001) docker     (123)     1139 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/window/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    22363 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/window/aggregation.py
--rw-r--r--   0 runner    (1001) docker     (123)     2427 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/window/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.076848 xorbits-0.2.2/xorbits/_mars/dataframe/window/ewm/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/window/ewm/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    15579 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/window/ewm/aggregation.py
--rw-r--r--   0 runner    (1001) docker     (123)     8515 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/window/ewm/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.076848 xorbits-0.2.2/xorbits/_mars/dataframe/window/expanding/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/window/expanding/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     5744 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/window/expanding/aggregation.py
--rw-r--r--   0 runner    (1001) docker     (123)     4150 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/window/expanding/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.076848 xorbits-0.2.2/xorbits/_mars/dataframe/window/rolling/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/window/rolling/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    17656 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/window/rolling/aggregation.py
--rw-r--r--   0 runner    (1001) docker     (123)    10336 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/dataframe/window/rolling/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.076848 xorbits-0.2.2/xorbits/_mars/deploy/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.076848 xorbits-0.2.2/xorbits/_mars/deploy/kubedl/
--rw-r--r--   0 runner    (1001) docker     (123)      697 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/kubedl/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    12305 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/kubedl/client.py
--rw-r--r--   0 runner    (1001) docker     (123)     8047 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/kubedl/config.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.076848 xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/
--rw-r--r--   0 runner    (1001) docker     (123)      701 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    17451 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/client.py
--rw-r--r--   0 runner    (1001) docker     (123)    19856 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/config.py
--rw-r--r--   0 runner    (1001) docker     (123)      124 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/config.yml
--rw-r--r--   0 runner    (1001) docker     (123)     7875 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     1145 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/supervisor.py
--rw-r--r--   0 runner    (1001) docker     (123)     1759 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/worker.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.076848 xorbits-0.2.2/xorbits/_mars/deploy/oscar/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/oscar/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2584 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/oscar/base_config.yml
--rw-r--r--   0 runner    (1001) docker     (123)     8297 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/oscar/cmdline.py
--rw-r--r--   0 runner    (1001) docker     (123)       66 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/oscar/config.yml
--rw-r--r--   0 runner    (1001) docker     (123)    15182 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/oscar/local.py
--rw-r--r--   0 runner    (1001) docker     (123)    11898 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/oscar/pool.py
--rw-r--r--   0 runner    (1001) docker     (123)     3557 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/oscar/service.py
--rw-r--r--   0 runner    (1001) docker     (123)    65132 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/oscar/session.py
--rw-r--r--   0 runner    (1001) docker     (123)     3765 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/oscar/supervisor.py
--rw-r--r--   0 runner    (1001) docker     (123)     4952 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/oscar/worker.py
--rw-r--r--   0 runner    (1001) docker     (123)     7792 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.080849 xorbits-0.2.2/xorbits/_mars/deploy/yarn/
--rw-r--r--   0 runner    (1001) docker     (123)      695 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/yarn/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     7611 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/yarn/client.py
--rw-r--r--   0 runner    (1001) docker     (123)     9848 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/yarn/config.py
--rw-r--r--   0 runner    (1001) docker     (123)       58 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/yarn/config.yml
--rw-r--r--   0 runner    (1001) docker     (123)     7167 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/yarn/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     1582 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/yarn/supervisor.py
--rw-r--r--   0 runner    (1001) docker     (123)     1722 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/deploy/yarn/worker.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.080849 xorbits-0.2.2/xorbits/_mars/learn/
--rw-r--r--   0 runner    (1001) docker     (123)     1093 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     6817 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/base.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.080849 xorbits-0.2.2/xorbits/_mars/learn/cluster/
--rw-r--r--   0 runner    (1001) docker     (123)     1467 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/cluster/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    12763 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_common.py
--rw-r--r--   0 runner    (1001) docker     (123)    16045 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_elkan.pyx
--rw-r--r--   0 runner    (1001) docker     (123)    27780 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_elkan_iter.py
--rw-r--r--   0 runner    (1001) docker     (123)      403 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_fast.pxd
--rw-r--r--   0 runner    (1001) docker     (123)     6473 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_fast.pyx
--rw-r--r--   0 runner    (1001) docker     (123)    16889 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_init.py
--rw-r--r--   0 runner    (1001) docker     (123)     7109 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_lloyd.pyx
--rw-r--r--   0 runner    (1001) docker     (123)    14867 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_lloyd_iter.py
--rw-r--r--   0 runner    (1001) docker     (123)    38142 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/cluster/_kmeans.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.080849 xorbits-0.2.2/xorbits/_mars/learn/contrib/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.080849 xorbits-0.2.2/xorbits/_mars/learn/contrib/joblib/
--rw-r--r--   0 runner    (1001) docker     (123)      687 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/joblib/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2919 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/joblib/backend.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.080849 xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/
--rw-r--r--   0 runner    (1001) docker     (123)     1079 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3865 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/_align.py
--rw-r--r--   0 runner    (1001) docker     (123)     7673 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/_predict.py
--rw-r--r--   0 runner    (1001) docker     (123)    15332 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/_train.py
--rw-r--r--   0 runner    (1001) docker     (123)     2418 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/classifier.py
--rw-r--r--   0 runner    (1001) docker     (123)     4094 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     2458 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/ranker.py
--rw-r--r--   0 runner    (1001) docker     (123)     2462 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/regressor.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.080849 xorbits-0.2.2/xorbits/_mars/learn/contrib/pytorch/
--rw-r--r--   0 runner    (1001) docker     (123)     1008 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/pytorch/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3069 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/pytorch/dataset.py
--rw-r--r--   0 runner    (1001) docker     (123)     4946 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/pytorch/run_script.py
--rw-r--r--   0 runner    (1001) docker     (123)    10509 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/pytorch/sampler.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.084849 xorbits-0.2.2/xorbits/_mars/learn/contrib/statsmodels/
--rw-r--r--   0 runner    (1001) docker     (123)      773 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/statsmodels/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3383 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/statsmodels/api.py
--rw-r--r--   0 runner    (1001) docker     (123)     3716 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/statsmodels/predict.py
--rw-r--r--   0 runner    (1001) docker     (123)     7394 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/statsmodels/train.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.084849 xorbits-0.2.2/xorbits/_mars/learn/contrib/tensorflow/
--rw-r--r--   0 runner    (1001) docker     (123)      875 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/tensorflow/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     6349 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/tensorflow/dataset.py
--rw-r--r--   0 runner    (1001) docker     (123)     6468 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/tensorflow/run_script.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.084849 xorbits-0.2.2/xorbits/_mars/learn/contrib/tsfresh/
--rw-r--r--   0 runner    (1001) docker     (123)      678 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/tsfresh/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2653 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/tsfresh/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     2552 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.084849 xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/
--rw-r--r--   0 runner    (1001) docker     (123)     1039 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3579 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/classifier.py
--rw-r--r--   0 runner    (1001) docker     (123)     5210 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/core.py
--rw-r--r--   0 runner    (1001) docker     (123)    13005 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/dmatrix.py
--rw-r--r--   0 runner    (1001) docker     (123)     7047 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/predict.py
--rw-r--r--   0 runner    (1001) docker     (123)     2565 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/regressor.py
--rw-r--r--   0 runner    (1001) docker     (123)     2088 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/start_tracker.py
--rw-r--r--   0 runner    (1001) docker     (123)    16904 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/tracker.py
--rw-r--r--   0 runner    (1001) docker     (123)    10218 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/train.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.084849 xorbits-0.2.2/xorbits/_mars/learn/datasets/
--rw-r--r--   0 runner    (1001) docker     (123)      767 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/datasets/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    22241 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/datasets/samples_generator.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.084849 xorbits-0.2.2/xorbits/_mars/learn/decomposition/
--rw-r--r--   0 runner    (1001) docker     (123)      707 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/decomposition/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     6619 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/decomposition/_base.py
--rw-r--r--   0 runner    (1001) docker     (123)    24734 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/decomposition/_pca.py
--rw-r--r--   0 runner    (1001) docker     (123)     9289 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/decomposition/_truncated_svd.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.084849 xorbits-0.2.2/xorbits/_mars/learn/ensemble/
--rw-r--r--   0 runner    (1001) docker     (123)      816 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/ensemble/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    64472 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/ensemble/_bagging.py
--rw-r--r--   0 runner    (1001) docker     (123)    13800 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/ensemble/_blockwise.py
--rw-r--r--   0 runner    (1001) docker     (123)    17881 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/ensemble/_iforest.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.084849 xorbits-0.2.2/xorbits/_mars/learn/glm/
--rw-r--r--   0 runner    (1001) docker     (123)      727 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/glm/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    11316 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/glm/_logistic.py
--rw-r--r--   0 runner    (1001) docker     (123)     2561 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/glm/_optimizers.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.084849 xorbits-0.2.2/xorbits/_mars/learn/linear_model/
--rw-r--r--   0 runner    (1001) docker     (123)      719 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/linear_model/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    12430 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/linear_model/_base.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.088849 xorbits-0.2.2/xorbits/_mars/learn/metrics/
--rw-r--r--   0 runner    (1001) docker     (123)     1057 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4677 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/_base.py
--rw-r--r--   0 runner    (1001) docker     (123)     7085 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/_check_targets.py
--rw-r--r--   0 runner    (1001) docker     (123)    54297 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/_classification.py
--rw-r--r--   0 runner    (1001) docker     (123)    29560 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/_ranking.py
--rw-r--r--   0 runner    (1001) docker     (123)     8635 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/_regresssion.py
--rw-r--r--   0 runner    (1001) docker     (123)     1724 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/_scorer.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.088849 xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/
--rw-r--r--   0 runner    (1001) docker     (123)      995 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     6377 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     4048 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/cosine.py
--rw-r--r--   0 runner    (1001) docker     (123)     8209 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/euclidean.py
--rw-r--r--   0 runner    (1001) docker     (123)     5389 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/haversine.py
--rw-r--r--   0 runner    (1001) docker     (123)     5998 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/manhattan.py
--rw-r--r--   0 runner    (1001) docker     (123)     3794 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/pairwise.py
--rw-r--r--   0 runner    (1001) docker     (123)    17273 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/pairwise_distances_topk.py
--rw-r--r--   0 runner    (1001) docker     (123)     1515 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/rbf_kernel.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.088849 xorbits-0.2.2/xorbits/_mars/learn/model_selection/
--rw-r--r--   0 runner    (1001) docker     (123)      688 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/model_selection/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    16492 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/model_selection/_split.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.088849 xorbits-0.2.2/xorbits/_mars/learn/neighbors/
--rw-r--r--   0 runner    (1001) docker     (123)      918 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/neighbors/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1821 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/neighbors/_ball_tree.py
--rw-r--r--   0 runner    (1001) docker     (123)    26863 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/neighbors/_faiss.py
--rw-r--r--   0 runner    (1001) docker     (123)     1859 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/neighbors/_kd_tree.py
--rw-r--r--   0 runner    (1001) docker     (123)     4659 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/neighbors/_kneighbors_graph.py
--rw-r--r--   0 runner    (1001) docker     (123)     1022 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/neighbors/_proxima.py
--rw-r--r--   0 runner    (1001) docker     (123)    21268 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/neighbors/base.py
--rw-r--r--   0 runner    (1001) docker     (123)     8809 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/neighbors/tree.py
--rw-r--r--   0 runner    (1001) docker     (123)     1277 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/neighbors/unsupervised.py
--rw-r--r--   0 runner    (1001) docker     (123)     3081 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/operands.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.088849 xorbits-0.2.2/xorbits/_mars/learn/preprocessing/
--rw-r--r--   0 runner    (1001) docker     (123)      788 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/preprocessing/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    13153 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/preprocessing/_data.py
--rw-r--r--   0 runner    (1001) docker     (123)    28962 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/preprocessing/_label.py
--rw-r--r--   0 runner    (1001) docker     (123)    11397 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/preprocessing/normalize.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.088849 xorbits-0.2.2/xorbits/_mars/learn/proxima/
--rw-r--r--   0 runner    (1001) docker     (123)      820 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/proxima/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     5964 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/proxima/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.088849 xorbits-0.2.2/xorbits/_mars/learn/proxima/simple_index/
--rw-r--r--   0 runner    (1001) docker     (123)      755 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/proxima/simple_index/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    13869 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/proxima/simple_index/builder.py
--rw-r--r--   0 runner    (1001) docker     (123)     3509 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/proxima/simple_index/knn.py
--rw-r--r--   0 runner    (1001) docker     (123)     4301 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/proxima/simple_index/recall.py
--rw-r--r--   0 runner    (1001) docker     (123)    19292 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/proxima/simple_index/searcher.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.088849 xorbits-0.2.2/xorbits/_mars/learn/semi_supervised/
--rw-r--r--   0 runner    (1001) docker     (123)      693 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/semi_supervised/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    12711 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/semi_supervised/_label_propagation.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.092849 xorbits-0.2.2/xorbits/_mars/learn/utils/
--rw-r--r--   0 runner    (1001) docker     (123)     1049 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/utils/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1382 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/utils/_cython_blas.pxd
--rw-r--r--   0 runner    (1001) docker     (123)     7074 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/utils/_cython_blas.pyx
--rw-r--r--   0 runner    (1001) docker     (123)     9494 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/utils/_encode.py
--rw-r--r--   0 runner    (1001) docker     (123)    14778 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/utils/checks.py
--rw-r--r--   0 runner    (1001) docker     (123)     3631 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/utils/collect_ports.py
--rw-r--r--   0 runner    (1001) docker     (123)     4679 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/utils/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     3142 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/utils/extmath.py
--rw-r--r--   0 runner    (1001) docker     (123)    15043 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/utils/multiclass.py
--rw-r--r--   0 runner    (1001) docker     (123)    18867 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/utils/shuffle.py
--rw-r--r--   0 runner    (1001) docker     (123)     6464 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/utils/sparsefuncs.py
--rw-r--r--   0 runner    (1001) docker     (123)    25615 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/utils/validation.py
--rw-r--r--   0 runner    (1001) docker     (123)    10972 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/learn/wrappers.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.092849 xorbits-0.2.2/xorbits/_mars/lib/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.092849 xorbits-0.2.2/xorbits/_mars/lib/aio/
--rw-r--r--   0 runner    (1001) docker     (123)     1031 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/aio/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     5092 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/aio/_runners.py
--rw-r--r--   0 runner    (1001) docker     (123)     1375 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/aio/_threads.py
--rw-r--r--   0 runner    (1001) docker     (123)     1280 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/aio/file.py
--rw-r--r--   0 runner    (1001) docker     (123)     2675 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/aio/isolation.py
--rw-r--r--   0 runner    (1001) docker     (123)    18712 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/bloom_filter.py
--rw-r--r--   0 runner    (1001) docker     (123)     1489 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/compression.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.092849 xorbits-0.2.2/xorbits/_mars/lib/filesystem/
--rw-r--r--   0 runner    (1001) docker     (123)      961 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     6582 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/_glob.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.096849 xorbits-0.2.2/xorbits/_mars/lib/filesystem/_oss_lib/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/_oss_lib/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     6662 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/_oss_lib/common.py
--rw-r--r--   0 runner    (1001) docker     (123)     4884 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/_oss_lib/glob.py
--rw-r--r--   0 runner    (1001) docker     (123)     4889 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/_oss_lib/handle.py
--rw-r--r--   0 runner    (1001) docker     (123)     8458 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/arrow.py
--rw-r--r--   0 runner    (1001) docker     (123)     1231 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/azure.py
--rw-r--r--   0 runner    (1001) docker     (123)     6681 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/base.py
--rw-r--r--   0 runner    (1001) docker     (123)     3048 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     5309 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/fsmap.py
--rw-r--r--   0 runner    (1001) docker     (123)     4502 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/fsspec_adapter.py
--rw-r--r--   0 runner    (1001) docker     (123)     1112 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/hdfs.py
--rw-r--r--   0 runner    (1001) docker     (123)     3635 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/local.py
--rw-r--r--   0 runner    (1001) docker     (123)     5064 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/oss.py
--rw-r--r--   0 runner    (1001) docker     (123)     2933 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/filesystem/s3.py
--rw-r--r--   0 runner    (1001) docker     (123)     8214 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/groupby_wrapper.py
--rw-r--r--   0 runner    (1001) docker     (123)     2586 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/mkl_interface.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.096849 xorbits-0.2.2/xorbits/_mars/lib/mmh3_src/
--rwxr-xr-x   0 runner    (1001) docker     (123)     8096 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/mmh3_src/MurmurHash3.cpp
--rwxr-xr-x   0 runner    (1001) docker     (123)     1263 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/mmh3_src/MurmurHash3.h
--rwxr-xr-x   0 runner    (1001) docker     (123)    11604 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/mmh3_src/mmh3module.cpp
--rw-r--r--   0 runner    (1001) docker     (123)    19804 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/nvutils.py
--rw-r--r--   0 runner    (1001) docker     (123)    14552 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/ordered_set.pyx
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.096849 xorbits-0.2.2/xorbits/_mars/lib/sparse/
--rw-r--r--   0 runner    (1001) docker     (123)    18059 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/sparse/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    52929 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/sparse/array.py
--rw-r--r--   0 runner    (1001) docker     (123)     2157 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/sparse/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     7155 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/sparse/matrix.py
--rw-r--r--   0 runner    (1001) docker     (123)     4810 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/sparse/vector.py
--rw-r--r--   0 runner    (1001) docker     (123)     3247 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/tbcode.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.096849 xorbits-0.2.2/xorbits/_mars/lib/uhashring/
--rw-r--r--   0 runner    (1001) docker     (123)       61 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/uhashring/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1184 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/uhashring/monkey.py
--rw-r--r--   0 runner    (1001) docker     (123)    11084 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/uhashring/ring.py
--rw-r--r--   0 runner    (1001) docker     (123)     2605 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/uhashring/ring_ketama.py
--rw-r--r--   0 runner    (1001) docker     (123)     1808 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/uhashring/ring_meta.py
--rw-r--r--   0 runner    (1001) docker     (123)    17724 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/lib/version.py
--rw-r--r--   0 runner    (1001) docker     (123)    10138 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/opcodes.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.096849 xorbits-0.2.2/xorbits/_mars/optimization/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.096849 xorbits-0.2.2/xorbits/_mars/optimization/logical/
--rw-r--r--   0 runner    (1001) docker     (123)      682 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.096849 xorbits-0.2.2/xorbits/_mars/optimization/logical/chunk/
--rw-r--r--   0 runner    (1001) docker     (123)      763 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/chunk/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)      992 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/chunk/column_pruning.py
--rw-r--r--   0 runner    (1001) docker     (123)     1296 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/chunk/core.py
--rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/chunk/head.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.096849 xorbits-0.2.2/xorbits/_mars/optimization/logical/common/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/common/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     9470 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/common/column_pruning.py
--rw-r--r--   0 runner    (1001) docker     (123)     5657 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/common/head.py
--rw-r--r--   0 runner    (1001) docker     (123)     9604 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.096849 xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/
--rw-r--r--   0 runner    (1001) docker     (123)      948 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    13824 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/arithmetic_query.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.096849 xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/column_pruning/
--rw-r--r--   0 runner    (1001) docker     (123)      633 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/column_pruning/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     9552 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/column_pruning/column_pruning_rule.py
--rw-r--r--   0 runner    (1001) docker     (123)     9779 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/column_pruning/input_column_selector.py
--rw-r--r--   0 runner    (1001) docker     (123)     5401 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/column_pruning/self_column_selector.py
--rw-r--r--   0 runner    (1001) docker     (123)     1036 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/column_pruning/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)     1489 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/core.py
--rw-r--r--   0 runner    (1001) docker     (123)      987 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/head.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.100849 xorbits-0.2.2/xorbits/_mars/optimization/physical/
--rw-r--r--   0 runner    (1001) docker     (123)      755 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/physical/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2900 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/physical/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     2277 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/physical/cupy.py
--rw-r--r--   0 runner    (1001) docker     (123)     7970 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/optimization/physical/numexpr.py
--rw-r--r--   0 runner    (1001) docker     (123)      965 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/oscar.py
--rw-r--r--   0 runner    (1001) docker     (123)     5281 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/profiling.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.100849 xorbits-0.2.2/xorbits/_mars/remote/
--rw-r--r--   0 runner    (1001) docker     (123)      776 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/remote/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    11829 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/remote/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     1162 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/remote/operands.py
--rw-r--r--   0 runner    (1001) docker     (123)     6957 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/remote/run_script.py
--rw-r--r--   0 runner    (1001) docker     (123)    13743 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/resource.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.100849 xorbits-0.2.2/xorbits/_mars/serialization/
--rw-r--r--   0 runner    (1001) docker     (123)      689 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/serialization/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1362 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/serialization/mars_objects.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.100849 xorbits-0.2.2/xorbits/_mars/serialization/serializables/
--rw-r--r--   0 runner    (1001) docker     (123)     1384 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/serialization/serializables/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     7781 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/serialization/serializables/core.py
--rw-r--r--   0 runner    (1001) docker     (123)    14703 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/serialization/serializables/field.py
--rw-r--r--   0 runner    (1001) docker     (123)    14365 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/serialization/serializables/field_type.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.100849 xorbits-0.2.2/xorbits/_mars/services/
--rw-r--r--   0 runner    (1001) docker     (123)      776 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.100849 xorbits-0.2.2/xorbits/_mars/services/cluster/
--rw-r--r--   0 runner    (1001) docker     (123)      898 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.100849 xorbits-0.2.2/xorbits/_mars/services/cluster/api/
--rw-r--r--   0 runner    (1001) docker     (123)      758 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/api/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4679 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/api/core.py
--rw-r--r--   0 runner    (1001) docker     (123)    14077 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/api/oscar.py
--rw-r--r--   0 runner    (1001) docker     (123)    13806 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/api/web.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.100849 xorbits-0.2.2/xorbits/_mars/services/cluster/backends/
--rw-r--r--   0 runner    (1001) docker     (123)      771 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/backends/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2687 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/backends/base.py
--rw-r--r--   0 runner    (1001) docker     (123)     1840 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/backends/fixed.py
--rw-r--r--   0 runner    (1001) docker     (123)     3390 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     3032 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/file_logger.py
--rw-r--r--   0 runner    (1001) docker     (123)     8615 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/gather.py
--rw-r--r--   0 runner    (1001) docker     (123)     4197 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/locator.py
--rw-r--r--   0 runner    (1001) docker     (123)     3128 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/procinfo.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.100849 xorbits-0.2.2/xorbits/_mars/services/cluster/supervisor/
--rw-r--r--   0 runner    (1001) docker     (123)      690 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/supervisor/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1911 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/supervisor/locator.py
--rw-r--r--   0 runner    (1001) docker     (123)     1716 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/supervisor/node_allocator.py
--rw-r--r--   0 runner    (1001) docker     (123)     7400 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/supervisor/node_info.py
--rw-r--r--   0 runner    (1001) docker     (123)     3785 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/supervisor/service.py
--rw-r--r--   0 runner    (1001) docker     (123)     7681 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/uploader.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.100849 xorbits-0.2.2/xorbits/_mars/services/cluster/worker/
--rw-r--r--   0 runner    (1001) docker     (123)      686 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/worker/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3460 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/worker/locator.py
--rw-r--r--   0 runner    (1001) docker     (123)     3101 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/cluster/worker/service.py
--rw-r--r--   0 runner    (1001) docker     (123)    11240 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/context.py
--rw-r--r--   0 runner    (1001) docker     (123)     6651 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.100849 xorbits-0.2.2/xorbits/_mars/services/lifecycle/
--rw-r--r--   0 runner    (1001) docker     (123)      770 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/lifecycle/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/lifecycle/api/
--rw-r--r--   0 runner    (1001) docker     (123)      766 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/lifecycle/api/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1288 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/lifecycle/api/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     5471 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/lifecycle/api/oscar.py
--rw-r--r--   0 runner    (1001) docker     (123)     3270 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/lifecycle/api/web.py
--rw-r--r--   0 runner    (1001) docker     (123)      727 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/lifecycle/errors.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/lifecycle/supervisor/
--rw-r--r--   0 runner    (1001) docker     (123)      692 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/lifecycle/supervisor/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1354 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/lifecycle/supervisor/service.py
--rw-r--r--   0 runner    (1001) docker     (123)    10684 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/lifecycle/supervisor/tracker.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/lifecycle/worker/
--rw-r--r--   0 runner    (1001) docker     (123)      727 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/lifecycle/worker/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/meta/
--rw-r--r--   0 runner    (1001) docker     (123)      774 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/meta/api/
--rw-r--r--   0 runner    (1001) docker     (123)      780 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/api/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1208 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/api/core.py
--rw-r--r--   0 runner    (1001) docker     (123)    11008 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/api/oscar.py
--rw-r--r--   0 runner    (1001) docker     (123)     3644 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/api/web.py
--rw-r--r--   0 runner    (1001) docker     (123)     2254 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     4985 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/metas.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/meta/store/
--rw-r--r--   0 runner    (1001) docker     (123)      734 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/store/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3547 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/store/base.py
--rw-r--r--   0 runner    (1001) docker     (123)     6014 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/store/dictionary.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/meta/supervisor/
--rw-r--r--   0 runner    (1001) docker     (123)      687 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/supervisor/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2620 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/supervisor/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     2183 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/supervisor/service.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/meta/worker/
--rw-r--r--   0 runner    (1001) docker     (123)      683 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/worker/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3004 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/worker/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     1671 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/meta/worker/service.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/mutable/
--rw-r--r--   0 runner    (1001) docker     (123)      825 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/mutable/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/mutable/api/
--rw-r--r--   0 runner    (1001) docker     (123)      758 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/mutable/api/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3369 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/mutable/api/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     3779 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/mutable/api/oscar.py
--rw-r--r--   0 runner    (1001) docker     (123)     7158 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/mutable/api/web.py
--rw-r--r--   0 runner    (1001) docker     (123)     5020 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/mutable/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/mutable/supervisor/
--rw-r--r--   0 runner    (1001) docker     (123)      767 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/mutable/supervisor/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     8355 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/mutable/supervisor/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     1378 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/mutable/supervisor/service.py
--rw-r--r--   0 runner    (1001) docker     (123)     6976 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/mutable/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/mutable/worker/
--rw-r--r--   0 runner    (1001) docker     (123)      686 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/mutable/worker/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4983 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/mutable/worker/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.104850 xorbits-0.2.2/xorbits/_mars/services/scheduling/
--rw-r--r--   0 runner    (1001) docker     (123)      694 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.108850 xorbits-0.2.2/xorbits/_mars/services/scheduling/api/
--rw-r--r--   0 runner    (1001) docker     (123)      696 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/api/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1149 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/api/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     6690 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/api/oscar.py
--rw-r--r--   0 runner    (1001) docker     (123)     4022 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/api/web.py
--rw-r--r--   0 runner    (1001) docker     (123)     1262 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/core.py
--rw-r--r--   0 runner    (1001) docker     (123)      897 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/errors.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.108850 xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/
--rw-r--r--   0 runner    (1001) docker     (123)      907 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    12446 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/assigner.py
--rw-r--r--   0 runner    (1001) docker     (123)    17563 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/autoscale.py
--rw-r--r--   0 runner    (1001) docker     (123)     6830 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/globalresource.py
--rw-r--r--   0 runner    (1001) docker     (123)    19032 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/manager.py
--rw-r--r--   0 runner    (1001) docker     (123)    14353 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/queueing.py
--rw-r--r--   0 runner    (1001) docker     (123)     4884 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/service.py
--rw-r--r--   0 runner    (1001) docker     (123)    12647 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/speculation.py
--rw-r--r--   0 runner    (1001) docker     (123)     2154 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.108850 xorbits-0.2.2/xorbits/_mars/services/scheduling/worker/
--rw-r--r--   0 runner    (1001) docker     (123)      912 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/worker/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    23010 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/worker/execution.py
--rw-r--r--   0 runner    (1001) docker     (123)    14295 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/worker/quota.py
--rw-r--r--   0 runner    (1001) docker     (123)     3425 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/worker/service.py
--rw-r--r--   0 runner    (1001) docker     (123)    12403 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/scheduling/worker/workerslot.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.108850 xorbits-0.2.2/xorbits/_mars/services/session/
--rw-r--r--   0 runner    (1001) docker     (123)      781 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.108850 xorbits-0.2.2/xorbits/_mars/services/session/api/
--rw-r--r--   0 runner    (1001) docker     (123)      758 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/api/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2829 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/api/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     8071 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/api/oscar.py
--rw-r--r--   0 runner    (1001) docker     (123)     6837 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/api/web.py
--rw-r--r--   0 runner    (1001) docker     (123)      796 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.108850 xorbits-0.2.2/xorbits/_mars/services/session/supervisor/
--rw-r--r--   0 runner    (1001) docker     (123)      785 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/supervisor/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     9175 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/supervisor/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     2247 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/supervisor/custom_log.py
--rw-r--r--   0 runner    (1001) docker     (123)     1345 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/supervisor/service.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.108850 xorbits-0.2.2/xorbits/_mars/services/session/worker/
--rw-r--r--   0 runner    (1001) docker     (123)      725 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/worker/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2380 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/worker/custom_log.py
--rw-r--r--   0 runner    (1001) docker     (123)     1418 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/session/worker/service.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.108850 xorbits-0.2.2/xorbits/_mars/services/storage/
--rw-r--r--   0 runner    (1001) docker     (123)      763 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.112850 xorbits-0.2.2/xorbits/_mars/services/storage/api/
--rw-r--r--   0 runner    (1001) docker     (123)      758 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/api/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2108 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/api/core.py
--rw-r--r--   0 runner    (1001) docker     (123)    11158 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/api/oscar.py
--rw-r--r--   0 runner    (1001) docker     (123)     6863 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/api/web.py
--rw-r--r--   0 runner    (1001) docker     (123)    25439 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/core.py
--rw-r--r--   0 runner    (1001) docker     (123)      835 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/errors.py
--rw-r--r--   0 runner    (1001) docker     (123)    26437 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/handler.py
--rw-r--r--   0 runner    (1001) docker     (123)     7256 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/spill.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.112850 xorbits-0.2.2/xorbits/_mars/services/storage/supervisor/
--rw-r--r--   0 runner    (1001) docker     (123)      734 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/supervisor/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    13188 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/transfer.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.112850 xorbits-0.2.2/xorbits/_mars/services/storage/worker/
--rw-r--r--   0 runner    (1001) docker     (123)      686 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/worker/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3036 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/storage/worker/service.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.112850 xorbits-0.2.2/xorbits/_mars/services/subtask/
--rw-r--r--   0 runner    (1001) docker     (123)      815 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/subtask/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3818 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/subtask/api.py
--rw-r--r--   0 runner    (1001) docker     (123)     7670 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/subtask/core.py
--rw-r--r--   0 runner    (1001) docker     (123)      737 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/subtask/errors.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.112850 xorbits-0.2.2/xorbits/_mars/services/subtask/supervisor/
--rw-r--r--   0 runner    (1001) docker     (123)      734 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/subtask/supervisor/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2955 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/subtask/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.112850 xorbits-0.2.2/xorbits/_mars/services/subtask/worker/
--rw-r--r--   0 runner    (1001) docker     (123)      686 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/subtask/worker/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2417 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/subtask/worker/manager.py
--rw-r--r--   0 runner    (1001) docker     (123)    30995 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/subtask/worker/processor.py
--rw-r--r--   0 runner    (1001) docker     (123)     5660 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/subtask/worker/runner.py
--rw-r--r--   0 runner    (1001) docker     (123)     1575 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/subtask/worker/service.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.112850 xorbits-0.2.2/xorbits/_mars/services/task/
--rw-r--r--   0 runner    (1001) docker     (123)      839 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.112850 xorbits-0.2.2/xorbits/_mars/services/task/analyzer/
--rw-r--r--   0 runner    (1001) docker     (123)      680 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/analyzer/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    22682 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/analyzer/analyzer.py
--rw-r--r--   0 runner    (1001) docker     (123)     8414 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/analyzer/assigner.py
--rw-r--r--   0 runner    (1001) docker     (123)     8911 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/analyzer/fusion.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.112850 xorbits-0.2.2/xorbits/_mars/services/task/api/
--rw-r--r--   0 runner    (1001) docker     (123)      733 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/api/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3757 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/api/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     5151 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/api/oscar.py
--rw-r--r--   0 runner    (1001) docker     (123)    11985 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/api/web.py
--rw-r--r--   0 runner    (1001) docker     (123)     1149 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/config.py
--rw-r--r--   0 runner    (1001) docker     (123)     3713 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/core.py
--rw-r--r--   0 runner    (1001) docker     (123)      721 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/errors.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.112850 xorbits-0.2.2/xorbits/_mars/services/task/execution/
--rw-r--r--   0 runner    (1001) docker     (123)      664 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/execution/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     7870 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/execution/api.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.112850 xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/
--rw-r--r--   0 runner    (1001) docker     (123)      756 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1367 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/config.py
--rw-r--r--   0 runner    (1001) docker     (123)    18936 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/executor.py
--rw-r--r--   0 runner    (1001) docker     (123)     2047 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/fetcher.py
--rw-r--r--   0 runner    (1001) docker     (123)     3689 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/resource.py
--rw-r--r--   0 runner    (1001) docker     (123)    14111 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/stage.py
--rw-r--r--   0 runner    (1001) docker     (123)     3668 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/execution/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.116850 xorbits-0.2.2/xorbits/_mars/services/task/supervisor/
--rw-r--r--   0 runner    (1001) docker     (123)      687 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/supervisor/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     6057 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/supervisor/graph_visualizer.py
--rw-r--r--   0 runner    (1001) docker     (123)    14265 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/supervisor/manager.py
--rw-r--r--   0 runner    (1001) docker     (123)     8667 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/supervisor/preprocessor.py
--rw-r--r--   0 runner    (1001) docker     (123)    18717 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/supervisor/processor.py
--rw-r--r--   0 runner    (1001) docker     (123)     3137 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/supervisor/service.py
--rw-r--r--   0 runner    (1001) docker     (123)    16347 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/supervisor/task.py
--rw-r--r--   0 runner    (1001) docker     (123)    14774 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/task_info_collector.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.116850 xorbits-0.2.2/xorbits/_mars/services/task/worker/
--rw-r--r--   0 runner    (1001) docker     (123)      683 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/worker/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1224 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/task/worker/service.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.116850 xorbits-0.2.2/xorbits/_mars/services/web/
--rw-r--r--   0 runner    (1001) docker     (123)      881 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/web/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.116850 xorbits-0.2.2/xorbits/_mars/services/web/api/
--rw-r--r--   0 runner    (1001) docker     (123)      675 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/web/api/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1253 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/web/api/oscar.py
--rw-r--r--   0 runner    (1001) docker     (123)      942 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/web/api/web.py
--rw-r--r--   0 runner    (1001) docker     (123)     9416 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/web/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     1391 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/web/handlers.py
--rw-r--r--   0 runner    (1001) docker     (123)     3735 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/web/supervisor.py
--rw-r--r--   0 runner    (1001) docker     (123)      725 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/services/web/worker.py
--rw-r--r--   0 runner    (1001) docker     (123)      828 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/session.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.116850 xorbits-0.2.2/xorbits/_mars/storage/
--rw-r--r--   0 runner    (1001) docker     (123)     1018 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/storage/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     6936 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/storage/base.py
--rw-r--r--   0 runner    (1001) docker     (123)     4272 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/storage/core.py
--rw-r--r--   0 runner    (1001) docker     (123)    10895 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/storage/cuda.py
--rw-r--r--   0 runner    (1001) docker     (123)      720 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/storage/errors.py
--rw-r--r--   0 runner    (1001) docker     (123)     5109 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/storage/filesystem.py
--rw-r--r--   0 runner    (1001) docker     (123)     9561 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/storage/plasma.py
--rw-r--r--   0 runner    (1001) docker     (123)     7728 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/storage/shared_memory.py
--rw-r--r--   0 runner    (1001) docker     (123)     7719 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/storage/vineyard.py
--rw-r--r--   0 runner    (1001) docker     (123)      833 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/supervisor.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.116850 xorbits-0.2.2/xorbits/_mars/tensor/
--rw-r--r--   0 runner    (1001) docker     (123)     6118 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.128851 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/
--rw-r--r--   0 runner    (1001) docker     (123)     9441 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2192 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/abs.py
--rw-r--r--   0 runner    (1001) docker     (123)     2222 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/absolute.py
--rw-r--r--   0 runner    (1001) docker     (123)     4068 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/add.py
--rw-r--r--   0 runner    (1001) docker     (123)     2579 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/angle.py
--rw-r--r--   0 runner    (1001) docker     (123)     3524 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arccos.py
--rw-r--r--   0 runner    (1001) docker     (123)     3036 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arccosh.py
--rw-r--r--   0 runner    (1001) docker     (123)     3256 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arcsin.py
--rw-r--r--   0 runner    (1001) docker     (123)     3043 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arcsinh.py
--rw-r--r--   0 runner    (1001) docker     (123)     3574 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arctan.py
--rw-r--r--   0 runner    (1001) docker     (123)     4455 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arctan2.py
--rw-r--r--   0 runner    (1001) docker     (123)     3021 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arctanh.py
--rw-r--r--   0 runner    (1001) docker     (123)     4413 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/around.py
--rw-r--r--   0 runner    (1001) docker     (123)     2929 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/bitand.py
--rw-r--r--   0 runner    (1001) docker     (123)     3324 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/bitor.py
--rw-r--r--   0 runner    (1001) docker     (123)     2920 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/bitxor.py
--rw-r--r--   0 runner    (1001) docker     (123)     2127 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/cbrt.py
--rw-r--r--   0 runner    (1001) docker     (123)     2264 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/ceil.py
--rw-r--r--   0 runner    (1001) docker     (123)     6680 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/clip.py
--rw-r--r--   0 runner    (1001) docker     (123)     2239 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/conj.py
--rw-r--r--   0 runner    (1001) docker     (123)     2517 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/copysign.py
--rw-r--r--   0 runner    (1001) docker     (123)    24387 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     2741 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/cos.py
--rw-r--r--   0 runner    (1001) docker     (123)     2230 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/cosh.py
--rw-r--r--   0 runner    (1001) docker     (123)     2183 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/deg2rad.py
--rw-r--r--   0 runner    (1001) docker     (123)     2387 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/degrees.py
--rw-r--r--   0 runner    (1001) docker     (123)     3722 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/divide.py
--rw-r--r--   0 runner    (1001) docker     (123)     2405 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/equal.py
--rw-r--r--   0 runner    (1001) docker     (123)     3795 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/exp.py
--rw-r--r--   0 runner    (1001) docker     (123)     2009 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/exp2.py
--rw-r--r--   0 runner    (1001) docker     (123)     2433 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/expm1.py
--rw-r--r--   0 runner    (1001) docker     (123)     2442 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/fabs.py
--rw-r--r--   0 runner    (1001) docker     (123)     1772 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/fix.py
--rw-r--r--   0 runner    (1001) docker     (123)     3376 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/float_power.py
--rw-r--r--   0 runner    (1001) docker     (123)     2454 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/floor.py
--rw-r--r--   0 runner    (1001) docker     (123)     2999 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/floordiv.py
--rw-r--r--   0 runner    (1001) docker     (123)     3586 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/fmax.py
--rw-r--r--   0 runner    (1001) docker     (123)     3579 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/fmin.py
--rw-r--r--   0 runner    (1001) docker     (123)     3224 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/fmod.py
--rw-r--r--   0 runner    (1001) docker     (123)     4415 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/frexp.py
--rw-r--r--   0 runner    (1001) docker     (123)     2467 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/greater.py
--rw-r--r--   0 runner    (1001) docker     (123)     2316 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/greater_equal.py
--rw-r--r--   0 runner    (1001) docker     (123)     2533 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/hypot.py
--rw-r--r--   0 runner    (1001) docker     (123)     3248 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/i0.py
--rw-r--r--   0 runner    (1001) docker     (123)     1780 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/imag.py
--rw-r--r--   0 runner    (1001) docker     (123)     3474 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/invert.py
--rw-r--r--   0 runner    (1001) docker     (123)     4613 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/isclose.py
--rw-r--r--   0 runner    (1001) docker     (123)     1716 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/iscomplex.py
--rw-r--r--   0 runner    (1001) docker     (123)     3606 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/isfinite.py
--rw-r--r--   0 runner    (1001) docker     (123)     3470 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/isinf.py
--rw-r--r--   0 runner    (1001) docker     (123)     2697 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/isnan.py
--rw-r--r--   0 runner    (1001) docker     (123)     1662 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/isreal.py
--rw-r--r--   0 runner    (1001) docker     (123)     3177 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/ldexp.py
--rw-r--r--   0 runner    (1001) docker     (123)     2277 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/less.py
--rw-r--r--   0 runner    (1001) docker     (123)     2305 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/less_equal.py
--rw-r--r--   0 runner    (1001) docker     (123)     3162 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/log.py
--rw-r--r--   0 runner    (1001) docker     (123)     3036 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/log10.py
--rw-r--r--   0 runner    (1001) docker     (123)     3251 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/log1p.py
--rw-r--r--   0 runner    (1001) docker     (123)     2878 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/log2.py
--rw-r--r--   0 runner    (1001) docker     (123)     2741 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/logaddexp.py
--rw-r--r--   0 runner    (1001) docker     (123)     2757 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/logaddexp2.py
--rw-r--r--   0 runner    (1001) docker     (123)     2582 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/logical_and.py
--rw-r--r--   0 runner    (1001) docker     (123)     2355 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/logical_not.py
--rw-r--r--   0 runner    (1001) docker     (123)     2601 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/logical_or.py
--rw-r--r--   0 runner    (1001) docker     (123)     2902 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/logical_xor.py
--rw-r--r--   0 runner    (1001) docker     (123)     2646 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/lshift.py
--rw-r--r--   0 runner    (1001) docker     (123)     3706 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/maximum.py
--rw-r--r--   0 runner    (1001) docker     (123)     3707 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/minimum.py
--rw-r--r--   0 runner    (1001) docker     (123)     3257 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/mod.py
--rw-r--r--   0 runner    (1001) docker     (123)     3959 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/modf.py
--rw-r--r--   0 runner    (1001) docker     (123)     4207 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/multiply.py
--rw-r--r--   0 runner    (1001) docker     (123)     3257 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/nan_to_num.py
--rw-r--r--   0 runner    (1001) docker     (123)     2100 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/negative.py
--rw-r--r--   0 runner    (1001) docker     (123)     2342 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/nextafter.py
--rw-r--r--   0 runner    (1001) docker     (123)     2286 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/not_equal.py
--rw-r--r--   0 runner    (1001) docker     (123)     1328 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/positive.py
--rw-r--r--   0 runner    (1001) docker     (123)     3215 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/power.py
--rw-r--r--   0 runner    (1001) docker     (123)     2114 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/rad2deg.py
--rw-r--r--   0 runner    (1001) docker     (123)     2392 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/radians.py
--rw-r--r--   0 runner    (1001) docker     (123)     1843 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/real.py
--rw-r--r--   0 runner    (1001) docker     (123)     2387 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/reciprocal.py
--rw-r--r--   0 runner    (1001) docker     (123)     2127 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/rint.py
--rw-r--r--   0 runner    (1001) docker     (123)     2567 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/rshift.py
--rw-r--r--   0 runner    (1001) docker     (123)     1479 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/setimag.py
--rw-r--r--   0 runner    (1001) docker     (123)     1479 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/setreal.py
--rw-r--r--   0 runner    (1001) docker     (123)     2563 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/sign.py
--rw-r--r--   0 runner    (1001) docker     (123)     2124 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/signbit.py
--rw-r--r--   0 runner    (1001) docker     (123)     3332 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/sin.py
--rw-r--r--   0 runner    (1001) docker     (123)     3499 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/sinc.py
--rw-r--r--   0 runner    (1001) docker     (123)     2928 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/sinh.py
--rw-r--r--   0 runner    (1001) docker     (123)     2325 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/spacing.py
--rw-r--r--   0 runner    (1001) docker     (123)     2817 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/sqrt.py
--rw-r--r--   0 runner    (1001) docker     (123)     2100 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/square.py
--rw-r--r--   0 runner    (1001) docker     (123)     2507 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/subtract.py
--rw-r--r--   0 runner    (1001) docker     (123)     2855 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/tan.py
--rw-r--r--   0 runner    (1001) docker     (123)     3056 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/tanh.py
--rw-r--r--   0 runner    (1001) docker     (123)     3359 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/truediv.py
--rw-r--r--   0 runner    (1001) docker     (123)     2315 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/trunc.py
--rw-r--r--   0 runner    (1001) docker     (123)     4164 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)     4990 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/array_utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.132851 xorbits-0.2.2/xorbits/_mars/tensor/base/
--rw-r--r--   0 runner    (1001) docker     (123)     2920 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3521 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/argpartition.py
--rw-r--r--   0 runner    (1001) docker     (123)     4582 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/argsort.py
--rw-r--r--   0 runner    (1001) docker     (123)     1430 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/argtopk.py
--rw-r--r--   0 runner    (1001) docker     (123)     3798 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/argwhere.py
--rw-r--r--   0 runner    (1001) docker     (123)     1632 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/array_split.py
--rw-r--r--   0 runner    (1001) docker     (123)     5891 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/astype.py
--rw-r--r--   0 runner    (1001) docker     (123)     1915 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/atleast_1d.py
--rw-r--r--   0 runner    (1001) docker     (123)     2001 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/atleast_2d.py
--rw-r--r--   0 runner    (1001) docker     (123)     2434 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/atleast_3d.py
--rw-r--r--   0 runner    (1001) docker     (123)     1702 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/broadcast_arrays.py
--rw-r--r--   0 runner    (1001) docker     (123)     4792 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/broadcast_to.py
--rw-r--r--   0 runner    (1001) docker     (123)     1823 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/copy.py
--rw-r--r--   0 runner    (1001) docker     (123)     6837 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/copyto.py
--rw-r--r--   0 runner    (1001) docker     (123)     1617 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     8713 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/delete.py
--rw-r--r--   0 runner    (1001) docker     (123)     4136 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/diff.py
--rw-r--r--   0 runner    (1001) docker     (123)     2159 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/dsplit.py
--rw-r--r--   0 runner    (1001) docker     (123)     2135 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/ediff1d.py
--rw-r--r--   0 runner    (1001) docker     (123)     2341 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/expand_dims.py
--rw-r--r--   0 runner    (1001) docker     (123)     1973 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/flatten.py
--rw-r--r--   0 runner    (1001) docker     (123)     2319 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/flip.py
--rw-r--r--   0 runner    (1001) docker     (123)     1788 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/fliplr.py
--rw-r--r--   0 runner    (1001) docker     (123)     1842 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/flipud.py
--rw-r--r--   0 runner    (1001) docker     (123)     2562 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/hsplit.py
--rw-r--r--   0 runner    (1001) docker     (123)     3285 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/in1d.py
--rw-r--r--   0 runner    (1001) docker     (123)    14622 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/insert.py
--rw-r--r--   0 runner    (1001) docker     (123)     7146 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/isin.py
--rw-r--r--   0 runner    (1001) docker     (123)     6724 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/map_chunk.py
--rw-r--r--   0 runner    (1001) docker     (123)     2481 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/moveaxis.py
--rw-r--r--   0 runner    (1001) docker     (123)     1432 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/ndim.py
--rw-r--r--   0 runner    (1001) docker     (123)    27176 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/partition.py
--rw-r--r--   0 runner    (1001) docker     (123)    35081 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/psrs.py
--rw-r--r--   0 runner    (1001) docker     (123)     3170 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/ravel.py
--rw-r--r--   0 runner    (1001) docker     (123)     4111 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/rebalance.py
--rw-r--r--   0 runner    (1001) docker     (123)     7157 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/repeat.py
--rw-r--r--   0 runner    (1001) docker     (123)     3082 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/result_type.py
--rw-r--r--   0 runner    (1001) docker     (123)     3425 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/roll.py
--rw-r--r--   0 runner    (1001) docker     (123)     2268 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/rollaxis.py
--rw-r--r--   0 runner    (1001) docker     (123)    13101 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/searchsorted.py
--rw-r--r--   0 runner    (1001) docker     (123)     1796 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/setdiff1d.py
--rw-r--r--   0 runner    (1001) docker     (123)     3873 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/shape.py
--rw-r--r--   0 runner    (1001) docker     (123)    18354 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/sort.py
--rw-r--r--   0 runner    (1001) docker     (123)     7880 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/split.py
--rw-r--r--   0 runner    (1001) docker     (123)     4982 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/squeeze.py
--rw-r--r--   0 runner    (1001) docker     (123)     4654 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/swapaxes.py
--rw-r--r--   0 runner    (1001) docker     (123)     3202 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/tile.py
--rw-r--r--   0 runner    (1001) docker     (123)     1299 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/to_cpu.py
--rw-r--r--   0 runner    (1001) docker     (123)     1364 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/to_gpu.py
--rw-r--r--   0 runner    (1001) docker     (123)    18738 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/topk.py
--rw-r--r--   0 runner    (1001) docker     (123)     4712 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/transpose.py
--rw-r--r--   0 runner    (1001) docker     (123)     6263 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/trapz.py
--rw-r--r--   0 runner    (1001) docker     (123)    21983 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/unique.py
--rw-r--r--   0 runner    (1001) docker     (123)     2384 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/vsplit.py
--rw-r--r--   0 runner    (1001) docker     (123)     6127 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/base/where.py
--rw-r--r--   0 runner    (1001) docker     (123)    22102 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.136851 xorbits-0.2.2/xorbits/_mars/tensor/datasource/
--rw-r--r--   0 runner    (1001) docker     (123)     1854 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     7339 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/arange.py
--rw-r--r--   0 runner    (1001) docker     (123)    13818 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/array.py
--rw-r--r--   0 runner    (1001) docker     (123)     6313 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     9388 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/diag.py
--rw-r--r--   0 runner    (1001) docker     (123)     2200 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/diagflat.py
--rw-r--r--   0 runner    (1001) docker     (123)     7249 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/empty.py
--rw-r--r--   0 runner    (1001) docker     (123)     4460 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/eye.py
--rw-r--r--   0 runner    (1001) docker     (123)     3826 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_dataframe.py
--rw-r--r--   0 runner    (1001) docker     (123)     2399 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_dense.py
--rw-r--r--   0 runner    (1001) docker     (123)     3202 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_hdf5.py
--rw-r--r--   0 runner    (1001) docker     (123)     2562 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_sparse.py
--rw-r--r--   0 runner    (1001) docker     (123)     6762 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_tiledb.py
--rw-r--r--   0 runner    (1001) docker     (123)     6748 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_vineyard.py
--rw-r--r--   0 runner    (1001) docker     (123)     3196 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_zarr.py
--rw-r--r--   0 runner    (1001) docker     (123)     7841 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/full.py
--rw-r--r--   0 runner    (1001) docker     (123)     1720 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/identity.py
--rw-r--r--   0 runner    (1001) docker     (123)     3845 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/indices.py
--rw-r--r--   0 runner    (1001) docker     (123)     6672 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/linspace.py
--rw-r--r--   0 runner    (1001) docker     (123)     4487 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/meshgrid.py
--rw-r--r--   0 runner    (1001) docker     (123)     6561 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/ones.py
--rw-r--r--   0 runner    (1001) docker     (123)     1894 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/scalar.py
--rw-r--r--   0 runner    (1001) docker     (123)     6261 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/tri.py
--rw-r--r--   0 runner    (1001) docker     (123)     7159 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datasource/zeros.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.136851 xorbits-0.2.2/xorbits/_mars/tensor/datastore/
--rw-r--r--   0 runner    (1001) docker     (123)      936 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datastore/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1930 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datastore/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     7747 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datastore/to_hdf5.py
--rw-r--r--   0 runner    (1001) docker     (123)     8359 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datastore/to_tiledb.py
--rw-r--r--   0 runner    (1001) docker     (123)     6418 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datastore/to_vineyard.py
--rw-r--r--   0 runner    (1001) docker     (123)     5828 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datastore/to_zarr.py
--rw-r--r--   0 runner    (1001) docker     (123)     2232 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/datastore/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.136851 xorbits-0.2.2/xorbits/_mars/tensor/einsum/
--rw-r--r--   0 runner    (1001) docker     (123)      669 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/einsum/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    19871 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/einsum/core.py
--rw-r--r--   0 runner    (1001) docker     (123)    35488 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/einsum/einsumfunc.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.136851 xorbits-0.2.2/xorbits/_mars/tensor/fetch/
--rw-r--r--   0 runner    (1001) docker     (123)      694 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fetch/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2065 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fetch/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.140851 xorbits-0.2.2/xorbits/_mars/tensor/fft/
--rw-r--r--   0 runner    (1001) docker     (123)     1349 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     8303 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     4273 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/fft.py
--rw-r--r--   0 runner    (1001) docker     (123)     4852 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/fft2.py
--rw-r--r--   0 runner    (1001) docker     (123)     4748 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/fftfreq.py
--rw-r--r--   0 runner    (1001) docker     (123)     4933 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/fftn.py
--rw-r--r--   0 runner    (1001) docker     (123)     2644 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/fftshift.py
--rw-r--r--   0 runner    (1001) docker     (123)     4157 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/hfft.py
--rw-r--r--   0 runner    (1001) docker     (123)     4246 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/ifft.py
--rw-r--r--   0 runner    (1001) docker     (123)     4814 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/ifft2.py
--rw-r--r--   0 runner    (1001) docker     (123)     5052 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/ifftn.py
--rw-r--r--   0 runner    (1001) docker     (123)     2370 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/ifftshift.py
--rw-r--r--   0 runner    (1001) docker     (123)     3356 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/ihfft.py
--rw-r--r--   0 runner    (1001) docker     (123)     4760 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/irfft.py
--rw-r--r--   0 runner    (1001) docker     (123)     2090 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/irfft2.py
--rw-r--r--   0 runner    (1001) docker     (123)     4641 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/irfftn.py
--rw-r--r--   0 runner    (1001) docker     (123)     4468 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/rfft.py
--rw-r--r--   0 runner    (1001) docker     (123)     2059 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/rfft2.py
--rw-r--r--   0 runner    (1001) docker     (123)     3833 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/rfftfreq.py
--rw-r--r--   0 runner    (1001) docker     (123)     4415 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fft/rfftn.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.140851 xorbits-0.2.2/xorbits/_mars/tensor/fuse/
--rw-r--r--   0 runner    (1001) docker     (123)      753 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fuse/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)      971 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fuse/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     2631 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fuse/cupy.py
--rw-r--r--   0 runner    (1001) docker     (123)     6226 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/fuse/numexpr.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.140851 xorbits-0.2.2/xorbits/_mars/tensor/images/
--rw-r--r--   0 runner    (1001) docker     (123)      671 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/images/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3890 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/images/imread.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.140851 xorbits-0.2.2/xorbits/_mars/tensor/indexing/
--rw-r--r--   0 runner    (1001) docker     (123)     1658 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     8377 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/choose.py
--rw-r--r--   0 runner    (1001) docker     (123)     4026 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/compress.py
--rw-r--r--   0 runner    (1001) docker     (123)     7164 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     2065 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/extract.py
--rw-r--r--   0 runner    (1001) docker     (123)    14693 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/fill_diagonal.py
--rw-r--r--   0 runner    (1001) docker     (123)     1703 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/flatnonzero.py
--rw-r--r--   0 runner    (1001) docker     (123)    13136 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/getitem.py
--rw-r--r--   0 runner    (1001) docker     (123)    39494 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/index_lib.py
--rw-r--r--   0 runner    (1001) docker     (123)     4455 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/nonzero.py
--rw-r--r--   0 runner    (1001) docker     (123)    13308 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/setitem.py
--rw-r--r--   0 runner    (1001) docker     (123)     2344 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/slice.py
--rw-r--r--   0 runner    (1001) docker     (123)     4251 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/take.py
--rw-r--r--   0 runner    (1001) docker     (123)     4786 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/indexing/unravel_index.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.140851 xorbits-0.2.2/xorbits/_mars/tensor/lib/
--rw-r--r--   0 runner    (1001) docker     (123)      705 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/lib/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    17238 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/lib/index_tricks.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.140851 xorbits-0.2.2/xorbits/_mars/tensor/linalg/
--rw-r--r--   0 runner    (1001) docker     (123)     1414 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    11687 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/cholesky.py
--rw-r--r--   0 runner    (1001) docker     (123)    11285 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     5276 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/dot.py
--rw-r--r--   0 runner    (1001) docker     (123)     1186 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/inner.py
--rw-r--r--   0 runner    (1001) docker     (123)     4942 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/inv.py
--rw-r--r--   0 runner    (1001) docker     (123)    20088 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/lu.py
--rw-r--r--   0 runner    (1001) docker     (123)    11180 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/matmul.py
--rw-r--r--   0 runner    (1001) docker     (123)    11539 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/norm.py
--rw-r--r--   0 runner    (1001) docker     (123)     6046 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/qr.py
--rw-r--r--   0 runner    (1001) docker     (123)     9155 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/randomized_svd.py
--rw-r--r--   0 runner    (1001) docker     (123)     2139 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/solve.py
--rw-r--r--   0 runner    (1001) docker     (123)     8182 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/solve_triangular.py
--rw-r--r--   0 runner    (1001) docker     (123)     8679 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/svd.py
--rw-r--r--   0 runner    (1001) docker     (123)    11693 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/tensordot.py
--rw-r--r--   0 runner    (1001) docker     (123)     2652 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)     2292 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/linalg/vdot.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.144852 xorbits-0.2.2/xorbits/_mars/tensor/merge/
--rw-r--r--   0 runner    (1001) docker     (123)      939 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/merge/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2509 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/merge/append.py
--rw-r--r--   0 runner    (1001) docker     (123)    17065 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/merge/block.py
--rw-r--r--   0 runner    (1001) docker     (123)     1779 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/merge/column_stack.py
--rw-r--r--   0 runner    (1001) docker     (123)    10643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/merge/concatenate.py
--rw-r--r--   0 runner    (1001) docker     (123)     2388 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/merge/dstack.py
--rw-r--r--   0 runner    (1001) docker     (123)     2400 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/merge/hstack.py
--rw-r--r--   0 runner    (1001) docker     (123)     7235 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/merge/stack.py
--rw-r--r--   0 runner    (1001) docker     (123)     1768 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/merge/union1d.py
--rw-r--r--   0 runner    (1001) docker     (123)     2471 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/merge/vstack.py
--rw-r--r--   0 runner    (1001) docker     (123)     3668 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/operands.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.148852 xorbits-0.2.2/xorbits/_mars/tensor/random/
--rw-r--r--   0 runner    (1001) docker     (123)     7012 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3175 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/beta.py
--rw-r--r--   0 runner    (1001) docker     (123)     5303 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/binomial.py
--rw-r--r--   0 runner    (1001) docker     (123)     1051 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/bytes.py
--rw-r--r--   0 runner    (1001) docker     (123)     3766 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/chisquare.py
--rw-r--r--   0 runner    (1001) docker     (123)    13246 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/choice.py
--rw-r--r--   0 runner    (1001) docker     (123)    13974 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     5518 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/dirichlet.py
--rw-r--r--   0 runner    (1001) docker     (123)     3599 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/exponential.py
--rw-r--r--   0 runner    (1001) docker     (123)     5103 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/f.py
--rw-r--r--   0 runner    (1001) docker     (123)     4631 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/gamma.py
--rw-r--r--   0 runner    (1001) docker     (123)     3362 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/geometric.py
--rw-r--r--   0 runner    (1001) docker     (123)     6333 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/gumbel.py
--rw-r--r--   0 runner    (1001) docker     (123)     5645 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/hypergeometric.py
--rw-r--r--   0 runner    (1001) docker     (123)     5019 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/laplace.py
--rw-r--r--   0 runner    (1001) docker     (123)     4740 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/logistic.py
--rw-r--r--   0 runner    (1001) docker     (123)     6067 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/lognormal.py
--rw-r--r--   0 runner    (1001) docker     (123)     4449 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/logseries.py
--rw-r--r--   0 runner    (1001) docker     (123)     4783 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/multinomial.py
--rw-r--r--   0 runner    (1001) docker     (123)     9503 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/multivariate_normal.py
--rw-r--r--   0 runner    (1001) docker     (123)     4851 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/negative_binomial.py
--rw-r--r--   0 runner    (1001) docker     (123)     4949 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/noncentral_chisquare.py
--rw-r--r--   0 runner    (1001) docker     (123)     5022 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/noncentral_f.py
--rw-r--r--   0 runner    (1001) docker     (123)     5221 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/normal.py
--rw-r--r--   0 runner    (1001) docker     (123)     5401 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/pareto.py
--rw-r--r--   0 runner    (1001) docker     (123)     8574 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/permutation.py
--rw-r--r--   0 runner    (1001) docker     (123)     3898 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/poisson.py
--rw-r--r--   0 runner    (1001) docker     (123)     4857 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/power.py
--rw-r--r--   0 runner    (1001) docker     (123)     2550 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/rand.py
--rw-r--r--   0 runner    (1001) docker     (123)     6024 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/randint.py
--rw-r--r--   0 runner    (1001) docker     (123)     3353 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/randn.py
--rw-r--r--   0 runner    (1001) docker     (123)     4372 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/random_integers.py
--rw-r--r--   0 runner    (1001) docker     (123)     3017 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/random_sample.py
--rw-r--r--   0 runner    (1001) docker     (123)     3968 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/rayleigh.py
--rw-r--r--   0 runner    (1001) docker     (123)     1805 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/shuffle.py
--rw-r--r--   0 runner    (1001) docker     (123)     3873 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/standard_cauchy.py
--rw-r--r--   0 runner    (1001) docker     (123)     2450 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/standard_exponential.py
--rw-r--r--   0 runner    (1001) docker     (123)     4261 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/standard_gamma.py
--rw-r--r--   0 runner    (1001) docker     (123)     2565 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/standard_normal.py
--rw-r--r--   0 runner    (1001) docker     (123)     4931 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/standard_t.py
--rw-r--r--   0 runner    (1001) docker     (123)     4360 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/triangular.py
--rw-r--r--   0 runner    (1001) docker     (123)     4711 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/uniform.py
--rw-r--r--   0 runner    (1001) docker     (123)     4811 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/vonmises.py
--rw-r--r--   0 runner    (1001) docker     (123)     4382 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/wald.py
--rw-r--r--   0 runner    (1001) docker     (123)     4907 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/weibull.py
--rw-r--r--   0 runner    (1001) docker     (123)     4103 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/random/zipf.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.148852 xorbits-0.2.2/xorbits/_mars/tensor/rechunk/
--rw-r--r--   0 runner    (1001) docker     (123)      844 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/rechunk/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4096 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/rechunk/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     4317 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/rechunk/rechunk.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.152852 xorbits-0.2.2/xorbits/_mars/tensor/reduction/
--rw-r--r--   0 runner    (1001) docker     (123)     2319 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3905 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/all.py
--rw-r--r--   0 runner    (1001) docker     (123)     2939 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/allclose.py
--rw-r--r--   0 runner    (1001) docker     (123)     4009 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/any.py
--rw-r--r--   0 runner    (1001) docker     (123)     3664 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/argmax.py
--rw-r--r--   0 runner    (1001) docker     (123)     3654 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/argmin.py
--rw-r--r--   0 runner    (1001) docker     (123)     1792 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/array_equal.py
--rw-r--r--   0 runner    (1001) docker     (123)    22582 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     4201 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/count_nonzero.py
--rw-r--r--   0 runner    (1001) docker     (123)     3414 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/cumprod.py
--rw-r--r--   0 runner    (1001) docker     (123)     3617 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/cumsum.py
--rw-r--r--   0 runner    (1001) docker     (123)     4431 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/max.py
--rw-r--r--   0 runner    (1001) docker     (123)     7075 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/mean.py
--rw-r--r--   0 runner    (1001) docker     (123)     4432 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/min.py
--rw-r--r--   0 runner    (1001) docker     (123)     3139 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanargmax.py
--rw-r--r--   0 runner    (1001) docker     (123)     2862 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanargmin.py
--rw-r--r--   0 runner    (1001) docker     (123)     3369 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/nancumprod.py
--rw-r--r--   0 runner    (1001) docker     (123)     3515 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/nancumsum.py
--rw-r--r--   0 runner    (1001) docker     (123)     4398 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanmax.py
--rw-r--r--   0 runner    (1001) docker     (123)     6233 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanmean.py
--rw-r--r--   0 runner    (1001) docker     (123)     4395 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanmin.py
--rw-r--r--   0 runner    (1001) docker     (123)     3766 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanprod.py
--rw-r--r--   0 runner    (1001) docker     (123)     5025 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanstd.py
--rw-r--r--   0 runner    (1001) docker     (123)     4518 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/nansum.py
--rw-r--r--   0 runner    (1001) docker     (123)    10173 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanvar.py
--rw-r--r--   0 runner    (1001) docker     (123)     4858 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/prod.py
--rw-r--r--   0 runner    (1001) docker     (123)     5263 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/std.py
--rw-r--r--   0 runner    (1001) docker     (123)     4684 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/sum.py
--rw-r--r--   0 runner    (1001) docker     (123)    10886 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reduction/var.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.152852 xorbits-0.2.2/xorbits/_mars/tensor/reshape/
--rw-r--r--   0 runner    (1001) docker     (123)      673 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reshape/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    22819 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/reshape/reshape.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.152852 xorbits-0.2.2/xorbits/_mars/tensor/spatial/
--rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/spatial/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.152852 xorbits-0.2.2/xorbits/_mars/tensor/spatial/distance/
--rw-r--r--   0 runner    (1001) docker     (123)      729 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/spatial/distance/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    18180 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/spatial/distance/cdist.py
--rw-r--r--   0 runner    (1001) docker     (123)    23831 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/spatial/distance/pdist.py
--rw-r--r--   0 runner    (1001) docker     (123)    15765 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/spatial/distance/squareform.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.152852 xorbits-0.2.2/xorbits/_mars/tensor/special/
--rw-r--r--   0 runner    (1001) docker     (123)     3757 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/special/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1619 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/special/airy.py
--rw-r--r--   0 runner    (1001) docker     (123)     4633 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/special/bessel.py
--rw-r--r--   0 runner    (1001) docker     (123)     1217 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/special/convenience.py
--rw-r--r--   0 runner    (1001) docker     (123)     5432 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/special/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     4024 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/special/ellip_func_integrals.py
--rw-r--r--   0 runner    (1001) docker     (123)     1746 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/special/ellip_harm.py
--rw-r--r--   0 runner    (1001) docker     (123)     5922 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/special/err_fresnel.py
--rw-r--r--   0 runner    (1001) docker     (123)     7826 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/special/gamma_funcs.py
--rw-r--r--   0 runner    (1001) docker     (123)     2001 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/special/hypergeometric_funcs.py
--rw-r--r--   0 runner    (1001) docker     (123)     5031 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/special/info_theory.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/_mars/tensor/statistics/
--rw-r--r--   0 runner    (1001) docker     (123)     1191 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/statistics/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     5099 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/statistics/average.py
--rw-r--r--   0 runner    (1001) docker     (123)    11032 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/statistics/bincount.py
--rw-r--r--   0 runner    (1001) docker     (123)     2298 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/statistics/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     2805 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/statistics/corrcoef.py
--rw-r--r--   0 runner    (1001) docker     (123)     7653 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/statistics/cov.py
--rw-r--r--   0 runner    (1001) docker     (123)     6061 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/statistics/digitize.py
--rw-r--r--   0 runner    (1001) docker     (123)    34980 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/statistics/histogram.py
--rw-r--r--   0 runner    (1001) docker     (123)     3146 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/statistics/median.py
--rw-r--r--   0 runner    (1001) docker     (123)     6086 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/statistics/percentile.py
--rw-r--r--   0 runner    (1001) docker     (123)     2814 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/statistics/ptp.py
--rw-r--r--   0 runner    (1001) docker     (123)    17626 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/statistics/quantile.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/_mars/tensor/stats/
--rw-r--r--   0 runner    (1001) docker     (123)      894 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/stats/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4948 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/stats/chisquare.py
--rw-r--r--   0 runner    (1001) docker     (123)     1526 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/stats/entropy.py
--rw-r--r--   0 runner    (1001) docker     (123)    24448 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/stats/ks.py
--rw-r--r--   0 runner    (1001) docker     (123)     9589 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/stats/power_divergence.py
--rw-r--r--   0 runner    (1001) docker     (123)     4419 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/stats/rankdata.py
--rw-r--r--   0 runner    (1001) docker     (123)     5540 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/stats/ttest.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/_mars/tensor/ufunc/
--rw-r--r--   0 runner    (1001) docker     (123)      796 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/ufunc/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     7183 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/ufunc/ufunc.py
--rw-r--r--   0 runner    (1001) docker     (123)    26724 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/tensor/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)     1596 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/typing.py
--rw-r--r--   0 runner    (1001) docker     (123)    54563 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)      825 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/_mars/worker.py
--rw-r--r--   0 runner    (1001) docker     (123)      497 2023-04-03 04:21:33.164852 xorbits-0.2.2/xorbits/_version.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/compat/
--rw-r--r--   0 runner    (1001) docker     (123)      581 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/compat/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)      745 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/compat/_constants.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/core/
--rw-r--r--   0 runner    (1001) docker     (123)      664 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/core/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    14086 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/core/adapter.py
--rw-r--r--   0 runner    (1001) docker     (123)     3042 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/core/api.py
--rw-r--r--   0 runner    (1001) docker     (123)     9027 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/core/data.py
--rw-r--r--   0 runner    (1001) docker     (123)     3462 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/core/execution.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/core/utils/
--rw-r--r--   0 runner    (1001) docker     (123)      581 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/core/utils/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    11364 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/core/utils/docstring.py
--rw-r--r--   0 runner    (1001) docker     (123)     2545 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/core/utils/fallback.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/deploy/
--rw-r--r--   0 runner    (1001) docker     (123)     5065 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/deploy/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/deploy/kubernetes/
--rw-r--r--   0 runner    (1001) docker     (123)      639 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/deploy/kubernetes/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)      628 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/deploy/kubernetes/_constants.py
--rw-r--r--   0 runner    (1001) docker     (123)    23910 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/deploy/kubernetes/client.py
--rw-r--r--   0 runner    (1001) docker     (123)    28192 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/deploy/kubernetes/config.py
--rw-r--r--   0 runner    (1001) docker     (123)       85 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/deploy/kubernetes/config.yml
--rw-r--r--   0 runner    (1001) docker     (123)     8020 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/deploy/kubernetes/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     1127 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/deploy/kubernetes/supervisor.py
--rw-r--r--   0 runner    (1001) docker     (123)     1730 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/deploy/kubernetes/worker.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/deploy/oscar/
--rw-r--r--   0 runner    (1001) docker     (123)     2078 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/deploy/oscar/file-logging.conf
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/numpy/
--rw-r--r--   0 runner    (1001) docker     (123)     3403 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/numpy/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)      886 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/numpy/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/numpy/fft/
--rw-r--r--   0 runner    (1001) docker     (123)     1925 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/numpy/fft/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/numpy/lib/
--rw-r--r--   0 runner    (1001) docker     (123)      609 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/numpy/lib/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1828 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/numpy/lib/index_tricks.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.156852 xorbits-0.2.2/xorbits/numpy/linalg/
--rw-r--r--   0 runner    (1001) docker     (123)     2001 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/numpy/linalg/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.160852 xorbits-0.2.2/xorbits/numpy/mars_adapters/
--rw-r--r--   0 runner    (1001) docker     (123)     1280 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/numpy/mars_adapters/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3035 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/numpy/mars_adapters/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     1101 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/numpy/mars_adapters/flatiter.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.160852 xorbits-0.2.2/xorbits/numpy/numpy_adapters/
--rw-r--r--   0 runner    (1001) docker     (123)      629 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/numpy/numpy_adapters/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4192 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/numpy/numpy_adapters/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.160852 xorbits-0.2.2/xorbits/numpy/random/
--rw-r--r--   0 runner    (1001) docker     (123)     2000 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/numpy/random/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.160852 xorbits-0.2.2/xorbits/pandas/
--rw-r--r--   0 runner    (1001) docker     (123)     1959 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/pandas/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2432 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/pandas/accessors.py
--rw-r--r--   0 runner    (1001) docker     (123)     2915 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/pandas/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     1214 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/pandas/groupby.py
--rw-r--r--   0 runner    (1001) docker     (123)     1612 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/pandas/indexing.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.160852 xorbits-0.2.2/xorbits/pandas/mars_adapters/
--rw-r--r--   0 runner    (1001) docker     (123)     4490 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/pandas/mars_adapters/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     6630 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/pandas/mars_adapters/core.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.160852 xorbits-0.2.2/xorbits/pandas/pandas_adapters/
--rw-r--r--   0 runner    (1001) docker     (123)      906 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/pandas/pandas_adapters/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     8001 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/pandas/pandas_adapters/core.py
--rw-r--r--   0 runner    (1001) docker     (123)     1421 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/pandas/plotting.py
--rw-r--r--   0 runner    (1001) docker     (123)     1779 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/pandas/window.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.160852 xorbits-0.2.2/xorbits/remote/
--rw-r--r--   0 runner    (1001) docker     (123)      615 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/remote/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.160852 xorbits-0.2.2/xorbits/remote/mars_adapters/
--rw-r--r--   0 runner    (1001) docker     (123)      606 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/remote/mars_adapters/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3680 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/remote/mars_adapters/core.py
--rw-r--r--   0 runner    (1001) docker     (123)      656 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/supervisor.py
--rw-r--r--   0 runner    (1001) docker     (123)     1937 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.160852 xorbits-0.2.2/xorbits/web/
--rw-r--r--   0 runner    (1001) docker     (123)     1084 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/web/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1034 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/web/index_handler.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.160852 xorbits-0.2.2/xorbits/web/ui/
--rw-r--r--   0 runner    (1001) docker     (123)      416 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/web/ui/.eslintrc.yml
--rw-r--r--   0 runner    (1001) docker     (123)      144 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/web/ui/.prettierrc.yml
--rw-r--r--   0 runner    (1001) docker     (123)     1234 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/web/ui/index.html
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.164852 xorbits-0.2.2/xorbits/web/ui/static/
--rw-r--r--   0 runner    (1001) docker     (123)   397889 2023-04-03 04:20:12.000000 xorbits-0.2.2/xorbits/web/ui/static/546.bundle.js
--rw-r--r--   0 runner    (1001) docker     (123)     1136 2023-04-03 04:20:12.000000 xorbits-0.2.2/xorbits/web/ui/static/546.bundle.js.LICENSE.txt
--rw-r--r--   0 runner    (1001) docker     (123)   355116 2023-04-03 04:20:12.000000 xorbits-0.2.2/xorbits/web/ui/static/601.bundle.js
--rw-r--r--   0 runner    (1001) docker     (123)      485 2023-04-03 04:20:12.000000 xorbits-0.2.2/xorbits/web/ui/static/601.bundle.js.LICENSE.txt
--rw-r--r--   0 runner    (1001) docker     (123)    12840 2023-04-03 04:20:12.000000 xorbits-0.2.2/xorbits/web/ui/static/615.bundle.js
--rw-r--r--   0 runner    (1001) docker     (123)    18581 2023-04-03 04:20:12.000000 xorbits-0.2.2/xorbits/web/ui/static/701.bundle.js
--rw-r--r--   0 runner    (1001) docker     (123)   481975 2023-04-03 04:20:12.000000 xorbits-0.2.2/xorbits/web/ui/static/bundle.js
--rw-r--r--   0 runner    (1001) docker     (123)     1857 2023-04-03 04:20:12.000000 xorbits-0.2.2/xorbits/web/ui/static/bundle.js.LICENSE.txt
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.044847 xorbits-0.2.2/xorbits/web/ui/static/resources/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.044847 xorbits-0.2.2/xorbits/web/ui/static/resources/assets/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.164852 xorbits-0.2.2/xorbits/web/ui/static/resources/assets/images/
--rw-r--r--   0 runner    (1001) docker     (123)     1893 2023-04-03 04:20:12.000000 xorbits-0.2.2/xorbits/web/ui/static/resources/assets/images/favicon.svg
--rw-r--r--   0 runner    (1001) docker     (123)     2731 2023-04-03 04:20:12.000000 xorbits-0.2.2/xorbits/web/ui/static/resources/assets/images/xorbits.svg
--rw-r--r--   0 runner    (1001) docker     (123)      862 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/web/version_handler.py
--rw-r--r--   0 runner    (1001) docker     (123)      652 2023-04-03 04:18:39.000000 xorbits-0.2.2/xorbits/worker.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 04:21:33.048847 xorbits-0.2.2/xorbits.egg-info/
--rw-r--r--   0 runner    (1001) docker     (123)     9363 2023-04-03 04:21:31.000000 xorbits-0.2.2/xorbits.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)    46007 2023-04-03 04:21:33.000000 xorbits-0.2.2/xorbits.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-04-03 04:21:31.000000 xorbits-0.2.2/xorbits.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (123)      100 2023-04-03 04:21:31.000000 xorbits-0.2.2/xorbits.egg-info/entry_points.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-04-03 04:20:47.000000 xorbits-0.2.2/xorbits.egg-info/not-zip-safe
--rw-r--r--   0 runner    (1001) docker     (123)      899 2023-04-03 04:21:31.000000 xorbits-0.2.2/xorbits.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (123)        8 2023-04-03 04:21:31.000000 xorbits-0.2.2/xorbits.egg-info/top_level.txt
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.806924 xorbits-0.3.0/
+-rw-r--r--   0 runner    (1001) docker     (123)      487 2023-04-28 11:43:56.000000 xorbits-0.3.0/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (123)     9512 2023-04-28 11:46:04.806924 xorbits-0.3.0/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     1577 2023-04-28 11:43:56.000000 xorbits-0.3.0/pyproject.toml
+-rw-r--r--   0 runner    (1001) docker     (123)     4384 2023-04-28 11:46:04.806924 xorbits-0.3.0/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (123)     7198 2023-04-28 11:43:56.000000 xorbits-0.3.0/setup.py
+-rw-r--r--   0 runner    (1001) docker     (123)    83196 2023-04-28 11:43:56.000000 xorbits-0.3.0/versioneer.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.806924 xorbits-0.3.0/xorbits/
+-rw-r--r--   0 runner    (1001) docker     (123)     1001 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.722925 xorbits-0.3.0/xorbits/_mars/
+-rw-r--r--   0 runner    (1001) docker     (123)     1005 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2443 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/_resource.pyx
+-rw-r--r--   0 runner    (1001) docker     (123)      720 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/_utils.pxd
+-rw-r--r--   0 runner    (1001) docker     (123)    11626 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/_utils.pyx
+-rw-r--r--   0 runner    (1001) docker     (123)    23710 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/_version.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13421 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/config.py
+-rw-r--r--   0 runner    (1001) docker     (123)       45 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/config.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      978 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/constants.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.722925 xorbits-0.3.0/xorbits/_mars/contrib/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/contrib/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.722925 xorbits-0.3.0/xorbits/_mars/contrib/dask/
+-rw-r--r--   0 runner    (1001) docker     (123)      936 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/contrib/dask/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1859 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/contrib/dask/converter.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3518 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/contrib/dask/scheduler.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2048 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/contrib/dask/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.722925 xorbits-0.3.0/xorbits/_mars/core/
+-rw-r--r--   0 runner    (1001) docker     (123)     1752 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4375 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/base.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7114 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/context.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5649 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/custom_log.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.722925 xorbits-0.3.0/xorbits/_mars/core/entity/
+-rw-r--r--   0 runner    (1001) docker     (123)     1400 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/entity/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2179 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/entity/chunks.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4068 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/entity/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11156 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/entity/executable.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2324 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/entity/fuse.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3083 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/entity/objects.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3013 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/entity/output_types.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14913 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/entity/tileables.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3402 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/entity/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1702 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/entrypoints.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.722925 xorbits-0.3.0/xorbits/_mars/core/graph/
+-rw-r--r--   0 runner    (1001) docker     (123)      851 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/graph/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.722925 xorbits-0.3.0/xorbits/_mars/core/graph/builder/
+-rw-r--r--   0 runner    (1001) docker     (123)      749 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/graph/builder/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2595 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/graph/builder/base.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16231 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/graph/builder/chunk.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1277 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/graph/builder/tileable.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1570 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/graph/builder/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    15725 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/graph/core.pyx
+-rw-r--r--   0 runner    (1001) docker     (123)     5564 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/graph/entity.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3043 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/mode.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.722925 xorbits-0.3.0/xorbits/_mars/core/operand/
+-rw-r--r--   0 runner    (1001) docker     (123)     1167 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/operand/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13138 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/operand/base.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17686 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/operand/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1792 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/operand/fetch.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1307 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/operand/fuse.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2654 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/operand/objects.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5727 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/core/operand/shuffle.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.722925 xorbits-0.3.0/xorbits/_mars/dataframe/
+-rw-r--r--   0 runner    (1001) docker     (123)     3047 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    38074 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/align.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.726925 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/
+-rw-r--r--   0 runner    (1001) docker     (123)    12350 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1047 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/abs.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1770 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/add.py
+-rw-r--r--   0 runner    (1001) docker     (123)      994 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/arccos.py
+-rw-r--r--   0 runner    (1001) docker     (123)      999 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/arccosh.py
+-rw-r--r--   0 runner    (1001) docker     (123)      994 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/arcsin.py
+-rw-r--r--   0 runner    (1001) docker     (123)      999 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/arcsinh.py
+-rw-r--r--   0 runner    (1001) docker     (123)      994 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/arctan.py
+-rw-r--r--   0 runner    (1001) docker     (123)      999 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/arctanh.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4649 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/around.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1491 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/bitwise_and.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2239 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/bitwise_or.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1490 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/bitwise_xor.py
+-rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/ceil.py
+-rw-r--r--   0 runner    (1001) docker     (123)    31804 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)      979 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/cos.py
+-rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/cosh.py
+-rw-r--r--   0 runner    (1001) docker     (123)      999 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/degrees.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12554 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/docstring.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9694 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/dot.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1527 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/equal.py
+-rw-r--r--   0 runner    (1001) docker     (123)      979 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/exp.py
+-rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/exp2.py
+-rw-r--r--   0 runner    (1001) docker     (123)      989 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/expm1.py
+-rw-r--r--   0 runner    (1001) docker     (123)      989 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/floor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1891 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/floordiv.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1557 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/greater.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1582 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/greater_equal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1049 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/invert.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1806 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/is_ufuncs.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1542 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/less.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1567 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/less_equal.py
+-rw-r--r--   0 runner    (1001) docker     (123)      979 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/log.py
+-rw-r--r--   0 runner    (1001) docker     (123)      989 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/log10.py
+-rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/log2.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1766 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/mod.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1797 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/multiply.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1071 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/negative.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1543 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/not_equal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1875 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/power.py
+-rw-r--r--   0 runner    (1001) docker     (123)      999 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/radians.py
+-rw-r--r--   0 runner    (1001) docker     (123)      979 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/sin.py
+-rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/sinh.py
+-rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/sqrt.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1844 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/subtract.py
+-rw-r--r--   0 runner    (1001) docker     (123)      979 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/tan.py
+-rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/tanh.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1872 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/truediv.py
+-rw-r--r--   0 runner    (1001) docker     (123)    28791 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/arrays.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.730924 xorbits-0.3.0/xorbits/_mars/dataframe/base/
+-rw-r--r--   0 runner    (1001) docker     (123)     6006 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    15056 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/_duplicate.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10091 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/accessor.py
+-rw-r--r--   0 runner    (1001) docker     (123)    29655 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/apply.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14553 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/astype.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10464 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/bloom_filter.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9487 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/cartesian_chunk.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5283 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/check_monotonic.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2188 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)    21345 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/cut.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4481 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/datetimes.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9286 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/describe.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8693 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/diff.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16542 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/drop.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14040 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/drop_duplicates.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17338 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/duplicated.py
+-rw-r--r--   0 runner    (1001) docker     (123)    27235 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/eval.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6459 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/explode.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13280 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/get_dummies.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14330 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/isin.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10224 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/map.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12851 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/map_chunk.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7314 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/melt.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16959 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/memory_usage.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4629 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/pct_change.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3780 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/qcut.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3267 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/rebalance.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8052 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/rechunk.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3187 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/select_dtypes.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18171 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/shift.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10392 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/stack.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/standardize_range_index.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14951 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/string_.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1334 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/to_cpu.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1450 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/to_gpu.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7824 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/to_numeric.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17446 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/transform.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4724 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/transpose.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9677 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/base/value_counts.py
+-rw-r--r--   0 runner    (1001) docker     (123)   101711 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.734924 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8560 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4672 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/dataframe.py
+-rw-r--r--   0 runner    (1001) docker     (123)    20750 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/date_range.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3335 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/from_index.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5932 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/from_records.py
+-rw-r--r--   0 runner    (1001) docker     (123)    27456 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/from_tensor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9329 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/from_vineyard.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9990 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/index.py
+-rw-r--r--   0 runner    (1001) docker     (123)    33386 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/read_csv.py
+-rw-r--r--   0 runner    (1001) docker     (123)    26363 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/read_parquet.py
+-rw-r--r--   0 runner    (1001) docker     (123)    34972 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/read_sql.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3768 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/series.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1220 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datasource/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.734924 xorbits-0.3.0/xorbits/_mars/dataframe/datastore/
+-rw-r--r--   0 runner    (1001) docker     (123)     1197 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datastore/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18915 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datastore/to_csv.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8702 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datastore/to_parquet.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12137 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datastore/to_sql.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6801 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/datastore/to_vineyard.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.734924 xorbits-0.3.0/xorbits/_mars/dataframe/fetch/
+-rw-r--r--   0 runner    (1001) docker     (123)      700 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/fetch/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3746 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/fetch/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.734924 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/
+-rw-r--r--   0 runner    (1001) docker     (123)     3596 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    49034 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/aggregation.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13267 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/apply.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18443 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6403 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/cum.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2254 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/custom_aggregation.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7312 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/fill.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4889 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/getitem.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7871 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/head.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5703 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/nunique.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22167 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/sample.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5382 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/sort.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12518 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/groupby/transform.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.734924 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/
+-rw-r--r--   0 runner    (1001) docker     (123)     3312 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3009 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/add_prefix_suffix.py
+-rw-r--r--   0 runner    (1001) docker     (123)    19726 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/align.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2260 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/at.py
+-rw-r--r--   0 runner    (1001) docker     (123)    25306 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/getitem.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1174 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/iat.py
+-rw-r--r--   0 runner    (1001) docker     (123)    27507 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/iloc.py
+-rw-r--r--   0 runner    (1001) docker     (123)    45723 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/index_lib.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6270 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/insert.py
+-rw-r--r--   0 runner    (1001) docker     (123)    20269 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/loc.py
+-rw-r--r--   0 runner    (1001) docker     (123)    32392 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/reindex.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16285 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/rename.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8480 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/rename_axis.py
+-rw-r--r--   0 runner    (1001) docker     (123)    20487 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/reset_index.py
+-rw-r--r--   0 runner    (1001) docker     (123)    21722 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/sample.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9110 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/set_axis.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7238 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/set_index.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13222 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/setitem.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1790 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12023 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/indexing/where.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9563 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/initializer.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.738924 xorbits-0.3.0/xorbits/_mars/dataframe/merge/
+-rw-r--r--   0 runner    (1001) docker     (123)     1100 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/merge/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8476 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/merge/append.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22331 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/merge/concat.py
+-rw-r--r--   0 runner    (1001) docker     (123)    52510 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/merge/merge.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.738924 xorbits-0.3.0/xorbits/_mars/dataframe/missing/
+-rw-r--r--   0 runner    (1001) docker     (123)     1780 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/missing/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9113 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/missing/checkna.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13659 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/missing/dropna.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22344 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/missing/fillna.py
+-rw-r--r--   0 runner    (1001) docker     (123)    19567 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/missing/replace.py
+-rw-r--r--   0 runner    (1001) docker     (123)    15685 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/operands.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.738924 xorbits-0.3.0/xorbits/_mars/dataframe/plotting/
+-rw-r--r--   0 runner    (1001) docker     (123)     1173 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/plotting/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2294 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/plotting/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.738924 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/
+-rw-r--r--   0 runner    (1001) docker     (123)     4259 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    42568 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/aggregation.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3767 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/all.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3771 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/any.py
+-rw-r--r--   0 runner    (1001) docker     (123)    43493 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2187 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/count.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1199 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/cummax.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1199 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/cummin.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1204 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/cumprod.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1199 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/cumsum.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1621 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/custom_reduction.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3433 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/kurtosis.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2146 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/max.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2004 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/mean.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2146 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/min.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7539 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/nunique.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2430 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/prod.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1182 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/reduction_size.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2378 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/sem.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3035 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/skew.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1528 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/std.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1908 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/str_concat.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2430 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/sum.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3232 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/unique.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2523 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/reduction/var.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.738924 xorbits-0.3.0/xorbits/_mars/dataframe/sort/
+-rw-r--r--   0 runner    (1001) docker     (123)     1207 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/sort/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4491 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/sort/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)    25930 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/sort/psrs.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9239 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/sort/sort_index.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11808 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/sort/sort_values.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.738924 xorbits-0.3.0/xorbits/_mars/dataframe/statistics/
+-rw-r--r--   0 runner    (1001) docker     (123)     1172 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/statistics/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    15262 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/statistics/corr.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16588 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/statistics/quantile.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.738924 xorbits-0.3.0/xorbits/_mars/dataframe/tseries/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/tseries/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13620 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/tseries/to_datetime.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.738924 xorbits-0.3.0/xorbits/_mars/dataframe/ufunc/
+-rw-r--r--   0 runner    (1001) docker     (123)      936 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/ufunc/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1665 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/ufunc/tensor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1695 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/ufunc/ufunc.py
+-rw-r--r--   0 runner    (1001) docker     (123)    52614 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.742925 xorbits-0.3.0/xorbits/_mars/dataframe/window/
+-rw-r--r--   0 runner    (1001) docker     (123)     1139 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/window/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22363 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/window/aggregation.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2427 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/window/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.742925 xorbits-0.3.0/xorbits/_mars/dataframe/window/ewm/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/window/ewm/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    15579 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/window/ewm/aggregation.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8515 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/window/ewm/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.742925 xorbits-0.3.0/xorbits/_mars/dataframe/window/expanding/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/window/expanding/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6046 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/window/expanding/aggregation.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3867 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/window/expanding/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.742925 xorbits-0.3.0/xorbits/_mars/dataframe/window/rolling/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/window/rolling/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17656 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/window/rolling/aggregation.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10462 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/dataframe/window/rolling/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.742925 xorbits-0.3.0/xorbits/_mars/deploy/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.742925 xorbits-0.3.0/xorbits/_mars/deploy/kubedl/
+-rw-r--r--   0 runner    (1001) docker     (123)      697 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/kubedl/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12305 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/kubedl/client.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8047 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/kubedl/config.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.742925 xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/
+-rw-r--r--   0 runner    (1001) docker     (123)      701 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17451 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/client.py
+-rw-r--r--   0 runner    (1001) docker     (123)    19856 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/config.py
+-rw-r--r--   0 runner    (1001) docker     (123)      124 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/config.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     7875 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1145 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/supervisor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1759 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/worker.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.742925 xorbits-0.3.0/xorbits/_mars/deploy/oscar/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/oscar/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2572 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/oscar/base_config.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     8297 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/oscar/cmdline.py
+-rw-r--r--   0 runner    (1001) docker     (123)       66 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/oscar/config.yml
+-rw-r--r--   0 runner    (1001) docker     (123)    15303 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/oscar/local.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12279 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/oscar/pool.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3557 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/oscar/service.py
+-rw-r--r--   0 runner    (1001) docker     (123)    59951 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/oscar/session.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3765 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/oscar/supervisor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4952 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/oscar/worker.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7792 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.742925 xorbits-0.3.0/xorbits/_mars/deploy/yarn/
+-rw-r--r--   0 runner    (1001) docker     (123)      695 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/yarn/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7611 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/yarn/client.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9848 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/yarn/config.py
+-rw-r--r--   0 runner    (1001) docker     (123)       58 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/yarn/config.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     7167 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/yarn/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1582 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/yarn/supervisor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1722 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/deploy/yarn/worker.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.742925 xorbits-0.3.0/xorbits/_mars/learn/
+-rw-r--r--   0 runner    (1001) docker     (123)     1093 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6817 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/base.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.746924 xorbits-0.3.0/xorbits/_mars/learn/cluster/
+-rw-r--r--   0 runner    (1001) docker     (123)     1467 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/cluster/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12807 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_common.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16045 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_elkan.pyx
+-rw-r--r--   0 runner    (1001) docker     (123)    27866 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_elkan_iter.py
+-rw-r--r--   0 runner    (1001) docker     (123)      403 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_fast.pxd
+-rw-r--r--   0 runner    (1001) docker     (123)     6473 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_fast.pyx
+-rw-r--r--   0 runner    (1001) docker     (123)    16889 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_init.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7109 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_lloyd.pyx
+-rw-r--r--   0 runner    (1001) docker     (123)    14911 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_lloyd_iter.py
+-rw-r--r--   0 runner    (1001) docker     (123)    38142 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/cluster/_kmeans.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.746924 xorbits-0.3.0/xorbits/_mars/learn/contrib/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.746924 xorbits-0.3.0/xorbits/_mars/learn/contrib/joblib/
+-rw-r--r--   0 runner    (1001) docker     (123)      687 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/joblib/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2919 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/joblib/backend.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.746924 xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/
+-rw-r--r--   0 runner    (1001) docker     (123)     1079 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3865 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/_align.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7673 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/_predict.py
+-rw-r--r--   0 runner    (1001) docker     (123)    15332 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/_train.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2418 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/classifier.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4094 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2458 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/ranker.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2462 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/regressor.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.746924 xorbits-0.3.0/xorbits/_mars/learn/contrib/pytorch/
+-rw-r--r--   0 runner    (1001) docker     (123)     1008 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/pytorch/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3069 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/pytorch/dataset.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4946 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/pytorch/run_script.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10509 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/pytorch/sampler.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.746924 xorbits-0.3.0/xorbits/_mars/learn/contrib/statsmodels/
+-rw-r--r--   0 runner    (1001) docker     (123)      773 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/statsmodels/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3383 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/statsmodels/api.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3716 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/statsmodels/predict.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7394 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/statsmodels/train.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.746924 xorbits-0.3.0/xorbits/_mars/learn/contrib/tensorflow/
+-rw-r--r--   0 runner    (1001) docker     (123)      875 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/tensorflow/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6349 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/tensorflow/dataset.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6468 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/tensorflow/run_script.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.746924 xorbits-0.3.0/xorbits/_mars/learn/contrib/tsfresh/
+-rw-r--r--   0 runner    (1001) docker     (123)      678 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/tsfresh/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2653 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/tsfresh/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2552 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.746924 xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/
+-rw-r--r--   0 runner    (1001) docker     (123)     1039 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3579 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/classifier.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5210 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13005 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/dmatrix.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7047 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/predict.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2565 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/regressor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2088 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/start_tracker.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16904 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/tracker.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10218 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/train.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.746924 xorbits-0.3.0/xorbits/_mars/learn/datasets/
+-rw-r--r--   0 runner    (1001) docker     (123)      767 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/datasets/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22241 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/datasets/samples_generator.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.746924 xorbits-0.3.0/xorbits/_mars/learn/decomposition/
+-rw-r--r--   0 runner    (1001) docker     (123)      707 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/decomposition/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6619 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/decomposition/_base.py
+-rw-r--r--   0 runner    (1001) docker     (123)    24734 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/decomposition/_pca.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9289 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/decomposition/_truncated_svd.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.746924 xorbits-0.3.0/xorbits/_mars/learn/ensemble/
+-rw-r--r--   0 runner    (1001) docker     (123)      816 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/ensemble/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    64472 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/ensemble/_bagging.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13800 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/ensemble/_blockwise.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17881 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/ensemble/_iforest.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.750924 xorbits-0.3.0/xorbits/_mars/learn/glm/
+-rw-r--r--   0 runner    (1001) docker     (123)      727 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/glm/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11316 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/glm/_logistic.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3003 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/glm/_optimizers.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.750924 xorbits-0.3.0/xorbits/_mars/learn/linear_model/
+-rw-r--r--   0 runner    (1001) docker     (123)      719 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/linear_model/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12430 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/linear_model/_base.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.750924 xorbits-0.3.0/xorbits/_mars/learn/metrics/
+-rw-r--r--   0 runner    (1001) docker     (123)     1057 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4677 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/_base.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7085 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/_check_targets.py
+-rw-r--r--   0 runner    (1001) docker     (123)    54297 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/_classification.py
+-rw-r--r--   0 runner    (1001) docker     (123)    29560 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/_ranking.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8635 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/_regresssion.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1724 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/_scorer.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.750924 xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/
+-rw-r--r--   0 runner    (1001) docker     (123)      995 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6377 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4048 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/cosine.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8209 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/euclidean.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5505 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/haversine.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5998 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/manhattan.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3794 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/pairwise.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17303 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/pairwise_distances_topk.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1515 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/rbf_kernel.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.750924 xorbits-0.3.0/xorbits/_mars/learn/model_selection/
+-rw-r--r--   0 runner    (1001) docker     (123)      688 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/model_selection/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16492 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/model_selection/_split.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.750924 xorbits-0.3.0/xorbits/_mars/learn/neighbors/
+-rw-r--r--   0 runner    (1001) docker     (123)      918 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/neighbors/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1821 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/neighbors/_ball_tree.py
+-rw-r--r--   0 runner    (1001) docker     (123)    26863 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/neighbors/_faiss.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1859 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/neighbors/_kd_tree.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4659 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/neighbors/_kneighbors_graph.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1022 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/neighbors/_proxima.py
+-rw-r--r--   0 runner    (1001) docker     (123)    21268 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/neighbors/base.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8809 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/neighbors/tree.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1277 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/neighbors/unsupervised.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3081 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/operands.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.750924 xorbits-0.3.0/xorbits/_mars/learn/preprocessing/
+-rw-r--r--   0 runner    (1001) docker     (123)      788 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/preprocessing/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13153 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/preprocessing/_data.py
+-rw-r--r--   0 runner    (1001) docker     (123)    28962 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/preprocessing/_label.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11448 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/preprocessing/normalize.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.750924 xorbits-0.3.0/xorbits/_mars/learn/proxima/
+-rw-r--r--   0 runner    (1001) docker     (123)      820 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/proxima/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5964 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/proxima/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.750924 xorbits-0.3.0/xorbits/_mars/learn/proxima/simple_index/
+-rw-r--r--   0 runner    (1001) docker     (123)      755 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/proxima/simple_index/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13869 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/proxima/simple_index/builder.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3509 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/proxima/simple_index/knn.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4301 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/proxima/simple_index/recall.py
+-rw-r--r--   0 runner    (1001) docker     (123)    19292 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/proxima/simple_index/searcher.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.750924 xorbits-0.3.0/xorbits/_mars/learn/semi_supervised/
+-rw-r--r--   0 runner    (1001) docker     (123)      693 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/semi_supervised/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12711 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/semi_supervised/_label_propagation.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.754924 xorbits-0.3.0/xorbits/_mars/learn/utils/
+-rw-r--r--   0 runner    (1001) docker     (123)     1049 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/utils/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1382 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/utils/_cython_blas.pxd
+-rw-r--r--   0 runner    (1001) docker     (123)     7074 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/utils/_cython_blas.pyx
+-rw-r--r--   0 runner    (1001) docker     (123)     9494 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/utils/_encode.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14778 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/utils/checks.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3631 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/utils/collect_ports.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4679 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/utils/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3142 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/utils/extmath.py
+-rw-r--r--   0 runner    (1001) docker     (123)    15043 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/utils/multiclass.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18903 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/utils/shuffle.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6464 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/utils/sparsefuncs.py
+-rw-r--r--   0 runner    (1001) docker     (123)    25615 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/utils/validation.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10972 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/learn/wrappers.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.754924 xorbits-0.3.0/xorbits/_mars/lib/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.754924 xorbits-0.3.0/xorbits/_mars/lib/aio/
+-rw-r--r--   0 runner    (1001) docker     (123)     1031 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/aio/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5092 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/aio/_runners.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1375 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/aio/_threads.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1280 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/aio/file.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2675 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/aio/isolation.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18712 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/bloom_filter.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1489 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/compression.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.754924 xorbits-0.3.0/xorbits/_mars/lib/filesystem/
+-rw-r--r--   0 runner    (1001) docker     (123)      961 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6582 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/_glob.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.754924 xorbits-0.3.0/xorbits/_mars/lib/filesystem/_oss_lib/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/_oss_lib/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6662 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/_oss_lib/common.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4884 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/_oss_lib/glob.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4889 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/_oss_lib/handle.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8458 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/arrow.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1231 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/azure.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6681 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/base.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3048 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5309 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/fsmap.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4502 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/fsspec_adapter.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1112 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/hdfs.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3635 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/local.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5064 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/oss.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2933 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/filesystem/s3.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7994 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/groupby_wrapper.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2586 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/mkl_interface.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.754924 xorbits-0.3.0/xorbits/_mars/lib/mmh3_src/
+-rwxr-xr-x   0 runner    (1001) docker     (123)     8096 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/mmh3_src/MurmurHash3.cpp
+-rwxr-xr-x   0 runner    (1001) docker     (123)     1263 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/mmh3_src/MurmurHash3.h
+-rwxr-xr-x   0 runner    (1001) docker     (123)    11604 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/mmh3_src/mmh3module.cpp
+-rw-r--r--   0 runner    (1001) docker     (123)    19804 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/nvutils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14552 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/ordered_set.pyx
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.754924 xorbits-0.3.0/xorbits/_mars/lib/sparse/
+-rw-r--r--   0 runner    (1001) docker     (123)    18109 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/sparse/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    53029 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/sparse/array.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2187 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/sparse/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7155 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/sparse/matrix.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4810 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/sparse/vector.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3247 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/tbcode.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/lib/uhashring/
+-rw-r--r--   0 runner    (1001) docker     (123)       61 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/uhashring/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1184 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/uhashring/monkey.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11084 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/uhashring/ring.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2605 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/uhashring/ring_ketama.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1808 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/uhashring/ring_meta.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17724 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/lib/version.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10138 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/opcodes.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/optimization/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/optimization/logical/
+-rw-r--r--   0 runner    (1001) docker     (123)      682 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/optimization/logical/chunk/
+-rw-r--r--   0 runner    (1001) docker     (123)      763 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/chunk/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      992 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/chunk/column_pruning.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1296 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/chunk/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)      984 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/chunk/head.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/optimization/logical/common/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/common/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9470 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/common/column_pruning.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5657 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/common/head.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9604 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/
+-rw-r--r--   0 runner    (1001) docker     (123)      948 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13824 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/arithmetic_query.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/column_pruning/
+-rw-r--r--   0 runner    (1001) docker     (123)      633 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/column_pruning/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9552 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/column_pruning/column_pruning_rule.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9779 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/column_pruning/input_column_selector.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5401 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/column_pruning/self_column_selector.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1036 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/column_pruning/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1489 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)      987 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/head.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/optimization/physical/
+-rw-r--r--   0 runner    (1001) docker     (123)      755 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/physical/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2900 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/physical/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2277 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/physical/cupy.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7970 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/optimization/physical/numexpr.py
+-rw-r--r--   0 runner    (1001) docker     (123)      965 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/oscar.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5281 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/profiling.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/remote/
+-rw-r--r--   0 runner    (1001) docker     (123)      776 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/remote/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11829 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/remote/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1162 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/remote/operands.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6957 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/remote/run_script.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13743 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/resource.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/serialization/
+-rw-r--r--   0 runner    (1001) docker     (123)      689 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/serialization/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1362 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/serialization/mars_objects.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/serialization/serializables/
+-rw-r--r--   0 runner    (1001) docker     (123)     1384 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/serialization/serializables/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7781 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/serialization/serializables/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14703 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/serialization/serializables/field.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14365 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/serialization/serializables/field_type.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/services/
+-rw-r--r--   0 runner    (1001) docker     (123)      776 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/services/cluster/
+-rw-r--r--   0 runner    (1001) docker     (123)      898 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/services/cluster/api/
+-rw-r--r--   0 runner    (1001) docker     (123)      758 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/api/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4679 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/api/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14363 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/api/oscar.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14721 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/api/web.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.758924 xorbits-0.3.0/xorbits/_mars/services/cluster/backends/
+-rw-r--r--   0 runner    (1001) docker     (123)      771 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/backends/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2963 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/backends/base.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1840 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/backends/fixed.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3390 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3032 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/file_logger.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8615 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/gather.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4197 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/locator.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3128 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/procinfo.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/cluster/supervisor/
+-rw-r--r--   0 runner    (1001) docker     (123)      690 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/supervisor/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1911 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/supervisor/locator.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1907 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/supervisor/node_allocator.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7400 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/supervisor/node_info.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3785 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/supervisor/service.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7681 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/uploader.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/cluster/worker/
+-rw-r--r--   0 runner    (1001) docker     (123)      686 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/worker/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3460 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/worker/locator.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3101 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/cluster/worker/service.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11240 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/context.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6651 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/lifecycle/
+-rw-r--r--   0 runner    (1001) docker     (123)      770 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/lifecycle/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/lifecycle/api/
+-rw-r--r--   0 runner    (1001) docker     (123)      766 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/lifecycle/api/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1288 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/lifecycle/api/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5471 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/lifecycle/api/oscar.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3270 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/lifecycle/api/web.py
+-rw-r--r--   0 runner    (1001) docker     (123)      727 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/lifecycle/errors.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/lifecycle/supervisor/
+-rw-r--r--   0 runner    (1001) docker     (123)      692 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/lifecycle/supervisor/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1354 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/lifecycle/supervisor/service.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10684 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/lifecycle/supervisor/tracker.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/lifecycle/worker/
+-rw-r--r--   0 runner    (1001) docker     (123)      727 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/lifecycle/worker/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/meta/
+-rw-r--r--   0 runner    (1001) docker     (123)      774 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/meta/api/
+-rw-r--r--   0 runner    (1001) docker     (123)      780 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/api/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1208 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/api/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11008 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/api/oscar.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3644 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/api/web.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2254 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4985 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/metas.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/meta/store/
+-rw-r--r--   0 runner    (1001) docker     (123)      734 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/store/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3547 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/store/base.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6014 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/store/dictionary.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/meta/supervisor/
+-rw-r--r--   0 runner    (1001) docker     (123)      687 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/supervisor/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2620 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/supervisor/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2183 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/supervisor/service.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/meta/worker/
+-rw-r--r--   0 runner    (1001) docker     (123)      683 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/worker/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3004 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/worker/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1671 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/meta/worker/service.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/scheduling/
+-rw-r--r--   0 runner    (1001) docker     (123)      694 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.762924 xorbits-0.3.0/xorbits/_mars/services/scheduling/api/
+-rw-r--r--   0 runner    (1001) docker     (123)      696 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/api/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1149 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/api/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6690 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/api/oscar.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4022 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/api/web.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1262 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)      897 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/errors.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/
+-rw-r--r--   0 runner    (1001) docker     (123)      907 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12446 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/assigner.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17563 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/autoscale.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6830 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/globalresource.py
+-rw-r--r--   0 runner    (1001) docker     (123)    19032 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/manager.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14353 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/queueing.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4884 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/service.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12647 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/speculation.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2154 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/scheduling/worker/
+-rw-r--r--   0 runner    (1001) docker     (123)      912 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/worker/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23581 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/worker/execution.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14295 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/worker/quota.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3425 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/worker/service.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12403 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/scheduling/worker/workerslot.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/session/
+-rw-r--r--   0 runner    (1001) docker     (123)      781 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/session/api/
+-rw-r--r--   0 runner    (1001) docker     (123)      758 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/api/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2829 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/api/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8071 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/api/oscar.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6837 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/api/web.py
+-rw-r--r--   0 runner    (1001) docker     (123)      796 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/session/supervisor/
+-rw-r--r--   0 runner    (1001) docker     (123)      785 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/supervisor/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9175 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/supervisor/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2247 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/supervisor/custom_log.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1345 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/supervisor/service.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/session/worker/
+-rw-r--r--   0 runner    (1001) docker     (123)      725 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/worker/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2380 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/worker/custom_log.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1418 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/session/worker/service.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/storage/
+-rw-r--r--   0 runner    (1001) docker     (123)      763 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/storage/api/
+-rw-r--r--   0 runner    (1001) docker     (123)      758 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/api/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2108 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/api/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11240 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/api/oscar.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7108 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/api/web.py
+-rw-r--r--   0 runner    (1001) docker     (123)    25439 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)      835 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/errors.py
+-rw-r--r--   0 runner    (1001) docker     (123)    27018 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/handler.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7256 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/spill.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/storage/supervisor/
+-rw-r--r--   0 runner    (1001) docker     (123)      734 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/supervisor/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13188 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/transfer.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/storage/worker/
+-rw-r--r--   0 runner    (1001) docker     (123)      686 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/worker/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3036 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/storage/worker/service.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/subtask/
+-rw-r--r--   0 runner    (1001) docker     (123)      815 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/subtask/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3818 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/subtask/api.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7670 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/subtask/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)      737 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/subtask/errors.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/subtask/supervisor/
+-rw-r--r--   0 runner    (1001) docker     (123)      734 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/subtask/supervisor/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2955 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/subtask/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/subtask/worker/
+-rw-r--r--   0 runner    (1001) docker     (123)      686 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/subtask/worker/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2417 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/subtask/worker/manager.py
+-rw-r--r--   0 runner    (1001) docker     (123)    31946 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/subtask/worker/processor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5660 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/subtask/worker/runner.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1575 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/subtask/worker/service.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.766924 xorbits-0.3.0/xorbits/_mars/services/task/
+-rw-r--r--   0 runner    (1001) docker     (123)      839 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.770924 xorbits-0.3.0/xorbits/_mars/services/task/analyzer/
+-rw-r--r--   0 runner    (1001) docker     (123)      680 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/analyzer/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22682 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/analyzer/analyzer.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8414 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/analyzer/assigner.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8911 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/analyzer/fusion.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.770924 xorbits-0.3.0/xorbits/_mars/services/task/api/
+-rw-r--r--   0 runner    (1001) docker     (123)      733 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/api/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3757 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/api/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5151 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/api/oscar.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11985 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/api/web.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1149 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/config.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3713 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)      721 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/errors.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.770924 xorbits-0.3.0/xorbits/_mars/services/task/execution/
+-rw-r--r--   0 runner    (1001) docker     (123)      664 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/execution/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7870 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/execution/api.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.770924 xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/
+-rw-r--r--   0 runner    (1001) docker     (123)      756 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1367 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/config.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18936 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/executor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2334 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/fetcher.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3689 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/resource.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14111 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/stage.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3668 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/execution/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.770924 xorbits-0.3.0/xorbits/_mars/services/task/supervisor/
+-rw-r--r--   0 runner    (1001) docker     (123)      687 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/supervisor/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6057 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/supervisor/graph_visualizer.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14265 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/supervisor/manager.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8667 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/supervisor/preprocessor.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18717 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/supervisor/processor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3137 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/supervisor/service.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16347 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/supervisor/task.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14493 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/task_info_collector.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.770924 xorbits-0.3.0/xorbits/_mars/services/task/worker/
+-rw-r--r--   0 runner    (1001) docker     (123)      683 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/worker/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1224 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/task/worker/service.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.770924 xorbits-0.3.0/xorbits/_mars/services/web/
+-rw-r--r--   0 runner    (1001) docker     (123)      881 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/web/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.770924 xorbits-0.3.0/xorbits/_mars/services/web/api/
+-rw-r--r--   0 runner    (1001) docker     (123)      675 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/web/api/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1253 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/web/api/oscar.py
+-rw-r--r--   0 runner    (1001) docker     (123)      942 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/web/api/web.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9416 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/web/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1391 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/web/handlers.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3735 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/web/supervisor.py
+-rw-r--r--   0 runner    (1001) docker     (123)      725 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/services/web/worker.py
+-rw-r--r--   0 runner    (1001) docker     (123)      828 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/session.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.770924 xorbits-0.3.0/xorbits/_mars/storage/
+-rw-r--r--   0 runner    (1001) docker     (123)     1018 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/storage/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6936 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/storage/base.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4272 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/storage/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10998 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/storage/cuda.py
+-rw-r--r--   0 runner    (1001) docker     (123)      720 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/storage/errors.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6762 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/storage/filesystem.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9561 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/storage/plasma.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7728 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/storage/shared_memory.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7719 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/storage/vineyard.py
+-rw-r--r--   0 runner    (1001) docker     (123)      833 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/supervisor.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.770924 xorbits-0.3.0/xorbits/_mars/tensor/
+-rw-r--r--   0 runner    (1001) docker     (123)     6127 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.778924 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/
+-rw-r--r--   0 runner    (1001) docker     (123)     9441 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2192 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/abs.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2222 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/absolute.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4068 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/add.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2579 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/angle.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3524 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arccos.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3036 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arccosh.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3256 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arcsin.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3043 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arcsinh.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3574 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arctan.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4455 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arctan2.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3021 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arctanh.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4413 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/around.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2929 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/bitand.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3324 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/bitor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2920 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/bitxor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2127 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/cbrt.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2264 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/ceil.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6680 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/clip.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2239 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/conj.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2517 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/copysign.py
+-rw-r--r--   0 runner    (1001) docker     (123)    24387 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2741 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/cos.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2230 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/cosh.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2183 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/deg2rad.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2387 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/degrees.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3722 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/divide.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2405 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/equal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3795 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/exp.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2009 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/exp2.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2433 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/expm1.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2442 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/fabs.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1772 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/fix.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3376 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/float_power.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2454 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/floor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2999 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/floordiv.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3586 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/fmax.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3579 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/fmin.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3224 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/fmod.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4415 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/frexp.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2467 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/greater.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2316 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/greater_equal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2533 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/hypot.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3248 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/i0.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1780 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/imag.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3474 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/invert.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4613 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/isclose.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1716 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/iscomplex.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3606 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/isfinite.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3470 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/isinf.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2697 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/isnan.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1662 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/isreal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3177 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/ldexp.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2277 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/less.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2305 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/less_equal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3162 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/log.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3036 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/log10.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3251 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/log1p.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2878 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/log2.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2741 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/logaddexp.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2757 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/logaddexp2.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2582 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/logical_and.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2355 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/logical_not.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2601 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/logical_or.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2902 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/logical_xor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2646 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/lshift.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3706 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/maximum.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3707 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/minimum.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3257 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/mod.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3959 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/modf.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4207 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/multiply.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3257 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/nan_to_num.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2100 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/negative.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2342 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/nextafter.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2286 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/not_equal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1328 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/positive.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3215 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/power.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2114 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/rad2deg.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2392 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/radians.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1843 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/real.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2387 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/reciprocal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2127 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/rint.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2567 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/rshift.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1479 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/setimag.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1479 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/setreal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2563 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/sign.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2124 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/signbit.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3332 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/sin.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3499 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/sinc.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2928 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/sinh.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2325 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/spacing.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2817 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/sqrt.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2100 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/square.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2507 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/subtract.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2855 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/tan.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3056 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/tanh.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3359 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/truediv.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2315 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/trunc.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4164 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5020 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/array_utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.782924 xorbits-0.3.0/xorbits/_mars/tensor/base/
+-rw-r--r--   0 runner    (1001) docker     (123)     2920 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3521 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/argpartition.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4582 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/argsort.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1430 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/argtopk.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3798 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/argwhere.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1632 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/array_split.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5921 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/astype.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1915 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/atleast_1d.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2001 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/atleast_2d.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2434 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/atleast_3d.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1702 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/broadcast_arrays.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4792 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/broadcast_to.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1823 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/copy.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6837 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/copyto.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1617 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8713 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/delete.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4136 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/diff.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2159 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/dsplit.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2135 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/ediff1d.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2341 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/expand_dims.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1973 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/flatten.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2319 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/flip.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1788 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/fliplr.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1842 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/flipud.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2562 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/hsplit.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3285 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/in1d.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14622 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/insert.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7146 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/isin.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6724 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/map_chunk.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2481 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/moveaxis.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1432 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/ndim.py
+-rw-r--r--   0 runner    (1001) docker     (123)    27176 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/partition.py
+-rw-r--r--   0 runner    (1001) docker     (123)    35087 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/psrs.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3170 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/ravel.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4111 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/rebalance.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7157 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/repeat.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3082 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/result_type.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3425 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/roll.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2268 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/rollaxis.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13101 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/searchsorted.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1796 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/setdiff1d.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3873 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/shape.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18354 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/sort.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7880 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/split.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4982 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/squeeze.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4654 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/swapaxes.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3202 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/tile.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1299 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/to_cpu.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1364 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/to_gpu.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18738 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/topk.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4712 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/transpose.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6263 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/trapz.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22013 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/unique.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2384 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/vsplit.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6127 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/base/where.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22102 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.786924 xorbits-0.3.0/xorbits/_mars/tensor/datasource/
+-rw-r--r--   0 runner    (1001) docker     (123)     1859 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7339 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/arange.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13876 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/array.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6313 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9388 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/diag.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2200 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/diagflat.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7249 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/empty.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4460 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/eye.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3826 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_dataframe.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2399 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_dense.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3202 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_hdf5.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2562 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_sparse.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6762 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_tiledb.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6748 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_vineyard.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3196 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_zarr.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7841 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/full.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1720 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/identity.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3845 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/indices.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6672 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/linspace.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4487 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/meshgrid.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6561 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/ones.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1894 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/scalar.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7611 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/tri.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7159 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datasource/zeros.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.786924 xorbits-0.3.0/xorbits/_mars/tensor/datastore/
+-rw-r--r--   0 runner    (1001) docker     (123)      936 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datastore/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1930 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datastore/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7747 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datastore/to_hdf5.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8359 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datastore/to_tiledb.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6418 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datastore/to_vineyard.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5828 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datastore/to_zarr.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2232 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/datastore/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.786924 xorbits-0.3.0/xorbits/_mars/tensor/einsum/
+-rw-r--r--   0 runner    (1001) docker     (123)      669 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/einsum/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    19921 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/einsum/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)    35488 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/einsum/einsumfunc.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.786924 xorbits-0.3.0/xorbits/_mars/tensor/fetch/
+-rw-r--r--   0 runner    (1001) docker     (123)      694 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fetch/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2065 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fetch/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.786924 xorbits-0.3.0/xorbits/_mars/tensor/fft/
+-rw-r--r--   0 runner    (1001) docker     (123)     1349 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8303 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4273 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/fft.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4852 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/fft2.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4748 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/fftfreq.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4933 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/fftn.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2644 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/fftshift.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4157 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/hfft.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4246 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/ifft.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4814 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/ifft2.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5052 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/ifftn.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2370 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/ifftshift.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3356 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/ihfft.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4760 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/irfft.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2090 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/irfft2.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4641 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/irfftn.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4468 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/rfft.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2059 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/rfft2.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3833 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/rfftfreq.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4415 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fft/rfftn.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.786924 xorbits-0.3.0/xorbits/_mars/tensor/fuse/
+-rw-r--r--   0 runner    (1001) docker     (123)      753 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fuse/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      971 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fuse/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2631 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fuse/cupy.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6226 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/fuse/numexpr.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.786924 xorbits-0.3.0/xorbits/_mars/tensor/images/
+-rw-r--r--   0 runner    (1001) docker     (123)      671 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/images/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3890 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/images/imread.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.790924 xorbits-0.3.0/xorbits/_mars/tensor/indexing/
+-rw-r--r--   0 runner    (1001) docker     (123)     1658 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8377 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/choose.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4026 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/compress.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7164 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2065 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/extract.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14693 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/fill_diagonal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1703 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/flatnonzero.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13136 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/getitem.py
+-rw-r--r--   0 runner    (1001) docker     (123)    39494 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/index_lib.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4455 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/nonzero.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13308 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/setitem.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2344 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/slice.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4251 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/take.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4786 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/indexing/unravel_index.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.790924 xorbits-0.3.0/xorbits/_mars/tensor/lib/
+-rw-r--r--   0 runner    (1001) docker     (123)      705 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/lib/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17238 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/lib/index_tricks.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.790924 xorbits-0.3.0/xorbits/_mars/tensor/linalg/
+-rw-r--r--   0 runner    (1001) docker     (123)     1414 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11717 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/cholesky.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11285 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5276 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/dot.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1186 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/inner.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4942 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/inv.py
+-rw-r--r--   0 runner    (1001) docker     (123)    20118 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/lu.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11180 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/matmul.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11539 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/norm.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6046 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/qr.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9155 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/randomized_svd.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2139 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/solve.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8226 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/solve_triangular.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8679 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/svd.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11693 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/tensordot.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2652 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2292 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/linalg/vdot.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.790924 xorbits-0.3.0/xorbits/_mars/tensor/merge/
+-rw-r--r--   0 runner    (1001) docker     (123)      939 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/merge/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2509 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/merge/append.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17065 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/merge/block.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1779 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/merge/column_stack.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/merge/concatenate.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2388 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/merge/dstack.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2400 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/merge/hstack.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7235 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/merge/stack.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1768 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/merge/union1d.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2471 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/merge/vstack.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3668 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/operands.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.794924 xorbits-0.3.0/xorbits/_mars/tensor/random/
+-rw-r--r--   0 runner    (1001) docker     (123)     7012 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3175 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/beta.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5303 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/binomial.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1051 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/bytes.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3766 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/chisquare.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13246 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/choice.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14038 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5518 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/dirichlet.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3599 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/exponential.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5103 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/f.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4631 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/gamma.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3362 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/geometric.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6333 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/gumbel.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5645 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/hypergeometric.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5019 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/laplace.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4740 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/logistic.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6067 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/lognormal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4449 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/logseries.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4783 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/multinomial.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9553 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/multivariate_normal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4851 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/negative_binomial.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4949 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/noncentral_chisquare.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5022 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/noncentral_f.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5221 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/normal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5401 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/pareto.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8574 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/permutation.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3898 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/poisson.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4857 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/power.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2550 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/rand.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6024 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/randint.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3353 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/randn.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4372 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/random_integers.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3017 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/random_sample.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3968 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/rayleigh.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1805 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/shuffle.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3873 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/standard_cauchy.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2450 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/standard_exponential.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4261 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/standard_gamma.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2565 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/standard_normal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4931 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/standard_t.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4360 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/triangular.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4711 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/uniform.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4811 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/vonmises.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4382 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/wald.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4907 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/weibull.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4103 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/random/zipf.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.794924 xorbits-0.3.0/xorbits/_mars/tensor/rechunk/
+-rw-r--r--   0 runner    (1001) docker     (123)      844 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/rechunk/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4096 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/rechunk/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4317 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/rechunk/rechunk.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.798924 xorbits-0.3.0/xorbits/_mars/tensor/reduction/
+-rw-r--r--   0 runner    (1001) docker     (123)     2319 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3905 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/all.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2939 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/allclose.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4009 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/any.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3664 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/argmax.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3654 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/argmin.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1792 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/array_equal.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22582 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4201 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/count_nonzero.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3414 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/cumprod.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3617 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/cumsum.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4431 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/max.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7075 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/mean.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4432 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/min.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3139 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanargmax.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2862 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanargmin.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3369 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/nancumprod.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3515 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/nancumsum.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4398 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanmax.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6233 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanmean.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4395 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanmin.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3766 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanprod.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5025 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanstd.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4518 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/nansum.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10173 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanvar.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4858 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/prod.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5263 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/std.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4684 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/sum.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10886 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reduction/var.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.798924 xorbits-0.3.0/xorbits/_mars/tensor/reshape/
+-rw-r--r--   0 runner    (1001) docker     (123)      673 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reshape/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22819 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/reshape/reshape.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.798924 xorbits-0.3.0/xorbits/_mars/tensor/spatial/
+-rw-r--r--   0 runner    (1001) docker     (123)      643 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/spatial/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.798924 xorbits-0.3.0/xorbits/_mars/tensor/spatial/distance/
+-rw-r--r--   0 runner    (1001) docker     (123)      729 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/spatial/distance/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18210 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/spatial/distance/cdist.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23875 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/spatial/distance/pdist.py
+-rw-r--r--   0 runner    (1001) docker     (123)    15809 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/spatial/distance/squareform.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.798924 xorbits-0.3.0/xorbits/_mars/tensor/special/
+-rw-r--r--   0 runner    (1001) docker     (123)     3757 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/special/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1619 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/special/airy.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4633 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/special/bessel.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1217 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/special/convenience.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5510 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/special/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4024 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/special/ellip_func_integrals.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1746 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/special/ellip_harm.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5922 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/special/err_fresnel.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7826 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/special/gamma_funcs.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2001 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/special/hypergeometric_funcs.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5031 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/special/info_theory.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.798924 xorbits-0.3.0/xorbits/_mars/tensor/statistics/
+-rw-r--r--   0 runner    (1001) docker     (123)     1191 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/statistics/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5099 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/statistics/average.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11032 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/statistics/bincount.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2298 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/statistics/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2805 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/statistics/corrcoef.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7653 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/statistics/cov.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6061 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/statistics/digitize.py
+-rw-r--r--   0 runner    (1001) docker     (123)    34980 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/statistics/histogram.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3146 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/statistics/median.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6086 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/statistics/percentile.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2814 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/statistics/ptp.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17626 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/statistics/quantile.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.798924 xorbits-0.3.0/xorbits/_mars/tensor/stats/
+-rw-r--r--   0 runner    (1001) docker     (123)      894 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/stats/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4948 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/stats/chisquare.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1526 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/stats/entropy.py
+-rw-r--r--   0 runner    (1001) docker     (123)    24448 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/stats/ks.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9589 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/stats/power_divergence.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4419 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/stats/rankdata.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5540 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/stats/ttest.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/_mars/tensor/ufunc/
+-rw-r--r--   0 runner    (1001) docker     (123)      796 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/ufunc/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7183 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/ufunc/ufunc.py
+-rw-r--r--   0 runner    (1001) docker     (123)    26724 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/tensor/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1596 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/typing.py
+-rw-r--r--   0 runner    (1001) docker     (123)    55138 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)      825 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/_mars/worker.py
+-rw-r--r--   0 runner    (1001) docker     (123)      497 2023-04-28 11:46:04.806924 xorbits-0.3.0/xorbits/_version.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/compat/
+-rw-r--r--   0 runner    (1001) docker     (123)      581 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/compat/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      745 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/compat/_constants.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/core/
+-rw-r--r--   0 runner    (1001) docker     (123)      664 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/core/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14086 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/core/adapter.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3042 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/core/api.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12572 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/core/data.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3462 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/core/execution.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/core/utils/
+-rw-r--r--   0 runner    (1001) docker     (123)      581 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/core/utils/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11364 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/core/utils/docstring.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2545 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/core/utils/fallback.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/deploy/
+-rw-r--r--   0 runner    (1001) docker     (123)     5268 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/deploy/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/deploy/kubernetes/
+-rw-r--r--   0 runner    (1001) docker     (123)      639 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/deploy/kubernetes/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      628 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/deploy/kubernetes/_constants.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23910 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/deploy/kubernetes/client.py
+-rw-r--r--   0 runner    (1001) docker     (123)    28408 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/deploy/kubernetes/config.py
+-rw-r--r--   0 runner    (1001) docker     (123)       85 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/deploy/kubernetes/config.yml
+-rw-r--r--   0 runner    (1001) docker     (123)    10322 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/deploy/kubernetes/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1127 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/deploy/kubernetes/supervisor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1730 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/deploy/kubernetes/worker.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/deploy/oscar/
+-rw-r--r--   0 runner    (1001) docker     (123)     2078 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/deploy/oscar/file-logging.conf
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/numpy/
+-rw-r--r--   0 runner    (1001) docker     (123)     3062 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/numpy/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      886 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/numpy/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/numpy/fft/
+-rw-r--r--   0 runner    (1001) docker     (123)     1681 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/numpy/fft/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/numpy/lib/
+-rw-r--r--   0 runner    (1001) docker     (123)      609 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/numpy/lib/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1828 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/numpy/lib/index_tricks.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/numpy/linalg/
+-rw-r--r--   0 runner    (1001) docker     (123)     1681 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/numpy/linalg/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/numpy/mars_adapters/
+-rw-r--r--   0 runner    (1001) docker     (123)     1280 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/numpy/mars_adapters/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3056 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/numpy/mars_adapters/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1101 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/numpy/mars_adapters/flatiter.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/numpy/numpy_adapters/
+-rw-r--r--   0 runner    (1001) docker     (123)      629 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/numpy/numpy_adapters/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4246 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/numpy/numpy_adapters/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/numpy/random/
+-rw-r--r--   0 runner    (1001) docker     (123)     1712 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/numpy/random/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/pandas/
+-rw-r--r--   0 runner    (1001) docker     (123)     2155 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/pandas/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2432 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/pandas/accessors.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2915 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/pandas/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1214 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/pandas/groupby.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1612 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/pandas/indexing.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/pandas/mars_adapters/
+-rw-r--r--   0 runner    (1001) docker     (123)     4490 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/pandas/mars_adapters/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6651 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/pandas/mars_adapters/core.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/pandas/pandas_adapters/
+-rw-r--r--   0 runner    (1001) docker     (123)      914 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/pandas/pandas_adapters/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7995 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/pandas/pandas_adapters/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1421 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/pandas/plotting.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1779 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/pandas/window.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/remote/
+-rw-r--r--   0 runner    (1001) docker     (123)      615 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/remote/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/remote/mars_adapters/
+-rw-r--r--   0 runner    (1001) docker     (123)      606 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/remote/mars_adapters/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3680 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/remote/mars_adapters/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)      656 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/supervisor.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1937 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.802924 xorbits-0.3.0/xorbits/web/
+-rw-r--r--   0 runner    (1001) docker     (123)     1084 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/web/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1034 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/web/index_handler.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.806924 xorbits-0.3.0/xorbits/web/ui/
+-rw-r--r--   0 runner    (1001) docker     (123)      416 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/web/ui/.eslintrc.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      144 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/web/ui/.prettierrc.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     1234 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/web/ui/index.html
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.806924 xorbits-0.3.0/xorbits/web/ui/static/
+-rw-r--r--   0 runner    (1001) docker     (123)   397889 2023-04-28 11:45:00.000000 xorbits-0.3.0/xorbits/web/ui/static/546.bundle.js
+-rw-r--r--   0 runner    (1001) docker     (123)     1136 2023-04-28 11:45:00.000000 xorbits-0.3.0/xorbits/web/ui/static/546.bundle.js.LICENSE.txt
+-rw-r--r--   0 runner    (1001) docker     (123)   355116 2023-04-28 11:45:00.000000 xorbits-0.3.0/xorbits/web/ui/static/601.bundle.js
+-rw-r--r--   0 runner    (1001) docker     (123)      485 2023-04-28 11:45:00.000000 xorbits-0.3.0/xorbits/web/ui/static/601.bundle.js.LICENSE.txt
+-rw-r--r--   0 runner    (1001) docker     (123)    12840 2023-04-28 11:45:00.000000 xorbits-0.3.0/xorbits/web/ui/static/615.bundle.js
+-rw-r--r--   0 runner    (1001) docker     (123)    18581 2023-04-28 11:45:00.000000 xorbits-0.3.0/xorbits/web/ui/static/701.bundle.js
+-rw-r--r--   0 runner    (1001) docker     (123)   481975 2023-04-28 11:45:00.000000 xorbits-0.3.0/xorbits/web/ui/static/bundle.js
+-rw-r--r--   0 runner    (1001) docker     (123)     1857 2023-04-28 11:45:00.000000 xorbits-0.3.0/xorbits/web/ui/static/bundle.js.LICENSE.txt
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.718925 xorbits-0.3.0/xorbits/web/ui/static/resources/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.718925 xorbits-0.3.0/xorbits/web/ui/static/resources/assets/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.806924 xorbits-0.3.0/xorbits/web/ui/static/resources/assets/images/
+-rw-r--r--   0 runner    (1001) docker     (123)     1893 2023-04-28 11:45:00.000000 xorbits-0.3.0/xorbits/web/ui/static/resources/assets/images/favicon.svg
+-rw-r--r--   0 runner    (1001) docker     (123)     2731 2023-04-28 11:45:00.000000 xorbits-0.3.0/xorbits/web/ui/static/resources/assets/images/xorbits.svg
+-rw-r--r--   0 runner    (1001) docker     (123)      862 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/web/version_handler.py
+-rw-r--r--   0 runner    (1001) docker     (123)      652 2023-04-28 11:43:56.000000 xorbits-0.3.0/xorbits/worker.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-28 11:46:04.718925 xorbits-0.3.0/xorbits.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (123)     9512 2023-04-28 11:46:03.000000 xorbits-0.3.0/xorbits.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)    45456 2023-04-28 11:46:04.000000 xorbits-0.3.0/xorbits.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-04-28 11:46:03.000000 xorbits-0.3.0/xorbits.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (123)      100 2023-04-28 11:46:03.000000 xorbits-0.3.0/xorbits.egg-info/entry_points.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-04-28 11:45:29.000000 xorbits-0.3.0/xorbits.egg-info/not-zip-safe
+-rw-r--r--   0 runner    (1001) docker     (123)      899 2023-04-28 11:46:03.000000 xorbits-0.3.0/xorbits.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        8 2023-04-28 11:46:03.000000 xorbits-0.3.0/xorbits.egg-info/top_level.txt
```

### Comparing `xorbits-0.2.2/PKG-INFO` & `xorbits-0.3.0/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: xorbits
-Version: 0.2.2
+Version: 0.3.0
 Summary: Scalable Python data science, in an API compatible & lightning fast way.
 Home-page: http://github.com/xprobe-inc/xorbits
 Author: Qin Xuye
 Author-email: qinxuye@xprobe.io
 Maintainer: Qin Xuye
 Maintainer-email: qinxuye@xprobe.io
 License: Apache License 2.0
@@ -130,14 +130,15 @@
 
 | Deployment                                                                           | Description                                               |
 |--------------------------------------------------------------------------------------|-----------------------------------------------------------|
 | [Local](https://doc.xorbits.io/en/latest/user_guide/deployment_local.html)           | Run Xorbits on a local machine, e.g. your laptop          |
 | [Cluster](https://doc.xorbits.io/en/latest/user_guide/deployment_cluster.html)       | Deploy Xorbits to existing cluster via command lines      |
 | [Kubernetes](https://doc.xorbits.io/en/latest/user_guide/deployment_kubernetes.html) | Deploy Xorbits to existing k8s cluster via python code    |
 | [Cloud](https://doc.xorbits.io/en/latest/user_guide/deployment_cloud.html)           | Deploy Xorbits to various cloud platforms via python code |
+| [SLURM](https://doc.xorbits.io/en/latest/user_guide/deployment_slurm.html)           | Deploy Xorbits to SLURM                                   |
 
 
 ## License
 [Apache 2](LICENSE)
 
 ## Documentation
 The official documentation is hosted on: https://doc.xorbits.io
```

### Comparing `xorbits-0.2.2/pyproject.toml` & `xorbits-0.3.0/pyproject.toml`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/setup.cfg` & `xorbits-0.3.0/setup.cfg`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/setup.py` & `xorbits-0.3.0/setup.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/versioneer.py` & `xorbits-0.3.0/versioneer.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/__init__.py` & `xorbits-0.3.0/xorbits/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/__init__.py` & `xorbits-0.3.0/xorbits/_mars/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/_resource.pyx` & `xorbits-0.3.0/xorbits/_mars/_resource.pyx`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/_utils.pxd` & `xorbits-0.3.0/xorbits/_mars/_utils.pxd`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/_utils.pyx` & `xorbits-0.3.0/xorbits/_mars/_utils.pyx`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/_version.py` & `xorbits-0.3.0/xorbits/_mars/_version.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/config.py` & `xorbits-0.3.0/xorbits/_mars/config.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/contrib/__init__.py` & `xorbits-0.3.0/xorbits/_mars/contrib/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/contrib/dask/__init__.py` & `xorbits-0.3.0/xorbits/_mars/contrib/dask/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/contrib/dask/converter.py` & `xorbits-0.3.0/xorbits/_mars/contrib/dask/converter.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/contrib/dask/scheduler.py` & `xorbits-0.3.0/xorbits/_mars/contrib/dask/scheduler.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/contrib/dask/utils.py` & `xorbits-0.3.0/xorbits/_mars/contrib/dask/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/__init__.py` & `xorbits-0.3.0/xorbits/_mars/core/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/base.py` & `xorbits-0.3.0/xorbits/_mars/core/base.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/context.py` & `xorbits-0.3.0/xorbits/_mars/core/context.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/custom_log.py` & `xorbits-0.3.0/xorbits/_mars/core/custom_log.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/entity/__init__.py` & `xorbits-0.3.0/xorbits/_mars/core/entity/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/entity/chunks.py` & `xorbits-0.3.0/xorbits/_mars/core/entity/chunks.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/entity/core.py` & `xorbits-0.3.0/xorbits/_mars/core/entity/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/entity/executable.py` & `xorbits-0.3.0/xorbits/_mars/core/entity/executable.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/entity/fuse.py` & `xorbits-0.3.0/xorbits/_mars/core/entity/fuse.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/entity/objects.py` & `xorbits-0.3.0/xorbits/_mars/core/entity/objects.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/entity/output_types.py` & `xorbits-0.3.0/xorbits/_mars/core/entity/output_types.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/entity/tileables.py` & `xorbits-0.3.0/xorbits/_mars/core/entity/tileables.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/entity/utils.py` & `xorbits-0.3.0/xorbits/_mars/core/entity/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/entrypoints.py` & `xorbits-0.3.0/xorbits/_mars/core/entrypoints.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/graph/__init__.py` & `xorbits-0.3.0/xorbits/_mars/core/graph/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/graph/builder/__init__.py` & `xorbits-0.3.0/xorbits/_mars/core/graph/builder/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/graph/builder/base.py` & `xorbits-0.3.0/xorbits/_mars/core/graph/builder/base.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/graph/builder/chunk.py` & `xorbits-0.3.0/xorbits/_mars/core/graph/builder/chunk.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/graph/builder/tileable.py` & `xorbits-0.3.0/xorbits/_mars/core/graph/builder/tileable.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/graph/builder/utils.py` & `xorbits-0.3.0/xorbits/_mars/core/graph/builder/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/graph/core.pyx` & `xorbits-0.3.0/xorbits/_mars/core/graph/core.pyx`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/graph/entity.py` & `xorbits-0.3.0/xorbits/_mars/core/graph/entity.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/mode.py` & `xorbits-0.3.0/xorbits/_mars/core/mode.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/operand/__init__.py` & `xorbits-0.3.0/xorbits/_mars/core/operand/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/operand/base.py` & `xorbits-0.3.0/xorbits/_mars/core/operand/base.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/operand/core.py` & `xorbits-0.3.0/xorbits/_mars/core/operand/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -495,23 +495,25 @@
                     op_name = f"{op.__class__.__name__}:{op.stage.name}"
                 else:
                     op_name = op.__class__.__name__
                 op_executed_number.record(1, {"op": op_name})
                 return result
             except UFuncTypeError as e:  # pragma: no cover
                 raise TypeError(str(e)).with_traceback(sys.exc_info()[2]) from None
-    except NotImplementedError:
+    except NotImplementedError as e:
         for op_cls in type(op).__mro__:
             if op_cls in _op_type_to_executor:
                 executor = _op_type_to_executor[op_cls]
                 _op_type_to_executor[type(op)] = executor
                 result = executor(results, op)
                 succeeded = True
                 return result
-        raise KeyError(f"No handler found for op: {op}")
+        raise KeyError(
+            f"No handler found for op: {op}, due to NotImplementedError: {str(e)}"
+        ) from e
     finally:
         if succeeded:
             op.post_execute(results, op)
 
 
 def estimate_size(results: Dict[str, Any], op: OperandType):
     try:
```

### Comparing `xorbits-0.2.2/xorbits/_mars/core/operand/fetch.py` & `xorbits-0.3.0/xorbits/_mars/core/operand/fetch.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/operand/fuse.py` & `xorbits-0.3.0/xorbits/_mars/core/operand/fuse.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/operand/objects.py` & `xorbits-0.3.0/xorbits/_mars/core/operand/objects.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/core/operand/shuffle.py` & `xorbits-0.3.0/xorbits/_mars/core/operand/shuffle.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/align.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/align.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/abs.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/abs.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/add.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/add.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/arccos.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/arccos.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/arccosh.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/arccosh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/arcsin.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/arcsin.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/arcsinh.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/arcsinh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/arctan.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/arctan.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/arctanh.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/arctanh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/around.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/around.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/bitwise_and.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/bitwise_and.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/bitwise_or.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/bitwise_or.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/bitwise_xor.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/bitwise_xor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/ceil.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/ceil.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/core.py`

 * *Files 1% similar despite different names*

```diff
@@ -209,56 +209,57 @@
         tileable = op.rhs if pd.api.types.is_scalar(op.lhs) else op.lhs
         df = op.outputs[0]
         out_chunks = []
         lazy_chunk_meta = is_chunk_meta_lazy(tileable.chunks[0])
         for chunk in tileable.chunks:
             out_op = op.copy().reset_key()
             if chunk.ndim == 2:
+                dtypes = df.dtypes[chunk.dtypes.index]
                 if lazy_chunk_meta:
                     out_chunk = out_op.new_chunk(
                         [chunk],
                         shape=chunk.shape,
                         index=chunk.index,
                     )
                     out_chunk._set_tileable_meta(
                         tileable_key=df.key,
                         nsplits=tileable.nsplits,
                         index_value=df.index_value,
                         columns_value=df.columns_value,
-                        dtypes=df.dtypes,
+                        dtypes=dtypes,
                     )
                 else:
                     out_chunk = out_op.new_chunk(
                         [chunk],
                         shape=chunk.shape,
                         index=chunk.index,
-                        dtypes=chunk.dtypes,
+                        dtypes=dtypes,
                         index_value=chunk.index_value,
                         columns_value=getattr(chunk, "columns_value"),
                     )
             else:
                 if lazy_chunk_meta:
                     out_chunk = out_op.new_chunk(
                         [chunk],
                         shape=chunk.shape,
                         index=chunk.index,
-                        dtype=chunk.dtype,
+                        dtype=df.dtype,
                         name=getattr(chunk, "name"),
                     )
                     out_chunk._set_tileable_meta(
                         tileable_key=df.key,
                         nsplits=tileable.nsplits,
                         index_value=df.index_value,
                     )
                 else:
                     out_chunk = out_op.new_chunk(
                         [chunk],
                         shape=chunk.shape,
                         index=chunk.index,
-                        dtype=chunk.dtype,
+                        dtype=df.dtype,
                         index_value=chunk.index_value,
                         name=getattr(chunk, "name"),
                     )
             out_chunks.append(out_chunk)
 
         new_op = op.copy()
         params = df.params.copy()
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/cos.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/cos.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/cosh.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/cosh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/degrees.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/degrees.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/docstring.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/docstring.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/dot.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/dot.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/equal.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/equal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/exp.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/exp.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/exp2.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/exp2.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/expm1.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/expm1.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/floor.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/floor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/floordiv.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/floordiv.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/greater.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/greater.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/greater_equal.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/greater_equal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/invert.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/invert.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/is_ufuncs.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/is_ufuncs.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/less.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/less.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/less_equal.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/less_equal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/log.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/log.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/log10.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/log10.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/log2.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/log2.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/mod.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/mod.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/multiply.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/multiply.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/negative.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/negative.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/not_equal.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/not_equal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/power.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/power.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/radians.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/radians.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/sin.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/sin.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/sinh.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/sinh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/sqrt.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/sqrt.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/subtract.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/subtract.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/tan.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/tan.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/tanh.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/tanh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arithmetic/truediv.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arithmetic/truediv.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/arrays.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/arrays.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/_duplicate.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/_duplicate.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/accessor.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/accessor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/apply.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/apply.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/astype.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/astype.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/bloom_filter.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/bloom_filter.py`

 * *Files 0% similar despite different names*

```diff
@@ -172,15 +172,15 @@
             in_data[op.on].apply(lambda v: bloom_filter.add(cls._get_value(v)), axis=1)
         return bloom_filter
 
     @classmethod
     def _convert_to_hashable_dtypes(cls, dtypes: pd.Series):
         dtypes = dict(
             (name, dtype) if np.issubdtype(dtype, int) else (name, str)
-            for name, dtype in dtypes.iteritems()
+            for name, dtype in dtypes.items()
         )
         return dtypes
 
     @classmethod
     def execute(cls, ctx: Union[dict, Context], op: "DataFrameBloomFilter"):
         if op.execution_stage == "build":
             on = op.on
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/cartesian_chunk.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/cartesian_chunk.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/check_monotonic.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/check_monotonic.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/cut.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/cut.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/datetimes.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/datetimes.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/describe.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/describe.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/diff.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/diff.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/drop.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/drop.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/drop_duplicates.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/drop_duplicates.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/duplicated.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/duplicated.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/eval.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/eval.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/explode.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/explode.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/get_dummies.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/get_dummies.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/isin.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/isin.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/map.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/map.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/map_chunk.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/map_chunk.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/melt.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/melt.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/memory_usage.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/memory_usage.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/pct_change.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/pct_change.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/qcut.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/qcut.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/rebalance.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/rebalance.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/rechunk.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/rechunk.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/select_dtypes.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/select_dtypes.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/shift.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/shift.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/stack.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/stack.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/standardize_range_index.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/standardize_range_index.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/string_.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/string_.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/to_cpu.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/to_cpu.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/to_gpu.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/to_gpu.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/to_numeric.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/to_numeric.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/transform.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/transform.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/transpose.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/transpose.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/base/value_counts.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/base/value_counts.py`

 * *Files 3% similar despite different names*

```diff
@@ -19,15 +19,15 @@
 from ... import opcodes
 from ...core import OutputType, recursive_tile
 from ...core.operand import OperandStage
 from ...serialization.serializables import BoolField, Int64Field, KeyField, StringField
 from ...utils import has_unknown_shape, pd_release_version
 from ..core import Series
 from ..operands import DataFrameOperand, DataFrameOperandMixin
-from ..utils import build_series, parse_index
+from ..utils import build_series, is_pandas_2, parse_index
 
 _keep_original_order = pd_release_version >= (1, 3, 0)
 
 
 class DataFrameValueCounts(DataFrameOperand, DataFrameOperandMixin):
     _op_type_ = opcodes.VALUE_COUNTS
 
@@ -47,14 +47,21 @@
 
     def _set_inputs(self, inputs):
         super()._set_inputs(inputs)
         self.input = self._inputs[0]
 
     def __call__(self, inp):
         test_series = build_series(inp).value_counts(normalize=self.normalize)
+        if is_pandas_2():
+            if self.normalize:
+                name = "proportion"
+            else:
+                name = "count"
+        else:
+            name = inp.name
         if self.bins is not None:
             from .cut import cut
 
             # cut
             try:
                 inp = cut(inp, self.bins, include_lowest=True)
             except TypeError:  # pragma: no cover
@@ -62,23 +69,23 @@
 
             self.bins = None
             self.convert_index_to_interval = True
             return self.new_series(
                 [inp],
                 shape=(np.nan,),
                 index_value=parse_index(pd.CategoricalIndex([]), inp, store_data=False),
-                name=inp.name,
+                name=name,
                 dtype=test_series.dtype,
             )
         else:
             return self.new_series(
                 [inp],
                 shape=(np.nan,),
                 index_value=parse_index(test_series.index, store_data=False),
-                name=inp.name,
+                name=name,
                 dtype=test_series.dtype,
             )
 
     @classmethod
     def tile(cls, op: "DataFrameValueCounts"):
         inp = op.input
         out = op.outputs[0]
@@ -127,14 +134,15 @@
         chunks = []
         for c in ret.chunks:
             chunk_op = DataFrameValueCounts(
                 convert_index_to_interval=op.convert_index_to_interval,
                 stage=OperandStage.map,
             )
             chunk_params = c.params
+            chunk_params["name"] = out.name
             if op.convert_index_to_interval:
                 # convert index to IntervalDtype
                 chunk_params["index_value"] = parse_index(
                     pd.IntervalIndex([]), c, store_data=False
                 )
             chunks.append(chunk_op.new_chunk([c], kws=[chunk_params]))
 
@@ -175,21 +183,23 @@
                         ascending=op.ascending,
                         bins=op.bins,
                         dropna=op.dropna,
                     )
         else:
             result = ctx[op.input.key]
             # set index name to None to keep consistency with pandas
-            result.index.name = None
+            if not is_pandas_2():
+                result.index.name = None
         if op.convert_index_to_interval:
             # convert CategoricalDtype which generated in `cut`
             # to IntervalDtype
             result.index = result.index.astype("interval")
         if op.nrows:
             result = result.head(op.nrows)
+        result.name = op.outputs[0].name
         ctx[op.outputs[0].key] = result
 
 
 def value_counts(
     series,
     normalize=False,
     sort=True,
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -87,6180 +87,6271 @@
 00000560: 4669 656c 642c 0a20 2020 2049 6e74 6572  Field,.    Inter
 00000570: 7661 6c41 7272 6179 4669 656c 642c 0a20  valArrayField,. 
 00000580: 2020 204c 6973 7446 6965 6c64 2c0a 2020     ListField,.  
 00000590: 2020 4e44 4172 7261 7946 6965 6c64 2c0a    NDArrayField,.
 000005a0: 2020 2020 4f6e 654f 6646 6965 6c64 2c0a      OneOfField,.
 000005b0: 2020 2020 5265 6665 7265 6e63 6546 6965      ReferenceFie
 000005c0: 6c64 2c0a 2020 2020 5365 7269 616c 697a  ld,.    Serializ
-000005d0: 6162 6c65 2c0a 2020 2020 5365 7269 6573  able,.    Series
-000005e0: 4669 656c 642c 0a20 2020 2053 6c69 6365  Field,.    Slice
-000005f0: 4669 656c 642c 0a20 2020 2053 7472 696e  Field,.    Strin
-00000600: 6746 6965 6c64 2c0a 2020 2020 5475 706c  gField,.    Tupl
-00000610: 6546 6965 6c64 2c0a 290a 6672 6f6d 202e  eField,.).from .
-00000620: 2e74 656e 736f 7220 696d 706f 7274 2073  .tensor import s
-00000630: 7461 7469 7374 6963 730a 6672 6f6d 202e  tatistics.from .
-00000640: 2e75 7469 6c73 2069 6d70 6f72 7420 280a  .utils import (.
-00000650: 2020 2020 6361 6c63 5f6e 7370 6c69 7473      calc_nsplits
-00000660: 2c0a 2020 2020 6365 696c 6469 762c 0a20  ,.    ceildiv,. 
-00000670: 2020 2065 7374 696d 6174 655f 7061 6e64     estimate_pand
-00000680: 6173 5f73 697a 652c 0a20 2020 206f 6e5f  as_size,.    on_
-00000690: 6465 7365 7269 616c 697a 655f 7368 6170  deserialize_shap
-000006a0: 652c 0a20 2020 206f 6e5f 7365 7269 616c  e,.    on_serial
-000006b0: 697a 655f 6e75 6d70 795f 7479 7065 2c0a  ize_numpy_type,.
-000006c0: 2020 2020 6f6e 5f73 6572 6961 6c69 7a65      on_serialize
-000006d0: 5f73 6861 7065 2c0a 2020 2020 746f 6b65  _shape,.    toke
-000006e0: 6e69 7a65 2c0a 290a 6672 6f6d 202e 7574  nize,.).from .ut
-000006f0: 696c 7320 696d 706f 7274 2052 6570 7253  ils import ReprS
-00000700: 6572 6965 732c 2066 6574 6368 5f63 6f72  eries, fetch_cor
-00000710: 6e65 725f 6461 7461 2c20 6d65 7267 655f  ner_data, merge_
-00000720: 696e 6465 785f 7661 6c75 652c 2070 6172  index_value, par
-00000730: 7365 5f69 6e64 6578 0a0a 0a63 6c61 7373  se_index...class
-00000740: 2049 6e64 6578 5661 6c75 6528 5365 7269   IndexValue(Seri
-00000750: 616c 697a 6162 6c65 293a 0a20 2020 2022  alizable):.    "
-00000760: 2222 0a20 2020 204d 6574 6120 636c 6173  "".    Meta clas
-00000770: 7320 666f 7220 696e 6465 782c 2068 656c  s for index, hel
-00000780: 6420 6279 2049 6e64 6578 4461 7461 2c20  d by IndexData, 
-00000790: 5365 7269 6573 4461 7461 2061 6e64 2044  SeriesData and D
-000007a0: 6174 6146 7261 6d65 4461 7461 0a20 2020  ataFrameData.   
-000007b0: 2022 2222 0a0a 2020 2020 5f5f 736c 6f74   """..    __slot
-000007c0: 735f 5f20 3d20 2829 0a0a 2020 2020 636c  s__ = ()..    cl
-000007d0: 6173 7320 496e 6465 7842 6173 6528 5365  ass IndexBase(Se
-000007e0: 7269 616c 697a 6162 6c65 293a 0a20 2020  rializable):.   
-000007f0: 2020 2020 205f 6b65 7920 3d20 5374 7269       _key = Stri
-00000800: 6e67 4669 656c 6428 226b 6579 2229 2020  ngField("key")  
-00000810: 2320 746f 2069 6465 6e74 6966 7920 6966  # to identify if
-00000820: 2074 6865 2069 6e64 6578 2069 7320 7468   the index is th
-00000830: 6520 7361 6d65 0a20 2020 2020 2020 205f  e same.        _
-00000840: 6973 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63  is_monotonic_inc
-00000850: 7265 6173 696e 6720 3d20 426f 6f6c 4669  reasing = BoolFi
-00000860: 656c 6428 2269 735f 6d6f 6e6f 746f 6e69  eld("is_monotoni
-00000870: 635f 696e 6372 6561 7369 6e67 2229 0a20  c_increasing"). 
-00000880: 2020 2020 2020 205f 6973 5f6d 6f6e 6f74         _is_monot
-00000890: 6f6e 6963 5f64 6563 7265 6173 696e 6720  onic_decreasing 
-000008a0: 3d20 426f 6f6c 4669 656c 6428 2269 735f  = BoolField("is_
-000008b0: 6d6f 6e6f 746f 6e69 635f 6465 6372 6561  monotonic_decrea
-000008c0: 7369 6e67 2229 0a20 2020 2020 2020 205f  sing").        _
-000008d0: 6973 5f75 6e69 7175 6520 3d20 426f 6f6c  is_unique = Bool
-000008e0: 4669 656c 6428 2269 735f 756e 6971 7565  Field("is_unique
-000008f0: 2229 0a20 2020 2020 2020 205f 6d61 785f  ").        _max_
-00000900: 7661 6c20 3d20 416e 7946 6965 6c64 2822  val = AnyField("
-00000910: 6d61 785f 7661 6c22 2c20 6f6e 5f73 6572  max_val", on_ser
-00000920: 6961 6c69 7a65 3d6f 6e5f 7365 7269 616c  ialize=on_serial
-00000930: 697a 655f 6e75 6d70 795f 7479 7065 290a  ize_numpy_type).
-00000940: 2020 2020 2020 2020 5f6d 6178 5f76 616c          _max_val
-00000950: 5f63 6c6f 7365 203d 2042 6f6f 6c46 6965  _close = BoolFie
-00000960: 6c64 2822 6d61 785f 7661 6c5f 636c 6f73  ld("max_val_clos
-00000970: 6522 290a 2020 2020 2020 2020 5f6d 696e  e").        _min
-00000980: 5f76 616c 203d 2041 6e79 4669 656c 6428  _val = AnyField(
-00000990: 226d 696e 5f76 616c 222c 206f 6e5f 7365  "min_val", on_se
-000009a0: 7269 616c 697a 653d 6f6e 5f73 6572 6961  rialize=on_seria
-000009b0: 6c69 7a65 5f6e 756d 7079 5f74 7970 6529  lize_numpy_type)
-000009c0: 0a20 2020 2020 2020 205f 6d69 6e5f 7661  .        _min_va
-000009d0: 6c5f 636c 6f73 6520 3d20 426f 6f6c 4669  l_close = BoolFi
-000009e0: 656c 6428 226d 696e 5f76 616c 5f63 6c6f  eld("min_val_clo
-000009f0: 7365 2229 0a0a 2020 2020 2020 2020 4070  se")..        @p
-00000a00: 726f 7065 7274 790a 2020 2020 2020 2020  roperty.        
-00000a10: 6465 6620 6973 5f6d 6f6e 6f74 6f6e 6963  def is_monotonic
-00000a20: 5f69 6e63 7265 6173 696e 6728 7365 6c66  _increasing(self
-00000a30: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00000a40: 6574 7572 6e20 7365 6c66 2e5f 6973 5f6d  eturn self._is_m
-00000a50: 6f6e 6f74 6f6e 6963 5f69 6e63 7265 6173  onotonic_increas
-00000a60: 696e 670a 0a20 2020 2020 2020 2040 7072  ing..        @pr
-00000a70: 6f70 6572 7479 0a20 2020 2020 2020 2064  operty.        d
-00000a80: 6566 2069 735f 6d6f 6e6f 746f 6e69 635f  ef is_monotonic_
-00000a90: 6465 6372 6561 7369 6e67 2873 656c 6629  decreasing(self)
-00000aa0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00000ab0: 7475 726e 2073 656c 662e 5f69 735f 6d6f  turn self._is_mo
-00000ac0: 6e6f 746f 6e69 635f 6465 6372 6561 7369  notonic_decreasi
-00000ad0: 6e67 0a0a 2020 2020 2020 2020 4070 726f  ng..        @pro
-00000ae0: 7065 7274 790a 2020 2020 2020 2020 6465  perty.        de
-00000af0: 6620 6973 5f75 6e69 7175 6528 7365 6c66  f is_unique(self
-00000b00: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00000b10: 6574 7572 6e20 7365 6c66 2e5f 6973 5f75  eturn self._is_u
-00000b20: 6e69 7175 650a 0a20 2020 2020 2020 2040  nique..        @
-00000b30: 7072 6f70 6572 7479 0a20 2020 2020 2020  property.       
-00000b40: 2064 6566 206d 696e 5f76 616c 2873 656c   def min_val(sel
-00000b50: 6629 3a0a 2020 2020 2020 2020 2020 2020  f):.            
-00000b60: 7265 7475 726e 2073 656c 662e 5f6d 696e  return self._min
-00000b70: 5f76 616c 0a0a 2020 2020 2020 2020 4070  _val..        @p
-00000b80: 726f 7065 7274 790a 2020 2020 2020 2020  roperty.        
-00000b90: 6465 6620 6d69 6e5f 7661 6c5f 636c 6f73  def min_val_clos
-00000ba0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-00000bb0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00000bc0: 2e5f 6d69 6e5f 7661 6c5f 636c 6f73 650a  ._min_val_close.
-00000bd0: 0a20 2020 2020 2020 2040 7072 6f70 6572  .        @proper
-00000be0: 7479 0a20 2020 2020 2020 2064 6566 206d  ty.        def m
-00000bf0: 6178 5f76 616c 2873 656c 6629 3a0a 2020  ax_val(self):.  
-00000c00: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00000c10: 2073 656c 662e 5f6d 6178 5f76 616c 0a0a   self._max_val..
-00000c20: 2020 2020 2020 2020 4070 726f 7065 7274          @propert
-00000c30: 790a 2020 2020 2020 2020 6465 6620 6d61  y.        def ma
-00000c40: 785f 7661 6c5f 636c 6f73 6528 7365 6c66  x_val_close(self
-00000c50: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00000c60: 6574 7572 6e20 7365 6c66 2e5f 6d61 785f  eturn self._max_
-00000c70: 7661 6c5f 636c 6f73 650a 0a20 2020 2020  val_close..     
-00000c80: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00000c90: 2020 2020 2064 6566 206b 6579 2873 656c       def key(sel
-00000ca0: 6629 3a0a 2020 2020 2020 2020 2020 2020  f):.            
-00000cb0: 7265 7475 726e 2073 656c 662e 5f6b 6579  return self._key
-00000cc0: 0a0a 2020 2020 2020 2020 4070 726f 7065  ..        @prope
-00000cd0: 7274 790a 2020 2020 2020 2020 6465 6620  rty.        def 
-00000ce0: 696e 6665 7272 6564 5f74 7970 6528 7365  inferred_type(se
-00000cf0: 6c66 293a 0a20 2020 2020 2020 2020 2020  lf):.           
-00000d00: 2072 6574 7572 6e20 4e6f 6e65 0a0a 2020   return None..  
-00000d10: 2020 2020 2020 6465 6620 746f 5f70 616e        def to_pan
-00000d20: 6461 7328 7365 6c66 293a 0a20 2020 2020  das(self):.     
-00000d30: 2020 2020 2020 206b 7720 3d20 7b0a 2020         kw = {.  
-00000d40: 2020 2020 2020 2020 2020 2020 2020 6669                fi
-00000d50: 656c 642e 7461 673a 2067 6574 6174 7472  eld.tag: getattr
-00000d60: 2873 656c 662c 2061 7474 722c 204e 6f6e  (self, attr, Non
-00000d70: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-00000d80: 2020 2066 6f72 2061 7474 722c 2066 6965     for attr, fie
-00000d90: 6c64 2069 6e20 7365 6c66 2e5f 4649 454c  ld in self._FIEL
-00000da0: 4453 2e69 7465 6d73 2829 0a20 2020 2020  DS.items().     
-00000db0: 2020 2020 2020 2020 2020 2069 6620 6174             if at
-00000dc0: 7472 206e 6f74 2069 6e20 7375 7065 7228  tr not in super(
-00000dd0: 7479 7065 2873 656c 6629 2c20 7365 6c66  type(self), self
-00000de0: 292e 5f46 4945 4c44 530a 2020 2020 2020  )._FIELDS.      
-00000df0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00000e00: 2020 2020 6b77 203d 207b 6b3a 2076 2066      kw = {k: v f
-00000e10: 6f72 206b 2c20 7620 696e 206b 772e 6974  or k, v in kw.it
-00000e20: 656d 7328 2920 6966 2076 2069 7320 6e6f  ems() if v is no
-00000e30: 7420 4e6f 6e65 7d0a 2020 2020 2020 2020  t None}.        
-00000e40: 2020 2020 6966 206b 772e 6765 7428 2264      if kw.get("d
-00000e50: 6174 6122 2920 6973 204e 6f6e 653a 0a20  ata") is None:. 
-00000e60: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-00000e70: 775b 2264 6174 6122 5d20 3d20 5b5d 0a0a  w["data"] = []..
-00000e80: 2020 2020 2020 2020 2020 2020 7064 5f69              pd_i
-00000e90: 6e69 7469 616c 697a 6572 203d 2067 6574  nitializer = get
-00000ea0: 6174 7472 2873 656c 662c 2022 5f70 645f  attr(self, "_pd_
-00000eb0: 696e 6974 6961 6c69 7a65 7222 2c20 4e6f  initializer", No
-00000ec0: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
-00000ed0: 6966 2070 645f 696e 6974 6961 6c69 7a65  if pd_initialize
-00000ee0: 7220 6973 204e 6f6e 653a 0a20 2020 2020  r is None:.     
-00000ef0: 2020 2020 2020 2020 2020 2070 645f 696e             pd_in
-00000f00: 6974 6961 6c69 7a65 7220 3d20 6765 7461  itializer = geta
-00000f10: 7474 7228 7064 2c20 7479 7065 2873 656c  ttr(pd, type(sel
-00000f20: 6629 2e5f 5f6e 616d 655f 5f29 0a20 2020  f).__name__).   
-00000f30: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00000f40: 7064 5f69 6e69 7469 616c 697a 6572 282a  pd_initializer(*
-00000f50: 2a6b 7729 0a0a 2020 2020 636c 6173 7320  *kw)..    class 
-00000f60: 496e 6465 7828 496e 6465 7842 6173 6529  Index(IndexBase)
-00000f70: 3a0a 2020 2020 2020 2020 5f6e 616d 6520  :.        _name 
-00000f80: 3d20 416e 7946 6965 6c64 2822 6e61 6d65  = AnyField("name
-00000f90: 2229 0a20 2020 2020 2020 205f 6461 7461  ").        _data
-00000fa0: 203d 204e 4441 7272 6179 4669 656c 6428   = NDArrayField(
-00000fb0: 2264 6174 6122 290a 2020 2020 2020 2020  "data").        
-00000fc0: 5f64 7479 7065 203d 2044 6174 6154 7970  _dtype = DataTyp
-00000fd0: 6546 6965 6c64 2822 6474 7970 6522 290a  eField("dtype").
-00000fe0: 0a20 2020 2063 6c61 7373 2052 616e 6765  .    class Range
-00000ff0: 496e 6465 7828 496e 6465 7842 6173 6529  Index(IndexBase)
-00001000: 3a0a 2020 2020 2020 2020 5f6e 616d 6520  :.        _name 
-00001010: 3d20 416e 7946 6965 6c64 2822 6e61 6d65  = AnyField("name
-00001020: 2229 0a20 2020 2020 2020 205f 736c 6963  ").        _slic
-00001030: 6520 3d20 536c 6963 6546 6965 6c64 2822  e = SliceField("
-00001040: 736c 6963 6522 290a 2020 2020 2020 2020  slice").        
-00001050: 5f64 7479 7065 203d 2044 6174 6154 7970  _dtype = DataTyp
-00001060: 6546 6965 6c64 2822 6474 7970 6522 290a  eField("dtype").
-00001070: 0a20 2020 2020 2020 2040 7072 6f70 6572  .        @proper
-00001080: 7479 0a20 2020 2020 2020 2064 6566 2073  ty.        def s
-00001090: 6c69 6365 2873 656c 6629 3a0a 2020 2020  lice(self):.    
-000010a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000010b0: 656c 662e 5f73 6c69 6365 0a0a 2020 2020  elf._slice..    
-000010c0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-000010d0: 2020 2020 2020 6465 6620 6474 7970 6528        def dtype(
-000010e0: 7365 6c66 293a 0a20 2020 2020 2020 2020  self):.         
-000010f0: 2020 2072 6574 7572 6e20 6765 7461 7474     return getatt
-00001100: 7228 7365 6c66 2c20 225f 6474 7970 6522  r(self, "_dtype"
-00001110: 2c20 6e70 2e64 7479 7065 286e 702e 696e  , np.dtype(np.in
-00001120: 7463 2929 0a0a 2020 2020 2020 2020 6465  tc))..        de
-00001130: 6620 746f 5f70 616e 6461 7328 7365 6c66  f to_pandas(self
-00001140: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-00001150: 6c63 203d 2073 656c 662e 5f73 6c69 6365  lc = self._slice
-00001160: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00001170: 7572 6e20 7064 2e52 616e 6765 496e 6465  urn pd.RangeInde
-00001180: 7828 0a20 2020 2020 2020 2020 2020 2020  x(.             
-00001190: 2020 2073 6c63 2e73 7461 7274 2c20 736c     slc.start, sl
-000011a0: 632e 7374 6f70 2c20 736c 632e 7374 6570  c.stop, slc.step
-000011b0: 2c20 6e61 6d65 3d67 6574 6174 7472 2873  , name=getattr(s
-000011c0: 656c 662c 2022 5f6e 616d 6522 2c20 4e6f  elf, "_name", No
-000011d0: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
-000011e0: 290a 0a20 2020 2063 6c61 7373 2043 6174  )..    class Cat
-000011f0: 6567 6f72 6963 616c 496e 6465 7828 496e  egoricalIndex(In
-00001200: 6465 7842 6173 6529 3a0a 2020 2020 2020  dexBase):.      
-00001210: 2020 5f6e 616d 6520 3d20 416e 7946 6965    _name = AnyFie
-00001220: 6c64 2822 6e61 6d65 2229 0a20 2020 2020  ld("name").     
-00001230: 2020 205f 6461 7461 203d 204e 4441 7272     _data = NDArr
-00001240: 6179 4669 656c 6428 2264 6174 6122 290a  ayField("data").
-00001250: 2020 2020 2020 2020 5f63 6174 6567 6f72          _categor
-00001260: 6965 7320 3d20 416e 7946 6965 6c64 2822  ies = AnyField("
-00001270: 6361 7465 676f 7269 6573 2229 0a20 2020  categories").   
-00001280: 2020 2020 205f 6f72 6465 7265 6420 3d20       _ordered = 
-00001290: 426f 6f6c 4669 656c 6428 226f 7264 6572  BoolField("order
-000012a0: 6564 2229 0a0a 2020 2020 2020 2020 4070  ed")..        @p
-000012b0: 726f 7065 7274 790a 2020 2020 2020 2020  roperty.        
-000012c0: 6465 6620 696e 6665 7272 6564 5f74 7970  def inferred_typ
-000012d0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-000012e0: 2020 2020 2072 6574 7572 6e20 2263 6174       return "cat
-000012f0: 6567 6f72 6963 616c 220a 0a20 2020 2063  egorical"..    c
-00001300: 6c61 7373 2049 6e74 6572 7661 6c49 6e64  lass IntervalInd
-00001310: 6578 2849 6e64 6578 4261 7365 293a 0a20  ex(IndexBase):. 
-00001320: 2020 2020 2020 205f 6e61 6d65 203d 2041         _name = A
-00001330: 6e79 4669 656c 6428 226e 616d 6522 290a  nyField("name").
-00001340: 2020 2020 2020 2020 5f64 6174 6120 3d20          _data = 
-00001350: 496e 7465 7276 616c 4172 7261 7946 6965  IntervalArrayFie
-00001360: 6c64 2822 6461 7461 2229 0a20 2020 2020  ld("data").     
-00001370: 2020 205f 636c 6f73 6564 203d 2053 7472     _closed = Str
-00001380: 696e 6746 6965 6c64 2822 636c 6f73 6564  ingField("closed
-00001390: 2229 0a0a 2020 2020 2020 2020 4070 726f  ")..        @pro
-000013a0: 7065 7274 790a 2020 2020 2020 2020 6465  perty.        de
-000013b0: 6620 696e 6665 7272 6564 5f74 7970 6528  f inferred_type(
-000013c0: 7365 6c66 293a 0a20 2020 2020 2020 2020  self):.         
-000013d0: 2020 2072 6574 7572 6e20 2269 6e74 6572     return "inter
-000013e0: 7661 6c22 0a0a 2020 2020 636c 6173 7320  val"..    class 
-000013f0: 4461 7465 7469 6d65 496e 6465 7828 496e  DatetimeIndex(In
-00001400: 6465 7842 6173 6529 3a0a 2020 2020 2020  dexBase):.      
-00001410: 2020 5f6e 616d 6520 3d20 416e 7946 6965    _name = AnyFie
-00001420: 6c64 2822 6e61 6d65 2229 0a20 2020 2020  ld("name").     
-00001430: 2020 205f 6461 7461 203d 204e 4441 7272     _data = NDArr
-00001440: 6179 4669 656c 6428 2264 6174 6122 290a  ayField("data").
-00001450: 2020 2020 2020 2020 5f66 7265 7120 3d20          _freq = 
-00001460: 416e 7946 6965 6c64 2822 6672 6571 2229  AnyField("freq")
-00001470: 0a20 2020 2020 2020 205f 7374 6172 7420  .        _start 
-00001480: 3d20 416e 7946 6965 6c64 2822 7374 6172  = AnyField("star
-00001490: 7422 290a 2020 2020 2020 2020 5f70 6572  t").        _per
-000014a0: 696f 6473 203d 2041 6e79 4669 656c 6428  iods = AnyField(
-000014b0: 2270 6572 696f 6473 2229 0a20 2020 2020  "periods").     
-000014c0: 2020 205f 656e 6420 3d20 416e 7946 6965     _end = AnyFie
-000014d0: 6c64 2822 656e 6422 290a 2020 2020 2020  ld("end").      
-000014e0: 2020 5f63 6c6f 7365 6420 3d20 416e 7946    _closed = AnyF
-000014f0: 6965 6c64 2822 636c 6f73 6564 2229 0a20  ield("closed"). 
-00001500: 2020 2020 2020 205f 747a 203d 2041 6e79         _tz = Any
-00001510: 4669 656c 6428 2274 7a22 290a 2020 2020  Field("tz").    
-00001520: 2020 2020 5f61 6d62 6967 756f 7573 203d      _ambiguous =
-00001530: 2041 6e79 4669 656c 6428 2261 6d62 6967   AnyField("ambig
-00001540: 756f 7573 2229 0a20 2020 2020 2020 205f  uous").        _
-00001550: 6461 7966 6972 7374 203d 2042 6f6f 6c46  dayfirst = BoolF
-00001560: 6965 6c64 2822 6461 7966 6972 7374 2229  ield("dayfirst")
-00001570: 0a20 2020 2020 2020 205f 7965 6172 6669  .        _yearfi
-00001580: 7273 7420 3d20 426f 6f6c 4669 656c 6428  rst = BoolField(
-00001590: 2279 6561 7266 6972 7374 2229 0a0a 2020  "yearfirst")..  
-000015a0: 2020 2020 2020 4070 726f 7065 7274 790a        @property.
-000015b0: 2020 2020 2020 2020 6465 6620 696e 6665          def infe
-000015c0: 7272 6564 5f74 7970 6528 7365 6c66 293a  rred_type(self):
-000015d0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000015e0: 7572 6e20 2264 6174 6574 696d 6536 3422  urn "datetime64"
-000015f0: 0a0a 2020 2020 2020 2020 4070 726f 7065  ..        @prope
-00001600: 7274 790a 2020 2020 2020 2020 6465 6620  rty.        def 
-00001610: 6672 6571 2873 656c 6629 3a0a 2020 2020  freq(self):.    
-00001620: 2020 2020 2020 2020 7265 7475 726e 2067          return g
-00001630: 6574 6174 7472 2873 656c 662c 2022 5f66  etattr(self, "_f
-00001640: 7265 7122 2c20 4e6f 6e65 290a 0a20 2020  req", None)..   
-00001650: 2063 6c61 7373 2054 696d 6564 656c 7461   class Timedelta
-00001660: 496e 6465 7828 496e 6465 7842 6173 6529  Index(IndexBase)
-00001670: 3a0a 2020 2020 2020 2020 5f6e 616d 6520  :.        _name 
-00001680: 3d20 416e 7946 6965 6c64 2822 6e61 6d65  = AnyField("name
-00001690: 2229 0a20 2020 2020 2020 205f 6461 7461  ").        _data
-000016a0: 203d 204e 4441 7272 6179 4669 656c 6428   = NDArrayField(
-000016b0: 2264 6174 6122 290a 2020 2020 2020 2020  "data").        
-000016c0: 5f75 6e69 7420 3d20 416e 7946 6965 6c64  _unit = AnyField
-000016d0: 2822 756e 6974 2229 0a20 2020 2020 2020  ("unit").       
-000016e0: 205f 6672 6571 203d 2041 6e79 4669 656c   _freq = AnyFiel
-000016f0: 6428 2266 7265 7122 290a 2020 2020 2020  d("freq").      
-00001700: 2020 5f73 7461 7274 203d 2041 6e79 4669    _start = AnyFi
-00001710: 656c 6428 2273 7461 7274 2229 0a20 2020  eld("start").   
-00001720: 2020 2020 205f 7065 7269 6f64 7320 3d20       _periods = 
-00001730: 416e 7946 6965 6c64 2822 7065 7269 6f64  AnyField("period
-00001740: 7322 290a 2020 2020 2020 2020 5f65 6e64  s").        _end
-00001750: 203d 2041 6e79 4669 656c 6428 2265 6e64   = AnyField("end
-00001760: 2229 0a20 2020 2020 2020 205f 636c 6f73  ").        _clos
-00001770: 6564 203d 2041 6e79 4669 656c 6428 2263  ed = AnyField("c
-00001780: 6c6f 7365 6422 290a 0a20 2020 2020 2020  losed")..       
-00001790: 2040 7072 6f70 6572 7479 0a20 2020 2020   @property.     
-000017a0: 2020 2064 6566 2069 6e66 6572 7265 645f     def inferred_
-000017b0: 7479 7065 2873 656c 6629 3a0a 2020 2020  type(self):.    
-000017c0: 2020 2020 2020 2020 7265 7475 726e 2022          return "
-000017d0: 7469 6d65 6465 6c74 6136 3422 0a0a 2020  timedelta64"..  
-000017e0: 2020 636c 6173 7320 5065 7269 6f64 496e    class PeriodIn
-000017f0: 6465 7828 496e 6465 7842 6173 6529 3a0a  dex(IndexBase):.
-00001800: 2020 2020 2020 2020 5f6e 616d 6520 3d20          _name = 
-00001810: 416e 7946 6965 6c64 2822 6e61 6d65 2229  AnyField("name")
-00001820: 0a20 2020 2020 2020 205f 6461 7461 203d  .        _data =
-00001830: 204e 4441 7272 6179 4669 656c 6428 2264   NDArrayField("d
-00001840: 6174 6122 290a 2020 2020 2020 2020 5f66  ata").        _f
-00001850: 7265 7120 3d20 416e 7946 6965 6c64 2822  req = AnyField("
-00001860: 6672 6571 2229 0a20 2020 2020 2020 205f  freq").        _
-00001870: 7374 6172 7420 3d20 416e 7946 6965 6c64  start = AnyField
-00001880: 2822 7374 6172 7422 290a 2020 2020 2020  ("start").      
-00001890: 2020 5f70 6572 696f 6473 203d 2041 6e79    _periods = Any
-000018a0: 4669 656c 6428 2270 6572 696f 6473 2229  Field("periods")
-000018b0: 0a20 2020 2020 2020 205f 656e 6420 3d20  .        _end = 
-000018c0: 416e 7946 6965 6c64 2822 656e 6422 290a  AnyField("end").
-000018d0: 2020 2020 2020 2020 5f79 6561 7220 3d20          _year = 
-000018e0: 416e 7946 6965 6c64 2822 7965 6172 2229  AnyField("year")
-000018f0: 0a20 2020 2020 2020 205f 6d6f 6e74 6820  .        _month 
-00001900: 3d20 416e 7946 6965 6c64 2822 6d6f 6e74  = AnyField("mont
-00001910: 6822 290a 2020 2020 2020 2020 5f71 7561  h").        _qua
-00001920: 7274 6572 203d 2041 6e79 4669 656c 6428  rter = AnyField(
-00001930: 2271 7561 7274 6572 2229 0a20 2020 2020  "quarter").     
-00001940: 2020 205f 6461 7920 3d20 416e 7946 6965     _day = AnyFie
-00001950: 6c64 2822 6461 7922 290a 2020 2020 2020  ld("day").      
-00001960: 2020 5f68 6f75 7220 3d20 416e 7946 6965    _hour = AnyFie
-00001970: 6c64 2822 686f 7572 2229 0a20 2020 2020  ld("hour").     
-00001980: 2020 205f 6d69 6e75 7465 203d 2041 6e79     _minute = Any
-00001990: 4669 656c 6428 226d 696e 7574 6522 290a  Field("minute").
-000019a0: 2020 2020 2020 2020 5f73 6563 6f6e 6420          _second 
-000019b0: 3d20 416e 7946 6965 6c64 2822 7365 636f  = AnyField("seco
-000019c0: 6e64 2229 0a20 2020 2020 2020 205f 747a  nd").        _tz
-000019d0: 203d 2041 6e79 4669 656c 6428 2274 7a22   = AnyField("tz"
-000019e0: 290a 2020 2020 2020 2020 5f64 7479 7065  ).        _dtype
-000019f0: 203d 2044 6174 6154 7970 6546 6965 6c64   = DataTypeField
-00001a00: 2822 6474 7970 6522 290a 0a20 2020 2020  ("dtype")..     
-00001a10: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00001a20: 2020 2020 2064 6566 2069 6e66 6572 7265       def inferre
-00001a30: 645f 7479 7065 2873 656c 6629 3a0a 2020  d_type(self):.  
-00001a40: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00001a50: 2022 7065 7269 6f64 220a 0a20 2020 2063   "period"..    c
-00001a60: 6c61 7373 2049 6e74 3634 496e 6465 7828  lass Int64Index(
-00001a70: 496e 6465 7842 6173 6529 3a0a 2020 2020  IndexBase):.    
-00001a80: 2020 2020 5f70 645f 696e 6974 6961 6c69      _pd_initiali
-00001a90: 7a65 7220 3d20 7064 2e49 6e64 6578 0a0a  zer = pd.Index..
-00001aa0: 2020 2020 2020 2020 5f6e 616d 6520 3d20          _name = 
-00001ab0: 416e 7946 6965 6c64 2822 6e61 6d65 2229  AnyField("name")
-00001ac0: 0a20 2020 2020 2020 205f 6461 7461 203d  .        _data =
-00001ad0: 204e 4441 7272 6179 4669 656c 6428 2264   NDArrayField("d
-00001ae0: 6174 6122 290a 2020 2020 2020 2020 5f64  ata").        _d
-00001af0: 7479 7065 203d 2044 6174 6154 7970 6546  type = DataTypeF
-00001b00: 6965 6c64 2822 6474 7970 6522 290a 0a20  ield("dtype").. 
-00001b10: 2020 2020 2020 2040 7072 6f70 6572 7479         @property
-00001b20: 0a20 2020 2020 2020 2064 6566 2069 6e66  .        def inf
-00001b30: 6572 7265 645f 7479 7065 2873 656c 6629  erred_type(self)
-00001b40: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00001b50: 7475 726e 2022 696e 7465 6765 7222 0a0a  turn "integer"..
-00001b60: 2020 2020 636c 6173 7320 5549 6e74 3634      class UInt64
-00001b70: 496e 6465 7828 496e 6465 7842 6173 6529  Index(IndexBase)
-00001b80: 3a0a 2020 2020 2020 2020 5f70 645f 696e  :.        _pd_in
-00001b90: 6974 6961 6c69 7a65 7220 3d20 7064 2e49  itializer = pd.I
-00001ba0: 6e64 6578 0a0a 2020 2020 2020 2020 5f6e  ndex..        _n
-00001bb0: 616d 6520 3d20 416e 7946 6965 6c64 2822  ame = AnyField("
-00001bc0: 6e61 6d65 2229 0a20 2020 2020 2020 205f  name").        _
-00001bd0: 6461 7461 203d 204e 4441 7272 6179 4669  data = NDArrayFi
-00001be0: 656c 6428 2264 6174 6122 290a 2020 2020  eld("data").    
-00001bf0: 2020 2020 5f64 7479 7065 203d 2044 6174      _dtype = Dat
-00001c00: 6154 7970 6546 6965 6c64 2822 6474 7970  aTypeField("dtyp
-00001c10: 6522 290a 0a20 2020 2020 2020 2040 7072  e")..        @pr
-00001c20: 6f70 6572 7479 0a20 2020 2020 2020 2064  operty.        d
-00001c30: 6566 2069 6e66 6572 7265 645f 7479 7065  ef inferred_type
-00001c40: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00001c50: 2020 2020 7265 7475 726e 2022 696e 7465      return "inte
-00001c60: 6765 7222 0a0a 2020 2020 636c 6173 7320  ger"..    class 
-00001c70: 466c 6f61 7436 3449 6e64 6578 2849 6e64  Float64Index(Ind
-00001c80: 6578 4261 7365 293a 0a20 2020 2020 2020  exBase):.       
-00001c90: 205f 7064 5f69 6e69 7469 616c 697a 6572   _pd_initializer
-00001ca0: 203d 2070 642e 496e 6465 780a 0a20 2020   = pd.Index..   
-00001cb0: 2020 2020 205f 6e61 6d65 203d 2041 6e79       _name = Any
-00001cc0: 4669 656c 6428 226e 616d 6522 290a 2020  Field("name").  
-00001cd0: 2020 2020 2020 5f64 6174 6120 3d20 4e44        _data = ND
-00001ce0: 4172 7261 7946 6965 6c64 2822 6461 7461  ArrayField("data
-00001cf0: 2229 0a20 2020 2020 2020 205f 6474 7970  ").        _dtyp
-00001d00: 6520 3d20 4461 7461 5479 7065 4669 656c  e = DataTypeFiel
-00001d10: 6428 2264 7479 7065 2229 0a0a 2020 2020  d("dtype")..    
-00001d20: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00001d30: 2020 2020 2020 6465 6620 696e 6665 7272        def inferr
-00001d40: 6564 5f74 7970 6528 7365 6c66 293a 0a20  ed_type(self):. 
-00001d50: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00001d60: 6e20 2266 6c6f 6174 696e 6722 0a0a 2020  n "floating"..  
-00001d70: 2020 636c 6173 7320 4d75 6c74 6949 6e64    class MultiInd
-00001d80: 6578 2849 6e64 6578 4261 7365 293a 0a20  ex(IndexBase):. 
-00001d90: 2020 2020 2020 205f 6e61 6d65 7320 3d20         _names = 
-00001da0: 4c69 7374 4669 656c 6428 226e 616d 6573  ListField("names
-00001db0: 222c 206f 6e5f 7365 7269 616c 697a 653d  ", on_serialize=
-00001dc0: 6c69 7374 290a 2020 2020 2020 2020 5f64  list).        _d
-00001dd0: 7479 7065 7320 3d20 4c69 7374 4669 656c  types = ListFiel
-00001de0: 6428 2264 7479 7065 7322 2c20 6f6e 5f73  d("dtypes", on_s
-00001df0: 6572 6961 6c69 7a65 3d6c 6973 7429 0a20  erialize=list). 
-00001e00: 2020 2020 2020 205f 6461 7461 203d 204e         _data = N
-00001e10: 4441 7272 6179 4669 656c 6428 2264 6174  DArrayField("dat
-00001e20: 6122 290a 2020 2020 2020 2020 5f73 6f72  a").        _sor
-00001e30: 746f 7264 6572 203d 2049 6e74 3332 4669  torder = Int32Fi
-00001e40: 656c 6428 2273 6f72 746f 7264 6572 2229  eld("sortorder")
-00001e50: 0a0a 2020 2020 2020 2020 4070 726f 7065  ..        @prope
-00001e60: 7274 790a 2020 2020 2020 2020 6465 6620  rty.        def 
-00001e70: 696e 6665 7272 6564 5f74 7970 6528 7365  inferred_type(se
-00001e80: 6c66 293a 0a20 2020 2020 2020 2020 2020  lf):.           
-00001e90: 2072 6574 7572 6e20 226d 6978 6564 220a   return "mixed".
-00001ea0: 0a20 2020 2020 2020 2040 7072 6f70 6572  .        @proper
-00001eb0: 7479 0a20 2020 2020 2020 2064 6566 206e  ty.        def n
-00001ec0: 616d 6573 2873 656c 6629 202d 3e20 6c69  ames(self) -> li
-00001ed0: 7374 3a0a 2020 2020 2020 2020 2020 2020  st:.            
-00001ee0: 7265 7475 726e 2073 656c 662e 5f6e 616d  return self._nam
-00001ef0: 6573 0a0a 2020 2020 2020 2020 6465 6620  es..        def 
-00001f00: 746f 5f70 616e 6461 7328 7365 6c66 293a  to_pandas(self):
-00001f10: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00001f20: 6120 3d20 6765 7461 7474 7228 7365 6c66  a = getattr(self
-00001f30: 2c20 225f 6461 7461 222c 204e 6f6e 6529  , "_data", None)
-00001f40: 0a20 2020 2020 2020 2020 2020 2073 6f72  .            sor
-00001f50: 746f 7264 6572 203d 2067 6574 6174 7472  torder = getattr
-00001f60: 2873 656c 662c 2022 5f73 6f72 746f 7264  (self, "_sortord
-00001f70: 6572 222c 204e 6f6e 6529 0a0a 2020 2020  er", None)..    
-00001f80: 2020 2020 2020 2020 6465 6620 5f62 7569          def _bui
-00001f90: 6c64 5f65 6d70 7479 5f61 7272 6179 2864  ld_empty_array(d
-00001fa0: 7479 7065 293a 0a20 2020 2020 2020 2020  type):.         
-00001fb0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00001fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001fd0: 7265 7475 726e 206e 702e 6172 7261 7928  return np.array(
-00001fe0: 5b5d 2c20 6474 7970 653d 6474 7970 6529  [], dtype=dtype)
-00001ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002000: 2065 7863 6570 7420 5479 7065 4572 726f   except TypeErro
-00002010: 723a 2020 2320 7072 6167 6d61 3a20 6e6f  r:  # pragma: no
-00002020: 2063 6f76 6572 0a20 2020 2020 2020 2020   cover.         
-00002030: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00002040: 6e20 7064 2e61 7272 6179 285b 5d2c 2064  n pd.array([], d
-00002050: 7479 7065 3d64 7479 7065 290a 0a20 2020  type=dtype)..   
-00002060: 2020 2020 2020 2020 2069 6620 6461 7461           if data
-00002070: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00002080: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00002090: 2070 642e 4d75 6c74 6949 6e64 6578 2e66   pd.MultiIndex.f
-000020a0: 726f 6d5f 6172 7261 7973 280a 2020 2020  rom_arrays(.    
-000020b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000020c0: 5b5f 6275 696c 645f 656d 7074 795f 6172  [_build_empty_ar
-000020d0: 7261 7928 6474 7970 6529 2066 6f72 2064  ray(dtype) for d
-000020e0: 7479 7065 2069 6e20 7365 6c66 2e5f 6474  type in self._dt
-000020f0: 7970 6573 5d2c 0a20 2020 2020 2020 2020  ypes],.         
-00002100: 2020 2020 2020 2020 2020 2073 6f72 746f             sorto
-00002110: 7264 6572 3d73 6f72 746f 7264 6572 2c0a  rder=sortorder,.
-00002120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002130: 2020 2020 6e61 6d65 733d 7365 6c66 2e5f      names=self._
-00002140: 6e61 6d65 732c 0a20 2020 2020 2020 2020  names,.         
-00002150: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00002160: 2020 2020 2072 6574 7572 6e20 7064 2e4d       return pd.M
-00002170: 756c 7469 496e 6465 782e 6672 6f6d 5f74  ultiIndex.from_t
-00002180: 7570 6c65 7328 0a20 2020 2020 2020 2020  uples(.         
-00002190: 2020 2020 2020 205b 7475 706c 6528 6429         [tuple(d)
-000021a0: 2066 6f72 2064 2069 6e20 6461 7461 5d2c   for d in data],
-000021b0: 2073 6f72 746f 7264 6572 3d73 6f72 746f   sortorder=sorto
-000021c0: 7264 6572 2c20 6e61 6d65 733d 7365 6c66  rder, names=self
-000021d0: 2e5f 6e61 6d65 730a 2020 2020 2020 2020  ._names.        
-000021e0: 2020 2020 290a 0a20 2020 205f 696e 6465      )..    _inde
-000021f0: 785f 7661 6c75 6520 3d20 4f6e 654f 6646  x_value = OneOfF
-00002200: 6965 6c64 280a 2020 2020 2020 2020 2269  ield(.        "i
-00002210: 6e64 6578 5f76 616c 7565 222c 0a20 2020  ndex_value",.   
-00002220: 2020 2020 2069 6e64 6578 3d49 6e64 6578       index=Index
-00002230: 2c0a 2020 2020 2020 2020 7261 6e67 655f  ,.        range_
-00002240: 696e 6465 783d 5261 6e67 6549 6e64 6578  index=RangeIndex
-00002250: 2c0a 2020 2020 2020 2020 6361 7465 676f  ,.        catego
-00002260: 7269 6361 6c5f 696e 6465 783d 4361 7465  rical_index=Cate
-00002270: 676f 7269 6361 6c49 6e64 6578 2c0a 2020  goricalIndex,.  
-00002280: 2020 2020 2020 696e 7465 7276 616c 5f69        interval_i
-00002290: 6e64 6578 3d49 6e74 6572 7661 6c49 6e64  ndex=IntervalInd
-000022a0: 6578 2c0a 2020 2020 2020 2020 6461 7465  ex,.        date
-000022b0: 7469 6d65 5f69 6e64 6578 3d44 6174 6574  time_index=Datet
-000022c0: 696d 6549 6e64 6578 2c0a 2020 2020 2020  imeIndex,.      
-000022d0: 2020 7469 6d65 6465 6c74 615f 696e 6465    timedelta_inde
-000022e0: 783d 5469 6d65 6465 6c74 6149 6e64 6578  x=TimedeltaIndex
-000022f0: 2c0a 2020 2020 2020 2020 7065 7269 6f64  ,.        period
-00002300: 5f69 6e64 6578 3d50 6572 696f 6449 6e64  _index=PeriodInd
-00002310: 6578 2c0a 2020 2020 2020 2020 696e 7436  ex,.        int6
-00002320: 345f 696e 6465 783d 496e 7436 3449 6e64  4_index=Int64Ind
-00002330: 6578 2c0a 2020 2020 2020 2020 7569 6e74  ex,.        uint
-00002340: 3634 5f69 6e64 6578 3d55 496e 7436 3449  64_index=UInt64I
-00002350: 6e64 6578 2c0a 2020 2020 2020 2020 666c  ndex,.        fl
-00002360: 6f61 7436 345f 696e 6465 783d 466c 6f61  oat64_index=Floa
-00002370: 7436 3449 6e64 6578 2c0a 2020 2020 2020  t64Index,.      
-00002380: 2020 6d75 6c74 695f 696e 6465 783d 4d75    multi_index=Mu
-00002390: 6c74 6949 6e64 6578 2c0a 2020 2020 290a  ltiIndex,.    ).
-000023a0: 0a20 2020 2064 6566 205f 5f6d 6172 735f  .    def __mars_
-000023b0: 746f 6b65 6e69 7a65 5f5f 2873 656c 6629  tokenize__(self)
-000023c0: 3a0a 2020 2020 2020 2020 2320 7265 7475  :.        # retu
-000023d0: 726e 206f 626a 6563 7420 666f 7220 746f  rn object for to
-000023e0: 6b65 6e69 7a65 0a20 2020 2020 2020 2076  kenize.        v
-000023f0: 203d 2073 656c 662e 5f69 6e64 6578 5f76   = self._index_v
-00002400: 616c 7565 0a20 2020 2020 2020 2072 6574  alue.        ret
-00002410: 7572 6e20 762e 5f6b 6579 0a0a 2020 2020  urn v._key..    
-00002420: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00002430: 6620 7661 6c75 6528 7365 6c66 293a 0a20  f value(self):. 
-00002440: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00002450: 6c66 2e5f 696e 6465 785f 7661 6c75 650a  lf._index_value.
-00002460: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00002470: 2020 2064 6566 206b 6579 2873 656c 6629     def key(self)
-00002480: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00002490: 2073 656c 662e 5f69 6e64 6578 5f76 616c   self._index_val
-000024a0: 7565 2e6b 6579 0a0a 2020 2020 4070 726f  ue.key..    @pro
-000024b0: 7065 7274 790a 2020 2020 6465 6620 6973  perty.    def is
-000024c0: 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63 7265  _monotonic_incre
-000024d0: 6173 696e 6728 7365 6c66 293a 0a20 2020  asing(self):.   
-000024e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000024f0: 2e5f 696e 6465 785f 7661 6c75 652e 6973  ._index_value.is
-00002500: 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63 7265  _monotonic_incre
-00002510: 6173 696e 670a 0a20 2020 2040 7072 6f70  asing..    @prop
-00002520: 6572 7479 0a20 2020 2064 6566 2069 735f  erty.    def is_
-00002530: 6d6f 6e6f 746f 6e69 635f 6465 6372 6561  monotonic_decrea
-00002540: 7369 6e67 2873 656c 6629 3a0a 2020 2020  sing(self):.    
-00002550: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00002560: 5f69 6e64 6578 5f76 616c 7565 2e69 735f  _index_value.is_
-00002570: 6d6f 6e6f 746f 6e69 635f 6465 6372 6561  monotonic_decrea
-00002580: 7369 6e67 0a0a 2020 2020 4070 726f 7065  sing..    @prope
-00002590: 7274 790a 2020 2020 6465 6620 6973 5f6d  rty.    def is_m
-000025a0: 6f6e 6f74 6f6e 6963 5f69 6e63 7265 6173  onotonic_increas
-000025b0: 696e 675f 6f72 5f64 6563 7265 6173 696e  ing_or_decreasin
-000025c0: 6728 7365 6c66 293a 0a20 2020 2020 2020  g(self):.       
-000025d0: 2072 6574 7572 6e20 7365 6c66 2e69 735f   return self.is_
-000025e0: 6d6f 6e6f 746f 6e69 635f 696e 6372 6561  monotonic_increa
-000025f0: 7369 6e67 206f 7220 7365 6c66 2e69 735f  sing or self.is_
-00002600: 6d6f 6e6f 746f 6e69 635f 6465 6372 6561  monotonic_decrea
-00002610: 7369 6e67 0a0a 2020 2020 4070 726f 7065  sing..    @prope
-00002620: 7274 790a 2020 2020 6465 6620 6973 5f75  rty.    def is_u
-00002630: 6e69 7175 6528 7365 6c66 293a 0a20 2020  nique(self):.   
-00002640: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00002650: 2e5f 696e 6465 785f 7661 6c75 652e 6973  ._index_value.is
-00002660: 5f75 6e69 7175 650a 0a20 2020 2040 7072  _unique..    @pr
-00002670: 6f70 6572 7479 0a20 2020 2064 6566 206d  operty.    def m
-00002680: 696e 5f76 616c 2873 656c 6629 3a0a 2020  in_val(self):.  
-00002690: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000026a0: 662e 5f69 6e64 6578 5f76 616c 7565 2e6d  f._index_value.m
-000026b0: 696e 5f76 616c 0a0a 2020 2020 4070 726f  in_val..    @pro
-000026c0: 7065 7274 790a 2020 2020 6465 6620 6d69  perty.    def mi
-000026d0: 6e5f 7661 6c5f 636c 6f73 6528 7365 6c66  n_val_close(self
-000026e0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-000026f0: 6e20 7365 6c66 2e5f 696e 6465 785f 7661  n self._index_va
-00002700: 6c75 652e 6d69 6e5f 7661 6c5f 636c 6f73  lue.min_val_clos
-00002710: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
-00002720: 0a20 2020 2064 6566 206d 6178 5f76 616c  .    def max_val
-00002730: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00002740: 7265 7475 726e 2073 656c 662e 5f69 6e64  return self._ind
-00002750: 6578 5f76 616c 7565 2e6d 6178 5f76 616c  ex_value.max_val
-00002760: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00002770: 2020 2020 6465 6620 6d61 785f 7661 6c5f      def max_val_
-00002780: 636c 6f73 6528 7365 6c66 293a 0a20 2020  close(self):.   
-00002790: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000027a0: 2e5f 696e 6465 785f 7661 6c75 652e 6d61  ._index_value.ma
-000027b0: 785f 7661 6c5f 636c 6f73 650a 0a20 2020  x_val_close..   
-000027c0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-000027d0: 6566 206d 696e 5f6d 6178 2873 656c 6629  ef min_max(self)
-000027e0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000027f0: 2028 0a20 2020 2020 2020 2020 2020 2073   (.            s
-00002800: 656c 662e 5f69 6e64 6578 5f76 616c 7565  elf._index_value
-00002810: 2e6d 696e 5f76 616c 2c0a 2020 2020 2020  .min_val,.      
-00002820: 2020 2020 2020 7365 6c66 2e5f 696e 6465        self._inde
-00002830: 785f 7661 6c75 652e 6d69 6e5f 7661 6c5f  x_value.min_val_
-00002840: 636c 6f73 652c 0a20 2020 2020 2020 2020  close,.         
-00002850: 2020 2073 656c 662e 5f69 6e64 6578 5f76     self._index_v
-00002860: 616c 7565 2e6d 6178 5f76 616c 2c0a 2020  alue.max_val,.  
-00002870: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00002880: 696e 6465 785f 7661 6c75 652e 6d61 785f  index_value.max_
-00002890: 7661 6c5f 636c 6f73 652c 0a20 2020 2020  val_close,.     
-000028a0: 2020 2029 0a0a 2020 2020 4070 726f 7065     )..    @prope
-000028b0: 7274 790a 2020 2020 6465 6620 6e61 6d65  rty.    def name
-000028c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000028d0: 7265 7475 726e 2067 6574 6174 7472 2873  return getattr(s
-000028e0: 656c 662e 5f69 6e64 6578 5f76 616c 7565  elf._index_value
-000028f0: 2c20 225f 6e61 6d65 222c 204e 6f6e 6529  , "_name", None)
-00002900: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00002910: 2020 2020 6465 6620 696e 6665 7272 6564      def inferred
-00002920: 5f74 7970 6528 7365 6c66 293a 0a20 2020  _type(self):.   
-00002930: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00002940: 2e5f 696e 6465 785f 7661 6c75 652e 696e  ._index_value.in
-00002950: 6665 7272 6564 5f74 7970 650a 0a20 2020  ferred_type..   
-00002960: 2064 6566 2068 6173 5f76 616c 7565 2873   def has_value(s
-00002970: 656c 6629 3a0a 2020 2020 2020 2020 6966  elf):.        if
-00002980: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
-00002990: 2e5f 696e 6465 785f 7661 6c75 652c 2073  ._index_value, s
-000029a0: 656c 662e 5261 6e67 6549 6e64 6578 293a  elf.RangeIndex):
-000029b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000029c0: 6e70 2e69 736e 616e 2873 656c 662e 5f69  np.isnan(self._i
-000029d0: 6e64 6578 5f76 616c 7565 2e6d 6178 5f76  ndex_value.max_v
-000029e0: 616c 293a 0a20 2020 2020 2020 2020 2020  al):.           
-000029f0: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
-00002a00: 650a 2020 2020 2020 2020 2020 2020 656c  e.            el
-00002a10: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00002a20: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
-00002a30: 2020 2020 2020 2020 656c 6966 2067 6574          elif get
-00002a40: 6174 7472 2873 656c 662e 5f69 6e64 6578  attr(self._index
-00002a50: 5f76 616c 7565 2c20 225f 6461 7461 222c  _value, "_data",
-00002a60: 204e 6f6e 6529 2069 7320 6e6f 7420 4e6f   None) is not No
-00002a70: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00002a80: 7265 7475 726e 2054 7275 650a 2020 2020  return True.    
-00002a90: 2020 2020 7265 7475 726e 2046 616c 7365      return False
-00002aa0: 0a0a 2020 2020 6465 6620 746f 5f70 616e  ..    def to_pan
-00002ab0: 6461 7328 7365 6c66 293a 0a20 2020 2020  das(self):.     
-00002ac0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00002ad0: 696e 6465 785f 7661 6c75 652e 746f 5f70  index_value.to_p
-00002ae0: 616e 6461 7328 290a 0a0a 636c 6173 7320  andas()...class 
-00002af0: 4474 7970 6573 5661 6c75 6528 5365 7269  DtypesValue(Seri
-00002b00: 616c 697a 6162 6c65 293a 0a20 2020 2022  alizable):.    "
-00002b10: 2222 0a20 2020 204d 6574 6120 636c 6173  "".    Meta clas
-00002b20: 7320 666f 7220 6474 7970 6573 2e0a 2020  s for dtypes..  
-00002b30: 2020 2222 220a 0a20 2020 205f 5f73 6c6f    """..    __slo
-00002b40: 7473 5f5f 203d 2028 290a 0a20 2020 205f  ts__ = ()..    _
-00002b50: 6b65 7920 3d20 5374 7269 6e67 4669 656c  key = StringFiel
-00002b60: 6428 226b 6579 2229 0a20 2020 205f 7661  d("key").    _va
-00002b70: 6c75 6520 3d20 5365 7269 6573 4669 656c  lue = SeriesFiel
-00002b80: 6428 2276 616c 7565 2229 0a0a 2020 2020  d("value")..    
-00002b90: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-00002ba0: 662c 206b 6579 3d4e 6f6e 652c 2076 616c  f, key=None, val
-00002bb0: 7565 3d4e 6f6e 652c 202a 2a6b 7729 3a0a  ue=None, **kw):.
-00002bc0: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-00002bd0: 5f5f 696e 6974 5f5f 285f 6b65 793d 6b65  __init__(_key=ke
-00002be0: 792c 205f 7661 6c75 653d 7661 6c75 652c  y, _value=value,
-00002bf0: 202a 2a6b 7729 0a20 2020 2020 2020 2069   **kw).        i
-00002c00: 6620 7365 6c66 2e5f 6b65 7920 6973 204e  f self._key is N
-00002c10: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00002c20: 2073 656c 662e 5f6b 6579 203d 2074 6f6b   self._key = tok
-00002c30: 656e 697a 6528 7365 6c66 2e5f 7661 6c75  enize(self._valu
-00002c40: 6529 0a0a 2020 2020 4070 726f 7065 7274  e)..    @propert
-00002c50: 790a 2020 2020 6465 6620 6b65 7928 7365  y.    def key(se
-00002c60: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00002c70: 7572 6e20 7365 6c66 2e5f 6b65 790a 0a20  urn self._key.. 
-00002c80: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00002c90: 2064 6566 2076 616c 7565 2873 656c 6629   def value(self)
-00002ca0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00002cb0: 2073 656c 662e 5f76 616c 7565 0a0a 0a64   self._value...d
-00002cc0: 6566 2072 6566 7265 7368 5f69 6e64 6578  ef refresh_index
-00002cd0: 5f76 616c 7565 2874 696c 6561 626c 653a  _value(tileable:
-00002ce0: 2045 4e54 4954 595f 5459 5045 293a 0a20   ENTITY_TYPE):. 
-00002cf0: 2020 2069 6e64 6578 5f74 6f5f 696e 6465     index_to_inde
-00002d00: 785f 7661 6c75 6573 203d 2064 6963 7428  x_values = dict(
-00002d10: 290a 2020 2020 666f 7220 6368 756e 6b20  ).    for chunk 
-00002d20: 696e 2074 696c 6561 626c 652e 6368 756e  in tileable.chun
-00002d30: 6b73 3a0a 2020 2020 2020 2020 6966 2063  ks:.        if c
-00002d40: 6875 6e6b 2e6e 6469 6d20 3d3d 2031 3a0a  hunk.ndim == 1:.
-00002d50: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-00002d60: 785f 746f 5f69 6e64 6578 5f76 616c 7565  x_to_index_value
-00002d70: 735b 6368 756e 6b2e 696e 6465 785d 203d  s[chunk.index] =
-00002d80: 2063 6875 6e6b 2e69 6e64 6578 5f76 616c   chunk.index_val
-00002d90: 7565 0a20 2020 2020 2020 2065 6c69 6620  ue.        elif 
-00002da0: 6368 756e 6b2e 696e 6465 785b 315d 203d  chunk.index[1] =
-00002db0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-00002dc0: 2069 6e64 6578 5f74 6f5f 696e 6465 785f   index_to_index_
-00002dd0: 7661 6c75 6573 5b63 6875 6e6b 2e69 6e64  values[chunk.ind
-00002de0: 6578 5d20 3d20 6368 756e 6b2e 696e 6465  ex] = chunk.inde
-00002df0: 785f 7661 6c75 650a 2020 2020 696e 6465  x_value.    inde
-00002e00: 785f 7661 6c75 6520 3d20 6d65 7267 655f  x_value = merge_
-00002e10: 696e 6465 785f 7661 6c75 6528 696e 6465  index_value(inde
-00002e20: 785f 746f 5f69 6e64 6578 5f76 616c 7565  x_to_index_value
-00002e30: 732c 2073 746f 7265 5f64 6174 613d 4661  s, store_data=Fa
-00002e40: 6c73 6529 0a20 2020 2023 206b 6565 7020  lse).    # keep 
-00002e50: 6b65 7920 6173 206f 7269 6769 6e61 6c20  key as original 
-00002e60: 696e 6465 785f 7661 6c75 6527 730a 2020  index_value's.  
-00002e70: 2020 6966 2074 696c 6561 626c 652e 696e    if tileable.in
-00002e80: 6465 785f 7661 6c75 6520 6973 206e 6f74  dex_value is not
-00002e90: 204e 6f6e 653a 0a20 2020 2020 2020 2069   None:.        i
-00002ea0: 6e64 6578 5f76 616c 7565 2e5f 696e 6465  ndex_value._inde
-00002eb0: 785f 7661 6c75 652e 5f6b 6579 203d 2074  x_value._key = t
-00002ec0: 696c 6561 626c 652e 696e 6465 785f 7661  ileable.index_va
-00002ed0: 6c75 652e 6b65 790a 2020 2020 7469 6c65  lue.key.    tile
-00002ee0: 6162 6c65 2e5f 696e 6465 785f 7661 6c75  able._index_valu
-00002ef0: 6520 3d20 696e 6465 785f 7661 6c75 650a  e = index_value.
-00002f00: 0a0a 6465 6620 7265 6672 6573 685f 6474  ..def refresh_dt
-00002f10: 7970 6573 2874 696c 6561 626c 653a 2045  ypes(tileable: E
-00002f20: 4e54 4954 595f 5459 5045 293a 0a20 2020  NTITY_TYPE):.   
-00002f30: 2061 6c6c 5f64 7479 7065 7320 3d20 5b63   all_dtypes = [c
-00002f40: 2e64 7479 7065 735f 7661 6c75 652e 7661  .dtypes_value.va
-00002f50: 6c75 6520 666f 7220 6320 696e 2074 696c  lue for c in til
-00002f60: 6561 626c 652e 6368 756e 6b73 2069 6620  eable.chunks if 
-00002f70: 632e 696e 6465 785b 305d 203d 3d20 305d  c.index[0] == 0]
-00002f80: 0a20 2020 2064 7479 7065 7320 3d20 7064  .    dtypes = pd
-00002f90: 2e63 6f6e 6361 7428 616c 6c5f 6474 7970  .concat(all_dtyp
-00002fa0: 6573 290a 2020 2020 7469 6c65 6162 6c65  es).    tileable
-00002fb0: 2e5f 6474 7970 6573 203d 2064 7479 7065  ._dtypes = dtype
-00002fc0: 730a 2020 2020 636f 6c75 6d6e 735f 7661  s.    columns_va
-00002fd0: 6c75 6573 203d 2070 6172 7365 5f69 6e64  lues = parse_ind
-00002fe0: 6578 2864 7479 7065 732e 696e 6465 782c  ex(dtypes.index,
-00002ff0: 2073 746f 7265 5f64 6174 613d 5472 7565   store_data=True
-00003000: 290a 2020 2020 7469 6c65 6162 6c65 2e5f  ).    tileable._
-00003010: 636f 6c75 6d6e 735f 7661 6c75 6520 3d20  columns_value = 
-00003020: 636f 6c75 6d6e 735f 7661 6c75 6573 0a20  columns_values. 
-00003030: 2020 2074 696c 6561 626c 652e 5f64 7479     tileable._dty
-00003040: 7065 735f 7661 6c75 6520 3d20 4474 7970  pes_value = Dtyp
-00003050: 6573 5661 6c75 6528 6b65 793d 746f 6b65  esValue(key=toke
-00003060: 6e69 7a65 2864 7479 7065 7329 2c20 7661  nize(dtypes), va
-00003070: 6c75 653d 6474 7970 6573 290a 0a0a 5f74  lue=dtypes)..._t
-00003080: 696c 6561 626c 655f 6b65 795f 7072 6f70  ileable_key_prop
-00003090: 6572 7479 203d 2022 5f74 696c 6561 626c  erty = "_tileabl
-000030a0: 655f 6b65 7922 0a5f 7469 6c65 6162 6c65  e_key"._tileable
-000030b0: 5f64 7479 7065 735f 7072 6f70 6572 7479  _dtypes_property
-000030c0: 203d 2022 5f74 696c 6561 626c 655f 6474   = "_tileable_dt
-000030d0: 7970 6573 220a 5f74 696c 6561 626c 655f  ypes"._tileable_
-000030e0: 696e 6465 785f 7661 6c75 655f 7072 6f70  index_value_prop
-000030f0: 6572 7479 203d 2022 5f74 696c 6561 626c  erty = "_tileabl
-00003100: 655f 696e 6465 785f 7661 6c75 6522 0a5f  e_index_value"._
-00003110: 7469 6c65 6162 6c65 5f63 6f6c 756d 6e73  tileable_columns
-00003120: 5f76 616c 7565 5f70 726f 7065 7274 7920  _value_property 
-00003130: 3d20 225f 7469 6c65 6162 6c65 5f63 6f6c  = "_tileable_col
-00003140: 756d 6e73 5f76 616c 7565 220a 5f6e 7370  umns_value"._nsp
-00003150: 6c69 7473 5f70 726f 7065 7274 7920 3d20  lits_property = 
-00003160: 225f 7469 6c65 6162 6c65 5f6e 7370 6c69  "_tileable_nspli
-00003170: 7473 220a 5f6c 617a 795f 6368 756e 6b5f  ts"._lazy_chunk_
-00003180: 6d65 7461 5f70 726f 7065 7274 6965 7320  meta_properties 
-00003190: 3d20 280a 2020 2020 5f74 696c 6561 626c  = (.    _tileabl
-000031a0: 655f 6b65 795f 7072 6f70 6572 7479 2c0a  e_key_property,.
-000031b0: 2020 2020 5f74 696c 6561 626c 655f 6474      _tileable_dt
-000031c0: 7970 6573 5f70 726f 7065 7274 792c 0a20  ypes_property,. 
-000031d0: 2020 205f 7469 6c65 6162 6c65 5f69 6e64     _tileable_ind
-000031e0: 6578 5f76 616c 7565 5f70 726f 7065 7274  ex_value_propert
-000031f0: 792c 0a20 2020 205f 7469 6c65 6162 6c65  y,.    _tileable
-00003200: 5f63 6f6c 756d 6e73 5f76 616c 7565 5f70  _columns_value_p
-00003210: 726f 7065 7274 792c 0a20 2020 205f 6e73  roperty,.    _ns
-00003220: 706c 6974 735f 7072 6f70 6572 7479 2c0a  plits_property,.
-00003230: 290a 0a0a 636c 6173 7320 4c61 7a79 4d65  )...class LazyMe
-00003240: 7461 4368 756e 6b44 6174 6128 4368 756e  taChunkData(Chun
-00003250: 6b44 6174 6129 3a0a 2020 2020 5f5f 736c  kData):.    __sl
-00003260: 6f74 735f 5f20 3d20 5f6c 617a 795f 6368  ots__ = _lazy_ch
-00003270: 756e 6b5f 6d65 7461 5f70 726f 7065 7274  unk_meta_propert
-00003280: 6965 730a 0a20 2020 2064 6566 205f 7365  ies..    def _se
-00003290: 745f 7469 6c65 6162 6c65 5f6d 6574 6128  t_tileable_meta(
-000032a0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-000032b0: 2020 2020 2020 2074 696c 6561 626c 655f         tileable_
-000032c0: 6b65 793a 2073 7472 203d 204e 6f6e 652c  key: str = None,
-000032d0: 0a20 2020 2020 2020 206e 7370 6c69 7473  .        nsplits
-000032e0: 3a20 5475 706c 655b 5475 706c 655b 696e  : Tuple[Tuple[in
-000032f0: 742c 202e 2e2e 5d5d 203d 204e 6f6e 652c  t, ...]] = None,
-00003300: 0a20 2020 2020 2020 2069 6e64 6578 5f76  .        index_v
-00003310: 616c 7565 3a20 496e 6465 7856 616c 7565  alue: IndexValue
-00003320: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00003330: 2063 6f6c 756d 6e73 5f76 616c 7565 3a20   columns_value: 
-00003340: 496e 6465 7856 616c 7565 203d 204e 6f6e  IndexValue = Non
-00003350: 652c 0a20 2020 2020 2020 2064 7479 7065  e,.        dtype
-00003360: 733a 2070 642e 5365 7269 6573 203d 204e  s: pd.Series = N
-00003370: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
-00003380: 2020 2020 7365 7461 7474 7228 7365 6c66      setattr(self
-00003390: 2c20 5f74 696c 6561 626c 655f 6b65 795f  , _tileable_key_
-000033a0: 7072 6f70 6572 7479 2c20 7469 6c65 6162  property, tileab
-000033b0: 6c65 5f6b 6579 290a 2020 2020 2020 2020  le_key).        
-000033c0: 7365 7461 7474 7228 7365 6c66 2c20 5f6e  setattr(self, _n
-000033d0: 7370 6c69 7473 5f70 726f 7065 7274 792c  splits_property,
-000033e0: 206e 7370 6c69 7473 290a 2020 2020 2020   nsplits).      
-000033f0: 2020 7365 7461 7474 7228 7365 6c66 2c20    setattr(self, 
-00003400: 5f74 696c 6561 626c 655f 696e 6465 785f  _tileable_index_
-00003410: 7661 6c75 655f 7072 6f70 6572 7479 2c20  value_property, 
-00003420: 696e 6465 785f 7661 6c75 6529 0a20 2020  index_value).   
-00003430: 2020 2020 2073 6574 6174 7472 2873 656c       setattr(sel
-00003440: 662c 205f 7469 6c65 6162 6c65 5f63 6f6c  f, _tileable_col
-00003450: 756d 6e73 5f76 616c 7565 5f70 726f 7065  umns_value_prope
-00003460: 7274 792c 2063 6f6c 756d 6e73 5f76 616c  rty, columns_val
-00003470: 7565 290a 2020 2020 2020 2020 7365 7461  ue).        seta
-00003480: 7474 7228 7365 6c66 2c20 5f74 696c 6561  ttr(self, _tilea
-00003490: 626c 655f 6474 7970 6573 5f70 726f 7065  ble_dtypes_prope
-000034a0: 7274 792c 2064 7479 7065 7329 0a0a 0a64  rty, dtypes)...d
-000034b0: 6566 2069 735f 6368 756e 6b5f 6d65 7461  ef is_chunk_meta
-000034c0: 5f6c 617a 7928 6368 756e 6b3a 2043 6875  _lazy(chunk: Chu
-000034d0: 6e6b 4461 7461 2920 2d3e 2062 6f6f 6c3a  nkData) -> bool:
-000034e0: 0a20 2020 2063 6875 6e6b 203d 2063 6875  .    chunk = chu
-000034f0: 6e6b 2e64 6174 6120 6966 2068 6173 6174  nk.data if hasat
-00003500: 7472 2863 6875 6e6b 2c20 2264 6174 6122  tr(chunk, "data"
-00003510: 2920 656c 7365 2063 6875 6e6b 0a20 2020  ) else chunk.   
-00003520: 2072 6574 7572 6e20 6973 696e 7374 616e   return isinstan
-00003530: 6365 2863 6875 6e6b 2c20 4c61 7a79 4d65  ce(chunk, LazyMe
-00003540: 7461 4368 756e 6b44 6174 6129 2061 6e64  taChunkData) and
-00003550: 2068 6173 6174 7472 280a 2020 2020 2020   hasattr(.      
-00003560: 2020 6368 756e 6b2c 205f 7469 6c65 6162    chunk, _tileab
-00003570: 6c65 5f6b 6579 5f70 726f 7065 7274 790a  le_key_property.
-00003580: 2020 2020 290a 0a0a 4066 756e 6374 6f6f      )...@functoo
-00003590: 6c73 2e6c 7275 5f63 6163 6865 286d 6178  ls.lru_cache(max
-000035a0: 7369 7a65 3d31 3238 290a 6465 6620 5f67  size=128).def _g
-000035b0: 6574 5f63 756d 5f6e 7370 6c69 7428 6e73  et_cum_nsplit(ns
-000035c0: 706c 6974 3a20 5475 706c 655b 696e 745d  plit: Tuple[int]
-000035d0: 2920 2d3e 204c 6973 745b 696e 745d 3a0a  ) -> List[int]:.
-000035e0: 2020 2020 7265 7475 726e 205b 305d 202b      return [0] +
-000035f0: 206e 702e 6375 6d73 756d 286e 7370 6c69   np.cumsum(nspli
-00003600: 7429 2e74 6f6c 6973 7428 290a 0a0a 6465  t).tolist()...de
-00003610: 6620 5f63 616c 635f 6178 6973 5f73 6c69  f _calc_axis_sli
-00003620: 6365 286e 7370 6c69 743a 2054 7570 6c65  ce(nsplit: Tuple
-00003630: 5b69 6e74 5d2c 2069 6e64 6578 3a20 696e  [int], index: in
-00003640: 7429 202d 3e20 736c 6963 653a 0a20 2020  t) -> slice:.   
-00003650: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-00003660: 6365 286e 7370 6c69 742c 2074 7570 6c65  ce(nsplit, tuple
-00003670: 293a 0a20 2020 2020 2020 206e 7370 6c69  ):.        nspli
-00003680: 7420 3d20 7475 706c 6528 6e73 706c 6974  t = tuple(nsplit
-00003690: 290a 2020 2020 6375 6d5f 6e73 706c 6974  ).    cum_nsplit
-000036a0: 203d 205f 6765 745f 6375 6d5f 6e73 706c   = _get_cum_nspl
-000036b0: 6974 286e 7370 6c69 7429 0a20 2020 2072  it(nsplit).    r
-000036c0: 6574 7572 6e20 736c 6963 6528 6375 6d5f  eturn slice(cum_
-000036d0: 6e73 706c 6974 5b69 6e64 6578 5d2c 2063  nsplit[index], c
-000036e0: 756d 5f6e 7370 6c69 745b 696e 6465 7820  um_nsplit[index 
-000036f0: 2b20 315d 290a 0a0a 636c 6173 7320 4368  + 1])...class Ch
-00003700: 756e 6b44 7479 7065 7346 6965 6c64 2853  unkDtypesField(S
-00003710: 6572 6965 7346 6965 6c64 293a 0a20 2020  eriesField):.   
-00003720: 205f 7469 6c65 6162 6c65 5f6b 6579 5f69   _tileable_key_i
-00003730: 6e64 6578 5f74 6f5f 6474 7970 6573 203d  ndex_to_dtypes =
-00003740: 2064 6963 7428 290a 0a20 2020 2040 7374   dict()..    @st
-00003750: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
-00003760: 6566 205f 6765 6e5f 6368 756e 6b5f 6474  ef _gen_chunk_dt
-00003770: 7970 6573 2869 6e73 7461 6e63 653a 2043  ypes(instance: C
-00003780: 6875 6e6b 2c20 696e 6465 783a 2069 6e74  hunk, index: int
-00003790: 2920 2d3e 204f 7074 696f 6e61 6c5b 7064  ) -> Optional[pd
-000037a0: 2e53 6572 6965 735d 3a0a 2020 2020 2020  .Series]:.      
-000037b0: 2020 2320 6474 7970 6573 206f 6620 7469    # dtypes of ti
-000037c0: 6c65 6162 6c65 0a20 2020 2020 2020 2074  leable.        t
-000037d0: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-000037e0: 7469 6c65 6162 6c65 5f6b 6579 203d 2067  tileable_key = g
-000037f0: 6574 6174 7472 2869 6e73 7461 6e63 652c  etattr(instance,
-00003800: 205f 7469 6c65 6162 6c65 5f6b 6579 5f70   _tileable_key_p
-00003810: 726f 7065 7274 7929 0a20 2020 2020 2020  roperty).       
-00003820: 2065 7863 6570 7420 4174 7472 6962 7574   except Attribut
-00003830: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
-00003840: 2020 2020 7265 7475 726e 0a20 2020 2020      return.     
-00003850: 2020 2063 6163 6865 203d 2043 6875 6e6b     cache = Chunk
-00003860: 4474 7970 6573 4669 656c 642e 5f74 696c  DtypesField._til
-00003870: 6561 626c 655f 6b65 795f 696e 6465 785f  eable_key_index_
-00003880: 746f 5f64 7479 7065 730a 2020 2020 2020  to_dtypes.      
-00003890: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-000038a0: 2020 2072 6574 7572 6e20 6361 6368 655b     return cache[
-000038b0: 7469 6c65 6162 6c65 5f6b 6579 2c20 696e  tileable_key, in
-000038c0: 6465 785d 0a20 2020 2020 2020 2065 7863  dex].        exc
-000038d0: 6570 7420 4b65 7945 7272 6f72 3a0a 2020  ept KeyError:.  
-000038e0: 2020 2020 2020 2020 2020 7469 6c65 6162            tileab
-000038f0: 6c65 5f64 7479 7065 7320 3d20 6765 7461  le_dtypes = geta
-00003900: 7474 7228 696e 7374 616e 6365 2c20 5f74  ttr(instance, _t
-00003910: 696c 6561 626c 655f 6474 7970 6573 5f70  ileable_dtypes_p
-00003920: 726f 7065 7274 7929 0a20 2020 2020 2020  roperty).       
-00003930: 2020 2020 2023 206e 7370 6c69 7473 206f       # nsplits o
-00003940: 6620 7469 6c65 6162 6c65 0a20 2020 2020  f tileable.     
-00003950: 2020 2020 2020 206e 7370 6c69 7473 203d         nsplits =
-00003960: 2067 6574 6174 7472 2869 6e73 7461 6e63   getattr(instanc
-00003970: 652c 205f 6e73 706c 6974 735f 7072 6f70  e, _nsplits_prop
-00003980: 6572 7479 295b 315d 0a20 2020 2020 2020  erty)[1].       
-00003990: 2020 2020 2023 2063 616c 6320 736c 6963       # calc slic
-000039a0: 650a 2020 2020 2020 2020 2020 2020 736c  e.            sl
-000039b0: 6320 3d20 5f63 616c 635f 6178 6973 5f73  c = _calc_axis_s
-000039c0: 6c69 6365 286e 7370 6c69 7473 2c20 696e  lice(nsplits, in
-000039d0: 6465 7829 0a20 2020 2020 2020 2020 2020  dex).           
-000039e0: 2064 7479 7065 7320 3d20 7469 6c65 6162   dtypes = tileab
-000039f0: 6c65 5f64 7479 7065 732e 696c 6f63 5b73  le_dtypes.iloc[s
-00003a00: 6c63 5d0a 2020 2020 2020 2020 2020 2020  lc].            
-00003a10: 6361 6368 655b 7469 6c65 6162 6c65 5f6b  cache[tileable_k
-00003a20: 6579 2c20 696e 6465 785d 203d 2064 7479  ey, index] = dty
-00003a30: 7065 730a 2020 2020 2020 2020 2020 2020  pes.            
-00003a40: 7265 7475 726e 2064 7479 7065 730a 0a20  return dtypes.. 
-00003a50: 2020 2064 6566 205f 5f67 6574 5f5f 2873     def __get__(s
-00003a60: 656c 662c 2069 6e73 7461 6e63 652c 206f  elf, instance, o
-00003a70: 776e 6572 3d4e 6f6e 6529 3a0a 2020 2020  wner=None):.    
-00003a80: 2020 2020 6966 206e 6f74 2069 7373 7562      if not issub
-00003a90: 636c 6173 7328 6f77 6e65 722c 204c 617a  class(owner, Laz
-00003aa0: 794d 6574 6143 6875 6e6b 4461 7461 293a  yMetaChunkData):
-00003ab0: 2020 2320 7072 6167 6d61 3a20 6e6f 2063    # pragma: no c
-00003ac0: 6f76 6572 0a20 2020 2020 2020 2020 2020  over.           
-00003ad0: 2072 6574 7572 6e20 7375 7065 7228 292e   return super().
-00003ae0: 5f5f 6765 745f 5f28 696e 7374 616e 6365  __get__(instance
-00003af0: 2c20 6f77 6e65 7229 0a0a 2020 2020 2020  , owner)..      
-00003b00: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00003b10: 2020 2076 616c 7565 203d 2073 656c 662e     value = self.
-00003b20: 6765 7428 696e 7374 616e 6365 2c20 6f77  get(instance, ow
-00003b30: 6e65 7229 0a20 2020 2020 2020 2020 2020  ner).           
-00003b40: 2069 6620 7661 6c75 6520 6973 206e 6f74   if value is not
-00003b50: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00003b60: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
-00003b70: 6c75 650a 2020 2020 2020 2020 6578 6365  lue.        exce
-00003b80: 7074 2041 7474 7269 6275 7465 4572 726f  pt AttributeErro
-00003b90: 723a 2020 2320 7072 6167 6d61 3a20 6e6f  r:  # pragma: no
-00003ba0: 2063 6f76 6572 0a20 2020 2020 2020 2020   cover.         
-00003bb0: 2020 2070 6173 730a 0a20 2020 2020 2020     pass..       
-00003bc0: 2069 6620 696e 7374 616e 6365 2e69 6e64   if instance.ind
-00003bd0: 6578 2069 7320 4e6f 6e65 3a0a 2020 2020  ex is None:.    
-00003be0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00003bf0: 7570 6572 2829 2e5f 5f67 6574 5f5f 2869  uper().__get__(i
-00003c00: 6e73 7461 6e63 652c 206f 776e 6572 290a  nstance, owner).
-00003c10: 0a20 2020 2020 2020 2023 2067 6574 2064  .        # get d
-00003c20: 7479 7065 7320 6c61 7a69 6c79 0a20 2020  types lazily.   
-00003c30: 2020 2020 2069 6e64 6578 203d 2069 6e73       index = ins
-00003c40: 7461 6e63 652e 696e 6465 785b 315d 0a20  tance.index[1]. 
-00003c50: 2020 2020 2020 2064 7479 7065 7320 3d20         dtypes = 
-00003c60: 7365 6c66 2e5f 6765 6e5f 6368 756e 6b5f  self._gen_chunk_
-00003c70: 6474 7970 6573 2869 6e73 7461 6e63 652c  dtypes(instance,
-00003c80: 2069 6e64 6578 290a 2020 2020 2020 2020   index).        
-00003c90: 2320 6361 6368 6520 6474 7970 6573 0a20  # cache dtypes. 
-00003ca0: 2020 2020 2020 2073 656c 662e 7365 7428         self.set(
-00003cb0: 696e 7374 616e 6365 2c20 6474 7970 6573  instance, dtypes
-00003cc0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00003cd0: 2064 7479 7065 730a 0a0a 636c 6173 7320   dtypes...class 
-00003ce0: 4368 756e 6b49 6e64 6578 5661 6c75 6546  ChunkIndexValueF
-00003cf0: 6965 6c64 2852 6566 6572 656e 6365 4669  ield(ReferenceFi
-00003d00: 656c 6429 3a0a 2020 2020 5f74 696c 6561  eld):.    _tilea
-00003d10: 626c 655f 6b65 795f 696e 6465 785f 746f  ble_key_index_to
-00003d20: 5f69 6e64 6578 5f76 616c 7565 203d 2064  _index_value = d
-00003d30: 6963 7428 290a 0a20 2020 2040 7374 6174  ict()..    @stat
-00003d40: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
-00003d50: 205f 6765 6e5f 6368 756e 6b5f 696e 6465   _gen_chunk_inde
-00003d60: 785f 7661 6c75 6528 696e 7374 616e 6365  x_value(instance
-00003d70: 3a20 4368 756e 6b2c 2069 6e64 6578 3a20  : Chunk, index: 
-00003d80: 696e 7429 202d 3e20 4f70 7469 6f6e 616c  int) -> Optional
-00003d90: 5b49 6e64 6578 5661 6c75 655d 3a0a 2020  [IndexValue]:.  
-00003da0: 2020 2020 2020 2320 696e 6465 785f 7661        # index_va
-00003db0: 6c75 6520 6f66 2074 696c 6561 626c 650a  lue of tileable.
-00003dc0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00003dd0: 2020 2020 2020 2020 2074 696c 6561 626c           tileabl
-00003de0: 655f 6b65 7920 3d20 6765 7461 7474 7228  e_key = getattr(
-00003df0: 696e 7374 616e 6365 2c20 5f74 696c 6561  instance, _tilea
-00003e00: 626c 655f 6b65 795f 7072 6f70 6572 7479  ble_key_property
-00003e10: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
-00003e20: 2041 7474 7269 6275 7465 4572 726f 723a   AttributeError:
-00003e30: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00003e40: 7572 6e0a 2020 2020 2020 2020 6361 6368  urn.        cach
-00003e50: 6520 3d20 4368 756e 6b49 6e64 6578 5661  e = ChunkIndexVa
-00003e60: 6c75 6546 6965 6c64 2e5f 7469 6c65 6162  lueField._tileab
-00003e70: 6c65 5f6b 6579 5f69 6e64 6578 5f74 6f5f  le_key_index_to_
-00003e80: 696e 6465 785f 7661 6c75 650a 2020 2020  index_value.    
-00003e90: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00003ea0: 2020 2020 2072 6574 7572 6e20 6361 6368       return cach
-00003eb0: 655b 7469 6c65 6162 6c65 5f6b 6579 2c20  e[tileable_key, 
-00003ec0: 696e 6465 785d 0a20 2020 2020 2020 2065  index].        e
-00003ed0: 7863 6570 7420 4b65 7945 7272 6f72 3a0a  xcept KeyError:.
-00003ee0: 2020 2020 2020 2020 2020 2020 7469 6c65              tile
-00003ef0: 6162 6c65 5f69 6e64 6578 5f76 616c 7565  able_index_value
-00003f00: 203d 2067 6574 6174 7472 2869 6e73 7461   = getattr(insta
-00003f10: 6e63 652c 205f 7469 6c65 6162 6c65 5f69  nce, _tileable_i
-00003f20: 6e64 6578 5f76 616c 7565 5f70 726f 7065  ndex_value_prope
-00003f30: 7274 7929 0a20 2020 2020 2020 2020 2020  rty).           
-00003f40: 2023 206e 7370 6c69 7473 206f 6620 7469   # nsplits of ti
-00003f50: 6c65 6162 6c65 0a20 2020 2020 2020 2020  leable.         
-00003f60: 2020 206e 7370 6c69 7420 3d20 6765 7461     nsplit = geta
-00003f70: 7474 7228 696e 7374 616e 6365 2c20 5f6e  ttr(instance, _n
-00003f80: 7370 6c69 7473 5f70 726f 7065 7274 7929  splits_property)
-00003f90: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-00003fa0: 2320 6361 6c63 2073 6c69 6365 0a20 2020  # calc slice.   
-00003fb0: 2020 2020 2020 2020 2073 6c63 203d 205f           slc = _
-00003fc0: 6361 6c63 5f61 7869 735f 736c 6963 6528  calc_axis_slice(
-00003fd0: 6e73 706c 6974 2c20 696e 6465 7829 0a20  nsplit, index). 
-00003fe0: 2020 2020 2020 2020 2020 2070 645f 696e             pd_in
-00003ff0: 6465 7820 3d20 7469 6c65 6162 6c65 5f69  dex = tileable_i
-00004000: 6e64 6578 5f76 616c 7565 2e74 6f5f 7061  ndex_value.to_pa
-00004010: 6e64 6173 2829 0a20 2020 2020 2020 2020  ndas().         
-00004020: 2020 2069 6620 6e70 2e69 736e 616e 2873     if np.isnan(s
-00004030: 6c63 2e73 746f 7020 2d20 736c 632e 7374  lc.stop - slc.st
-00004040: 6172 7429 3a0a 2020 2020 2020 2020 2020  art):.          
-00004050: 2020 2020 2020 6368 756e 6b5f 7064 5f69        chunk_pd_i
-00004060: 6e64 6578 203d 2070 645f 696e 6465 785b  ndex = pd_index[
-00004070: 3a30 5d0a 2020 2020 2020 2020 2020 2020  :0].            
-00004080: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00004090: 2020 2020 2020 6368 756e 6b5f 7064 5f69        chunk_pd_i
-000040a0: 6e64 6578 203d 2070 645f 696e 6465 785b  ndex = pd_index[
-000040b0: 736c 635d 0a20 2020 2020 2020 2020 2020  slc].           
-000040c0: 2069 6e64 6578 5f76 616c 7565 203d 2070   index_value = p
-000040d0: 6172 7365 5f69 6e64 6578 280a 2020 2020  arse_index(.    
-000040e0: 2020 2020 2020 2020 2020 2020 6368 756e              chun
-000040f0: 6b5f 7064 5f69 6e64 6578 2c0a 2020 2020  k_pd_index,.    
-00004100: 2020 2020 2020 2020 2020 2020 6b65 793d              key=
-00004110: 6622 7b74 696c 6561 626c 655f 696e 6465  f"{tileable_inde
-00004120: 785f 7661 6c75 652e 6b65 797d 5f69 6e64  x_value.key}_ind
-00004130: 6578 5f7b 696e 6465 787d 5f7b 736c 632e  ex_{index}_{slc.
-00004140: 7374 6172 747d 5f7b 736c 632e 7374 6f70  start}_{slc.stop
-00004150: 7d22 2c0a 2020 2020 2020 2020 2020 2020  }",.            
-00004160: 290a 2020 2020 2020 2020 2020 2020 6361  ).            ca
-00004170: 6368 655b 7469 6c65 6162 6c65 5f6b 6579  che[tileable_key
-00004180: 2c20 696e 6465 785d 203d 2069 6e64 6578  , index] = index
-00004190: 5f76 616c 7565 0a20 2020 2020 2020 2020  _value.         
-000041a0: 2020 2072 6574 7572 6e20 696e 6465 785f     return index_
-000041b0: 7661 6c75 650a 0a20 2020 2064 6566 205f  value..    def _
-000041c0: 5f67 6574 5f5f 2873 656c 662c 2069 6e73  _get__(self, ins
-000041d0: 7461 6e63 652c 206f 776e 6572 3d4e 6f6e  tance, owner=Non
-000041e0: 6529 3a0a 2020 2020 2020 2020 6966 206e  e):.        if n
-000041f0: 6f74 2069 7373 7562 636c 6173 7328 6f77  ot issubclass(ow
-00004200: 6e65 722c 204c 617a 794d 6574 6143 6875  ner, LazyMetaChu
-00004210: 6e6b 4461 7461 293a 2020 2320 7072 6167  nkData):  # prag
-00004220: 6d61 3a20 6e6f 2063 6f76 6572 0a20 2020  ma: no cover.   
-00004230: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00004240: 7375 7065 7228 292e 5f5f 6765 745f 5f28  super().__get__(
-00004250: 696e 7374 616e 6365 2c20 6f77 6e65 7229  instance, owner)
-00004260: 0a0a 2020 2020 2020 2020 7472 793a 0a20  ..        try:. 
-00004270: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00004280: 203d 2073 656c 662e 6765 7428 696e 7374   = self.get(inst
-00004290: 616e 6365 2c20 6f77 6e65 7229 0a20 2020  ance, owner).   
-000042a0: 2020 2020 2020 2020 2069 6620 7661 6c75           if valu
-000042b0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-000042c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000042d0: 6574 7572 6e20 7661 6c75 650a 2020 2020  eturn value.    
-000042e0: 2020 2020 6578 6365 7074 2041 7474 7269      except Attri
-000042f0: 6275 7465 4572 726f 723a 2020 2320 7072  buteError:  # pr
-00004300: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a20  agma: no cover. 
-00004310: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
-00004320: 0a20 2020 2020 2020 2069 6620 696e 7374  .        if inst
-00004330: 616e 6365 2e69 6e64 6578 2069 7320 4e6f  ance.index is No
-00004340: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00004350: 7265 7475 726e 2073 7570 6572 2829 2e5f  return super()._
-00004360: 5f67 6574 5f5f 2869 6e73 7461 6e63 652c  _get__(instance,
-00004370: 206f 776e 6572 290a 0a20 2020 2020 2020   owner)..       
-00004380: 2023 2067 6574 2069 6e64 6578 5f76 616c   # get index_val
-00004390: 7565 206c 617a 696c 790a 2020 2020 2020  ue lazily.      
-000043a0: 2020 696e 6465 7820 3d20 696e 7374 616e    index = instan
-000043b0: 6365 2e69 6e64 6578 5b30 5d0a 2020 2020  ce.index[0].    
-000043c0: 2020 2020 696e 6465 785f 7661 6c75 6520      index_value 
-000043d0: 3d20 7365 6c66 2e5f 6765 6e5f 6368 756e  = self._gen_chun
-000043e0: 6b5f 696e 6465 785f 7661 6c75 6528 696e  k_index_value(in
-000043f0: 7374 616e 6365 2c20 696e 6465 7829 0a20  stance, index). 
-00004400: 2020 2020 2020 2023 2063 6163 6865 2069         # cache i
-00004410: 6e64 6578 5f76 616c 7565 0a20 2020 2020  ndex_value.     
-00004420: 2020 2073 656c 662e 7365 7428 696e 7374     self.set(inst
-00004430: 616e 6365 2c20 696e 6465 785f 7661 6c75  ance, index_valu
-00004440: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
-00004450: 6e20 696e 6465 785f 7661 6c75 650a 0a0a  n index_value...
-00004460: 636c 6173 7320 4368 756e 6b43 6f6c 756d  class ChunkColum
-00004470: 6e73 5661 6c75 6546 6965 6c64 2852 6566  nsValueField(Ref
-00004480: 6572 656e 6365 4669 656c 6429 3a0a 2020  erenceField):.  
-00004490: 2020 5f74 696c 6561 626c 655f 6b65 795f    _tileable_key_
-000044a0: 696e 6465 785f 746f 5f69 6e64 6578 5f76  index_to_index_v
-000044b0: 616c 7565 203d 2064 6963 7428 290a 0a20  alue = dict().. 
-000044c0: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
-000044d0: 0a20 2020 2064 6566 205f 6765 6e5f 6368  .    def _gen_ch
-000044e0: 756e 6b5f 636f 6c75 6d6e 735f 7661 6c75  unk_columns_valu
-000044f0: 6528 696e 7374 616e 6365 3a20 4368 756e  e(instance: Chun
-00004500: 6b2c 2069 6e64 6578 3a20 696e 7429 202d  k, index: int) -
-00004510: 3e20 4f70 7469 6f6e 616c 5b49 6e64 6578  > Optional[Index
-00004520: 5661 6c75 655d 3a0a 2020 2020 2020 2020  Value]:.        
-00004530: 2320 636f 6c75 6d6e 735f 7661 6c75 6520  # columns_value 
-00004540: 6f66 2074 696c 6561 626c 650a 2020 2020  of tileable.    
-00004550: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00004560: 2020 2020 2074 696c 6561 626c 655f 6b65       tileable_ke
-00004570: 7920 3d20 6765 7461 7474 7228 696e 7374  y = getattr(inst
-00004580: 616e 6365 2c20 5f74 696c 6561 626c 655f  ance, _tileable_
-00004590: 6b65 795f 7072 6f70 6572 7479 290a 2020  key_property).  
-000045a0: 2020 2020 2020 6578 6365 7074 2041 7474        except Att
-000045b0: 7269 6275 7465 4572 726f 723a 0a20 2020  ributeError:.   
-000045c0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-000045d0: 2020 2020 2020 2020 6361 6368 6520 3d20          cache = 
-000045e0: 4368 756e 6b43 6f6c 756d 6e73 5661 6c75  ChunkColumnsValu
-000045f0: 6546 6965 6c64 2e5f 7469 6c65 6162 6c65  eField._tileable
-00004600: 5f6b 6579 5f69 6e64 6578 5f74 6f5f 696e  _key_index_to_in
-00004610: 6465 785f 7661 6c75 650a 2020 2020 2020  dex_value.      
-00004620: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00004630: 2020 2072 6574 7572 6e20 6361 6368 655b     return cache[
-00004640: 7469 6c65 6162 6c65 5f6b 6579 2c20 696e  tileable_key, in
-00004650: 6465 785d 0a20 2020 2020 2020 2065 7863  dex].        exc
-00004660: 6570 7420 4b65 7945 7272 6f72 3a0a 2020  ept KeyError:.  
-00004670: 2020 2020 2020 2020 2020 7469 6c65 6162            tileab
-00004680: 6c65 5f63 6f6c 756d 6e73 5f76 616c 7565  le_columns_value
-00004690: 203d 2067 6574 6174 7472 2869 6e73 7461   = getattr(insta
-000046a0: 6e63 652c 205f 7469 6c65 6162 6c65 5f63  nce, _tileable_c
-000046b0: 6f6c 756d 6e73 5f76 616c 7565 5f70 726f  olumns_value_pro
-000046c0: 7065 7274 7929 0a20 2020 2020 2020 2020  perty).         
-000046d0: 2020 2023 206e 7370 6c69 7473 206f 6620     # nsplits of 
-000046e0: 7469 6c65 6162 6c65 0a20 2020 2020 2020  tileable.       
-000046f0: 2020 2020 206e 7370 6c69 7420 3d20 6765       nsplit = ge
-00004700: 7461 7474 7228 696e 7374 616e 6365 2c20  tattr(instance, 
-00004710: 5f6e 7370 6c69 7473 5f70 726f 7065 7274  _nsplits_propert
-00004720: 7929 5b31 5d0a 2020 2020 2020 2020 2020  y)[1].          
-00004730: 2020 2320 6361 6c63 2073 6c69 6365 0a20    # calc slice. 
-00004740: 2020 2020 2020 2020 2020 2073 6c63 203d             slc =
-00004750: 205f 6361 6c63 5f61 7869 735f 736c 6963   _calc_axis_slic
-00004760: 6528 6e73 706c 6974 2c20 696e 6465 7829  e(nsplit, index)
-00004770: 0a20 2020 2020 2020 2020 2020 2070 645f  .            pd_
-00004780: 696e 6465 7820 3d20 7469 6c65 6162 6c65  index = tileable
-00004790: 5f63 6f6c 756d 6e73 5f76 616c 7565 2e74  _columns_value.t
-000047a0: 6f5f 7061 6e64 6173 2829 0a20 2020 2020  o_pandas().     
-000047b0: 2020 2020 2020 2063 6875 6e6b 5f70 645f         chunk_pd_
-000047c0: 696e 6465 7820 3d20 280a 2020 2020 2020  index = (.      
-000047d0: 2020 2020 2020 2020 2020 7064 5f69 6e64            pd_ind
-000047e0: 6578 5b3a 305d 2069 6620 6e70 2e69 736e  ex[:0] if np.isn
-000047f0: 616e 2873 6c63 2e73 746f 7020 2d20 736c  an(slc.stop - sl
-00004800: 632e 7374 6172 7429 2065 6c73 6520 7064  c.start) else pd
-00004810: 5f69 6e64 6578 5b73 6c63 5d0a 2020 2020  _index[slc].    
-00004820: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00004830: 2020 2020 2020 636f 6c75 6d6e 735f 7661        columns_va
-00004840: 6c75 6520 3d20 7061 7273 655f 696e 6465  lue = parse_inde
-00004850: 7828 6368 756e 6b5f 7064 5f69 6e64 6578  x(chunk_pd_index
-00004860: 2c20 7374 6f72 655f 6461 7461 3d54 7275  , store_data=Tru
-00004870: 6529 0a20 2020 2020 2020 2020 2020 2063  e).            c
-00004880: 6163 6865 5b74 696c 6561 626c 655f 6b65  ache[tileable_ke
-00004890: 792c 2069 6e64 6578 5d20 3d20 636f 6c75  y, index] = colu
-000048a0: 6d6e 735f 7661 6c75 650a 2020 2020 2020  mns_value.      
-000048b0: 2020 2020 2020 7265 7475 726e 2063 6f6c        return col
-000048c0: 756d 6e73 5f76 616c 7565 0a0a 2020 2020  umns_value..    
-000048d0: 6465 6620 5f5f 6765 745f 5f28 7365 6c66  def __get__(self
-000048e0: 2c20 696e 7374 616e 6365 2c20 6f77 6e65  , instance, owne
-000048f0: 723d 4e6f 6e65 293a 0a20 2020 2020 2020  r=None):.       
-00004900: 2069 6620 6e6f 7420 6973 7375 6263 6c61   if not issubcla
-00004910: 7373 286f 776e 6572 2c20 4c61 7a79 4d65  ss(owner, LazyMe
-00004920: 7461 4368 756e 6b44 6174 6129 3a20 2023  taChunkData):  #
-00004930: 2070 7261 676d 613a 206e 6f20 636f 7665   pragma: no cove
-00004940: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
-00004950: 7475 726e 2073 7570 6572 2829 2e5f 5f67  turn super().__g
-00004960: 6574 5f5f 2869 6e73 7461 6e63 652c 206f  et__(instance, o
-00004970: 776e 6572 290a 0a20 2020 2020 2020 2074  wner)..        t
-00004980: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00004990: 7661 6c75 6520 3d20 7365 6c66 2e67 6574  value = self.get
-000049a0: 2869 6e73 7461 6e63 652c 206f 776e 6572  (instance, owner
-000049b0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-000049c0: 2076 616c 7565 2069 7320 6e6f 7420 4e6f   value is not No
-000049d0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-000049e0: 2020 2020 7265 7475 726e 2076 616c 7565      return value
-000049f0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00004a00: 4174 7472 6962 7574 6545 7272 6f72 3a20  AttributeError: 
-00004a10: 2023 2070 7261 676d 613a 206e 6f20 636f   # pragma: no co
-00004a20: 7665 720a 2020 2020 2020 2020 2020 2020  ver.            
-00004a30: 7061 7373 0a0a 2020 2020 2020 2020 6966  pass..        if
-00004a40: 2069 6e73 7461 6e63 652e 696e 6465 7820   instance.index 
-00004a50: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00004a60: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-00004a70: 7228 292e 5f5f 6765 745f 5f28 696e 7374  r().__get__(inst
-00004a80: 616e 6365 2c20 6f77 6e65 7229 0a0a 2020  ance, owner)..  
-00004a90: 2020 2020 2020 2320 6765 7420 636f 6c75        # get colu
-00004aa0: 6d6e 735f 7661 6c75 6520 6c61 7a69 6c79  mns_value lazily
-00004ab0: 0a20 2020 2020 2020 2069 6e64 6578 203d  .        index =
-00004ac0: 2069 6e73 7461 6e63 652e 696e 6465 785b   instance.index[
-00004ad0: 315d 0a20 2020 2020 2020 2063 6f6c 756d  1].        colum
-00004ae0: 6e73 5f76 616c 7565 203d 2073 656c 662e  ns_value = self.
-00004af0: 5f67 656e 5f63 6875 6e6b 5f63 6f6c 756d  _gen_chunk_colum
-00004b00: 6e73 5f76 616c 7565 2869 6e73 7461 6e63  ns_value(instanc
-00004b10: 652c 2069 6e64 6578 290a 2020 2020 2020  e, index).      
-00004b20: 2020 2320 6361 6368 6520 636f 6c75 6d6e    # cache column
-00004b30: 735f 7661 6c75 650a 2020 2020 2020 2020  s_value.        
-00004b40: 7365 6c66 2e73 6574 2869 6e73 7461 6e63  self.set(instanc
-00004b50: 652c 2063 6f6c 756d 6e73 5f76 616c 7565  e, columns_value
-00004b60: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00004b70: 2063 6f6c 756d 6e73 5f76 616c 7565 0a0a   columns_value..
-00004b80: 0a63 6c61 7373 2049 6e64 6578 4368 756e  .class IndexChun
-00004b90: 6b44 6174 6128 4368 756e 6b44 6174 6129  kData(ChunkData)
-00004ba0: 3a0a 2020 2020 5f5f 736c 6f74 735f 5f20  :.    __slots__ 
-00004bb0: 3d20 2829 0a20 2020 2074 7970 655f 6e61  = ().    type_na
-00004bc0: 6d65 203d 2022 496e 6465 7822 0a0a 2020  me = "Index"..  
-00004bd0: 2020 2320 7265 7175 6972 6564 2066 6965    # required fie
-00004be0: 6c64 730a 2020 2020 5f73 6861 7065 203d  lds.    _shape =
-00004bf0: 2054 7570 6c65 4669 656c 6428 0a20 2020   TupleField(.   
-00004c00: 2020 2020 2022 7368 6170 6522 2c0a 2020       "shape",.  
-00004c10: 2020 2020 2020 4669 656c 6454 7970 6573        FieldTypes
-00004c20: 2e69 6e74 3634 2c0a 2020 2020 2020 2020  .int64,.        
-00004c30: 6f6e 5f73 6572 6961 6c69 7a65 3d6f 6e5f  on_serialize=on_
-00004c40: 7365 7269 616c 697a 655f 7368 6170 652c  serialize_shape,
-00004c50: 0a20 2020 2020 2020 206f 6e5f 6465 7365  .        on_dese
-00004c60: 7269 616c 697a 653d 6f6e 5f64 6573 6572  rialize=on_deser
-00004c70: 6961 6c69 7a65 5f73 6861 7065 2c0a 2020  ialize_shape,.  
-00004c80: 2020 290a 2020 2020 2320 6f70 7469 6f6e    ).    # option
-00004c90: 616c 2066 6965 6c64 0a20 2020 205f 6474  al field.    _dt
-00004ca0: 7970 6520 3d20 4461 7461 5479 7065 4669  ype = DataTypeFi
-00004cb0: 656c 6428 2264 7479 7065 2229 0a20 2020  eld("dtype").   
-00004cc0: 205f 6e61 6d65 203d 2041 6e79 4669 656c   _name = AnyFiel
-00004cd0: 6428 226e 616d 6522 290a 2020 2020 5f69  d("name").    _i
-00004ce0: 6e64 6578 5f76 616c 7565 203d 2052 6566  ndex_value = Ref
-00004cf0: 6572 656e 6365 4669 656c 6428 2269 6e64  erenceField("ind
-00004d00: 6578 5f76 616c 7565 222c 2049 6e64 6578  ex_value", Index
-00004d10: 5661 6c75 6529 0a0a 2020 2020 6465 6620  Value)..    def 
-00004d20: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
-00004d30: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00004d40: 6f70 3d4e 6f6e 652c 0a20 2020 2020 2020  op=None,.       
-00004d50: 2073 6861 7065 3d4e 6f6e 652c 0a20 2020   shape=None,.   
-00004d60: 2020 2020 2069 6e64 6578 3d4e 6f6e 652c       index=None,
-00004d70: 0a20 2020 2020 2020 2064 7479 7065 3d4e  .        dtype=N
-00004d80: 6f6e 652c 0a20 2020 2020 2020 206e 616d  one,.        nam
-00004d90: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-00004da0: 696e 6465 785f 7661 6c75 653d 4e6f 6e65  index_value=None
-00004db0: 2c0a 2020 2020 2020 2020 2a2a 6b77 2c0a  ,.        **kw,.
-00004dc0: 2020 2020 293a 0a20 2020 2020 2020 2073      ):.        s
-00004dd0: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
-00004de0: 0a20 2020 2020 2020 2020 2020 205f 6f70  .            _op
-00004df0: 3d6f 702c 0a20 2020 2020 2020 2020 2020  =op,.           
-00004e00: 205f 7368 6170 653d 7368 6170 652c 0a20   _shape=shape,. 
-00004e10: 2020 2020 2020 2020 2020 205f 696e 6465             _inde
-00004e20: 783d 696e 6465 782c 0a20 2020 2020 2020  x=index,.       
-00004e30: 2020 2020 205f 6474 7970 653d 6474 7970       _dtype=dtyp
-00004e40: 652c 0a20 2020 2020 2020 2020 2020 205f  e,.            _
-00004e50: 6e61 6d65 3d6e 616d 652c 0a20 2020 2020  name=name,.     
-00004e60: 2020 2020 2020 205f 696e 6465 785f 7661         _index_va
-00004e70: 6c75 653d 696e 6465 785f 7661 6c75 652c  lue=index_value,
-00004e80: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
-00004e90: 772c 0a20 2020 2020 2020 2029 0a0a 2020  w,.        )..  
-00004ea0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00004eb0: 6465 6620 7061 7261 6d73 2873 656c 6629  def params(self)
-00004ec0: 202d 3e20 4469 6374 5b73 7472 2c20 416e   -> Dict[str, An
-00004ed0: 795d 3a0a 2020 2020 2020 2020 2320 7061  y]:.        # pa
-00004ee0: 7261 6d73 2072 6574 7572 6e20 7468 6520  rams return the 
-00004ef0: 7072 6f70 6572 7469 6573 2077 6869 6368  properties which
-00004f00: 2075 7365 6675 6c20 746f 2072 6562 7569   useful to rebui
-00004f10: 6c64 2061 206e 6577 2063 6875 6e6b 0a20  ld a new chunk. 
-00004f20: 2020 2020 2020 2072 6574 7572 6e20 7b0a         return {.
-00004f30: 2020 2020 2020 2020 2020 2020 2273 6861              "sha
-00004f40: 7065 223a 2073 656c 662e 7368 6170 652c  pe": self.shape,
-00004f50: 0a20 2020 2020 2020 2020 2020 2022 6474  .            "dt
-00004f60: 7970 6522 3a20 7365 6c66 2e64 7479 7065  ype": self.dtype
-00004f70: 2c0a 2020 2020 2020 2020 2020 2020 2269  ,.            "i
-00004f80: 6e64 6578 223a 2073 656c 662e 696e 6465  ndex": self.inde
-00004f90: 782c 0a20 2020 2020 2020 2020 2020 2022  x,.            "
-00004fa0: 696e 6465 785f 7661 6c75 6522 3a20 7365  index_value": se
-00004fb0: 6c66 2e69 6e64 6578 5f76 616c 7565 2c0a  lf.index_value,.
-00004fc0: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
-00004fd0: 6522 3a20 7365 6c66 2e6e 616d 652c 0a20  e": self.name,. 
-00004fe0: 2020 2020 2020 207d 0a0a 2020 2020 4070         }..    @p
-00004ff0: 6172 616d 732e 7365 7474 6572 0a20 2020  arams.setter.   
-00005000: 2064 6566 2070 6172 616d 7328 7365 6c66   def params(self
-00005010: 2c20 6e65 775f 7061 7261 6d73 3a20 4469  , new_params: Di
-00005020: 6374 5b73 7472 2c20 416e 795d 293a 0a20  ct[str, Any]):. 
-00005030: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-00005040: 6e65 775f 7061 7261 6d73 2e63 6f70 7928  new_params.copy(
-00005050: 290a 2020 2020 2020 2020 7061 7261 6d73  ).        params
-00005060: 2e70 6f70 2822 696e 6465 7822 2c20 4e6f  .pop("index", No
-00005070: 6e65 2920 2023 2069 6e64 6578 206e 6f74  ne)  # index not
-00005080: 206e 6565 6465 6420 746f 2075 7064 6174   needed to updat
-00005090: 650a 2020 2020 2020 2020 6e65 775f 7368  e.        new_sh
-000050a0: 6170 6520 3d20 7061 7261 6d73 2e70 6f70  ape = params.pop
-000050b0: 2822 7368 6170 6522 2c20 4e6f 6e65 290a  ("shape", None).
-000050c0: 2020 2020 2020 2020 6966 206e 6577 5f73          if new_s
-000050d0: 6861 7065 2069 7320 6e6f 7420 4e6f 6e65  hape is not None
-000050e0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-000050f0: 6c66 2e5f 7368 6170 6520 3d20 6e65 775f  lf._shape = new_
-00005100: 7368 6170 650a 2020 2020 2020 2020 6474  shape.        dt
-00005110: 7970 6520 3d20 7061 7261 6d73 2e70 6f70  ype = params.pop
-00005120: 2822 6474 7970 6522 2c20 4e6f 6e65 290a  ("dtype", None).
-00005130: 2020 2020 2020 2020 6966 2064 7479 7065          if dtype
-00005140: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00005150: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00005160: 6474 7970 6520 3d20 6474 7970 650a 2020  dtype = dtype.  
-00005170: 2020 2020 2020 696e 6465 785f 7661 6c75        index_valu
-00005180: 6520 3d20 7061 7261 6d73 2e70 6f70 2822  e = params.pop("
-00005190: 696e 6465 785f 7661 6c75 6522 2c20 4e6f  index_value", No
-000051a0: 6e65 290a 2020 2020 2020 2020 6966 2069  ne).        if i
-000051b0: 6e64 6578 5f76 616c 7565 2069 7320 6e6f  ndex_value is no
-000051c0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-000051d0: 2020 2020 7365 6c66 2e5f 696e 6465 785f      self._index_
-000051e0: 7661 6c75 6520 3d20 696e 6465 785f 7661  value = index_va
-000051f0: 6c75 650a 2020 2020 2020 2020 6e61 6d65  lue.        name
-00005200: 203d 2070 6172 616d 732e 706f 7028 226e   = params.pop("n
-00005210: 616d 6522 2c20 4e6f 6e65 290a 2020 2020  ame", None).    
-00005220: 2020 2020 6966 206e 616d 6520 6973 206e      if name is n
-00005230: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00005240: 2020 2020 2073 656c 662e 5f6e 616d 6520       self._name 
-00005250: 3d20 6e61 6d65 0a20 2020 2020 2020 2069  = name.        i
-00005260: 6620 7061 7261 6d73 3a20 2023 2070 7261  f params:  # pra
-00005270: 676d 613a 206e 6f20 636f 7665 720a 2020  gma: no cover.  
-00005280: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00005290: 5479 7065 4572 726f 7228 6622 556e 6b6e  TypeError(f"Unkn
-000052a0: 6f77 6e20 7061 7261 6d73 3a20 7b6c 6973  own params: {lis
-000052b0: 7428 7061 7261 6d73 297d 2229 0a0a 2020  t(params)}")..  
-000052c0: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
-000052d0: 2020 2064 6566 2067 6574 5f70 6172 616d     def get_param
-000052e0: 735f 6672 6f6d 5f64 6174 6128 636c 732c  s_from_data(cls,
-000052f0: 2064 6174 613a 2070 642e 496e 6465 7829   data: pd.Index)
-00005300: 202d 3e20 4469 6374 5b73 7472 2c20 416e   -> Dict[str, An
-00005310: 795d 3a0a 2020 2020 2020 2020 7265 7475  y]:.        retu
-00005320: 726e 207b 0a20 2020 2020 2020 2020 2020  rn {.           
-00005330: 2022 7368 6170 6522 3a20 6461 7461 2e73   "shape": data.s
-00005340: 6861 7065 2c0a 2020 2020 2020 2020 2020  hape,.          
-00005350: 2020 2264 7479 7065 223a 2064 6174 612e    "dtype": data.
-00005360: 6474 7970 652c 0a20 2020 2020 2020 2020  dtype,.         
-00005370: 2020 2022 696e 6465 785f 7661 6c75 6522     "index_value"
-00005380: 3a20 7061 7273 655f 696e 6465 7828 6461  : parse_index(da
-00005390: 7461 2c20 7374 6f72 655f 6461 7461 3d46  ta, store_data=F
-000053a0: 616c 7365 292c 0a20 2020 2020 2020 2020  alse),.         
-000053b0: 2020 2022 6e61 6d65 223a 2064 6174 612e     "name": data.
-000053c0: 6e61 6d65 2c0a 2020 2020 2020 2020 7d0a  name,.        }.
-000053d0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-000053e0: 2020 2064 6566 2073 6861 7065 2873 656c     def shape(sel
-000053f0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00005400: 726e 2067 6574 6174 7472 2873 656c 662c  rn getattr(self,
-00005410: 2022 5f73 6861 7065 222c 204e 6f6e 6529   "_shape", None)
-00005420: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00005430: 2020 2020 6465 6620 6e64 696d 2873 656c      def ndim(sel
-00005440: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00005450: 726e 206c 656e 2873 656c 662e 7368 6170  rn len(self.shap
-00005460: 6529 0a0a 2020 2020 4070 726f 7065 7274  e)..    @propert
-00005470: 790a 2020 2020 6465 6620 6474 7970 6528  y.    def dtype(
-00005480: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00005490: 6574 7572 6e20 7365 6c66 2e5f 6474 7970  eturn self._dtyp
-000054a0: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
-000054b0: 0a20 2020 2064 6566 206e 616d 6528 7365  .    def name(se
-000054c0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-000054d0: 7572 6e20 7365 6c66 2e5f 6e61 6d65 0a0a  urn self._name..
-000054e0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-000054f0: 2020 6465 6620 696e 6465 785f 7661 6c75    def index_valu
-00005500: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-00005510: 2072 6574 7572 6e20 7365 6c66 2e5f 696e   return self._in
-00005520: 6465 785f 7661 6c75 650a 0a0a 636c 6173  dex_value...clas
-00005530: 7320 496e 6465 7843 6875 6e6b 2843 6875  s IndexChunk(Chu
-00005540: 6e6b 293a 0a20 2020 205f 5f73 6c6f 7473  nk):.    __slots
-00005550: 5f5f 203d 2028 290a 2020 2020 5f61 6c6c  __ = ().    _all
-00005560: 6f77 5f64 6174 615f 7479 7065 5f20 3d20  ow_data_type_ = 
-00005570: 2849 6e64 6578 4368 756e 6b44 6174 612c  (IndexChunkData,
-00005580: 290a 2020 2020 7479 7065 5f6e 616d 6520  ).    type_name 
-00005590: 3d20 2249 6e64 6578 220a 0a0a 6465 6620  = "Index"...def 
-000055a0: 5f6f 6e5f 6465 7365 7269 616c 697a 655f  _on_deserialize_
-000055b0: 696e 6465 785f 7661 6c75 6528 696e 6465  index_value(inde
-000055c0: 785f 7661 6c75 6529 3a0a 2020 2020 6966  x_value):.    if
-000055d0: 2069 6e64 6578 5f76 616c 7565 2069 7320   index_value is 
-000055e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
-000055f0: 7475 726e 0a20 2020 2074 7279 3a0a 2020  turn.    try:.  
-00005600: 2020 2020 2020 6765 7461 7474 7228 696e        getattr(in
-00005610: 6465 785f 7661 6c75 652c 2022 7661 6c75  dex_value, "valu
-00005620: 6522 290a 2020 2020 2020 2020 7265 7475  e").        retu
-00005630: 726e 2069 6e64 6578 5f76 616c 7565 0a20  rn index_value. 
-00005640: 2020 2065 7863 6570 7420 4174 7472 6962     except Attrib
-00005650: 7574 6545 7272 6f72 3a0a 2020 2020 2020  uteError:.      
-00005660: 2020 7265 7475 726e 0a0a 0a63 6c61 7373    return...class
-00005670: 205f 546f 5061 6e64 6173 4d69 7869 6e28   _ToPandasMixin(
-00005680: 5f45 7865 6375 7465 416e 6446 6574 6368  _ExecuteAndFetch
-00005690: 4d69 7869 6e29 3a0a 2020 2020 5f5f 736c  Mixin):.    __sl
-000056a0: 6f74 735f 5f20 3d20 2829 0a0a 2020 2020  ots__ = ()..    
-000056b0: 6465 6620 746f 5f70 616e 6461 7328 7365  def to_pandas(se
-000056c0: 6c66 2c20 7365 7373 696f 6e3d 4e6f 6e65  lf, session=None
-000056d0: 2c20 2a2a 6b77 293a 0a20 2020 2020 2020  , **kw):.       
-000056e0: 2072 6574 7572 6e20 7365 6c66 2e5f 6578   return self._ex
-000056f0: 6563 7574 655f 616e 645f 6665 7463 6828  ecute_and_fetch(
-00005700: 7365 7373 696f 6e3d 7365 7373 696f 6e2c  session=session,
-00005710: 202a 2a6b 7729 0a0a 0a63 6c61 7373 205f   **kw)...class _
-00005720: 4261 7463 6865 6446 6574 6368 6572 3a0a  BatchedFetcher:.
-00005730: 2020 2020 5f5f 736c 6f74 735f 5f20 3d20      __slots__ = 
-00005740: 2829 0a0a 2020 2020 6465 6620 5f69 7465  ()..    def _ite
-00005750: 7228 7365 6c66 2c20 6261 7463 685f 7369  r(self, batch_si
-00005760: 7a65 3d4e 6f6e 652c 2073 6573 7369 6f6e  ze=None, session
-00005770: 3d4e 6f6e 652c 202a 2a6b 7729 3a0a 2020  =None, **kw):.  
-00005780: 2020 2020 2020 6672 6f6d 202e 696e 6465        from .inde
-00005790: 7869 6e67 2e69 6c6f 6320 696d 706f 7274  xing.iloc import
-000057a0: 2069 6c6f 630a 0a20 2020 2020 2020 2069   iloc..        i
-000057b0: 6620 6261 7463 685f 7369 7a65 2069 7320  f batch_size is 
-000057c0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-000057d0: 2020 2020 2020 7369 7a65 203d 2073 656c        size = sel
-000057e0: 662e 7368 6170 655b 305d 0a20 2020 2020  f.shape[0].     
-000057f0: 2020 2020 2020 206e 5f62 6174 6368 203d         n_batch =
-00005800: 2063 6569 6c64 6976 2873 697a 652c 2062   ceildiv(size, b
-00005810: 6174 6368 5f73 697a 6529 0a0a 2020 2020  atch_size)..    
-00005820: 2020 2020 2020 2020 6966 206e 5f62 6174          if n_bat
-00005830: 6368 203e 2031 3a0a 2020 2020 2020 2020  ch > 1:.        
-00005840: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00005850: 2072 616e 6765 286e 5f62 6174 6368 293a   range(n_batch):
-00005860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005870: 2020 2020 2062 6174 6368 5f64 6174 6120       batch_data 
-00005880: 3d20 696c 6f63 2873 656c 6629 5b62 6174  = iloc(self)[bat
-00005890: 6368 5f73 697a 6520 2a20 6920 3a20 6261  ch_size * i : ba
-000058a0: 7463 685f 7369 7a65 202a 2028 6920 2b20  tch_size * (i + 
-000058b0: 3129 5d0a 2020 2020 2020 2020 2020 2020  1)].            
-000058c0: 2020 2020 2020 2020 7969 656c 6420 6261          yield ba
-000058d0: 7463 685f 6461 7461 2e5f 6665 7463 6828  tch_data._fetch(
-000058e0: 7365 7373 696f 6e3d 7365 7373 696f 6e2c  session=session,
-000058f0: 202a 2a6b 7729 0a20 2020 2020 2020 2020   **kw).         
-00005900: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00005910: 2020 2020 2020 2020 2079 6965 6c64 2073           yield s
-00005920: 656c 662e 5f66 6574 6368 2873 6573 7369  elf._fetch(sessi
-00005930: 6f6e 3d73 6573 7369 6f6e 2c20 2a2a 6b77  on=session, **kw
-00005940: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00005950: 2020 2020 2020 2020 2020 2020 2320 6966              # if
-00005960: 2062 6174 6368 5f73 697a 6520 6973 206e   batch_size is n
-00005970: 6f74 2073 7065 6369 6669 6564 2c20 7573  ot specified, us
-00005980: 6520 6669 7273 7420 6261 7463 6820 746f  e first batch to
-00005990: 2065 7374 696d 6174 650a 2020 2020 2020   estimate.      
-000059a0: 2020 2020 2020 2320 6261 7463 685f 7369        # batch_si
-000059b0: 7a65 2e0a 2020 2020 2020 2020 2020 2020  ze..            
-000059c0: 6465 6661 756c 745f 6261 7463 685f 6279  default_batch_by
-000059d0: 7465 7320 3d20 3530 202a 2031 3032 342a  tes = 50 * 1024*
-000059e0: 2a32 0a20 2020 2020 2020 2020 2020 2066  *2.            f
-000059f0: 6972 7374 5f62 6174 6368 203d 2031 3030  irst_batch = 100
-00005a00: 300a 2020 2020 2020 2020 2020 2020 7369  0.            si
-00005a10: 7a65 203d 2073 656c 662e 7368 6170 655b  ze = self.shape[
-00005a20: 305d 0a0a 2020 2020 2020 2020 2020 2020  0]..            
-00005a30: 6966 2073 697a 6520 3e3d 2066 6972 7374  if size >= first
-00005a40: 5f62 6174 6368 3a0a 2020 2020 2020 2020  _batch:.        
-00005a50: 2020 2020 2020 2020 6261 7463 685f 6461          batch_da
-00005a60: 7461 203d 2069 6c6f 6328 7365 6c66 295b  ta = iloc(self)[
-00005a70: 3a66 6972 7374 5f62 6174 6368 5d0a 2020  :first_batch].  
-00005a80: 2020 2020 2020 2020 2020 2020 2020 6669                fi
-00005a90: 7273 745f 6261 7463 685f 6461 7461 203d  rst_batch_data =
-00005aa0: 2062 6174 6368 5f64 6174 612e 5f66 6574   batch_data._fet
-00005ab0: 6368 2873 6573 7369 6f6e 3d73 6573 7369  ch(session=sessi
-00005ac0: 6f6e 2c20 2a2a 6b77 290a 2020 2020 2020  on, **kw).      
-00005ad0: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
-00005ae0: 6669 7273 745f 6261 7463 685f 6461 7461  first_batch_data
-00005af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005b00: 2064 6174 615f 7369 7a65 203d 2065 7374   data_size = est
-00005b10: 696d 6174 655f 7061 6e64 6173 5f73 697a  imate_pandas_siz
-00005b20: 6528 6669 7273 745f 6261 7463 685f 6461  e(first_batch_da
-00005b30: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
-00005b40: 2020 2020 6261 7463 685f 7369 7a65 203d      batch_size =
-00005b50: 2069 6e74 2864 6566 6175 6c74 5f62 6174   int(default_bat
-00005b60: 6368 5f62 7974 6573 202f 2064 6174 615f  ch_bytes / data_
-00005b70: 7369 7a65 202a 2066 6972 7374 5f62 6174  size * first_bat
-00005b80: 6368 290a 2020 2020 2020 2020 2020 2020  ch).            
-00005b90: 2020 2020 6e5f 6261 7463 6820 3d20 6365      n_batch = ce
-00005ba0: 696c 6469 7628 7369 7a65 202d 2031 3030  ildiv(size - 100
-00005bb0: 302c 2062 6174 6368 5f73 697a 6529 0a20  0, batch_size). 
-00005bc0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00005bd0: 6f72 2069 2069 6e20 7261 6e67 6528 6e5f  or i in range(n_
-00005be0: 6261 7463 6829 3a0a 2020 2020 2020 2020  batch):.        
-00005bf0: 2020 2020 2020 2020 2020 2020 6261 7463              batc
-00005c00: 685f 6461 7461 203d 2069 6c6f 6328 7365  h_data = iloc(se
-00005c10: 6c66 295b 0a20 2020 2020 2020 2020 2020  lf)[.           
-00005c20: 2020 2020 2020 2020 2020 2020 2066 6972               fir
-00005c30: 7374 5f62 6174 6368 0a20 2020 2020 2020  st_batch.       
-00005c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005c50: 202b 2062 6174 6368 5f73 697a 6520 2a20   + batch_size * 
-00005c60: 6920 3a20 6669 7273 745f 6261 7463 680a  i : first_batch.
-00005c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005c80: 2020 2020 2020 2020 2b20 6261 7463 685f          + batch_
-00005c90: 7369 7a65 202a 2028 6920 2b20 3129 0a20  size * (i + 1). 
-00005ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005cb0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-00005cc0: 2020 2020 2020 2020 2079 6965 6c64 2062           yield b
-00005cd0: 6174 6368 5f64 6174 612e 5f66 6574 6368  atch_data._fetch
-00005ce0: 2873 6573 7369 6f6e 3d73 6573 7369 6f6e  (session=session
-00005cf0: 2c20 2a2a 6b77 290a 2020 2020 2020 2020  , **kw).        
-00005d00: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00005d10: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
-00005d20: 7365 6c66 2e5f 6665 7463 6828 7365 7373  self._fetch(sess
-00005d30: 696f 6e3d 7365 7373 696f 6e2c 202a 2a6b  ion=session, **k
-00005d40: 7729 0a0a 2020 2020 6465 6620 6974 6572  w)..    def iter
-00005d50: 6261 7463 6828 7365 6c66 2c20 6261 7463  batch(self, batc
-00005d60: 685f 7369 7a65 3d4e 6f6e 652c 2073 6573  h_size=None, ses
-00005d70: 7369 6f6e 3d4e 6f6e 652c 202a 2a6b 7729  sion=None, **kw)
-00005d80: 3a0a 2020 2020 2020 2020 2320 7472 6967  :.        # trig
-00005d90: 6765 7220 6578 6563 7574 696f 6e0a 2020  ger execution.  
-00005da0: 2020 2020 2020 7365 6c66 2e65 7865 6375        self.execu
-00005db0: 7465 2873 6573 7369 6f6e 3d73 6573 7369  te(session=sessi
-00005dc0: 6f6e 2c20 2a2a 6b77 290a 2020 2020 2020  on, **kw).      
-00005dd0: 2020 7265 7475 726e 2073 656c 662e 5f69    return self._i
-00005de0: 7465 7228 6261 7463 685f 7369 7a65 3d62  ter(batch_size=b
-00005df0: 6174 6368 5f73 697a 652c 2073 6573 7369  atch_size, sessi
-00005e00: 6f6e 3d73 6573 7369 6f6e 290a 0a20 2020  on=session)..   
-00005e10: 2064 6566 2066 6574 6368 2873 656c 662c   def fetch(self,
-00005e20: 2073 6573 7369 6f6e 3d4e 6f6e 652c 202a   session=None, *
-00005e30: 2a6b 7729 3a0a 2020 2020 2020 2020 6672  *kw):.        fr
-00005e40: 6f6d 202e 696e 6465 7869 6e67 2e69 6c6f  om .indexing.ilo
-00005e50: 6320 696d 706f 7274 2044 6174 6146 7261  c import DataFra
-00005e60: 6d65 496c 6f63 4765 7449 7465 6d2c 2053  meIlocGetItem, S
-00005e70: 6572 6965 7349 6c6f 6347 6574 4974 656d  eriesIlocGetItem
-00005e80: 0a0a 2020 2020 2020 2020 6261 7463 685f  ..        batch_
-00005e90: 7369 7a65 203d 206b 772e 706f 7028 2262  size = kw.pop("b
-00005ea0: 6174 6368 5f73 697a 6522 2c20 4e6f 6e65  atch_size", None
-00005eb0: 290a 2020 2020 2020 2020 6966 2069 7369  ).        if isi
-00005ec0: 6e73 7461 6e63 6528 7365 6c66 2e6f 702c  nstance(self.op,
-00005ed0: 2028 4461 7461 4672 616d 6549 6c6f 6347   (DataFrameIlocG
-00005ee0: 6574 4974 656d 2c20 5365 7269 6573 496c  etItem, SeriesIl
-00005ef0: 6f63 4765 7449 7465 6d29 293a 0a20 2020  ocGetItem)):.   
-00005f00: 2020 2020 2020 2020 2023 2073 6565 2047           # see G
-00005f10: 4823 3138 3731 0a20 2020 2020 2020 2020  H#1871.         
-00005f20: 2020 2023 2061 6c72 6561 6479 2069 6c6f     # already ilo
-00005f30: 632c 2064 6f20 6e6f 7420 7472 6967 6765  c, do not trigge
-00005f40: 7220 6261 7463 6820 6665 7463 680a 2020  r batch fetch.  
-00005f50: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00005f60: 2073 656c 662e 5f66 6574 6368 2873 6573   self._fetch(ses
-00005f70: 7369 6f6e 3d73 6573 7369 6f6e 2c20 2a2a  sion=session, **
-00005f80: 6b77 290a 2020 2020 2020 2020 656c 7365  kw).        else
-00005f90: 3a0a 2020 2020 2020 2020 2020 2020 6261  :.            ba
-00005fa0: 7463 6865 7320 3d20 6c69 7374 2873 656c  tches = list(sel
-00005fb0: 662e 5f69 7465 7228 6261 7463 685f 7369  f._iter(batch_si
-00005fc0: 7a65 3d62 6174 6368 5f73 697a 652c 2073  ze=batch_size, s
-00005fd0: 6573 7369 6f6e 3d73 6573 7369 6f6e 2c20  ession=session, 
-00005fe0: 2a2a 6b77 2929 0a20 2020 2020 2020 2020  **kw)).         
-00005ff0: 2020 2072 6574 7572 6e20 7064 2e63 6f6e     return pd.con
-00006000: 6361 7428 6261 7463 6865 7329 2069 6620  cat(batches) if 
-00006010: 6c65 6e28 6261 7463 6865 7329 203e 2031  len(batches) > 1
-00006020: 2065 6c73 6520 6261 7463 6865 735b 305d   else batches[0]
-00006030: 0a0a 2020 2020 6465 6620 6665 7463 685f  ..    def fetch_
-00006040: 696e 666f 7328 7365 6c66 2c20 6669 656c  infos(self, fiel
-00006050: 6473 3d4e 6f6e 652c 2073 6573 7369 6f6e  ds=None, session
-00006060: 3d4e 6f6e 652c 202a 2a6b 7729 3a0a 2020  =None, **kw):.  
-00006070: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00006080: 662e 5f66 6574 6368 5f69 6e66 6f73 2866  f._fetch_infos(f
-00006090: 6965 6c64 733d 6669 656c 6473 2c20 7365  ields=fields, se
-000060a0: 7373 696f 6e3d 7365 7373 696f 6e2c 202a  ssion=session, *
-000060b0: 2a6b 7729 0a0a 0a63 6c61 7373 2049 6e64  *kw)...class Ind
-000060c0: 6578 4461 7461 2848 6173 5368 6170 6554  exData(HasShapeT
-000060d0: 696c 6561 626c 6544 6174 612c 205f 546f  ileableData, _To
-000060e0: 5061 6e64 6173 4d69 7869 6e29 3a0a 2020  PandasMixin):.  
-000060f0: 2020 5f5f 736c 6f74 735f 5f20 3d20 2829    __slots__ = ()
-00006100: 0a20 2020 2074 7970 655f 6e61 6d65 203d  .    type_name =
-00006110: 2022 496e 6465 7822 0a0a 2020 2020 2320   "Index"..    # 
-00006120: 6f70 7469 6f6e 616c 2066 6965 6c64 0a20  optional field. 
-00006130: 2020 205f 6474 7970 6520 3d20 4461 7461     _dtype = Data
-00006140: 5479 7065 4669 656c 6428 2264 7479 7065  TypeField("dtype
-00006150: 2229 0a20 2020 205f 6e61 6d65 203d 2041  ").    _name = A
-00006160: 6e79 4669 656c 6428 226e 616d 6522 290a  nyField("name").
-00006170: 2020 2020 5f6e 616d 6573 203d 2041 6e79      _names = Any
-00006180: 4669 656c 6428 226e 616d 6573 2229 0a20  Field("names"). 
-00006190: 2020 205f 696e 6465 785f 7661 6c75 6520     _index_value 
-000061a0: 3d20 5265 6665 7265 6e63 6546 6965 6c64  = ReferenceField
-000061b0: 280a 2020 2020 2020 2020 2269 6e64 6578  (.        "index
-000061c0: 5f76 616c 7565 222c 2049 6e64 6578 5661  _value", IndexVa
-000061d0: 6c75 652c 206f 6e5f 6465 7365 7269 616c  lue, on_deserial
-000061e0: 697a 653d 5f6f 6e5f 6465 7365 7269 616c  ize=_on_deserial
-000061f0: 697a 655f 696e 6465 785f 7661 6c75 650a  ize_index_value.
-00006200: 2020 2020 290a 2020 2020 5f63 6875 6e6b      ).    _chunk
-00006210: 7320 3d20 4c69 7374 4669 656c 6428 0a20  s = ListField(. 
-00006220: 2020 2020 2020 2022 6368 756e 6b73 222c         "chunks",
-00006230: 0a20 2020 2020 2020 2046 6965 6c64 5479  .        FieldTy
-00006240: 7065 732e 7265 6665 7265 6e63 6528 496e  pes.reference(In
-00006250: 6465 7843 6875 6e6b 4461 7461 292c 0a20  dexChunkData),. 
-00006260: 2020 2020 2020 206f 6e5f 7365 7269 616c         on_serial
-00006270: 697a 653d 6c61 6d62 6461 2078 3a20 5b69  ize=lambda x: [i
-00006280: 742e 6461 7461 2066 6f72 2069 7420 696e  t.data for it in
-00006290: 2078 5d20 6966 2078 2069 7320 6e6f 7420   x] if x is not 
-000062a0: 4e6f 6e65 2065 6c73 6520 782c 0a20 2020  None else x,.   
-000062b0: 2020 2020 206f 6e5f 6465 7365 7269 616c       on_deserial
-000062c0: 697a 653d 6c61 6d62 6461 2078 3a20 5b49  ize=lambda x: [I
-000062d0: 6e64 6578 4368 756e 6b28 6974 2920 666f  ndexChunk(it) fo
-000062e0: 7220 6974 2069 6e20 785d 2069 6620 7820  r it in x] if x 
-000062f0: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
-00006300: 2078 2c0a 2020 2020 290a 0a20 2020 2064   x,.    )..    d
-00006310: 6566 205f 5f69 6e69 745f 5f28 0a20 2020  ef __init__(.   
-00006320: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00006330: 2020 206f 703d 4e6f 6e65 2c0a 2020 2020     op=None,.    
-00006340: 2020 2020 7368 6170 653d 4e6f 6e65 2c0a      shape=None,.
-00006350: 2020 2020 2020 2020 6e73 706c 6974 733d          nsplits=
-00006360: 4e6f 6e65 2c0a 2020 2020 2020 2020 6474  None,.        dt
-00006370: 7970 653d 4e6f 6e65 2c0a 2020 2020 2020  ype=None,.      
-00006380: 2020 6e61 6d65 3d4e 6f6e 652c 0a20 2020    name=None,.   
-00006390: 2020 2020 206e 616d 6573 3d4e 6f6e 652c       names=None,
-000063a0: 0a20 2020 2020 2020 2069 6e64 6578 5f76  .        index_v
-000063b0: 616c 7565 3d4e 6f6e 652c 0a20 2020 2020  alue=None,.     
-000063c0: 2020 2063 6875 6e6b 733d 4e6f 6e65 2c0a     chunks=None,.
-000063d0: 2020 2020 2020 2020 2a2a 6b77 2c0a 2020          **kw,.  
-000063e0: 2020 293a 0a20 2020 2020 2020 2073 7570    ):.        sup
-000063f0: 6572 2829 2e5f 5f69 6e69 745f 5f28 0a20  er().__init__(. 
-00006400: 2020 2020 2020 2020 2020 205f 6f70 3d6f             _op=o
-00006410: 702c 0a20 2020 2020 2020 2020 2020 205f  p,.            _
-00006420: 7368 6170 653d 7368 6170 652c 0a20 2020  shape=shape,.   
-00006430: 2020 2020 2020 2020 205f 6e73 706c 6974           _nsplit
-00006440: 733d 6e73 706c 6974 732c 0a20 2020 2020  s=nsplits,.     
-00006450: 2020 2020 2020 205f 6474 7970 653d 6474         _dtype=dt
-00006460: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-00006470: 205f 6e61 6d65 3d6e 616d 652c 0a20 2020   _name=name,.   
-00006480: 2020 2020 2020 2020 205f 6e61 6d65 733d           _names=
-00006490: 6e61 6d65 732c 0a20 2020 2020 2020 2020  names,.         
-000064a0: 2020 205f 696e 6465 785f 7661 6c75 653d     _index_value=
-000064b0: 696e 6465 785f 7661 6c75 652c 0a20 2020  index_value,.   
-000064c0: 2020 2020 2020 2020 205f 6368 756e 6b73           _chunks
-000064d0: 3d63 6875 6e6b 732c 0a20 2020 2020 2020  =chunks,.       
-000064e0: 2020 2020 202a 2a6b 772c 0a20 2020 2020       **kw,.     
-000064f0: 2020 2029 0a0a 2020 2020 4070 726f 7065     )..    @prope
-00006500: 7274 790a 2020 2020 6465 6620 7061 7261  rty.    def para
-00006510: 6d73 2873 656c 6629 202d 3e20 4469 6374  ms(self) -> Dict
-00006520: 5b73 7472 2c20 416e 795d 3a0a 2020 2020  [str, Any]:.    
-00006530: 2020 2020 2320 7061 7261 6d73 2072 6574      # params ret
-00006540: 7572 6e20 7468 6520 7072 6f70 6572 7469  urn the properti
-00006550: 6573 2077 6869 6368 2075 7365 6675 6c20  es which useful 
-00006560: 746f 2072 6562 7569 6c64 2061 206e 6577  to rebuild a new
-00006570: 2074 696c 6561 626c 6520 6f62 6a65 6374   tileable object
-00006580: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00006590: 7b0a 2020 2020 2020 2020 2020 2020 2273  {.            "s
-000065a0: 6861 7065 223a 2073 656c 662e 7368 6170  hape": self.shap
-000065b0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-000065c0: 6474 7970 6522 3a20 7365 6c66 2e64 7479  dtype": self.dty
-000065d0: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-000065e0: 226e 616d 6522 3a20 7365 6c66 2e6e 616d  "name": self.nam
-000065f0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-00006600: 696e 6465 785f 7661 6c75 6522 3a20 7365  index_value": se
-00006610: 6c66 2e69 6e64 6578 5f76 616c 7565 2c0a  lf.index_value,.
-00006620: 2020 2020 2020 2020 7d0a 0a20 2020 2040          }..    @
-00006630: 7061 7261 6d73 2e73 6574 7465 720a 2020  params.setter.  
-00006640: 2020 6465 6620 7061 7261 6d73 2873 656c    def params(sel
-00006650: 662c 206e 6577 5f70 6172 616d 733a 2044  f, new_params: D
-00006660: 6963 745b 7374 722c 2041 6e79 5d29 3a0a  ict[str, Any]):.
-00006670: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-00006680: 206e 6577 5f70 6172 616d 732e 636f 7079   new_params.copy
-00006690: 2829 0a20 2020 2020 2020 206e 6577 5f73  ().        new_s
-000066a0: 6861 7065 203d 2070 6172 616d 732e 706f  hape = params.po
-000066b0: 7028 2273 6861 7065 222c 204e 6f6e 6529  p("shape", None)
-000066c0: 0a20 2020 2020 2020 2069 6620 6e65 775f  .        if new_
-000066d0: 7368 6170 6520 6973 206e 6f74 204e 6f6e  shape is not Non
-000066e0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-000066f0: 656c 662e 5f73 6861 7065 203d 206e 6577  elf._shape = new
-00006700: 5f73 6861 7065 0a20 2020 2020 2020 2064  _shape.        d
-00006710: 7479 7065 203d 2070 6172 616d 732e 706f  type = params.po
-00006720: 7028 2264 7479 7065 222c 204e 6f6e 6529  p("dtype", None)
-00006730: 0a20 2020 2020 2020 2069 6620 6474 7970  .        if dtyp
-00006740: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-00006750: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00006760: 5f64 7479 7065 203d 2064 7479 7065 0a20  _dtype = dtype. 
-00006770: 2020 2020 2020 2069 6e64 6578 5f76 616c         index_val
-00006780: 7565 203d 2070 6172 616d 732e 706f 7028  ue = params.pop(
-00006790: 2269 6e64 6578 5f76 616c 7565 222c 204e  "index_value", N
-000067a0: 6f6e 6529 0a20 2020 2020 2020 2069 6620  one).        if 
-000067b0: 696e 6465 785f 7661 6c75 6520 6973 206e  index_value is n
-000067c0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-000067d0: 2020 2020 2073 656c 662e 5f69 6e64 6578       self._index
-000067e0: 5f76 616c 7565 203d 2069 6e64 6578 5f76  _value = index_v
-000067f0: 616c 7565 0a20 2020 2020 2020 206e 616d  alue.        nam
-00006800: 6520 3d20 7061 7261 6d73 2e70 6f70 2822  e = params.pop("
-00006810: 6e61 6d65 222c 204e 6f6e 6529 0a20 2020  name", None).   
-00006820: 2020 2020 2069 6620 6e61 6d65 2069 7320       if name is 
-00006830: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00006840: 2020 2020 2020 7365 6c66 2e5f 6e61 6d65        self._name
-00006850: 203d 206e 616d 650a 2020 2020 2020 2020   = name.        
-00006860: 6966 2070 6172 616d 733a 2020 2320 7072  if params:  # pr
-00006870: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a20  agma: no cover. 
-00006880: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00006890: 2054 7970 6545 7272 6f72 2866 2255 6e6b   TypeError(f"Unk
-000068a0: 6e6f 776e 2070 6172 616d 733a 207b 6c69  nown params: {li
-000068b0: 7374 2870 6172 616d 7329 7d22 290a 0a20  st(params)}").. 
-000068c0: 2020 2064 6566 2072 6566 7265 7368 5f70     def refresh_p
-000068d0: 6172 616d 7328 7365 6c66 293a 0a20 2020  arams(self):.   
-000068e0: 2020 2020 2023 2072 6566 7265 7368 2070       # refresh p
-000068f0: 6172 616d 7320 7768 656e 2063 6875 6e6b  arams when chunk
-00006900: 7320 7570 6461 7465 640a 2020 2020 2020  s updated.      
-00006910: 2020 7265 6672 6573 685f 7469 6c65 6162    refresh_tileab
-00006920: 6c65 5f73 6861 7065 2873 656c 6629 0a20  le_shape(self). 
-00006930: 2020 2020 2020 2072 6566 7265 7368 5f69         refresh_i
-00006940: 6e64 6578 5f76 616c 7565 2873 656c 6629  ndex_value(self)
-00006950: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00006960: 2e5f 6474 7970 6520 6973 204e 6f6e 653a  ._dtype is None:
-00006970: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00006980: 662e 5f64 7479 7065 203d 2073 656c 662e  f._dtype = self.
-00006990: 6368 756e 6b73 5b30 5d2e 6474 7970 650a  chunks[0].dtype.
-000069a0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000069b0: 5f6e 616d 6520 6973 204e 6f6e 653a 0a20  _name is None:. 
-000069c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000069d0: 5f6e 616d 6520 3d20 7365 6c66 2e63 6875  _name = self.chu
-000069e0: 6e6b 735b 305d 2e6e 616d 650a 0a20 2020  nks[0].name..   
-000069f0: 2064 6566 205f 746f 5f73 7472 2873 656c   def _to_str(sel
-00006a00: 662c 2072 6570 7265 7365 6e74 6174 696f  f, representatio
-00006a10: 6e3d 4661 6c73 6529 3a0a 2020 2020 2020  n=False):.      
-00006a20: 2020 6966 2069 735f 6275 696c 645f 6d6f    if is_build_mo
-00006a30: 6465 2829 206f 7220 6c65 6e28 7365 6c66  de() or len(self
-00006a40: 2e5f 6578 6563 7574 6564 5f73 6573 7369  ._executed_sessi
-00006a50: 6f6e 7329 203d 3d20 303a 0a20 2020 2020  ons) == 0:.     
-00006a60: 2020 2020 2020 2023 2069 6e20 6275 696c         # in buil
-00006a70: 6420 6d6f 6465 2c20 6f72 206e 6f74 2065  d mode, or not e
-00006a80: 7865 6375 7465 642c 206a 7573 7420 7265  xecuted, just re
-00006a90: 7475 726e 2072 6570 7265 7365 6e74 6174  turn representat
-00006aa0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-00006ab0: 6966 2072 6570 7265 7365 6e74 6174 696f  if representatio
-00006ac0: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
-00006ad0: 2020 2072 6574 7572 6e20 6622 496e 6465     return f"Inde
-00006ae0: 7820 3c6f 703d 7b74 7970 6528 7365 6c66  x <op={type(self
-00006af0: 2e5f 6f70 292e 5f5f 6e61 6d65 5f5f 7d2c  ._op).__name__},
-00006b00: 206b 6579 3d7b 7365 6c66 2e6b 6579 7d22   key={self.key}"
-00006b10: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00006b20: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00006b30: 2020 2072 6574 7572 6e20 6622 496e 6465     return f"Inde
-00006b40: 7828 6f70 3d7b 7479 7065 2873 656c 662e  x(op={type(self.
-00006b50: 5f6f 7029 2e5f 5f6e 616d 655f 5f7d 2922  _op).__name__})"
-00006b60: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00006b70: 2020 2020 2020 2020 2020 2064 6174 6120             data 
-00006b80: 3d20 7365 6c66 2e66 6574 6368 2873 6573  = self.fetch(ses
-00006b90: 7369 6f6e 3d73 656c 662e 5f65 7865 6375  sion=self._execu
-00006ba0: 7465 645f 7365 7373 696f 6e73 5b2d 315d  ted_sessions[-1]
-00006bb0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00006bc0: 7475 726e 2072 6570 7228 6461 7461 2920  turn repr(data) 
-00006bd0: 6966 2072 6570 7228 6461 7461 2920 656c  if repr(data) el
-00006be0: 7365 2073 7472 2864 6174 6129 0a0a 2020  se str(data)..  
-00006bf0: 2020 6465 6620 5f5f 7374 725f 5f28 7365    def __str__(se
-00006c00: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00006c10: 7572 6e20 7365 6c66 2e5f 746f 5f73 7472  urn self._to_str
-00006c20: 2872 6570 7265 7365 6e74 6174 696f 6e3d  (representation=
-00006c30: 4661 6c73 6529 0a0a 2020 2020 6465 6620  False)..    def 
-00006c40: 5f5f 7265 7072 5f5f 2873 656c 6629 3a0a  __repr__(self):.
-00006c50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00006c60: 656c 662e 5f74 6f5f 7374 7228 7265 7072  elf._to_str(repr
-00006c70: 6573 656e 7461 7469 6f6e 3d54 7275 6529  esentation=True)
-00006c80: 0a0a 2020 2020 6465 6620 5f74 6f5f 6d61  ..    def _to_ma
-00006c90: 7273 5f74 656e 736f 7228 7365 6c66 2c20  rs_tensor(self, 
-00006ca0: 6474 7970 653d 4e6f 6e65 2c20 6f72 6465  dtype=None, orde
-00006cb0: 723d 224b 222c 2065 7874 7261 6374 5f6d  r="K", extract_m
-00006cc0: 756c 7469 5f69 6e64 6578 3d46 616c 7365  ulti_index=False
-00006cd0: 293a 0a20 2020 2020 2020 2074 656e 736f  ):.        tenso
-00006ce0: 7220 3d20 7365 6c66 2e74 6f5f 7465 6e73  r = self.to_tens
-00006cf0: 6f72 2865 7874 7261 6374 5f6d 756c 7469  or(extract_multi
-00006d00: 5f69 6e64 6578 3d65 7874 7261 6374 5f6d  _index=extract_m
-00006d10: 756c 7469 5f69 6e64 6578 290a 2020 2020  ulti_index).    
-00006d20: 2020 2020 6474 7970 6520 3d20 6474 7970      dtype = dtyp
-00006d30: 6520 6966 2064 7479 7065 2069 7320 6e6f  e if dtype is no
-00006d40: 7420 4e6f 6e65 2065 6c73 6520 7465 6e73  t None else tens
-00006d50: 6f72 2e64 7479 7065 0a20 2020 2020 2020  or.dtype.       
-00006d60: 2072 6574 7572 6e20 7465 6e73 6f72 2e61   return tensor.a
-00006d70: 7374 7970 6528 6474 7970 653d 6474 7970  stype(dtype=dtyp
-00006d80: 652c 206f 7264 6572 3d6f 7264 6572 2c20  e, order=order, 
-00006d90: 636f 7079 3d46 616c 7365 290a 0a20 2020  copy=False)..   
-00006da0: 2064 6566 205f 5f6d 6172 735f 7465 6e73   def __mars_tens
-00006db0: 6f72 5f5f 2873 656c 662c 2064 7479 7065  or__(self, dtype
-00006dc0: 3d4e 6f6e 652c 206f 7264 6572 3d22 4b22  =None, order="K"
-00006dd0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00006de0: 6e20 7365 6c66 2e5f 746f 5f6d 6172 735f  n self._to_mars_
-00006df0: 7465 6e73 6f72 2864 7479 7065 3d64 7479  tensor(dtype=dty
-00006e00: 7065 2c20 6f72 6465 723d 6f72 6465 7229  pe, order=order)
-00006e10: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00006e20: 2020 2020 6465 6620 6474 7970 6528 7365      def dtype(se
-00006e30: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00006e40: 7572 6e20 6765 7461 7474 7228 7365 6c66  urn getattr(self
-00006e50: 2c20 225f 6474 7970 6522 2c20 4e6f 6e65  , "_dtype", None
-00006e60: 2920 6f72 2073 656c 662e 6f70 2e64 7479  ) or self.op.dty
-00006e70: 7065 0a0a 2020 2020 4070 726f 7065 7274  pe..    @propert
-00006e80: 790a 2020 2020 6465 6620 6e61 6d65 2873  y.    def name(s
-00006e90: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00006ea0: 7475 726e 2073 656c 662e 5f6e 616d 650a  turn self._name.
-00006eb0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00006ec0: 2020 2064 6566 206e 616d 6573 2873 656c     def names(sel
-00006ed0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00006ee0: 726e 2067 6574 6174 7472 2873 656c 662c  rn getattr(self,
-00006ef0: 2022 5f6e 616d 6573 222c 204e 6f6e 6529   "_names", None)
-00006f00: 206f 7220 5b73 656c 662e 6e61 6d65 5d0a   or [self.name].
-00006f10: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00006f20: 2020 2064 6566 2069 6e64 6578 5f76 616c     def index_val
-00006f30: 7565 2873 656c 6629 202d 3e20 496e 6465  ue(self) -> Inde
-00006f40: 7856 616c 7565 3a0a 2020 2020 2020 2020  xValue:.        
-00006f50: 7265 7475 726e 2073 656c 662e 5f69 6e64  return self._ind
-00006f60: 6578 5f76 616c 7565 0a0a 2020 2020 4070  ex_value..    @p
-00006f70: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00006f80: 696e 6665 7272 6564 5f74 7970 6528 7365  inferred_type(se
-00006f90: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00006fa0: 7572 6e20 7365 6c66 2e5f 696e 6465 785f  urn self._index_
-00006fb0: 7661 6c75 652e 696e 6665 7272 6564 5f74  value.inferred_t
-00006fc0: 7970 650a 0a20 2020 2064 6566 2074 6f5f  ype..    def to_
-00006fd0: 7465 6e73 6f72 2873 656c 662c 2064 7479  tensor(self, dty
-00006fe0: 7065 3d4e 6f6e 652c 2065 7874 7261 6374  pe=None, extract
-00006ff0: 5f6d 756c 7469 5f69 6e64 6578 3d46 616c  _multi_index=Fal
-00007000: 7365 293a 0a20 2020 2020 2020 2066 726f  se):.        fro
-00007010: 6d20 2e2e 7465 6e73 6f72 2e64 6174 6173  m ..tensor.datas
-00007020: 6f75 7263 652e 6672 6f6d 5f64 6174 6166  ource.from_dataf
-00007030: 7261 6d65 2069 6d70 6f72 7420 6672 6f6d  rame import from
-00007040: 5f69 6e64 6578 0a0a 2020 2020 2020 2020  _index..        
-00007050: 7265 7475 726e 2066 726f 6d5f 696e 6465  return from_inde
-00007060: 7828 7365 6c66 2c20 6474 7970 653d 6474  x(self, dtype=dt
-00007070: 7970 652c 2065 7874 7261 6374 5f6d 756c  ype, extract_mul
-00007080: 7469 5f69 6e64 6578 3d65 7874 7261 6374  ti_index=extract
-00007090: 5f6d 756c 7469 5f69 6e64 6578 290a 0a0a  _multi_index)...
-000070a0: 636c 6173 7320 496e 6465 7828 4861 7353  class Index(HasS
-000070b0: 6861 7065 5469 6c65 6162 6c65 2c20 5f54  hapeTileable, _T
-000070c0: 6f50 616e 6461 734d 6978 696e 293a 0a20  oPandasMixin):. 
-000070d0: 2020 205f 5f73 6c6f 7473 5f5f 203d 2022     __slots__ = "
-000070e0: 5f64 665f 6f72 5f73 6572 6965 7322 2c20  _df_or_series", 
-000070f0: 225f 7061 7265 6e74 5f6b 6579 222c 2022  "_parent_key", "
-00007100: 5f61 7869 7322 0a20 2020 205f 616c 6c6f  _axis".    _allo
-00007110: 775f 6461 7461 5f74 7970 655f 203d 2028  w_data_type_ = (
-00007120: 496e 6465 7844 6174 612c 290a 2020 2020  IndexData,).    
-00007130: 7479 7065 5f6e 616d 6520 3d20 2249 6e64  type_name = "Ind
-00007140: 6578 220a 0a20 2020 2064 6566 205f 5f6e  ex"..    def __n
-00007150: 6577 5f5f 2863 6c73 2c20 6461 7461 3a20  ew__(cls, data: 
-00007160: 556e 696f 6e5b 7064 2e49 6e64 6578 2c20  Union[pd.Index, 
-00007170: 496e 6465 7844 6174 615d 203d 204e 6f6e  IndexData] = Non
-00007180: 652c 202a 2a5f 293a 0a20 2020 2020 2020  e, **_):.       
-00007190: 2069 6620 6461 7461 2069 7320 6e6f 7420   if data is not 
-000071a0: 4e6f 6e65 2061 6e64 206e 6f74 2069 7369  None and not isi
-000071b0: 6e73 7461 6e63 6528 6461 7461 2c20 7064  nstance(data, pd
-000071c0: 2e49 6e64 6578 293a 0a20 2020 2020 2020  .Index):.       
-000071d0: 2020 2020 2023 2063 7265 6174 6520 636f       # create co
-000071e0: 7272 6573 706f 6e64 696e 6720 496e 6465  rresponding Inde
-000071f0: 7820 636c 6173 730a 2020 2020 2020 2020  x class.        
-00007200: 2020 2020 2320 6163 636f 7264 696e 6720      # according 
-00007210: 746f 2074 7970 6520 6f66 2069 6e64 6578  to type of index
-00007220: 5f76 616c 7565 0a20 2020 2020 2020 2020  _value.         
-00007230: 2020 2063 6c7a 203d 2067 6c6f 6261 6c73     clz = globals
-00007240: 2829 5b74 7970 6528 6461 7461 2e69 6e64  ()[type(data.ind
-00007250: 6578 5f76 616c 7565 2e76 616c 7565 292e  ex_value.value).
-00007260: 5f5f 6e61 6d65 5f5f 5d0a 2020 2020 2020  __name__].      
-00007270: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00007280: 2020 2020 636c 7a20 3d20 636c 730a 2020      clz = cls.  
-00007290: 2020 2020 2020 7265 7475 726e 206f 626a        return obj
-000072a0: 6563 742e 5f5f 6e65 775f 5f28 636c 7a29  ect.__new__(clz)
-000072b0: 0a0a 2020 2020 6465 6620 5f5f 6c65 6e5f  ..    def __len_
-000072c0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-000072d0: 2072 6574 7572 6e20 6c65 6e28 7365 6c66   return len(self
-000072e0: 2e5f 6461 7461 290a 0a20 2020 2064 6566  ._data)..    def
-000072f0: 205f 5f6d 6172 735f 7465 6e73 6f72 5f5f   __mars_tensor__
-00007300: 2873 656c 662c 2064 7479 7065 3d4e 6f6e  (self, dtype=Non
-00007310: 652c 206f 7264 6572 3d22 4b22 293a 0a20  e, order="K"):. 
-00007320: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00007330: 6c66 2e5f 6461 7461 2e5f 5f6d 6172 735f  lf._data.__mars_
-00007340: 7465 6e73 6f72 5f5f 2864 7479 7065 3d64  tensor__(dtype=d
-00007350: 7479 7065 2c20 6f72 6465 723d 6f72 6465  type, order=orde
-00007360: 7229 0a0a 2020 2020 6465 6620 5f67 6574  r)..    def _get
-00007370: 5f64 665f 6f72 5f73 6572 6965 7328 7365  _df_or_series(se
-00007380: 6c66 293a 0a20 2020 2020 2020 206f 626a  lf):.        obj
-00007390: 203d 2067 6574 6174 7472 2873 656c 662c   = getattr(self,
-000073a0: 2022 5f64 665f 6f72 5f73 6572 6965 7322   "_df_or_series"
-000073b0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-000073c0: 6966 206f 626a 2069 7320 6e6f 7420 4e6f  if obj is not No
-000073d0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-000073e0: 7265 7475 726e 206f 626a 2829 0a20 2020  return obj().   
-000073f0: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
-00007400: 0a0a 2020 2020 6465 6620 5f73 6574 5f64  ..    def _set_d
-00007410: 665f 6f72 5f73 6572 6965 7328 7365 6c66  f_or_series(self
-00007420: 2c20 6466 5f6f 725f 7365 7269 6573 2c20  , df_or_series, 
-00007430: 6178 6973 293a 0a20 2020 2020 2020 2073  axis):.        s
-00007440: 656c 662e 5f64 665f 6f72 5f73 6572 6965  elf._df_or_serie
-00007450: 7320 3d20 7765 616b 7265 662e 7265 6628  s = weakref.ref(
-00007460: 6466 5f6f 725f 7365 7269 6573 290a 2020  df_or_series).  
-00007470: 2020 2020 2020 7365 6c66 2e5f 7061 7265        self._pare
-00007480: 6e74 5f6b 6579 203d 2064 665f 6f72 5f73  nt_key = df_or_s
-00007490: 6572 6965 732e 6b65 790a 2020 2020 2020  eries.key.      
-000074a0: 2020 7365 6c66 2e5f 6178 6973 203d 2061    self._axis = a
-000074b0: 7869 730a 0a20 2020 2040 7072 6f70 6572  xis..    @proper
-000074c0: 7479 0a20 2020 2064 6566 2054 2873 656c  ty.    def T(sel
-000074d0: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-000074e0: 6574 7572 6e20 7468 6520 7472 616e 7370  eturn the transp
-000074f0: 6f73 652c 2077 6869 6368 2069 7320 6279  ose, which is by
-00007500: 2064 6566 696e 6974 696f 6e20 7365 6c66   definition self
-00007510: 2e22 2222 0a20 2020 2020 2020 2072 6574  .""".        ret
-00007520: 7572 6e20 7365 6c66 0a0a 2020 2020 4070  urn self..    @p
-00007530: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00007540: 6e61 6d65 2873 656c 6629 3a0a 2020 2020  name(self):.    
-00007550: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00007560: 5f64 6174 612e 6e61 6d65 0a0a 2020 2020  _data.name..    
-00007570: 406e 616d 652e 7365 7474 6572 0a20 2020  @name.setter.   
-00007580: 2064 6566 206e 616d 6528 7365 6c66 2c20   def name(self, 
-00007590: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
-000075a0: 6466 5f6f 725f 7365 7269 6573 203d 2073  df_or_series = s
-000075b0: 656c 662e 5f67 6574 5f64 665f 6f72 5f73  elf._get_df_or_s
-000075c0: 6572 6965 7328 290a 2020 2020 2020 2020  eries().        
-000075d0: 6966 2064 665f 6f72 5f73 6572 6965 7320  if df_or_series 
-000075e0: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-000075f0: 6466 5f6f 725f 7365 7269 6573 2e6b 6579  df_or_series.key
-00007600: 203d 3d20 7365 6c66 2e5f 7061 7265 6e74   == self._parent
-00007610: 5f6b 6579 3a0a 2020 2020 2020 2020 2020  _key:.          
-00007620: 2020 6466 5f6f 725f 7365 7269 6573 2e72    df_or_series.r
-00007630: 656e 616d 655f 6178 6973 2876 616c 7565  ename_axis(value
-00007640: 2c20 6178 6973 3d73 656c 662e 5f61 7869  , axis=self._axi
-00007650: 732c 2069 6e70 6c61 6365 3d54 7275 6529  s, inplace=True)
-00007660: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00007670: 662e 6461 7461 203d 2064 665f 6f72 5f73  f.data = df_or_s
-00007680: 6572 6965 732e 6178 6573 5b73 656c 662e  eries.axes[self.
-00007690: 5f61 7869 735d 2e64 6174 610a 2020 2020  _axis].data.    
-000076a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000076b0: 2020 2020 2020 7365 6c66 2e72 656e 616d        self.renam
-000076c0: 6528 7661 6c75 652c 2069 6e70 6c61 6365  e(value, inplace
-000076d0: 3d54 7275 6529 0a0a 2020 2020 4070 726f  =True)..    @pro
-000076e0: 7065 7274 790a 2020 2020 6465 6620 6e61  perty.    def na
-000076f0: 6d65 7328 7365 6c66 293a 0a20 2020 2020  mes(self):.     
-00007700: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00007710: 6461 7461 2e6e 616d 6573 0a0a 2020 2020  data.names..    
-00007720: 406e 616d 6573 2e73 6574 7465 720a 2020  @names.setter.  
-00007730: 2020 6465 6620 6e61 6d65 7328 7365 6c66    def names(self
-00007740: 2c20 7661 6c75 6529 3a0a 2020 2020 2020  , value):.      
-00007750: 2020 6466 5f6f 725f 7365 7269 6573 203d    df_or_series =
-00007760: 2073 656c 662e 5f67 6574 5f64 665f 6f72   self._get_df_or
-00007770: 5f73 6572 6965 7328 290a 2020 2020 2020  _series().      
-00007780: 2020 6966 2064 665f 6f72 5f73 6572 6965    if df_or_serie
-00007790: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
-000077a0: 2020 2020 2020 2020 2020 2064 665f 6f72             df_or
-000077b0: 5f73 6572 6965 732e 7265 6e61 6d65 5f61  _series.rename_a
-000077c0: 7869 7328 7661 6c75 652c 2061 7869 733d  xis(value, axis=
-000077d0: 7365 6c66 2e5f 6178 6973 2c20 696e 706c  self._axis, inpl
-000077e0: 6163 653d 5472 7565 290a 2020 2020 2020  ace=True).      
-000077f0: 2020 2020 2020 7365 6c66 2e64 6174 6120        self.data 
-00007800: 3d20 6466 5f6f 725f 7365 7269 6573 2e61  = df_or_series.a
-00007810: 7865 735b 7365 6c66 2e5f 6178 6973 5d2e  xes[self._axis].
-00007820: 6461 7461 0a20 2020 2020 2020 2065 6c73  data.        els
-00007830: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-00007840: 656c 662e 7265 6e61 6d65 2876 616c 7565  elf.rename(value
-00007850: 2c20 696e 706c 6163 653d 5472 7565 290a  , inplace=True).
-00007860: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00007870: 2020 2064 6566 2076 616c 7565 7328 7365     def values(se
-00007880: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00007890: 7572 6e20 7365 6c66 2e74 6f5f 7465 6e73  urn self.to_tens
-000078a0: 6f72 2829 0a0a 2020 2020 6465 6620 746f  or()..    def to
-000078b0: 5f66 7261 6d65 2873 656c 662c 2069 6e64  _frame(self, ind
-000078c0: 6578 3a20 626f 6f6c 203d 2054 7275 652c  ex: bool = True,
-000078d0: 206e 616d 653d 4e6f 6e65 293a 0a20 2020   name=None):.   
-000078e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000078f0: 2043 7265 6174 6520 6120 4461 7461 4672   Create a DataFr
-00007900: 616d 6520 7769 7468 2061 2063 6f6c 756d  ame with a colum
-00007910: 6e20 636f 6e74 6169 6e69 6e67 2074 6865  n containing the
-00007920: 2049 6e64 6578 2e0a 0a20 2020 2020 2020   Index...       
-00007930: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00007940: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00007950: 2020 2020 2020 2069 6e64 6578 203a 2062         index : b
-00007960: 6f6f 6c2c 2064 6566 6175 6c74 2054 7275  ool, default Tru
-00007970: 650a 2020 2020 2020 2020 2020 2020 5365  e.            Se
-00007980: 7420 7468 6520 696e 6465 7820 6f66 2074  t the index of t
-00007990: 6865 2072 6574 7572 6e65 6420 4461 7461  he returned Data
-000079a0: 4672 616d 6520 6173 2074 6865 206f 7269  Frame as the ori
-000079b0: 6769 6e61 6c20 496e 6465 782e 0a0a 2020  ginal Index...  
-000079c0: 2020 2020 2020 6e61 6d65 203a 206f 626a        name : obj
-000079d0: 6563 742c 2064 6566 6175 6c74 204e 6f6e  ect, default Non
-000079e0: 650a 2020 2020 2020 2020 2020 2020 5468  e.            Th
-000079f0: 6520 7061 7373 6564 206e 616d 6520 7368  e passed name sh
-00007a00: 6f75 6c64 2073 7562 7374 6974 7574 6520  ould substitute 
-00007a10: 666f 7220 7468 6520 696e 6465 7820 6e61  for the index na
-00007a20: 6d65 2028 6966 2069 7420 6861 730a 2020  me (if it has.  
-00007a30: 2020 2020 2020 2020 2020 6f6e 6529 2e0a            one)..
-00007a40: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00007a50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00007a60: 0a20 2020 2020 2020 2044 6174 6146 7261  .        DataFra
-00007a70: 6d65 0a20 2020 2020 2020 2020 2020 2044  me.            D
-00007a80: 6174 6146 7261 6d65 2063 6f6e 7461 696e  ataFrame contain
-00007a90: 696e 6720 7468 6520 6f72 6967 696e 616c  ing the original
-00007aa0: 2049 6e64 6578 2064 6174 612e 0a0a 2020   Index data...  
-00007ab0: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
-00007ac0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00007ad0: 2020 2020 2020 2020 496e 6465 782e 746f          Index.to
-00007ae0: 5f73 6572 6965 7320 3a20 436f 6e76 6572  _series : Conver
-00007af0: 7420 616e 2049 6e64 6578 2074 6f20 6120  t an Index to a 
-00007b00: 5365 7269 6573 2e0a 2020 2020 2020 2020  Series..        
-00007b10: 5365 7269 6573 2e74 6f5f 6672 616d 6520  Series.to_frame 
-00007b20: 3a20 436f 6e76 6572 7420 5365 7269 6573  : Convert Series
-00007b30: 2074 6f20 4461 7461 4672 616d 652e 0a0a   to DataFrame...
-00007b40: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-00007b50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00007b60: 2d0a 2020 2020 2020 2020 3e3e 3e20 696d  -.        >>> im
-00007b70: 706f 7274 206d 6172 732e 6461 7461 6672  port mars.datafr
-00007b80: 616d 6520 6173 206d 640a 2020 2020 2020  ame as md.      
-00007b90: 2020 3e3e 3e20 6964 7820 3d20 6d64 2e49    >>> idx = md.I
-00007ba0: 6e64 6578 285b 2741 6e74 272c 2027 4265  ndex(['Ant', 'Be
-00007bb0: 6172 272c 2027 436f 7727 5d2c 206e 616d  ar', 'Cow'], nam
-00007bc0: 653d 2761 6e69 6d61 6c27 290a 2020 2020  e='animal').    
-00007bd0: 2020 2020 3e3e 3e20 6964 782e 746f 5f66      >>> idx.to_f
-00007be0: 7261 6d65 2829 2e65 7865 6375 7465 2829  rame().execute()
-00007bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007c00: 616e 696d 616c 0a20 2020 2020 2020 2061  animal.        a
-00007c10: 6e69 6d61 6c0a 2020 2020 2020 2020 416e  nimal.        An
-00007c20: 7420 2020 2020 2020 416e 740a 2020 2020  t       Ant.    
-00007c30: 2020 2020 4265 6172 2020 2020 2042 6561      Bear     Bea
-00007c40: 720a 2020 2020 2020 2020 436f 7720 2020  r.        Cow   
-00007c50: 2020 2020 436f 770a 0a20 2020 2020 2020      Cow..       
-00007c60: 2042 7920 6465 6661 756c 742c 2074 6865   By default, the
-00007c70: 206f 7269 6769 6e61 6c20 496e 6465 7820   original Index 
-00007c80: 6973 2072 6575 7365 642e 2054 6f20 656e  is reused. To en
-00007c90: 666f 7263 6520 6120 6e65 7720 496e 6465  force a new Inde
-00007ca0: 783a 0a0a 2020 2020 2020 2020 3e3e 3e20  x:..        >>> 
-00007cb0: 6964 782e 746f 5f66 7261 6d65 2869 6e64  idx.to_frame(ind
-00007cc0: 6578 3d46 616c 7365 292e 6578 6563 7574  ex=False).execut
-00007cd0: 6528 290a 2020 2020 2020 2020 2020 616e  e().          an
-00007ce0: 696d 616c 0a20 2020 2020 2020 2030 2020  imal.        0  
-00007cf0: 2020 416e 740a 2020 2020 2020 2020 3120    Ant.        1 
-00007d00: 2020 4265 6172 0a20 2020 2020 2020 2032    Bear.        2
-00007d10: 2020 2020 436f 770a 0a20 2020 2020 2020      Cow..       
-00007d20: 2054 6f20 6f76 6572 7269 6465 2074 6865   To override the
-00007d30: 206e 616d 6520 6f66 2074 6865 2072 6573   name of the res
-00007d40: 756c 7469 6e67 2063 6f6c 756d 6e2c 2073  ulting column, s
-00007d50: 7065 6369 6679 2060 6e61 6d65 603a 0a0a  pecify `name`:..
-00007d60: 2020 2020 2020 2020 3e3e 3e20 6964 782e          >>> idx.
-00007d70: 746f 5f66 7261 6d65 2869 6e64 6578 3d46  to_frame(index=F
-00007d80: 616c 7365 2c20 6e61 6d65 3d27 7a6f 6f27  alse, name='zoo'
-00007d90: 292e 6578 6563 7574 6528 290a 2020 2020  ).execute().    
-00007da0: 2020 2020 2020 2020 7a6f 6f0a 2020 2020          zoo.    
-00007db0: 2020 2020 3020 2020 416e 740a 2020 2020      0   Ant.    
-00007dc0: 2020 2020 3120 2042 6561 720a 2020 2020      1  Bear.    
-00007dd0: 2020 2020 3220 2020 436f 770a 2020 2020      2   Cow.    
-00007de0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00007df0: 6672 6f6d 202e 2069 6d70 6f72 7420 6461  from . import da
-00007e00: 7461 6672 616d 655f 6672 6f6d 5f74 656e  taframe_from_ten
-00007e10: 736f 720a 0a20 2020 2020 2020 2069 6620  sor..        if 
-00007e20: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
-00007e30: 696e 6465 785f 7661 6c75 652e 7661 6c75  index_value.valu
-00007e40: 652c 2049 6e64 6578 5661 6c75 652e 4d75  e, IndexValue.Mu
-00007e50: 6c74 6949 6e64 6578 293a 0a20 2020 2020  ltiIndex):.     
-00007e60: 2020 2020 2020 206f 6c64 5f6e 616d 6573         old_names
-00007e70: 203d 2073 656c 662e 696e 6465 785f 7661   = self.index_va
-00007e80: 6c75 652e 7661 6c75 652e 6e61 6d65 730a  lue.value.names.
-00007e90: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00007ea0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00007eb0: 2020 6e61 6d65 2069 7320 6e6f 7420 4e6f    name is not No
-00007ec0: 6e65 0a20 2020 2020 2020 2020 2020 2020  ne.             
-00007ed0: 2020 2061 6e64 206e 6f74 2069 7369 6e73     and not isins
-00007ee0: 7461 6e63 6528 6e61 6d65 2c20 4974 6572  tance(name, Iter
-00007ef0: 6162 6c65 290a 2020 2020 2020 2020 2020  able).          
-00007f00: 2020 2020 2020 6f72 2069 7369 6e73 7461        or isinsta
-00007f10: 6e63 6528 6e61 6d65 2c20 7374 7229 0a20  nce(name, str). 
-00007f20: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
-00007f30: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00007f40: 6973 6520 5479 7065 4572 726f 7228 2227  ise TypeError("'
-00007f50: 6e61 6d65 2720 6d75 7374 2062 6520 6120  name' must be a 
-00007f60: 6c69 7374 202f 2073 6571 7565 6e63 6520  list / sequence 
-00007f70: 6f66 2063 6f6c 756d 6e20 6e61 6d65 732e  of column names.
-00007f80: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
-00007f90: 6e61 6d65 203d 206c 6973 7428 6e61 6d65  name = list(name
-00007fa0: 2069 6620 6e61 6d65 2069 7320 6e6f 7420   if name is not 
-00007fb0: 4e6f 6e65 2065 6c73 6520 6f6c 645f 6e61  None else old_na
-00007fc0: 6d65 7329 0a20 2020 2020 2020 2020 2020  mes).           
-00007fd0: 2069 6620 6c65 6e28 6e61 6d65 2920 213d   if len(name) !=
-00007fe0: 206c 656e 286f 6c64 5f6e 616d 6573 293a   len(old_names):
-00007ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008000: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00008010: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00008020: 2020 2020 2020 2022 276e 616d 6527 2073         "'name' s
-00008030: 686f 756c 6420 6861 7665 2073 616d 6520  hould have same 
-00008040: 6c65 6e67 7468 2061 7320 6e75 6d62 6572  length as number
-00008050: 206f 6620 6c65 7665 6c73 206f 6e20 696e   of levels on in
-00008060: 6465 782e 220a 2020 2020 2020 2020 2020  dex.".          
-00008070: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00008080: 2020 2020 2063 6f6c 756d 6e73 203d 205b       columns = [
-00008090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000080a0: 206f 6c64 206f 7220 6e65 7720 6f72 2069   old or new or i
-000080b0: 6478 2066 6f72 2069 6478 2c20 286f 6c64  dx for idx, (old
-000080c0: 2c20 6e65 7729 2069 6e20 656e 756d 6572  , new) in enumer
-000080d0: 6174 6528 7a69 7028 6f6c 645f 6e61 6d65  ate(zip(old_name
-000080e0: 732c 206e 616d 6529 290a 2020 2020 2020  s, name)).      
-000080f0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00008100: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00008110: 2020 636f 6c75 6d6e 7320 3d20 5b6e 616d    columns = [nam
-00008120: 6520 6f72 2073 656c 662e 6e61 6d65 206f  e or self.name o
-00008130: 7220 305d 0a20 2020 2020 2020 2069 6e64  r 0].        ind
-00008140: 6578 5f20 3d20 7365 6c66 2069 6620 696e  ex_ = self if in
-00008150: 6465 7820 656c 7365 204e 6f6e 650a 2020  dex else None.  
-00008160: 2020 2020 2020 7265 7475 726e 2064 6174        return dat
-00008170: 6166 7261 6d65 5f66 726f 6d5f 7465 6e73  aframe_from_tens
-00008180: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00008190: 7365 6c66 2e5f 6461 7461 2e5f 746f 5f6d  self._data._to_m
-000081a0: 6172 735f 7465 6e73 6f72 2873 656c 662c  ars_tensor(self,
-000081b0: 2065 7874 7261 6374 5f6d 756c 7469 5f69   extract_multi_i
-000081c0: 6e64 6578 3d54 7275 6529 2c0a 2020 2020  ndex=True),.    
-000081d0: 2020 2020 2020 2020 696e 6465 783d 696e          index=in
-000081e0: 6465 785f 2c0a 2020 2020 2020 2020 2020  dex_,.          
-000081f0: 2020 636f 6c75 6d6e 733d 636f 6c75 6d6e    columns=column
-00008200: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
-00008210: 2020 6465 6620 746f 5f73 6572 6965 7328    def to_series(
-00008220: 7365 6c66 2c20 696e 6465 783d 4e6f 6e65  self, index=None
-00008230: 2c20 6e61 6d65 3d4e 6f6e 6529 3a0a 2020  , name=None):.  
-00008240: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00008250: 2020 4372 6561 7465 2061 2053 6572 6965    Create a Serie
-00008260: 7320 7769 7468 2062 6f74 6820 696e 6465  s with both inde
-00008270: 7820 616e 6420 7661 6c75 6573 2065 7175  x and values equ
-00008280: 616c 2074 6f20 7468 6520 696e 6465 7820  al to the index 
-00008290: 6b65 7973 2e0a 0a20 2020 2020 2020 2055  keys...        U
-000082a0: 7365 6675 6c20 7769 7468 206d 6170 2066  seful with map f
-000082b0: 6f72 2072 6574 7572 6e69 6e67 2061 6e20  or returning an 
-000082c0: 696e 6465 7865 7220 6261 7365 6420 6f6e  indexer based on
-000082d0: 2061 6e20 696e 6465 782e 0a0a 2020 2020   an index...    
-000082e0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-000082f0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00008300: 2d0a 2020 2020 2020 2020 696e 6465 7820  -.        index 
-00008310: 3a20 496e 6465 782c 206f 7074 696f 6e61  : Index, optiona
-00008320: 6c0a 2020 2020 2020 2020 2020 2020 496e  l.            In
-00008330: 6465 7820 6f66 2072 6573 756c 7469 6e67  dex of resulting
-00008340: 2053 6572 6965 732e 2049 6620 4e6f 6e65   Series. If None
-00008350: 2c20 6465 6661 756c 7473 2074 6f20 6f72  , defaults to or
-00008360: 6967 696e 616c 2069 6e64 6578 2e0a 2020  iginal index..  
-00008370: 2020 2020 2020 6e61 6d65 203a 2073 7472        name : str
-00008380: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00008390: 2020 2020 2020 2044 616d 6520 6f66 2072         Dame of r
-000083a0: 6573 756c 7469 6e67 2053 6572 6965 732e  esulting Series.
-000083b0: 2049 6620 4e6f 6e65 2c20 6465 6661 756c   If None, defaul
-000083c0: 7473 2074 6f20 6e61 6d65 206f 6620 6f72  ts to name of or
-000083d0: 6967 696e 616c 0a20 2020 2020 2020 2020  iginal.         
-000083e0: 2020 2069 6e64 6578 2e0a 0a20 2020 2020     index...     
-000083f0: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-00008400: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00008410: 2020 2053 6572 6965 730a 2020 2020 2020     Series.      
-00008420: 2020 2020 2020 5468 6520 6474 7970 6520        The dtype 
-00008430: 7769 6c6c 2062 6520 6261 7365 6420 6f6e  will be based on
-00008440: 2074 6865 2074 7970 6520 6f66 2074 6865   the type of the
-00008450: 2049 6e64 6578 2076 616c 7565 732e 0a20   Index values.. 
-00008460: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00008470: 2020 2066 726f 6d20 2e20 696d 706f 7274     from . import
-00008480: 2073 6572 6965 735f 6672 6f6d 5f69 6e64   series_from_ind
-00008490: 6578 0a0a 2020 2020 2020 2020 7265 7475  ex..        retu
-000084a0: 726e 2073 6572 6965 735f 6672 6f6d 5f69  rn series_from_i
-000084b0: 6e64 6578 2873 656c 662c 2069 6e64 6578  ndex(self, index
-000084c0: 3d69 6e64 6578 2c20 6e61 6d65 3d6e 616d  =index, name=nam
-000084d0: 6529 0a0a 0a63 6c61 7373 2052 616e 6765  e)...class Range
-000084e0: 496e 6465 7828 496e 6465 7829 3a0a 2020  Index(Index):.  
-000084f0: 2020 5f5f 736c 6f74 735f 5f20 3d20 2829    __slots__ = ()
-00008500: 0a0a 0a63 6c61 7373 2043 6174 6567 6f72  ...class Categor
-00008510: 6963 616c 496e 6465 7828 496e 6465 7829  icalIndex(Index)
-00008520: 3a0a 2020 2020 5f5f 736c 6f74 735f 5f20  :.    __slots__ 
-00008530: 3d20 2829 0a0a 0a63 6c61 7373 2049 6e74  = ()...class Int
-00008540: 6572 7661 6c49 6e64 6578 2849 6e64 6578  ervalIndex(Index
-00008550: 293a 0a20 2020 205f 5f73 6c6f 7473 5f5f  ):.    __slots__
-00008560: 203d 2028 290a 0a0a 636c 6173 7320 4461   = ()...class Da
-00008570: 7465 7469 6d65 496e 6465 7828 496e 6465  tetimeIndex(Inde
-00008580: 7829 3a0a 2020 2020 5f5f 736c 6f74 735f  x):.    __slots_
-00008590: 5f20 3d20 2829 0a0a 0a63 6c61 7373 2054  _ = ()...class T
-000085a0: 696d 6564 656c 7461 496e 6465 7828 496e  imedeltaIndex(In
-000085b0: 6465 7829 3a0a 2020 2020 5f5f 736c 6f74  dex):.    __slot
-000085c0: 735f 5f20 3d20 2829 0a0a 0a63 6c61 7373  s__ = ()...class
-000085d0: 2050 6572 696f 6449 6e64 6578 2849 6e64   PeriodIndex(Ind
-000085e0: 6578 293a 0a20 2020 205f 5f73 6c6f 7473  ex):.    __slots
-000085f0: 5f5f 203d 2028 290a 0a0a 636c 6173 7320  __ = ()...class 
-00008600: 496e 7436 3449 6e64 6578 2849 6e64 6578  Int64Index(Index
-00008610: 293a 0a20 2020 205f 5f73 6c6f 7473 5f5f  ):.    __slots__
-00008620: 203d 2028 290a 0a0a 636c 6173 7320 5549   = ()...class UI
-00008630: 6e74 3634 496e 6465 7828 496e 6465 7829  nt64Index(Index)
-00008640: 3a0a 2020 2020 5f5f 736c 6f74 735f 5f20  :.    __slots__ 
-00008650: 3d20 2829 0a0a 0a63 6c61 7373 2046 6c6f  = ()...class Flo
-00008660: 6174 3634 496e 6465 7828 496e 6465 7829  at64Index(Index)
-00008670: 3a0a 2020 2020 5f5f 736c 6f74 735f 5f20  :.    __slots__ 
-00008680: 3d20 2829 0a0a 0a63 6c61 7373 204d 756c  = ()...class Mul
-00008690: 7469 496e 6465 7828 496e 6465 7829 3a0a  tiIndex(Index):.
-000086a0: 2020 2020 5f5f 736c 6f74 735f 5f20 3d20      __slots__ = 
-000086b0: 2829 0a0a 0a63 6c61 7373 2042 6173 6553  ()...class BaseS
-000086c0: 6572 6965 7343 6875 6e6b 4461 7461 284c  eriesChunkData(L
-000086d0: 617a 794d 6574 6143 6875 6e6b 4461 7461  azyMetaChunkData
-000086e0: 293a 0a20 2020 205f 5f73 6c6f 7473 5f5f  ):.    __slots__
-000086f0: 203d 2028 290a 0a20 2020 2023 2072 6571   = ()..    # req
-00008700: 7569 7265 6420 6669 656c 6473 0a20 2020  uired fields.   
-00008710: 205f 7368 6170 6520 3d20 5475 706c 6546   _shape = TupleF
-00008720: 6965 6c64 280a 2020 2020 2020 2020 2273  ield(.        "s
-00008730: 6861 7065 222c 0a20 2020 2020 2020 2046  hape",.        F
-00008740: 6965 6c64 5479 7065 732e 696e 7436 342c  ieldTypes.int64,
-00008750: 0a20 2020 2020 2020 206f 6e5f 7365 7269  .        on_seri
-00008760: 616c 697a 653d 6f6e 5f73 6572 6961 6c69  alize=on_seriali
-00008770: 7a65 5f73 6861 7065 2c0a 2020 2020 2020  ze_shape,.      
-00008780: 2020 6f6e 5f64 6573 6572 6961 6c69 7a65    on_deserialize
-00008790: 3d6f 6e5f 6465 7365 7269 616c 697a 655f  =on_deserialize_
-000087a0: 7368 6170 652c 0a20 2020 2029 0a20 2020  shape,.    ).   
-000087b0: 2023 206f 7074 696f 6e61 6c20 6669 656c   # optional fiel
-000087c0: 640a 2020 2020 5f64 7479 7065 203d 2044  d.    _dtype = D
-000087d0: 6174 6154 7970 6546 6965 6c64 2822 6474  ataTypeField("dt
-000087e0: 7970 6522 290a 2020 2020 5f6e 616d 6520  ype").    _name 
-000087f0: 3d20 416e 7946 6965 6c64 2822 6e61 6d65  = AnyField("name
-00008800: 2229 0a20 2020 205f 696e 6465 785f 7661  ").    _index_va
-00008810: 6c75 6520 3d20 4368 756e 6b49 6e64 6578  lue = ChunkIndex
-00008820: 5661 6c75 6546 6965 6c64 280a 2020 2020  ValueField(.    
-00008830: 2020 2020 2269 6e64 6578 5f76 616c 7565      "index_value
-00008840: 222c 2049 6e64 6578 5661 6c75 652c 206f  ", IndexValue, o
-00008850: 6e5f 6465 7365 7269 616c 697a 653d 5f6f  n_deserialize=_o
-00008860: 6e5f 6465 7365 7269 616c 697a 655f 696e  n_deserialize_in
-00008870: 6465 785f 7661 6c75 650a 2020 2020 290a  dex_value.    ).
-00008880: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00008890: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
-000088a0: 0a20 2020 2020 2020 206f 703d 4e6f 6e65  .        op=None
-000088b0: 2c0a 2020 2020 2020 2020 7368 6170 653d  ,.        shape=
-000088c0: 4e6f 6e65 2c0a 2020 2020 2020 2020 696e  None,.        in
-000088d0: 6465 783d 4e6f 6e65 2c0a 2020 2020 2020  dex=None,.      
-000088e0: 2020 6474 7970 653d 4e6f 6e65 2c0a 2020    dtype=None,.  
-000088f0: 2020 2020 2020 6e61 6d65 3d4e 6f6e 652c        name=None,
-00008900: 0a20 2020 2020 2020 2069 6e64 6578 5f76  .        index_v
-00008910: 616c 7565 3d4e 6f6e 652c 0a20 2020 2020  alue=None,.     
-00008920: 2020 202a 2a6b 772c 0a20 2020 2029 3a0a     **kw,.    ):.
-00008930: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-00008940: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
-00008950: 2020 2020 2020 5f6f 703d 6f70 2c0a 2020        _op=op,.  
-00008960: 2020 2020 2020 2020 2020 5f73 6861 7065            _shape
-00008970: 3d73 6861 7065 2c0a 2020 2020 2020 2020  =shape,.        
-00008980: 2020 2020 5f69 6e64 6578 3d69 6e64 6578      _index=index
-00008990: 2c0a 2020 2020 2020 2020 2020 2020 5f64  ,.            _d
-000089a0: 7479 7065 3d64 7479 7065 2c0a 2020 2020  type=dtype,.    
-000089b0: 2020 2020 2020 2020 5f6e 616d 653d 6e61          _name=na
-000089c0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-000089d0: 5f69 6e64 6578 5f76 616c 7565 3d69 6e64  _index_value=ind
-000089e0: 6578 5f76 616c 7565 2c0a 2020 2020 2020  ex_value,.      
-000089f0: 2020 2020 2020 2a2a 6b77 2c0a 2020 2020        **kw,.    
-00008a00: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
-00008a10: 6765 745f 7061 7261 6d73 2873 656c 6629  get_params(self)
-00008a20: 202d 3e20 4469 6374 5b73 7472 2c20 416e   -> Dict[str, An
-00008a30: 795d 3a0a 2020 2020 2020 2020 2320 7061  y]:.        # pa
-00008a40: 7261 6d73 2072 6574 7572 6e20 7468 6520  rams return the 
-00008a50: 7072 6f70 6572 7469 6573 2077 6869 6368  properties which
-00008a60: 2075 7365 6675 6c20 746f 2072 6562 7569   useful to rebui
-00008a70: 6c64 2061 206e 6577 2063 6875 6e6b 0a20  ld a new chunk. 
-00008a80: 2020 2020 2020 2072 6574 7572 6e20 7b0a         return {.
-00008a90: 2020 2020 2020 2020 2020 2020 2273 6861              "sha
-00008aa0: 7065 223a 2073 656c 662e 7368 6170 652c  pe": self.shape,
-00008ab0: 0a20 2020 2020 2020 2020 2020 2022 6474  .            "dt
-00008ac0: 7970 6522 3a20 7365 6c66 2e64 7479 7065  ype": self.dtype
-00008ad0: 2c0a 2020 2020 2020 2020 2020 2020 2269  ,.            "i
-00008ae0: 6e64 6578 223a 2073 656c 662e 696e 6465  ndex": self.inde
-00008af0: 782c 0a20 2020 2020 2020 2020 2020 2022  x,.            "
-00008b00: 696e 6465 785f 7661 6c75 6522 3a20 7365  index_value": se
-00008b10: 6c66 2e69 6e64 6578 5f76 616c 7565 2c0a  lf.index_value,.
-00008b20: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
-00008b30: 6522 3a20 7365 6c66 2e6e 616d 652c 0a20  e": self.name,. 
-00008b40: 2020 2020 2020 207d 0a0a 2020 2020 6465         }..    de
-00008b50: 6620 5f73 6574 5f70 6172 616d 7328 7365  f _set_params(se
-00008b60: 6c66 2c20 6e65 775f 7061 7261 6d73 3a20  lf, new_params: 
-00008b70: 4469 6374 5b73 7472 2c20 416e 795d 293a  Dict[str, Any]):
-00008b80: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-00008b90: 3d20 6e65 775f 7061 7261 6d73 2e63 6f70  = new_params.cop
-00008ba0: 7928 290a 2020 2020 2020 2020 7061 7261  y().        para
-00008bb0: 6d73 2e70 6f70 2822 696e 6465 7822 2c20  ms.pop("index", 
-00008bc0: 4e6f 6e65 2920 2023 2069 6e64 6578 206e  None)  # index n
-00008bd0: 6f74 206e 6565 6465 6420 746f 2075 7064  ot needed to upd
-00008be0: 6174 650a 2020 2020 2020 2020 6e65 775f  ate.        new_
-00008bf0: 7368 6170 6520 3d20 7061 7261 6d73 2e70  shape = params.p
-00008c00: 6f70 2822 7368 6170 6522 2c20 4e6f 6e65  op("shape", None
-00008c10: 290a 2020 2020 2020 2020 6966 206e 6577  ).        if new
-00008c20: 5f73 6861 7065 2069 7320 6e6f 7420 4e6f  _shape is not No
-00008c30: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00008c40: 7365 6c66 2e5f 7368 6170 6520 3d20 6e65  self._shape = ne
-00008c50: 775f 7368 6170 650a 2020 2020 2020 2020  w_shape.        
-00008c60: 6474 7970 6520 3d20 7061 7261 6d73 2e70  dtype = params.p
-00008c70: 6f70 2822 6474 7970 6522 2c20 4e6f 6e65  op("dtype", None
-00008c80: 290a 2020 2020 2020 2020 6966 2064 7479  ).        if dty
-00008c90: 7065 2069 7320 6e6f 7420 4e6f 6e65 3a0a  pe is not None:.
-00008ca0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00008cb0: 2e5f 6474 7970 6520 3d20 6474 7970 650a  ._dtype = dtype.
-00008cc0: 2020 2020 2020 2020 696e 6465 785f 7661          index_va
-00008cd0: 6c75 6520 3d20 7061 7261 6d73 2e70 6f70  lue = params.pop
-00008ce0: 2822 696e 6465 785f 7661 6c75 6522 2c20  ("index_value", 
-00008cf0: 4e6f 6e65 290a 2020 2020 2020 2020 6966  None).        if
-00008d00: 2069 6e64 6578 5f76 616c 7565 2069 7320   index_value is 
-00008d10: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00008d20: 2020 2020 2020 7365 6c66 2e5f 696e 6465        self._inde
-00008d30: 785f 7661 6c75 6520 3d20 696e 6465 785f  x_value = index_
-00008d40: 7661 6c75 650a 2020 2020 2020 2020 6e61  value.        na
-00008d50: 6d65 203d 2070 6172 616d 732e 706f 7028  me = params.pop(
-00008d60: 226e 616d 6522 2c20 4e6f 6e65 290a 2020  "name", None).  
-00008d70: 2020 2020 2020 6966 206e 616d 6520 6973        if name is
-00008d80: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00008d90: 2020 2020 2020 2073 656c 662e 5f6e 616d         self._nam
-00008da0: 6520 3d20 6e61 6d65 0a20 2020 2020 2020  e = name.       
-00008db0: 2069 6620 7061 7261 6d73 3a20 2023 2070   if params:  # p
-00008dc0: 7261 676d 613a 206e 6f20 636f 7665 720a  ragma: no cover.
-00008dd0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00008de0: 6520 5479 7065 4572 726f 7228 6622 556e  e TypeError(f"Un
-00008df0: 6b6e 6f77 6e20 7061 7261 6d73 3a20 7b6c  known params: {l
-00008e00: 6973 7428 7061 7261 6d73 297d 2229 0a0a  ist(params)}")..
-00008e10: 2020 2020 7061 7261 6d73 203d 2070 726f      params = pro
-00008e20: 7065 7274 7928 5f67 6574 5f70 6172 616d  perty(_get_param
-00008e30: 732c 205f 7365 745f 7061 7261 6d73 290a  s, _set_params).
-00008e40: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-00008e50: 640a 2020 2020 6465 6620 6765 745f 7061  d.    def get_pa
-00008e60: 7261 6d73 5f66 726f 6d5f 6461 7461 2863  rams_from_data(c
-00008e70: 6c73 2c20 6461 7461 3a20 7064 2e53 6572  ls, data: pd.Ser
-00008e80: 6965 7329 202d 3e20 4469 6374 5b73 7472  ies) -> Dict[str
-00008e90: 2c20 416e 795d 3a0a 2020 2020 2020 2020  , Any]:.        
-00008ea0: 7265 7475 726e 207b 0a20 2020 2020 2020  return {.       
-00008eb0: 2020 2020 2022 7368 6170 6522 3a20 6461       "shape": da
-00008ec0: 7461 2e73 6861 7065 2c0a 2020 2020 2020  ta.shape,.      
-00008ed0: 2020 2020 2020 2264 7479 7065 223a 2064        "dtype": d
-00008ee0: 6174 612e 6474 7970 652c 0a20 2020 2020  ata.dtype,.     
-00008ef0: 2020 2020 2020 2022 696e 6465 785f 7661         "index_va
-00008f00: 6c75 6522 3a20 7061 7273 655f 696e 6465  lue": parse_inde
-00008f10: 7828 6461 7461 2e69 6e64 6578 2c20 7374  x(data.index, st
-00008f20: 6f72 655f 6461 7461 3d46 616c 7365 292c  ore_data=False),
-00008f30: 0a20 2020 2020 2020 2020 2020 2022 6e61  .            "na
-00008f40: 6d65 223a 2064 6174 612e 6e61 6d65 2c0a  me": data.name,.
-00008f50: 2020 2020 2020 2020 7d0a 0a20 2020 2040          }..    @
-00008f60: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00008f70: 2073 6861 7065 2873 656c 6629 3a0a 2020   shape(self):.  
-00008f80: 2020 2020 2020 7265 7475 726e 2067 6574        return get
-00008f90: 6174 7472 2873 656c 662c 2022 5f73 6861  attr(self, "_sha
-00008fa0: 7065 222c 204e 6f6e 6529 0a0a 2020 2020  pe", None)..    
-00008fb0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00008fc0: 6620 6e64 696d 2873 656c 6629 3a0a 2020  f ndim(self):.  
-00008fd0: 2020 2020 2020 7265 7475 726e 206c 656e        return len
-00008fe0: 2873 656c 662e 7368 6170 6529 0a0a 2020  (self.shape)..  
-00008ff0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00009000: 6465 6620 6474 7970 6528 7365 6c66 293a  def dtype(self):
-00009010: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00009020: 7365 6c66 2e5f 6474 7970 650a 0a20 2020  self._dtype..   
-00009030: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00009040: 6566 206e 616d 6528 7365 6c66 293a 0a20  ef name(self):. 
-00009050: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00009060: 6c66 2e5f 6e61 6d65 0a0a 2020 2020 4070  lf._name..    @p
-00009070: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00009080: 696e 6465 785f 7661 6c75 6528 7365 6c66  index_value(self
-00009090: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-000090a0: 6e20 7365 6c66 2e5f 696e 6465 785f 7661  n self._index_va
-000090b0: 6c75 650a 0a0a 636c 6173 7320 5365 7269  lue...class Seri
-000090c0: 6573 4368 756e 6b44 6174 6128 4261 7365  esChunkData(Base
-000090d0: 5365 7269 6573 4368 756e 6b44 6174 6129  SeriesChunkData)
-000090e0: 3a0a 2020 2020 7479 7065 5f6e 616d 6520  :.    type_name 
-000090f0: 3d20 2253 6572 6965 7322 0a0a 0a63 6c61  = "Series"...cla
-00009100: 7373 2053 6572 6965 7343 6875 6e6b 2843  ss SeriesChunk(C
-00009110: 6875 6e6b 293a 0a20 2020 205f 5f73 6c6f  hunk):.    __slo
-00009120: 7473 5f5f 203d 2028 290a 2020 2020 5f61  ts__ = ().    _a
-00009130: 6c6c 6f77 5f64 6174 615f 7479 7065 5f20  llow_data_type_ 
-00009140: 3d20 2853 6572 6965 7343 6875 6e6b 4461  = (SeriesChunkDa
-00009150: 7461 2c29 0a20 2020 2074 7970 655f 6e61  ta,).    type_na
-00009160: 6d65 203d 2022 5365 7269 6573 220a 0a0a  me = "Series"...
-00009170: 636c 6173 7320 4261 7365 5365 7269 6573  class BaseSeries
-00009180: 4461 7461 2848 6173 5368 6170 6554 696c  Data(HasShapeTil
-00009190: 6561 626c 6544 6174 612c 205f 546f 5061  eableData, _ToPa
-000091a0: 6e64 6173 4d69 7869 6e29 3a0a 2020 2020  ndasMixin):.    
-000091b0: 5f5f 736c 6f74 735f 5f20 3d20 225f 6361  __slots__ = "_ca
-000091c0: 6368 6522 2c20 225f 6163 6365 7373 6f72  che", "_accessor
-000091d0: 7322 0a0a 2020 2020 2320 6f70 7469 6f6e  s"..    # option
-000091e0: 616c 2066 6965 6c64 0a20 2020 205f 6474  al field.    _dt
-000091f0: 7970 6520 3d20 4461 7461 5479 7065 4669  ype = DataTypeFi
-00009200: 656c 6428 2264 7479 7065 2229 0a20 2020  eld("dtype").   
-00009210: 205f 6e61 6d65 203d 2041 6e79 4669 656c   _name = AnyFiel
-00009220: 6428 226e 616d 6522 290a 2020 2020 5f69  d("name").    _i
-00009230: 6e64 6578 5f76 616c 7565 203d 2052 6566  ndex_value = Ref
-00009240: 6572 656e 6365 4669 656c 6428 0a20 2020  erenceField(.   
-00009250: 2020 2020 2022 696e 6465 785f 7661 6c75       "index_valu
-00009260: 6522 2c20 496e 6465 7856 616c 7565 2c20  e", IndexValue, 
-00009270: 6f6e 5f64 6573 6572 6961 6c69 7a65 3d5f  on_deserialize=_
-00009280: 6f6e 5f64 6573 6572 6961 6c69 7a65 5f69  on_deserialize_i
-00009290: 6e64 6578 5f76 616c 7565 0a20 2020 2029  ndex_value.    )
-000092a0: 0a20 2020 205f 6368 756e 6b73 203d 204c  .    _chunks = L
-000092b0: 6973 7446 6965 6c64 280a 2020 2020 2020  istField(.      
-000092c0: 2020 2263 6875 6e6b 7322 2c0a 2020 2020    "chunks",.    
-000092d0: 2020 2020 4669 656c 6454 7970 6573 2e72      FieldTypes.r
-000092e0: 6566 6572 656e 6365 2853 6572 6965 7343  eference(SeriesC
-000092f0: 6875 6e6b 4461 7461 292c 0a20 2020 2020  hunkData),.     
-00009300: 2020 206f 6e5f 7365 7269 616c 697a 653d     on_serialize=
-00009310: 6c61 6d62 6461 2078 3a20 5b69 742e 6461  lambda x: [it.da
-00009320: 7461 2066 6f72 2069 7420 696e 2078 5d20  ta for it in x] 
-00009330: 6966 2078 2069 7320 6e6f 7420 4e6f 6e65  if x is not None
-00009340: 2065 6c73 6520 782c 0a20 2020 2020 2020   else x,.       
-00009350: 206f 6e5f 6465 7365 7269 616c 697a 653d   on_deserialize=
-00009360: 6c61 6d62 6461 2078 3a20 5b53 6572 6965  lambda x: [Serie
-00009370: 7343 6875 6e6b 2869 7429 2066 6f72 2069  sChunk(it) for i
-00009380: 7420 696e 2078 5d20 6966 2078 2069 7320  t in x] if x is 
-00009390: 6e6f 7420 4e6f 6e65 2065 6c73 6520 782c  not None else x,
-000093a0: 0a20 2020 2029 0a0a 2020 2020 6465 6620  .    )..    def 
-000093b0: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
-000093c0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000093d0: 6f70 3d4e 6f6e 652c 0a20 2020 2020 2020  op=None,.       
-000093e0: 2073 6861 7065 3d4e 6f6e 652c 0a20 2020   shape=None,.   
-000093f0: 2020 2020 206e 7370 6c69 7473 3d4e 6f6e       nsplits=Non
-00009400: 652c 0a20 2020 2020 2020 2064 7479 7065  e,.        dtype
-00009410: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
-00009420: 616d 653d 4e6f 6e65 2c0a 2020 2020 2020  ame=None,.      
-00009430: 2020 696e 6465 785f 7661 6c75 653d 4e6f    index_value=No
-00009440: 6e65 2c0a 2020 2020 2020 2020 6368 756e  ne,.        chun
-00009450: 6b73 3d4e 6f6e 652c 0a20 2020 2020 2020  ks=None,.       
-00009460: 202a 2a6b 772c 0a20 2020 2029 3a0a 2020   **kw,.    ):.  
-00009470: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
-00009480: 696e 6974 5f5f 280a 2020 2020 2020 2020  init__(.        
-00009490: 2020 2020 5f6f 703d 6f70 2c0a 2020 2020      _op=op,.    
-000094a0: 2020 2020 2020 2020 5f73 6861 7065 3d73          _shape=s
-000094b0: 6861 7065 2c0a 2020 2020 2020 2020 2020  hape,.          
-000094c0: 2020 5f6e 7370 6c69 7473 3d6e 7370 6c69    _nsplits=nspli
-000094d0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-000094e0: 5f64 7479 7065 3d64 7479 7065 2c0a 2020  _dtype=dtype,.  
-000094f0: 2020 2020 2020 2020 2020 5f6e 616d 653d            _name=
-00009500: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00009510: 2020 5f69 6e64 6578 5f76 616c 7565 3d69    _index_value=i
-00009520: 6e64 6578 5f76 616c 7565 2c0a 2020 2020  ndex_value,.    
-00009530: 2020 2020 2020 2020 5f63 6875 6e6b 733d          _chunks=
-00009540: 6368 756e 6b73 2c0a 2020 2020 2020 2020  chunks,.        
-00009550: 2020 2020 2a2a 6b77 2c0a 2020 2020 2020      **kw,.      
-00009560: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00009570: 2e5f 6163 6365 7373 6f72 7320 3d20 6469  ._accessors = di
-00009580: 6374 2829 0a0a 2020 2020 6465 6620 5f67  ct()..    def _g
-00009590: 6574 5f70 6172 616d 7328 7365 6c66 2920  et_params(self) 
-000095a0: 2d3e 2044 6963 745b 7374 722c 2041 6e79  -> Dict[str, Any
-000095b0: 5d3a 0a20 2020 2020 2020 2023 2070 6172  ]:.        # par
-000095c0: 616d 7320 7265 7475 726e 2074 6865 2070  ams return the p
-000095d0: 726f 7065 7274 6965 7320 7768 6963 6820  roperties which 
-000095e0: 7573 6566 756c 2074 6f20 7265 6275 696c  useful to rebuil
-000095f0: 6420 6120 6e65 7720 7469 6c65 6162 6c65  d a new tileable
-00009600: 206f 626a 6563 740a 2020 2020 2020 2020   object.        
-00009610: 7265 7475 726e 207b 0a20 2020 2020 2020  return {.       
-00009620: 2020 2020 2022 7368 6170 6522 3a20 7365       "shape": se
-00009630: 6c66 2e73 6861 7065 2c0a 2020 2020 2020  lf.shape,.      
-00009640: 2020 2020 2020 2264 7479 7065 223a 2073        "dtype": s
-00009650: 656c 662e 6474 7970 652c 0a20 2020 2020  elf.dtype,.     
-00009660: 2020 2020 2020 2022 6e61 6d65 223a 2073         "name": s
-00009670: 656c 662e 6e61 6d65 2c0a 2020 2020 2020  elf.name,.      
-00009680: 2020 2020 2020 2269 6e64 6578 5f76 616c        "index_val
-00009690: 7565 223a 2073 656c 662e 696e 6465 785f  ue": self.index_
-000096a0: 7661 6c75 652c 0a20 2020 2020 2020 207d  value,.        }
-000096b0: 0a0a 2020 2020 6465 6620 5f73 6574 5f70  ..    def _set_p
-000096c0: 6172 616d 7328 7365 6c66 2c20 6e65 775f  arams(self, new_
-000096d0: 7061 7261 6d73 3a20 4469 6374 5b73 7472  params: Dict[str
-000096e0: 2c20 416e 795d 293a 0a20 2020 2020 2020  , Any]):.       
-000096f0: 2070 6172 616d 7320 3d20 6e65 775f 7061   params = new_pa
-00009700: 7261 6d73 2e63 6f70 7928 290a 2020 2020  rams.copy().    
-00009710: 2020 2020 6e65 775f 7368 6170 6520 3d20      new_shape = 
-00009720: 7061 7261 6d73 2e70 6f70 2822 7368 6170  params.pop("shap
-00009730: 6522 2c20 4e6f 6e65 290a 2020 2020 2020  e", None).      
-00009740: 2020 6966 206e 6577 5f73 6861 7065 2069    if new_shape i
-00009750: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00009760: 2020 2020 2020 2020 7365 6c66 2e5f 7368          self._sh
-00009770: 6170 6520 3d20 6e65 775f 7368 6170 650a  ape = new_shape.
-00009780: 2020 2020 2020 2020 6474 7970 6520 3d20          dtype = 
-00009790: 7061 7261 6d73 2e70 6f70 2822 6474 7970  params.pop("dtyp
-000097a0: 6522 2c20 4e6f 6e65 290a 2020 2020 2020  e", None).      
-000097b0: 2020 6966 2064 7479 7065 2069 7320 6e6f    if dtype is no
-000097c0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-000097d0: 2020 2020 7365 6c66 2e5f 6474 7970 6520      self._dtype 
-000097e0: 3d20 6474 7970 650a 2020 2020 2020 2020  = dtype.        
-000097f0: 696e 6465 785f 7661 6c75 6520 3d20 7061  index_value = pa
-00009800: 7261 6d73 2e70 6f70 2822 696e 6465 785f  rams.pop("index_
-00009810: 7661 6c75 6522 2c20 4e6f 6e65 290a 2020  value", None).  
-00009820: 2020 2020 2020 6966 2069 6e64 6578 5f76        if index_v
-00009830: 616c 7565 2069 7320 6e6f 7420 4e6f 6e65  alue is not None
-00009840: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00009850: 6c66 2e5f 696e 6465 785f 7661 6c75 6520  lf._index_value 
-00009860: 3d20 696e 6465 785f 7661 6c75 650a 2020  = index_value.  
-00009870: 2020 2020 2020 6e61 6d65 203d 2070 6172        name = par
-00009880: 616d 732e 706f 7028 226e 616d 6522 2c20  ams.pop("name", 
-00009890: 4e6f 6e65 290a 2020 2020 2020 2020 6966  None).        if
-000098a0: 206e 616d 6520 6973 206e 6f74 204e 6f6e   name is not Non
-000098b0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-000098c0: 656c 662e 5f6e 616d 6520 3d20 6e61 6d65  elf._name = name
-000098d0: 0a20 2020 2020 2020 2069 6620 7061 7261  .        if para
-000098e0: 6d73 3a20 2023 2070 7261 676d 613a 206e  ms:  # pragma: n
-000098f0: 6f20 636f 7665 720a 2020 2020 2020 2020  o cover.        
-00009900: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00009910: 726f 7228 6622 556e 6b6e 6f77 6e20 7061  ror(f"Unknown pa
-00009920: 7261 6d73 3a20 7b6c 6973 7428 7061 7261  rams: {list(para
-00009930: 6d73 297d 2229 0a0a 2020 2020 7061 7261  ms)}")..    para
-00009940: 6d73 203d 2070 726f 7065 7274 7928 5f67  ms = property(_g
-00009950: 6574 5f70 6172 616d 732c 205f 7365 745f  et_params, _set_
-00009960: 7061 7261 6d73 290a 0a20 2020 2064 6566  params)..    def
-00009970: 2072 6566 7265 7368 5f70 6172 616d 7328   refresh_params(
-00009980: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
-00009990: 2072 6566 7265 7368 2070 6172 616d 7320   refresh params 
-000099a0: 7768 656e 2063 6875 6e6b 7320 7570 6461  when chunks upda
-000099b0: 7465 640a 2020 2020 2020 2020 7265 6672  ted.        refr
-000099c0: 6573 685f 7469 6c65 6162 6c65 5f73 6861  esh_tileable_sha
-000099d0: 7065 2873 656c 6629 0a20 2020 2020 2020  pe(self).       
-000099e0: 2072 6566 7265 7368 5f69 6e64 6578 5f76   refresh_index_v
-000099f0: 616c 7565 2873 656c 6629 0a20 2020 2020  alue(self).     
-00009a00: 2020 2069 6620 7365 6c66 2e5f 6474 7970     if self._dtyp
-00009a10: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-00009a20: 2020 2020 2020 2073 656c 662e 5f64 7479         self._dty
-00009a30: 7065 203d 2073 656c 662e 6368 756e 6b73  pe = self.chunks
-00009a40: 5b30 5d2e 6474 7970 650a 2020 2020 2020  [0].dtype.      
-00009a50: 2020 6966 2073 656c 662e 5f6e 616d 6520    if self._name 
-00009a60: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00009a70: 2020 2020 2073 656c 662e 5f6e 616d 6520       self._name 
-00009a80: 3d20 7365 6c66 2e63 6875 6e6b 735b 305d  = self.chunks[0]
-00009a90: 2e6e 616d 650a 0a20 2020 2064 6566 205f  .name..    def _
-00009aa0: 746f 5f73 7472 2873 656c 662c 2072 6570  to_str(self, rep
-00009ab0: 7265 7365 6e74 6174 696f 6e3d 4661 6c73  resentation=Fals
-00009ac0: 6529 3a0a 2020 2020 2020 2020 6966 2069  e):.        if i
-00009ad0: 735f 6275 696c 645f 6d6f 6465 2829 206f  s_build_mode() o
-00009ae0: 7220 6c65 6e28 7365 6c66 2e5f 6578 6563  r len(self._exec
-00009af0: 7574 6564 5f73 6573 7369 6f6e 7329 203d  uted_sessions) =
-00009b00: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-00009b10: 2023 2069 6e20 6275 696c 6420 6d6f 6465   # in build mode
-00009b20: 2c20 6f72 206e 6f74 2065 7865 6375 7465  , or not execute
-00009b30: 642c 206a 7573 7420 7265 7475 726e 2072  d, just return r
-00009b40: 6570 7265 7365 6e74 6174 696f 6e0a 2020  epresentation.  
-00009b50: 2020 2020 2020 2020 2020 6966 2072 6570            if rep
-00009b60: 7265 7365 6e74 6174 696f 6e3a 0a20 2020  resentation:.   
-00009b70: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00009b80: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
-00009b90: 2020 2020 2020 2020 2020 6622 7b73 656c            f"{sel
-00009ba0: 662e 7479 7065 5f6e 616d 657d 203c 6f70  f.type_name} <op
-00009bb0: 3d7b 7479 7065 2873 656c 662e 5f6f 7029  ={type(self._op)
-00009bc0: 2e5f 5f6e 616d 655f 5f7d 2c20 6b65 793d  .__name__}, key=
-00009bd0: 7b73 656c 662e 6b65 797d 3e22 0a20 2020  {self.key}>".   
-00009be0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00009bf0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00009c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009c10: 2072 6574 7572 6e20 6622 7b73 656c 662e   return f"{self.
-00009c20: 7479 7065 5f6e 616d 657d 286f 703d 7b74  type_name}(op={t
-00009c30: 7970 6528 7365 6c66 2e5f 6f70 292e 5f5f  ype(self._op).__
-00009c40: 6e61 6d65 5f5f 7d29 220a 2020 2020 2020  name__})".      
-00009c50: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00009c60: 2020 2020 636f 726e 6572 5f64 6174 6120      corner_data 
-00009c70: 3d20 6665 7463 685f 636f 726e 6572 5f64  = fetch_corner_d
-00009c80: 6174 6128 7365 6c66 2c20 7365 7373 696f  ata(self, sessio
-00009c90: 6e3d 7365 6c66 2e5f 6578 6563 7574 6564  n=self._executed
-00009ca0: 5f73 6573 7369 6f6e 735b 2d31 5d29 0a0a  _sessions[-1])..
-00009cb0: 2020 2020 2020 2020 2020 2020 6275 6620              buf 
-00009cc0: 3d20 5374 7269 6e67 494f 2829 0a20 2020  = StringIO().   
-00009cd0: 2020 2020 2020 2020 206d 6178 5f72 6f77           max_row
-00009ce0: 7320 3d20 7064 2e67 6574 5f6f 7074 696f  s = pd.get_optio
-00009cf0: 6e28 2264 6973 706c 6179 2e6d 6178 5f72  n("display.max_r
-00009d00: 6f77 7322 290a 2020 2020 2020 2020 2020  ows").          
-00009d10: 2020 636f 726e 6572 5f6d 6178 5f72 6f77    corner_max_row
-00009d20: 7320 3d20 280a 2020 2020 2020 2020 2020  s = (.          
-00009d30: 2020 2020 2020 6d61 785f 726f 7773 2069        max_rows i
-00009d40: 6620 7365 6c66 2e73 6861 7065 5b30 5d20  f self.shape[0] 
-00009d50: 3c3d 206d 6178 5f72 6f77 7320 656c 7365  <= max_rows else
-00009d60: 2063 6f72 6e65 725f 6461 7461 2e73 6861   corner_data.sha
-00009d70: 7065 5b30 5d20 2d20 310a 2020 2020 2020  pe[0] - 1.      
-00009d80: 2020 2020 2020 2920 2023 206d 616b 6520        )  # make 
-00009d90: 7375 7265 206d 6178 5f72 6f77 7320 3c20  sure max_rows < 
-00009da0: 636f 726e 6572 5f64 6174 610a 0a20 2020  corner_data..   
-00009db0: 2020 2020 2020 2020 2077 6974 6820 7064           with pd
-00009dc0: 2e6f 7074 696f 6e5f 636f 6e74 6578 7428  .option_context(
-00009dd0: 2264 6973 706c 6179 2e6d 6178 5f72 6f77  "display.max_row
-00009de0: 7322 2c20 636f 726e 6572 5f6d 6178 5f72  s", corner_max_r
-00009df0: 6f77 7329 3a0a 2020 2020 2020 2020 2020  ows):.          
-00009e00: 2020 2020 2020 6966 2073 656c 662e 7368        if self.sh
-00009e10: 6170 655b 305d 203c 3d20 6d61 785f 726f  ape[0] <= max_ro
-00009e20: 7773 3a0a 2020 2020 2020 2020 2020 2020  ws:.            
-00009e30: 2020 2020 2020 2020 636f 726e 6572 5f73          corner_s
-00009e40: 6572 6965 7320 3d20 636f 726e 6572 5f64  eries = corner_d
-00009e50: 6174 610a 2020 2020 2020 2020 2020 2020  ata.            
-00009e60: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00009e70: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00009e80: 726e 6572 5f73 6572 6965 7320 3d20 5265  rner_series = Re
-00009e90: 7072 5365 7269 6573 2863 6f72 6e65 725f  prSeries(corner_
-00009ea0: 6461 7461 2c20 7365 6c66 2e73 6861 7065  data, self.shape
-00009eb0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00009ec0: 2020 6275 662e 7772 6974 6528 7265 7072    buf.write(repr
-00009ed0: 2863 6f72 6e65 725f 7365 7269 6573 2920  (corner_series) 
-00009ee0: 6966 2072 6570 7265 7365 6e74 6174 696f  if representatio
-00009ef0: 6e20 656c 7365 2073 7472 2863 6f72 6e65  n else str(corne
-00009f00: 725f 7365 7269 6573 2929 0a0a 2020 2020  r_series))..    
-00009f10: 2020 2020 2020 2020 7265 7475 726e 2062          return b
-00009f20: 7566 2e67 6574 7661 6c75 6528 290a 0a20  uf.getvalue().. 
-00009f30: 2020 2064 6566 205f 5f73 7472 5f5f 2873     def __str__(s
-00009f40: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00009f50: 7475 726e 2073 656c 662e 5f74 6f5f 7374  turn self._to_st
-00009f60: 7228 7265 7072 6573 656e 7461 7469 6f6e  r(representation
-00009f70: 3d46 616c 7365 290a 0a20 2020 2064 6566  =False)..    def
-00009f80: 205f 5f72 6570 725f 5f28 7365 6c66 293a   __repr__(self):
-00009f90: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00009fa0: 7365 6c66 2e5f 746f 5f73 7472 2872 6570  self._to_str(rep
-00009fb0: 7265 7365 6e74 6174 696f 6e3d 4661 6c73  resentation=Fals
-00009fc0: 6529 0a0a 2020 2020 4070 726f 7065 7274  e)..    @propert
-00009fd0: 790a 2020 2020 6465 6620 6474 7970 6528  y.    def dtype(
-00009fe0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00009ff0: 6574 7572 6e20 6765 7461 7474 7228 7365  eturn getattr(se
-0000a000: 6c66 2c20 225f 6474 7970 6522 2c20 4e6f  lf, "_dtype", No
-0000a010: 6e65 2920 6f72 2067 6574 6174 7472 2873  ne) or getattr(s
-0000a020: 656c 662e 6f70 2c20 2264 7479 7065 222c  elf.op, "dtype",
-0000a030: 204e 6f6e 6529 0a0a 2020 2020 4070 726f   None)..    @pro
-0000a040: 7065 7274 790a 2020 2020 6465 6620 6e61  perty.    def na
-0000a050: 6d65 2873 656c 6629 3a0a 2020 2020 2020  me(self):.      
-0000a060: 2020 7265 7475 726e 2073 656c 662e 5f6e    return self._n
-0000a070: 616d 650a 0a20 2020 2040 7072 6f70 6572  ame..    @proper
-0000a080: 7479 0a20 2020 2064 6566 2069 6e64 6578  ty.    def index
-0000a090: 5f76 616c 7565 2873 656c 6629 3a0a 2020  _value(self):.  
-0000a0a0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000a0b0: 662e 5f69 6e64 6578 5f76 616c 7565 0a0a  f._index_value..
-0000a0c0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000a0d0: 2020 6465 6620 696e 6465 7828 7365 6c66    def index(self
-0000a0e0: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
-0000a0f0: 2e64 6174 6173 6f75 7263 652e 696e 6465  .datasource.inde
-0000a100: 7820 696d 706f 7274 2066 726f 6d5f 7469  x import from_ti
-0000a110: 6c65 6162 6c65 0a0a 2020 2020 2020 2020  leable..        
-0000a120: 7265 7475 726e 2066 726f 6d5f 7469 6c65  return from_tile
-0000a130: 6162 6c65 2873 656c 6629 0a0a 2020 2020  able(self)..    
-0000a140: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0000a150: 6620 6178 6573 2873 656c 6629 3a0a 2020  f axes(self):.  
-0000a160: 2020 2020 2020 7265 7475 726e 205b 7365        return [se
-0000a170: 6c66 2e69 6e64 6578 5d0a 0a20 2020 2040  lf.index]..    @
-0000a180: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0000a190: 2065 6d70 7479 2873 656c 6629 3a0a 2020   empty(self):.  
-0000a1a0: 2020 2020 2020 7368 6170 6520 3d20 6765        shape = ge
-0000a1b0: 7461 7474 7228 7365 6c66 2c20 225f 7368  tattr(self, "_sh
-0000a1c0: 6170 6522 290a 2020 2020 2020 2020 6966  ape").        if
-0000a1d0: 206e 702e 616e 7928 6e70 2e69 736e 616e   np.any(np.isnan
-0000a1e0: 2873 6861 7065 2929 3a0a 2020 2020 2020  (shape)):.      
-0000a1f0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0000a200: 6545 7272 6f72 2822 5469 6c65 6162 6c65  eError("Tileable
-0000a210: 206f 626a 6563 7420 6d75 7374 2062 6520   object must be 
-0000a220: 6578 6563 7574 6564 2066 6972 7374 2229  executed first")
-0000a230: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000a240: 7368 6170 6520 3d3d 2028 302c 290a 0a20  shape == (0,).. 
-0000a250: 2020 2064 6566 2074 6f5f 7465 6e73 6f72     def to_tensor
-0000a260: 2873 656c 662c 2064 7479 7065 3d4e 6f6e  (self, dtype=Non
-0000a270: 6529 3a0a 2020 2020 2020 2020 6672 6f6d  e):.        from
-0000a280: 202e 2e74 656e 736f 722e 6461 7461 736f   ..tensor.dataso
-0000a290: 7572 6365 2e66 726f 6d5f 6461 7461 6672  urce.from_datafr
-0000a2a0: 616d 6520 696d 706f 7274 2066 726f 6d5f  ame import from_
-0000a2b0: 7365 7269 6573 0a0a 2020 2020 2020 2020  series..        
-0000a2c0: 7265 7475 726e 2066 726f 6d5f 7365 7269  return from_seri
-0000a2d0: 6573 2873 656c 662c 2064 7479 7065 3d64  es(self, dtype=d
-0000a2e0: 7479 7065 290a 0a20 2020 2040 7374 6174  type)..    @stat
-0000a2f0: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
-0000a300: 2066 726f 6d5f 7465 6e73 6f72 2869 6e5f   from_tensor(in_
-0000a310: 7465 6e73 6f72 2c20 696e 6465 783d 4e6f  tensor, index=No
-0000a320: 6e65 2c20 6e61 6d65 3d4e 6f6e 6529 3a0a  ne, name=None):.
-0000a330: 2020 2020 2020 2020 6672 6f6d 202e 6461          from .da
-0000a340: 7461 736f 7572 6365 2e66 726f 6d5f 7465  tasource.from_te
-0000a350: 6e73 6f72 2069 6d70 6f72 7420 7365 7269  nsor import seri
-0000a360: 6573 5f66 726f 6d5f 7465 6e73 6f72 0a0a  es_from_tensor..
-0000a370: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000a380: 6572 6965 735f 6672 6f6d 5f74 656e 736f  eries_from_tenso
-0000a390: 7228 696e 5f74 656e 736f 722c 2069 6e64  r(in_tensor, ind
-0000a3a0: 6578 3d69 6e64 6578 2c20 6e61 6d65 3d6e  ex=index, name=n
-0000a3b0: 616d 6529 0a0a 0a63 6c61 7373 2053 6572  ame)...class Ser
-0000a3c0: 6965 7344 6174 6128 5f42 6174 6368 6564  iesData(_Batched
-0000a3d0: 4665 7463 6865 722c 2042 6173 6553 6572  Fetcher, BaseSer
-0000a3e0: 6965 7344 6174 6129 3a0a 2020 2020 7479  iesData):.    ty
-0000a3f0: 7065 5f6e 616d 6520 3d20 2253 6572 6965  pe_name = "Serie
-0000a400: 7322 0a0a 2020 2020 6465 6620 5f5f 6d61  s"..    def __ma
-0000a410: 7273 5f74 656e 736f 725f 5f28 7365 6c66  rs_tensor__(self
-0000a420: 2c20 6474 7970 653d 4e6f 6e65 2c20 6f72  , dtype=None, or
-0000a430: 6465 723d 224b 2229 3a0a 2020 2020 2020  der="K"):.      
-0000a440: 2020 7465 6e73 6f72 203d 2073 656c 662e    tensor = self.
-0000a450: 746f 5f74 656e 736f 7228 290a 2020 2020  to_tensor().    
-0000a460: 2020 2020 6474 7970 6520 3d20 6474 7970      dtype = dtyp
-0000a470: 6520 6966 2064 7479 7065 2069 7320 6e6f  e if dtype is no
-0000a480: 7420 4e6f 6e65 2065 6c73 6520 7465 6e73  t None else tens
-0000a490: 6f72 2e64 7479 7065 0a20 2020 2020 2020  or.dtype.       
-0000a4a0: 2072 6574 7572 6e20 7465 6e73 6f72 2e61   return tensor.a
-0000a4b0: 7374 7970 6528 6474 7970 653d 6474 7970  stype(dtype=dtyp
-0000a4c0: 652c 206f 7264 6572 3d6f 7264 6572 2c20  e, order=order, 
-0000a4d0: 636f 7079 3d46 616c 7365 290a 0a20 2020  copy=False)..   
-0000a4e0: 2064 6566 2069 7465 7269 7465 6d73 2873   def iteritems(s
-0000a4f0: 656c 662c 2062 6174 6368 5f73 697a 653d  elf, batch_size=
-0000a500: 3130 3030 302c 2073 6573 7369 6f6e 3d4e  10000, session=N
-0000a510: 6f6e 6529 3a0a 2020 2020 2020 2020 666f  one):.        fo
-0000a520: 7220 6261 7463 685f 6461 7461 2069 6e20  r batch_data in 
-0000a530: 7365 6c66 2e69 7465 7262 6174 6368 2862  self.iterbatch(b
-0000a540: 6174 6368 5f73 697a 653d 6261 7463 685f  atch_size=batch_
-0000a550: 7369 7a65 2c20 7365 7373 696f 6e3d 7365  size, session=se
-0000a560: 7373 696f 6e29 3a0a 2020 2020 2020 2020  ssion):.        
-0000a570: 2020 2020 7969 656c 6420 6672 6f6d 2067      yield from g
-0000a580: 6574 6174 7472 2862 6174 6368 5f64 6174  etattr(batch_dat
-0000a590: 612c 2022 6974 6572 6974 656d 7322 2928  a, "iteritems")(
-0000a5a0: 290a 0a20 2020 2069 7465 6d73 203d 2069  )..    items = i
-0000a5b0: 7465 7269 7465 6d73 0a0a 2020 2020 6465  teritems..    de
-0000a5c0: 6620 746f 5f64 6963 7428 7365 6c66 2c20  f to_dict(self, 
-0000a5d0: 696e 746f 3d64 6963 742c 2062 6174 6368  into=dict, batch
-0000a5e0: 5f73 697a 653d 3130 3030 302c 2073 6573  _size=10000, ses
-0000a5f0: 7369 6f6e 3d4e 6f6e 6529 3a0a 2020 2020  sion=None):.    
-0000a600: 2020 2020 6665 7463 685f 6b77 6172 6773      fetch_kwargs
-0000a610: 203d 2064 6963 7428 6261 7463 685f 7369   = dict(batch_si
-0000a620: 7a65 3d62 6174 6368 5f73 697a 6529 0a20  ze=batch_size). 
-0000a630: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000a640: 6c66 2e74 6f5f 7061 6e64 6173 2873 6573  lf.to_pandas(ses
-0000a650: 7369 6f6e 3d73 6573 7369 6f6e 2c20 6665  sion=session, fe
-0000a660: 7463 685f 6b77 6172 6773 3d66 6574 6368  tch_kwargs=fetch
-0000a670: 5f6b 7761 7267 7329 2e74 6f5f 6469 6374  _kwargs).to_dict
-0000a680: 280a 2020 2020 2020 2020 2020 2020 696e  (.            in
-0000a690: 746f 3d69 6e74 6f0a 2020 2020 2020 2020  to=into.        
-0000a6a0: 290a 0a0a 636c 6173 7320 5365 7269 6573  )...class Series
-0000a6b0: 2848 6173 5368 6170 6554 696c 6561 626c  (HasShapeTileabl
-0000a6c0: 652c 205f 546f 5061 6e64 6173 4d69 7869  e, _ToPandasMixi
-0000a6d0: 6e29 3a0a 2020 2020 5f5f 736c 6f74 735f  n):.    __slots_
-0000a6e0: 5f20 3d20 2822 5f63 6163 6865 222c 290a  _ = ("_cache",).
-0000a6f0: 2020 2020 5f61 6c6c 6f77 5f64 6174 615f      _allow_data_
-0000a700: 7479 7065 5f20 3d20 2853 6572 6965 7344  type_ = (SeriesD
-0000a710: 6174 612c 290a 2020 2020 7479 7065 5f6e  ata,).    type_n
-0000a720: 616d 6520 3d20 2253 6572 6965 7322 0a0a  ame = "Series"..
-0000a730: 2020 2020 6465 6620 746f 5f74 656e 736f      def to_tenso
-0000a740: 7228 7365 6c66 2c20 6474 7970 653d 4e6f  r(self, dtype=No
-0000a750: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
-0000a760: 7572 6e20 7365 6c66 2e5f 6461 7461 2e74  urn self._data.t
-0000a770: 6f5f 7465 6e73 6f72 2864 7479 7065 3d64  o_tensor(dtype=d
-0000a780: 7479 7065 290a 0a20 2020 2064 6566 2066  type)..    def f
-0000a790: 726f 6d5f 7465 6e73 6f72 2873 656c 662c  rom_tensor(self,
-0000a7a0: 2069 6e5f 7465 6e73 6f72 2c20 696e 6465   in_tensor, inde
-0000a7b0: 783d 4e6f 6e65 2c20 6e61 6d65 3d4e 6f6e  x=None, name=Non
-0000a7c0: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
-0000a7d0: 726e 2073 656c 662e 5f64 6174 612e 6672  rn self._data.fr
-0000a7e0: 6f6d 5f74 656e 736f 7228 696e 5f74 656e  om_tensor(in_ten
-0000a7f0: 736f 722c 2069 6e64 6578 3d69 6e64 6578  sor, index=index
-0000a800: 2c20 6e61 6d65 3d6e 616d 6529 0a0a 2020  , name=name)..  
-0000a810: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0000a820: 6465 6620 5428 7365 6c66 293a 0a20 2020  def T(self):.   
-0000a830: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
-0000a840: 6865 2074 7261 6e73 706f 7365 2c20 7768  he transpose, wh
-0000a850: 6963 6820 6973 2062 7920 6465 6669 6e69  ich is by defini
-0000a860: 7469 6f6e 2073 656c 662e 2222 220a 2020  tion self.""".  
-0000a870: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000a880: 660a 0a20 2020 2040 7072 6f70 6572 7479  f..    @property
-0000a890: 0a20 2020 2064 6566 206e 6469 6d28 7365  .    def ndim(se
-0000a8a0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0000a8b0: 0a20 2020 2020 2020 2052 6574 7572 6e20  .        Return 
-0000a8c0: 616e 2069 6e74 2072 6570 7265 7365 6e74  an int represent
-0000a8d0: 696e 6720 7468 6520 6e75 6d62 6572 206f  ing the number o
-0000a8e0: 6620 6178 6573 202f 2061 7272 6179 2064  f axes / array d
-0000a8f0: 696d 656e 7369 6f6e 732e 0a0a 2020 2020  imensions...    
-0000a900: 2020 2020 5265 7475 726e 2031 2069 6620      Return 1 if 
-0000a910: 5365 7269 6573 2e20 4f74 6865 7277 6973  Series. Otherwis
-0000a920: 6520 7265 7475 726e 2032 2069 6620 4461  e return 2 if Da
-0000a930: 7461 4672 616d 652e 0a0a 2020 2020 2020  taFrame...      
-0000a940: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
-0000a950: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-0000a960: 2020 2020 6e64 6172 7261 792e 6e64 696d      ndarray.ndim
-0000a970: 203a 204e 756d 6265 7220 6f66 2061 7272   : Number of arr
-0000a980: 6179 2064 696d 656e 7369 6f6e 732e 0a0a  ay dimensions...
-0000a990: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-0000a9a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000a9b0: 2d0a 2020 2020 2020 2020 3e3e 3e20 696d  -.        >>> im
-0000a9c0: 706f 7274 206d 6172 732e 6461 7461 6672  port mars.datafr
-0000a9d0: 616d 6520 6173 206d 640a 2020 2020 2020  ame as md.      
-0000a9e0: 2020 3e3e 3e20 7320 3d20 6d64 2e53 6572    >>> s = md.Ser
-0000a9f0: 6965 7328 7b27 6127 3a20 312c 2027 6227  ies({'a': 1, 'b'
-0000aa00: 3a20 322c 2027 6327 3a20 337d 290a 2020  : 2, 'c': 3}).  
-0000aa10: 2020 2020 2020 3e3e 3e20 732e 6e64 696d        >>> s.ndim
-0000aa20: 2e65 7865 6375 7465 2829 0a20 2020 2020  .execute().     
-0000aa30: 2020 2031 0a0a 2020 2020 2020 2020 3e3e     1..        >>
-0000aa40: 3e20 6466 203d 206d 642e 4461 7461 4672  > df = md.DataFr
-0000aa50: 616d 6528 7b27 636f 6c31 273a 205b 312c  ame({'col1': [1,
-0000aa60: 2032 5d2c 2027 636f 6c32 273a 205b 332c   2], 'col2': [3,
-0000aa70: 2034 5d7d 290a 2020 2020 2020 2020 3e3e   4]}).        >>
-0000aa80: 3e20 6466 2e6e 6469 6d2e 6578 6563 7574  > df.ndim.execut
-0000aa90: 6528 290a 2020 2020 2020 2020 320a 2020  e().        2.  
-0000aaa0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000aab0: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
-0000aac0: 2e6e 6469 6d0a 0a20 2020 2040 7072 6f70  .ndim..    @prop
-0000aad0: 6572 7479 0a20 2020 2064 6566 2069 6e64  erty.    def ind
-0000aae0: 6578 2873 656c 6629 3a0a 2020 2020 2020  ex(self):.      
-0000aaf0: 2020 2222 220a 2020 2020 2020 2020 5468    """.        Th
-0000ab00: 6520 696e 6465 7820 2861 7869 7320 6c61  e index (axis la
-0000ab10: 6265 6c73 2920 6f66 2074 6865 2053 6572  bels) of the Ser
-0000ab20: 6965 732e 0a20 2020 2020 2020 2022 2222  ies..        """
-0000ab30: 0a20 2020 2020 2020 2069 6478 203d 2073  .        idx = s
-0000ab40: 656c 662e 5f64 6174 612e 696e 6465 780a  elf._data.index.
-0000ab50: 2020 2020 2020 2020 6964 782e 5f73 6574          idx._set
-0000ab60: 5f64 665f 6f72 5f73 6572 6965 7328 7365  _df_or_series(se
-0000ab70: 6c66 2c20 3029 0a20 2020 2020 2020 2072  lf, 0).        r
-0000ab80: 6574 7572 6e20 6964 780a 0a20 2020 2040  eturn idx..    @
-0000ab90: 696e 6465 782e 7365 7474 6572 0a20 2020  index.setter.   
-0000aba0: 2064 6566 2069 6e64 6578 2873 656c 662c   def index(self,
-0000abb0: 206e 6577 5f69 6e64 6578 293a 0a20 2020   new_index):.   
-0000abc0: 2020 2020 2073 656c 662e 7365 745f 6178       self.set_ax
-0000abd0: 6973 286e 6577 5f69 6e64 6578 2c20 6178  is(new_index, ax
-0000abe0: 6973 3d30 2c20 696e 706c 6163 653d 5472  is=0, inplace=Tr
-0000abf0: 7565 290a 0a20 2020 2040 7072 6f70 6572  ue)..    @proper
-0000ac00: 7479 0a20 2020 2064 6566 206e 616d 6528  ty.    def name(
-0000ac10: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-0000ac20: 6574 7572 6e20 7365 6c66 2e5f 6461 7461  eturn self._data
-0000ac30: 2e6e 616d 650a 0a20 2020 2040 6e61 6d65  .name..    @name
-0000ac40: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
-0000ac50: 6e61 6d65 2873 656c 662c 2076 616c 293a  name(self, val):
-0000ac60: 0a20 2020 2020 2020 2066 726f 6d20 2e69  .        from .i
-0000ac70: 6e64 6578 696e 672e 7265 6e61 6d65 2069  ndexing.rename i
-0000ac80: 6d70 6f72 7420 4461 7461 4672 616d 6552  mport DataFrameR
-0000ac90: 656e 616d 650a 0a20 2020 2020 2020 206f  ename..        o
-0000aca0: 7020 3d20 4461 7461 4672 616d 6552 656e  p = DataFrameRen
-0000acb0: 616d 6528 6e65 775f 6e61 6d65 3d76 616c  ame(new_name=val
-0000acc0: 2c20 6f75 7470 7574 5f74 7970 6573 3d5b  , output_types=[
-0000acd0: 4f75 7470 7574 5479 7065 2e73 6572 6965  OutputType.serie
-0000ace0: 735d 290a 2020 2020 2020 2020 6e65 775f  s]).        new_
-0000acf0: 7365 7269 6573 203d 206f 7028 7365 6c66  series = op(self
-0000ad00: 290a 2020 2020 2020 2020 7365 6c66 2e64  ).        self.d
-0000ad10: 6174 6120 3d20 6e65 775f 7365 7269 6573  ata = new_series
-0000ad20: 2e64 6174 610a 0a20 2020 2040 7072 6f70  .data..    @prop
-0000ad30: 6572 7479 0a20 2020 2064 6566 2064 7479  erty.    def dty
-0000ad40: 7065 2873 656c 6629 3a0a 2020 2020 2020  pe(self):.      
-0000ad50: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-0000ad60: 7475 726e 2074 6865 2064 7479 7065 206f  turn the dtype o
-0000ad70: 626a 6563 7420 6f66 2074 6865 2075 6e64  bject of the und
-0000ad80: 6572 6c79 696e 6720 6461 7461 2e0a 2020  erlying data..  
-0000ad90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000ada0: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
-0000adb0: 6174 612e 6474 7970 650a 0a20 2020 2064  ata.dtype..    d
-0000adc0: 6566 2063 6f70 7928 7365 6c66 2c20 6465  ef copy(self, de
-0000add0: 6570 3d54 7275 6529 3a20 2023 2070 796c  ep=True):  # pyl
-0000ade0: 696e 743a 2064 6973 6162 6c65 3d61 7267  int: disable=arg
-0000adf0: 756d 656e 7473 2d64 6966 6665 720a 2020  uments-differ.  
-0000ae00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000ae10: 2020 4d61 6b65 2061 2063 6f70 7920 6f66    Make a copy of
-0000ae20: 2074 6869 7320 6f62 6a65 6374 2773 2069   this object's i
-0000ae30: 6e64 6963 6573 2061 6e64 2064 6174 612e  ndices and data.
-0000ae40: 0a0a 2020 2020 2020 2020 5768 656e 2060  ..        When `
-0000ae50: 6064 6565 703d 5472 7565 6060 2028 6465  `deep=True`` (de
-0000ae60: 6661 756c 7429 2c20 6120 6e65 7720 6f62  fault), a new ob
-0000ae70: 6a65 6374 2077 696c 6c20 6265 2063 7265  ject will be cre
-0000ae80: 6174 6564 2077 6974 6820 610a 2020 2020  ated with a.    
-0000ae90: 2020 2020 636f 7079 206f 6620 7468 6520      copy of the 
-0000aea0: 6361 6c6c 696e 6720 6f62 6a65 6374 2773  calling object's
-0000aeb0: 2064 6174 6120 616e 6420 696e 6469 6365   data and indice
-0000aec0: 732e 204d 6f64 6966 6963 6174 696f 6e73  s. Modifications
-0000aed0: 2074 6f0a 2020 2020 2020 2020 7468 6520   to.        the 
-0000aee0: 6461 7461 206f 7220 696e 6469 6365 7320  data or indices 
-0000aef0: 6f66 2074 6865 2063 6f70 7920 7769 6c6c  of the copy will
-0000af00: 206e 6f74 2062 6520 7265 666c 6563 7465   not be reflecte
-0000af10: 6420 696e 2074 6865 0a20 2020 2020 2020  d in the.       
-0000af20: 206f 7269 6769 6e61 6c20 6f62 6a65 6374   original object
-0000af30: 2028 7365 6520 6e6f 7465 7320 6265 6c6f   (see notes belo
-0000af40: 7729 2e0a 0a20 2020 2020 2020 2057 6865  w)...        Whe
-0000af50: 6e20 6060 6465 6570 3d46 616c 7365 6060  n ``deep=False``
-0000af60: 2c20 6120 6e65 7720 6f62 6a65 6374 2077  , a new object w
-0000af70: 696c 6c20 6265 2063 7265 6174 6564 2077  ill be created w
-0000af80: 6974 686f 7574 2063 6f70 7969 6e67 0a20  ithout copying. 
-0000af90: 2020 2020 2020 2074 6865 2063 616c 6c69         the calli
-0000afa0: 6e67 206f 626a 6563 7427 7320 6461 7461  ng object's data
-0000afb0: 206f 7220 696e 6465 7820 286f 6e6c 7920   or index (only 
-0000afc0: 7265 6665 7265 6e63 6573 2074 6f20 7468  references to th
-0000afd0: 6520 6461 7461 0a20 2020 2020 2020 2061  e data.        a
-0000afe0: 6e64 2069 6e64 6578 2061 7265 2063 6f70  nd index are cop
-0000aff0: 6965 6429 2e20 416e 7920 6368 616e 6765  ied). Any change
-0000b000: 7320 746f 2074 6865 2064 6174 6120 6f66  s to the data of
-0000b010: 2074 6865 206f 7269 6769 6e61 6c0a 2020   the original.  
-0000b020: 2020 2020 2020 7769 6c6c 2062 6520 7265        will be re
-0000b030: 666c 6563 7465 6420 696e 2074 6865 2073  flected in the s
-0000b040: 6861 6c6c 6f77 2063 6f70 7920 2861 6e64  hallow copy (and
-0000b050: 2076 6963 6520 7665 7273 6129 2e0a 0a20   vice versa)... 
-0000b060: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0000b070: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0000b080: 2d2d 2d2d 0a20 2020 2020 2020 2064 6565  ----.        dee
-0000b090: 7020 3a20 626f 6f6c 2c20 6465 6661 756c  p : bool, defaul
-0000b0a0: 7420 5472 7565 0a20 2020 2020 2020 2020  t True.         
-0000b0b0: 2020 204d 616b 6520 6120 6465 6570 2063     Make a deep c
-0000b0c0: 6f70 792c 2069 6e63 6c75 6469 6e67 2061  opy, including a
-0000b0d0: 2063 6f70 7920 6f66 2074 6865 2064 6174   copy of the dat
-0000b0e0: 6120 616e 6420 7468 6520 696e 6469 6365  a and the indice
-0000b0f0: 732e 0a20 2020 2020 2020 2020 2020 2057  s..            W
-0000b100: 6974 6820 6060 6465 6570 3d46 616c 7365  ith ``deep=False
-0000b110: 6060 206e 6569 7468 6572 2074 6865 2069  `` neither the i
-0000b120: 6e64 6963 6573 206e 6f72 2074 6865 2064  ndices nor the d
-0000b130: 6174 6120 6172 6520 636f 7069 6564 2e0a  ata are copied..
-0000b140: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0000b150: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000b160: 0a20 2020 2020 2020 2063 6f70 7920 3a20  .        copy : 
-0000b170: 5365 7269 6573 206f 7220 4461 7461 4672  Series or DataFr
-0000b180: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
-0000b190: 4f62 6a65 6374 2074 7970 6520 6d61 7463  Object type matc
-0000b1a0: 6865 7320 6361 6c6c 6572 2e0a 2020 2020  hes caller..    
-0000b1b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000b1c0: 6966 2064 6565 703a 0a20 2020 2020 2020  if deep:.       
-0000b1d0: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-0000b1e0: 7228 292e 636f 7079 2829 0a20 2020 2020  r().copy().     
-0000b1f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000b200: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-0000b210: 7228 292e 5f76 6965 7728 290a 0a20 2020  r()._view()..   
-0000b220: 2064 6566 205f 5f6c 656e 5f5f 2873 656c   def __len__(sel
-0000b230: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-0000b240: 726e 206c 656e 2873 656c 662e 5f64 6174  rn len(self._dat
-0000b250: 6129 0a0a 2020 2020 6465 6620 5f5f 6d61  a)..    def __ma
-0000b260: 7273 5f74 656e 736f 725f 5f28 7365 6c66  rs_tensor__(self
-0000b270: 2c20 6474 7970 653d 4e6f 6e65 2c20 6f72  , dtype=None, or
-0000b280: 6465 723d 224b 2229 3a0a 2020 2020 2020  der="K"):.      
-0000b290: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
-0000b2a0: 6174 612e 5f5f 6d61 7273 5f74 656e 736f  ata.__mars_tenso
-0000b2b0: 725f 5f28 6474 7970 653d 6474 7970 652c  r__(dtype=dtype,
-0000b2c0: 206f 7264 6572 3d6f 7264 6572 290a 0a20   order=order).. 
-0000b2d0: 2020 2064 6566 206b 6579 7328 7365 6c66     def keys(self
-0000b2e0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0000b2f0: 2020 2020 2020 2052 6574 7572 6e20 616c         Return al
-0000b300: 6961 7320 666f 7220 696e 6465 782e 0a0a  ias for index...
-0000b310: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-0000b320: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-0000b330: 2020 2020 2020 2020 496e 6465 780a 2020          Index.  
-0000b340: 2020 2020 2020 2020 2020 496e 6465 7820            Index 
-0000b350: 6f66 2074 6865 2053 6572 6965 732e 0a20  of the Series.. 
-0000b360: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000b370: 2020 2072 6574 7572 6e20 7365 6c66 2e69     return self.i
-0000b380: 6e64 6578 0a0a 2020 2020 4070 726f 7065  ndex..    @prope
-0000b390: 7274 790a 2020 2020 6465 6620 7661 6c75  rty.    def valu
-0000b3a0: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
-0000b3b0: 2020 7265 7475 726e 2073 656c 662e 746f    return self.to
-0000b3c0: 5f74 656e 736f 7228 290a 0a20 2020 2064  _tensor()..    d
-0000b3d0: 6566 2069 7465 7269 7465 6d73 2873 656c  ef iteritems(sel
-0000b3e0: 662c 2062 6174 6368 5f73 697a 653d 3130  f, batch_size=10
-0000b3f0: 3030 302c 2073 6573 7369 6f6e 3d4e 6f6e  000, session=Non
-0000b400: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
-0000b410: 2020 2020 2020 2020 4c61 7a69 6c79 2069          Lazily i
-0000b420: 7465 7261 7465 206f 7665 7220 2869 6e64  terate over (ind
-0000b430: 6578 2c20 7661 6c75 6529 2074 7570 6c65  ex, value) tuple
-0000b440: 732e 0a0a 2020 2020 2020 2020 5468 6973  s...        This
-0000b450: 206d 6574 686f 6420 7265 7475 726e 7320   method returns 
-0000b460: 616e 2069 7465 7261 626c 6520 7475 706c  an iterable tupl
-0000b470: 6520 2869 6e64 6578 2c20 7661 6c75 6529  e (index, value)
-0000b480: 2e20 5468 6973 2069 730a 2020 2020 2020  . This is.      
-0000b490: 2020 636f 6e76 656e 6965 6e74 2069 6620    convenient if 
-0000b4a0: 796f 7520 7761 6e74 2074 6f20 6372 6561  you want to crea
-0000b4b0: 7465 2061 206c 617a 7920 6974 6572 6174  te a lazy iterat
-0000b4c0: 6f72 2e0a 0a20 2020 2020 2020 2052 6574  or...        Ret
-0000b4d0: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
-0000b4e0: 2d2d 2d2d 0a20 2020 2020 2020 2069 7465  ----.        ite
-0000b4f0: 7261 626c 650a 2020 2020 2020 2020 2020  rable.          
-0000b500: 2020 4974 6572 6162 6c65 206f 6620 7475    Iterable of tu
-0000b510: 706c 6573 2063 6f6e 7461 696e 696e 6720  ples containing 
-0000b520: 7468 6520 2869 6e64 6578 2c20 7661 6c75  the (index, valu
-0000b530: 6529 2070 6169 7273 2066 726f 6d20 610a  e) pairs from a.
-0000b540: 2020 2020 2020 2020 2020 2020 5365 7269              Seri
-0000b550: 6573 2e0a 0a20 2020 2020 2020 2053 6565  es...        See
-0000b560: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-0000b570: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
-0000b580: 6174 6146 7261 6d65 2e69 7465 6d73 203a  ataFrame.items :
-0000b590: 2049 7465 7261 7465 206f 7665 7220 2863   Iterate over (c
-0000b5a0: 6f6c 756d 6e20 6e61 6d65 2c20 5365 7269  olumn name, Seri
-0000b5b0: 6573 2920 7061 6972 732e 0a20 2020 2020  es) pairs..     
-0000b5c0: 2020 2044 6174 6146 7261 6d65 2e69 7465     DataFrame.ite
-0000b5d0: 7272 6f77 7320 3a20 4974 6572 6174 6520  rrows : Iterate 
-0000b5e0: 6f76 6572 2044 6174 6146 7261 6d65 2072  over DataFrame r
-0000b5f0: 6f77 7320 6173 2028 696e 6465 782c 2053  ows as (index, S
-0000b600: 6572 6965 7329 2070 6169 7273 2e0a 0a20  eries) pairs... 
-0000b610: 2020 2020 2020 2045 7861 6d70 6c65 730a         Examples.
-0000b620: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000b630: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-0000b640: 6f72 7420 6d61 7273 2e64 6174 6166 7261  ort mars.datafra
-0000b650: 6d65 2061 7320 6d64 0a20 2020 2020 2020  me as md.       
-0000b660: 203e 3e3e 2073 203d 206d 642e 5365 7269   >>> s = md.Seri
-0000b670: 6573 285b 2741 272c 2027 4227 2c20 2743  es(['A', 'B', 'C
-0000b680: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
-0000b690: 666f 7220 696e 6465 782c 2076 616c 7565  for index, value
-0000b6a0: 2069 6e20 732e 6974 656d 7328 293a 0a20   in s.items():. 
-0000b6b0: 2020 2020 2020 202e 2e2e 2020 2020 2070         ...     p
-0000b6c0: 7269 6e74 2866 2249 6e64 6578 203a 207b  rint(f"Index : {
-0000b6d0: 696e 6465 787d 2c20 5661 6c75 6520 3a20  index}, Value : 
-0000b6e0: 7b76 616c 7565 7d22 290a 2020 2020 2020  {value}").      
-0000b6f0: 2020 496e 6465 7820 3a20 302c 2056 616c    Index : 0, Val
-0000b700: 7565 203a 2041 0a20 2020 2020 2020 2049  ue : A.        I
-0000b710: 6e64 6578 203a 2031 2c20 5661 6c75 6520  ndex : 1, Value 
-0000b720: 3a20 420a 2020 2020 2020 2020 496e 6465  : B.        Inde
-0000b730: 7820 3a20 322c 2056 616c 7565 203a 2043  x : 2, Value : C
-0000b740: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000b750: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000b760: 2e5f 6461 7461 2e69 7465 7269 7465 6d73  ._data.iteritems
-0000b770: 2862 6174 6368 5f73 697a 653d 6261 7463  (batch_size=batc
-0000b780: 685f 7369 7a65 2c20 7365 7373 696f 6e3d  h_size, session=
-0000b790: 7365 7373 696f 6e29 0a0a 2020 2020 6974  session)..    it
-0000b7a0: 656d 7320 3d20 6974 6572 6974 656d 730a  ems = iteritems.
-0000b7b0: 0a20 2020 2064 6566 2074 6f5f 6469 6374  .    def to_dict
-0000b7c0: 2873 656c 662c 2069 6e74 6f3d 6469 6374  (self, into=dict
-0000b7d0: 2c20 6261 7463 685f 7369 7a65 3d31 3030  , batch_size=100
-0000b7e0: 3030 2c20 7365 7373 696f 6e3d 4e6f 6e65  00, session=None
-0000b7f0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0000b800: 2020 2020 2020 2043 6f6e 7665 7274 2053         Convert S
-0000b810: 6572 6965 7320 746f 207b 6c61 6265 6c20  eries to {label 
-0000b820: 2d3e 2076 616c 7565 7d20 6469 6374 206f  -> value} dict o
-0000b830: 7220 6469 6374 2d6c 696b 6520 6f62 6a65  r dict-like obje
-0000b840: 6374 2e0a 0a20 2020 2020 2020 2050 6172  ct...        Par
-0000b850: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-0000b860: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000b870: 2020 2069 6e74 6f20 3a20 636c 6173 732c     into : class,
-0000b880: 2064 6566 6175 6c74 2064 6963 740a 2020   default dict.  
-0000b890: 2020 2020 2020 2020 2020 5468 6520 636f            The co
-0000b8a0: 6c6c 6563 7469 6f6e 732e 6162 632e 4d61  llections.abc.Ma
-0000b8b0: 7070 696e 6720 7375 6263 6c61 7373 2074  pping subclass t
-0000b8c0: 6f20 7573 6520 6173 2074 6865 2072 6574  o use as the ret
-0000b8d0: 7572 6e0a 2020 2020 2020 2020 2020 2020  urn.            
-0000b8e0: 6f62 6a65 6374 2e20 4361 6e20 6265 2074  object. Can be t
-0000b8f0: 6865 2061 6374 7561 6c20 636c 6173 7320  he actual class 
-0000b900: 6f72 2061 6e20 656d 7074 790a 2020 2020  or an empty.    
-0000b910: 2020 2020 2020 2020 696e 7374 616e 6365          instance
-0000b920: 206f 6620 7468 6520 6d61 7070 696e 6720   of the mapping 
-0000b930: 7479 7065 2079 6f75 2077 616e 742e 2020  type you want.  
-0000b940: 4966 2079 6f75 2077 616e 7420 610a 2020  If you want a.  
-0000b950: 2020 2020 2020 2020 2020 636f 6c6c 6563            collec
-0000b960: 7469 6f6e 732e 6465 6661 756c 7464 6963  tions.defaultdic
-0000b970: 742c 2079 6f75 206d 7573 7420 7061 7373  t, you must pass
-0000b980: 2069 7420 696e 6974 6961 6c69 7a65 642e   it initialized.
-0000b990: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0000b9a0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0000b9b0: 2d0a 2020 2020 2020 2020 636f 6c6c 6563  -.        collec
-0000b9c0: 7469 6f6e 732e 6162 632e 4d61 7070 696e  tions.abc.Mappin
-0000b9d0: 670a 2020 2020 2020 2020 2020 2020 4b65  g.            Ke
-0000b9e0: 792d 7661 6c75 6520 7265 7072 6573 656e  y-value represen
-0000b9f0: 7461 7469 6f6e 206f 6620 5365 7269 6573  tation of Series
-0000ba00: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-0000ba10: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
-0000ba20: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
-0000ba30: 2069 6d70 6f72 7420 6d61 7273 2e64 6174   import mars.dat
-0000ba40: 6166 7261 6d65 2061 7320 6d64 0a20 2020  aframe as md.   
-0000ba50: 2020 2020 203e 3e3e 2073 203d 206d 642e       >>> s = md.
-0000ba60: 5365 7269 6573 285b 312c 2032 2c20 332c  Series([1, 2, 3,
-0000ba70: 2034 5d29 0a20 2020 2020 2020 203e 3e3e   4]).        >>>
-0000ba80: 2073 2e74 6f5f 6469 6374 2829 0a20 2020   s.to_dict().   
-0000ba90: 2020 2020 207b 303a 2031 2c20 313a 2032       {0: 1, 1: 2
-0000baa0: 2c20 323a 2033 2c20 333a 2034 7d0a 2020  , 2: 3, 3: 4}.  
-0000bab0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2063        >>> from c
-0000bac0: 6f6c 6c65 6374 696f 6e73 2069 6d70 6f72  ollections impor
-0000bad0: 7420 4f72 6465 7265 6444 6963 742c 2064  t OrderedDict, d
-0000bae0: 6566 6175 6c74 6469 6374 0a20 2020 2020  efaultdict.     
-0000baf0: 2020 203e 3e3e 2073 2e74 6f5f 6469 6374     >>> s.to_dict
-0000bb00: 284f 7264 6572 6564 4469 6374 290a 2020  (OrderedDict).  
-0000bb10: 2020 2020 2020 4f72 6465 7265 6444 6963        OrderedDic
-0000bb20: 7428 5b28 302c 2031 292c 2028 312c 2032  t([(0, 1), (1, 2
-0000bb30: 292c 2028 322c 2033 292c 2028 332c 2034  ), (2, 3), (3, 4
-0000bb40: 295d 290a 2020 2020 2020 2020 3e3e 3e20  )]).        >>> 
-0000bb50: 6464 203d 2064 6566 6175 6c74 6469 6374  dd = defaultdict
-0000bb60: 286c 6973 7429 0a20 2020 2020 2020 203e  (list).        >
-0000bb70: 3e3e 2073 2e74 6f5f 6469 6374 2864 6429  >> s.to_dict(dd)
-0000bb80: 0a20 2020 2020 2020 2064 6566 6175 6c74  .        default
-0000bb90: 6469 6374 283c 636c 6173 7320 276c 6973  dict(<class 'lis
-0000bba0: 7427 3e2c 207b 303a 2031 2c20 313a 2032  t'>, {0: 1, 1: 2
-0000bbb0: 2c20 323a 2033 2c20 333a 2034 7d29 0a20  , 2: 3, 3: 4}). 
-0000bbc0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000bbd0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0000bbe0: 6461 7461 2e74 6f5f 6469 6374 2869 6e74  data.to_dict(int
-0000bbf0: 6f3d 696e 746f 2c20 6261 7463 685f 7369  o=into, batch_si
-0000bc00: 7a65 3d62 6174 6368 5f73 697a 652c 2073  ze=batch_size, s
-0000bc10: 6573 7369 6f6e 3d73 6573 7369 6f6e 290a  ession=session).
-0000bc20: 0a20 2020 2064 6566 2074 6f5f 6672 616d  .    def to_fram
-0000bc30: 6528 7365 6c66 2c20 6e61 6d65 3d4e 6f6e  e(self, name=Non
-0000bc40: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
-0000bc50: 2020 2020 2020 2020 436f 6e76 6572 7420          Convert 
-0000bc60: 5365 7269 6573 2074 6f20 4461 7461 4672  Series to DataFr
-0000bc70: 616d 652e 0a0a 2020 2020 2020 2020 5061  ame...        Pa
-0000bc80: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-0000bc90: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0000bca0: 2020 2020 6e61 6d65 203a 206f 626a 6563      name : objec
-0000bcb0: 742c 2064 6566 6175 6c74 204e 6f6e 650a  t, default None.
-0000bcc0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-0000bcd0: 7061 7373 6564 206e 616d 6520 7368 6f75  passed name shou
-0000bce0: 6c64 2073 7562 7374 6974 7574 6520 666f  ld substitute fo
-0000bcf0: 7220 7468 6520 7365 7269 6573 206e 616d  r the series nam
-0000bd00: 6520 2869 6620 6974 2068 6173 0a20 2020  e (if it has.   
-0000bd10: 2020 2020 2020 2020 206f 6e65 292e 0a0a           one)...
-0000bd20: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-0000bd30: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-0000bd40: 2020 2020 2020 2020 4461 7461 4672 616d          DataFram
-0000bd50: 650a 2020 2020 2020 2020 2020 2020 4461  e.            Da
-0000bd60: 7461 4672 616d 6520 7265 7072 6573 656e  taFrame represen
-0000bd70: 7461 7469 6f6e 206f 6620 5365 7269 6573  tation of Series
-0000bd80: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-0000bd90: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
-0000bda0: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
-0000bdb0: 2069 6d70 6f72 7420 6d61 7273 2e64 6174   import mars.dat
-0000bdc0: 6166 7261 6d65 2061 7320 6d64 0a20 2020  aframe as md.   
-0000bdd0: 2020 2020 203e 3e3e 2073 203d 206d 642e       >>> s = md.
-0000bde0: 5365 7269 6573 285b 2261 222c 2022 6222  Series(["a", "b"
-0000bdf0: 2c20 2263 225d 2c20 6e61 6d65 3d22 7661  , "c"], name="va
-0000be00: 6c73 2229 0a20 2020 2020 2020 203e 3e3e  ls").        >>>
-0000be10: 2073 2e74 6f5f 6672 616d 6528 292e 6578   s.to_frame().ex
-0000be20: 6563 7574 6528 290a 2020 2020 2020 2020  ecute().        
-0000be30: 2020 7661 6c73 0a20 2020 2020 2020 2030    vals.        0
-0000be40: 2020 2020 610a 2020 2020 2020 2020 3120      a.        1 
-0000be50: 2020 2062 0a20 2020 2020 2020 2032 2020     b.        2  
-0000be60: 2020 630a 2020 2020 2020 2020 2222 220a    c.        """.
-0000be70: 2020 2020 2020 2020 6672 6f6d 202e 2069          from . i
-0000be80: 6d70 6f72 7420 6461 7461 6672 616d 655f  mport dataframe_
-0000be90: 6672 6f6d 5f74 656e 736f 720a 0a20 2020  from_tensor..   
-0000bea0: 2020 2020 206e 616d 6520 3d20 6e61 6d65       name = name
-0000beb0: 206f 7220 7365 6c66 2e6e 616d 6520 6f72   or self.name or
-0000bec0: 2030 0a20 2020 2020 2020 2072 6574 7572   0.        retur
-0000bed0: 6e20 6461 7461 6672 616d 655f 6672 6f6d  n dataframe_from
-0000bee0: 5f74 656e 736f 7228 7365 6c66 2c20 636f  _tensor(self, co
-0000bef0: 6c75 6d6e 733d 5b6e 616d 655d 290a 0a20  lumns=[name]).. 
-0000bf00: 2020 2064 6566 2062 6574 7765 656e 2873     def between(s
-0000bf10: 656c 662c 206c 6566 742c 2072 6967 6874  elf, left, right
-0000bf20: 2c20 696e 636c 7573 6976 653d 2262 6f74  , inclusive="bot
-0000bf30: 6822 293a 0a20 2020 2020 2020 2022 2222  h"):.        """
-0000bf40: 0a20 2020 2020 2020 2052 6574 7572 6e20  .        Return 
-0000bf50: 626f 6f6c 6561 6e20 5365 7269 6573 2065  boolean Series e
-0000bf60: 7175 6976 616c 656e 7420 746f 206c 6566  quivalent to lef
-0000bf70: 7420 3c3d 2073 6572 6965 7320 3c3d 2072  t <= series <= r
-0000bf80: 6967 6874 2e0a 2020 2020 2020 2020 5468  ight..        Th
-0000bf90: 6973 2066 756e 6374 696f 6e20 7265 7475  is function retu
-0000bfa0: 726e 7320 6120 626f 6f6c 6561 6e20 7665  rns a boolean ve
-0000bfb0: 6374 6f72 2063 6f6e 7461 696e 696e 6720  ctor containing 
-0000bfc0: 6054 7275 6560 2077 6865 7265 7665 7220  `True` wherever 
-0000bfd0: 7468 650a 2020 2020 2020 2020 636f 7272  the.        corr
-0000bfe0: 6573 706f 6e64 696e 6720 5365 7269 6573  esponding Series
-0000bff0: 2065 6c65 6d65 6e74 2069 7320 6265 7477   element is betw
-0000c000: 6565 6e20 7468 6520 626f 756e 6461 7279  een the boundary
-0000c010: 2076 616c 7565 7320 606c 6566 7460 2061   values `left` a
-0000c020: 6e64 0a20 2020 2020 2020 2060 7269 6768  nd.        `righ
-0000c030: 7460 2e20 4e41 2076 616c 7565 7320 6172  t`. NA values ar
-0000c040: 6520 7472 6561 7465 6420 6173 2060 4661  e treated as `Fa
-0000c050: 6c73 6560 2e0a 0a20 2020 2020 2020 2050  lse`...        P
-0000c060: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-0000c070: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0000c080: 2020 2020 206c 6566 7420 3a20 7363 616c       left : scal
-0000c090: 6172 206f 7220 6c69 7374 2d6c 696b 650a  ar or list-like.
-0000c0a0: 2020 2020 2020 2020 2020 2020 4c65 6674              Left
-0000c0b0: 2062 6f75 6e64 6172 792e 0a20 2020 2020   boundary..     
-0000c0c0: 2020 2072 6967 6874 203a 2073 6361 6c61     right : scala
-0000c0d0: 7220 6f72 206c 6973 742d 6c69 6b65 0a20  r or list-like. 
-0000c0e0: 2020 2020 2020 2020 2020 2052 6967 6874             Right
-0000c0f0: 2062 6f75 6e64 6172 792e 0a20 2020 2020   boundary..     
-0000c100: 2020 2069 6e63 6c75 7369 7665 203a 207b     inclusive : {
-0000c110: 2262 6f74 6822 2c20 226e 6569 7468 6572  "both", "neither
-0000c120: 222c 2022 6c65 6674 222c 2022 7269 6768  ", "left", "righ
-0000c130: 7422 7d0a 2020 2020 2020 2020 2020 2020  t"}.            
-0000c140: 496e 636c 7564 6520 626f 756e 6461 7269  Include boundari
-0000c150: 6573 2e20 5768 6574 6865 7220 746f 2073  es. Whether to s
-0000c160: 6574 2065 6163 6820 626f 756e 6420 6173  et each bound as
-0000c170: 2063 6c6f 7365 6420 6f72 206f 7065 6e2e   closed or open.
-0000c180: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0000c190: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0000c1a0: 2d0a 2020 2020 2020 2020 5365 7269 6573  -.        Series
-0000c1b0: 0a20 2020 2020 2020 2020 2020 2053 6572  .            Ser
-0000c1c0: 6965 7320 7265 7072 6573 656e 7469 6e67  ies representing
-0000c1d0: 2077 6865 7468 6572 2065 6163 6820 656c   whether each el
-0000c1e0: 656d 656e 7420 6973 2062 6574 7765 656e  ement is between
-0000c1f0: 206c 6566 7420 616e 640a 2020 2020 2020   left and.      
-0000c200: 2020 2020 2020 7269 6768 7420 2869 6e63        right (inc
-0000c210: 6c75 7369 7665 292e 0a0a 2020 2020 2020  lusive)...      
-0000c220: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
-0000c230: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-0000c240: 2020 2020 5365 7269 6573 2e67 7420 3a20      Series.gt : 
-0000c250: 4772 6561 7465 7220 7468 616e 206f 6620  Greater than of 
-0000c260: 7365 7269 6573 2061 6e64 206f 7468 6572  series and other
-0000c270: 2e0a 2020 2020 2020 2020 5365 7269 6573  ..        Series
-0000c280: 2e6c 7420 3a20 4c65 7373 2074 6861 6e20  .lt : Less than 
-0000c290: 6f66 2073 6572 6965 7320 616e 6420 6f74  of series and ot
-0000c2a0: 6865 722e 0a0a 2020 2020 2020 2020 4e6f  her...        No
-0000c2b0: 7465 730a 2020 2020 2020 2020 2d2d 2d2d  tes.        ----
-0000c2c0: 2d0a 2020 2020 2020 2020 5468 6973 2066  -.        This f
-0000c2d0: 756e 6374 696f 6e20 6973 2065 7175 6976  unction is equiv
-0000c2e0: 616c 656e 7420 746f 2060 6028 6c65 6674  alent to ``(left
-0000c2f0: 203c 3d20 7365 7229 2026 2028 7365 7220   <= ser) & (ser 
-0000c300: 3c3d 2072 6967 6874 2960 600a 0a20 2020  <= right)``..   
-0000c310: 2020 2020 2045 7861 6d70 6c65 730a 2020       Examples.  
-0000c320: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-0000c330: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
-0000c340: 7420 6d61 7273 2e64 6174 6166 7261 6d65  t mars.dataframe
-0000c350: 2061 7320 6d64 0a20 2020 2020 2020 203e   as md.        >
-0000c360: 3e3e 2073 203d 206d 642e 5365 7269 6573  >> s = md.Series
-0000c370: 285b 322c 2030 2c20 342c 2038 2c20 6e70  ([2, 0, 4, 8, np
-0000c380: 2e6e 616e 5d29 0a0a 2020 2020 2020 2020  .nan])..        
-0000c390: 426f 756e 6461 7279 2076 616c 7565 7320  Boundary values 
-0000c3a0: 6172 6520 696e 636c 7564 6564 2062 7920  are included by 
-0000c3b0: 6465 6661 756c 743a 0a0a 2020 2020 2020  default:..      
-0000c3c0: 2020 3e3e 3e20 732e 6265 7477 6565 6e28    >>> s.between(
-0000c3d0: 312c 2034 292e 6578 6563 7574 6528 290a  1, 4).execute().
-0000c3e0: 2020 2020 2020 2020 3020 2020 2020 5472          0     Tr
-0000c3f0: 7565 0a20 2020 2020 2020 2031 2020 2020  ue.        1    
-0000c400: 4661 6c73 650a 2020 2020 2020 2020 3220  False.        2 
-0000c410: 2020 2020 5472 7565 0a20 2020 2020 2020      True.       
-0000c420: 2033 2020 2020 4661 6c73 650a 2020 2020   3    False.    
-0000c430: 2020 2020 3420 2020 2046 616c 7365 0a20      4    False. 
-0000c440: 2020 2020 2020 2064 7479 7065 3a20 626f         dtype: bo
-0000c450: 6f6c 0a0a 2020 2020 2020 2020 5769 7468  ol..        With
-0000c460: 2060 696e 636c 7573 6976 6560 2073 6574   `inclusive` set
-0000c470: 2074 6f20 6060 226e 6569 7468 6572 2260   to ``"neither"`
-0000c480: 6020 626f 756e 6461 7279 2076 616c 7565  ` boundary value
-0000c490: 7320 6172 6520 6578 636c 7564 6564 3a0a  s are excluded:.
-0000c4a0: 0a20 2020 2020 2020 203e 3e3e 2073 2e62  .        >>> s.b
-0000c4b0: 6574 7765 656e 2831 2c20 342c 2069 6e63  etween(1, 4, inc
-0000c4c0: 6c75 7369 7665 3d22 6e65 6974 6865 7222  lusive="neither"
-0000c4d0: 292e 6578 6563 7574 6528 290a 2020 2020  ).execute().    
-0000c4e0: 2020 2020 3020 2020 2020 5472 7565 0a20      0     True. 
-0000c4f0: 2020 2020 2020 2031 2020 2020 4661 6c73         1    Fals
-0000c500: 650a 2020 2020 2020 2020 3220 2020 2046  e.        2    F
-0000c510: 616c 7365 0a20 2020 2020 2020 2033 2020  alse.        3  
-0000c520: 2020 4661 6c73 650a 2020 2020 2020 2020    False.        
-0000c530: 3420 2020 2046 616c 7365 0a20 2020 2020  4    False.     
-0000c540: 2020 2064 7479 7065 3a20 626f 6f6c 0a0a     dtype: bool..
-0000c550: 2020 2020 2020 2020 606c 6566 7460 2061          `left` a
-0000c560: 6e64 2060 7269 6768 7460 2063 616e 2062  nd `right` can b
-0000c570: 6520 616e 7920 7363 616c 6172 2076 616c  e any scalar val
-0000c580: 7565 3a0a 0a20 2020 2020 2020 203e 3e3e  ue:..        >>>
-0000c590: 2073 203d 206d 642e 5365 7269 6573 285b   s = md.Series([
-0000c5a0: 2741 6c69 6365 272c 2027 426f 6227 2c20  'Alice', 'Bob', 
-0000c5b0: 2743 6172 6f6c 272c 2027 4576 6527 5d29  'Carol', 'Eve'])
-0000c5c0: 0a20 2020 2020 2020 203e 3e3e 2073 2e62  .        >>> s.b
-0000c5d0: 6574 7765 656e 2827 416e 6e61 272c 2027  etween('Anna', '
-0000c5e0: 4461 6e69 656c 2729 2e65 7865 6375 7465  Daniel').execute
-0000c5f0: 2829 0a20 2020 2020 2020 2030 2020 2020  ().        0    
-0000c600: 4661 6c73 650a 2020 2020 2020 2020 3120  False.        1 
-0000c610: 2020 2020 5472 7565 0a20 2020 2020 2020      True.       
-0000c620: 2032 2020 2020 2054 7275 650a 2020 2020   2     True.    
-0000c630: 2020 2020 3320 2020 2046 616c 7365 0a20      3    False. 
-0000c640: 2020 2020 2020 2064 7479 7065 3a20 626f         dtype: bo
-0000c650: 6f6c 0a20 2020 2020 2020 2022 2222 0a20  ol.        """. 
-0000c660: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0000c670: 616e 6365 2869 6e63 6c75 7369 7665 2c20  ance(inclusive, 
-0000c680: 626f 6f6c 293a 2020 2320 7072 6167 6d61  bool):  # pragma
-0000c690: 3a20 6e6f 2063 6f76 6572 0a20 2020 2020  : no cover.     
-0000c6a0: 2020 2020 2020 2023 2066 6f72 2070 616e         # for pan
-0000c6b0: 6461 7320 3c20 312e 332e 300a 2020 2020  das < 1.3.0.    
-0000c6c0: 2020 2020 2020 2020 6966 2069 6e63 6c75          if inclu
-0000c6d0: 7369 7665 3a0a 2020 2020 2020 2020 2020  sive:.          
-0000c6e0: 2020 2020 2020 696e 636c 7573 6976 6520        inclusive 
-0000c6f0: 3d20 2262 6f74 6822 0a20 2020 2020 2020  = "both".       
-0000c700: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000c710: 2020 2020 2020 2020 2020 2069 6e63 6c75             inclu
-0000c720: 7369 7665 203d 2022 6e65 6974 6865 7222  sive = "neither"
-0000c730: 0a20 2020 2020 2020 2069 6620 696e 636c  .        if incl
-0000c740: 7573 6976 6520 3d3d 2022 626f 7468 223a  usive == "both":
-0000c750: 0a20 2020 2020 2020 2020 2020 206c 6d61  .            lma
-0000c760: 736b 203d 2073 656c 6620 3e3d 206c 6566  sk = self >= lef
-0000c770: 740a 2020 2020 2020 2020 2020 2020 726d  t.            rm
-0000c780: 6173 6b20 3d20 7365 6c66 203c 3d20 7269  ask = self <= ri
-0000c790: 6768 740a 2020 2020 2020 2020 656c 6966  ght.        elif
-0000c7a0: 2069 6e63 6c75 7369 7665 203d 3d20 226c   inclusive == "l
-0000c7b0: 6566 7422 3a0a 2020 2020 2020 2020 2020  eft":.          
-0000c7c0: 2020 6c6d 6173 6b20 3d20 7365 6c66 203e    lmask = self >
-0000c7d0: 3d20 6c65 6674 0a20 2020 2020 2020 2020  = left.         
-0000c7e0: 2020 2072 6d61 736b 203d 2073 656c 6620     rmask = self 
-0000c7f0: 3c20 7269 6768 740a 2020 2020 2020 2020  < right.        
-0000c800: 656c 6966 2069 6e63 6c75 7369 7665 203d  elif inclusive =
-0000c810: 3d20 2272 6967 6874 223a 0a20 2020 2020  = "right":.     
-0000c820: 2020 2020 2020 206c 6d61 736b 203d 2073         lmask = s
-0000c830: 656c 6620 3e20 6c65 6674 0a20 2020 2020  elf > left.     
-0000c840: 2020 2020 2020 2072 6d61 736b 203d 2073         rmask = s
-0000c850: 656c 6620 3c3d 2072 6967 6874 0a20 2020  elf <= right.   
-0000c860: 2020 2020 2065 6c69 6620 696e 636c 7573       elif inclus
-0000c870: 6976 6520 3d3d 2022 6e65 6974 6865 7222  ive == "neither"
-0000c880: 3a0a 2020 2020 2020 2020 2020 2020 6c6d  :.            lm
-0000c890: 6173 6b20 3d20 7365 6c66 203e 206c 6566  ask = self > lef
-0000c8a0: 740a 2020 2020 2020 2020 2020 2020 726d  t.            rm
-0000c8b0: 6173 6b20 3d20 7365 6c66 203c 2072 6967  ask = self < rig
-0000c8c0: 6874 0a20 2020 2020 2020 2065 6c73 653a  ht.        else:
-0000c8d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000c8e0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0000c8f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000c900: 496e 636c 7573 6976 6520 6861 7320 746f  Inclusive has to
-0000c910: 2062 6520 6569 7468 6572 2073 7472 696e   be either strin
-0000c920: 6720 6f66 2027 626f 7468 272c 220a 2020  g of 'both',".  
-0000c930: 2020 2020 2020 2020 2020 2020 2020 2227                "'
-0000c940: 6c65 6674 272c 2027 7269 6768 7427 2c20  left', 'right', 
-0000c950: 6f72 2027 6e65 6974 6865 7227 2e22 0a20  or 'neither'.". 
-0000c960: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0000c970: 2020 2020 2020 7265 7475 726e 206c 6d61        return lma
-0000c980: 736b 2026 2072 6d61 736b 0a0a 2020 2020  sk & rmask..    
-0000c990: 6465 6620 6d65 6469 616e 280a 2020 2020  def median(.    
-0000c9a0: 2020 2020 7365 6c66 2c20 6178 6973 3d4e      self, axis=N
-0000c9b0: 6f6e 652c 2073 6b69 706e 613d 5472 7565  one, skipna=True
-0000c9c0: 2c20 6f75 743d 4e6f 6e65 2c20 6f76 6572  , out=None, over
-0000c9d0: 7772 6974 655f 696e 7075 743d 4661 6c73  write_input=Fals
-0000c9e0: 652c 206b 6565 7064 696d 733d 4661 6c73  e, keepdims=Fals
-0000c9f0: 650a 2020 2020 293a 0a20 2020 2020 2020  e.    ):.       
-0000ca00: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-0000ca10: 7572 6e20 7468 6520 6d65 6469 616e 206f  urn the median o
-0000ca20: 6620 7468 6520 7661 6c75 6573 206f 7665  f the values ove
-0000ca30: 7220 7468 6520 7265 7175 6573 7465 6420  r the requested 
-0000ca40: 6178 6973 2e0a 0a20 2020 2020 2020 2050  axis...        P
-0000ca50: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-0000ca60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0000ca70: 2020 2020 2061 7869 7320 3a20 7b69 6e64       axis : {ind
-0000ca80: 6578 2028 3029 7d0a 2020 2020 2020 2020  ex (0)}.        
-0000ca90: 2020 2020 4178 6973 206f 7220 6178 6573      Axis or axes
-0000caa0: 2061 6c6f 6e67 2077 6869 6368 2074 6865   along which the
-0000cab0: 206d 6564 6961 6e73 2061 7265 2063 6f6d   medians are com
-0000cac0: 7075 7465 642e 2054 6865 2064 6566 6175  puted. The defau
-0000cad0: 6c74 0a20 2020 2020 2020 2020 2020 2069  lt.            i
-0000cae0: 7320 746f 2063 6f6d 7075 7465 2074 6865  s to compute the
-0000caf0: 206d 6564 6961 6e20 616c 6f6e 6720 6120   median along a 
-0000cb00: 666c 6174 7465 6e65 6420 7665 7273 696f  flattened versio
-0000cb10: 6e20 6f66 2074 6865 2074 656e 736f 722e  n of the tensor.
-0000cb20: 0a20 2020 2020 2020 2020 2020 2041 2073  .            A s
-0000cb30: 6571 7565 6e63 6520 6f66 2061 7865 7320  equence of axes 
-0000cb40: 6973 2073 7570 706f 7274 6564 2073 696e  is supported sin
-0000cb50: 6365 2076 6572 7369 6f6e 2031 2e39 2e30  ce version 1.9.0
-0000cb60: 2e0a 2020 2020 2020 2020 736b 6970 6e61  ..        skipna
-0000cb70: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
-0000cb80: 6c2c 2064 6566 6175 6c74 2054 7275 650a  l, default True.
-0000cb90: 2020 2020 2020 2020 2020 2020 4578 636c              Excl
-0000cba0: 7564 6520 4e41 2f6e 756c 6c20 7661 6c75  ude NA/null valu
-0000cbb0: 6573 2077 6865 6e20 636f 6d70 7574 696e  es when computin
-0000cbc0: 6720 7468 6520 7265 7375 6c74 2e0a 2020  g the result..  
-0000cbd0: 2020 2020 2020 6f75 7420 3a20 5465 6e73        out : Tens
-0000cbe0: 6f72 2c20 6465 6661 756c 7420 4e6f 6e65  or, default None
-0000cbf0: 0a20 2020 2020 2020 2020 2020 204f 7574  .            Out
-0000cc00: 7075 7420 7465 6e73 6f72 2069 6e20 7768  put tensor in wh
-0000cc10: 6963 6820 746f 2070 6c61 6365 2074 6865  ich to place the
-0000cc20: 2072 6573 756c 742e 2049 7420 6d75 7374   result. It must
-0000cc30: 0a20 2020 2020 2020 2020 2020 2068 6176  .            hav
-0000cc40: 6520 7468 6520 7361 6d65 2073 6861 7065  e the same shape
-0000cc50: 2061 6e64 2062 7566 6665 7220 6c65 6e67   and buffer leng
-0000cc60: 7468 2061 7320 7468 6520 6578 7065 6374  th as the expect
-0000cc70: 6564 206f 7574 7075 742c 0a20 2020 2020  ed output,.     
-0000cc80: 2020 2020 2020 2062 7574 2074 6865 2074         but the t
-0000cc90: 7970 6520 286f 6620 7468 6520 6f75 7470  ype (of the outp
-0000cca0: 7574 2920 7769 6c6c 2062 6520 6361 7374  ut) will be cast
-0000ccb0: 2069 6620 6e65 6365 7373 6172 792e 0a20   if necessary.. 
-0000ccc0: 2020 2020 2020 206f 7665 7277 7269 7465         overwrite
-0000ccd0: 5f69 6e70 7574 203a 2062 6f6f 6c2c 2064  _input : bool, d
-0000cce0: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
-0000ccf0: 2020 2020 2020 2020 204a 7573 7420 666f           Just fo
-0000cd00: 7220 636f 6d70 6174 6962 696c 6974 7920  r compatibility 
-0000cd10: 7769 7468 204e 756d 7079 2c20 776f 756c  with Numpy, woul
-0000cd20: 6420 6e6f 7420 7461 6b65 2065 6666 6563  d not take effec
-0000cd30: 742e 0a20 2020 2020 2020 206b 6565 7064  t..        keepd
-0000cd40: 696d 7320 3a20 626f 6f6c 2c20 6465 6661  ims : bool, defa
-0000cd50: 756c 7420 4661 6c73 650a 2020 2020 2020  ult False.      
-0000cd60: 2020 2020 2020 4966 2074 6869 7320 6973        If this is
-0000cd70: 2073 6574 2074 6f20 5472 7565 2c20 7468   set to True, th
-0000cd80: 6520 6178 6573 2077 6869 6368 2061 7265  e axes which are
-0000cd90: 2072 6564 7563 6564 2061 7265 206c 6566   reduced are lef
-0000cda0: 740a 2020 2020 2020 2020 2020 2020 696e  t.            in
-0000cdb0: 2074 6865 2072 6573 756c 7420 6173 2064   the result as d
-0000cdc0: 696d 656e 7369 6f6e 7320 7769 7468 2073  imensions with s
-0000cdd0: 697a 6520 6f6e 652e 2057 6974 6820 7468  ize one. With th
-0000cde0: 6973 206f 7074 696f 6e2c 0a20 2020 2020  is option,.     
-0000cdf0: 2020 2020 2020 2074 6865 2072 6573 756c         the resul
-0000ce00: 7420 7769 6c6c 2062 726f 6164 6361 7374  t will broadcast
-0000ce10: 2063 6f72 7265 6374 6c79 2061 6761 696e   correctly again
-0000ce20: 7374 2074 6865 206f 7269 6769 6e61 6c20  st the original 
-0000ce30: 6061 7272 602e 0a0a 2020 2020 2020 2020  `arr`...        
-0000ce40: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-0000ce50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000ce60: 6d65 6469 616e 203a 2073 6361 6c61 720a  median : scalar.
-0000ce70: 2020 2020 2020 2020 2020 2020 5265 7475              Retu
-0000ce80: 726e 2074 6865 206d 6564 6961 6e20 6f66  rn the median of
-0000ce90: 2074 6865 2076 616c 7565 7320 6f76 6572   the values over
-0000cea0: 2074 6865 2072 6571 7565 7374 6564 2061   the requested a
-0000ceb0: 7869 732e 0a0a 2020 2020 2020 2020 5365  xis...        Se
-0000cec0: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
-0000ced0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000cee0: 7465 6e73 6f72 2e6d 6561 6e2c 2074 656e  tensor.mean, ten
-0000cef0: 736f 722e 7065 7263 656e 7469 6c65 0a0a  sor.percentile..
-0000cf00: 2020 2020 2020 2020 4e6f 7465 730a 2020          Notes.  
-0000cf10: 2020 2020 2020 2d2d 2d2d 2d0a 2020 2020        -----.    
-0000cf20: 2020 2020 4769 7665 6e20 6120 7665 6374      Given a vect
-0000cf30: 6f72 2060 6056 6060 206f 6620 6c65 6e67  or ``V`` of leng
-0000cf40: 7468 2060 604e 6060 2c20 7468 6520 6d65  th ``N``, the me
-0000cf50: 6469 616e 206f 6620 6060 5660 6020 6973  dian of ``V`` is
-0000cf60: 2074 6865 0a20 2020 2020 2020 206d 6964   the.        mid
-0000cf70: 646c 6520 7661 6c75 6520 6f66 2061 2073  dle value of a s
-0000cf80: 6f72 7465 6420 636f 7079 206f 6620 6060  orted copy of ``
-0000cf90: 5660 602c 2060 6056 5f73 6f72 7465 6460  V``, ``V_sorted`
-0000cfa0: 6020 2d20 690a 2020 2020 2020 2020 652e  ` - i.        e.
-0000cfb0: 2c20 6060 565f 736f 7274 6564 5b28 4e2d  , ``V_sorted[(N-
-0000cfc0: 3129 2f32 5d60 602c 2077 6865 6e20 6060  1)/2]``, when ``
-0000cfd0: 4e60 6020 6973 206f 6464 2c20 616e 6420  N`` is odd, and 
-0000cfe0: 7468 6520 6176 6572 6167 6520 6f66 2074  the average of t
-0000cff0: 6865 0a20 2020 2020 2020 2074 776f 206d  he.        two m
-0000d000: 6964 646c 6520 7661 6c75 6573 206f 6620  iddle values of 
-0000d010: 6060 565f 736f 7274 6564 6060 2077 6865  ``V_sorted`` whe
-0000d020: 6e20 6060 4e60 6020 6973 2065 7665 6e2e  n ``N`` is even.
-0000d030: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-0000d040: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-0000d050: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
-0000d060: 696d 706f 7274 206d 6172 732e 6461 7461  import mars.data
-0000d070: 6672 616d 6520 6173 206d 640a 2020 2020  frame as md.    
-0000d080: 2020 2020 3e3e 3e20 6120 3d20 6d64 2e53      >>> a = md.S
-0000d090: 6572 6965 7328 5b31 302c 2037 2c20 342c  eries([10, 7, 4,
-0000d0a0: 2033 2c20 322c 2031 5d29 0a20 2020 2020   3, 2, 1]).     
-0000d0b0: 2020 203e 3e3e 2061 2e6d 6564 6961 6e28     >>> a.median(
-0000d0c0: 292e 6578 6563 7574 6528 290a 2020 2020  ).execute().    
-0000d0d0: 2020 2020 322e 300a 2020 2020 2020 2020      2.0.        
-0000d0e0: 3e3e 3e20 6d74 2e6d 6564 6961 6e28 6129  >>> mt.median(a)
-0000d0f0: 2e65 7865 6375 7465 2829 0a20 2020 2020  .execute().     
-0000d100: 2020 2033 2e35 0a20 2020 2020 2020 203e     3.5.        >
-0000d110: 3e3e 2061 203d 206d 642e 5365 7269 6573  >> a = md.Series
-0000d120: 285b 3130 2c20 372c 2034 2c20 4e6f 6e65  ([10, 7, 4, None
-0000d130: 2c20 322c 2031 5d29 0a20 2020 2020 2020  , 2, 1]).       
-0000d140: 203e 3e3e 2061 2e6d 6564 6961 6e28 292e   >>> a.median().
-0000d150: 6578 6563 7574 6528 290a 2020 2020 2020  execute().      
-0000d160: 2020 342e 300a 2020 2020 2020 2020 3e3e    4.0.        >>
-0000d170: 3e20 612e 6d65 6469 616e 2873 6b69 706e  > a.median(skipn
-0000d180: 613d 4661 6c73 6529 2e65 7865 6375 7465  a=False).execute
-0000d190: 2829 0a20 2020 2020 2020 206e 616e 0a20  ().        nan. 
-0000d1a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000d1b0: 2020 2069 6620 736b 6970 6e61 3a0a 2020     if skipna:.  
-0000d1c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000d1d0: 2073 7461 7469 7374 6963 732e 6d65 6469   statistics.medi
-0000d1e0: 616e 280a 2020 2020 2020 2020 2020 2020  an(.            
-0000d1f0: 2020 2020 7365 6c66 2e64 726f 706e 6128      self.dropna(
-0000d200: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000d210: 2020 2061 7869 733d 4e6f 6e65 2c0a 2020     axis=None,.  
-0000d220: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-0000d230: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
-0000d240: 2020 2020 2020 2020 6f76 6572 7772 6974          overwrit
-0000d250: 655f 696e 7075 743d 4661 6c73 652c 0a20  e_input=False,. 
-0000d260: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-0000d270: 6565 7064 696d 733d 4661 6c73 652c 0a20  eepdims=False,. 
-0000d280: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000d290: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000d2a0: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
-0000d2b0: 6174 6973 7469 6373 2e6d 6564 6961 6e28  atistics.median(
-0000d2c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d2d0: 2073 656c 662c 2061 7869 733d 4e6f 6e65   self, axis=None
-0000d2e0: 2c20 6f75 743d 4e6f 6e65 2c20 6f76 6572  , out=None, over
-0000d2f0: 7772 6974 655f 696e 7075 743d 4661 6c73  write_input=Fals
-0000d300: 652c 206b 6565 7064 696d 733d 4661 6c73  e, keepdims=Fals
-0000d310: 650a 2020 2020 2020 2020 2020 2020 290a  e.            ).
-0000d320: 0a0a 636c 6173 7320 4261 7365 4461 7461  ..class BaseData
-0000d330: 4672 616d 6543 6875 6e6b 4461 7461 284c  FrameChunkData(L
-0000d340: 617a 794d 6574 6143 6875 6e6b 4461 7461  azyMetaChunkData
-0000d350: 293a 0a20 2020 205f 5f73 6c6f 7473 5f5f  ):.    __slots__
-0000d360: 203d 2028 225f 6474 7970 6573 5f76 616c   = ("_dtypes_val
-0000d370: 7565 222c 290a 2020 2020 5f6e 6f5f 636f  ue",).    _no_co
-0000d380: 7079 5f61 7474 7273 5f20 3d20 4368 756e  py_attrs_ = Chun
-0000d390: 6b44 6174 612e 5f6e 6f5f 636f 7079 5f61  kData._no_copy_a
-0000d3a0: 7474 7273 5f20 7c20 7b22 5f64 7479 7065  ttrs_ | {"_dtype
-0000d3b0: 7322 2c20 225f 636f 6c75 6d6e 735f 7661  s", "_columns_va
-0000d3c0: 6c75 6522 7d0a 0a20 2020 2023 2072 6571  lue"}..    # req
-0000d3d0: 7569 7265 6420 6669 656c 6473 0a20 2020  uired fields.   
-0000d3e0: 205f 7368 6170 6520 3d20 5475 706c 6546   _shape = TupleF
-0000d3f0: 6965 6c64 280a 2020 2020 2020 2020 2273  ield(.        "s
-0000d400: 6861 7065 222c 0a20 2020 2020 2020 2046  hape",.        F
-0000d410: 6965 6c64 5479 7065 732e 696e 7436 342c  ieldTypes.int64,
-0000d420: 0a20 2020 2020 2020 206f 6e5f 7365 7269  .        on_seri
-0000d430: 616c 697a 653d 6f6e 5f73 6572 6961 6c69  alize=on_seriali
-0000d440: 7a65 5f73 6861 7065 2c0a 2020 2020 2020  ze_shape,.      
-0000d450: 2020 6f6e 5f64 6573 6572 6961 6c69 7a65    on_deserialize
-0000d460: 3d6f 6e5f 6465 7365 7269 616c 697a 655f  =on_deserialize_
-0000d470: 7368 6170 652c 0a20 2020 2029 0a20 2020  shape,.    ).   
-0000d480: 2023 206f 7074 696f 6e61 6c20 6669 656c   # optional fiel
-0000d490: 6473 0a20 2020 205f 6474 7970 6573 203d  ds.    _dtypes =
-0000d4a0: 2043 6875 6e6b 4474 7970 6573 4669 656c   ChunkDtypesFiel
-0000d4b0: 6428 2264 7479 7065 7322 290a 2020 2020  d("dtypes").    
-0000d4c0: 5f69 6e64 6578 5f76 616c 7565 203d 2043  _index_value = C
-0000d4d0: 6875 6e6b 496e 6465 7856 616c 7565 4669  hunkIndexValueFi
-0000d4e0: 656c 6428 0a20 2020 2020 2020 2022 696e  eld(.        "in
-0000d4f0: 6465 785f 7661 6c75 6522 2c20 496e 6465  dex_value", Inde
-0000d500: 7856 616c 7565 2c20 6f6e 5f64 6573 6572  xValue, on_deser
-0000d510: 6961 6c69 7a65 3d5f 6f6e 5f64 6573 6572  ialize=_on_deser
-0000d520: 6961 6c69 7a65 5f69 6e64 6578 5f76 616c  ialize_index_val
-0000d530: 7565 0a20 2020 2029 0a20 2020 205f 636f  ue.    ).    _co
-0000d540: 6c75 6d6e 735f 7661 6c75 6520 3d20 4368  lumns_value = Ch
-0000d550: 756e 6b43 6f6c 756d 6e73 5661 6c75 6546  unkColumnsValueF
-0000d560: 6965 6c64 2822 636f 6c75 6d6e 735f 7661  ield("columns_va
-0000d570: 6c75 6522 2c20 496e 6465 7856 616c 7565  lue", IndexValue
-0000d580: 290a 0a20 2020 2064 6566 205f 5f69 6e69  )..    def __ini
-0000d590: 745f 5f28 0a20 2020 2020 2020 2073 656c  t__(.        sel
-0000d5a0: 662c 0a20 2020 2020 2020 206f 703d 4e6f  f,.        op=No
-0000d5b0: 6e65 2c0a 2020 2020 2020 2020 7368 6170  ne,.        shap
-0000d5c0: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-0000d5d0: 696e 6465 783d 4e6f 6e65 2c0a 2020 2020  index=None,.    
-0000d5e0: 2020 2020 6474 7970 6573 3d4e 6f6e 652c      dtypes=None,
-0000d5f0: 0a20 2020 2020 2020 2069 6e64 6578 5f76  .        index_v
-0000d600: 616c 7565 3d4e 6f6e 652c 0a20 2020 2020  alue=None,.     
-0000d610: 2020 2063 6f6c 756d 6e73 5f76 616c 7565     columns_value
-0000d620: 3d4e 6f6e 652c 0a20 2020 2020 2020 202a  =None,.        *
-0000d630: 2a6b 772c 0a20 2020 2029 3a0a 2020 2020  *kw,.    ):.    
-0000d640: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
-0000d650: 6974 5f5f 280a 2020 2020 2020 2020 2020  it__(.          
-0000d660: 2020 5f6f 703d 6f70 2c0a 2020 2020 2020    _op=op,.      
-0000d670: 2020 2020 2020 5f73 6861 7065 3d73 6861        _shape=sha
-0000d680: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-0000d690: 5f69 6e64 6578 3d69 6e64 6578 2c0a 2020  _index=index,.  
-0000d6a0: 2020 2020 2020 2020 2020 5f64 7479 7065            _dtype
-0000d6b0: 733d 6474 7970 6573 2c0a 2020 2020 2020  s=dtypes,.      
-0000d6c0: 2020 2020 2020 5f69 6e64 6578 5f76 616c        _index_val
-0000d6d0: 7565 3d69 6e64 6578 5f76 616c 7565 2c0a  ue=index_value,.
-0000d6e0: 2020 2020 2020 2020 2020 2020 5f63 6f6c              _col
-0000d6f0: 756d 6e73 5f76 616c 7565 3d63 6f6c 756d  umns_value=colum
-0000d700: 6e73 5f76 616c 7565 2c0a 2020 2020 2020  ns_value,.      
-0000d710: 2020 2020 2020 2a2a 6b77 2c0a 2020 2020        **kw,.    
-0000d720: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0000d730: 6c66 2e5f 6474 7970 6573 5f76 616c 7565  lf._dtypes_value
-0000d740: 203d 204e 6f6e 650a 0a20 2020 2064 6566   = None..    def
-0000d750: 205f 5f6f 6e5f 6465 7365 7269 616c 697a   __on_deserializ
-0000d760: 655f 5f28 7365 6c66 293a 0a20 2020 2020  e__(self):.     
-0000d770: 2020 2073 7570 6572 2842 6173 6544 6174     super(BaseDat
-0000d780: 6146 7261 6d65 4368 756e 6b44 6174 612c  aFrameChunkData,
-0000d790: 2073 656c 6629 2e5f 5f6f 6e5f 6465 7365   self).__on_dese
-0000d7a0: 7269 616c 697a 655f 5f28 290a 2020 2020  rialize__().    
-0000d7b0: 2020 2020 7365 6c66 2e5f 6474 7970 6573      self._dtypes
-0000d7c0: 5f76 616c 7565 203d 204e 6f6e 650a 0a20  _value = None.. 
-0000d7d0: 2020 2064 6566 205f 5f6c 656e 5f5f 2873     def __len__(s
-0000d7e0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-0000d7f0: 7475 726e 2073 656c 662e 7368 6170 655b  turn self.shape[
-0000d800: 305d 0a0a 2020 2020 6465 6620 5f67 6574  0]..    def _get
-0000d810: 5f70 6172 616d 7328 7365 6c66 2920 2d3e  _params(self) ->
-0000d820: 2044 6963 745b 7374 722c 2041 6e79 5d3a   Dict[str, Any]:
-0000d830: 0a20 2020 2020 2020 2023 2070 6172 616d  .        # param
-0000d840: 7320 7265 7475 726e 2074 6865 2070 726f  s return the pro
-0000d850: 7065 7274 6965 7320 7768 6963 6820 7573  perties which us
-0000d860: 6566 756c 2074 6f20 7265 6275 696c 6420  eful to rebuild 
-0000d870: 6120 6e65 7720 6368 756e 6b0a 2020 2020  a new chunk.    
-0000d880: 2020 2020 7265 7475 726e 207b 0a20 2020      return {.   
-0000d890: 2020 2020 2020 2020 2022 7368 6170 6522           "shape"
-0000d8a0: 3a20 7365 6c66 2e73 6861 7065 2c0a 2020  : self.shape,.  
-0000d8b0: 2020 2020 2020 2020 2020 2264 7479 7065            "dtype
-0000d8c0: 7322 3a20 7365 6c66 2e64 7479 7065 732c  s": self.dtypes,
-0000d8d0: 0a20 2020 2020 2020 2020 2020 2022 6474  .            "dt
-0000d8e0: 7970 6573 5f76 616c 7565 223a 2073 656c  ypes_value": sel
-0000d8f0: 662e 6474 7970 6573 5f76 616c 7565 2c0a  f.dtypes_value,.
-0000d900: 2020 2020 2020 2020 2020 2020 2269 6e64              "ind
-0000d910: 6578 223a 2073 656c 662e 696e 6465 782c  ex": self.index,
-0000d920: 0a20 2020 2020 2020 2020 2020 2022 696e  .            "in
-0000d930: 6465 785f 7661 6c75 6522 3a20 7365 6c66  dex_value": self
-0000d940: 2e69 6e64 6578 5f76 616c 7565 2c0a 2020  .index_value,.  
-0000d950: 2020 2020 2020 2020 2020 2263 6f6c 756d            "colum
-0000d960: 6e73 5f76 616c 7565 223a 2073 656c 662e  ns_value": self.
-0000d970: 636f 6c75 6d6e 735f 7661 6c75 652c 0a20  columns_value,. 
-0000d980: 2020 2020 2020 207d 0a0a 2020 2020 6465         }..    de
-0000d990: 6620 5f73 6574 5f70 6172 616d 7328 7365  f _set_params(se
-0000d9a0: 6c66 2c20 6e65 775f 7061 7261 6d73 3a20  lf, new_params: 
-0000d9b0: 4469 6374 5b73 7472 2c20 416e 795d 293a  Dict[str, Any]):
-0000d9c0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-0000d9d0: 3d20 6e65 775f 7061 7261 6d73 2e63 6f70  = new_params.cop
-0000d9e0: 7928 290a 2020 2020 2020 2020 7061 7261  y().        para
-0000d9f0: 6d73 2e70 6f70 2822 696e 6465 7822 2c20  ms.pop("index", 
-0000da00: 4e6f 6e65 2920 2023 2069 6e64 6578 206e  None)  # index n
-0000da10: 6f74 206e 6565 6465 6420 746f 2075 7064  ot needed to upd
-0000da20: 6174 650a 2020 2020 2020 2020 6e65 775f  ate.        new_
-0000da30: 7368 6170 6520 3d20 7061 7261 6d73 2e70  shape = params.p
-0000da40: 6f70 2822 7368 6170 6522 2c20 4e6f 6e65  op("shape", None
-0000da50: 290a 2020 2020 2020 2020 6966 206e 6577  ).        if new
-0000da60: 5f73 6861 7065 2069 7320 6e6f 7420 4e6f  _shape is not No
-0000da70: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000da80: 7365 6c66 2e5f 7368 6170 6520 3d20 6e65  self._shape = ne
-0000da90: 775f 7368 6170 650a 2020 2020 2020 2020  w_shape.        
-0000daa0: 696e 6465 785f 7661 6c75 6520 3d20 7061  index_value = pa
-0000dab0: 7261 6d73 2e70 6f70 2822 696e 6465 785f  rams.pop("index_
-0000dac0: 7661 6c75 6522 2c20 4e6f 6e65 290a 2020  value", None).  
-0000dad0: 2020 2020 2020 6966 2069 6e64 6578 5f76        if index_v
-0000dae0: 616c 7565 2069 7320 6e6f 7420 4e6f 6e65  alue is not None
-0000daf0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0000db00: 6c66 2e5f 696e 6465 785f 7661 6c75 6520  lf._index_value 
-0000db10: 3d20 696e 6465 785f 7661 6c75 650a 2020  = index_value.  
-0000db20: 2020 2020 2020 6474 7970 6573 203d 2070        dtypes = p
-0000db30: 6172 616d 732e 706f 7028 2264 7479 7065  arams.pop("dtype
-0000db40: 7322 2c20 4e6f 6e65 290a 2020 2020 2020  s", None).      
-0000db50: 2020 6966 2064 7479 7065 7320 6973 206e    if dtypes is n
-0000db60: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0000db70: 2020 2020 2073 656c 662e 5f64 7479 7065       self._dtype
-0000db80: 7320 3d20 6474 7970 6573 0a20 2020 2020  s = dtypes.     
-0000db90: 2020 2063 6f6c 756d 6e73 5f76 616c 7565     columns_value
-0000dba0: 203d 2070 6172 616d 732e 706f 7028 2263   = params.pop("c
-0000dbb0: 6f6c 756d 6e73 5f76 616c 7565 222c 204e  olumns_value", N
-0000dbc0: 6f6e 6529 0a20 2020 2020 2020 2069 6620  one).        if 
-0000dbd0: 636f 6c75 6d6e 735f 7661 6c75 6520 6973  columns_value is
-0000dbe0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0000dbf0: 2020 2020 2020 2073 656c 662e 5f63 6f6c         self._col
-0000dc00: 756d 6e73 5f76 616c 7565 203d 2063 6f6c  umns_value = col
-0000dc10: 756d 6e73 5f76 616c 7565 0a20 2020 2020  umns_value.     
-0000dc20: 2020 2064 7479 7065 735f 7661 6c75 6520     dtypes_value 
-0000dc30: 3d20 7061 7261 6d73 2e70 6f70 2822 6474  = params.pop("dt
-0000dc40: 7970 6573 5f76 616c 7565 222c 204e 6f6e  ypes_value", Non
-0000dc50: 6529 0a20 2020 2020 2020 2069 6620 6474  e).        if dt
-0000dc60: 7970 6573 5f76 616c 7565 2069 7320 6e6f  ypes_value is no
-0000dc70: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0000dc80: 2020 2020 6966 2064 7479 7065 7320 6973      if dtypes is
-0000dc90: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0000dca0: 2020 2020 2020 2073 656c 662e 5f64 7479         self._dty
-0000dcb0: 7065 7320 3d20 6474 7970 6573 5f76 616c  pes = dtypes_val
-0000dcc0: 7565 2e76 616c 7565 0a20 2020 2020 2020  ue.value.       
-0000dcd0: 2020 2020 2069 6620 636f 6c75 6d6e 735f       if columns_
-0000dce0: 7661 6c75 6520 6973 204e 6f6e 653a 0a20  value is None:. 
-0000dcf0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000dd00: 656c 662e 5f63 6f6c 756d 6e73 5f76 616c  elf._columns_val
-0000dd10: 7565 203d 2070 6172 7365 5f69 6e64 6578  ue = parse_index
-0000dd20: 2873 656c 662e 5f64 7479 7065 732e 696e  (self._dtypes.in
-0000dd30: 6465 782c 2073 746f 7265 5f64 6174 613d  dex, store_data=
-0000dd40: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
-0000dd50: 2020 7365 6c66 2e5f 6474 7970 6573 5f76    self._dtypes_v
-0000dd60: 616c 7565 203d 2064 7479 7065 735f 7661  alue = dtypes_va
-0000dd70: 6c75 650a 2020 2020 2020 2020 6966 2070  lue.        if p
-0000dd80: 6172 616d 733a 2020 2320 7072 6167 6d61  arams:  # pragma
-0000dd90: 3a20 6e6f 2063 6f76 6572 0a20 2020 2020  : no cover.     
-0000dda0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-0000ddb0: 6545 7272 6f72 2866 2255 6e6b 6e6f 776e  eError(f"Unknown
-0000ddc0: 2070 6172 616d 733a 207b 6c69 7374 2870   params: {list(p
-0000ddd0: 6172 616d 7329 7d22 290a 0a20 2020 2070  arams)}")..    p
-0000dde0: 6172 616d 7320 3d20 7072 6f70 6572 7479  arams = property
-0000ddf0: 285f 6765 745f 7061 7261 6d73 2c20 5f73  (_get_params, _s
-0000de00: 6574 5f70 6172 616d 7329 0a0a 2020 2020  et_params)..    
-0000de10: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
-0000de20: 2064 6566 2067 6574 5f70 6172 616d 735f   def get_params_
-0000de30: 6672 6f6d 5f64 6174 6128 636c 732c 2064  from_data(cls, d
-0000de40: 6174 613a 2070 642e 4461 7461 4672 616d  ata: pd.DataFram
-0000de50: 6529 202d 3e20 4469 6374 5b73 7472 2c20  e) -> Dict[str, 
-0000de60: 416e 795d 3a0a 2020 2020 2020 2020 7061  Any]:.        pa
-0000de70: 7273 655f 696e 6465 7828 6461 7461 2e69  rse_index(data.i
-0000de80: 6e64 6578 2c20 7374 6f72 655f 6461 7461  ndex, store_data
-0000de90: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-0000dea0: 7265 7475 726e 207b 0a20 2020 2020 2020  return {.       
-0000deb0: 2020 2020 2022 7368 6170 6522 3a20 6461       "shape": da
-0000dec0: 7461 2e73 6861 7065 2c0a 2020 2020 2020  ta.shape,.      
-0000ded0: 2020 2020 2020 2269 6e64 6578 5f76 616c        "index_val
-0000dee0: 7565 223a 2070 6172 7365 5f69 6e64 6578  ue": parse_index
-0000def0: 2864 6174 612e 696e 6465 782c 2073 746f  (data.index, sto
-0000df00: 7265 5f64 6174 613d 4661 6c73 6529 2c0a  re_data=False),.
-0000df10: 2020 2020 2020 2020 2020 2020 2264 7479              "dty
-0000df20: 7065 735f 7661 6c75 6522 3a20 4474 7970  pes_value": Dtyp
-0000df30: 6573 5661 6c75 6528 6b65 793d 746f 6b65  esValue(key=toke
-0000df40: 6e69 7a65 2864 6174 612e 6474 7970 6573  nize(data.dtypes
-0000df50: 292c 2076 616c 7565 3d64 6174 612e 6474  ), value=data.dt
-0000df60: 7970 6573 292c 0a20 2020 2020 2020 207d  ypes),.        }
-0000df70: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000df80: 2020 2020 6465 6620 7368 6170 6528 7365      def shape(se
-0000df90: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-0000dfa0: 7572 6e20 6765 7461 7474 7228 7365 6c66  urn getattr(self
-0000dfb0: 2c20 225f 7368 6170 6522 2c20 4e6f 6e65  , "_shape", None
-0000dfc0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0000dfd0: 0a20 2020 2064 6566 206e 6469 6d28 7365  .    def ndim(se
-0000dfe0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-0000dff0: 7572 6e20 6c65 6e28 7365 6c66 2e73 6861  urn len(self.sha
-0000e000: 7065 290a 0a20 2020 2040 7072 6f70 6572  pe)..    @proper
-0000e010: 7479 0a20 2020 2064 6566 2064 7479 7065  ty.    def dtype
-0000e020: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-0000e030: 2064 7420 3d20 6765 7461 7474 7228 7365   dt = getattr(se
-0000e040: 6c66 2c20 225f 6474 7970 6573 222c 204e  lf, "_dtypes", N
-0000e050: 6f6e 6529 0a20 2020 2020 2020 2069 6620  one).        if 
-0000e060: 6474 2069 7320 6e6f 7420 4e6f 6e65 3a0a  dt is not None:.
-0000e070: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000e080: 726e 2064 740a 2020 2020 2020 2020 7265  rn dt.        re
-0000e090: 7475 726e 2067 6574 6174 7472 2873 656c  turn getattr(sel
-0000e0a0: 662e 6f70 2c20 2264 7479 7065 7322 2c20  f.op, "dtypes", 
-0000e0b0: 4e6f 6e65 290a 0a20 2020 2040 7072 6f70  None)..    @prop
-0000e0c0: 6572 7479 0a20 2020 2064 6566 2064 7479  erty.    def dty
-0000e0d0: 7065 735f 7661 6c75 6528 7365 6c66 293a  pes_value(self):
-0000e0e0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0000e0f0: 2e5f 6474 7970 6573 5f76 616c 7565 2069  ._dtypes_value i
-0000e100: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000e110: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000e120: 656c 662e 5f64 7479 7065 735f 7661 6c75  elf._dtypes_valu
-0000e130: 650a 2020 2020 2020 2020 2320 544f 444f  e.        # TODO
-0000e140: 2871 696e 7875 7965 293a 2077 6865 6e20  (qinxuye): when 
-0000e150: 6372 6561 7469 6e67 2044 6174 6166 7261  creating Datafra
-0000e160: 6d65 2c0a 2020 2020 2020 2020 2320 2064  me,.        #  d
-0000e170: 7479 7065 735f 7661 6c75 6520 696e 7374  types_value inst
-0000e180: 6561 6420 6f66 2064 7479 7065 7320 6c61  ead of dtypes la
-0000e190: 7465 7220 6d75 7374 2062 6520 7061 7373  ter must be pass
-0000e1a0: 6564 2069 6e74 6f0a 2020 2020 2020 2020  ed into.        
-0000e1b0: 6474 7970 6573 203d 2073 656c 662e 6474  dtypes = self.dt
-0000e1c0: 7970 6573 0a20 2020 2020 2020 2069 6620  ypes.        if 
-0000e1d0: 6474 7970 6573 2069 7320 6e6f 7420 4e6f  dtypes is not No
-0000e1e0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000e1f0: 7365 6c66 2e5f 6474 7970 6573 5f76 616c  self._dtypes_val
-0000e200: 7565 203d 2044 7479 7065 7356 616c 7565  ue = DtypesValue
-0000e210: 286b 6579 3d74 6f6b 656e 697a 6528 6474  (key=tokenize(dt
-0000e220: 7970 6573 292c 2076 616c 7565 3d64 7479  ypes), value=dty
-0000e230: 7065 7329 0a20 2020 2020 2020 2020 2020  pes).           
-0000e240: 2072 6574 7572 6e20 7365 6c66 2e5f 6474   return self._dt
-0000e250: 7970 6573 5f76 616c 7565 0a0a 2020 2020  ypes_value..    
-0000e260: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0000e270: 6620 696e 6465 785f 7661 6c75 6528 7365  f index_value(se
-0000e280: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-0000e290: 7572 6e20 7365 6c66 2e5f 696e 6465 785f  urn self._index_
-0000e2a0: 7661 6c75 650a 0a20 2020 2040 7072 6f70  value..    @prop
-0000e2b0: 6572 7479 0a20 2020 2064 6566 2063 6f6c  erty.    def col
-0000e2c0: 756d 6e73 5f76 616c 7565 2873 656c 6629  umns_value(self)
-0000e2d0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0000e2e0: 2073 656c 662e 5f63 6f6c 756d 6e73 5f76   self._columns_v
-0000e2f0: 616c 7565 0a0a 0a63 6c61 7373 2044 6174  alue...class Dat
-0000e300: 6146 7261 6d65 4368 756e 6b44 6174 6128  aFrameChunkData(
-0000e310: 4261 7365 4461 7461 4672 616d 6543 6875  BaseDataFrameChu
-0000e320: 6e6b 4461 7461 293a 0a20 2020 2074 7970  nkData):.    typ
-0000e330: 655f 6e61 6d65 203d 2022 4461 7461 4672  e_name = "DataFr
-0000e340: 616d 6522 0a0a 0a63 6c61 7373 2044 6174  ame"...class Dat
-0000e350: 6146 7261 6d65 4368 756e 6b28 4368 756e  aFrameChunk(Chun
-0000e360: 6b29 3a0a 2020 2020 5f5f 736c 6f74 735f  k):.    __slots_
-0000e370: 5f20 3d20 2829 0a20 2020 205f 616c 6c6f  _ = ().    _allo
-0000e380: 775f 6461 7461 5f74 7970 655f 203d 2028  w_data_type_ = (
-0000e390: 4461 7461 4672 616d 6543 6875 6e6b 4461  DataFrameChunkDa
-0000e3a0: 7461 2c29 0a20 2020 2074 7970 655f 6e61  ta,).    type_na
-0000e3b0: 6d65 203d 2022 4461 7461 4672 616d 6522  me = "DataFrame"
-0000e3c0: 0a0a 2020 2020 6465 6620 5f5f 6c65 6e5f  ..    def __len_
-0000e3d0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-0000e3e0: 2072 6574 7572 6e20 6c65 6e28 7365 6c66   return len(self
-0000e3f0: 2e5f 6461 7461 290a 0a0a 636c 6173 7320  ._data)...class 
-0000e400: 4261 7365 4461 7461 4672 616d 6544 6174  BaseDataFrameDat
-0000e410: 6128 4861 7353 6861 7065 5469 6c65 6162  a(HasShapeTileab
-0000e420: 6c65 4461 7461 2c20 5f54 6f50 616e 6461  leData, _ToPanda
-0000e430: 734d 6978 696e 293a 0a20 2020 205f 5f73  sMixin):.    __s
-0000e440: 6c6f 7473 5f5f 203d 2022 5f61 6363 6573  lots__ = "_acces
-0000e450: 736f 7273 222c 2022 5f64 7479 7065 735f  sors", "_dtypes_
-0000e460: 7661 6c75 6522 2c20 225f 6474 7970 6573  value", "_dtypes
-0000e470: 5f64 6963 7422 0a0a 2020 2020 2320 6f70  _dict"..    # op
-0000e480: 7469 6f6e 616c 2066 6965 6c64 730a 2020  tional fields.  
-0000e490: 2020 5f64 7479 7065 7320 3d20 5365 7269    _dtypes = Seri
-0000e4a0: 6573 4669 656c 6428 2264 7479 7065 7322  esField("dtypes"
-0000e4b0: 290a 2020 2020 5f69 6e64 6578 5f76 616c  ).    _index_val
-0000e4c0: 7565 203d 2052 6566 6572 656e 6365 4669  ue = ReferenceFi
-0000e4d0: 656c 6428 0a20 2020 2020 2020 2022 696e  eld(.        "in
-0000e4e0: 6465 785f 7661 6c75 6522 2c20 496e 6465  dex_value", Inde
-0000e4f0: 7856 616c 7565 2c20 6f6e 5f64 6573 6572  xValue, on_deser
-0000e500: 6961 6c69 7a65 3d5f 6f6e 5f64 6573 6572  ialize=_on_deser
-0000e510: 6961 6c69 7a65 5f69 6e64 6578 5f76 616c  ialize_index_val
-0000e520: 7565 0a20 2020 2029 0a20 2020 205f 636f  ue.    ).    _co
-0000e530: 6c75 6d6e 735f 7661 6c75 6520 3d20 5265  lumns_value = Re
-0000e540: 6665 7265 6e63 6546 6965 6c64 2822 636f  ferenceField("co
-0000e550: 6c75 6d6e 735f 7661 6c75 6522 2c20 496e  lumns_value", In
-0000e560: 6465 7856 616c 7565 290a 2020 2020 5f63  dexValue).    _c
-0000e570: 6875 6e6b 7320 3d20 4c69 7374 4669 656c  hunks = ListFiel
-0000e580: 6428 0a20 2020 2020 2020 2022 6368 756e  d(.        "chun
-0000e590: 6b73 222c 0a20 2020 2020 2020 2046 6965  ks",.        Fie
-0000e5a0: 6c64 5479 7065 732e 7265 6665 7265 6e63  ldTypes.referenc
-0000e5b0: 6528 4461 7461 4672 616d 6543 6875 6e6b  e(DataFrameChunk
-0000e5c0: 4461 7461 292c 0a20 2020 2020 2020 206f  Data),.        o
-0000e5d0: 6e5f 7365 7269 616c 697a 653d 6c61 6d62  n_serialize=lamb
-0000e5e0: 6461 2078 3a20 5b69 742e 6461 7461 2066  da x: [it.data f
-0000e5f0: 6f72 2069 7420 696e 2078 5d20 6966 2078  or it in x] if x
-0000e600: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
-0000e610: 6520 782c 0a20 2020 2020 2020 206f 6e5f  e x,.        on_
-0000e620: 6465 7365 7269 616c 697a 653d 6c61 6d62  deserialize=lamb
-0000e630: 6461 2078 3a20 5b44 6174 6146 7261 6d65  da x: [DataFrame
-0000e640: 4368 756e 6b28 6974 2920 666f 7220 6974  Chunk(it) for it
-0000e650: 2069 6e20 785d 0a20 2020 2020 2020 2069   in x].        i
-0000e660: 6620 7820 6973 206e 6f74 204e 6f6e 650a  f x is not None.
-0000e670: 2020 2020 2020 2020 656c 7365 2078 2c0a          else x,.
-0000e680: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
-0000e690: 5f69 6e69 745f 5f28 0a20 2020 2020 2020  _init__(.       
-0000e6a0: 2073 656c 662c 0a20 2020 2020 2020 206f   self,.        o
-0000e6b0: 703d 4e6f 6e65 2c0a 2020 2020 2020 2020  p=None,.        
-0000e6c0: 7368 6170 653d 4e6f 6e65 2c0a 2020 2020  shape=None,.    
-0000e6d0: 2020 2020 6e73 706c 6974 733d 4e6f 6e65      nsplits=None
-0000e6e0: 2c0a 2020 2020 2020 2020 6474 7970 6573  ,.        dtypes
-0000e6f0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2069  =None,.        i
-0000e700: 6e64 6578 5f76 616c 7565 3d4e 6f6e 652c  ndex_value=None,
-0000e710: 0a20 2020 2020 2020 2063 6f6c 756d 6e73  .        columns
-0000e720: 5f76 616c 7565 3d4e 6f6e 652c 0a20 2020  _value=None,.   
-0000e730: 2020 2020 2063 6875 6e6b 733d 4e6f 6e65       chunks=None
-0000e740: 2c0a 2020 2020 2020 2020 2a2a 6b77 2c0a  ,.        **kw,.
-0000e750: 2020 2020 293a 0a20 2020 2020 2020 2073      ):.        s
-0000e760: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
-0000e770: 0a20 2020 2020 2020 2020 2020 205f 6f70  .            _op
-0000e780: 3d6f 702c 0a20 2020 2020 2020 2020 2020  =op,.           
-0000e790: 205f 7368 6170 653d 7368 6170 652c 0a20   _shape=shape,. 
-0000e7a0: 2020 2020 2020 2020 2020 205f 6e73 706c             _nspl
-0000e7b0: 6974 733d 6e73 706c 6974 732c 0a20 2020  its=nsplits,.   
-0000e7c0: 2020 2020 2020 2020 205f 6474 7970 6573           _dtypes
-0000e7d0: 3d64 7479 7065 732c 0a20 2020 2020 2020  =dtypes,.       
-0000e7e0: 2020 2020 205f 696e 6465 785f 7661 6c75       _index_valu
-0000e7f0: 653d 696e 6465 785f 7661 6c75 652c 0a20  e=index_value,. 
-0000e800: 2020 2020 2020 2020 2020 205f 636f 6c75             _colu
-0000e810: 6d6e 735f 7661 6c75 653d 636f 6c75 6d6e  mns_value=column
-0000e820: 735f 7661 6c75 652c 0a20 2020 2020 2020  s_value,.       
-0000e830: 2020 2020 205f 6368 756e 6b73 3d63 6875       _chunks=chu
-0000e840: 6e6b 732c 0a20 2020 2020 2020 2020 2020  nks,.           
-0000e850: 202a 2a6b 772c 0a20 2020 2020 2020 2029   **kw,.        )
-0000e860: 0a20 2020 2020 2020 2073 656c 662e 5f61  .        self._a
-0000e870: 6363 6573 736f 7273 203d 2064 6963 7428  ccessors = dict(
-0000e880: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
-0000e890: 6474 7970 6573 5f76 616c 7565 203d 204e  dtypes_value = N
-0000e8a0: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
-0000e8b0: 2e5f 6474 7970 6573 5f64 6963 7420 3d20  ._dtypes_dict = 
-0000e8c0: 4e6f 6e65 0a0a 2020 2020 6465 6620 5f5f  None..    def __
-0000e8d0: 6f6e 5f64 6573 6572 6961 6c69 7a65 5f5f  on_deserialize__
-0000e8e0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000e8f0: 7375 7065 7228 292e 5f5f 6f6e 5f64 6573  super().__on_des
-0000e900: 6572 6961 6c69 7a65 5f5f 2829 0a20 2020  erialize__().   
-0000e910: 2020 2020 2073 656c 662e 5f61 6363 6573       self._acces
-0000e920: 736f 7273 203d 2064 6963 7428 290a 2020  sors = dict().  
-0000e930: 2020 2020 2020 7365 6c66 2e5f 6474 7970        self._dtyp
-0000e940: 6573 5f76 616c 7565 203d 204e 6f6e 650a  es_value = None.
-0000e950: 2020 2020 2020 2020 7365 6c66 2e5f 6474          self._dt
-0000e960: 7970 6573 5f64 6963 7420 3d20 4e6f 6e65  ypes_dict = None
-0000e970: 0a0a 2020 2020 6465 6620 5f67 6574 5f70  ..    def _get_p
-0000e980: 6172 616d 7328 7365 6c66 2920 2d3e 2044  arams(self) -> D
-0000e990: 6963 745b 7374 722c 2041 6e79 5d3a 0a20  ict[str, Any]:. 
-0000e9a0: 2020 2020 2020 2023 2070 6172 616d 7320         # params 
-0000e9b0: 7265 7475 726e 2074 6865 2070 726f 7065  return the prope
-0000e9c0: 7274 6965 7320 7768 6963 6820 7573 6566  rties which usef
-0000e9d0: 756c 2074 6f20 7265 6275 696c 6420 6120  ul to rebuild a 
-0000e9e0: 6e65 7720 7469 6c65 6162 6c65 206f 626a  new tileable obj
-0000e9f0: 6563 740a 2020 2020 2020 2020 7265 7475  ect.        retu
-0000ea00: 726e 207b 0a20 2020 2020 2020 2020 2020  rn {.           
-0000ea10: 2022 7368 6170 6522 3a20 7365 6c66 2e73   "shape": self.s
-0000ea20: 6861 7065 2c0a 2020 2020 2020 2020 2020  hape,.          
-0000ea30: 2020 2264 7479 7065 7322 3a20 7365 6c66    "dtypes": self
-0000ea40: 2e64 7479 7065 732c 0a20 2020 2020 2020  .dtypes,.       
-0000ea50: 2020 2020 2022 696e 6465 785f 7661 6c75       "index_valu
-0000ea60: 6522 3a20 7365 6c66 2e69 6e64 6578 5f76  e": self.index_v
-0000ea70: 616c 7565 2c0a 2020 2020 2020 2020 2020  alue,.          
-0000ea80: 2020 2263 6f6c 756d 6e73 5f76 616c 7565    "columns_value
-0000ea90: 223a 2073 656c 662e 636f 6c75 6d6e 735f  ": self.columns_
-0000eaa0: 7661 6c75 652c 0a20 2020 2020 2020 2020  value,.         
-0000eab0: 2020 2022 6474 7970 6573 5f76 616c 7565     "dtypes_value
-0000eac0: 223a 2073 656c 662e 6474 7970 6573 5f76  ": self.dtypes_v
-0000ead0: 616c 7565 2c0a 2020 2020 2020 2020 7d0a  alue,.        }.
-0000eae0: 0a20 2020 2064 6566 205f 7365 745f 7061  .    def _set_pa
-0000eaf0: 7261 6d73 2873 656c 662c 206e 6577 5f70  rams(self, new_p
-0000eb00: 6172 616d 733a 2044 6963 745b 7374 722c  arams: Dict[str,
-0000eb10: 2041 6e79 5d29 3a0a 2020 2020 2020 2020   Any]):.        
-0000eb20: 7061 7261 6d73 203d 206e 6577 5f70 6172  params = new_par
-0000eb30: 616d 732e 636f 7079 2829 0a20 2020 2020  ams.copy().     
-0000eb40: 2020 206e 6577 5f73 6861 7065 203d 2070     new_shape = p
-0000eb50: 6172 616d 732e 706f 7028 2273 6861 7065  arams.pop("shape
-0000eb60: 222c 204e 6f6e 6529 0a20 2020 2020 2020  ", None).       
-0000eb70: 2069 6620 6e65 775f 7368 6170 6520 6973   if new_shape is
-0000eb80: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0000eb90: 2020 2020 2020 2073 656c 662e 5f73 6861         self._sha
-0000eba0: 7065 203d 206e 6577 5f73 6861 7065 0a20  pe = new_shape. 
-0000ebb0: 2020 2020 2020 2069 6e64 6578 5f76 616c         index_val
-0000ebc0: 7565 203d 2070 6172 616d 732e 706f 7028  ue = params.pop(
-0000ebd0: 2269 6e64 6578 5f76 616c 7565 222c 204e  "index_value", N
-0000ebe0: 6f6e 6529 0a20 2020 2020 2020 2069 6620  one).        if 
-0000ebf0: 696e 6465 785f 7661 6c75 6520 6973 206e  index_value is n
-0000ec00: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0000ec10: 2020 2020 2073 656c 662e 5f69 6e64 6578       self._index
-0000ec20: 5f76 616c 7565 203d 2069 6e64 6578 5f76  _value = index_v
-0000ec30: 616c 7565 0a20 2020 2020 2020 2064 7479  alue.        dty
-0000ec40: 7065 7320 3d20 7061 7261 6d73 2e70 6f70  pes = params.pop
-0000ec50: 2822 6474 7970 6573 222c 204e 6f6e 6529  ("dtypes", None)
-0000ec60: 0a20 2020 2020 2020 2069 6620 6474 7970  .        if dtyp
-0000ec70: 6573 2069 7320 6e6f 7420 4e6f 6e65 3a0a  es is not None:.
-0000ec80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000ec90: 2e5f 6474 7970 6573 203d 2064 7479 7065  ._dtypes = dtype
-0000eca0: 730a 2020 2020 2020 2020 636f 6c75 6d6e  s.        column
-0000ecb0: 735f 7661 6c75 6520 3d20 7061 7261 6d73  s_value = params
-0000ecc0: 2e70 6f70 2822 636f 6c75 6d6e 735f 7661  .pop("columns_va
-0000ecd0: 6c75 6522 2c20 4e6f 6e65 290a 2020 2020  lue", None).    
-0000ece0: 2020 2020 6966 2063 6f6c 756d 6e73 5f76      if columns_v
-0000ecf0: 616c 7565 2069 7320 6e6f 7420 4e6f 6e65  alue is not None
-0000ed00: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0000ed10: 6c66 2e5f 636f 6c75 6d6e 735f 7661 6c75  lf._columns_valu
-0000ed20: 6520 3d20 636f 6c75 6d6e 735f 7661 6c75  e = columns_valu
-0000ed30: 650a 2020 2020 2020 2020 6474 7970 6573  e.        dtypes
-0000ed40: 5f76 616c 7565 203d 2070 6172 616d 732e  _value = params.
-0000ed50: 706f 7028 2264 7479 7065 735f 7661 6c75  pop("dtypes_valu
-0000ed60: 6522 2c20 4e6f 6e65 290a 2020 2020 2020  e", None).      
-0000ed70: 2020 6966 2064 7479 7065 735f 7661 6c75    if dtypes_valu
-0000ed80: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-0000ed90: 2020 2020 2020 2020 2020 2069 6620 6474             if dt
-0000eda0: 7970 6573 2069 7320 4e6f 6e65 3a0a 2020  ypes is None:.  
-0000edb0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000edc0: 6c66 2e5f 6474 7970 6573 203d 2064 7479  lf._dtypes = dty
-0000edd0: 7065 735f 7661 6c75 652e 7661 6c75 650a  pes_value.value.
-0000ede0: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-0000edf0: 6f6c 756d 6e73 5f76 616c 7565 2069 7320  olumns_value is 
-0000ee00: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000ee10: 2020 2020 2020 7365 6c66 2e5f 636f 6c75        self._colu
-0000ee20: 6d6e 735f 7661 6c75 6520 3d20 7061 7273  mns_value = pars
-0000ee30: 655f 696e 6465 7828 7365 6c66 2e5f 6474  e_index(self._dt
-0000ee40: 7970 6573 2e69 6e64 6578 2c20 7374 6f72  ypes.index, stor
-0000ee50: 655f 6461 7461 3d54 7275 6529 0a20 2020  e_data=True).   
-0000ee60: 2020 2020 2020 2020 2073 656c 662e 5f64           self._d
-0000ee70: 7479 7065 735f 7661 6c75 6520 3d20 6474  types_value = dt
-0000ee80: 7970 6573 5f76 616c 7565 0a20 2020 2020  ypes_value.     
-0000ee90: 2020 2069 6620 7061 7261 6d73 3a20 2023     if params:  #
-0000eea0: 2070 7261 676d 613a 206e 6f20 636f 7665   pragma: no cove
-0000eeb0: 720a 2020 2020 2020 2020 2020 2020 7261  r.            ra
-0000eec0: 6973 6520 5479 7065 4572 726f 7228 6622  ise TypeError(f"
-0000eed0: 556e 6b6e 6f77 6e20 7061 7261 6d73 3a20  Unknown params: 
-0000eee0: 7b6c 6973 7428 7061 7261 6d73 297d 2229  {list(params)}")
-0000eef0: 0a0a 2020 2020 7061 7261 6d73 203d 2070  ..    params = p
-0000ef00: 726f 7065 7274 7928 5f67 6574 5f70 6172  roperty(_get_par
-0000ef10: 616d 732c 205f 7365 745f 7061 7261 6d73  ams, _set_params
-0000ef20: 290a 0a20 2020 2064 6566 2072 6566 7265  )..    def refre
-0000ef30: 7368 5f70 6172 616d 7328 7365 6c66 293a  sh_params(self):
-0000ef40: 0a20 2020 2020 2020 2023 2072 6566 7265  .        # refre
-0000ef50: 7368 2070 6172 616d 7320 7768 656e 2063  sh params when c
-0000ef60: 6875 6e6b 7320 7570 6461 7465 640a 2020  hunks updated.  
-0000ef70: 2020 2020 2020 7265 6672 6573 685f 7469        refresh_ti
-0000ef80: 6c65 6162 6c65 5f73 6861 7065 2873 656c  leable_shape(sel
-0000ef90: 6629 0a20 2020 2020 2020 2072 6566 7265  f).        refre
-0000efa0: 7368 5f69 6e64 6578 5f76 616c 7565 2873  sh_index_value(s
-0000efb0: 656c 6629 0a20 2020 2020 2020 2072 6566  elf).        ref
-0000efc0: 7265 7368 5f64 7479 7065 7328 7365 6c66  resh_dtypes(self
-0000efd0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0000efe0: 0a20 2020 2064 6566 2064 7479 7065 7328  .    def dtypes(
-0000eff0: 7365 6c66 293a 0a20 2020 2020 2020 2064  self):.        d
-0000f000: 7420 3d20 6765 7461 7474 7228 7365 6c66  t = getattr(self
-0000f010: 2c20 225f 6474 7970 6573 222c 204e 6f6e  , "_dtypes", Non
-0000f020: 6529 0a20 2020 2020 2020 2069 6620 6474  e).        if dt
-0000f030: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000f040: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000f050: 2064 740a 2020 2020 2020 2020 7265 7475   dt.        retu
-0000f060: 726e 2067 6574 6174 7472 2873 656c 662e  rn getattr(self.
-0000f070: 6f70 2c20 2264 7479 7065 7322 2c20 4e6f  op, "dtypes", No
-0000f080: 6e65 290a 0a20 2020 2040 7072 6f70 6572  ne)..    @proper
-0000f090: 7479 0a20 2020 2064 6566 2064 7479 7065  ty.    def dtype
-0000f0a0: 735f 7661 6c75 6528 7365 6c66 293a 0a20  s_value(self):. 
-0000f0b0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0000f0c0: 6474 7970 6573 5f76 616c 7565 2069 7320  dtypes_value is 
-0000f0d0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0000f0e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000f0f0: 662e 5f64 7479 7065 735f 7661 6c75 650a  f._dtypes_value.
-0000f100: 2020 2020 2020 2020 2320 544f 444f 2871          # TODO(q
-0000f110: 696e 7875 7965 293a 2077 6865 6e20 6372  inxuye): when cr
-0000f120: 6561 7469 6e67 2044 6174 6166 7261 6d65  eating Dataframe
-0000f130: 2c0a 2020 2020 2020 2020 2320 2064 7479  ,.        #  dty
-0000f140: 7065 735f 7661 6c75 6520 696e 7374 6561  pes_value instea
-0000f150: 6420 6f66 2064 7479 7065 7320 6c61 7465  d of dtypes late
-0000f160: 7220 6d75 7374 2062 6520 7061 7373 6564  r must be passed
-0000f170: 2069 6e74 6f0a 2020 2020 2020 2020 6474   into.        dt
-0000f180: 7970 6573 203d 2073 656c 662e 6474 7970  ypes = self.dtyp
-0000f190: 6573 0a20 2020 2020 2020 2069 6620 6474  es.        if dt
-0000f1a0: 7970 6573 2069 7320 6e6f 7420 4e6f 6e65  ypes is not None
-0000f1b0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0000f1c0: 6c66 2e5f 6474 7970 6573 5f76 616c 7565  lf._dtypes_value
-0000f1d0: 203d 2044 7479 7065 7356 616c 7565 286b   = DtypesValue(k
-0000f1e0: 6579 3d74 6f6b 656e 697a 6528 6474 7970  ey=tokenize(dtyp
-0000f1f0: 6573 292c 2076 616c 7565 3d64 7479 7065  es), value=dtype
-0000f200: 7329 0a20 2020 2020 2020 2020 2020 2072  s).            r
-0000f210: 6574 7572 6e20 7365 6c66 2e5f 6474 7970  eturn self._dtyp
-0000f220: 6573 5f76 616c 7565 0a0a 2020 2020 4070  es_value..    @p
-0000f230: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0000f240: 696e 6465 785f 7661 6c75 6528 7365 6c66  index_value(self
-0000f250: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0000f260: 6e20 7365 6c66 2e5f 696e 6465 785f 7661  n self._index_va
-0000f270: 6c75 650a 0a20 2020 2040 7072 6f70 6572  lue..    @proper
-0000f280: 7479 0a20 2020 2064 6566 2063 6f6c 756d  ty.    def colum
-0000f290: 6e73 5f76 616c 7565 2873 656c 6629 3a0a  ns_value(self):.
-0000f2a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000f2b0: 656c 662e 5f63 6f6c 756d 6e73 5f76 616c  elf._columns_val
-0000f2c0: 7565 0a0a 2020 2020 4070 726f 7065 7274  ue..    @propert
-0000f2d0: 790a 2020 2020 6465 6620 656d 7074 7928  y.    def empty(
-0000f2e0: 7365 6c66 293a 0a20 2020 2020 2020 2073  self):.        s
-0000f2f0: 6861 7065 203d 2067 6574 6174 7472 2873  hape = getattr(s
-0000f300: 656c 662c 2022 5f73 6861 7065 2229 0a20  elf, "_shape"). 
-0000f310: 2020 2020 2020 2069 6620 6e70 2e61 6e79         if np.any
-0000f320: 286e 702e 6973 6e61 6e28 7368 6170 6529  (np.isnan(shape)
-0000f330: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0000f340: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0000f350: 2254 696c 6561 626c 6520 6f62 6a65 6374  "Tileable object
-0000f360: 206d 7573 7420 6265 2065 7865 6375 7465   must be execute
-0000f370: 6420 6669 7273 7422 290a 2020 2020 2020  d first").      
-0000f380: 2020 7265 7475 726e 2030 2069 6e20 7368    return 0 in sh
-0000f390: 6170 650a 0a20 2020 2064 6566 2074 6f5f  ape..    def to_
-0000f3a0: 7465 6e73 6f72 2873 656c 662c 2064 7479  tensor(self, dty
-0000f3b0: 7065 3d4e 6f6e 6529 3a0a 2020 2020 2020  pe=None):.      
-0000f3c0: 2020 6672 6f6d 202e 2e74 656e 736f 722e    from ..tensor.
-0000f3d0: 6461 7461 736f 7572 6365 2e66 726f 6d5f  datasource.from_
-0000f3e0: 6461 7461 6672 616d 6520 696d 706f 7274  dataframe import
-0000f3f0: 2066 726f 6d5f 6461 7461 6672 616d 650a   from_dataframe.
-0000f400: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000f410: 6672 6f6d 5f64 6174 6166 7261 6d65 2873  from_dataframe(s
-0000f420: 656c 662c 2064 7479 7065 3d64 7479 7065  elf, dtype=dtype
-0000f430: 290a 0a20 2020 2040 7374 6174 6963 6d65  )..    @staticme
-0000f440: 7468 6f64 0a20 2020 2064 6566 2066 726f  thod.    def fro
-0000f450: 6d5f 7465 6e73 6f72 2869 6e5f 7465 6e73  m_tensor(in_tens
-0000f460: 6f72 2c20 696e 6465 783d 4e6f 6e65 2c20  or, index=None, 
-0000f470: 636f 6c75 6d6e 733d 4e6f 6e65 293a 0a20  columns=None):. 
-0000f480: 2020 2020 2020 2066 726f 6d20 2e64 6174         from .dat
-0000f490: 6173 6f75 7263 652e 6672 6f6d 5f74 656e  asource.from_ten
-0000f4a0: 736f 7220 696d 706f 7274 2064 6174 6166  sor import dataf
-0000f4b0: 7261 6d65 5f66 726f 6d5f 7465 6e73 6f72  rame_from_tensor
-0000f4c0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000f4d0: 2064 6174 6166 7261 6d65 5f66 726f 6d5f   dataframe_from_
-0000f4e0: 7465 6e73 6f72 2869 6e5f 7465 6e73 6f72  tensor(in_tensor
-0000f4f0: 2c20 696e 6465 783d 696e 6465 782c 2063  , index=index, c
-0000f500: 6f6c 756d 6e73 3d63 6f6c 756d 6e73 290a  olumns=columns).
-0000f510: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0000f520: 6f64 0a20 2020 2064 6566 2066 726f 6d5f  od.    def from_
-0000f530: 7265 636f 7264 7328 7265 636f 7264 732c  records(records,
-0000f540: 202a 2a6b 7729 3a0a 2020 2020 2020 2020   **kw):.        
-0000f550: 6672 6f6d 202e 6461 7461 736f 7572 6365  from .datasource
-0000f560: 2e66 726f 6d5f 7265 636f 7264 7320 696d  .from_records im
-0000f570: 706f 7274 2066 726f 6d5f 7265 636f 7264  port from_record
-0000f580: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
-0000f590: 6e20 6672 6f6d 5f72 6563 6f72 6473 2872  n from_records(r
-0000f5a0: 6563 6f72 6473 2c20 2a2a 6b77 290a 0a20  ecords, **kw).. 
-0000f5b0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000f5c0: 2064 6566 2069 6e64 6578 2873 656c 6629   def index(self)
-0000f5d0: 3a0a 2020 2020 2020 2020 6672 6f6d 202e  :.        from .
-0000f5e0: 6461 7461 736f 7572 6365 2e69 6e64 6578  datasource.index
-0000f5f0: 2069 6d70 6f72 7420 6672 6f6d 5f74 696c   import from_til
-0000f600: 6561 626c 650a 0a20 2020 2020 2020 2072  eable..        r
-0000f610: 6574 7572 6e20 6672 6f6d 5f74 696c 6561  eturn from_tilea
-0000f620: 626c 6528 7365 6c66 290a 0a20 2020 2040  ble(self)..    @
-0000f630: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0000f640: 2063 6f6c 756d 6e73 2873 656c 6629 3a0a   columns(self):.
-0000f650: 2020 2020 2020 2020 6672 6f6d 202e 6461          from .da
-0000f660: 7461 736f 7572 6365 2e69 6e64 6578 2069  tasource.index i
-0000f670: 6d70 6f72 7420 6672 6f6d 5f70 616e 6461  mport from_panda
-0000f680: 7320 6173 2066 726f 6d5f 7061 6e64 6173  s as from_pandas
-0000f690: 5f69 6e64 6578 0a0a 2020 2020 2020 2020  _index..        
-0000f6a0: 7265 7475 726e 2066 726f 6d5f 7061 6e64  return from_pand
-0000f6b0: 6173 5f69 6e64 6578 2873 656c 662e 6474  as_index(self.dt
-0000f6c0: 7970 6573 2e69 6e64 6578 2c20 7374 6f72  ypes.index, stor
-0000f6d0: 655f 6461 7461 3d54 7275 6529 0a0a 2020  e_data=True)..  
-0000f6e0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0000f6f0: 6465 6620 6178 6573 2873 656c 6629 3a0a  def axes(self):.
-0000f700: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-0000f710: 7365 6c66 2e69 6e64 6578 2c20 7365 6c66  self.index, self
-0000f720: 2e63 6f6c 756d 6e73 5d0a 0a20 2020 2064  .columns]..    d
-0000f730: 6566 205f 6765 745f 6474 7970 6573 5f64  ef _get_dtypes_d
-0000f740: 6963 7428 7365 6c66 293a 0a20 2020 2020  ict(self):.     
-0000f750: 2020 2069 6620 7365 6c66 2e5f 6474 7970     if self._dtyp
-0000f760: 6573 5f64 6963 7420 6973 204e 6f6e 653a  es_dict is None:
-0000f770: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000f780: 662e 5f64 7479 7065 735f 6469 6374 203d  f._dtypes_dict =
-0000f790: 2064 203d 2064 6963 7428 290a 2020 2020   d = dict().    
-0000f7a0: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
-0000f7b0: 2069 6e20 7365 6c66 2e64 7479 7065 732e   in self.dtypes.
-0000f7c0: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-0000f7d0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-0000f7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f7f0: 2020 6f62 6a5f 6c69 7374 203d 2064 5b6b    obj_list = d[k
-0000f800: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0000f810: 2020 6578 6365 7074 204b 6579 4572 726f    except KeyErro
-0000f820: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
-0000f830: 2020 2020 2020 206f 626a 5f6c 6973 7420         obj_list 
-0000f840: 3d20 645b 6b5d 203d 205b 5d0a 2020 2020  = d[k] = [].    
-0000f850: 2020 2020 2020 2020 2020 2020 6f62 6a5f              obj_
-0000f860: 6c69 7374 2e61 7070 656e 6428 7629 0a20  list.append(v). 
-0000f870: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000f880: 6c66 2e5f 6474 7970 6573 5f64 6963 740a  lf._dtypes_dict.
-0000f890: 0a20 2020 2064 6566 205f 6765 745f 6474  .    def _get_dt
-0000f8a0: 7970 6573 5f62 795f 636f 6c75 6d6e 7328  ypes_by_columns(
-0000f8b0: 7365 6c66 2c20 636f 6c75 6d6e 733a 206c  self, columns: l
-0000f8c0: 6973 7429 3a0a 2020 2020 2020 2020 6474  ist):.        dt
-0000f8d0: 7970 6573 5f64 6963 7420 3d20 7365 6c66  ypes_dict = self
-0000f8e0: 2e5f 6765 745f 6474 7970 6573 5f64 6963  ._get_dtypes_dic
-0000f8f0: 7428 290a 2020 2020 2020 2020 7265 7475  t().        retu
-0000f900: 726e 2066 756e 6374 6f6f 6c73 2e72 6564  rn functools.red
-0000f910: 7563 6528 6f70 6572 6174 6f72 2e61 6464  uce(operator.add
-0000f920: 2c20 2864 7479 7065 735f 6469 6374 5b63  , (dtypes_dict[c
-0000f930: 5d20 666f 7220 6320 696e 2063 6f6c 756d  ] for c in colum
-0000f940: 6e73 292c 205b 5d29 0a0a 2020 2020 6465  ns), [])..    de
-0000f950: 6620 5f67 6574 5f63 6f6c 756d 6e73 5f62  f _get_columns_b
-0000f960: 795f 636f 6c75 6d6e 7328 7365 6c66 2c20  y_columns(self, 
-0000f970: 636f 6c75 6d6e 733a 206c 6973 7429 3a0a  columns: list):.
-0000f980: 2020 2020 2020 2020 6474 7970 6573 5f64          dtypes_d
-0000f990: 6963 7420 3d20 7365 6c66 2e5f 6765 745f  ict = self._get_
-0000f9a0: 6474 7970 6573 5f64 6963 7428 290a 2020  dtypes_dict().  
-0000f9b0: 2020 2020 2020 7265 7475 726e 2066 756e        return fun
-0000f9c0: 6374 6f6f 6c73 2e72 6564 7563 6528 0a20  ctools.reduce(. 
-0000f9d0: 2020 2020 2020 2020 2020 206f 7065 7261             opera
-0000f9e0: 746f 722e 6164 642c 2028 5b63 5d20 2a20  tor.add, ([c] * 
-0000f9f0: 6c65 6e28 6474 7970 6573 5f64 6963 745b  len(dtypes_dict[
-0000fa00: 635d 2920 666f 7220 6320 696e 2063 6f6c  c]) for c in col
-0000fa10: 756d 6e73 292c 205b 5d0a 2020 2020 2020  umns), [].      
-0000fa20: 2020 290a 0a0a 636c 6173 7320 4461 7461    )...class Data
-0000fa30: 4672 616d 6544 6174 6128 5f42 6174 6368  FrameData(_Batch
-0000fa40: 6564 4665 7463 6865 722c 2042 6173 6544  edFetcher, BaseD
-0000fa50: 6174 6146 7261 6d65 4461 7461 293a 0a20  ataFrameData):. 
-0000fa60: 2020 2074 7970 655f 6e61 6d65 203d 2022     type_name = "
-0000fa70: 4461 7461 4672 616d 6522 0a0a 2020 2020  DataFrame"..    
-0000fa80: 6465 6620 5f74 6f5f 7374 7228 7365 6c66  def _to_str(self
-0000fa90: 2c20 7265 7072 6573 656e 7461 7469 6f6e  , representation
-0000faa0: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
-0000fab0: 2069 6620 6973 5f62 7569 6c64 5f6d 6f64   if is_build_mod
-0000fac0: 6528 2920 6f72 206c 656e 2873 656c 662e  e() or len(self.
-0000fad0: 5f65 7865 6375 7465 645f 7365 7373 696f  _executed_sessio
-0000fae0: 6e73 2920 3d3d 2030 3a0a 2020 2020 2020  ns) == 0:.      
-0000faf0: 2020 2020 2020 2320 696e 2062 7569 6c64        # in build
-0000fb00: 206d 6f64 652c 206f 7220 6e6f 7420 6578   mode, or not ex
-0000fb10: 6563 7574 6564 2c20 6a75 7374 2072 6574  ecuted, just ret
-0000fb20: 7572 6e20 7265 7072 6573 656e 7461 7469  urn representati
-0000fb30: 6f6e 0a20 2020 2020 2020 2020 2020 2069  on.            i
-0000fb40: 6620 7265 7072 6573 656e 7461 7469 6f6e  f representation
-0000fb50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000fb60: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
-0000fb70: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000fb80: 227b 7365 6c66 2e74 7970 655f 6e61 6d65  "{self.type_name
-0000fb90: 7d20 3c6f 703d 7b74 7970 6528 7365 6c66  } <op={type(self
-0000fba0: 2e5f 6f70 292e 5f5f 6e61 6d65 5f5f 7d2c  ._op).__name__},
-0000fbb0: 206b 6579 3d7b 7365 6c66 2e6b 6579 7d3e   key={self.key}>
-0000fbc0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000fbd0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000fbe0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000fbf0: 2020 2020 2020 7265 7475 726e 2066 227b        return f"{
-0000fc00: 7365 6c66 2e74 7970 655f 6e61 6d65 7d28  self.type_name}(
-0000fc10: 6f70 3d7b 7479 7065 2873 656c 662e 5f6f  op={type(self._o
-0000fc20: 7029 2e5f 5f6e 616d 655f 5f7d 2922 0a20  p).__name__})". 
-0000fc30: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000fc40: 2020 2020 2020 2020 2063 6f72 6e65 725f           corner_
-0000fc50: 6461 7461 203d 2066 6574 6368 5f63 6f72  data = fetch_cor
-0000fc60: 6e65 725f 6461 7461 2873 656c 662c 2073  ner_data(self, s
-0000fc70: 6573 7369 6f6e 3d73 656c 662e 5f65 7865  ession=self._exe
-0000fc80: 6375 7465 645f 7365 7373 696f 6e73 5b2d  cuted_sessions[-
-0000fc90: 315d 290a 0a20 2020 2020 2020 2020 2020  1])..           
-0000fca0: 2062 7566 203d 2053 7472 696e 6749 4f28   buf = StringIO(
-0000fcb0: 290a 2020 2020 2020 2020 2020 2020 6d61  ).            ma
-0000fcc0: 785f 726f 7773 203d 2070 642e 6765 745f  x_rows = pd.get_
-0000fcd0: 6f70 7469 6f6e 2822 6469 7370 6c61 792e  option("display.
-0000fce0: 6d61 785f 726f 7773 2229 0a0a 2020 2020  max_rows")..    
-0000fcf0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000fd00: 7368 6170 655b 305d 203c 3d20 6d61 785f  shape[0] <= max_
-0000fd10: 726f 7773 3a0a 2020 2020 2020 2020 2020  rows:.          
-0000fd20: 2020 2020 2020 6275 662e 7772 6974 6528        buf.write(
-0000fd30: 7265 7072 2863 6f72 6e65 725f 6461 7461  repr(corner_data
-0000fd40: 2920 6966 2072 6570 7265 7365 6e74 6174  ) if representat
-0000fd50: 696f 6e20 656c 7365 2073 7472 2863 6f72  ion else str(cor
-0000fd60: 6e65 725f 6461 7461 2929 0a20 2020 2020  ner_data)).     
-0000fd70: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000fd80: 2020 2020 2020 2020 2020 2020 2023 2072               # r
-0000fd90: 656d 656d 6265 7220 7765 2063 616e 6e6f  emember we canno
-0000fda0: 7420 6469 7265 6374 6c79 2063 616c 6c20  t directly call 
-0000fdb0: 7265 7072 2864 6629 2c0a 2020 2020 2020  repr(df),.      
-0000fdc0: 2020 2020 2020 2020 2020 2320 6265 6361            # beca
-0000fdd0: 7573 6520 7468 6520 5b2e 2e2e 2072 6f77  use the [... row
-0000fde0: 7320 7820 2e2e 2e20 636f 6c75 6d6e 735d  s x ... columns]
-0000fdf0: 206d 6179 2073 686f 7720 7772 6f6e 6720   may show wrong 
-0000fe00: 726f 7773 0a20 2020 2020 2020 2020 2020  rows.           
-0000fe10: 2020 2020 2077 6974 6820 7064 2e6f 7074       with pd.opt
-0000fe20: 696f 6e5f 636f 6e74 6578 7428 0a20 2020  ion_context(.   
-0000fe30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fe40: 2022 6469 7370 6c61 792e 7368 6f77 5f64   "display.show_d
-0000fe50: 696d 656e 7369 6f6e 7322 2c0a 2020 2020  imensions",.    
-0000fe60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fe70: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-0000fe80: 2020 2020 2020 2020 2020 2022 6469 7370             "disp
-0000fe90: 6c61 792e 6d61 785f 726f 7773 222c 0a20  lay.max_rows",. 
-0000fea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000feb0: 2020 2063 6f72 6e65 725f 6461 7461 2e73     corner_data.s
-0000fec0: 6861 7065 5b30 5d20 2d20 312c 0a20 2020  hape[0] - 1,.   
-0000fed0: 2020 2020 2020 2020 2020 2020 2029 3a0a               ):.
-0000fee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fef0: 2020 2020 6966 2072 6570 7265 7365 6e74      if represent
-0000ff00: 6174 696f 6e3a 0a20 2020 2020 2020 2020  ation:.         
-0000ff10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000ff20: 203d 2072 6570 7228 636f 726e 6572 5f64   = repr(corner_d
-0000ff30: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
-0000ff40: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0000ff50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ff60: 2020 2020 2020 2073 203d 2073 7472 2863         s = str(c
-0000ff70: 6f72 6e65 725f 6461 7461 290a 2020 2020  orner_data).    
-0000ff80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ff90: 6275 662e 7772 6974 6528 7329 0a20 2020  buf.write(s).   
-0000ffa0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000ffb0: 7064 2e67 6574 5f6f 7074 696f 6e28 2264  pd.get_option("d
-0000ffc0: 6973 706c 6179 2e73 686f 775f 6469 6d65  isplay.show_dime
-0000ffd0: 6e73 696f 6e73 2229 3a0a 2020 2020 2020  nsions"):.      
-0000ffe0: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
-0000fff0: 726f 7773 2c20 6e5f 636f 6c73 203d 2073  rows, n_cols = s
-00010000: 656c 662e 7368 6170 650a 2020 2020 2020  elf.shape.      
-00010010: 2020 2020 2020 2020 2020 2020 2020 6275                bu
-00010020: 662e 7772 6974 6528 6622 5c6e 5c6e 5b7b  f.write(f"\n\n[{
-00010030: 6e5f 726f 7773 7d20 726f 7773 2078 207b  n_rows} rows x {
-00010040: 6e5f 636f 6c73 7d20 636f 6c75 6d6e 735d  n_cols} columns]
-00010050: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
-00010060: 7265 7475 726e 2062 7566 2e67 6574 7661  return buf.getva
-00010070: 6c75 6528 290a 0a20 2020 2064 6566 205f  lue()..    def _
-00010080: 5f73 7472 5f5f 2873 656c 6629 3a0a 2020  _str__(self):.  
-00010090: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000100a0: 662e 5f74 6f5f 7374 7228 7265 7072 6573  f._to_str(repres
-000100b0: 656e 7461 7469 6f6e 3d46 616c 7365 290a  entation=False).
-000100c0: 0a20 2020 2064 6566 205f 5f72 6570 725f  .    def __repr_
-000100d0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-000100e0: 2072 6574 7572 6e20 7365 6c66 2e5f 746f   return self._to
-000100f0: 5f73 7472 2872 6570 7265 7365 6e74 6174  _str(representat
-00010100: 696f 6e3d 5472 7565 290a 0a20 2020 2064  ion=True)..    d
-00010110: 6566 205f 5f6d 6172 735f 7465 6e73 6f72  ef __mars_tensor
-00010120: 5f5f 2873 656c 662c 2064 7479 7065 3d4e  __(self, dtype=N
-00010130: 6f6e 652c 206f 7264 6572 3d22 4b22 293a  one, order="K"):
-00010140: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00010150: 7365 6c66 2e74 6f5f 7465 6e73 6f72 2829  self.to_tensor()
-00010160: 2e61 7374 7970 6528 6474 7970 653d 6474  .astype(dtype=dt
-00010170: 7970 652c 206f 7264 6572 3d6f 7264 6572  ype, order=order
-00010180: 2c20 636f 7079 3d46 616c 7365 290a 0a20  , copy=False).. 
-00010190: 2020 2064 6566 205f 7265 7072 5f68 746d     def _repr_htm
-000101a0: 6c5f 2873 656c 6629 3a0a 2020 2020 2020  l_(self):.      
-000101b0: 2020 6966 206c 656e 2873 656c 662e 5f65    if len(self._e
-000101c0: 7865 6375 7465 645f 7365 7373 696f 6e73  xecuted_sessions
-000101d0: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
-000101e0: 2020 2020 2320 6e6f 7420 6578 6563 7574      # not execut
-000101f0: 6564 2062 6566 6f72 652c 2066 616c 6c20  ed before, fall 
-00010200: 6261 636b 2074 6f20 6e6f 726d 616c 2072  back to normal r
-00010210: 6570 720a 2020 2020 2020 2020 2020 2020  epr.            
-00010220: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00010230: 6e74 6564 4572 726f 720a 0a20 2020 2020  ntedError..     
-00010240: 2020 2063 6f72 6e65 725f 6461 7461 203d     corner_data =
-00010250: 2066 6574 6368 5f63 6f72 6e65 725f 6461   fetch_corner_da
-00010260: 7461 2873 656c 662c 2073 6573 7369 6f6e  ta(self, session
-00010270: 3d73 656c 662e 5f65 7865 6375 7465 645f  =self._executed_
-00010280: 7365 7373 696f 6e73 5b2d 315d 290a 0a20  sessions[-1]).. 
-00010290: 2020 2020 2020 2062 7566 203d 2053 7472         buf = Str
-000102a0: 696e 6749 4f28 290a 2020 2020 2020 2020  ingIO().        
-000102b0: 6d61 785f 726f 7773 203d 2070 642e 6765  max_rows = pd.ge
-000102c0: 745f 6f70 7469 6f6e 2822 6469 7370 6c61  t_option("displa
-000102d0: 792e 6d61 785f 726f 7773 2229 0a20 2020  y.max_rows").   
-000102e0: 2020 2020 2069 6620 7365 6c66 2e73 6861       if self.sha
-000102f0: 7065 5b30 5d20 3c3d 206d 6178 5f72 6f77  pe[0] <= max_row
-00010300: 733a 0a20 2020 2020 2020 2020 2020 2062  s:.            b
-00010310: 7566 2e77 7269 7465 2863 6f72 6e65 725f  uf.write(corner_
-00010320: 6461 7461 2e5f 7265 7072 5f68 746d 6c5f  data._repr_html_
-00010330: 2829 290a 2020 2020 2020 2020 656c 7365  ()).        else
-00010340: 3a0a 2020 2020 2020 2020 2020 2020 7769  :.            wi
-00010350: 7468 2070 642e 6f70 7469 6f6e 5f63 6f6e  th pd.option_con
-00010360: 7465 7874 280a 2020 2020 2020 2020 2020  text(.          
-00010370: 2020 2020 2020 2264 6973 706c 6179 2e73        "display.s
-00010380: 686f 775f 6469 6d65 6e73 696f 6e73 222c  how_dimensions",
-00010390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000103a0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-000103b0: 2020 2020 2020 2020 2264 6973 706c 6179          "display
-000103c0: 2e6d 6178 5f72 6f77 7322 2c0a 2020 2020  .max_rows",.    
-000103d0: 2020 2020 2020 2020 2020 2020 636f 726e              corn
-000103e0: 6572 5f64 6174 612e 7368 6170 655b 305d  er_data.shape[0]
-000103f0: 202d 2031 2c0a 2020 2020 2020 2020 2020   - 1,.          
-00010400: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-00010410: 2020 2020 2062 7566 2e77 7269 7465 2863       buf.write(c
-00010420: 6f72 6e65 725f 6461 7461 2e5f 7265 7072  orner_data._repr
-00010430: 5f68 746d 6c5f 2829 2e72 7374 7269 7028  _html_().rstrip(
-00010440: 292e 7273 7472 6970 2822 3c2f 6469 763e  ).rstrip("</div>
-00010450: 2229 290a 2020 2020 2020 2020 2020 2020  ")).            
-00010460: 6966 2070 642e 6765 745f 6f70 7469 6f6e  if pd.get_option
-00010470: 2822 6469 7370 6c61 792e 7368 6f77 5f64  ("display.show_d
-00010480: 696d 656e 7369 6f6e 7322 293a 0a20 2020  imensions"):.   
-00010490: 2020 2020 2020 2020 2020 2020 206e 5f72               n_r
-000104a0: 6f77 732c 206e 5f63 6f6c 7320 3d20 7365  ows, n_cols = se
-000104b0: 6c66 2e73 6861 7065 0a20 2020 2020 2020  lf.shape.       
-000104c0: 2020 2020 2020 2020 2062 7566 2e77 7269           buf.wri
-000104d0: 7465 2866 223c 703e 7b6e 5f72 6f77 737d  te(f"<p>{n_rows}
-000104e0: 2072 6f77 7320 c397 207b 6e5f 636f 6c73   rows .. {n_cols
-000104f0: 7d20 636f 6c75 6d6e 733c 2f70 3e5c 6e22  } columns</p>\n"
-00010500: 290a 2020 2020 2020 2020 2020 2020 6275  ).            bu
-00010510: 662e 7772 6974 6528 223c 2f64 6976 3e22  f.write("</div>"
-00010520: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00010530: 6e20 6275 662e 6765 7476 616c 7565 2829  n buf.getvalue()
-00010540: 0a0a 2020 2020 6465 6620 6974 656d 7328  ..    def items(
-00010550: 7365 6c66 293a 0a20 2020 2020 2020 2066  self):.        f
-00010560: 6f72 2063 6f6c 5f6e 616d 6520 696e 2073  or col_name in s
-00010570: 656c 662e 6474 7970 6573 2e69 6e64 6578  elf.dtypes.index
-00010580: 3a0a 2020 2020 2020 2020 2020 2020 7969  :.            yi
-00010590: 656c 6420 636f 6c5f 6e61 6d65 2c20 7365  eld col_name, se
-000105a0: 6c66 5b63 6f6c 5f6e 616d 655d 0a0a 2020  lf[col_name]..  
-000105b0: 2020 6974 6572 6974 656d 7320 3d20 6974    iteritems = it
-000105c0: 656d 730a 0a20 2020 2064 6566 2069 7465  ems..    def ite
-000105d0: 7272 6f77 7328 7365 6c66 2c20 6261 7463  rrows(self, batc
-000105e0: 685f 7369 7a65 3d31 3030 302c 2073 6573  h_size=1000, ses
-000105f0: 7369 6f6e 3d4e 6f6e 6529 3a0a 2020 2020  sion=None):.    
-00010600: 2020 2020 666f 7220 6261 7463 685f 6461      for batch_da
-00010610: 7461 2069 6e20 7365 6c66 2e69 7465 7262  ta in self.iterb
-00010620: 6174 6368 2862 6174 6368 5f73 697a 653d  atch(batch_size=
-00010630: 6261 7463 685f 7369 7a65 2c20 7365 7373  batch_size, sess
-00010640: 696f 6e3d 7365 7373 696f 6e29 3a0a 2020  ion=session):.  
-00010650: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
-00010660: 6672 6f6d 2067 6574 6174 7472 2862 6174  from getattr(bat
-00010670: 6368 5f64 6174 612c 2022 6974 6572 726f  ch_data, "iterro
-00010680: 7773 2229 2829 0a0a 2020 2020 6465 6620  ws")()..    def 
-00010690: 6974 6572 7475 706c 6573 2873 656c 662c  itertuples(self,
-000106a0: 2069 6e64 6578 3d54 7275 652c 206e 616d   index=True, nam
-000106b0: 653d 2250 616e 6461 7322 2c20 6261 7463  e="Pandas", batc
-000106c0: 685f 7369 7a65 3d31 3030 302c 2073 6573  h_size=1000, ses
-000106d0: 7369 6f6e 3d4e 6f6e 6529 3a0a 2020 2020  sion=None):.    
-000106e0: 2020 2020 666f 7220 6261 7463 685f 6461      for batch_da
-000106f0: 7461 2069 6e20 7365 6c66 2e69 7465 7262  ta in self.iterb
-00010700: 6174 6368 2862 6174 6368 5f73 697a 653d  atch(batch_size=
-00010710: 6261 7463 685f 7369 7a65 2c20 7365 7373  batch_size, sess
-00010720: 696f 6e3d 7365 7373 696f 6e29 3a0a 2020  ion=session):.  
-00010730: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
-00010740: 6672 6f6d 2067 6574 6174 7472 2862 6174  from getattr(bat
-00010750: 6368 5f64 6174 612c 2022 6974 6572 7475  ch_data, "itertu
-00010760: 706c 6573 2229 2869 6e64 6578 3d69 6e64  ples")(index=ind
-00010770: 6578 2c20 6e61 6d65 3d6e 616d 6529 0a0a  ex, name=name)..
-00010780: 2020 2020 6465 6620 5f6e 6565 645f 6578      def _need_ex
-00010790: 6563 7574 696f 6e28 7365 6c66 293a 0a20  ecution(self):. 
-000107a0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-000107b0: 6474 7970 6573 2069 7320 4e6f 6e65 3a0a  dtypes is None:.
-000107c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000107d0: 726e 2054 7275 650a 2020 2020 2020 2020  rn True.        
-000107e0: 7265 7475 726e 2046 616c 7365 0a0a 0a63  return False...c
-000107f0: 6c61 7373 2044 6174 6146 7261 6d65 2848  lass DataFrame(H
-00010800: 6173 5368 6170 6554 696c 6561 626c 652c  asShapeTileable,
-00010810: 205f 546f 5061 6e64 6173 4d69 7869 6e29   _ToPandasMixin)
-00010820: 3a0a 2020 2020 5f5f 736c 6f74 735f 5f20  :.    __slots__ 
-00010830: 3d20 2822 5f63 6163 6865 222c 290a 2020  = ("_cache",).  
-00010840: 2020 5f61 6c6c 6f77 5f64 6174 615f 7479    _allow_data_ty
-00010850: 7065 5f20 3d20 2844 6174 6146 7261 6d65  pe_ = (DataFrame
-00010860: 4461 7461 2c29 0a20 2020 2074 7970 655f  Data,).    type_
-00010870: 6e61 6d65 203d 2022 4461 7461 4672 616d  name = "DataFram
-00010880: 6522 0a0a 2020 2020 6465 6620 5f5f 6c65  e"..    def __le
-00010890: 6e5f 5f28 7365 6c66 293a 0a20 2020 2020  n__(self):.     
-000108a0: 2020 2072 6574 7572 6e20 6c65 6e28 7365     return len(se
-000108b0: 6c66 2e5f 6461 7461 290a 0a20 2020 2064  lf._data)..    d
-000108c0: 6566 2074 6f5f 7465 6e73 6f72 2873 656c  ef to_tensor(sel
-000108d0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-000108e0: 726e 2073 656c 662e 5f64 6174 612e 746f  rn self._data.to
-000108f0: 5f74 656e 736f 7228 290a 0a20 2020 2064  _tensor()..    d
-00010900: 6566 2066 726f 6d5f 7465 6e73 6f72 2873  ef from_tensor(s
-00010910: 656c 662c 2069 6e5f 7465 6e73 6f72 2c20  elf, in_tensor, 
-00010920: 696e 6465 783d 4e6f 6e65 2c20 636f 6c75  index=None, colu
-00010930: 6d6e 733d 4e6f 6e65 293a 0a20 2020 2020  mns=None):.     
-00010940: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00010950: 6461 7461 2e66 726f 6d5f 7465 6e73 6f72  data.from_tensor
-00010960: 2869 6e5f 7465 6e73 6f72 2c20 696e 6465  (in_tensor, inde
-00010970: 783d 696e 6465 782c 2063 6f6c 756d 6e73  x=index, columns
-00010980: 3d63 6f6c 756d 6e73 290a 0a20 2020 2064  =columns)..    d
-00010990: 6566 2066 726f 6d5f 7265 636f 7264 7328  ef from_records(
-000109a0: 7365 6c66 2c20 7265 636f 7264 732c 202a  self, records, *
-000109b0: 2a6b 7729 3a0a 2020 2020 2020 2020 7265  *kw):.        re
-000109c0: 7475 726e 2073 656c 662e 5f64 6174 612e  turn self._data.
-000109d0: 6672 6f6d 5f72 6563 6f72 6473 2872 6563  from_records(rec
-000109e0: 6f72 6473 2c20 2a2a 6b77 290a 0a20 2020  ords, **kw)..   
-000109f0: 2064 6566 205f 5f6d 6172 735f 7465 6e73   def __mars_tens
-00010a00: 6f72 5f5f 2873 656c 662c 2064 7479 7065  or__(self, dtype
-00010a10: 3d4e 6f6e 652c 206f 7264 6572 3d22 4b22  =None, order="K"
-00010a20: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00010a30: 6e20 7365 6c66 2e5f 6461 7461 2e5f 5f6d  n self._data.__m
-00010a40: 6172 735f 7465 6e73 6f72 5f5f 2864 7479  ars_tensor__(dty
-00010a50: 7065 3d64 7479 7065 2c20 6f72 6465 723d  pe=dtype, order=
-00010a60: 6f72 6465 7229 0a0a 2020 2020 6465 6620  order)..    def 
-00010a70: 5f5f 6765 7461 7474 725f 5f28 7365 6c66  __getattr__(self
-00010a80: 2c20 6b65 7929 3a0a 2020 2020 2020 2020  , key):.        
-00010a90: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00010aa0: 2072 6574 7572 6e20 6765 7461 7474 7228   return getattr(
-00010ab0: 7365 6c66 2e5f 6461 7461 2c20 6b65 7929  self._data, key)
-00010ac0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00010ad0: 4174 7472 6962 7574 6545 7272 6f72 3a0a  AttributeError:.
-00010ae0: 2020 2020 2020 2020 2020 2020 6966 206b              if k
-00010af0: 6579 2069 6e20 7365 6c66 2e64 7479 7065  ey in self.dtype
-00010b00: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00010b10: 2020 2072 6574 7572 6e20 7365 6c66 5b6b     return self[k
-00010b20: 6579 5d0a 2020 2020 2020 2020 2020 2020  ey].            
-00010b30: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00010b40: 2020 2020 2020 7261 6973 650a 0a20 2020        raise..   
-00010b50: 2064 6566 205f 5f64 6972 5f5f 2873 656c   def __dir__(sel
-00010b60: 6629 3a0a 2020 2020 2020 2020 7265 7375  f):.        resu
-00010b70: 6c74 203d 206c 6973 7428 7375 7065 7228  lt = list(super(
-00010b80: 292e 5f5f 6469 725f 5f28 2929 0a20 2020  ).__dir__()).   
-00010b90: 2020 2020 2072 6574 7572 6e20 736f 7274       return sort
-00010ba0: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
-00010bb0: 7265 7375 6c74 0a20 2020 2020 2020 2020  result.         
-00010bc0: 2020 202b 205b 6b20 666f 7220 6b20 696e     + [k for k in
-00010bd0: 2073 656c 662e 6474 7970 6573 2e69 6e64   self.dtypes.ind
-00010be0: 6578 2069 6620 6973 696e 7374 616e 6365  ex if isinstance
-00010bf0: 286b 2c20 7374 7229 2061 6e64 206b 2e69  (k, str) and k.i
-00010c00: 7369 6465 6e74 6966 6965 7228 295d 0a20  sidentifier()]. 
-00010c10: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
-00010c20: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00010c30: 5428 7365 6c66 293a 0a20 2020 2020 2020  T(self):.       
-00010c40: 2072 6574 7572 6e20 7365 6c66 2e74 7261   return self.tra
-00010c50: 6e73 706f 7365 2829 0a0a 2020 2020 4070  nspose()..    @p
-00010c60: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00010c70: 6e64 696d 2873 656c 6629 3a0a 2020 2020  ndim(self):.    
-00010c80: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00010c90: 5265 7475 726e 2061 6e20 696e 7420 7265  Return an int re
-00010ca0: 7072 6573 656e 7469 6e67 2074 6865 206e  presenting the n
-00010cb0: 756d 6265 7220 6f66 2061 7865 7320 2f20  umber of axes / 
-00010cc0: 6172 7261 7920 6469 6d65 6e73 696f 6e73  array dimensions
-00010cd0: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-00010ce0: 6e20 3120 6966 2053 6572 6965 732e 204f  n 1 if Series. O
-00010cf0: 7468 6572 7769 7365 2072 6574 7572 6e20  therwise return 
-00010d00: 3220 6966 2044 6174 6146 7261 6d65 2e0a  2 if DataFrame..
-00010d10: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-00010d20: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-00010d30: 2d2d 0a20 2020 2020 2020 206e 6461 7272  --.        ndarr
-00010d40: 6179 2e6e 6469 6d20 3a20 4e75 6d62 6572  ay.ndim : Number
-00010d50: 206f 6620 6172 7261 7920 6469 6d65 6e73   of array dimens
-00010d60: 696f 6e73 2e0a 0a20 2020 2020 2020 2045  ions...        E
-00010d70: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-00010d80: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00010d90: 203e 3e3e 2069 6d70 6f72 7420 6d61 7273   >>> import mars
-00010da0: 2e64 6174 6166 7261 6d65 2061 7320 6d64  .dataframe as md
-00010db0: 0a20 2020 2020 2020 203e 3e3e 2073 203d  .        >>> s =
-00010dc0: 206d 642e 5365 7269 6573 287b 2761 273a   md.Series({'a':
-00010dd0: 2031 2c20 2762 273a 2032 2c20 2763 273a   1, 'b': 2, 'c':
-00010de0: 2033 7d29 0a20 2020 2020 2020 203e 3e3e   3}).        >>>
-00010df0: 2073 2e6e 6469 6d2e 6578 6563 7574 6528   s.ndim.execute(
-00010e00: 290a 2020 2020 2020 2020 310a 0a20 2020  ).        1..   
-00010e10: 2020 2020 203e 3e3e 2064 6620 3d20 6d64       >>> df = md
-00010e20: 2e44 6174 6146 7261 6d65 287b 2763 6f6c  .DataFrame({'col
-00010e30: 3127 3a20 5b31 2c20 325d 2c20 2763 6f6c  1': [1, 2], 'col
-00010e40: 3227 3a20 5b33 2c20 345d 7d29 0a20 2020  2': [3, 4]}).   
-00010e50: 2020 2020 203e 3e3e 2064 662e 6e64 696d       >>> df.ndim
-00010e60: 2e65 7865 6375 7465 2829 0a20 2020 2020  .execute().     
-00010e70: 2020 2032 0a20 2020 2020 2020 2022 2222     2.        """
-00010e80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00010e90: 7375 7065 7228 292e 6e64 696d 0a0a 2020  super().ndim..  
-00010ea0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00010eb0: 6465 6620 696e 6465 7828 7365 6c66 293a  def index(self):
-00010ec0: 0a20 2020 2020 2020 2069 6478 203d 2073  .        idx = s
-00010ed0: 656c 662e 5f64 6174 612e 696e 6465 780a  elf._data.index.
-00010ee0: 2020 2020 2020 2020 6964 782e 5f73 6574          idx._set
-00010ef0: 5f64 665f 6f72 5f73 6572 6965 7328 7365  _df_or_series(se
-00010f00: 6c66 2c20 3029 0a20 2020 2020 2020 2072  lf, 0).        r
-00010f10: 6574 7572 6e20 6964 780a 0a20 2020 2040  eturn idx..    @
-00010f20: 696e 6465 782e 7365 7474 6572 0a20 2020  index.setter.   
-00010f30: 2064 6566 2069 6e64 6578 2873 656c 662c   def index(self,
-00010f40: 206e 6577 5f69 6e64 6578 293a 0a20 2020   new_index):.   
-00010f50: 2020 2020 2073 656c 662e 7365 745f 6178       self.set_ax
-00010f60: 6973 286e 6577 5f69 6e64 6578 2c20 6178  is(new_index, ax
-00010f70: 6973 3d30 2c20 696e 706c 6163 653d 5472  is=0, inplace=Tr
-00010f80: 7565 290a 0a20 2020 2040 7072 6f70 6572  ue)..    @proper
-00010f90: 7479 0a20 2020 2064 6566 2063 6f6c 756d  ty.    def colum
-00010fa0: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
-00010fb0: 2020 636f 6c20 3d20 7365 6c66 2e5f 6461    col = self._da
-00010fc0: 7461 2e63 6f6c 756d 6e73 0a20 2020 2020  ta.columns.     
-00010fd0: 2020 2063 6f6c 2e5f 7365 745f 6466 5f6f     col._set_df_o
-00010fe0: 725f 7365 7269 6573 2873 656c 662c 2031  r_series(self, 1
-00010ff0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00011000: 2063 6f6c 0a0a 2020 2020 4063 6f6c 756d   col..    @colum
-00011010: 6e73 2e73 6574 7465 720a 2020 2020 6465  ns.setter.    de
-00011020: 6620 636f 6c75 6d6e 7328 7365 6c66 2c20  f columns(self, 
-00011030: 6e65 775f 636f 6c75 6d6e 7329 3a0a 2020  new_columns):.  
-00011040: 2020 2020 2020 7365 6c66 2e73 6574 5f61        self.set_a
-00011050: 7869 7328 6e65 775f 636f 6c75 6d6e 732c  xis(new_columns,
-00011060: 2061 7869 733d 312c 2069 6e70 6c61 6365   axis=1, inplace
-00011070: 3d54 7275 6529 0a0a 2020 2020 6465 6620  =True)..    def 
-00011080: 6b65 7973 2873 656c 6629 3a0a 2020 2020  keys(self):.    
-00011090: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000110a0: 4765 7420 7468 6520 2769 6e66 6f20 6178  Get the 'info ax
-000110b0: 6973 2720 2873 6565 2049 6e64 6578 696e  is' (see Indexin
-000110c0: 6720 666f 7220 6d6f 7265 292e 0a0a 2020  g for more)...  
-000110d0: 2020 2020 2020 5468 6973 2069 7320 696e        This is in
-000110e0: 6465 7820 666f 7220 5365 7269 6573 2c20  dex for Series, 
-000110f0: 636f 6c75 6d6e 7320 666f 7220 4461 7461  columns for Data
-00011100: 4672 616d 652e 0a0a 2020 2020 2020 2020  Frame...        
-00011110: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-00011120: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00011130: 496e 6465 780a 2020 2020 2020 2020 2020  Index.          
-00011140: 2020 496e 666f 2061 7869 732e 0a20 2020    Info axis..   
-00011150: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00011160: 2072 6574 7572 6e20 7365 6c66 2e63 6f6c   return self.col
-00011170: 756d 6e73 0a0a 2020 2020 4070 726f 7065  umns..    @prope
-00011180: 7274 790a 2020 2020 6465 6620 7661 6c75  rty.    def valu
-00011190: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
-000111a0: 2020 7265 7475 726e 2073 656c 662e 746f    return self.to
-000111b0: 5f74 656e 736f 7228 290a 0a20 2020 2040  _tensor()..    @
-000111c0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-000111d0: 2064 7479 7065 7328 7365 6c66 293a 0a20   dtypes(self):. 
-000111e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000111f0: 2020 2052 6574 7572 6e20 7468 6520 6474     Return the dt
-00011200: 7970 6573 2069 6e20 7468 6520 4461 7461  ypes in the Data
-00011210: 4672 616d 652e 0a0a 2020 2020 2020 2020  Frame...        
-00011220: 5468 6973 2072 6574 7572 6e73 2061 2053  This returns a S
-00011230: 6572 6965 7320 7769 7468 2074 6865 2064  eries with the d
-00011240: 6174 6120 7479 7065 206f 6620 6561 6368  ata type of each
-00011250: 2063 6f6c 756d 6e2e 0a20 2020 2020 2020   column..       
-00011260: 2054 6865 2072 6573 756c 7427 7320 696e   The result's in
-00011270: 6465 7820 6973 2074 6865 206f 7269 6769  dex is the origi
-00011280: 6e61 6c20 4461 7461 4672 616d 6527 7320  nal DataFrame's 
-00011290: 636f 6c75 6d6e 732e 2043 6f6c 756d 6e73  columns. Columns
-000112a0: 0a20 2020 2020 2020 2077 6974 6820 6d69  .        with mi
-000112b0: 7865 6420 7479 7065 7320 6172 6520 7374  xed types are st
-000112c0: 6f72 6564 2077 6974 6820 7468 6520 6060  ored with the ``
-000112d0: 6f62 6a65 6374 6060 2064 7479 7065 2e20  object`` dtype. 
-000112e0: 5365 650a 2020 2020 2020 2020 3a72 6566  See.        :ref
-000112f0: 3a60 7468 6520 5573 6572 2047 7569 6465  :`the User Guide
-00011300: 203c 6261 7369 6373 2e64 7479 7065 733e   <basics.dtypes>
-00011310: 6020 666f 7220 6d6f 7265 2e0a 0a20 2020  ` for more...   
-00011320: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-00011330: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00011340: 2020 2020 2070 616e 6461 732e 5365 7269       pandas.Seri
-00011350: 6573 0a20 2020 2020 2020 2020 2020 2054  es.            T
-00011360: 6865 2064 6174 6120 7479 7065 206f 6620  he data type of 
-00011370: 6561 6368 2063 6f6c 756d 6e2e 0a0a 2020  each column...  
-00011380: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
-00011390: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-000113a0: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-000113b0: 7274 206d 6172 732e 6461 7461 6672 616d  rt mars.datafram
-000113c0: 6520 6173 206d 640a 2020 2020 2020 2020  e as md.        
-000113d0: 3e3e 3e20 6466 203d 206d 642e 4461 7461  >>> df = md.Data
-000113e0: 4672 616d 6528 7b27 666c 6f61 7427 3a20  Frame({'float': 
-000113f0: 5b31 2e30 5d2c 0a20 2020 2020 2020 202e  [1.0],.        .
-00011400: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
-00011410: 2020 2020 2020 2769 6e74 273a 205b 315d        'int': [1]
-00011420: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00011430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011440: 2027 6461 7465 7469 6d65 273a 205b 6d64   'datetime': [md
-00011450: 2e54 696d 6573 7461 6d70 2827 3230 3138  .Timestamp('2018
-00011460: 3033 3130 2729 5d2c 0a20 2020 2020 2020  0310')],.       
-00011470: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-00011480: 2020 2020 2020 2020 2773 7472 696e 6727          'string'
-00011490: 3a20 5b27 666f 6f27 5d7d 290a 2020 2020  : ['foo']}).    
-000114a0: 2020 2020 3e3e 3e20 6466 2e64 7479 7065      >>> df.dtype
-000114b0: 730a 2020 2020 2020 2020 666c 6f61 7420  s.        float 
-000114c0: 2020 2020 2020 2020 2020 2020 2066 6c6f               flo
-000114d0: 6174 3634 0a20 2020 2020 2020 2069 6e74  at64.        int
-000114e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114f0: 2020 696e 7436 340a 2020 2020 2020 2020    int64.        
-00011500: 6461 7465 7469 6d65 2020 2020 6461 7465  datetime    date
-00011510: 7469 6d65 3634 5b6e 735d 0a20 2020 2020  time64[ns].     
-00011520: 2020 2073 7472 696e 6720 2020 2020 2020     string       
-00011530: 2020 2020 2020 206f 626a 6563 740a 2020         object.  
-00011540: 2020 2020 2020 6474 7970 653a 206f 626a        dtype: obj
-00011550: 6563 740a 2020 2020 2020 2020 2222 220a  ect.        """.
-00011560: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00011570: 656c 662e 5f64 6174 612e 6474 7970 6573  elf._data.dtypes
-00011580: 0a0a 2020 2020 6465 6620 6974 6572 726f  ..    def iterro
-00011590: 7773 2873 656c 662c 2062 6174 6368 5f73  ws(self, batch_s
-000115a0: 697a 653d 3130 3030 2c20 7365 7373 696f  ize=1000, sessio
-000115b0: 6e3d 4e6f 6e65 293a 0a20 2020 2020 2020  n=None):.       
-000115c0: 2022 2222 0a20 2020 2020 2020 2049 7465   """.        Ite
-000115d0: 7261 7465 206f 7665 7220 4461 7461 4672  rate over DataFr
-000115e0: 616d 6520 726f 7773 2061 7320 2869 6e64  ame rows as (ind
-000115f0: 6578 2c20 5365 7269 6573 2920 7061 6972  ex, Series) pair
-00011600: 732e 0a0a 2020 2020 2020 2020 5969 656c  s...        Yiel
-00011610: 6473 0a20 2020 2020 2020 202d 2d2d 2d2d  ds.        -----
-00011620: 2d0a 2020 2020 2020 2020 696e 6465 7820  -.        index 
-00011630: 3a20 6c61 6265 6c20 6f72 2074 7570 6c65  : label or tuple
-00011640: 206f 6620 6c61 6265 6c0a 2020 2020 2020   of label.      
-00011650: 2020 2020 2020 5468 6520 696e 6465 7820        The index 
-00011660: 6f66 2074 6865 2072 6f77 2e20 4120 7475  of the row. A tu
-00011670: 706c 6520 666f 7220 6120 604d 756c 7469  ple for a `Multi
-00011680: 496e 6465 7860 2e0a 2020 2020 2020 2020  Index`..        
-00011690: 6461 7461 203a 2053 6572 6965 730a 2020  data : Series.  
-000116a0: 2020 2020 2020 2020 2020 5468 6520 6461            The da
-000116b0: 7461 206f 6620 7468 6520 726f 7720 6173  ta of the row as
-000116c0: 2061 2053 6572 6965 732e 0a0a 2020 2020   a Series...    
-000116d0: 2020 2020 6974 203a 2067 656e 6572 6174      it : generat
-000116e0: 6f72 0a20 2020 2020 2020 2020 2020 2041  or.            A
-000116f0: 2067 656e 6572 6174 6f72 2074 6861 7420   generator that 
-00011700: 6974 6572 6174 6573 206f 7665 7220 7468  iterates over th
-00011710: 6520 726f 7773 206f 6620 7468 6520 6672  e rows of the fr
-00011720: 616d 652e 0a0a 2020 2020 2020 2020 5365  ame...        Se
-00011730: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
-00011740: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00011750: 4461 7461 4672 616d 652e 6974 6572 7475  DataFrame.itertu
-00011760: 706c 6573 203a 2049 7465 7261 7465 206f  ples : Iterate o
-00011770: 7665 7220 4461 7461 4672 616d 6520 726f  ver DataFrame ro
-00011780: 7773 2061 7320 6e61 6d65 6474 7570 6c65  ws as namedtuple
-00011790: 7320 6f66 2074 6865 2076 616c 7565 732e  s of the values.
-000117a0: 0a20 2020 2020 2020 2044 6174 6146 7261  .        DataFra
-000117b0: 6d65 2e69 7465 6d73 203a 2049 7465 7261  me.items : Itera
-000117c0: 7465 206f 7665 7220 2863 6f6c 756d 6e20  te over (column 
-000117d0: 6e61 6d65 2c20 5365 7269 6573 2920 7061  name, Series) pa
-000117e0: 6972 732e 0a0a 2020 2020 2020 2020 4e6f  irs...        No
-000117f0: 7465 730a 2020 2020 2020 2020 2d2d 2d2d  tes.        ----
-00011800: 2d0a 0a20 2020 2020 2020 2031 2e20 4265  -..        1. Be
-00011810: 6361 7573 6520 6060 6974 6572 726f 7773  cause ``iterrows
-00011820: 6060 2072 6574 7572 6e73 2061 2053 6572  `` returns a Ser
-00011830: 6965 7320 666f 7220 6561 6368 2072 6f77  ies for each row
-00011840: 2c0a 2020 2020 2020 2020 2020 2069 7420  ,.           it 
-00011850: 646f 6573 202a 2a6e 6f74 2a2a 2070 7265  does **not** pre
-00011860: 7365 7276 6520 6474 7970 6573 2061 6372  serve dtypes acr
-00011870: 6f73 7320 7468 6520 726f 7773 2028 6474  oss the rows (dt
-00011880: 7970 6573 2061 7265 0a20 2020 2020 2020  ypes are.       
-00011890: 2020 2020 7072 6573 6572 7665 6420 6163      preserved ac
-000118a0: 726f 7373 2063 6f6c 756d 6e73 2066 6f72  ross columns for
-000118b0: 2044 6174 6146 7261 6d65 7329 2e20 466f   DataFrames). Fo
-000118c0: 7220 6578 616d 706c 652c 0a0a 2020 2020  r example,..    
-000118d0: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
-000118e0: 7420 6d61 7273 2e64 6174 6166 7261 6d65  t mars.dataframe
-000118f0: 2061 7320 6d64 0a20 2020 2020 2020 2020   as md.         
-00011900: 2020 3e3e 3e20 6466 203d 206d 642e 4461    >>> df = md.Da
-00011910: 7461 4672 616d 6528 5b5b 312c 2031 2e35  taFrame([[1, 1.5
-00011920: 5d5d 2c20 636f 6c75 6d6e 733d 5b27 696e  ]], columns=['in
-00011930: 7427 2c20 2766 6c6f 6174 275d 290a 2020  t', 'float']).  
-00011940: 2020 2020 2020 2020 203e 3e3e 2072 6f77           >>> row
-00011950: 203d 206e 6578 7428 6466 2e69 7465 7272   = next(df.iterr
-00011960: 6f77 7328 2929 5b31 5d0a 2020 2020 2020  ows())[1].      
-00011970: 2020 2020 203e 3e3e 2072 6f77 0a20 2020       >>> row.   
-00011980: 2020 2020 2020 2020 696e 7420 2020 2020          int     
-00011990: 2031 2e30 0a20 2020 2020 2020 2020 2020   1.0.           
-000119a0: 666c 6f61 7420 2020 2031 2e35 0a20 2020  float    1.5.   
-000119b0: 2020 2020 2020 2020 4e61 6d65 3a20 302c          Name: 0,
-000119c0: 2064 7479 7065 3a20 666c 6f61 7436 340a   dtype: float64.
-000119d0: 2020 2020 2020 2020 2020 203e 3e3e 2070             >>> p
-000119e0: 7269 6e74 2872 6f77 5b27 696e 7427 5d2e  rint(row['int'].
-000119f0: 6474 7970 6529 0a20 2020 2020 2020 2020  dtype).         
-00011a00: 2020 666c 6f61 7436 340a 2020 2020 2020    float64.      
-00011a10: 2020 2020 203e 3e3e 2070 7269 6e74 2864       >>> print(d
-00011a20: 665b 2769 6e74 275d 2e64 7479 7065 290a  f['int'].dtype).
-00011a30: 2020 2020 2020 2020 2020 2069 6e74 3634             int64
-00011a40: 0a0a 2020 2020 2020 2020 2020 2054 6f20  ..           To 
-00011a50: 7072 6573 6572 7665 2064 7479 7065 7320  preserve dtypes 
-00011a60: 7768 696c 6520 6974 6572 6174 696e 6720  while iterating 
-00011a70: 6f76 6572 2074 6865 2072 6f77 732c 2069  over the rows, i
-00011a80: 7420 6973 2062 6574 7465 720a 2020 2020  t is better.    
-00011a90: 2020 2020 2020 2074 6f20 7573 6520 3a6d         to use :m
-00011aa0: 6574 683a 6069 7465 7274 7570 6c65 7360  eth:`itertuples`
-00011ab0: 2077 6869 6368 2072 6574 7572 6e73 206e   which returns n
-00011ac0: 616d 6564 7475 706c 6573 206f 6620 7468  amedtuples of th
-00011ad0: 6520 7661 6c75 6573 0a20 2020 2020 2020  e values.       
-00011ae0: 2020 2020 616e 6420 7768 6963 6820 6973      and which is
-00011af0: 2067 656e 6572 616c 6c79 2066 6173 7465   generally faste
-00011b00: 7220 7468 616e 2060 6069 7465 7272 6f77  r than ``iterrow
-00011b10: 7360 602e 0a0a 2020 2020 2020 2020 322e  s``...        2.
-00011b20: 2059 6f75 2073 686f 756c 6420 2a2a 6e65   You should **ne
-00011b30: 7665 7220 6d6f 6469 6679 2a2a 2073 6f6d  ver modify** som
-00011b40: 6574 6869 6e67 2079 6f75 2061 7265 2069  ething you are i
-00011b50: 7465 7261 7469 6e67 206f 7665 722e 0a20  terating over.. 
-00011b60: 2020 2020 2020 2020 2020 5468 6973 2069            This i
-00011b70: 7320 6e6f 7420 6775 6172 616e 7465 6564  s not guaranteed
-00011b80: 2074 6f20 776f 726b 2069 6e20 616c 6c20   to work in all 
-00011b90: 6361 7365 732e 2044 6570 656e 6469 6e67  cases. Depending
-00011ba0: 206f 6e20 7468 650a 2020 2020 2020 2020   on the.        
-00011bb0: 2020 2064 6174 6120 7479 7065 732c 2074     data types, t
-00011bc0: 6865 2069 7465 7261 746f 7220 7265 7475  he iterator retu
-00011bd0: 726e 7320 6120 636f 7079 2061 6e64 206e  rns a copy and n
-00011be0: 6f74 2061 2076 6965 772c 2061 6e64 2077  ot a view, and w
-00011bf0: 7269 7469 6e67 0a20 2020 2020 2020 2020  riting.         
-00011c00: 2020 746f 2069 7420 7769 6c6c 2068 6176    to it will hav
-00011c10: 6520 6e6f 2065 6666 6563 742e 0a20 2020  e no effect..   
-00011c20: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00011c30: 2072 6574 7572 6e20 7365 6c66 2e5f 6461   return self._da
-00011c40: 7461 2e69 7465 7272 6f77 7328 6261 7463  ta.iterrows(batc
-00011c50: 685f 7369 7a65 3d62 6174 6368 5f73 697a  h_size=batch_siz
-00011c60: 652c 2073 6573 7369 6f6e 3d73 6573 7369  e, session=sessi
-00011c70: 6f6e 290a 0a20 2020 2064 6566 2069 7465  on)..    def ite
-00011c80: 7274 7570 6c65 7328 7365 6c66 2c20 696e  rtuples(self, in
-00011c90: 6465 783d 5472 7565 2c20 6e61 6d65 3d22  dex=True, name="
-00011ca0: 5061 6e64 6173 222c 2062 6174 6368 5f73  Pandas", batch_s
-00011cb0: 697a 653d 3130 3030 2c20 7365 7373 696f  ize=1000, sessio
-00011cc0: 6e3d 4e6f 6e65 293a 0a20 2020 2020 2020  n=None):.       
-00011cd0: 2022 2222 0a20 2020 2020 2020 2049 7465   """.        Ite
-00011ce0: 7261 7465 206f 7665 7220 4461 7461 4672  rate over DataFr
-00011cf0: 616d 6520 726f 7773 2061 7320 6e61 6d65  ame rows as name
-00011d00: 6474 7570 6c65 732e 0a0a 2020 2020 2020  dtuples...      
-00011d10: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00011d20: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00011d30: 2020 2020 2020 2020 696e 6465 7820 3a20          index : 
-00011d40: 626f 6f6c 2c20 6465 6661 756c 7420 5472  bool, default Tr
-00011d50: 7565 0a20 2020 2020 2020 2020 2020 2049  ue.            I
-00011d60: 6620 5472 7565 2c20 7265 7475 726e 2074  f True, return t
-00011d70: 6865 2069 6e64 6578 2061 7320 7468 6520  he index as the 
-00011d80: 6669 7273 7420 656c 656d 656e 7420 6f66  first element of
-00011d90: 2074 6865 2074 7570 6c65 2e0a 2020 2020   the tuple..    
-00011da0: 2020 2020 6e61 6d65 203a 2073 7472 206f      name : str o
-00011db0: 7220 4e6f 6e65 2c20 6465 6661 756c 7420  r None, default 
-00011dc0: 2250 616e 6461 7322 0a20 2020 2020 2020  "Pandas".       
-00011dd0: 2020 2020 2054 6865 206e 616d 6520 6f66       The name of
-00011de0: 2074 6865 2072 6574 7572 6e65 6420 6e61   the returned na
-00011df0: 6d65 6474 7570 6c65 7320 6f72 204e 6f6e  medtuples or Non
-00011e00: 6520 746f 2072 6574 7572 6e20 7265 6775  e to return regu
-00011e10: 6c61 720a 2020 2020 2020 2020 2020 2020  lar.            
-00011e20: 7475 706c 6573 2e0a 0a20 2020 2020 2020  tuples...       
-00011e30: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-00011e40: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-00011e50: 2069 7465 7261 746f 720a 2020 2020 2020   iterator.      
-00011e60: 2020 2020 2020 416e 206f 626a 6563 7420        An object 
-00011e70: 746f 2069 7465 7261 7465 206f 7665 7220  to iterate over 
-00011e80: 6e61 6d65 6474 7570 6c65 7320 666f 7220  namedtuples for 
-00011e90: 6561 6368 2072 6f77 2069 6e20 7468 650a  each row in the.
-00011ea0: 2020 2020 2020 2020 2020 2020 4461 7461              Data
-00011eb0: 4672 616d 6520 7769 7468 2074 6865 2066  Frame with the f
-00011ec0: 6972 7374 2066 6965 6c64 2070 6f73 7369  irst field possi
-00011ed0: 626c 7920 6265 696e 6720 7468 6520 696e  bly being the in
-00011ee0: 6465 7820 616e 640a 2020 2020 2020 2020  dex and.        
-00011ef0: 2020 2020 666f 6c6c 6f77 696e 6720 6669      following fi
-00011f00: 656c 6473 2062 6569 6e67 2074 6865 2063  elds being the c
-00011f10: 6f6c 756d 6e20 7661 6c75 6573 2e0a 0a20  olumn values... 
-00011f20: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
-00011f30: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00011f40: 0a20 2020 2020 2020 2044 6174 6146 7261  .        DataFra
-00011f50: 6d65 2e69 7465 7272 6f77 7320 3a20 4974  me.iterrows : It
-00011f60: 6572 6174 6520 6f76 6572 2044 6174 6146  erate over DataF
-00011f70: 7261 6d65 2072 6f77 7320 6173 2028 696e  rame rows as (in
-00011f80: 6465 782c 2053 6572 6965 7329 0a20 2020  dex, Series).   
-00011f90: 2020 2020 2020 2020 2070 6169 7273 2e0a           pairs..
-00011fa0: 2020 2020 2020 2020 4461 7461 4672 616d          DataFram
-00011fb0: 652e 6974 656d 7320 3a20 4974 6572 6174  e.items : Iterat
-00011fc0: 6520 6f76 6572 2028 636f 6c75 6d6e 206e  e over (column n
-00011fd0: 616d 652c 2053 6572 6965 7329 2070 6169  ame, Series) pai
-00011fe0: 7273 2e0a 0a20 2020 2020 2020 204e 6f74  rs...        Not
-00011ff0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-00012000: 0a20 2020 2020 2020 2054 6865 2063 6f6c  .        The col
-00012010: 756d 6e20 6e61 6d65 7320 7769 6c6c 2062  umn names will b
-00012020: 6520 7265 6e61 6d65 6420 746f 2070 6f73  e renamed to pos
-00012030: 6974 696f 6e61 6c20 6e61 6d65 7320 6966  itional names if
-00012040: 2074 6865 7920 6172 650a 2020 2020 2020   they are.      
-00012050: 2020 696e 7661 6c69 6420 5079 7468 6f6e    invalid Python
-00012060: 2069 6465 6e74 6966 6965 7273 2c20 7265   identifiers, re
-00012070: 7065 6174 6564 2c20 6f72 2073 7461 7274  peated, or start
-00012080: 2077 6974 6820 616e 2075 6e64 6572 7363   with an undersc
-00012090: 6f72 652e 0a20 2020 2020 2020 204f 6e20  ore..        On 
-000120a0: 7079 7468 6f6e 2076 6572 7369 6f6e 7320  python versions 
-000120b0: 3c20 332e 3720 7265 6775 6c61 7220 7475  < 3.7 regular tu
-000120c0: 706c 6573 2061 7265 2072 6574 7572 6e65  ples are returne
-000120d0: 6420 666f 7220 4461 7461 4672 616d 6573  d for DataFrames
-000120e0: 0a20 2020 2020 2020 2077 6974 6820 6120  .        with a 
-000120f0: 6c61 7267 6520 6e75 6d62 6572 206f 6620  large number of 
-00012100: 636f 6c75 6d6e 7320 283e 3235 3429 2e0a  columns (>254)..
-00012110: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-00012120: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00012130: 2d2d 0a20 2020 2020 2020 203e 3e3e 2069  --.        >>> i
-00012140: 6d70 6f72 7420 6d61 7273 2e64 6174 6166  mport mars.dataf
-00012150: 7261 6d65 2061 7320 6d64 0a20 2020 2020  rame as md.     
-00012160: 2020 203e 3e3e 2064 6620 3d20 6d64 2e44     >>> df = md.D
-00012170: 6174 6146 7261 6d65 287b 276e 756d 5f6c  ataFrame({'num_l
-00012180: 6567 7327 3a20 5b34 2c20 325d 2c20 276e  egs': [4, 2], 'n
-00012190: 756d 5f77 696e 6773 273a 205b 302c 2032  um_wings': [0, 2
-000121a0: 5d7d 2c0a 2020 2020 2020 2020 2e2e 2e20  ]},.        ... 
-000121b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000121c0: 2020 696e 6465 783d 5b27 646f 6727 2c20    index=['dog', 
-000121d0: 2768 6177 6b27 5d29 0a20 2020 2020 2020  'hawk']).       
-000121e0: 203e 3e3e 2064 662e 6578 6563 7574 6528   >>> df.execute(
-000121f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00012200: 6e75 6d5f 6c65 6773 2020 6e75 6d5f 7769  num_legs  num_wi
-00012210: 6e67 730a 2020 2020 2020 2020 646f 6720  ngs.        dog 
-00012220: 2020 2020 2020 2020 2034 2020 2020 2020           4      
-00012230: 2020 2020 300a 2020 2020 2020 2020 6861      0.        ha
-00012240: 776b 2020 2020 2020 2020 2032 2020 2020  wk         2    
-00012250: 2020 2020 2020 320a 2020 2020 2020 2020        2.        
-00012260: 3e3e 3e20 666f 7220 726f 7720 696e 2064  >>> for row in d
-00012270: 662e 6974 6572 7475 706c 6573 2829 3a0a  f.itertuples():.
-00012280: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00012290: 7072 696e 7428 726f 7729 0a20 2020 2020  print(row).     
-000122a0: 2020 202e 2e2e 0a20 2020 2020 2020 2050     ....        P
-000122b0: 616e 6461 7328 496e 6465 783d 2764 6f67  andas(Index='dog
-000122c0: 272c 206e 756d 5f6c 6567 733d 342c 206e  ', num_legs=4, n
-000122d0: 756d 5f77 696e 6773 3d30 290a 2020 2020  um_wings=0).    
-000122e0: 2020 2020 5061 6e64 6173 2849 6e64 6578      Pandas(Index
-000122f0: 3d27 6861 776b 272c 206e 756d 5f6c 6567  ='hawk', num_leg
-00012300: 733d 322c 206e 756d 5f77 696e 6773 3d32  s=2, num_wings=2
-00012310: 290a 0a20 2020 2020 2020 2042 7920 7365  )..        By se
-00012320: 7474 696e 6720 7468 6520 6069 6e64 6578  tting the `index
-00012330: 6020 7061 7261 6d65 7465 7220 746f 2046  ` parameter to F
-00012340: 616c 7365 2077 6520 6361 6e20 7265 6d6f  alse we can remo
-00012350: 7665 2074 6865 2069 6e64 6578 0a20 2020  ve the index.   
-00012360: 2020 2020 2061 7320 7468 6520 6669 7273       as the firs
-00012370: 7420 656c 656d 656e 7420 6f66 2074 6865  t element of the
-00012380: 2074 7570 6c65 3a0a 0a20 2020 2020 2020   tuple:..       
-00012390: 203e 3e3e 2066 6f72 2072 6f77 2069 6e20   >>> for row in 
-000123a0: 6466 2e69 7465 7274 7570 6c65 7328 696e  df.itertuples(in
-000123b0: 6465 783d 4661 6c73 6529 3a0a 2020 2020  dex=False):.    
-000123c0: 2020 2020 2e2e 2e20 2020 2020 7072 696e      ...     prin
-000123d0: 7428 726f 7729 0a20 2020 2020 2020 202e  t(row).        .
-000123e0: 2e2e 0a20 2020 2020 2020 2050 616e 6461  ...        Panda
-000123f0: 7328 6e75 6d5f 6c65 6773 3d34 2c20 6e75  s(num_legs=4, nu
-00012400: 6d5f 7769 6e67 733d 3029 0a20 2020 2020  m_wings=0).     
-00012410: 2020 2050 616e 6461 7328 6e75 6d5f 6c65     Pandas(num_le
-00012420: 6773 3d32 2c20 6e75 6d5f 7769 6e67 733d  gs=2, num_wings=
-00012430: 3229 0a0a 2020 2020 2020 2020 5769 7468  2)..        With
-00012440: 2074 6865 2060 6e61 6d65 6020 7061 7261   the `name` para
-00012450: 6d65 7465 7220 7365 7420 7765 2073 6574  meter set we set
-00012460: 2061 2063 7573 746f 6d20 6e61 6d65 2066   a custom name f
-00012470: 6f72 2074 6865 2079 6965 6c64 6564 0a20  or the yielded. 
-00012480: 2020 2020 2020 206e 616d 6564 7475 706c         namedtupl
-00012490: 6573 3a0a 0a20 2020 2020 2020 203e 3e3e  es:..        >>>
-000124a0: 2066 6f72 2072 6f77 2069 6e20 6466 2e69   for row in df.i
-000124b0: 7465 7274 7570 6c65 7328 6e61 6d65 3d27  tertuples(name='
-000124c0: 416e 696d 616c 2729 3a0a 2020 2020 2020  Animal'):.      
-000124d0: 2020 2e2e 2e20 2020 2020 7072 696e 7428    ...     print(
-000124e0: 726f 7729 0a20 2020 2020 2020 202e 2e2e  row).        ...
-000124f0: 0a20 2020 2020 2020 2041 6e69 6d61 6c28  .        Animal(
-00012500: 496e 6465 783d 2764 6f67 272c 206e 756d  Index='dog', num
-00012510: 5f6c 6567 733d 342c 206e 756d 5f77 696e  _legs=4, num_win
-00012520: 6773 3d30 290a 2020 2020 2020 2020 416e  gs=0).        An
-00012530: 696d 616c 2849 6e64 6578 3d27 6861 776b  imal(Index='hawk
-00012540: 272c 206e 756d 5f6c 6567 733d 322c 206e  ', num_legs=2, n
-00012550: 756d 5f77 696e 6773 3d32 290a 2020 2020  um_wings=2).    
-00012560: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00012570: 7265 7475 726e 2073 656c 662e 5f64 6174  return self._dat
-00012580: 612e 6974 6572 7475 706c 6573 280a 2020  a.itertuples(.  
-00012590: 2020 2020 2020 2020 2020 6261 7463 685f            batch_
-000125a0: 7369 7a65 3d62 6174 6368 5f73 697a 652c  size=batch_size,
-000125b0: 2073 6573 7369 6f6e 3d73 6573 7369 6f6e   session=session
-000125c0: 2c20 696e 6465 783d 696e 6465 782c 206e  , index=index, n
-000125d0: 616d 653d 6e61 6d65 0a20 2020 2020 2020  ame=name.       
-000125e0: 2029 0a0a 2020 2020 6465 6620 6173 7369   )..    def assi
-000125f0: 676e 2873 656c 662c 202a 2a6b 7761 7267  gn(self, **kwarg
-00012600: 7329 3a0a 2020 2020 2020 2020 2222 220a  s):.        """.
-00012610: 2020 2020 2020 2020 4173 7369 676e 206e          Assign n
-00012620: 6577 2063 6f6c 756d 6e73 2074 6f20 6120  ew columns to a 
-00012630: 4461 7461 4672 616d 652e 0a20 2020 2020  DataFrame..     
-00012640: 2020 2052 6574 7572 6e73 2061 206e 6577     Returns a new
-00012650: 206f 626a 6563 7420 7769 7468 2061 6c6c   object with all
-00012660: 206f 7269 6769 6e61 6c20 636f 6c75 6d6e   original column
-00012670: 7320 696e 2061 6464 6974 696f 6e20 746f  s in addition to
-00012680: 206e 6577 206f 6e65 732e 0a20 2020 2020   new ones..     
-00012690: 2020 2045 7869 7374 696e 6720 636f 6c75     Existing colu
-000126a0: 6d6e 7320 7468 6174 2061 7265 2072 652d  mns that are re-
-000126b0: 6173 7369 676e 6564 2077 696c 6c20 6265  assigned will be
-000126c0: 206f 7665 7277 7269 7474 656e 2e0a 0a20   overwritten... 
-000126d0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-000126e0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-000126f0: 2d2d 2d2d 0a20 2020 2020 2020 202a 2a6b  ----.        **k
-00012700: 7761 7267 7320 3a20 6469 6374 206f 6620  wargs : dict of 
-00012710: 7b73 7472 3a20 6361 6c6c 6162 6c65 206f  {str: callable o
-00012720: 7220 5365 7269 6573 7d0a 2020 2020 2020  r Series}.      
-00012730: 2020 2020 2020 5468 6520 636f 6c75 6d6e        The column
-00012740: 206e 616d 6573 2061 7265 206b 6579 776f   names are keywo
-00012750: 7264 732e 2049 6620 7468 6520 7661 6c75  rds. If the valu
-00012760: 6573 2061 7265 0a20 2020 2020 2020 2020  es are.         
-00012770: 2020 2063 616c 6c61 626c 652c 2074 6865     callable, the
-00012780: 7920 6172 6520 636f 6d70 7574 6564 206f  y are computed o
-00012790: 6e20 7468 6520 4461 7461 4672 616d 6520  n the DataFrame 
-000127a0: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-000127b0: 6173 7369 676e 6564 2074 6f20 7468 6520  assigned to the 
-000127c0: 6e65 7720 636f 6c75 6d6e 732e 2054 6865  new columns. The
-000127d0: 2063 616c 6c61 626c 6520 6d75 7374 206e   callable must n
-000127e0: 6f74 0a20 2020 2020 2020 2020 2020 2063  ot.            c
-000127f0: 6861 6e67 6520 696e 7075 7420 4461 7461  hange input Data
-00012800: 4672 616d 6520 2874 686f 7567 6820 7061  Frame (though pa
-00012810: 6e64 6173 2064 6f65 736e 2774 2063 6865  ndas doesn't che
-00012820: 636b 2069 7429 2e0a 2020 2020 2020 2020  ck it)..        
-00012830: 2020 2020 4966 2074 6865 2076 616c 7565      If the value
-00012840: 7320 6172 6520 6e6f 7420 6361 6c6c 6162  s are not callab
-00012850: 6c65 2c20 2865 2e67 2e20 6120 5365 7269  le, (e.g. a Seri
-00012860: 6573 2c20 7363 616c 6172 2c20 6f72 2061  es, scalar, or a
-00012870: 7272 6179 292c 0a20 2020 2020 2020 2020  rray),.         
-00012880: 2020 2074 6865 7920 6172 6520 7369 6d70     they are simp
-00012890: 6c79 2061 7373 6967 6e65 642e 0a0a 2020  ly assigned...  
-000128a0: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-000128b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-000128c0: 2020 2020 2020 4461 7461 4672 616d 650a        DataFrame.
-000128d0: 2020 2020 2020 2020 2020 2020 4120 6e65              A ne
-000128e0: 7720 4461 7461 4672 616d 6520 7769 7468  w DataFrame with
-000128f0: 2074 6865 206e 6577 2063 6f6c 756d 6e73   the new columns
-00012900: 2069 6e20 6164 6469 7469 6f6e 2074 6f0a   in addition to.
-00012910: 2020 2020 2020 2020 2020 2020 616c 6c20              all 
-00012920: 7468 6520 6578 6973 7469 6e67 2063 6f6c  the existing col
-00012930: 756d 6e73 2e0a 0a20 2020 2020 2020 204e  umns...        N
-00012940: 6f74 6573 0a20 2020 2020 2020 202d 2d2d  otes.        ---
-00012950: 2d2d 0a20 2020 2020 2020 2041 7373 6967  --.        Assig
-00012960: 6e69 6e67 206d 756c 7469 706c 6520 636f  ning multiple co
-00012970: 6c75 6d6e 7320 7769 7468 696e 2074 6865  lumns within the
-00012980: 2073 616d 6520 6060 6173 7369 676e 6060   same ``assign``
-00012990: 2069 7320 706f 7373 6962 6c65 2e0a 2020   is possible..  
-000129a0: 2020 2020 2020 4c61 7465 7220 6974 656d        Later item
-000129b0: 7320 696e 2027 6b77 6172 6773 2720 6d61  s in 'kwargs' ma
-000129c0: 7920 7265 6665 7220 746f 206e 6577 6c79  y refer to newly
-000129d0: 2063 7265 6174 6564 206f 7220 6d6f 6469   created or modi
-000129e0: 6669 6564 0a20 2020 2020 2020 2063 6f6c  fied.        col
-000129f0: 756d 6e73 2069 6e20 2764 6627 3b20 6974  umns in 'df'; it
-00012a00: 656d 7320 6172 6520 636f 6d70 7574 6564  ems are computed
-00012a10: 2061 6e64 2061 7373 6967 6e65 6420 696e   and assigned in
-00012a20: 746f 2027 6466 2720 696e 206f 7264 6572  to 'df' in order
-00012a30: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-00012a40: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
-00012a50: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
-00012a60: 2069 6d70 6f72 7420 6d61 7273 2e64 6174   import mars.dat
-00012a70: 6166 7261 6d65 2061 7320 6d64 0a20 2020  aframe as md.   
-00012a80: 2020 2020 203e 3e3e 2064 6620 3d20 6d64       >>> df = md
-00012a90: 2e44 6174 6146 7261 6d65 287b 2774 656d  .DataFrame({'tem
-00012aa0: 705f 6327 3a20 5b31 372e 302c 2032 352e  p_c': [17.0, 25.
-00012ab0: 305d 7d2c 0a20 2020 2020 2020 202e 2e2e  0]},.        ...
-00012ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ad0: 2020 2069 6e64 6578 3d5b 2750 6f72 746c     index=['Portl
-00012ae0: 616e 6427 2c20 2742 6572 6b65 6c65 7927  and', 'Berkeley'
-00012af0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00012b00: 662e 6578 6563 7574 6528 290a 2020 2020  f.execute().    
-00012b10: 2020 2020 2020 2020 2020 2020 2020 7465                te
-00012b20: 6d70 5f63 0a20 2020 2020 2020 2050 6f72  mp_c.        Por
-00012b30: 746c 616e 6420 2020 2031 372e 300a 2020  tland    17.0.  
-00012b40: 2020 2020 2020 4265 726b 656c 6579 2020        Berkeley  
-00012b50: 2020 3235 2e30 0a0a 2020 2020 2020 2020    25.0..        
-00012b60: 5768 6572 6520 7468 6520 7661 6c75 6520  Where the value 
-00012b70: 6973 2061 2063 616c 6c61 626c 652c 2065  is a callable, e
-00012b80: 7661 6c75 6174 6564 206f 6e20 6064 6660  valuated on `df`
-00012b90: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-00012ba0: 662e 6173 7369 676e 2874 656d 705f 663d  f.assign(temp_f=
-00012bb0: 6c61 6d62 6461 2078 3a20 782e 7465 6d70  lambda x: x.temp
-00012bc0: 5f63 202a 2039 202f 2035 202b 2033 3229  _c * 9 / 5 + 32)
-00012bd0: 2e65 7865 6375 7465 2829 0a20 2020 2020  .execute().     
-00012be0: 2020 2020 2020 2020 2020 2020 2074 656d               tem
-00012bf0: 705f 6320 2074 656d 705f 660a 2020 2020  p_c  temp_f.    
-00012c00: 2020 2020 506f 7274 6c61 6e64 2020 2020      Portland    
-00012c10: 3137 2e30 2020 2020 3632 2e36 0a20 2020  17.0    62.6.   
-00012c20: 2020 2020 2042 6572 6b65 6c65 7920 2020       Berkeley   
-00012c30: 2032 352e 3020 2020 2037 372e 300a 0a20   25.0    77.0.. 
-00012c40: 2020 2020 2020 2041 6c74 6572 6e61 7469         Alternati
-00012c50: 7665 6c79 2c20 7468 6520 7361 6d65 2062  vely, the same b
-00012c60: 6568 6176 696f 7220 6361 6e20 6265 2061  ehavior can be a
-00012c70: 6368 6965 7665 6420 6279 2064 6972 6563  chieved by direc
-00012c80: 746c 790a 2020 2020 2020 2020 7265 6665  tly.        refe
-00012c90: 7265 6e63 696e 6720 616e 2065 7869 7374  rencing an exist
-00012ca0: 696e 6720 5365 7269 6573 206f 7220 7365  ing Series or se
-00012cb0: 7175 656e 6365 3a0a 0a20 2020 2020 2020  quence:..       
-00012cc0: 203e 3e3e 2064 662e 6173 7369 676e 2874   >>> df.assign(t
-00012cd0: 656d 705f 663d 6466 5b27 7465 6d70 5f63  emp_f=df['temp_c
-00012ce0: 275d 202a 2039 202f 2035 202b 2033 3229  '] * 9 / 5 + 32)
-00012cf0: 2e65 7865 6375 7465 2829 0a20 2020 2020  .execute().     
-00012d00: 2020 2020 2020 2020 2020 2020 2074 656d               tem
-00012d10: 705f 6320 2074 656d 705f 660a 2020 2020  p_c  temp_f.    
-00012d20: 2020 2020 506f 7274 6c61 6e64 2020 2020      Portland    
-00012d30: 3137 2e30 2020 2020 3632 2e36 0a20 2020  17.0    62.6.   
-00012d40: 2020 2020 2042 6572 6b65 6c65 7920 2020       Berkeley   
-00012d50: 2032 352e 3020 2020 2037 372e 300a 0a20   25.0    77.0.. 
-00012d60: 2020 2020 2020 2059 6f75 2063 616e 2063         You can c
-00012d70: 7265 6174 6520 6d75 6c74 6970 6c65 2063  reate multiple c
-00012d80: 6f6c 756d 6e73 2077 6974 6869 6e20 7468  olumns within th
-00012d90: 6520 7361 6d65 2061 7373 6967 6e20 7768  e same assign wh
-00012da0: 6572 6520 6f6e 650a 2020 2020 2020 2020  ere one.        
-00012db0: 6f66 2074 6865 2063 6f6c 756d 6e73 2064  of the columns d
-00012dc0: 6570 656e 6473 206f 6e20 616e 6f74 6865  epends on anothe
-00012dd0: 7220 6f6e 6520 6465 6669 6e65 6420 7769  r one defined wi
-00012de0: 7468 696e 2074 6865 2073 616d 6520 6173  thin the same as
-00012df0: 7369 676e 3a0a 0a20 2020 2020 2020 203e  sign:..        >
-00012e00: 3e3e 2064 662e 6173 7369 676e 2874 656d  >> df.assign(tem
-00012e10: 705f 663d 6c61 6d62 6461 2078 3a20 785b  p_f=lambda x: x[
-00012e20: 2774 656d 705f 6327 5d20 2a20 3920 2f20  'temp_c'] * 9 / 
-00012e30: 3520 2b20 3332 2c0a 2020 2020 2020 2020  5 + 32,.        
-00012e40: 2e2e 2e20 2020 2020 2020 2020 2020 7465  ...           te
-00012e50: 6d70 5f6b 3d6c 616d 6264 6120 783a 2028  mp_k=lambda x: (
-00012e60: 785b 2774 656d 705f 6627 5d20 2b20 2034  x['temp_f'] +  4
-00012e70: 3539 2e36 3729 202a 2035 202f 2039 292e  59.67) * 5 / 9).
-00012e80: 6578 6563 7574 6528 290a 2020 2020 2020  execute().      
-00012e90: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
-00012ea0: 5f63 2020 7465 6d70 5f66 2020 7465 6d70  _c  temp_f  temp
-00012eb0: 5f6b 0a20 2020 2020 2020 2050 6f72 746c  _k.        Portl
-00012ec0: 616e 6420 2020 2031 372e 3020 2020 2036  and    17.0    6
-00012ed0: 322e 3620 2032 3930 2e31 350a 2020 2020  2.6  290.15.    
-00012ee0: 2020 2020 4265 726b 656c 6579 2020 2020      Berkeley    
-00012ef0: 3235 2e30 2020 2020 3737 2e30 2020 3239  25.0    77.0  29
-00012f00: 382e 3135 0a20 2020 2020 2020 2022 2222  8.15.        """
-00012f10: 0a0a 2020 2020 2020 2020 6465 6620 6170  ..        def ap
-00012f20: 706c 795f 6966 5f63 616c 6c61 626c 6528  ply_if_callable(
-00012f30: 6d61 7962 655f 6361 6c6c 6162 6c65 2c20  maybe_callable, 
-00012f40: 6f62 6a2c 202a 2a6b 7761 7267 7329 3a0a  obj, **kwargs):.
-00012f50: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00012f60: 616c 6c61 626c 6528 6d61 7962 655f 6361  allable(maybe_ca
-00012f70: 6c6c 6162 6c65 293a 0a20 2020 2020 2020  llable):.       
-00012f80: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00012f90: 6d61 7962 655f 6361 6c6c 6162 6c65 286f  maybe_callable(o
-00012fa0: 626a 2c20 2a2a 6b77 6172 6773 290a 0a20  bj, **kwargs).. 
-00012fb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00012fc0: 6e20 6d61 7962 655f 6361 6c6c 6162 6c65  n maybe_callable
-00012fd0: 0a0a 2020 2020 2020 2020 6461 7461 203d  ..        data =
-00012fe0: 2073 656c 662e 636f 7079 2829 0a0a 2020   self.copy()..  
-00012ff0: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
-00013000: 6e20 6b77 6172 6773 2e69 7465 6d73 2829  n kwargs.items()
-00013010: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
-00013020: 7461 5b6b 5d20 3d20 6170 706c 795f 6966  ta[k] = apply_if
-00013030: 5f63 616c 6c61 626c 6528 762c 2064 6174  _callable(v, dat
-00013040: 6129 0a20 2020 2020 2020 2072 6574 7572  a).        retur
-00013050: 6e20 6461 7461 0a0a 0a63 6c61 7373 2044  n data...class D
-00013060: 6174 6146 7261 6d65 4772 6f75 7042 7943  ataFrameGroupByC
-00013070: 6875 6e6b 4461 7461 2842 6173 6544 6174  hunkData(BaseDat
-00013080: 6146 7261 6d65 4368 756e 6b44 6174 6129  aFrameChunkData)
-00013090: 3a0a 2020 2020 7479 7065 5f6e 616d 6520  :.    type_name 
-000130a0: 3d20 2244 6174 6146 7261 6d65 4772 6f75  = "DataFrameGrou
-000130b0: 7042 7922 0a0a 2020 2020 5f6b 6579 5f64  pBy"..    _key_d
-000130c0: 7479 7065 7320 3d20 5365 7269 6573 4669  types = SeriesFi
-000130d0: 656c 6428 226b 6579 5f64 7479 7065 7322  eld("key_dtypes"
-000130e0: 290a 2020 2020 5f73 656c 6563 7469 6f6e  ).    _selection
-000130f0: 203d 2041 6e79 4669 656c 6428 2273 656c   = AnyField("sel
-00013100: 6563 7469 6f6e 2229 0a0a 2020 2020 4070  ection")..    @p
-00013110: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00013120: 6b65 795f 6474 7970 6573 2873 656c 6629  key_dtypes(self)
-00013130: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00013140: 2073 656c 662e 5f6b 6579 5f64 7479 7065   self._key_dtype
-00013150: 730a 0a20 2020 2040 7072 6f70 6572 7479  s..    @property
-00013160: 0a20 2020 2064 6566 2073 656c 6563 7469  .    def selecti
-00013170: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
-00013180: 2020 7265 7475 726e 2073 656c 662e 5f73    return self._s
-00013190: 656c 6563 7469 6f6e 0a0a 2020 2020 6465  election..    de
-000131a0: 6620 5f67 6574 5f70 6172 616d 7328 7365  f _get_params(se
-000131b0: 6c66 2920 2d3e 2044 6963 745b 7374 722c  lf) -> Dict[str,
-000131c0: 2041 6e79 5d3a 0a20 2020 2020 2020 2070   Any]:.        p
-000131d0: 203d 2073 7570 6572 2829 2e5f 6765 745f   = super()._get_
-000131e0: 7061 7261 6d73 2829 0a20 2020 2020 2020  params().       
-000131f0: 2070 2e75 7064 6174 6528 6469 6374 286b   p.update(dict(k
-00013200: 6579 5f64 7479 7065 733d 7365 6c66 2e6b  ey_dtypes=self.k
-00013210: 6579 5f64 7479 7065 732c 2073 656c 6563  ey_dtypes, selec
-00013220: 7469 6f6e 3d73 656c 662e 7365 6c65 6374  tion=self.select
-00013230: 696f 6e29 290a 2020 2020 2020 2020 7265  ion)).        re
-00013240: 7475 726e 2070 0a0a 2020 2020 6465 6620  turn p..    def 
-00013250: 5f73 6574 5f70 6172 616d 7328 7365 6c66  _set_params(self
-00013260: 2c20 6e65 775f 7061 7261 6d73 3a20 4469  , new_params: Di
-00013270: 6374 5b73 7472 2c20 416e 795d 293a 0a20  ct[str, Any]):. 
-00013280: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-00013290: 6e65 775f 7061 7261 6d73 2e63 6f70 7928  new_params.copy(
-000132a0: 290a 2020 2020 2020 2020 6b65 795f 6474  ).        key_dt
-000132b0: 7970 6573 203d 2070 6172 616d 732e 706f  ypes = params.po
-000132c0: 7028 226b 6579 5f64 7479 7065 7322 2c20  p("key_dtypes", 
-000132d0: 4e6f 6e65 290a 2020 2020 2020 2020 6966  None).        if
-000132e0: 206b 6579 5f64 7479 7065 7320 6973 206e   key_dtypes is n
-000132f0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00013300: 2020 2020 2073 656c 662e 5f6b 6579 5f64       self._key_d
-00013310: 7479 7065 7320 3d20 6b65 795f 6474 7970  types = key_dtyp
-00013320: 6573 0a20 2020 2020 2020 2073 656c 6563  es.        selec
-00013330: 7469 6f6e 203d 2070 6172 616d 732e 706f  tion = params.po
-00013340: 7028 2273 656c 6563 7469 6f6e 222c 204e  p("selection", N
-00013350: 6f6e 6529 0a20 2020 2020 2020 2069 6620  one).        if 
-00013360: 7365 6c65 6374 696f 6e20 6973 206e 6f74  selection is not
-00013370: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00013380: 2020 2073 656c 662e 5f73 656c 6563 7469     self._selecti
-00013390: 6f6e 203d 2073 656c 6563 7469 6f6e 0a20  on = selection. 
-000133a0: 2020 2020 2020 2073 7570 6572 2829 2e5f         super()._
-000133b0: 7365 745f 7061 7261 6d73 2870 6172 616d  set_params(param
-000133c0: 7329 0a0a 2020 2020 7061 7261 6d73 203d  s)..    params =
-000133d0: 2070 726f 7065 7274 7928 5f67 6574 5f70   property(_get_p
-000133e0: 6172 616d 732c 205f 7365 745f 7061 7261  arams, _set_para
-000133f0: 6d73 290a 0a20 2020 2040 636c 6173 736d  ms)..    @classm
-00013400: 6574 686f 640a 2020 2020 6465 6620 6765  ethod.    def ge
-00013410: 745f 7061 7261 6d73 5f66 726f 6d5f 6461  t_params_from_da
-00013420: 7461 2863 6c73 2c20 6461 7461 3a20 4772  ta(cls, data: Gr
-00013430: 6f75 7042 7957 7261 7070 6572 2920 2d3e  oupByWrapper) ->
-00013440: 2044 6963 745b 7374 722c 2041 6e79 5d3a   Dict[str, Any]:
-00013450: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-00013460: 3d20 7375 7065 7228 292e 6765 745f 7061  = super().get_pa
-00013470: 7261 6d73 5f66 726f 6d5f 6461 7461 2864  rams_from_data(d
-00013480: 6174 612e 6f62 6a29 0a20 2020 2020 2020  ata.obj).       
-00013490: 2069 6620 6461 7461 2e73 656c 6563 7469   if data.selecti
-000134a0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-000134b0: 6474 7970 6573 203d 2070 6172 616d 735b  dtypes = params[
-000134c0: 2264 7479 7065 735f 7661 6c75 6522 5d2e  "dtypes_value"].
-000134d0: 7661 6c75 655b 6461 7461 2e73 656c 6563  value[data.selec
-000134e0: 7469 6f6e 5d0a 2020 2020 2020 2020 2020  tion].          
-000134f0: 2020 7061 7261 6d73 5b22 6474 7970 6573    params["dtypes
-00013500: 5f76 616c 7565 225d 203d 2044 7479 7065  _value"] = Dtype
-00013510: 7356 616c 7565 2876 616c 7565 3d64 7479  sValue(value=dty
-00013520: 7065 7329 0a20 2020 2020 2020 2020 2020  pes).           
-00013530: 2070 6172 616d 735b 2273 6861 7065 225d   params["shape"]
-00013540: 203d 2064 6174 612e 7368 6170 650a 2020   = data.shape.  
-00013550: 2020 2020 2020 7265 7475 726e 2070 6172        return par
-00013560: 616d 730a 0a20 2020 2064 6566 205f 5f69  ams..    def __i
-00013570: 6e69 745f 5f28 7365 6c66 2c20 6b65 795f  nit__(self, key_
-00013580: 6474 7970 6573 3d4e 6f6e 652c 2073 656c  dtypes=None, sel
-00013590: 6563 7469 6f6e 3d4e 6f6e 652c 202a 2a6b  ection=None, **k
-000135a0: 7729 3a0a 2020 2020 2020 2020 7375 7065  w):.        supe
-000135b0: 7228 292e 5f5f 696e 6974 5f5f 285f 6b65  r().__init__(_ke
-000135c0: 795f 6474 7970 6573 3d6b 6579 5f64 7479  y_dtypes=key_dty
-000135d0: 7065 732c 205f 7365 6c65 6374 696f 6e3d  pes, _selection=
-000135e0: 7365 6c65 6374 696f 6e2c 202a 2a6b 7729  selection, **kw)
-000135f0: 0a0a 0a63 6c61 7373 2044 6174 6146 7261  ...class DataFra
-00013600: 6d65 4772 6f75 7042 7943 6875 6e6b 2843  meGroupByChunk(C
-00013610: 6875 6e6b 293a 0a20 2020 205f 5f73 6c6f  hunk):.    __slo
-00013620: 7473 5f5f 203d 2028 290a 2020 2020 5f61  ts__ = ().    _a
-00013630: 6c6c 6f77 5f64 6174 615f 7479 7065 5f20  llow_data_type_ 
-00013640: 3d20 2844 6174 6146 7261 6d65 4772 6f75  = (DataFrameGrou
-00013650: 7042 7943 6875 6e6b 4461 7461 2c29 0a20  pByChunkData,). 
-00013660: 2020 2074 7970 655f 6e61 6d65 203d 2022     type_name = "
-00013670: 4461 7461 4672 616d 6547 726f 7570 4279  DataFrameGroupBy
-00013680: 220a 0a20 2020 2064 6566 205f 5f6c 656e  "..    def __len
-00013690: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-000136a0: 2020 7265 7475 726e 206c 656e 2873 656c    return len(sel
-000136b0: 662e 5f64 6174 6129 0a0a 0a63 6c61 7373  f._data)...class
-000136c0: 2053 6572 6965 7347 726f 7570 4279 4368   SeriesGroupByCh
-000136d0: 756e 6b44 6174 6128 4261 7365 5365 7269  unkData(BaseSeri
-000136e0: 6573 4368 756e 6b44 6174 6129 3a0a 2020  esChunkData):.  
-000136f0: 2020 7479 7065 5f6e 616d 6520 3d20 2253    type_name = "S
-00013700: 6572 6965 7347 726f 7570 4279 220a 0a20  eriesGroupBy".. 
-00013710: 2020 205f 6b65 795f 6474 7970 6573 203d     _key_dtypes =
-00013720: 2041 6e79 4669 656c 6428 226b 6579 5f64   AnyField("key_d
-00013730: 7479 7065 7322 290a 0a20 2020 2040 7072  types")..    @pr
-00013740: 6f70 6572 7479 0a20 2020 2064 6566 206b  operty.    def k
-00013750: 6579 5f64 7479 7065 7328 7365 6c66 293a  ey_dtypes(self):
-00013760: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00013770: 7365 6c66 2e5f 6b65 795f 6474 7970 6573  self._key_dtypes
-00013780: 0a0a 2020 2020 6465 6620 5f67 6574 5f70  ..    def _get_p
-00013790: 6172 616d 7328 7365 6c66 2920 2d3e 2044  arams(self) -> D
-000137a0: 6963 745b 7374 722c 2041 6e79 5d3a 0a20  ict[str, Any]:. 
-000137b0: 2020 2020 2020 2070 203d 2073 7570 6572         p = super
-000137c0: 2829 2e5f 6765 745f 7061 7261 6d73 2829  ()._get_params()
-000137d0: 0a20 2020 2020 2020 2070 5b22 6b65 795f  .        p["key_
-000137e0: 6474 7970 6573 225d 203d 2073 656c 662e  dtypes"] = self.
-000137f0: 6b65 795f 6474 7970 6573 0a20 2020 2020  key_dtypes.     
-00013800: 2020 2072 6574 7572 6e20 700a 0a20 2020     return p..   
-00013810: 2064 6566 205f 7365 745f 7061 7261 6d73   def _set_params
-00013820: 2873 656c 662c 206e 6577 5f70 6172 616d  (self, new_param
-00013830: 733a 2044 6963 745b 7374 722c 2041 6e79  s: Dict[str, Any
-00013840: 5d29 3a0a 2020 2020 2020 2020 7061 7261  ]):.        para
-00013850: 6d73 203d 206e 6577 5f70 6172 616d 732e  ms = new_params.
-00013860: 636f 7079 2829 0a20 2020 2020 2020 206b  copy().        k
-00013870: 6579 5f64 7479 7065 7320 3d20 7061 7261  ey_dtypes = para
-00013880: 6d73 2e70 6f70 2822 6b65 795f 6474 7970  ms.pop("key_dtyp
-00013890: 6573 222c 204e 6f6e 6529 0a20 2020 2020  es", None).     
-000138a0: 2020 2069 6620 6b65 795f 6474 7970 6573     if key_dtypes
-000138b0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-000138c0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-000138d0: 6b65 795f 6474 7970 6573 203d 206b 6579  key_dtypes = key
-000138e0: 5f64 7479 7065 730a 2020 2020 2020 2020  _dtypes.        
-000138f0: 7375 7065 7228 292e 5f73 6574 5f70 6172  super()._set_par
-00013900: 616d 7328 6e65 775f 7061 7261 6d73 290a  ams(new_params).
-00013910: 0a20 2020 2070 6172 616d 7320 3d20 7072  .    params = pr
-00013920: 6f70 6572 7479 285f 6765 745f 7061 7261  operty(_get_para
-00013930: 6d73 2c20 5f73 6574 5f70 6172 616d 7329  ms, _set_params)
-00013940: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
-00013950: 6f64 0a20 2020 2064 6566 2067 6574 5f70  od.    def get_p
-00013960: 6172 616d 735f 6672 6f6d 5f64 6174 6128  arams_from_data(
-00013970: 636c 732c 2064 6174 613a 2047 726f 7570  cls, data: Group
-00013980: 4279 5772 6170 7065 7229 3a0a 2020 2020  ByWrapper):.    
-00013990: 2020 2020 7365 7269 6573 5f6e 616d 6520      series_name 
-000139a0: 3d20 6461 7461 2e73 656c 6563 7469 6f6e  = data.selection
-000139b0: 206f 7220 6461 7461 2e6f 626a 2e6e 616d   or data.obj.nam
-000139c0: 650a 2020 2020 2020 2020 6966 2068 6173  e.        if has
-000139d0: 6174 7472 2864 6174 612e 6f62 6a2c 2022  attr(data.obj, "
-000139e0: 6474 7970 6522 293a 0a20 2020 2020 2020  dtype"):.       
-000139f0: 2020 2020 2064 7479 7065 203d 2064 6174       dtype = dat
-00013a00: 612e 6f62 6a2e 6474 7970 650a 2020 2020  a.obj.dtype.    
-00013a10: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00013a20: 2020 2020 2020 6474 7970 6520 3d20 6461        dtype = da
-00013a30: 7461 2e6f 626a 2e64 7479 7065 735b 7365  ta.obj.dtypes[se
-00013a40: 7269 6573 5f6e 616d 655d 0a0a 2020 2020  ries_name]..    
-00013a50: 2020 2020 7265 7475 726e 207b 0a20 2020      return {.   
-00013a60: 2020 2020 2020 2020 2022 7368 6170 6522           "shape"
-00013a70: 3a20 2864 6174 612e 6f62 6a2e 7368 6170  : (data.obj.shap
-00013a80: 655b 305d 2c29 2c0a 2020 2020 2020 2020  e[0],),.        
-00013a90: 2020 2020 2264 7479 7065 223a 2064 7479      "dtype": dty
-00013aa0: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-00013ab0: 2269 6e64 6578 5f76 616c 7565 223a 2070  "index_value": p
-00013ac0: 6172 7365 5f69 6e64 6578 2864 6174 612e  arse_index(data.
-00013ad0: 6f62 6a2e 696e 6465 782c 2073 746f 7265  obj.index, store
-00013ae0: 5f64 6174 613d 4661 6c73 6529 2c0a 2020  _data=False),.  
-00013af0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-00013b00: 3a20 7365 7269 6573 5f6e 616d 652c 0a20  : series_name,. 
-00013b10: 2020 2020 2020 207d 0a0a 2020 2020 6465         }..    de
-00013b20: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-00013b30: 206b 6579 5f64 7479 7065 733d 4e6f 6e65   key_dtypes=None
-00013b40: 2c20 2a2a 6b77 293a 0a20 2020 2020 2020  , **kw):.       
-00013b50: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
-00013b60: 5f28 5f6b 6579 5f64 7479 7065 733d 6b65  _(_key_dtypes=ke
-00013b70: 795f 6474 7970 6573 2c20 2a2a 6b77 290a  y_dtypes, **kw).
-00013b80: 0a0a 636c 6173 7320 5365 7269 6573 4772  ..class SeriesGr
-00013b90: 6f75 7042 7943 6875 6e6b 2843 6875 6e6b  oupByChunk(Chunk
-00013ba0: 293a 0a20 2020 205f 5f73 6c6f 7473 5f5f  ):.    __slots__
-00013bb0: 203d 2028 290a 2020 2020 5f61 6c6c 6f77   = ().    _allow
-00013bc0: 5f64 6174 615f 7479 7065 5f20 3d20 2853  _data_type_ = (S
-00013bd0: 6572 6965 7347 726f 7570 4279 4368 756e  eriesGroupByChun
-00013be0: 6b44 6174 612c 290a 2020 2020 7479 7065  kData,).    type
-00013bf0: 5f6e 616d 6520 3d20 2253 6572 6965 7347  _name = "SeriesG
-00013c00: 726f 7570 4279 220a 0a20 2020 2064 6566  roupBy"..    def
-00013c10: 205f 5f6c 656e 5f5f 2873 656c 6629 3a0a   __len__(self):.
-00013c20: 2020 2020 2020 2020 7265 7475 726e 206c          return l
-00013c30: 656e 2873 656c 662e 5f64 6174 6129 0a0a  en(self._data)..
-00013c40: 0a63 6c61 7373 2044 6174 6146 7261 6d65  .class DataFrame
-00013c50: 4772 6f75 7042 7944 6174 6128 4261 7365  GroupByData(Base
-00013c60: 4461 7461 4672 616d 6544 6174 6129 3a0a  DataFrameData):.
-00013c70: 2020 2020 7479 7065 5f6e 616d 6520 3d20      type_name = 
-00013c80: 2244 6174 6146 7261 6d65 4772 6f75 7042  "DataFrameGroupB
-00013c90: 7922 0a0a 2020 2020 5f6b 6579 5f64 7479  y"..    _key_dty
-00013ca0: 7065 7320 3d20 5365 7269 6573 4669 656c  pes = SeriesFiel
-00013cb0: 6428 226b 6579 5f64 7479 7065 7322 290a  d("key_dtypes").
-00013cc0: 2020 2020 5f73 656c 6563 7469 6f6e 203d      _selection =
-00013cd0: 2041 6e79 4669 656c 6428 2273 656c 6563   AnyField("selec
-00013ce0: 7469 6f6e 2229 0a20 2020 205f 6368 756e  tion").    _chun
-00013cf0: 6b73 203d 204c 6973 7446 6965 6c64 280a  ks = ListField(.
-00013d00: 2020 2020 2020 2020 2263 6875 6e6b 7322          "chunks"
-00013d10: 2c0a 2020 2020 2020 2020 4669 656c 6454  ,.        FieldT
-00013d20: 7970 6573 2e72 6566 6572 656e 6365 2844  ypes.reference(D
-00013d30: 6174 6146 7261 6d65 4772 6f75 7042 7943  ataFrameGroupByC
-00013d40: 6875 6e6b 4461 7461 292c 0a20 2020 2020  hunkData),.     
-00013d50: 2020 206f 6e5f 7365 7269 616c 697a 653d     on_serialize=
-00013d60: 6c61 6d62 6461 2078 3a20 5b69 742e 6461  lambda x: [it.da
-00013d70: 7461 2066 6f72 2069 7420 696e 2078 5d20  ta for it in x] 
-00013d80: 6966 2078 2069 7320 6e6f 7420 4e6f 6e65  if x is not None
-00013d90: 2065 6c73 6520 782c 0a20 2020 2020 2020   else x,.       
-00013da0: 206f 6e5f 6465 7365 7269 616c 697a 653d   on_deserialize=
-00013db0: 6c61 6d62 6461 2078 3a20 5b44 6174 6146  lambda x: [DataF
-00013dc0: 7261 6d65 4772 6f75 7042 7943 6875 6e6b  rameGroupByChunk
-00013dd0: 2869 7429 2066 6f72 2069 7420 696e 2078  (it) for it in x
-00013de0: 5d0a 2020 2020 2020 2020 6966 2078 2069  ].        if x i
-00013df0: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
-00013e00: 2020 2065 6c73 6520 782c 0a20 2020 2029     else x,.    )
-00013e10: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00013e20: 2020 2020 6465 6620 6b65 795f 6474 7970      def key_dtyp
-00013e30: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
-00013e40: 2020 7265 7475 726e 2073 656c 662e 5f6b    return self._k
-00013e50: 6579 5f64 7479 7065 730a 0a20 2020 2040  ey_dtypes..    @
-00013e60: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00013e70: 2073 656c 6563 7469 6f6e 2873 656c 6629   selection(self)
-00013e80: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00013e90: 2073 656c 662e 5f73 656c 6563 7469 6f6e   self._selection
-00013ea0: 0a0a 2020 2020 6465 6620 5f67 6574 5f70  ..    def _get_p
-00013eb0: 6172 616d 7328 7365 6c66 2920 2d3e 2044  arams(self) -> D
-00013ec0: 6963 745b 7374 722c 2041 6e79 5d3a 0a20  ict[str, Any]:. 
-00013ed0: 2020 2020 2020 2070 203d 2073 7570 6572         p = super
-00013ee0: 2829 2e5f 6765 745f 7061 7261 6d73 2829  ()._get_params()
-00013ef0: 0a20 2020 2020 2020 2070 2e75 7064 6174  .        p.updat
-00013f00: 6528 6469 6374 286b 6579 5f64 7479 7065  e(dict(key_dtype
-00013f10: 733d 7365 6c66 2e6b 6579 5f64 7479 7065  s=self.key_dtype
-00013f20: 732c 2073 656c 6563 7469 6f6e 3d73 656c  s, selection=sel
-00013f30: 662e 7365 6c65 6374 696f 6e29 290a 2020  f.selection)).  
-00013f40: 2020 2020 2020 7265 7475 726e 2070 0a0a        return p..
-00013f50: 2020 2020 6465 6620 5f73 6574 5f70 6172      def _set_par
-00013f60: 616d 7328 7365 6c66 2c20 6e65 775f 7061  ams(self, new_pa
-00013f70: 7261 6d73 3a20 4469 6374 5b73 7472 2c20  rams: Dict[str, 
-00013f80: 416e 795d 293a 0a20 2020 2020 2020 2070  Any]):.        p
-00013f90: 6172 616d 7320 3d20 6e65 775f 7061 7261  arams = new_para
-00013fa0: 6d73 2e63 6f70 7928 290a 2020 2020 2020  ms.copy().      
-00013fb0: 2020 6b65 795f 6474 7970 6573 203d 2070    key_dtypes = p
-00013fc0: 6172 616d 732e 706f 7028 226b 6579 5f64  arams.pop("key_d
-00013fd0: 7479 7065 7322 2c20 4e6f 6e65 290a 2020  types", None).  
-00013fe0: 2020 2020 2020 6966 206b 6579 5f64 7479        if key_dty
-00013ff0: 7065 7320 6973 206e 6f74 204e 6f6e 653a  pes is not None:
-00014000: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00014010: 662e 5f6b 6579 5f64 7479 7065 7320 3d20  f._key_dtypes = 
-00014020: 6b65 795f 6474 7970 6573 0a20 2020 2020  key_dtypes.     
-00014030: 2020 2073 656c 6563 7469 6f6e 203d 2070     selection = p
-00014040: 6172 616d 732e 706f 7028 2273 656c 6563  arams.pop("selec
-00014050: 7469 6f6e 222c 204e 6f6e 6529 0a20 2020  tion", None).   
-00014060: 2020 2020 2069 6620 7365 6c65 6374 696f       if selectio
-00014070: 6e20 6973 206e 6f74 204e 6f6e 653a 0a20  n is not None:. 
-00014080: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00014090: 5f73 656c 6563 7469 6f6e 203d 2073 656c  _selection = sel
-000140a0: 6563 7469 6f6e 0a20 2020 2020 2020 2073  ection.        s
-000140b0: 7570 6572 2829 2e5f 7365 745f 7061 7261  uper()._set_para
-000140c0: 6d73 2870 6172 616d 7329 0a0a 2020 2020  ms(params)..    
-000140d0: 7061 7261 6d73 203d 2070 726f 7065 7274  params = propert
-000140e0: 7928 5f67 6574 5f70 6172 616d 732c 205f  y(_get_params, _
-000140f0: 7365 745f 7061 7261 6d73 290a 0a20 2020  set_params)..   
-00014100: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-00014110: 6c66 2c20 6b65 795f 6474 7970 6573 3d4e  lf, key_dtypes=N
-00014120: 6f6e 652c 2073 656c 6563 7469 6f6e 3d4e  one, selection=N
-00014130: 6f6e 652c 202a 2a6b 7729 3a0a 2020 2020  one, **kw):.    
-00014140: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
-00014150: 6974 5f5f 285f 6b65 795f 6474 7970 6573  it__(_key_dtypes
-00014160: 3d6b 6579 5f64 7479 7065 732c 205f 7365  =key_dtypes, _se
-00014170: 6c65 6374 696f 6e3d 7365 6c65 6374 696f  lection=selectio
-00014180: 6e2c 202a 2a6b 7729 0a0a 2020 2020 6465  n, **kw)..    de
-00014190: 6620 5f65 7175 616c 2873 656c 662c 206f  f _equal(self, o
-000141a0: 293a 0a20 2020 2020 2020 2023 2046 4958  ):.        # FIX
-000141b0: 4d45 2057 6520 6e65 6564 2074 6f20 696d  ME We need to im
-000141c0: 706c 656d 656e 7465 6420 6120 7472 7565  plemented a true
-000141d0: 2060 3d3d 6020 6f70 6572 6174 6f72 2066   `==` operator f
-000141e0: 6f72 2044 6174 6146 7261 6d65 4772 6f75  or DataFrameGrou
-000141f0: 7062 790a 2020 2020 2020 2020 6966 2069  pby.        if i
-00014200: 735f 6275 696c 645f 6d6f 6465 2829 3a0a  s_build_mode():.
-00014210: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00014220: 726e 2073 656c 6620 6973 206f 0a20 2020  rn self is o.   
-00014230: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00014240: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00014250: 6c66 203d 3d20 6f0a 0a0a 636c 6173 7320  lf == o...class 
-00014260: 5365 7269 6573 4772 6f75 7042 7944 6174  SeriesGroupByDat
-00014270: 6128 4261 7365 5365 7269 6573 4461 7461  a(BaseSeriesData
-00014280: 293a 0a20 2020 2074 7970 655f 6e61 6d65  ):.    type_name
-00014290: 203d 2022 5365 7269 6573 4772 6f75 7042   = "SeriesGroupB
-000142a0: 7922 0a0a 2020 2020 5f6b 6579 5f64 7479  y"..    _key_dty
-000142b0: 7065 7320 3d20 416e 7946 6965 6c64 2822  pes = AnyField("
-000142c0: 6b65 795f 6474 7970 6573 2229 0a20 2020  key_dtypes").   
-000142d0: 205f 6368 756e 6b73 203d 204c 6973 7446   _chunks = ListF
-000142e0: 6965 6c64 280a 2020 2020 2020 2020 2263  ield(.        "c
-000142f0: 6875 6e6b 7322 2c0a 2020 2020 2020 2020  hunks",.        
-00014300: 4669 656c 6454 7970 6573 2e72 6566 6572  FieldTypes.refer
-00014310: 656e 6365 2853 6572 6965 7347 726f 7570  ence(SeriesGroup
-00014320: 4279 4368 756e 6b44 6174 6129 2c0a 2020  ByChunkData),.  
-00014330: 2020 2020 2020 6f6e 5f73 6572 6961 6c69        on_seriali
-00014340: 7a65 3d6c 616d 6264 6120 783a 205b 6974  ze=lambda x: [it
-00014350: 2e64 6174 6120 666f 7220 6974 2069 6e20  .data for it in 
-00014360: 785d 2069 6620 7820 6973 206e 6f74 204e  x] if x is not N
-00014370: 6f6e 6520 656c 7365 2078 2c0a 2020 2020  one else x,.    
-00014380: 2020 2020 6f6e 5f64 6573 6572 6961 6c69      on_deseriali
-00014390: 7a65 3d6c 616d 6264 6120 783a 205b 5365  ze=lambda x: [Se
-000143a0: 7269 6573 4772 6f75 7042 7943 6875 6e6b  riesGroupByChunk
-000143b0: 2869 7429 2066 6f72 2069 7420 696e 2078  (it) for it in x
-000143c0: 5d0a 2020 2020 2020 2020 6966 2078 2069  ].        if x i
-000143d0: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
-000143e0: 2020 2065 6c73 6520 782c 0a20 2020 2029     else x,.    )
-000143f0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00014400: 2020 2020 6465 6620 6b65 795f 6474 7970      def key_dtyp
-00014410: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
-00014420: 2020 7265 7475 726e 2073 656c 662e 5f6b    return self._k
-00014430: 6579 5f64 7479 7065 730a 0a20 2020 2064  ey_dtypes..    d
-00014440: 6566 205f 6765 745f 7061 7261 6d73 2873  ef _get_params(s
-00014450: 656c 6629 202d 3e20 4469 6374 5b73 7472  elf) -> Dict[str
-00014460: 2c20 416e 795d 3a0a 2020 2020 2020 2020  , Any]:.        
-00014470: 7020 3d20 7375 7065 7228 292e 5f67 6574  p = super()._get
-00014480: 5f70 6172 616d 7328 290a 2020 2020 2020  _params().      
-00014490: 2020 705b 226b 6579 5f64 7479 7065 7322    p["key_dtypes"
-000144a0: 5d20 3d20 7365 6c66 2e6b 6579 5f64 7479  ] = self.key_dty
-000144b0: 7065 730a 2020 2020 2020 2020 7265 7475  pes.        retu
-000144c0: 726e 2070 0a0a 2020 2020 6465 6620 5f73  rn p..    def _s
-000144d0: 6574 5f70 6172 616d 7328 7365 6c66 2c20  et_params(self, 
-000144e0: 6e65 775f 7061 7261 6d73 3a20 4469 6374  new_params: Dict
-000144f0: 5b73 7472 2c20 416e 795d 293a 0a20 2020  [str, Any]):.   
-00014500: 2020 2020 2070 6172 616d 7320 3d20 6e65       params = ne
-00014510: 775f 7061 7261 6d73 2e63 6f70 7928 290a  w_params.copy().
-00014520: 2020 2020 2020 2020 6b65 795f 6474 7970          key_dtyp
-00014530: 6573 203d 2070 6172 616d 732e 706f 7028  es = params.pop(
-00014540: 226b 6579 5f64 7479 7065 7322 2c20 4e6f  "key_dtypes", No
-00014550: 6e65 290a 2020 2020 2020 2020 6966 206b  ne).        if k
-00014560: 6579 5f64 7479 7065 7320 6973 206e 6f74  ey_dtypes is not
-00014570: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00014580: 2020 2073 656c 662e 5f6b 6579 5f64 7479     self._key_dty
-00014590: 7065 7320 3d20 6b65 795f 6474 7970 6573  pes = key_dtypes
-000145a0: 0a20 2020 2020 2020 2073 7570 6572 2829  .        super()
-000145b0: 2e5f 7365 745f 7061 7261 6d73 2870 6172  ._set_params(par
-000145c0: 616d 7329 0a0a 2020 2020 7061 7261 6d73  ams)..    params
-000145d0: 203d 2070 726f 7065 7274 7928 5f67 6574   = property(_get
-000145e0: 5f70 6172 616d 732c 205f 7365 745f 7061  _params, _set_pa
-000145f0: 7261 6d73 290a 0a20 2020 2064 6566 205f  rams)..    def _
-00014600: 5f69 6e69 745f 5f28 7365 6c66 2c20 6b65  _init__(self, ke
-00014610: 795f 6474 7970 6573 3d4e 6f6e 652c 202a  y_dtypes=None, *
-00014620: 2a6b 7729 3a0a 2020 2020 2020 2020 7375  *kw):.        su
-00014630: 7065 7228 292e 5f5f 696e 6974 5f5f 285f  per().__init__(_
-00014640: 6b65 795f 6474 7970 6573 3d6b 6579 5f64  key_dtypes=key_d
-00014650: 7479 7065 732c 202a 2a6b 7729 0a0a 2020  types, **kw)..  
-00014660: 2020 6465 6620 5f65 7175 616c 2873 656c    def _equal(sel
-00014670: 662c 206f 293a 0a20 2020 2020 2020 2023  f, o):.        #
-00014680: 2046 4958 4d45 2057 6520 6e65 6564 2074   FIXME We need t
-00014690: 6f20 696d 706c 656d 656e 7465 6420 6120  o implemented a 
-000146a0: 7472 7565 2060 3d3d 6020 6f70 6572 6174  true `==` operat
-000146b0: 6f72 2066 6f72 2044 6174 6146 7261 6d65  or for DataFrame
-000146c0: 4772 6f75 7062 790a 2020 2020 2020 2020  Groupby.        
-000146d0: 6966 2069 735f 6275 696c 645f 6d6f 6465  if is_build_mode
-000146e0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-000146f0: 7265 7475 726e 2073 656c 6620 6973 206f  return self is o
-00014700: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00014710: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00014720: 6e20 7365 6c66 203d 3d20 6f0a 0a0a 636c  n self == o...cl
-00014730: 6173 7320 4772 6f75 7042 7928 5469 6c65  ass GroupBy(Tile
-00014740: 6162 6c65 2c20 5f54 6f50 616e 6461 734d  able, _ToPandasM
-00014750: 6978 696e 293a 0a20 2020 205f 5f73 6c6f  ixin):.    __slo
-00014760: 7473 5f5f 203d 2028 290a 0a0a 636c 6173  ts__ = ()...clas
-00014770: 7320 4461 7461 4672 616d 6547 726f 7570  s DataFrameGroup
-00014780: 4279 2847 726f 7570 4279 293a 0a20 2020  By(GroupBy):.   
-00014790: 205f 5f73 6c6f 7473 5f5f 203d 2028 290a   __slots__ = ().
-000147a0: 2020 2020 5f61 6c6c 6f77 5f64 6174 615f      _allow_data_
-000147b0: 7479 7065 5f20 3d20 2844 6174 6146 7261  type_ = (DataFra
-000147c0: 6d65 4772 6f75 7042 7944 6174 612c 290a  meGroupByData,).
-000147d0: 2020 2020 7479 7065 5f6e 616d 6520 3d20      type_name = 
-000147e0: 2244 6174 6146 7261 6d65 4772 6f75 7042  "DataFrameGroupB
-000147f0: 7922 0a0a 2020 2020 6465 6620 5f5f 6571  y"..    def __eq
-00014800: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
-00014810: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00014820: 7365 6c66 2e5f 6571 7561 6c28 6f74 6865  self._equal(othe
-00014830: 7229 0a0a 2020 2020 6465 6620 5f5f 6861  r)..    def __ha
-00014840: 7368 5f5f 2873 656c 6629 3a0a 2020 2020  sh__(self):.    
-00014850: 2020 2020 2320 4e42 3a20 7765 2068 6176      # NB: we hav
-00014860: 6520 6375 7374 6f6d 697a 6564 205f 5f65  e customized __e
-00014870: 715f 5f20 6578 706c 6963 6974 6c79 2c20  q__ explicitly, 
-00014880: 7468 7573 2077 6520 6e65 6564 2064 6566  thus we need def
-00014890: 696e 6520 5f5f 6861 7368 5f5f 2065 7870  ine __hash__ exp
-000148a0: 6c69 6369 746c 7920 6173 2077 656c 6c2e  licitly as well.
-000148b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000148c0: 7375 7065 7228 292e 5f5f 6861 7368 5f5f  super().__hash__
-000148d0: 2829 0a0a 2020 2020 6465 6620 5f5f 6765  ()..    def __ge
-000148e0: 7461 7474 725f 5f28 7365 6c66 2c20 6974  tattr__(self, it
-000148f0: 656d 293a 0a20 2020 2020 2020 2074 7279  em):.        try
-00014900: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00014910: 7475 726e 2073 7570 6572 2829 2e5f 5f67  turn super().__g
-00014920: 6574 6174 7472 5f5f 2869 7465 6d29 0a20  etattr__(item). 
-00014930: 2020 2020 2020 2065 7863 6570 7420 4174         except At
-00014940: 7472 6962 7574 6545 7272 6f72 3a0a 2020  tributeError:.  
-00014950: 2020 2020 2020 2020 2020 6966 2069 7465            if ite
-00014960: 6d20 696e 2073 656c 662e 6474 7970 6573  m in self.dtypes
-00014970: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00014980: 2020 7265 7475 726e 2073 656c 665b 6974    return self[it
-00014990: 656d 5d0a 2020 2020 2020 2020 2020 2020  em].            
-000149a0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000149b0: 2020 2020 2020 7261 6973 650a 0a20 2020        raise..   
-000149c0: 2064 6566 205f 5f64 6972 5f5f 2873 656c   def __dir__(sel
-000149d0: 6629 3a0a 2020 2020 2020 2020 7265 7375  f):.        resu
-000149e0: 6c74 203d 206c 6973 7428 7375 7065 7228  lt = list(super(
-000149f0: 292e 5f5f 6469 725f 5f28 2929 0a20 2020  ).__dir__()).   
-00014a00: 2020 2020 2072 6574 7572 6e20 736f 7274       return sort
-00014a10: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
-00014a20: 7265 7375 6c74 0a20 2020 2020 2020 2020  result.         
-00014a30: 2020 202b 205b 6b20 666f 7220 6b20 696e     + [k for k in
-00014a40: 2073 656c 662e 6474 7970 6573 2e69 6e64   self.dtypes.ind
-00014a50: 6578 2069 6620 6973 696e 7374 616e 6365  ex if isinstance
-00014a60: 286b 2c20 7374 7229 2061 6e64 206b 2e69  (k, str) and k.i
-00014a70: 7369 6465 6e74 6966 6965 7228 295d 0a20  sidentifier()]. 
-00014a80: 2020 2020 2020 2029 0a0a 0a63 6c61 7373         )...class
-00014a90: 2053 6572 6965 7347 726f 7570 4279 2847   SeriesGroupBy(G
-00014aa0: 726f 7570 4279 293a 0a20 2020 205f 5f73  roupBy):.    __s
-00014ab0: 6c6f 7473 5f5f 203d 2028 290a 2020 2020  lots__ = ().    
-00014ac0: 5f61 6c6c 6f77 5f64 6174 615f 7479 7065  _allow_data_type
-00014ad0: 5f20 3d20 2853 6572 6965 7347 726f 7570  _ = (SeriesGroup
-00014ae0: 4279 4461 7461 2c29 0a20 2020 2074 7970  ByData,).    typ
-00014af0: 655f 6e61 6d65 203d 2022 5365 7269 6573  e_name = "Series
-00014b00: 4772 6f75 7042 7922 0a0a 2020 2020 6465  GroupBy"..    de
-00014b10: 6620 5f5f 6571 5f5f 2873 656c 662c 206f  f __eq__(self, o
-00014b20: 7468 6572 293a 0a20 2020 2020 2020 2072  ther):.        r
-00014b30: 6574 7572 6e20 7365 6c66 2e5f 6571 7561  eturn self._equa
-00014b40: 6c28 6f74 6865 7229 0a0a 2020 2020 6465  l(other)..    de
-00014b50: 6620 5f5f 6861 7368 5f5f 2873 656c 6629  f __hash__(self)
-00014b60: 3a0a 2020 2020 2020 2020 2320 4e42 3a20  :.        # NB: 
-00014b70: 7765 2068 6176 6520 6375 7374 6f6d 697a  we have customiz
-00014b80: 6564 205f 5f65 715f 5f20 6578 706c 6963  ed __eq__ explic
-00014b90: 6974 6c79 2c20 7468 7573 2077 6520 6e65  itly, thus we ne
-00014ba0: 6564 2064 6566 696e 6520 5f5f 6861 7368  ed define __hash
-00014bb0: 5f5f 2065 7870 6c69 6369 746c 7920 6173  __ explicitly as
-00014bc0: 2077 656c 6c2e 0a20 2020 2020 2020 2072   well..        r
-00014bd0: 6574 7572 6e20 7375 7065 7228 292e 5f5f  eturn super().__
-00014be0: 6861 7368 5f5f 2829 0a0a 0a63 6c61 7373  hash__()...class
-00014bf0: 2043 6174 6567 6f72 6963 616c 4368 756e   CategoricalChun
-00014c00: 6b44 6174 6128 4368 756e 6b44 6174 6129  kData(ChunkData)
-00014c10: 3a0a 2020 2020 5f5f 736c 6f74 735f 5f20  :.    __slots__ 
-00014c20: 3d20 2829 0a20 2020 2074 7970 655f 6e61  = ().    type_na
-00014c30: 6d65 203d 2022 4361 7465 676f 7269 6361  me = "Categorica
-00014c40: 6c22 0a0a 2020 2020 2320 7265 7175 6972  l"..    # requir
-00014c50: 6564 2066 6965 6c64 730a 2020 2020 5f73  ed fields.    _s
-00014c60: 6861 7065 203d 2054 7570 6c65 4669 656c  hape = TupleFiel
-00014c70: 6428 0a20 2020 2020 2020 2022 7368 6170  d(.        "shap
-00014c80: 6522 2c0a 2020 2020 2020 2020 4669 656c  e",.        Fiel
-00014c90: 6454 7970 6573 2e69 6e74 3634 2c0a 2020  dTypes.int64,.  
-00014ca0: 2020 2020 2020 6f6e 5f73 6572 6961 6c69        on_seriali
-00014cb0: 7a65 3d6f 6e5f 7365 7269 616c 697a 655f  ze=on_serialize_
-00014cc0: 7368 6170 652c 0a20 2020 2020 2020 206f  shape,.        o
-00014cd0: 6e5f 6465 7365 7269 616c 697a 653d 6f6e  n_deserialize=on
-00014ce0: 5f64 6573 6572 6961 6c69 7a65 5f73 6861  _deserialize_sha
-00014cf0: 7065 2c0a 2020 2020 290a 2020 2020 2320  pe,.    ).    # 
-00014d00: 6f70 7469 6f6e 616c 2066 6965 6c64 0a20  optional field. 
-00014d10: 2020 205f 6474 7970 6520 3d20 4461 7461     _dtype = Data
-00014d20: 5479 7065 4669 656c 6428 2264 7479 7065  TypeField("dtype
-00014d30: 2229 0a20 2020 205f 6361 7465 676f 7269  ").    _categori
-00014d40: 6573 5f76 616c 7565 203d 2052 6566 6572  es_value = Refer
-00014d50: 656e 6365 4669 656c 6428 0a20 2020 2020  enceField(.     
-00014d60: 2020 2022 6361 7465 676f 7269 6573 5f76     "categories_v
-00014d70: 616c 7565 222c 2049 6e64 6578 5661 6c75  alue", IndexValu
-00014d80: 652c 206f 6e5f 6465 7365 7269 616c 697a  e, on_deserializ
-00014d90: 653d 5f6f 6e5f 6465 7365 7269 616c 697a  e=_on_deserializ
-00014da0: 655f 696e 6465 785f 7661 6c75 650a 2020  e_index_value.  
-00014db0: 2020 290a 0a20 2020 2064 6566 205f 5f69    )..    def __i
-00014dc0: 6e69 745f 5f28 0a20 2020 2020 2020 2073  nit__(.        s
-00014dd0: 656c 662c 206f 703d 4e6f 6e65 2c20 7368  elf, op=None, sh
-00014de0: 6170 653d 4e6f 6e65 2c20 696e 6465 783d  ape=None, index=
-00014df0: 4e6f 6e65 2c20 6474 7970 653d 4e6f 6e65  None, dtype=None
-00014e00: 2c20 6361 7465 676f 7269 6573 5f76 616c  , categories_val
-00014e10: 7565 3d4e 6f6e 652c 202a 2a6b 770a 2020  ue=None, **kw.  
-00014e20: 2020 293a 0a20 2020 2020 2020 2073 7570    ):.        sup
-00014e30: 6572 2829 2e5f 5f69 6e69 745f 5f28 0a20  er().__init__(. 
-00014e40: 2020 2020 2020 2020 2020 205f 6f70 3d6f             _op=o
-00014e50: 702c 0a20 2020 2020 2020 2020 2020 205f  p,.            _
-00014e60: 7368 6170 653d 7368 6170 652c 0a20 2020  shape=shape,.   
-00014e70: 2020 2020 2020 2020 205f 696e 6465 783d           _index=
-00014e80: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
-00014e90: 2020 205f 6474 7970 653d 6474 7970 652c     _dtype=dtype,
-00014ea0: 0a20 2020 2020 2020 2020 2020 205f 6361  .            _ca
-00014eb0: 7465 676f 7269 6573 5f76 616c 7565 3d63  tegories_value=c
-00014ec0: 6174 6567 6f72 6965 735f 7661 6c75 652c  ategories_value,
-00014ed0: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
-00014ee0: 772c 0a20 2020 2020 2020 2029 0a0a 2020  w,.        )..  
-00014ef0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00014f00: 6465 6620 7061 7261 6d73 2873 656c 6629  def params(self)
-00014f10: 202d 3e20 4469 6374 5b73 7472 2c20 416e   -> Dict[str, An
-00014f20: 795d 3a0a 2020 2020 2020 2020 2320 7061  y]:.        # pa
-00014f30: 7261 6d73 2072 6574 7572 6e20 7468 6520  rams return the 
-00014f40: 7072 6f70 6572 7469 6573 2077 6869 6368  properties which
-00014f50: 2075 7365 6675 6c20 746f 2072 6562 7569   useful to rebui
-00014f60: 6c64 2061 206e 6577 2063 6875 6e6b 0a20  ld a new chunk. 
-00014f70: 2020 2020 2020 2072 6574 7572 6e20 7b0a         return {.
-00014f80: 2020 2020 2020 2020 2020 2020 2273 6861              "sha
-00014f90: 7065 223a 2073 656c 662e 7368 6170 652c  pe": self.shape,
-00014fa0: 0a20 2020 2020 2020 2020 2020 2022 6474  .            "dt
-00014fb0: 7970 6522 3a20 7365 6c66 2e64 7479 7065  ype": self.dtype
-00014fc0: 2c0a 2020 2020 2020 2020 2020 2020 2269  ,.            "i
-00014fd0: 6e64 6578 223a 2073 656c 662e 696e 6465  ndex": self.inde
-00014fe0: 782c 0a20 2020 2020 2020 2020 2020 2022  x,.            "
-00014ff0: 6361 7465 676f 7269 6573 5f76 616c 7565  categories_value
-00015000: 223a 2073 656c 662e 6361 7465 676f 7269  ": self.categori
-00015010: 6573 5f76 616c 7565 2c0a 2020 2020 2020  es_value,.      
-00015020: 2020 7d0a 0a20 2020 2040 7061 7261 6d73    }..    @params
-00015030: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
-00015040: 7061 7261 6d73 2873 656c 662c 206e 6577  params(self, new
-00015050: 5f70 6172 616d 733a 2044 6963 745b 7374  _params: Dict[st
-00015060: 722c 2041 6e79 5d29 3a0a 2020 2020 2020  r, Any]):.      
-00015070: 2020 7061 7261 6d73 203d 206e 6577 5f70    params = new_p
-00015080: 6172 616d 732e 636f 7079 2829 0a20 2020  arams.copy().   
-00015090: 2020 2020 2070 6172 616d 732e 706f 7028       params.pop(
-000150a0: 2269 6e64 6578 222c 204e 6f6e 6529 2020  "index", None)  
-000150b0: 2320 696e 6465 7820 6e6f 7420 6e65 6564  # index not need
-000150c0: 6564 2074 6f20 7570 6461 7465 0a20 2020  ed to update.   
-000150d0: 2020 2020 206e 6577 5f73 6861 7065 203d       new_shape =
-000150e0: 2070 6172 616d 732e 706f 7028 2273 6861   params.pop("sha
-000150f0: 7065 222c 204e 6f6e 6529 0a20 2020 2020  pe", None).     
-00015100: 2020 2069 6620 6e65 775f 7368 6170 6520     if new_shape 
-00015110: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00015120: 2020 2020 2020 2020 2073 656c 662e 5f73           self._s
-00015130: 6861 7065 203d 206e 6577 5f73 6861 7065  hape = new_shape
-00015140: 0a20 2020 2020 2020 2064 7479 7065 203d  .        dtype =
-00015150: 2070 6172 616d 732e 706f 7028 2264 7479   params.pop("dty
-00015160: 7065 222c 204e 6f6e 6529 0a20 2020 2020  pe", None).     
-00015170: 2020 2069 6620 6474 7970 6520 6973 206e     if dtype is n
-00015180: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00015190: 2020 2020 2073 656c 662e 5f64 7479 7065       self._dtype
-000151a0: 203d 2064 7479 7065 0a20 2020 2020 2020   = dtype.       
-000151b0: 2063 6174 6567 6f72 6965 735f 7661 6c75   categories_valu
-000151c0: 6520 3d20 7061 7261 6d73 2e70 6f70 2822  e = params.pop("
-000151d0: 6361 7465 676f 7269 6573 5f76 616c 7565  categories_value
-000151e0: 222c 204e 6f6e 6529 0a20 2020 2020 2020  ", None).       
-000151f0: 2069 6620 6361 7465 676f 7269 6573 5f76   if categories_v
-00015200: 616c 7565 2069 7320 6e6f 7420 4e6f 6e65  alue is not None
-00015210: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00015220: 6c66 2e5f 6361 7465 676f 7269 6573 5f76  lf._categories_v
-00015230: 616c 7565 203d 2063 6174 6567 6f72 6965  alue = categorie
-00015240: 735f 7661 6c75 650a 2020 2020 2020 2020  s_value.        
-00015250: 6966 2070 6172 616d 733a 2020 2320 7072  if params:  # pr
-00015260: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a20  agma: no cover. 
-00015270: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00015280: 2054 7970 6545 7272 6f72 2866 2255 6e6b   TypeError(f"Unk
-00015290: 6e6f 776e 2070 6172 616d 733a 207b 6c69  nown params: {li
-000152a0: 7374 2870 6172 616d 7329 7d22 290a 0a20  st(params)}").. 
-000152b0: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
-000152c0: 2020 2020 6465 6620 6765 745f 7061 7261      def get_para
-000152d0: 6d73 5f66 726f 6d5f 6461 7461 2863 6c73  ms_from_data(cls
-000152e0: 2c20 6461 7461 3a20 7064 2e43 6174 6567  , data: pd.Categ
-000152f0: 6f72 6963 616c 2920 2d3e 2044 6963 745b  orical) -> Dict[
-00015300: 7374 722c 2041 6e79 5d3a 0a20 2020 2020  str, Any]:.     
-00015310: 2020 2072 6574 7572 6e20 7b0a 2020 2020     return {.    
-00015320: 2020 2020 2020 2020 2273 6861 7065 223a          "shape":
-00015330: 2064 6174 612e 7368 6170 652c 0a20 2020   data.shape,.   
-00015340: 2020 2020 2020 2020 2022 6474 7970 6522           "dtype"
-00015350: 3a20 6461 7461 2e64 7479 7065 2c0a 2020  : data.dtype,.  
-00015360: 2020 2020 2020 2020 2020 2263 6174 6567            "categ
-00015370: 6f72 6965 735f 7661 6c75 6522 3a20 7061  ories_value": pa
-00015380: 7273 655f 696e 6465 7828 6461 7461 2e63  rse_index(data.c
-00015390: 6174 6567 6f72 6965 732c 2073 746f 7265  ategories, store
-000153a0: 5f64 6174 613d 5472 7565 292c 0a20 2020  _data=True),.   
-000153b0: 2020 2020 207d 0a0a 2020 2020 4070 726f       }..    @pro
-000153c0: 7065 7274 790a 2020 2020 6465 6620 7368  perty.    def sh
-000153d0: 6170 6528 7365 6c66 293a 0a20 2020 2020  ape(self):.     
-000153e0: 2020 2072 6574 7572 6e20 6765 7461 7474     return getatt
-000153f0: 7228 7365 6c66 2c20 225f 7368 6170 6522  r(self, "_shape"
-00015400: 2c20 4e6f 6e65 290a 0a20 2020 2040 7072  , None)..    @pr
-00015410: 6f70 6572 7479 0a20 2020 2064 6566 206e  operty.    def n
-00015420: 6469 6d28 7365 6c66 293a 0a20 2020 2020  dim(self):.     
-00015430: 2020 2072 6574 7572 6e20 6c65 6e28 7365     return len(se
-00015440: 6c66 2e73 6861 7065 290a 0a20 2020 2040  lf.shape)..    @
-00015450: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00015460: 2064 7479 7065 2873 656c 6629 3a0a 2020   dtype(self):.  
-00015470: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00015480: 662e 5f64 7479 7065 0a0a 2020 2020 4070  f._dtype..    @p
-00015490: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000154a0: 6361 7465 676f 7269 6573 5f76 616c 7565  categories_value
-000154b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000154c0: 7265 7475 726e 2073 656c 662e 5f63 6174  return self._cat
-000154d0: 6567 6f72 6965 735f 7661 6c75 650a 0a0a  egories_value...
-000154e0: 636c 6173 7320 4361 7465 676f 7269 6361  class Categorica
-000154f0: 6c43 6875 6e6b 2843 6875 6e6b 293a 0a20  lChunk(Chunk):. 
-00015500: 2020 205f 5f73 6c6f 7473 5f5f 203d 2028     __slots__ = (
-00015510: 290a 2020 2020 5f61 6c6c 6f77 5f64 6174  ).    _allow_dat
-00015520: 615f 7479 7065 5f20 3d20 2843 6174 6567  a_type_ = (Categ
-00015530: 6f72 6963 616c 4368 756e 6b44 6174 612c  oricalChunkData,
-00015540: 290a 2020 2020 7479 7065 5f6e 616d 6520  ).    type_name 
-00015550: 3d20 2243 6174 6567 6f72 6963 616c 220a  = "Categorical".
-00015560: 0a0a 636c 6173 7320 4361 7465 676f 7269  ..class Categori
-00015570: 6361 6c44 6174 6128 4861 7353 6861 7065  calData(HasShape
-00015580: 5469 6c65 6162 6c65 4461 7461 2c20 5f54  TileableData, _T
-00015590: 6f50 616e 6461 734d 6978 696e 293a 0a20  oPandasMixin):. 
-000155a0: 2020 205f 5f73 6c6f 7473 5f5f 203d 2028     __slots__ = (
-000155b0: 225f 6361 6368 6522 2c29 0a20 2020 2074  "_cache",).    t
-000155c0: 7970 655f 6e61 6d65 203d 2022 4361 7465  ype_name = "Cate
-000155d0: 676f 7269 6361 6c22 0a0a 2020 2020 2320  gorical"..    # 
-000155e0: 6f70 7469 6f6e 616c 2066 6965 6c64 0a20  optional field. 
-000155f0: 2020 205f 6474 7970 6520 3d20 4461 7461     _dtype = Data
-00015600: 5479 7065 4669 656c 6428 2264 7479 7065  TypeField("dtype
-00015610: 2229 0a20 2020 205f 6361 7465 676f 7269  ").    _categori
-00015620: 6573 5f76 616c 7565 203d 2052 6566 6572  es_value = Refer
-00015630: 656e 6365 4669 656c 6428 0a20 2020 2020  enceField(.     
-00015640: 2020 2022 6361 7465 676f 7269 6573 5f76     "categories_v
-00015650: 616c 7565 222c 2049 6e64 6578 5661 6c75  alue", IndexValu
-00015660: 652c 206f 6e5f 6465 7365 7269 616c 697a  e, on_deserializ
-00015670: 653d 5f6f 6e5f 6465 7365 7269 616c 697a  e=_on_deserializ
-00015680: 655f 696e 6465 785f 7661 6c75 650a 2020  e_index_value.  
-00015690: 2020 290a 2020 2020 5f63 6875 6e6b 7320    ).    _chunks 
-000156a0: 3d20 4c69 7374 4669 656c 6428 0a20 2020  = ListField(.   
-000156b0: 2020 2020 2022 6368 756e 6b73 222c 0a20       "chunks",. 
-000156c0: 2020 2020 2020 2046 6965 6c64 5479 7065         FieldType
-000156d0: 732e 7265 6665 7265 6e63 6528 4361 7465  s.reference(Cate
-000156e0: 676f 7269 6361 6c43 6875 6e6b 4461 7461  goricalChunkData
-000156f0: 292c 0a20 2020 2020 2020 206f 6e5f 7365  ),.        on_se
-00015700: 7269 616c 697a 653d 6c61 6d62 6461 2078  rialize=lambda x
-00015710: 3a20 5b69 742e 6461 7461 2066 6f72 2069  : [it.data for i
-00015720: 7420 696e 2078 5d20 6966 2078 2069 7320  t in x] if x is 
-00015730: 6e6f 7420 4e6f 6e65 2065 6c73 6520 782c  not None else x,
-00015740: 0a20 2020 2020 2020 206f 6e5f 6465 7365  .        on_dese
-00015750: 7269 616c 697a 653d 6c61 6d62 6461 2078  rialize=lambda x
-00015760: 3a20 5b43 6174 6567 6f72 6963 616c 4368  : [CategoricalCh
-00015770: 756e 6b28 6974 2920 666f 7220 6974 2069  unk(it) for it i
-00015780: 6e20 785d 0a20 2020 2020 2020 2069 6620  n x].        if 
-00015790: 7820 6973 206e 6f74 204e 6f6e 650a 2020  x is not None.  
-000157a0: 2020 2020 2020 656c 7365 2078 2c0a 2020        else x,.  
-000157b0: 2020 290a 0a20 2020 2064 6566 205f 5f69    )..    def __i
-000157c0: 6e69 745f 5f28 0a20 2020 2020 2020 2073  nit__(.        s
-000157d0: 656c 662c 0a20 2020 2020 2020 206f 703d  elf,.        op=
-000157e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7368  None,.        sh
-000157f0: 6170 653d 4e6f 6e65 2c0a 2020 2020 2020  ape=None,.      
-00015800: 2020 6e73 706c 6974 733d 4e6f 6e65 2c0a    nsplits=None,.
-00015810: 2020 2020 2020 2020 6474 7970 653d 4e6f          dtype=No
-00015820: 6e65 2c0a 2020 2020 2020 2020 6361 7465  ne,.        cate
-00015830: 676f 7269 6573 5f76 616c 7565 3d4e 6f6e  gories_value=Non
-00015840: 652c 0a20 2020 2020 2020 2063 6875 6e6b  e,.        chunk
-00015850: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
-00015860: 2a2a 6b77 2c0a 2020 2020 293a 0a20 2020  **kw,.    ):.   
-00015870: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
-00015880: 6e69 745f 5f28 0a20 2020 2020 2020 2020  nit__(.         
-00015890: 2020 205f 6f70 3d6f 702c 0a20 2020 2020     _op=op,.     
-000158a0: 2020 2020 2020 205f 7368 6170 653d 7368         _shape=sh
-000158b0: 6170 652c 0a20 2020 2020 2020 2020 2020  ape,.           
-000158c0: 205f 6e73 706c 6974 733d 6e73 706c 6974   _nsplits=nsplit
-000158d0: 732c 0a20 2020 2020 2020 2020 2020 205f  s,.            _
-000158e0: 6474 7970 653d 6474 7970 652c 0a20 2020  dtype=dtype,.   
-000158f0: 2020 2020 2020 2020 205f 6361 7465 676f           _catego
-00015900: 7269 6573 5f76 616c 7565 3d63 6174 6567  ries_value=categ
-00015910: 6f72 6965 735f 7661 6c75 652c 0a20 2020  ories_value,.   
-00015920: 2020 2020 2020 2020 205f 6368 756e 6b73           _chunks
-00015930: 3d63 6875 6e6b 732c 0a20 2020 2020 2020  =chunks,.       
-00015940: 2020 2020 202a 2a6b 772c 0a20 2020 2020       **kw,.     
-00015950: 2020 2029 0a0a 2020 2020 4070 726f 7065     )..    @prope
-00015960: 7274 790a 2020 2020 6465 6620 7061 7261  rty.    def para
-00015970: 6d73 2873 656c 6629 202d 3e20 4469 6374  ms(self) -> Dict
-00015980: 5b73 7472 2c20 416e 795d 3a0a 2020 2020  [str, Any]:.    
-00015990: 2020 2020 2320 7061 7261 6d73 2072 6574      # params ret
-000159a0: 7572 6e20 7468 6520 7072 6f70 6572 7469  urn the properti
-000159b0: 6573 2077 6869 6368 2075 7365 6675 6c20  es which useful 
-000159c0: 746f 2072 6562 7569 6c64 2061 206e 6577  to rebuild a new
-000159d0: 2074 696c 6561 626c 6520 6f62 6a65 6374   tileable object
-000159e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000159f0: 7b0a 2020 2020 2020 2020 2020 2020 2273  {.            "s
-00015a00: 6861 7065 223a 2073 656c 662e 7368 6170  hape": self.shap
-00015a10: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-00015a20: 6474 7970 6522 3a20 7365 6c66 2e64 7479  dtype": self.dty
-00015a30: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-00015a40: 2263 6174 6567 6f72 6965 735f 7661 6c75  "categories_valu
-00015a50: 6522 3a20 7365 6c66 2e63 6174 6567 6f72  e": self.categor
-00015a60: 6965 735f 7661 6c75 652c 0a20 2020 2020  ies_value,.     
-00015a70: 2020 207d 0a0a 2020 2020 4070 6172 616d     }..    @param
-00015a80: 732e 7365 7474 6572 0a20 2020 2064 6566  s.setter.    def
-00015a90: 2070 6172 616d 7328 7365 6c66 2c20 6e65   params(self, ne
-00015aa0: 775f 7061 7261 6d73 3a20 4469 6374 5b73  w_params: Dict[s
-00015ab0: 7472 2c20 416e 795d 293a 0a20 2020 2020  tr, Any]):.     
-00015ac0: 2020 2070 6172 616d 7320 3d20 6e65 775f     params = new_
-00015ad0: 7061 7261 6d73 2e63 6f70 7928 290a 2020  params.copy().  
-00015ae0: 2020 2020 2020 6e65 775f 7368 6170 6520        new_shape 
-00015af0: 3d20 7061 7261 6d73 2e70 6f70 2822 7368  = params.pop("sh
-00015b00: 6170 6522 2c20 4e6f 6e65 290a 2020 2020  ape", None).    
-00015b10: 2020 2020 6966 206e 6577 5f73 6861 7065      if new_shape
-00015b20: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00015b30: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00015b40: 7368 6170 6520 3d20 6e65 775f 7368 6170  shape = new_shap
-00015b50: 650a 2020 2020 2020 2020 6474 7970 6520  e.        dtype 
-00015b60: 3d20 7061 7261 6d73 2e70 6f70 2822 6474  = params.pop("dt
-00015b70: 7970 6522 2c20 4e6f 6e65 290a 2020 2020  ype", None).    
-00015b80: 2020 2020 6966 2064 7479 7065 2069 7320      if dtype is 
-00015b90: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00015ba0: 2020 2020 2020 7365 6c66 2e5f 6474 7970        self._dtyp
-00015bb0: 6520 3d20 6474 7970 650a 2020 2020 2020  e = dtype.      
-00015bc0: 2020 6361 7465 676f 7269 6573 5f76 616c    categories_val
-00015bd0: 7565 203d 2070 6172 616d 732e 706f 7028  ue = params.pop(
-00015be0: 2263 6174 6567 6f72 6965 735f 7661 6c75  "categories_valu
-00015bf0: 6522 2c20 4e6f 6e65 290a 2020 2020 2020  e", None).      
-00015c00: 2020 6966 2063 6174 6567 6f72 6965 735f    if categories_
-00015c10: 7661 6c75 6520 6973 206e 6f74 204e 6f6e  value is not Non
-00015c20: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-00015c30: 656c 662e 5f63 6174 6567 6f72 6965 735f  elf._categories_
-00015c40: 7661 6c75 6520 3d20 6361 7465 676f 7269  value = categori
-00015c50: 6573 5f76 616c 7565 0a20 2020 2020 2020  es_value.       
-00015c60: 2069 6620 7061 7261 6d73 3a20 2023 2070   if params:  # p
-00015c70: 7261 676d 613a 206e 6f20 636f 7665 720a  ragma: no cover.
-00015c80: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00015c90: 6520 5479 7065 4572 726f 7228 6622 556e  e TypeError(f"Un
-00015ca0: 6b6e 6f77 6e20 7061 7261 6d73 3a20 7b6c  known params: {l
-00015cb0: 6973 7428 7061 7261 6d73 297d 2229 0a0a  ist(params)}")..
-00015cc0: 2020 2020 6465 6620 7265 6672 6573 685f      def refresh_
-00015cd0: 7061 7261 6d73 2873 656c 6629 3a0a 2020  params(self):.  
-00015ce0: 2020 2020 2020 2320 7265 6672 6573 6820        # refresh 
-00015cf0: 7061 7261 6d73 2077 6865 6e20 6368 756e  params when chun
-00015d00: 6b73 2075 7064 6174 6564 0a20 2020 2020  ks updated.     
-00015d10: 2020 2072 6566 7265 7368 5f74 696c 6561     refresh_tilea
-00015d20: 626c 655f 7368 6170 6528 7365 6c66 290a  ble_shape(self).
-00015d30: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00015d40: 5f64 7479 7065 2069 7320 4e6f 6e65 3a0a  _dtype is None:.
-00015d50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00015d60: 2e5f 6474 7970 6520 3d20 7365 6c66 2e63  ._dtype = self.c
-00015d70: 6875 6e6b 735b 305d 2e64 7479 7065 0a20  hunks[0].dtype. 
-00015d80: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-00015d90: 6361 7465 676f 7269 6573 5f76 616c 7565  categories_value
-00015da0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00015db0: 2020 2020 2020 6361 7465 676f 7269 6573        categories
-00015dc0: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
-00015dd0: 2020 666f 7220 6368 756e 6b20 696e 2073    for chunk in s
-00015de0: 656c 662e 6368 756e 6b73 3a0a 2020 2020  elf.chunks:.    
-00015df0: 2020 2020 2020 2020 2020 2020 6361 7465              cate
-00015e00: 676f 7269 6573 2e65 7874 656e 6428 6368  gories.extend(ch
-00015e10: 756e 6b2e 6361 7465 676f 7269 6573 5f76  unk.categories_v
-00015e20: 616c 7565 2e74 6f5f 7061 6e64 6173 2829  alue.to_pandas()
-00015e30: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00015e40: 6c66 2e5f 6361 7465 676f 7269 6573 5f76  lf._categories_v
-00015e50: 616c 7565 203d 2070 6172 7365 5f69 6e64  alue = parse_ind
-00015e60: 6578 280a 2020 2020 2020 2020 2020 2020  ex(.            
-00015e70: 2020 2020 7064 2e43 6174 6567 6f72 6963      pd.Categoric
-00015e80: 616c 2863 6174 6567 6f72 6965 7329 2e63  al(categories).c
-00015e90: 6174 6567 6f72 6965 732c 2073 746f 7265  ategories, store
-00015ea0: 5f64 6174 613d 5472 7565 0a20 2020 2020  _data=True.     
-00015eb0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00015ec0: 6620 5f74 6f5f 7374 7228 7365 6c66 2c20  f _to_str(self, 
-00015ed0: 7265 7072 6573 656e 7461 7469 6f6e 3d46  representation=F
-00015ee0: 616c 7365 293a 0a20 2020 2020 2020 2069  alse):.        i
-00015ef0: 6620 6973 5f62 7569 6c64 5f6d 6f64 6528  f is_build_mode(
-00015f00: 2920 6f72 206c 656e 2873 656c 662e 5f65  ) or len(self._e
-00015f10: 7865 6375 7465 645f 7365 7373 696f 6e73  xecuted_sessions
-00015f20: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
-00015f30: 2020 2020 2320 696e 2062 7569 6c64 206d      # in build m
-00015f40: 6f64 652c 206f 7220 6e6f 7420 6578 6563  ode, or not exec
-00015f50: 7574 6564 2c20 6a75 7374 2072 6574 7572  uted, just retur
-00015f60: 6e20 7265 7072 6573 656e 7461 7469 6f6e  n representation
-00015f70: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00015f80: 7265 7072 6573 656e 7461 7469 6f6e 3a0a  representation:.
-00015f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015fa0: 7265 7475 726e 2066 227b 7365 6c66 2e74  return f"{self.t
-00015fb0: 7970 655f 6e61 6d65 7d20 3c6f 703d 7b74  ype_name} <op={t
-00015fc0: 7970 6528 7365 6c66 2e6f 7029 2e5f 5f6e  ype(self.op).__n
-00015fd0: 616d 655f 5f7d 2c20 6b65 793d 7b73 656c  ame__}, key={sel
-00015fe0: 662e 6b65 797d 3e22 0a20 2020 2020 2020  f.key}>".       
-00015ff0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00016000: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00016010: 6e20 6622 7b73 656c 662e 7479 7065 5f6e  n f"{self.type_n
-00016020: 616d 657d 286f 703d 7b74 7970 6528 7365  ame}(op={type(se
-00016030: 6c66 2e6f 7029 2e5f 5f6e 616d 655f 5f7d  lf.op).__name__}
-00016040: 2922 0a20 2020 2020 2020 2065 6c73 653a  )".        else:
-00016050: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00016060: 6120 3d20 7365 6c66 2e66 6574 6368 2873  a = self.fetch(s
-00016070: 6573 7369 6f6e 3d73 656c 662e 5f65 7865  ession=self._exe
-00016080: 6375 7465 645f 7365 7373 696f 6e73 5b2d  cuted_sessions[-
-00016090: 315d 290a 2020 2020 2020 2020 2020 2020  1]).            
-000160a0: 7265 7475 726e 2072 6570 7228 6461 7461  return repr(data
-000160b0: 2920 6966 2072 6570 7228 6461 7461 2920  ) if repr(data) 
-000160c0: 656c 7365 2073 7472 2864 6174 6129 0a0a  else str(data)..
-000160d0: 2020 2020 6465 6620 5f5f 7374 725f 5f28      def __str__(
-000160e0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-000160f0: 6574 7572 6e20 7365 6c66 2e5f 746f 5f73  eturn self._to_s
-00016100: 7472 2872 6570 7265 7365 6e74 6174 696f  tr(representatio
-00016110: 6e3d 4661 6c73 6529 0a0a 2020 2020 6465  n=False)..    de
-00016120: 6620 5f5f 7265 7072 5f5f 2873 656c 6629  f __repr__(self)
-00016130: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00016140: 2073 656c 662e 5f74 6f5f 7374 7228 7265   self._to_str(re
-00016150: 7072 6573 656e 7461 7469 6f6e 3d54 7275  presentation=Tru
-00016160: 6529 0a0a 2020 2020 6465 6620 5f65 7175  e)..    def _equ
-00016170: 616c 2873 656c 662c 206f 293a 0a20 2020  al(self, o):.   
-00016180: 2020 2020 2023 2046 4958 4d45 2057 6520       # FIXME We 
-00016190: 6e65 6564 2074 6f20 696d 706c 656d 656e  need to implemen
-000161a0: 7465 6420 6120 7472 7565 2060 3d3d 6020  ted a true `==` 
-000161b0: 6f70 6572 6174 6f72 2066 6f72 2044 6174  operator for Dat
-000161c0: 6146 7261 6d65 4772 6f75 7062 790a 2020  aFrameGroupby.  
-000161d0: 2020 2020 2020 6966 2069 735f 6275 696c        if is_buil
-000161e0: 645f 6d6f 6465 2829 3a0a 2020 2020 2020  d_mode():.      
-000161f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00016200: 6620 6973 206f 0a20 2020 2020 2020 2065  f is o.        e
-00016210: 6c73 653a 2020 2320 7072 6167 6d61 3a20  lse:  # pragma: 
-00016220: 6e6f 2063 6f76 6572 0a20 2020 2020 2020  no cover.       
-00016230: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00016240: 203d 3d20 6f0a 0a20 2020 2040 7072 6f70   == o..    @prop
-00016250: 6572 7479 0a20 2020 2064 6566 2064 7479  erty.    def dty
-00016260: 7065 2873 656c 6629 3a0a 2020 2020 2020  pe(self):.      
-00016270: 2020 7265 7475 726e 2067 6574 6174 7472    return getattr
-00016280: 2873 656c 662c 2022 5f64 7479 7065 222c  (self, "_dtype",
-00016290: 204e 6f6e 6529 206f 7220 7365 6c66 2e6f   None) or self.o
-000162a0: 702e 6474 7970 650a 0a20 2020 2040 7072  p.dtype..    @pr
-000162b0: 6f70 6572 7479 0a20 2020 2064 6566 2063  operty.    def c
-000162c0: 6174 6567 6f72 6965 735f 7661 6c75 6528  ategories_value(
-000162d0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-000162e0: 6574 7572 6e20 7365 6c66 2e5f 6361 7465  eturn self._cate
-000162f0: 676f 7269 6573 5f76 616c 7565 0a0a 2020  gories_value..  
-00016300: 2020 6465 6620 5f5f 6571 5f5f 2873 656c    def __eq__(sel
-00016310: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
-00016320: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00016330: 6571 7561 6c28 6f74 6865 7229 0a0a 2020  equal(other)..  
-00016340: 2020 6465 6620 5f5f 6861 7368 5f5f 2873    def __hash__(s
-00016350: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
-00016360: 4e42 3a20 7765 2068 6176 6520 6375 7374  NB: we have cust
-00016370: 6f6d 697a 6564 205f 5f65 715f 5f20 6578  omized __eq__ ex
-00016380: 706c 6963 6974 6c79 2c20 7468 7573 2077  plicitly, thus w
-00016390: 6520 6e65 6564 2064 6566 696e 6520 5f5f  e need define __
-000163a0: 6861 7368 5f5f 2065 7870 6c69 6369 746c  hash__ explicitl
-000163b0: 7920 6173 2077 656c 6c2e 0a20 2020 2020  y as well..     
-000163c0: 2020 2072 6574 7572 6e20 7375 7065 7228     return super(
-000163d0: 292e 5f5f 6861 7368 5f5f 2829 0a0a 0a63  ).__hash__()...c
-000163e0: 6c61 7373 2043 6174 6567 6f72 6963 616c  lass Categorical
-000163f0: 2848 6173 5368 6170 6554 696c 6561 626c  (HasShapeTileabl
-00016400: 652c 205f 546f 5061 6e64 6173 4d69 7869  e, _ToPandasMixi
-00016410: 6e29 3a0a 2020 2020 5f5f 736c 6f74 735f  n):.    __slots_
-00016420: 5f20 3d20 2829 0a20 2020 205f 616c 6c6f  _ = ().    _allo
-00016430: 775f 6461 7461 5f74 7970 655f 203d 2028  w_data_type_ = (
-00016440: 4361 7465 676f 7269 6361 6c44 6174 612c  CategoricalData,
-00016450: 290a 2020 2020 7479 7065 5f6e 616d 6520  ).    type_name 
-00016460: 3d20 2243 6174 6567 6f72 6963 616c 220a  = "Categorical".
-00016470: 0a20 2020 2064 6566 205f 5f6c 656e 5f5f  .    def __len__
-00016480: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00016490: 7265 7475 726e 206c 656e 2873 656c 662e  return len(self.
-000164a0: 5f64 6174 6129 0a0a 2020 2020 6465 6620  _data)..    def 
-000164b0: 5f5f 6571 5f5f 2873 656c 662c 206f 7468  __eq__(self, oth
-000164c0: 6572 293a 0a20 2020 2020 2020 2072 6574  er):.        ret
-000164d0: 7572 6e20 7365 6c66 2e5f 6571 7561 6c28  urn self._equal(
-000164e0: 6f74 6865 7229 0a0a 2020 2020 6465 6620  other)..    def 
-000164f0: 5f5f 6861 7368 5f5f 2873 656c 6629 3a0a  __hash__(self):.
-00016500: 2020 2020 2020 2020 2320 4e42 3a20 7765          # NB: we
-00016510: 2068 6176 6520 6375 7374 6f6d 697a 6564   have customized
-00016520: 205f 5f65 715f 5f20 6578 706c 6963 6974   __eq__ explicit
-00016530: 6c79 2c20 7468 7573 2077 6520 6e65 6564  ly, thus we need
-00016540: 2064 6566 696e 6520 5f5f 6861 7368 5f5f   define __hash__
-00016550: 2065 7870 6c69 6369 746c 7920 6173 2077   explicitly as w
-00016560: 656c 6c2e 0a20 2020 2020 2020 2072 6574  ell..        ret
-00016570: 7572 6e20 7375 7065 7228 292e 5f5f 6861  urn super().__ha
-00016580: 7368 5f5f 2829 0a0a 0a63 6c61 7373 2044  sh__()...class D
-00016590: 6174 6146 7261 6d65 4f72 5365 7269 6573  ataFrameOrSeries
-000165a0: 4368 756e 6b44 6174 6128 4368 756e 6b44  ChunkData(ChunkD
-000165b0: 6174 6129 3a0a 2020 2020 5f5f 736c 6f74  ata):.    __slot
-000165c0: 735f 5f20 3d20 2829 0a20 2020 2074 7970  s__ = ().    typ
-000165d0: 655f 6e61 6d65 203d 2022 4461 7461 4672  e_name = "DataFr
-000165e0: 616d 654f 7253 6572 6965 7322 0a0a 2020  ameOrSeries"..  
-000165f0: 2020 5f63 6f6c 6c61 7073 655f 6178 6973    _collapse_axis
-00016600: 203d 2049 6e74 3846 6965 6c64 2822 636f   = Int8Field("co
-00016610: 6c6c 6170 7365 5f61 7869 7322 290a 2020  llapse_axis").  
-00016620: 2020 5f64 6174 615f 7479 7065 203d 2053    _data_type = S
-00016630: 7472 696e 6746 6965 6c64 2822 6461 7461  tringField("data
-00016640: 5f74 7970 6522 290a 2020 2020 5f64 6174  _type").    _dat
-00016650: 615f 7061 7261 6d73 203d 2044 6963 7446  a_params = DictF
-00016660: 6965 6c64 2822 6461 7461 5f70 6172 616d  ield("data_param
-00016670: 7322 290a 0a20 2020 2064 6566 205f 5f69  s")..    def __i
-00016680: 6e69 745f 5f28 0a20 2020 2020 2020 2073  nit__(.        s
-00016690: 656c 662c 0a20 2020 2020 2020 206f 703d  elf,.        op=
-000166a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 696e  None,.        in
-000166b0: 6465 783d 4e6f 6e65 2c0a 2020 2020 2020  dex=None,.      
-000166c0: 2020 636f 6c6c 6170 7365 5f61 7869 733d    collapse_axis=
-000166d0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6461  None,.        da
-000166e0: 7461 5f74 7970 653d 4e6f 6e65 2c0a 2020  ta_type=None,.  
-000166f0: 2020 2020 2020 6461 7461 5f70 6172 616d        data_param
-00016700: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
-00016710: 2a2a 6b77 2c0a 2020 2020 293a 0a20 2020  **kw,.    ):.   
-00016720: 2020 2020 2073 656c 662e 5f63 6f6c 6c61       self._colla
-00016730: 7073 655f 6178 6973 203d 2063 6f6c 6c61  pse_axis = colla
-00016740: 7073 655f 6178 6973 0a20 2020 2020 2020  pse_axis.       
-00016750: 2073 656c 662e 5f69 6e64 6578 203d 2069   self._index = i
-00016760: 6e64 6578 0a20 2020 2020 2020 2073 656c  ndex.        sel
-00016770: 662e 5f64 6174 615f 7479 7065 203d 2064  f._data_type = d
-00016780: 6174 615f 7479 7065 0a20 2020 2020 2020  ata_type.       
-00016790: 2073 656c 662e 5f64 6174 615f 7061 7261   self._data_para
-000167a0: 6d73 203d 2064 6174 615f 7061 7261 6d73  ms = data_params
-000167b0: 206f 7220 6469 6374 2829 0a20 2020 2020   or dict().     
-000167c0: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
-000167d0: 745f 5f28 5f6f 703d 6f70 2c20 2a2a 6b77  t__(_op=op, **kw
-000167e0: 290a 0a20 2020 2064 6566 205f 5f67 6574  )..    def __get
-000167f0: 6174 7472 5f5f 2873 656c 662c 2069 7465  attr__(self, ite
-00016800: 6d29 3a0a 2020 2020 2020 2020 6966 2069  m):.        if i
-00016810: 7465 6d20 696e 2073 656c 662e 5f64 6174  tem in self._dat
-00016820: 615f 7061 7261 6d73 3a0a 2020 2020 2020  a_params:.      
-00016830: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00016840: 662e 5f64 6174 615f 7061 7261 6d73 5b69  f._data_params[i
-00016850: 7465 6d5d 0a20 2020 2020 2020 2072 6169  tem].        rai
-00016860: 7365 2041 7474 7269 6275 7465 4572 726f  se AttributeErro
-00016870: 7228 6622 277b 7479 7065 2873 656c 6629  r(f"'{type(self)
-00016880: 7d27 206f 626a 6563 7420 6861 7320 6e6f  }' object has no
-00016890: 2061 7474 7269 6275 7465 2027 7b69 7465   attribute '{ite
-000168a0: 6d7d 2722 290a 0a20 2020 2040 7072 6f70  m}'")..    @prop
-000168b0: 6572 7479 0a20 2020 2064 6566 206e 6469  erty.    def ndi
-000168c0: 6d28 7365 6c66 2920 2d3e 2069 6e74 3a0a  m(self) -> int:.
-000168d0: 2020 2020 2020 2020 7265 7475 726e 2028          return (
-000168e0: 7365 6c66 2e5f 6461 7461 5f74 7970 6520  self._data_type 
-000168f0: 3d3d 2022 6461 7461 6672 616d 6522 2920  == "dataframe") 
-00016900: 2b20 310a 0a20 2020 2040 7072 6f70 6572  + 1..    @proper
-00016910: 7479 0a20 2020 2064 6566 2070 6172 616d  ty.    def param
-00016920: 7328 7365 6c66 2920 2d3e 2044 6963 745b  s(self) -> Dict[
-00016930: 7374 722c 2041 6e79 5d3a 0a20 2020 2020  str, Any]:.     
-00016940: 2020 2072 6574 7572 6e20 7b0a 2020 2020     return {.    
-00016950: 2020 2020 2020 2020 2263 6f6c 6c61 7073          "collaps
-00016960: 655f 6178 6973 223a 2073 656c 662e 5f63  e_axis": self._c
-00016970: 6f6c 6c61 7073 655f 6178 6973 2c0a 2020  ollapse_axis,.  
-00016980: 2020 2020 2020 2020 2020 2269 6e64 6578            "index
-00016990: 223a 2073 656c 662e 5f69 6e64 6578 2c0a  ": self._index,.
-000169a0: 2020 2020 2020 2020 2020 2020 2264 6174              "dat
-000169b0: 615f 7479 7065 223a 2073 656c 662e 5f64  a_type": self._d
-000169c0: 6174 615f 7479 7065 2c0a 2020 2020 2020  ata_type,.      
-000169d0: 2020 2020 2020 2264 6174 615f 7061 7261        "data_para
-000169e0: 6d73 223a 2073 656c 662e 5f64 6174 615f  ms": self._data_
-000169f0: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
-00016a00: 7d0a 0a20 2020 2040 7061 7261 6d73 2e73  }..    @params.s
-00016a10: 6574 7465 720a 2020 2020 6465 6620 7061  etter.    def pa
-00016a20: 7261 6d73 2873 656c 662c 206e 6577 5f70  rams(self, new_p
-00016a30: 6172 616d 733a 2044 6963 745b 7374 722c  arams: Dict[str,
-00016a40: 2041 6e79 5d29 3a0a 2020 2020 2020 2020   Any]):.        
-00016a50: 7365 6c66 2e5f 6461 7461 5f74 7970 6520  self._data_type 
-00016a60: 3d20 6e65 775f 7061 7261 6d73 2e67 6574  = new_params.get
-00016a70: 2822 6461 7461 5f74 7970 6522 290a 2020  ("data_type").  
-00016a80: 2020 2020 2020 6966 2073 656c 662e 5f63        if self._c
-00016a90: 6f6c 6c61 7073 655f 6178 6973 2069 7320  ollapse_axis is 
-00016aa0: 6e6f 7420 4e6f 6e65 2061 6e64 2073 656c  not None and sel
-00016ab0: 662e 5f64 6174 615f 7479 7065 203d 3d20  f._data_type == 
-00016ac0: 2273 6572 6965 7322 3a0a 2020 2020 2020  "series":.      
-00016ad0: 2020 2020 2020 7365 6c66 2e5f 696e 6465        self._inde
-00016ae0: 7820 3d20 2873 656c 662e 5f69 6e64 6578  x = (self._index
-00016af0: 5b31 202d 2073 656c 662e 5f63 6f6c 6c61  [1 - self._colla
-00016b00: 7073 655f 6178 6973 5d2c 290a 2020 2020  pse_axis],).    
-00016b10: 2020 2020 6966 2073 656c 662e 5f63 6f6c      if self._col
-00016b20: 6c61 7073 655f 6178 6973 2069 7320 4e6f  lapse_axis is No
-00016b30: 6e65 2061 6e64 2073 656c 662e 5f64 6174  ne and self._dat
-00016b40: 615f 7479 7065 203d 3d20 2264 6174 6166  a_type == "dataf
-00016b50: 7261 6d65 223a 0a20 2020 2020 2020 2020  rame":.         
-00016b60: 2020 2073 656c 662e 5f69 6e64 6578 203d     self._index =
-00016b70: 2028 7365 6c66 2e5f 696e 6465 785b 305d   (self._index[0]
-00016b80: 2c20 3029 0a20 2020 2020 2020 2064 6174  , 0).        dat
-00016b90: 615f 7061 7261 6d73 203d 206e 6577 5f70  a_params = new_p
-00016ba0: 6172 616d 735b 2264 6174 615f 7061 7261  arams["data_para
-00016bb0: 6d73 225d 0a20 2020 2020 2020 2069 6620  ms"].        if 
-00016bc0: 7365 6c66 2e5f 6461 7461 5f74 7970 6520  self._data_type 
-00016bd0: 3d3d 2022 6461 7461 6672 616d 6522 3a0a  == "dataframe":.
-00016be0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00016bf0: 5f70 6172 616d 735b 2264 7479 7065 7322  _params["dtypes"
-00016c00: 5d20 3d20 6461 7461 5f70 6172 616d 735b  ] = data_params[
-00016c10: 2264 7479 7065 735f 7661 6c75 6522 5d2e  "dtypes_value"].
-00016c20: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-00016c30: 2020 6461 7461 5f70 6172 616d 735b 2263    data_params["c
-00016c40: 6f6c 756d 6e73 5f76 616c 7565 225d 203d  olumns_value"] =
-00016c50: 2070 6172 7365 5f69 6e64 6578 280a 2020   parse_index(.  
-00016c60: 2020 2020 2020 2020 2020 2020 2020 6461                da
-00016c70: 7461 5f70 6172 616d 735b 2264 7479 7065  ta_params["dtype
-00016c80: 735f 7661 6c75 6522 5d2e 7661 6c75 652e  s_value"].value.
-00016c90: 696e 6465 782c 2073 746f 7265 5f64 6174  index, store_dat
-00016ca0: 613d 5472 7565 0a20 2020 2020 2020 2020  a=True.         
-00016cb0: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00016cc0: 662e 5f64 6174 615f 7061 7261 6d73 203d  f._data_params =
-00016cd0: 207b 6b3a 2076 2066 6f72 206b 2c20 7620   {k: v for k, v 
-00016ce0: 696e 2064 6174 615f 7061 7261 6d73 2e69  in data_params.i
-00016cf0: 7465 6d73 2829 7d0a 0a20 2020 2040 636c  tems()}..    @cl
-00016d00: 6173 736d 6574 686f 640a 2020 2020 6465  assmethod.    de
-00016d10: 6620 6765 745f 7061 7261 6d73 5f66 726f  f get_params_fro
-00016d20: 6d5f 6461 7461 2863 6c73 2c20 6461 7461  m_data(cls, data
-00016d30: 3a20 416e 7929 202d 3e20 4469 6374 5b73  : Any) -> Dict[s
-00016d40: 7472 2c20 416e 795d 3a0a 2020 2020 2020  tr, Any]:.      
-00016d50: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00016d60: 6461 7461 2c20 7064 2e44 6174 6146 7261  data, pd.DataFra
-00016d70: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-00016d80: 2072 6574 7572 6e20 7b0a 2020 2020 2020   return {.      
-00016d90: 2020 2020 2020 2020 2020 2264 6174 615f            "data_
-00016da0: 7479 7065 223a 2022 6461 7461 6672 616d  type": "datafram
-00016db0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-00016dc0: 2020 2020 2264 6174 615f 7061 7261 6d73      "data_params
-00016dd0: 223a 2044 6174 6146 7261 6d65 4368 756e  ": DataFrameChun
-00016de0: 6b44 6174 612e 6765 745f 7061 7261 6d73  kData.get_params
-00016df0: 5f66 726f 6d5f 6461 7461 2864 6174 6129  _from_data(data)
-00016e00: 2c0a 2020 2020 2020 2020 2020 2020 7d0a  ,.            }.
-00016e10: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00016e20: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00016e30: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00016e40: 2020 2022 6461 7461 5f74 7970 6522 3a20     "data_type": 
-00016e50: 2273 6572 6965 7322 2c0a 2020 2020 2020  "series",.      
-00016e60: 2020 2020 2020 2020 2020 2264 6174 615f            "data_
-00016e70: 7061 7261 6d73 223a 2053 6572 6965 7343  params": SeriesC
-00016e80: 6875 6e6b 4461 7461 2e67 6574 5f70 6172  hunkData.get_par
-00016e90: 616d 735f 6672 6f6d 5f64 6174 6128 6461  ams_from_data(da
-00016ea0: 7461 292c 0a20 2020 2020 2020 2020 2020  ta),.           
-00016eb0: 207d 0a0a 0a63 6c61 7373 2044 6174 6146   }...class DataF
-00016ec0: 7261 6d65 4f72 5365 7269 6573 4368 756e  rameOrSeriesChun
-00016ed0: 6b28 4368 756e 6b29 3a0a 2020 2020 5f5f  k(Chunk):.    __
-00016ee0: 736c 6f74 735f 5f20 3d20 2829 0a20 2020  slots__ = ().   
-00016ef0: 205f 616c 6c6f 775f 6461 7461 5f74 7970   _allow_data_typ
-00016f00: 655f 203d 2028 4461 7461 4672 616d 654f  e_ = (DataFrameO
-00016f10: 7253 6572 6965 7343 6875 6e6b 4461 7461  rSeriesChunkData
-00016f20: 2c29 0a20 2020 2074 7970 655f 6e61 6d65  ,).    type_name
-00016f30: 203d 2022 4461 7461 4672 616d 654f 7253   = "DataFrameOrS
-00016f40: 6572 6965 7322 0a0a 0a63 6c61 7373 2044  eries"...class D
-00016f50: 6174 6146 7261 6d65 4f72 5365 7269 6573  ataFrameOrSeries
-00016f60: 4461 7461 2848 6173 5368 6170 6554 696c  Data(HasShapeTil
-00016f70: 6561 626c 6544 6174 612c 205f 546f 5061  eableData, _ToPa
-00016f80: 6e64 6173 4d69 7869 6e29 3a0a 2020 2020  ndasMixin):.    
-00016f90: 5f5f 736c 6f74 735f 5f20 3d20 2829 0a20  __slots__ = (). 
-00016fa0: 2020 205f 6368 756e 6b73 203d 204c 6973     _chunks = Lis
-00016fb0: 7446 6965 6c64 280a 2020 2020 2020 2020  tField(.        
-00016fc0: 2263 6875 6e6b 7322 2c0a 2020 2020 2020  "chunks",.      
-00016fd0: 2020 4669 656c 6454 7970 6573 2e72 6566    FieldTypes.ref
-00016fe0: 6572 656e 6365 2844 6174 6146 7261 6d65  erence(DataFrame
-00016ff0: 4f72 5365 7269 6573 4368 756e 6b44 6174  OrSeriesChunkDat
-00017000: 6129 2c0a 2020 2020 2020 2020 6f6e 5f73  a),.        on_s
-00017010: 6572 6961 6c69 7a65 3d6c 616d 6264 6120  erialize=lambda 
-00017020: 783a 205b 6974 2e64 6174 6120 666f 7220  x: [it.data for 
-00017030: 6974 2069 6e20 785d 2069 6620 7820 6973  it in x] if x is
-00017040: 206e 6f74 204e 6f6e 6520 656c 7365 2078   not None else x
-00017050: 2c0a 2020 2020 2020 2020 6f6e 5f64 6573  ,.        on_des
-00017060: 6572 6961 6c69 7a65 3d6c 616d 6264 6120  erialize=lambda 
-00017070: 783a 205b 4461 7461 4672 616d 654f 7253  x: [DataFrameOrS
-00017080: 6572 6965 7343 6875 6e6b 2869 7429 2066  eriesChunk(it) f
-00017090: 6f72 2069 7420 696e 2078 5d0a 2020 2020  or it in x].    
-000170a0: 2020 2020 6966 2078 2069 7320 6e6f 7420      if x is not 
-000170b0: 4e6f 6e65 0a20 2020 2020 2020 2065 6c73  None.        els
-000170c0: 6520 782c 0a20 2020 2029 0a0a 2020 2020  e x,.    )..    
-000170d0: 5f64 6174 615f 7479 7065 203d 2053 7472  _data_type = Str
-000170e0: 696e 6746 6965 6c64 2822 6461 7461 5f74  ingField("data_t
-000170f0: 7970 6522 290a 2020 2020 5f64 6174 615f  ype").    _data_
-00017100: 7061 7261 6d73 203d 2044 6963 7446 6965  params = DictFie
-00017110: 6c64 2822 6461 7461 5f70 6172 616d 7322  ld("data_params"
-00017120: 290a 0a20 2020 2064 6566 205f 5f69 6e69  )..    def __ini
-00017130: 745f 5f28 0a20 2020 2020 2020 2073 656c  t__(.        sel
-00017140: 662c 0a20 2020 2020 2020 206f 703d 4e6f  f,.        op=No
-00017150: 6e65 2c0a 2020 2020 2020 2020 6368 756e  ne,.        chun
-00017160: 6b73 3d4e 6f6e 652c 0a20 2020 2020 2020  ks=None,.       
-00017170: 2064 6174 615f 7479 7065 3d4e 6f6e 652c   data_type=None,
-00017180: 0a20 2020 2020 2020 2064 6174 615f 7061  .        data_pa
-00017190: 7261 6d73 3d4e 6f6e 652c 0a20 2020 2020  rams=None,.     
-000171a0: 2020 202a 2a6b 772c 0a20 2020 2029 3a0a     **kw,.    ):.
-000171b0: 2020 2020 2020 2020 7365 6c66 2e5f 6461          self._da
-000171c0: 7461 5f74 7970 6520 3d20 6461 7461 5f74  ta_type = data_t
-000171d0: 7970 650a 2020 2020 2020 2020 7365 6c66  ype.        self
-000171e0: 2e5f 6461 7461 5f70 6172 616d 7320 3d20  ._data_params = 
-000171f0: 6461 7461 5f70 6172 616d 7320 6f72 2064  data_params or d
-00017200: 6963 7428 290a 2020 2020 2020 2020 7375  ict().        su
-00017210: 7065 7228 292e 5f5f 696e 6974 5f5f 280a  per().__init__(.
-00017220: 2020 2020 2020 2020 2020 2020 5f6f 703d              _op=
-00017230: 6f70 2c0a 2020 2020 2020 2020 2020 2020  op,.            
-00017240: 5f63 6875 6e6b 733d 6368 756e 6b73 2c0a  _chunks=chunks,.
-00017250: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
-00017260: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00017270: 2064 6566 205f 5f67 6574 6174 7472 5f5f   def __getattr__
-00017280: 2873 656c 662c 2069 7465 6d29 3a0a 2020  (self, item):.  
-00017290: 2020 2020 2020 6966 2069 7465 6d20 696e        if item in
-000172a0: 2073 656c 662e 5f64 6174 615f 7061 7261   self._data_para
-000172b0: 6d73 3a0a 2020 2020 2020 2020 2020 2020  ms:.            
-000172c0: 7265 7475 726e 2073 656c 662e 5f64 6174  return self._dat
-000172d0: 615f 7061 7261 6d73 5b69 7465 6d5d 0a20  a_params[item]. 
-000172e0: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
-000172f0: 7269 6275 7465 4572 726f 7228 6622 277b  ributeError(f"'{
-00017300: 7479 7065 2873 656c 6629 7d27 206f 626a  type(self)}' obj
-00017310: 6563 7420 6861 7320 6e6f 2061 7474 7269  ect has no attri
-00017320: 6275 7465 2027 7b69 7465 6d7d 2722 290a  bute '{item}'").
-00017330: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00017340: 2020 2064 6566 2073 6861 7065 2873 656c     def shape(sel
-00017350: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00017360: 726e 2073 656c 662e 5f64 6174 615f 7061  rn self._data_pa
-00017370: 7261 6d73 2e67 6574 2822 7368 6170 6522  rams.get("shape"
-00017380: 2c20 4e6f 6e65 290a 0a20 2020 2040 7072  , None)..    @pr
-00017390: 6f70 6572 7479 0a20 2020 2064 6566 206e  operty.    def n
-000173a0: 7370 6c69 7473 2873 656c 6629 3a0a 2020  splits(self):.  
-000173b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000173c0: 662e 5f64 6174 615f 7061 7261 6d73 2e67  f._data_params.g
-000173d0: 6574 2822 6e73 706c 6974 7322 2c20 4e6f  et("nsplits", No
-000173e0: 6e65 290a 0a20 2020 2040 7072 6f70 6572  ne)..    @proper
-000173f0: 7479 0a20 2020 2064 6566 2064 6174 615f  ty.    def data_
-00017400: 7479 7065 2873 656c 6629 3a0a 2020 2020  type(self):.    
-00017410: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00017420: 5f64 6174 615f 7479 7065 0a0a 2020 2020  _data_type..    
-00017430: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00017440: 6620 6461 7461 5f70 6172 616d 7328 7365  f data_params(se
-00017450: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00017460: 7572 6e20 7365 6c66 2e5f 6461 7461 5f70  urn self._data_p
-00017470: 6172 616d 730a 0a20 2020 2040 7072 6f70  arams..    @prop
-00017480: 6572 7479 0a20 2020 2064 6566 2070 6172  erty.    def par
-00017490: 616d 7328 7365 6c66 2920 2d3e 2044 6963  ams(self) -> Dic
-000174a0: 745b 7374 722c 2041 6e79 5d3a 0a20 2020  t[str, Any]:.   
-000174b0: 2020 2020 2072 6574 7572 6e20 7b22 6461       return {"da
-000174c0: 7461 5f74 7970 6522 3a20 7365 6c66 2e5f  ta_type": self._
-000174d0: 6461 7461 5f74 7970 652c 2022 6461 7461  data_type, "data
-000174e0: 5f70 6172 616d 7322 3a20 7365 6c66 2e5f  _params": self._
-000174f0: 6461 7461 5f70 6172 616d 737d 0a0a 2020  data_params}..  
-00017500: 2020 4070 6172 616d 732e 7365 7474 6572    @params.setter
-00017510: 0a20 2020 2064 6566 2070 6172 616d 7328  .    def params(
-00017520: 7365 6c66 2c20 6e65 775f 7061 7261 6d73  self, new_params
-00017530: 3a20 4469 6374 5b73 7472 2c20 416e 795d  : Dict[str, Any]
-00017540: 293a 0a20 2020 2020 2020 2023 2041 6674  ):.        # Aft
-00017550: 6572 2065 7865 6375 7469 6f6e 2c20 6372  er execution, cr
-00017560: 6561 7465 2044 6174 6146 7261 6d65 4665  eate DataFrameFe
-00017570: 7463 682c 2061 6e64 2074 6865 2064 6174  tch, and the dat
-00017580: 610a 2020 2020 2020 2020 2320 636f 7272  a.        # corr
-00017590: 6573 706f 6e64 696e 6720 746f 2074 6865  esponding to the
-000175a0: 206f 7269 6769 6e61 6c20 6b65 7920 6973   original key is
-000175b0: 2073 7469 6c6c 2044 6174 6146 7261 6d65   still DataFrame
-000175c0: 4f72 5365 7269 6573 2074 7970 652c 0a20  OrSeries type,. 
-000175d0: 2020 2020 2020 2023 2073 6f20 7768 656e         # so when
-000175e0: 2072 6573 746f 7269 6e67 2044 6174 6146   restoring DataF
-000175f0: 7261 6d65 4f72 5365 7269 6573 2074 7970  rameOrSeries typ
-00017600: 652c 0a20 2020 2020 2020 2023 2074 6865  e,.        # the
-00017610: 7265 2069 7320 6e6f 2022 6461 7461 5f74  re is no "data_t
-00017620: 7970 6522 2066 6965 6c64 2069 6e20 7061  ype" field in pa
-00017630: 7261 6d73 2e0a 2020 2020 2020 2020 6966  rams..        if
-00017640: 2022 6461 7461 5f74 7970 6522 206e 6f74   "data_type" not
-00017650: 2069 6e20 6e65 775f 7061 7261 6d73 3a0a   in new_params:.
-00017660: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-00017670: 6474 7970 6522 2069 6e20 6e65 775f 7061  dtype" in new_pa
-00017680: 7261 6d73 3a0a 2020 2020 2020 2020 2020  rams:.          
-00017690: 2020 2020 2020 7365 6c66 2e5f 6461 7461        self._data
-000176a0: 5f74 7970 6520 3d20 2273 6572 6965 7322  _type = "series"
-000176b0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-000176c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000176d0: 2020 2073 656c 662e 5f64 6174 615f 7479     self._data_ty
-000176e0: 7065 203d 2022 6461 7461 6672 616d 6522  pe = "dataframe"
-000176f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00017700: 662e 5f64 6174 615f 7061 7261 6d73 203d  f._data_params =
-00017710: 206e 6577 5f70 6172 616d 732e 636f 7079   new_params.copy
-00017720: 2829 0a20 2020 2020 2020 2065 6c73 653a  ().        else:
-00017730: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00017740: 662e 5f64 6174 615f 7479 7065 203d 206e  f._data_type = n
-00017750: 6577 5f70 6172 616d 732e 6765 7428 2264  ew_params.get("d
-00017760: 6174 615f 7479 7065 2229 0a20 2020 2020  ata_type").     
-00017770: 2020 2020 2020 2073 656c 662e 5f64 6174         self._dat
-00017780: 615f 7061 7261 6d73 203d 207b 0a20 2020  a_params = {.   
-00017790: 2020 2020 2020 2020 2020 2020 206b 3a20               k: 
-000177a0: 7620 666f 7220 6b2c 2076 2069 6e20 6e65  v for k, v in ne
-000177b0: 775f 7061 7261 6d73 2e67 6574 2822 6461  w_params.get("da
-000177c0: 7461 5f70 6172 616d 7322 2c20 7b7d 292e  ta_params", {}).
-000177d0: 6974 656d 7328 290a 2020 2020 2020 2020  items().        
-000177e0: 2020 2020 7d0a 0a20 2020 2064 6566 2072      }..    def r
-000177f0: 6566 7265 7368 5f70 6172 616d 7328 7365  efresh_params(se
-00017800: 6c66 293a 0a20 2020 2020 2020 2069 6e64  lf):.        ind
-00017810: 6578 5f74 6f5f 696e 6465 785f 7661 6c75  ex_to_index_valu
-00017820: 6573 203d 2064 6963 7428 290a 2020 2020  es = dict().    
-00017830: 2020 2020 666f 7220 6368 756e 6b20 696e      for chunk in
-00017840: 2073 656c 662e 6368 756e 6b73 3a0a 2020   self.chunks:.  
-00017850: 2020 2020 2020 2020 2020 6966 2063 6875            if chu
-00017860: 6e6b 2e6e 6469 6d20 3d3d 2031 3a0a 2020  nk.ndim == 1:.  
-00017870: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00017880: 6465 785f 746f 5f69 6e64 6578 5f76 616c  dex_to_index_val
-00017890: 7565 735b 6368 756e 6b2e 696e 6465 785d  ues[chunk.index]
-000178a0: 203d 2063 6875 6e6b 2e69 6e64 6578 5f76   = chunk.index_v
-000178b0: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
-000178c0: 2065 6c69 6620 6368 756e 6b2e 696e 6465   elif chunk.inde
-000178d0: 785b 315d 203d 3d20 303a 0a20 2020 2020  x[1] == 0:.     
-000178e0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-000178f0: 5f74 6f5f 696e 6465 785f 7661 6c75 6573  _to_index_values
-00017900: 5b63 6875 6e6b 2e69 6e64 6578 5d20 3d20  [chunk.index] = 
-00017910: 6368 756e 6b2e 696e 6465 785f 7661 6c75  chunk.index_valu
-00017920: 650a 2020 2020 2020 2020 696e 6465 785f  e.        index_
-00017930: 7661 6c75 6520 3d20 6d65 7267 655f 696e  value = merge_in
-00017940: 6465 785f 7661 6c75 6528 696e 6465 785f  dex_value(index_
-00017950: 746f 5f69 6e64 6578 5f76 616c 7565 732c  to_index_values,
-00017960: 2073 746f 7265 5f64 6174 613d 4661 6c73   store_data=Fals
-00017970: 6529 0a20 2020 2020 2020 206e 7370 6c69  e).        nspli
-00017980: 7473 203d 2063 616c 635f 6e73 706c 6974  ts = calc_nsplit
-00017990: 7328 7b63 2e69 6e64 6578 3a20 632e 7368  s({c.index: c.sh
-000179a0: 6170 6520 666f 7220 6320 696e 2073 656c  ape for c in sel
-000179b0: 662e 6368 756e 6b73 7d29 0a20 2020 2020  f.chunks}).     
-000179c0: 2020 2073 6861 7065 203d 2074 7570 6c65     shape = tuple
-000179d0: 2873 756d 286e 7329 2066 6f72 206e 7320  (sum(ns) for ns 
-000179e0: 696e 206e 7370 6c69 7473 290a 0a20 2020  in nsplits)..   
-000179f0: 2020 2020 2064 6174 615f 7061 7261 6d73       data_params
-00017a00: 203d 2064 6963 7428 290a 2020 2020 2020   = dict().      
-00017a10: 2020 6461 7461 5f70 6172 616d 735b 226e    data_params["n
-00017a20: 7370 6c69 7473 225d 203d 206e 7370 6c69  splits"] = nspli
-00017a30: 7473 0a20 2020 2020 2020 2064 6174 615f  ts.        data_
-00017a40: 7061 7261 6d73 5b22 7368 6170 6522 5d20  params["shape"] 
-00017a50: 3d20 7368 6170 650a 2020 2020 2020 2020  = shape.        
-00017a60: 6461 7461 5f70 6172 616d 735b 2269 6e64  data_params["ind
-00017a70: 6578 5f76 616c 7565 225d 203d 2069 6e64  ex_value"] = ind
-00017a80: 6578 5f76 616c 7565 0a0a 2020 2020 2020  ex_value..      
-00017a90: 2020 7365 6c66 2e5f 6461 7461 5f74 7970    self._data_typ
-00017aa0: 6520 3d20 7365 6c66 2e5f 6368 756e 6b73  e = self._chunks
-00017ab0: 5b30 5d2e 5f64 6174 615f 7479 7065 0a20  [0]._data_type. 
-00017ac0: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
-00017ad0: 6174 615f 7479 7065 203d 3d20 2264 6174  ata_type == "dat
-00017ae0: 6166 7261 6d65 223a 0a20 2020 2020 2020  aframe":.       
-00017af0: 2020 2020 2061 6c6c 5f64 7479 7065 7320       all_dtypes 
-00017b00: 3d20 5b63 2e64 7479 7065 735f 7661 6c75  = [c.dtypes_valu
-00017b10: 652e 7661 6c75 6520 666f 7220 6320 696e  e.value for c in
-00017b20: 2073 656c 662e 6368 756e 6b73 2069 6620   self.chunks if 
-00017b30: 632e 696e 6465 785b 305d 203d 3d20 305d  c.index[0] == 0]
-00017b40: 0a20 2020 2020 2020 2020 2020 2064 7479  .            dty
-00017b50: 7065 7320 3d20 7064 2e63 6f6e 6361 7428  pes = pd.concat(
-00017b60: 616c 6c5f 6474 7970 6573 290a 2020 2020  all_dtypes).    
-00017b70: 2020 2020 2020 2020 6461 7461 5f70 6172          data_par
-00017b80: 616d 735b 2264 7479 7065 7322 5d20 3d20  ams["dtypes"] = 
-00017b90: 6474 7970 6573 0a20 2020 2020 2020 2020  dtypes.         
-00017ba0: 2020 2063 6f6c 756d 6e73 5f76 616c 7565     columns_value
-00017bb0: 7320 3d20 7061 7273 655f 696e 6465 7828  s = parse_index(
-00017bc0: 6474 7970 6573 2e69 6e64 6578 2c20 7374  dtypes.index, st
-00017bd0: 6f72 655f 6461 7461 3d54 7275 6529 0a20  ore_data=True). 
-00017be0: 2020 2020 2020 2020 2020 2064 6174 615f             data_
-00017bf0: 7061 7261 6d73 5b22 636f 6c75 6d6e 735f  params["columns_
-00017c00: 7661 6c75 6522 5d20 3d20 636f 6c75 6d6e  value"] = column
-00017c10: 735f 7661 6c75 6573 0a20 2020 2020 2020  s_values.       
-00017c20: 2020 2020 2064 6174 615f 7061 7261 6d73       data_params
-00017c30: 5b22 6474 7970 6573 5f76 616c 7565 225d  ["dtypes_value"]
-00017c40: 203d 2044 7479 7065 7356 616c 7565 280a   = DtypesValue(.
-00017c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c60: 6b65 793d 746f 6b65 6e69 7a65 2864 7479  key=tokenize(dty
-00017c70: 7065 7329 2c20 7661 6c75 653d 6474 7970  pes), value=dtyp
-00017c80: 6573 0a20 2020 2020 2020 2020 2020 2029  es.            )
-00017c90: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00017ca0: 2020 2020 2020 2020 2020 2064 6174 615f             data_
-00017cb0: 7061 7261 6d73 5b22 6474 7970 6522 5d20  params["dtype"] 
-00017cc0: 3d20 7365 6c66 2e63 6875 6e6b 735b 305d  = self.chunks[0]
-00017cd0: 2e64 7479 7065 0a20 2020 2020 2020 2020  .dtype.         
-00017ce0: 2020 2064 6174 615f 7061 7261 6d73 5b22     data_params["
-00017cf0: 6e61 6d65 225d 203d 2073 656c 662e 6368  name"] = self.ch
-00017d00: 756e 6b73 5b30 5d2e 6e61 6d65 0a20 2020  unks[0].name.   
-00017d10: 2020 2020 2073 656c 662e 5f64 6174 615f       self._data_
-00017d20: 7061 7261 6d73 2e75 7064 6174 6528 6461  params.update(da
-00017d30: 7461 5f70 6172 616d 7329 0a0a 2020 2020  ta_params)..    
-00017d40: 6465 6620 656e 7375 7265 5f64 6174 6128  def ensure_data(
-00017d50: 7365 6c66 293a 0a20 2020 2020 2020 2066  self):.        f
-00017d60: 726f 6d20 2e66 6574 6368 2e63 6f72 6520  rom .fetch.core 
-00017d70: 696d 706f 7274 2044 6174 6146 7261 6d65  import DataFrame
-00017d80: 4665 7463 680a 0a20 2020 2020 2020 2073  Fetch..        s
-00017d90: 656c 662e 6578 6563 7574 6528 290a 2020  elf.execute().  
-00017da0: 2020 2020 2020 6465 6661 756c 745f 7365        default_se
-00017db0: 7373 203d 2067 6574 5f64 6566 6175 6c74  ss = get_default
-00017dc0: 5f73 6573 7369 6f6e 2829 0a20 2020 2020  _session().     
-00017dd0: 2020 2073 656c 662e 5f64 6574 6163 685f     self._detach_
-00017de0: 7365 7373 696f 6e28 6465 6661 756c 745f  session(default_
-00017df0: 7365 7373 2e5f 7365 7373 696f 6e29 0a0a  sess._session)..
-00017e00: 2020 2020 2020 2020 6665 7463 685f 7469          fetch_ti
-00017e10: 6c65 6162 6c65 203d 2064 6566 6175 6c74  leable = default
-00017e20: 5f73 6573 732e 5f73 6573 7369 6f6e 2e5f  _sess._session._
-00017e30: 7469 6c65 6162 6c65 5f74 6f5f 6665 7463  tileable_to_fetc
-00017e40: 685b 7365 6c66 5d0a 2020 2020 2020 2020  h[self].        
-00017e50: 6e65 7720 3d20 4461 7461 4672 616d 6546  new = DataFrameF
-00017e60: 6574 6368 280a 2020 2020 2020 2020 2020  etch(.          
-00017e70: 2020 6f75 7470 7574 5f74 7970 6573 3d5b    output_types=[
-00017e80: 6765 7461 7474 7228 4f75 7470 7574 5479  getattr(OutputTy
-00017e90: 7065 2c20 7365 6c66 2e64 6174 615f 7479  pe, self.data_ty
-00017ea0: 7065 295d 0a20 2020 2020 2020 2029 2e6e  pe)].        ).n
-00017eb0: 6577 5f74 696c 6561 626c 6528 0a20 2020  ew_tileable(.   
-00017ec0: 2020 2020 2020 2020 205b 5d2c 0a20 2020           [],.   
-00017ed0: 2020 2020 2020 2020 205f 6b65 793d 7365           _key=se
-00017ee0: 6c66 2e6b 6579 2c0a 2020 2020 2020 2020  lf.key,.        
-00017ef0: 2020 2020 6368 756e 6b73 3d66 6574 6368      chunks=fetch
-00017f00: 5f74 696c 6561 626c 652e 6368 756e 6b73  _tileable.chunks
-00017f10: 2c0a 2020 2020 2020 2020 2020 2020 6e73  ,.            ns
-00017f20: 706c 6974 733d 6665 7463 685f 7469 6c65  plits=fetch_tile
-00017f30: 6162 6c65 2e6e 7370 6c69 7473 2c0a 2020  able.nsplits,.  
-00017f40: 2020 2020 2020 2020 2020 2a2a 7365 6c66            **self
-00017f50: 2e64 6174 615f 7061 7261 6d73 2c0a 2020  .data_params,.  
-00017f60: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00017f70: 6e65 772e 5f61 7474 6163 685f 7365 7373  new._attach_sess
-00017f80: 696f 6e28 6465 6661 756c 745f 7365 7373  ion(default_sess
-00017f90: 2e5f 7365 7373 696f 6e29 0a20 2020 2020  ._session).     
-00017fa0: 2020 2072 6574 7572 6e20 6e65 770a 0a0a     return new...
-00017fb0: 636c 6173 7320 4461 7461 4672 616d 654f  class DataFrameO
-00017fc0: 7253 6572 6965 7328 4861 7353 6861 7065  rSeries(HasShape
-00017fd0: 5469 6c65 6162 6c65 2c20 5f54 6f50 616e  Tileable, _ToPan
-00017fe0: 6461 734d 6978 696e 293a 0a20 2020 205f  dasMixin):.    _
-00017ff0: 5f73 6c6f 7473 5f5f 203d 2028 290a 2020  _slots__ = ().  
-00018000: 2020 5f61 6c6c 6f77 5f64 6174 615f 7479    _allow_data_ty
-00018010: 7065 5f20 3d20 2844 6174 6146 7261 6d65  pe_ = (DataFrame
-00018020: 4f72 5365 7269 6573 4461 7461 2c29 0a20  OrSeriesData,). 
-00018030: 2020 2074 7970 655f 6e61 6d65 203d 2022     type_name = "
-00018040: 4461 7461 4672 616d 654f 7253 6572 6965  DataFrameOrSerie
-00018050: 7322 0a0a 0a49 4e44 4558 5f54 5950 4520  s"...INDEX_TYPE 
-00018060: 3d20 2849 6e64 6578 2c20 496e 6465 7844  = (Index, IndexD
-00018070: 6174 6129 0a49 4e44 4558 5f43 4855 4e4b  ata).INDEX_CHUNK
-00018080: 5f54 5950 4520 3d20 2849 6e64 6578 4368  _TYPE = (IndexCh
-00018090: 756e 6b2c 2049 6e64 6578 4368 756e 6b44  unk, IndexChunkD
-000180a0: 6174 6129 0a53 4552 4945 535f 5459 5045  ata).SERIES_TYPE
-000180b0: 203d 2028 5365 7269 6573 2c20 5365 7269   = (Series, Seri
-000180c0: 6573 4461 7461 290a 5345 5249 4553 5f43  esData).SERIES_C
-000180d0: 4855 4e4b 5f54 5950 4520 3d20 2853 6572  HUNK_TYPE = (Ser
-000180e0: 6965 7343 6875 6e6b 2c20 5365 7269 6573  iesChunk, Series
-000180f0: 4368 756e 6b44 6174 6129 0a44 4154 4146  ChunkData).DATAF
-00018100: 5241 4d45 5f4f 525f 5345 5249 4553 5f54  RAME_OR_SERIES_T
-00018110: 5950 4520 3d20 2844 6174 6146 7261 6d65  YPE = (DataFrame
-00018120: 4f72 5365 7269 6573 2c20 4461 7461 4672  OrSeries, DataFr
-00018130: 616d 654f 7253 6572 6965 7344 6174 6129  ameOrSeriesData)
-00018140: 0a44 4154 4146 5241 4d45 5f4f 525f 5345  .DATAFRAME_OR_SE
-00018150: 5249 4553 5f43 4855 4e4b 5f54 5950 4520  RIES_CHUNK_TYPE 
-00018160: 3d20 2844 6174 6146 7261 6d65 4f72 5365  = (DataFrameOrSe
-00018170: 7269 6573 4368 756e 6b2c 2044 6174 6146  riesChunk, DataF
-00018180: 7261 6d65 4f72 5365 7269 6573 4368 756e  rameOrSeriesChun
-00018190: 6b44 6174 6129 0a44 4154 4146 5241 4d45  kData).DATAFRAME
-000181a0: 5f54 5950 4520 3d20 2844 6174 6146 7261  _TYPE = (DataFra
-000181b0: 6d65 2c20 4461 7461 4672 616d 6544 6174  me, DataFrameDat
-000181c0: 6129 0a44 4154 4146 5241 4d45 5f43 4855  a).DATAFRAME_CHU
-000181d0: 4e4b 5f54 5950 4520 3d20 2844 6174 6146  NK_TYPE = (DataF
-000181e0: 7261 6d65 4368 756e 6b2c 2044 6174 6146  rameChunk, DataF
-000181f0: 7261 6d65 4368 756e 6b44 6174 6129 0a44  rameChunkData).D
-00018200: 4154 4146 5241 4d45 5f47 524f 5550 4259  ATAFRAME_GROUPBY
-00018210: 5f54 5950 4520 3d20 2844 6174 6146 7261  _TYPE = (DataFra
-00018220: 6d65 4772 6f75 7042 792c 2044 6174 6146  meGroupBy, DataF
-00018230: 7261 6d65 4772 6f75 7042 7944 6174 6129  rameGroupByData)
-00018240: 0a44 4154 4146 5241 4d45 5f47 524f 5550  .DATAFRAME_GROUP
-00018250: 4259 5f43 4855 4e4b 5f54 5950 4520 3d20  BY_CHUNK_TYPE = 
-00018260: 2844 6174 6146 7261 6d65 4772 6f75 7042  (DataFrameGroupB
-00018270: 7943 6875 6e6b 2c20 4461 7461 4672 616d  yChunk, DataFram
-00018280: 6547 726f 7570 4279 4368 756e 6b44 6174  eGroupByChunkDat
-00018290: 6129 0a53 4552 4945 535f 4752 4f55 5042  a).SERIES_GROUPB
-000182a0: 595f 5459 5045 203d 2028 5365 7269 6573  Y_TYPE = (Series
-000182b0: 4772 6f75 7042 792c 2053 6572 6965 7347  GroupBy, SeriesG
-000182c0: 726f 7570 4279 4461 7461 290a 5345 5249  roupByData).SERI
-000182d0: 4553 5f47 524f 5550 4259 5f43 4855 4e4b  ES_GROUPBY_CHUNK
-000182e0: 5f54 5950 4520 3d20 2853 6572 6965 7347  _TYPE = (SeriesG
-000182f0: 726f 7570 4279 4368 756e 6b2c 2053 6572  roupByChunk, Ser
-00018300: 6965 7347 726f 7570 4279 4368 756e 6b44  iesGroupByChunkD
-00018310: 6174 6129 0a47 524f 5550 4259 5f54 5950  ata).GROUPBY_TYP
-00018320: 4520 3d20 2847 726f 7570 4279 2c29 202b  E = (GroupBy,) +
-00018330: 2044 4154 4146 5241 4d45 5f47 524f 5550   DATAFRAME_GROUP
-00018340: 4259 5f54 5950 4520 2b20 5345 5249 4553  BY_TYPE + SERIES
-00018350: 5f47 524f 5550 4259 5f54 5950 450a 4752  _GROUPBY_TYPE.GR
-00018360: 4f55 5042 595f 4348 554e 4b5f 5459 5045  OUPBY_CHUNK_TYPE
-00018370: 203d 2044 4154 4146 5241 4d45 5f47 524f   = DATAFRAME_GRO
-00018380: 5550 4259 5f43 4855 4e4b 5f54 5950 4520  UPBY_CHUNK_TYPE 
-00018390: 2b20 5345 5249 4553 5f47 524f 5550 4259  + SERIES_GROUPBY
-000183a0: 5f43 4855 4e4b 5f54 5950 450a 4341 5445  _CHUNK_TYPE.CATE
-000183b0: 474f 5249 4341 4c5f 5459 5045 203d 2028  GORICAL_TYPE = (
-000183c0: 4361 7465 676f 7269 6361 6c2c 2043 6174  Categorical, Cat
-000183d0: 6567 6f72 6963 616c 4461 7461 290a 4341  egoricalData).CA
-000183e0: 5445 474f 5249 4341 4c5f 4348 554e 4b5f  TEGORICAL_CHUNK_
-000183f0: 5459 5045 203d 2028 4361 7465 676f 7269  TYPE = (Categori
-00018400: 6361 6c43 6875 6e6b 2c20 4361 7465 676f  calChunk, Catego
-00018410: 7269 6361 6c43 6875 6e6b 4461 7461 290a  ricalChunkData).
-00018420: 5449 4c45 4142 4c45 5f54 5950 4520 3d20  TILEABLE_TYPE = 
-00018430: 280a 2020 2020 494e 4445 585f 5459 5045  (.    INDEX_TYPE
-00018440: 202b 2053 4552 4945 535f 5459 5045 202b   + SERIES_TYPE +
-00018450: 2044 4154 4146 5241 4d45 5f54 5950 4520   DATAFRAME_TYPE 
-00018460: 2b20 4752 4f55 5042 595f 5459 5045 202b  + GROUPBY_TYPE +
-00018470: 2043 4154 4547 4f52 4943 414c 5f54 5950   CATEGORICAL_TYP
-00018480: 450a 290a 4348 554e 4b5f 5459 5045 203d  E.).CHUNK_TYPE =
-00018490: 2028 0a20 2020 2049 4e44 4558 5f43 4855   (.    INDEX_CHU
-000184a0: 4e4b 5f54 5950 450a 2020 2020 2b20 5345  NK_TYPE.    + SE
-000184b0: 5249 4553 5f43 4855 4e4b 5f54 5950 450a  RIES_CHUNK_TYPE.
-000184c0: 2020 2020 2b20 4441 5441 4652 414d 455f      + DATAFRAME_
-000184d0: 4348 554e 4b5f 5459 5045 0a20 2020 202b  CHUNK_TYPE.    +
-000184e0: 2047 524f 5550 4259 5f43 4855 4e4b 5f54   GROUPBY_CHUNK_T
-000184f0: 5950 450a 2020 2020 2b20 4341 5445 474f  YPE.    + CATEGO
-00018500: 5249 4341 4c5f 4348 554e 4b5f 5459 5045  RICAL_CHUNK_TYPE
-00018510: 0a29 0a0a 7265 6769 7374 6572 5f6f 7574  .)..register_out
-00018520: 7075 745f 7479 7065 7328 4f75 7470 7574  put_types(Output
-00018530: 5479 7065 2e64 6174 6166 7261 6d65 2c20  Type.dataframe, 
-00018540: 4441 5441 4652 414d 455f 5459 5045 2c20  DATAFRAME_TYPE, 
-00018550: 4441 5441 4652 414d 455f 4348 554e 4b5f  DATAFRAME_CHUNK_
-00018560: 5459 5045 290a 7265 6769 7374 6572 5f6f  TYPE).register_o
-00018570: 7574 7075 745f 7479 7065 7328 4f75 7470  utput_types(Outp
-00018580: 7574 5479 7065 2e73 6572 6965 732c 2053  utType.series, S
-00018590: 4552 4945 535f 5459 5045 2c20 5345 5249  ERIES_TYPE, SERI
-000185a0: 4553 5f43 4855 4e4b 5f54 5950 4529 0a72  ES_CHUNK_TYPE).r
-000185b0: 6567 6973 7465 725f 6f75 7470 7574 5f74  egister_output_t
-000185c0: 7970 6573 280a 2020 2020 4f75 7470 7574  ypes(.    Output
-000185d0: 5479 7065 2e64 665f 6f72 5f73 6572 6965  Type.df_or_serie
-000185e0: 732c 2044 4154 4146 5241 4d45 5f4f 525f  s, DATAFRAME_OR_
-000185f0: 5345 5249 4553 5f54 5950 452c 2044 4154  SERIES_TYPE, DAT
-00018600: 4146 5241 4d45 5f4f 525f 5345 5249 4553  AFRAME_OR_SERIES
-00018610: 5f43 4855 4e4b 5f54 5950 450a 290a 7265  _CHUNK_TYPE.).re
-00018620: 6769 7374 6572 5f6f 7574 7075 745f 7479  gister_output_ty
-00018630: 7065 7328 4f75 7470 7574 5479 7065 2e69  pes(OutputType.i
-00018640: 6e64 6578 2c20 494e 4445 585f 5459 5045  ndex, INDEX_TYPE
-00018650: 2c20 494e 4445 585f 4348 554e 4b5f 5459  , INDEX_CHUNK_TY
-00018660: 5045 290a 7265 6769 7374 6572 5f6f 7574  PE).register_out
-00018670: 7075 745f 7479 7065 7328 4f75 7470 7574  put_types(Output
-00018680: 5479 7065 2e63 6174 6567 6f72 6963 616c  Type.categorical
-00018690: 2c20 4341 5445 474f 5249 4341 4c5f 5459  , CATEGORICAL_TY
-000186a0: 5045 2c20 4341 5445 474f 5249 4341 4c5f  PE, CATEGORICAL_
-000186b0: 4348 554e 4b5f 5459 5045 290a 7265 6769  CHUNK_TYPE).regi
-000186c0: 7374 6572 5f6f 7574 7075 745f 7479 7065  ster_output_type
-000186d0: 7328 0a20 2020 204f 7574 7075 7454 7970  s(.    OutputTyp
-000186e0: 652e 6461 7461 6672 616d 655f 6772 6f75  e.dataframe_grou
-000186f0: 7062 792c 2044 4154 4146 5241 4d45 5f47  pby, DATAFRAME_G
-00018700: 524f 5550 4259 5f54 5950 452c 2044 4154  ROUPBY_TYPE, DAT
-00018710: 4146 5241 4d45 5f47 524f 5550 4259 5f43  AFRAME_GROUPBY_C
-00018720: 4855 4e4b 5f54 5950 450a 290a 7265 6769  HUNK_TYPE.).regi
-00018730: 7374 6572 5f6f 7574 7075 745f 7479 7065  ster_output_type
-00018740: 7328 0a20 2020 204f 7574 7075 7454 7970  s(.    OutputTyp
-00018750: 652e 7365 7269 6573 5f67 726f 7570 6279  e.series_groupby
-00018760: 2c20 5345 5249 4553 5f47 524f 5550 4259  , SERIES_GROUPBY
-00018770: 5f54 5950 452c 2053 4552 4945 535f 4752  _TYPE, SERIES_GR
-00018780: 4f55 5042 595f 4348 554e 4b5f 5459 5045  OUPBY_CHUNK_TYPE
-00018790: 0a29 0a                                  .).
+000005d0: 6162 6c65 2c0a 2020 2020 5365 7269 616c  able,.    Serial
+000005e0: 697a 6162 6c65 4d65 7461 2c0a 2020 2020  izableMeta,.    
+000005f0: 5365 7269 6573 4669 656c 642c 0a20 2020  SeriesField,.   
+00000600: 2053 6c69 6365 4669 656c 642c 0a20 2020   SliceField,.   
+00000610: 2053 7472 696e 6746 6965 6c64 2c0a 2020   StringField,.  
+00000620: 2020 5475 706c 6546 6965 6c64 2c0a 290a    TupleField,.).
+00000630: 6672 6f6d 202e 2e74 656e 736f 7220 696d  from ..tensor im
+00000640: 706f 7274 2073 7461 7469 7374 6963 730a  port statistics.
+00000650: 6672 6f6d 202e 2e75 7469 6c73 2069 6d70  from ..utils imp
+00000660: 6f72 7420 280a 2020 2020 6361 6c63 5f6e  ort (.    calc_n
+00000670: 7370 6c69 7473 2c0a 2020 2020 6365 696c  splits,.    ceil
+00000680: 6469 762c 0a20 2020 2065 7374 696d 6174  div,.    estimat
+00000690: 655f 7061 6e64 6173 5f73 697a 652c 0a20  e_pandas_size,. 
+000006a0: 2020 206c 617a 795f 696d 706f 7274 2c0a     lazy_import,.
+000006b0: 2020 2020 6f6e 5f64 6573 6572 6961 6c69      on_deseriali
+000006c0: 7a65 5f73 6861 7065 2c0a 2020 2020 6f6e  ze_shape,.    on
+000006d0: 5f73 6572 6961 6c69 7a65 5f6e 756d 7079  _serialize_numpy
+000006e0: 5f74 7970 652c 0a20 2020 206f 6e5f 7365  _type,.    on_se
+000006f0: 7269 616c 697a 655f 7368 6170 652c 0a20  rialize_shape,. 
+00000700: 2020 2074 6f6b 656e 697a 652c 0a29 0a66     tokenize,.).f
+00000710: 726f 6d20 2e75 7469 6c73 2069 6d70 6f72  rom .utils impor
+00000720: 7420 280a 2020 2020 5265 7072 5365 7269  t (.    ReprSeri
+00000730: 6573 2c0a 2020 2020 6665 7463 685f 636f  es,.    fetch_co
+00000740: 726e 6572 5f64 6174 612c 0a20 2020 2069  rner_data,.    i
+00000750: 735f 7061 6e64 6173 5f32 2c0a 2020 2020  s_pandas_2,.    
+00000760: 6d65 7267 655f 696e 6465 785f 7661 6c75  merge_index_valu
+00000770: 652c 0a20 2020 2070 6172 7365 5f69 6e64  e,.    parse_ind
+00000780: 6578 2c0a 290a 0a63 7564 6620 3d20 6c61  ex,.)..cudf = la
+00000790: 7a79 5f69 6d70 6f72 7428 2263 7564 6622  zy_import("cudf"
+000007a0: 290a 0a0a 636c 6173 7320 496e 6465 7856  )...class IndexV
+000007b0: 616c 7565 2853 6572 6961 6c69 7a61 626c  alue(Serializabl
+000007c0: 6529 3a0a 2020 2020 2222 220a 2020 2020  e):.    """.    
+000007d0: 4d65 7461 2063 6c61 7373 2066 6f72 2069  Meta class for i
+000007e0: 6e64 6578 2c20 6865 6c64 2062 7920 496e  ndex, held by In
+000007f0: 6465 7844 6174 612c 2053 6572 6965 7344  dexData, SeriesD
+00000800: 6174 6120 616e 6420 4461 7461 4672 616d  ata and DataFram
+00000810: 6544 6174 610a 2020 2020 2222 220a 0a20  eData.    """.. 
+00000820: 2020 205f 5f73 6c6f 7473 5f5f 203d 2028     __slots__ = (
+00000830: 290a 0a20 2020 2063 6c61 7373 2049 6e64  )..    class Ind
+00000840: 6578 4d65 7461 2853 6572 6961 6c69 7a61  exMeta(Serializa
+00000850: 626c 654d 6574 6129 3a0a 2020 2020 2020  bleMeta):.      
+00000860: 2020 636c 6173 736d 6574 686f 640a 0a20    classmethod.. 
+00000870: 2020 2020 2020 2064 6566 205f 5f69 6e73         def __ins
+00000880: 7461 6e63 6563 6865 636b 5f5f 2863 6c73  tancecheck__(cls
+00000890: 2c20 696e 7374 616e 6365 293a 0a20 2020  , instance):.   
+000008a0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+000008b0: 6973 5f70 616e 6461 735f 3228 293a 0a20  is_pandas_2():. 
+000008c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000008d0: 6574 7572 6e20 636c 7320 696e 2069 6e73  eturn cls in ins
+000008e0: 7461 6e63 652e 5f5f 636c 6173 735f 5f2e  tance.__class__.
+000008f0: 5f5f 6d72 6f5f 5f0a 2020 2020 2020 2020  __mro__.        
+00000900: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00000910: 2020 2020 2020 2020 2020 6966 2063 6c73            if cls
+00000920: 2069 7320 496e 6465 7856 616c 7565 2e49   is IndexValue.I
+00000930: 6e74 3634 496e 6465 783a 0a20 2020 2020  nt64Index:.     
+00000940: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00000950: 6574 7572 6e20 7479 7065 280a 2020 2020  eturn type(.    
+00000960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000970: 2020 2020 696e 7374 616e 6365 0a20 2020      instance.   
+00000980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000990: 2029 203d 3d20 496e 6465 7856 616c 7565   ) == IndexValue
+000009a0: 2e49 6e64 6578 2061 6e64 2069 6e73 7461  .Index and insta
+000009b0: 6e63 652e 5f64 7479 7065 203d 3d20 6e70  nce._dtype == np
+000009c0: 2e64 7479 7065 2822 696e 7436 3422 290a  .dtype("int64").
+000009d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000009e0: 656c 6966 2063 6c73 2069 7320 496e 6465  elif cls is Inde
+000009f0: 7856 616c 7565 2e46 6c6f 6174 3634 496e  xValue.Float64In
+00000a00: 6465 783a 0a20 2020 2020 2020 2020 2020  dex:.           
+00000a10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00000a20: 7479 7065 280a 2020 2020 2020 2020 2020  type(.          
+00000a30: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00000a40: 7374 616e 6365 0a20 2020 2020 2020 2020  stance.         
+00000a50: 2020 2020 2020 2020 2020 2029 203d 3d20             ) == 
+00000a60: 496e 6465 7856 616c 7565 2e49 6e64 6578  IndexValue.Index
+00000a70: 2061 6e64 2069 6e73 7461 6e63 652e 5f64   and instance._d
+00000a80: 7479 7065 203d 3d20 6e70 2e64 7479 7065  type == np.dtype
+00000a90: 2822 666c 6f61 7436 3422 290a 2020 2020  ("float64").    
+00000aa0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00000ab0: 2063 6c73 2069 7320 496e 6465 7856 616c   cls is IndexVal
+00000ac0: 7565 2e55 496e 7436 3449 6e64 6578 3a0a  ue.UInt64Index:.
+00000ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ae0: 2020 2020 7265 7475 726e 2074 7970 6528      return type(
+00000af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000b00: 2020 2020 2020 2020 2069 6e73 7461 6e63           instanc
+00000b10: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00000b20: 2020 2020 2020 2920 3d3d 2049 6e64 6578        ) == Index
+00000b30: 5661 6c75 652e 496e 6465 7820 616e 6420  Value.Index and 
+00000b40: 696e 7374 616e 6365 2e5f 6474 7970 6520  instance._dtype 
+00000b50: 3d3d 206e 702e 6474 7970 6528 2275 696e  == np.dtype("uin
+00000b60: 6974 3634 2229 0a20 2020 2020 2020 2020  it64").         
+00000b70: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00000b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000b90: 2072 6574 7572 6e20 636c 7320 696e 2069   return cls in i
+00000ba0: 6e73 7461 6e63 652e 5f5f 636c 6173 735f  nstance.__class_
+00000bb0: 5f2e 5f5f 6d72 6f5f 5f0a 0a20 2020 2063  _.__mro__..    c
+00000bc0: 6c61 7373 2049 6e64 6578 4261 7365 2853  lass IndexBase(S
+00000bd0: 6572 6961 6c69 7a61 626c 652c 206d 6574  erializable, met
+00000be0: 6163 6c61 7373 3d49 6e64 6578 4d65 7461  aclass=IndexMeta
+00000bf0: 293a 0a20 2020 2020 2020 205f 6b65 7920  ):.        _key 
+00000c00: 3d20 5374 7269 6e67 4669 656c 6428 226b  = StringField("k
+00000c10: 6579 2229 2020 2320 746f 2069 6465 6e74  ey")  # to ident
+00000c20: 6966 7920 6966 2074 6865 2069 6e64 6578  ify if the index
+00000c30: 2069 7320 7468 6520 7361 6d65 0a20 2020   is the same.   
+00000c40: 2020 2020 205f 6973 5f6d 6f6e 6f74 6f6e       _is_monoton
+00000c50: 6963 5f69 6e63 7265 6173 696e 6720 3d20  ic_increasing = 
+00000c60: 426f 6f6c 4669 656c 6428 2269 735f 6d6f  BoolField("is_mo
+00000c70: 6e6f 746f 6e69 635f 696e 6372 6561 7369  notonic_increasi
+00000c80: 6e67 2229 0a20 2020 2020 2020 205f 6973  ng").        _is
+00000c90: 5f6d 6f6e 6f74 6f6e 6963 5f64 6563 7265  _monotonic_decre
+00000ca0: 6173 696e 6720 3d20 426f 6f6c 4669 656c  asing = BoolFiel
+00000cb0: 6428 2269 735f 6d6f 6e6f 746f 6e69 635f  d("is_monotonic_
+00000cc0: 6465 6372 6561 7369 6e67 2229 0a20 2020  decreasing").   
+00000cd0: 2020 2020 205f 6973 5f75 6e69 7175 6520       _is_unique 
+00000ce0: 3d20 426f 6f6c 4669 656c 6428 2269 735f  = BoolField("is_
+00000cf0: 756e 6971 7565 2229 0a20 2020 2020 2020  unique").       
+00000d00: 205f 6d61 785f 7661 6c20 3d20 416e 7946   _max_val = AnyF
+00000d10: 6965 6c64 2822 6d61 785f 7661 6c22 2c20  ield("max_val", 
+00000d20: 6f6e 5f73 6572 6961 6c69 7a65 3d6f 6e5f  on_serialize=on_
+00000d30: 7365 7269 616c 697a 655f 6e75 6d70 795f  serialize_numpy_
+00000d40: 7479 7065 290a 2020 2020 2020 2020 5f6d  type).        _m
+00000d50: 6178 5f76 616c 5f63 6c6f 7365 203d 2042  ax_val_close = B
+00000d60: 6f6f 6c46 6965 6c64 2822 6d61 785f 7661  oolField("max_va
+00000d70: 6c5f 636c 6f73 6522 290a 2020 2020 2020  l_close").      
+00000d80: 2020 5f6d 696e 5f76 616c 203d 2041 6e79    _min_val = Any
+00000d90: 4669 656c 6428 226d 696e 5f76 616c 222c  Field("min_val",
+00000da0: 206f 6e5f 7365 7269 616c 697a 653d 6f6e   on_serialize=on
+00000db0: 5f73 6572 6961 6c69 7a65 5f6e 756d 7079  _serialize_numpy
+00000dc0: 5f74 7970 6529 0a20 2020 2020 2020 205f  _type).        _
+00000dd0: 6d69 6e5f 7661 6c5f 636c 6f73 6520 3d20  min_val_close = 
+00000de0: 426f 6f6c 4669 656c 6428 226d 696e 5f76  BoolField("min_v
+00000df0: 616c 5f63 6c6f 7365 2229 0a0a 2020 2020  al_close")..    
+00000e00: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00000e10: 2020 2020 2020 6465 6620 6973 5f6d 6f6e        def is_mon
+00000e20: 6f74 6f6e 6963 5f69 6e63 7265 6173 696e  otonic_increasin
+00000e30: 6728 7365 6c66 293a 0a20 2020 2020 2020  g(self):.       
+00000e40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00000e50: 2e5f 6973 5f6d 6f6e 6f74 6f6e 6963 5f69  ._is_monotonic_i
+00000e60: 6e63 7265 6173 696e 670a 0a20 2020 2020  ncreasing..     
+00000e70: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00000e80: 2020 2020 2064 6566 2069 735f 6d6f 6e6f       def is_mono
+00000e90: 746f 6e69 635f 6465 6372 6561 7369 6e67  tonic_decreasing
+00000ea0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00000eb0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00000ec0: 5f69 735f 6d6f 6e6f 746f 6e69 635f 6465  _is_monotonic_de
+00000ed0: 6372 6561 7369 6e67 0a0a 2020 2020 2020  creasing..      
+00000ee0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00000ef0: 2020 2020 6465 6620 6973 5f75 6e69 7175      def is_uniqu
+00000f00: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+00000f10: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00000f20: 2e5f 6973 5f75 6e69 7175 650a 0a20 2020  ._is_unique..   
+00000f30: 2020 2020 2040 7072 6f70 6572 7479 0a20       @property. 
+00000f40: 2020 2020 2020 2064 6566 206d 696e 5f76         def min_v
+00000f50: 616c 2873 656c 6629 3a0a 2020 2020 2020  al(self):.      
+00000f60: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00000f70: 662e 5f6d 696e 5f76 616c 0a0a 2020 2020  f._min_val..    
+00000f80: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00000f90: 2020 2020 2020 6465 6620 6d69 6e5f 7661        def min_va
+00000fa0: 6c5f 636c 6f73 6528 7365 6c66 293a 0a20  l_close(self):. 
+00000fb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00000fc0: 6e20 7365 6c66 2e5f 6d69 6e5f 7661 6c5f  n self._min_val_
+00000fd0: 636c 6f73 650a 0a20 2020 2020 2020 2040  close..        @
+00000fe0: 7072 6f70 6572 7479 0a20 2020 2020 2020  property.       
+00000ff0: 2064 6566 206d 6178 5f76 616c 2873 656c   def max_val(sel
+00001000: 6629 3a0a 2020 2020 2020 2020 2020 2020  f):.            
+00001010: 7265 7475 726e 2073 656c 662e 5f6d 6178  return self._max
+00001020: 5f76 616c 0a0a 2020 2020 2020 2020 4070  _val..        @p
+00001030: 726f 7065 7274 790a 2020 2020 2020 2020  roperty.        
+00001040: 6465 6620 6d61 785f 7661 6c5f 636c 6f73  def max_val_clos
+00001050: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+00001060: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00001070: 2e5f 6d61 785f 7661 6c5f 636c 6f73 650a  ._max_val_close.
+00001080: 0a20 2020 2020 2020 2040 7072 6f70 6572  .        @proper
+00001090: 7479 0a20 2020 2020 2020 2064 6566 206b  ty.        def k
+000010a0: 6579 2873 656c 6629 3a0a 2020 2020 2020  ey(self):.      
+000010b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000010c0: 662e 5f6b 6579 0a0a 2020 2020 2020 2020  f._key..        
+000010d0: 4070 726f 7065 7274 790a 2020 2020 2020  @property.      
+000010e0: 2020 6465 6620 696e 6665 7272 6564 5f74    def inferred_t
+000010f0: 7970 6528 7365 6c66 293a 0a20 2020 2020  ype(self):.     
+00001100: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+00001110: 6e65 0a0a 2020 2020 2020 2020 6465 6620  ne..        def 
+00001120: 746f 5f70 616e 6461 7328 7365 6c66 293a  to_pandas(self):
+00001130: 0a20 2020 2020 2020 2020 2020 206b 7720  .            kw 
+00001140: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00001150: 2020 2020 6669 656c 642e 7461 673a 2067      field.tag: g
+00001160: 6574 6174 7472 2873 656c 662c 2061 7474  etattr(self, att
+00001170: 722c 204e 6f6e 6529 0a20 2020 2020 2020  r, None).       
+00001180: 2020 2020 2020 2020 2066 6f72 2061 7474           for att
+00001190: 722c 2066 6965 6c64 2069 6e20 7365 6c66  r, field in self
+000011a0: 2e5f 4649 454c 4453 2e69 7465 6d73 2829  ._FIELDS.items()
+000011b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000011c0: 2069 6620 6174 7472 206e 6f74 2069 6e20   if attr not in 
+000011d0: 7375 7065 7228 7479 7065 2873 656c 6629  super(type(self)
+000011e0: 2c20 7365 6c66 292e 5f46 4945 4c44 530a  , self)._FIELDS.
+000011f0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+00001200: 2020 2020 2020 2020 2020 6b77 203d 207b            kw = {
+00001210: 6b3a 2076 2066 6f72 206b 2c20 7620 696e  k: v for k, v in
+00001220: 206b 772e 6974 656d 7328 2920 6966 2076   kw.items() if v
+00001230: 2069 7320 6e6f 7420 4e6f 6e65 7d0a 2020   is not None}.  
+00001240: 2020 2020 2020 2020 2020 6966 206b 772e            if kw.
+00001250: 6765 7428 2264 6174 6122 2920 6973 204e  get("data") is N
+00001260: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00001270: 2020 2020 206b 775b 2264 6174 6122 5d20       kw["data"] 
+00001280: 3d20 5b5d 0a0a 2020 2020 2020 2020 2020  = []..          
+00001290: 2020 7064 5f69 6e69 7469 616c 697a 6572    pd_initializer
+000012a0: 203d 2067 6574 6174 7472 2873 656c 662c   = getattr(self,
+000012b0: 2022 5f70 645f 696e 6974 6961 6c69 7a65   "_pd_initialize
+000012c0: 7222 2c20 4e6f 6e65 290a 2020 2020 2020  r", None).      
+000012d0: 2020 2020 2020 6966 2070 645f 696e 6974        if pd_init
+000012e0: 6961 6c69 7a65 7220 6973 204e 6f6e 653a  ializer is None:
+000012f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001300: 2070 645f 696e 6974 6961 6c69 7a65 7220   pd_initializer 
+00001310: 3d20 6765 7461 7474 7228 7064 2c20 7479  = getattr(pd, ty
+00001320: 7065 2873 656c 6629 2e5f 5f6e 616d 655f  pe(self).__name_
+00001330: 5f29 0a20 2020 2020 2020 2020 2020 2072  _).            r
+00001340: 6574 7572 6e20 7064 5f69 6e69 7469 616c  eturn pd_initial
+00001350: 697a 6572 282a 2a6b 7729 0a0a 2020 2020  izer(**kw)..    
+00001360: 636c 6173 7320 496e 6465 7828 496e 6465  class Index(Inde
+00001370: 7842 6173 6529 3a0a 2020 2020 2020 2020  xBase):.        
+00001380: 5f6e 616d 6520 3d20 416e 7946 6965 6c64  _name = AnyField
+00001390: 2822 6e61 6d65 2229 0a20 2020 2020 2020  ("name").       
+000013a0: 205f 6461 7461 203d 204e 4441 7272 6179   _data = NDArray
+000013b0: 4669 656c 6428 2264 6174 6122 290a 2020  Field("data").  
+000013c0: 2020 2020 2020 5f64 7479 7065 203d 2044        _dtype = D
+000013d0: 6174 6154 7970 6546 6965 6c64 2822 6474  ataTypeField("dt
+000013e0: 7970 6522 290a 0a20 2020 2063 6c61 7373  ype")..    class
+000013f0: 2052 616e 6765 496e 6465 7828 496e 6465   RangeIndex(Inde
+00001400: 7842 6173 6529 3a0a 2020 2020 2020 2020  xBase):.        
+00001410: 5f6e 616d 6520 3d20 416e 7946 6965 6c64  _name = AnyField
+00001420: 2822 6e61 6d65 2229 0a20 2020 2020 2020  ("name").       
+00001430: 205f 736c 6963 6520 3d20 536c 6963 6546   _slice = SliceF
+00001440: 6965 6c64 2822 736c 6963 6522 290a 2020  ield("slice").  
+00001450: 2020 2020 2020 5f64 7479 7065 203d 2044        _dtype = D
+00001460: 6174 6154 7970 6546 6965 6c64 2822 6474  ataTypeField("dt
+00001470: 7970 6522 290a 0a20 2020 2020 2020 2040  ype")..        @
+00001480: 7072 6f70 6572 7479 0a20 2020 2020 2020  property.       
+00001490: 2064 6566 2073 6c69 6365 2873 656c 6629   def slice(self)
+000014a0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000014b0: 7475 726e 2073 656c 662e 5f73 6c69 6365  turn self._slice
+000014c0: 0a0a 2020 2020 2020 2020 4070 726f 7065  ..        @prope
+000014d0: 7274 790a 2020 2020 2020 2020 6465 6620  rty.        def 
+000014e0: 6474 7970 6528 7365 6c66 293a 0a20 2020  dtype(self):.   
+000014f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00001500: 6765 7461 7474 7228 7365 6c66 2c20 225f  getattr(self, "_
+00001510: 6474 7970 6522 2c20 6e70 2e64 7479 7065  dtype", np.dtype
+00001520: 286e 702e 696e 7463 2929 0a0a 2020 2020  (np.intc))..    
+00001530: 2020 2020 6465 6620 746f 5f70 616e 6461      def to_panda
+00001540: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+00001550: 2020 2020 2073 6c63 203d 2073 656c 662e       slc = self.
+00001560: 5f73 6c69 6365 0a20 2020 2020 2020 2020  _slice.         
+00001570: 2020 2072 6574 7572 6e20 7064 2e52 616e     return pd.Ran
+00001580: 6765 496e 6465 7828 0a20 2020 2020 2020  geIndex(.       
+00001590: 2020 2020 2020 2020 2073 6c63 2e73 7461           slc.sta
+000015a0: 7274 2c20 736c 632e 7374 6f70 2c20 736c  rt, slc.stop, sl
+000015b0: 632e 7374 6570 2c20 6e61 6d65 3d67 6574  c.step, name=get
+000015c0: 6174 7472 2873 656c 662c 2022 5f6e 616d  attr(self, "_nam
+000015d0: 6522 2c20 4e6f 6e65 290a 2020 2020 2020  e", None).      
+000015e0: 2020 2020 2020 290a 0a20 2020 2063 6c61        )..    cla
+000015f0: 7373 2043 6174 6567 6f72 6963 616c 496e  ss CategoricalIn
+00001600: 6465 7828 496e 6465 7842 6173 6529 3a0a  dex(IndexBase):.
+00001610: 2020 2020 2020 2020 5f6e 616d 6520 3d20          _name = 
+00001620: 416e 7946 6965 6c64 2822 6e61 6d65 2229  AnyField("name")
+00001630: 0a20 2020 2020 2020 205f 6461 7461 203d  .        _data =
+00001640: 204e 4441 7272 6179 4669 656c 6428 2264   NDArrayField("d
+00001650: 6174 6122 290a 2020 2020 2020 2020 5f63  ata").        _c
+00001660: 6174 6567 6f72 6965 7320 3d20 416e 7946  ategories = AnyF
+00001670: 6965 6c64 2822 6361 7465 676f 7269 6573  ield("categories
+00001680: 2229 0a20 2020 2020 2020 205f 6f72 6465  ").        _orde
+00001690: 7265 6420 3d20 426f 6f6c 4669 656c 6428  red = BoolField(
+000016a0: 226f 7264 6572 6564 2229 0a0a 2020 2020  "ordered")..    
+000016b0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+000016c0: 2020 2020 2020 6465 6620 696e 6665 7272        def inferr
+000016d0: 6564 5f74 7970 6528 7365 6c66 293a 0a20  ed_type(self):. 
+000016e0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000016f0: 6e20 2263 6174 6567 6f72 6963 616c 220a  n "categorical".
+00001700: 0a20 2020 2063 6c61 7373 2049 6e74 6572  .    class Inter
+00001710: 7661 6c49 6e64 6578 2849 6e64 6578 4261  valIndex(IndexBa
+00001720: 7365 293a 0a20 2020 2020 2020 205f 6e61  se):.        _na
+00001730: 6d65 203d 2041 6e79 4669 656c 6428 226e  me = AnyField("n
+00001740: 616d 6522 290a 2020 2020 2020 2020 5f64  ame").        _d
+00001750: 6174 6120 3d20 496e 7465 7276 616c 4172  ata = IntervalAr
+00001760: 7261 7946 6965 6c64 2822 6461 7461 2229  rayField("data")
+00001770: 0a20 2020 2020 2020 205f 636c 6f73 6564  .        _closed
+00001780: 203d 2053 7472 696e 6746 6965 6c64 2822   = StringField("
+00001790: 636c 6f73 6564 2229 0a0a 2020 2020 2020  closed")..      
+000017a0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+000017b0: 2020 2020 6465 6620 696e 6665 7272 6564      def inferred
+000017c0: 5f74 7970 6528 7365 6c66 293a 0a20 2020  _type(self):.   
+000017d0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000017e0: 2269 6e74 6572 7661 6c22 0a0a 2020 2020  "interval"..    
+000017f0: 636c 6173 7320 4461 7465 7469 6d65 496e  class DatetimeIn
+00001800: 6465 7828 496e 6465 7842 6173 6529 3a0a  dex(IndexBase):.
+00001810: 2020 2020 2020 2020 5f6e 616d 6520 3d20          _name = 
+00001820: 416e 7946 6965 6c64 2822 6e61 6d65 2229  AnyField("name")
+00001830: 0a20 2020 2020 2020 205f 6461 7461 203d  .        _data =
+00001840: 204e 4441 7272 6179 4669 656c 6428 2264   NDArrayField("d
+00001850: 6174 6122 290a 2020 2020 2020 2020 5f66  ata").        _f
+00001860: 7265 7120 3d20 416e 7946 6965 6c64 2822  req = AnyField("
+00001870: 6672 6571 2229 0a20 2020 2020 2020 205f  freq").        _
+00001880: 7374 6172 7420 3d20 416e 7946 6965 6c64  start = AnyField
+00001890: 2822 7374 6172 7422 290a 2020 2020 2020  ("start").      
+000018a0: 2020 5f70 6572 696f 6473 203d 2041 6e79    _periods = Any
+000018b0: 4669 656c 6428 2270 6572 696f 6473 2229  Field("periods")
+000018c0: 0a20 2020 2020 2020 205f 656e 6420 3d20  .        _end = 
+000018d0: 416e 7946 6965 6c64 2822 656e 6422 290a  AnyField("end").
+000018e0: 2020 2020 2020 2020 5f63 6c6f 7365 6420          _closed 
+000018f0: 3d20 416e 7946 6965 6c64 2822 636c 6f73  = AnyField("clos
+00001900: 6564 2229 0a20 2020 2020 2020 205f 747a  ed").        _tz
+00001910: 203d 2041 6e79 4669 656c 6428 2274 7a22   = AnyField("tz"
+00001920: 290a 2020 2020 2020 2020 5f61 6d62 6967  ).        _ambig
+00001930: 756f 7573 203d 2041 6e79 4669 656c 6428  uous = AnyField(
+00001940: 2261 6d62 6967 756f 7573 2229 0a20 2020  "ambiguous").   
+00001950: 2020 2020 205f 6461 7966 6972 7374 203d       _dayfirst =
+00001960: 2042 6f6f 6c46 6965 6c64 2822 6461 7966   BoolField("dayf
+00001970: 6972 7374 2229 0a20 2020 2020 2020 205f  irst").        _
+00001980: 7965 6172 6669 7273 7420 3d20 426f 6f6c  yearfirst = Bool
+00001990: 4669 656c 6428 2279 6561 7266 6972 7374  Field("yearfirst
+000019a0: 2229 0a0a 2020 2020 2020 2020 4070 726f  ")..        @pro
+000019b0: 7065 7274 790a 2020 2020 2020 2020 6465  perty.        de
+000019c0: 6620 696e 6665 7272 6564 5f74 7970 6528  f inferred_type(
+000019d0: 7365 6c66 293a 0a20 2020 2020 2020 2020  self):.         
+000019e0: 2020 2072 6574 7572 6e20 2264 6174 6574     return "datet
+000019f0: 696d 6536 3422 0a0a 2020 2020 2020 2020  ime64"..        
+00001a00: 4070 726f 7065 7274 790a 2020 2020 2020  @property.      
+00001a10: 2020 6465 6620 6672 6571 2873 656c 6629    def freq(self)
+00001a20: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00001a30: 7475 726e 2067 6574 6174 7472 2873 656c  turn getattr(sel
+00001a40: 662c 2022 5f66 7265 7122 2c20 4e6f 6e65  f, "_freq", None
+00001a50: 290a 0a20 2020 2063 6c61 7373 2054 696d  )..    class Tim
+00001a60: 6564 656c 7461 496e 6465 7828 496e 6465  edeltaIndex(Inde
+00001a70: 7842 6173 6529 3a0a 2020 2020 2020 2020  xBase):.        
+00001a80: 5f6e 616d 6520 3d20 416e 7946 6965 6c64  _name = AnyField
+00001a90: 2822 6e61 6d65 2229 0a20 2020 2020 2020  ("name").       
+00001aa0: 205f 6461 7461 203d 204e 4441 7272 6179   _data = NDArray
+00001ab0: 4669 656c 6428 2264 6174 6122 290a 2020  Field("data").  
+00001ac0: 2020 2020 2020 5f75 6e69 7420 3d20 416e        _unit = An
+00001ad0: 7946 6965 6c64 2822 756e 6974 2229 0a20  yField("unit"). 
+00001ae0: 2020 2020 2020 205f 6672 6571 203d 2041         _freq = A
+00001af0: 6e79 4669 656c 6428 2266 7265 7122 290a  nyField("freq").
+00001b00: 2020 2020 2020 2020 5f73 7461 7274 203d          _start =
+00001b10: 2041 6e79 4669 656c 6428 2273 7461 7274   AnyField("start
+00001b20: 2229 0a20 2020 2020 2020 205f 7065 7269  ").        _peri
+00001b30: 6f64 7320 3d20 416e 7946 6965 6c64 2822  ods = AnyField("
+00001b40: 7065 7269 6f64 7322 290a 2020 2020 2020  periods").      
+00001b50: 2020 5f65 6e64 203d 2041 6e79 4669 656c    _end = AnyFiel
+00001b60: 6428 2265 6e64 2229 0a20 2020 2020 2020  d("end").       
+00001b70: 205f 636c 6f73 6564 203d 2041 6e79 4669   _closed = AnyFi
+00001b80: 656c 6428 2263 6c6f 7365 6422 290a 0a20  eld("closed").. 
+00001b90: 2020 2020 2020 2040 7072 6f70 6572 7479         @property
+00001ba0: 0a20 2020 2020 2020 2064 6566 2069 6e66  .        def inf
+00001bb0: 6572 7265 645f 7479 7065 2873 656c 6629  erred_type(self)
+00001bc0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00001bd0: 7475 726e 2022 7469 6d65 6465 6c74 6136  turn "timedelta6
+00001be0: 3422 0a0a 2020 2020 636c 6173 7320 5065  4"..    class Pe
+00001bf0: 7269 6f64 496e 6465 7828 496e 6465 7842  riodIndex(IndexB
+00001c00: 6173 6529 3a0a 2020 2020 2020 2020 5f6e  ase):.        _n
+00001c10: 616d 6520 3d20 416e 7946 6965 6c64 2822  ame = AnyField("
+00001c20: 6e61 6d65 2229 0a20 2020 2020 2020 205f  name").        _
+00001c30: 6461 7461 203d 204e 4441 7272 6179 4669  data = NDArrayFi
+00001c40: 656c 6428 2264 6174 6122 290a 2020 2020  eld("data").    
+00001c50: 2020 2020 5f66 7265 7120 3d20 416e 7946      _freq = AnyF
+00001c60: 6965 6c64 2822 6672 6571 2229 0a20 2020  ield("freq").   
+00001c70: 2020 2020 205f 7374 6172 7420 3d20 416e       _start = An
+00001c80: 7946 6965 6c64 2822 7374 6172 7422 290a  yField("start").
+00001c90: 2020 2020 2020 2020 5f70 6572 696f 6473          _periods
+00001ca0: 203d 2041 6e79 4669 656c 6428 2270 6572   = AnyField("per
+00001cb0: 696f 6473 2229 0a20 2020 2020 2020 205f  iods").        _
+00001cc0: 656e 6420 3d20 416e 7946 6965 6c64 2822  end = AnyField("
+00001cd0: 656e 6422 290a 2020 2020 2020 2020 5f79  end").        _y
+00001ce0: 6561 7220 3d20 416e 7946 6965 6c64 2822  ear = AnyField("
+00001cf0: 7965 6172 2229 0a20 2020 2020 2020 205f  year").        _
+00001d00: 6d6f 6e74 6820 3d20 416e 7946 6965 6c64  month = AnyField
+00001d10: 2822 6d6f 6e74 6822 290a 2020 2020 2020  ("month").      
+00001d20: 2020 5f71 7561 7274 6572 203d 2041 6e79    _quarter = Any
+00001d30: 4669 656c 6428 2271 7561 7274 6572 2229  Field("quarter")
+00001d40: 0a20 2020 2020 2020 205f 6461 7920 3d20  .        _day = 
+00001d50: 416e 7946 6965 6c64 2822 6461 7922 290a  AnyField("day").
+00001d60: 2020 2020 2020 2020 5f68 6f75 7220 3d20          _hour = 
+00001d70: 416e 7946 6965 6c64 2822 686f 7572 2229  AnyField("hour")
+00001d80: 0a20 2020 2020 2020 205f 6d69 6e75 7465  .        _minute
+00001d90: 203d 2041 6e79 4669 656c 6428 226d 696e   = AnyField("min
+00001da0: 7574 6522 290a 2020 2020 2020 2020 5f73  ute").        _s
+00001db0: 6563 6f6e 6420 3d20 416e 7946 6965 6c64  econd = AnyField
+00001dc0: 2822 7365 636f 6e64 2229 0a20 2020 2020  ("second").     
+00001dd0: 2020 205f 747a 203d 2041 6e79 4669 656c     _tz = AnyFiel
+00001de0: 6428 2274 7a22 290a 2020 2020 2020 2020  d("tz").        
+00001df0: 5f64 7479 7065 203d 2044 6174 6154 7970  _dtype = DataTyp
+00001e00: 6546 6965 6c64 2822 6474 7970 6522 290a  eField("dtype").
+00001e10: 0a20 2020 2020 2020 2040 7072 6f70 6572  .        @proper
+00001e20: 7479 0a20 2020 2020 2020 2064 6566 2069  ty.        def i
+00001e30: 6e66 6572 7265 645f 7479 7065 2873 656c  nferred_type(sel
+00001e40: 6629 3a0a 2020 2020 2020 2020 2020 2020  f):.            
+00001e50: 7265 7475 726e 2022 7065 7269 6f64 220a  return "period".
+00001e60: 0a20 2020 2063 6c61 7373 2049 6e74 3634  .    class Int64
+00001e70: 496e 6465 7828 496e 6465 7842 6173 6529  Index(IndexBase)
+00001e80: 3a0a 2020 2020 2020 2020 5f70 645f 696e  :.        _pd_in
+00001e90: 6974 6961 6c69 7a65 7220 3d20 7064 2e49  itializer = pd.I
+00001ea0: 6e64 6578 0a0a 2020 2020 2020 2020 5f6e  ndex..        _n
+00001eb0: 616d 6520 3d20 416e 7946 6965 6c64 2822  ame = AnyField("
+00001ec0: 6e61 6d65 2229 0a20 2020 2020 2020 205f  name").        _
+00001ed0: 6461 7461 203d 204e 4441 7272 6179 4669  data = NDArrayFi
+00001ee0: 656c 6428 2264 6174 6122 290a 2020 2020  eld("data").    
+00001ef0: 2020 2020 5f64 7479 7065 203d 2044 6174      _dtype = Dat
+00001f00: 6154 7970 6546 6965 6c64 2822 6474 7970  aTypeField("dtyp
+00001f10: 6522 290a 0a20 2020 2020 2020 2040 7072  e")..        @pr
+00001f20: 6f70 6572 7479 0a20 2020 2020 2020 2064  operty.        d
+00001f30: 6566 2069 6e66 6572 7265 645f 7479 7065  ef inferred_type
+00001f40: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00001f50: 2020 2020 7265 7475 726e 2022 696e 7465      return "inte
+00001f60: 6765 7222 0a0a 2020 2020 636c 6173 7320  ger"..    class 
+00001f70: 5549 6e74 3634 496e 6465 7828 496e 6465  UInt64Index(Inde
+00001f80: 7842 6173 6529 3a0a 2020 2020 2020 2020  xBase):.        
+00001f90: 5f70 645f 696e 6974 6961 6c69 7a65 7220  _pd_initializer 
+00001fa0: 3d20 7064 2e49 6e64 6578 0a0a 2020 2020  = pd.Index..    
+00001fb0: 2020 2020 5f6e 616d 6520 3d20 416e 7946      _name = AnyF
+00001fc0: 6965 6c64 2822 6e61 6d65 2229 0a20 2020  ield("name").   
+00001fd0: 2020 2020 205f 6461 7461 203d 204e 4441       _data = NDA
+00001fe0: 7272 6179 4669 656c 6428 2264 6174 6122  rrayField("data"
+00001ff0: 290a 2020 2020 2020 2020 5f64 7479 7065  ).        _dtype
+00002000: 203d 2044 6174 6154 7970 6546 6965 6c64   = DataTypeField
+00002010: 2822 6474 7970 6522 290a 0a20 2020 2020  ("dtype")..     
+00002020: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00002030: 2020 2020 2064 6566 2069 6e66 6572 7265       def inferre
+00002040: 645f 7479 7065 2873 656c 6629 3a0a 2020  d_type(self):.  
+00002050: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00002060: 2022 696e 7465 6765 7222 0a0a 2020 2020   "integer"..    
+00002070: 636c 6173 7320 466c 6f61 7436 3449 6e64  class Float64Ind
+00002080: 6578 2849 6e64 6578 4261 7365 293a 0a20  ex(IndexBase):. 
+00002090: 2020 2020 2020 205f 7064 5f69 6e69 7469         _pd_initi
+000020a0: 616c 697a 6572 203d 2070 642e 496e 6465  alizer = pd.Inde
+000020b0: 780a 0a20 2020 2020 2020 205f 6e61 6d65  x..        _name
+000020c0: 203d 2041 6e79 4669 656c 6428 226e 616d   = AnyField("nam
+000020d0: 6522 290a 2020 2020 2020 2020 5f64 6174  e").        _dat
+000020e0: 6120 3d20 4e44 4172 7261 7946 6965 6c64  a = NDArrayField
+000020f0: 2822 6461 7461 2229 0a20 2020 2020 2020  ("data").       
+00002100: 205f 6474 7970 6520 3d20 4461 7461 5479   _dtype = DataTy
+00002110: 7065 4669 656c 6428 2264 7479 7065 2229  peField("dtype")
+00002120: 0a0a 2020 2020 2020 2020 4070 726f 7065  ..        @prope
+00002130: 7274 790a 2020 2020 2020 2020 6465 6620  rty.        def 
+00002140: 696e 6665 7272 6564 5f74 7970 6528 7365  inferred_type(se
+00002150: 6c66 293a 0a20 2020 2020 2020 2020 2020  lf):.           
+00002160: 2072 6574 7572 6e20 2266 6c6f 6174 696e   return "floatin
+00002170: 6722 0a0a 2020 2020 636c 6173 7320 4d75  g"..    class Mu
+00002180: 6c74 6949 6e64 6578 2849 6e64 6578 4261  ltiIndex(IndexBa
+00002190: 7365 293a 0a20 2020 2020 2020 205f 6e61  se):.        _na
+000021a0: 6d65 7320 3d20 4c69 7374 4669 656c 6428  mes = ListField(
+000021b0: 226e 616d 6573 222c 206f 6e5f 7365 7269  "names", on_seri
+000021c0: 616c 697a 653d 6c69 7374 290a 2020 2020  alize=list).    
+000021d0: 2020 2020 5f64 7479 7065 7320 3d20 4c69      _dtypes = Li
+000021e0: 7374 4669 656c 6428 2264 7479 7065 7322  stField("dtypes"
+000021f0: 2c20 6f6e 5f73 6572 6961 6c69 7a65 3d6c  , on_serialize=l
+00002200: 6973 7429 0a20 2020 2020 2020 205f 6461  ist).        _da
+00002210: 7461 203d 204e 4441 7272 6179 4669 656c  ta = NDArrayFiel
+00002220: 6428 2264 6174 6122 290a 2020 2020 2020  d("data").      
+00002230: 2020 5f73 6f72 746f 7264 6572 203d 2049    _sortorder = I
+00002240: 6e74 3332 4669 656c 6428 2273 6f72 746f  nt32Field("sorto
+00002250: 7264 6572 2229 0a0a 2020 2020 2020 2020  rder")..        
+00002260: 4070 726f 7065 7274 790a 2020 2020 2020  @property.      
+00002270: 2020 6465 6620 696e 6665 7272 6564 5f74    def inferred_t
+00002280: 7970 6528 7365 6c66 293a 0a20 2020 2020  ype(self):.     
+00002290: 2020 2020 2020 2072 6574 7572 6e20 226d         return "m
+000022a0: 6978 6564 220a 0a20 2020 2020 2020 2040  ixed"..        @
+000022b0: 7072 6f70 6572 7479 0a20 2020 2020 2020  property.       
+000022c0: 2064 6566 206e 616d 6573 2873 656c 6629   def names(self)
+000022d0: 202d 3e20 6c69 7374 3a0a 2020 2020 2020   -> list:.      
+000022e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000022f0: 662e 5f6e 616d 6573 0a0a 2020 2020 2020  f._names..      
+00002300: 2020 6465 6620 746f 5f70 616e 6461 7328    def to_pandas(
+00002310: 7365 6c66 293a 0a20 2020 2020 2020 2020  self):.         
+00002320: 2020 2064 6174 6120 3d20 6765 7461 7474     data = getatt
+00002330: 7228 7365 6c66 2c20 225f 6461 7461 222c  r(self, "_data",
+00002340: 204e 6f6e 6529 0a20 2020 2020 2020 2020   None).         
+00002350: 2020 2073 6f72 746f 7264 6572 203d 2067     sortorder = g
+00002360: 6574 6174 7472 2873 656c 662c 2022 5f73  etattr(self, "_s
+00002370: 6f72 746f 7264 6572 222c 204e 6f6e 6529  ortorder", None)
+00002380: 0a0a 2020 2020 2020 2020 2020 2020 6465  ..            de
+00002390: 6620 5f62 7569 6c64 5f65 6d70 7479 5f61  f _build_empty_a
+000023a0: 7272 6179 2864 7479 7065 293a 0a20 2020  rray(dtype):.   
+000023b0: 2020 2020 2020 2020 2020 2020 2074 7279               try
+000023c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000023d0: 2020 2020 2020 7265 7475 726e 206e 702e        return np.
+000023e0: 6172 7261 7928 5b5d 2c20 6474 7970 653d  array([], dtype=
+000023f0: 6474 7970 6529 0a20 2020 2020 2020 2020  dtype).         
+00002400: 2020 2020 2020 2065 7863 6570 7420 5479         except Ty
+00002410: 7065 4572 726f 723a 2020 2320 7072 6167  peError:  # prag
+00002420: 6d61 3a20 6e6f 2063 6f76 6572 0a20 2020  ma: no cover.   
+00002430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002440: 2072 6574 7572 6e20 7064 2e61 7272 6179   return pd.array
+00002450: 285b 5d2c 2064 7479 7065 3d64 7479 7065  ([], dtype=dtype
+00002460: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00002470: 6620 6461 7461 2069 7320 4e6f 6e65 3a0a  f data is None:.
+00002480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002490: 7265 7475 726e 2070 642e 4d75 6c74 6949  return pd.MultiI
+000024a0: 6e64 6578 2e66 726f 6d5f 6172 7261 7973  ndex.from_arrays
+000024b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000024c0: 2020 2020 2020 5b5f 6275 696c 645f 656d        [_build_em
+000024d0: 7074 795f 6172 7261 7928 6474 7970 6529  pty_array(dtype)
+000024e0: 2066 6f72 2064 7479 7065 2069 6e20 7365   for dtype in se
+000024f0: 6c66 2e5f 6474 7970 6573 5d2c 0a20 2020  lf._dtypes],.   
+00002500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002510: 2073 6f72 746f 7264 6572 3d73 6f72 746f   sortorder=sorto
+00002520: 7264 6572 2c0a 2020 2020 2020 2020 2020  rder,.          
+00002530: 2020 2020 2020 2020 2020 6e61 6d65 733d            names=
+00002540: 7365 6c66 2e5f 6e61 6d65 732c 0a20 2020  self._names,.   
+00002550: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00002560: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00002570: 6e20 7064 2e4d 756c 7469 496e 6465 782e  n pd.MultiIndex.
+00002580: 6672 6f6d 5f74 7570 6c65 7328 0a20 2020  from_tuples(.   
+00002590: 2020 2020 2020 2020 2020 2020 205b 7475               [tu
+000025a0: 706c 6528 6429 2066 6f72 2064 2069 6e20  ple(d) for d in 
+000025b0: 6461 7461 5d2c 2073 6f72 746f 7264 6572  data], sortorder
+000025c0: 3d73 6f72 746f 7264 6572 2c20 6e61 6d65  =sortorder, name
+000025d0: 733d 7365 6c66 2e5f 6e61 6d65 730a 2020  s=self._names.  
+000025e0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+000025f0: 205f 696e 6465 785f 7661 6c75 6520 3d20   _index_value = 
+00002600: 4f6e 654f 6646 6965 6c64 280a 2020 2020  OneOfField(.    
+00002610: 2020 2020 2269 6e64 6578 5f76 616c 7565      "index_value
+00002620: 222c 0a20 2020 2020 2020 2069 6e64 6578  ",.        index
+00002630: 3d49 6e64 6578 2c0a 2020 2020 2020 2020  =Index,.        
+00002640: 7261 6e67 655f 696e 6465 783d 5261 6e67  range_index=Rang
+00002650: 6549 6e64 6578 2c0a 2020 2020 2020 2020  eIndex,.        
+00002660: 6361 7465 676f 7269 6361 6c5f 696e 6465  categorical_inde
+00002670: 783d 4361 7465 676f 7269 6361 6c49 6e64  x=CategoricalInd
+00002680: 6578 2c0a 2020 2020 2020 2020 696e 7465  ex,.        inte
+00002690: 7276 616c 5f69 6e64 6578 3d49 6e74 6572  rval_index=Inter
+000026a0: 7661 6c49 6e64 6578 2c0a 2020 2020 2020  valIndex,.      
+000026b0: 2020 6461 7465 7469 6d65 5f69 6e64 6578    datetime_index
+000026c0: 3d44 6174 6574 696d 6549 6e64 6578 2c0a  =DatetimeIndex,.
+000026d0: 2020 2020 2020 2020 7469 6d65 6465 6c74          timedelt
+000026e0: 615f 696e 6465 783d 5469 6d65 6465 6c74  a_index=Timedelt
+000026f0: 6149 6e64 6578 2c0a 2020 2020 2020 2020  aIndex,.        
+00002700: 7065 7269 6f64 5f69 6e64 6578 3d50 6572  period_index=Per
+00002710: 696f 6449 6e64 6578 2c0a 2020 2020 2020  iodIndex,.      
+00002720: 2020 696e 7436 345f 696e 6465 783d 496e    int64_index=In
+00002730: 7436 3449 6e64 6578 2c0a 2020 2020 2020  t64Index,.      
+00002740: 2020 7569 6e74 3634 5f69 6e64 6578 3d55    uint64_index=U
+00002750: 496e 7436 3449 6e64 6578 2c0a 2020 2020  Int64Index,.    
+00002760: 2020 2020 666c 6f61 7436 345f 696e 6465      float64_inde
+00002770: 783d 466c 6f61 7436 3449 6e64 6578 2c0a  x=Float64Index,.
+00002780: 2020 2020 2020 2020 6d75 6c74 695f 696e          multi_in
+00002790: 6465 783d 4d75 6c74 6949 6e64 6578 2c0a  dex=MultiIndex,.
+000027a0: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
+000027b0: 5f6d 6172 735f 746f 6b65 6e69 7a65 5f5f  _mars_tokenize__
+000027c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000027d0: 2320 7265 7475 726e 206f 626a 6563 7420  # return object 
+000027e0: 666f 7220 746f 6b65 6e69 7a65 0a20 2020  for tokenize.   
+000027f0: 2020 2020 2076 203d 2073 656c 662e 5f69       v = self._i
+00002800: 6e64 6578 5f76 616c 7565 0a20 2020 2020  ndex_value.     
+00002810: 2020 2072 6574 7572 6e20 762e 5f6b 6579     return v._key
+00002820: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00002830: 2020 2020 6465 6620 7661 6c75 6528 7365      def value(se
+00002840: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00002850: 7572 6e20 7365 6c66 2e5f 696e 6465 785f  urn self._index_
+00002860: 7661 6c75 650a 0a20 2020 2040 7072 6f70  value..    @prop
+00002870: 6572 7479 0a20 2020 2064 6566 206b 6579  erty.    def key
+00002880: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00002890: 7265 7475 726e 2073 656c 662e 5f69 6e64  return self._ind
+000028a0: 6578 5f76 616c 7565 2e6b 6579 0a0a 2020  ex_value.key..  
+000028b0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+000028c0: 6465 6620 6973 5f6d 6f6e 6f74 6f6e 6963  def is_monotonic
+000028d0: 5f69 6e63 7265 6173 696e 6728 7365 6c66  _increasing(self
+000028e0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000028f0: 6e20 7365 6c66 2e5f 696e 6465 785f 7661  n self._index_va
+00002900: 6c75 652e 6973 5f6d 6f6e 6f74 6f6e 6963  lue.is_monotonic
+00002910: 5f69 6e63 7265 6173 696e 670a 0a20 2020  _increasing..   
+00002920: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00002930: 6566 2069 735f 6d6f 6e6f 746f 6e69 635f  ef is_monotonic_
+00002940: 6465 6372 6561 7369 6e67 2873 656c 6629  decreasing(self)
+00002950: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00002960: 2073 656c 662e 5f69 6e64 6578 5f76 616c   self._index_val
+00002970: 7565 2e69 735f 6d6f 6e6f 746f 6e69 635f  ue.is_monotonic_
+00002980: 6465 6372 6561 7369 6e67 0a0a 2020 2020  decreasing..    
+00002990: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+000029a0: 6620 6973 5f6d 6f6e 6f74 6f6e 6963 5f69  f is_monotonic_i
+000029b0: 6e63 7265 6173 696e 675f 6f72 5f64 6563  ncreasing_or_dec
+000029c0: 7265 6173 696e 6728 7365 6c66 293a 0a20  reasing(self):. 
+000029d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000029e0: 6c66 2e69 735f 6d6f 6e6f 746f 6e69 635f  lf.is_monotonic_
+000029f0: 696e 6372 6561 7369 6e67 206f 7220 7365  increasing or se
+00002a00: 6c66 2e69 735f 6d6f 6e6f 746f 6e69 635f  lf.is_monotonic_
+00002a10: 6465 6372 6561 7369 6e67 0a0a 2020 2020  decreasing..    
+00002a20: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00002a30: 6620 6973 5f75 6e69 7175 6528 7365 6c66  f is_unique(self
+00002a40: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00002a50: 6e20 7365 6c66 2e5f 696e 6465 785f 7661  n self._index_va
+00002a60: 6c75 652e 6973 5f75 6e69 7175 650a 0a20  lue.is_unique.. 
+00002a70: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00002a80: 2064 6566 206d 696e 5f76 616c 2873 656c   def min_val(sel
+00002a90: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00002aa0: 726e 2073 656c 662e 5f69 6e64 6578 5f76  rn self._index_v
+00002ab0: 616c 7565 2e6d 696e 5f76 616c 0a0a 2020  alue.min_val..  
+00002ac0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00002ad0: 6465 6620 6d69 6e5f 7661 6c5f 636c 6f73  def min_val_clos
+00002ae0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+00002af0: 2072 6574 7572 6e20 7365 6c66 2e5f 696e   return self._in
+00002b00: 6465 785f 7661 6c75 652e 6d69 6e5f 7661  dex_value.min_va
+00002b10: 6c5f 636c 6f73 650a 0a20 2020 2040 7072  l_close..    @pr
+00002b20: 6f70 6572 7479 0a20 2020 2064 6566 206d  operty.    def m
+00002b30: 6178 5f76 616c 2873 656c 6629 3a0a 2020  ax_val(self):.  
+00002b40: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00002b50: 662e 5f69 6e64 6578 5f76 616c 7565 2e6d  f._index_value.m
+00002b60: 6178 5f76 616c 0a0a 2020 2020 4070 726f  ax_val..    @pro
+00002b70: 7065 7274 790a 2020 2020 6465 6620 6d61  perty.    def ma
+00002b80: 785f 7661 6c5f 636c 6f73 6528 7365 6c66  x_val_close(self
+00002b90: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00002ba0: 6e20 7365 6c66 2e5f 696e 6465 785f 7661  n self._index_va
+00002bb0: 6c75 652e 6d61 785f 7661 6c5f 636c 6f73  lue.max_val_clos
+00002bc0: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
+00002bd0: 0a20 2020 2064 6566 206d 696e 5f6d 6178  .    def min_max
+00002be0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00002bf0: 7265 7475 726e 2028 0a20 2020 2020 2020  return (.       
+00002c00: 2020 2020 2073 656c 662e 5f69 6e64 6578       self._index
+00002c10: 5f76 616c 7565 2e6d 696e 5f76 616c 2c0a  _value.min_val,.
+00002c20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00002c30: 2e5f 696e 6465 785f 7661 6c75 652e 6d69  ._index_value.mi
+00002c40: 6e5f 7661 6c5f 636c 6f73 652c 0a20 2020  n_val_close,.   
+00002c50: 2020 2020 2020 2020 2073 656c 662e 5f69           self._i
+00002c60: 6e64 6578 5f76 616c 7565 2e6d 6178 5f76  ndex_value.max_v
+00002c70: 616c 2c0a 2020 2020 2020 2020 2020 2020  al,.            
+00002c80: 7365 6c66 2e5f 696e 6465 785f 7661 6c75  self._index_valu
+00002c90: 652e 6d61 785f 7661 6c5f 636c 6f73 652c  e.max_val_close,
+00002ca0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00002cb0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00002cc0: 6620 6e61 6d65 2873 656c 6629 3a0a 2020  f name(self):.  
+00002cd0: 2020 2020 2020 7265 7475 726e 2067 6574        return get
+00002ce0: 6174 7472 2873 656c 662e 5f69 6e64 6578  attr(self._index
+00002cf0: 5f76 616c 7565 2c20 225f 6e61 6d65 222c  _value, "_name",
+00002d00: 204e 6f6e 6529 0a0a 2020 2020 4070 726f   None)..    @pro
+00002d10: 7065 7274 790a 2020 2020 6465 6620 696e  perty.    def in
+00002d20: 6665 7272 6564 5f74 7970 6528 7365 6c66  ferred_type(self
+00002d30: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00002d40: 6e20 7365 6c66 2e5f 696e 6465 785f 7661  n self._index_va
+00002d50: 6c75 652e 696e 6665 7272 6564 5f74 7970  lue.inferred_typ
+00002d60: 650a 0a20 2020 2064 6566 2068 6173 5f76  e..    def has_v
+00002d70: 616c 7565 2873 656c 6629 3a0a 2020 2020  alue(self):.    
+00002d80: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00002d90: 6528 7365 6c66 2e5f 696e 6465 785f 7661  e(self._index_va
+00002da0: 6c75 652c 2073 656c 662e 5261 6e67 6549  lue, self.RangeI
+00002db0: 6e64 6578 293a 0a20 2020 2020 2020 2020  ndex):.         
+00002dc0: 2020 2069 6620 6e70 2e69 736e 616e 2873     if np.isnan(s
+00002dd0: 656c 662e 5f69 6e64 6578 5f76 616c 7565  elf._index_value
+00002de0: 2e6d 6178 5f76 616c 293a 0a20 2020 2020  .max_val):.     
+00002df0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00002e00: 6e20 4661 6c73 650a 2020 2020 2020 2020  n False.        
+00002e10: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00002e20: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00002e30: 2054 7275 650a 2020 2020 2020 2020 656c   True.        el
+00002e40: 6966 2067 6574 6174 7472 2873 656c 662e  if getattr(self.
+00002e50: 5f69 6e64 6578 5f76 616c 7565 2c20 225f  _index_value, "_
+00002e60: 6461 7461 222c 204e 6f6e 6529 2069 7320  data", None) is 
+00002e70: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00002e80: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+00002e90: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
+00002ea0: 2046 616c 7365 0a0a 2020 2020 6465 6620   False..    def 
+00002eb0: 746f 5f70 616e 6461 7328 7365 6c66 293a  to_pandas(self):
+00002ec0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00002ed0: 7365 6c66 2e5f 696e 6465 785f 7661 6c75  self._index_valu
+00002ee0: 652e 746f 5f70 616e 6461 7328 290a 0a0a  e.to_pandas()...
+00002ef0: 636c 6173 7320 4474 7970 6573 5661 6c75  class DtypesValu
+00002f00: 6528 5365 7269 616c 697a 6162 6c65 293a  e(Serializable):
+00002f10: 0a20 2020 2022 2222 0a20 2020 204d 6574  .    """.    Met
+00002f20: 6120 636c 6173 7320 666f 7220 6474 7970  a class for dtyp
+00002f30: 6573 2e0a 2020 2020 2222 220a 0a20 2020  es..    """..   
+00002f40: 205f 5f73 6c6f 7473 5f5f 203d 2028 290a   __slots__ = ().
+00002f50: 0a20 2020 205f 6b65 7920 3d20 5374 7269  .    _key = Stri
+00002f60: 6e67 4669 656c 6428 226b 6579 2229 0a20  ngField("key"). 
+00002f70: 2020 205f 7661 6c75 6520 3d20 5365 7269     _value = Seri
+00002f80: 6573 4669 656c 6428 2276 616c 7565 2229  esField("value")
+00002f90: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+00002fa0: 5f5f 2873 656c 662c 206b 6579 3d4e 6f6e  __(self, key=Non
+00002fb0: 652c 2076 616c 7565 3d4e 6f6e 652c 202a  e, value=None, *
+00002fc0: 2a6b 7729 3a0a 2020 2020 2020 2020 7375  *kw):.        su
+00002fd0: 7065 7228 292e 5f5f 696e 6974 5f5f 285f  per().__init__(_
+00002fe0: 6b65 793d 6b65 792c 205f 7661 6c75 653d  key=key, _value=
+00002ff0: 7661 6c75 652c 202a 2a6b 7729 0a20 2020  value, **kw).   
+00003000: 2020 2020 2069 6620 7365 6c66 2e5f 6b65       if self._ke
+00003010: 7920 6973 204e 6f6e 653a 0a20 2020 2020  y is None:.     
+00003020: 2020 2020 2020 2073 656c 662e 5f6b 6579         self._key
+00003030: 203d 2074 6f6b 656e 697a 6528 7365 6c66   = tokenize(self
+00003040: 2e5f 7661 6c75 6529 0a0a 2020 2020 4070  ._value)..    @p
+00003050: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00003060: 6b65 7928 7365 6c66 293a 0a20 2020 2020  key(self):.     
+00003070: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00003080: 6b65 790a 0a20 2020 2040 7072 6f70 6572  key..    @proper
+00003090: 7479 0a20 2020 2064 6566 2076 616c 7565  ty.    def value
+000030a0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000030b0: 7265 7475 726e 2073 656c 662e 5f76 616c  return self._val
+000030c0: 7565 0a0a 0a64 6566 2072 6566 7265 7368  ue...def refresh
+000030d0: 5f69 6e64 6578 5f76 616c 7565 2874 696c  _index_value(til
+000030e0: 6561 626c 653a 2045 4e54 4954 595f 5459  eable: ENTITY_TY
+000030f0: 5045 293a 0a20 2020 2069 6e64 6578 5f74  PE):.    index_t
+00003100: 6f5f 696e 6465 785f 7661 6c75 6573 203d  o_index_values =
+00003110: 2064 6963 7428 290a 2020 2020 666f 7220   dict().    for 
+00003120: 6368 756e 6b20 696e 2074 696c 6561 626c  chunk in tileabl
+00003130: 652e 6368 756e 6b73 3a0a 2020 2020 2020  e.chunks:.      
+00003140: 2020 6966 2063 6875 6e6b 2e6e 6469 6d20    if chunk.ndim 
+00003150: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+00003160: 2020 696e 6465 785f 746f 5f69 6e64 6578    index_to_index
+00003170: 5f76 616c 7565 735b 6368 756e 6b2e 696e  _values[chunk.in
+00003180: 6465 785d 203d 2063 6875 6e6b 2e69 6e64  dex] = chunk.ind
+00003190: 6578 5f76 616c 7565 0a20 2020 2020 2020  ex_value.       
+000031a0: 2065 6c69 6620 6368 756e 6b2e 696e 6465   elif chunk.inde
+000031b0: 785b 315d 203d 3d20 303a 0a20 2020 2020  x[1] == 0:.     
+000031c0: 2020 2020 2020 2069 6e64 6578 5f74 6f5f         index_to_
+000031d0: 696e 6465 785f 7661 6c75 6573 5b63 6875  index_values[chu
+000031e0: 6e6b 2e69 6e64 6578 5d20 3d20 6368 756e  nk.index] = chun
+000031f0: 6b2e 696e 6465 785f 7661 6c75 650a 2020  k.index_value.  
+00003200: 2020 696e 6465 785f 7661 6c75 6520 3d20    index_value = 
+00003210: 6d65 7267 655f 696e 6465 785f 7661 6c75  merge_index_valu
+00003220: 6528 696e 6465 785f 746f 5f69 6e64 6578  e(index_to_index
+00003230: 5f76 616c 7565 732c 2073 746f 7265 5f64  _values, store_d
+00003240: 6174 613d 4661 6c73 6529 0a20 2020 2023  ata=False).    #
+00003250: 206b 6565 7020 6b65 7920 6173 206f 7269   keep key as ori
+00003260: 6769 6e61 6c20 696e 6465 785f 7661 6c75  ginal index_valu
+00003270: 6527 730a 2020 2020 6966 2074 696c 6561  e's.    if tilea
+00003280: 626c 652e 696e 6465 785f 7661 6c75 6520  ble.index_value 
+00003290: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000032a0: 2020 2020 2069 6e64 6578 5f76 616c 7565       index_value
+000032b0: 2e5f 696e 6465 785f 7661 6c75 652e 5f6b  ._index_value._k
+000032c0: 6579 203d 2074 696c 6561 626c 652e 696e  ey = tileable.in
+000032d0: 6465 785f 7661 6c75 652e 6b65 790a 2020  dex_value.key.  
+000032e0: 2020 7469 6c65 6162 6c65 2e5f 696e 6465    tileable._inde
+000032f0: 785f 7661 6c75 6520 3d20 696e 6465 785f  x_value = index_
+00003300: 7661 6c75 650a 0a0a 6465 6620 7265 6672  value...def refr
+00003310: 6573 685f 6474 7970 6573 2874 696c 6561  esh_dtypes(tilea
+00003320: 626c 653a 2045 4e54 4954 595f 5459 5045  ble: ENTITY_TYPE
+00003330: 293a 0a20 2020 2061 6c6c 5f64 7479 7065  ):.    all_dtype
+00003340: 7320 3d20 5b63 2e64 7479 7065 735f 7661  s = [c.dtypes_va
+00003350: 6c75 652e 7661 6c75 6520 666f 7220 6320  lue.value for c 
+00003360: 696e 2074 696c 6561 626c 652e 6368 756e  in tileable.chun
+00003370: 6b73 2069 6620 632e 696e 6465 785b 305d  ks if c.index[0]
+00003380: 203d 3d20 305d 0a20 2020 2064 7479 7065   == 0].    dtype
+00003390: 7320 3d20 7064 2e63 6f6e 6361 7428 616c  s = pd.concat(al
+000033a0: 6c5f 6474 7970 6573 290a 2020 2020 7469  l_dtypes).    ti
+000033b0: 6c65 6162 6c65 2e5f 6474 7970 6573 203d  leable._dtypes =
+000033c0: 2064 7479 7065 730a 2020 2020 636f 6c75   dtypes.    colu
+000033d0: 6d6e 735f 7661 6c75 6573 203d 2070 6172  mns_values = par
+000033e0: 7365 5f69 6e64 6578 2864 7479 7065 732e  se_index(dtypes.
+000033f0: 696e 6465 782c 2073 746f 7265 5f64 6174  index, store_dat
+00003400: 613d 5472 7565 290a 2020 2020 7469 6c65  a=True).    tile
+00003410: 6162 6c65 2e5f 636f 6c75 6d6e 735f 7661  able._columns_va
+00003420: 6c75 6520 3d20 636f 6c75 6d6e 735f 7661  lue = columns_va
+00003430: 6c75 6573 0a20 2020 2074 696c 6561 626c  lues.    tileabl
+00003440: 652e 5f64 7479 7065 735f 7661 6c75 6520  e._dtypes_value 
+00003450: 3d20 4474 7970 6573 5661 6c75 6528 6b65  = DtypesValue(ke
+00003460: 793d 746f 6b65 6e69 7a65 2864 7479 7065  y=tokenize(dtype
+00003470: 7329 2c20 7661 6c75 653d 6474 7970 6573  s), value=dtypes
+00003480: 290a 0a0a 5f74 696c 6561 626c 655f 6b65  )..._tileable_ke
+00003490: 795f 7072 6f70 6572 7479 203d 2022 5f74  y_property = "_t
+000034a0: 696c 6561 626c 655f 6b65 7922 0a5f 7469  ileable_key"._ti
+000034b0: 6c65 6162 6c65 5f64 7479 7065 735f 7072  leable_dtypes_pr
+000034c0: 6f70 6572 7479 203d 2022 5f74 696c 6561  operty = "_tilea
+000034d0: 626c 655f 6474 7970 6573 220a 5f74 696c  ble_dtypes"._til
+000034e0: 6561 626c 655f 696e 6465 785f 7661 6c75  eable_index_valu
+000034f0: 655f 7072 6f70 6572 7479 203d 2022 5f74  e_property = "_t
+00003500: 696c 6561 626c 655f 696e 6465 785f 7661  ileable_index_va
+00003510: 6c75 6522 0a5f 7469 6c65 6162 6c65 5f63  lue"._tileable_c
+00003520: 6f6c 756d 6e73 5f76 616c 7565 5f70 726f  olumns_value_pro
+00003530: 7065 7274 7920 3d20 225f 7469 6c65 6162  perty = "_tileab
+00003540: 6c65 5f63 6f6c 756d 6e73 5f76 616c 7565  le_columns_value
+00003550: 220a 5f6e 7370 6c69 7473 5f70 726f 7065  "._nsplits_prope
+00003560: 7274 7920 3d20 225f 7469 6c65 6162 6c65  rty = "_tileable
+00003570: 5f6e 7370 6c69 7473 220a 5f6c 617a 795f  _nsplits"._lazy_
+00003580: 6368 756e 6b5f 6d65 7461 5f70 726f 7065  chunk_meta_prope
+00003590: 7274 6965 7320 3d20 280a 2020 2020 5f74  rties = (.    _t
+000035a0: 696c 6561 626c 655f 6b65 795f 7072 6f70  ileable_key_prop
+000035b0: 6572 7479 2c0a 2020 2020 5f74 696c 6561  erty,.    _tilea
+000035c0: 626c 655f 6474 7970 6573 5f70 726f 7065  ble_dtypes_prope
+000035d0: 7274 792c 0a20 2020 205f 7469 6c65 6162  rty,.    _tileab
+000035e0: 6c65 5f69 6e64 6578 5f76 616c 7565 5f70  le_index_value_p
+000035f0: 726f 7065 7274 792c 0a20 2020 205f 7469  roperty,.    _ti
+00003600: 6c65 6162 6c65 5f63 6f6c 756d 6e73 5f76  leable_columns_v
+00003610: 616c 7565 5f70 726f 7065 7274 792c 0a20  alue_property,. 
+00003620: 2020 205f 6e73 706c 6974 735f 7072 6f70     _nsplits_prop
+00003630: 6572 7479 2c0a 290a 0a0a 636c 6173 7320  erty,.)...class 
+00003640: 4c61 7a79 4d65 7461 4368 756e 6b44 6174  LazyMetaChunkDat
+00003650: 6128 4368 756e 6b44 6174 6129 3a0a 2020  a(ChunkData):.  
+00003660: 2020 5f5f 736c 6f74 735f 5f20 3d20 5f6c    __slots__ = _l
+00003670: 617a 795f 6368 756e 6b5f 6d65 7461 5f70  azy_chunk_meta_p
+00003680: 726f 7065 7274 6965 730a 0a20 2020 2064  roperties..    d
+00003690: 6566 205f 7365 745f 7469 6c65 6162 6c65  ef _set_tileable
+000036a0: 5f6d 6574 6128 0a20 2020 2020 2020 2073  _meta(.        s
+000036b0: 656c 662c 0a20 2020 2020 2020 2074 696c  elf,.        til
+000036c0: 6561 626c 655f 6b65 793a 2073 7472 203d  eable_key: str =
+000036d0: 204e 6f6e 652c 0a20 2020 2020 2020 206e   None,.        n
+000036e0: 7370 6c69 7473 3a20 5475 706c 655b 5475  splits: Tuple[Tu
+000036f0: 706c 655b 696e 742c 202e 2e2e 5d5d 203d  ple[int, ...]] =
+00003700: 204e 6f6e 652c 0a20 2020 2020 2020 2069   None,.        i
+00003710: 6e64 6578 5f76 616c 7565 3a20 496e 6465  ndex_value: Inde
+00003720: 7856 616c 7565 203d 204e 6f6e 652c 0a20  xValue = None,. 
+00003730: 2020 2020 2020 2063 6f6c 756d 6e73 5f76         columns_v
+00003740: 616c 7565 3a20 496e 6465 7856 616c 7565  alue: IndexValue
+00003750: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00003760: 2064 7479 7065 733a 2070 642e 5365 7269   dtypes: pd.Seri
+00003770: 6573 203d 204e 6f6e 652c 0a20 2020 2029  es = None,.    )
+00003780: 3a0a 2020 2020 2020 2020 7365 7461 7474  :.        setatt
+00003790: 7228 7365 6c66 2c20 5f74 696c 6561 626c  r(self, _tileabl
+000037a0: 655f 6b65 795f 7072 6f70 6572 7479 2c20  e_key_property, 
+000037b0: 7469 6c65 6162 6c65 5f6b 6579 290a 2020  tileable_key).  
+000037c0: 2020 2020 2020 7365 7461 7474 7228 7365        setattr(se
+000037d0: 6c66 2c20 5f6e 7370 6c69 7473 5f70 726f  lf, _nsplits_pro
+000037e0: 7065 7274 792c 206e 7370 6c69 7473 290a  perty, nsplits).
+000037f0: 2020 2020 2020 2020 7365 7461 7474 7228          setattr(
+00003800: 7365 6c66 2c20 5f74 696c 6561 626c 655f  self, _tileable_
+00003810: 696e 6465 785f 7661 6c75 655f 7072 6f70  index_value_prop
+00003820: 6572 7479 2c20 696e 6465 785f 7661 6c75  erty, index_valu
+00003830: 6529 0a20 2020 2020 2020 2073 6574 6174  e).        setat
+00003840: 7472 2873 656c 662c 205f 7469 6c65 6162  tr(self, _tileab
+00003850: 6c65 5f63 6f6c 756d 6e73 5f76 616c 7565  le_columns_value
+00003860: 5f70 726f 7065 7274 792c 2063 6f6c 756d  _property, colum
+00003870: 6e73 5f76 616c 7565 290a 2020 2020 2020  ns_value).      
+00003880: 2020 7365 7461 7474 7228 7365 6c66 2c20    setattr(self, 
+00003890: 5f74 696c 6561 626c 655f 6474 7970 6573  _tileable_dtypes
+000038a0: 5f70 726f 7065 7274 792c 2064 7479 7065  _property, dtype
+000038b0: 7329 0a0a 0a64 6566 2069 735f 6368 756e  s)...def is_chun
+000038c0: 6b5f 6d65 7461 5f6c 617a 7928 6368 756e  k_meta_lazy(chun
+000038d0: 6b3a 2043 6875 6e6b 4461 7461 2920 2d3e  k: ChunkData) ->
+000038e0: 2062 6f6f 6c3a 0a20 2020 2063 6875 6e6b   bool:.    chunk
+000038f0: 203d 2063 6875 6e6b 2e64 6174 6120 6966   = chunk.data if
+00003900: 2068 6173 6174 7472 2863 6875 6e6b 2c20   hasattr(chunk, 
+00003910: 2264 6174 6122 2920 656c 7365 2063 6875  "data") else chu
+00003920: 6e6b 0a20 2020 2072 6574 7572 6e20 6973  nk.    return is
+00003930: 696e 7374 616e 6365 2863 6875 6e6b 2c20  instance(chunk, 
+00003940: 4c61 7a79 4d65 7461 4368 756e 6b44 6174  LazyMetaChunkDat
+00003950: 6129 2061 6e64 2068 6173 6174 7472 280a  a) and hasattr(.
+00003960: 2020 2020 2020 2020 6368 756e 6b2c 205f          chunk, _
+00003970: 7469 6c65 6162 6c65 5f6b 6579 5f70 726f  tileable_key_pro
+00003980: 7065 7274 790a 2020 2020 290a 0a0a 4066  perty.    )...@f
+00003990: 756e 6374 6f6f 6c73 2e6c 7275 5f63 6163  unctools.lru_cac
+000039a0: 6865 286d 6178 7369 7a65 3d31 3238 290a  he(maxsize=128).
+000039b0: 6465 6620 5f67 6574 5f63 756d 5f6e 7370  def _get_cum_nsp
+000039c0: 6c69 7428 6e73 706c 6974 3a20 5475 706c  lit(nsplit: Tupl
+000039d0: 655b 696e 745d 2920 2d3e 204c 6973 745b  e[int]) -> List[
+000039e0: 696e 745d 3a0a 2020 2020 7265 7475 726e  int]:.    return
+000039f0: 205b 305d 202b 206e 702e 6375 6d73 756d   [0] + np.cumsum
+00003a00: 286e 7370 6c69 7429 2e74 6f6c 6973 7428  (nsplit).tolist(
+00003a10: 290a 0a0a 6465 6620 5f63 616c 635f 6178  )...def _calc_ax
+00003a20: 6973 5f73 6c69 6365 286e 7370 6c69 743a  is_slice(nsplit:
+00003a30: 2054 7570 6c65 5b69 6e74 5d2c 2069 6e64   Tuple[int], ind
+00003a40: 6578 3a20 696e 7429 202d 3e20 736c 6963  ex: int) -> slic
+00003a50: 653a 0a20 2020 2069 6620 6e6f 7420 6973  e:.    if not is
+00003a60: 696e 7374 616e 6365 286e 7370 6c69 742c  instance(nsplit,
+00003a70: 2074 7570 6c65 293a 0a20 2020 2020 2020   tuple):.       
+00003a80: 206e 7370 6c69 7420 3d20 7475 706c 6528   nsplit = tuple(
+00003a90: 6e73 706c 6974 290a 2020 2020 6375 6d5f  nsplit).    cum_
+00003aa0: 6e73 706c 6974 203d 205f 6765 745f 6375  nsplit = _get_cu
+00003ab0: 6d5f 6e73 706c 6974 286e 7370 6c69 7429  m_nsplit(nsplit)
+00003ac0: 0a20 2020 2072 6574 7572 6e20 736c 6963  .    return slic
+00003ad0: 6528 6375 6d5f 6e73 706c 6974 5b69 6e64  e(cum_nsplit[ind
+00003ae0: 6578 5d2c 2063 756d 5f6e 7370 6c69 745b  ex], cum_nsplit[
+00003af0: 696e 6465 7820 2b20 315d 290a 0a0a 636c  index + 1])...cl
+00003b00: 6173 7320 4368 756e 6b44 7479 7065 7346  ass ChunkDtypesF
+00003b10: 6965 6c64 2853 6572 6965 7346 6965 6c64  ield(SeriesField
+00003b20: 293a 0a20 2020 205f 7469 6c65 6162 6c65  ):.    _tileable
+00003b30: 5f6b 6579 5f69 6e64 6578 5f74 6f5f 6474  _key_index_to_dt
+00003b40: 7970 6573 203d 2064 6963 7428 290a 0a20  ypes = dict().. 
+00003b50: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
+00003b60: 0a20 2020 2064 6566 205f 6765 6e5f 6368  .    def _gen_ch
+00003b70: 756e 6b5f 6474 7970 6573 2869 6e73 7461  unk_dtypes(insta
+00003b80: 6e63 653a 2043 6875 6e6b 2c20 696e 6465  nce: Chunk, inde
+00003b90: 783a 2069 6e74 2920 2d3e 204f 7074 696f  x: int) -> Optio
+00003ba0: 6e61 6c5b 7064 2e53 6572 6965 735d 3a0a  nal[pd.Series]:.
+00003bb0: 2020 2020 2020 2020 2320 6474 7970 6573          # dtypes
+00003bc0: 206f 6620 7469 6c65 6162 6c65 0a20 2020   of tileable.   
+00003bd0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00003be0: 2020 2020 2020 7469 6c65 6162 6c65 5f6b        tileable_k
+00003bf0: 6579 203d 2067 6574 6174 7472 2869 6e73  ey = getattr(ins
+00003c00: 7461 6e63 652c 205f 7469 6c65 6162 6c65  tance, _tileable
+00003c10: 5f6b 6579 5f70 726f 7065 7274 7929 0a20  _key_property). 
+00003c20: 2020 2020 2020 2065 7863 6570 7420 4174         except At
+00003c30: 7472 6962 7574 6545 7272 6f72 3a0a 2020  tributeError:.  
+00003c40: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00003c50: 0a20 2020 2020 2020 2063 6163 6865 203d  .        cache =
+00003c60: 2043 6875 6e6b 4474 7970 6573 4669 656c   ChunkDtypesFiel
+00003c70: 642e 5f74 696c 6561 626c 655f 6b65 795f  d._tileable_key_
+00003c80: 696e 6465 785f 746f 5f64 7479 7065 730a  index_to_dtypes.
+00003c90: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00003ca0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00003cb0: 6361 6368 655b 7469 6c65 6162 6c65 5f6b  cache[tileable_k
+00003cc0: 6579 2c20 696e 6465 785d 0a20 2020 2020  ey, index].     
+00003cd0: 2020 2065 7863 6570 7420 4b65 7945 7272     except KeyErr
+00003ce0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00003cf0: 7469 6c65 6162 6c65 5f64 7479 7065 7320  tileable_dtypes 
+00003d00: 3d20 6765 7461 7474 7228 696e 7374 616e  = getattr(instan
+00003d10: 6365 2c20 5f74 696c 6561 626c 655f 6474  ce, _tileable_dt
+00003d20: 7970 6573 5f70 726f 7065 7274 7929 0a20  ypes_property). 
+00003d30: 2020 2020 2020 2020 2020 2023 206e 7370             # nsp
+00003d40: 6c69 7473 206f 6620 7469 6c65 6162 6c65  lits of tileable
+00003d50: 0a20 2020 2020 2020 2020 2020 206e 7370  .            nsp
+00003d60: 6c69 7473 203d 2067 6574 6174 7472 2869  lits = getattr(i
+00003d70: 6e73 7461 6e63 652c 205f 6e73 706c 6974  nstance, _nsplit
+00003d80: 735f 7072 6f70 6572 7479 295b 315d 0a20  s_property)[1]. 
+00003d90: 2020 2020 2020 2020 2020 2023 2063 616c             # cal
+00003da0: 6320 736c 6963 650a 2020 2020 2020 2020  c slice.        
+00003db0: 2020 2020 736c 6320 3d20 5f63 616c 635f      slc = _calc_
+00003dc0: 6178 6973 5f73 6c69 6365 286e 7370 6c69  axis_slice(nspli
+00003dd0: 7473 2c20 696e 6465 7829 0a20 2020 2020  ts, index).     
+00003de0: 2020 2020 2020 2064 7479 7065 7320 3d20         dtypes = 
+00003df0: 7469 6c65 6162 6c65 5f64 7479 7065 732e  tileable_dtypes.
+00003e00: 696c 6f63 5b73 6c63 5d0a 2020 2020 2020  iloc[slc].      
+00003e10: 2020 2020 2020 6361 6368 655b 7469 6c65        cache[tile
+00003e20: 6162 6c65 5f6b 6579 2c20 696e 6465 785d  able_key, index]
+00003e30: 203d 2064 7479 7065 730a 2020 2020 2020   = dtypes.      
+00003e40: 2020 2020 2020 7265 7475 726e 2064 7479        return dty
+00003e50: 7065 730a 0a20 2020 2064 6566 205f 5f67  pes..    def __g
+00003e60: 6574 5f5f 2873 656c 662c 2069 6e73 7461  et__(self, insta
+00003e70: 6e63 652c 206f 776e 6572 3d4e 6f6e 6529  nce, owner=None)
+00003e80: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
+00003e90: 2069 7373 7562 636c 6173 7328 6f77 6e65   issubclass(owne
+00003ea0: 722c 204c 617a 794d 6574 6143 6875 6e6b  r, LazyMetaChunk
+00003eb0: 4461 7461 293a 2020 2320 7072 6167 6d61  Data):  # pragma
+00003ec0: 3a20 6e6f 2063 6f76 6572 0a20 2020 2020  : no cover.     
+00003ed0: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
+00003ee0: 7065 7228 292e 5f5f 6765 745f 5f28 696e  per().__get__(in
+00003ef0: 7374 616e 6365 2c20 6f77 6e65 7229 0a0a  stance, owner)..
+00003f00: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00003f10: 2020 2020 2020 2020 2076 616c 7565 203d           value =
+00003f20: 2073 656c 662e 6765 7428 696e 7374 616e   self.get(instan
+00003f30: 6365 2c20 6f77 6e65 7229 0a20 2020 2020  ce, owner).     
+00003f40: 2020 2020 2020 2069 6620 7661 6c75 6520         if value 
+00003f50: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00003f60: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00003f70: 7572 6e20 7661 6c75 650a 2020 2020 2020  urn value.      
+00003f80: 2020 6578 6365 7074 2041 7474 7269 6275    except Attribu
+00003f90: 7465 4572 726f 723a 2020 2320 7072 6167  teError:  # prag
+00003fa0: 6d61 3a20 6e6f 2063 6f76 6572 0a20 2020  ma: no cover.   
+00003fb0: 2020 2020 2020 2020 2070 6173 730a 0a20           pass.. 
+00003fc0: 2020 2020 2020 2069 6620 696e 7374 616e         if instan
+00003fd0: 6365 2e69 6e64 6578 2069 7320 4e6f 6e65  ce.index is None
+00003fe0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00003ff0: 7475 726e 2073 7570 6572 2829 2e5f 5f67  turn super().__g
+00004000: 6574 5f5f 2869 6e73 7461 6e63 652c 206f  et__(instance, o
+00004010: 776e 6572 290a 0a20 2020 2020 2020 2023  wner)..        #
+00004020: 2067 6574 2064 7479 7065 7320 6c61 7a69   get dtypes lazi
+00004030: 6c79 0a20 2020 2020 2020 2069 6e64 6578  ly.        index
+00004040: 203d 2069 6e73 7461 6e63 652e 696e 6465   = instance.inde
+00004050: 785b 315d 0a20 2020 2020 2020 2064 7479  x[1].        dty
+00004060: 7065 7320 3d20 7365 6c66 2e5f 6765 6e5f  pes = self._gen_
+00004070: 6368 756e 6b5f 6474 7970 6573 2869 6e73  chunk_dtypes(ins
+00004080: 7461 6e63 652c 2069 6e64 6578 290a 2020  tance, index).  
+00004090: 2020 2020 2020 2320 6361 6368 6520 6474        # cache dt
+000040a0: 7970 6573 0a20 2020 2020 2020 2073 656c  ypes.        sel
+000040b0: 662e 7365 7428 696e 7374 616e 6365 2c20  f.set(instance, 
+000040c0: 6474 7970 6573 290a 2020 2020 2020 2020  dtypes).        
+000040d0: 7265 7475 726e 2064 7479 7065 730a 0a0a  return dtypes...
+000040e0: 636c 6173 7320 4368 756e 6b49 6e64 6578  class ChunkIndex
+000040f0: 5661 6c75 6546 6965 6c64 2852 6566 6572  ValueField(Refer
+00004100: 656e 6365 4669 656c 6429 3a0a 2020 2020  enceField):.    
+00004110: 5f74 696c 6561 626c 655f 6b65 795f 696e  _tileable_key_in
+00004120: 6465 785f 746f 5f69 6e64 6578 5f76 616c  dex_to_index_val
+00004130: 7565 203d 2064 6963 7428 290a 0a20 2020  ue = dict()..   
+00004140: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+00004150: 2020 2064 6566 205f 6765 6e5f 6368 756e     def _gen_chun
+00004160: 6b5f 696e 6465 785f 7661 6c75 6528 696e  k_index_value(in
+00004170: 7374 616e 6365 3a20 4368 756e 6b2c 2069  stance: Chunk, i
+00004180: 6e64 6578 3a20 696e 7429 202d 3e20 4f70  ndex: int) -> Op
+00004190: 7469 6f6e 616c 5b49 6e64 6578 5661 6c75  tional[IndexValu
+000041a0: 655d 3a0a 2020 2020 2020 2020 2320 696e  e]:.        # in
+000041b0: 6465 785f 7661 6c75 6520 6f66 2074 696c  dex_value of til
+000041c0: 6561 626c 650a 2020 2020 2020 2020 7472  eable.        tr
+000041d0: 793a 0a20 2020 2020 2020 2020 2020 2074  y:.            t
+000041e0: 696c 6561 626c 655f 6b65 7920 3d20 6765  ileable_key = ge
+000041f0: 7461 7474 7228 696e 7374 616e 6365 2c20  tattr(instance, 
+00004200: 5f74 696c 6561 626c 655f 6b65 795f 7072  _tileable_key_pr
+00004210: 6f70 6572 7479 290a 2020 2020 2020 2020  operty).        
+00004220: 6578 6365 7074 2041 7474 7269 6275 7465  except Attribute
+00004230: 4572 726f 723a 0a20 2020 2020 2020 2020  Error:.         
+00004240: 2020 2072 6574 7572 6e0a 2020 2020 2020     return.      
+00004250: 2020 6361 6368 6520 3d20 4368 756e 6b49    cache = ChunkI
+00004260: 6e64 6578 5661 6c75 6546 6965 6c64 2e5f  ndexValueField._
+00004270: 7469 6c65 6162 6c65 5f6b 6579 5f69 6e64  tileable_key_ind
+00004280: 6578 5f74 6f5f 696e 6465 785f 7661 6c75  ex_to_index_valu
+00004290: 650a 2020 2020 2020 2020 7472 793a 0a20  e.        try:. 
+000042a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000042b0: 6e20 6361 6368 655b 7469 6c65 6162 6c65  n cache[tileable
+000042c0: 5f6b 6579 2c20 696e 6465 785d 0a20 2020  _key, index].   
+000042d0: 2020 2020 2065 7863 6570 7420 4b65 7945       except KeyE
+000042e0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+000042f0: 2020 7469 6c65 6162 6c65 5f69 6e64 6578    tileable_index
+00004300: 5f76 616c 7565 203d 2067 6574 6174 7472  _value = getattr
+00004310: 2869 6e73 7461 6e63 652c 205f 7469 6c65  (instance, _tile
+00004320: 6162 6c65 5f69 6e64 6578 5f76 616c 7565  able_index_value
+00004330: 5f70 726f 7065 7274 7929 0a20 2020 2020  _property).     
+00004340: 2020 2020 2020 2023 206e 7370 6c69 7473         # nsplits
+00004350: 206f 6620 7469 6c65 6162 6c65 0a20 2020   of tileable.   
+00004360: 2020 2020 2020 2020 206e 7370 6c69 7420           nsplit 
+00004370: 3d20 6765 7461 7474 7228 696e 7374 616e  = getattr(instan
+00004380: 6365 2c20 5f6e 7370 6c69 7473 5f70 726f  ce, _nsplits_pro
+00004390: 7065 7274 7929 5b30 5d0a 2020 2020 2020  perty)[0].      
+000043a0: 2020 2020 2020 2320 6361 6c63 2073 6c69        # calc sli
+000043b0: 6365 0a20 2020 2020 2020 2020 2020 2073  ce.            s
+000043c0: 6c63 203d 205f 6361 6c63 5f61 7869 735f  lc = _calc_axis_
+000043d0: 736c 6963 6528 6e73 706c 6974 2c20 696e  slice(nsplit, in
+000043e0: 6465 7829 0a20 2020 2020 2020 2020 2020  dex).           
+000043f0: 2070 645f 696e 6465 7820 3d20 7469 6c65   pd_index = tile
+00004400: 6162 6c65 5f69 6e64 6578 5f76 616c 7565  able_index_value
+00004410: 2e74 6f5f 7061 6e64 6173 2829 0a20 2020  .to_pandas().   
+00004420: 2020 2020 2020 2020 2069 6620 6e70 2e69           if np.i
+00004430: 736e 616e 2873 6c63 2e73 746f 7020 2d20  snan(slc.stop - 
+00004440: 736c 632e 7374 6172 7429 3a0a 2020 2020  slc.start):.    
+00004450: 2020 2020 2020 2020 2020 2020 6368 756e              chun
+00004460: 6b5f 7064 5f69 6e64 6578 203d 2070 645f  k_pd_index = pd_
+00004470: 696e 6465 785b 3a30 5d0a 2020 2020 2020  index[:0].      
+00004480: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00004490: 2020 2020 2020 2020 2020 2020 6368 756e              chun
+000044a0: 6b5f 7064 5f69 6e64 6578 203d 2070 645f  k_pd_index = pd_
+000044b0: 696e 6465 785b 736c 635d 0a20 2020 2020  index[slc].     
+000044c0: 2020 2020 2020 2069 6e64 6578 5f76 616c         index_val
+000044d0: 7565 203d 2070 6172 7365 5f69 6e64 6578  ue = parse_index
+000044e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000044f0: 2020 6368 756e 6b5f 7064 5f69 6e64 6578    chunk_pd_index
+00004500: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00004510: 2020 6b65 793d 6622 7b74 696c 6561 626c    key=f"{tileabl
+00004520: 655f 696e 6465 785f 7661 6c75 652e 6b65  e_index_value.ke
+00004530: 797d 5f69 6e64 6578 5f7b 696e 6465 787d  y}_index_{index}
+00004540: 5f7b 736c 632e 7374 6172 747d 5f7b 736c  _{slc.start}_{sl
+00004550: 632e 7374 6f70 7d22 2c0a 2020 2020 2020  c.stop}",.      
+00004560: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00004570: 2020 2020 6361 6368 655b 7469 6c65 6162      cache[tileab
+00004580: 6c65 5f6b 6579 2c20 696e 6465 785d 203d  le_key, index] =
+00004590: 2069 6e64 6578 5f76 616c 7565 0a20 2020   index_value.   
+000045a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000045b0: 696e 6465 785f 7661 6c75 650a 0a20 2020  index_value..   
+000045c0: 2064 6566 205f 5f67 6574 5f5f 2873 656c   def __get__(sel
+000045d0: 662c 2069 6e73 7461 6e63 652c 206f 776e  f, instance, own
+000045e0: 6572 3d4e 6f6e 6529 3a0a 2020 2020 2020  er=None):.      
+000045f0: 2020 6966 206e 6f74 2069 7373 7562 636c    if not issubcl
+00004600: 6173 7328 6f77 6e65 722c 204c 617a 794d  ass(owner, LazyM
+00004610: 6574 6143 6875 6e6b 4461 7461 293a 2020  etaChunkData):  
+00004620: 2320 7072 6167 6d61 3a20 6e6f 2063 6f76  # pragma: no cov
+00004630: 6572 0a20 2020 2020 2020 2020 2020 2072  er.            r
+00004640: 6574 7572 6e20 7375 7065 7228 292e 5f5f  eturn super().__
+00004650: 6765 745f 5f28 696e 7374 616e 6365 2c20  get__(instance, 
+00004660: 6f77 6e65 7229 0a0a 2020 2020 2020 2020  owner)..        
+00004670: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00004680: 2076 616c 7565 203d 2073 656c 662e 6765   value = self.ge
+00004690: 7428 696e 7374 616e 6365 2c20 6f77 6e65  t(instance, owne
+000046a0: 7229 0a20 2020 2020 2020 2020 2020 2069  r).            i
+000046b0: 6620 7661 6c75 6520 6973 206e 6f74 204e  f value is not N
+000046c0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000046d0: 2020 2020 2072 6574 7572 6e20 7661 6c75       return valu
+000046e0: 650a 2020 2020 2020 2020 6578 6365 7074  e.        except
+000046f0: 2041 7474 7269 6275 7465 4572 726f 723a   AttributeError:
+00004700: 2020 2320 7072 6167 6d61 3a20 6e6f 2063    # pragma: no c
+00004710: 6f76 6572 0a20 2020 2020 2020 2020 2020  over.           
+00004720: 2070 6173 730a 0a20 2020 2020 2020 2069   pass..        i
+00004730: 6620 696e 7374 616e 6365 2e69 6e64 6578  f instance.index
+00004740: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00004750: 2020 2020 2020 7265 7475 726e 2073 7570        return sup
+00004760: 6572 2829 2e5f 5f67 6574 5f5f 2869 6e73  er().__get__(ins
+00004770: 7461 6e63 652c 206f 776e 6572 290a 0a20  tance, owner).. 
+00004780: 2020 2020 2020 2023 2067 6574 2069 6e64         # get ind
+00004790: 6578 5f76 616c 7565 206c 617a 696c 790a  ex_value lazily.
+000047a0: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
+000047b0: 696e 7374 616e 6365 2e69 6e64 6578 5b30  instance.index[0
+000047c0: 5d0a 2020 2020 2020 2020 696e 6465 785f  ].        index_
+000047d0: 7661 6c75 6520 3d20 7365 6c66 2e5f 6765  value = self._ge
+000047e0: 6e5f 6368 756e 6b5f 696e 6465 785f 7661  n_chunk_index_va
+000047f0: 6c75 6528 696e 7374 616e 6365 2c20 696e  lue(instance, in
+00004800: 6465 7829 0a20 2020 2020 2020 2023 2063  dex).        # c
+00004810: 6163 6865 2069 6e64 6578 5f76 616c 7565  ache index_value
+00004820: 0a20 2020 2020 2020 2073 656c 662e 7365  .        self.se
+00004830: 7428 696e 7374 616e 6365 2c20 696e 6465  t(instance, inde
+00004840: 785f 7661 6c75 6529 0a20 2020 2020 2020  x_value).       
+00004850: 2072 6574 7572 6e20 696e 6465 785f 7661   return index_va
+00004860: 6c75 650a 0a0a 636c 6173 7320 4368 756e  lue...class Chun
+00004870: 6b43 6f6c 756d 6e73 5661 6c75 6546 6965  kColumnsValueFie
+00004880: 6c64 2852 6566 6572 656e 6365 4669 656c  ld(ReferenceFiel
+00004890: 6429 3a0a 2020 2020 5f74 696c 6561 626c  d):.    _tileabl
+000048a0: 655f 6b65 795f 696e 6465 785f 746f 5f69  e_key_index_to_i
+000048b0: 6e64 6578 5f76 616c 7565 203d 2064 6963  ndex_value = dic
+000048c0: 7428 290a 0a20 2020 2040 7374 6174 6963  t()..    @static
+000048d0: 6d65 7468 6f64 0a20 2020 2064 6566 205f  method.    def _
+000048e0: 6765 6e5f 6368 756e 6b5f 636f 6c75 6d6e  gen_chunk_column
+000048f0: 735f 7661 6c75 6528 696e 7374 616e 6365  s_value(instance
+00004900: 3a20 4368 756e 6b2c 2069 6e64 6578 3a20  : Chunk, index: 
+00004910: 696e 7429 202d 3e20 4f70 7469 6f6e 616c  int) -> Optional
+00004920: 5b49 6e64 6578 5661 6c75 655d 3a0a 2020  [IndexValue]:.  
+00004930: 2020 2020 2020 2320 636f 6c75 6d6e 735f        # columns_
+00004940: 7661 6c75 6520 6f66 2074 696c 6561 626c  value of tileabl
+00004950: 650a 2020 2020 2020 2020 7472 793a 0a20  e.        try:. 
+00004960: 2020 2020 2020 2020 2020 2074 696c 6561             tilea
+00004970: 626c 655f 6b65 7920 3d20 6765 7461 7474  ble_key = getatt
+00004980: 7228 696e 7374 616e 6365 2c20 5f74 696c  r(instance, _til
+00004990: 6561 626c 655f 6b65 795f 7072 6f70 6572  eable_key_proper
+000049a0: 7479 290a 2020 2020 2020 2020 6578 6365  ty).        exce
+000049b0: 7074 2041 7474 7269 6275 7465 4572 726f  pt AttributeErro
+000049c0: 723a 0a20 2020 2020 2020 2020 2020 2072  r:.            r
+000049d0: 6574 7572 6e0a 2020 2020 2020 2020 6361  eturn.        ca
+000049e0: 6368 6520 3d20 4368 756e 6b43 6f6c 756d  che = ChunkColum
+000049f0: 6e73 5661 6c75 6546 6965 6c64 2e5f 7469  nsValueField._ti
+00004a00: 6c65 6162 6c65 5f6b 6579 5f69 6e64 6578  leable_key_index
+00004a10: 5f74 6f5f 696e 6465 785f 7661 6c75 650a  _to_index_value.
+00004a20: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00004a30: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00004a40: 6361 6368 655b 7469 6c65 6162 6c65 5f6b  cache[tileable_k
+00004a50: 6579 2c20 696e 6465 785d 0a20 2020 2020  ey, index].     
+00004a60: 2020 2065 7863 6570 7420 4b65 7945 7272     except KeyErr
+00004a70: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00004a80: 7469 6c65 6162 6c65 5f63 6f6c 756d 6e73  tileable_columns
+00004a90: 5f76 616c 7565 203d 2067 6574 6174 7472  _value = getattr
+00004aa0: 2869 6e73 7461 6e63 652c 205f 7469 6c65  (instance, _tile
+00004ab0: 6162 6c65 5f63 6f6c 756d 6e73 5f76 616c  able_columns_val
+00004ac0: 7565 5f70 726f 7065 7274 7929 0a20 2020  ue_property).   
+00004ad0: 2020 2020 2020 2020 2023 206e 7370 6c69           # nspli
+00004ae0: 7473 206f 6620 7469 6c65 6162 6c65 0a20  ts of tileable. 
+00004af0: 2020 2020 2020 2020 2020 206e 7370 6c69             nspli
+00004b00: 7420 3d20 6765 7461 7474 7228 696e 7374  t = getattr(inst
+00004b10: 616e 6365 2c20 5f6e 7370 6c69 7473 5f70  ance, _nsplits_p
+00004b20: 726f 7065 7274 7929 5b31 5d0a 2020 2020  roperty)[1].    
+00004b30: 2020 2020 2020 2020 2320 6361 6c63 2073          # calc s
+00004b40: 6c69 6365 0a20 2020 2020 2020 2020 2020  lice.           
+00004b50: 2073 6c63 203d 205f 6361 6c63 5f61 7869   slc = _calc_axi
+00004b60: 735f 736c 6963 6528 6e73 706c 6974 2c20  s_slice(nsplit, 
+00004b70: 696e 6465 7829 0a20 2020 2020 2020 2020  index).         
+00004b80: 2020 2070 645f 696e 6465 7820 3d20 7469     pd_index = ti
+00004b90: 6c65 6162 6c65 5f63 6f6c 756d 6e73 5f76  leable_columns_v
+00004ba0: 616c 7565 2e74 6f5f 7061 6e64 6173 2829  alue.to_pandas()
+00004bb0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
+00004bc0: 6e6b 5f70 645f 696e 6465 7820 3d20 280a  nk_pd_index = (.
+00004bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004be0: 7064 5f69 6e64 6578 5b3a 305d 2069 6620  pd_index[:0] if 
+00004bf0: 6e70 2e69 736e 616e 2873 6c63 2e73 746f  np.isnan(slc.sto
+00004c00: 7020 2d20 736c 632e 7374 6172 7429 2065  p - slc.start) e
+00004c10: 6c73 6520 7064 5f69 6e64 6578 5b73 6c63  lse pd_index[slc
+00004c20: 5d0a 2020 2020 2020 2020 2020 2020 290a  ].            ).
+00004c30: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+00004c40: 6d6e 735f 7661 6c75 6520 3d20 7061 7273  mns_value = pars
+00004c50: 655f 696e 6465 7828 6368 756e 6b5f 7064  e_index(chunk_pd
+00004c60: 5f69 6e64 6578 2c20 7374 6f72 655f 6461  _index, store_da
+00004c70: 7461 3d54 7275 6529 0a20 2020 2020 2020  ta=True).       
+00004c80: 2020 2020 2063 6163 6865 5b74 696c 6561       cache[tilea
+00004c90: 626c 655f 6b65 792c 2069 6e64 6578 5d20  ble_key, index] 
+00004ca0: 3d20 636f 6c75 6d6e 735f 7661 6c75 650a  = columns_value.
+00004cb0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00004cc0: 726e 2063 6f6c 756d 6e73 5f76 616c 7565  rn columns_value
+00004cd0: 0a0a 2020 2020 6465 6620 5f5f 6765 745f  ..    def __get_
+00004ce0: 5f28 7365 6c66 2c20 696e 7374 616e 6365  _(self, instance
+00004cf0: 2c20 6f77 6e65 723d 4e6f 6e65 293a 0a20  , owner=None):. 
+00004d00: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00004d10: 7375 6263 6c61 7373 286f 776e 6572 2c20  subclass(owner, 
+00004d20: 4c61 7a79 4d65 7461 4368 756e 6b44 6174  LazyMetaChunkDat
+00004d30: 6129 3a20 2023 2070 7261 676d 613a 206e  a):  # pragma: n
+00004d40: 6f20 636f 7665 720a 2020 2020 2020 2020  o cover.        
+00004d50: 2020 2020 7265 7475 726e 2073 7570 6572      return super
+00004d60: 2829 2e5f 5f67 6574 5f5f 2869 6e73 7461  ().__get__(insta
+00004d70: 6e63 652c 206f 776e 6572 290a 0a20 2020  nce, owner)..   
+00004d80: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00004d90: 2020 2020 2020 7661 6c75 6520 3d20 7365        value = se
+00004da0: 6c66 2e67 6574 2869 6e73 7461 6e63 652c  lf.get(instance,
+00004db0: 206f 776e 6572 290a 2020 2020 2020 2020   owner).        
+00004dc0: 2020 2020 6966 2076 616c 7565 2069 7320      if value is 
+00004dd0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00004de0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00004df0: 2076 616c 7565 0a20 2020 2020 2020 2065   value.        e
+00004e00: 7863 6570 7420 4174 7472 6962 7574 6545  xcept AttributeE
+00004e10: 7272 6f72 3a20 2023 2070 7261 676d 613a  rror:  # pragma:
+00004e20: 206e 6f20 636f 7665 720a 2020 2020 2020   no cover.      
+00004e30: 2020 2020 2020 7061 7373 0a0a 2020 2020        pass..    
+00004e40: 2020 2020 6966 2069 6e73 7461 6e63 652e      if instance.
+00004e50: 696e 6465 7820 6973 204e 6f6e 653a 0a20  index is None:. 
+00004e60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00004e70: 6e20 7375 7065 7228 292e 5f5f 6765 745f  n super().__get_
+00004e80: 5f28 696e 7374 616e 6365 2c20 6f77 6e65  _(instance, owne
+00004e90: 7229 0a0a 2020 2020 2020 2020 2320 6765  r)..        # ge
+00004ea0: 7420 636f 6c75 6d6e 735f 7661 6c75 6520  t columns_value 
+00004eb0: 6c61 7a69 6c79 0a20 2020 2020 2020 2069  lazily.        i
+00004ec0: 6e64 6578 203d 2069 6e73 7461 6e63 652e  ndex = instance.
+00004ed0: 696e 6465 785b 315d 0a20 2020 2020 2020  index[1].       
+00004ee0: 2063 6f6c 756d 6e73 5f76 616c 7565 203d   columns_value =
+00004ef0: 2073 656c 662e 5f67 656e 5f63 6875 6e6b   self._gen_chunk
+00004f00: 5f63 6f6c 756d 6e73 5f76 616c 7565 2869  _columns_value(i
+00004f10: 6e73 7461 6e63 652c 2069 6e64 6578 290a  nstance, index).
+00004f20: 2020 2020 2020 2020 2320 6361 6368 6520          # cache 
+00004f30: 636f 6c75 6d6e 735f 7661 6c75 650a 2020  columns_value.  
+00004f40: 2020 2020 2020 7365 6c66 2e73 6574 2869        self.set(i
+00004f50: 6e73 7461 6e63 652c 2063 6f6c 756d 6e73  nstance, columns
+00004f60: 5f76 616c 7565 290a 2020 2020 2020 2020  _value).        
+00004f70: 7265 7475 726e 2063 6f6c 756d 6e73 5f76  return columns_v
+00004f80: 616c 7565 0a0a 0a63 6c61 7373 2049 6e64  alue...class Ind
+00004f90: 6578 4368 756e 6b44 6174 6128 4368 756e  exChunkData(Chun
+00004fa0: 6b44 6174 6129 3a0a 2020 2020 5f5f 736c  kData):.    __sl
+00004fb0: 6f74 735f 5f20 3d20 2829 0a20 2020 2074  ots__ = ().    t
+00004fc0: 7970 655f 6e61 6d65 203d 2022 496e 6465  ype_name = "Inde
+00004fd0: 7822 0a0a 2020 2020 2320 7265 7175 6972  x"..    # requir
+00004fe0: 6564 2066 6965 6c64 730a 2020 2020 5f73  ed fields.    _s
+00004ff0: 6861 7065 203d 2054 7570 6c65 4669 656c  hape = TupleFiel
+00005000: 6428 0a20 2020 2020 2020 2022 7368 6170  d(.        "shap
+00005010: 6522 2c0a 2020 2020 2020 2020 4669 656c  e",.        Fiel
+00005020: 6454 7970 6573 2e69 6e74 3634 2c0a 2020  dTypes.int64,.  
+00005030: 2020 2020 2020 6f6e 5f73 6572 6961 6c69        on_seriali
+00005040: 7a65 3d6f 6e5f 7365 7269 616c 697a 655f  ze=on_serialize_
+00005050: 7368 6170 652c 0a20 2020 2020 2020 206f  shape,.        o
+00005060: 6e5f 6465 7365 7269 616c 697a 653d 6f6e  n_deserialize=on
+00005070: 5f64 6573 6572 6961 6c69 7a65 5f73 6861  _deserialize_sha
+00005080: 7065 2c0a 2020 2020 290a 2020 2020 2320  pe,.    ).    # 
+00005090: 6f70 7469 6f6e 616c 2066 6965 6c64 0a20  optional field. 
+000050a0: 2020 205f 6474 7970 6520 3d20 4461 7461     _dtype = Data
+000050b0: 5479 7065 4669 656c 6428 2264 7479 7065  TypeField("dtype
+000050c0: 2229 0a20 2020 205f 6e61 6d65 203d 2041  ").    _name = A
+000050d0: 6e79 4669 656c 6428 226e 616d 6522 290a  nyField("name").
+000050e0: 2020 2020 5f69 6e64 6578 5f76 616c 7565      _index_value
+000050f0: 203d 2052 6566 6572 656e 6365 4669 656c   = ReferenceFiel
+00005100: 6428 2269 6e64 6578 5f76 616c 7565 222c  d("index_value",
+00005110: 2049 6e64 6578 5661 6c75 6529 0a0a 2020   IndexValue)..  
+00005120: 2020 6465 6620 5f5f 696e 6974 5f5f 280a    def __init__(.
+00005130: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00005140: 2020 2020 2020 6f70 3d4e 6f6e 652c 0a20        op=None,. 
+00005150: 2020 2020 2020 2073 6861 7065 3d4e 6f6e         shape=Non
+00005160: 652c 0a20 2020 2020 2020 2069 6e64 6578  e,.        index
+00005170: 3d4e 6f6e 652c 0a20 2020 2020 2020 2064  =None,.        d
+00005180: 7479 7065 3d4e 6f6e 652c 0a20 2020 2020  type=None,.     
+00005190: 2020 206e 616d 653d 4e6f 6e65 2c0a 2020     name=None,.  
+000051a0: 2020 2020 2020 696e 6465 785f 7661 6c75        index_valu
+000051b0: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
+000051c0: 2a2a 6b77 2c0a 2020 2020 293a 0a20 2020  **kw,.    ):.   
+000051d0: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
+000051e0: 6e69 745f 5f28 0a20 2020 2020 2020 2020  nit__(.         
+000051f0: 2020 205f 6f70 3d6f 702c 0a20 2020 2020     _op=op,.     
+00005200: 2020 2020 2020 205f 7368 6170 653d 7368         _shape=sh
+00005210: 6170 652c 0a20 2020 2020 2020 2020 2020  ape,.           
+00005220: 205f 696e 6465 783d 696e 6465 782c 0a20   _index=index,. 
+00005230: 2020 2020 2020 2020 2020 205f 6474 7970             _dtyp
+00005240: 653d 6474 7970 652c 0a20 2020 2020 2020  e=dtype,.       
+00005250: 2020 2020 205f 6e61 6d65 3d6e 616d 652c       _name=name,
+00005260: 0a20 2020 2020 2020 2020 2020 205f 696e  .            _in
+00005270: 6465 785f 7661 6c75 653d 696e 6465 785f  dex_value=index_
+00005280: 7661 6c75 652c 0a20 2020 2020 2020 2020  value,.         
+00005290: 2020 202a 2a6b 772c 0a20 2020 2020 2020     **kw,.       
+000052a0: 2029 0a0a 2020 2020 4070 726f 7065 7274   )..    @propert
+000052b0: 790a 2020 2020 6465 6620 7061 7261 6d73  y.    def params
+000052c0: 2873 656c 6629 202d 3e20 4469 6374 5b73  (self) -> Dict[s
+000052d0: 7472 2c20 416e 795d 3a0a 2020 2020 2020  tr, Any]:.      
+000052e0: 2020 2320 7061 7261 6d73 2072 6574 7572    # params retur
+000052f0: 6e20 7468 6520 7072 6f70 6572 7469 6573  n the properties
+00005300: 2077 6869 6368 2075 7365 6675 6c20 746f   which useful to
+00005310: 2072 6562 7569 6c64 2061 206e 6577 2063   rebuild a new c
+00005320: 6875 6e6b 0a20 2020 2020 2020 2072 6574  hunk.        ret
+00005330: 7572 6e20 7b0a 2020 2020 2020 2020 2020  urn {.          
+00005340: 2020 2273 6861 7065 223a 2073 656c 662e    "shape": self.
+00005350: 7368 6170 652c 0a20 2020 2020 2020 2020  shape,.         
+00005360: 2020 2022 6474 7970 6522 3a20 7365 6c66     "dtype": self
+00005370: 2e64 7479 7065 2c0a 2020 2020 2020 2020  .dtype,.        
+00005380: 2020 2020 2269 6e64 6578 223a 2073 656c      "index": sel
+00005390: 662e 696e 6465 782c 0a20 2020 2020 2020  f.index,.       
+000053a0: 2020 2020 2022 696e 6465 785f 7661 6c75       "index_valu
+000053b0: 6522 3a20 7365 6c66 2e69 6e64 6578 5f76  e": self.index_v
+000053c0: 616c 7565 2c0a 2020 2020 2020 2020 2020  alue,.          
+000053d0: 2020 226e 616d 6522 3a20 7365 6c66 2e6e    "name": self.n
+000053e0: 616d 652c 0a20 2020 2020 2020 207d 0a0a  ame,.        }..
+000053f0: 2020 2020 4070 6172 616d 732e 7365 7474      @params.sett
+00005400: 6572 0a20 2020 2064 6566 2070 6172 616d  er.    def param
+00005410: 7328 7365 6c66 2c20 6e65 775f 7061 7261  s(self, new_para
+00005420: 6d73 3a20 4469 6374 5b73 7472 2c20 416e  ms: Dict[str, An
+00005430: 795d 293a 0a20 2020 2020 2020 2070 6172  y]):.        par
+00005440: 616d 7320 3d20 6e65 775f 7061 7261 6d73  ams = new_params
+00005450: 2e63 6f70 7928 290a 2020 2020 2020 2020  .copy().        
+00005460: 7061 7261 6d73 2e70 6f70 2822 696e 6465  params.pop("inde
+00005470: 7822 2c20 4e6f 6e65 2920 2023 2069 6e64  x", None)  # ind
+00005480: 6578 206e 6f74 206e 6565 6465 6420 746f  ex not needed to
+00005490: 2075 7064 6174 650a 2020 2020 2020 2020   update.        
+000054a0: 6e65 775f 7368 6170 6520 3d20 7061 7261  new_shape = para
+000054b0: 6d73 2e70 6f70 2822 7368 6170 6522 2c20  ms.pop("shape", 
+000054c0: 4e6f 6e65 290a 2020 2020 2020 2020 6966  None).        if
+000054d0: 206e 6577 5f73 6861 7065 2069 7320 6e6f   new_shape is no
+000054e0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+000054f0: 2020 2020 7365 6c66 2e5f 7368 6170 6520      self._shape 
+00005500: 3d20 6e65 775f 7368 6170 650a 2020 2020  = new_shape.    
+00005510: 2020 2020 6474 7970 6520 3d20 7061 7261      dtype = para
+00005520: 6d73 2e70 6f70 2822 6474 7970 6522 2c20  ms.pop("dtype", 
+00005530: 4e6f 6e65 290a 2020 2020 2020 2020 6966  None).        if
+00005540: 2064 7479 7065 2069 7320 6e6f 7420 4e6f   dtype is not No
+00005550: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00005560: 7365 6c66 2e5f 6474 7970 6520 3d20 6474  self._dtype = dt
+00005570: 7970 650a 2020 2020 2020 2020 696e 6465  ype.        inde
+00005580: 785f 7661 6c75 6520 3d20 7061 7261 6d73  x_value = params
+00005590: 2e70 6f70 2822 696e 6465 785f 7661 6c75  .pop("index_valu
+000055a0: 6522 2c20 4e6f 6e65 290a 2020 2020 2020  e", None).      
+000055b0: 2020 6966 2069 6e64 6578 5f76 616c 7565    if index_value
+000055c0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000055d0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000055e0: 696e 6465 785f 7661 6c75 6520 3d20 696e  index_value = in
+000055f0: 6465 785f 7661 6c75 650a 2020 2020 2020  dex_value.      
+00005600: 2020 6e61 6d65 203d 2070 6172 616d 732e    name = params.
+00005610: 706f 7028 226e 616d 6522 2c20 4e6f 6e65  pop("name", None
+00005620: 290a 2020 2020 2020 2020 6966 206e 616d  ).        if nam
+00005630: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+00005640: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005650: 5f6e 616d 6520 3d20 6e61 6d65 0a20 2020  _name = name.   
+00005660: 2020 2020 2069 6620 7061 7261 6d73 3a20       if params: 
+00005670: 2023 2070 7261 676d 613a 206e 6f20 636f   # pragma: no co
+00005680: 7665 720a 2020 2020 2020 2020 2020 2020  ver.            
+00005690: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+000056a0: 6622 556e 6b6e 6f77 6e20 7061 7261 6d73  f"Unknown params
+000056b0: 3a20 7b6c 6973 7428 7061 7261 6d73 297d  : {list(params)}
+000056c0: 2229 0a0a 2020 2020 4063 6c61 7373 6d65  ")..    @classme
+000056d0: 7468 6f64 0a20 2020 2064 6566 2067 6574  thod.    def get
+000056e0: 5f70 6172 616d 735f 6672 6f6d 5f64 6174  _params_from_dat
+000056f0: 6128 0a20 2020 2020 2020 2063 6c73 2c20  a(.        cls, 
+00005700: 6461 7461 3a20 2255 6e69 6f6e 5b70 642e  data: "Union[pd.
+00005710: 496e 6465 782c 2063 7564 662e 636f 7265  Index, cudf.core
+00005720: 2e69 6e64 6578 2e42 6173 6549 6e64 6578  .index.BaseIndex
+00005730: 5d22 0a20 2020 2029 202d 3e20 4469 6374  ]".    ) -> Dict
+00005740: 5b73 7472 2c20 416e 795d 3a0a 2020 2020  [str, Any]:.    
+00005750: 2020 2020 2320 6375 6466 206d 756c 7469      # cudf multi
+00005760: 2069 6e64 6578 2064 6f65 736e 2774 2068   index doesn't h
+00005770: 6176 6520 6174 7472 6962 7574 6520 2764  ave attribute 'd
+00005780: 7479 7065 272e 0a20 2020 2020 2020 2064  type'..        d
+00005790: 7479 7065 203d 2067 6574 6174 7472 2864  type = getattr(d
+000057a0: 6174 612c 2022 6474 7970 6522 2c20 6e70  ata, "dtype", np
+000057b0: 2e64 7479 7065 286f 626a 6563 7429 290a  .dtype(object)).
+000057c0: 2020 2020 2020 2020 7265 7475 726e 207b          return {
+000057d0: 0a20 2020 2020 2020 2020 2020 2022 7368  .            "sh
+000057e0: 6170 6522 3a20 6461 7461 2e73 6861 7065  ape": data.shape
+000057f0: 2c0a 2020 2020 2020 2020 2020 2020 2264  ,.            "d
+00005800: 7479 7065 223a 2064 7479 7065 2c0a 2020  type": dtype,.  
+00005810: 2020 2020 2020 2020 2020 2269 6e64 6578            "index
+00005820: 5f76 616c 7565 223a 2070 6172 7365 5f69  _value": parse_i
+00005830: 6e64 6578 2864 6174 612c 2073 746f 7265  ndex(data, store
+00005840: 5f64 6174 613d 4661 6c73 6529 2c0a 2020  _data=False),.  
+00005850: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+00005860: 3a20 6461 7461 2e6e 616d 652c 0a20 2020  : data.name,.   
+00005870: 2020 2020 207d 0a0a 2020 2020 4070 726f       }..    @pro
+00005880: 7065 7274 790a 2020 2020 6465 6620 7368  perty.    def sh
+00005890: 6170 6528 7365 6c66 293a 0a20 2020 2020  ape(self):.     
+000058a0: 2020 2072 6574 7572 6e20 6765 7461 7474     return getatt
+000058b0: 7228 7365 6c66 2c20 225f 7368 6170 6522  r(self, "_shape"
+000058c0: 2c20 4e6f 6e65 290a 0a20 2020 2040 7072  , None)..    @pr
+000058d0: 6f70 6572 7479 0a20 2020 2064 6566 206e  operty.    def n
+000058e0: 6469 6d28 7365 6c66 293a 0a20 2020 2020  dim(self):.     
+000058f0: 2020 2072 6574 7572 6e20 6c65 6e28 7365     return len(se
+00005900: 6c66 2e73 6861 7065 290a 0a20 2020 2040  lf.shape)..    @
+00005910: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00005920: 2064 7479 7065 2873 656c 6629 3a0a 2020   dtype(self):.  
+00005930: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00005940: 662e 5f64 7479 7065 0a0a 2020 2020 4070  f._dtype..    @p
+00005950: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00005960: 6e61 6d65 2873 656c 6629 3a0a 2020 2020  name(self):.    
+00005970: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00005980: 5f6e 616d 650a 0a20 2020 2040 7072 6f70  _name..    @prop
+00005990: 6572 7479 0a20 2020 2064 6566 2069 6e64  erty.    def ind
+000059a0: 6578 5f76 616c 7565 2873 656c 6629 3a0a  ex_value(self):.
+000059b0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000059c0: 656c 662e 5f69 6e64 6578 5f76 616c 7565  elf._index_value
+000059d0: 0a0a 0a63 6c61 7373 2049 6e64 6578 4368  ...class IndexCh
+000059e0: 756e 6b28 4368 756e 6b29 3a0a 2020 2020  unk(Chunk):.    
+000059f0: 5f5f 736c 6f74 735f 5f20 3d20 2829 0a20  __slots__ = (). 
+00005a00: 2020 205f 616c 6c6f 775f 6461 7461 5f74     _allow_data_t
+00005a10: 7970 655f 203d 2028 496e 6465 7843 6875  ype_ = (IndexChu
+00005a20: 6e6b 4461 7461 2c29 0a20 2020 2074 7970  nkData,).    typ
+00005a30: 655f 6e61 6d65 203d 2022 496e 6465 7822  e_name = "Index"
+00005a40: 0a0a 0a64 6566 205f 6f6e 5f64 6573 6572  ...def _on_deser
+00005a50: 6961 6c69 7a65 5f69 6e64 6578 5f76 616c  ialize_index_val
+00005a60: 7565 2869 6e64 6578 5f76 616c 7565 293a  ue(index_value):
+00005a70: 0a20 2020 2069 6620 696e 6465 785f 7661  .    if index_va
+00005a80: 6c75 6520 6973 204e 6f6e 653a 0a20 2020  lue is None:.   
+00005a90: 2020 2020 2072 6574 7572 6e0a 2020 2020       return.    
+00005aa0: 7472 793a 0a20 2020 2020 2020 2067 6574  try:.        get
+00005ab0: 6174 7472 2869 6e64 6578 5f76 616c 7565  attr(index_value
+00005ac0: 2c20 2276 616c 7565 2229 0a20 2020 2020  , "value").     
+00005ad0: 2020 2072 6574 7572 6e20 696e 6465 785f     return index_
+00005ae0: 7661 6c75 650a 2020 2020 6578 6365 7074  value.    except
+00005af0: 2041 7474 7269 6275 7465 4572 726f 723a   AttributeError:
+00005b00: 0a20 2020 2020 2020 2072 6574 7572 6e0a  .        return.
+00005b10: 0a0a 636c 6173 7320 5f54 6f50 616e 6461  ..class _ToPanda
+00005b20: 734d 6978 696e 285f 4578 6563 7574 6541  sMixin(_ExecuteA
+00005b30: 6e64 4665 7463 684d 6978 696e 293a 0a20  ndFetchMixin):. 
+00005b40: 2020 205f 5f73 6c6f 7473 5f5f 203d 2028     __slots__ = (
+00005b50: 290a 0a20 2020 2064 6566 2074 6f5f 7061  )..    def to_pa
+00005b60: 6e64 6173 2873 656c 662c 2073 6573 7369  ndas(self, sessi
+00005b70: 6f6e 3d4e 6f6e 652c 202a 2a6b 7729 3a0a  on=None, **kw):.
+00005b80: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00005b90: 656c 662e 5f65 7865 6375 7465 5f61 6e64  elf._execute_and
+00005ba0: 5f66 6574 6368 2873 6573 7369 6f6e 3d73  _fetch(session=s
+00005bb0: 6573 7369 6f6e 2c20 2a2a 6b77 290a 0a0a  ession, **kw)...
+00005bc0: 636c 6173 7320 5f42 6174 6368 6564 4665  class _BatchedFe
+00005bd0: 7463 6865 723a 0a20 2020 205f 5f73 6c6f  tcher:.    __slo
+00005be0: 7473 5f5f 203d 2028 290a 0a20 2020 2064  ts__ = ()..    d
+00005bf0: 6566 205f 6974 6572 2873 656c 662c 2062  ef _iter(self, b
+00005c00: 6174 6368 5f73 697a 653d 4e6f 6e65 2c20  atch_size=None, 
+00005c10: 7365 7373 696f 6e3d 4e6f 6e65 2c20 2a2a  session=None, **
+00005c20: 6b77 293a 0a20 2020 2020 2020 2066 726f  kw):.        fro
+00005c30: 6d20 2e69 6e64 6578 696e 672e 696c 6f63  m .indexing.iloc
+00005c40: 2069 6d70 6f72 7420 696c 6f63 0a0a 2020   import iloc..  
+00005c50: 2020 2020 2020 6966 2062 6174 6368 5f73        if batch_s
+00005c60: 697a 6520 6973 206e 6f74 204e 6f6e 653a  ize is not None:
+00005c70: 0a20 2020 2020 2020 2020 2020 2073 697a  .            siz
+00005c80: 6520 3d20 7365 6c66 2e73 6861 7065 5b30  e = self.shape[0
+00005c90: 5d0a 2020 2020 2020 2020 2020 2020 6e5f  ].            n_
+00005ca0: 6261 7463 6820 3d20 6365 696c 6469 7628  batch = ceildiv(
+00005cb0: 7369 7a65 2c20 6261 7463 685f 7369 7a65  size, batch_size
+00005cc0: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00005cd0: 6620 6e5f 6261 7463 6820 3e20 313a 0a20  f n_batch > 1:. 
+00005ce0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00005cf0: 6f72 2069 2069 6e20 7261 6e67 6528 6e5f  or i in range(n_
+00005d00: 6261 7463 6829 3a0a 2020 2020 2020 2020  batch):.        
+00005d10: 2020 2020 2020 2020 2020 2020 6261 7463              batc
+00005d20: 685f 6461 7461 203d 2069 6c6f 6328 7365  h_data = iloc(se
+00005d30: 6c66 295b 6261 7463 685f 7369 7a65 202a  lf)[batch_size *
+00005d40: 2069 203a 2062 6174 6368 5f73 697a 6520   i : batch_size 
+00005d50: 2a20 2869 202b 2031 295d 0a20 2020 2020  * (i + 1)].     
+00005d60: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00005d70: 6965 6c64 2062 6174 6368 5f64 6174 612e  ield batch_data.
+00005d80: 5f66 6574 6368 2873 6573 7369 6f6e 3d73  _fetch(session=s
+00005d90: 6573 7369 6f6e 2c20 2a2a 6b77 290a 2020  ession, **kw).  
+00005da0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00005db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005dc0: 7969 656c 6420 7365 6c66 2e5f 6665 7463  yield self._fetc
+00005dd0: 6828 7365 7373 696f 6e3d 7365 7373 696f  h(session=sessio
+00005de0: 6e2c 202a 2a6b 7729 0a20 2020 2020 2020  n, **kw).       
+00005df0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00005e00: 2020 2023 2069 6620 6261 7463 685f 7369     # if batch_si
+00005e10: 7a65 2069 7320 6e6f 7420 7370 6563 6966  ze is not specif
+00005e20: 6965 642c 2075 7365 2066 6972 7374 2062  ied, use first b
+00005e30: 6174 6368 2074 6f20 6573 7469 6d61 7465  atch to estimate
+00005e40: 0a20 2020 2020 2020 2020 2020 2023 2062  .            # b
+00005e50: 6174 6368 5f73 697a 652e 0a20 2020 2020  atch_size..     
+00005e60: 2020 2020 2020 2064 6566 6175 6c74 5f62         default_b
+00005e70: 6174 6368 5f62 7974 6573 203d 2035 3020  atch_bytes = 50 
+00005e80: 2a20 3130 3234 2a2a 320a 2020 2020 2020  * 1024**2.      
+00005e90: 2020 2020 2020 6669 7273 745f 6261 7463        first_batc
+00005ea0: 6820 3d20 3130 3030 0a20 2020 2020 2020  h = 1000.       
+00005eb0: 2020 2020 2073 697a 6520 3d20 7365 6c66       size = self
+00005ec0: 2e73 6861 7065 5b30 5d0a 0a20 2020 2020  .shape[0]..     
+00005ed0: 2020 2020 2020 2069 6620 7369 7a65 203e         if size >
+00005ee0: 3d20 6669 7273 745f 6261 7463 683a 0a20  = first_batch:. 
+00005ef0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00005f00: 6174 6368 5f64 6174 6120 3d20 696c 6f63  atch_data = iloc
+00005f10: 2873 656c 6629 5b3a 6669 7273 745f 6261  (self)[:first_ba
+00005f20: 7463 685d 0a20 2020 2020 2020 2020 2020  tch].           
+00005f30: 2020 2020 2066 6972 7374 5f62 6174 6368       first_batch
+00005f40: 5f64 6174 6120 3d20 6261 7463 685f 6461  _data = batch_da
+00005f50: 7461 2e5f 6665 7463 6828 7365 7373 696f  ta._fetch(sessio
+00005f60: 6e3d 7365 7373 696f 6e2c 202a 2a6b 7729  n=session, **kw)
+00005f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005f80: 2079 6965 6c64 2066 6972 7374 5f62 6174   yield first_bat
+00005f90: 6368 5f64 6174 610a 2020 2020 2020 2020  ch_data.        
+00005fa0: 2020 2020 2020 2020 6461 7461 5f73 697a          data_siz
+00005fb0: 6520 3d20 6573 7469 6d61 7465 5f70 616e  e = estimate_pan
+00005fc0: 6461 735f 7369 7a65 2866 6972 7374 5f62  das_size(first_b
+00005fd0: 6174 6368 5f64 6174 6129 0a20 2020 2020  atch_data).     
+00005fe0: 2020 2020 2020 2020 2020 2062 6174 6368             batch
+00005ff0: 5f73 697a 6520 3d20 696e 7428 6465 6661  _size = int(defa
+00006000: 756c 745f 6261 7463 685f 6279 7465 7320  ult_batch_bytes 
+00006010: 2f20 6461 7461 5f73 697a 6520 2a20 6669  / data_size * fi
+00006020: 7273 745f 6261 7463 6829 0a20 2020 2020  rst_batch).     
+00006030: 2020 2020 2020 2020 2020 206e 5f62 6174             n_bat
+00006040: 6368 203d 2063 6569 6c64 6976 2873 697a  ch = ceildiv(siz
+00006050: 6520 2d20 3130 3030 2c20 6261 7463 685f  e - 1000, batch_
+00006060: 7369 7a65 290a 2020 2020 2020 2020 2020  size).          
+00006070: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00006080: 616e 6765 286e 5f62 6174 6368 293a 0a20  ange(n_batch):. 
+00006090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000060a0: 2020 2062 6174 6368 5f64 6174 6120 3d20     batch_data = 
+000060b0: 696c 6f63 2873 656c 6629 5b0a 2020 2020  iloc(self)[.    
+000060c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000060d0: 2020 2020 6669 7273 745f 6261 7463 680a      first_batch.
+000060e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000060f0: 2020 2020 2020 2020 2b20 6261 7463 685f          + batch_
+00006100: 7369 7a65 202a 2069 203a 2066 6972 7374  size * i : first
+00006110: 5f62 6174 6368 0a20 2020 2020 2020 2020  _batch.         
+00006120: 2020 2020 2020 2020 2020 2020 2020 202b                 +
+00006130: 2062 6174 6368 5f73 697a 6520 2a20 2869   batch_size * (i
+00006140: 202b 2031 290a 2020 2020 2020 2020 2020   + 1).          
+00006150: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
+00006160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006170: 7969 656c 6420 6261 7463 685f 6461 7461  yield batch_data
+00006180: 2e5f 6665 7463 6828 7365 7373 696f 6e3d  ._fetch(session=
+00006190: 7365 7373 696f 6e2c 202a 2a6b 7729 0a20  session, **kw). 
+000061a0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000061b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000061c0: 2079 6965 6c64 2073 656c 662e 5f66 6574   yield self._fet
+000061d0: 6368 2873 6573 7369 6f6e 3d73 6573 7369  ch(session=sessi
+000061e0: 6f6e 2c20 2a2a 6b77 290a 0a20 2020 2064  on, **kw)..    d
+000061f0: 6566 2069 7465 7262 6174 6368 2873 656c  ef iterbatch(sel
+00006200: 662c 2062 6174 6368 5f73 697a 653d 4e6f  f, batch_size=No
+00006210: 6e65 2c20 7365 7373 696f 6e3d 4e6f 6e65  ne, session=None
+00006220: 2c20 2a2a 6b77 293a 0a20 2020 2020 2020  , **kw):.       
+00006230: 2023 2074 7269 6767 6572 2065 7865 6375   # trigger execu
+00006240: 7469 6f6e 0a20 2020 2020 2020 2073 656c  tion.        sel
+00006250: 662e 6578 6563 7574 6528 7365 7373 696f  f.execute(sessio
+00006260: 6e3d 7365 7373 696f 6e2c 202a 2a6b 7729  n=session, **kw)
+00006270: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00006280: 7365 6c66 2e5f 6974 6572 2862 6174 6368  self._iter(batch
+00006290: 5f73 697a 653d 6261 7463 685f 7369 7a65  _size=batch_size
+000062a0: 2c20 7365 7373 696f 6e3d 7365 7373 696f  , session=sessio
+000062b0: 6e29 0a0a 2020 2020 6465 6620 6665 7463  n)..    def fetc
+000062c0: 6828 7365 6c66 2c20 7365 7373 696f 6e3d  h(self, session=
+000062d0: 4e6f 6e65 2c20 2a2a 6b77 293a 0a20 2020  None, **kw):.   
+000062e0: 2020 2020 2066 726f 6d20 2e69 6e64 6578       from .index
+000062f0: 696e 672e 696c 6f63 2069 6d70 6f72 7420  ing.iloc import 
+00006300: 4461 7461 4672 616d 6549 6c6f 6347 6574  DataFrameIlocGet
+00006310: 4974 656d 2c20 5365 7269 6573 496c 6f63  Item, SeriesIloc
+00006320: 4765 7449 7465 6d0a 0a20 2020 2020 2020  GetItem..       
+00006330: 2062 6174 6368 5f73 697a 6520 3d20 6b77   batch_size = kw
+00006340: 2e70 6f70 2822 6261 7463 685f 7369 7a65  .pop("batch_size
+00006350: 222c 204e 6f6e 6529 0a20 2020 2020 2020  ", None).       
+00006360: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
+00006370: 656c 662e 6f70 2c20 2844 6174 6146 7261  elf.op, (DataFra
+00006380: 6d65 496c 6f63 4765 7449 7465 6d2c 2053  meIlocGetItem, S
+00006390: 6572 6965 7349 6c6f 6347 6574 4974 656d  eriesIlocGetItem
+000063a0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+000063b0: 2320 7365 6520 4748 2331 3837 310a 2020  # see GH#1871.  
+000063c0: 2020 2020 2020 2020 2020 2320 616c 7265            # alre
+000063d0: 6164 7920 696c 6f63 2c20 646f 206e 6f74  ady iloc, do not
+000063e0: 2074 7269 6767 6572 2062 6174 6368 2066   trigger batch f
+000063f0: 6574 6368 0a20 2020 2020 2020 2020 2020  etch.           
+00006400: 2072 6574 7572 6e20 7365 6c66 2e5f 6665   return self._fe
+00006410: 7463 6828 7365 7373 696f 6e3d 7365 7373  tch(session=sess
+00006420: 696f 6e2c 202a 2a6b 7729 0a20 2020 2020  ion, **kw).     
+00006430: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00006440: 2020 2020 2062 6174 6368 6573 203d 206c       batches = l
+00006450: 6973 7428 7365 6c66 2e5f 6974 6572 2862  ist(self._iter(b
+00006460: 6174 6368 5f73 697a 653d 6261 7463 685f  atch_size=batch_
+00006470: 7369 7a65 2c20 7365 7373 696f 6e3d 7365  size, session=se
+00006480: 7373 696f 6e2c 202a 2a6b 7729 290a 2020  ssion, **kw)).  
+00006490: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000064a0: 2070 642e 636f 6e63 6174 2862 6174 6368   pd.concat(batch
+000064b0: 6573 2920 6966 206c 656e 2862 6174 6368  es) if len(batch
+000064c0: 6573 2920 3e20 3120 656c 7365 2062 6174  es) > 1 else bat
+000064d0: 6368 6573 5b30 5d0a 0a20 2020 2064 6566  ches[0]..    def
+000064e0: 2066 6574 6368 5f69 6e66 6f73 2873 656c   fetch_infos(sel
+000064f0: 662c 2066 6965 6c64 733d 4e6f 6e65 2c20  f, fields=None, 
+00006500: 7365 7373 696f 6e3d 4e6f 6e65 2c20 2a2a  session=None, **
+00006510: 6b77 293a 0a20 2020 2020 2020 2072 6574  kw):.        ret
+00006520: 7572 6e20 7365 6c66 2e5f 6665 7463 685f  urn self._fetch_
+00006530: 696e 666f 7328 6669 656c 6473 3d66 6965  infos(fields=fie
+00006540: 6c64 732c 2073 6573 7369 6f6e 3d73 6573  lds, session=ses
+00006550: 7369 6f6e 2c20 2a2a 6b77 290a 0a0a 636c  sion, **kw)...cl
+00006560: 6173 7320 496e 6465 7844 6174 6128 4861  ass IndexData(Ha
+00006570: 7353 6861 7065 5469 6c65 6162 6c65 4461  sShapeTileableDa
+00006580: 7461 2c20 5f54 6f50 616e 6461 734d 6978  ta, _ToPandasMix
+00006590: 696e 293a 0a20 2020 205f 5f73 6c6f 7473  in):.    __slots
+000065a0: 5f5f 203d 2028 290a 2020 2020 7479 7065  __ = ().    type
+000065b0: 5f6e 616d 6520 3d20 2249 6e64 6578 220a  _name = "Index".
+000065c0: 0a20 2020 2023 206f 7074 696f 6e61 6c20  .    # optional 
+000065d0: 6669 656c 640a 2020 2020 5f64 7479 7065  field.    _dtype
+000065e0: 203d 2044 6174 6154 7970 6546 6965 6c64   = DataTypeField
+000065f0: 2822 6474 7970 6522 290a 2020 2020 5f6e  ("dtype").    _n
+00006600: 616d 6520 3d20 416e 7946 6965 6c64 2822  ame = AnyField("
+00006610: 6e61 6d65 2229 0a20 2020 205f 6e61 6d65  name").    _name
+00006620: 7320 3d20 416e 7946 6965 6c64 2822 6e61  s = AnyField("na
+00006630: 6d65 7322 290a 2020 2020 5f69 6e64 6578  mes").    _index
+00006640: 5f76 616c 7565 203d 2052 6566 6572 656e  _value = Referen
+00006650: 6365 4669 656c 6428 0a20 2020 2020 2020  ceField(.       
+00006660: 2022 696e 6465 785f 7661 6c75 6522 2c20   "index_value", 
+00006670: 496e 6465 7856 616c 7565 2c20 6f6e 5f64  IndexValue, on_d
+00006680: 6573 6572 6961 6c69 7a65 3d5f 6f6e 5f64  eserialize=_on_d
+00006690: 6573 6572 6961 6c69 7a65 5f69 6e64 6578  eserialize_index
+000066a0: 5f76 616c 7565 0a20 2020 2029 0a20 2020  _value.    ).   
+000066b0: 205f 6368 756e 6b73 203d 204c 6973 7446   _chunks = ListF
+000066c0: 6965 6c64 280a 2020 2020 2020 2020 2263  ield(.        "c
+000066d0: 6875 6e6b 7322 2c0a 2020 2020 2020 2020  hunks",.        
+000066e0: 4669 656c 6454 7970 6573 2e72 6566 6572  FieldTypes.refer
+000066f0: 656e 6365 2849 6e64 6578 4368 756e 6b44  ence(IndexChunkD
+00006700: 6174 6129 2c0a 2020 2020 2020 2020 6f6e  ata),.        on
+00006710: 5f73 6572 6961 6c69 7a65 3d6c 616d 6264  _serialize=lambd
+00006720: 6120 783a 205b 6974 2e64 6174 6120 666f  a x: [it.data fo
+00006730: 7220 6974 2069 6e20 785d 2069 6620 7820  r it in x] if x 
+00006740: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
+00006750: 2078 2c0a 2020 2020 2020 2020 6f6e 5f64   x,.        on_d
+00006760: 6573 6572 6961 6c69 7a65 3d6c 616d 6264  eserialize=lambd
+00006770: 6120 783a 205b 496e 6465 7843 6875 6e6b  a x: [IndexChunk
+00006780: 2869 7429 2066 6f72 2069 7420 696e 2078  (it) for it in x
+00006790: 5d20 6966 2078 2069 7320 6e6f 7420 4e6f  ] if x is not No
+000067a0: 6e65 2065 6c73 6520 782c 0a20 2020 2029  ne else x,.    )
+000067b0: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+000067c0: 5f5f 280a 2020 2020 2020 2020 7365 6c66  __(.        self
+000067d0: 2c0a 2020 2020 2020 2020 6f70 3d4e 6f6e  ,.        op=Non
+000067e0: 652c 0a20 2020 2020 2020 2073 6861 7065  e,.        shape
+000067f0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
+00006800: 7370 6c69 7473 3d4e 6f6e 652c 0a20 2020  splits=None,.   
+00006810: 2020 2020 2064 7479 7065 3d4e 6f6e 652c       dtype=None,
+00006820: 0a20 2020 2020 2020 206e 616d 653d 4e6f  .        name=No
+00006830: 6e65 2c0a 2020 2020 2020 2020 6e61 6d65  ne,.        name
+00006840: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+00006850: 696e 6465 785f 7661 6c75 653d 4e6f 6e65  index_value=None
+00006860: 2c0a 2020 2020 2020 2020 6368 756e 6b73  ,.        chunks
+00006870: 3d4e 6f6e 652c 0a20 2020 2020 2020 202a  =None,.        *
+00006880: 2a6b 772c 0a20 2020 2029 3a0a 2020 2020  *kw,.    ):.    
+00006890: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
+000068a0: 6974 5f5f 280a 2020 2020 2020 2020 2020  it__(.          
+000068b0: 2020 5f6f 703d 6f70 2c0a 2020 2020 2020    _op=op,.      
+000068c0: 2020 2020 2020 5f73 6861 7065 3d73 6861        _shape=sha
+000068d0: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+000068e0: 5f6e 7370 6c69 7473 3d6e 7370 6c69 7473  _nsplits=nsplits
+000068f0: 2c0a 2020 2020 2020 2020 2020 2020 5f64  ,.            _d
+00006900: 7479 7065 3d64 7479 7065 2c0a 2020 2020  type=dtype,.    
+00006910: 2020 2020 2020 2020 5f6e 616d 653d 6e61          _name=na
+00006920: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+00006930: 5f6e 616d 6573 3d6e 616d 6573 2c0a 2020  _names=names,.  
+00006940: 2020 2020 2020 2020 2020 5f69 6e64 6578            _index
+00006950: 5f76 616c 7565 3d69 6e64 6578 5f76 616c  _value=index_val
+00006960: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+00006970: 5f63 6875 6e6b 733d 6368 756e 6b73 2c0a  _chunks=chunks,.
+00006980: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
+00006990: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+000069a0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000069b0: 6566 2070 6172 616d 7328 7365 6c66 2920  ef params(self) 
+000069c0: 2d3e 2044 6963 745b 7374 722c 2041 6e79  -> Dict[str, Any
+000069d0: 5d3a 0a20 2020 2020 2020 2023 2070 6172  ]:.        # par
+000069e0: 616d 7320 7265 7475 726e 2074 6865 2070  ams return the p
+000069f0: 726f 7065 7274 6965 7320 7768 6963 6820  roperties which 
+00006a00: 7573 6566 756c 2074 6f20 7265 6275 696c  useful to rebuil
+00006a10: 6420 6120 6e65 7720 7469 6c65 6162 6c65  d a new tileable
+00006a20: 206f 626a 6563 740a 2020 2020 2020 2020   object.        
+00006a30: 7265 7475 726e 207b 0a20 2020 2020 2020  return {.       
+00006a40: 2020 2020 2022 7368 6170 6522 3a20 7365       "shape": se
+00006a50: 6c66 2e73 6861 7065 2c0a 2020 2020 2020  lf.shape,.      
+00006a60: 2020 2020 2020 2264 7479 7065 223a 2073        "dtype": s
+00006a70: 656c 662e 6474 7970 652c 0a20 2020 2020  elf.dtype,.     
+00006a80: 2020 2020 2020 2022 6e61 6d65 223a 2073         "name": s
+00006a90: 656c 662e 6e61 6d65 2c0a 2020 2020 2020  elf.name,.      
+00006aa0: 2020 2020 2020 2269 6e64 6578 5f76 616c        "index_val
+00006ab0: 7565 223a 2073 656c 662e 696e 6465 785f  ue": self.index_
+00006ac0: 7661 6c75 652c 0a20 2020 2020 2020 207d  value,.        }
+00006ad0: 0a0a 2020 2020 4070 6172 616d 732e 7365  ..    @params.se
+00006ae0: 7474 6572 0a20 2020 2064 6566 2070 6172  tter.    def par
+00006af0: 616d 7328 7365 6c66 2c20 6e65 775f 7061  ams(self, new_pa
+00006b00: 7261 6d73 3a20 4469 6374 5b73 7472 2c20  rams: Dict[str, 
+00006b10: 416e 795d 293a 0a20 2020 2020 2020 2070  Any]):.        p
+00006b20: 6172 616d 7320 3d20 6e65 775f 7061 7261  arams = new_para
+00006b30: 6d73 2e63 6f70 7928 290a 2020 2020 2020  ms.copy().      
+00006b40: 2020 6e65 775f 7368 6170 6520 3d20 7061    new_shape = pa
+00006b50: 7261 6d73 2e70 6f70 2822 7368 6170 6522  rams.pop("shape"
+00006b60: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+00006b70: 6966 206e 6577 5f73 6861 7065 2069 7320  if new_shape is 
+00006b80: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00006b90: 2020 2020 2020 7365 6c66 2e5f 7368 6170        self._shap
+00006ba0: 6520 3d20 6e65 775f 7368 6170 650a 2020  e = new_shape.  
+00006bb0: 2020 2020 2020 6474 7970 6520 3d20 7061        dtype = pa
+00006bc0: 7261 6d73 2e70 6f70 2822 6474 7970 6522  rams.pop("dtype"
+00006bd0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+00006be0: 6966 2064 7479 7065 2069 7320 6e6f 7420  if dtype is not 
+00006bf0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00006c00: 2020 7365 6c66 2e5f 6474 7970 6520 3d20    self._dtype = 
+00006c10: 6474 7970 650a 2020 2020 2020 2020 696e  dtype.        in
+00006c20: 6465 785f 7661 6c75 6520 3d20 7061 7261  dex_value = para
+00006c30: 6d73 2e70 6f70 2822 696e 6465 785f 7661  ms.pop("index_va
+00006c40: 6c75 6522 2c20 4e6f 6e65 290a 2020 2020  lue", None).    
+00006c50: 2020 2020 6966 2069 6e64 6578 5f76 616c      if index_val
+00006c60: 7565 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ue is not None:.
+00006c70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00006c80: 2e5f 696e 6465 785f 7661 6c75 6520 3d20  ._index_value = 
+00006c90: 696e 6465 785f 7661 6c75 650a 2020 2020  index_value.    
+00006ca0: 2020 2020 6e61 6d65 203d 2070 6172 616d      name = param
+00006cb0: 732e 706f 7028 226e 616d 6522 2c20 4e6f  s.pop("name", No
+00006cc0: 6e65 290a 2020 2020 2020 2020 6966 206e  ne).        if n
+00006cd0: 616d 6520 6973 206e 6f74 204e 6f6e 653a  ame is not None:
+00006ce0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00006cf0: 662e 5f6e 616d 6520 3d20 6e61 6d65 0a20  f._name = name. 
+00006d00: 2020 2020 2020 2069 6620 7061 7261 6d73         if params
+00006d10: 3a20 2023 2070 7261 676d 613a 206e 6f20  :  # pragma: no 
+00006d20: 636f 7665 720a 2020 2020 2020 2020 2020  cover.          
+00006d30: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00006d40: 7228 6622 556e 6b6e 6f77 6e20 7061 7261  r(f"Unknown para
+00006d50: 6d73 3a20 7b6c 6973 7428 7061 7261 6d73  ms: {list(params
+00006d60: 297d 2229 0a0a 2020 2020 6465 6620 7265  )}")..    def re
+00006d70: 6672 6573 685f 7061 7261 6d73 2873 656c  fresh_params(sel
+00006d80: 6629 3a0a 2020 2020 2020 2020 2320 7265  f):.        # re
+00006d90: 6672 6573 6820 7061 7261 6d73 2077 6865  fresh params whe
+00006da0: 6e20 6368 756e 6b73 2075 7064 6174 6564  n chunks updated
+00006db0: 0a20 2020 2020 2020 2072 6566 7265 7368  .        refresh
+00006dc0: 5f74 696c 6561 626c 655f 7368 6170 6528  _tileable_shape(
+00006dd0: 7365 6c66 290a 2020 2020 2020 2020 7265  self).        re
+00006de0: 6672 6573 685f 696e 6465 785f 7661 6c75  fresh_index_valu
+00006df0: 6528 7365 6c66 290a 2020 2020 2020 2020  e(self).        
+00006e00: 6966 2073 656c 662e 5f64 7479 7065 2069  if self._dtype i
+00006e10: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00006e20: 2020 2020 7365 6c66 2e5f 6474 7970 6520      self._dtype 
+00006e30: 3d20 7365 6c66 2e63 6875 6e6b 735b 305d  = self.chunks[0]
+00006e40: 2e64 7479 7065 0a20 2020 2020 2020 2069  .dtype.        i
+00006e50: 6620 7365 6c66 2e5f 6e61 6d65 2069 7320  f self._name is 
+00006e60: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00006e70: 2020 7365 6c66 2e5f 6e61 6d65 203d 2073    self._name = s
+00006e80: 656c 662e 6368 756e 6b73 5b30 5d2e 6e61  elf.chunks[0].na
+00006e90: 6d65 0a0a 2020 2020 6465 6620 5f74 6f5f  me..    def _to_
+00006ea0: 7374 7228 7365 6c66 2c20 7265 7072 6573  str(self, repres
+00006eb0: 656e 7461 7469 6f6e 3d46 616c 7365 293a  entation=False):
+00006ec0: 0a20 2020 2020 2020 2069 6620 6973 5f62  .        if is_b
+00006ed0: 7569 6c64 5f6d 6f64 6528 2920 6f72 206c  uild_mode() or l
+00006ee0: 656e 2873 656c 662e 5f65 7865 6375 7465  en(self._execute
+00006ef0: 645f 7365 7373 696f 6e73 2920 3d3d 2030  d_sessions) == 0
+00006f00: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00006f10: 696e 2062 7569 6c64 206d 6f64 652c 206f  in build mode, o
+00006f20: 7220 6e6f 7420 6578 6563 7574 6564 2c20  r not executed, 
+00006f30: 6a75 7374 2072 6574 7572 6e20 7265 7072  just return repr
+00006f40: 6573 656e 7461 7469 6f6e 0a20 2020 2020  esentation.     
+00006f50: 2020 2020 2020 2069 6620 7265 7072 6573         if repres
+00006f60: 656e 7461 7469 6f6e 3a0a 2020 2020 2020  entation:.      
+00006f70: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00006f80: 2066 2249 6e64 6578 203c 6f70 3d7b 7479   f"Index <op={ty
+00006f90: 7065 2873 656c 662e 5f6f 7029 2e5f 5f6e  pe(self._op).__n
+00006fa0: 616d 655f 5f7d 2c20 6b65 793d 7b73 656c  ame__}, key={sel
+00006fb0: 662e 6b65 797d 220a 2020 2020 2020 2020  f.key}".        
+00006fc0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00006fd0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00006fe0: 2066 2249 6e64 6578 286f 703d 7b74 7970   f"Index(op={typ
+00006ff0: 6528 7365 6c66 2e5f 6f70 292e 5f5f 6e61  e(self._op).__na
+00007000: 6d65 5f5f 7d29 220a 2020 2020 2020 2020  me__})".        
+00007010: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00007020: 2020 6461 7461 203d 2073 656c 662e 6665    data = self.fe
+00007030: 7463 6828 7365 7373 696f 6e3d 7365 6c66  tch(session=self
+00007040: 2e5f 6578 6563 7574 6564 5f73 6573 7369  ._executed_sessi
+00007050: 6f6e 735b 2d31 5d29 0a20 2020 2020 2020  ons[-1]).       
+00007060: 2020 2020 2072 6574 7572 6e20 7265 7072       return repr
+00007070: 2864 6174 6129 2069 6620 7265 7072 2864  (data) if repr(d
+00007080: 6174 6129 2065 6c73 6520 7374 7228 6461  ata) else str(da
+00007090: 7461 290a 0a20 2020 2064 6566 205f 5f73  ta)..    def __s
+000070a0: 7472 5f5f 2873 656c 6629 3a0a 2020 2020  tr__(self):.    
+000070b0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000070c0: 5f74 6f5f 7374 7228 7265 7072 6573 656e  _to_str(represen
+000070d0: 7461 7469 6f6e 3d46 616c 7365 290a 0a20  tation=False).. 
+000070e0: 2020 2064 6566 205f 5f72 6570 725f 5f28     def __repr__(
+000070f0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00007100: 6574 7572 6e20 7365 6c66 2e5f 746f 5f73  eturn self._to_s
+00007110: 7472 2872 6570 7265 7365 6e74 6174 696f  tr(representatio
+00007120: 6e3d 5472 7565 290a 0a20 2020 2064 6566  n=True)..    def
+00007130: 205f 746f 5f6d 6172 735f 7465 6e73 6f72   _to_mars_tensor
+00007140: 2873 656c 662c 2064 7479 7065 3d4e 6f6e  (self, dtype=Non
+00007150: 652c 206f 7264 6572 3d22 4b22 2c20 6578  e, order="K", ex
+00007160: 7472 6163 745f 6d75 6c74 695f 696e 6465  tract_multi_inde
+00007170: 783d 4661 6c73 6529 3a0a 2020 2020 2020  x=False):.      
+00007180: 2020 7465 6e73 6f72 203d 2073 656c 662e    tensor = self.
+00007190: 746f 5f74 656e 736f 7228 6578 7472 6163  to_tensor(extrac
+000071a0: 745f 6d75 6c74 695f 696e 6465 783d 6578  t_multi_index=ex
+000071b0: 7472 6163 745f 6d75 6c74 695f 696e 6465  tract_multi_inde
+000071c0: 7829 0a20 2020 2020 2020 2064 7479 7065  x).        dtype
+000071d0: 203d 2064 7479 7065 2069 6620 6474 7970   = dtype if dtyp
+000071e0: 6520 6973 206e 6f74 204e 6f6e 6520 656c  e is not None el
+000071f0: 7365 2074 656e 736f 722e 6474 7970 650a  se tensor.dtype.
+00007200: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+00007210: 656e 736f 722e 6173 7479 7065 2864 7479  ensor.astype(dty
+00007220: 7065 3d64 7479 7065 2c20 6f72 6465 723d  pe=dtype, order=
+00007230: 6f72 6465 722c 2063 6f70 793d 4661 6c73  order, copy=Fals
+00007240: 6529 0a0a 2020 2020 6465 6620 5f5f 6d61  e)..    def __ma
+00007250: 7273 5f74 656e 736f 725f 5f28 7365 6c66  rs_tensor__(self
+00007260: 2c20 6474 7970 653d 4e6f 6e65 2c20 6f72  , dtype=None, or
+00007270: 6465 723d 224b 2229 3a0a 2020 2020 2020  der="K"):.      
+00007280: 2020 7265 7475 726e 2073 656c 662e 5f74    return self._t
+00007290: 6f5f 6d61 7273 5f74 656e 736f 7228 6474  o_mars_tensor(dt
+000072a0: 7970 653d 6474 7970 652c 206f 7264 6572  ype=dtype, order
+000072b0: 3d6f 7264 6572 290a 0a20 2020 2040 7072  =order)..    @pr
+000072c0: 6f70 6572 7479 0a20 2020 2064 6566 2064  operty.    def d
+000072d0: 7479 7065 2873 656c 6629 3a0a 2020 2020  type(self):.    
+000072e0: 2020 2020 7265 7475 726e 2067 6574 6174      return getat
+000072f0: 7472 2873 656c 662c 2022 5f64 7479 7065  tr(self, "_dtype
+00007300: 222c 204e 6f6e 6529 206f 7220 7365 6c66  ", None) or self
+00007310: 2e6f 702e 6474 7970 650a 0a20 2020 2040  .op.dtype..    @
+00007320: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00007330: 206e 616d 6528 7365 6c66 293a 0a20 2020   name(self):.   
+00007340: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00007350: 2e5f 6e61 6d65 0a0a 2020 2020 4070 726f  ._name..    @pro
+00007360: 7065 7274 790a 2020 2020 6465 6620 6e61  perty.    def na
+00007370: 6d65 7328 7365 6c66 293a 0a20 2020 2020  mes(self):.     
+00007380: 2020 2072 6574 7572 6e20 6765 7461 7474     return getatt
+00007390: 7228 7365 6c66 2c20 225f 6e61 6d65 7322  r(self, "_names"
+000073a0: 2c20 4e6f 6e65 2920 6f72 205b 7365 6c66  , None) or [self
+000073b0: 2e6e 616d 655d 0a0a 2020 2020 4070 726f  .name]..    @pro
+000073c0: 7065 7274 790a 2020 2020 6465 6620 696e  perty.    def in
+000073d0: 6465 785f 7661 6c75 6528 7365 6c66 2920  dex_value(self) 
+000073e0: 2d3e 2049 6e64 6578 5661 6c75 653a 0a20  -> IndexValue:. 
+000073f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00007400: 6c66 2e5f 696e 6465 785f 7661 6c75 650a  lf._index_value.
+00007410: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00007420: 2020 2064 6566 2069 6e66 6572 7265 645f     def inferred_
+00007430: 7479 7065 2873 656c 6629 3a0a 2020 2020  type(self):.    
+00007440: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00007450: 5f69 6e64 6578 5f76 616c 7565 2e69 6e66  _index_value.inf
+00007460: 6572 7265 645f 7479 7065 0a0a 2020 2020  erred_type..    
+00007470: 6465 6620 746f 5f74 656e 736f 7228 7365  def to_tensor(se
+00007480: 6c66 2c20 6474 7970 653d 4e6f 6e65 2c20  lf, dtype=None, 
+00007490: 6578 7472 6163 745f 6d75 6c74 695f 696e  extract_multi_in
+000074a0: 6465 783d 4661 6c73 6529 3a0a 2020 2020  dex=False):.    
+000074b0: 2020 2020 6672 6f6d 202e 2e74 656e 736f      from ..tenso
+000074c0: 722e 6461 7461 736f 7572 6365 2e66 726f  r.datasource.fro
+000074d0: 6d5f 6461 7461 6672 616d 6520 696d 706f  m_dataframe impo
+000074e0: 7274 2066 726f 6d5f 696e 6465 780a 0a20  rt from_index.. 
+000074f0: 2020 2020 2020 2072 6574 7572 6e20 6672         return fr
+00007500: 6f6d 5f69 6e64 6578 2873 656c 662c 2064  om_index(self, d
+00007510: 7479 7065 3d64 7479 7065 2c20 6578 7472  type=dtype, extr
+00007520: 6163 745f 6d75 6c74 695f 696e 6465 783d  act_multi_index=
+00007530: 6578 7472 6163 745f 6d75 6c74 695f 696e  extract_multi_in
+00007540: 6465 7829 0a0a 0a63 6c61 7373 2049 6e64  dex)...class Ind
+00007550: 6578 2848 6173 5368 6170 6554 696c 6561  ex(HasShapeTilea
+00007560: 626c 652c 205f 546f 5061 6e64 6173 4d69  ble, _ToPandasMi
+00007570: 7869 6e29 3a0a 2020 2020 5f5f 736c 6f74  xin):.    __slot
+00007580: 735f 5f20 3d20 225f 6466 5f6f 725f 7365  s__ = "_df_or_se
+00007590: 7269 6573 222c 2022 5f70 6172 656e 745f  ries", "_parent_
+000075a0: 6b65 7922 2c20 225f 6178 6973 220a 2020  key", "_axis".  
+000075b0: 2020 5f61 6c6c 6f77 5f64 6174 615f 7479    _allow_data_ty
+000075c0: 7065 5f20 3d20 2849 6e64 6578 4461 7461  pe_ = (IndexData
+000075d0: 2c29 0a20 2020 2074 7970 655f 6e61 6d65  ,).    type_name
+000075e0: 203d 2022 496e 6465 7822 0a0a 2020 2020   = "Index"..    
+000075f0: 6465 6620 5f5f 6e65 775f 5f28 636c 732c  def __new__(cls,
+00007600: 2064 6174 613a 2055 6e69 6f6e 5b70 642e   data: Union[pd.
+00007610: 496e 6465 782c 2049 6e64 6578 4461 7461  Index, IndexData
+00007620: 5d20 3d20 4e6f 6e65 2c20 2a2a 5f29 3a0a  ] = None, **_):.
+00007630: 2020 2020 2020 2020 6966 2064 6174 6120          if data 
+00007640: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
+00007650: 6e6f 7420 6973 696e 7374 616e 6365 2864  not isinstance(d
+00007660: 6174 612c 2070 642e 496e 6465 7829 3a0a  ata, pd.Index):.
+00007670: 2020 2020 2020 2020 2020 2020 2320 6372              # cr
+00007680: 6561 7465 2063 6f72 7265 7370 6f6e 6469  eate correspondi
+00007690: 6e67 2049 6e64 6578 2063 6c61 7373 0a20  ng Index class. 
+000076a0: 2020 2020 2020 2020 2020 2023 2061 6363             # acc
+000076b0: 6f72 6469 6e67 2074 6f20 7479 7065 206f  ording to type o
+000076c0: 6620 696e 6465 785f 7661 6c75 650a 2020  f index_value.  
+000076d0: 2020 2020 2020 2020 2020 636c 7a20 3d20            clz = 
+000076e0: 676c 6f62 616c 7328 295b 7479 7065 2864  globals()[type(d
+000076f0: 6174 612e 696e 6465 785f 7661 6c75 652e  ata.index_value.
+00007700: 7661 6c75 6529 2e5f 5f6e 616d 655f 5f5d  value).__name__]
+00007710: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00007720: 2020 2020 2020 2020 2020 2063 6c7a 203d             clz =
+00007730: 2063 6c73 0a20 2020 2020 2020 2072 6574   cls.        ret
+00007740: 7572 6e20 6f62 6a65 6374 2e5f 5f6e 6577  urn object.__new
+00007750: 5f5f 2863 6c7a 290a 0a20 2020 2064 6566  __(clz)..    def
+00007760: 205f 5f6c 656e 5f5f 2873 656c 6629 3a0a   __len__(self):.
+00007770: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+00007780: 656e 2873 656c 662e 5f64 6174 6129 0a0a  en(self._data)..
+00007790: 2020 2020 6465 6620 5f5f 6d61 7273 5f74      def __mars_t
+000077a0: 656e 736f 725f 5f28 7365 6c66 2c20 6474  ensor__(self, dt
+000077b0: 7970 653d 4e6f 6e65 2c20 6f72 6465 723d  ype=None, order=
+000077c0: 224b 2229 3a0a 2020 2020 2020 2020 7265  "K"):.        re
+000077d0: 7475 726e 2073 656c 662e 5f64 6174 612e  turn self._data.
+000077e0: 5f5f 6d61 7273 5f74 656e 736f 725f 5f28  __mars_tensor__(
+000077f0: 6474 7970 653d 6474 7970 652c 206f 7264  dtype=dtype, ord
+00007800: 6572 3d6f 7264 6572 290a 0a20 2020 2064  er=order)..    d
+00007810: 6566 205f 6765 745f 6466 5f6f 725f 7365  ef _get_df_or_se
+00007820: 7269 6573 2873 656c 6629 3a0a 2020 2020  ries(self):.    
+00007830: 2020 2020 6f62 6a20 3d20 6765 7461 7474      obj = getatt
+00007840: 7228 7365 6c66 2c20 225f 6466 5f6f 725f  r(self, "_df_or_
+00007850: 7365 7269 6573 222c 204e 6f6e 6529 0a20  series", None). 
+00007860: 2020 2020 2020 2069 6620 6f62 6a20 6973         if obj is
+00007870: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00007880: 2020 2020 2020 2072 6574 7572 6e20 6f62         return ob
+00007890: 6a28 290a 2020 2020 2020 2020 7265 7475  j().        retu
+000078a0: 726e 204e 6f6e 650a 0a20 2020 2064 6566  rn None..    def
+000078b0: 205f 7365 745f 6466 5f6f 725f 7365 7269   _set_df_or_seri
+000078c0: 6573 2873 656c 662c 2064 665f 6f72 5f73  es(self, df_or_s
+000078d0: 6572 6965 732c 2061 7869 7329 3a0a 2020  eries, axis):.  
+000078e0: 2020 2020 2020 7365 6c66 2e5f 6466 5f6f        self._df_o
+000078f0: 725f 7365 7269 6573 203d 2077 6561 6b72  r_series = weakr
+00007900: 6566 2e72 6566 2864 665f 6f72 5f73 6572  ef.ref(df_or_ser
+00007910: 6965 7329 0a20 2020 2020 2020 2073 656c  ies).        sel
+00007920: 662e 5f70 6172 656e 745f 6b65 7920 3d20  f._parent_key = 
+00007930: 6466 5f6f 725f 7365 7269 6573 2e6b 6579  df_or_series.key
+00007940: 0a20 2020 2020 2020 2073 656c 662e 5f61  .        self._a
+00007950: 7869 7320 3d20 6178 6973 0a0a 2020 2020  xis = axis..    
+00007960: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00007970: 6620 5428 7365 6c66 293a 0a20 2020 2020  f T(self):.     
+00007980: 2020 2022 2222 5265 7475 726e 2074 6865     """Return the
+00007990: 2074 7261 6e73 706f 7365 2c20 7768 6963   transpose, whic
+000079a0: 6820 6973 2062 7920 6465 6669 6e69 7469  h is by definiti
+000079b0: 6f6e 2073 656c 662e 2222 220a 2020 2020  on self.""".    
+000079c0: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+000079d0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+000079e0: 2020 2064 6566 206e 616d 6528 7365 6c66     def name(self
+000079f0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00007a00: 6e20 7365 6c66 2e5f 6461 7461 2e6e 616d  n self._data.nam
+00007a10: 650a 0a20 2020 2040 6e61 6d65 2e73 6574  e..    @name.set
+00007a20: 7465 720a 2020 2020 6465 6620 6e61 6d65  ter.    def name
+00007a30: 2873 656c 662c 2076 616c 7565 293a 0a20  (self, value):. 
+00007a40: 2020 2020 2020 2064 665f 6f72 5f73 6572         df_or_ser
+00007a50: 6965 7320 3d20 7365 6c66 2e5f 6765 745f  ies = self._get_
+00007a60: 6466 5f6f 725f 7365 7269 6573 2829 0a20  df_or_series(). 
+00007a70: 2020 2020 2020 2069 6620 6466 5f6f 725f         if df_or_
+00007a80: 7365 7269 6573 2069 7320 6e6f 7420 4e6f  series is not No
+00007a90: 6e65 2061 6e64 2064 665f 6f72 5f73 6572  ne and df_or_ser
+00007aa0: 6965 732e 6b65 7920 3d3d 2073 656c 662e  ies.key == self.
+00007ab0: 5f70 6172 656e 745f 6b65 793a 0a20 2020  _parent_key:.   
+00007ac0: 2020 2020 2020 2020 2064 665f 6f72 5f73           df_or_s
+00007ad0: 6572 6965 732e 7265 6e61 6d65 5f61 7869  eries.rename_axi
+00007ae0: 7328 7661 6c75 652c 2061 7869 733d 7365  s(value, axis=se
+00007af0: 6c66 2e5f 6178 6973 2c20 696e 706c 6163  lf._axis, inplac
+00007b00: 653d 5472 7565 290a 2020 2020 2020 2020  e=True).        
+00007b10: 2020 2020 7365 6c66 2e64 6174 6120 3d20      self.data = 
+00007b20: 6466 5f6f 725f 7365 7269 6573 2e61 7865  df_or_series.axe
+00007b30: 735b 7365 6c66 2e5f 6178 6973 5d2e 6461  s[self._axis].da
+00007b40: 7461 0a20 2020 2020 2020 2065 6c73 653a  ta.        else:
+00007b50: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00007b60: 662e 7265 6e61 6d65 2876 616c 7565 2c20  f.rename(value, 
+00007b70: 696e 706c 6163 653d 5472 7565 290a 0a20  inplace=True).. 
+00007b80: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00007b90: 2064 6566 206e 616d 6573 2873 656c 6629   def names(self)
+00007ba0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00007bb0: 2073 656c 662e 5f64 6174 612e 6e61 6d65   self._data.name
+00007bc0: 730a 0a20 2020 2040 6e61 6d65 732e 7365  s..    @names.se
+00007bd0: 7474 6572 0a20 2020 2064 6566 206e 616d  tter.    def nam
+00007be0: 6573 2873 656c 662c 2076 616c 7565 293a  es(self, value):
+00007bf0: 0a20 2020 2020 2020 2064 665f 6f72 5f73  .        df_or_s
+00007c00: 6572 6965 7320 3d20 7365 6c66 2e5f 6765  eries = self._ge
+00007c10: 745f 6466 5f6f 725f 7365 7269 6573 2829  t_df_or_series()
+00007c20: 0a20 2020 2020 2020 2069 6620 6466 5f6f  .        if df_o
+00007c30: 725f 7365 7269 6573 2069 7320 6e6f 7420  r_series is not 
+00007c40: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00007c50: 2020 6466 5f6f 725f 7365 7269 6573 2e72    df_or_series.r
+00007c60: 656e 616d 655f 6178 6973 2876 616c 7565  ename_axis(value
+00007c70: 2c20 6178 6973 3d73 656c 662e 5f61 7869  , axis=self._axi
+00007c80: 732c 2069 6e70 6c61 6365 3d54 7275 6529  s, inplace=True)
+00007c90: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00007ca0: 662e 6461 7461 203d 2064 665f 6f72 5f73  f.data = df_or_s
+00007cb0: 6572 6965 732e 6178 6573 5b73 656c 662e  eries.axes[self.
+00007cc0: 5f61 7869 735d 2e64 6174 610a 2020 2020  _axis].data.    
+00007cd0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00007ce0: 2020 2020 2020 7365 6c66 2e72 656e 616d        self.renam
+00007cf0: 6528 7661 6c75 652c 2069 6e70 6c61 6365  e(value, inplace
+00007d00: 3d54 7275 6529 0a0a 2020 2020 4070 726f  =True)..    @pro
+00007d10: 7065 7274 790a 2020 2020 6465 6620 7661  perty.    def va
+00007d20: 6c75 6573 2873 656c 6629 3a0a 2020 2020  lues(self):.    
+00007d30: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00007d40: 746f 5f74 656e 736f 7228 290a 0a20 2020  to_tensor()..   
+00007d50: 2064 6566 2074 6f5f 6672 616d 6528 7365   def to_frame(se
+00007d60: 6c66 2c20 696e 6465 783a 2062 6f6f 6c20  lf, index: bool 
+00007d70: 3d20 5472 7565 2c20 6e61 6d65 3d4e 6f6e  = True, name=Non
+00007d80: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
+00007d90: 2020 2020 2020 2020 4372 6561 7465 2061          Create a
+00007da0: 2044 6174 6146 7261 6d65 2077 6974 6820   DataFrame with 
+00007db0: 6120 636f 6c75 6d6e 2063 6f6e 7461 696e  a column contain
+00007dc0: 696e 6720 7468 6520 496e 6465 782e 0a0a  ing the Index...
+00007dd0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00007de0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00007df0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 696e  -----.        in
+00007e00: 6465 7820 3a20 626f 6f6c 2c20 6465 6661  dex : bool, defa
+00007e10: 756c 7420 5472 7565 0a20 2020 2020 2020  ult True.       
+00007e20: 2020 2020 2053 6574 2074 6865 2069 6e64       Set the ind
+00007e30: 6578 206f 6620 7468 6520 7265 7475 726e  ex of the return
+00007e40: 6564 2044 6174 6146 7261 6d65 2061 7320  ed DataFrame as 
+00007e50: 7468 6520 6f72 6967 696e 616c 2049 6e64  the original Ind
+00007e60: 6578 2e0a 0a20 2020 2020 2020 206e 616d  ex...        nam
+00007e70: 6520 3a20 6f62 6a65 6374 2c20 6465 6661  e : object, defa
+00007e80: 756c 7420 4e6f 6e65 0a20 2020 2020 2020  ult None.       
+00007e90: 2020 2020 2054 6865 2070 6173 7365 6420       The passed 
+00007ea0: 6e61 6d65 2073 686f 756c 6420 7375 6273  name should subs
+00007eb0: 7469 7475 7465 2066 6f72 2074 6865 2069  titute for the i
+00007ec0: 6e64 6578 206e 616d 6520 2869 6620 6974  ndex name (if it
+00007ed0: 2068 6173 0a20 2020 2020 2020 2020 2020   has.           
+00007ee0: 206f 6e65 292e 0a0a 2020 2020 2020 2020   one)...        
+00007ef0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00007f00: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00007f10: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
+00007f20: 2020 2020 2020 4461 7461 4672 616d 6520        DataFrame 
+00007f30: 636f 6e74 6169 6e69 6e67 2074 6865 206f  containing the o
+00007f40: 7269 6769 6e61 6c20 496e 6465 7820 6461  riginal Index da
+00007f50: 7461 2e0a 0a20 2020 2020 2020 2053 6565  ta...        See
+00007f60: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
+00007f70: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2049  ------.        I
+00007f80: 6e64 6578 2e74 6f5f 7365 7269 6573 203a  ndex.to_series :
+00007f90: 2043 6f6e 7665 7274 2061 6e20 496e 6465   Convert an Inde
+00007fa0: 7820 746f 2061 2053 6572 6965 732e 0a20  x to a Series.. 
+00007fb0: 2020 2020 2020 2053 6572 6965 732e 746f         Series.to
+00007fc0: 5f66 7261 6d65 203a 2043 6f6e 7665 7274  _frame : Convert
+00007fd0: 2053 6572 6965 7320 746f 2044 6174 6146   Series to DataF
+00007fe0: 7261 6d65 2e0a 0a20 2020 2020 2020 2045  rame...        E
+00007ff0: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
+00008000: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00008010: 203e 3e3e 2069 6d70 6f72 7420 6d61 7273   >>> import mars
+00008020: 2e64 6174 6166 7261 6d65 2061 7320 6d64  .dataframe as md
+00008030: 0a20 2020 2020 2020 203e 3e3e 2069 6478  .        >>> idx
+00008040: 203d 206d 642e 496e 6465 7828 5b27 416e   = md.Index(['An
+00008050: 7427 2c20 2742 6561 7227 2c20 2743 6f77  t', 'Bear', 'Cow
+00008060: 275d 2c20 6e61 6d65 3d27 616e 696d 616c  '], name='animal
+00008070: 2729 0a20 2020 2020 2020 203e 3e3e 2069  ').        >>> i
+00008080: 6478 2e74 6f5f 6672 616d 6528 292e 6578  dx.to_frame().ex
+00008090: 6563 7574 6528 290a 2020 2020 2020 2020  ecute().        
+000080a0: 2020 2020 2020 2061 6e69 6d61 6c0a 2020         animal.  
+000080b0: 2020 2020 2020 616e 696d 616c 0a20 2020        animal.   
+000080c0: 2020 2020 2041 6e74 2020 2020 2020 2041       Ant       A
+000080d0: 6e74 0a20 2020 2020 2020 2042 6561 7220  nt.        Bear 
+000080e0: 2020 2020 4265 6172 0a20 2020 2020 2020      Bear.       
+000080f0: 2043 6f77 2020 2020 2020 2043 6f77 0a0a   Cow       Cow..
+00008100: 2020 2020 2020 2020 4279 2064 6566 6175          By defau
+00008110: 6c74 2c20 7468 6520 6f72 6967 696e 616c  lt, the original
+00008120: 2049 6e64 6578 2069 7320 7265 7573 6564   Index is reused
+00008130: 2e20 546f 2065 6e66 6f72 6365 2061 206e  . To enforce a n
+00008140: 6577 2049 6e64 6578 3a0a 0a20 2020 2020  ew Index:..     
+00008150: 2020 203e 3e3e 2069 6478 2e74 6f5f 6672     >>> idx.to_fr
+00008160: 616d 6528 696e 6465 783d 4661 6c73 6529  ame(index=False)
+00008170: 2e65 7865 6375 7465 2829 0a20 2020 2020  .execute().     
+00008180: 2020 2020 2061 6e69 6d61 6c0a 2020 2020       animal.    
+00008190: 2020 2020 3020 2020 2041 6e74 0a20 2020      0    Ant.   
+000081a0: 2020 2020 2031 2020 2042 6561 720a 2020       1   Bear.  
+000081b0: 2020 2020 2020 3220 2020 2043 6f77 0a0a        2    Cow..
+000081c0: 2020 2020 2020 2020 546f 206f 7665 7272          To overr
+000081d0: 6964 6520 7468 6520 6e61 6d65 206f 6620  ide the name of 
+000081e0: 7468 6520 7265 7375 6c74 696e 6720 636f  the resulting co
+000081f0: 6c75 6d6e 2c20 7370 6563 6966 7920 606e  lumn, specify `n
+00008200: 616d 6560 3a0a 0a20 2020 2020 2020 203e  ame`:..        >
+00008210: 3e3e 2069 6478 2e74 6f5f 6672 616d 6528  >> idx.to_frame(
+00008220: 696e 6465 783d 4661 6c73 652c 206e 616d  index=False, nam
+00008230: 653d 277a 6f6f 2729 2e65 7865 6375 7465  e='zoo').execute
+00008240: 2829 0a20 2020 2020 2020 2020 2020 207a  ().            z
+00008250: 6f6f 0a20 2020 2020 2020 2030 2020 2041  oo.        0   A
+00008260: 6e74 0a20 2020 2020 2020 2031 2020 4265  nt.        1  Be
+00008270: 6172 0a20 2020 2020 2020 2032 2020 2043  ar.        2   C
+00008280: 6f77 0a20 2020 2020 2020 2022 2222 0a20  ow.        """. 
+00008290: 2020 2020 2020 2066 726f 6d20 2e20 696d         from . im
+000082a0: 706f 7274 2064 6174 6166 7261 6d65 5f66  port dataframe_f
+000082b0: 726f 6d5f 7465 6e73 6f72 0a0a 2020 2020  rom_tensor..    
+000082c0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000082d0: 6528 7365 6c66 2e69 6e64 6578 5f76 616c  e(self.index_val
+000082e0: 7565 2e76 616c 7565 2c20 496e 6465 7856  ue.value, IndexV
+000082f0: 616c 7565 2e4d 756c 7469 496e 6465 7829  alue.MultiIndex)
+00008300: 3a0a 2020 2020 2020 2020 2020 2020 6f6c  :.            ol
+00008310: 645f 6e61 6d65 7320 3d20 7365 6c66 2e69  d_names = self.i
+00008320: 6e64 6578 5f76 616c 7565 2e76 616c 7565  ndex_value.value
+00008330: 2e6e 616d 6573 0a0a 2020 2020 2020 2020  .names..        
+00008340: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
+00008350: 2020 2020 2020 2020 206e 616d 6520 6973           name is
+00008360: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
+00008370: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
+00008380: 7420 6973 696e 7374 616e 6365 286e 616d  t isinstance(nam
+00008390: 652c 2049 7465 7261 626c 6529 0a20 2020  e, Iterable).   
+000083a0: 2020 2020 2020 2020 2020 2020 206f 7220               or 
+000083b0: 6973 696e 7374 616e 6365 286e 616d 652c  isinstance(name,
+000083c0: 2073 7472 290a 2020 2020 2020 2020 2020   str).          
+000083d0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+000083e0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+000083f0: 7272 6f72 2822 276e 616d 6527 206d 7573  rror("'name' mus
+00008400: 7420 6265 2061 206c 6973 7420 2f20 7365  t be a list / se
+00008410: 7175 656e 6365 206f 6620 636f 6c75 6d6e  quence of column
+00008420: 206e 616d 6573 2e22 290a 0a20 2020 2020   names.")..     
+00008430: 2020 2020 2020 206e 616d 6520 3d20 6c69         name = li
+00008440: 7374 286e 616d 6520 6966 206e 616d 6520  st(name if name 
+00008450: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
+00008460: 206f 6c64 5f6e 616d 6573 290a 2020 2020   old_names).    
+00008470: 2020 2020 2020 2020 6966 206c 656e 286e          if len(n
+00008480: 616d 6529 2021 3d20 6c65 6e28 6f6c 645f  ame) != len(old_
+00008490: 6e61 6d65 7329 3a0a 2020 2020 2020 2020  names):.        
+000084a0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+000084b0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+000084c0: 2020 2020 2020 2020 2020 2020 2020 2227                "'
+000084d0: 6e61 6d65 2720 7368 6f75 6c64 2068 6176  name' should hav
+000084e0: 6520 7361 6d65 206c 656e 6774 6820 6173  e same length as
+000084f0: 206e 756d 6265 7220 6f66 206c 6576 656c   number of level
+00008500: 7320 6f6e 2069 6e64 6578 2e22 0a20 2020  s on index.".   
+00008510: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00008520: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+00008530: 6d6e 7320 3d20 5b0a 2020 2020 2020 2020  mns = [.        
+00008540: 2020 2020 2020 2020 6f6c 6420 6f72 206e          old or n
+00008550: 6577 206f 7220 6964 7820 666f 7220 6964  ew or idx for id
+00008560: 782c 2028 6f6c 642c 206e 6577 2920 696e  x, (old, new) in
+00008570: 2065 6e75 6d65 7261 7465 287a 6970 286f   enumerate(zip(o
+00008580: 6c64 5f6e 616d 6573 2c20 6e61 6d65 2929  ld_names, name))
+00008590: 0a20 2020 2020 2020 2020 2020 205d 0a20  .            ]. 
+000085a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000085b0: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
+000085c0: 203d 205b 6e61 6d65 206f 7220 7365 6c66   = [name or self
+000085d0: 2e6e 616d 6520 6f72 2030 5d0a 2020 2020  .name or 0].    
+000085e0: 2020 2020 696e 6465 785f 203d 2073 656c      index_ = sel
+000085f0: 6620 6966 2069 6e64 6578 2065 6c73 6520  f if index else 
+00008600: 4e6f 6e65 0a20 2020 2020 2020 2072 6574  None.        ret
+00008610: 7572 6e20 6461 7461 6672 616d 655f 6672  urn dataframe_fr
+00008620: 6f6d 5f74 656e 736f 7228 0a20 2020 2020  om_tensor(.     
+00008630: 2020 2020 2020 2073 656c 662e 5f64 6174         self._dat
+00008640: 612e 5f74 6f5f 6d61 7273 5f74 656e 736f  a._to_mars_tenso
+00008650: 7228 7365 6c66 2c20 6578 7472 6163 745f  r(self, extract_
+00008660: 6d75 6c74 695f 696e 6465 783d 5472 7565  multi_index=True
+00008670: 292c 0a20 2020 2020 2020 2020 2020 2069  ),.            i
+00008680: 6e64 6578 3d69 6e64 6578 5f2c 0a20 2020  ndex=index_,.   
+00008690: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
+000086a0: 3d63 6f6c 756d 6e73 2c0a 2020 2020 2020  =columns,.      
+000086b0: 2020 290a 0a20 2020 2064 6566 2074 6f5f    )..    def to_
+000086c0: 7365 7269 6573 2873 656c 662c 2069 6e64  series(self, ind
+000086d0: 6578 3d4e 6f6e 652c 206e 616d 653d 4e6f  ex=None, name=No
+000086e0: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
+000086f0: 0a20 2020 2020 2020 2043 7265 6174 6520  .        Create 
+00008700: 6120 5365 7269 6573 2077 6974 6820 626f  a Series with bo
+00008710: 7468 2069 6e64 6578 2061 6e64 2076 616c  th index and val
+00008720: 7565 7320 6571 7561 6c20 746f 2074 6865  ues equal to the
+00008730: 2069 6e64 6578 206b 6579 732e 0a0a 2020   index keys...  
+00008740: 2020 2020 2020 5573 6566 756c 2077 6974        Useful wit
+00008750: 6820 6d61 7020 666f 7220 7265 7475 726e  h map for return
+00008760: 696e 6720 616e 2069 6e64 6578 6572 2062  ing an indexer b
+00008770: 6173 6564 206f 6e20 616e 2069 6e64 6578  ased on an index
+00008780: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00008790: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+000087a0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+000087b0: 2069 6e64 6578 203a 2049 6e64 6578 2c20   index : Index, 
+000087c0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+000087d0: 2020 2020 2049 6e64 6578 206f 6620 7265       Index of re
+000087e0: 7375 6c74 696e 6720 5365 7269 6573 2e20  sulting Series. 
+000087f0: 4966 204e 6f6e 652c 2064 6566 6175 6c74  If None, default
+00008800: 7320 746f 206f 7269 6769 6e61 6c20 696e  s to original in
+00008810: 6465 782e 0a20 2020 2020 2020 206e 616d  dex..        nam
+00008820: 6520 3a20 7374 722c 206f 7074 696f 6e61  e : str, optiona
+00008830: 6c0a 2020 2020 2020 2020 2020 2020 4461  l.            Da
+00008840: 6d65 206f 6620 7265 7375 6c74 696e 6720  me of resulting 
+00008850: 5365 7269 6573 2e20 4966 204e 6f6e 652c  Series. If None,
+00008860: 2064 6566 6175 6c74 7320 746f 206e 616d   defaults to nam
+00008870: 6520 6f66 206f 7269 6769 6e61 6c0a 2020  e of original.  
+00008880: 2020 2020 2020 2020 2020 696e 6465 782e            index.
+00008890: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+000088a0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+000088b0: 2d0a 2020 2020 2020 2020 5365 7269 6573  -.        Series
+000088c0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+000088d0: 2064 7479 7065 2077 696c 6c20 6265 2062   dtype will be b
+000088e0: 6173 6564 206f 6e20 7468 6520 7479 7065  ased on the type
+000088f0: 206f 6620 7468 6520 496e 6465 7820 7661   of the Index va
+00008900: 6c75 6573 2e0a 2020 2020 2020 2020 2222  lues..        ""
+00008910: 220a 2020 2020 2020 2020 6672 6f6d 202e  ".        from .
+00008920: 2069 6d70 6f72 7420 7365 7269 6573 5f66   import series_f
+00008930: 726f 6d5f 696e 6465 780a 0a20 2020 2020  rom_index..     
+00008940: 2020 2072 6574 7572 6e20 7365 7269 6573     return series
+00008950: 5f66 726f 6d5f 696e 6465 7828 7365 6c66  _from_index(self
+00008960: 2c20 696e 6465 783d 696e 6465 782c 206e  , index=index, n
+00008970: 616d 653d 6e61 6d65 290a 0a0a 636c 6173  ame=name)...clas
+00008980: 7320 5261 6e67 6549 6e64 6578 2849 6e64  s RangeIndex(Ind
+00008990: 6578 293a 0a20 2020 205f 5f73 6c6f 7473  ex):.    __slots
+000089a0: 5f5f 203d 2028 290a 0a0a 636c 6173 7320  __ = ()...class 
+000089b0: 4361 7465 676f 7269 6361 6c49 6e64 6578  CategoricalIndex
+000089c0: 2849 6e64 6578 293a 0a20 2020 205f 5f73  (Index):.    __s
+000089d0: 6c6f 7473 5f5f 203d 2028 290a 0a0a 636c  lots__ = ()...cl
+000089e0: 6173 7320 496e 7465 7276 616c 496e 6465  ass IntervalInde
+000089f0: 7828 496e 6465 7829 3a0a 2020 2020 5f5f  x(Index):.    __
+00008a00: 736c 6f74 735f 5f20 3d20 2829 0a0a 0a63  slots__ = ()...c
+00008a10: 6c61 7373 2044 6174 6574 696d 6549 6e64  lass DatetimeInd
+00008a20: 6578 2849 6e64 6578 293a 0a20 2020 205f  ex(Index):.    _
+00008a30: 5f73 6c6f 7473 5f5f 203d 2028 290a 0a0a  _slots__ = ()...
+00008a40: 636c 6173 7320 5469 6d65 6465 6c74 6149  class TimedeltaI
+00008a50: 6e64 6578 2849 6e64 6578 293a 0a20 2020  ndex(Index):.   
+00008a60: 205f 5f73 6c6f 7473 5f5f 203d 2028 290a   __slots__ = ().
+00008a70: 0a0a 636c 6173 7320 5065 7269 6f64 496e  ..class PeriodIn
+00008a80: 6465 7828 496e 6465 7829 3a0a 2020 2020  dex(Index):.    
+00008a90: 5f5f 736c 6f74 735f 5f20 3d20 2829 0a0a  __slots__ = ()..
+00008aa0: 0a63 6c61 7373 2049 6e74 3634 496e 6465  .class Int64Inde
+00008ab0: 7828 496e 6465 7829 3a0a 2020 2020 5f5f  x(Index):.    __
+00008ac0: 736c 6f74 735f 5f20 3d20 2829 0a0a 0a63  slots__ = ()...c
+00008ad0: 6c61 7373 2055 496e 7436 3449 6e64 6578  lass UInt64Index
+00008ae0: 2849 6e64 6578 293a 0a20 2020 205f 5f73  (Index):.    __s
+00008af0: 6c6f 7473 5f5f 203d 2028 290a 0a0a 636c  lots__ = ()...cl
+00008b00: 6173 7320 466c 6f61 7436 3449 6e64 6578  ass Float64Index
+00008b10: 2849 6e64 6578 293a 0a20 2020 205f 5f73  (Index):.    __s
+00008b20: 6c6f 7473 5f5f 203d 2028 290a 0a0a 636c  lots__ = ()...cl
+00008b30: 6173 7320 4d75 6c74 6949 6e64 6578 2849  ass MultiIndex(I
+00008b40: 6e64 6578 293a 0a20 2020 205f 5f73 6c6f  ndex):.    __slo
+00008b50: 7473 5f5f 203d 2028 290a 0a0a 636c 6173  ts__ = ()...clas
+00008b60: 7320 4261 7365 5365 7269 6573 4368 756e  s BaseSeriesChun
+00008b70: 6b44 6174 6128 4c61 7a79 4d65 7461 4368  kData(LazyMetaCh
+00008b80: 756e 6b44 6174 6129 3a0a 2020 2020 5f5f  unkData):.    __
+00008b90: 736c 6f74 735f 5f20 3d20 2829 0a0a 2020  slots__ = ()..  
+00008ba0: 2020 2320 7265 7175 6972 6564 2066 6965    # required fie
+00008bb0: 6c64 730a 2020 2020 5f73 6861 7065 203d  lds.    _shape =
+00008bc0: 2054 7570 6c65 4669 656c 6428 0a20 2020   TupleField(.   
+00008bd0: 2020 2020 2022 7368 6170 6522 2c0a 2020       "shape",.  
+00008be0: 2020 2020 2020 4669 656c 6454 7970 6573        FieldTypes
+00008bf0: 2e69 6e74 3634 2c0a 2020 2020 2020 2020  .int64,.        
+00008c00: 6f6e 5f73 6572 6961 6c69 7a65 3d6f 6e5f  on_serialize=on_
+00008c10: 7365 7269 616c 697a 655f 7368 6170 652c  serialize_shape,
+00008c20: 0a20 2020 2020 2020 206f 6e5f 6465 7365  .        on_dese
+00008c30: 7269 616c 697a 653d 6f6e 5f64 6573 6572  rialize=on_deser
+00008c40: 6961 6c69 7a65 5f73 6861 7065 2c0a 2020  ialize_shape,.  
+00008c50: 2020 290a 2020 2020 2320 6f70 7469 6f6e    ).    # option
+00008c60: 616c 2066 6965 6c64 0a20 2020 205f 6474  al field.    _dt
+00008c70: 7970 6520 3d20 4461 7461 5479 7065 4669  ype = DataTypeFi
+00008c80: 656c 6428 2264 7479 7065 2229 0a20 2020  eld("dtype").   
+00008c90: 205f 6e61 6d65 203d 2041 6e79 4669 656c   _name = AnyFiel
+00008ca0: 6428 226e 616d 6522 290a 2020 2020 5f69  d("name").    _i
+00008cb0: 6e64 6578 5f76 616c 7565 203d 2043 6875  ndex_value = Chu
+00008cc0: 6e6b 496e 6465 7856 616c 7565 4669 656c  nkIndexValueFiel
+00008cd0: 6428 0a20 2020 2020 2020 2022 696e 6465  d(.        "inde
+00008ce0: 785f 7661 6c75 6522 2c20 496e 6465 7856  x_value", IndexV
+00008cf0: 616c 7565 2c20 6f6e 5f64 6573 6572 6961  alue, on_deseria
+00008d00: 6c69 7a65 3d5f 6f6e 5f64 6573 6572 6961  lize=_on_deseria
+00008d10: 6c69 7a65 5f69 6e64 6578 5f76 616c 7565  lize_index_value
+00008d20: 0a20 2020 2029 0a0a 2020 2020 6465 6620  .    )..    def 
+00008d30: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
+00008d40: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00008d50: 6f70 3d4e 6f6e 652c 0a20 2020 2020 2020  op=None,.       
+00008d60: 2073 6861 7065 3d4e 6f6e 652c 0a20 2020   shape=None,.   
+00008d70: 2020 2020 2069 6e64 6578 3d4e 6f6e 652c       index=None,
+00008d80: 0a20 2020 2020 2020 2064 7479 7065 3d4e  .        dtype=N
+00008d90: 6f6e 652c 0a20 2020 2020 2020 206e 616d  one,.        nam
+00008da0: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
+00008db0: 696e 6465 785f 7661 6c75 653d 4e6f 6e65  index_value=None
+00008dc0: 2c0a 2020 2020 2020 2020 2a2a 6b77 2c0a  ,.        **kw,.
+00008dd0: 2020 2020 293a 0a20 2020 2020 2020 2073      ):.        s
+00008de0: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
+00008df0: 0a20 2020 2020 2020 2020 2020 205f 6f70  .            _op
+00008e00: 3d6f 702c 0a20 2020 2020 2020 2020 2020  =op,.           
+00008e10: 205f 7368 6170 653d 7368 6170 652c 0a20   _shape=shape,. 
+00008e20: 2020 2020 2020 2020 2020 205f 696e 6465             _inde
+00008e30: 783d 696e 6465 782c 0a20 2020 2020 2020  x=index,.       
+00008e40: 2020 2020 205f 6474 7970 653d 6474 7970       _dtype=dtyp
+00008e50: 652c 0a20 2020 2020 2020 2020 2020 205f  e,.            _
+00008e60: 6e61 6d65 3d6e 616d 652c 0a20 2020 2020  name=name,.     
+00008e70: 2020 2020 2020 205f 696e 6465 785f 7661         _index_va
+00008e80: 6c75 653d 696e 6465 785f 7661 6c75 652c  lue=index_value,
+00008e90: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
+00008ea0: 772c 0a20 2020 2020 2020 2029 0a0a 2020  w,.        )..  
+00008eb0: 2020 6465 6620 5f67 6574 5f70 6172 616d    def _get_param
+00008ec0: 7328 7365 6c66 2920 2d3e 2044 6963 745b  s(self) -> Dict[
+00008ed0: 7374 722c 2041 6e79 5d3a 0a20 2020 2020  str, Any]:.     
+00008ee0: 2020 2023 2070 6172 616d 7320 7265 7475     # params retu
+00008ef0: 726e 2074 6865 2070 726f 7065 7274 6965  rn the propertie
+00008f00: 7320 7768 6963 6820 7573 6566 756c 2074  s which useful t
+00008f10: 6f20 7265 6275 696c 6420 6120 6e65 7720  o rebuild a new 
+00008f20: 6368 756e 6b0a 2020 2020 2020 2020 7265  chunk.        re
+00008f30: 7475 726e 207b 0a20 2020 2020 2020 2020  turn {.         
+00008f40: 2020 2022 7368 6170 6522 3a20 7365 6c66     "shape": self
+00008f50: 2e73 6861 7065 2c0a 2020 2020 2020 2020  .shape,.        
+00008f60: 2020 2020 2264 7479 7065 223a 2073 656c      "dtype": sel
+00008f70: 662e 6474 7970 652c 0a20 2020 2020 2020  f.dtype,.       
+00008f80: 2020 2020 2022 696e 6465 7822 3a20 7365       "index": se
+00008f90: 6c66 2e69 6e64 6578 2c0a 2020 2020 2020  lf.index,.      
+00008fa0: 2020 2020 2020 2269 6e64 6578 5f76 616c        "index_val
+00008fb0: 7565 223a 2073 656c 662e 696e 6465 785f  ue": self.index_
+00008fc0: 7661 6c75 652c 0a20 2020 2020 2020 2020  value,.         
+00008fd0: 2020 2022 6e61 6d65 223a 2073 656c 662e     "name": self.
+00008fe0: 6e61 6d65 2c0a 2020 2020 2020 2020 7d0a  name,.        }.
+00008ff0: 0a20 2020 2064 6566 205f 7365 745f 7061  .    def _set_pa
+00009000: 7261 6d73 2873 656c 662c 206e 6577 5f70  rams(self, new_p
+00009010: 6172 616d 733a 2044 6963 745b 7374 722c  arams: Dict[str,
+00009020: 2041 6e79 5d29 3a0a 2020 2020 2020 2020   Any]):.        
+00009030: 7061 7261 6d73 203d 206e 6577 5f70 6172  params = new_par
+00009040: 616d 732e 636f 7079 2829 0a20 2020 2020  ams.copy().     
+00009050: 2020 2070 6172 616d 732e 706f 7028 2269     params.pop("i
+00009060: 6e64 6578 222c 204e 6f6e 6529 2020 2320  ndex", None)  # 
+00009070: 696e 6465 7820 6e6f 7420 6e65 6564 6564  index not needed
+00009080: 2074 6f20 7570 6461 7465 0a20 2020 2020   to update.     
+00009090: 2020 206e 6577 5f73 6861 7065 203d 2070     new_shape = p
+000090a0: 6172 616d 732e 706f 7028 2273 6861 7065  arams.pop("shape
+000090b0: 222c 204e 6f6e 6529 0a20 2020 2020 2020  ", None).       
+000090c0: 2069 6620 6e65 775f 7368 6170 6520 6973   if new_shape is
+000090d0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+000090e0: 2020 2020 2020 2073 656c 662e 5f73 6861         self._sha
+000090f0: 7065 203d 206e 6577 5f73 6861 7065 0a20  pe = new_shape. 
+00009100: 2020 2020 2020 2064 7479 7065 203d 2070         dtype = p
+00009110: 6172 616d 732e 706f 7028 2264 7479 7065  arams.pop("dtype
+00009120: 222c 204e 6f6e 6529 0a20 2020 2020 2020  ", None).       
+00009130: 2069 6620 6474 7970 6520 6973 206e 6f74   if dtype is not
+00009140: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00009150: 2020 2073 656c 662e 5f64 7479 7065 203d     self._dtype =
+00009160: 2064 7479 7065 0a20 2020 2020 2020 2069   dtype.        i
+00009170: 6e64 6578 5f76 616c 7565 203d 2070 6172  ndex_value = par
+00009180: 616d 732e 706f 7028 2269 6e64 6578 5f76  ams.pop("index_v
+00009190: 616c 7565 222c 204e 6f6e 6529 0a20 2020  alue", None).   
+000091a0: 2020 2020 2069 6620 696e 6465 785f 7661       if index_va
+000091b0: 6c75 6520 6973 206e 6f74 204e 6f6e 653a  lue is not None:
+000091c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000091d0: 662e 5f69 6e64 6578 5f76 616c 7565 203d  f._index_value =
+000091e0: 2069 6e64 6578 5f76 616c 7565 0a20 2020   index_value.   
+000091f0: 2020 2020 206e 616d 6520 3d20 7061 7261       name = para
+00009200: 6d73 2e70 6f70 2822 6e61 6d65 222c 204e  ms.pop("name", N
+00009210: 6f6e 6529 0a20 2020 2020 2020 2069 6620  one).        if 
+00009220: 6e61 6d65 2069 7320 6e6f 7420 4e6f 6e65  name is not None
+00009230: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00009240: 6c66 2e5f 6e61 6d65 203d 206e 616d 650a  lf._name = name.
+00009250: 2020 2020 2020 2020 6966 2070 6172 616d          if param
+00009260: 733a 2020 2320 7072 6167 6d61 3a20 6e6f  s:  # pragma: no
+00009270: 2063 6f76 6572 0a20 2020 2020 2020 2020   cover.         
+00009280: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00009290: 6f72 2866 2255 6e6b 6e6f 776e 2070 6172  or(f"Unknown par
+000092a0: 616d 733a 207b 6c69 7374 2870 6172 616d  ams: {list(param
+000092b0: 7329 7d22 290a 0a20 2020 2070 6172 616d  s)}")..    param
+000092c0: 7320 3d20 7072 6f70 6572 7479 285f 6765  s = property(_ge
+000092d0: 745f 7061 7261 6d73 2c20 5f73 6574 5f70  t_params, _set_p
+000092e0: 6172 616d 7329 0a0a 2020 2020 4063 6c61  arams)..    @cla
+000092f0: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+00009300: 2067 6574 5f70 6172 616d 735f 6672 6f6d   get_params_from
+00009310: 5f64 6174 6128 636c 732c 2064 6174 613a  _data(cls, data:
+00009320: 2070 642e 5365 7269 6573 2920 2d3e 2044   pd.Series) -> D
+00009330: 6963 745b 7374 722c 2041 6e79 5d3a 0a20  ict[str, Any]:. 
+00009340: 2020 2020 2020 2072 6574 7572 6e20 7b0a         return {.
+00009350: 2020 2020 2020 2020 2020 2020 2273 6861              "sha
+00009360: 7065 223a 2064 6174 612e 7368 6170 652c  pe": data.shape,
+00009370: 0a20 2020 2020 2020 2020 2020 2022 6474  .            "dt
+00009380: 7970 6522 3a20 6461 7461 2e64 7479 7065  ype": data.dtype
+00009390: 2c0a 2020 2020 2020 2020 2020 2020 2269  ,.            "i
+000093a0: 6e64 6578 5f76 616c 7565 223a 2070 6172  ndex_value": par
+000093b0: 7365 5f69 6e64 6578 2864 6174 612e 696e  se_index(data.in
+000093c0: 6465 782c 2073 746f 7265 5f64 6174 613d  dex, store_data=
+000093d0: 4661 6c73 6529 2c0a 2020 2020 2020 2020  False),.        
+000093e0: 2020 2020 226e 616d 6522 3a20 6461 7461      "name": data
+000093f0: 2e6e 616d 652c 0a20 2020 2020 2020 207d  .name,.        }
+00009400: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00009410: 2020 2020 6465 6620 7368 6170 6528 7365      def shape(se
+00009420: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00009430: 7572 6e20 6765 7461 7474 7228 7365 6c66  urn getattr(self
+00009440: 2c20 225f 7368 6170 6522 2c20 4e6f 6e65  , "_shape", None
+00009450: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00009460: 0a20 2020 2064 6566 206e 6469 6d28 7365  .    def ndim(se
+00009470: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00009480: 7572 6e20 6c65 6e28 7365 6c66 2e73 6861  urn len(self.sha
+00009490: 7065 290a 0a20 2020 2040 7072 6f70 6572  pe)..    @proper
+000094a0: 7479 0a20 2020 2064 6566 2064 7479 7065  ty.    def dtype
+000094b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000094c0: 7265 7475 726e 2073 656c 662e 5f64 7479  return self._dty
+000094d0: 7065 0a0a 2020 2020 4070 726f 7065 7274  pe..    @propert
+000094e0: 790a 2020 2020 6465 6620 6e61 6d65 2873  y.    def name(s
+000094f0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00009500: 7475 726e 2073 656c 662e 5f6e 616d 650a  turn self._name.
+00009510: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00009520: 2020 2064 6566 2069 6e64 6578 5f76 616c     def index_val
+00009530: 7565 2873 656c 6629 3a0a 2020 2020 2020  ue(self):.      
+00009540: 2020 7265 7475 726e 2073 656c 662e 5f69    return self._i
+00009550: 6e64 6578 5f76 616c 7565 0a0a 0a63 6c61  ndex_value...cla
+00009560: 7373 2053 6572 6965 7343 6875 6e6b 4461  ss SeriesChunkDa
+00009570: 7461 2842 6173 6553 6572 6965 7343 6875  ta(BaseSeriesChu
+00009580: 6e6b 4461 7461 293a 0a20 2020 2074 7970  nkData):.    typ
+00009590: 655f 6e61 6d65 203d 2022 5365 7269 6573  e_name = "Series
+000095a0: 220a 0a0a 636c 6173 7320 5365 7269 6573  "...class Series
+000095b0: 4368 756e 6b28 4368 756e 6b29 3a0a 2020  Chunk(Chunk):.  
+000095c0: 2020 5f5f 736c 6f74 735f 5f20 3d20 2829    __slots__ = ()
+000095d0: 0a20 2020 205f 616c 6c6f 775f 6461 7461  .    _allow_data
+000095e0: 5f74 7970 655f 203d 2028 5365 7269 6573  _type_ = (Series
+000095f0: 4368 756e 6b44 6174 612c 290a 2020 2020  ChunkData,).    
+00009600: 7479 7065 5f6e 616d 6520 3d20 2253 6572  type_name = "Ser
+00009610: 6965 7322 0a0a 0a63 6c61 7373 2042 6173  ies"...class Bas
+00009620: 6553 6572 6965 7344 6174 6128 4861 7353  eSeriesData(HasS
+00009630: 6861 7065 5469 6c65 6162 6c65 4461 7461  hapeTileableData
+00009640: 2c20 5f54 6f50 616e 6461 734d 6978 696e  , _ToPandasMixin
+00009650: 293a 0a20 2020 205f 5f73 6c6f 7473 5f5f  ):.    __slots__
+00009660: 203d 2022 5f63 6163 6865 222c 2022 5f61   = "_cache", "_a
+00009670: 6363 6573 736f 7273 220a 0a20 2020 2023  ccessors"..    #
+00009680: 206f 7074 696f 6e61 6c20 6669 656c 640a   optional field.
+00009690: 2020 2020 5f64 7479 7065 203d 2044 6174      _dtype = Dat
+000096a0: 6154 7970 6546 6965 6c64 2822 6474 7970  aTypeField("dtyp
+000096b0: 6522 290a 2020 2020 5f6e 616d 6520 3d20  e").    _name = 
+000096c0: 416e 7946 6965 6c64 2822 6e61 6d65 2229  AnyField("name")
+000096d0: 0a20 2020 205f 696e 6465 785f 7661 6c75  .    _index_valu
+000096e0: 6520 3d20 5265 6665 7265 6e63 6546 6965  e = ReferenceFie
+000096f0: 6c64 280a 2020 2020 2020 2020 2269 6e64  ld(.        "ind
+00009700: 6578 5f76 616c 7565 222c 2049 6e64 6578  ex_value", Index
+00009710: 5661 6c75 652c 206f 6e5f 6465 7365 7269  Value, on_deseri
+00009720: 616c 697a 653d 5f6f 6e5f 6465 7365 7269  alize=_on_deseri
+00009730: 616c 697a 655f 696e 6465 785f 7661 6c75  alize_index_valu
+00009740: 650a 2020 2020 290a 2020 2020 5f63 6875  e.    ).    _chu
+00009750: 6e6b 7320 3d20 4c69 7374 4669 656c 6428  nks = ListField(
+00009760: 0a20 2020 2020 2020 2022 6368 756e 6b73  .        "chunks
+00009770: 222c 0a20 2020 2020 2020 2046 6965 6c64  ",.        Field
+00009780: 5479 7065 732e 7265 6665 7265 6e63 6528  Types.reference(
+00009790: 5365 7269 6573 4368 756e 6b44 6174 6129  SeriesChunkData)
+000097a0: 2c0a 2020 2020 2020 2020 6f6e 5f73 6572  ,.        on_ser
+000097b0: 6961 6c69 7a65 3d6c 616d 6264 6120 783a  ialize=lambda x:
+000097c0: 205b 6974 2e64 6174 6120 666f 7220 6974   [it.data for it
+000097d0: 2069 6e20 785d 2069 6620 7820 6973 206e   in x] if x is n
+000097e0: 6f74 204e 6f6e 6520 656c 7365 2078 2c0a  ot None else x,.
+000097f0: 2020 2020 2020 2020 6f6e 5f64 6573 6572          on_deser
+00009800: 6961 6c69 7a65 3d6c 616d 6264 6120 783a  ialize=lambda x:
+00009810: 205b 5365 7269 6573 4368 756e 6b28 6974   [SeriesChunk(it
+00009820: 2920 666f 7220 6974 2069 6e20 785d 2069  ) for it in x] i
+00009830: 6620 7820 6973 206e 6f74 204e 6f6e 6520  f x is not None 
+00009840: 656c 7365 2078 2c0a 2020 2020 290a 0a20  else x,.    ).. 
+00009850: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00009860: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00009870: 2020 2020 2020 206f 703d 4e6f 6e65 2c0a         op=None,.
+00009880: 2020 2020 2020 2020 7368 6170 653d 4e6f          shape=No
+00009890: 6e65 2c0a 2020 2020 2020 2020 6e73 706c  ne,.        nspl
+000098a0: 6974 733d 4e6f 6e65 2c0a 2020 2020 2020  its=None,.      
+000098b0: 2020 6474 7970 653d 4e6f 6e65 2c0a 2020    dtype=None,.  
+000098c0: 2020 2020 2020 6e61 6d65 3d4e 6f6e 652c        name=None,
+000098d0: 0a20 2020 2020 2020 2069 6e64 6578 5f76  .        index_v
+000098e0: 616c 7565 3d4e 6f6e 652c 0a20 2020 2020  alue=None,.     
+000098f0: 2020 2063 6875 6e6b 733d 4e6f 6e65 2c0a     chunks=None,.
+00009900: 2020 2020 2020 2020 2a2a 6b77 2c0a 2020          **kw,.  
+00009910: 2020 293a 0a20 2020 2020 2020 2073 7570    ):.        sup
+00009920: 6572 2829 2e5f 5f69 6e69 745f 5f28 0a20  er().__init__(. 
+00009930: 2020 2020 2020 2020 2020 205f 6f70 3d6f             _op=o
+00009940: 702c 0a20 2020 2020 2020 2020 2020 205f  p,.            _
+00009950: 7368 6170 653d 7368 6170 652c 0a20 2020  shape=shape,.   
+00009960: 2020 2020 2020 2020 205f 6e73 706c 6974           _nsplit
+00009970: 733d 6e73 706c 6974 732c 0a20 2020 2020  s=nsplits,.     
+00009980: 2020 2020 2020 205f 6474 7970 653d 6474         _dtype=dt
+00009990: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+000099a0: 205f 6e61 6d65 3d6e 616d 652c 0a20 2020   _name=name,.   
+000099b0: 2020 2020 2020 2020 205f 696e 6465 785f           _index_
+000099c0: 7661 6c75 653d 696e 6465 785f 7661 6c75  value=index_valu
+000099d0: 652c 0a20 2020 2020 2020 2020 2020 205f  e,.            _
+000099e0: 6368 756e 6b73 3d63 6875 6e6b 732c 0a20  chunks=chunks,. 
+000099f0: 2020 2020 2020 2020 2020 202a 2a6b 772c             **kw,
+00009a00: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00009a10: 2020 2073 656c 662e 5f61 6363 6573 736f     self._accesso
+00009a20: 7273 203d 2064 6963 7428 290a 0a20 2020  rs = dict()..   
+00009a30: 2064 6566 205f 6765 745f 7061 7261 6d73   def _get_params
+00009a40: 2873 656c 6629 202d 3e20 4469 6374 5b73  (self) -> Dict[s
+00009a50: 7472 2c20 416e 795d 3a0a 2020 2020 2020  tr, Any]:.      
+00009a60: 2020 2320 7061 7261 6d73 2072 6574 7572    # params retur
+00009a70: 6e20 7468 6520 7072 6f70 6572 7469 6573  n the properties
+00009a80: 2077 6869 6368 2075 7365 6675 6c20 746f   which useful to
+00009a90: 2072 6562 7569 6c64 2061 206e 6577 2074   rebuild a new t
+00009aa0: 696c 6561 626c 6520 6f62 6a65 6374 0a20  ileable object. 
+00009ab0: 2020 2020 2020 2072 6574 7572 6e20 7b0a         return {.
+00009ac0: 2020 2020 2020 2020 2020 2020 2273 6861              "sha
+00009ad0: 7065 223a 2073 656c 662e 7368 6170 652c  pe": self.shape,
+00009ae0: 0a20 2020 2020 2020 2020 2020 2022 6474  .            "dt
+00009af0: 7970 6522 3a20 7365 6c66 2e64 7479 7065  ype": self.dtype
+00009b00: 2c0a 2020 2020 2020 2020 2020 2020 226e  ,.            "n
+00009b10: 616d 6522 3a20 7365 6c66 2e6e 616d 652c  ame": self.name,
+00009b20: 0a20 2020 2020 2020 2020 2020 2022 696e  .            "in
+00009b30: 6465 785f 7661 6c75 6522 3a20 7365 6c66  dex_value": self
+00009b40: 2e69 6e64 6578 5f76 616c 7565 2c0a 2020  .index_value,.  
+00009b50: 2020 2020 2020 7d0a 0a20 2020 2064 6566        }..    def
+00009b60: 205f 7365 745f 7061 7261 6d73 2873 656c   _set_params(sel
+00009b70: 662c 206e 6577 5f70 6172 616d 733a 2044  f, new_params: D
+00009b80: 6963 745b 7374 722c 2041 6e79 5d29 3a0a  ict[str, Any]):.
+00009b90: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+00009ba0: 206e 6577 5f70 6172 616d 732e 636f 7079   new_params.copy
+00009bb0: 2829 0a20 2020 2020 2020 206e 6577 5f73  ().        new_s
+00009bc0: 6861 7065 203d 2070 6172 616d 732e 706f  hape = params.po
+00009bd0: 7028 2273 6861 7065 222c 204e 6f6e 6529  p("shape", None)
+00009be0: 0a20 2020 2020 2020 2069 6620 6e65 775f  .        if new_
+00009bf0: 7368 6170 6520 6973 206e 6f74 204e 6f6e  shape is not Non
+00009c00: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00009c10: 656c 662e 5f73 6861 7065 203d 206e 6577  elf._shape = new
+00009c20: 5f73 6861 7065 0a20 2020 2020 2020 2064  _shape.        d
+00009c30: 7479 7065 203d 2070 6172 616d 732e 706f  type = params.po
+00009c40: 7028 2264 7479 7065 222c 204e 6f6e 6529  p("dtype", None)
+00009c50: 0a20 2020 2020 2020 2069 6620 6474 7970  .        if dtyp
+00009c60: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+00009c70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00009c80: 5f64 7479 7065 203d 2064 7479 7065 0a20  _dtype = dtype. 
+00009c90: 2020 2020 2020 2069 6e64 6578 5f76 616c         index_val
+00009ca0: 7565 203d 2070 6172 616d 732e 706f 7028  ue = params.pop(
+00009cb0: 2269 6e64 6578 5f76 616c 7565 222c 204e  "index_value", N
+00009cc0: 6f6e 6529 0a20 2020 2020 2020 2069 6620  one).        if 
+00009cd0: 696e 6465 785f 7661 6c75 6520 6973 206e  index_value is n
+00009ce0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00009cf0: 2020 2020 2073 656c 662e 5f69 6e64 6578       self._index
+00009d00: 5f76 616c 7565 203d 2069 6e64 6578 5f76  _value = index_v
+00009d10: 616c 7565 0a20 2020 2020 2020 206e 616d  alue.        nam
+00009d20: 6520 3d20 7061 7261 6d73 2e70 6f70 2822  e = params.pop("
+00009d30: 6e61 6d65 222c 204e 6f6e 6529 0a20 2020  name", None).   
+00009d40: 2020 2020 2069 6620 6e61 6d65 2069 7320       if name is 
+00009d50: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00009d60: 2020 2020 2020 7365 6c66 2e5f 6e61 6d65        self._name
+00009d70: 203d 206e 616d 650a 2020 2020 2020 2020   = name.        
+00009d80: 6966 2070 6172 616d 733a 2020 2320 7072  if params:  # pr
+00009d90: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a20  agma: no cover. 
+00009da0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00009db0: 2054 7970 6545 7272 6f72 2866 2255 6e6b   TypeError(f"Unk
+00009dc0: 6e6f 776e 2070 6172 616d 733a 207b 6c69  nown params: {li
+00009dd0: 7374 2870 6172 616d 7329 7d22 290a 0a20  st(params)}").. 
+00009de0: 2020 2070 6172 616d 7320 3d20 7072 6f70     params = prop
+00009df0: 6572 7479 285f 6765 745f 7061 7261 6d73  erty(_get_params
+00009e00: 2c20 5f73 6574 5f70 6172 616d 7329 0a0a  , _set_params)..
+00009e10: 2020 2020 6465 6620 7265 6672 6573 685f      def refresh_
+00009e20: 7061 7261 6d73 2873 656c 6629 3a0a 2020  params(self):.  
+00009e30: 2020 2020 2020 2320 7265 6672 6573 6820        # refresh 
+00009e40: 7061 7261 6d73 2077 6865 6e20 6368 756e  params when chun
+00009e50: 6b73 2075 7064 6174 6564 0a20 2020 2020  ks updated.     
+00009e60: 2020 2072 6566 7265 7368 5f74 696c 6561     refresh_tilea
+00009e70: 626c 655f 7368 6170 6528 7365 6c66 290a  ble_shape(self).
+00009e80: 2020 2020 2020 2020 7265 6672 6573 685f          refresh_
+00009e90: 696e 6465 785f 7661 6c75 6528 7365 6c66  index_value(self
+00009ea0: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
+00009eb0: 662e 5f64 7479 7065 2069 7320 4e6f 6e65  f._dtype is None
+00009ec0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00009ed0: 6c66 2e5f 6474 7970 6520 3d20 7365 6c66  lf._dtype = self
+00009ee0: 2e63 6875 6e6b 735b 305d 2e64 7479 7065  .chunks[0].dtype
+00009ef0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00009f00: 2e5f 6e61 6d65 2069 7320 4e6f 6e65 3a0a  ._name is None:.
+00009f10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00009f20: 2e5f 6e61 6d65 203d 2073 656c 662e 6368  ._name = self.ch
+00009f30: 756e 6b73 5b30 5d2e 6e61 6d65 0a0a 2020  unks[0].name..  
+00009f40: 2020 6465 6620 5f74 6f5f 7374 7228 7365    def _to_str(se
+00009f50: 6c66 2c20 7265 7072 6573 656e 7461 7469  lf, representati
+00009f60: 6f6e 3d46 616c 7365 293a 0a20 2020 2020  on=False):.     
+00009f70: 2020 2069 6620 6973 5f62 7569 6c64 5f6d     if is_build_m
+00009f80: 6f64 6528 2920 6f72 206c 656e 2873 656c  ode() or len(sel
+00009f90: 662e 5f65 7865 6375 7465 645f 7365 7373  f._executed_sess
+00009fa0: 696f 6e73 2920 3d3d 2030 3a0a 2020 2020  ions) == 0:.    
+00009fb0: 2020 2020 2020 2020 2320 696e 2062 7569          # in bui
+00009fc0: 6c64 206d 6f64 652c 206f 7220 6e6f 7420  ld mode, or not 
+00009fd0: 6578 6563 7574 6564 2c20 6a75 7374 2072  executed, just r
+00009fe0: 6574 7572 6e20 7265 7072 6573 656e 7461  eturn representa
+00009ff0: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+0000a000: 2069 6620 7265 7072 6573 656e 7461 7469   if representati
+0000a010: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+0000a020: 2020 2020 7265 7475 726e 2028 0a20 2020      return (.   
+0000a030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a040: 2066 227b 7365 6c66 2e74 7970 655f 6e61   f"{self.type_na
+0000a050: 6d65 7d20 3c6f 703d 7b74 7970 6528 7365  me} <op={type(se
+0000a060: 6c66 2e5f 6f70 292e 5f5f 6e61 6d65 5f5f  lf._op).__name__
+0000a070: 7d2c 206b 6579 3d7b 7365 6c66 2e6b 6579  }, key={self.key
+0000a080: 7d3e 220a 2020 2020 2020 2020 2020 2020  }>".            
+0000a090: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000a0a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000a0b0: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+0000a0c0: 227b 7365 6c66 2e74 7970 655f 6e61 6d65  "{self.type_name
+0000a0d0: 7d28 6f70 3d7b 7479 7065 2873 656c 662e  }(op={type(self.
+0000a0e0: 5f6f 7029 2e5f 5f6e 616d 655f 5f7d 2922  _op).__name__})"
+0000a0f0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000a100: 2020 2020 2020 2020 2020 2063 6f72 6e65             corne
+0000a110: 725f 6461 7461 203d 2066 6574 6368 5f63  r_data = fetch_c
+0000a120: 6f72 6e65 725f 6461 7461 2873 656c 662c  orner_data(self,
+0000a130: 2073 6573 7369 6f6e 3d73 656c 662e 5f65   session=self._e
+0000a140: 7865 6375 7465 645f 7365 7373 696f 6e73  xecuted_sessions
+0000a150: 5b2d 315d 290a 0a20 2020 2020 2020 2020  [-1])..         
+0000a160: 2020 2062 7566 203d 2053 7472 696e 6749     buf = StringI
+0000a170: 4f28 290a 2020 2020 2020 2020 2020 2020  O().            
+0000a180: 6d61 785f 726f 7773 203d 2070 642e 6765  max_rows = pd.ge
+0000a190: 745f 6f70 7469 6f6e 2822 6469 7370 6c61  t_option("displa
+0000a1a0: 792e 6d61 785f 726f 7773 2229 0a20 2020  y.max_rows").   
+0000a1b0: 2020 2020 2020 2020 2063 6f72 6e65 725f           corner_
+0000a1c0: 6d61 785f 726f 7773 203d 2028 0a20 2020  max_rows = (.   
+0000a1d0: 2020 2020 2020 2020 2020 2020 206d 6178               max
+0000a1e0: 5f72 6f77 7320 6966 2073 656c 662e 7368  _rows if self.sh
+0000a1f0: 6170 655b 305d 203c 3d20 6d61 785f 726f  ape[0] <= max_ro
+0000a200: 7773 2065 6c73 6520 636f 726e 6572 5f64  ws else corner_d
+0000a210: 6174 612e 7368 6170 655b 305d 202d 2031  ata.shape[0] - 1
+0000a220: 0a20 2020 2020 2020 2020 2020 2029 2020  .            )  
+0000a230: 2320 6d61 6b65 2073 7572 6520 6d61 785f  # make sure max_
+0000a240: 726f 7773 203c 2063 6f72 6e65 725f 6461  rows < corner_da
+0000a250: 7461 0a0a 2020 2020 2020 2020 2020 2020  ta..            
+0000a260: 7769 7468 2070 642e 6f70 7469 6f6e 5f63  with pd.option_c
+0000a270: 6f6e 7465 7874 2822 6469 7370 6c61 792e  ontext("display.
+0000a280: 6d61 785f 726f 7773 222c 2063 6f72 6e65  max_rows", corne
+0000a290: 725f 6d61 785f 726f 7773 293a 0a20 2020  r_max_rows):.   
+0000a2a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000a2b0: 7365 6c66 2e73 6861 7065 5b30 5d20 3c3d  self.shape[0] <=
+0000a2c0: 206d 6178 5f72 6f77 733a 0a20 2020 2020   max_rows:.     
+0000a2d0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000a2e0: 6f72 6e65 725f 7365 7269 6573 203d 2063  orner_series = c
+0000a2f0: 6f72 6e65 725f 6461 7461 0a20 2020 2020  orner_data.     
+0000a300: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0000a310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a320: 2020 2020 2063 6f72 6e65 725f 7365 7269       corner_seri
+0000a330: 6573 203d 2052 6570 7253 6572 6965 7328  es = ReprSeries(
+0000a340: 636f 726e 6572 5f64 6174 612c 2073 656c  corner_data, sel
+0000a350: 662e 7368 6170 6529 0a20 2020 2020 2020  f.shape).       
+0000a360: 2020 2020 2020 2020 2062 7566 2e77 7269           buf.wri
+0000a370: 7465 2872 6570 7228 636f 726e 6572 5f73  te(repr(corner_s
+0000a380: 6572 6965 7329 2069 6620 7265 7072 6573  eries) if repres
+0000a390: 656e 7461 7469 6f6e 2065 6c73 6520 7374  entation else st
+0000a3a0: 7228 636f 726e 6572 5f73 6572 6965 7329  r(corner_series)
+0000a3b0: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
+0000a3c0: 6574 7572 6e20 6275 662e 6765 7476 616c  eturn buf.getval
+0000a3d0: 7565 2829 0a0a 2020 2020 6465 6620 5f5f  ue()..    def __
+0000a3e0: 7374 725f 5f28 7365 6c66 293a 0a20 2020  str__(self):.   
+0000a3f0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000a400: 2e5f 746f 5f73 7472 2872 6570 7265 7365  ._to_str(represe
+0000a410: 6e74 6174 696f 6e3d 4661 6c73 6529 0a0a  ntation=False)..
+0000a420: 2020 2020 6465 6620 5f5f 7265 7072 5f5f      def __repr__
+0000a430: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000a440: 7265 7475 726e 2073 656c 662e 5f74 6f5f  return self._to_
+0000a450: 7374 7228 7265 7072 6573 656e 7461 7469  str(representati
+0000a460: 6f6e 3d46 616c 7365 290a 0a20 2020 2040  on=False)..    @
+0000a470: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000a480: 2064 7479 7065 2873 656c 6629 3a0a 2020   dtype(self):.  
+0000a490: 2020 2020 2020 7265 7475 726e 2067 6574        return get
+0000a4a0: 6174 7472 2873 656c 662c 2022 5f64 7479  attr(self, "_dty
+0000a4b0: 7065 222c 204e 6f6e 6529 206f 7220 6765  pe", None) or ge
+0000a4c0: 7461 7474 7228 7365 6c66 2e6f 702c 2022  tattr(self.op, "
+0000a4d0: 6474 7970 6522 2c20 4e6f 6e65 290a 0a20  dtype", None).. 
+0000a4e0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0000a4f0: 2064 6566 206e 616d 6528 7365 6c66 293a   def name(self):
+0000a500: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000a510: 7365 6c66 2e5f 6e61 6d65 0a0a 2020 2020  self._name..    
+0000a520: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000a530: 6620 696e 6465 785f 7661 6c75 6528 7365  f index_value(se
+0000a540: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+0000a550: 7572 6e20 7365 6c66 2e5f 696e 6465 785f  urn self._index_
+0000a560: 7661 6c75 650a 0a20 2020 2040 7072 6f70  value..    @prop
+0000a570: 6572 7479 0a20 2020 2064 6566 2069 6e64  erty.    def ind
+0000a580: 6578 2873 656c 6629 3a0a 2020 2020 2020  ex(self):.      
+0000a590: 2020 6672 6f6d 202e 6461 7461 736f 7572    from .datasour
+0000a5a0: 6365 2e69 6e64 6578 2069 6d70 6f72 7420  ce.index import 
+0000a5b0: 6672 6f6d 5f74 696c 6561 626c 650a 0a20  from_tileable.. 
+0000a5c0: 2020 2020 2020 2072 6574 7572 6e20 6672         return fr
+0000a5d0: 6f6d 5f74 696c 6561 626c 6528 7365 6c66  om_tileable(self
+0000a5e0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+0000a5f0: 0a20 2020 2064 6566 2061 7865 7328 7365  .    def axes(se
+0000a600: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+0000a610: 7572 6e20 5b73 656c 662e 696e 6465 785d  urn [self.index]
+0000a620: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0000a630: 2020 2020 6465 6620 656d 7074 7928 7365      def empty(se
+0000a640: 6c66 293a 0a20 2020 2020 2020 2073 6861  lf):.        sha
+0000a650: 7065 203d 2067 6574 6174 7472 2873 656c  pe = getattr(sel
+0000a660: 662c 2022 5f73 6861 7065 2229 0a20 2020  f, "_shape").   
+0000a670: 2020 2020 2069 6620 6e70 2e61 6e79 286e       if np.any(n
+0000a680: 702e 6973 6e61 6e28 7368 6170 6529 293a  p.isnan(shape)):
+0000a690: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000a6a0: 7365 2056 616c 7565 4572 726f 7228 2254  se ValueError("T
+0000a6b0: 696c 6561 626c 6520 6f62 6a65 6374 206d  ileable object m
+0000a6c0: 7573 7420 6265 2065 7865 6375 7465 6420  ust be executed 
+0000a6d0: 6669 7273 7422 290a 2020 2020 2020 2020  first").        
+0000a6e0: 7265 7475 726e 2073 6861 7065 203d 3d20  return shape == 
+0000a6f0: 2830 2c29 0a0a 2020 2020 6465 6620 746f  (0,)..    def to
+0000a700: 5f74 656e 736f 7228 7365 6c66 2c20 6474  _tensor(self, dt
+0000a710: 7970 653d 4e6f 6e65 293a 0a20 2020 2020  ype=None):.     
+0000a720: 2020 2066 726f 6d20 2e2e 7465 6e73 6f72     from ..tensor
+0000a730: 2e64 6174 6173 6f75 7263 652e 6672 6f6d  .datasource.from
+0000a740: 5f64 6174 6166 7261 6d65 2069 6d70 6f72  _dataframe impor
+0000a750: 7420 6672 6f6d 5f73 6572 6965 730a 0a20  t from_series.. 
+0000a760: 2020 2020 2020 2072 6574 7572 6e20 6672         return fr
+0000a770: 6f6d 5f73 6572 6965 7328 7365 6c66 2c20  om_series(self, 
+0000a780: 6474 7970 653d 6474 7970 6529 0a0a 2020  dtype=dtype)..  
+0000a790: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
+0000a7a0: 2020 2020 6465 6620 6672 6f6d 5f74 656e      def from_ten
+0000a7b0: 736f 7228 696e 5f74 656e 736f 722c 2069  sor(in_tensor, i
+0000a7c0: 6e64 6578 3d4e 6f6e 652c 206e 616d 653d  ndex=None, name=
+0000a7d0: 4e6f 6e65 293a 0a20 2020 2020 2020 2066  None):.        f
+0000a7e0: 726f 6d20 2e64 6174 6173 6f75 7263 652e  rom .datasource.
+0000a7f0: 6672 6f6d 5f74 656e 736f 7220 696d 706f  from_tensor impo
+0000a800: 7274 2073 6572 6965 735f 6672 6f6d 5f74  rt series_from_t
+0000a810: 656e 736f 720a 0a20 2020 2020 2020 2072  ensor..        r
+0000a820: 6574 7572 6e20 7365 7269 6573 5f66 726f  eturn series_fro
+0000a830: 6d5f 7465 6e73 6f72 2869 6e5f 7465 6e73  m_tensor(in_tens
+0000a840: 6f72 2c20 696e 6465 783d 696e 6465 782c  or, index=index,
+0000a850: 206e 616d 653d 6e61 6d65 290a 0a0a 636c   name=name)...cl
+0000a860: 6173 7320 5365 7269 6573 4461 7461 285f  ass SeriesData(_
+0000a870: 4261 7463 6865 6446 6574 6368 6572 2c20  BatchedFetcher, 
+0000a880: 4261 7365 5365 7269 6573 4461 7461 293a  BaseSeriesData):
+0000a890: 0a20 2020 2074 7970 655f 6e61 6d65 203d  .    type_name =
+0000a8a0: 2022 5365 7269 6573 220a 0a20 2020 2064   "Series"..    d
+0000a8b0: 6566 205f 5f6d 6172 735f 7465 6e73 6f72  ef __mars_tensor
+0000a8c0: 5f5f 2873 656c 662c 2064 7479 7065 3d4e  __(self, dtype=N
+0000a8d0: 6f6e 652c 206f 7264 6572 3d22 4b22 293a  one, order="K"):
+0000a8e0: 0a20 2020 2020 2020 2074 656e 736f 7220  .        tensor 
+0000a8f0: 3d20 7365 6c66 2e74 6f5f 7465 6e73 6f72  = self.to_tensor
+0000a900: 2829 0a20 2020 2020 2020 2064 7479 7065  ().        dtype
+0000a910: 203d 2064 7479 7065 2069 6620 6474 7970   = dtype if dtyp
+0000a920: 6520 6973 206e 6f74 204e 6f6e 6520 656c  e is not None el
+0000a930: 7365 2074 656e 736f 722e 6474 7970 650a  se tensor.dtype.
+0000a940: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+0000a950: 656e 736f 722e 6173 7479 7065 2864 7479  ensor.astype(dty
+0000a960: 7065 3d64 7479 7065 2c20 6f72 6465 723d  pe=dtype, order=
+0000a970: 6f72 6465 722c 2063 6f70 793d 4661 6c73  order, copy=Fals
+0000a980: 6529 0a0a 2020 2020 6465 6620 6974 656d  e)..    def item
+0000a990: 7328 7365 6c66 2c20 6261 7463 685f 7369  s(self, batch_si
+0000a9a0: 7a65 3d31 3030 3030 2c20 7365 7373 696f  ze=10000, sessio
+0000a9b0: 6e3d 4e6f 6e65 293a 0a20 2020 2020 2020  n=None):.       
+0000a9c0: 2066 6f72 2062 6174 6368 5f64 6174 6120   for batch_data 
+0000a9d0: 696e 2073 656c 662e 6974 6572 6261 7463  in self.iterbatc
+0000a9e0: 6828 6261 7463 685f 7369 7a65 3d62 6174  h(batch_size=bat
+0000a9f0: 6368 5f73 697a 652c 2073 6573 7369 6f6e  ch_size, session
+0000aa00: 3d73 6573 7369 6f6e 293a 0a20 2020 2020  =session):.     
+0000aa10: 2020 2020 2020 2079 6965 6c64 2066 726f         yield fro
+0000aa20: 6d20 6765 7461 7474 7228 6261 7463 685f  m getattr(batch_
+0000aa30: 6461 7461 2c20 2269 7465 6d73 2229 2829  data, "items")()
+0000aa40: 0a0a 2020 2020 6465 6620 746f 5f64 6963  ..    def to_dic
+0000aa50: 7428 7365 6c66 2c20 696e 746f 3d64 6963  t(self, into=dic
+0000aa60: 742c 2062 6174 6368 5f73 697a 653d 3130  t, batch_size=10
+0000aa70: 3030 302c 2073 6573 7369 6f6e 3d4e 6f6e  000, session=Non
+0000aa80: 6529 3a0a 2020 2020 2020 2020 6665 7463  e):.        fetc
+0000aa90: 685f 6b77 6172 6773 203d 2064 6963 7428  h_kwargs = dict(
+0000aaa0: 6261 7463 685f 7369 7a65 3d62 6174 6368  batch_size=batch
+0000aab0: 5f73 697a 6529 0a20 2020 2020 2020 2072  _size).        r
+0000aac0: 6574 7572 6e20 7365 6c66 2e74 6f5f 7061  eturn self.to_pa
+0000aad0: 6e64 6173 2873 6573 7369 6f6e 3d73 6573  ndas(session=ses
+0000aae0: 7369 6f6e 2c20 6665 7463 685f 6b77 6172  sion, fetch_kwar
+0000aaf0: 6773 3d66 6574 6368 5f6b 7761 7267 7329  gs=fetch_kwargs)
+0000ab00: 2e74 6f5f 6469 6374 280a 2020 2020 2020  .to_dict(.      
+0000ab10: 2020 2020 2020 696e 746f 3d69 6e74 6f0a        into=into.
+0000ab20: 2020 2020 2020 2020 290a 0a0a 636c 6173          )...clas
+0000ab30: 7320 5365 7269 6573 2848 6173 5368 6170  s Series(HasShap
+0000ab40: 6554 696c 6561 626c 652c 205f 546f 5061  eTileable, _ToPa
+0000ab50: 6e64 6173 4d69 7869 6e29 3a0a 2020 2020  ndasMixin):.    
+0000ab60: 5f5f 736c 6f74 735f 5f20 3d20 2822 5f63  __slots__ = ("_c
+0000ab70: 6163 6865 222c 290a 2020 2020 5f61 6c6c  ache",).    _all
+0000ab80: 6f77 5f64 6174 615f 7479 7065 5f20 3d20  ow_data_type_ = 
+0000ab90: 2853 6572 6965 7344 6174 612c 290a 2020  (SeriesData,).  
+0000aba0: 2020 7479 7065 5f6e 616d 6520 3d20 2253    type_name = "S
+0000abb0: 6572 6965 7322 0a0a 2020 2020 6465 6620  eries"..    def 
+0000abc0: 746f 5f74 656e 736f 7228 7365 6c66 2c20  to_tensor(self, 
+0000abd0: 6474 7970 653d 4e6f 6e65 293a 0a20 2020  dtype=None):.   
+0000abe0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000abf0: 2e5f 6461 7461 2e74 6f5f 7465 6e73 6f72  ._data.to_tensor
+0000ac00: 2864 7479 7065 3d64 7479 7065 290a 0a20  (dtype=dtype).. 
+0000ac10: 2020 2064 6566 2066 726f 6d5f 7465 6e73     def from_tens
+0000ac20: 6f72 2873 656c 662c 2069 6e5f 7465 6e73  or(self, in_tens
+0000ac30: 6f72 2c20 696e 6465 783d 4e6f 6e65 2c20  or, index=None, 
+0000ac40: 6e61 6d65 3d4e 6f6e 6529 3a0a 2020 2020  name=None):.    
+0000ac50: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000ac60: 5f64 6174 612e 6672 6f6d 5f74 656e 736f  _data.from_tenso
+0000ac70: 7228 696e 5f74 656e 736f 722c 2069 6e64  r(in_tensor, ind
+0000ac80: 6578 3d69 6e64 6578 2c20 6e61 6d65 3d6e  ex=index, name=n
+0000ac90: 616d 6529 0a0a 2020 2020 4070 726f 7065  ame)..    @prope
+0000aca0: 7274 790a 2020 2020 6465 6620 5428 7365  rty.    def T(se
+0000acb0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0000acc0: 5265 7475 726e 2074 6865 2074 7261 6e73  Return the trans
+0000acd0: 706f 7365 2c20 7768 6963 6820 6973 2062  pose, which is b
+0000ace0: 7920 6465 6669 6e69 7469 6f6e 2073 656c  y definition sel
+0000acf0: 662e 2222 220a 2020 2020 2020 2020 7265  f.""".        re
+0000ad00: 7475 726e 2073 656c 660a 0a20 2020 2040  turn self..    @
+0000ad10: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000ad20: 206e 6469 6d28 7365 6c66 293a 0a20 2020   ndim(self):.   
+0000ad30: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000ad40: 2052 6574 7572 6e20 616e 2069 6e74 2072   Return an int r
+0000ad50: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
+0000ad60: 6e75 6d62 6572 206f 6620 6178 6573 202f  number of axes /
+0000ad70: 2061 7272 6179 2064 696d 656e 7369 6f6e   array dimension
+0000ad80: 732e 0a0a 2020 2020 2020 2020 5265 7475  s...        Retu
+0000ad90: 726e 2031 2069 6620 5365 7269 6573 2e20  rn 1 if Series. 
+0000ada0: 4f74 6865 7277 6973 6520 7265 7475 726e  Otherwise return
+0000adb0: 2032 2069 6620 4461 7461 4672 616d 652e   2 if DataFrame.
+0000adc0: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+0000add0: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+0000ade0: 2d2d 2d0a 2020 2020 2020 2020 6e64 6172  ---.        ndar
+0000adf0: 7261 792e 6e64 696d 203a 204e 756d 6265  ray.ndim : Numbe
+0000ae00: 7220 6f66 2061 7272 6179 2064 696d 656e  r of array dimen
+0000ae10: 7369 6f6e 732e 0a0a 2020 2020 2020 2020  sions...        
+0000ae20: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+0000ae30: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+0000ae40: 2020 3e3e 3e20 696d 706f 7274 206d 6172    >>> import mar
+0000ae50: 732e 6461 7461 6672 616d 6520 6173 206d  s.dataframe as m
+0000ae60: 640a 2020 2020 2020 2020 3e3e 3e20 7320  d.        >>> s 
+0000ae70: 3d20 6d64 2e53 6572 6965 7328 7b27 6127  = md.Series({'a'
+0000ae80: 3a20 312c 2027 6227 3a20 322c 2027 6327  : 1, 'b': 2, 'c'
+0000ae90: 3a20 337d 290a 2020 2020 2020 2020 3e3e  : 3}).        >>
+0000aea0: 3e20 732e 6e64 696d 2e65 7865 6375 7465  > s.ndim.execute
+0000aeb0: 2829 0a20 2020 2020 2020 2031 0a0a 2020  ().        1..  
+0000aec0: 2020 2020 2020 3e3e 3e20 6466 203d 206d        >>> df = m
+0000aed0: 642e 4461 7461 4672 616d 6528 7b27 636f  d.DataFrame({'co
+0000aee0: 6c31 273a 205b 312c 2032 5d2c 2027 636f  l1': [1, 2], 'co
+0000aef0: 6c32 273a 205b 332c 2034 5d7d 290a 2020  l2': [3, 4]}).  
+0000af00: 2020 2020 2020 3e3e 3e20 6466 2e6e 6469        >>> df.ndi
+0000af10: 6d2e 6578 6563 7574 6528 290a 2020 2020  m.execute().    
+0000af20: 2020 2020 320a 2020 2020 2020 2020 2222      2.        ""
+0000af30: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0000af40: 2073 7570 6572 2829 2e6e 6469 6d0a 0a20   super().ndim.. 
+0000af50: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0000af60: 2064 6566 2069 6e64 6578 2873 656c 6629   def index(self)
+0000af70: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000af80: 2020 2020 2020 5468 6520 696e 6465 7820        The index 
+0000af90: 2861 7869 7320 6c61 6265 6c73 2920 6f66  (axis labels) of
+0000afa0: 2074 6865 2053 6572 6965 732e 0a20 2020   the Series..   
+0000afb0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000afc0: 2069 6478 203d 2073 656c 662e 5f64 6174   idx = self._dat
+0000afd0: 612e 696e 6465 780a 2020 2020 2020 2020  a.index.        
+0000afe0: 6964 782e 5f73 6574 5f64 665f 6f72 5f73  idx._set_df_or_s
+0000aff0: 6572 6965 7328 7365 6c66 2c20 3029 0a20  eries(self, 0). 
+0000b000: 2020 2020 2020 2072 6574 7572 6e20 6964         return id
+0000b010: 780a 0a20 2020 2040 696e 6465 782e 7365  x..    @index.se
+0000b020: 7474 6572 0a20 2020 2064 6566 2069 6e64  tter.    def ind
+0000b030: 6578 2873 656c 662c 206e 6577 5f69 6e64  ex(self, new_ind
+0000b040: 6578 293a 0a20 2020 2020 2020 2073 656c  ex):.        sel
+0000b050: 662e 7365 745f 6178 6973 286e 6577 5f69  f.set_axis(new_i
+0000b060: 6e64 6578 2c20 6178 6973 3d30 2c20 636f  ndex, axis=0, co
+0000b070: 7079 3d46 616c 7365 290a 0a20 2020 2040  py=False)..    @
+0000b080: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000b090: 206e 616d 6528 7365 6c66 293a 0a20 2020   name(self):.   
+0000b0a0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000b0b0: 2e5f 6461 7461 2e6e 616d 650a 0a20 2020  ._data.name..   
+0000b0c0: 2040 6e61 6d65 2e73 6574 7465 720a 2020   @name.setter.  
+0000b0d0: 2020 6465 6620 6e61 6d65 2873 656c 662c    def name(self,
+0000b0e0: 2076 616c 293a 0a20 2020 2020 2020 2066   val):.        f
+0000b0f0: 726f 6d20 2e69 6e64 6578 696e 672e 7265  rom .indexing.re
+0000b100: 6e61 6d65 2069 6d70 6f72 7420 4461 7461  name import Data
+0000b110: 4672 616d 6552 656e 616d 650a 0a20 2020  FrameRename..   
+0000b120: 2020 2020 206f 7020 3d20 4461 7461 4672       op = DataFr
+0000b130: 616d 6552 656e 616d 6528 6e65 775f 6e61  ameRename(new_na
+0000b140: 6d65 3d76 616c 2c20 6f75 7470 7574 5f74  me=val, output_t
+0000b150: 7970 6573 3d5b 4f75 7470 7574 5479 7065  ypes=[OutputType
+0000b160: 2e73 6572 6965 735d 290a 2020 2020 2020  .series]).      
+0000b170: 2020 6e65 775f 7365 7269 6573 203d 206f    new_series = o
+0000b180: 7028 7365 6c66 290a 2020 2020 2020 2020  p(self).        
+0000b190: 7365 6c66 2e64 6174 6120 3d20 6e65 775f  self.data = new_
+0000b1a0: 7365 7269 6573 2e64 6174 610a 0a20 2020  series.data..   
+0000b1b0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0000b1c0: 6566 2064 7479 7065 2873 656c 6629 3a0a  ef dtype(self):.
+0000b1d0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000b1e0: 2020 2020 5265 7475 726e 2074 6865 2064      Return the d
+0000b1f0: 7479 7065 206f 626a 6563 7420 6f66 2074  type object of t
+0000b200: 6865 2075 6e64 6572 6c79 696e 6720 6461  he underlying da
+0000b210: 7461 2e0a 2020 2020 2020 2020 2222 220a  ta..        """.
+0000b220: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000b230: 656c 662e 5f64 6174 612e 6474 7970 650a  elf._data.dtype.
+0000b240: 0a20 2020 2064 6566 2063 6f70 7928 7365  .    def copy(se
+0000b250: 6c66 2c20 6465 6570 3d54 7275 6529 3a20  lf, deep=True): 
+0000b260: 2023 2070 796c 696e 743a 2064 6973 6162   # pylint: disab
+0000b270: 6c65 3d61 7267 756d 656e 7473 2d64 6966  le=arguments-dif
+0000b280: 6665 720a 2020 2020 2020 2020 2222 220a  fer.        """.
+0000b290: 2020 2020 2020 2020 4d61 6b65 2061 2063          Make a c
+0000b2a0: 6f70 7920 6f66 2074 6869 7320 6f62 6a65  opy of this obje
+0000b2b0: 6374 2773 2069 6e64 6963 6573 2061 6e64  ct's indices and
+0000b2c0: 2064 6174 612e 0a0a 2020 2020 2020 2020   data...        
+0000b2d0: 5768 656e 2060 6064 6565 703d 5472 7565  When ``deep=True
+0000b2e0: 6060 2028 6465 6661 756c 7429 2c20 6120  `` (default), a 
+0000b2f0: 6e65 7720 6f62 6a65 6374 2077 696c 6c20  new object will 
+0000b300: 6265 2063 7265 6174 6564 2077 6974 6820  be created with 
+0000b310: 610a 2020 2020 2020 2020 636f 7079 206f  a.        copy o
+0000b320: 6620 7468 6520 6361 6c6c 696e 6720 6f62  f the calling ob
+0000b330: 6a65 6374 2773 2064 6174 6120 616e 6420  ject's data and 
+0000b340: 696e 6469 6365 732e 204d 6f64 6966 6963  indices. Modific
+0000b350: 6174 696f 6e73 2074 6f0a 2020 2020 2020  ations to.      
+0000b360: 2020 7468 6520 6461 7461 206f 7220 696e    the data or in
+0000b370: 6469 6365 7320 6f66 2074 6865 2063 6f70  dices of the cop
+0000b380: 7920 7769 6c6c 206e 6f74 2062 6520 7265  y will not be re
+0000b390: 666c 6563 7465 6420 696e 2074 6865 0a20  flected in the. 
+0000b3a0: 2020 2020 2020 206f 7269 6769 6e61 6c20         original 
+0000b3b0: 6f62 6a65 6374 2028 7365 6520 6e6f 7465  object (see note
+0000b3c0: 7320 6265 6c6f 7729 2e0a 0a20 2020 2020  s below)...     
+0000b3d0: 2020 2057 6865 6e20 6060 6465 6570 3d46     When ``deep=F
+0000b3e0: 616c 7365 6060 2c20 6120 6e65 7720 6f62  alse``, a new ob
+0000b3f0: 6a65 6374 2077 696c 6c20 6265 2063 7265  ject will be cre
+0000b400: 6174 6564 2077 6974 686f 7574 2063 6f70  ated without cop
+0000b410: 7969 6e67 0a20 2020 2020 2020 2074 6865  ying.        the
+0000b420: 2063 616c 6c69 6e67 206f 626a 6563 7427   calling object'
+0000b430: 7320 6461 7461 206f 7220 696e 6465 7820  s data or index 
+0000b440: 286f 6e6c 7920 7265 6665 7265 6e63 6573  (only references
+0000b450: 2074 6f20 7468 6520 6461 7461 0a20 2020   to the data.   
+0000b460: 2020 2020 2061 6e64 2069 6e64 6578 2061       and index a
+0000b470: 7265 2063 6f70 6965 6429 2e20 416e 7920  re copied). Any 
+0000b480: 6368 616e 6765 7320 746f 2074 6865 2064  changes to the d
+0000b490: 6174 6120 6f66 2074 6865 206f 7269 6769  ata of the origi
+0000b4a0: 6e61 6c0a 2020 2020 2020 2020 7769 6c6c  nal.        will
+0000b4b0: 2062 6520 7265 666c 6563 7465 6420 696e   be reflected in
+0000b4c0: 2074 6865 2073 6861 6c6c 6f77 2063 6f70   the shallow cop
+0000b4d0: 7920 2861 6e64 2076 6963 6520 7665 7273  y (and vice vers
+0000b4e0: 6129 2e0a 0a20 2020 2020 2020 2050 6172  a)...        Par
+0000b4f0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+0000b500: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0000b510: 2020 2064 6565 7020 3a20 626f 6f6c 2c20     deep : bool, 
+0000b520: 6465 6661 756c 7420 5472 7565 0a20 2020  default True.   
+0000b530: 2020 2020 2020 2020 204d 616b 6520 6120           Make a 
+0000b540: 6465 6570 2063 6f70 792c 2069 6e63 6c75  deep copy, inclu
+0000b550: 6469 6e67 2061 2063 6f70 7920 6f66 2074  ding a copy of t
+0000b560: 6865 2064 6174 6120 616e 6420 7468 6520  he data and the 
+0000b570: 696e 6469 6365 732e 0a20 2020 2020 2020  indices..       
+0000b580: 2020 2020 2057 6974 6820 6060 6465 6570       With ``deep
+0000b590: 3d46 616c 7365 6060 206e 6569 7468 6572  =False`` neither
+0000b5a0: 2074 6865 2069 6e64 6963 6573 206e 6f72   the indices nor
+0000b5b0: 2074 6865 2064 6174 6120 6172 6520 636f   the data are co
+0000b5c0: 7069 6564 2e0a 0a20 2020 2020 2020 2052  pied...        R
+0000b5d0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+0000b5e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2063  ------.        c
+0000b5f0: 6f70 7920 3a20 5365 7269 6573 206f 7220  opy : Series or 
+0000b600: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
+0000b610: 2020 2020 2020 4f62 6a65 6374 2074 7970        Object typ
+0000b620: 6520 6d61 7463 6865 7320 6361 6c6c 6572  e matches caller
+0000b630: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000b640: 2020 2020 2020 6966 2064 6565 703a 0a20        if deep:. 
+0000b650: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000b660: 6e20 7375 7065 7228 292e 636f 7079 2829  n super().copy()
+0000b670: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000b680: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000b690: 6e20 7375 7065 7228 292e 5f76 6965 7728  n super()._view(
+0000b6a0: 290a 0a20 2020 2064 6566 205f 5f6c 656e  )..    def __len
+0000b6b0: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+0000b6c0: 2020 7265 7475 726e 206c 656e 2873 656c    return len(sel
+0000b6d0: 662e 5f64 6174 6129 0a0a 2020 2020 6465  f._data)..    de
+0000b6e0: 6620 5f5f 6d61 7273 5f74 656e 736f 725f  f __mars_tensor_
+0000b6f0: 5f28 7365 6c66 2c20 6474 7970 653d 4e6f  _(self, dtype=No
+0000b700: 6e65 2c20 6f72 6465 723d 224b 2229 3a0a  ne, order="K"):.
+0000b710: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000b720: 656c 662e 5f64 6174 612e 5f5f 6d61 7273  elf._data.__mars
+0000b730: 5f74 656e 736f 725f 5f28 6474 7970 653d  _tensor__(dtype=
+0000b740: 6474 7970 652c 206f 7264 6572 3d6f 7264  dtype, order=ord
+0000b750: 6572 290a 0a20 2020 2064 6566 206b 6579  er)..    def key
+0000b760: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+0000b770: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+0000b780: 7572 6e20 616c 6961 7320 666f 7220 696e  urn alias for in
+0000b790: 6465 782e 0a0a 2020 2020 2020 2020 5265  dex...        Re
+0000b7a0: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+0000b7b0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 496e  -----.        In
+0000b7c0: 6465 780a 2020 2020 2020 2020 2020 2020  dex.            
+0000b7d0: 496e 6465 7820 6f66 2074 6865 2053 6572  Index of the Ser
+0000b7e0: 6965 732e 0a20 2020 2020 2020 2022 2222  ies..        """
+0000b7f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000b800: 7365 6c66 2e69 6e64 6578 0a0a 2020 2020  self.index..    
+0000b810: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000b820: 6620 7661 6c75 6573 2873 656c 6629 3a0a  f values(self):.
+0000b830: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000b840: 656c 662e 746f 5f74 656e 736f 7228 290a  elf.to_tensor().
+0000b850: 0a20 2020 2064 6566 2069 7465 6d73 2873  .    def items(s
+0000b860: 656c 662c 2062 6174 6368 5f73 697a 653d  elf, batch_size=
+0000b870: 3130 3030 302c 2073 6573 7369 6f6e 3d4e  10000, session=N
+0000b880: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
+0000b890: 220a 2020 2020 2020 2020 4c61 7a69 6c79  ".        Lazily
+0000b8a0: 2069 7465 7261 7465 206f 7665 7220 2869   iterate over (i
+0000b8b0: 6e64 6578 2c20 7661 6c75 6529 2074 7570  ndex, value) tup
+0000b8c0: 6c65 732e 0a0a 2020 2020 2020 2020 5468  les...        Th
+0000b8d0: 6973 206d 6574 686f 6420 7265 7475 726e  is method return
+0000b8e0: 7320 616e 2069 7465 7261 626c 6520 7475  s an iterable tu
+0000b8f0: 706c 6520 2869 6e64 6578 2c20 7661 6c75  ple (index, valu
+0000b900: 6529 2e20 5468 6973 2069 730a 2020 2020  e). This is.    
+0000b910: 2020 2020 636f 6e76 656e 6965 6e74 2069      convenient i
+0000b920: 6620 796f 7520 7761 6e74 2074 6f20 6372  f you want to cr
+0000b930: 6561 7465 2061 206c 617a 7920 6974 6572  eate a lazy iter
+0000b940: 6174 6f72 2e0a 0a20 2020 2020 2020 2052  ator...        R
+0000b950: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+0000b960: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2069  ------.        i
+0000b970: 7465 7261 626c 650a 2020 2020 2020 2020  terable.        
+0000b980: 2020 2020 4974 6572 6162 6c65 206f 6620      Iterable of 
+0000b990: 7475 706c 6573 2063 6f6e 7461 696e 696e  tuples containin
+0000b9a0: 6720 7468 6520 2869 6e64 6578 2c20 7661  g the (index, va
+0000b9b0: 6c75 6529 2070 6169 7273 2066 726f 6d20  lue) pairs from 
+0000b9c0: 610a 2020 2020 2020 2020 2020 2020 5365  a.            Se
+0000b9d0: 7269 6573 2e0a 0a20 2020 2020 2020 2053  ries...        S
+0000b9e0: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
+0000b9f0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000ba00: 2044 6174 6146 7261 6d65 2e69 7465 6d73   DataFrame.items
+0000ba10: 203a 2049 7465 7261 7465 206f 7665 7220   : Iterate over 
+0000ba20: 2863 6f6c 756d 6e20 6e61 6d65 2c20 5365  (column name, Se
+0000ba30: 7269 6573 2920 7061 6972 732e 0a20 2020  ries) pairs..   
+0000ba40: 2020 2020 2044 6174 6146 7261 6d65 2e69       DataFrame.i
+0000ba50: 7465 7272 6f77 7320 3a20 4974 6572 6174  terrows : Iterat
+0000ba60: 6520 6f76 6572 2044 6174 6146 7261 6d65  e over DataFrame
+0000ba70: 2072 6f77 7320 6173 2028 696e 6465 782c   rows as (index,
+0000ba80: 2053 6572 6965 7329 2070 6169 7273 2e0a   Series) pairs..
+0000ba90: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+0000baa0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0000bab0: 2d2d 0a20 2020 2020 2020 203e 3e3e 2069  --.        >>> i
+0000bac0: 6d70 6f72 7420 6d61 7273 2e64 6174 6166  mport mars.dataf
+0000bad0: 7261 6d65 2061 7320 6d64 0a20 2020 2020  rame as md.     
+0000bae0: 2020 203e 3e3e 2073 203d 206d 642e 5365     >>> s = md.Se
+0000baf0: 7269 6573 285b 2741 272c 2027 4227 2c20  ries(['A', 'B', 
+0000bb00: 2743 275d 290a 2020 2020 2020 2020 3e3e  'C']).        >>
+0000bb10: 3e20 666f 7220 696e 6465 782c 2076 616c  > for index, val
+0000bb20: 7565 2069 6e20 732e 6974 656d 7328 293a  ue in s.items():
+0000bb30: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0000bb40: 2070 7269 6e74 2866 2249 6e64 6578 203a   print(f"Index :
+0000bb50: 207b 696e 6465 787d 2c20 5661 6c75 6520   {index}, Value 
+0000bb60: 3a20 7b76 616c 7565 7d22 290a 2020 2020  : {value}").    
+0000bb70: 2020 2020 496e 6465 7820 3a20 302c 2056      Index : 0, V
+0000bb80: 616c 7565 203a 2041 0a20 2020 2020 2020  alue : A.       
+0000bb90: 2049 6e64 6578 203a 2031 2c20 5661 6c75   Index : 1, Valu
+0000bba0: 6520 3a20 420a 2020 2020 2020 2020 496e  e : B.        In
+0000bbb0: 6465 7820 3a20 322c 2056 616c 7565 203a  dex : 2, Value :
+0000bbc0: 2043 0a20 2020 2020 2020 2022 2222 0a20   C.        """. 
+0000bbd0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000bbe0: 6c66 2e5f 6461 7461 2e69 7465 6d73 2862  lf._data.items(b
+0000bbf0: 6174 6368 5f73 697a 653d 6261 7463 685f  atch_size=batch_
+0000bc00: 7369 7a65 2c20 7365 7373 696f 6e3d 7365  size, session=se
+0000bc10: 7373 696f 6e29 0a0a 2020 2020 6465 6620  ssion)..    def 
+0000bc20: 746f 5f64 6963 7428 7365 6c66 2c20 696e  to_dict(self, in
+0000bc30: 746f 3d64 6963 742c 2062 6174 6368 5f73  to=dict, batch_s
+0000bc40: 697a 653d 3130 3030 302c 2073 6573 7369  ize=10000, sessi
+0000bc50: 6f6e 3d4e 6f6e 6529 3a0a 2020 2020 2020  on=None):.      
+0000bc60: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
+0000bc70: 6e76 6572 7420 5365 7269 6573 2074 6f20  nvert Series to 
+0000bc80: 7b6c 6162 656c 202d 3e20 7661 6c75 657d  {label -> value}
+0000bc90: 2064 6963 7420 6f72 2064 6963 742d 6c69   dict or dict-li
+0000bca0: 6b65 206f 626a 6563 742e 0a0a 2020 2020  ke object...    
+0000bcb0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0000bcc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000bcd0: 2d0a 2020 2020 2020 2020 696e 746f 203a  -.        into :
+0000bce0: 2063 6c61 7373 2c20 6465 6661 756c 7420   class, default 
+0000bcf0: 6469 6374 0a20 2020 2020 2020 2020 2020  dict.           
+0000bd00: 2054 6865 2063 6f6c 6c65 6374 696f 6e73   The collections
+0000bd10: 2e61 6263 2e4d 6170 7069 6e67 2073 7562  .abc.Mapping sub
+0000bd20: 636c 6173 7320 746f 2075 7365 2061 7320  class to use as 
+0000bd30: 7468 6520 7265 7475 726e 0a20 2020 2020  the return.     
+0000bd40: 2020 2020 2020 206f 626a 6563 742e 2043         object. C
+0000bd50: 616e 2062 6520 7468 6520 6163 7475 616c  an be the actual
+0000bd60: 2063 6c61 7373 206f 7220 616e 2065 6d70   class or an emp
+0000bd70: 7479 0a20 2020 2020 2020 2020 2020 2069  ty.            i
+0000bd80: 6e73 7461 6e63 6520 6f66 2074 6865 206d  nstance of the m
+0000bd90: 6170 7069 6e67 2074 7970 6520 796f 7520  apping type you 
+0000bda0: 7761 6e74 2e20 2049 6620 796f 7520 7761  want.  If you wa
+0000bdb0: 6e74 2061 0a20 2020 2020 2020 2020 2020  nt a.           
+0000bdc0: 2063 6f6c 6c65 6374 696f 6e73 2e64 6566   collections.def
+0000bdd0: 6175 6c74 6469 6374 2c20 796f 7520 6d75  aultdict, you mu
+0000bde0: 7374 2070 6173 7320 6974 2069 6e69 7469  st pass it initi
+0000bdf0: 616c 697a 6564 2e0a 0a20 2020 2020 2020  alized...       
+0000be00: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+0000be10: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+0000be20: 2063 6f6c 6c65 6374 696f 6e73 2e61 6263   collections.abc
+0000be30: 2e4d 6170 7069 6e67 0a20 2020 2020 2020  .Mapping.       
+0000be40: 2020 2020 204b 6579 2d76 616c 7565 2072       Key-value r
+0000be50: 6570 7265 7365 6e74 6174 696f 6e20 6f66  epresentation of
+0000be60: 2053 6572 6965 732e 0a0a 2020 2020 2020   Series...      
+0000be70: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
+0000be80: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+0000be90: 2020 2020 3e3e 3e20 696d 706f 7274 206d      >>> import m
+0000bea0: 6172 732e 6461 7461 6672 616d 6520 6173  ars.dataframe as
+0000beb0: 206d 640a 2020 2020 2020 2020 3e3e 3e20   md.        >>> 
+0000bec0: 7320 3d20 6d64 2e53 6572 6965 7328 5b31  s = md.Series([1
+0000bed0: 2c20 322c 2033 2c20 345d 290a 2020 2020  , 2, 3, 4]).    
+0000bee0: 2020 2020 3e3e 3e20 732e 746f 5f64 6963      >>> s.to_dic
+0000bef0: 7428 290a 2020 2020 2020 2020 7b30 3a20  t().        {0: 
+0000bf00: 312c 2031 3a20 322c 2032 3a20 332c 2033  1, 1: 2, 2: 3, 3
+0000bf10: 3a20 347d 0a20 2020 2020 2020 203e 3e3e  : 4}.        >>>
+0000bf20: 2066 726f 6d20 636f 6c6c 6563 7469 6f6e   from collection
+0000bf30: 7320 696d 706f 7274 204f 7264 6572 6564  s import Ordered
+0000bf40: 4469 6374 2c20 6465 6661 756c 7464 6963  Dict, defaultdic
+0000bf50: 740a 2020 2020 2020 2020 3e3e 3e20 732e  t.        >>> s.
+0000bf60: 746f 5f64 6963 7428 4f72 6465 7265 6444  to_dict(OrderedD
+0000bf70: 6963 7429 0a20 2020 2020 2020 204f 7264  ict).        Ord
+0000bf80: 6572 6564 4469 6374 285b 2830 2c20 3129  eredDict([(0, 1)
+0000bf90: 2c20 2831 2c20 3229 2c20 2832 2c20 3329  , (1, 2), (2, 3)
+0000bfa0: 2c20 2833 2c20 3429 5d29 0a20 2020 2020  , (3, 4)]).     
+0000bfb0: 2020 203e 3e3e 2064 6420 3d20 6465 6661     >>> dd = defa
+0000bfc0: 756c 7464 6963 7428 6c69 7374 290a 2020  ultdict(list).  
+0000bfd0: 2020 2020 2020 3e3e 3e20 732e 746f 5f64        >>> s.to_d
+0000bfe0: 6963 7428 6464 290a 2020 2020 2020 2020  ict(dd).        
+0000bff0: 6465 6661 756c 7464 6963 7428 3c63 6c61  defaultdict(<cla
+0000c000: 7373 2027 6c69 7374 273e 2c20 7b30 3a20  ss 'list'>, {0: 
+0000c010: 312c 2031 3a20 322c 2032 3a20 332c 2033  1, 1: 2, 2: 3, 3
+0000c020: 3a20 347d 290a 2020 2020 2020 2020 2222  : 4}).        ""
+0000c030: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0000c040: 2073 656c 662e 5f64 6174 612e 746f 5f64   self._data.to_d
+0000c050: 6963 7428 696e 746f 3d69 6e74 6f2c 2062  ict(into=into, b
+0000c060: 6174 6368 5f73 697a 653d 6261 7463 685f  atch_size=batch_
+0000c070: 7369 7a65 2c20 7365 7373 696f 6e3d 7365  size, session=se
+0000c080: 7373 696f 6e29 0a0a 2020 2020 6465 6620  ssion)..    def 
+0000c090: 746f 5f66 7261 6d65 2873 656c 662c 206e  to_frame(self, n
+0000c0a0: 616d 653d 4e6f 6e65 293a 0a20 2020 2020  ame=None):.     
+0000c0b0: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+0000c0c0: 6f6e 7665 7274 2053 6572 6965 7320 746f  onvert Series to
+0000c0d0: 2044 6174 6146 7261 6d65 2e0a 0a20 2020   DataFrame...   
+0000c0e0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+0000c0f0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000c100: 2d2d 0a20 2020 2020 2020 206e 616d 6520  --.        name 
+0000c110: 3a20 6f62 6a65 6374 2c20 6465 6661 756c  : object, defaul
+0000c120: 7420 4e6f 6e65 0a20 2020 2020 2020 2020  t None.         
+0000c130: 2020 2054 6865 2070 6173 7365 6420 6e61     The passed na
+0000c140: 6d65 2073 686f 756c 6420 7375 6273 7469  me should substi
+0000c150: 7475 7465 2066 6f72 2074 6865 2073 6572  tute for the ser
+0000c160: 6965 7320 6e61 6d65 2028 6966 2069 7420  ies name (if it 
+0000c170: 6861 730a 2020 2020 2020 2020 2020 2020  has.            
+0000c180: 6f6e 6529 2e0a 0a20 2020 2020 2020 2052  one)...        R
+0000c190: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+0000c1a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
+0000c1b0: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
+0000c1c0: 2020 2020 2044 6174 6146 7261 6d65 2072       DataFrame r
+0000c1d0: 6570 7265 7365 6e74 6174 696f 6e20 6f66  epresentation of
+0000c1e0: 2053 6572 6965 732e 0a0a 2020 2020 2020   Series...      
+0000c1f0: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
+0000c200: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+0000c210: 2020 2020 3e3e 3e20 696d 706f 7274 206d      >>> import m
+0000c220: 6172 732e 6461 7461 6672 616d 6520 6173  ars.dataframe as
+0000c230: 206d 640a 2020 2020 2020 2020 3e3e 3e20   md.        >>> 
+0000c240: 7320 3d20 6d64 2e53 6572 6965 7328 5b22  s = md.Series(["
+0000c250: 6122 2c20 2262 222c 2022 6322 5d2c 206e  a", "b", "c"], n
+0000c260: 616d 653d 2276 616c 7322 290a 2020 2020  ame="vals").    
+0000c270: 2020 2020 3e3e 3e20 732e 746f 5f66 7261      >>> s.to_fra
+0000c280: 6d65 2829 2e65 7865 6375 7465 2829 0a20  me().execute(). 
+0000c290: 2020 2020 2020 2020 2076 616c 730a 2020           vals.  
+0000c2a0: 2020 2020 2020 3020 2020 2061 0a20 2020        0    a.   
+0000c2b0: 2020 2020 2031 2020 2020 620a 2020 2020       1    b.    
+0000c2c0: 2020 2020 3220 2020 2063 0a20 2020 2020      2    c.     
+0000c2d0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+0000c2e0: 726f 6d20 2e20 696d 706f 7274 2064 6174  rom . import dat
+0000c2f0: 6166 7261 6d65 5f66 726f 6d5f 7465 6e73  aframe_from_tens
+0000c300: 6f72 0a0a 2020 2020 2020 2020 6e61 6d65  or..        name
+0000c310: 203d 206e 616d 6520 6f72 2073 656c 662e   = name or self.
+0000c320: 6e61 6d65 206f 7220 300a 2020 2020 2020  name or 0.      
+0000c330: 2020 7265 7475 726e 2064 6174 6166 7261    return datafra
+0000c340: 6d65 5f66 726f 6d5f 7465 6e73 6f72 2873  me_from_tensor(s
+0000c350: 656c 662c 2063 6f6c 756d 6e73 3d5b 6e61  elf, columns=[na
+0000c360: 6d65 5d29 0a0a 2020 2020 6465 6620 6265  me])..    def be
+0000c370: 7477 6565 6e28 7365 6c66 2c20 6c65 6674  tween(self, left
+0000c380: 2c20 7269 6768 742c 2069 6e63 6c75 7369  , right, inclusi
+0000c390: 7665 3d22 626f 7468 2229 3a0a 2020 2020  ve="both"):.    
+0000c3a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000c3b0: 5265 7475 726e 2062 6f6f 6c65 616e 2053  Return boolean S
+0000c3c0: 6572 6965 7320 6571 7569 7661 6c65 6e74  eries equivalent
+0000c3d0: 2074 6f20 6c65 6674 203c 3d20 7365 7269   to left <= seri
+0000c3e0: 6573 203c 3d20 7269 6768 742e 0a20 2020  es <= right..   
+0000c3f0: 2020 2020 2054 6869 7320 6675 6e63 7469       This functi
+0000c400: 6f6e 2072 6574 7572 6e73 2061 2062 6f6f  on returns a boo
+0000c410: 6c65 616e 2076 6563 746f 7220 636f 6e74  lean vector cont
+0000c420: 6169 6e69 6e67 2060 5472 7565 6020 7768  aining `True` wh
+0000c430: 6572 6576 6572 2074 6865 0a20 2020 2020  erever the.     
+0000c440: 2020 2063 6f72 7265 7370 6f6e 6469 6e67     corresponding
+0000c450: 2053 6572 6965 7320 656c 656d 656e 7420   Series element 
+0000c460: 6973 2062 6574 7765 656e 2074 6865 2062  is between the b
+0000c470: 6f75 6e64 6172 7920 7661 6c75 6573 2060  oundary values `
+0000c480: 6c65 6674 6020 616e 640a 2020 2020 2020  left` and.      
+0000c490: 2020 6072 6967 6874 602e 204e 4120 7661    `right`. NA va
+0000c4a0: 6c75 6573 2061 7265 2074 7265 6174 6564  lues are treated
+0000c4b0: 2061 7320 6046 616c 7365 602e 0a0a 2020   as `False`...  
+0000c4c0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0000c4d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000c4e0: 2d2d 2d0a 2020 2020 2020 2020 6c65 6674  ---.        left
+0000c4f0: 203a 2073 6361 6c61 7220 6f72 206c 6973   : scalar or lis
+0000c500: 742d 6c69 6b65 0a20 2020 2020 2020 2020  t-like.         
+0000c510: 2020 204c 6566 7420 626f 756e 6461 7279     Left boundary
+0000c520: 2e0a 2020 2020 2020 2020 7269 6768 7420  ..        right 
+0000c530: 3a20 7363 616c 6172 206f 7220 6c69 7374  : scalar or list
+0000c540: 2d6c 696b 650a 2020 2020 2020 2020 2020  -like.          
+0000c550: 2020 5269 6768 7420 626f 756e 6461 7279    Right boundary
+0000c560: 2e0a 2020 2020 2020 2020 696e 636c 7573  ..        inclus
+0000c570: 6976 6520 3a20 7b22 626f 7468 222c 2022  ive : {"both", "
+0000c580: 6e65 6974 6865 7222 2c20 226c 6566 7422  neither", "left"
+0000c590: 2c20 2272 6967 6874 227d 0a20 2020 2020  , "right"}.     
+0000c5a0: 2020 2020 2020 2049 6e63 6c75 6465 2062         Include b
+0000c5b0: 6f75 6e64 6172 6965 732e 2057 6865 7468  oundaries. Wheth
+0000c5c0: 6572 2074 6f20 7365 7420 6561 6368 2062  er to set each b
+0000c5d0: 6f75 6e64 2061 7320 636c 6f73 6564 206f  ound as closed o
+0000c5e0: 7220 6f70 656e 2e0a 0a20 2020 2020 2020  r open...       
+0000c5f0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+0000c600: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+0000c610: 2053 6572 6965 730a 2020 2020 2020 2020   Series.        
+0000c620: 2020 2020 5365 7269 6573 2072 6570 7265      Series repre
+0000c630: 7365 6e74 696e 6720 7768 6574 6865 7220  senting whether 
+0000c640: 6561 6368 2065 6c65 6d65 6e74 2069 7320  each element is 
+0000c650: 6265 7477 6565 6e20 6c65 6674 2061 6e64  between left and
+0000c660: 0a20 2020 2020 2020 2020 2020 2072 6967  .            rig
+0000c670: 6874 2028 696e 636c 7573 6976 6529 2e0a  ht (inclusive)..
+0000c680: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
+0000c690: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
+0000c6a0: 2d2d 0a20 2020 2020 2020 2053 6572 6965  --.        Serie
+0000c6b0: 732e 6774 203a 2047 7265 6174 6572 2074  s.gt : Greater t
+0000c6c0: 6861 6e20 6f66 2073 6572 6965 7320 616e  han of series an
+0000c6d0: 6420 6f74 6865 722e 0a20 2020 2020 2020  d other..       
+0000c6e0: 2053 6572 6965 732e 6c74 203a 204c 6573   Series.lt : Les
+0000c6f0: 7320 7468 616e 206f 6620 7365 7269 6573  s than of series
+0000c700: 2061 6e64 206f 7468 6572 2e0a 0a20 2020   and other...   
+0000c710: 2020 2020 204e 6f74 6573 0a20 2020 2020       Notes.     
+0000c720: 2020 202d 2d2d 2d2d 0a20 2020 2020 2020     -----.       
+0000c730: 2054 6869 7320 6675 6e63 7469 6f6e 2069   This function i
+0000c740: 7320 6571 7569 7661 6c65 6e74 2074 6f20  s equivalent to 
+0000c750: 6060 286c 6566 7420 3c3d 2073 6572 2920  ``(left <= ser) 
+0000c760: 2620 2873 6572 203c 3d20 7269 6768 7429  & (ser <= right)
+0000c770: 6060 0a0a 2020 2020 2020 2020 4578 616d  ``..        Exam
+0000c780: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
+0000c790: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
+0000c7a0: 3e20 696d 706f 7274 206d 6172 732e 6461  > import mars.da
+0000c7b0: 7461 6672 616d 6520 6173 206d 640a 2020  taframe as md.  
+0000c7c0: 2020 2020 2020 3e3e 3e20 7320 3d20 6d64        >>> s = md
+0000c7d0: 2e53 6572 6965 7328 5b32 2c20 302c 2034  .Series([2, 0, 4
+0000c7e0: 2c20 382c 206e 702e 6e61 6e5d 290a 0a20  , 8, np.nan]).. 
+0000c7f0: 2020 2020 2020 2042 6f75 6e64 6172 7920         Boundary 
+0000c800: 7661 6c75 6573 2061 7265 2069 6e63 6c75  values are inclu
+0000c810: 6465 6420 6279 2064 6566 6175 6c74 3a0a  ded by default:.
+0000c820: 0a20 2020 2020 2020 203e 3e3e 2073 2e62  .        >>> s.b
+0000c830: 6574 7765 656e 2831 2c20 3429 2e65 7865  etween(1, 4).exe
+0000c840: 6375 7465 2829 0a20 2020 2020 2020 2030  cute().        0
+0000c850: 2020 2020 2054 7275 650a 2020 2020 2020       True.      
+0000c860: 2020 3120 2020 2046 616c 7365 0a20 2020    1    False.   
+0000c870: 2020 2020 2032 2020 2020 2054 7275 650a       2     True.
+0000c880: 2020 2020 2020 2020 3320 2020 2046 616c          3    Fal
+0000c890: 7365 0a20 2020 2020 2020 2034 2020 2020  se.        4    
+0000c8a0: 4661 6c73 650a 2020 2020 2020 2020 6474  False.        dt
+0000c8b0: 7970 653a 2062 6f6f 6c0a 0a20 2020 2020  ype: bool..     
+0000c8c0: 2020 2057 6974 6820 6069 6e63 6c75 7369     With `inclusi
+0000c8d0: 7665 6020 7365 7420 746f 2060 6022 6e65  ve` set to ``"ne
+0000c8e0: 6974 6865 7222 6060 2062 6f75 6e64 6172  ither"`` boundar
+0000c8f0: 7920 7661 6c75 6573 2061 7265 2065 7863  y values are exc
+0000c900: 6c75 6465 643a 0a0a 2020 2020 2020 2020  luded:..        
+0000c910: 3e3e 3e20 732e 6265 7477 6565 6e28 312c  >>> s.between(1,
+0000c920: 2034 2c20 696e 636c 7573 6976 653d 226e   4, inclusive="n
+0000c930: 6569 7468 6572 2229 2e65 7865 6375 7465  either").execute
+0000c940: 2829 0a20 2020 2020 2020 2030 2020 2020  ().        0    
+0000c950: 2054 7275 650a 2020 2020 2020 2020 3120   True.        1 
+0000c960: 2020 2046 616c 7365 0a20 2020 2020 2020     False.       
+0000c970: 2032 2020 2020 4661 6c73 650a 2020 2020   2    False.    
+0000c980: 2020 2020 3320 2020 2046 616c 7365 0a20      3    False. 
+0000c990: 2020 2020 2020 2034 2020 2020 4661 6c73         4    Fals
+0000c9a0: 650a 2020 2020 2020 2020 6474 7970 653a  e.        dtype:
+0000c9b0: 2062 6f6f 6c0a 0a20 2020 2020 2020 2060   bool..        `
+0000c9c0: 6c65 6674 6020 616e 6420 6072 6967 6874  left` and `right
+0000c9d0: 6020 6361 6e20 6265 2061 6e79 2073 6361  ` can be any sca
+0000c9e0: 6c61 7220 7661 6c75 653a 0a0a 2020 2020  lar value:..    
+0000c9f0: 2020 2020 3e3e 3e20 7320 3d20 6d64 2e53      >>> s = md.S
+0000ca00: 6572 6965 7328 5b27 416c 6963 6527 2c20  eries(['Alice', 
+0000ca10: 2742 6f62 272c 2027 4361 726f 6c27 2c20  'Bob', 'Carol', 
+0000ca20: 2745 7665 275d 290a 2020 2020 2020 2020  'Eve']).        
+0000ca30: 3e3e 3e20 732e 6265 7477 6565 6e28 2741  >>> s.between('A
+0000ca40: 6e6e 6127 2c20 2744 616e 6965 6c27 292e  nna', 'Daniel').
+0000ca50: 6578 6563 7574 6528 290a 2020 2020 2020  execute().      
+0000ca60: 2020 3020 2020 2046 616c 7365 0a20 2020    0    False.   
+0000ca70: 2020 2020 2031 2020 2020 2054 7275 650a       1     True.
+0000ca80: 2020 2020 2020 2020 3220 2020 2020 5472          2     Tr
+0000ca90: 7565 0a20 2020 2020 2020 2033 2020 2020  ue.        3    
+0000caa0: 4661 6c73 650a 2020 2020 2020 2020 6474  False.        dt
+0000cab0: 7970 653a 2062 6f6f 6c0a 2020 2020 2020  ype: bool.      
+0000cac0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+0000cad0: 2069 7369 6e73 7461 6e63 6528 696e 636c   isinstance(incl
+0000cae0: 7573 6976 652c 2062 6f6f 6c29 3a20 2023  usive, bool):  #
+0000caf0: 2070 7261 676d 613a 206e 6f20 636f 7665   pragma: no cove
+0000cb00: 720a 2020 2020 2020 2020 2020 2020 2320  r.            # 
+0000cb10: 666f 7220 7061 6e64 6173 203c 2031 2e33  for pandas < 1.3
+0000cb20: 2e30 0a20 2020 2020 2020 2020 2020 2069  .0.            i
+0000cb30: 6620 696e 636c 7573 6976 653a 0a20 2020  f inclusive:.   
+0000cb40: 2020 2020 2020 2020 2020 2020 2069 6e63               inc
+0000cb50: 6c75 7369 7665 203d 2022 626f 7468 220a  lusive = "both".
+0000cb60: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000cb70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000cb80: 2020 696e 636c 7573 6976 6520 3d20 226e    inclusive = "n
+0000cb90: 6569 7468 6572 220a 2020 2020 2020 2020  either".        
+0000cba0: 6966 2069 6e63 6c75 7369 7665 203d 3d20  if inclusive == 
+0000cbb0: 2262 6f74 6822 3a0a 2020 2020 2020 2020  "both":.        
+0000cbc0: 2020 2020 6c6d 6173 6b20 3d20 7365 6c66      lmask = self
+0000cbd0: 203e 3d20 6c65 6674 0a20 2020 2020 2020   >= left.       
+0000cbe0: 2020 2020 2072 6d61 736b 203d 2073 656c       rmask = sel
+0000cbf0: 6620 3c3d 2072 6967 6874 0a20 2020 2020  f <= right.     
+0000cc00: 2020 2065 6c69 6620 696e 636c 7573 6976     elif inclusiv
+0000cc10: 6520 3d3d 2022 6c65 6674 223a 0a20 2020  e == "left":.   
+0000cc20: 2020 2020 2020 2020 206c 6d61 736b 203d           lmask =
+0000cc30: 2073 656c 6620 3e3d 206c 6566 740a 2020   self >= left.  
+0000cc40: 2020 2020 2020 2020 2020 726d 6173 6b20            rmask 
+0000cc50: 3d20 7365 6c66 203c 2072 6967 6874 0a20  = self < right. 
+0000cc60: 2020 2020 2020 2065 6c69 6620 696e 636c         elif incl
+0000cc70: 7573 6976 6520 3d3d 2022 7269 6768 7422  usive == "right"
+0000cc80: 3a0a 2020 2020 2020 2020 2020 2020 6c6d  :.            lm
+0000cc90: 6173 6b20 3d20 7365 6c66 203e 206c 6566  ask = self > lef
+0000cca0: 740a 2020 2020 2020 2020 2020 2020 726d  t.            rm
+0000ccb0: 6173 6b20 3d20 7365 6c66 203c 3d20 7269  ask = self <= ri
+0000ccc0: 6768 740a 2020 2020 2020 2020 656c 6966  ght.        elif
+0000ccd0: 2069 6e63 6c75 7369 7665 203d 3d20 226e   inclusive == "n
+0000cce0: 6569 7468 6572 223a 0a20 2020 2020 2020  either":.       
+0000ccf0: 2020 2020 206c 6d61 736b 203d 2073 656c       lmask = sel
+0000cd00: 6620 3e20 6c65 6674 0a20 2020 2020 2020  f > left.       
+0000cd10: 2020 2020 2072 6d61 736b 203d 2073 656c       rmask = sel
+0000cd20: 6620 3c20 7269 6768 740a 2020 2020 2020  f < right.      
+0000cd30: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000cd40: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000cd50: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0000cd60: 2020 2020 2020 2249 6e63 6c75 7369 7665        "Inclusive
+0000cd70: 2068 6173 2074 6f20 6265 2065 6974 6865   has to be eithe
+0000cd80: 7220 7374 7269 6e67 206f 6620 2762 6f74  r string of 'bot
+0000cd90: 6827 2c22 0a20 2020 2020 2020 2020 2020  h',".           
+0000cda0: 2020 2020 2022 276c 6566 7427 2c20 2772       "'left', 'r
+0000cdb0: 6967 6874 272c 206f 7220 276e 6569 7468  ight', or 'neith
+0000cdc0: 6572 272e 220a 2020 2020 2020 2020 2020  er'.".          
+0000cdd0: 2020 290a 0a20 2020 2020 2020 2072 6574    )..        ret
+0000cde0: 7572 6e20 6c6d 6173 6b20 2620 726d 6173  urn lmask & rmas
+0000cdf0: 6b0a 0a20 2020 2064 6566 206d 6564 6961  k..    def media
+0000ce00: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
+0000ce10: 2061 7869 733d 4e6f 6e65 2c20 736b 6970   axis=None, skip
+0000ce20: 6e61 3d54 7275 652c 206f 7574 3d4e 6f6e  na=True, out=Non
+0000ce30: 652c 206f 7665 7277 7269 7465 5f69 6e70  e, overwrite_inp
+0000ce40: 7574 3d46 616c 7365 2c20 6b65 6570 6469  ut=False, keepdi
+0000ce50: 6d73 3d46 616c 7365 0a20 2020 2029 3a0a  ms=False.    ):.
+0000ce60: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000ce70: 2020 2020 5265 7475 726e 2074 6865 206d      Return the m
+0000ce80: 6564 6961 6e20 6f66 2074 6865 2076 616c  edian of the val
+0000ce90: 7565 7320 6f76 6572 2074 6865 2072 6571  ues over the req
+0000cea0: 7565 7374 6564 2061 7869 732e 0a0a 2020  uested axis...  
+0000ceb0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0000cec0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000ced0: 2d2d 2d0a 2020 2020 2020 2020 6178 6973  ---.        axis
+0000cee0: 203a 207b 696e 6465 7820 2830 297d 0a20   : {index (0)}. 
+0000cef0: 2020 2020 2020 2020 2020 2041 7869 7320             Axis 
+0000cf00: 6f72 2061 7865 7320 616c 6f6e 6720 7768  or axes along wh
+0000cf10: 6963 6820 7468 6520 6d65 6469 616e 7320  ich the medians 
+0000cf20: 6172 6520 636f 6d70 7574 6564 2e20 5468  are computed. Th
+0000cf30: 6520 6465 6661 756c 740a 2020 2020 2020  e default.      
+0000cf40: 2020 2020 2020 6973 2074 6f20 636f 6d70        is to comp
+0000cf50: 7574 6520 7468 6520 6d65 6469 616e 2061  ute the median a
+0000cf60: 6c6f 6e67 2061 2066 6c61 7474 656e 6564  long a flattened
+0000cf70: 2076 6572 7369 6f6e 206f 6620 7468 6520   version of the 
+0000cf80: 7465 6e73 6f72 2e0a 2020 2020 2020 2020  tensor..        
+0000cf90: 2020 2020 4120 7365 7175 656e 6365 206f      A sequence o
+0000cfa0: 6620 6178 6573 2069 7320 7375 7070 6f72  f axes is suppor
+0000cfb0: 7465 6420 7369 6e63 6520 7665 7273 696f  ted since versio
+0000cfc0: 6e20 312e 392e 302e 0a20 2020 2020 2020  n 1.9.0..       
+0000cfd0: 2073 6b69 706e 6120 3a20 626f 6f6c 2c20   skipna : bool, 
+0000cfe0: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+0000cff0: 7420 5472 7565 0a20 2020 2020 2020 2020  t True.         
+0000d000: 2020 2045 7863 6c75 6465 204e 412f 6e75     Exclude NA/nu
+0000d010: 6c6c 2076 616c 7565 7320 7768 656e 2063  ll values when c
+0000d020: 6f6d 7075 7469 6e67 2074 6865 2072 6573  omputing the res
+0000d030: 756c 742e 0a20 2020 2020 2020 206f 7574  ult..        out
+0000d040: 203a 2054 656e 736f 722c 2064 6566 6175   : Tensor, defau
+0000d050: 6c74 204e 6f6e 650a 2020 2020 2020 2020  lt None.        
+0000d060: 2020 2020 4f75 7470 7574 2074 656e 736f      Output tenso
+0000d070: 7220 696e 2077 6869 6368 2074 6f20 706c  r in which to pl
+0000d080: 6163 6520 7468 6520 7265 7375 6c74 2e20  ace the result. 
+0000d090: 4974 206d 7573 740a 2020 2020 2020 2020  It must.        
+0000d0a0: 2020 2020 6861 7665 2074 6865 2073 616d      have the sam
+0000d0b0: 6520 7368 6170 6520 616e 6420 6275 6666  e shape and buff
+0000d0c0: 6572 206c 656e 6774 6820 6173 2074 6865  er length as the
+0000d0d0: 2065 7870 6563 7465 6420 6f75 7470 7574   expected output
+0000d0e0: 2c0a 2020 2020 2020 2020 2020 2020 6275  ,.            bu
+0000d0f0: 7420 7468 6520 7479 7065 2028 6f66 2074  t the type (of t
+0000d100: 6865 206f 7574 7075 7429 2077 696c 6c20  he output) will 
+0000d110: 6265 2063 6173 7420 6966 206e 6563 6573  be cast if neces
+0000d120: 7361 7279 2e0a 2020 2020 2020 2020 6f76  sary..        ov
+0000d130: 6572 7772 6974 655f 696e 7075 7420 3a20  erwrite_input : 
+0000d140: 626f 6f6c 2c20 6465 6661 756c 7420 4661  bool, default Fa
+0000d150: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+0000d160: 4a75 7374 2066 6f72 2063 6f6d 7061 7469  Just for compati
+0000d170: 6269 6c69 7479 2077 6974 6820 4e75 6d70  bility with Nump
+0000d180: 792c 2077 6f75 6c64 206e 6f74 2074 616b  y, would not tak
+0000d190: 6520 6566 6665 6374 2e0a 2020 2020 2020  e effect..      
+0000d1a0: 2020 6b65 6570 6469 6d73 203a 2062 6f6f    keepdims : boo
+0000d1b0: 6c2c 2064 6566 6175 6c74 2046 616c 7365  l, default False
+0000d1c0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+0000d1d0: 7468 6973 2069 7320 7365 7420 746f 2054  this is set to T
+0000d1e0: 7275 652c 2074 6865 2061 7865 7320 7768  rue, the axes wh
+0000d1f0: 6963 6820 6172 6520 7265 6475 6365 6420  ich are reduced 
+0000d200: 6172 6520 6c65 6674 0a20 2020 2020 2020  are left.       
+0000d210: 2020 2020 2069 6e20 7468 6520 7265 7375       in the resu
+0000d220: 6c74 2061 7320 6469 6d65 6e73 696f 6e73  lt as dimensions
+0000d230: 2077 6974 6820 7369 7a65 206f 6e65 2e20   with size one. 
+0000d240: 5769 7468 2074 6869 7320 6f70 7469 6f6e  With this option
+0000d250: 2c0a 2020 2020 2020 2020 2020 2020 7468  ,.            th
+0000d260: 6520 7265 7375 6c74 2077 696c 6c20 6272  e result will br
+0000d270: 6f61 6463 6173 7420 636f 7272 6563 746c  oadcast correctl
+0000d280: 7920 6167 6169 6e73 7420 7468 6520 6f72  y against the or
+0000d290: 6967 696e 616c 2060 6172 7260 2e0a 0a20  iginal `arr`... 
+0000d2a0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+0000d2b0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+0000d2c0: 2020 2020 2020 206d 6564 6961 6e20 3a20         median : 
+0000d2d0: 7363 616c 6172 0a20 2020 2020 2020 2020  scalar.         
+0000d2e0: 2020 2052 6574 7572 6e20 7468 6520 6d65     Return the me
+0000d2f0: 6469 616e 206f 6620 7468 6520 7661 6c75  dian of the valu
+0000d300: 6573 206f 7665 7220 7468 6520 7265 7175  es over the requ
+0000d310: 6573 7465 6420 6178 6973 2e0a 0a20 2020  ested axis...   
+0000d320: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+0000d330: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+0000d340: 2020 2020 2020 2074 656e 736f 722e 6d65         tensor.me
+0000d350: 616e 2c20 7465 6e73 6f72 2e70 6572 6365  an, tensor.perce
+0000d360: 6e74 696c 650a 0a20 2020 2020 2020 204e  ntile..        N
+0000d370: 6f74 6573 0a20 2020 2020 2020 202d 2d2d  otes.        ---
+0000d380: 2d2d 0a20 2020 2020 2020 2047 6976 656e  --.        Given
+0000d390: 2061 2076 6563 746f 7220 6060 5660 6020   a vector ``V`` 
+0000d3a0: 6f66 206c 656e 6774 6820 6060 4e60 602c  of length ``N``,
+0000d3b0: 2074 6865 206d 6564 6961 6e20 6f66 2060   the median of `
+0000d3c0: 6056 6060 2069 7320 7468 650a 2020 2020  `V`` is the.    
+0000d3d0: 2020 2020 6d69 6464 6c65 2076 616c 7565      middle value
+0000d3e0: 206f 6620 6120 736f 7274 6564 2063 6f70   of a sorted cop
+0000d3f0: 7920 6f66 2060 6056 6060 2c20 6060 565f  y of ``V``, ``V_
+0000d400: 736f 7274 6564 6060 202d 2069 0a20 2020  sorted`` - i.   
+0000d410: 2020 2020 2065 2e2c 2060 6056 5f73 6f72       e., ``V_sor
+0000d420: 7465 645b 284e 2d31 292f 325d 6060 2c20  ted[(N-1)/2]``, 
+0000d430: 7768 656e 2060 604e 6060 2069 7320 6f64  when ``N`` is od
+0000d440: 642c 2061 6e64 2074 6865 2061 7665 7261  d, and the avera
+0000d450: 6765 206f 6620 7468 650a 2020 2020 2020  ge of the.      
+0000d460: 2020 7477 6f20 6d69 6464 6c65 2076 616c    two middle val
+0000d470: 7565 7320 6f66 2060 6056 5f73 6f72 7465  ues of ``V_sorte
+0000d480: 6460 6020 7768 656e 2060 604e 6060 2069  d`` when ``N`` i
+0000d490: 7320 6576 656e 2e0a 0a20 2020 2020 2020  s even...       
+0000d4a0: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
+0000d4b0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+0000d4c0: 2020 203e 3e3e 2069 6d70 6f72 7420 6d61     >>> import ma
+0000d4d0: 7273 2e64 6174 6166 7261 6d65 2061 7320  rs.dataframe as 
+0000d4e0: 6d64 0a20 2020 2020 2020 203e 3e3e 2061  md.        >>> a
+0000d4f0: 203d 206d 642e 5365 7269 6573 285b 3130   = md.Series([10
+0000d500: 2c20 372c 2034 2c20 332c 2032 2c20 315d  , 7, 4, 3, 2, 1]
+0000d510: 290a 2020 2020 2020 2020 3e3e 3e20 612e  ).        >>> a.
+0000d520: 6d65 6469 616e 2829 2e65 7865 6375 7465  median().execute
+0000d530: 2829 0a20 2020 2020 2020 2032 2e30 0a20  ().        2.0. 
+0000d540: 2020 2020 2020 203e 3e3e 206d 742e 6d65         >>> mt.me
+0000d550: 6469 616e 2861 292e 6578 6563 7574 6528  dian(a).execute(
+0000d560: 290a 2020 2020 2020 2020 332e 350a 2020  ).        3.5.  
+0000d570: 2020 2020 2020 3e3e 3e20 6120 3d20 6d64        >>> a = md
+0000d580: 2e53 6572 6965 7328 5b31 302c 2037 2c20  .Series([10, 7, 
+0000d590: 342c 204e 6f6e 652c 2032 2c20 315d 290a  4, None, 2, 1]).
+0000d5a0: 2020 2020 2020 2020 3e3e 3e20 612e 6d65          >>> a.me
+0000d5b0: 6469 616e 2829 2e65 7865 6375 7465 2829  dian().execute()
+0000d5c0: 0a20 2020 2020 2020 2034 2e30 0a20 2020  .        4.0.   
+0000d5d0: 2020 2020 203e 3e3e 2061 2e6d 6564 6961       >>> a.media
+0000d5e0: 6e28 736b 6970 6e61 3d46 616c 7365 292e  n(skipna=False).
+0000d5f0: 6578 6563 7574 6528 290a 2020 2020 2020  execute().      
+0000d600: 2020 6e61 6e0a 2020 2020 2020 2020 2222    nan.        ""
+0000d610: 220a 2020 2020 2020 2020 6966 2073 6b69  ".        if ski
+0000d620: 706e 613a 0a20 2020 2020 2020 2020 2020  pna:.           
+0000d630: 2072 6574 7572 6e20 7374 6174 6973 7469   return statisti
+0000d640: 6373 2e6d 6564 6961 6e28 0a20 2020 2020  cs.median(.     
+0000d650: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000d660: 6472 6f70 6e61 2829 2c0a 2020 2020 2020  dropna(),.      
+0000d670: 2020 2020 2020 2020 2020 6178 6973 3d4e            axis=N
+0000d680: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+0000d690: 2020 2020 206f 7574 3d4e 6f6e 652c 0a20       out=None,. 
+0000d6a0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0000d6b0: 7665 7277 7269 7465 5f69 6e70 7574 3d46  verwrite_input=F
+0000d6c0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+0000d6d0: 2020 2020 2020 6b65 6570 6469 6d73 3d46        keepdims=F
+0000d6e0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+0000d6f0: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+0000d700: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000d710: 7475 726e 2073 7461 7469 7374 6963 732e  turn statistics.
+0000d720: 6d65 6469 616e 280a 2020 2020 2020 2020  median(.        
+0000d730: 2020 2020 2020 2020 7365 6c66 2c20 6178          self, ax
+0000d740: 6973 3d4e 6f6e 652c 206f 7574 3d4e 6f6e  is=None, out=Non
+0000d750: 652c 206f 7665 7277 7269 7465 5f69 6e70  e, overwrite_inp
+0000d760: 7574 3d46 616c 7365 2c20 6b65 6570 6469  ut=False, keepdi
+0000d770: 6d73 3d46 616c 7365 0a20 2020 2020 2020  ms=False.       
+0000d780: 2020 2020 2029 0a0a 0a63 6c61 7373 2042       )...class B
+0000d790: 6173 6544 6174 6146 7261 6d65 4368 756e  aseDataFrameChun
+0000d7a0: 6b44 6174 6128 4c61 7a79 4d65 7461 4368  kData(LazyMetaCh
+0000d7b0: 756e 6b44 6174 6129 3a0a 2020 2020 5f5f  unkData):.    __
+0000d7c0: 736c 6f74 735f 5f20 3d20 2822 5f64 7479  slots__ = ("_dty
+0000d7d0: 7065 735f 7661 6c75 6522 2c29 0a20 2020  pes_value",).   
+0000d7e0: 205f 6e6f 5f63 6f70 795f 6174 7472 735f   _no_copy_attrs_
+0000d7f0: 203d 2043 6875 6e6b 4461 7461 2e5f 6e6f   = ChunkData._no
+0000d800: 5f63 6f70 795f 6174 7472 735f 207c 207b  _copy_attrs_ | {
+0000d810: 225f 6474 7970 6573 222c 2022 5f63 6f6c  "_dtypes", "_col
+0000d820: 756d 6e73 5f76 616c 7565 227d 0a0a 2020  umns_value"}..  
+0000d830: 2020 2320 7265 7175 6972 6564 2066 6965    # required fie
+0000d840: 6c64 730a 2020 2020 5f73 6861 7065 203d  lds.    _shape =
+0000d850: 2054 7570 6c65 4669 656c 6428 0a20 2020   TupleField(.   
+0000d860: 2020 2020 2022 7368 6170 6522 2c0a 2020       "shape",.  
+0000d870: 2020 2020 2020 4669 656c 6454 7970 6573        FieldTypes
+0000d880: 2e69 6e74 3634 2c0a 2020 2020 2020 2020  .int64,.        
+0000d890: 6f6e 5f73 6572 6961 6c69 7a65 3d6f 6e5f  on_serialize=on_
+0000d8a0: 7365 7269 616c 697a 655f 7368 6170 652c  serialize_shape,
+0000d8b0: 0a20 2020 2020 2020 206f 6e5f 6465 7365  .        on_dese
+0000d8c0: 7269 616c 697a 653d 6f6e 5f64 6573 6572  rialize=on_deser
+0000d8d0: 6961 6c69 7a65 5f73 6861 7065 2c0a 2020  ialize_shape,.  
+0000d8e0: 2020 290a 2020 2020 2320 6f70 7469 6f6e    ).    # option
+0000d8f0: 616c 2066 6965 6c64 730a 2020 2020 5f64  al fields.    _d
+0000d900: 7479 7065 7320 3d20 4368 756e 6b44 7479  types = ChunkDty
+0000d910: 7065 7346 6965 6c64 2822 6474 7970 6573  pesField("dtypes
+0000d920: 2229 0a20 2020 205f 696e 6465 785f 7661  ").    _index_va
+0000d930: 6c75 6520 3d20 4368 756e 6b49 6e64 6578  lue = ChunkIndex
+0000d940: 5661 6c75 6546 6965 6c64 280a 2020 2020  ValueField(.    
+0000d950: 2020 2020 2269 6e64 6578 5f76 616c 7565      "index_value
+0000d960: 222c 2049 6e64 6578 5661 6c75 652c 206f  ", IndexValue, o
+0000d970: 6e5f 6465 7365 7269 616c 697a 653d 5f6f  n_deserialize=_o
+0000d980: 6e5f 6465 7365 7269 616c 697a 655f 696e  n_deserialize_in
+0000d990: 6465 785f 7661 6c75 650a 2020 2020 290a  dex_value.    ).
+0000d9a0: 2020 2020 5f63 6f6c 756d 6e73 5f76 616c      _columns_val
+0000d9b0: 7565 203d 2043 6875 6e6b 436f 6c75 6d6e  ue = ChunkColumn
+0000d9c0: 7356 616c 7565 4669 656c 6428 2263 6f6c  sValueField("col
+0000d9d0: 756d 6e73 5f76 616c 7565 222c 2049 6e64  umns_value", Ind
+0000d9e0: 6578 5661 6c75 6529 0a0a 2020 2020 6465  exValue)..    de
+0000d9f0: 6620 5f5f 696e 6974 5f5f 280a 2020 2020  f __init__(.    
+0000da00: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000da10: 2020 6f70 3d4e 6f6e 652c 0a20 2020 2020    op=None,.     
+0000da20: 2020 2073 6861 7065 3d4e 6f6e 652c 0a20     shape=None,. 
+0000da30: 2020 2020 2020 2069 6e64 6578 3d4e 6f6e         index=Non
+0000da40: 652c 0a20 2020 2020 2020 2064 7479 7065  e,.        dtype
+0000da50: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+0000da60: 696e 6465 785f 7661 6c75 653d 4e6f 6e65  index_value=None
+0000da70: 2c0a 2020 2020 2020 2020 636f 6c75 6d6e  ,.        column
+0000da80: 735f 7661 6c75 653d 4e6f 6e65 2c0a 2020  s_value=None,.  
+0000da90: 2020 2020 2020 2a2a 6b77 2c0a 2020 2020        **kw,.    
+0000daa0: 293a 0a20 2020 2020 2020 2073 7570 6572  ):.        super
+0000dab0: 2829 2e5f 5f69 6e69 745f 5f28 0a20 2020  ().__init__(.   
+0000dac0: 2020 2020 2020 2020 205f 6f70 3d6f 702c           _op=op,
+0000dad0: 0a20 2020 2020 2020 2020 2020 205f 7368  .            _sh
+0000dae0: 6170 653d 7368 6170 652c 0a20 2020 2020  ape=shape,.     
+0000daf0: 2020 2020 2020 205f 696e 6465 783d 696e         _index=in
+0000db00: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
+0000db10: 205f 6474 7970 6573 3d64 7479 7065 732c   _dtypes=dtypes,
+0000db20: 0a20 2020 2020 2020 2020 2020 205f 696e  .            _in
+0000db30: 6465 785f 7661 6c75 653d 696e 6465 785f  dex_value=index_
+0000db40: 7661 6c75 652c 0a20 2020 2020 2020 2020  value,.         
+0000db50: 2020 205f 636f 6c75 6d6e 735f 7661 6c75     _columns_valu
+0000db60: 653d 636f 6c75 6d6e 735f 7661 6c75 652c  e=columns_value,
+0000db70: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
+0000db80: 772c 0a20 2020 2020 2020 2029 0a20 2020  w,.        ).   
+0000db90: 2020 2020 2073 656c 662e 5f64 7479 7065       self._dtype
+0000dba0: 735f 7661 6c75 6520 3d20 4e6f 6e65 0a0a  s_value = None..
+0000dbb0: 2020 2020 6465 6620 5f5f 6f6e 5f64 6573      def __on_des
+0000dbc0: 6572 6961 6c69 7a65 5f5f 2873 656c 6629  erialize__(self)
+0000dbd0: 3a0a 2020 2020 2020 2020 7375 7065 7228  :.        super(
+0000dbe0: 4261 7365 4461 7461 4672 616d 6543 6875  BaseDataFrameChu
+0000dbf0: 6e6b 4461 7461 2c20 7365 6c66 292e 5f5f  nkData, self).__
+0000dc00: 6f6e 5f64 6573 6572 6961 6c69 7a65 5f5f  on_deserialize__
+0000dc10: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+0000dc20: 5f64 7479 7065 735f 7661 6c75 6520 3d20  _dtypes_value = 
+0000dc30: 4e6f 6e65 0a0a 2020 2020 6465 6620 5f5f  None..    def __
+0000dc40: 6c65 6e5f 5f28 7365 6c66 293a 0a20 2020  len__(self):.   
+0000dc50: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000dc60: 2e73 6861 7065 5b30 5d0a 0a20 2020 2064  .shape[0]..    d
+0000dc70: 6566 205f 6765 745f 7061 7261 6d73 2873  ef _get_params(s
+0000dc80: 656c 6629 202d 3e20 4469 6374 5b73 7472  elf) -> Dict[str
+0000dc90: 2c20 416e 795d 3a0a 2020 2020 2020 2020  , Any]:.        
+0000dca0: 2320 7061 7261 6d73 2072 6574 7572 6e20  # params return 
+0000dcb0: 7468 6520 7072 6f70 6572 7469 6573 2077  the properties w
+0000dcc0: 6869 6368 2075 7365 6675 6c20 746f 2072  hich useful to r
+0000dcd0: 6562 7569 6c64 2061 206e 6577 2063 6875  ebuild a new chu
+0000dce0: 6e6b 0a20 2020 2020 2020 2072 6574 7572  nk.        retur
+0000dcf0: 6e20 7b0a 2020 2020 2020 2020 2020 2020  n {.            
+0000dd00: 2273 6861 7065 223a 2073 656c 662e 7368  "shape": self.sh
+0000dd10: 6170 652c 0a20 2020 2020 2020 2020 2020  ape,.           
+0000dd20: 2022 6474 7970 6573 223a 2073 656c 662e   "dtypes": self.
+0000dd30: 6474 7970 6573 2c0a 2020 2020 2020 2020  dtypes,.        
+0000dd40: 2020 2020 2264 7479 7065 735f 7661 6c75      "dtypes_valu
+0000dd50: 6522 3a20 7365 6c66 2e64 7479 7065 735f  e": self.dtypes_
+0000dd60: 7661 6c75 652c 0a20 2020 2020 2020 2020  value,.         
+0000dd70: 2020 2022 696e 6465 7822 3a20 7365 6c66     "index": self
+0000dd80: 2e69 6e64 6578 2c0a 2020 2020 2020 2020  .index,.        
+0000dd90: 2020 2020 2269 6e64 6578 5f76 616c 7565      "index_value
+0000dda0: 223a 2073 656c 662e 696e 6465 785f 7661  ": self.index_va
+0000ddb0: 6c75 652c 0a20 2020 2020 2020 2020 2020  lue,.           
+0000ddc0: 2022 636f 6c75 6d6e 735f 7661 6c75 6522   "columns_value"
+0000ddd0: 3a20 7365 6c66 2e63 6f6c 756d 6e73 5f76  : self.columns_v
+0000dde0: 616c 7565 2c0a 2020 2020 2020 2020 7d0a  alue,.        }.
+0000ddf0: 0a20 2020 2064 6566 205f 7365 745f 7061  .    def _set_pa
+0000de00: 7261 6d73 2873 656c 662c 206e 6577 5f70  rams(self, new_p
+0000de10: 6172 616d 733a 2044 6963 745b 7374 722c  arams: Dict[str,
+0000de20: 2041 6e79 5d29 3a0a 2020 2020 2020 2020   Any]):.        
+0000de30: 7061 7261 6d73 203d 206e 6577 5f70 6172  params = new_par
+0000de40: 616d 732e 636f 7079 2829 0a20 2020 2020  ams.copy().     
+0000de50: 2020 2070 6172 616d 732e 706f 7028 2269     params.pop("i
+0000de60: 6e64 6578 222c 204e 6f6e 6529 2020 2320  ndex", None)  # 
+0000de70: 696e 6465 7820 6e6f 7420 6e65 6564 6564  index not needed
+0000de80: 2074 6f20 7570 6461 7465 0a20 2020 2020   to update.     
+0000de90: 2020 206e 6577 5f73 6861 7065 203d 2070     new_shape = p
+0000dea0: 6172 616d 732e 706f 7028 2273 6861 7065  arams.pop("shape
+0000deb0: 222c 204e 6f6e 6529 0a20 2020 2020 2020  ", None).       
+0000dec0: 2069 6620 6e65 775f 7368 6170 6520 6973   if new_shape is
+0000ded0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0000dee0: 2020 2020 2020 2073 656c 662e 5f73 6861         self._sha
+0000def0: 7065 203d 206e 6577 5f73 6861 7065 0a20  pe = new_shape. 
+0000df00: 2020 2020 2020 2069 6e64 6578 5f76 616c         index_val
+0000df10: 7565 203d 2070 6172 616d 732e 706f 7028  ue = params.pop(
+0000df20: 2269 6e64 6578 5f76 616c 7565 222c 204e  "index_value", N
+0000df30: 6f6e 6529 0a20 2020 2020 2020 2069 6620  one).        if 
+0000df40: 696e 6465 785f 7661 6c75 6520 6973 206e  index_value is n
+0000df50: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0000df60: 2020 2020 2073 656c 662e 5f69 6e64 6578       self._index
+0000df70: 5f76 616c 7565 203d 2069 6e64 6578 5f76  _value = index_v
+0000df80: 616c 7565 0a20 2020 2020 2020 2064 7479  alue.        dty
+0000df90: 7065 7320 3d20 7061 7261 6d73 2e70 6f70  pes = params.pop
+0000dfa0: 2822 6474 7970 6573 222c 204e 6f6e 6529  ("dtypes", None)
+0000dfb0: 0a20 2020 2020 2020 2069 6620 6474 7970  .        if dtyp
+0000dfc0: 6573 2069 7320 6e6f 7420 4e6f 6e65 3a0a  es is not None:.
+0000dfd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000dfe0: 2e5f 6474 7970 6573 203d 2064 7479 7065  ._dtypes = dtype
+0000dff0: 730a 2020 2020 2020 2020 636f 6c75 6d6e  s.        column
+0000e000: 735f 7661 6c75 6520 3d20 7061 7261 6d73  s_value = params
+0000e010: 2e70 6f70 2822 636f 6c75 6d6e 735f 7661  .pop("columns_va
+0000e020: 6c75 6522 2c20 4e6f 6e65 290a 2020 2020  lue", None).    
+0000e030: 2020 2020 6966 2063 6f6c 756d 6e73 5f76      if columns_v
+0000e040: 616c 7565 2069 7320 6e6f 7420 4e6f 6e65  alue is not None
+0000e050: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0000e060: 6c66 2e5f 636f 6c75 6d6e 735f 7661 6c75  lf._columns_valu
+0000e070: 6520 3d20 636f 6c75 6d6e 735f 7661 6c75  e = columns_valu
+0000e080: 650a 2020 2020 2020 2020 6474 7970 6573  e.        dtypes
+0000e090: 5f76 616c 7565 203d 2070 6172 616d 732e  _value = params.
+0000e0a0: 706f 7028 2264 7479 7065 735f 7661 6c75  pop("dtypes_valu
+0000e0b0: 6522 2c20 4e6f 6e65 290a 2020 2020 2020  e", None).      
+0000e0c0: 2020 6966 2064 7479 7065 735f 7661 6c75    if dtypes_valu
+0000e0d0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+0000e0e0: 2020 2020 2020 2020 2020 2069 6620 6474             if dt
+0000e0f0: 7970 6573 2069 7320 4e6f 6e65 3a0a 2020  ypes is None:.  
+0000e100: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000e110: 6c66 2e5f 6474 7970 6573 203d 2064 7479  lf._dtypes = dty
+0000e120: 7065 735f 7661 6c75 652e 7661 6c75 650a  pes_value.value.
+0000e130: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+0000e140: 6f6c 756d 6e73 5f76 616c 7565 2069 7320  olumns_value is 
+0000e150: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000e160: 2020 2020 2020 7365 6c66 2e5f 636f 6c75        self._colu
+0000e170: 6d6e 735f 7661 6c75 6520 3d20 7061 7273  mns_value = pars
+0000e180: 655f 696e 6465 7828 7365 6c66 2e5f 6474  e_index(self._dt
+0000e190: 7970 6573 2e69 6e64 6578 2c20 7374 6f72  ypes.index, stor
+0000e1a0: 655f 6461 7461 3d54 7275 6529 0a20 2020  e_data=True).   
+0000e1b0: 2020 2020 2020 2020 2073 656c 662e 5f64           self._d
+0000e1c0: 7479 7065 735f 7661 6c75 6520 3d20 6474  types_value = dt
+0000e1d0: 7970 6573 5f76 616c 7565 0a20 2020 2020  ypes_value.     
+0000e1e0: 2020 2069 6620 7061 7261 6d73 3a20 2023     if params:  #
+0000e1f0: 2070 7261 676d 613a 206e 6f20 636f 7665   pragma: no cove
+0000e200: 720a 2020 2020 2020 2020 2020 2020 7261  r.            ra
+0000e210: 6973 6520 5479 7065 4572 726f 7228 6622  ise TypeError(f"
+0000e220: 556e 6b6e 6f77 6e20 7061 7261 6d73 3a20  Unknown params: 
+0000e230: 7b6c 6973 7428 7061 7261 6d73 297d 2229  {list(params)}")
+0000e240: 0a0a 2020 2020 7061 7261 6d73 203d 2070  ..    params = p
+0000e250: 726f 7065 7274 7928 5f67 6574 5f70 6172  roperty(_get_par
+0000e260: 616d 732c 205f 7365 745f 7061 7261 6d73  ams, _set_params
+0000e270: 290a 0a20 2020 2040 636c 6173 736d 6574  )..    @classmet
+0000e280: 686f 640a 2020 2020 6465 6620 6765 745f  hod.    def get_
+0000e290: 7061 7261 6d73 5f66 726f 6d5f 6461 7461  params_from_data
+0000e2a0: 2863 6c73 2c20 6461 7461 3a20 7064 2e44  (cls, data: pd.D
+0000e2b0: 6174 6146 7261 6d65 2920 2d3e 2044 6963  ataFrame) -> Dic
+0000e2c0: 745b 7374 722c 2041 6e79 5d3a 0a20 2020  t[str, Any]:.   
+0000e2d0: 2020 2020 2070 6172 7365 5f69 6e64 6578       parse_index
+0000e2e0: 2864 6174 612e 696e 6465 782c 2073 746f  (data.index, sto
+0000e2f0: 7265 5f64 6174 613d 4661 6c73 6529 0a20  re_data=False). 
+0000e300: 2020 2020 2020 2072 6574 7572 6e20 7b0a         return {.
+0000e310: 2020 2020 2020 2020 2020 2020 2273 6861              "sha
+0000e320: 7065 223a 2064 6174 612e 7368 6170 652c  pe": data.shape,
+0000e330: 0a20 2020 2020 2020 2020 2020 2022 696e  .            "in
+0000e340: 6465 785f 7661 6c75 6522 3a20 7061 7273  dex_value": pars
+0000e350: 655f 696e 6465 7828 6461 7461 2e69 6e64  e_index(data.ind
+0000e360: 6578 2c20 7374 6f72 655f 6461 7461 3d46  ex, store_data=F
+0000e370: 616c 7365 292c 0a20 2020 2020 2020 2020  alse),.         
+0000e380: 2020 2022 6474 7970 6573 5f76 616c 7565     "dtypes_value
+0000e390: 223a 2044 7479 7065 7356 616c 7565 286b  ": DtypesValue(k
+0000e3a0: 6579 3d74 6f6b 656e 697a 6528 6461 7461  ey=tokenize(data
+0000e3b0: 2e64 7479 7065 7329 2c20 7661 6c75 653d  .dtypes), value=
+0000e3c0: 6461 7461 2e64 7479 7065 7329 2c0a 2020  data.dtypes),.  
+0000e3d0: 2020 2020 2020 7d0a 0a20 2020 2040 7072        }..    @pr
+0000e3e0: 6f70 6572 7479 0a20 2020 2064 6566 2073  operty.    def s
+0000e3f0: 6861 7065 2873 656c 6629 3a0a 2020 2020  hape(self):.    
+0000e400: 2020 2020 7265 7475 726e 2067 6574 6174      return getat
+0000e410: 7472 2873 656c 662c 2022 5f73 6861 7065  tr(self, "_shape
+0000e420: 222c 204e 6f6e 6529 0a0a 2020 2020 4070  ", None)..    @p
+0000e430: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000e440: 6e64 696d 2873 656c 6629 3a0a 2020 2020  ndim(self):.    
+0000e450: 2020 2020 7265 7475 726e 206c 656e 2873      return len(s
+0000e460: 656c 662e 7368 6170 6529 0a0a 2020 2020  elf.shape)..    
+0000e470: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000e480: 6620 6474 7970 6573 2873 656c 6629 3a0a  f dtypes(self):.
+0000e490: 2020 2020 2020 2020 6474 203d 2067 6574          dt = get
+0000e4a0: 6174 7472 2873 656c 662c 2022 5f64 7479  attr(self, "_dty
+0000e4b0: 7065 7322 2c20 4e6f 6e65 290a 2020 2020  pes", None).    
+0000e4c0: 2020 2020 6966 2064 7420 6973 206e 6f74      if dt is not
+0000e4d0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0000e4e0: 2020 2072 6574 7572 6e20 6474 0a20 2020     return dt.   
+0000e4f0: 2020 2020 2072 6574 7572 6e20 6765 7461       return geta
+0000e500: 7474 7228 7365 6c66 2e6f 702c 2022 6474  ttr(self.op, "dt
+0000e510: 7970 6573 222c 204e 6f6e 6529 0a0a 2020  ypes", None)..  
+0000e520: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000e530: 6465 6620 6474 7970 6573 5f76 616c 7565  def dtypes_value
+0000e540: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000e550: 6966 2073 656c 662e 5f64 7479 7065 735f  if self._dtypes_
+0000e560: 7661 6c75 6520 6973 206e 6f74 204e 6f6e  value is not Non
+0000e570: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0000e580: 6574 7572 6e20 7365 6c66 2e5f 6474 7970  eturn self._dtyp
+0000e590: 6573 5f76 616c 7565 0a20 2020 2020 2020  es_value.       
+0000e5a0: 2023 2054 4f44 4f28 7169 6e78 7579 6529   # TODO(qinxuye)
+0000e5b0: 3a20 7768 656e 2063 7265 6174 696e 6720  : when creating 
+0000e5c0: 4461 7461 6672 616d 652c 0a20 2020 2020  Dataframe,.     
+0000e5d0: 2020 2023 2020 6474 7970 6573 5f76 616c     #  dtypes_val
+0000e5e0: 7565 2069 6e73 7465 6164 206f 6620 6474  ue instead of dt
+0000e5f0: 7970 6573 206c 6174 6572 206d 7573 7420  ypes later must 
+0000e600: 6265 2070 6173 7365 6420 696e 746f 0a20  be passed into. 
+0000e610: 2020 2020 2020 2064 7479 7065 7320 3d20         dtypes = 
+0000e620: 7365 6c66 2e64 7479 7065 730a 2020 2020  self.dtypes.    
+0000e630: 2020 2020 6966 2064 7479 7065 7320 6973      if dtypes is
+0000e640: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0000e650: 2020 2020 2020 2073 656c 662e 5f64 7479         self._dty
+0000e660: 7065 735f 7661 6c75 6520 3d20 4474 7970  pes_value = Dtyp
+0000e670: 6573 5661 6c75 6528 6b65 793d 746f 6b65  esValue(key=toke
+0000e680: 6e69 7a65 2864 7479 7065 7329 2c20 7661  nize(dtypes), va
+0000e690: 6c75 653d 6474 7970 6573 290a 2020 2020  lue=dtypes).    
+0000e6a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000e6b0: 656c 662e 5f64 7479 7065 735f 7661 6c75  elf._dtypes_valu
+0000e6c0: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
+0000e6d0: 0a20 2020 2064 6566 2069 6e64 6578 5f76  .    def index_v
+0000e6e0: 616c 7565 2873 656c 6629 3a0a 2020 2020  alue(self):.    
+0000e6f0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000e700: 5f69 6e64 6578 5f76 616c 7565 0a0a 2020  _index_value..  
+0000e710: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000e720: 6465 6620 636f 6c75 6d6e 735f 7661 6c75  def columns_valu
+0000e730: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+0000e740: 2072 6574 7572 6e20 7365 6c66 2e5f 636f   return self._co
+0000e750: 6c75 6d6e 735f 7661 6c75 650a 0a0a 636c  lumns_value...cl
+0000e760: 6173 7320 4461 7461 4672 616d 6543 6875  ass DataFrameChu
+0000e770: 6e6b 4461 7461 2842 6173 6544 6174 6146  nkData(BaseDataF
+0000e780: 7261 6d65 4368 756e 6b44 6174 6129 3a0a  rameChunkData):.
+0000e790: 2020 2020 7479 7065 5f6e 616d 6520 3d20      type_name = 
+0000e7a0: 2244 6174 6146 7261 6d65 220a 0a0a 636c  "DataFrame"...cl
+0000e7b0: 6173 7320 4461 7461 4672 616d 6543 6875  ass DataFrameChu
+0000e7c0: 6e6b 2843 6875 6e6b 293a 0a20 2020 205f  nk(Chunk):.    _
+0000e7d0: 5f73 6c6f 7473 5f5f 203d 2028 290a 2020  _slots__ = ().  
+0000e7e0: 2020 5f61 6c6c 6f77 5f64 6174 615f 7479    _allow_data_ty
+0000e7f0: 7065 5f20 3d20 2844 6174 6146 7261 6d65  pe_ = (DataFrame
+0000e800: 4368 756e 6b44 6174 612c 290a 2020 2020  ChunkData,).    
+0000e810: 7479 7065 5f6e 616d 6520 3d20 2244 6174  type_name = "Dat
+0000e820: 6146 7261 6d65 220a 0a20 2020 2064 6566  aFrame"..    def
+0000e830: 205f 5f6c 656e 5f5f 2873 656c 6629 3a0a   __len__(self):.
+0000e840: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+0000e850: 656e 2873 656c 662e 5f64 6174 6129 0a0a  en(self._data)..
+0000e860: 0a63 6c61 7373 2042 6173 6544 6174 6146  .class BaseDataF
+0000e870: 7261 6d65 4461 7461 2848 6173 5368 6170  rameData(HasShap
+0000e880: 6554 696c 6561 626c 6544 6174 612c 205f  eTileableData, _
+0000e890: 546f 5061 6e64 6173 4d69 7869 6e29 3a0a  ToPandasMixin):.
+0000e8a0: 2020 2020 5f5f 736c 6f74 735f 5f20 3d20      __slots__ = 
+0000e8b0: 225f 6163 6365 7373 6f72 7322 2c20 225f  "_accessors", "_
+0000e8c0: 6474 7970 6573 5f76 616c 7565 222c 2022  dtypes_value", "
+0000e8d0: 5f64 7479 7065 735f 6469 6374 220a 0a20  _dtypes_dict".. 
+0000e8e0: 2020 2023 206f 7074 696f 6e61 6c20 6669     # optional fi
+0000e8f0: 656c 6473 0a20 2020 205f 6474 7970 6573  elds.    _dtypes
+0000e900: 203d 2053 6572 6965 7346 6965 6c64 2822   = SeriesField("
+0000e910: 6474 7970 6573 2229 0a20 2020 205f 696e  dtypes").    _in
+0000e920: 6465 785f 7661 6c75 6520 3d20 5265 6665  dex_value = Refe
+0000e930: 7265 6e63 6546 6965 6c64 280a 2020 2020  renceField(.    
+0000e940: 2020 2020 2269 6e64 6578 5f76 616c 7565      "index_value
+0000e950: 222c 2049 6e64 6578 5661 6c75 652c 206f  ", IndexValue, o
+0000e960: 6e5f 6465 7365 7269 616c 697a 653d 5f6f  n_deserialize=_o
+0000e970: 6e5f 6465 7365 7269 616c 697a 655f 696e  n_deserialize_in
+0000e980: 6465 785f 7661 6c75 650a 2020 2020 290a  dex_value.    ).
+0000e990: 2020 2020 5f63 6f6c 756d 6e73 5f76 616c      _columns_val
+0000e9a0: 7565 203d 2052 6566 6572 656e 6365 4669  ue = ReferenceFi
+0000e9b0: 656c 6428 2263 6f6c 756d 6e73 5f76 616c  eld("columns_val
+0000e9c0: 7565 222c 2049 6e64 6578 5661 6c75 6529  ue", IndexValue)
+0000e9d0: 0a20 2020 205f 6368 756e 6b73 203d 204c  .    _chunks = L
+0000e9e0: 6973 7446 6965 6c64 280a 2020 2020 2020  istField(.      
+0000e9f0: 2020 2263 6875 6e6b 7322 2c0a 2020 2020    "chunks",.    
+0000ea00: 2020 2020 4669 656c 6454 7970 6573 2e72      FieldTypes.r
+0000ea10: 6566 6572 656e 6365 2844 6174 6146 7261  eference(DataFra
+0000ea20: 6d65 4368 756e 6b44 6174 6129 2c0a 2020  meChunkData),.  
+0000ea30: 2020 2020 2020 6f6e 5f73 6572 6961 6c69        on_seriali
+0000ea40: 7a65 3d6c 616d 6264 6120 783a 205b 6974  ze=lambda x: [it
+0000ea50: 2e64 6174 6120 666f 7220 6974 2069 6e20  .data for it in 
+0000ea60: 785d 2069 6620 7820 6973 206e 6f74 204e  x] if x is not N
+0000ea70: 6f6e 6520 656c 7365 2078 2c0a 2020 2020  one else x,.    
+0000ea80: 2020 2020 6f6e 5f64 6573 6572 6961 6c69      on_deseriali
+0000ea90: 7a65 3d6c 616d 6264 6120 783a 205b 4461  ze=lambda x: [Da
+0000eaa0: 7461 4672 616d 6543 6875 6e6b 2869 7429  taFrameChunk(it)
+0000eab0: 2066 6f72 2069 7420 696e 2078 5d0a 2020   for it in x].  
+0000eac0: 2020 2020 2020 6966 2078 2069 7320 6e6f        if x is no
+0000ead0: 7420 4e6f 6e65 0a20 2020 2020 2020 2065  t None.        e
+0000eae0: 6c73 6520 782c 0a20 2020 2029 0a0a 2020  lse x,.    )..  
+0000eaf0: 2020 6465 6620 5f5f 696e 6974 5f5f 280a    def __init__(.
+0000eb00: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000eb10: 2020 2020 2020 6f70 3d4e 6f6e 652c 0a20        op=None,. 
+0000eb20: 2020 2020 2020 2073 6861 7065 3d4e 6f6e         shape=Non
+0000eb30: 652c 0a20 2020 2020 2020 206e 7370 6c69  e,.        nspli
+0000eb40: 7473 3d4e 6f6e 652c 0a20 2020 2020 2020  ts=None,.       
+0000eb50: 2064 7479 7065 733d 4e6f 6e65 2c0a 2020   dtypes=None,.  
+0000eb60: 2020 2020 2020 696e 6465 785f 7661 6c75        index_valu
+0000eb70: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
+0000eb80: 636f 6c75 6d6e 735f 7661 6c75 653d 4e6f  columns_value=No
+0000eb90: 6e65 2c0a 2020 2020 2020 2020 6368 756e  ne,.        chun
+0000eba0: 6b73 3d4e 6f6e 652c 0a20 2020 2020 2020  ks=None,.       
+0000ebb0: 202a 2a6b 772c 0a20 2020 2029 3a0a 2020   **kw,.    ):.  
+0000ebc0: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
+0000ebd0: 696e 6974 5f5f 280a 2020 2020 2020 2020  init__(.        
+0000ebe0: 2020 2020 5f6f 703d 6f70 2c0a 2020 2020      _op=op,.    
+0000ebf0: 2020 2020 2020 2020 5f73 6861 7065 3d73          _shape=s
+0000ec00: 6861 7065 2c0a 2020 2020 2020 2020 2020  hape,.          
+0000ec10: 2020 5f6e 7370 6c69 7473 3d6e 7370 6c69    _nsplits=nspli
+0000ec20: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+0000ec30: 5f64 7479 7065 733d 6474 7970 6573 2c0a  _dtypes=dtypes,.
+0000ec40: 2020 2020 2020 2020 2020 2020 5f69 6e64              _ind
+0000ec50: 6578 5f76 616c 7565 3d69 6e64 6578 5f76  ex_value=index_v
+0000ec60: 616c 7565 2c0a 2020 2020 2020 2020 2020  alue,.          
+0000ec70: 2020 5f63 6f6c 756d 6e73 5f76 616c 7565    _columns_value
+0000ec80: 3d63 6f6c 756d 6e73 5f76 616c 7565 2c0a  =columns_value,.
+0000ec90: 2020 2020 2020 2020 2020 2020 5f63 6875              _chu
+0000eca0: 6e6b 733d 6368 756e 6b73 2c0a 2020 2020  nks=chunks,.    
+0000ecb0: 2020 2020 2020 2020 2a2a 6b77 2c0a 2020          **kw,.  
+0000ecc0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000ecd0: 7365 6c66 2e5f 6163 6365 7373 6f72 7320  self._accessors 
+0000ece0: 3d20 6469 6374 2829 0a20 2020 2020 2020  = dict().       
+0000ecf0: 2073 656c 662e 5f64 7479 7065 735f 7661   self._dtypes_va
+0000ed00: 6c75 6520 3d20 4e6f 6e65 0a20 2020 2020  lue = None.     
+0000ed10: 2020 2073 656c 662e 5f64 7479 7065 735f     self._dtypes_
+0000ed20: 6469 6374 203d 204e 6f6e 650a 0a20 2020  dict = None..   
+0000ed30: 2064 6566 205f 5f6f 6e5f 6465 7365 7269   def __on_deseri
+0000ed40: 616c 697a 655f 5f28 7365 6c66 293a 0a20  alize__(self):. 
+0000ed50: 2020 2020 2020 2073 7570 6572 2829 2e5f         super()._
+0000ed60: 5f6f 6e5f 6465 7365 7269 616c 697a 655f  _on_deserialize_
+0000ed70: 5f28 290a 2020 2020 2020 2020 7365 6c66  _().        self
+0000ed80: 2e5f 6163 6365 7373 6f72 7320 3d20 6469  ._accessors = di
+0000ed90: 6374 2829 0a20 2020 2020 2020 2073 656c  ct().        sel
+0000eda0: 662e 5f64 7479 7065 735f 7661 6c75 6520  f._dtypes_value 
+0000edb0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+0000edc0: 656c 662e 5f64 7479 7065 735f 6469 6374  elf._dtypes_dict
+0000edd0: 203d 204e 6f6e 650a 0a20 2020 2064 6566   = None..    def
+0000ede0: 205f 6765 745f 7061 7261 6d73 2873 656c   _get_params(sel
+0000edf0: 6629 202d 3e20 4469 6374 5b73 7472 2c20  f) -> Dict[str, 
+0000ee00: 416e 795d 3a0a 2020 2020 2020 2020 2320  Any]:.        # 
+0000ee10: 7061 7261 6d73 2072 6574 7572 6e20 7468  params return th
+0000ee20: 6520 7072 6f70 6572 7469 6573 2077 6869  e properties whi
+0000ee30: 6368 2075 7365 6675 6c20 746f 2072 6562  ch useful to reb
+0000ee40: 7569 6c64 2061 206e 6577 2074 696c 6561  uild a new tilea
+0000ee50: 626c 6520 6f62 6a65 6374 0a20 2020 2020  ble object.     
+0000ee60: 2020 2072 6574 7572 6e20 7b0a 2020 2020     return {.    
+0000ee70: 2020 2020 2020 2020 2273 6861 7065 223a          "shape":
+0000ee80: 2073 656c 662e 7368 6170 652c 0a20 2020   self.shape,.   
+0000ee90: 2020 2020 2020 2020 2022 6474 7970 6573           "dtypes
+0000eea0: 223a 2073 656c 662e 6474 7970 6573 2c0a  ": self.dtypes,.
+0000eeb0: 2020 2020 2020 2020 2020 2020 2269 6e64              "ind
+0000eec0: 6578 5f76 616c 7565 223a 2073 656c 662e  ex_value": self.
+0000eed0: 696e 6465 785f 7661 6c75 652c 0a20 2020  index_value,.   
+0000eee0: 2020 2020 2020 2020 2022 636f 6c75 6d6e           "column
+0000eef0: 735f 7661 6c75 6522 3a20 7365 6c66 2e63  s_value": self.c
+0000ef00: 6f6c 756d 6e73 5f76 616c 7565 2c0a 2020  olumns_value,.  
+0000ef10: 2020 2020 2020 2020 2020 2264 7479 7065            "dtype
+0000ef20: 735f 7661 6c75 6522 3a20 7365 6c66 2e64  s_value": self.d
+0000ef30: 7479 7065 735f 7661 6c75 652c 0a20 2020  types_value,.   
+0000ef40: 2020 2020 207d 0a0a 2020 2020 6465 6620       }..    def 
+0000ef50: 5f73 6574 5f70 6172 616d 7328 7365 6c66  _set_params(self
+0000ef60: 2c20 6e65 775f 7061 7261 6d73 3a20 4469  , new_params: Di
+0000ef70: 6374 5b73 7472 2c20 416e 795d 293a 0a20  ct[str, Any]):. 
+0000ef80: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+0000ef90: 6e65 775f 7061 7261 6d73 2e63 6f70 7928  new_params.copy(
+0000efa0: 290a 2020 2020 2020 2020 6e65 775f 7368  ).        new_sh
+0000efb0: 6170 6520 3d20 7061 7261 6d73 2e70 6f70  ape = params.pop
+0000efc0: 2822 7368 6170 6522 2c20 4e6f 6e65 290a  ("shape", None).
+0000efd0: 2020 2020 2020 2020 6966 206e 6577 5f73          if new_s
+0000efe0: 6861 7065 2069 7320 6e6f 7420 4e6f 6e65  hape is not None
+0000eff0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0000f000: 6c66 2e5f 7368 6170 6520 3d20 6e65 775f  lf._shape = new_
+0000f010: 7368 6170 650a 2020 2020 2020 2020 696e  shape.        in
+0000f020: 6465 785f 7661 6c75 6520 3d20 7061 7261  dex_value = para
+0000f030: 6d73 2e70 6f70 2822 696e 6465 785f 7661  ms.pop("index_va
+0000f040: 6c75 6522 2c20 4e6f 6e65 290a 2020 2020  lue", None).    
+0000f050: 2020 2020 6966 2069 6e64 6578 5f76 616c      if index_val
+0000f060: 7565 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ue is not None:.
+0000f070: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000f080: 2e5f 696e 6465 785f 7661 6c75 6520 3d20  ._index_value = 
+0000f090: 696e 6465 785f 7661 6c75 650a 2020 2020  index_value.    
+0000f0a0: 2020 2020 6474 7970 6573 203d 2070 6172      dtypes = par
+0000f0b0: 616d 732e 706f 7028 2264 7479 7065 7322  ams.pop("dtypes"
+0000f0c0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+0000f0d0: 6966 2064 7479 7065 7320 6973 206e 6f74  if dtypes is not
+0000f0e0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0000f0f0: 2020 2073 656c 662e 5f64 7479 7065 7320     self._dtypes 
+0000f100: 3d20 6474 7970 6573 0a20 2020 2020 2020  = dtypes.       
+0000f110: 2063 6f6c 756d 6e73 5f76 616c 7565 203d   columns_value =
+0000f120: 2070 6172 616d 732e 706f 7028 2263 6f6c   params.pop("col
+0000f130: 756d 6e73 5f76 616c 7565 222c 204e 6f6e  umns_value", Non
+0000f140: 6529 0a20 2020 2020 2020 2069 6620 636f  e).        if co
+0000f150: 6c75 6d6e 735f 7661 6c75 6520 6973 206e  lumns_value is n
+0000f160: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0000f170: 2020 2020 2073 656c 662e 5f63 6f6c 756d       self._colum
+0000f180: 6e73 5f76 616c 7565 203d 2063 6f6c 756d  ns_value = colum
+0000f190: 6e73 5f76 616c 7565 0a20 2020 2020 2020  ns_value.       
+0000f1a0: 2064 7479 7065 735f 7661 6c75 6520 3d20   dtypes_value = 
+0000f1b0: 7061 7261 6d73 2e70 6f70 2822 6474 7970  params.pop("dtyp
+0000f1c0: 6573 5f76 616c 7565 222c 204e 6f6e 6529  es_value", None)
+0000f1d0: 0a20 2020 2020 2020 2069 6620 6474 7970  .        if dtyp
+0000f1e0: 6573 5f76 616c 7565 2069 7320 6e6f 7420  es_value is not 
+0000f1f0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000f200: 2020 6966 2064 7479 7065 7320 6973 204e    if dtypes is N
+0000f210: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0000f220: 2020 2020 2073 656c 662e 5f64 7479 7065       self._dtype
+0000f230: 7320 3d20 6474 7970 6573 5f76 616c 7565  s = dtypes_value
+0000f240: 2e76 616c 7565 0a20 2020 2020 2020 2020  .value.         
+0000f250: 2020 2069 6620 636f 6c75 6d6e 735f 7661     if columns_va
+0000f260: 6c75 6520 6973 204e 6f6e 653a 0a20 2020  lue is None:.   
+0000f270: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000f280: 662e 5f63 6f6c 756d 6e73 5f76 616c 7565  f._columns_value
+0000f290: 203d 2070 6172 7365 5f69 6e64 6578 2873   = parse_index(s
+0000f2a0: 656c 662e 5f64 7479 7065 732e 696e 6465  elf._dtypes.inde
+0000f2b0: 782c 2073 746f 7265 5f64 6174 613d 5472  x, store_data=Tr
+0000f2c0: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
+0000f2d0: 7365 6c66 2e5f 6474 7970 6573 5f76 616c  self._dtypes_val
+0000f2e0: 7565 203d 2064 7479 7065 735f 7661 6c75  ue = dtypes_valu
+0000f2f0: 650a 2020 2020 2020 2020 6966 2070 6172  e.        if par
+0000f300: 616d 733a 2020 2320 7072 6167 6d61 3a20  ams:  # pragma: 
+0000f310: 6e6f 2063 6f76 6572 0a20 2020 2020 2020  no cover.       
+0000f320: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+0000f330: 7272 6f72 2866 2255 6e6b 6e6f 776e 2070  rror(f"Unknown p
+0000f340: 6172 616d 733a 207b 6c69 7374 2870 6172  arams: {list(par
+0000f350: 616d 7329 7d22 290a 0a20 2020 2070 6172  ams)}")..    par
+0000f360: 616d 7320 3d20 7072 6f70 6572 7479 285f  ams = property(_
+0000f370: 6765 745f 7061 7261 6d73 2c20 5f73 6574  get_params, _set
+0000f380: 5f70 6172 616d 7329 0a0a 2020 2020 6465  _params)..    de
+0000f390: 6620 7265 6672 6573 685f 7061 7261 6d73  f refresh_params
+0000f3a0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000f3b0: 2320 7265 6672 6573 6820 7061 7261 6d73  # refresh params
+0000f3c0: 2077 6865 6e20 6368 756e 6b73 2075 7064   when chunks upd
+0000f3d0: 6174 6564 0a20 2020 2020 2020 2072 6566  ated.        ref
+0000f3e0: 7265 7368 5f74 696c 6561 626c 655f 7368  resh_tileable_sh
+0000f3f0: 6170 6528 7365 6c66 290a 2020 2020 2020  ape(self).      
+0000f400: 2020 7265 6672 6573 685f 696e 6465 785f    refresh_index_
+0000f410: 7661 6c75 6528 7365 6c66 290a 2020 2020  value(self).    
+0000f420: 2020 2020 7265 6672 6573 685f 6474 7970      refresh_dtyp
+0000f430: 6573 2873 656c 6629 0a0a 2020 2020 4070  es(self)..    @p
+0000f440: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000f450: 6474 7970 6573 2873 656c 6629 3a0a 2020  dtypes(self):.  
+0000f460: 2020 2020 2020 6474 203d 2067 6574 6174        dt = getat
+0000f470: 7472 2873 656c 662c 2022 5f64 7479 7065  tr(self, "_dtype
+0000f480: 7322 2c20 4e6f 6e65 290a 2020 2020 2020  s", None).      
+0000f490: 2020 6966 2064 7420 6973 206e 6f74 204e    if dt is not N
+0000f4a0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0000f4b0: 2072 6574 7572 6e20 6474 0a20 2020 2020   return dt.     
+0000f4c0: 2020 2072 6574 7572 6e20 6765 7461 7474     return getatt
+0000f4d0: 7228 7365 6c66 2e6f 702c 2022 6474 7970  r(self.op, "dtyp
+0000f4e0: 6573 222c 204e 6f6e 6529 0a0a 2020 2020  es", None)..    
+0000f4f0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000f500: 6620 6474 7970 6573 5f76 616c 7565 2873  f dtypes_value(s
+0000f510: 656c 6629 3a0a 2020 2020 2020 2020 6966  elf):.        if
+0000f520: 2073 656c 662e 5f64 7479 7065 735f 7661   self._dtypes_va
+0000f530: 6c75 6520 6973 206e 6f74 204e 6f6e 653a  lue is not None:
+0000f540: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000f550: 7572 6e20 7365 6c66 2e5f 6474 7970 6573  urn self._dtypes
+0000f560: 5f76 616c 7565 0a20 2020 2020 2020 2023  _value.        #
+0000f570: 2054 4f44 4f28 7169 6e78 7579 6529 3a20   TODO(qinxuye): 
+0000f580: 7768 656e 2063 7265 6174 696e 6720 4461  when creating Da
+0000f590: 7461 6672 616d 652c 0a20 2020 2020 2020  taframe,.       
+0000f5a0: 2023 2020 6474 7970 6573 5f76 616c 7565   #  dtypes_value
+0000f5b0: 2069 6e73 7465 6164 206f 6620 6474 7970   instead of dtyp
+0000f5c0: 6573 206c 6174 6572 206d 7573 7420 6265  es later must be
+0000f5d0: 2070 6173 7365 6420 696e 746f 0a20 2020   passed into.   
+0000f5e0: 2020 2020 2064 7479 7065 7320 3d20 7365       dtypes = se
+0000f5f0: 6c66 2e64 7479 7065 730a 2020 2020 2020  lf.dtypes.      
+0000f600: 2020 6966 2064 7479 7065 7320 6973 206e    if dtypes is n
+0000f610: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0000f620: 2020 2020 2073 656c 662e 5f64 7479 7065       self._dtype
+0000f630: 735f 7661 6c75 6520 3d20 4474 7970 6573  s_value = Dtypes
+0000f640: 5661 6c75 6528 6b65 793d 746f 6b65 6e69  Value(key=tokeni
+0000f650: 7a65 2864 7479 7065 7329 2c20 7661 6c75  ze(dtypes), valu
+0000f660: 653d 6474 7970 6573 290a 2020 2020 2020  e=dtypes).      
+0000f670: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000f680: 662e 5f64 7479 7065 735f 7661 6c75 650a  f._dtypes_value.
+0000f690: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000f6a0: 2020 2064 6566 2069 6e64 6578 5f76 616c     def index_val
+0000f6b0: 7565 2873 656c 6629 3a0a 2020 2020 2020  ue(self):.      
+0000f6c0: 2020 7265 7475 726e 2073 656c 662e 5f69    return self._i
+0000f6d0: 6e64 6578 5f76 616c 7565 0a0a 2020 2020  ndex_value..    
+0000f6e0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000f6f0: 6620 636f 6c75 6d6e 735f 7661 6c75 6528  f columns_value(
+0000f700: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+0000f710: 6574 7572 6e20 7365 6c66 2e5f 636f 6c75  eturn self._colu
+0000f720: 6d6e 735f 7661 6c75 650a 0a20 2020 2040  mns_value..    @
+0000f730: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000f740: 2065 6d70 7479 2873 656c 6629 3a0a 2020   empty(self):.  
+0000f750: 2020 2020 2020 7368 6170 6520 3d20 6765        shape = ge
+0000f760: 7461 7474 7228 7365 6c66 2c20 225f 7368  tattr(self, "_sh
+0000f770: 6170 6522 290a 2020 2020 2020 2020 6966  ape").        if
+0000f780: 206e 702e 616e 7928 6e70 2e69 736e 616e   np.any(np.isnan
+0000f790: 2873 6861 7065 2929 3a0a 2020 2020 2020  (shape)):.      
+0000f7a0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000f7b0: 6545 7272 6f72 2822 5469 6c65 6162 6c65  eError("Tileable
+0000f7c0: 206f 626a 6563 7420 6d75 7374 2062 6520   object must be 
+0000f7d0: 6578 6563 7574 6564 2066 6972 7374 2229  executed first")
+0000f7e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000f7f0: 3020 696e 2073 6861 7065 0a0a 2020 2020  0 in shape..    
+0000f800: 6465 6620 746f 5f74 656e 736f 7228 7365  def to_tensor(se
+0000f810: 6c66 2c20 6474 7970 653d 4e6f 6e65 293a  lf, dtype=None):
+0000f820: 0a20 2020 2020 2020 2066 726f 6d20 2e2e  .        from ..
+0000f830: 7465 6e73 6f72 2e64 6174 6173 6f75 7263  tensor.datasourc
+0000f840: 652e 6672 6f6d 5f64 6174 6166 7261 6d65  e.from_dataframe
+0000f850: 2069 6d70 6f72 7420 6672 6f6d 5f64 6174   import from_dat
+0000f860: 6166 7261 6d65 0a0a 2020 2020 2020 2020  aframe..        
+0000f870: 7265 7475 726e 2066 726f 6d5f 6461 7461  return from_data
+0000f880: 6672 616d 6528 7365 6c66 2c20 6474 7970  frame(self, dtyp
+0000f890: 653d 6474 7970 6529 0a0a 2020 2020 4073  e=dtype)..    @s
+0000f8a0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+0000f8b0: 6465 6620 6672 6f6d 5f74 656e 736f 7228  def from_tensor(
+0000f8c0: 696e 5f74 656e 736f 722c 2069 6e64 6578  in_tensor, index
+0000f8d0: 3d4e 6f6e 652c 2063 6f6c 756d 6e73 3d4e  =None, columns=N
+0000f8e0: 6f6e 6529 3a0a 2020 2020 2020 2020 6672  one):.        fr
+0000f8f0: 6f6d 202e 6461 7461 736f 7572 6365 2e66  om .datasource.f
+0000f900: 726f 6d5f 7465 6e73 6f72 2069 6d70 6f72  rom_tensor impor
+0000f910: 7420 6461 7461 6672 616d 655f 6672 6f6d  t dataframe_from
+0000f920: 5f74 656e 736f 720a 0a20 2020 2020 2020  _tensor..       
+0000f930: 2072 6574 7572 6e20 6461 7461 6672 616d   return datafram
+0000f940: 655f 6672 6f6d 5f74 656e 736f 7228 696e  e_from_tensor(in
+0000f950: 5f74 656e 736f 722c 2069 6e64 6578 3d69  _tensor, index=i
+0000f960: 6e64 6578 2c20 636f 6c75 6d6e 733d 636f  ndex, columns=co
+0000f970: 6c75 6d6e 7329 0a0a 2020 2020 4073 7461  lumns)..    @sta
+0000f980: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
+0000f990: 6620 6672 6f6d 5f72 6563 6f72 6473 2872  f from_records(r
+0000f9a0: 6563 6f72 6473 2c20 2a2a 6b77 293a 0a20  ecords, **kw):. 
+0000f9b0: 2020 2020 2020 2066 726f 6d20 2e64 6174         from .dat
+0000f9c0: 6173 6f75 7263 652e 6672 6f6d 5f72 6563  asource.from_rec
+0000f9d0: 6f72 6473 2069 6d70 6f72 7420 6672 6f6d  ords import from
+0000f9e0: 5f72 6563 6f72 6473 0a0a 2020 2020 2020  _records..      
+0000f9f0: 2020 7265 7475 726e 2066 726f 6d5f 7265    return from_re
+0000fa00: 636f 7264 7328 7265 636f 7264 732c 202a  cords(records, *
+0000fa10: 2a6b 7729 0a0a 2020 2020 4070 726f 7065  *kw)..    @prope
+0000fa20: 7274 790a 2020 2020 6465 6620 696e 6465  rty.    def inde
+0000fa30: 7828 7365 6c66 293a 0a20 2020 2020 2020  x(self):.       
+0000fa40: 2066 726f 6d20 2e64 6174 6173 6f75 7263   from .datasourc
+0000fa50: 652e 696e 6465 7820 696d 706f 7274 2066  e.index import f
+0000fa60: 726f 6d5f 7469 6c65 6162 6c65 0a0a 2020  rom_tileable..  
+0000fa70: 2020 2020 2020 7265 7475 726e 2066 726f        return fro
+0000fa80: 6d5f 7469 6c65 6162 6c65 2873 656c 6629  m_tileable(self)
+0000fa90: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0000faa0: 2020 2020 6465 6620 636f 6c75 6d6e 7328      def columns(
+0000fab0: 7365 6c66 293a 0a20 2020 2020 2020 2066  self):.        f
+0000fac0: 726f 6d20 2e64 6174 6173 6f75 7263 652e  rom .datasource.
+0000fad0: 696e 6465 7820 696d 706f 7274 2066 726f  index import fro
+0000fae0: 6d5f 7061 6e64 6173 2061 7320 6672 6f6d  m_pandas as from
+0000faf0: 5f70 616e 6461 735f 696e 6465 780a 0a20  _pandas_index.. 
+0000fb00: 2020 2020 2020 2072 6574 7572 6e20 6672         return fr
+0000fb10: 6f6d 5f70 616e 6461 735f 696e 6465 7828  om_pandas_index(
+0000fb20: 7365 6c66 2e64 7479 7065 732e 696e 6465  self.dtypes.inde
+0000fb30: 782c 2073 746f 7265 5f64 6174 613d 5472  x, store_data=Tr
+0000fb40: 7565 290a 0a20 2020 2040 7072 6f70 6572  ue)..    @proper
+0000fb50: 7479 0a20 2020 2064 6566 2061 7865 7328  ty.    def axes(
+0000fb60: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+0000fb70: 6574 7572 6e20 5b73 656c 662e 696e 6465  eturn [self.inde
+0000fb80: 782c 2073 656c 662e 636f 6c75 6d6e 735d  x, self.columns]
+0000fb90: 0a0a 2020 2020 6465 6620 5f67 6574 5f64  ..    def _get_d
+0000fba0: 7479 7065 735f 6469 6374 2873 656c 6629  types_dict(self)
+0000fbb0: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
+0000fbc0: 662e 5f64 7479 7065 735f 6469 6374 2069  f._dtypes_dict i
+0000fbd0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0000fbe0: 2020 2020 7365 6c66 2e5f 6474 7970 6573      self._dtypes
+0000fbf0: 5f64 6963 7420 3d20 6420 3d20 6469 6374  _dict = d = dict
+0000fc00: 2829 0a20 2020 2020 2020 2020 2020 2066  ().            f
+0000fc10: 6f72 206b 2c20 7620 696e 2073 656c 662e  or k, v in self.
+0000fc20: 6474 7970 6573 2e69 7465 6d73 2829 3a0a  dtypes.items():.
+0000fc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc40: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+0000fc50: 2020 2020 2020 2020 206f 626a 5f6c 6973           obj_lis
+0000fc60: 7420 3d20 645b 6b5d 0a20 2020 2020 2020  t = d[k].       
+0000fc70: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+0000fc80: 4b65 7945 7272 6f72 3a0a 2020 2020 2020  KeyError:.      
+0000fc90: 2020 2020 2020 2020 2020 2020 2020 6f62                ob
+0000fca0: 6a5f 6c69 7374 203d 2064 5b6b 5d20 3d20  j_list = d[k] = 
+0000fcb0: 5b5d 0a20 2020 2020 2020 2020 2020 2020  [].             
+0000fcc0: 2020 206f 626a 5f6c 6973 742e 6170 7065     obj_list.appe
+0000fcd0: 6e64 2876 290a 2020 2020 2020 2020 7265  nd(v).        re
+0000fce0: 7475 726e 2073 656c 662e 5f64 7479 7065  turn self._dtype
+0000fcf0: 735f 6469 6374 0a0a 2020 2020 6465 6620  s_dict..    def 
+0000fd00: 5f67 6574 5f64 7479 7065 735f 6279 5f63  _get_dtypes_by_c
+0000fd10: 6f6c 756d 6e73 2873 656c 662c 2063 6f6c  olumns(self, col
+0000fd20: 756d 6e73 3a20 6c69 7374 293a 0a20 2020  umns: list):.   
+0000fd30: 2020 2020 2064 7479 7065 735f 6469 6374       dtypes_dict
+0000fd40: 203d 2073 656c 662e 5f67 6574 5f64 7479   = self._get_dty
+0000fd50: 7065 735f 6469 6374 2829 0a20 2020 2020  pes_dict().     
+0000fd60: 2020 2072 6574 7572 6e20 6675 6e63 746f     return functo
+0000fd70: 6f6c 732e 7265 6475 6365 286f 7065 7261  ols.reduce(opera
+0000fd80: 746f 722e 6164 642c 2028 6474 7970 6573  tor.add, (dtypes
+0000fd90: 5f64 6963 745b 635d 2066 6f72 2063 2069  _dict[c] for c i
+0000fda0: 6e20 636f 6c75 6d6e 7329 2c20 5b5d 290a  n columns), []).
+0000fdb0: 0a20 2020 2064 6566 205f 6765 745f 636f  .    def _get_co
+0000fdc0: 6c75 6d6e 735f 6279 5f63 6f6c 756d 6e73  lumns_by_columns
+0000fdd0: 2873 656c 662c 2063 6f6c 756d 6e73 3a20  (self, columns: 
+0000fde0: 6c69 7374 293a 0a20 2020 2020 2020 2064  list):.        d
+0000fdf0: 7479 7065 735f 6469 6374 203d 2073 656c  types_dict = sel
+0000fe00: 662e 5f67 6574 5f64 7479 7065 735f 6469  f._get_dtypes_di
+0000fe10: 6374 2829 0a20 2020 2020 2020 2072 6574  ct().        ret
+0000fe20: 7572 6e20 6675 6e63 746f 6f6c 732e 7265  urn functools.re
+0000fe30: 6475 6365 280a 2020 2020 2020 2020 2020  duce(.          
+0000fe40: 2020 6f70 6572 6174 6f72 2e61 6464 2c20    operator.add, 
+0000fe50: 285b 635d 202a 206c 656e 2864 7479 7065  ([c] * len(dtype
+0000fe60: 735f 6469 6374 5b63 5d29 2066 6f72 2063  s_dict[c]) for c
+0000fe70: 2069 6e20 636f 6c75 6d6e 7329 2c20 5b5d   in columns), []
+0000fe80: 0a20 2020 2020 2020 2029 0a0a 0a63 6c61  .        )...cla
+0000fe90: 7373 2044 6174 6146 7261 6d65 4461 7461  ss DataFrameData
+0000fea0: 285f 4261 7463 6865 6446 6574 6368 6572  (_BatchedFetcher
+0000feb0: 2c20 4261 7365 4461 7461 4672 616d 6544  , BaseDataFrameD
+0000fec0: 6174 6129 3a0a 2020 2020 7479 7065 5f6e  ata):.    type_n
+0000fed0: 616d 6520 3d20 2244 6174 6146 7261 6d65  ame = "DataFrame
+0000fee0: 220a 0a20 2020 2064 6566 205f 746f 5f73  "..    def _to_s
+0000fef0: 7472 2873 656c 662c 2072 6570 7265 7365  tr(self, represe
+0000ff00: 6e74 6174 696f 6e3d 4661 6c73 6529 3a0a  ntation=False):.
+0000ff10: 2020 2020 2020 2020 6966 2069 735f 6275          if is_bu
+0000ff20: 696c 645f 6d6f 6465 2829 206f 7220 6c65  ild_mode() or le
+0000ff30: 6e28 7365 6c66 2e5f 6578 6563 7574 6564  n(self._executed
+0000ff40: 5f73 6573 7369 6f6e 7329 203d 3d20 303a  _sessions) == 0:
+0000ff50: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
+0000ff60: 6e20 6275 696c 6420 6d6f 6465 2c20 6f72  n build mode, or
+0000ff70: 206e 6f74 2065 7865 6375 7465 642c 206a   not executed, j
+0000ff80: 7573 7420 7265 7475 726e 2072 6570 7265  ust return repre
+0000ff90: 7365 6e74 6174 696f 6e0a 2020 2020 2020  sentation.      
+0000ffa0: 2020 2020 2020 6966 2072 6570 7265 7365        if represe
+0000ffb0: 6e74 6174 696f 6e3a 0a20 2020 2020 2020  ntation:.       
+0000ffc0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000ffd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000ffe0: 2020 2020 2020 6622 7b73 656c 662e 7479        f"{self.ty
+0000fff0: 7065 5f6e 616d 657d 203c 6f70 3d7b 7479  pe_name} <op={ty
+00010000: 7065 2873 656c 662e 5f6f 7029 2e5f 5f6e  pe(self._op).__n
+00010010: 616d 655f 5f7d 2c20 6b65 793d 7b73 656c  ame__}, key={sel
+00010020: 662e 6b65 797d 3e22 0a20 2020 2020 2020  f.key}>".       
+00010030: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00010040: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00010050: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00010060: 7572 6e20 6622 7b73 656c 662e 7479 7065  urn f"{self.type
+00010070: 5f6e 616d 657d 286f 703d 7b74 7970 6528  _name}(op={type(
+00010080: 7365 6c66 2e5f 6f70 292e 5f5f 6e61 6d65  self._op).__name
+00010090: 5f5f 7d29 220a 2020 2020 2020 2020 656c  __})".        el
+000100a0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000100b0: 636f 726e 6572 5f64 6174 6120 3d20 6665  corner_data = fe
+000100c0: 7463 685f 636f 726e 6572 5f64 6174 6128  tch_corner_data(
+000100d0: 7365 6c66 2c20 7365 7373 696f 6e3d 7365  self, session=se
+000100e0: 6c66 2e5f 6578 6563 7574 6564 5f73 6573  lf._executed_ses
+000100f0: 7369 6f6e 735b 2d31 5d29 0a0a 2020 2020  sions[-1])..    
+00010100: 2020 2020 2020 2020 6275 6620 3d20 5374          buf = St
+00010110: 7269 6e67 494f 2829 0a20 2020 2020 2020  ringIO().       
+00010120: 2020 2020 206d 6178 5f72 6f77 7320 3d20       max_rows = 
+00010130: 7064 2e67 6574 5f6f 7074 696f 6e28 2264  pd.get_option("d
+00010140: 6973 706c 6179 2e6d 6178 5f72 6f77 7322  isplay.max_rows"
+00010150: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00010160: 6620 7365 6c66 2e73 6861 7065 5b30 5d20  f self.shape[0] 
+00010170: 3c3d 206d 6178 5f72 6f77 733a 0a20 2020  <= max_rows:.   
+00010180: 2020 2020 2020 2020 2020 2020 2062 7566               buf
+00010190: 2e77 7269 7465 2872 6570 7228 636f 726e  .write(repr(corn
+000101a0: 6572 5f64 6174 6129 2069 6620 7265 7072  er_data) if repr
+000101b0: 6573 656e 7461 7469 6f6e 2065 6c73 6520  esentation else 
+000101c0: 7374 7228 636f 726e 6572 5f64 6174 6129  str(corner_data)
+000101d0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+000101e0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000101f0: 2020 2020 2320 7265 6d65 6d62 6572 2077      # remember w
+00010200: 6520 6361 6e6e 6f74 2064 6972 6563 746c  e cannot directl
+00010210: 7920 6361 6c6c 2072 6570 7228 6466 292c  y call repr(df),
+00010220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010230: 2023 2062 6563 6175 7365 2074 6865 205b   # because the [
+00010240: 2e2e 2e20 726f 7773 2078 202e 2e2e 2063  ... rows x ... c
+00010250: 6f6c 756d 6e73 5d20 6d61 7920 7368 6f77  olumns] may show
+00010260: 2077 726f 6e67 2072 6f77 730a 2020 2020   wrong rows.    
+00010270: 2020 2020 2020 2020 2020 2020 7769 7468              with
+00010280: 2070 642e 6f70 7469 6f6e 5f63 6f6e 7465   pd.option_conte
+00010290: 7874 280a 2020 2020 2020 2020 2020 2020  xt(.            
+000102a0: 2020 2020 2020 2020 2264 6973 706c 6179          "display
+000102b0: 2e73 686f 775f 6469 6d65 6e73 696f 6e73  .show_dimensions
+000102c0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000102d0: 2020 2020 2020 2046 616c 7365 2c0a 2020         False,.  
+000102e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000102f0: 2020 2264 6973 706c 6179 2e6d 6178 5f72    "display.max_r
+00010300: 6f77 7322 2c0a 2020 2020 2020 2020 2020  ows",.          
+00010310: 2020 2020 2020 2020 2020 636f 726e 6572            corner
+00010320: 5f64 6174 612e 7368 6170 655b 305d 202d  _data.shape[0] -
+00010330: 2031 2c0a 2020 2020 2020 2020 2020 2020   1,.            
+00010340: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+00010350: 2020 2020 2020 2020 2020 2069 6620 7265             if re
+00010360: 7072 6573 656e 7461 7469 6f6e 3a0a 2020  presentation:.  
+00010370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010380: 2020 2020 2020 7320 3d20 7265 7072 2863        s = repr(c
+00010390: 6f72 6e65 725f 6461 7461 290a 2020 2020  orner_data).    
+000103a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000103b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000103c0: 2020 2020 2020 2020 2020 2020 2020 7320                s 
+000103d0: 3d20 7374 7228 636f 726e 6572 5f64 6174  = str(corner_dat
+000103e0: 6129 0a20 2020 2020 2020 2020 2020 2020  a).             
+000103f0: 2020 2020 2020 2062 7566 2e77 7269 7465         buf.write
+00010400: 2873 290a 2020 2020 2020 2020 2020 2020  (s).            
+00010410: 2020 2020 6966 2070 642e 6765 745f 6f70      if pd.get_op
+00010420: 7469 6f6e 2822 6469 7370 6c61 792e 7368  tion("display.sh
+00010430: 6f77 5f64 696d 656e 7369 6f6e 7322 293a  ow_dimensions"):
+00010440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010450: 2020 2020 206e 5f72 6f77 732c 206e 5f63       n_rows, n_c
+00010460: 6f6c 7320 3d20 7365 6c66 2e73 6861 7065  ols = self.shape
+00010470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010480: 2020 2020 2062 7566 2e77 7269 7465 2866       buf.write(f
+00010490: 225c 6e5c 6e5b 7b6e 5f72 6f77 737d 2072  "\n\n[{n_rows} r
+000104a0: 6f77 7320 7820 7b6e 5f63 6f6c 737d 2063  ows x {n_cols} c
+000104b0: 6f6c 756d 6e73 5d22 290a 0a20 2020 2020  olumns]")..     
+000104c0: 2020 2020 2020 2072 6574 7572 6e20 6275         return bu
+000104d0: 662e 6765 7476 616c 7565 2829 0a0a 2020  f.getvalue()..  
+000104e0: 2020 6465 6620 5f5f 7374 725f 5f28 7365    def __str__(se
+000104f0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00010500: 7572 6e20 7365 6c66 2e5f 746f 5f73 7472  urn self._to_str
+00010510: 2872 6570 7265 7365 6e74 6174 696f 6e3d  (representation=
+00010520: 4661 6c73 6529 0a0a 2020 2020 6465 6620  False)..    def 
+00010530: 5f74 6f5f 6172 7228 7365 6c66 293a 0a20  _to_arr(self):. 
+00010540: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
+00010550: 6c66 2e5f 6578 6563 7574 6564 5f73 6573  lf._executed_ses
+00010560: 7369 6f6e 7329 203d 3d20 303a 0a20 2020  sions) == 0:.   
+00010570: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+00010580: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00010590: 6f72 0a0a 2020 2020 2020 2020 6461 7461  or..        data
+000105a0: 203d 2073 656c 662e 6665 7463 6828 7365   = self.fetch(se
+000105b0: 7373 696f 6e3d 7365 6c66 2e5f 6578 6563  ssion=self._exec
+000105c0: 7574 6564 5f73 6573 7369 6f6e 735b 2d31  uted_sessions[-1
+000105d0: 5d29 0a20 2020 2020 2020 2072 6574 7572  ]).        retur
+000105e0: 6e20 6e70 2e61 7361 7272 6179 2864 6174  n np.asarray(dat
+000105f0: 6129 0a0a 2020 2020 6465 6620 5f5f 6172  a)..    def __ar
+00010600: 7261 795f 5f28 7365 6c66 293a 0a20 2020  ray__(self):.   
+00010610: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00010620: 2e5f 746f 5f61 7272 2829 0a0a 2020 2020  ._to_arr()..    
+00010630: 6465 6620 5f5f 7265 7072 5f5f 2873 656c  def __repr__(sel
+00010640: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00010650: 726e 2073 656c 662e 5f74 6f5f 7374 7228  rn self._to_str(
+00010660: 7265 7072 6573 656e 7461 7469 6f6e 3d54  representation=T
+00010670: 7275 6529 0a0a 2020 2020 6465 6620 5f5f  rue)..    def __
+00010680: 6d61 7273 5f74 656e 736f 725f 5f28 7365  mars_tensor__(se
+00010690: 6c66 2c20 6474 7970 653d 4e6f 6e65 2c20  lf, dtype=None, 
+000106a0: 6f72 6465 723d 224b 2229 3a0a 2020 2020  order="K"):.    
+000106b0: 2020 2020 7465 6e73 6f72 203d 2073 656c      tensor = sel
+000106c0: 662e 746f 5f74 656e 736f 7228 290a 2020  f.to_tensor().  
+000106d0: 2020 2020 2020 6474 7970 6520 3d20 6474        dtype = dt
+000106e0: 7970 6520 6966 2064 7479 7065 2069 7320  ype if dtype is 
+000106f0: 6e6f 7420 4e6f 6e65 2065 6c73 6520 7465  not None else te
+00010700: 6e73 6f72 2e64 7479 7065 0a20 2020 2020  nsor.dtype.     
+00010710: 2020 2072 6574 7572 6e20 7465 6e73 6f72     return tensor
+00010720: 2e61 7374 7970 6528 6474 7970 653d 6474  .astype(dtype=dt
+00010730: 7970 652c 206f 7264 6572 3d6f 7264 6572  ype, order=order
+00010740: 2c20 636f 7079 3d46 616c 7365 290a 0a20  , copy=False).. 
+00010750: 2020 2064 6566 205f 7265 7072 5f68 746d     def _repr_htm
+00010760: 6c5f 2873 656c 6629 3a0a 2020 2020 2020  l_(self):.      
+00010770: 2020 6966 206c 656e 2873 656c 662e 5f65    if len(self._e
+00010780: 7865 6375 7465 645f 7365 7373 696f 6e73  xecuted_sessions
+00010790: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
+000107a0: 2020 2020 2320 6e6f 7420 6578 6563 7574      # not execut
+000107b0: 6564 2062 6566 6f72 652c 2066 616c 6c20  ed before, fall 
+000107c0: 6261 636b 2074 6f20 6e6f 726d 616c 2072  back to normal r
+000107d0: 6570 720a 2020 2020 2020 2020 2020 2020  epr.            
+000107e0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+000107f0: 6e74 6564 4572 726f 720a 0a20 2020 2020  ntedError..     
+00010800: 2020 2063 6f72 6e65 725f 6461 7461 203d     corner_data =
+00010810: 2066 6574 6368 5f63 6f72 6e65 725f 6461   fetch_corner_da
+00010820: 7461 2873 656c 662c 2073 6573 7369 6f6e  ta(self, session
+00010830: 3d73 656c 662e 5f65 7865 6375 7465 645f  =self._executed_
+00010840: 7365 7373 696f 6e73 5b2d 315d 290a 0a20  sessions[-1]).. 
+00010850: 2020 2020 2020 2062 7566 203d 2053 7472         buf = Str
+00010860: 696e 6749 4f28 290a 2020 2020 2020 2020  ingIO().        
+00010870: 6d61 785f 726f 7773 203d 2070 642e 6765  max_rows = pd.ge
+00010880: 745f 6f70 7469 6f6e 2822 6469 7370 6c61  t_option("displa
+00010890: 792e 6d61 785f 726f 7773 2229 0a20 2020  y.max_rows").   
+000108a0: 2020 2020 2069 6620 7365 6c66 2e73 6861       if self.sha
+000108b0: 7065 5b30 5d20 3c3d 206d 6178 5f72 6f77  pe[0] <= max_row
+000108c0: 733a 0a20 2020 2020 2020 2020 2020 2062  s:.            b
+000108d0: 7566 2e77 7269 7465 2863 6f72 6e65 725f  uf.write(corner_
+000108e0: 6461 7461 2e5f 7265 7072 5f68 746d 6c5f  data._repr_html_
+000108f0: 2829 290a 2020 2020 2020 2020 656c 7365  ()).        else
+00010900: 3a0a 2020 2020 2020 2020 2020 2020 7769  :.            wi
+00010910: 7468 2070 642e 6f70 7469 6f6e 5f63 6f6e  th pd.option_con
+00010920: 7465 7874 280a 2020 2020 2020 2020 2020  text(.          
+00010930: 2020 2020 2020 2264 6973 706c 6179 2e73        "display.s
+00010940: 686f 775f 6469 6d65 6e73 696f 6e73 222c  how_dimensions",
+00010950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010960: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+00010970: 2020 2020 2020 2020 2264 6973 706c 6179          "display
+00010980: 2e6d 6178 5f72 6f77 7322 2c0a 2020 2020  .max_rows",.    
+00010990: 2020 2020 2020 2020 2020 2020 636f 726e              corn
+000109a0: 6572 5f64 6174 612e 7368 6170 655b 305d  er_data.shape[0]
+000109b0: 202d 2031 2c0a 2020 2020 2020 2020 2020   - 1,.          
+000109c0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+000109d0: 2020 2020 2062 7566 2e77 7269 7465 2863       buf.write(c
+000109e0: 6f72 6e65 725f 6461 7461 2e5f 7265 7072  orner_data._repr
+000109f0: 5f68 746d 6c5f 2829 2e72 7374 7269 7028  _html_().rstrip(
+00010a00: 292e 7273 7472 6970 2822 3c2f 6469 763e  ).rstrip("</div>
+00010a10: 2229 290a 2020 2020 2020 2020 2020 2020  ")).            
+00010a20: 6966 2070 642e 6765 745f 6f70 7469 6f6e  if pd.get_option
+00010a30: 2822 6469 7370 6c61 792e 7368 6f77 5f64  ("display.show_d
+00010a40: 696d 656e 7369 6f6e 7322 293a 0a20 2020  imensions"):.   
+00010a50: 2020 2020 2020 2020 2020 2020 206e 5f72               n_r
+00010a60: 6f77 732c 206e 5f63 6f6c 7320 3d20 7365  ows, n_cols = se
+00010a70: 6c66 2e73 6861 7065 0a20 2020 2020 2020  lf.shape.       
+00010a80: 2020 2020 2020 2020 2062 7566 2e77 7269           buf.wri
+00010a90: 7465 2866 223c 703e 7b6e 5f72 6f77 737d  te(f"<p>{n_rows}
+00010aa0: 2072 6f77 7320 c397 207b 6e5f 636f 6c73   rows .. {n_cols
+00010ab0: 7d20 636f 6c75 6d6e 733c 2f70 3e5c 6e22  } columns</p>\n"
+00010ac0: 290a 2020 2020 2020 2020 2020 2020 6275  ).            bu
+00010ad0: 662e 7772 6974 6528 223c 2f64 6976 3e22  f.write("</div>"
+00010ae0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00010af0: 6e20 6275 662e 6765 7476 616c 7565 2829  n buf.getvalue()
+00010b00: 0a0a 2020 2020 6465 6620 6974 656d 7328  ..    def items(
+00010b10: 7365 6c66 293a 0a20 2020 2020 2020 2066  self):.        f
+00010b20: 6f72 2063 6f6c 5f6e 616d 6520 696e 2073  or col_name in s
+00010b30: 656c 662e 6474 7970 6573 2e69 6e64 6578  elf.dtypes.index
+00010b40: 3a0a 2020 2020 2020 2020 2020 2020 7969  :.            yi
+00010b50: 656c 6420 636f 6c5f 6e61 6d65 2c20 7365  eld col_name, se
+00010b60: 6c66 5b63 6f6c 5f6e 616d 655d 0a0a 2020  lf[col_name]..  
+00010b70: 2020 6974 6572 6974 656d 7320 3d20 6974    iteritems = it
+00010b80: 656d 730a 0a20 2020 2064 6566 2069 7465  ems..    def ite
+00010b90: 7272 6f77 7328 7365 6c66 2c20 6261 7463  rrows(self, batc
+00010ba0: 685f 7369 7a65 3d31 3030 302c 2073 6573  h_size=1000, ses
+00010bb0: 7369 6f6e 3d4e 6f6e 6529 3a0a 2020 2020  sion=None):.    
+00010bc0: 2020 2020 666f 7220 6261 7463 685f 6461      for batch_da
+00010bd0: 7461 2069 6e20 7365 6c66 2e69 7465 7262  ta in self.iterb
+00010be0: 6174 6368 2862 6174 6368 5f73 697a 653d  atch(batch_size=
+00010bf0: 6261 7463 685f 7369 7a65 2c20 7365 7373  batch_size, sess
+00010c00: 696f 6e3d 7365 7373 696f 6e29 3a0a 2020  ion=session):.  
+00010c10: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
+00010c20: 6672 6f6d 2067 6574 6174 7472 2862 6174  from getattr(bat
+00010c30: 6368 5f64 6174 612c 2022 6974 6572 726f  ch_data, "iterro
+00010c40: 7773 2229 2829 0a0a 2020 2020 6465 6620  ws")()..    def 
+00010c50: 6974 6572 7475 706c 6573 2873 656c 662c  itertuples(self,
+00010c60: 2069 6e64 6578 3d54 7275 652c 206e 616d   index=True, nam
+00010c70: 653d 2250 616e 6461 7322 2c20 6261 7463  e="Pandas", batc
+00010c80: 685f 7369 7a65 3d31 3030 302c 2073 6573  h_size=1000, ses
+00010c90: 7369 6f6e 3d4e 6f6e 6529 3a0a 2020 2020  sion=None):.    
+00010ca0: 2020 2020 666f 7220 6261 7463 685f 6461      for batch_da
+00010cb0: 7461 2069 6e20 7365 6c66 2e69 7465 7262  ta in self.iterb
+00010cc0: 6174 6368 2862 6174 6368 5f73 697a 653d  atch(batch_size=
+00010cd0: 6261 7463 685f 7369 7a65 2c20 7365 7373  batch_size, sess
+00010ce0: 696f 6e3d 7365 7373 696f 6e29 3a0a 2020  ion=session):.  
+00010cf0: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
+00010d00: 6672 6f6d 2067 6574 6174 7472 2862 6174  from getattr(bat
+00010d10: 6368 5f64 6174 612c 2022 6974 6572 7475  ch_data, "itertu
+00010d20: 706c 6573 2229 2869 6e64 6578 3d69 6e64  ples")(index=ind
+00010d30: 6578 2c20 6e61 6d65 3d6e 616d 6529 0a0a  ex, name=name)..
+00010d40: 2020 2020 6465 6620 5f6e 6565 645f 6578      def _need_ex
+00010d50: 6563 7574 696f 6e28 7365 6c66 293a 0a20  ecution(self):. 
+00010d60: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+00010d70: 6474 7970 6573 2069 7320 4e6f 6e65 3a0a  dtypes is None:.
+00010d80: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00010d90: 726e 2054 7275 650a 2020 2020 2020 2020  rn True.        
+00010da0: 7265 7475 726e 2046 616c 7365 0a0a 0a63  return False...c
+00010db0: 6c61 7373 2044 6174 6146 7261 6d65 2848  lass DataFrame(H
+00010dc0: 6173 5368 6170 6554 696c 6561 626c 652c  asShapeTileable,
+00010dd0: 205f 546f 5061 6e64 6173 4d69 7869 6e29   _ToPandasMixin)
+00010de0: 3a0a 2020 2020 5f5f 736c 6f74 735f 5f20  :.    __slots__ 
+00010df0: 3d20 2822 5f63 6163 6865 222c 290a 2020  = ("_cache",).  
+00010e00: 2020 5f61 6c6c 6f77 5f64 6174 615f 7479    _allow_data_ty
+00010e10: 7065 5f20 3d20 2844 6174 6146 7261 6d65  pe_ = (DataFrame
+00010e20: 4461 7461 2c29 0a20 2020 2074 7970 655f  Data,).    type_
+00010e30: 6e61 6d65 203d 2022 4461 7461 4672 616d  name = "DataFram
+00010e40: 6522 0a0a 2020 2020 6465 6620 5f5f 6c65  e"..    def __le
+00010e50: 6e5f 5f28 7365 6c66 293a 0a20 2020 2020  n__(self):.     
+00010e60: 2020 2072 6574 7572 6e20 6c65 6e28 7365     return len(se
+00010e70: 6c66 2e5f 6461 7461 290a 0a20 2020 2064  lf._data)..    d
+00010e80: 6566 2074 6f5f 7465 6e73 6f72 2873 656c  ef to_tensor(sel
+00010e90: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00010ea0: 726e 2073 656c 662e 5f64 6174 612e 746f  rn self._data.to
+00010eb0: 5f74 656e 736f 7228 290a 0a20 2020 2064  _tensor()..    d
+00010ec0: 6566 2066 726f 6d5f 7465 6e73 6f72 2873  ef from_tensor(s
+00010ed0: 656c 662c 2069 6e5f 7465 6e73 6f72 2c20  elf, in_tensor, 
+00010ee0: 696e 6465 783d 4e6f 6e65 2c20 636f 6c75  index=None, colu
+00010ef0: 6d6e 733d 4e6f 6e65 293a 0a20 2020 2020  mns=None):.     
+00010f00: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00010f10: 6461 7461 2e66 726f 6d5f 7465 6e73 6f72  data.from_tensor
+00010f20: 2869 6e5f 7465 6e73 6f72 2c20 696e 6465  (in_tensor, inde
+00010f30: 783d 696e 6465 782c 2063 6f6c 756d 6e73  x=index, columns
+00010f40: 3d63 6f6c 756d 6e73 290a 0a20 2020 2064  =columns)..    d
+00010f50: 6566 2066 726f 6d5f 7265 636f 7264 7328  ef from_records(
+00010f60: 7365 6c66 2c20 7265 636f 7264 732c 202a  self, records, *
+00010f70: 2a6b 7729 3a0a 2020 2020 2020 2020 7265  *kw):.        re
+00010f80: 7475 726e 2073 656c 662e 5f64 6174 612e  turn self._data.
+00010f90: 6672 6f6d 5f72 6563 6f72 6473 2872 6563  from_records(rec
+00010fa0: 6f72 6473 2c20 2a2a 6b77 290a 0a20 2020  ords, **kw)..   
+00010fb0: 2064 6566 205f 5f6d 6172 735f 7465 6e73   def __mars_tens
+00010fc0: 6f72 5f5f 2873 656c 662c 2064 7479 7065  or__(self, dtype
+00010fd0: 3d4e 6f6e 652c 206f 7264 6572 3d22 4b22  =None, order="K"
+00010fe0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00010ff0: 6e20 7365 6c66 2e5f 6461 7461 2e5f 5f6d  n self._data.__m
+00011000: 6172 735f 7465 6e73 6f72 5f5f 2864 7479  ars_tensor__(dty
+00011010: 7065 3d64 7479 7065 2c20 6f72 6465 723d  pe=dtype, order=
+00011020: 6f72 6465 7229 0a0a 2020 2020 6465 6620  order)..    def 
+00011030: 5f5f 6765 7461 7474 725f 5f28 7365 6c66  __getattr__(self
+00011040: 2c20 6b65 7929 3a0a 2020 2020 2020 2020  , key):.        
+00011050: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00011060: 2072 6574 7572 6e20 6765 7461 7474 7228   return getattr(
+00011070: 7365 6c66 2e5f 6461 7461 2c20 6b65 7929  self._data, key)
+00011080: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+00011090: 4174 7472 6962 7574 6545 7272 6f72 3a0a  AttributeError:.
+000110a0: 2020 2020 2020 2020 2020 2020 6966 206b              if k
+000110b0: 6579 2069 6e20 7365 6c66 2e64 7479 7065  ey in self.dtype
+000110c0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+000110d0: 2020 2072 6574 7572 6e20 7365 6c66 5b6b     return self[k
+000110e0: 6579 5d0a 2020 2020 2020 2020 2020 2020  ey].            
+000110f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00011100: 2020 2020 2020 7261 6973 650a 0a20 2020        raise..   
+00011110: 2064 6566 205f 5f64 6972 5f5f 2873 656c   def __dir__(sel
+00011120: 6629 3a0a 2020 2020 2020 2020 7265 7375  f):.        resu
+00011130: 6c74 203d 206c 6973 7428 7375 7065 7228  lt = list(super(
+00011140: 292e 5f5f 6469 725f 5f28 2929 0a20 2020  ).__dir__()).   
+00011150: 2020 2020 2072 6574 7572 6e20 736f 7274       return sort
+00011160: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
+00011170: 7265 7375 6c74 0a20 2020 2020 2020 2020  result.         
+00011180: 2020 202b 205b 6b20 666f 7220 6b20 696e     + [k for k in
+00011190: 2073 656c 662e 6474 7970 6573 2e69 6e64   self.dtypes.ind
+000111a0: 6578 2069 6620 6973 696e 7374 616e 6365  ex if isinstance
+000111b0: 286b 2c20 7374 7229 2061 6e64 206b 2e69  (k, str) and k.i
+000111c0: 7369 6465 6e74 6966 6965 7228 295d 0a20  sidentifier()]. 
+000111d0: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
+000111e0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+000111f0: 5428 7365 6c66 293a 0a20 2020 2020 2020  T(self):.       
+00011200: 2072 6574 7572 6e20 7365 6c66 2e74 7261   return self.tra
+00011210: 6e73 706f 7365 2829 0a0a 2020 2020 4070  nspose()..    @p
+00011220: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00011230: 6e64 696d 2873 656c 6629 3a0a 2020 2020  ndim(self):.    
+00011240: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00011250: 5265 7475 726e 2061 6e20 696e 7420 7265  Return an int re
+00011260: 7072 6573 656e 7469 6e67 2074 6865 206e  presenting the n
+00011270: 756d 6265 7220 6f66 2061 7865 7320 2f20  umber of axes / 
+00011280: 6172 7261 7920 6469 6d65 6e73 696f 6e73  array dimensions
+00011290: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+000112a0: 6e20 3120 6966 2053 6572 6965 732e 204f  n 1 if Series. O
+000112b0: 7468 6572 7769 7365 2072 6574 7572 6e20  therwise return 
+000112c0: 3220 6966 2044 6174 6146 7261 6d65 2e0a  2 if DataFrame..
+000112d0: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
+000112e0: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
+000112f0: 2d2d 0a20 2020 2020 2020 206e 6461 7272  --.        ndarr
+00011300: 6179 2e6e 6469 6d20 3a20 4e75 6d62 6572  ay.ndim : Number
+00011310: 206f 6620 6172 7261 7920 6469 6d65 6e73   of array dimens
+00011320: 696f 6e73 2e0a 0a20 2020 2020 2020 2045  ions...        E
+00011330: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
+00011340: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00011350: 203e 3e3e 2069 6d70 6f72 7420 6d61 7273   >>> import mars
+00011360: 2e64 6174 6166 7261 6d65 2061 7320 6d64  .dataframe as md
+00011370: 0a20 2020 2020 2020 203e 3e3e 2073 203d  .        >>> s =
+00011380: 206d 642e 5365 7269 6573 287b 2761 273a   md.Series({'a':
+00011390: 2031 2c20 2762 273a 2032 2c20 2763 273a   1, 'b': 2, 'c':
+000113a0: 2033 7d29 0a20 2020 2020 2020 203e 3e3e   3}).        >>>
+000113b0: 2073 2e6e 6469 6d2e 6578 6563 7574 6528   s.ndim.execute(
+000113c0: 290a 2020 2020 2020 2020 310a 0a20 2020  ).        1..   
+000113d0: 2020 2020 203e 3e3e 2064 6620 3d20 6d64       >>> df = md
+000113e0: 2e44 6174 6146 7261 6d65 287b 2763 6f6c  .DataFrame({'col
+000113f0: 3127 3a20 5b31 2c20 325d 2c20 2763 6f6c  1': [1, 2], 'col
+00011400: 3227 3a20 5b33 2c20 345d 7d29 0a20 2020  2': [3, 4]}).   
+00011410: 2020 2020 203e 3e3e 2064 662e 6e64 696d       >>> df.ndim
+00011420: 2e65 7865 6375 7465 2829 0a20 2020 2020  .execute().     
+00011430: 2020 2032 0a20 2020 2020 2020 2022 2222     2.        """
+00011440: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00011450: 7375 7065 7228 292e 6e64 696d 0a0a 2020  super().ndim..  
+00011460: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00011470: 6465 6620 696e 6465 7828 7365 6c66 293a  def index(self):
+00011480: 0a20 2020 2020 2020 2069 6478 203d 2073  .        idx = s
+00011490: 656c 662e 5f64 6174 612e 696e 6465 780a  elf._data.index.
+000114a0: 2020 2020 2020 2020 6964 782e 5f73 6574          idx._set
+000114b0: 5f64 665f 6f72 5f73 6572 6965 7328 7365  _df_or_series(se
+000114c0: 6c66 2c20 3029 0a20 2020 2020 2020 2072  lf, 0).        r
+000114d0: 6574 7572 6e20 6964 780a 0a20 2020 2040  eturn idx..    @
+000114e0: 696e 6465 782e 7365 7474 6572 0a20 2020  index.setter.   
+000114f0: 2064 6566 2069 6e64 6578 2873 656c 662c   def index(self,
+00011500: 206e 6577 5f69 6e64 6578 293a 0a20 2020   new_index):.   
+00011510: 2020 2020 2073 656c 662e 7365 745f 6178       self.set_ax
+00011520: 6973 286e 6577 5f69 6e64 6578 2c20 6178  is(new_index, ax
+00011530: 6973 3d30 2c20 636f 7079 3d46 616c 7365  is=0, copy=False
+00011540: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00011550: 0a20 2020 2064 6566 2063 6f6c 756d 6e73  .    def columns
+00011560: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00011570: 636f 6c20 3d20 7365 6c66 2e5f 6461 7461  col = self._data
+00011580: 2e63 6f6c 756d 6e73 0a20 2020 2020 2020  .columns.       
+00011590: 2063 6f6c 2e5f 7365 745f 6466 5f6f 725f   col._set_df_or_
+000115a0: 7365 7269 6573 2873 656c 662c 2031 290a  series(self, 1).
+000115b0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+000115c0: 6f6c 0a0a 2020 2020 4063 6f6c 756d 6e73  ol..    @columns
+000115d0: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
+000115e0: 636f 6c75 6d6e 7328 7365 6c66 2c20 6e65  columns(self, ne
+000115f0: 775f 636f 6c75 6d6e 7329 3a0a 2020 2020  w_columns):.    
+00011600: 2020 2020 7365 6c66 2e73 6574 5f61 7869      self.set_axi
+00011610: 7328 6e65 775f 636f 6c75 6d6e 732c 2061  s(new_columns, a
+00011620: 7869 733d 312c 2063 6f70 793d 4661 6c73  xis=1, copy=Fals
+00011630: 6529 0a0a 2020 2020 6465 6620 6b65 7973  e)..    def keys
+00011640: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00011650: 2222 220a 2020 2020 2020 2020 4765 7420  """.        Get 
+00011660: 7468 6520 2769 6e66 6f20 6178 6973 2720  the 'info axis' 
+00011670: 2873 6565 2049 6e64 6578 696e 6720 666f  (see Indexing fo
+00011680: 7220 6d6f 7265 292e 0a0a 2020 2020 2020  r more)...      
+00011690: 2020 5468 6973 2069 7320 696e 6465 7820    This is index 
+000116a0: 666f 7220 5365 7269 6573 2c20 636f 6c75  for Series, colu
+000116b0: 6d6e 7320 666f 7220 4461 7461 4672 616d  mns for DataFram
+000116c0: 652e 0a0a 2020 2020 2020 2020 5265 7475  e...        Retu
+000116d0: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+000116e0: 2d2d 2d0a 2020 2020 2020 2020 496e 6465  ---.        Inde
+000116f0: 780a 2020 2020 2020 2020 2020 2020 496e  x.            In
+00011700: 666f 2061 7869 732e 0a20 2020 2020 2020  fo axis..       
+00011710: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+00011720: 7572 6e20 7365 6c66 2e63 6f6c 756d 6e73  urn self.columns
+00011730: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00011740: 2020 2020 6465 6620 7661 6c75 6573 2873      def values(s
+00011750: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00011760: 7475 726e 2073 656c 662e 746f 5f74 656e  turn self.to_ten
+00011770: 736f 7228 290a 0a20 2020 2040 7072 6f70  sor()..    @prop
+00011780: 6572 7479 0a20 2020 2064 6566 2064 7479  erty.    def dty
+00011790: 7065 7328 7365 6c66 293a 0a20 2020 2020  pes(self):.     
+000117a0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+000117b0: 6574 7572 6e20 7468 6520 6474 7970 6573  eturn the dtypes
+000117c0: 2069 6e20 7468 6520 4461 7461 4672 616d   in the DataFram
+000117d0: 652e 0a0a 2020 2020 2020 2020 5468 6973  e...        This
+000117e0: 2072 6574 7572 6e73 2061 2053 6572 6965   returns a Serie
+000117f0: 7320 7769 7468 2074 6865 2064 6174 6120  s with the data 
+00011800: 7479 7065 206f 6620 6561 6368 2063 6f6c  type of each col
+00011810: 756d 6e2e 0a20 2020 2020 2020 2054 6865  umn..        The
+00011820: 2072 6573 756c 7427 7320 696e 6465 7820   result's index 
+00011830: 6973 2074 6865 206f 7269 6769 6e61 6c20  is the original 
+00011840: 4461 7461 4672 616d 6527 7320 636f 6c75  DataFrame's colu
+00011850: 6d6e 732e 2043 6f6c 756d 6e73 0a20 2020  mns. Columns.   
+00011860: 2020 2020 2077 6974 6820 6d69 7865 6420       with mixed 
+00011870: 7479 7065 7320 6172 6520 7374 6f72 6564  types are stored
+00011880: 2077 6974 6820 7468 6520 6060 6f62 6a65   with the ``obje
+00011890: 6374 6060 2064 7479 7065 2e20 5365 650a  ct`` dtype. See.
+000118a0: 2020 2020 2020 2020 3a72 6566 3a60 7468          :ref:`th
+000118b0: 6520 5573 6572 2047 7569 6465 203c 6261  e User Guide <ba
+000118c0: 7369 6373 2e64 7479 7065 733e 6020 666f  sics.dtypes>` fo
+000118d0: 7220 6d6f 7265 2e0a 0a20 2020 2020 2020  r more...       
+000118e0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+000118f0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00011900: 2070 616e 6461 732e 5365 7269 6573 0a20   pandas.Series. 
+00011910: 2020 2020 2020 2020 2020 2054 6865 2064             The d
+00011920: 6174 6120 7479 7065 206f 6620 6561 6368  ata type of each
+00011930: 2063 6f6c 756d 6e2e 0a0a 2020 2020 2020   column...      
+00011940: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
+00011950: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00011960: 2020 2020 3e3e 3e20 696d 706f 7274 206d      >>> import m
+00011970: 6172 732e 6461 7461 6672 616d 6520 6173  ars.dataframe as
+00011980: 206d 640a 2020 2020 2020 2020 3e3e 3e20   md.        >>> 
+00011990: 6466 203d 206d 642e 4461 7461 4672 616d  df = md.DataFram
+000119a0: 6528 7b27 666c 6f61 7427 3a20 5b31 2e30  e({'float': [1.0
+000119b0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+000119c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000119d0: 2020 2769 6e74 273a 205b 315d 2c0a 2020    'int': [1],.  
+000119e0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+000119f0: 2020 2020 2020 2020 2020 2020 2027 6461               'da
+00011a00: 7465 7469 6d65 273a 205b 6d64 2e54 696d  tetime': [md.Tim
+00011a10: 6573 7461 6d70 2827 3230 3138 3033 3130  estamp('20180310
+00011a20: 2729 5d2c 0a20 2020 2020 2020 202e 2e2e  ')],.        ...
+00011a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011a40: 2020 2020 2773 7472 696e 6727 3a20 5b27      'string': ['
+00011a50: 666f 6f27 5d7d 290a 2020 2020 2020 2020  foo']}).        
+00011a60: 3e3e 3e20 6466 2e64 7479 7065 730a 2020  >>> df.dtypes.  
+00011a70: 2020 2020 2020 666c 6f61 7420 2020 2020        float     
+00011a80: 2020 2020 2020 2020 2066 6c6f 6174 3634           float64
+00011a90: 0a20 2020 2020 2020 2069 6e74 2020 2020  .        int    
+00011aa0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00011ab0: 7436 340a 2020 2020 2020 2020 6461 7465  t64.        date
+00011ac0: 7469 6d65 2020 2020 6461 7465 7469 6d65  time    datetime
+00011ad0: 3634 5b6e 735d 0a20 2020 2020 2020 2073  64[ns].        s
+00011ae0: 7472 696e 6720 2020 2020 2020 2020 2020  tring           
+00011af0: 2020 206f 626a 6563 740a 2020 2020 2020     object.      
+00011b00: 2020 6474 7970 653a 206f 626a 6563 740a    dtype: object.
+00011b10: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00011b20: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00011b30: 5f64 6174 612e 6474 7970 6573 0a0a 2020  _data.dtypes..  
+00011b40: 2020 6465 6620 6974 6572 726f 7773 2873    def iterrows(s
+00011b50: 656c 662c 2062 6174 6368 5f73 697a 653d  elf, batch_size=
+00011b60: 3130 3030 2c20 7365 7373 696f 6e3d 4e6f  1000, session=No
+00011b70: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
+00011b80: 0a20 2020 2020 2020 2049 7465 7261 7465  .        Iterate
+00011b90: 206f 7665 7220 4461 7461 4672 616d 6520   over DataFrame 
+00011ba0: 726f 7773 2061 7320 2869 6e64 6578 2c20  rows as (index, 
+00011bb0: 5365 7269 6573 2920 7061 6972 732e 0a0a  Series) pairs...
+00011bc0: 2020 2020 2020 2020 5969 656c 6473 0a20          Yields. 
+00011bd0: 2020 2020 2020 202d 2d2d 2d2d 2d0a 2020         ------.  
+00011be0: 2020 2020 2020 696e 6465 7820 3a20 6c61        index : la
+00011bf0: 6265 6c20 6f72 2074 7570 6c65 206f 6620  bel or tuple of 
+00011c00: 6c61 6265 6c0a 2020 2020 2020 2020 2020  label.          
+00011c10: 2020 5468 6520 696e 6465 7820 6f66 2074    The index of t
+00011c20: 6865 2072 6f77 2e20 4120 7475 706c 6520  he row. A tuple 
+00011c30: 666f 7220 6120 604d 756c 7469 496e 6465  for a `MultiInde
+00011c40: 7860 2e0a 2020 2020 2020 2020 6461 7461  x`..        data
+00011c50: 203a 2053 6572 6965 730a 2020 2020 2020   : Series.      
+00011c60: 2020 2020 2020 5468 6520 6461 7461 206f        The data o
+00011c70: 6620 7468 6520 726f 7720 6173 2061 2053  f the row as a S
+00011c80: 6572 6965 732e 0a0a 2020 2020 2020 2020  eries...        
+00011c90: 6974 203a 2067 656e 6572 6174 6f72 0a20  it : generator. 
+00011ca0: 2020 2020 2020 2020 2020 2041 2067 656e             A gen
+00011cb0: 6572 6174 6f72 2074 6861 7420 6974 6572  erator that iter
+00011cc0: 6174 6573 206f 7665 7220 7468 6520 726f  ates over the ro
+00011cd0: 7773 206f 6620 7468 6520 6672 616d 652e  ws of the frame.
+00011ce0: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+00011cf0: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+00011d00: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
+00011d10: 4672 616d 652e 6974 6572 7475 706c 6573  Frame.itertuples
+00011d20: 203a 2049 7465 7261 7465 206f 7665 7220   : Iterate over 
+00011d30: 4461 7461 4672 616d 6520 726f 7773 2061  DataFrame rows a
+00011d40: 7320 6e61 6d65 6474 7570 6c65 7320 6f66  s namedtuples of
+00011d50: 2074 6865 2076 616c 7565 732e 0a20 2020   the values..   
+00011d60: 2020 2020 2044 6174 6146 7261 6d65 2e69       DataFrame.i
+00011d70: 7465 6d73 203a 2049 7465 7261 7465 206f  tems : Iterate o
+00011d80: 7665 7220 2863 6f6c 756d 6e20 6e61 6d65  ver (column name
+00011d90: 2c20 5365 7269 6573 2920 7061 6972 732e  , Series) pairs.
+00011da0: 0a0a 2020 2020 2020 2020 4e6f 7465 730a  ..        Notes.
+00011db0: 2020 2020 2020 2020 2d2d 2d2d 2d0a 0a20          -----.. 
+00011dc0: 2020 2020 2020 2031 2e20 4265 6361 7573         1. Becaus
+00011dd0: 6520 6060 6974 6572 726f 7773 6060 2072  e ``iterrows`` r
+00011de0: 6574 7572 6e73 2061 2053 6572 6965 7320  eturns a Series 
+00011df0: 666f 7220 6561 6368 2072 6f77 2c0a 2020  for each row,.  
+00011e00: 2020 2020 2020 2020 2069 7420 646f 6573           it does
+00011e10: 202a 2a6e 6f74 2a2a 2070 7265 7365 7276   **not** preserv
+00011e20: 6520 6474 7970 6573 2061 6372 6f73 7320  e dtypes across 
+00011e30: 7468 6520 726f 7773 2028 6474 7970 6573  the rows (dtypes
+00011e40: 2061 7265 0a20 2020 2020 2020 2020 2020   are.           
+00011e50: 7072 6573 6572 7665 6420 6163 726f 7373  preserved across
+00011e60: 2063 6f6c 756d 6e73 2066 6f72 2044 6174   columns for Dat
+00011e70: 6146 7261 6d65 7329 2e20 466f 7220 6578  aFrames). For ex
+00011e80: 616d 706c 652c 0a0a 2020 2020 2020 2020  ample,..        
+00011e90: 2020 203e 3e3e 2069 6d70 6f72 7420 6d61     >>> import ma
+00011ea0: 7273 2e64 6174 6166 7261 6d65 2061 7320  rs.dataframe as 
+00011eb0: 6d64 0a20 2020 2020 2020 2020 2020 3e3e  md.           >>
+00011ec0: 3e20 6466 203d 206d 642e 4461 7461 4672  > df = md.DataFr
+00011ed0: 616d 6528 5b5b 312c 2031 2e35 5d5d 2c20  ame([[1, 1.5]], 
+00011ee0: 636f 6c75 6d6e 733d 5b27 696e 7427 2c20  columns=['int', 
+00011ef0: 2766 6c6f 6174 275d 290a 2020 2020 2020  'float']).      
+00011f00: 2020 2020 203e 3e3e 2072 6f77 203d 206e       >>> row = n
+00011f10: 6578 7428 6466 2e69 7465 7272 6f77 7328  ext(df.iterrows(
+00011f20: 2929 5b31 5d0a 2020 2020 2020 2020 2020  ))[1].          
+00011f30: 203e 3e3e 2072 6f77 0a20 2020 2020 2020   >>> row.       
+00011f40: 2020 2020 696e 7420 2020 2020 2031 2e30      int      1.0
+00011f50: 0a20 2020 2020 2020 2020 2020 666c 6f61  .           floa
+00011f60: 7420 2020 2031 2e35 0a20 2020 2020 2020  t    1.5.       
+00011f70: 2020 2020 4e61 6d65 3a20 302c 2064 7479      Name: 0, dty
+00011f80: 7065 3a20 666c 6f61 7436 340a 2020 2020  pe: float64.    
+00011f90: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
+00011fa0: 2872 6f77 5b27 696e 7427 5d2e 6474 7970  (row['int'].dtyp
+00011fb0: 6529 0a20 2020 2020 2020 2020 2020 666c  e).           fl
+00011fc0: 6f61 7436 340a 2020 2020 2020 2020 2020  oat64.          
+00011fd0: 203e 3e3e 2070 7269 6e74 2864 665b 2769   >>> print(df['i
+00011fe0: 6e74 275d 2e64 7479 7065 290a 2020 2020  nt'].dtype).    
+00011ff0: 2020 2020 2020 2069 6e74 3634 0a0a 2020         int64..  
+00012000: 2020 2020 2020 2020 2054 6f20 7072 6573           To pres
+00012010: 6572 7665 2064 7479 7065 7320 7768 696c  erve dtypes whil
+00012020: 6520 6974 6572 6174 696e 6720 6f76 6572  e iterating over
+00012030: 2074 6865 2072 6f77 732c 2069 7420 6973   the rows, it is
+00012040: 2062 6574 7465 720a 2020 2020 2020 2020   better.        
+00012050: 2020 2074 6f20 7573 6520 3a6d 6574 683a     to use :meth:
+00012060: 6069 7465 7274 7570 6c65 7360 2077 6869  `itertuples` whi
+00012070: 6368 2072 6574 7572 6e73 206e 616d 6564  ch returns named
+00012080: 7475 706c 6573 206f 6620 7468 6520 7661  tuples of the va
+00012090: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
+000120a0: 616e 6420 7768 6963 6820 6973 2067 656e  and which is gen
+000120b0: 6572 616c 6c79 2066 6173 7465 7220 7468  erally faster th
+000120c0: 616e 2060 6069 7465 7272 6f77 7360 602e  an ``iterrows``.
+000120d0: 0a0a 2020 2020 2020 2020 322e 2059 6f75  ..        2. You
+000120e0: 2073 686f 756c 6420 2a2a 6e65 7665 7220   should **never 
+000120f0: 6d6f 6469 6679 2a2a 2073 6f6d 6574 6869  modify** somethi
+00012100: 6e67 2079 6f75 2061 7265 2069 7465 7261  ng you are itera
+00012110: 7469 6e67 206f 7665 722e 0a20 2020 2020  ting over..     
+00012120: 2020 2020 2020 5468 6973 2069 7320 6e6f        This is no
+00012130: 7420 6775 6172 616e 7465 6564 2074 6f20  t guaranteed to 
+00012140: 776f 726b 2069 6e20 616c 6c20 6361 7365  work in all case
+00012150: 732e 2044 6570 656e 6469 6e67 206f 6e20  s. Depending on 
+00012160: 7468 650a 2020 2020 2020 2020 2020 2064  the.           d
+00012170: 6174 6120 7479 7065 732c 2074 6865 2069  ata types, the i
+00012180: 7465 7261 746f 7220 7265 7475 726e 7320  terator returns 
+00012190: 6120 636f 7079 2061 6e64 206e 6f74 2061  a copy and not a
+000121a0: 2076 6965 772c 2061 6e64 2077 7269 7469   view, and writi
+000121b0: 6e67 0a20 2020 2020 2020 2020 2020 746f  ng.           to
+000121c0: 2069 7420 7769 6c6c 2068 6176 6520 6e6f   it will have no
+000121d0: 2065 6666 6563 742e 0a20 2020 2020 2020   effect..       
+000121e0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+000121f0: 7572 6e20 7365 6c66 2e5f 6461 7461 2e69  urn self._data.i
+00012200: 7465 7272 6f77 7328 6261 7463 685f 7369  terrows(batch_si
+00012210: 7a65 3d62 6174 6368 5f73 697a 652c 2073  ze=batch_size, s
+00012220: 6573 7369 6f6e 3d73 6573 7369 6f6e 290a  ession=session).
+00012230: 0a20 2020 2064 6566 2069 7465 7274 7570  .    def itertup
+00012240: 6c65 7328 7365 6c66 2c20 696e 6465 783d  les(self, index=
+00012250: 5472 7565 2c20 6e61 6d65 3d22 5061 6e64  True, name="Pand
+00012260: 6173 222c 2062 6174 6368 5f73 697a 653d  as", batch_size=
+00012270: 3130 3030 2c20 7365 7373 696f 6e3d 4e6f  1000, session=No
+00012280: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
+00012290: 0a20 2020 2020 2020 2049 7465 7261 7465  .        Iterate
+000122a0: 206f 7665 7220 4461 7461 4672 616d 6520   over DataFrame 
+000122b0: 726f 7773 2061 7320 6e61 6d65 6474 7570  rows as namedtup
+000122c0: 6c65 732e 0a0a 2020 2020 2020 2020 5061  les...        Pa
+000122d0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+000122e0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+000122f0: 2020 2020 696e 6465 7820 3a20 626f 6f6c      index : bool
+00012300: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
+00012310: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
+00012320: 7565 2c20 7265 7475 726e 2074 6865 2069  ue, return the i
+00012330: 6e64 6578 2061 7320 7468 6520 6669 7273  ndex as the firs
+00012340: 7420 656c 656d 656e 7420 6f66 2074 6865  t element of the
+00012350: 2074 7570 6c65 2e0a 2020 2020 2020 2020   tuple..        
+00012360: 6e61 6d65 203a 2073 7472 206f 7220 4e6f  name : str or No
+00012370: 6e65 2c20 6465 6661 756c 7420 2250 616e  ne, default "Pan
+00012380: 6461 7322 0a20 2020 2020 2020 2020 2020  das".           
+00012390: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
+000123a0: 2072 6574 7572 6e65 6420 6e61 6d65 6474   returned namedt
+000123b0: 7570 6c65 7320 6f72 204e 6f6e 6520 746f  uples or None to
+000123c0: 2072 6574 7572 6e20 7265 6775 6c61 720a   return regular.
+000123d0: 2020 2020 2020 2020 2020 2020 7475 706c              tupl
+000123e0: 6573 2e0a 0a20 2020 2020 2020 2052 6574  es...        Ret
+000123f0: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+00012400: 2d2d 2d2d 0a20 2020 2020 2020 2069 7465  ----.        ite
+00012410: 7261 746f 720a 2020 2020 2020 2020 2020  rator.          
+00012420: 2020 416e 206f 626a 6563 7420 746f 2069    An object to i
+00012430: 7465 7261 7465 206f 7665 7220 6e61 6d65  terate over name
+00012440: 6474 7570 6c65 7320 666f 7220 6561 6368  dtuples for each
+00012450: 2072 6f77 2069 6e20 7468 650a 2020 2020   row in the.    
+00012460: 2020 2020 2020 2020 4461 7461 4672 616d          DataFram
+00012470: 6520 7769 7468 2074 6865 2066 6972 7374  e with the first
+00012480: 2066 6965 6c64 2070 6f73 7369 626c 7920   field possibly 
+00012490: 6265 696e 6720 7468 6520 696e 6465 7820  being the index 
+000124a0: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+000124b0: 666f 6c6c 6f77 696e 6720 6669 656c 6473  following fields
+000124c0: 2062 6569 6e67 2074 6865 2063 6f6c 756d   being the colum
+000124d0: 6e20 7661 6c75 6573 2e0a 0a20 2020 2020  n values...     
+000124e0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+000124f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+00012500: 2020 2020 2044 6174 6146 7261 6d65 2e69       DataFrame.i
+00012510: 7465 7272 6f77 7320 3a20 4974 6572 6174  terrows : Iterat
+00012520: 6520 6f76 6572 2044 6174 6146 7261 6d65  e over DataFrame
+00012530: 2072 6f77 7320 6173 2028 696e 6465 782c   rows as (index,
+00012540: 2053 6572 6965 7329 0a20 2020 2020 2020   Series).       
+00012550: 2020 2020 2070 6169 7273 2e0a 2020 2020       pairs..    
+00012560: 2020 2020 4461 7461 4672 616d 652e 6974      DataFrame.it
+00012570: 656d 7320 3a20 4974 6572 6174 6520 6f76  ems : Iterate ov
+00012580: 6572 2028 636f 6c75 6d6e 206e 616d 652c  er (column name,
+00012590: 2053 6572 6965 7329 2070 6169 7273 2e0a   Series) pairs..
+000125a0: 0a20 2020 2020 2020 204e 6f74 6573 0a20  .        Notes. 
+000125b0: 2020 2020 2020 202d 2d2d 2d2d 0a20 2020         -----.   
+000125c0: 2020 2020 2054 6865 2063 6f6c 756d 6e20       The column 
+000125d0: 6e61 6d65 7320 7769 6c6c 2062 6520 7265  names will be re
+000125e0: 6e61 6d65 6420 746f 2070 6f73 6974 696f  named to positio
+000125f0: 6e61 6c20 6e61 6d65 7320 6966 2074 6865  nal names if the
+00012600: 7920 6172 650a 2020 2020 2020 2020 696e  y are.        in
+00012610: 7661 6c69 6420 5079 7468 6f6e 2069 6465  valid Python ide
+00012620: 6e74 6966 6965 7273 2c20 7265 7065 6174  ntifiers, repeat
+00012630: 6564 2c20 6f72 2073 7461 7274 2077 6974  ed, or start wit
+00012640: 6820 616e 2075 6e64 6572 7363 6f72 652e  h an underscore.
+00012650: 0a20 2020 2020 2020 204f 6e20 7079 7468  .        On pyth
+00012660: 6f6e 2076 6572 7369 6f6e 7320 3c20 332e  on versions < 3.
+00012670: 3720 7265 6775 6c61 7220 7475 706c 6573  7 regular tuples
+00012680: 2061 7265 2072 6574 7572 6e65 6420 666f   are returned fo
+00012690: 7220 4461 7461 4672 616d 6573 0a20 2020  r DataFrames.   
+000126a0: 2020 2020 2077 6974 6820 6120 6c61 7267       with a larg
+000126b0: 6520 6e75 6d62 6572 206f 6620 636f 6c75  e number of colu
+000126c0: 6d6e 7320 283e 3235 3429 2e0a 0a20 2020  mns (>254)...   
+000126d0: 2020 2020 2045 7861 6d70 6c65 730a 2020       Examples.  
+000126e0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+000126f0: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
+00012700: 7420 6d61 7273 2e64 6174 6166 7261 6d65  t mars.dataframe
+00012710: 2061 7320 6d64 0a20 2020 2020 2020 203e   as md.        >
+00012720: 3e3e 2064 6620 3d20 6d64 2e44 6174 6146  >> df = md.DataF
+00012730: 7261 6d65 287b 276e 756d 5f6c 6567 7327  rame({'num_legs'
+00012740: 3a20 5b34 2c20 325d 2c20 276e 756d 5f77  : [4, 2], 'num_w
+00012750: 696e 6773 273a 205b 302c 2032 5d7d 2c0a  ings': [0, 2]},.
+00012760: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00012770: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00012780: 6465 783d 5b27 646f 6727 2c20 2768 6177  dex=['dog', 'haw
+00012790: 6b27 5d29 0a20 2020 2020 2020 203e 3e3e  k']).        >>>
+000127a0: 2064 662e 6578 6563 7574 6528 290a 2020   df.execute().  
+000127b0: 2020 2020 2020 2020 2020 2020 6e75 6d5f              num_
+000127c0: 6c65 6773 2020 6e75 6d5f 7769 6e67 730a  legs  num_wings.
+000127d0: 2020 2020 2020 2020 646f 6720 2020 2020          dog     
+000127e0: 2020 2020 2034 2020 2020 2020 2020 2020       4          
+000127f0: 300a 2020 2020 2020 2020 6861 776b 2020  0.        hawk  
+00012800: 2020 2020 2020 2032 2020 2020 2020 2020         2        
+00012810: 2020 320a 2020 2020 2020 2020 3e3e 3e20    2.        >>> 
+00012820: 666f 7220 726f 7720 696e 2064 662e 6974  for row in df.it
+00012830: 6572 7475 706c 6573 2829 3a0a 2020 2020  ertuples():.    
+00012840: 2020 2020 2e2e 2e20 2020 2020 7072 696e      ...     prin
+00012850: 7428 726f 7729 0a20 2020 2020 2020 202e  t(row).        .
+00012860: 2e2e 0a20 2020 2020 2020 2050 616e 6461  ...        Panda
+00012870: 7328 496e 6465 783d 2764 6f67 272c 206e  s(Index='dog', n
+00012880: 756d 5f6c 6567 733d 342c 206e 756d 5f77  um_legs=4, num_w
+00012890: 696e 6773 3d30 290a 2020 2020 2020 2020  ings=0).        
+000128a0: 5061 6e64 6173 2849 6e64 6578 3d27 6861  Pandas(Index='ha
+000128b0: 776b 272c 206e 756d 5f6c 6567 733d 322c  wk', num_legs=2,
+000128c0: 206e 756d 5f77 696e 6773 3d32 290a 0a20   num_wings=2).. 
+000128d0: 2020 2020 2020 2042 7920 7365 7474 696e         By settin
+000128e0: 6720 7468 6520 6069 6e64 6578 6020 7061  g the `index` pa
+000128f0: 7261 6d65 7465 7220 746f 2046 616c 7365  rameter to False
+00012900: 2077 6520 6361 6e20 7265 6d6f 7665 2074   we can remove t
+00012910: 6865 2069 6e64 6578 0a20 2020 2020 2020  he index.       
+00012920: 2061 7320 7468 6520 6669 7273 7420 656c   as the first el
+00012930: 656d 656e 7420 6f66 2074 6865 2074 7570  ement of the tup
+00012940: 6c65 3a0a 0a20 2020 2020 2020 203e 3e3e  le:..        >>>
+00012950: 2066 6f72 2072 6f77 2069 6e20 6466 2e69   for row in df.i
+00012960: 7465 7274 7570 6c65 7328 696e 6465 783d  tertuples(index=
+00012970: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00012980: 2e2e 2e20 2020 2020 7072 696e 7428 726f  ...     print(ro
+00012990: 7729 0a20 2020 2020 2020 202e 2e2e 0a20  w).        .... 
+000129a0: 2020 2020 2020 2050 616e 6461 7328 6e75         Pandas(nu
+000129b0: 6d5f 6c65 6773 3d34 2c20 6e75 6d5f 7769  m_legs=4, num_wi
+000129c0: 6e67 733d 3029 0a20 2020 2020 2020 2050  ngs=0).        P
+000129d0: 616e 6461 7328 6e75 6d5f 6c65 6773 3d32  andas(num_legs=2
+000129e0: 2c20 6e75 6d5f 7769 6e67 733d 3229 0a0a  , num_wings=2)..
+000129f0: 2020 2020 2020 2020 5769 7468 2074 6865          With the
+00012a00: 2060 6e61 6d65 6020 7061 7261 6d65 7465   `name` paramete
+00012a10: 7220 7365 7420 7765 2073 6574 2061 2063  r set we set a c
+00012a20: 7573 746f 6d20 6e61 6d65 2066 6f72 2074  ustom name for t
+00012a30: 6865 2079 6965 6c64 6564 0a20 2020 2020  he yielded.     
+00012a40: 2020 206e 616d 6564 7475 706c 6573 3a0a     namedtuples:.
+00012a50: 0a20 2020 2020 2020 203e 3e3e 2066 6f72  .        >>> for
+00012a60: 2072 6f77 2069 6e20 6466 2e69 7465 7274   row in df.itert
+00012a70: 7570 6c65 7328 6e61 6d65 3d27 416e 696d  uples(name='Anim
+00012a80: 616c 2729 3a0a 2020 2020 2020 2020 2e2e  al'):.        ..
+00012a90: 2e20 2020 2020 7072 696e 7428 726f 7729  .     print(row)
+00012aa0: 0a20 2020 2020 2020 202e 2e2e 0a20 2020  .        ....   
+00012ab0: 2020 2020 2041 6e69 6d61 6c28 496e 6465       Animal(Inde
+00012ac0: 783d 2764 6f67 272c 206e 756d 5f6c 6567  x='dog', num_leg
+00012ad0: 733d 342c 206e 756d 5f77 696e 6773 3d30  s=4, num_wings=0
+00012ae0: 290a 2020 2020 2020 2020 416e 696d 616c  ).        Animal
+00012af0: 2849 6e64 6578 3d27 6861 776b 272c 206e  (Index='hawk', n
+00012b00: 756d 5f6c 6567 733d 322c 206e 756d 5f77  um_legs=2, num_w
+00012b10: 696e 6773 3d32 290a 2020 2020 2020 2020  ings=2).        
+00012b20: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+00012b30: 726e 2073 656c 662e 5f64 6174 612e 6974  rn self._data.it
+00012b40: 6572 7475 706c 6573 280a 2020 2020 2020  ertuples(.      
+00012b50: 2020 2020 2020 6261 7463 685f 7369 7a65        batch_size
+00012b60: 3d62 6174 6368 5f73 697a 652c 2073 6573  =batch_size, ses
+00012b70: 7369 6f6e 3d73 6573 7369 6f6e 2c20 696e  sion=session, in
+00012b80: 6465 783d 696e 6465 782c 206e 616d 653d  dex=index, name=
+00012b90: 6e61 6d65 0a20 2020 2020 2020 2029 0a0a  name.        )..
+00012ba0: 2020 2020 6465 6620 6173 7369 676e 2873      def assign(s
+00012bb0: 656c 662c 202a 2a6b 7761 7267 7329 3a0a  elf, **kwargs):.
+00012bc0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00012bd0: 2020 2020 4173 7369 676e 206e 6577 2063      Assign new c
+00012be0: 6f6c 756d 6e73 2074 6f20 6120 4461 7461  olumns to a Data
+00012bf0: 4672 616d 652e 0a20 2020 2020 2020 2052  Frame..        R
+00012c00: 6574 7572 6e73 2061 206e 6577 206f 626a  eturns a new obj
+00012c10: 6563 7420 7769 7468 2061 6c6c 206f 7269  ect with all ori
+00012c20: 6769 6e61 6c20 636f 6c75 6d6e 7320 696e  ginal columns in
+00012c30: 2061 6464 6974 696f 6e20 746f 206e 6577   addition to new
+00012c40: 206f 6e65 732e 0a20 2020 2020 2020 2045   ones..        E
+00012c50: 7869 7374 696e 6720 636f 6c75 6d6e 7320  xisting columns 
+00012c60: 7468 6174 2061 7265 2072 652d 6173 7369  that are re-assi
+00012c70: 676e 6564 2077 696c 6c20 6265 206f 7665  gned will be ove
+00012c80: 7277 7269 7474 656e 2e0a 0a20 2020 2020  rwritten...     
+00012c90: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00012ca0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00012cb0: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
+00012cc0: 7320 3a20 6469 6374 206f 6620 7b73 7472  s : dict of {str
+00012cd0: 3a20 6361 6c6c 6162 6c65 206f 7220 5365  : callable or Se
+00012ce0: 7269 6573 7d0a 2020 2020 2020 2020 2020  ries}.          
+00012cf0: 2020 5468 6520 636f 6c75 6d6e 206e 616d    The column nam
+00012d00: 6573 2061 7265 206b 6579 776f 7264 732e  es are keywords.
+00012d10: 2049 6620 7468 6520 7661 6c75 6573 2061   If the values a
+00012d20: 7265 0a20 2020 2020 2020 2020 2020 2063  re.            c
+00012d30: 616c 6c61 626c 652c 2074 6865 7920 6172  allable, they ar
+00012d40: 6520 636f 6d70 7574 6564 206f 6e20 7468  e computed on th
+00012d50: 6520 4461 7461 4672 616d 6520 616e 640a  e DataFrame and.
+00012d60: 2020 2020 2020 2020 2020 2020 6173 7369              assi
+00012d70: 676e 6564 2074 6f20 7468 6520 6e65 7720  gned to the new 
+00012d80: 636f 6c75 6d6e 732e 2054 6865 2063 616c  columns. The cal
+00012d90: 6c61 626c 6520 6d75 7374 206e 6f74 0a20  lable must not. 
+00012da0: 2020 2020 2020 2020 2020 2063 6861 6e67             chang
+00012db0: 6520 696e 7075 7420 4461 7461 4672 616d  e input DataFram
+00012dc0: 6520 2874 686f 7567 6820 7061 6e64 6173  e (though pandas
+00012dd0: 2064 6f65 736e 2774 2063 6865 636b 2069   doesn't check i
+00012de0: 7429 2e0a 2020 2020 2020 2020 2020 2020  t)..            
+00012df0: 4966 2074 6865 2076 616c 7565 7320 6172  If the values ar
+00012e00: 6520 6e6f 7420 6361 6c6c 6162 6c65 2c20  e not callable, 
+00012e10: 2865 2e67 2e20 6120 5365 7269 6573 2c20  (e.g. a Series, 
+00012e20: 7363 616c 6172 2c20 6f72 2061 7272 6179  scalar, or array
+00012e30: 292c 0a20 2020 2020 2020 2020 2020 2074  ),.            t
+00012e40: 6865 7920 6172 6520 7369 6d70 6c79 2061  hey are simply a
+00012e50: 7373 6967 6e65 642e 0a0a 2020 2020 2020  ssigned...      
+00012e60: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+00012e70: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+00012e80: 2020 4461 7461 4672 616d 650a 2020 2020    DataFrame.    
+00012e90: 2020 2020 2020 2020 4120 6e65 7720 4461          A new Da
+00012ea0: 7461 4672 616d 6520 7769 7468 2074 6865  taFrame with the
+00012eb0: 206e 6577 2063 6f6c 756d 6e73 2069 6e20   new columns in 
+00012ec0: 6164 6469 7469 6f6e 2074 6f0a 2020 2020  addition to.    
+00012ed0: 2020 2020 2020 2020 616c 6c20 7468 6520          all the 
+00012ee0: 6578 6973 7469 6e67 2063 6f6c 756d 6e73  existing columns
+00012ef0: 2e0a 0a20 2020 2020 2020 204e 6f74 6573  ...        Notes
+00012f00: 0a20 2020 2020 2020 202d 2d2d 2d2d 0a20  .        -----. 
+00012f10: 2020 2020 2020 2041 7373 6967 6e69 6e67         Assigning
+00012f20: 206d 756c 7469 706c 6520 636f 6c75 6d6e   multiple column
+00012f30: 7320 7769 7468 696e 2074 6865 2073 616d  s within the sam
+00012f40: 6520 6060 6173 7369 676e 6060 2069 7320  e ``assign`` is 
+00012f50: 706f 7373 6962 6c65 2e0a 2020 2020 2020  possible..      
+00012f60: 2020 4c61 7465 7220 6974 656d 7320 696e    Later items in
+00012f70: 2027 6b77 6172 6773 2720 6d61 7920 7265   'kwargs' may re
+00012f80: 6665 7220 746f 206e 6577 6c79 2063 7265  fer to newly cre
+00012f90: 6174 6564 206f 7220 6d6f 6469 6669 6564  ated or modified
+00012fa0: 0a20 2020 2020 2020 2063 6f6c 756d 6e73  .        columns
+00012fb0: 2069 6e20 2764 6627 3b20 6974 656d 7320   in 'df'; items 
+00012fc0: 6172 6520 636f 6d70 7574 6564 2061 6e64  are computed and
+00012fd0: 2061 7373 6967 6e65 6420 696e 746f 2027   assigned into '
+00012fe0: 6466 2720 696e 206f 7264 6572 2e0a 0a20  df' in order... 
+00012ff0: 2020 2020 2020 2045 7861 6d70 6c65 730a         Examples.
+00013000: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00013010: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+00013020: 6f72 7420 6d61 7273 2e64 6174 6166 7261  ort mars.datafra
+00013030: 6d65 2061 7320 6d64 0a20 2020 2020 2020  me as md.       
+00013040: 203e 3e3e 2064 6620 3d20 6d64 2e44 6174   >>> df = md.Dat
+00013050: 6146 7261 6d65 287b 2774 656d 705f 6327  aFrame({'temp_c'
+00013060: 3a20 5b31 372e 302c 2032 352e 305d 7d2c  : [17.0, 25.0]},
+00013070: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00013080: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00013090: 6e64 6578 3d5b 2750 6f72 746c 616e 6427  ndex=['Portland'
+000130a0: 2c20 2742 6572 6b65 6c65 7927 5d29 0a20  , 'Berkeley']). 
+000130b0: 2020 2020 2020 203e 3e3e 2064 662e 6578         >>> df.ex
+000130c0: 6563 7574 6528 290a 2020 2020 2020 2020  ecute().        
+000130d0: 2020 2020 2020 2020 2020 7465 6d70 5f63            temp_c
+000130e0: 0a20 2020 2020 2020 2050 6f72 746c 616e  .        Portlan
+000130f0: 6420 2020 2031 372e 300a 2020 2020 2020  d    17.0.      
+00013100: 2020 4265 726b 656c 6579 2020 2020 3235    Berkeley    25
+00013110: 2e30 0a0a 2020 2020 2020 2020 5768 6572  .0..        Wher
+00013120: 6520 7468 6520 7661 6c75 6520 6973 2061  e the value is a
+00013130: 2063 616c 6c61 626c 652c 2065 7661 6c75   callable, evalu
+00013140: 6174 6564 206f 6e20 6064 6660 3a0a 0a20  ated on `df`:.. 
+00013150: 2020 2020 2020 203e 3e3e 2064 662e 6173         >>> df.as
+00013160: 7369 676e 2874 656d 705f 663d 6c61 6d62  sign(temp_f=lamb
+00013170: 6461 2078 3a20 782e 7465 6d70 5f63 202a  da x: x.temp_c *
+00013180: 2039 202f 2035 202b 2033 3229 2e65 7865   9 / 5 + 32).exe
+00013190: 6375 7465 2829 0a20 2020 2020 2020 2020  cute().         
+000131a0: 2020 2020 2020 2020 2074 656d 705f 6320           temp_c 
+000131b0: 2074 656d 705f 660a 2020 2020 2020 2020   temp_f.        
+000131c0: 506f 7274 6c61 6e64 2020 2020 3137 2e30  Portland    17.0
+000131d0: 2020 2020 3632 2e36 0a20 2020 2020 2020      62.6.       
+000131e0: 2042 6572 6b65 6c65 7920 2020 2032 352e   Berkeley    25.
+000131f0: 3020 2020 2037 372e 300a 0a20 2020 2020  0    77.0..     
+00013200: 2020 2041 6c74 6572 6e61 7469 7665 6c79     Alternatively
+00013210: 2c20 7468 6520 7361 6d65 2062 6568 6176  , the same behav
+00013220: 696f 7220 6361 6e20 6265 2061 6368 6965  ior can be achie
+00013230: 7665 6420 6279 2064 6972 6563 746c 790a  ved by directly.
+00013240: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
+00013250: 696e 6720 616e 2065 7869 7374 696e 6720  ing an existing 
+00013260: 5365 7269 6573 206f 7220 7365 7175 656e  Series or sequen
+00013270: 6365 3a0a 0a20 2020 2020 2020 203e 3e3e  ce:..        >>>
+00013280: 2064 662e 6173 7369 676e 2874 656d 705f   df.assign(temp_
+00013290: 663d 6466 5b27 7465 6d70 5f63 275d 202a  f=df['temp_c'] *
+000132a0: 2039 202f 2035 202b 2033 3229 2e65 7865   9 / 5 + 32).exe
+000132b0: 6375 7465 2829 0a20 2020 2020 2020 2020  cute().         
+000132c0: 2020 2020 2020 2020 2074 656d 705f 6320           temp_c 
+000132d0: 2074 656d 705f 660a 2020 2020 2020 2020   temp_f.        
+000132e0: 506f 7274 6c61 6e64 2020 2020 3137 2e30  Portland    17.0
+000132f0: 2020 2020 3632 2e36 0a20 2020 2020 2020      62.6.       
+00013300: 2042 6572 6b65 6c65 7920 2020 2032 352e   Berkeley    25.
+00013310: 3020 2020 2037 372e 300a 0a20 2020 2020  0    77.0..     
+00013320: 2020 2059 6f75 2063 616e 2063 7265 6174     You can creat
+00013330: 6520 6d75 6c74 6970 6c65 2063 6f6c 756d  e multiple colum
+00013340: 6e73 2077 6974 6869 6e20 7468 6520 7361  ns within the sa
+00013350: 6d65 2061 7373 6967 6e20 7768 6572 6520  me assign where 
+00013360: 6f6e 650a 2020 2020 2020 2020 6f66 2074  one.        of t
+00013370: 6865 2063 6f6c 756d 6e73 2064 6570 656e  he columns depen
+00013380: 6473 206f 6e20 616e 6f74 6865 7220 6f6e  ds on another on
+00013390: 6520 6465 6669 6e65 6420 7769 7468 696e  e defined within
+000133a0: 2074 6865 2073 616d 6520 6173 7369 676e   the same assign
+000133b0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+000133c0: 662e 6173 7369 676e 2874 656d 705f 663d  f.assign(temp_f=
+000133d0: 6c61 6d62 6461 2078 3a20 785b 2774 656d  lambda x: x['tem
+000133e0: 705f 6327 5d20 2a20 3920 2f20 3520 2b20  p_c'] * 9 / 5 + 
+000133f0: 3332 2c0a 2020 2020 2020 2020 2e2e 2e20  32,.        ... 
+00013400: 2020 2020 2020 2020 2020 7465 6d70 5f6b            temp_k
+00013410: 3d6c 616d 6264 6120 783a 2028 785b 2774  =lambda x: (x['t
+00013420: 656d 705f 6627 5d20 2b20 2034 3539 2e36  emp_f'] +  459.6
+00013430: 3729 202a 2035 202f 2039 292e 6578 6563  7) * 5 / 9).exec
+00013440: 7574 6528 290a 2020 2020 2020 2020 2020  ute().          
+00013450: 2020 2020 2020 2020 7465 6d70 5f63 2020          temp_c  
+00013460: 7465 6d70 5f66 2020 7465 6d70 5f6b 0a20  temp_f  temp_k. 
+00013470: 2020 2020 2020 2050 6f72 746c 616e 6420         Portland 
+00013480: 2020 2031 372e 3020 2020 2036 322e 3620     17.0    62.6 
+00013490: 2032 3930 2e31 350a 2020 2020 2020 2020   290.15.        
+000134a0: 4265 726b 656c 6579 2020 2020 3235 2e30  Berkeley    25.0
+000134b0: 2020 2020 3737 2e30 2020 3239 382e 3135      77.0  298.15
+000134c0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+000134d0: 2020 2020 2020 6465 6620 6170 706c 795f        def apply_
+000134e0: 6966 5f63 616c 6c61 626c 6528 6d61 7962  if_callable(mayb
+000134f0: 655f 6361 6c6c 6162 6c65 2c20 6f62 6a2c  e_callable, obj,
+00013500: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00013510: 2020 2020 2020 2020 6966 2063 616c 6c61          if calla
+00013520: 626c 6528 6d61 7962 655f 6361 6c6c 6162  ble(maybe_callab
+00013530: 6c65 293a 0a20 2020 2020 2020 2020 2020  le):.           
+00013540: 2020 2020 2072 6574 7572 6e20 6d61 7962       return mayb
+00013550: 655f 6361 6c6c 6162 6c65 286f 626a 2c20  e_callable(obj, 
+00013560: 2a2a 6b77 6172 6773 290a 0a20 2020 2020  **kwargs)..     
+00013570: 2020 2020 2020 2072 6574 7572 6e20 6d61         return ma
+00013580: 7962 655f 6361 6c6c 6162 6c65 0a0a 2020  ybe_callable..  
+00013590: 2020 2020 2020 6461 7461 203d 2073 656c        data = sel
+000135a0: 662e 636f 7079 2829 0a0a 2020 2020 2020  f.copy()..      
+000135b0: 2020 666f 7220 6b2c 2076 2069 6e20 6b77    for k, v in kw
+000135c0: 6172 6773 2e69 7465 6d73 2829 3a0a 2020  args.items():.  
+000135d0: 2020 2020 2020 2020 2020 6461 7461 5b6b            data[k
+000135e0: 5d20 3d20 6170 706c 795f 6966 5f63 616c  ] = apply_if_cal
+000135f0: 6c61 626c 6528 762c 2064 6174 6129 0a20  lable(v, data). 
+00013600: 2020 2020 2020 2072 6574 7572 6e20 6461         return da
+00013610: 7461 0a0a 0a63 6c61 7373 2044 6174 6146  ta...class DataF
+00013620: 7261 6d65 4772 6f75 7042 7943 6875 6e6b  rameGroupByChunk
+00013630: 4461 7461 2842 6173 6544 6174 6146 7261  Data(BaseDataFra
+00013640: 6d65 4368 756e 6b44 6174 6129 3a0a 2020  meChunkData):.  
+00013650: 2020 7479 7065 5f6e 616d 6520 3d20 2244    type_name = "D
+00013660: 6174 6146 7261 6d65 4772 6f75 7042 7922  ataFrameGroupBy"
+00013670: 0a0a 2020 2020 5f6b 6579 5f64 7479 7065  ..    _key_dtype
+00013680: 7320 3d20 5365 7269 6573 4669 656c 6428  s = SeriesField(
+00013690: 226b 6579 5f64 7479 7065 7322 290a 2020  "key_dtypes").  
+000136a0: 2020 5f73 656c 6563 7469 6f6e 203d 2041    _selection = A
+000136b0: 6e79 4669 656c 6428 2273 656c 6563 7469  nyField("selecti
+000136c0: 6f6e 2229 0a0a 2020 2020 4070 726f 7065  on")..    @prope
+000136d0: 7274 790a 2020 2020 6465 6620 6b65 795f  rty.    def key_
+000136e0: 6474 7970 6573 2873 656c 6629 3a0a 2020  dtypes(self):.  
+000136f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00013700: 662e 5f6b 6579 5f64 7479 7065 730a 0a20  f._key_dtypes.. 
+00013710: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00013720: 2064 6566 2073 656c 6563 7469 6f6e 2873   def selection(s
+00013730: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00013740: 7475 726e 2073 656c 662e 5f73 656c 6563  turn self._selec
+00013750: 7469 6f6e 0a0a 2020 2020 6465 6620 5f67  tion..    def _g
+00013760: 6574 5f70 6172 616d 7328 7365 6c66 2920  et_params(self) 
+00013770: 2d3e 2044 6963 745b 7374 722c 2041 6e79  -> Dict[str, Any
+00013780: 5d3a 0a20 2020 2020 2020 2070 203d 2073  ]:.        p = s
+00013790: 7570 6572 2829 2e5f 6765 745f 7061 7261  uper()._get_para
+000137a0: 6d73 2829 0a20 2020 2020 2020 2070 2e75  ms().        p.u
+000137b0: 7064 6174 6528 6469 6374 286b 6579 5f64  pdate(dict(key_d
+000137c0: 7479 7065 733d 7365 6c66 2e6b 6579 5f64  types=self.key_d
+000137d0: 7479 7065 732c 2073 656c 6563 7469 6f6e  types, selection
+000137e0: 3d73 656c 662e 7365 6c65 6374 696f 6e29  =self.selection)
+000137f0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00013800: 2070 0a0a 2020 2020 6465 6620 5f73 6574   p..    def _set
+00013810: 5f70 6172 616d 7328 7365 6c66 2c20 6e65  _params(self, ne
+00013820: 775f 7061 7261 6d73 3a20 4469 6374 5b73  w_params: Dict[s
+00013830: 7472 2c20 416e 795d 293a 0a20 2020 2020  tr, Any]):.     
+00013840: 2020 2070 6172 616d 7320 3d20 6e65 775f     params = new_
+00013850: 7061 7261 6d73 2e63 6f70 7928 290a 2020  params.copy().  
+00013860: 2020 2020 2020 6b65 795f 6474 7970 6573        key_dtypes
+00013870: 203d 2070 6172 616d 732e 706f 7028 226b   = params.pop("k
+00013880: 6579 5f64 7479 7065 7322 2c20 4e6f 6e65  ey_dtypes", None
+00013890: 290a 2020 2020 2020 2020 6966 206b 6579  ).        if key
+000138a0: 5f64 7479 7065 7320 6973 206e 6f74 204e  _dtypes is not N
+000138b0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000138c0: 2073 656c 662e 5f6b 6579 5f64 7479 7065   self._key_dtype
+000138d0: 7320 3d20 6b65 795f 6474 7970 6573 0a20  s = key_dtypes. 
+000138e0: 2020 2020 2020 2073 656c 6563 7469 6f6e         selection
+000138f0: 203d 2070 6172 616d 732e 706f 7028 2273   = params.pop("s
+00013900: 656c 6563 7469 6f6e 222c 204e 6f6e 6529  election", None)
+00013910: 0a20 2020 2020 2020 2069 6620 7365 6c65  .        if sele
+00013920: 6374 696f 6e20 6973 206e 6f74 204e 6f6e  ction is not Non
+00013930: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00013940: 656c 662e 5f73 656c 6563 7469 6f6e 203d  elf._selection =
+00013950: 2073 656c 6563 7469 6f6e 0a20 2020 2020   selection.     
+00013960: 2020 2073 7570 6572 2829 2e5f 7365 745f     super()._set_
+00013970: 7061 7261 6d73 2870 6172 616d 7329 0a0a  params(params)..
+00013980: 2020 2020 7061 7261 6d73 203d 2070 726f      params = pro
+00013990: 7065 7274 7928 5f67 6574 5f70 6172 616d  perty(_get_param
+000139a0: 732c 205f 7365 745f 7061 7261 6d73 290a  s, _set_params).
+000139b0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
+000139c0: 640a 2020 2020 6465 6620 6765 745f 7061  d.    def get_pa
+000139d0: 7261 6d73 5f66 726f 6d5f 6461 7461 2863  rams_from_data(c
+000139e0: 6c73 2c20 6461 7461 3a20 4772 6f75 7042  ls, data: GroupB
+000139f0: 7957 7261 7070 6572 2920 2d3e 2044 6963  yWrapper) -> Dic
+00013a00: 745b 7374 722c 2041 6e79 5d3a 0a20 2020  t[str, Any]:.   
+00013a10: 2020 2020 2070 6172 616d 7320 3d20 7375       params = su
+00013a20: 7065 7228 292e 6765 745f 7061 7261 6d73  per().get_params
+00013a30: 5f66 726f 6d5f 6461 7461 2864 6174 612e  _from_data(data.
+00013a40: 6f62 6a29 0a20 2020 2020 2020 2069 6620  obj).        if 
+00013a50: 6461 7461 2e73 656c 6563 7469 6f6e 3a0a  data.selection:.
+00013a60: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+00013a70: 6573 203d 2070 6172 616d 735b 2264 7479  es = params["dty
+00013a80: 7065 735f 7661 6c75 6522 5d2e 7661 6c75  pes_value"].valu
+00013a90: 655b 6461 7461 2e73 656c 6563 7469 6f6e  e[data.selection
+00013aa0: 5d0a 2020 2020 2020 2020 2020 2020 7061  ].            pa
+00013ab0: 7261 6d73 5b22 6474 7970 6573 5f76 616c  rams["dtypes_val
+00013ac0: 7565 225d 203d 2044 7479 7065 7356 616c  ue"] = DtypesVal
+00013ad0: 7565 2876 616c 7565 3d64 7479 7065 7329  ue(value=dtypes)
+00013ae0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+00013af0: 616d 735b 2273 6861 7065 225d 203d 2064  ams["shape"] = d
+00013b00: 6174 612e 7368 6170 650a 2020 2020 2020  ata.shape.      
+00013b10: 2020 7265 7475 726e 2070 6172 616d 730a    return params.
+00013b20: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00013b30: 5f28 7365 6c66 2c20 6b65 795f 6474 7970  _(self, key_dtyp
+00013b40: 6573 3d4e 6f6e 652c 2073 656c 6563 7469  es=None, selecti
+00013b50: 6f6e 3d4e 6f6e 652c 202a 2a6b 7729 3a0a  on=None, **kw):.
+00013b60: 2020 2020 2020 2020 7375 7065 7228 292e          super().
+00013b70: 5f5f 696e 6974 5f5f 285f 6b65 795f 6474  __init__(_key_dt
+00013b80: 7970 6573 3d6b 6579 5f64 7479 7065 732c  ypes=key_dtypes,
+00013b90: 205f 7365 6c65 6374 696f 6e3d 7365 6c65   _selection=sele
+00013ba0: 6374 696f 6e2c 202a 2a6b 7729 0a0a 0a63  ction, **kw)...c
+00013bb0: 6c61 7373 2044 6174 6146 7261 6d65 4772  lass DataFrameGr
+00013bc0: 6f75 7042 7943 6875 6e6b 2843 6875 6e6b  oupByChunk(Chunk
+00013bd0: 293a 0a20 2020 205f 5f73 6c6f 7473 5f5f  ):.    __slots__
+00013be0: 203d 2028 290a 2020 2020 5f61 6c6c 6f77   = ().    _allow
+00013bf0: 5f64 6174 615f 7479 7065 5f20 3d20 2844  _data_type_ = (D
+00013c00: 6174 6146 7261 6d65 4772 6f75 7042 7943  ataFrameGroupByC
+00013c10: 6875 6e6b 4461 7461 2c29 0a20 2020 2074  hunkData,).    t
+00013c20: 7970 655f 6e61 6d65 203d 2022 4461 7461  ype_name = "Data
+00013c30: 4672 616d 6547 726f 7570 4279 220a 0a20  FrameGroupBy".. 
+00013c40: 2020 2064 6566 205f 5f6c 656e 5f5f 2873     def __len__(s
+00013c50: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00013c60: 7475 726e 206c 656e 2873 656c 662e 5f64  turn len(self._d
+00013c70: 6174 6129 0a0a 0a63 6c61 7373 2053 6572  ata)...class Ser
+00013c80: 6965 7347 726f 7570 4279 4368 756e 6b44  iesGroupByChunkD
+00013c90: 6174 6128 4261 7365 5365 7269 6573 4368  ata(BaseSeriesCh
+00013ca0: 756e 6b44 6174 6129 3a0a 2020 2020 7479  unkData):.    ty
+00013cb0: 7065 5f6e 616d 6520 3d20 2253 6572 6965  pe_name = "Serie
+00013cc0: 7347 726f 7570 4279 220a 0a20 2020 205f  sGroupBy"..    _
+00013cd0: 6b65 795f 6474 7970 6573 203d 2041 6e79  key_dtypes = Any
+00013ce0: 4669 656c 6428 226b 6579 5f64 7479 7065  Field("key_dtype
+00013cf0: 7322 290a 0a20 2020 2040 7072 6f70 6572  s")..    @proper
+00013d00: 7479 0a20 2020 2064 6566 206b 6579 5f64  ty.    def key_d
+00013d10: 7479 7065 7328 7365 6c66 293a 0a20 2020  types(self):.   
+00013d20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00013d30: 2e5f 6b65 795f 6474 7970 6573 0a0a 2020  ._key_dtypes..  
+00013d40: 2020 6465 6620 5f67 6574 5f70 6172 616d    def _get_param
+00013d50: 7328 7365 6c66 2920 2d3e 2044 6963 745b  s(self) -> Dict[
+00013d60: 7374 722c 2041 6e79 5d3a 0a20 2020 2020  str, Any]:.     
+00013d70: 2020 2070 203d 2073 7570 6572 2829 2e5f     p = super()._
+00013d80: 6765 745f 7061 7261 6d73 2829 0a20 2020  get_params().   
+00013d90: 2020 2020 2070 5b22 6b65 795f 6474 7970       p["key_dtyp
+00013da0: 6573 225d 203d 2073 656c 662e 6b65 795f  es"] = self.key_
+00013db0: 6474 7970 6573 0a20 2020 2020 2020 2072  dtypes.        r
+00013dc0: 6574 7572 6e20 700a 0a20 2020 2064 6566  eturn p..    def
+00013dd0: 205f 7365 745f 7061 7261 6d73 2873 656c   _set_params(sel
+00013de0: 662c 206e 6577 5f70 6172 616d 733a 2044  f, new_params: D
+00013df0: 6963 745b 7374 722c 2041 6e79 5d29 3a0a  ict[str, Any]):.
+00013e00: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+00013e10: 206e 6577 5f70 6172 616d 732e 636f 7079   new_params.copy
+00013e20: 2829 0a20 2020 2020 2020 206b 6579 5f64  ().        key_d
+00013e30: 7479 7065 7320 3d20 7061 7261 6d73 2e70  types = params.p
+00013e40: 6f70 2822 6b65 795f 6474 7970 6573 222c  op("key_dtypes",
+00013e50: 204e 6f6e 6529 0a20 2020 2020 2020 2069   None).        i
+00013e60: 6620 6b65 795f 6474 7970 6573 2069 7320  f key_dtypes is 
+00013e70: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00013e80: 2020 2020 2020 7365 6c66 2e5f 6b65 795f        self._key_
+00013e90: 6474 7970 6573 203d 206b 6579 5f64 7479  dtypes = key_dty
+00013ea0: 7065 730a 2020 2020 2020 2020 7375 7065  pes.        supe
+00013eb0: 7228 292e 5f73 6574 5f70 6172 616d 7328  r()._set_params(
+00013ec0: 6e65 775f 7061 7261 6d73 290a 0a20 2020  new_params)..   
+00013ed0: 2070 6172 616d 7320 3d20 7072 6f70 6572   params = proper
+00013ee0: 7479 285f 6765 745f 7061 7261 6d73 2c20  ty(_get_params, 
+00013ef0: 5f73 6574 5f70 6172 616d 7329 0a0a 2020  _set_params)..  
+00013f00: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
+00013f10: 2020 2064 6566 2067 6574 5f70 6172 616d     def get_param
+00013f20: 735f 6672 6f6d 5f64 6174 6128 636c 732c  s_from_data(cls,
+00013f30: 2064 6174 613a 2047 726f 7570 4279 5772   data: GroupByWr
+00013f40: 6170 7065 7229 3a0a 2020 2020 2020 2020  apper):.        
+00013f50: 7365 7269 6573 5f6e 616d 6520 3d20 6461  series_name = da
+00013f60: 7461 2e73 656c 6563 7469 6f6e 206f 7220  ta.selection or 
+00013f70: 6461 7461 2e6f 626a 2e6e 616d 650a 2020  data.obj.name.  
+00013f80: 2020 2020 2020 6966 2068 6173 6174 7472        if hasattr
+00013f90: 2864 6174 612e 6f62 6a2c 2022 6474 7970  (data.obj, "dtyp
+00013fa0: 6522 293a 0a20 2020 2020 2020 2020 2020  e"):.           
+00013fb0: 2064 7479 7065 203d 2064 6174 612e 6f62   dtype = data.ob
+00013fc0: 6a2e 6474 7970 650a 2020 2020 2020 2020  j.dtype.        
+00013fd0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00013fe0: 2020 6474 7970 6520 3d20 6461 7461 2e6f    dtype = data.o
+00013ff0: 626a 2e64 7479 7065 735b 7365 7269 6573  bj.dtypes[series
+00014000: 5f6e 616d 655d 0a0a 2020 2020 2020 2020  _name]..        
+00014010: 7265 7475 726e 207b 0a20 2020 2020 2020  return {.       
+00014020: 2020 2020 2022 7368 6170 6522 3a20 2864       "shape": (d
+00014030: 6174 612e 6f62 6a2e 7368 6170 655b 305d  ata.obj.shape[0]
+00014040: 2c29 2c0a 2020 2020 2020 2020 2020 2020  ,),.            
+00014050: 2264 7479 7065 223a 2064 7479 7065 2c0a  "dtype": dtype,.
+00014060: 2020 2020 2020 2020 2020 2020 2269 6e64              "ind
+00014070: 6578 5f76 616c 7565 223a 2070 6172 7365  ex_value": parse
+00014080: 5f69 6e64 6578 2864 6174 612e 6f62 6a2e  _index(data.obj.
+00014090: 696e 6465 782c 2073 746f 7265 5f64 6174  index, store_dat
+000140a0: 613d 4661 6c73 6529 2c0a 2020 2020 2020  a=False),.      
+000140b0: 2020 2020 2020 226e 616d 6522 3a20 7365        "name": se
+000140c0: 7269 6573 5f6e 616d 652c 0a20 2020 2020  ries_name,.     
+000140d0: 2020 207d 0a0a 2020 2020 6465 6620 5f5f     }..    def __
+000140e0: 696e 6974 5f5f 2873 656c 662c 206b 6579  init__(self, key
+000140f0: 5f64 7479 7065 733d 4e6f 6e65 2c20 2a2a  _dtypes=None, **
+00014100: 6b77 293a 0a20 2020 2020 2020 2073 7570  kw):.        sup
+00014110: 6572 2829 2e5f 5f69 6e69 745f 5f28 5f6b  er().__init__(_k
+00014120: 6579 5f64 7479 7065 733d 6b65 795f 6474  ey_dtypes=key_dt
+00014130: 7970 6573 2c20 2a2a 6b77 290a 0a0a 636c  ypes, **kw)...cl
+00014140: 6173 7320 5365 7269 6573 4772 6f75 7042  ass SeriesGroupB
+00014150: 7943 6875 6e6b 2843 6875 6e6b 293a 0a20  yChunk(Chunk):. 
+00014160: 2020 205f 5f73 6c6f 7473 5f5f 203d 2028     __slots__ = (
+00014170: 290a 2020 2020 5f61 6c6c 6f77 5f64 6174  ).    _allow_dat
+00014180: 615f 7479 7065 5f20 3d20 2853 6572 6965  a_type_ = (Serie
+00014190: 7347 726f 7570 4279 4368 756e 6b44 6174  sGroupByChunkDat
+000141a0: 612c 290a 2020 2020 7479 7065 5f6e 616d  a,).    type_nam
+000141b0: 6520 3d20 2253 6572 6965 7347 726f 7570  e = "SeriesGroup
+000141c0: 4279 220a 0a20 2020 2064 6566 205f 5f6c  By"..    def __l
+000141d0: 656e 5f5f 2873 656c 6629 3a0a 2020 2020  en__(self):.    
+000141e0: 2020 2020 7265 7475 726e 206c 656e 2873      return len(s
+000141f0: 656c 662e 5f64 6174 6129 0a0a 0a63 6c61  elf._data)...cla
+00014200: 7373 2044 6174 6146 7261 6d65 4772 6f75  ss DataFrameGrou
+00014210: 7042 7944 6174 6128 4261 7365 4461 7461  pByData(BaseData
+00014220: 4672 616d 6544 6174 6129 3a0a 2020 2020  FrameData):.    
+00014230: 7479 7065 5f6e 616d 6520 3d20 2244 6174  type_name = "Dat
+00014240: 6146 7261 6d65 4772 6f75 7042 7922 0a0a  aFrameGroupBy"..
+00014250: 2020 2020 5f6b 6579 5f64 7479 7065 7320      _key_dtypes 
+00014260: 3d20 5365 7269 6573 4669 656c 6428 226b  = SeriesField("k
+00014270: 6579 5f64 7479 7065 7322 290a 2020 2020  ey_dtypes").    
+00014280: 5f73 656c 6563 7469 6f6e 203d 2041 6e79  _selection = Any
+00014290: 4669 656c 6428 2273 656c 6563 7469 6f6e  Field("selection
+000142a0: 2229 0a20 2020 205f 6368 756e 6b73 203d  ").    _chunks =
+000142b0: 204c 6973 7446 6965 6c64 280a 2020 2020   ListField(.    
+000142c0: 2020 2020 2263 6875 6e6b 7322 2c0a 2020      "chunks",.  
+000142d0: 2020 2020 2020 4669 656c 6454 7970 6573        FieldTypes
+000142e0: 2e72 6566 6572 656e 6365 2844 6174 6146  .reference(DataF
+000142f0: 7261 6d65 4772 6f75 7042 7943 6875 6e6b  rameGroupByChunk
+00014300: 4461 7461 292c 0a20 2020 2020 2020 206f  Data),.        o
+00014310: 6e5f 7365 7269 616c 697a 653d 6c61 6d62  n_serialize=lamb
+00014320: 6461 2078 3a20 5b69 742e 6461 7461 2066  da x: [it.data f
+00014330: 6f72 2069 7420 696e 2078 5d20 6966 2078  or it in x] if x
+00014340: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
+00014350: 6520 782c 0a20 2020 2020 2020 206f 6e5f  e x,.        on_
+00014360: 6465 7365 7269 616c 697a 653d 6c61 6d62  deserialize=lamb
+00014370: 6461 2078 3a20 5b44 6174 6146 7261 6d65  da x: [DataFrame
+00014380: 4772 6f75 7042 7943 6875 6e6b 2869 7429  GroupByChunk(it)
+00014390: 2066 6f72 2069 7420 696e 2078 5d0a 2020   for it in x].  
+000143a0: 2020 2020 2020 6966 2078 2069 7320 6e6f        if x is no
+000143b0: 7420 4e6f 6e65 0a20 2020 2020 2020 2065  t None.        e
+000143c0: 6c73 6520 782c 0a20 2020 2029 0a0a 2020  lse x,.    )..  
+000143d0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+000143e0: 6465 6620 6b65 795f 6474 7970 6573 2873  def key_dtypes(s
+000143f0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00014400: 7475 726e 2073 656c 662e 5f6b 6579 5f64  turn self._key_d
+00014410: 7479 7065 730a 0a20 2020 2040 7072 6f70  types..    @prop
+00014420: 6572 7479 0a20 2020 2064 6566 2073 656c  erty.    def sel
+00014430: 6563 7469 6f6e 2873 656c 6629 3a0a 2020  ection(self):.  
+00014440: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00014450: 662e 5f73 656c 6563 7469 6f6e 0a0a 2020  f._selection..  
+00014460: 2020 6465 6620 5f67 6574 5f70 6172 616d    def _get_param
+00014470: 7328 7365 6c66 2920 2d3e 2044 6963 745b  s(self) -> Dict[
+00014480: 7374 722c 2041 6e79 5d3a 0a20 2020 2020  str, Any]:.     
+00014490: 2020 2070 203d 2073 7570 6572 2829 2e5f     p = super()._
+000144a0: 6765 745f 7061 7261 6d73 2829 0a20 2020  get_params().   
+000144b0: 2020 2020 2070 2e75 7064 6174 6528 6469       p.update(di
+000144c0: 6374 286b 6579 5f64 7479 7065 733d 7365  ct(key_dtypes=se
+000144d0: 6c66 2e6b 6579 5f64 7479 7065 732c 2073  lf.key_dtypes, s
+000144e0: 656c 6563 7469 6f6e 3d73 656c 662e 7365  election=self.se
+000144f0: 6c65 6374 696f 6e29 290a 2020 2020 2020  lection)).      
+00014500: 2020 7265 7475 726e 2070 0a0a 2020 2020    return p..    
+00014510: 6465 6620 5f73 6574 5f70 6172 616d 7328  def _set_params(
+00014520: 7365 6c66 2c20 6e65 775f 7061 7261 6d73  self, new_params
+00014530: 3a20 4469 6374 5b73 7472 2c20 416e 795d  : Dict[str, Any]
+00014540: 293a 0a20 2020 2020 2020 2070 6172 616d  ):.        param
+00014550: 7320 3d20 6e65 775f 7061 7261 6d73 2e63  s = new_params.c
+00014560: 6f70 7928 290a 2020 2020 2020 2020 6b65  opy().        ke
+00014570: 795f 6474 7970 6573 203d 2070 6172 616d  y_dtypes = param
+00014580: 732e 706f 7028 226b 6579 5f64 7479 7065  s.pop("key_dtype
+00014590: 7322 2c20 4e6f 6e65 290a 2020 2020 2020  s", None).      
+000145a0: 2020 6966 206b 6579 5f64 7479 7065 7320    if key_dtypes 
+000145b0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000145c0: 2020 2020 2020 2020 2073 656c 662e 5f6b           self._k
+000145d0: 6579 5f64 7479 7065 7320 3d20 6b65 795f  ey_dtypes = key_
+000145e0: 6474 7970 6573 0a20 2020 2020 2020 2073  dtypes.        s
+000145f0: 656c 6563 7469 6f6e 203d 2070 6172 616d  election = param
+00014600: 732e 706f 7028 2273 656c 6563 7469 6f6e  s.pop("selection
+00014610: 222c 204e 6f6e 6529 0a20 2020 2020 2020  ", None).       
+00014620: 2069 6620 7365 6c65 6374 696f 6e20 6973   if selection is
+00014630: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00014640: 2020 2020 2020 2073 656c 662e 5f73 656c         self._sel
+00014650: 6563 7469 6f6e 203d 2073 656c 6563 7469  ection = selecti
+00014660: 6f6e 0a20 2020 2020 2020 2073 7570 6572  on.        super
+00014670: 2829 2e5f 7365 745f 7061 7261 6d73 2870  ()._set_params(p
+00014680: 6172 616d 7329 0a0a 2020 2020 7061 7261  arams)..    para
+00014690: 6d73 203d 2070 726f 7065 7274 7928 5f67  ms = property(_g
+000146a0: 6574 5f70 6172 616d 732c 205f 7365 745f  et_params, _set_
+000146b0: 7061 7261 6d73 290a 0a20 2020 2064 6566  params)..    def
+000146c0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+000146d0: 6b65 795f 6474 7970 6573 3d4e 6f6e 652c  key_dtypes=None,
+000146e0: 2073 656c 6563 7469 6f6e 3d4e 6f6e 652c   selection=None,
+000146f0: 202a 2a6b 7729 3a0a 2020 2020 2020 2020   **kw):.        
+00014700: 7375 7065 7228 292e 5f5f 696e 6974 5f5f  super().__init__
+00014710: 285f 6b65 795f 6474 7970 6573 3d6b 6579  (_key_dtypes=key
+00014720: 5f64 7479 7065 732c 205f 7365 6c65 6374  _dtypes, _select
+00014730: 696f 6e3d 7365 6c65 6374 696f 6e2c 202a  ion=selection, *
+00014740: 2a6b 7729 0a0a 2020 2020 6465 6620 5f65  *kw)..    def _e
+00014750: 7175 616c 2873 656c 662c 206f 293a 0a20  qual(self, o):. 
+00014760: 2020 2020 2020 2023 2046 4958 4d45 2057         # FIXME W
+00014770: 6520 6e65 6564 2074 6f20 696d 706c 656d  e need to implem
+00014780: 656e 7465 6420 6120 7472 7565 2060 3d3d  ented a true `==
+00014790: 6020 6f70 6572 6174 6f72 2066 6f72 2044  ` operator for D
+000147a0: 6174 6146 7261 6d65 4772 6f75 7062 790a  ataFrameGroupby.
+000147b0: 2020 2020 2020 2020 6966 2069 735f 6275          if is_bu
+000147c0: 696c 645f 6d6f 6465 2829 3a0a 2020 2020  ild_mode():.    
+000147d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000147e0: 656c 6620 6973 206f 0a20 2020 2020 2020  elf is o.       
+000147f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00014800: 2020 2072 6574 7572 6e20 7365 6c66 203d     return self =
+00014810: 3d20 6f0a 0a0a 636c 6173 7320 5365 7269  = o...class Seri
+00014820: 6573 4772 6f75 7042 7944 6174 6128 4261  esGroupByData(Ba
+00014830: 7365 5365 7269 6573 4461 7461 293a 0a20  seSeriesData):. 
+00014840: 2020 2074 7970 655f 6e61 6d65 203d 2022     type_name = "
+00014850: 5365 7269 6573 4772 6f75 7042 7922 0a0a  SeriesGroupBy"..
+00014860: 2020 2020 5f6b 6579 5f64 7479 7065 7320      _key_dtypes 
+00014870: 3d20 416e 7946 6965 6c64 2822 6b65 795f  = AnyField("key_
+00014880: 6474 7970 6573 2229 0a20 2020 205f 6368  dtypes").    _ch
+00014890: 756e 6b73 203d 204c 6973 7446 6965 6c64  unks = ListField
+000148a0: 280a 2020 2020 2020 2020 2263 6875 6e6b  (.        "chunk
+000148b0: 7322 2c0a 2020 2020 2020 2020 4669 656c  s",.        Fiel
+000148c0: 6454 7970 6573 2e72 6566 6572 656e 6365  dTypes.reference
+000148d0: 2853 6572 6965 7347 726f 7570 4279 4368  (SeriesGroupByCh
+000148e0: 756e 6b44 6174 6129 2c0a 2020 2020 2020  unkData),.      
+000148f0: 2020 6f6e 5f73 6572 6961 6c69 7a65 3d6c    on_serialize=l
+00014900: 616d 6264 6120 783a 205b 6974 2e64 6174  ambda x: [it.dat
+00014910: 6120 666f 7220 6974 2069 6e20 785d 2069  a for it in x] i
+00014920: 6620 7820 6973 206e 6f74 204e 6f6e 6520  f x is not None 
+00014930: 656c 7365 2078 2c0a 2020 2020 2020 2020  else x,.        
+00014940: 6f6e 5f64 6573 6572 6961 6c69 7a65 3d6c  on_deserialize=l
+00014950: 616d 6264 6120 783a 205b 5365 7269 6573  ambda x: [Series
+00014960: 4772 6f75 7042 7943 6875 6e6b 2869 7429  GroupByChunk(it)
+00014970: 2066 6f72 2069 7420 696e 2078 5d0a 2020   for it in x].  
+00014980: 2020 2020 2020 6966 2078 2069 7320 6e6f        if x is no
+00014990: 7420 4e6f 6e65 0a20 2020 2020 2020 2065  t None.        e
+000149a0: 6c73 6520 782c 0a20 2020 2029 0a0a 2020  lse x,.    )..  
+000149b0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+000149c0: 6465 6620 6b65 795f 6474 7970 6573 2873  def key_dtypes(s
+000149d0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+000149e0: 7475 726e 2073 656c 662e 5f6b 6579 5f64  turn self._key_d
+000149f0: 7479 7065 730a 0a20 2020 2064 6566 205f  types..    def _
+00014a00: 6765 745f 7061 7261 6d73 2873 656c 6629  get_params(self)
+00014a10: 202d 3e20 4469 6374 5b73 7472 2c20 416e   -> Dict[str, An
+00014a20: 795d 3a0a 2020 2020 2020 2020 7020 3d20  y]:.        p = 
+00014a30: 7375 7065 7228 292e 5f67 6574 5f70 6172  super()._get_par
+00014a40: 616d 7328 290a 2020 2020 2020 2020 705b  ams().        p[
+00014a50: 226b 6579 5f64 7479 7065 7322 5d20 3d20  "key_dtypes"] = 
+00014a60: 7365 6c66 2e6b 6579 5f64 7479 7065 730a  self.key_dtypes.
+00014a70: 2020 2020 2020 2020 7265 7475 726e 2070          return p
+00014a80: 0a0a 2020 2020 6465 6620 5f73 6574 5f70  ..    def _set_p
+00014a90: 6172 616d 7328 7365 6c66 2c20 6e65 775f  arams(self, new_
+00014aa0: 7061 7261 6d73 3a20 4469 6374 5b73 7472  params: Dict[str
+00014ab0: 2c20 416e 795d 293a 0a20 2020 2020 2020  , Any]):.       
+00014ac0: 2070 6172 616d 7320 3d20 6e65 775f 7061   params = new_pa
+00014ad0: 7261 6d73 2e63 6f70 7928 290a 2020 2020  rams.copy().    
+00014ae0: 2020 2020 6b65 795f 6474 7970 6573 203d      key_dtypes =
+00014af0: 2070 6172 616d 732e 706f 7028 226b 6579   params.pop("key
+00014b00: 5f64 7479 7065 7322 2c20 4e6f 6e65 290a  _dtypes", None).
+00014b10: 2020 2020 2020 2020 6966 206b 6579 5f64          if key_d
+00014b20: 7479 7065 7320 6973 206e 6f74 204e 6f6e  types is not Non
+00014b30: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00014b40: 656c 662e 5f6b 6579 5f64 7479 7065 7320  elf._key_dtypes 
+00014b50: 3d20 6b65 795f 6474 7970 6573 0a20 2020  = key_dtypes.   
+00014b60: 2020 2020 2073 7570 6572 2829 2e5f 7365       super()._se
+00014b70: 745f 7061 7261 6d73 2870 6172 616d 7329  t_params(params)
+00014b80: 0a0a 2020 2020 7061 7261 6d73 203d 2070  ..    params = p
+00014b90: 726f 7065 7274 7928 5f67 6574 5f70 6172  roperty(_get_par
+00014ba0: 616d 732c 205f 7365 745f 7061 7261 6d73  ams, _set_params
+00014bb0: 290a 0a20 2020 2064 6566 205f 5f69 6e69  )..    def __ini
+00014bc0: 745f 5f28 7365 6c66 2c20 6b65 795f 6474  t__(self, key_dt
+00014bd0: 7970 6573 3d4e 6f6e 652c 202a 2a6b 7729  ypes=None, **kw)
+00014be0: 3a0a 2020 2020 2020 2020 7375 7065 7228  :.        super(
+00014bf0: 292e 5f5f 696e 6974 5f5f 285f 6b65 795f  ).__init__(_key_
+00014c00: 6474 7970 6573 3d6b 6579 5f64 7479 7065  dtypes=key_dtype
+00014c10: 732c 202a 2a6b 7729 0a0a 2020 2020 6465  s, **kw)..    de
+00014c20: 6620 5f65 7175 616c 2873 656c 662c 206f  f _equal(self, o
+00014c30: 293a 0a20 2020 2020 2020 2023 2046 4958  ):.        # FIX
+00014c40: 4d45 2057 6520 6e65 6564 2074 6f20 696d  ME We need to im
+00014c50: 706c 656d 656e 7465 6420 6120 7472 7565  plemented a true
+00014c60: 2060 3d3d 6020 6f70 6572 6174 6f72 2066   `==` operator f
+00014c70: 6f72 2044 6174 6146 7261 6d65 4772 6f75  or DataFrameGrou
+00014c80: 7062 790a 2020 2020 2020 2020 6966 2069  pby.        if i
+00014c90: 735f 6275 696c 645f 6d6f 6465 2829 3a0a  s_build_mode():.
+00014ca0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00014cb0: 726e 2073 656c 6620 6973 206f 0a20 2020  rn self is o.   
+00014cc0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00014cd0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00014ce0: 6c66 203d 3d20 6f0a 0a0a 636c 6173 7320  lf == o...class 
+00014cf0: 4772 6f75 7042 7928 5469 6c65 6162 6c65  GroupBy(Tileable
+00014d00: 2c20 5f54 6f50 616e 6461 734d 6978 696e  , _ToPandasMixin
+00014d10: 293a 0a20 2020 205f 5f73 6c6f 7473 5f5f  ):.    __slots__
+00014d20: 203d 2028 290a 0a0a 636c 6173 7320 4461   = ()...class Da
+00014d30: 7461 4672 616d 6547 726f 7570 4279 2847  taFrameGroupBy(G
+00014d40: 726f 7570 4279 293a 0a20 2020 205f 5f73  roupBy):.    __s
+00014d50: 6c6f 7473 5f5f 203d 2028 290a 2020 2020  lots__ = ().    
+00014d60: 5f61 6c6c 6f77 5f64 6174 615f 7479 7065  _allow_data_type
+00014d70: 5f20 3d20 2844 6174 6146 7261 6d65 4772  _ = (DataFrameGr
+00014d80: 6f75 7042 7944 6174 612c 290a 2020 2020  oupByData,).    
+00014d90: 7479 7065 5f6e 616d 6520 3d20 2244 6174  type_name = "Dat
+00014da0: 6146 7261 6d65 4772 6f75 7042 7922 0a0a  aFrameGroupBy"..
+00014db0: 2020 2020 6465 6620 5f5f 6571 5f5f 2873      def __eq__(s
+00014dc0: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
+00014dd0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00014de0: 2e5f 6571 7561 6c28 6f74 6865 7229 0a0a  ._equal(other)..
+00014df0: 2020 2020 6465 6620 5f5f 6861 7368 5f5f      def __hash__
+00014e00: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00014e10: 2320 4e42 3a20 7765 2068 6176 6520 6375  # NB: we have cu
+00014e20: 7374 6f6d 697a 6564 205f 5f65 715f 5f20  stomized __eq__ 
+00014e30: 6578 706c 6963 6974 6c79 2c20 7468 7573  explicitly, thus
+00014e40: 2077 6520 6e65 6564 2064 6566 696e 6520   we need define 
+00014e50: 5f5f 6861 7368 5f5f 2065 7870 6c69 6369  __hash__ explici
+00014e60: 746c 7920 6173 2077 656c 6c2e 0a20 2020  tly as well..   
+00014e70: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
+00014e80: 7228 292e 5f5f 6861 7368 5f5f 2829 0a0a  r().__hash__()..
+00014e90: 2020 2020 6465 6620 5f5f 6765 7461 7474      def __getatt
+00014ea0: 725f 5f28 7365 6c66 2c20 6974 656d 293a  r__(self, item):
+00014eb0: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00014ec0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00014ed0: 2073 7570 6572 2829 2e5f 5f67 6574 6174   super().__getat
+00014ee0: 7472 5f5f 2869 7465 6d29 0a20 2020 2020  tr__(item).     
+00014ef0: 2020 2065 7863 6570 7420 4174 7472 6962     except Attrib
+00014f00: 7574 6545 7272 6f72 3a0a 2020 2020 2020  uteError:.      
+00014f10: 2020 2020 2020 6966 2069 7465 6d20 696e        if item in
+00014f20: 2073 656c 662e 6474 7970 6573 3a0a 2020   self.dtypes:.  
+00014f30: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00014f40: 7475 726e 2073 656c 665b 6974 656d 5d0a  turn self[item].
+00014f50: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00014f60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014f70: 2020 7261 6973 650a 0a20 2020 2064 6566    raise..    def
+00014f80: 205f 5f64 6972 5f5f 2873 656c 6629 3a0a   __dir__(self):.
+00014f90: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+00014fa0: 206c 6973 7428 7375 7065 7228 292e 5f5f   list(super().__
+00014fb0: 6469 725f 5f28 2929 0a20 2020 2020 2020  dir__()).       
+00014fc0: 2072 6574 7572 6e20 736f 7274 6564 280a   return sorted(.
+00014fd0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00014fe0: 6c74 0a20 2020 2020 2020 2020 2020 202b  lt.            +
+00014ff0: 205b 6b20 666f 7220 6b20 696e 2073 656c   [k for k in sel
+00015000: 662e 6474 7970 6573 2e69 6e64 6578 2069  f.dtypes.index i
+00015010: 6620 6973 696e 7374 616e 6365 286b 2c20  f isinstance(k, 
+00015020: 7374 7229 2061 6e64 206b 2e69 7369 6465  str) and k.iside
+00015030: 6e74 6966 6965 7228 295d 0a20 2020 2020  ntifier()].     
+00015040: 2020 2029 0a0a 0a63 6c61 7373 2053 6572     )...class Ser
+00015050: 6965 7347 726f 7570 4279 2847 726f 7570  iesGroupBy(Group
+00015060: 4279 293a 0a20 2020 205f 5f73 6c6f 7473  By):.    __slots
+00015070: 5f5f 203d 2028 290a 2020 2020 5f61 6c6c  __ = ().    _all
+00015080: 6f77 5f64 6174 615f 7479 7065 5f20 3d20  ow_data_type_ = 
+00015090: 2853 6572 6965 7347 726f 7570 4279 4461  (SeriesGroupByDa
+000150a0: 7461 2c29 0a20 2020 2074 7970 655f 6e61  ta,).    type_na
+000150b0: 6d65 203d 2022 5365 7269 6573 4772 6f75  me = "SeriesGrou
+000150c0: 7042 7922 0a0a 2020 2020 6465 6620 5f5f  pBy"..    def __
+000150d0: 6571 5f5f 2873 656c 662c 206f 7468 6572  eq__(self, other
+000150e0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000150f0: 6e20 7365 6c66 2e5f 6571 7561 6c28 6f74  n self._equal(ot
+00015100: 6865 7229 0a0a 2020 2020 6465 6620 5f5f  her)..    def __
+00015110: 6861 7368 5f5f 2873 656c 6629 3a0a 2020  hash__(self):.  
+00015120: 2020 2020 2020 2320 4e42 3a20 7765 2068        # NB: we h
+00015130: 6176 6520 6375 7374 6f6d 697a 6564 205f  ave customized _
+00015140: 5f65 715f 5f20 6578 706c 6963 6974 6c79  _eq__ explicitly
+00015150: 2c20 7468 7573 2077 6520 6e65 6564 2064  , thus we need d
+00015160: 6566 696e 6520 5f5f 6861 7368 5f5f 2065  efine __hash__ e
+00015170: 7870 6c69 6369 746c 7920 6173 2077 656c  xplicitly as wel
+00015180: 6c2e 0a20 2020 2020 2020 2072 6574 7572  l..        retur
+00015190: 6e20 7375 7065 7228 292e 5f5f 6861 7368  n super().__hash
+000151a0: 5f5f 2829 0a0a 0a63 6c61 7373 2043 6174  __()...class Cat
+000151b0: 6567 6f72 6963 616c 4368 756e 6b44 6174  egoricalChunkDat
+000151c0: 6128 4368 756e 6b44 6174 6129 3a0a 2020  a(ChunkData):.  
+000151d0: 2020 5f5f 736c 6f74 735f 5f20 3d20 2829    __slots__ = ()
+000151e0: 0a20 2020 2074 7970 655f 6e61 6d65 203d  .    type_name =
+000151f0: 2022 4361 7465 676f 7269 6361 6c22 0a0a   "Categorical"..
+00015200: 2020 2020 2320 7265 7175 6972 6564 2066      # required f
+00015210: 6965 6c64 730a 2020 2020 5f73 6861 7065  ields.    _shape
+00015220: 203d 2054 7570 6c65 4669 656c 6428 0a20   = TupleField(. 
+00015230: 2020 2020 2020 2022 7368 6170 6522 2c0a         "shape",.
+00015240: 2020 2020 2020 2020 4669 656c 6454 7970          FieldTyp
+00015250: 6573 2e69 6e74 3634 2c0a 2020 2020 2020  es.int64,.      
+00015260: 2020 6f6e 5f73 6572 6961 6c69 7a65 3d6f    on_serialize=o
+00015270: 6e5f 7365 7269 616c 697a 655f 7368 6170  n_serialize_shap
+00015280: 652c 0a20 2020 2020 2020 206f 6e5f 6465  e,.        on_de
+00015290: 7365 7269 616c 697a 653d 6f6e 5f64 6573  serialize=on_des
+000152a0: 6572 6961 6c69 7a65 5f73 6861 7065 2c0a  erialize_shape,.
+000152b0: 2020 2020 290a 2020 2020 2320 6f70 7469      ).    # opti
+000152c0: 6f6e 616c 2066 6965 6c64 0a20 2020 205f  onal field.    _
+000152d0: 6474 7970 6520 3d20 4461 7461 5479 7065  dtype = DataType
+000152e0: 4669 656c 6428 2264 7479 7065 2229 0a20  Field("dtype"). 
+000152f0: 2020 205f 6361 7465 676f 7269 6573 5f76     _categories_v
+00015300: 616c 7565 203d 2052 6566 6572 656e 6365  alue = Reference
+00015310: 4669 656c 6428 0a20 2020 2020 2020 2022  Field(.        "
+00015320: 6361 7465 676f 7269 6573 5f76 616c 7565  categories_value
+00015330: 222c 2049 6e64 6578 5661 6c75 652c 206f  ", IndexValue, o
+00015340: 6e5f 6465 7365 7269 616c 697a 653d 5f6f  n_deserialize=_o
+00015350: 6e5f 6465 7365 7269 616c 697a 655f 696e  n_deserialize_in
+00015360: 6465 785f 7661 6c75 650a 2020 2020 290a  dex_value.    ).
+00015370: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00015380: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
+00015390: 206f 703d 4e6f 6e65 2c20 7368 6170 653d   op=None, shape=
+000153a0: 4e6f 6e65 2c20 696e 6465 783d 4e6f 6e65  None, index=None
+000153b0: 2c20 6474 7970 653d 4e6f 6e65 2c20 6361  , dtype=None, ca
+000153c0: 7465 676f 7269 6573 5f76 616c 7565 3d4e  tegories_value=N
+000153d0: 6f6e 652c 202a 2a6b 770a 2020 2020 293a  one, **kw.    ):
+000153e0: 0a20 2020 2020 2020 2073 7570 6572 2829  .        super()
+000153f0: 2e5f 5f69 6e69 745f 5f28 0a20 2020 2020  .__init__(.     
+00015400: 2020 2020 2020 205f 6f70 3d6f 702c 0a20         _op=op,. 
+00015410: 2020 2020 2020 2020 2020 205f 7368 6170             _shap
+00015420: 653d 7368 6170 652c 0a20 2020 2020 2020  e=shape,.       
+00015430: 2020 2020 205f 696e 6465 783d 696e 6465       _index=inde
+00015440: 782c 0a20 2020 2020 2020 2020 2020 205f  x,.            _
+00015450: 6474 7970 653d 6474 7970 652c 0a20 2020  dtype=dtype,.   
+00015460: 2020 2020 2020 2020 205f 6361 7465 676f           _catego
+00015470: 7269 6573 5f76 616c 7565 3d63 6174 6567  ries_value=categ
+00015480: 6f72 6965 735f 7661 6c75 652c 0a20 2020  ories_value,.   
+00015490: 2020 2020 2020 2020 202a 2a6b 772c 0a20           **kw,. 
+000154a0: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
+000154b0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+000154c0: 7061 7261 6d73 2873 656c 6629 202d 3e20  params(self) -> 
+000154d0: 4469 6374 5b73 7472 2c20 416e 795d 3a0a  Dict[str, Any]:.
+000154e0: 2020 2020 2020 2020 2320 7061 7261 6d73          # params
+000154f0: 2072 6574 7572 6e20 7468 6520 7072 6f70   return the prop
+00015500: 6572 7469 6573 2077 6869 6368 2075 7365  erties which use
+00015510: 6675 6c20 746f 2072 6562 7569 6c64 2061  ful to rebuild a
+00015520: 206e 6577 2063 6875 6e6b 0a20 2020 2020   new chunk.     
+00015530: 2020 2072 6574 7572 6e20 7b0a 2020 2020     return {.    
+00015540: 2020 2020 2020 2020 2273 6861 7065 223a          "shape":
+00015550: 2073 656c 662e 7368 6170 652c 0a20 2020   self.shape,.   
+00015560: 2020 2020 2020 2020 2022 6474 7970 6522           "dtype"
+00015570: 3a20 7365 6c66 2e64 7479 7065 2c0a 2020  : self.dtype,.  
+00015580: 2020 2020 2020 2020 2020 2269 6e64 6578            "index
+00015590: 223a 2073 656c 662e 696e 6465 782c 0a20  ": self.index,. 
+000155a0: 2020 2020 2020 2020 2020 2022 6361 7465             "cate
+000155b0: 676f 7269 6573 5f76 616c 7565 223a 2073  gories_value": s
+000155c0: 656c 662e 6361 7465 676f 7269 6573 5f76  elf.categories_v
+000155d0: 616c 7565 2c0a 2020 2020 2020 2020 7d0a  alue,.        }.
+000155e0: 0a20 2020 2040 7061 7261 6d73 2e73 6574  .    @params.set
+000155f0: 7465 720a 2020 2020 6465 6620 7061 7261  ter.    def para
+00015600: 6d73 2873 656c 662c 206e 6577 5f70 6172  ms(self, new_par
+00015610: 616d 733a 2044 6963 745b 7374 722c 2041  ams: Dict[str, A
+00015620: 6e79 5d29 3a0a 2020 2020 2020 2020 7061  ny]):.        pa
+00015630: 7261 6d73 203d 206e 6577 5f70 6172 616d  rams = new_param
+00015640: 732e 636f 7079 2829 0a20 2020 2020 2020  s.copy().       
+00015650: 2070 6172 616d 732e 706f 7028 2269 6e64   params.pop("ind
+00015660: 6578 222c 204e 6f6e 6529 2020 2320 696e  ex", None)  # in
+00015670: 6465 7820 6e6f 7420 6e65 6564 6564 2074  dex not needed t
+00015680: 6f20 7570 6461 7465 0a20 2020 2020 2020  o update.       
+00015690: 206e 6577 5f73 6861 7065 203d 2070 6172   new_shape = par
+000156a0: 616d 732e 706f 7028 2273 6861 7065 222c  ams.pop("shape",
+000156b0: 204e 6f6e 6529 0a20 2020 2020 2020 2069   None).        i
+000156c0: 6620 6e65 775f 7368 6170 6520 6973 206e  f new_shape is n
+000156d0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+000156e0: 2020 2020 2073 656c 662e 5f73 6861 7065       self._shape
+000156f0: 203d 206e 6577 5f73 6861 7065 0a20 2020   = new_shape.   
+00015700: 2020 2020 2064 7479 7065 203d 2070 6172       dtype = par
+00015710: 616d 732e 706f 7028 2264 7479 7065 222c  ams.pop("dtype",
+00015720: 204e 6f6e 6529 0a20 2020 2020 2020 2069   None).        i
+00015730: 6620 6474 7970 6520 6973 206e 6f74 204e  f dtype is not N
+00015740: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00015750: 2073 656c 662e 5f64 7479 7065 203d 2064   self._dtype = d
+00015760: 7479 7065 0a20 2020 2020 2020 2063 6174  type.        cat
+00015770: 6567 6f72 6965 735f 7661 6c75 6520 3d20  egories_value = 
+00015780: 7061 7261 6d73 2e70 6f70 2822 6361 7465  params.pop("cate
+00015790: 676f 7269 6573 5f76 616c 7565 222c 204e  gories_value", N
+000157a0: 6f6e 6529 0a20 2020 2020 2020 2069 6620  one).        if 
+000157b0: 6361 7465 676f 7269 6573 5f76 616c 7565  categories_value
+000157c0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000157d0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000157e0: 6361 7465 676f 7269 6573 5f76 616c 7565  categories_value
+000157f0: 203d 2063 6174 6567 6f72 6965 735f 7661   = categories_va
+00015800: 6c75 650a 2020 2020 2020 2020 6966 2070  lue.        if p
+00015810: 6172 616d 733a 2020 2320 7072 6167 6d61  arams:  # pragma
+00015820: 3a20 6e6f 2063 6f76 6572 0a20 2020 2020  : no cover.     
+00015830: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00015840: 6545 7272 6f72 2866 2255 6e6b 6e6f 776e  eError(f"Unknown
+00015850: 2070 6172 616d 733a 207b 6c69 7374 2870   params: {list(p
+00015860: 6172 616d 7329 7d22 290a 0a20 2020 2040  arams)}")..    @
+00015870: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
+00015880: 6465 6620 6765 745f 7061 7261 6d73 5f66  def get_params_f
+00015890: 726f 6d5f 6461 7461 2863 6c73 2c20 6461  rom_data(cls, da
+000158a0: 7461 3a20 7064 2e43 6174 6567 6f72 6963  ta: pd.Categoric
+000158b0: 616c 2920 2d3e 2044 6963 745b 7374 722c  al) -> Dict[str,
+000158c0: 2041 6e79 5d3a 0a20 2020 2020 2020 2072   Any]:.        r
+000158d0: 6574 7572 6e20 7b0a 2020 2020 2020 2020  eturn {.        
+000158e0: 2020 2020 2273 6861 7065 223a 2064 6174      "shape": dat
+000158f0: 612e 7368 6170 652c 0a20 2020 2020 2020  a.shape,.       
+00015900: 2020 2020 2022 6474 7970 6522 3a20 6461       "dtype": da
+00015910: 7461 2e64 7479 7065 2c0a 2020 2020 2020  ta.dtype,.      
+00015920: 2020 2020 2020 2263 6174 6567 6f72 6965        "categorie
+00015930: 735f 7661 6c75 6522 3a20 7061 7273 655f  s_value": parse_
+00015940: 696e 6465 7828 6461 7461 2e63 6174 6567  index(data.categ
+00015950: 6f72 6965 732c 2073 746f 7265 5f64 6174  ories, store_dat
+00015960: 613d 5472 7565 292c 0a20 2020 2020 2020  a=True),.       
+00015970: 207d 0a0a 2020 2020 4070 726f 7065 7274   }..    @propert
+00015980: 790a 2020 2020 6465 6620 7368 6170 6528  y.    def shape(
+00015990: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+000159a0: 6574 7572 6e20 6765 7461 7474 7228 7365  eturn getattr(se
+000159b0: 6c66 2c20 225f 7368 6170 6522 2c20 4e6f  lf, "_shape", No
+000159c0: 6e65 290a 0a20 2020 2040 7072 6f70 6572  ne)..    @proper
+000159d0: 7479 0a20 2020 2064 6566 206e 6469 6d28  ty.    def ndim(
+000159e0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+000159f0: 6574 7572 6e20 6c65 6e28 7365 6c66 2e73  eturn len(self.s
+00015a00: 6861 7065 290a 0a20 2020 2040 7072 6f70  hape)..    @prop
+00015a10: 6572 7479 0a20 2020 2064 6566 2064 7479  erty.    def dty
+00015a20: 7065 2873 656c 6629 3a0a 2020 2020 2020  pe(self):.      
+00015a30: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+00015a40: 7479 7065 0a0a 2020 2020 4070 726f 7065  type..    @prope
+00015a50: 7274 790a 2020 2020 6465 6620 6361 7465  rty.    def cate
+00015a60: 676f 7269 6573 5f76 616c 7565 2873 656c  gories_value(sel
+00015a70: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00015a80: 726e 2073 656c 662e 5f63 6174 6567 6f72  rn self._categor
+00015a90: 6965 735f 7661 6c75 650a 0a0a 636c 6173  ies_value...clas
+00015aa0: 7320 4361 7465 676f 7269 6361 6c43 6875  s CategoricalChu
+00015ab0: 6e6b 2843 6875 6e6b 293a 0a20 2020 205f  nk(Chunk):.    _
+00015ac0: 5f73 6c6f 7473 5f5f 203d 2028 290a 2020  _slots__ = ().  
+00015ad0: 2020 5f61 6c6c 6f77 5f64 6174 615f 7479    _allow_data_ty
+00015ae0: 7065 5f20 3d20 2843 6174 6567 6f72 6963  pe_ = (Categoric
+00015af0: 616c 4368 756e 6b44 6174 612c 290a 2020  alChunkData,).  
+00015b00: 2020 7479 7065 5f6e 616d 6520 3d20 2243    type_name = "C
+00015b10: 6174 6567 6f72 6963 616c 220a 0a0a 636c  ategorical"...cl
+00015b20: 6173 7320 4361 7465 676f 7269 6361 6c44  ass CategoricalD
+00015b30: 6174 6128 4861 7353 6861 7065 5469 6c65  ata(HasShapeTile
+00015b40: 6162 6c65 4461 7461 2c20 5f54 6f50 616e  ableData, _ToPan
+00015b50: 6461 734d 6978 696e 293a 0a20 2020 205f  dasMixin):.    _
+00015b60: 5f73 6c6f 7473 5f5f 203d 2028 225f 6361  _slots__ = ("_ca
+00015b70: 6368 6522 2c29 0a20 2020 2074 7970 655f  che",).    type_
+00015b80: 6e61 6d65 203d 2022 4361 7465 676f 7269  name = "Categori
+00015b90: 6361 6c22 0a0a 2020 2020 2320 6f70 7469  cal"..    # opti
+00015ba0: 6f6e 616c 2066 6965 6c64 0a20 2020 205f  onal field.    _
+00015bb0: 6474 7970 6520 3d20 4461 7461 5479 7065  dtype = DataType
+00015bc0: 4669 656c 6428 2264 7479 7065 2229 0a20  Field("dtype"). 
+00015bd0: 2020 205f 6361 7465 676f 7269 6573 5f76     _categories_v
+00015be0: 616c 7565 203d 2052 6566 6572 656e 6365  alue = Reference
+00015bf0: 4669 656c 6428 0a20 2020 2020 2020 2022  Field(.        "
+00015c00: 6361 7465 676f 7269 6573 5f76 616c 7565  categories_value
+00015c10: 222c 2049 6e64 6578 5661 6c75 652c 206f  ", IndexValue, o
+00015c20: 6e5f 6465 7365 7269 616c 697a 653d 5f6f  n_deserialize=_o
+00015c30: 6e5f 6465 7365 7269 616c 697a 655f 696e  n_deserialize_in
+00015c40: 6465 785f 7661 6c75 650a 2020 2020 290a  dex_value.    ).
+00015c50: 2020 2020 5f63 6875 6e6b 7320 3d20 4c69      _chunks = Li
+00015c60: 7374 4669 656c 6428 0a20 2020 2020 2020  stField(.       
+00015c70: 2022 6368 756e 6b73 222c 0a20 2020 2020   "chunks",.     
+00015c80: 2020 2046 6965 6c64 5479 7065 732e 7265     FieldTypes.re
+00015c90: 6665 7265 6e63 6528 4361 7465 676f 7269  ference(Categori
+00015ca0: 6361 6c43 6875 6e6b 4461 7461 292c 0a20  calChunkData),. 
+00015cb0: 2020 2020 2020 206f 6e5f 7365 7269 616c         on_serial
+00015cc0: 697a 653d 6c61 6d62 6461 2078 3a20 5b69  ize=lambda x: [i
+00015cd0: 742e 6461 7461 2066 6f72 2069 7420 696e  t.data for it in
+00015ce0: 2078 5d20 6966 2078 2069 7320 6e6f 7420   x] if x is not 
+00015cf0: 4e6f 6e65 2065 6c73 6520 782c 0a20 2020  None else x,.   
+00015d00: 2020 2020 206f 6e5f 6465 7365 7269 616c       on_deserial
+00015d10: 697a 653d 6c61 6d62 6461 2078 3a20 5b43  ize=lambda x: [C
+00015d20: 6174 6567 6f72 6963 616c 4368 756e 6b28  ategoricalChunk(
+00015d30: 6974 2920 666f 7220 6974 2069 6e20 785d  it) for it in x]
+00015d40: 0a20 2020 2020 2020 2069 6620 7820 6973  .        if x is
+00015d50: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
+00015d60: 2020 656c 7365 2078 2c0a 2020 2020 290a    else x,.    ).
+00015d70: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00015d80: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
+00015d90: 0a20 2020 2020 2020 206f 703d 4e6f 6e65  .        op=None
+00015da0: 2c0a 2020 2020 2020 2020 7368 6170 653d  ,.        shape=
+00015db0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e73  None,.        ns
+00015dc0: 706c 6974 733d 4e6f 6e65 2c0a 2020 2020  plits=None,.    
+00015dd0: 2020 2020 6474 7970 653d 4e6f 6e65 2c0a      dtype=None,.
+00015de0: 2020 2020 2020 2020 6361 7465 676f 7269          categori
+00015df0: 6573 5f76 616c 7565 3d4e 6f6e 652c 0a20  es_value=None,. 
+00015e00: 2020 2020 2020 2063 6875 6e6b 733d 4e6f         chunks=No
+00015e10: 6e65 2c0a 2020 2020 2020 2020 2a2a 6b77  ne,.        **kw
+00015e20: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+00015e30: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+00015e40: 5f28 0a20 2020 2020 2020 2020 2020 205f  _(.            _
+00015e50: 6f70 3d6f 702c 0a20 2020 2020 2020 2020  op=op,.         
+00015e60: 2020 205f 7368 6170 653d 7368 6170 652c     _shape=shape,
+00015e70: 0a20 2020 2020 2020 2020 2020 205f 6e73  .            _ns
+00015e80: 706c 6974 733d 6e73 706c 6974 732c 0a20  plits=nsplits,. 
+00015e90: 2020 2020 2020 2020 2020 205f 6474 7970             _dtyp
+00015ea0: 653d 6474 7970 652c 0a20 2020 2020 2020  e=dtype,.       
+00015eb0: 2020 2020 205f 6361 7465 676f 7269 6573       _categories
+00015ec0: 5f76 616c 7565 3d63 6174 6567 6f72 6965  _value=categorie
+00015ed0: 735f 7661 6c75 652c 0a20 2020 2020 2020  s_value,.       
+00015ee0: 2020 2020 205f 6368 756e 6b73 3d63 6875       _chunks=chu
+00015ef0: 6e6b 732c 0a20 2020 2020 2020 2020 2020  nks,.           
+00015f00: 202a 2a6b 772c 0a20 2020 2020 2020 2029   **kw,.        )
+00015f10: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00015f20: 2020 2020 6465 6620 7061 7261 6d73 2873      def params(s
+00015f30: 656c 6629 202d 3e20 4469 6374 5b73 7472  elf) -> Dict[str
+00015f40: 2c20 416e 795d 3a0a 2020 2020 2020 2020  , Any]:.        
+00015f50: 2320 7061 7261 6d73 2072 6574 7572 6e20  # params return 
+00015f60: 7468 6520 7072 6f70 6572 7469 6573 2077  the properties w
+00015f70: 6869 6368 2075 7365 6675 6c20 746f 2072  hich useful to r
+00015f80: 6562 7569 6c64 2061 206e 6577 2074 696c  ebuild a new til
+00015f90: 6561 626c 6520 6f62 6a65 6374 0a20 2020  eable object.   
+00015fa0: 2020 2020 2072 6574 7572 6e20 7b0a 2020       return {.  
+00015fb0: 2020 2020 2020 2020 2020 2273 6861 7065            "shape
+00015fc0: 223a 2073 656c 662e 7368 6170 652c 0a20  ": self.shape,. 
+00015fd0: 2020 2020 2020 2020 2020 2022 6474 7970             "dtyp
+00015fe0: 6522 3a20 7365 6c66 2e64 7479 7065 2c0a  e": self.dtype,.
+00015ff0: 2020 2020 2020 2020 2020 2020 2263 6174              "cat
+00016000: 6567 6f72 6965 735f 7661 6c75 6522 3a20  egories_value": 
+00016010: 7365 6c66 2e63 6174 6567 6f72 6965 735f  self.categories_
+00016020: 7661 6c75 652c 0a20 2020 2020 2020 207d  value,.        }
+00016030: 0a0a 2020 2020 4070 6172 616d 732e 7365  ..    @params.se
+00016040: 7474 6572 0a20 2020 2064 6566 2070 6172  tter.    def par
+00016050: 616d 7328 7365 6c66 2c20 6e65 775f 7061  ams(self, new_pa
+00016060: 7261 6d73 3a20 4469 6374 5b73 7472 2c20  rams: Dict[str, 
+00016070: 416e 795d 293a 0a20 2020 2020 2020 2070  Any]):.        p
+00016080: 6172 616d 7320 3d20 6e65 775f 7061 7261  arams = new_para
+00016090: 6d73 2e63 6f70 7928 290a 2020 2020 2020  ms.copy().      
+000160a0: 2020 6e65 775f 7368 6170 6520 3d20 7061    new_shape = pa
+000160b0: 7261 6d73 2e70 6f70 2822 7368 6170 6522  rams.pop("shape"
+000160c0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+000160d0: 6966 206e 6577 5f73 6861 7065 2069 7320  if new_shape is 
+000160e0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+000160f0: 2020 2020 2020 7365 6c66 2e5f 7368 6170        self._shap
+00016100: 6520 3d20 6e65 775f 7368 6170 650a 2020  e = new_shape.  
+00016110: 2020 2020 2020 6474 7970 6520 3d20 7061        dtype = pa
+00016120: 7261 6d73 2e70 6f70 2822 6474 7970 6522  rams.pop("dtype"
+00016130: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+00016140: 6966 2064 7479 7065 2069 7320 6e6f 7420  if dtype is not 
+00016150: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00016160: 2020 7365 6c66 2e5f 6474 7970 6520 3d20    self._dtype = 
+00016170: 6474 7970 650a 2020 2020 2020 2020 6361  dtype.        ca
+00016180: 7465 676f 7269 6573 5f76 616c 7565 203d  tegories_value =
+00016190: 2070 6172 616d 732e 706f 7028 2263 6174   params.pop("cat
+000161a0: 6567 6f72 6965 735f 7661 6c75 6522 2c20  egories_value", 
+000161b0: 4e6f 6e65 290a 2020 2020 2020 2020 6966  None).        if
+000161c0: 2063 6174 6567 6f72 6965 735f 7661 6c75   categories_valu
+000161d0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+000161e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000161f0: 5f63 6174 6567 6f72 6965 735f 7661 6c75  _categories_valu
+00016200: 6520 3d20 6361 7465 676f 7269 6573 5f76  e = categories_v
+00016210: 616c 7565 0a20 2020 2020 2020 2069 6620  alue.        if 
+00016220: 7061 7261 6d73 3a20 2023 2070 7261 676d  params:  # pragm
+00016230: 613a 206e 6f20 636f 7665 720a 2020 2020  a: no cover.    
+00016240: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00016250: 7065 4572 726f 7228 6622 556e 6b6e 6f77  peError(f"Unknow
+00016260: 6e20 7061 7261 6d73 3a20 7b6c 6973 7428  n params: {list(
+00016270: 7061 7261 6d73 297d 2229 0a0a 2020 2020  params)}")..    
+00016280: 6465 6620 7265 6672 6573 685f 7061 7261  def refresh_para
+00016290: 6d73 2873 656c 6629 3a0a 2020 2020 2020  ms(self):.      
+000162a0: 2020 2320 7265 6672 6573 6820 7061 7261    # refresh para
+000162b0: 6d73 2077 6865 6e20 6368 756e 6b73 2075  ms when chunks u
+000162c0: 7064 6174 6564 0a20 2020 2020 2020 2072  pdated.        r
+000162d0: 6566 7265 7368 5f74 696c 6561 626c 655f  efresh_tileable_
+000162e0: 7368 6170 6528 7365 6c66 290a 2020 2020  shape(self).    
+000162f0: 2020 2020 6966 2073 656c 662e 5f64 7479      if self._dty
+00016300: 7065 2069 7320 4e6f 6e65 3a0a 2020 2020  pe is None:.    
+00016310: 2020 2020 2020 2020 7365 6c66 2e5f 6474          self._dt
+00016320: 7970 6520 3d20 7365 6c66 2e63 6875 6e6b  ype = self.chunk
+00016330: 735b 305d 2e64 7479 7065 0a20 2020 2020  s[0].dtype.     
+00016340: 2020 2069 6620 7365 6c66 2e5f 6361 7465     if self._cate
+00016350: 676f 7269 6573 5f76 616c 7565 2069 7320  gories_value is 
+00016360: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00016370: 2020 6361 7465 676f 7269 6573 203d 205b    categories = [
+00016380: 5d0a 2020 2020 2020 2020 2020 2020 666f  ].            fo
+00016390: 7220 6368 756e 6b20 696e 2073 656c 662e  r chunk in self.
+000163a0: 6368 756e 6b73 3a0a 2020 2020 2020 2020  chunks:.        
+000163b0: 2020 2020 2020 2020 6361 7465 676f 7269          categori
+000163c0: 6573 2e65 7874 656e 6428 6368 756e 6b2e  es.extend(chunk.
+000163d0: 6361 7465 676f 7269 6573 5f76 616c 7565  categories_value
+000163e0: 2e74 6f5f 7061 6e64 6173 2829 290a 2020  .to_pandas()).  
+000163f0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00016400: 6361 7465 676f 7269 6573 5f76 616c 7565  categories_value
+00016410: 203d 2070 6172 7365 5f69 6e64 6578 280a   = parse_index(.
+00016420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016430: 7064 2e43 6174 6567 6f72 6963 616c 2863  pd.Categorical(c
+00016440: 6174 6567 6f72 6965 7329 2e63 6174 6567  ategories).categ
+00016450: 6f72 6965 732c 2073 746f 7265 5f64 6174  ories, store_dat
+00016460: 613d 5472 7565 0a20 2020 2020 2020 2020  a=True.         
+00016470: 2020 2029 0a0a 2020 2020 6465 6620 5f74     )..    def _t
+00016480: 6f5f 7374 7228 7365 6c66 2c20 7265 7072  o_str(self, repr
+00016490: 6573 656e 7461 7469 6f6e 3d46 616c 7365  esentation=False
+000164a0: 293a 0a20 2020 2020 2020 2069 6620 6973  ):.        if is
+000164b0: 5f62 7569 6c64 5f6d 6f64 6528 2920 6f72  _build_mode() or
+000164c0: 206c 656e 2873 656c 662e 5f65 7865 6375   len(self._execu
+000164d0: 7465 645f 7365 7373 696f 6e73 2920 3d3d  ted_sessions) ==
+000164e0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000164f0: 2320 696e 2062 7569 6c64 206d 6f64 652c  # in build mode,
+00016500: 206f 7220 6e6f 7420 6578 6563 7574 6564   or not executed
+00016510: 2c20 6a75 7374 2072 6574 7572 6e20 7265  , just return re
+00016520: 7072 6573 656e 7461 7469 6f6e 0a20 2020  presentation.   
+00016530: 2020 2020 2020 2020 2069 6620 7265 7072           if repr
+00016540: 6573 656e 7461 7469 6f6e 3a0a 2020 2020  esentation:.    
+00016550: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00016560: 726e 2066 227b 7365 6c66 2e74 7970 655f  rn f"{self.type_
+00016570: 6e61 6d65 7d20 3c6f 703d 7b74 7970 6528  name} <op={type(
+00016580: 7365 6c66 2e6f 7029 2e5f 5f6e 616d 655f  self.op).__name_
+00016590: 5f7d 2c20 6b65 793d 7b73 656c 662e 6b65  _}, key={self.ke
+000165a0: 797d 3e22 0a20 2020 2020 2020 2020 2020  y}>".           
+000165b0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000165c0: 2020 2020 2020 2072 6574 7572 6e20 6622         return f"
+000165d0: 7b73 656c 662e 7479 7065 5f6e 616d 657d  {self.type_name}
+000165e0: 286f 703d 7b74 7970 6528 7365 6c66 2e6f  (op={type(self.o
+000165f0: 7029 2e5f 5f6e 616d 655f 5f7d 2922 0a20  p).__name__})". 
+00016600: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00016610: 2020 2020 2020 2020 2064 6174 6120 3d20           data = 
+00016620: 7365 6c66 2e66 6574 6368 2873 6573 7369  self.fetch(sessi
+00016630: 6f6e 3d73 656c 662e 5f65 7865 6375 7465  on=self._execute
+00016640: 645f 7365 7373 696f 6e73 5b2d 315d 290a  d_sessions[-1]).
+00016650: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00016660: 726e 2072 6570 7228 6461 7461 2920 6966  rn repr(data) if
+00016670: 2072 6570 7228 6461 7461 2920 656c 7365   repr(data) else
+00016680: 2073 7472 2864 6174 6129 0a0a 2020 2020   str(data)..    
+00016690: 6465 6620 5f5f 7374 725f 5f28 7365 6c66  def __str__(self
+000166a0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000166b0: 6e20 7365 6c66 2e5f 746f 5f73 7472 2872  n self._to_str(r
+000166c0: 6570 7265 7365 6e74 6174 696f 6e3d 4661  epresentation=Fa
+000166d0: 6c73 6529 0a0a 2020 2020 6465 6620 5f5f  lse)..    def __
+000166e0: 7265 7072 5f5f 2873 656c 6629 3a0a 2020  repr__(self):.  
+000166f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00016700: 662e 5f74 6f5f 7374 7228 7265 7072 6573  f._to_str(repres
+00016710: 656e 7461 7469 6f6e 3d54 7275 6529 0a0a  entation=True)..
+00016720: 2020 2020 6465 6620 5f65 7175 616c 2873      def _equal(s
+00016730: 656c 662c 206f 293a 0a20 2020 2020 2020  elf, o):.       
+00016740: 2023 2046 4958 4d45 2057 6520 6e65 6564   # FIXME We need
+00016750: 2074 6f20 696d 706c 656d 656e 7465 6420   to implemented 
+00016760: 6120 7472 7565 2060 3d3d 6020 6f70 6572  a true `==` oper
+00016770: 6174 6f72 2066 6f72 2044 6174 6146 7261  ator for DataFra
+00016780: 6d65 4772 6f75 7062 790a 2020 2020 2020  meGroupby.      
+00016790: 2020 6966 2069 735f 6275 696c 645f 6d6f    if is_build_mo
+000167a0: 6465 2829 3a0a 2020 2020 2020 2020 2020  de():.          
+000167b0: 2020 7265 7475 726e 2073 656c 6620 6973    return self is
+000167c0: 206f 0a20 2020 2020 2020 2065 6c73 653a   o.        else:
+000167d0: 2020 2320 7072 6167 6d61 3a20 6e6f 2063    # pragma: no c
+000167e0: 6f76 6572 0a20 2020 2020 2020 2020 2020  over.           
+000167f0: 2072 6574 7572 6e20 7365 6c66 203d 3d20   return self == 
+00016800: 6f0a 0a20 2020 2040 7072 6f70 6572 7479  o..    @property
+00016810: 0a20 2020 2064 6566 2064 7479 7065 2873  .    def dtype(s
+00016820: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00016830: 7475 726e 2067 6574 6174 7472 2873 656c  turn getattr(sel
+00016840: 662c 2022 5f64 7479 7065 222c 204e 6f6e  f, "_dtype", Non
+00016850: 6529 206f 7220 7365 6c66 2e6f 702e 6474  e) or self.op.dt
+00016860: 7970 650a 0a20 2020 2040 7072 6f70 6572  ype..    @proper
+00016870: 7479 0a20 2020 2064 6566 2063 6174 6567  ty.    def categ
+00016880: 6f72 6965 735f 7661 6c75 6528 7365 6c66  ories_value(self
+00016890: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000168a0: 6e20 7365 6c66 2e5f 6361 7465 676f 7269  n self._categori
+000168b0: 6573 5f76 616c 7565 0a0a 2020 2020 6465  es_value..    de
+000168c0: 6620 5f5f 6571 5f5f 2873 656c 662c 206f  f __eq__(self, o
+000168d0: 7468 6572 293a 0a20 2020 2020 2020 2072  ther):.        r
+000168e0: 6574 7572 6e20 7365 6c66 2e5f 6571 7561  eturn self._equa
+000168f0: 6c28 6f74 6865 7229 0a0a 2020 2020 6465  l(other)..    de
+00016900: 6620 5f5f 6861 7368 5f5f 2873 656c 6629  f __hash__(self)
+00016910: 3a0a 2020 2020 2020 2020 2320 4e42 3a20  :.        # NB: 
+00016920: 7765 2068 6176 6520 6375 7374 6f6d 697a  we have customiz
+00016930: 6564 205f 5f65 715f 5f20 6578 706c 6963  ed __eq__ explic
+00016940: 6974 6c79 2c20 7468 7573 2077 6520 6e65  itly, thus we ne
+00016950: 6564 2064 6566 696e 6520 5f5f 6861 7368  ed define __hash
+00016960: 5f5f 2065 7870 6c69 6369 746c 7920 6173  __ explicitly as
+00016970: 2077 656c 6c2e 0a20 2020 2020 2020 2072   well..        r
+00016980: 6574 7572 6e20 7375 7065 7228 292e 5f5f  eturn super().__
+00016990: 6861 7368 5f5f 2829 0a0a 0a63 6c61 7373  hash__()...class
+000169a0: 2043 6174 6567 6f72 6963 616c 2848 6173   Categorical(Has
+000169b0: 5368 6170 6554 696c 6561 626c 652c 205f  ShapeTileable, _
+000169c0: 546f 5061 6e64 6173 4d69 7869 6e29 3a0a  ToPandasMixin):.
+000169d0: 2020 2020 5f5f 736c 6f74 735f 5f20 3d20      __slots__ = 
+000169e0: 2829 0a20 2020 205f 616c 6c6f 775f 6461  ().    _allow_da
+000169f0: 7461 5f74 7970 655f 203d 2028 4361 7465  ta_type_ = (Cate
+00016a00: 676f 7269 6361 6c44 6174 612c 290a 2020  goricalData,).  
+00016a10: 2020 7479 7065 5f6e 616d 6520 3d20 2243    type_name = "C
+00016a20: 6174 6567 6f72 6963 616c 220a 0a20 2020  ategorical"..   
+00016a30: 2064 6566 205f 5f6c 656e 5f5f 2873 656c   def __len__(sel
+00016a40: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00016a50: 726e 206c 656e 2873 656c 662e 5f64 6174  rn len(self._dat
+00016a60: 6129 0a0a 2020 2020 6465 6620 5f5f 6571  a)..    def __eq
+00016a70: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
+00016a80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00016a90: 7365 6c66 2e5f 6571 7561 6c28 6f74 6865  self._equal(othe
+00016aa0: 7229 0a0a 2020 2020 6465 6620 5f5f 6861  r)..    def __ha
+00016ab0: 7368 5f5f 2873 656c 6629 3a0a 2020 2020  sh__(self):.    
+00016ac0: 2020 2020 2320 4e42 3a20 7765 2068 6176      # NB: we hav
+00016ad0: 6520 6375 7374 6f6d 697a 6564 205f 5f65  e customized __e
+00016ae0: 715f 5f20 6578 706c 6963 6974 6c79 2c20  q__ explicitly, 
+00016af0: 7468 7573 2077 6520 6e65 6564 2064 6566  thus we need def
+00016b00: 696e 6520 5f5f 6861 7368 5f5f 2065 7870  ine __hash__ exp
+00016b10: 6c69 6369 746c 7920 6173 2077 656c 6c2e  licitly as well.
+00016b20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00016b30: 7375 7065 7228 292e 5f5f 6861 7368 5f5f  super().__hash__
+00016b40: 2829 0a0a 0a63 6c61 7373 2044 6174 6146  ()...class DataF
+00016b50: 7261 6d65 4f72 5365 7269 6573 4368 756e  rameOrSeriesChun
+00016b60: 6b44 6174 6128 4368 756e 6b44 6174 6129  kData(ChunkData)
+00016b70: 3a0a 2020 2020 5f5f 736c 6f74 735f 5f20  :.    __slots__ 
+00016b80: 3d20 2829 0a20 2020 2074 7970 655f 6e61  = ().    type_na
+00016b90: 6d65 203d 2022 4461 7461 4672 616d 654f  me = "DataFrameO
+00016ba0: 7253 6572 6965 7322 0a0a 2020 2020 5f63  rSeries"..    _c
+00016bb0: 6f6c 6c61 7073 655f 6178 6973 203d 2049  ollapse_axis = I
+00016bc0: 6e74 3846 6965 6c64 2822 636f 6c6c 6170  nt8Field("collap
+00016bd0: 7365 5f61 7869 7322 290a 2020 2020 5f64  se_axis").    _d
+00016be0: 6174 615f 7479 7065 203d 2053 7472 696e  ata_type = Strin
+00016bf0: 6746 6965 6c64 2822 6461 7461 5f74 7970  gField("data_typ
+00016c00: 6522 290a 2020 2020 5f64 6174 615f 7061  e").    _data_pa
+00016c10: 7261 6d73 203d 2044 6963 7446 6965 6c64  rams = DictField
+00016c20: 2822 6461 7461 5f70 6172 616d 7322 290a  ("data_params").
+00016c30: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00016c40: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
+00016c50: 0a20 2020 2020 2020 206f 703d 4e6f 6e65  .        op=None
+00016c60: 2c0a 2020 2020 2020 2020 696e 6465 783d  ,.        index=
+00016c70: 4e6f 6e65 2c0a 2020 2020 2020 2020 636f  None,.        co
+00016c80: 6c6c 6170 7365 5f61 7869 733d 4e6f 6e65  llapse_axis=None
+00016c90: 2c0a 2020 2020 2020 2020 6461 7461 5f74  ,.        data_t
+00016ca0: 7970 653d 4e6f 6e65 2c0a 2020 2020 2020  ype=None,.      
+00016cb0: 2020 6461 7461 5f70 6172 616d 733d 4e6f    data_params=No
+00016cc0: 6e65 2c0a 2020 2020 2020 2020 2a2a 6b77  ne,.        **kw
+00016cd0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+00016ce0: 2073 656c 662e 5f63 6f6c 6c61 7073 655f   self._collapse_
+00016cf0: 6178 6973 203d 2063 6f6c 6c61 7073 655f  axis = collapse_
+00016d00: 6178 6973 0a20 2020 2020 2020 2073 656c  axis.        sel
+00016d10: 662e 5f69 6e64 6578 203d 2069 6e64 6578  f._index = index
+00016d20: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
+00016d30: 6174 615f 7479 7065 203d 2064 6174 615f  ata_type = data_
+00016d40: 7479 7065 0a20 2020 2020 2020 2073 656c  type.        sel
+00016d50: 662e 5f64 6174 615f 7061 7261 6d73 203d  f._data_params =
+00016d60: 2064 6174 615f 7061 7261 6d73 206f 7220   data_params or 
+00016d70: 6469 6374 2829 0a20 2020 2020 2020 2073  dict().        s
+00016d80: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
+00016d90: 5f6f 703d 6f70 2c20 2a2a 6b77 290a 0a20  _op=op, **kw).. 
+00016da0: 2020 2064 6566 205f 5f67 6574 6174 7472     def __getattr
+00016db0: 5f5f 2873 656c 662c 2069 7465 6d29 3a0a  __(self, item):.
+00016dc0: 2020 2020 2020 2020 6966 2069 7465 6d20          if item 
+00016dd0: 696e 2073 656c 662e 5f64 6174 615f 7061  in self._data_pa
+00016de0: 7261 6d73 3a0a 2020 2020 2020 2020 2020  rams:.          
+00016df0: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+00016e00: 6174 615f 7061 7261 6d73 5b69 7465 6d5d  ata_params[item]
+00016e10: 0a20 2020 2020 2020 2072 6169 7365 2041  .        raise A
+00016e20: 7474 7269 6275 7465 4572 726f 7228 6622  ttributeError(f"
+00016e30: 277b 7479 7065 2873 656c 6629 7d27 206f  '{type(self)}' o
+00016e40: 626a 6563 7420 6861 7320 6e6f 2061 7474  bject has no att
+00016e50: 7269 6275 7465 2027 7b69 7465 6d7d 2722  ribute '{item}'"
+00016e60: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00016e70: 0a20 2020 2064 6566 206e 6469 6d28 7365  .    def ndim(se
+00016e80: 6c66 2920 2d3e 2069 6e74 3a0a 2020 2020  lf) -> int:.    
+00016e90: 2020 2020 7265 7475 726e 2028 7365 6c66      return (self
+00016ea0: 2e5f 6461 7461 5f74 7970 6520 3d3d 2022  ._data_type == "
+00016eb0: 6461 7461 6672 616d 6522 2920 2b20 310a  dataframe") + 1.
+00016ec0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00016ed0: 2020 2064 6566 2070 6172 616d 7328 7365     def params(se
+00016ee0: 6c66 2920 2d3e 2044 6963 745b 7374 722c  lf) -> Dict[str,
+00016ef0: 2041 6e79 5d3a 0a20 2020 2020 2020 2072   Any]:.        r
+00016f00: 6574 7572 6e20 7b0a 2020 2020 2020 2020  eturn {.        
+00016f10: 2020 2020 2263 6f6c 6c61 7073 655f 6178      "collapse_ax
+00016f20: 6973 223a 2073 656c 662e 5f63 6f6c 6c61  is": self._colla
+00016f30: 7073 655f 6178 6973 2c0a 2020 2020 2020  pse_axis,.      
+00016f40: 2020 2020 2020 2269 6e64 6578 223a 2073        "index": s
+00016f50: 656c 662e 5f69 6e64 6578 2c0a 2020 2020  elf._index,.    
+00016f60: 2020 2020 2020 2020 2264 6174 615f 7479          "data_ty
+00016f70: 7065 223a 2073 656c 662e 5f64 6174 615f  pe": self._data_
+00016f80: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+00016f90: 2020 2264 6174 615f 7061 7261 6d73 223a    "data_params":
+00016fa0: 2073 656c 662e 5f64 6174 615f 7061 7261   self._data_para
+00016fb0: 6d73 2c0a 2020 2020 2020 2020 7d0a 0a20  ms,.        }.. 
+00016fc0: 2020 2040 7061 7261 6d73 2e73 6574 7465     @params.sette
+00016fd0: 720a 2020 2020 6465 6620 7061 7261 6d73  r.    def params
+00016fe0: 2873 656c 662c 206e 6577 5f70 6172 616d  (self, new_param
+00016ff0: 733a 2044 6963 745b 7374 722c 2041 6e79  s: Dict[str, Any
+00017000: 5d29 3a0a 2020 2020 2020 2020 7365 6c66  ]):.        self
+00017010: 2e5f 6461 7461 5f74 7970 6520 3d20 6e65  ._data_type = ne
+00017020: 775f 7061 7261 6d73 2e67 6574 2822 6461  w_params.get("da
+00017030: 7461 5f74 7970 6522 290a 2020 2020 2020  ta_type").      
+00017040: 2020 6966 2073 656c 662e 5f63 6f6c 6c61    if self._colla
+00017050: 7073 655f 6178 6973 2069 7320 6e6f 7420  pse_axis is not 
+00017060: 4e6f 6e65 2061 6e64 2073 656c 662e 5f64  None and self._d
+00017070: 6174 615f 7479 7065 203d 3d20 2273 6572  ata_type == "ser
+00017080: 6965 7322 3a0a 2020 2020 2020 2020 2020  ies":.          
+00017090: 2020 7365 6c66 2e5f 696e 6465 7820 3d20    self._index = 
+000170a0: 2873 656c 662e 5f69 6e64 6578 5b31 202d  (self._index[1 -
+000170b0: 2073 656c 662e 5f63 6f6c 6c61 7073 655f   self._collapse_
+000170c0: 6178 6973 5d2c 290a 2020 2020 2020 2020  axis],).        
+000170d0: 6966 2073 656c 662e 5f63 6f6c 6c61 7073  if self._collaps
+000170e0: 655f 6178 6973 2069 7320 4e6f 6e65 2061  e_axis is None a
+000170f0: 6e64 2073 656c 662e 5f64 6174 615f 7479  nd self._data_ty
+00017100: 7065 203d 3d20 2264 6174 6166 7261 6d65  pe == "dataframe
+00017110: 223a 0a20 2020 2020 2020 2020 2020 2073  ":.            s
+00017120: 656c 662e 5f69 6e64 6578 203d 2028 7365  elf._index = (se
+00017130: 6c66 2e5f 696e 6465 785b 305d 2c20 3029  lf._index[0], 0)
+00017140: 0a20 2020 2020 2020 2064 6174 615f 7061  .        data_pa
+00017150: 7261 6d73 203d 206e 6577 5f70 6172 616d  rams = new_param
+00017160: 735b 2264 6174 615f 7061 7261 6d73 225d  s["data_params"]
+00017170: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00017180: 2e5f 6461 7461 5f74 7970 6520 3d3d 2022  ._data_type == "
+00017190: 6461 7461 6672 616d 6522 3a0a 2020 2020  dataframe":.    
+000171a0: 2020 2020 2020 2020 6461 7461 5f70 6172          data_par
+000171b0: 616d 735b 2264 7479 7065 7322 5d20 3d20  ams["dtypes"] = 
+000171c0: 6461 7461 5f70 6172 616d 735b 2264 7479  data_params["dty
+000171d0: 7065 735f 7661 6c75 6522 5d2e 7661 6c75  pes_value"].valu
+000171e0: 650a 2020 2020 2020 2020 2020 2020 6461  e.            da
+000171f0: 7461 5f70 6172 616d 735b 2263 6f6c 756d  ta_params["colum
+00017200: 6e73 5f76 616c 7565 225d 203d 2070 6172  ns_value"] = par
+00017210: 7365 5f69 6e64 6578 280a 2020 2020 2020  se_index(.      
+00017220: 2020 2020 2020 2020 2020 6461 7461 5f70            data_p
+00017230: 6172 616d 735b 2264 7479 7065 735f 7661  arams["dtypes_va
+00017240: 6c75 6522 5d2e 7661 6c75 652e 696e 6465  lue"].value.inde
+00017250: 782c 2073 746f 7265 5f64 6174 613d 5472  x, store_data=Tr
+00017260: 7565 0a20 2020 2020 2020 2020 2020 2029  ue.            )
+00017270: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
+00017280: 6174 615f 7061 7261 6d73 203d 207b 6b3a  ata_params = {k:
+00017290: 2076 2066 6f72 206b 2c20 7620 696e 2064   v for k, v in d
+000172a0: 6174 615f 7061 7261 6d73 2e69 7465 6d73  ata_params.items
+000172b0: 2829 7d0a 0a20 2020 2040 636c 6173 736d  ()}..    @classm
+000172c0: 6574 686f 640a 2020 2020 6465 6620 6765  ethod.    def ge
+000172d0: 745f 7061 7261 6d73 5f66 726f 6d5f 6461  t_params_from_da
+000172e0: 7461 2863 6c73 2c20 6461 7461 3a20 416e  ta(cls, data: An
+000172f0: 7929 202d 3e20 4469 6374 5b73 7472 2c20  y) -> Dict[str, 
+00017300: 416e 795d 3a0a 2020 2020 2020 2020 6966  Any]:.        if
+00017310: 2069 7369 6e73 7461 6e63 6528 6461 7461   isinstance(data
+00017320: 2c20 7064 2e44 6174 6146 7261 6d65 293a  , pd.DataFrame):
+00017330: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00017340: 7572 6e20 7b0a 2020 2020 2020 2020 2020  urn {.          
+00017350: 2020 2020 2020 2264 6174 615f 7479 7065        "data_type
+00017360: 223a 2022 6461 7461 6672 616d 6522 2c0a  ": "dataframe",.
+00017370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017380: 2264 6174 615f 7061 7261 6d73 223a 2044  "data_params": D
+00017390: 6174 6146 7261 6d65 4368 756e 6b44 6174  ataFrameChunkDat
+000173a0: 612e 6765 745f 7061 7261 6d73 5f66 726f  a.get_params_fro
+000173b0: 6d5f 6461 7461 2864 6174 6129 2c0a 2020  m_data(data),.  
+000173c0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+000173d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000173e0: 2020 2020 2020 7265 7475 726e 207b 0a20        return {. 
+000173f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00017400: 6461 7461 5f74 7970 6522 3a20 2273 6572  data_type": "ser
+00017410: 6965 7322 2c0a 2020 2020 2020 2020 2020  ies",.          
+00017420: 2020 2020 2020 2264 6174 615f 7061 7261        "data_para
+00017430: 6d73 223a 2053 6572 6965 7343 6875 6e6b  ms": SeriesChunk
+00017440: 4461 7461 2e67 6574 5f70 6172 616d 735f  Data.get_params_
+00017450: 6672 6f6d 5f64 6174 6128 6461 7461 292c  from_data(data),
+00017460: 0a20 2020 2020 2020 2020 2020 207d 0a0a  .            }..
+00017470: 0a63 6c61 7373 2044 6174 6146 7261 6d65  .class DataFrame
+00017480: 4f72 5365 7269 6573 4368 756e 6b28 4368  OrSeriesChunk(Ch
+00017490: 756e 6b29 3a0a 2020 2020 5f5f 736c 6f74  unk):.    __slot
+000174a0: 735f 5f20 3d20 2829 0a20 2020 205f 616c  s__ = ().    _al
+000174b0: 6c6f 775f 6461 7461 5f74 7970 655f 203d  low_data_type_ =
+000174c0: 2028 4461 7461 4672 616d 654f 7253 6572   (DataFrameOrSer
+000174d0: 6965 7343 6875 6e6b 4461 7461 2c29 0a20  iesChunkData,). 
+000174e0: 2020 2074 7970 655f 6e61 6d65 203d 2022     type_name = "
+000174f0: 4461 7461 4672 616d 654f 7253 6572 6965  DataFrameOrSerie
+00017500: 7322 0a0a 0a63 6c61 7373 2044 6174 6146  s"...class DataF
+00017510: 7261 6d65 4f72 5365 7269 6573 4461 7461  rameOrSeriesData
+00017520: 2848 6173 5368 6170 6554 696c 6561 626c  (HasShapeTileabl
+00017530: 6544 6174 612c 205f 546f 5061 6e64 6173  eData, _ToPandas
+00017540: 4d69 7869 6e29 3a0a 2020 2020 5f5f 736c  Mixin):.    __sl
+00017550: 6f74 735f 5f20 3d20 2829 0a20 2020 205f  ots__ = ().    _
+00017560: 6368 756e 6b73 203d 204c 6973 7446 6965  chunks = ListFie
+00017570: 6c64 280a 2020 2020 2020 2020 2263 6875  ld(.        "chu
+00017580: 6e6b 7322 2c0a 2020 2020 2020 2020 4669  nks",.        Fi
+00017590: 656c 6454 7970 6573 2e72 6566 6572 656e  eldTypes.referen
+000175a0: 6365 2844 6174 6146 7261 6d65 4f72 5365  ce(DataFrameOrSe
+000175b0: 7269 6573 4368 756e 6b44 6174 6129 2c0a  riesChunkData),.
+000175c0: 2020 2020 2020 2020 6f6e 5f73 6572 6961          on_seria
+000175d0: 6c69 7a65 3d6c 616d 6264 6120 783a 205b  lize=lambda x: [
+000175e0: 6974 2e64 6174 6120 666f 7220 6974 2069  it.data for it i
+000175f0: 6e20 785d 2069 6620 7820 6973 206e 6f74  n x] if x is not
+00017600: 204e 6f6e 6520 656c 7365 2078 2c0a 2020   None else x,.  
+00017610: 2020 2020 2020 6f6e 5f64 6573 6572 6961        on_deseria
+00017620: 6c69 7a65 3d6c 616d 6264 6120 783a 205b  lize=lambda x: [
+00017630: 4461 7461 4672 616d 654f 7253 6572 6965  DataFrameOrSerie
+00017640: 7343 6875 6e6b 2869 7429 2066 6f72 2069  sChunk(it) for i
+00017650: 7420 696e 2078 5d0a 2020 2020 2020 2020  t in x].        
+00017660: 6966 2078 2069 7320 6e6f 7420 4e6f 6e65  if x is not None
+00017670: 0a20 2020 2020 2020 2065 6c73 6520 782c  .        else x,
+00017680: 0a20 2020 2029 0a0a 2020 2020 5f64 6174  .    )..    _dat
+00017690: 615f 7479 7065 203d 2053 7472 696e 6746  a_type = StringF
+000176a0: 6965 6c64 2822 6461 7461 5f74 7970 6522  ield("data_type"
+000176b0: 290a 2020 2020 5f64 6174 615f 7061 7261  ).    _data_para
+000176c0: 6d73 203d 2044 6963 7446 6965 6c64 2822  ms = DictField("
+000176d0: 6461 7461 5f70 6172 616d 7322 290a 0a20  data_params").. 
+000176e0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+000176f0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00017700: 2020 2020 2020 206f 703d 4e6f 6e65 2c0a         op=None,.
+00017710: 2020 2020 2020 2020 6368 756e 6b73 3d4e          chunks=N
+00017720: 6f6e 652c 0a20 2020 2020 2020 2064 6174  one,.        dat
+00017730: 615f 7479 7065 3d4e 6f6e 652c 0a20 2020  a_type=None,.   
+00017740: 2020 2020 2064 6174 615f 7061 7261 6d73       data_params
+00017750: 3d4e 6f6e 652c 0a20 2020 2020 2020 202a  =None,.        *
+00017760: 2a6b 772c 0a20 2020 2029 3a0a 2020 2020  *kw,.    ):.    
+00017770: 2020 2020 7365 6c66 2e5f 6461 7461 5f74      self._data_t
+00017780: 7970 6520 3d20 6461 7461 5f74 7970 650a  ype = data_type.
+00017790: 2020 2020 2020 2020 7365 6c66 2e5f 6461          self._da
+000177a0: 7461 5f70 6172 616d 7320 3d20 6461 7461  ta_params = data
+000177b0: 5f70 6172 616d 7320 6f72 2064 6963 7428  _params or dict(
+000177c0: 290a 2020 2020 2020 2020 7375 7065 7228  ).        super(
+000177d0: 292e 5f5f 696e 6974 5f5f 280a 2020 2020  ).__init__(.    
+000177e0: 2020 2020 2020 2020 5f6f 703d 6f70 2c0a          _op=op,.
+000177f0: 2020 2020 2020 2020 2020 2020 5f63 6875              _chu
+00017800: 6e6b 733d 6368 756e 6b73 2c0a 2020 2020  nks=chunks,.    
+00017810: 2020 2020 2020 2020 2a2a 6b77 2c0a 2020          **kw,.  
+00017820: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+00017830: 205f 5f67 6574 6174 7472 5f5f 2873 656c   __getattr__(sel
+00017840: 662c 2069 7465 6d29 3a0a 2020 2020 2020  f, item):.      
+00017850: 2020 6966 2069 7465 6d20 696e 2073 656c    if item in sel
+00017860: 662e 5f64 6174 615f 7061 7261 6d73 3a0a  f._data_params:.
+00017870: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00017880: 726e 2073 656c 662e 5f64 6174 615f 7061  rn self._data_pa
+00017890: 7261 6d73 5b69 7465 6d5d 0a20 2020 2020  rams[item].     
+000178a0: 2020 2072 6169 7365 2041 7474 7269 6275     raise Attribu
+000178b0: 7465 4572 726f 7228 6622 277b 7479 7065  teError(f"'{type
+000178c0: 2873 656c 6629 7d27 206f 626a 6563 7420  (self)}' object 
+000178d0: 6861 7320 6e6f 2061 7474 7269 6275 7465  has no attribute
+000178e0: 2027 7b69 7465 6d7d 2722 290a 0a20 2020   '{item}'")..   
+000178f0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00017900: 6566 2073 6861 7065 2873 656c 6629 3a0a  ef shape(self):.
+00017910: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00017920: 656c 662e 5f64 6174 615f 7061 7261 6d73  elf._data_params
+00017930: 2e67 6574 2822 7368 6170 6522 2c20 4e6f  .get("shape", No
+00017940: 6e65 290a 0a20 2020 2040 7072 6f70 6572  ne)..    @proper
+00017950: 7479 0a20 2020 2064 6566 206e 7370 6c69  ty.    def nspli
+00017960: 7473 2873 656c 6629 3a0a 2020 2020 2020  ts(self):.      
+00017970: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+00017980: 6174 615f 7061 7261 6d73 2e67 6574 2822  ata_params.get("
+00017990: 6e73 706c 6974 7322 2c20 4e6f 6e65 290a  nsplits", None).
+000179a0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+000179b0: 2020 2064 6566 2064 6174 615f 7479 7065     def data_type
+000179c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000179d0: 7265 7475 726e 2073 656c 662e 5f64 6174  return self._dat
+000179e0: 615f 7479 7065 0a0a 2020 2020 4070 726f  a_type..    @pro
+000179f0: 7065 7274 790a 2020 2020 6465 6620 6461  perty.    def da
+00017a00: 7461 5f70 6172 616d 7328 7365 6c66 293a  ta_params(self):
+00017a10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00017a20: 7365 6c66 2e5f 6461 7461 5f70 6172 616d  self._data_param
+00017a30: 730a 0a20 2020 2040 7072 6f70 6572 7479  s..    @property
+00017a40: 0a20 2020 2064 6566 2070 6172 616d 7328  .    def params(
+00017a50: 7365 6c66 2920 2d3e 2044 6963 745b 7374  self) -> Dict[st
+00017a60: 722c 2041 6e79 5d3a 0a20 2020 2020 2020  r, Any]:.       
+00017a70: 2072 6574 7572 6e20 7b22 6461 7461 5f74   return {"data_t
+00017a80: 7970 6522 3a20 7365 6c66 2e5f 6461 7461  ype": self._data
+00017a90: 5f74 7970 652c 2022 6461 7461 5f70 6172  _type, "data_par
+00017aa0: 616d 7322 3a20 7365 6c66 2e5f 6461 7461  ams": self._data
+00017ab0: 5f70 6172 616d 737d 0a0a 2020 2020 4070  _params}..    @p
+00017ac0: 6172 616d 732e 7365 7474 6572 0a20 2020  arams.setter.   
+00017ad0: 2064 6566 2070 6172 616d 7328 7365 6c66   def params(self
+00017ae0: 2c20 6e65 775f 7061 7261 6d73 3a20 4469  , new_params: Di
+00017af0: 6374 5b73 7472 2c20 416e 795d 293a 0a20  ct[str, Any]):. 
+00017b00: 2020 2020 2020 2023 2041 6674 6572 2065         # After e
+00017b10: 7865 6375 7469 6f6e 2c20 6372 6561 7465  xecution, create
+00017b20: 2044 6174 6146 7261 6d65 4665 7463 682c   DataFrameFetch,
+00017b30: 2061 6e64 2074 6865 2064 6174 610a 2020   and the data.  
+00017b40: 2020 2020 2020 2320 636f 7272 6573 706f        # correspo
+00017b50: 6e64 696e 6720 746f 2074 6865 206f 7269  nding to the ori
+00017b60: 6769 6e61 6c20 6b65 7920 6973 2073 7469  ginal key is sti
+00017b70: 6c6c 2044 6174 6146 7261 6d65 4f72 5365  ll DataFrameOrSe
+00017b80: 7269 6573 2074 7970 652c 0a20 2020 2020  ries type,.     
+00017b90: 2020 2023 2073 6f20 7768 656e 2072 6573     # so when res
+00017ba0: 746f 7269 6e67 2044 6174 6146 7261 6d65  toring DataFrame
+00017bb0: 4f72 5365 7269 6573 2074 7970 652c 0a20  OrSeries type,. 
+00017bc0: 2020 2020 2020 2023 2074 6865 7265 2069         # there i
+00017bd0: 7320 6e6f 2022 6461 7461 5f74 7970 6522  s no "data_type"
+00017be0: 2066 6965 6c64 2069 6e20 7061 7261 6d73   field in params
+00017bf0: 2e0a 2020 2020 2020 2020 6966 2022 6461  ..        if "da
+00017c00: 7461 5f74 7970 6522 206e 6f74 2069 6e20  ta_type" not in 
+00017c10: 6e65 775f 7061 7261 6d73 3a0a 2020 2020  new_params:.    
+00017c20: 2020 2020 2020 2020 6966 2022 6474 7970          if "dtyp
+00017c30: 6522 2069 6e20 6e65 775f 7061 7261 6d73  e" in new_params
+00017c40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00017c50: 2020 7365 6c66 2e5f 6461 7461 5f74 7970    self._data_typ
+00017c60: 6520 3d20 2273 6572 6965 7322 0a20 2020  e = "series".   
+00017c70: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00017c80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00017c90: 656c 662e 5f64 6174 615f 7479 7065 203d  elf._data_type =
+00017ca0: 2022 6461 7461 6672 616d 6522 0a20 2020   "dataframe".   
+00017cb0: 2020 2020 2020 2020 2073 656c 662e 5f64           self._d
+00017cc0: 6174 615f 7061 7261 6d73 203d 206e 6577  ata_params = new
+00017cd0: 5f70 6172 616d 732e 636f 7079 2829 0a20  _params.copy(). 
+00017ce0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00017cf0: 2020 2020 2020 2020 2073 656c 662e 5f64           self._d
+00017d00: 6174 615f 7479 7065 203d 206e 6577 5f70  ata_type = new_p
+00017d10: 6172 616d 732e 6765 7428 2264 6174 615f  arams.get("data_
+00017d20: 7479 7065 2229 0a20 2020 2020 2020 2020  type").         
+00017d30: 2020 2073 656c 662e 5f64 6174 615f 7061     self._data_pa
+00017d40: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+00017d50: 2020 2020 2020 2020 206b 3a20 7620 666f           k: v fo
+00017d60: 7220 6b2c 2076 2069 6e20 6e65 775f 7061  r k, v in new_pa
+00017d70: 7261 6d73 2e67 6574 2822 6461 7461 5f70  rams.get("data_p
+00017d80: 6172 616d 7322 2c20 7b7d 292e 6974 656d  arams", {}).item
+00017d90: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+00017da0: 7d0a 0a20 2020 2064 6566 2072 6566 7265  }..    def refre
+00017db0: 7368 5f70 6172 616d 7328 7365 6c66 293a  sh_params(self):
+00017dc0: 0a20 2020 2020 2020 2069 6e64 6578 5f74  .        index_t
+00017dd0: 6f5f 696e 6465 785f 7661 6c75 6573 203d  o_index_values =
+00017de0: 2064 6963 7428 290a 2020 2020 2020 2020   dict().        
+00017df0: 666f 7220 6368 756e 6b20 696e 2073 656c  for chunk in sel
+00017e00: 662e 6368 756e 6b73 3a0a 2020 2020 2020  f.chunks:.      
+00017e10: 2020 2020 2020 6966 2063 6875 6e6b 2e6e        if chunk.n
+00017e20: 6469 6d20 3d3d 2031 3a0a 2020 2020 2020  dim == 1:.      
+00017e30: 2020 2020 2020 2020 2020 696e 6465 785f            index_
+00017e40: 746f 5f69 6e64 6578 5f76 616c 7565 735b  to_index_values[
+00017e50: 6368 756e 6b2e 696e 6465 785d 203d 2063  chunk.index] = c
+00017e60: 6875 6e6b 2e69 6e64 6578 5f76 616c 7565  hunk.index_value
+00017e70: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00017e80: 6620 6368 756e 6b2e 696e 6465 785b 315d  f chunk.index[1]
+00017e90: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00017ea0: 2020 2020 2020 2069 6e64 6578 5f74 6f5f         index_to_
+00017eb0: 696e 6465 785f 7661 6c75 6573 5b63 6875  index_values[chu
+00017ec0: 6e6b 2e69 6e64 6578 5d20 3d20 6368 756e  nk.index] = chun
+00017ed0: 6b2e 696e 6465 785f 7661 6c75 650a 2020  k.index_value.  
+00017ee0: 2020 2020 2020 696e 6465 785f 7661 6c75        index_valu
+00017ef0: 6520 3d20 6d65 7267 655f 696e 6465 785f  e = merge_index_
+00017f00: 7661 6c75 6528 696e 6465 785f 746f 5f69  value(index_to_i
+00017f10: 6e64 6578 5f76 616c 7565 732c 2073 746f  ndex_values, sto
+00017f20: 7265 5f64 6174 613d 4661 6c73 6529 0a20  re_data=False). 
+00017f30: 2020 2020 2020 206e 7370 6c69 7473 203d         nsplits =
+00017f40: 2063 616c 635f 6e73 706c 6974 7328 7b63   calc_nsplits({c
+00017f50: 2e69 6e64 6578 3a20 632e 7368 6170 6520  .index: c.shape 
+00017f60: 666f 7220 6320 696e 2073 656c 662e 6368  for c in self.ch
+00017f70: 756e 6b73 7d29 0a20 2020 2020 2020 2073  unks}).        s
+00017f80: 6861 7065 203d 2074 7570 6c65 2873 756d  hape = tuple(sum
+00017f90: 286e 7329 2066 6f72 206e 7320 696e 206e  (ns) for ns in n
+00017fa0: 7370 6c69 7473 290a 0a20 2020 2020 2020  splits)..       
+00017fb0: 2064 6174 615f 7061 7261 6d73 203d 2064   data_params = d
+00017fc0: 6963 7428 290a 2020 2020 2020 2020 6461  ict().        da
+00017fd0: 7461 5f70 6172 616d 735b 226e 7370 6c69  ta_params["nspli
+00017fe0: 7473 225d 203d 206e 7370 6c69 7473 0a20  ts"] = nsplits. 
+00017ff0: 2020 2020 2020 2064 6174 615f 7061 7261         data_para
+00018000: 6d73 5b22 7368 6170 6522 5d20 3d20 7368  ms["shape"] = sh
+00018010: 6170 650a 2020 2020 2020 2020 6461 7461  ape.        data
+00018020: 5f70 6172 616d 735b 2269 6e64 6578 5f76  _params["index_v
+00018030: 616c 7565 225d 203d 2069 6e64 6578 5f76  alue"] = index_v
+00018040: 616c 7565 0a0a 2020 2020 2020 2020 7365  alue..        se
+00018050: 6c66 2e5f 6461 7461 5f74 7970 6520 3d20  lf._data_type = 
+00018060: 7365 6c66 2e5f 6368 756e 6b73 5b30 5d2e  self._chunks[0].
+00018070: 5f64 6174 615f 7479 7065 0a20 2020 2020  _data_type.     
+00018080: 2020 2069 6620 7365 6c66 2e64 6174 615f     if self.data_
+00018090: 7479 7065 203d 3d20 2264 6174 6166 7261  type == "datafra
+000180a0: 6d65 223a 0a20 2020 2020 2020 2020 2020  me":.           
+000180b0: 2061 6c6c 5f64 7479 7065 7320 3d20 5b63   all_dtypes = [c
+000180c0: 2e64 7479 7065 735f 7661 6c75 652e 7661  .dtypes_value.va
+000180d0: 6c75 6520 666f 7220 6320 696e 2073 656c  lue for c in sel
+000180e0: 662e 6368 756e 6b73 2069 6620 632e 696e  f.chunks if c.in
+000180f0: 6465 785b 305d 203d 3d20 305d 0a20 2020  dex[0] == 0].   
+00018100: 2020 2020 2020 2020 2064 7479 7065 7320           dtypes 
+00018110: 3d20 7064 2e63 6f6e 6361 7428 616c 6c5f  = pd.concat(all_
+00018120: 6474 7970 6573 290a 2020 2020 2020 2020  dtypes).        
+00018130: 2020 2020 6461 7461 5f70 6172 616d 735b      data_params[
+00018140: 2264 7479 7065 7322 5d20 3d20 6474 7970  "dtypes"] = dtyp
+00018150: 6573 0a20 2020 2020 2020 2020 2020 2063  es.            c
+00018160: 6f6c 756d 6e73 5f76 616c 7565 7320 3d20  olumns_values = 
+00018170: 7061 7273 655f 696e 6465 7828 6474 7970  parse_index(dtyp
+00018180: 6573 2e69 6e64 6578 2c20 7374 6f72 655f  es.index, store_
+00018190: 6461 7461 3d54 7275 6529 0a20 2020 2020  data=True).     
+000181a0: 2020 2020 2020 2064 6174 615f 7061 7261         data_para
+000181b0: 6d73 5b22 636f 6c75 6d6e 735f 7661 6c75  ms["columns_valu
+000181c0: 6522 5d20 3d20 636f 6c75 6d6e 735f 7661  e"] = columns_va
+000181d0: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
+000181e0: 2064 6174 615f 7061 7261 6d73 5b22 6474   data_params["dt
+000181f0: 7970 6573 5f76 616c 7565 225d 203d 2044  ypes_value"] = D
+00018200: 7479 7065 7356 616c 7565 280a 2020 2020  typesValue(.    
+00018210: 2020 2020 2020 2020 2020 2020 6b65 793d              key=
+00018220: 746f 6b65 6e69 7a65 2864 7479 7065 7329  tokenize(dtypes)
+00018230: 2c20 7661 6c75 653d 6474 7970 6573 0a20  , value=dtypes. 
+00018240: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00018250: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00018260: 2020 2020 2020 2064 6174 615f 7061 7261         data_para
+00018270: 6d73 5b22 6474 7970 6522 5d20 3d20 7365  ms["dtype"] = se
+00018280: 6c66 2e63 6875 6e6b 735b 305d 2e64 7479  lf.chunks[0].dty
+00018290: 7065 0a20 2020 2020 2020 2020 2020 2064  pe.            d
+000182a0: 6174 615f 7061 7261 6d73 5b22 6e61 6d65  ata_params["name
+000182b0: 225d 203d 2073 656c 662e 6368 756e 6b73  "] = self.chunks
+000182c0: 5b30 5d2e 6e61 6d65 0a20 2020 2020 2020  [0].name.       
+000182d0: 2073 656c 662e 5f64 6174 615f 7061 7261   self._data_para
+000182e0: 6d73 2e75 7064 6174 6528 6461 7461 5f70  ms.update(data_p
+000182f0: 6172 616d 7329 0a0a 2020 2020 6465 6620  arams)..    def 
+00018300: 656e 7375 7265 5f64 6174 6128 7365 6c66  ensure_data(self
+00018310: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
+00018320: 2e66 6574 6368 2e63 6f72 6520 696d 706f  .fetch.core impo
+00018330: 7274 2044 6174 6146 7261 6d65 4665 7463  rt DataFrameFetc
+00018340: 680a 0a20 2020 2020 2020 2073 656c 662e  h..        self.
+00018350: 6578 6563 7574 6528 290a 2020 2020 2020  execute().      
+00018360: 2020 6465 6661 756c 745f 7365 7373 203d    default_sess =
+00018370: 2067 6574 5f64 6566 6175 6c74 5f73 6573   get_default_ses
+00018380: 7369 6f6e 2829 0a20 2020 2020 2020 2073  sion().        s
+00018390: 656c 662e 5f64 6574 6163 685f 7365 7373  elf._detach_sess
+000183a0: 696f 6e28 6465 6661 756c 745f 7365 7373  ion(default_sess
+000183b0: 2e5f 7365 7373 696f 6e29 0a0a 2020 2020  ._session)..    
+000183c0: 2020 2020 6665 7463 685f 7469 6c65 6162      fetch_tileab
+000183d0: 6c65 203d 2064 6566 6175 6c74 5f73 6573  le = default_ses
+000183e0: 732e 5f73 6573 7369 6f6e 2e5f 7469 6c65  s._session._tile
+000183f0: 6162 6c65 5f74 6f5f 6665 7463 685b 7365  able_to_fetch[se
+00018400: 6c66 5d0a 2020 2020 2020 2020 6e65 7720  lf].        new 
+00018410: 3d20 4461 7461 4672 616d 6546 6574 6368  = DataFrameFetch
+00018420: 280a 2020 2020 2020 2020 2020 2020 6f75  (.            ou
+00018430: 7470 7574 5f74 7970 6573 3d5b 6765 7461  tput_types=[geta
+00018440: 7474 7228 4f75 7470 7574 5479 7065 2c20  ttr(OutputType, 
+00018450: 7365 6c66 2e64 6174 615f 7479 7065 295d  self.data_type)]
+00018460: 0a20 2020 2020 2020 2029 2e6e 6577 5f74  .        ).new_t
+00018470: 696c 6561 626c 6528 0a20 2020 2020 2020  ileable(.       
+00018480: 2020 2020 205b 5d2c 0a20 2020 2020 2020       [],.       
+00018490: 2020 2020 205f 6b65 793d 7365 6c66 2e6b       _key=self.k
+000184a0: 6579 2c0a 2020 2020 2020 2020 2020 2020  ey,.            
+000184b0: 6368 756e 6b73 3d66 6574 6368 5f74 696c  chunks=fetch_til
+000184c0: 6561 626c 652e 6368 756e 6b73 2c0a 2020  eable.chunks,.  
+000184d0: 2020 2020 2020 2020 2020 6e73 706c 6974            nsplit
+000184e0: 733d 6665 7463 685f 7469 6c65 6162 6c65  s=fetch_tileable
+000184f0: 2e6e 7370 6c69 7473 2c0a 2020 2020 2020  .nsplits,.      
+00018500: 2020 2020 2020 2a2a 7365 6c66 2e64 6174        **self.dat
+00018510: 615f 7061 7261 6d73 2c0a 2020 2020 2020  a_params,.      
+00018520: 2020 290a 2020 2020 2020 2020 6e65 772e    ).        new.
+00018530: 5f61 7474 6163 685f 7365 7373 696f 6e28  _attach_session(
+00018540: 6465 6661 756c 745f 7365 7373 2e5f 7365  default_sess._se
+00018550: 7373 696f 6e29 0a20 2020 2020 2020 2072  ssion).        r
+00018560: 6574 7572 6e20 6e65 770a 0a0a 636c 6173  eturn new...clas
+00018570: 7320 4461 7461 4672 616d 654f 7253 6572  s DataFrameOrSer
+00018580: 6965 7328 4861 7353 6861 7065 5469 6c65  ies(HasShapeTile
+00018590: 6162 6c65 2c20 5f54 6f50 616e 6461 734d  able, _ToPandasM
+000185a0: 6978 696e 293a 0a20 2020 205f 5f73 6c6f  ixin):.    __slo
+000185b0: 7473 5f5f 203d 2028 290a 2020 2020 5f61  ts__ = ().    _a
+000185c0: 6c6c 6f77 5f64 6174 615f 7479 7065 5f20  llow_data_type_ 
+000185d0: 3d20 2844 6174 6146 7261 6d65 4f72 5365  = (DataFrameOrSe
+000185e0: 7269 6573 4461 7461 2c29 0a20 2020 2074  riesData,).    t
+000185f0: 7970 655f 6e61 6d65 203d 2022 4461 7461  ype_name = "Data
+00018600: 4672 616d 654f 7253 6572 6965 7322 0a0a  FrameOrSeries"..
+00018610: 0a49 4e44 4558 5f54 5950 4520 3d20 2849  .INDEX_TYPE = (I
+00018620: 6e64 6578 2c20 496e 6465 7844 6174 6129  ndex, IndexData)
+00018630: 0a49 4e44 4558 5f43 4855 4e4b 5f54 5950  .INDEX_CHUNK_TYP
+00018640: 4520 3d20 2849 6e64 6578 4368 756e 6b2c  E = (IndexChunk,
+00018650: 2049 6e64 6578 4368 756e 6b44 6174 6129   IndexChunkData)
+00018660: 0a53 4552 4945 535f 5459 5045 203d 2028  .SERIES_TYPE = (
+00018670: 5365 7269 6573 2c20 5365 7269 6573 4461  Series, SeriesDa
+00018680: 7461 290a 5345 5249 4553 5f43 4855 4e4b  ta).SERIES_CHUNK
+00018690: 5f54 5950 4520 3d20 2853 6572 6965 7343  _TYPE = (SeriesC
+000186a0: 6875 6e6b 2c20 5365 7269 6573 4368 756e  hunk, SeriesChun
+000186b0: 6b44 6174 6129 0a44 4154 4146 5241 4d45  kData).DATAFRAME
+000186c0: 5f4f 525f 5345 5249 4553 5f54 5950 4520  _OR_SERIES_TYPE 
+000186d0: 3d20 2844 6174 6146 7261 6d65 4f72 5365  = (DataFrameOrSe
+000186e0: 7269 6573 2c20 4461 7461 4672 616d 654f  ries, DataFrameO
+000186f0: 7253 6572 6965 7344 6174 6129 0a44 4154  rSeriesData).DAT
+00018700: 4146 5241 4d45 5f4f 525f 5345 5249 4553  AFRAME_OR_SERIES
+00018710: 5f43 4855 4e4b 5f54 5950 4520 3d20 2844  _CHUNK_TYPE = (D
+00018720: 6174 6146 7261 6d65 4f72 5365 7269 6573  ataFrameOrSeries
+00018730: 4368 756e 6b2c 2044 6174 6146 7261 6d65  Chunk, DataFrame
+00018740: 4f72 5365 7269 6573 4368 756e 6b44 6174  OrSeriesChunkDat
+00018750: 6129 0a44 4154 4146 5241 4d45 5f54 5950  a).DATAFRAME_TYP
+00018760: 4520 3d20 2844 6174 6146 7261 6d65 2c20  E = (DataFrame, 
+00018770: 4461 7461 4672 616d 6544 6174 6129 0a44  DataFrameData).D
+00018780: 4154 4146 5241 4d45 5f43 4855 4e4b 5f54  ATAFRAME_CHUNK_T
+00018790: 5950 4520 3d20 2844 6174 6146 7261 6d65  YPE = (DataFrame
+000187a0: 4368 756e 6b2c 2044 6174 6146 7261 6d65  Chunk, DataFrame
+000187b0: 4368 756e 6b44 6174 6129 0a44 4154 4146  ChunkData).DATAF
+000187c0: 5241 4d45 5f47 524f 5550 4259 5f54 5950  RAME_GROUPBY_TYP
+000187d0: 4520 3d20 2844 6174 6146 7261 6d65 4772  E = (DataFrameGr
+000187e0: 6f75 7042 792c 2044 6174 6146 7261 6d65  oupBy, DataFrame
+000187f0: 4772 6f75 7042 7944 6174 6129 0a44 4154  GroupByData).DAT
+00018800: 4146 5241 4d45 5f47 524f 5550 4259 5f43  AFRAME_GROUPBY_C
+00018810: 4855 4e4b 5f54 5950 4520 3d20 2844 6174  HUNK_TYPE = (Dat
+00018820: 6146 7261 6d65 4772 6f75 7042 7943 6875  aFrameGroupByChu
+00018830: 6e6b 2c20 4461 7461 4672 616d 6547 726f  nk, DataFrameGro
+00018840: 7570 4279 4368 756e 6b44 6174 6129 0a53  upByChunkData).S
+00018850: 4552 4945 535f 4752 4f55 5042 595f 5459  ERIES_GROUPBY_TY
+00018860: 5045 203d 2028 5365 7269 6573 4772 6f75  PE = (SeriesGrou
+00018870: 7042 792c 2053 6572 6965 7347 726f 7570  pBy, SeriesGroup
+00018880: 4279 4461 7461 290a 5345 5249 4553 5f47  ByData).SERIES_G
+00018890: 524f 5550 4259 5f43 4855 4e4b 5f54 5950  ROUPBY_CHUNK_TYP
+000188a0: 4520 3d20 2853 6572 6965 7347 726f 7570  E = (SeriesGroup
+000188b0: 4279 4368 756e 6b2c 2053 6572 6965 7347  ByChunk, SeriesG
+000188c0: 726f 7570 4279 4368 756e 6b44 6174 6129  roupByChunkData)
+000188d0: 0a47 524f 5550 4259 5f54 5950 4520 3d20  .GROUPBY_TYPE = 
+000188e0: 2847 726f 7570 4279 2c29 202b 2044 4154  (GroupBy,) + DAT
+000188f0: 4146 5241 4d45 5f47 524f 5550 4259 5f54  AFRAME_GROUPBY_T
+00018900: 5950 4520 2b20 5345 5249 4553 5f47 524f  YPE + SERIES_GRO
+00018910: 5550 4259 5f54 5950 450a 4752 4f55 5042  UPBY_TYPE.GROUPB
+00018920: 595f 4348 554e 4b5f 5459 5045 203d 2044  Y_CHUNK_TYPE = D
+00018930: 4154 4146 5241 4d45 5f47 524f 5550 4259  ATAFRAME_GROUPBY
+00018940: 5f43 4855 4e4b 5f54 5950 4520 2b20 5345  _CHUNK_TYPE + SE
+00018950: 5249 4553 5f47 524f 5550 4259 5f43 4855  RIES_GROUPBY_CHU
+00018960: 4e4b 5f54 5950 450a 4341 5445 474f 5249  NK_TYPE.CATEGORI
+00018970: 4341 4c5f 5459 5045 203d 2028 4361 7465  CAL_TYPE = (Cate
+00018980: 676f 7269 6361 6c2c 2043 6174 6567 6f72  gorical, Categor
+00018990: 6963 616c 4461 7461 290a 4341 5445 474f  icalData).CATEGO
+000189a0: 5249 4341 4c5f 4348 554e 4b5f 5459 5045  RICAL_CHUNK_TYPE
+000189b0: 203d 2028 4361 7465 676f 7269 6361 6c43   = (CategoricalC
+000189c0: 6875 6e6b 2c20 4361 7465 676f 7269 6361  hunk, Categorica
+000189d0: 6c43 6875 6e6b 4461 7461 290a 5449 4c45  lChunkData).TILE
+000189e0: 4142 4c45 5f54 5950 4520 3d20 280a 2020  ABLE_TYPE = (.  
+000189f0: 2020 494e 4445 585f 5459 5045 202b 2053    INDEX_TYPE + S
+00018a00: 4552 4945 535f 5459 5045 202b 2044 4154  ERIES_TYPE + DAT
+00018a10: 4146 5241 4d45 5f54 5950 4520 2b20 4752  AFRAME_TYPE + GR
+00018a20: 4f55 5042 595f 5459 5045 202b 2043 4154  OUPBY_TYPE + CAT
+00018a30: 4547 4f52 4943 414c 5f54 5950 450a 290a  EGORICAL_TYPE.).
+00018a40: 4348 554e 4b5f 5459 5045 203d 2028 0a20  CHUNK_TYPE = (. 
+00018a50: 2020 2049 4e44 4558 5f43 4855 4e4b 5f54     INDEX_CHUNK_T
+00018a60: 5950 450a 2020 2020 2b20 5345 5249 4553  YPE.    + SERIES
+00018a70: 5f43 4855 4e4b 5f54 5950 450a 2020 2020  _CHUNK_TYPE.    
+00018a80: 2b20 4441 5441 4652 414d 455f 4348 554e  + DATAFRAME_CHUN
+00018a90: 4b5f 5459 5045 0a20 2020 202b 2047 524f  K_TYPE.    + GRO
+00018aa0: 5550 4259 5f43 4855 4e4b 5f54 5950 450a  UPBY_CHUNK_TYPE.
+00018ab0: 2020 2020 2b20 4341 5445 474f 5249 4341      + CATEGORICA
+00018ac0: 4c5f 4348 554e 4b5f 5459 5045 0a29 0a0a  L_CHUNK_TYPE.)..
+00018ad0: 7265 6769 7374 6572 5f6f 7574 7075 745f  register_output_
+00018ae0: 7479 7065 7328 4f75 7470 7574 5479 7065  types(OutputType
+00018af0: 2e64 6174 6166 7261 6d65 2c20 4441 5441  .dataframe, DATA
+00018b00: 4652 414d 455f 5459 5045 2c20 4441 5441  FRAME_TYPE, DATA
+00018b10: 4652 414d 455f 4348 554e 4b5f 5459 5045  FRAME_CHUNK_TYPE
+00018b20: 290a 7265 6769 7374 6572 5f6f 7574 7075  ).register_outpu
+00018b30: 745f 7479 7065 7328 4f75 7470 7574 5479  t_types(OutputTy
+00018b40: 7065 2e73 6572 6965 732c 2053 4552 4945  pe.series, SERIE
+00018b50: 535f 5459 5045 2c20 5345 5249 4553 5f43  S_TYPE, SERIES_C
+00018b60: 4855 4e4b 5f54 5950 4529 0a72 6567 6973  HUNK_TYPE).regis
+00018b70: 7465 725f 6f75 7470 7574 5f74 7970 6573  ter_output_types
+00018b80: 280a 2020 2020 4f75 7470 7574 5479 7065  (.    OutputType
+00018b90: 2e64 665f 6f72 5f73 6572 6965 732c 2044  .df_or_series, D
+00018ba0: 4154 4146 5241 4d45 5f4f 525f 5345 5249  ATAFRAME_OR_SERI
+00018bb0: 4553 5f54 5950 452c 2044 4154 4146 5241  ES_TYPE, DATAFRA
+00018bc0: 4d45 5f4f 525f 5345 5249 4553 5f43 4855  ME_OR_SERIES_CHU
+00018bd0: 4e4b 5f54 5950 450a 290a 7265 6769 7374  NK_TYPE.).regist
+00018be0: 6572 5f6f 7574 7075 745f 7479 7065 7328  er_output_types(
+00018bf0: 4f75 7470 7574 5479 7065 2e69 6e64 6578  OutputType.index
+00018c00: 2c20 494e 4445 585f 5459 5045 2c20 494e  , INDEX_TYPE, IN
+00018c10: 4445 585f 4348 554e 4b5f 5459 5045 290a  DEX_CHUNK_TYPE).
+00018c20: 7265 6769 7374 6572 5f6f 7574 7075 745f  register_output_
+00018c30: 7479 7065 7328 4f75 7470 7574 5479 7065  types(OutputType
+00018c40: 2e63 6174 6567 6f72 6963 616c 2c20 4341  .categorical, CA
+00018c50: 5445 474f 5249 4341 4c5f 5459 5045 2c20  TEGORICAL_TYPE, 
+00018c60: 4341 5445 474f 5249 4341 4c5f 4348 554e  CATEGORICAL_CHUN
+00018c70: 4b5f 5459 5045 290a 7265 6769 7374 6572  K_TYPE).register
+00018c80: 5f6f 7574 7075 745f 7479 7065 7328 0a20  _output_types(. 
+00018c90: 2020 204f 7574 7075 7454 7970 652e 6461     OutputType.da
+00018ca0: 7461 6672 616d 655f 6772 6f75 7062 792c  taframe_groupby,
+00018cb0: 2044 4154 4146 5241 4d45 5f47 524f 5550   DATAFRAME_GROUP
+00018cc0: 4259 5f54 5950 452c 2044 4154 4146 5241  BY_TYPE, DATAFRA
+00018cd0: 4d45 5f47 524f 5550 4259 5f43 4855 4e4b  ME_GROUPBY_CHUNK
+00018ce0: 5f54 5950 450a 290a 7265 6769 7374 6572  _TYPE.).register
+00018cf0: 5f6f 7574 7075 745f 7479 7065 7328 0a20  _output_types(. 
+00018d00: 2020 204f 7574 7075 7454 7970 652e 7365     OutputType.se
+00018d10: 7269 6573 5f67 726f 7570 6279 2c20 5345  ries_groupby, SE
+00018d20: 5249 4553 5f47 524f 5550 4259 5f54 5950  RIES_GROUPBY_TYP
+00018d30: 452c 2053 4552 4945 535f 4752 4f55 5042  E, SERIES_GROUPB
+00018d40: 595f 4348 554e 4b5f 5459 5045 0a29 0a    Y_CHUNK_TYPE.).
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/dataframe.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/dataframe.py`

 * *Files 2% similar despite different names*

```diff
@@ -18,18 +18,20 @@
 import pandas as pd
 
 from ... import opcodes as OperandDef
 from ...config import options
 from ...core import OutputType
 from ...serialization.serializables import DataFrameField, SeriesField
 from ...tensor.utils import get_chunk_slices
-from ...utils import estimate_pandas_size
+from ...utils import estimate_pandas_size, lazy_import
 from ..operands import DataFrameOperand, DataFrameOperandMixin
 from ..utils import decide_dataframe_chunk_sizes, is_cudf, parse_index
 
+cudf = lazy_import("cudf")
+
 
 class DataFrameDataSource(DataFrameOperand, DataFrameOperandMixin):
     """
     Represents data from pandas DataFrame
     """
 
     _op_type_ = OperandDef.DATAFRAME_DATA_SOURCE
@@ -117,14 +119,14 @@
             columns_value=df.columns_value,
             chunks=out_chunks,
             nsplits=chunk_size,
             **df.extra_params
         )
 
     @classmethod
-    def execute(cls, ctx, op):
-        ctx[op.outputs[0].key] = op.data
+    def execute(cls, ctx, op: "DataFrameDataSource"):
+        ctx[op.outputs[0].key] = cudf.DataFrame(op.data) if op.is_gpu() else op.data
 
 
 def from_pandas(data, chunk_size=None, gpu=None, sparse=False):
     op = DataFrameDataSource(data=data, gpu=gpu, sparse=sparse)
     return op(data.shape, chunk_size=chunk_size)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/date_range.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/date_range.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/from_index.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/from_index.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/from_records.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/from_records.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/from_tensor.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/from_tensor.py`

 * *Files 0% similar despite different names*

```diff
@@ -23,18 +23,20 @@
 from ...core import ENTITY_TYPE, OutputType, recursive_tile
 from ...core.context import Context
 from ...serialization.serializables import AnyField, KeyField
 from ...tensor.core import Tensor
 from ...tensor.datasource import tensor as astensor
 from ...tensor.utils import unify_chunks
 from ...typing import EntityType, TileableType
-from ...utils import has_unknown_shape
+from ...utils import has_unknown_shape, lazy_import
 from ..core import INDEX_TYPE, SERIES_TYPE
 from ..operands import DataFrameOperand, DataFrameOperandMixin
-from ..utils import parse_index
+from ..utils import is_pandas_2, parse_index
+
+cudf = lazy_import("cudf")
 
 
 class DataFrameFromTensor(DataFrameOperand, DataFrameOperandMixin):
     """
     Represents data from mars tensor
     """
 
@@ -65,15 +67,15 @@
                 self.input = new_input
 
         if isinstance(self.index, ENTITY_TYPE):
             self.index = next(inputs_iter)
 
     def __call__(
         self,
-        input_tensor: Tensor,
+        input_tensor: Union[Tensor, Dict],
         index: Union[TileableType, pd.Index],
         columns: pd.Index,
         dtypes: pd.Series,
     ):
         if isinstance(input_tensor, dict):
             return self._call_input_1d_tileables(input_tensor, index, columns, dtypes)
         elif input_tensor is not None:
@@ -247,15 +249,15 @@
             if not isinstance(columns, pd.Index):
                 if isinstance(columns, ENTITY_TYPE):
                     raise NotImplementedError("The columns value cannot be a tileable")
                 columns = pd.Index(columns)
             columns_value = parse_index(columns, store_data=True)
             shape.append(columns.shape[0])
         else:
-            columns_value = parse_index(pd.Index([], dtype=object), store_data=True)
+            columns_value = parse_index(pd.RangeIndex(0), store_data=True)
             shape.append(0)
 
         return self.new_dataframe(
             inputs,
             shape=tuple(shape),
             dtypes=dtypes,
             index_value=index_value,
@@ -437,48 +439,49 @@
         params = out_df.params.copy()
         params["nsplits"] = (op.index.nsplits[0], (out_df.shape[1],))
         params["chunks"] = out_chunks
         return new_op.new_dataframes(out_df.inputs, kws=[params])
 
     @classmethod
     def execute(cls, ctx: Union[dict, Context], op: "DataFrameFromTensor"):
-        chunk = op.outputs[0]
+        xdf = cudf if op.is_gpu() else pd
 
+        chunk = op.outputs[0]
         if isinstance(op.input, dict):
             d = OrderedDict()
             for k, v in op.input.items():
                 if hasattr(v, "key"):
                     d[k] = ctx[v.key]
                 else:
                     d[k] = v
             if op.index is not None and hasattr(op.index, "key"):
                 index_data = ctx[op.index.key]
             else:
                 index_data = op.index
-            ctx[chunk.key] = pd.DataFrame(d, index=index_data, columns=op.columns)
+            ctx[chunk.key] = xdf.DataFrame(d, index=index_data, columns=op.columns)
         elif op.input is not None:
             tensor_data = ctx[op.inputs[0].key]
-            if isinstance(tensor_data, pd.Series):
+            if isinstance(tensor_data, xdf.Series):
                 ctx[chunk.key] = tensor_data.to_frame(name=chunk.dtypes.index[0])
             else:
                 if op.index is not None and hasattr(op.index, "key"):
                     # index is a tensor
                     index_data = ctx[op.inputs[1].key]
                 else:
                     index_data = op.index
-                    if isinstance(index_data, pd.RangeIndex) and len(index_data) == 0:
+                    if isinstance(index_data, xdf.RangeIndex) and len(index_data) == 0:
                         index_data = None
-                ctx[chunk.key] = pd.DataFrame(
+                ctx[chunk.key] = xdf.DataFrame(
                     tensor_data,
                     index=index_data,
                     columns=op.columns,
                 )
         else:
             index_data = ctx[op.index.key]
-            ctx[chunk.key] = pd.DataFrame(index=index_data, columns=op.columns)
+            ctx[chunk.key] = xdf.DataFrame(index=index_data, columns=op.columns)
 
 
 def dataframe_from_tensor(
     tensor: Tensor,
     index: Union[TileableType, pd.Index] = None,
     columns: Union[pd.Index, list] = None,
     gpu: bool = None,
@@ -498,15 +501,18 @@
         if columns is None:
             columns = dtypes.index
     else:
         gpu = None
         if columns is not None:
             dtypes = pd.Series([], index=columns)
         else:
-            dtypes = pd.Series([], index=pd.Index([], dtype=object))
+            if is_pandas_2():
+                dtypes = pd.Series([], index=pd.RangeIndex(0))
+            else:
+                dtypes = pd.Series([], index=pd.Index([], dtype=object))
     if index is not None and not isinstance(index, ENTITY_TYPE):
         index = pd.Index(index)
     op = DataFrameFromTensor(
         input=tensor, index=index, columns=columns, gpu=gpu, sparse=sparse
     )
     return op(tensor, index, columns, dtypes)
 
@@ -529,14 +535,15 @@
     d = data
     if columns is not None:
         tileables = [d.get(c) for c in columns]
     else:
         columns = list(d.keys())
         tileables = list(d.values())
 
+    # TODO: This is quite random. Better use any() or all() to determine if the result should be in varm.
     gpu = (
         next((t.op.gpu for t in tileables if hasattr(t, "op")), False)
         if gpu is None
         else gpu
     )
     dtypes = pd.Series(
         [t.dtype if hasattr(t, "dtype") else pd.Series(t).dtype for t in tileables],
@@ -657,14 +664,16 @@
         params = out_series.params.copy()
         params["nsplits"] = (op.index.nsplits[0],)
         params["chunks"] = out_chunks
         return new_op.new_tileables(out_series.inputs, kws=[params])
 
     @classmethod
     def execute(cls, ctx: Union[dict, Context], op: "SeriesFromTensor"):
+        xdf = cudf if op.is_gpu() else pd
+
         chunk = op.outputs[0]
         if op.input is not None:
             tensor_data = ctx[op.input.key]
         else:
             tensor_data = None
 
         if op.index is not None and hasattr(op.index, "key"):
@@ -675,15 +684,15 @@
                 tensor_data is not None
                 and isinstance(index_data, pd.RangeIndex)
                 and len(index_data) == 0
             ):
                 # index not specified
                 index_data = None
 
-        ctx[chunk.key] = pd.Series(
+        ctx[chunk.key] = xdf.Series(
             tensor_data, index=index_data, name=chunk.name, dtype=chunk.dtype
         )
 
     def __call__(
         self,
         input_tensor: Tensor,
         index: Union[TileableType, pd.Index],
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/from_vineyard.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/from_vineyard.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/index.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/index.py`

 * *Files 3% similar despite different names*

```diff
@@ -10,26 +10,30 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import itertools
+from typing import Union
 
 import numpy as np
 import pandas as pd
 
 from ... import opcodes as OperandDef
 from ...config import options
 from ...core import OutputType
 from ...serialization.serializables import BoolField, DataTypeField, IndexField
 from ...tensor.utils import get_chunk_slices
+from ...utils import lazy_import
 from ..operands import DataFrameOperand, DataFrameOperandMixin
 from ..utils import decide_series_chunk_size, is_cudf, parse_index
 
+cudf = lazy_import("cudf")
+
 
 class IndexDataSource(DataFrameOperand, DataFrameOperandMixin):
     """
     Represent data from pandas Index
     """
 
     _op_type_ = OperandDef.INDEX_DATA_SOURCE
@@ -106,30 +110,30 @@
                 dtype=self.dtype,
                 index_value=parse_index(pd_index, inp, store_data=self.store_data),
                 name=name,
                 names=names,
             )
 
     @classmethod
-    def _tile_from_pandas(cls, op):
+    def _tile_from_pandas(cls, op: "IndexDataSource"):
         index = op.outputs[0]
         raw_index = op.data
 
         memory_usage = raw_index.memory_usage(deep=True)
         chunk_size = index.extra_params.raw_chunk_size or options.chunk_size
         chunk_size = decide_series_chunk_size(index.shape, chunk_size, memory_usage)
         chunk_size_idxes = (range(len(size)) for size in chunk_size)
 
         out_chunks = []
         for chunk_index, chunk_shape in zip(
             itertools.product(*chunk_size_idxes), itertools.product(*chunk_size)
         ):
             chunk_op = op.copy().reset_key()
             slc = get_chunk_slices(chunk_size, chunk_index)
-            if is_cudf(raw_index):  # pragma: no cover
+            if is_cudf(raw_index) or op.is_gpu():
                 chunk_op.data = chunk_data = raw_index[slc[0]]
             else:
                 chunk_op.data = chunk_data = raw_index[slc]
             out_chunk = chunk_op.new_chunk(
                 None,
                 shape=chunk_shape,
                 dtype=index.dtype,
@@ -229,33 +233,52 @@
         elif hasattr(op.inputs[0], "index_value"):
             # from DataFrame or Series
             return cls._tile_from_dataframe(op)
         else:
             # from tensor
             return cls._tile_from_tensor(op)
 
+    @staticmethod
+    def to_cudf_index(idx: "Union[pd.Index, cudf.core.index.BaseIndex]"):
+        if isinstance(idx, cudf.core.index.BaseIndex):
+            return idx
+
+        return cudf.from_pandas(idx)
+
     @classmethod
-    def execute(cls, ctx, op):
+    def execute(cls, ctx, op: "IndexDataSource"):
+        xdf = cudf if op.is_gpu() else pd
+
+        out = op.outputs[0]
         if not op.inputs:
-            # from pandas
-            ctx[op.outputs[0].key] = op.data
+            # from pandas.
+            idx = op.data
         else:
             out = op.outputs[0]
             inp = ctx[op.inputs[0].key]
             dtype = out.dtype if out.dtype != object else None
             if hasattr(inp, "index"):
-                # DataFrame, Series
-                ctx[out.key] = pd.Index(inp.index, dtype=dtype, name=out.name)
+                # inp could be a DataFrame or Series.
+                idx = inp.index
             else:
-                ctx[out.key] = pd.Index(inp, dtype=dtype, name=out.name)
+                # inp could be an array.
+                idx = xdf.Index(inp, dtype=dtype, name=out.name)
+
+        ctx[out.key] = cls.to_cudf_index(idx) if op.is_gpu() else idx
 
 
 def from_pandas(data, chunk_size=None, gpu=None, sparse=False, store_data=False):
     op = IndexDataSource(
         data=data, gpu=gpu, sparse=sparse, dtype=data.dtype, store_data=store_data
     )
-    return op(shape=data.shape, chunk_size=chunk_size)
+
+    shape = data.shape
+    if gpu and hasattr(data, "levels"):
+        # the shape of cudf multi index is a 2-d tuple where the first element represents the
+        # number of rows and the second element represents the number of levels.
+        shape = (data.shape[0], len(data.levels))
+    return op(shape=shape, chunk_size=chunk_size)
 
 
 def from_tileable(tileable, dtype=None, name=None, names=None):
     op = IndexDataSource(gpu=tileable.op.gpu, sparse=tileable.issparse(), dtype=dtype)
     return op(inp=tileable, name=name, names=names)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/read_csv.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/read_csv.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/read_parquet.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/read_parquet.py`

 * *Files 4% similar despite different names*

```diff
@@ -10,25 +10,28 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import os
-from typing import Dict
+from typing import Dict, Optional, Union
 from urllib.parse import urlparse
 
 import numpy as np
 import pandas as pd
 
 try:
     import pyarrow as pa
     import pyarrow.parquet as pq
+
+    arrow_dtype = pa.DataType
 except ImportError:
     pa = None
+    arrow_dtype = None
 
 try:
     import fastparquet
 except ImportError:
     fastparquet = None
 
 from ... import opcodes as OperandDef
@@ -40,26 +43,27 @@
     DictField,
     Int32Field,
     Int64Field,
     ListField,
     StringField,
 )
 from ...utils import is_object_dtype, lazy_import
-from ..arrays import ArrowStringDtype
+from ..arrays import ArrowListDtype, ArrowStringDtype
 from ..operands import OutputType
 from ..utils import contain_arrow_dtype, parse_index, to_arrow_dtypes
 from .core import (
     ColumnPruneSupportedDataSourceMixin,
     IncrementalIndexDatasource,
     IncrementalIndexDataSourceMixin,
     merge_small_files,
 )
 from .utils import convert_to_abspath
 
-PARQUET_MEMORY_SCALE = 15
+PARQUET_MEMORY_SCALE = 10
+PARQUET_MEMORY_SCALE_WITH_ARROW_DTYPE = 3
 STRING_FIELD_OVERHEAD = 50
 cudf = lazy_import("cudf")
 
 
 def check_engine(engine):
     if engine == "auto":
         if pa is not None:
@@ -162,29 +166,43 @@
     if isinstance(path, str):
         parsed_path = urlparse(path)
         if parsed_path.scheme:
             path_prefix = f"{parsed_path.scheme}://{parsed_path.netloc}"
     return path_prefix
 
 
+def _arrow_dtype_mapper(
+    tp: Union[np.dtype, arrow_dtype]
+) -> Optional[Union[ArrowListDtype, ArrowStringDtype]]:
+    if tp == pa.string():
+        return ArrowStringDtype()
+    elif isinstance(tp, pa.ListType):
+        return ArrowListDtype(tp.value_type)
+    else:
+        return
+
+
 class ArrowEngine(ParquetEngine):
     def get_row_num(self, f):
         file = pq.ParquetFile(f)
         return file.metadata.num_rows
 
     def read_dtypes(self, f, **kwargs):
+        types_mapper = kwargs.pop("types_mapper", None)
         file = pq.ParquetFile(f)
-        return file.schema_arrow.empty_table().to_pandas().dtypes
+        return (
+            file.schema_arrow.empty_table().to_pandas(types_mapper=types_mapper).dtypes
+        )
 
     @classmethod
     def _table_to_pandas(cls, t, nrows=None, use_arrow_dtype=None):
         if nrows is not None:
             t = t.slice(0, nrows)
         if use_arrow_dtype:
-            df = t.to_pandas(types_mapper={pa.string(): ArrowStringDtype()}.get)
+            df = t.to_pandas(types_mapper=_arrow_dtype_mapper)
         else:
             df = t.to_pandas()
         return df
 
     def read_to_pandas(
         self, f, columns=None, nrows=None, use_arrow_dtype=None, **kwargs
     ):
@@ -564,18 +582,37 @@
             )
 
         estimated_row_num = (
             np.ceil(first_chunk_row_num * (raw_bytes / first_chunk_raw_bytes))
             .astype(np.int64)
             .item()
         )
-        phy_size = raw_bytes * (op.memory_scale or PARQUET_MEMORY_SCALE)
-        n_strings = len([dt for dt in op.outputs[0].dtypes if is_object_dtype(dt)])
-        pd_size = phy_size + n_strings * estimated_row_num * STRING_FIELD_OVERHEAD
-        ctx[op.outputs[0].key] = (pd_size, pd_size + phy_size)
+        if op.columns is not None:
+            with open_file(op.path, storage_options=op.storage_options) as f:
+                all_columns = list(get_engine(op.engine).read_dtypes(f).index)
+        else:
+            all_columns = list(op.outputs[0].dtypes.index)
+        columns = op.columns if op.columns else all_columns
+        if op.use_arrow_dtype:
+            scale = op.memory_scale or PARQUET_MEMORY_SCALE_WITH_ARROW_DTYPE
+        else:
+            scale = op.memory_scale or PARQUET_MEMORY_SCALE
+        phy_size = raw_bytes * scale * len(columns) / len(all_columns)
+        n_strings = len(
+            [
+                dt
+                for col, dt in op.outputs[0].dtypes.items()
+                if col in columns and is_object_dtype(dt)
+            ]
+        )
+        if op.use_arrow_dtype:
+            pd_size = phy_size
+        else:
+            pd_size = phy_size + n_strings * estimated_row_num * STRING_FIELD_OVERHEAD
+        ctx[op.outputs[0].key] = (pd_size, pd_size)
 
     def __call__(self, index_value=None, columns_value=None, dtypes=None):
         self._output_types = [OutputType.dataframe]
         shape = (np.nan, len(dtypes))
         return self.new_dataframe(
             None,
             shape,
@@ -647,40 +684,43 @@
 
     engine_type = check_engine(engine)
     engine = get_engine(engine_type)
 
     single_path = path[0] if isinstance(path, list) else path
     fs = get_fs(single_path, storage_options)
     is_partitioned = False
+    if use_arrow_dtype is None:
+        use_arrow_dtype = options.dataframe.use_arrow_dtype
+    if use_arrow_dtype and engine_type != "pyarrow":
+        raise ValueError(
+            f"The 'use_arrow_dtype' argument is not supported for the {engine_type} engine"
+        )
+    types_mapper = _arrow_dtype_mapper if use_arrow_dtype else None
+
     if fs.isdir(single_path):
         paths = fs.ls(path)
         if all(fs.isdir(p) for p in paths):
             # If all are directories, it is read as a partitioned dataset.
             dtypes = engine.read_partitioned_dtypes(fs, path, storage_options)
             is_partitioned = True
         else:
             with fs.open(paths[0], mode="rb") as f:
-                dtypes = engine.read_dtypes(f)
+                dtypes = engine.read_dtypes(f, types_mapper=types_mapper)
     else:
         if not isinstance(path, list):
             file_path = glob(path, storage_options=storage_options)[0]
         else:
             file_path = path[0]
 
         with open_file(file_path, storage_options=storage_options) as f:
-            dtypes = engine.read_dtypes(f)
+            dtypes = engine.read_dtypes(f, types_mapper=types_mapper)
 
     if columns:
         dtypes = dtypes[columns]
 
-    if use_arrow_dtype is None:
-        use_arrow_dtype = options.dataframe.use_arrow_dtype
-    if use_arrow_dtype:
-        dtypes = to_arrow_dtypes(dtypes)
-
     index_value = parse_index(pd.RangeIndex(-1))
     columns_value = parse_index(dtypes.index, store_data=True)
 
     # convert path to abs_path
     abs_path = convert_to_abspath(path, storage_options)
     op = DataFrameReadParquet(
         path=abs_path,
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/read_sql.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/read_sql.py`

 * *Files 0% similar despite different names*

```diff
@@ -494,15 +494,15 @@
             if use_arrow_dtype is None:
                 use_arrow_dtype = options.dataframe.use_arrow_dtype
             if use_arrow_dtype:
                 dtypes = to_arrow_dtypes(df.dtypes, test_df=df)
                 for i in range(len(dtypes)):
                     dtype = dtypes.iloc[i]
                     if isinstance(dtype, ArrowStringDtype):
-                        df.iloc[:, i] = df.iloc[:, i].astype(dtype)
+                        df.isetitem(i, df.iloc[:, i].astype(dtype))
 
             if out.ndim == 2:
                 ctx[out.key] = df
             else:
                 # this happens when column pruning results in one single series
                 ctx[out.key] = df.iloc[:, 0]
         finally:
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/series.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/series.py`

 * *Files 4% similar despite different names*

```diff
@@ -16,17 +16,20 @@
 import itertools
 
 from ... import opcodes as OperandDef
 from ...config import options
 from ...core import OutputType
 from ...serialization.serializables import DataTypeField, SeriesField
 from ...tensor.utils import get_chunk_slices
+from ...utils import lazy_import
 from ..operands import DataFrameOperand, DataFrameOperandMixin
 from ..utils import decide_series_chunk_size, is_cudf, parse_index
 
+cudf = lazy_import("cudf")
+
 
 class SeriesDataSource(DataFrameOperand, DataFrameOperandMixin):
     """
     Represents data from pandas Series
     """
 
     _op_type_ = OperandDef.SERIES_DATA_SOURCE
@@ -93,13 +96,13 @@
             name=series.name,
             chunks=out_chunks,
             nsplits=chunk_size,
         )
 
     @classmethod
     def execute(cls, ctx, op):
-        ctx[op.outputs[0].key] = op.data
+        ctx[op.outputs[0].key] = cudf.Series(op.data) if op.is_gpu() else op.data
 
 
 def from_pandas(data, chunk_size=None, gpu=None, sparse=False):
     op = SeriesDataSource(data=data, gpu=gpu, sparse=sparse)
     return op(data.shape, chunk_size=chunk_size)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datasource/utils.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datasource/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datastore/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datastore/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datastore/to_csv.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datastore/to_csv.py`

 * *Files 3% similar despite different names*

```diff
@@ -31,15 +31,15 @@
     KeyField,
     ListField,
     StringField,
 )
 from ...tensor.core import TensorOrder
 from ...tensor.operands import TensorOperand, TensorOperandMixin
 from ..operands import DataFrameOperand, DataFrameOperandMixin
-from ..utils import parse_index
+from ..utils import is_pandas_2, parse_index
 
 
 class DataFrameToCSV(DataFrameOperand, DataFrameOperandMixin):
     _op_type_ = OperandDef.TO_CSV
 
     _input = KeyField("input")
     _path = AnyField("path")
@@ -51,15 +51,15 @@
     _index = BoolField("index")
     _index_label = AnyField("index_label")
     _mode = StringField("mode")
     _encoding = StringField("encoding")
     _compression = AnyField("compression")
     _quoting = Int32Field("quoting")
     _quotechar = StringField("quotechar")
-    _line_terminator = StringField("line_terminator")
+    _lineterminator = StringField("lineterminator")
     _chunksize = Int64Field("chunksize")
     _date_format = StringField("date_format")
     _doublequote = BoolField("doublequote")
     _escapechar = StringField("escapechar")
     _decimal = StringField("decimal")
     _storage_options = DictField("storage_options")
     # for chunk
@@ -76,15 +76,15 @@
         index=None,
         index_label=None,
         mode=None,
         encoding=None,
         compression=None,
         quoting=None,
         quotechar=None,
-        line_terminator=None,
+        lineterminator=None,
         chunksize=None,
         date_format=None,
         doublequote=None,
         escapechar=None,
         decimal=None,
         output_stat=None,
         storage_options=None,
@@ -101,15 +101,15 @@
             _index=index,
             _index_label=index_label,
             _mode=mode,
             _encoding=encoding,
             _compression=compression,
             _quoting=quoting,
             _quotechar=quotechar,
-            _line_terminator=line_terminator,
+            _lineterminator=lineterminator,
             _chunksize=chunksize,
             _date_format=date_format,
             _doublequote=doublequote,
             _escapechar=escapechar,
             _decimal=decimal,
             _output_stat=output_stat,
             _storage_options=storage_options,
@@ -170,16 +170,16 @@
         return self._quoting
 
     @property
     def quotechar(self):
         return self._quotechar
 
     @property
-    def line_terminator(self):
-        return self._line_terminator
+    def lineterminator(self):
+        return self._lineterminator
 
     @property
     def chunksize(self):
         return self._chunksize
 
     @property
     def date_format(self):
@@ -229,29 +229,28 @@
 
         one_file = op.one_file
 
         out_chunks = [], []
         for chunk in in_df.chunks:
             chunk_op = op.copy().reset_key()
             if not one_file:
-                index_value = parse_index(chunk.index_value.to_pandas()[:0], chunk)
                 if chunk.ndim == 2:
                     out_chunk = chunk_op.new_chunk(
                         [chunk],
                         shape=(0, 0),
-                        index_value=index_value,
+                        index_value=out_df.index_value,
                         columns_value=out_df.columns_value,
                         dtypes=out_df.dtypes,
                         index=chunk.index,
                     )
                 else:
                     out_chunk = chunk_op.new_chunk(
                         [chunk],
                         shape=(0,),
-                        index_value=index_value,
+                        index_value=out_df.index_value,
                         dtype=out_df.dtype,
                         index=chunk.index,
                     )
                 out_chunks[0].append(out_chunk)
             else:
                 chunk_op._output_stat = True
                 chunk_op.stage = OperandStage.map
@@ -326,56 +325,59 @@
         else:
             params.update(
                 dict(chunks=out_chunks, nsplits=((0,) * in_df.chunk_shape[0],))
             )
         return new_op.new_tileables([in_df], **params)
 
     def __call__(self, df):
-        index_value = parse_index(df.index_value.to_pandas()[:0], df)
+        index_value = parse_index(pd.RangeIndex(0), df)
         if df.ndim == 2:
-            columns_value = parse_index(
-                df.columns_value.to_pandas()[:0], store_data=True
-            )
+            columns_value = parse_index(pd.RangeIndex(0))
             return self.new_dataframe(
                 [df],
                 shape=(0, 0),
-                dtypes=df.dtypes[:0],
+                dtypes=pd.Series(dtype="object"),
                 index_value=index_value,
                 columns_value=columns_value,
             )
         else:
             return self.new_series(
                 [df], shape=(0,), dtype=df.dtype, index_value=index_value
             )
 
     @classmethod
     def _to_csv(cls, op, df, path, header=None):
         if header is None:
             header = op.header
-        df.to_csv(
-            path,
+        kwargs = dict(
             sep=op.sep,
             na_rep=op.na_rep,
             float_format=op.float_format,
             columns=op.columns,
             header=header,
             index=op.index,
             index_label=op.index_label,
             mode=op.mode,
             encoding=op.encoding,
             compression=op.compression,
             quoting=op.quoting,
             quotechar=op.quotechar,
-            line_terminator=op.line_terminator,
+            lineterminator=op.lineterminator,
             chunksize=op.chunksize,
             date_format=op.date_format,
             doublequote=op.doublequote,
             escapechar=op.escapechar,
             decimal=op.decimal,
         )
+        if is_pandas_2():
+            kwargs["lineterminator"] = op.lineterminator
+        else:
+            kwargs["line_terminator"] = op.lineterminator
+
+        df.to_csv(path, **kwargs)
 
     @classmethod
     def _execute_map(cls, ctx, op):
         out = op.outputs[0]
 
         df = ctx[op.input.key]
         sio = StringIO()
@@ -477,15 +479,15 @@
     index=True,
     index_label=None,
     mode="w",
     encoding=None,
     compression="infer",
     quoting=None,
     quotechar='"',
-    line_terminator=None,
+    lineterminator=None,
     chunksize=None,
     date_format=None,
     doublequote=True,
     escapechar=None,
     decimal=".",
     storage_options=None,
 ):
@@ -536,15 +538,15 @@
         additional compression options.
     quoting : optional constant from csv module
         Defaults to csv.QUOTE_MINIMAL. If you have set a `float_format`
         then floats are converted to strings and thus csv.QUOTE_NONNUMERIC
         will treat them as non-numeric.
     quotechar : str, default '\"'
         String of length 1. Character used to quote fields.
-    line_terminator : str, optional
+    lineterminator : str, optional
         The newline character or character sequence to use in the output
         file. Defaults to `os.linesep`, which depends on the OS in which
         this method is called ('\n' for linux, '\r\n' for Windows, i.e.).
     chunksize : int or None
         Rows to write at a time.
     date_format : str, default None
         Format string for datetime objects.
@@ -587,15 +589,15 @@
         index=index,
         index_label=index_label,
         mode=mode,
         encoding=encoding,
         compression=compression,
         quoting=quoting,
         quotechar=quotechar,
-        line_terminator=line_terminator,
+        lineterminator=lineterminator,
         chunksize=chunksize,
         date_format=date_format,
         doublequote=doublequote,
         escapechar=escapechar,
         decimal=decimal,
         storage_options=storage_options,
     )
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datastore/to_parquet.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datastore/to_parquet.py`

 * *Files 3% similar despite different names*

```diff
@@ -191,20 +191,20 @@
                 raise NotImplementedError(
                     "Only support pyarrow engine when specify `partition_cols`."
                 )
 
         ctx[out.key] = pd.DataFrame()
 
     def __call__(self, df):
-        index_value = parse_index(df.index_value.to_pandas()[:0], df)
-        columns_value = parse_index(df.columns_value.to_pandas()[:0], store_data=True)
+        index_value = parse_index(pd.RangeIndex(0), df)
+        columns_value = parse_index(pd.RangeIndex(0))
         return self.new_dataframe(
             [df],
             shape=(0, 0),
-            dtypes=df.dtypes[:0],
+            dtypes=pd.Series(dtype="object"),
             index_value=index_value,
             columns_value=columns_value,
         )
 
 
 def to_parquet(
     df,
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datastore/to_sql.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datastore/to_sql.py`

 * *Files 2% similar despite different names*

```diff
@@ -28,14 +28,15 @@
 )
 from ..core import DATAFRAME_TYPE
 from ..operands import DataFrameOperand, DataFrameOperandMixin
 from ..utils import (
     build_empty_df,
     build_empty_series,
     create_sa_connection,
+    is_pandas_2,
     parse_index,
 )
 
 
 class DataFrameToSQLTableLogicKeyGeneratorMixin(OperatorLogicKeyGeneratorMixin):
     def _get_logic_key_token_values(self):
         fields_to_tokenize = [
@@ -92,32 +93,44 @@
                 schema=self.schema,
                 if_exists=self.if_exists,
                 index=self.index,
                 index_label=self.index_label,
                 dtype=self.dtype,
             )
 
-            index_value = parse_index(
-                df_or_series.index_value.to_pandas()[:0], df_or_series.key, "index"
-            )
             if isinstance(df_or_series, DATAFRAME_TYPE):
+                if is_pandas_2():
+                    dtypes = pd.Series([], index=pd.RangeIndex(0), dtype="object")
+                else:
+                    dtypes = df_or_series.dtypes[:0]
+                index_value = parse_index(dtypes.index, df_or_series.key, "index")
                 columns_value = parse_index(
-                    df_or_series.columns_value.to_pandas()[:0],
+                    dtypes.index,
                     df_or_series.key,
                     "columns",
                     store_data=True,
                 )
                 return self.new_dataframe(
                     [df_or_series],
                     shape=(0, 0),
-                    dtypes=df_or_series.dtypes[:0],
+                    dtypes=dtypes,
                     index_value=index_value,
                     columns_value=columns_value,
                 )
             else:
+                if is_pandas_2():
+                    index_value = parse_index(
+                        pd.RangeIndex(0), df_or_series.key, "index"
+                    )
+                else:
+                    index_value = parse_index(
+                        df_or_series.index_value.to_pandas()[:0],
+                        df_or_series.key,
+                        "index",
+                    )
                 return self.new_series(
                     [df_or_series],
                     shape=(0,),
                     dtype=df_or_series.dtype,
                     index_value=index_value,
                 )
 
@@ -129,19 +142,17 @@
             inp = yield from recursive_tile(inp.rechunk({1: (inp.shape[1],)}))
 
         chunks = []
         for c in inp.chunks:
             new_op = op.copy().reset_key()
             new_op.if_exists = "append"
 
-            index_value = parse_index(c.index_value.to_pandas()[:0], c)
+            index_value = out.index_value
             if c.ndim == 2:
-                columns_value = parse_index(
-                    c.columns_value.to_pandas()[:0], store_data=True
-                )
+                columns_value = out.columns_value
                 chunks.append(
                     new_op.new_chunk(
                         [c],
                         shape=(0, 0),
                         index=c.index,
                         dtypes=out.dtypes,
                         index_value=index_value,
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/datastore/to_vineyard.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/datastore/to_vineyard.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/fetch/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/fetch/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/fetch/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/fetch/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/aggregation.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/aggregation.py`

 * *Files 2% similar despite different names*

```diff
@@ -13,15 +13,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import functools
 import itertools
 import logging
 import uuid
-from typing import Callable, Dict, List, Union
+from typing import Callable, Dict, List, Optional, Union
 
 import numpy as np
 import pandas as pd
 
 from ... import opcodes as OperandDef
 from ...config import options
 from ...core import ENTITY_TYPE, OutputType
@@ -1002,26 +1002,39 @@
             return custom_agg_functions[func_name].execute_map(op, in_data)
         elif op.stage == OperandStage.combine:
             return custom_agg_functions[func_name].execute_combine(op, in_data)
         else:  # must be OperandStage.agg, since OperandStage.reduce has been excluded in the execute function.
             return custom_agg_functions[func_name].execute_agg(op, in_data)
 
     @staticmethod
-    def _do_predefined_agg(input_obj, agg_func, single_func=False, **kwds):
+    def _do_predefined_agg(
+        input_obj,
+        agg_func,
+        single_func: bool = False,
+        gpu: Optional[bool] = False,
+        **kwds,
+    ):
         ndim = getattr(input_obj, "ndim", None) or input_obj.obj.ndim
         if agg_func == "str_concat":
             agg_func = lambda x: x.str.cat(**kwds)
         elif isinstance(agg_func, str) and not kwds.get("skipna", True):
             func_name = agg_func
             agg_func = lambda x: getattr(x, func_name)(skipna=False)
             agg_func.__name__ = func_name
 
         if ndim == 2:
             if single_func:
-                result = input_obj.agg(agg_func)
+                # DataFrameGroupby.agg('size') returns empty df in cudf, which is not correct
+                # The index order of .size() is wrong in cudf,
+                # however, for performance considerations, sort_index() will not be called here
+                result = (
+                    input_obj.size()
+                    if gpu and agg_func == "size"
+                    else input_obj.agg(agg_func)
+                )
                 if result.ndim == 1:
                     # when agg_func == size, agg only returns one single series.
                     result = result.to_frame(agg_func)
             else:
                 result = input_obj.agg([agg_func])
                 result.columns = result.columns.droplevel(-1)
             return result
@@ -1106,15 +1119,15 @@
             input_obj = ret_map_groupbys[input_key]
             if map_func_name == "custom_reduction":
                 agg_dfs.append(cls._do_custom_agg(raw_func_name, op, in_data))
             else:
                 single_func = map_func_name == op.raw_func
                 agg_dfs.append(
                     cls._do_predefined_agg(
-                        input_obj, map_func_name, single_func, **kwds
+                        input_obj, map_func_name, single_func, op.gpu, **kwds
                     )
                 )
 
         if getattr(op, "size_recorder_name", None) is not None:
             # record_size
             raw_size = estimate_pandas_size(in_data)
             # when agg by a list of methods, agg_size should be sum
@@ -1152,15 +1165,15 @@
             kwds,
         ) in zip(ctx[op.inputs[0].key], op.agg_funcs):
             input_obj = in_data_dict[output_key]
             if agg_func_name == "custom_reduction":
                 combines.append(cls._do_custom_agg(raw_func_name, op, raw_input))
             else:
                 combines.append(
-                    cls._do_predefined_agg(input_obj, agg_func_name, **kwds)
+                    cls._do_predefined_agg(input_obj, agg_func_name, gpu=op.gpu, **kwds)
                 )
         ctx[op.outputs[0].key] = tuple(combines)
 
     @classmethod
     def _execute_agg(cls, ctx, op: "DataFrameGroupByAgg"):
         xdf = cudf if op.gpu else pd
         out_chunk = op.outputs[0]
@@ -1195,15 +1208,15 @@
             if agg_func_name == "custom_reduction":
                 in_data_dict[output_key] = cls._do_custom_agg(
                     raw_func_name, op, in_data_dict[output_key]
                 )
             else:
                 input_obj = cls._get_grouped(op, in_data_dict[output_key], ctx)
                 in_data_dict[output_key] = cls._do_predefined_agg(
-                    input_obj, agg_func_name, **kwds
+                    input_obj, agg_func_name, gpu=op.gpu, **kwds
                 )
 
         aggs = []
         for input_keys, _output_key, func_name, cols, func in op.post_funcs:
             if func_name in custom_agg_functions:
                 agg_df = in_data_dict[_output_key]
             else:
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/apply.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/apply.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/core.py`

 * *Files 6% similar despite different names*

```diff
@@ -44,38 +44,41 @@
 _default_group_keys = no_default if _GROUP_KEYS_NO_DEFAULT else True
 
 
 class DataFrameGroupByOperand(MapReduceOperand, DataFrameOperandMixin):
     _op_type_ = OperandDef.GROUPBY
 
     _by = AnyField("by", on_serialize=lambda x: x.data if isinstance(x, Entity) else x)
+    _is_list_by = BoolField("is_list_by")
     _level = AnyField("level")
     _as_index = BoolField("as_index")
     _sort = BoolField("sort")
     _group_keys = BoolField("group_keys")
 
     _shuffle_size = Int32Field("shuffle_size")
 
     def __init__(
         self,
         by=None,
         level=None,
         as_index=None,
         sort=None,
         group_keys=None,
+        is_list_by=None,
         shuffle_size=None,
         output_types=None,
         **kw
     ):
         super().__init__(
             _by=by,
             _level=level,
             _as_index=as_index,
             _sort=sort,
             _group_keys=group_keys,
+            _is_list_by=is_list_by,
             _shuffle_size=shuffle_size,
             _output_types=output_types,
             **kw
         )
         if output_types:
             if self.stage in (OperandStage.map, OperandStage.reduce):
                 if output_types[0] in (
@@ -112,14 +115,18 @@
         return self._sort
 
     @property
     def group_keys(self):
         return self._group_keys
 
     @property
+    def is_list_by(self):
+        return self._is_list_by
+
+    @property
     def shuffle_size(self):
         return self._shuffle_size
 
     @property
     def is_dataframe_obj(self):
         return self.output_types[0] in (
             OutputType.dataframe_groupby,
@@ -494,14 +501,16 @@
             inp = ctx[op.inputs[0].key]
             if isinstance(inp, tuple):
                 # df, by
                 df, by = inp
             else:
                 df = inp
                 by = op.by
+            if not op.is_list_by and isinstance(by, list):
+                by = by[0]
             ctx[op.outputs[0].key] = wrapped_groupby(
                 df,
                 by=by,
                 level=op.level,
                 as_index=op.as_index,
                 sort=op.sort,
                 group_keys=op.group_keys if op.group_keys is not None else no_default,
@@ -513,22 +522,24 @@
 ):
     if not as_index and df.op.output_types[0] == OutputType.series:
         raise TypeError("as_index=False only valid with DataFrame")
 
     output_types = (
         [OutputType.dataframe_groupby] if df.ndim == 2 else [OutputType.series_groupby]
     )
+    is_list_by = isinstance(by, (list, tuple))
     if isinstance(by, (SERIES_TYPE, pd.Series)):
         if isinstance(by, pd.Series):
             by = asseries(by)
         by = [by]
     elif df.ndim > 1 and by is not None and not isinstance(by, list):
         by = [by]
     op = DataFrameGroupByOperand(
         by=by,
         level=level,
         as_index=as_index,
         sort=sort,
         group_keys=group_keys if group_keys is not no_default else None,
+        is_list_by=is_list_by,
         output_types=output_types,
     )
     return op(df)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/cum.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/cum.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/custom_aggregation.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/custom_aggregation.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/fill.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/fill.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/getitem.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/getitem.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/head.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/head.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/nunique.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/nunique.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/sample.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/sample.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/sort.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/sort.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/groupby/transform.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/groupby/transform.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/add_prefix_suffix.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/add_prefix_suffix.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/align.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/align.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/at.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/at.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/getitem.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/getitem.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/iat.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/iat.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/iloc.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/iloc.py`

 * *Files 0% similar despite different names*

```diff
@@ -537,24 +537,26 @@
         if tileds is not None:
             return tileds
 
         handler = DataFrameIlocIndexesHandler()
         return [(yield from handler.handle(op))]
 
     @classmethod
-    def execute(cls, ctx, op):
+    def execute(cls, ctx, op: "SeriesIlocGetItem"):
         chunk = op.outputs[0]
         series = ctx[op.input.key]
         if len(op.inputs) > 1:
             indexes = tuple(
                 ctx[index.key] if hasattr(index, "key") else index
                 for index in op.indexes
             )
         else:
             indexes = tuple(op.indexes)
+        if op.is_gpu() and len(indexes) == 1:
+            indexes = indexes[0]
         if hasattr(series, "iloc"):
             ctx[chunk.key] = series.iloc[indexes]
         else:
             # index, only happen for calling from rechunk
             ctx[chunk.key] = series[indexes if len(indexes) > 1 else indexes[0]]
 
     def __call__(self, series):
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/index_lib.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/index_lib.py`

 * *Files 0% similar despite different names*

```diff
@@ -274,17 +274,15 @@
             "dtypes": None,
         }
         if index_info.input_axis == 0:
             if is_full_slice(index):
                 kw["index_value"] = chunk_input.index_value
             else:
                 index = chunk_input.index_value.to_pandas()
-                start, stop = index.slice_locs(
-                    slc.start, slc.stop, slc.step, kind="loc"
-                )
+                start, stop = index.slice_locs(slc.start, slc.stop, slc.step)
                 pos_slc = slice(start, stop, slc.step)
                 kw["index_value"] = parse_index(
                     index[pos_slc], chunk_input, slc, store_data=False
                 )
         else:
             assert index_info.input_axis == 1
             dtypes = chunk_input.dtypes
@@ -327,15 +325,14 @@
     ) -> None:
         pd_index = index_value.to_pandas()
         # turn label-based slice into position-based slice
         start, end = pd_index.slice_locs(
             index_info.raw_index.start,
             index_info.raw_index.stop,
             index_info.raw_index.step,
-            kind="loc",
         )
         slc = slice(start, end, index_info.raw_index.step)
 
         cum_nsplit = [0] + np.cumsum(tileable.nsplits[index_info.input_axis]).tolist()
         # split position-based slice into chunk slices
         effected_i_to_slc = slice_split(slc, tileable.nsplits[index_info.input_axis])
         is_reversed = (slc.step or 0) < 0
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/insert.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/insert.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/loc.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/loc.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,15 +26,15 @@
 from ...core.operand import OperandStage
 from ...serialization.serializables import AnyField, KeyField, ListField
 from ...tensor.datasource import asarray
 from ...tensor.utils import calc_sliced_size, filter_inputs
 from ...utils import is_full_slice, lazy_import
 from ..core import DATAFRAME_TYPE, IndexValue
 from ..operands import DataFrameOperand, DataFrameOperandMixin
-from ..utils import is_index_value_identical, parse_index
+from ..utils import is_cudf, is_index_value_identical, parse_index
 from .iloc import DataFrameIlocSetItem
 from .index_lib import DataFrameLocIndexesHandler
 
 cudf = lazy_import("cudf")
 
 
 def process_loc_indexes(inp, indexes, fetch_index: bool = True):
@@ -285,17 +285,15 @@
         if is_full_slice(index):
             # full slice on this axis
             param["shape"] = inp.shape[axis]
             param["index_value"] = input_index_value
             if axis == 1:
                 param["dtypes"] = inp.dtypes
         elif input_index_value.has_value():
-            start, end = pd_index.slice_locs(
-                index.start, index.stop, index.step, kind="loc"
-            )
+            start, end = pd_index.slice_locs(index.start, index.stop, index.step)
             slc = slice(start, end, index.step)
             size = calc_sliced_size(inp.shape[axis], slc)
             param["shape"] = size
             out_index = pd_index[slc]
             param["index_value"] = parse_index(out_index, store_data=axis == 1)
             if axis == 1:
                 param["dtypes"] = inp.dtypes[slc]
@@ -526,15 +524,18 @@
                         new_indexes.append(index)
                     else:
                         new_indexes.append(index)
                 else:
                     new_indexes.append(index)
 
             try:
-                r = df.loc[tuple(new_indexes)]
+                if is_cudf(df) and len(new_indexes) == 1:
+                    r = df.loc[new_indexes[0]]
+                else:
+                    r = df.loc[tuple(new_indexes)]
                 if str_loc_on_datetime_index:
                     # convert back to DataFrame or Series
                     if r.ndim == 0:
                         index = df.index[df.index.get_loc(new_indexes[0])]
                         r = xdf.Series([r], index=[index])
                     elif r.ndim == 1:
                         rdf = xdf.DataFrame(columns=r.index)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/reindex.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/reindex.py`

 * *Files 1% similar despite different names*

```diff
@@ -328,15 +328,15 @@
             return series
 
     @classmethod
     def _reindex(cls, ctx, op, fill=True, try_sparse=None):
         inp = cls._convert_to_writable(ctx[op.input.key])
         index = cls._get_value(ctx, op.index)
         if op.index_freq is not None:
-            index = pd.Index(index, freq=op.index_freq)
+            index = type(pd.Index(index))(index, freq=op.index_freq)
         columns = cls._get_value(ctx, op.columns)
         kw = {"level": op.level}
         if index is not None and not isinstance(index, slice):
             kw["index"] = cls._convert_to_writable(index)
         if columns is not None and not isinstance(columns, slice):
             kw["columns"] = cls._convert_to_writable(columns)
         if fill:
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/rename.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/rename.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/rename_axis.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/rename_axis.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/reset_index.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/reset_index.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/sample.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/sample.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/set_axis.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/set_axis.py`

 * *Files 8% similar despite different names*

```diff
@@ -15,17 +15,17 @@
 
 import numpy as np
 import pandas as pd
 
 from ... import opcodes
 from ...core import ENTITY_TYPE, get_output_types, recursive_tile
 from ...serialization.serializables import AnyField, Int8Field, KeyField
-from ...utils import has_unknown_shape
+from ...utils import has_unknown_shape, is_same_module
 from ..operands import DataFrameOperand, DataFrameOperandMixin
-from ..utils import parse_index, validate_axis
+from ..utils import get_xdf, parse_index, validate_axis
 
 
 class DataFrameSetAxis(DataFrameOperand, DataFrameOperandMixin):
     _op_code_ = opcodes.DATAFRAME_SET_AXIS
 
     _input = KeyField("input")
     _axis = Int8Field("axis")
@@ -167,52 +167,62 @@
 
     @classmethod
     def execute(cls, ctx, op: "DataFrameSetAxis"):
         in_data = ctx[op.input.key]
         value = op.value
         if isinstance(value, ENTITY_TYPE):
             value = ctx[value.key]
-        ctx[op.outputs[0].key] = in_data.set_axis(value, axis=op.axis)
 
+        xdf = get_xdf(in_data)
+        if is_same_module(xdf, pd):
+            ctx[op.outputs[0].key] = in_data.set_axis(value, axis=op.axis)
+        else:
+            # cudf does not support set_axis.
+            if op.axis == 0:
+                in_data.index = value
+            else:
+                in_data.columns = value
+            ctx[op.outputs[0].key] = in_data
 
-def _set_axis(df_or_axis, labels, axis=0, inplace=False):
+
+def _set_axis(df_or_axis, labels, axis=0, copy=False):
     axis = validate_axis(axis, df_or_axis)
     if not isinstance(labels, ENTITY_TYPE) and not isinstance(labels, pd.Index):
         labels = pd.Index(labels)
 
     op = DataFrameSetAxis(value=labels, axis=axis)
     result = op(df_or_axis)
-    if inplace:
+    if not copy:
         df_or_axis.data = result.data
     else:
         return result
 
 
-def df_set_axis(df, labels, axis=0, inplace=False):
+def df_set_axis(df, labels, axis=0, copy=True):
     """
     Assign desired index to given axis.
 
     Indexes for column or row labels can be changed by assigning
     a list-like or Index.
 
     Parameters
     ----------
     labels : list-like, Index
         The values for the new index.
 
     axis : {0 or 'index', 1 or 'columns'}, default 0
         The axis to update. The value 0 identifies the rows, and 1 identifies the columns.
 
-    inplace : bool, default False
-        Whether to return a new DataFrame instance.
+    copy : bool, default True
+        Whether to make a copy of the underlying data.
 
     Returns
     -------
     renamed : DataFrame or None
-        An object of type DataFrame or None if ``inplace=True``.
+        An object of type DataFrame.
 
     See Also
     --------
     DataFrame.rename_axis : Alter the name of the index or columns.
 
     Examples
     --------
@@ -230,49 +240,40 @@
     Change the column labels.
 
     >>> df.set_axis(['I', 'II'], axis='columns').execute()
        I  II
     0  1   4
     1  2   5
     2  3   6
-
-    Now, update the labels inplace.
-
-    >>> df.set_axis(['i', 'ii'], axis='columns', inplace=True)
-    >>> df.execute()
-       i  ii
-    0  1   4
-    1  2   5
-    2  3   6
     """
-    return _set_axis(df, labels, axis=axis, inplace=inplace)
+    return _set_axis(df, labels, axis=axis, copy=copy)
 
 
-def series_set_axis(series, labels, axis=0, inplace=False):
+def series_set_axis(series, labels, axis=0, copy=True):
     """
     Assign desired index to given axis.
 
     Indexes for row labels can be changed by assigning
     a list-like or Index.
 
     Parameters
     ----------
     labels : list-like, Index
         The values for the new index.
 
     axis : {0 or 'index'}, default 0
         The axis to update. The value 0 identifies the rows.
 
-    inplace : bool, default False
+    copy : bool, default False
         Whether to return a new Series instance.
 
     Returns
     -------
     renamed : Series or None
-        An object of type Series or None if ``inplace=True``.
+        An object of type Series.
 
     See Also
     --------
     Series.rename_axis : Alter the name of the index.
 
     Examples
     --------
@@ -286,8 +287,8 @@
 
     >>> s.set_axis(['a', 'b', 'c'], axis=0).execute()
     a    1
     b    2
     c    3
     dtype: int64
     """
-    return _set_axis(series, labels, axis=axis, inplace=inplace)
+    return _set_axis(series, labels, axis=axis, copy=copy)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/set_index.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/set_index.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/setitem.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/setitem.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/utils.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/indexing/where.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/indexing/where.py`

 * *Files 2% similar despite different names*

```diff
@@ -18,15 +18,15 @@
 
 from ... import opcodes
 from ...core import ENTITY_TYPE, recursive_tile
 from ...serialization.serializables import AnyField, BoolField, Int32Field, StringField
 from ...tensor.utils import filter_inputs
 from ..core import DATAFRAME_TYPE, SERIES_TYPE
 from ..operands import DataFrameOperand, DataFrameOperandMixin
-from ..utils import build_df, build_series, validate_axis
+from ..utils import build_df, build_series, is_pandas_2, validate_axis
 
 
 class DataFrameWhere(DataFrameOperand, DataFrameOperandMixin):
     _op_type_ = opcodes.WHERE
 
     _input = AnyField("input")
     _cond = AnyField("cond")
@@ -118,22 +118,30 @@
         if isinstance(self.other, (pd.DataFrame, DATAFRAME_TYPE)):
             mock_other = build_df(self.other)
         elif isinstance(self.other, (pd.Series, SERIES_TYPE)):
             mock_other = build_series(self.other)
         else:
             mock_other = self.other
 
-        result_df = mock_obj.where(
-            np.zeros(mock_obj.shape).astype(bool),
-            other=mock_other,
-            axis=self.axis,
-            level=self.level,
-            errors=self.errors,
-            try_cast=self.try_cast,
-        )
+        if is_pandas_2():
+            result_df = mock_obj.where(
+                np.zeros(mock_obj.shape).astype(bool),
+                other=mock_other,
+                axis=self.axis,
+                level=self.level,
+            )
+        else:
+            result_df = mock_obj.where(
+                np.zeros(mock_obj.shape).astype(bool),
+                other=mock_other,
+                axis=self.axis,
+                level=self.level,
+                errors=self.errors,
+                try_cast=self.try_cast,
+            )
 
         inputs = filter_inputs([df_or_series, self.cond, self.other])
         if isinstance(df_or_series, DATAFRAME_TYPE):
             return self.new_dataframe(
                 inputs,
                 shape=df_or_series.shape,
                 dtypes=result_df.dtypes,
@@ -209,32 +217,22 @@
         if isinstance(cond, ENTITY_TYPE):
             cond = ctx[cond.key]
 
         other = op.other
         if isinstance(other, ENTITY_TYPE):
             other = ctx[other.key]
 
+        params = dict(axis=op.axis, level=op.level)
+        if not is_pandas_2():
+            params["errors"] = op.errors
+            params["try_cast"] = op.try_cast
         if op.replace_true:
-            ctx[out_obj.key] = input_data.mask(
-                cond,
-                other,
-                axis=op.axis,
-                level=op.level,
-                errors=op.errors,
-                try_cast=op.try_cast,
-            )
+            ctx[out_obj.key] = input_data.mask(cond, other, **params)
         else:
-            ctx[out_obj.key] = input_data.where(
-                cond,
-                other,
-                axis=op.axis,
-                level=op.level,
-                errors=op.errors,
-                try_cast=op.try_cast,
-            )
+            ctx[out_obj.key] = input_data.where(cond, other, **params)
 
 
 _doc_template = """
 Replace values where the condition is {replace_true}.
 
 Parameters
 ----------
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/initializer.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/initializer.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/merge/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/merge/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/merge/append.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/merge/append.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/merge/concat.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/merge/concat.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/merge/merge.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/merge/merge.py`

 * *Files 5% similar despite different names*

```diff
@@ -110,25 +110,35 @@
                 df = df.reset_index(to_reset_index_names)
 
         filters = hash_dataframe_on(df, shuffle_on, op.index_shuffle_size)
 
         # shuffle on index
         for index_idx, index_filter in enumerate(filters):
             reducer_index = (index_idx, chunk.index[1])
-            if index_filter is not None and index_filter is not list():
+            # for MultiIndex in cudf,
+            # get each line of df and then concat them.
+            if is_cudf(df) and isinstance(df.index, cudf.MultiIndex):
+                filtered_dfs = [
+                    df.iloc[int(index) : int(index) + 1]
+                    for index in index_filter.values
+                ]
+                if filtered_dfs:
+                    filtered_df = cudf.concat(filtered_dfs, axis=0)
+                else:  # empty dataframe
+                    filtered_df = df.iloc[0:0]
                 ctx[chunk.key, reducer_index] = (
                     op.mapper_id,
                     ctx.get_current_chunk().index,
-                    df.iloc[index_filter],
+                    filtered_df,
                 )
             else:
                 ctx[chunk.key, reducer_index] = (
                     op.mapper_id,
                     ctx.get_current_chunk().index,
-                    None,
+                    df.iloc[index_filter],
                 )
 
     @classmethod
     def execute_reduce(cls, ctx, op: "DataFrameMergeAlign"):
         for i, chunk in enumerate(op.outputs):
             input_idx_to_df = {
                 partition_index: data
@@ -227,15 +237,15 @@
             self.left_index,
             self.right_index,
         ]
         return self.new_dataframe(
             [left, right],
             shape=(np.nan, merged.shape[1]),
             dtypes=merged.dtypes,
-            index_value=parse_index(merged.index, *index_tokenize_objects),
+            index_value=parse_index(merged.index[:0], *index_tokenize_objects),
             columns_value=parse_index(merged.columns, store_data=True),
         )
 
     @classmethod
     def _gen_map_chunk(
         cls,
         chunk: DataFrameChunk,
@@ -851,34 +861,78 @@
             else:
                 index = hash_dataframe_on(right, on=op.on, size=split_info.nsplits)[
                     split_info.split_index
                 ]
                 right = right.iloc[index]
 
         def execute_merge(x, y):
+            """
+            All merge and join operations are transformed into specific merge operations.
+            In particular, for join operations on the GPU without the ``on`` column
+            (CUDF does not support join with ``on`` parameter),
+            The key of merge is always transformed into a column on one side (left_on / right_on) and
+            an index on the other side (left_index=True / right_index=True).
+            In this case, CUDF takes the result of the ``on`` column as the index instead of the data column,
+            which is different from pandas.
+            so we should reset the index before the real calculation, and
+            then restore the column to the ``on`` data column.
+            """
+            left_index = None
+            left_on = None
+            right_index = None
+            right_on = None
+            rename_mapping = None
+            magic_index_col_name = "__index__"
             if not op.gpu:
                 kwargs = dict(
                     copy=op.copy, validate=op.validate, indicator=op.indicator
                 )
-            else:  # pragma: no cover
+            else:
                 # cudf doesn't support 'validate' and 'copy'
                 kwargs = dict(indicator=op.indicator)
-            return x.merge(
+                # TODO: support MultiIndex case
+                if not (
+                    isinstance(x.index, cudf.MultiIndex)
+                    or isinstance(y.index, cudf.MultiIndex)
+                ):
+                    if op.how == "left" and op.left_index is True:
+                        x.index.name = magic_index_col_name
+                        x = x.reset_index()
+                        left_on = magic_index_col_name
+                        left_index = False
+                        rename_mapping = {magic_index_col_name: op.right_on}
+                    elif op.how == "right" and op.right_index is True:
+                        y.index.name = magic_index_col_name
+                        y = y.reset_index()
+                        right_on = magic_index_col_name
+                        right_index = False
+                        rename_mapping = {magic_index_col_name: op.left_on}
+
+            res = x.merge(
                 y,
                 how=op.how,
                 on=op.on,
-                left_on=op.left_on,
-                right_on=op.right_on,
-                left_index=op.left_index,
-                right_index=op.right_index,
+                left_on=left_on if left_on is not None else op.left_on,
+                right_on=right_on if right_on is not None else op.right_on,
+                left_index=left_index if left_index is not None else op.left_index,
+                right_index=right_index if right_index is not None else op.right_index,
                 sort=op.sort,
                 suffixes=op.suffixes,
                 **kwargs,
             )
 
+            if rename_mapping is not None:
+                col = list(rename_mapping.values())[0]
+                if col in res.columns:
+                    res[col] = res[magic_index_col_name]
+                    res = res.drop(columns=[magic_index_col_name])
+                else:
+                    res = res.rename(columns=rename_mapping)
+            return res
+
         # workaround for: https://github.com/pandas-dev/pandas/issues/27943
         try:
             r = execute_merge(left, right)
         except ValueError:
             r = execute_merge(left.copy(deep=True), right.copy(deep=True))
 
         # make sure column's order
@@ -1109,14 +1163,20 @@
         "broadcast",
     ]:  # pragma: no cover
         raise NotImplementedError(f"{method} merge is not supported")
     if auto_merge not in ["both", "none", "before", "after"]:  # pragma: no cover
         raise ValueError(
             f"auto_merge can only be `both`, `none`, `before` or `after`, got {auto_merge}"
         )
+    if (df.op.gpu or right.op.gpu) and bloom_filter is not False:
+        logger.warning(
+            "Currently we do not support ``bloom_filter`` option on GPU, due to some limitations of CUDF."
+        )
+        bloom_filter = False
+
     if bloom_filter not in [True, False, "auto"]:
         raise ValueError(
             f'bloom_filter can only be True, False, or "auto", got {bloom_filter}'
         )
     if bloom_filter_options:
         if not isinstance(bloom_filter_options, dict):
             raise TypeError(
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/missing/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/missing/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/missing/checkna.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/missing/checkna.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/missing/dropna.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/missing/dropna.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/missing/fillna.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/missing/fillna.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,15 +26,15 @@
 from ..align import (
     align_dataframe_dataframe,
     align_dataframe_series,
     align_series_series,
 )
 from ..core import DATAFRAME_TYPE, SERIES_TYPE
 from ..operands import DataFrameOperand, DataFrameOperandMixin
-from ..utils import validate_axis
+from ..utils import is_pandas_2, validate_axis
 
 
 class FillNA(DataFrameOperand, DataFrameOperandMixin):
     _op_type_ = opcodes.FILL_NA
 
     _value = AnyField(
         "value", on_serialize=lambda x: x.data if isinstance(x, Entity) else x
@@ -160,17 +160,26 @@
         )
 
         if method == "bfill":
             concat_df = pd.concat([input_data, valid_summary], axis=axis)
         else:
             concat_df = pd.concat([valid_summary, input_data], axis=axis)
 
-        concat_df.fillna(
-            method=method, axis=axis, inplace=True, limit=limit, downcast=op.downcast
-        )
+        if is_pandas_2():
+            concat_df = concat_df.fillna(
+                method=method, axis=axis, limit=limit, downcast=op.downcast
+            )
+        else:
+            concat_df.fillna(
+                method=method,
+                axis=axis,
+                inplace=True,
+                limit=limit,
+                downcast=op.downcast,
+            )
         ctx[op.outputs[0].key] = cls._get_first_slice(op, concat_df, -1)
 
     @classmethod
     def execute(cls, ctx, op):
         try:
             pd.set_option("mode.use_inf_as_na", op.use_inf_as_na)
             if op.stage == OperandStage.map:
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/missing/replace.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/missing/replace.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/operands.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/operands.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/plotting/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/plotting/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/plotting/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/plotting/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/aggregation.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/aggregation.py`

 * *Files 2% similar despite different names*

```diff
@@ -14,15 +14,15 @@
 # limitations under the License.
 
 import copy
 import functools
 import itertools
 from collections import OrderedDict
 from collections.abc import Iterable
-from typing import Dict, List
+from typing import Callable, Dict, List, Union
 
 import numpy as np
 import pandas as pd
 
 from ... import opcodes
 from ... import tensor as mars_tensor
 from ...config import options
@@ -36,15 +36,24 @@
     Int32Field,
     ListField,
 )
 from ...utils import ceildiv, enter_current_session, lazy_import, pd_release_version
 from ..core import INDEX_CHUNK_TYPE
 from ..merge import DataFrameConcat
 from ..operands import DataFrameOperand, DataFrameOperandMixin
-from ..utils import build_df, build_empty_df, build_series, parse_index, validate_axis
+from ..utils import (
+    build_df,
+    build_empty_df,
+    build_series,
+    is_cudf,
+    is_dataframe,
+    is_series,
+    parse_index,
+    validate_axis,
+)
 from .core import CustomReduction, ReductionAggStep, ReductionCompiler, ReductionSteps
 
 cp = lazy_import("cupy", rename="cp")
 cudf = lazy_import("cudf")
 
 _agg_size_as_series = pd_release_version >= (1, 3, 0)
 
@@ -858,14 +867,65 @@
             else:
                 concat_df = concat_df[op.outputs[0].columns_value.to_pandas()]
 
             concat_df = concat_df.astype(op.outputs[0].dtypes, copy=False)
         ctx[op.outputs[0].key] = concat_df
 
     @classmethod
+    def _handle_cudf_agg_error(
+        cls,
+        func_name: Union[str, List[str], Callable, List[Callable]],
+        exception: Exception,
+    ):
+        if callable(func_name) or (
+            isinstance(func_name, list) and any([callable(f) for f in func_name])
+        ):
+            raise NotImplementedError(
+                "Cudf does not support callable type aggregation functions for now. "
+                "Please try to replace them with string type ones."
+            ) from exception
+        else:
+            raise RuntimeError(f"Cudf error: {str(exception)}") from exception
+
+    @classmethod
+    def _cudf_agg(cls, op: "DataFrameAggregate", in_data):
+        data = in_data
+        if is_series(in_data):
+            data = in_data.to_frame()
+            # cudf to_frame doc: https://docs.rapids.ai/api/cudf/stable/api_docs/api/cudf.series.to_frame
+            # The `name` option is None by default, but the actual behaviour sets the name to `0`
+            # So define the columns manually
+            data.columns = [in_data.name]
+
+        func_name = (
+            op.func_rename[0] or op.func[0] if len(op.func) == 1 else op.func_rename
+        )
+        # df.agg doesn't support the parameter axis in cudf
+        # when axis is not None, cudf raises Error
+        # ref: https://docs.rapids.ai/api/cudf/stable/api_docs/api/cudf.dataframe.agg
+        axis = op.axis if op.axis == 1 else None
+        result = None
+        try:
+            result = data.agg(func_name, axis=axis)
+        except Exception as error:
+            if isinstance(func_name, str):
+                try:
+                    result = getattr(data, func_name)(axis=axis)
+                except Exception as e:
+                    cls._handle_cudf_agg_error(func_name, e)
+            else:
+                cls._handle_cudf_agg_error(func_name, error)
+
+        if is_series(result) and op.output_types[0] == OutputType.scalar:
+            result = result[0]
+        elif is_dataframe(result) and op.output_types[0] == OutputType.series:
+            result = result.iloc[:, 0]
+        return result
+
+    @classmethod
     @redirect_custom_log
     @enter_current_session
     def execute(cls, ctx, op: "DataFrameAggregate"):
         try:
             pd.set_option("mode.use_inf_as_na", op.use_inf_as_na)
             if op.stage == OperandStage.map:
                 cls._execute_map(ctx, op)
@@ -888,15 +948,18 @@
                 elif (
                     op.output_types[0] == OutputType.scalar
                     and in_data.shape == (0,)
                     and callable(op.func[0])
                 ):
                     result = op.func[0](in_data)
                 else:
-                    result = in_data.agg(op.raw_func, axis=op.axis)
+                    if is_cudf(in_data):
+                        result = cls._cudf_agg(op, in_data)
+                    else:
+                        result = in_data.agg(op.raw_func, axis=op.axis)
                     if op.outputs[0].ndim == 1:
                         result = result.astype(op.outputs[0].dtype, copy=False)
 
                 if op.output_types[0] == OutputType.tensor:
                     result = xp.array(result)
                 ctx[op.outputs[0].key] = result
         finally:
@@ -1017,21 +1080,33 @@
     combine_size = kw.pop("_combine_size", None) or options.combine_size
     numeric_only = kw.pop("_numeric_only", None)
     bool_only = kw.pop("_bool_only", None)
 
     output_type = kw.pop("_output_type", None)
     dtypes = kw.pop("_dtypes", None)
     index = kw.pop("_index", None)
+    raw_func_name = kw.pop("_func_name", None)
 
     if not is_funcs_aggregate(func, func_kw=kw, ndim=df.ndim):
         return df.transform(func, axis=axis, _call_agg=True)
 
+    func_rename = (
+        (
+            [raw_func_name]
+            if raw_func_name
+            else (func if isinstance(func, list) else [func])
+        )
+        if df.op.gpu
+        else None
+    )
+
     op = DataFrameAggregate(
         raw_func=copy.deepcopy(func),
         raw_func_kw=copy.deepcopy(kw),
+        func_rename=func_rename,
         axis=axis,
         combine_size=combine_size,
         numeric_only=numeric_only,
         bool_only=bool_only,
         use_inf_as_na=use_inf_as_na,
     )
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/all.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/all.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/any.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/any.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -41,14 +41,15 @@
 from ..core import SERIES_TYPE
 from ..operands import DATAFRAME_TYPE, DataFrameOperand, DataFrameOperandMixin
 from ..utils import (
     build_df,
     build_empty_df,
     build_empty_series,
     build_series,
+    is_cudf,
     parse_index,
     validate_axis,
 )
 
 # in pandas<1.3, when aggregating with multiple levels and numeric_only is True,
 # object cols not ignored with min-max funcs
 _level_reduction_keep_object = pd_release_version[:2] < (1, 3)
@@ -297,14 +298,15 @@
                 axis=op.axis or 0,
                 _numeric_only=op.numeric_only,
                 _bool_only=op.bool_only,
                 _combine_size=op.combine_size,
                 _output_type=output_type,
                 _dtypes=dtypes,
                 _index=index,
+                _func_name=getattr(op, "_func_name"),
             )
         )
         return [out_df]
 
     def _call_groupby_level(self, df, level):
         return df.groupby(level=level).agg(
             self.get_reduction_callable(self), method=self.method
@@ -328,15 +330,19 @@
                 index=df.dtypes.index if axis == 0 else None,
             )
             reduced_cols = list(reduced.index)
             reduced_dtype = reduced.dtype
         elif func_name == "custom_reduction":
             empty_df = build_df(df, ensure_string=True)
             reduced = getattr(self, "custom_reduction").__call_agg__(empty_df)
-            reduced_cols = list(reduced.index)
+            reduced_cols = (
+                list(reduced.index.to_pandas())
+                if is_cudf(reduced)
+                else list(reduced.index)
+            )
             reduced_dtype = reduced.dtype
         else:
             reduced_cols, dtypes = [], []
             for col, src_dt in df.dtypes.items():
                 dt = _get_df_reduction_dtype(
                     src_dt,
                     func_name,
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/count.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/count.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/cummax.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/cummax.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/cummin.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/cummin.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/cumprod.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/cumprod.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/cumsum.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/cumsum.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/custom_reduction.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/custom_reduction.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/kurtosis.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/kurtosis.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/max.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/max.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/mean.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/mean.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/min.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/min.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/nunique.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/nunique.py`

 * *Files 2% similar despite different names*

```diff
@@ -56,15 +56,15 @@
         xdf = cudf if self.is_gpu() else pd
         if isinstance(in_data, xdf.Series):
             unique_values = in_data.drop_duplicates()
             return xdf.Series(unique_values, name=in_data.name)
         else:
             if self._axis == 0:
                 data = dict()
-                for d, v in in_data.iteritems():
+                for d, v in in_data.items():
                     if not self._use_arrow_dtype or xdf is cudf:
                         data[d] = [v.drop_duplicates().to_list()]
                     else:
                         data[d] = self._drop_duplicates_to_arrow(v)
                 df = xdf.DataFrame(data)
             else:
                 df = xdf.DataFrame(columns=[0])
@@ -79,15 +79,15 @@
         xdf = cudf if self.is_gpu() else pd
         if isinstance(in_data, xdf.Series):
             unique_values = in_data.explode().drop_duplicates()
             return xdf.Series(unique_values, name=in_data.name)
         else:
             if self._axis == 0:
                 data = dict()
-                for d, v in in_data.iteritems():
+                for d, v in in_data.items():
                     if not self._use_arrow_dtype or xdf is cudf:
                         data[d] = [v.explode().drop_duplicates().to_list()]
                     else:
                         v = pd.Series(v.to_numpy())
                         data[d] = self._drop_duplicates_to_arrow(v, explode=True)
                 df = xdf.DataFrame(data)
             else:
@@ -100,17 +100,15 @@
             return df
 
     def post(self, in_data):  # noqa: W0221  # pylint: disable=arguments-differ
         xdf = cudf if self.is_gpu() else pd
         if isinstance(in_data, xdf.Series):
             return in_data.explode().nunique(dropna=self._dropna)
         else:
-            in_data_iter = (
-                in_data.iteritems() if self._axis == 0 else in_data.iterrows()
-            )
+            in_data_iter = in_data.items() if self._axis == 0 else in_data.iterrows()
             data = dict()
             for d, v in in_data_iter:
                 if isinstance(v.dtype, ArrowListDtype):
                     v = xdf.Series(v.to_numpy())
                 data[d] = v.explode().nunique(dropna=self._dropna)
             return xdf.Series(data)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/prod.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/prod.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/reduction_size.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/reduction_size.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/sem.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/sem.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/skew.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/skew.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/std.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/std.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/str_concat.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/str_concat.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/sum.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/sum.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/unique.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/unique.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/reduction/var.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/reduction/var.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/sort/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/sort/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/sort/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/sort/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/sort/psrs.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/sort/psrs.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/sort/sort_index.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/sort/sort_index.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/sort/sort_values.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/sort/sort_values.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/statistics/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/statistics/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/statistics/corr.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/statistics/corr.py`

 * *Files 4% similar despite different names*

```diff
@@ -28,14 +28,15 @@
 
 class DataFrameCorr(DataFrameOperand, DataFrameOperandMixin):
     _op_type_ = opcodes.CORR
 
     other = KeyField("other", default=None)
     method = AnyField("method", default=None)
     min_periods = Int32Field("min_periods", default=None)
+    numeric_only = BoolField("numeric_only", default=None)
     axis = Int32Field("axis", default=None)
     drop = BoolField("drop", default=None)
 
     def _set_inputs(self, inputs):
         super()._set_inputs(inputs)
         inputs_iter = iter(self._inputs)
         next(inputs_iter)
@@ -213,32 +214,37 @@
 
     @classmethod
     def execute(cls, ctx, op: "DataFrameCorr"):
         inp = op.inputs[0]
         out = op.outputs[0]
         inp_data = ctx[inp.key]
 
+        kws = dict(method=op.method)
         if inp.ndim == 1:
-            ctx[out.key] = inp_data.corr(
-                ctx[op.other.key], method=op.method, min_periods=op.min_periods
-            )
+            kws["min_periods"] = op.min_periods
+            ctx[out.key] = inp_data.corr(ctx[op.other.key], **kws)
         elif op.axis is None:
-            ctx[out.key] = inp_data.corr(method=op.method, min_periods=op.min_periods)
+            kws["min_periods"] = op.min_periods
+            if pd.__version__ >= "1.5.0":
+                kws["numeric_only"] = op.numeric_only
+            ctx[out.key] = inp_data.corr(**kws)
         else:
-            ctx[out.key] = inp_data.corrwith(
-                ctx[op.other.key], method=op.method, axis=op.axis, drop=op.drop
-            )
+            kws["drop"] = op.drop
+            kws["axis"] = op.axis
+            if pd.__version__ >= "1.5.0":
+                kws["numeric_only"] = op.numeric_only
+            ctx[out.key] = inp_data.corrwith(ctx[op.other.key], **kws)
 
 
 def _check_supported_methods(method):
     if method != "pearson":
         raise NotImplementedError(f"Correlation method {method!r} not supported")
 
 
-def df_corr(df, method="pearson", min_periods=1):
+def df_corr(df, method="pearson", min_periods=1, numeric_only=False):
     """
     Compute pairwise correlation of columns, excluding NA/null values.
 
     Parameters
     ----------
     method : {'pearson', 'kendall', 'spearman'} or callable
         Method of correlation:
@@ -255,14 +261,17 @@
             kendall, spearman and callables not supported on multiple chunks yet.
 
     min_periods : int, optional
         Minimum number of observations required per pair of columns
         to have a valid result. Currently only available for Pearson
         and Spearman correlation.
 
+    numeric_only : bool, default False
+        Include only float, int or boolean data.
+
     Returns
     -------
     DataFrame
         Correlation matrix.
 
     See Also
     --------
@@ -276,19 +285,21 @@
     >>> df = md.DataFrame([(.2, .3), (.0, .6), (.6, .0), (.2, .1)],
     ...                   columns=['dogs', 'cats'])
     >>> df.corr(method='pearson').execute()
               dogs      cats
     dogs  1.000000 -0.851064
     cats -0.851064  1.000000
     """
-    op = DataFrameCorr(method=method, min_periods=min_periods)
+    op = DataFrameCorr(
+        method=method, min_periods=min_periods, numeric_only=numeric_only
+    )
     return op(df)
 
 
-def df_corrwith(df, other, axis=0, drop=False, method="pearson"):
+def df_corrwith(df, other, axis=0, drop=False, method="pearson", numeric_only=False):
     """
     Compute pairwise correlation.
 
     Pairwise correlation is computed between rows or columns of
     DataFrame with rows or columns of Series or DataFrame. DataFrames
     are first aligned along both axes before computing the
     correlations.
@@ -309,29 +320,33 @@
         * kendall : Kendall Tau correlation coefficient
         * spearman : Spearman rank correlation
         * callable: callable with input two 1d ndarrays
             and returning a float.
 
         .. note::
             kendall, spearman and callables not supported on multiple chunks yet.
+    numeric_only : bool, default False
+        Include only float, int or boolean data.
 
     Returns
     -------
     Series
         Pairwise correlations.
 
     See Also
     --------
     DataFrame.corr : Compute pairwise correlation of columns.
     """
     axis = validate_axis(axis, df)
     if drop:
         # TODO implement with df.align(method='inner')
         raise NotImplementedError("drop=True not implemented")
-    op = DataFrameCorr(other=other, method=method, axis=axis, drop=drop)
+    op = DataFrameCorr(
+        other=other, method=method, axis=axis, drop=drop, numeric_only=numeric_only
+    )
     return op(df)
 
 
 def series_corr(series, other, method="pearson", min_periods=None):
     """
     Compute correlation with `other` Series, excluding missing values.
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/statistics/quantile.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/statistics/quantile.py`

 * *Files 2% similar despite different names*

```diff
@@ -121,15 +121,18 @@
         if isinstance(self._q, TENSOR_TYPE):
             q_val = self._q
             pd_index = pd.Index([], dtype=q_val.dtype)
             name = None
             store_index_value = False
         else:
             q_val = np.asanyarray(self._q)
-            pd_index = pd.Index(q_val)
+            if np.isscalar(self._q):
+                pd_index = pd.Index([self._q])
+            else:
+                pd_index = pd.Index(q_val)
             name = self._q if q_val.size == 1 else None
             store_index_value = True
         tokenize_objects = (a, q_val, self._interpolation, type(self).__name__)
 
         if q_val.ndim == 0 and self._axis == 0:
             index_value = parse_index(dtypes.index, store_data=store_index_value)
             shape = (len(dtypes),)
@@ -204,15 +207,18 @@
     def _call_series(self, a, inputs):
         if isinstance(self._q, TENSOR_TYPE):
             q_val = self._q
             index_val = pd.Index([], dtype=q_val.dtype)
             store_index_value = False
         else:
             q_val = np.asanyarray(self._q)
-            index_val = pd.Index(q_val)
+            if np.isscalar(self._q):
+                index_val = pd.Index([self._q])
+            else:
+                index_val = pd.Index(q_val)
             store_index_value = True
 
         # get dtype by tensor
         a_t = astensor(a)
         self._dtype = dtype = tensor_quantile(
             a_t,
             self._q,
@@ -397,25 +403,25 @@
     else:
         q_input = None
 
     op = DataFrameQuantile(q=q, interpolation=interpolation, gpu=series.op.gpu)
     return op(series, q_input=q_input)
 
 
-def quantile_dataframe(df, q=0.5, axis=0, numeric_only=True, interpolation="linear"):
+def quantile_dataframe(df, q=0.5, axis=0, numeric_only=False, interpolation="linear"):
     """
     Return values at the given quantile over requested axis.
 
     Parameters
     ----------
     q : float or array-like, default 0.5 (50% quantile)
         Value between 0 <= q <= 1, the quantile(s) to compute.
     axis : {0, 1, 'index', 'columns'} (default 0)
         Equals 0 or 'index' for row-wise, 1 or 'columns' for column-wise.
-    numeric_only : bool, default True
+    numeric_only : bool, default False
         If False, the quantile of datetime and timedelta data will be
         computed as well.
     interpolation : {'linear', 'lower', 'higher', 'midpoint', 'nearest'}
         This optional parameter specifies the interpolation method to use,
         when the desired quantile lies between two data points `i` and `j`:
         * linear: `i + (j - i) * fraction`, where `fraction` is the
           fractional part of the index surrounded by `i` and `j`.
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/tseries/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/tseries/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/tseries/to_datetime.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/tseries/to_datetime.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/ufunc/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/ufunc/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/ufunc/tensor.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/ufunc/tensor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/ufunc/ufunc.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/ufunc/ufunc.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/utils.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -27,14 +27,16 @@
 from pandas.api.types import is_string_dtype
 from pandas.core.dtypes.cast import find_common_type
 
 from ..config import options
 from ..core import Entity, ExecutableTuple
 from ..core.context import Context
 from ..lib.mmh3 import hash as mmh_hash
+from ..storage import StorageLevel
+from ..tensor.array_utils import is_cupy
 from ..tensor.utils import dictify_chunk_size, normalize_chunk_sizes
 from ..typing import ChunkType, TileableType
 from ..utils import (
     ModulePlaceholder,
     is_full_slice,
     lazy_import,
     parse_readable_size,
@@ -57,39 +59,79 @@
         return mmh_hash(sbytes(x)) % size
 
     f = functools.partial(func, size=size)
     idx_to_grouped = index.groupby(index.map(f))
     return [idx_to_grouped.get(i, list()) for i in range(size)]
 
 
+def _get_hash(
+    data: Union[
+        pd.DataFrame, pd.Series, pd.Index, "cudf.DataFrame", "cudf.Series", "cudf.Index"
+    ],
+    **kwargs,
+) -> Union[pd.Series, "cudf.Series"]:
+    """
+    The hash value of the cudf object is obtained by the ``hash_values`` interface.
+    Specifically, for the Index obj in cudf, convert it to DataFrame first.
+    """
+    return (
+        (data.to_frame().hash_values() if is_index(data) else data.hash_values())
+        if is_cudf(data)
+        else pd.util.hash_pandas_object(data, **kwargs)
+    )
+
+
+def _get_index_for_on(
+    data: Union[pd.Series, "cudf.Series"], size: int
+) -> List[Union[pd.Index, "cudf.Index"]]:
+    if is_cudf(data):
+        # Since cudf does not support groupby for RangeIndex,
+        # the following code is the equivalent implementation in the pandas (CPU) case.
+        series = cudf.Series(range(len(data)))
+        # reset_index(drop=True) is required,
+        # since series groupby will raise an exception if the index has duplicate values
+        groups = (data % size).reset_index(drop=True)
+        groupby = series.groupby(groups)
+        result = []
+        for i in range(size):
+            try:
+                idx = cudf.Index(groupby.get_group(i).drop_duplicates())
+            except KeyError:
+                idx = cudf.Index([])
+            result.append(idx)
+        return result
+    else:
+        idx_to_grouped = pd.RangeIndex(0, len(data)).groupby(data % size)
+        return [idx_to_grouped.get(i, pd.Index([])) for i in range(size)]
+
+
 def hash_dataframe_on(df, on, size, level=None):
     if on is None:
         idx = df.index
         if level is not None:
             idx = idx.to_frame(False)[level]
-        if cudf and isinstance(idx, cudf.Index):  # pragma: no cover
-            idx = idx.to_pandas()
-        hashed_label = pd.util.hash_pandas_object(idx, categorize=False)
+        hashed_label = _get_hash(idx, categorize=False)
     elif callable(on):
         # todo optimization can be added, if ``on`` is a numpy ufunc or sth can be vectorized
-        hashed_label = pd.util.hash_pandas_object(df.index.map(on), categorize=False)
+        # TODO: cudf index may not have attribute ``map``
+        hashed_label = _get_hash(df.index.map(on), categorize=False)
     else:
         if isinstance(on, list):
             to_concat = []
             for v in on:
-                if isinstance(v, pd.Series):
+                if is_series(v):
                     to_concat.append(v)
                 else:
                     to_concat.append(df[v])
-            data = pd.concat(to_concat, axis=1)
+            xpd = cudf if is_cudf(df) else pd
+            data = xpd.concat(to_concat, axis=1)
         else:
             data = df[on]
-        hashed_label = pd.util.hash_pandas_object(data, index=False, categorize=False)
-    idx_to_grouped = pd.RangeIndex(0, len(hashed_label)).groupby(hashed_label % size)
-    return [idx_to_grouped.get(i, pd.Index([])) for i in range(size)]
+        hashed_label = _get_hash(data, index=False, categorize=False)
+    return _get_index_for_on(hashed_label, size)
 
 
 def hash_dtypes(dtypes, size):
     hashed_indexes = hash_index(dtypes.index, size)
     return [dtypes[index] for index in hashed_indexes]
 
 
@@ -291,17 +333,25 @@
             if isinstance(index, pd.IntervalIndex):
                 return None
             raise
         except TypeError:
             return None
 
     def _serialize_index(index):
-        tp = getattr(IndexValue, type(index).__name__)
+        extra_properties = dict(_name=index.name)
+        if not is_pandas_2():
+            tp = getattr(IndexValue, type(index).__name__)
+        else:
+            # pandas 2.0 does not have `Int64Index`, `Float64Index`, etc.
+            name = type(index).__name__
+            if name == "Index":
+                extra_properties["_dtype"] = index.dtype
+            tp = getattr(IndexValue, type(index).__name__)
         properties = _extract_property(index, tp, store_data)
-        properties["_name"] = index.name
+        properties.update(extra_properties)
         return tp(**properties)
 
     def _serialize_range_index(index):
         if is_pd_range_empty(index):
             properties = {
                 "_is_monotonic_increasing": True,
                 "_is_monotonic_decreasing": False,
@@ -1156,16 +1206,15 @@
 
     if index_size is None:
         return df_or_series._fetch(session=session)
     else:
         head = iloc(df_or_series)[:index_size]
         tail = iloc(df_or_series)[-index_size:]
         head_data, tail_data = ExecutableTuple([head, tail]).fetch(session=session)
-        xdf = cudf if head.op.is_gpu() else pd
-        return xdf.concat([head_data, tail_data], axis="index")
+        return pd.concat([head_data, tail_data], axis="index")
 
 
 class ReprSeries(pd.Series):
     def __init__(self, corner_data, real_shape):
         super().__init__(corner_data)
         self._real_shape = real_shape
 
@@ -1336,14 +1385,24 @@
 def is_cudf(x):
     if cudf is not None:  # pragma: no cover
         if isinstance(x, (cudf.DataFrame, cudf.Series, cudf.Index)):
             return True
     return False
 
 
+def get_storage_level_gpu_or_memory(data: Any) -> StorageLevel:
+    if isinstance(data, (tuple, list, set)):
+        return (
+            StorageLevel.GPU
+            if any([is_cudf(v) or is_cupy(v) for v in data])
+            else StorageLevel.MEMORY
+        )
+    return StorageLevel.GPU if is_cudf(data) or is_cupy(data) else StorageLevel.MEMORY
+
+
 def auto_merge_chunks(
     ctx: Context,
     df_or_series: TileableType,
     merged_file_size: Union[int, float, str] = None,
 ) -> TileableType:
     from .merge import DataFrameConcat
 
@@ -1438,7 +1497,11 @@
     # In cudf, concat with axis=1 and ignore_index=False by default behaves opposite to pandas.
     # Cudf would reset the index when axis=1 and ignore_index=False, which does not match with its document.
     # Therefore, we deal with this case specially.
     result = xdf.concat(objs, axis=1)
     if xdf is cudf:
         result.index = objs[0].index
     return result
+
+
+def is_pandas_2():
+    return pd.__version__ >= "2.0.0"
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/window/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/window/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/window/aggregation.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/window/aggregation.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/window/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/window/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/window/ewm/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/window/ewm/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/window/ewm/aggregation.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/window/ewm/aggregation.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/window/ewm/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/window/ewm/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/window/expanding/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/window/expanding/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/window/expanding/aggregation.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/window/expanding/aggregation.py`

 * *Files 5% similar despite different names*

```diff
@@ -17,14 +17,15 @@
 from functools import partial
 
 import numpy as np
 import pandas as pd
 
 from .... import opcodes
 from ....serialization.serializables import BoolField
+from ...utils import is_pandas_2
 from ..aggregation import BaseDataFrameExpandingAgg
 
 _stage_info = namedtuple(
     "_stage_info",
     (
         "map_groups",
         "map_sources",
@@ -146,17 +147,20 @@
         else:  # pragma: no cover
             raise NotImplementedError
 
     @classmethod
     def _execute_map_function(cls, op: "DataFrameExpandingAgg", func, in_data):
         min_periods = 1 if op.min_periods > 0 else 0
 
-        expanding = in_data.expanding(
-            min_periods=min_periods, center=op.center, axis=op.axis
-        )
+        if is_pandas_2():
+            expanding = in_data.expanding(min_periods=min_periods, axis=op.axis)
+        else:
+            expanding = in_data.expanding(
+                min_periods=min_periods, center=op.center, axis=op.axis
+            )
         if func == "var":
             result = expanding.var(ddof=0)
         else:
             result = expanding.agg(func)
 
         if op.output_agg:
             summary = result.iloc[len(result) - 1 : len(result)]
@@ -168,11 +172,14 @@
     def _execute_combine_function(
         cls, op: "DataFrameExpandingAgg", func, pred_inputs, local_inputs, func_cols
     ):
         return func(pred_inputs, local_inputs, axis=op.axis)
 
     @classmethod
     def _execute_raw_function(cls, op: "DataFrameExpandingAgg", in_data):
-        expanding = in_data.expanding(
-            min_periods=op.min_periods, center=op.center, axis=op.axis
-        )
+        if is_pandas_2():
+            expanding = in_data.expanding(min_periods=op.min_periods, axis=op.axis)
+        else:
+            expanding = in_data.expanding(
+                min_periods=op.min_periods, center=op.center, axis=op.axis
+            )
         return expanding.agg(op.func)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/window/expanding/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/window/expanding/core.py`

 * *Files 9% similar despite different names*

```diff
@@ -11,37 +11,29 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from collections import OrderedDict
 
-from ....serialization.serializables import (
-    BoolField,
-    Int32Field,
-    Int64Field,
-    StringField,
-)
+from ....serialization.serializables import Int32Field, Int64Field, StringField
 from ....utils import pd_release_version
 from ...utils import validate_axis
 from ..core import Window
 
 _window_has_method = pd_release_version >= (1, 3, 0)
 
 
 class Expanding(Window):
     _min_periods = Int64Field("min_periods")
     _axis = Int32Field("axis")
-    _center = BoolField("center")
     _method = StringField("method")
 
-    def __init__(self, min_periods=None, axis=None, center=None, method=None, **kw):
-        super().__init__(
-            _min_periods=min_periods, _axis=axis, _center=center, _method=method, **kw
-        )
+    def __init__(self, min_periods=None, axis=None, method=None, **kw):
+        super().__init__(_min_periods=min_periods, _axis=axis, _method=method, **kw)
 
     @property
     def min_periods(self):
         return self._min_periods
 
     @property
     def axis(self):
@@ -59,17 +51,17 @@
         return df.expanding(**self.params)
 
     @property
     def params(self):
         p = OrderedDict()
 
         if not _window_has_method:  # pragma: no cover
-            args = ["min_periods", "center", "axis"]
+            args = ["min_periods", "axis"]
         else:
-            args = ["min_periods", "center", "axis", "method"]
+            args = ["min_periods", "axis", "method"]
 
         for k in args:
             p[k] = getattr(self, k)
         return p
 
     def aggregate(self, func, **kwargs):
         from .aggregation import DataFrameExpandingAgg
@@ -101,24 +93,23 @@
     def var(self):
         return self.aggregate("var")
 
     def std(self):
         return self.aggregate("std")
 
 
-def expanding(obj, min_periods=1, center=False, axis=0):
+def expanding(obj, min_periods=1, axis=0):
     """
     Provide expanding transformations.
 
     Parameters
     ----------
     min_periods : int, default 1
     Minimum number of observations in window required to have a value
     (otherwise result is NA).
-    center : bool, default False
     Set the labels at the center of the window.
     axis : int or str, default 0
 
     Returns
     -------
     a Window sub-classed for the particular operation
 
@@ -150,13 +141,11 @@
     1  1.0
     2  3.0
     3  3.0
     4  7.0
     """
     axis = validate_axis(axis, obj)
 
-    if center:
-        raise NotImplementedError("center == True is not supported")
     if axis == 1:
         raise NotImplementedError("axis other than 0 is not supported")
 
-    return Expanding(input=obj, min_periods=min_periods, center=center, axis=axis)
+    return Expanding(input=obj, min_periods=min_periods, axis=axis)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/window/rolling/__init__.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/window/rolling/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/window/rolling/aggregation.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/window/rolling/aggregation.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/dataframe/window/rolling/core.py` & `xorbits-0.3.0/xorbits/_mars/dataframe/window/rolling/core.py`

 * *Files 1% similar despite different names*

```diff
@@ -20,15 +20,15 @@
     BoolField,
     Int32Field,
     Int64Field,
     StringField,
 )
 from ....utils import pd_release_version
 from ...core import DATAFRAME_TYPE
-from ...utils import build_empty_df, build_empty_series, validate_axis
+from ...utils import build_empty_df, build_empty_series, is_pandas_2, validate_axis
 from ..core import Window
 
 _window_has_method = pd_release_version >= (1, 3, 0)
 
 
 class Rolling(Window):
     _window = AnyField("window")
@@ -138,14 +138,16 @@
             empty_obj = build_empty_series(
                 self._input.dtype, index=pd_index[:0], name=self._input.name
             )
         pd_rolling = empty_obj.rolling(**self.params)
         for k in self.params:
             # update value according to pandas rolling
             setattr(self, "_" + k, getattr(pd_rolling, k))
+        if is_pandas_2() and pd_rolling._win_freq_i8 is not None:
+            setattr(self, "_win_type", "freq")
 
     def aggregate(self, func, *args, **kwargs):
         from .aggregation import DataFrameRollingAgg
 
         op = DataFrameRollingAgg(
             func=func, func_args=args, func_kwargs=kwargs, **self.params
         )
```

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/__init__.py` & `xorbits-0.3.0/xorbits/_mars/deploy/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/kubedl/__init__.py` & `xorbits-0.3.0/xorbits/_mars/deploy/kubedl/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/kubedl/client.py` & `xorbits-0.3.0/xorbits/_mars/deploy/kubedl/client.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/kubedl/config.py` & `xorbits-0.3.0/xorbits/_mars/deploy/kubedl/config.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/__init__.py` & `xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/client.py` & `xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/client.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/config.py` & `xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/config.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/core.py` & `xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/supervisor.py` & `xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/supervisor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/kubernetes/worker.py` & `xorbits-0.3.0/xorbits/_mars/deploy/kubernetes/worker.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/oscar/__init__.py` & `xorbits-0.3.0/xorbits/_mars/deploy/oscar/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/oscar/base_config.yml` & `xorbits-0.3.0/xorbits/_mars/deploy/oscar/base_config.yml`

 * *Files 1% similar despite different names*

```diff
@@ -3,15 +3,14 @@
   - session
   - storage
   - meta
   - lifecycle
   - scheduling
   - subtask
   - task
-  - mutable
 cluster:
   backend: fixed
   node_timeout: 120
   node_check_interval: 1
 session:
   custom_log_dir: null
 storage:
```

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/oscar/cmdline.py` & `xorbits-0.3.0/xorbits/_mars/deploy/oscar/cmdline.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/oscar/local.py` & `xorbits-0.3.0/xorbits/_mars/deploy/oscar/local.py`

 * *Files 2% similar despite different names*

```diff
@@ -275,15 +275,15 @@
         if cuda_devices == "auto":
             total = cuda_count()
             all_devices = np.arange(total)
             return [list(arr) for arr in np.array_split(all_devices, n_worker)]
 
         else:
             if not cuda_devices:
-                return []
+                return [[]] * n_worker
             elif isinstance(cuda_devices[0], int):
                 assert n_worker == 1
                 return [cuda_devices]
             else:
                 assert len(cuda_devices) == n_worker
                 return cuda_devices
 
@@ -332,21 +332,24 @@
         )
         self.supervisor_address = self._supervisor_pool.external_address
 
     async def _start_worker_pools(self):
         worker_modules = get_third_party_modules_from_config(
             self._config, NodeRole.WORKER
         )
-        for band_to_resource in self._bands_to_resource:
+        for band_to_resource, worker_devices in zip(
+            self._bands_to_resource, self._cuda_devices
+        ):
             worker_pool = await create_worker_actor_pool(
                 self._address,
                 band_to_resource,
                 modules=worker_modules,
                 subprocess_start_method=self._subprocess_start_method,
                 metrics=self._config.get("metrics", {}),
+                cuda_devices=worker_devices,
                 web=self._web,
                 # passing logging conf to config logging when create pools
                 logging_conf=self._log_config,
                 oscar_config=self._config.get("oscar"),
             )
             self._worker_pools.append(worker_pool)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/oscar/pool.py` & `xorbits-0.3.0/xorbits/_mars/deploy/oscar/pool.py`

 * *Files 2% similar despite different names*

```diff
@@ -12,23 +12,21 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import configparser
 import logging
 import os
-import sys
 import time
 from typing import Any, Dict, List, Optional, Tuple
 
 from ....utils import get_default_logging_config_file_path
 from ...constants import (
     DEFAULT_MARS_LOG_BACKUP_COUNT,
     DEFAULT_MARS_LOG_DIR,
-    DEFAULT_MARS_LOG_DIR_WIN,
     DEFAULT_MARS_LOG_FILE_NAME,
     DEFAULT_MARS_LOG_MAX_BYTES,
     MARS_LOG_DIR_KEY,
 )
 from ...oscar import create_actor_pool
 from ...resource import Resource, cuda_count
 
@@ -148,22 +146,16 @@
             config["formatter_console"]["format"] = root_fmt
             config["formatters"]["keys"] += ",console"
             config["handler_stream_handler"]["formatter"] = "console"
     return config, log_config_path
 
 
 def _get_or_create_default_log_dir() -> str:
-    if sys.platform.startswith("win"):
-        log_dir = DEFAULT_MARS_LOG_DIR_WIN
-    else:
-        log_dir = DEFAULT_MARS_LOG_DIR
-
-    os.makedirs(log_dir, exist_ok=True)
-    os.chmod(log_dir, mode=0o777)
-    return log_dir
+    os.makedirs(DEFAULT_MARS_LOG_DIR, exist_ok=True)
+    return DEFAULT_MARS_LOG_DIR
 
 
 def _get_log_subdir(log_dir: Optional[str], subdir_prefix: Optional[str]) -> str:
     if log_dir is None:
         log_dir = _get_or_create_default_log_dir()
     if not os.path.exists(log_dir):
         raise RuntimeError(f"Log directory does not exist: {log_dir}")
@@ -297,19 +289,32 @@
             external_address_schemes.extend(
                 [numa_external_address_scheme for _ in range(num_cpus)]
             )
             enable_internal_addresses.extend(
                 [numa_enable_internal_address for _ in range(num_cpus)]
             )
 
+    # handle n_io_process
+    n_process += n_io_process
+    # sub-pools for IO(transfer and spill)
+    for _ in range(n_io_process):
+        if envs:  # pragma: no cover
+            envs.append({"CUDA_VISIBLE_DEVICES": "-1"})
+        labels.append("io")
+        if external_address_schemes:
+            # just use main process' scheme for IO process
+            external_address_schemes.append(external_address_schemes[0])
+        if enable_internal_addresses:
+            # just use main process' setting for IO process
+            enable_internal_addresses.append(enable_internal_addresses[0])
+
     return await create_actor_pool(
         address,
         n_process=n_process,
         ports=ports,
-        n_io_process=n_io_process,
         labels=labels,
         envs=envs,
         modules=modules,
         subprocess_start_method=subprocess_start_method,
         suspend_sigint=_need_suspend_sigint(),
         external_address_schemes=external_address_schemes,
         enable_internal_addresses=enable_internal_addresses,
```

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/oscar/service.py` & `xorbits-0.3.0/xorbits/_mars/deploy/oscar/service.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/oscar/session.py` & `xorbits-0.3.0/xorbits/_mars/deploy/oscar/session.py`

 * *Files 2% similar despite different names*

```diff
@@ -26,15 +26,14 @@
 from dataclasses import dataclass
 from functools import wraps
 from numbers import Integral
 from typing import Any, Callable, Coroutine, Dict, List, Optional, Tuple, Union
 from urllib.parse import urlparse
 from weakref import WeakKeyDictionary, WeakSet, ref
 
-import numpy as np
 import xoscar as mo
 from xoscar.metrics import Metrics
 
 from ...config import options
 from ...core import ChunkType, TileableGraph, TileableType, enter_mode
 from ...core.operand import Fetch
 from ...lib.aio import (
@@ -43,15 +42,14 @@
     get_isolation,
     new_isolation,
     stop_isolation,
 )
 from ...services.cluster import AbstractClusterAPI, ClusterAPI
 from ...services.lifecycle import AbstractLifecycleAPI, LifecycleAPI
 from ...services.meta import AbstractMetaAPI, MetaAPI
-from ...services.mutable import MutableAPI, MutableTensor
 from ...services.session import AbstractSessionAPI, SessionAPI
 from ...services.storage import StorageAPI
 from ...services.task import AbstractTaskAPI, TaskAPI, TaskResult
 from ...services.task.execution.api import Fetcher
 from ...services.web import OscarWebAPI
 from ...typing import BandType, ClientType
 from ...utils import (
@@ -374,63 +372,14 @@
         Parameters
         ----------
         session_id : str
             Session ID.
         name : str
         """
 
-    @abstractmethod
-    async def create_mutable_tensor(
-        self,
-        shape: tuple,
-        dtype: Union[np.dtype, str],
-        name: str = None,
-        default_value: Union[int, float] = 0,
-        chunk_size: Union[int, Tuple] = None,
-    ):
-        """
-        Create a mutable tensor.
-
-        Parameters
-        ----------
-        shape: tuple
-            Shape of the mutable tensor.
-
-        dtype: np.dtype or str
-            Data type of the mutable tensor.
-
-        name: str, optional
-            Name of the mutable tensor, a random name will be used if not specified.
-
-        default_value: optional
-            Default value of the mutable tensor. Default is 0.
-
-        chunk_size: int or tuple, optional
-            Chunk size of the mutable tensor.
-
-        Returns
-        -------
-            MutableTensor
-        """
-
-    @abstractmethod
-    async def get_mutable_tensor(self, name: str):
-        """
-        Get a mutable tensor by name.
-
-        Parameters
-        ----------
-        name: str
-            Name of the mutable tensor to get.
-
-        Returns
-        -------
-            MutableTensor
-        """
-
     async def stop_server(self):
         """
         Stop server.
         """
 
 
 class AbstractSyncSession(AbstractSession, metaclass=ABCMeta):
@@ -593,63 +542,14 @@
 
         Returns
         -------
         web_endpoint : str
             web endpoint
         """
 
-    @abstractmethod
-    def create_mutable_tensor(
-        self,
-        shape: tuple,
-        dtype: Union[np.dtype, str],
-        name: str = None,
-        default_value: Union[int, float] = 0,
-        chunk_size: Union[int, Tuple] = None,
-    ):
-        """
-        Create a mutable tensor.
-
-        Parameters
-        ----------
-        shape: tuple
-            Shape of the mutable tensor.
-
-        dtype: np.dtype or str
-            Data type of the mutable tensor.
-
-        name: str, optional
-            Name of the mutable tensor, a random name will be used if not specified.
-
-        default_value: optional
-            Default value of the mutable tensor. Default is 0.
-
-        chunk_size: int or tuple, optional
-            Chunk size of the mutable tensor.
-
-        Returns
-        -------
-            MutableTensor
-        """
-
-    @abstractmethod
-    def get_mutable_tensor(self, name: str):
-        """
-        Get a mutable tensor by name.
-
-        Parameters
-        ----------
-        name: str
-            Name of the mutable tensor to get.
-
-        Returns
-        -------
-            MutableTensor
-        """
-
     def fetch_log(
         self,
         tileables: List[TileableType],
         offsets: List[int] = None,
         sizes: List[int] = None,
     ):
         from ...core.custom_log import fetch
@@ -752,28 +652,26 @@
         address: str,
         session_id: str,
         backend: str,
         session_api: AbstractSessionAPI,
         meta_api: AbstractMetaAPI,
         lifecycle_api: AbstractLifecycleAPI,
         task_api: AbstractTaskAPI,
-        mutable_api: MutableAPI,
         cluster_api: AbstractClusterAPI,
         web_api: Optional[OscarWebAPI],
         client: ClientType = None,
         timeout: float = None,
         request_rewriter: Callable = None,
     ):
         super().__init__(address, session_id)
         self._backend = backend
         self._session_api = session_api
         self._task_api = task_api
         self._meta_api = meta_api
         self._lifecycle_api = lifecycle_api
-        self._mutable_api = mutable_api
         self._cluster_api = cluster_api
         self._web_api = web_api
         self.client = client
         self.timeout = timeout
         self._request_rewriter = request_rewriter
 
         self._tileable_to_fetch = WeakKeyDictionary()
@@ -802,29 +700,27 @@
             # create new session
             session_id, session_address = await session_api.create_session(session_id)
         else:
             session_address = await session_api.get_session_address(session_id)
         lifecycle_api = await LifecycleAPI.create(session_id, session_address)
         meta_api = await MetaAPI.create(session_id, session_address)
         task_api = await TaskAPI.create(session_id, session_address)
-        mutable_api = await MutableAPI.create(session_id, session_address)
         cluster_api = await ClusterAPI.create(session_address)
         try:
             web_api = await OscarWebAPI.create(session_address)
         except mo.ActorNotExist:
             web_api = None
         return cls(
             address,
             session_id,
             backend,
             session_api,
             meta_api,
             lifecycle_api,
             task_api,
-            mutable_api,
             cluster_api,
             web_api,
             timeout=timeout,
         )
 
     @classmethod
     @implements(AbstractAsyncSession.init)
@@ -1079,19 +975,17 @@
                 self._session_id, self.address, band[1], self._request_rewriter
             )
         else:
             storage_api = await StorageAPI.create(self._session_id, band[0], band[1])
         return storage_api
 
     async def fetch(self, *tileables, **kwargs) -> list:
-        if kwargs:  # pragma: no cover
-            unexpected_keys = ", ".join(list(kwargs.keys()))
-            raise TypeError(f"`fetch` got unexpected arguments: {unexpected_keys}")
-
-        fetcher = Fetcher.create(self._backend, get_storage_api=self._get_storage_api)
+        fetcher = Fetcher.create(
+            self._backend, get_storage_api=self._get_storage_api, **kwargs
+        )
 
         with enter_mode(build=True):
             chunks = []
             get_chunk_metas = []
             fetch_infos_list = []
             for tileable in tileables:
                 fetch_tileable, indexes = self._get_to_fetch_tileable(tileable)
@@ -1302,31 +1196,14 @@
 
     async def get_remote_object(self, session_id: str, name: str):
         return await self._session_api.get_remote_object(session_id, name)
 
     async def destroy_remote_object(self, session_id: str, name: str):
         return await self._session_api.destroy_remote_object(session_id, name)
 
-    async def create_mutable_tensor(
-        self,
-        shape: tuple,
-        dtype: Union[np.dtype, str],
-        name: str = None,
-        default_value: Union[int, float] = 0,
-        chunk_size: Union[int, Tuple] = None,
-    ):
-        tensor_info = await self._mutable_api.create_mutable_tensor(
-            shape, dtype, name, default_value, chunk_size
-        )
-        return tensor_info, self._mutable_api
-
-    async def get_mutable_tensor(self, name: str):
-        tensor_info = await self._mutable_api.get_mutable_tensor(name)
-        return tensor_info, self._mutable_api
-
     async def stop_server(self):
         if self.client:
             await self.client.stop()
 
 
 class _IsolatedWebSession(_IsolatedSession):
     @classmethod
@@ -1338,37 +1215,34 @@
         new: bool = True,
         timeout: float = None,
         request_rewriter: Callable = None,
     ):
         from ...services.cluster import WebClusterAPI
         from ...services.lifecycle import WebLifecycleAPI
         from ...services.meta import WebMetaAPI
-        from ...services.mutable import WebMutableAPI
         from ...services.session import WebSessionAPI
         from ...services.task import WebTaskAPI
 
         session_api = WebSessionAPI(address, request_rewriter)
         if new:
             # create new session
             session_id, _ = await session_api.create_session(session_id)
         lifecycle_api = WebLifecycleAPI(session_id, address, request_rewriter)
         meta_api = WebMetaAPI(session_id, address, request_rewriter)
         task_api = WebTaskAPI(session_id, address, request_rewriter)
-        mutable_api = WebMutableAPI(session_id, address, request_rewriter)
         cluster_api = WebClusterAPI(address, request_rewriter)
 
         return cls(
             address,
             session_id,
             backend,
             session_api,
             meta_api,
             lifecycle_api,
             task_api,
-            mutable_api,
             cluster_api,
             None,
             timeout=timeout,
             request_rewriter=request_rewriter,
         )
 
     async def get_web_endpoint(self) -> Optional[str]:
@@ -1506,33 +1380,14 @@
         pass  # pragma: no cover
 
     @implements(AbstractAsyncSession.destroy_remote_object)
     @_delegate_to_isolated_session
     async def destroy_remote_object(self, session_id: str, name: str):
         pass  # pragma: no cover
 
-    @implements(AbstractAsyncSession.create_mutable_tensor)
-    async def create_mutable_tensor(
-        self,
-        shape: tuple,
-        dtype: Union[np.dtype, str],
-        name: str = None,
-        default_value: Union[int, float] = 0,
-        chunk_size: Union[int, Tuple] = None,
-    ):
-        tensor_info, mutable_api = await self._isolated_session.create_mutable_tensor(
-            shape, dtype, name, default_value, chunk_size
-        )
-        return MutableTensor.create(tensor_info, mutable_api, self._loop)
-
-    @implements(AbstractAsyncSession.get_mutable_tensor)
-    async def get_mutable_tensor(self, name: str):
-        tensor_info, mutable_api = await self._isolated_session.get_mutable_tensor(name)
-        return MutableTensor.create(tensor_info, mutable_api, self._loop)
-
     @implements(AbstractAsyncSession.get_web_endpoint)
     @_delegate_to_isolated_session
     async def get_web_endpoint(self) -> Optional[str]:
         pass  # pragma: no cover
 
     @implements(AbstractAsyncSession.stop_server)
     async def stop_server(self):
@@ -1744,37 +1599,14 @@
         pass  # pragma: no cover
 
     @implements(AbstractSyncSession.get_cluster_versions)
     @_delegate_to_isolated_session
     def get_cluster_versions(self) -> List[str]:
         pass  # pragma: no cover
 
-    @implements(AbstractSyncSession.create_mutable_tensor)
-    def create_mutable_tensor(
-        self,
-        shape: tuple,
-        dtype: Union[np.dtype, str],
-        name: str = None,
-        default_value: Union[int, float] = 0,
-        chunk_size: Union[int, Tuple] = None,
-    ):
-        coro = self._isolated_session.create_mutable_tensor(
-            shape, dtype, name, default_value, chunk_size
-        )
-        fut = asyncio.run_coroutine_threadsafe(coro, self._loop)
-        tensor_info, mutable_api = fut.result()
-        return MutableTensor.create(tensor_info, mutable_api, self._loop)
-
-    @implements(AbstractSyncSession.get_mutable_tensor)
-    def get_mutable_tensor(self, name: str):
-        coro = self._isolated_session.get_mutable_tensor(name)
-        fut = asyncio.run_coroutine_threadsafe(coro, self._loop)
-        tensor_info, mutable_api = fut.result()
-        return MutableTensor.create(tensor_info, mutable_api, self._loop)
-
     def destroy(self):
         coro = self._isolated_session.destroy()
         asyncio.run_coroutine_threadsafe(coro, self._loop).result()
         self.reset_default()
 
     def stop_server(self, isolation=True):
         try:
```

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/oscar/supervisor.py` & `xorbits-0.3.0/xorbits/_mars/deploy/oscar/supervisor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/oscar/worker.py` & `xorbits-0.3.0/xorbits/_mars/deploy/oscar/worker.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/utils.py` & `xorbits-0.3.0/xorbits/_mars/deploy/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/yarn/__init__.py` & `xorbits-0.3.0/xorbits/_mars/deploy/yarn/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/yarn/client.py` & `xorbits-0.3.0/xorbits/_mars/deploy/yarn/client.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/yarn/config.py` & `xorbits-0.3.0/xorbits/_mars/deploy/yarn/config.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/yarn/core.py` & `xorbits-0.3.0/xorbits/_mars/deploy/yarn/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/yarn/supervisor.py` & `xorbits-0.3.0/xorbits/_mars/deploy/yarn/supervisor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/deploy/yarn/worker.py` & `xorbits-0.3.0/xorbits/_mars/deploy/yarn/worker.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/base.py` & `xorbits-0.3.0/xorbits/_mars/learn/base.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/cluster/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/cluster/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_common.py` & `xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_common.py`

 * *Files 4% similar despite different names*

```diff
@@ -17,15 +17,15 @@
 
 from ... import opcodes
 from ... import tensor as mt
 from ...core import OutputType, recursive_tile
 from ...serialization.serializables import KeyField
 from ...tensor.array_utils import as_same_device, device, sparse
 from ...tensor.core import TensorOrder
-from ...utils import has_unknown_shape
+from ...utils import has_unknown_shape, is_same_module
 from ..operands import LearnOperand, LearnOperandMixin
 from ._k_means_fast import _inertia_dense, _inertia_sparse, merge_update_chunks
 
 
 class KMeansInertia(LearnOperand, LearnOperandMixin):
     _op_type_ = opcodes.KMEANS_INERTIA
 
@@ -128,17 +128,17 @@
             [ctx[inp.key] for inp in op.inputs],
             device=op.device,
             ret_extra=True,
             copy_if_not_writeable=True,
         )
 
         with device(device_id):
-            if xp is np:
+            if is_same_module(xp, np):
                 method = _inertia_dense
-            elif xp is sparse:
+            elif is_same_module(xp, sparse):
                 method = _inertia_sparse
             else:  # pragma: no cover
                 raise NotImplementedError("Cannot run inertial on GPU")
 
             result = method(x, sample_weight, centers, labels)
             ctx[op.outputs[0].key] = np.array([result])
```

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_elkan.pyx` & `xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_elkan.pyx`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_elkan_iter.py` & `xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_elkan_iter.py`

 * *Files 0% similar despite different names*

```diff
@@ -17,15 +17,15 @@
 
 from ... import opcodes
 from ...core import OutputType, recursive_tile
 from ...core.operand import OperandStage
 from ...serialization.serializables import BoolField, Int32Field, KeyField
 from ...tensor.array_utils import as_same_device, cp, device, sparse
 from ...tensor.core import TensorOrder
-from ...utils import has_unknown_shape
+from ...utils import has_unknown_shape, is_same_module
 from ..operands import LearnOperand, LearnOperandMixin
 from ._k_means_common import _execute_merge_update, _relocate_empty_clusters
 from ._k_means_elkan import (
     init_bounds_dense,
     init_bounds_sparse,
     update_chunk_dense,
     update_chunk_sparse,
@@ -189,28 +189,28 @@
             [ctx[inp.key] for inp in op.inputs],
             device=op.device,
             ret_extra=True,
             copy_if_not_writeable=True,
         )
 
         with device(device_id):
-            if xp is cp:  # pragma: no cover
+            if is_same_module(xp, cp):  # pragma: no cover
                 raise NotImplementedError("cannot support init_bounds for kmeans elkan")
 
             n_samples = x.shape[0]
             n_clusters = op.n_clusters
 
             labels = np.full(n_samples, -1, dtype=np.int32)
             upper_bounds = np.zeros(n_samples, dtype=x.dtype)
             lower_bounds = np.zeros((n_samples, n_clusters), dtype=x.dtype)
 
-            if xp is np:
+            if is_same_module(xp, np):
                 init_bounds = init_bounds_dense
             else:
-                assert xp is sparse
+                assert is_same_module(xp, sparse)
                 init_bounds = init_bounds_sparse
 
             init_bounds(
                 x, centers, center_half_distances, labels, upper_bounds, lower_bounds
             )
 
             ctx[op.outputs[0].key] = labels
@@ -525,17 +525,17 @@
             with device(device_id):
                 if not op.update_centers:
                     centers_new = centers_old.copy()
                 else:
                     centers_new = np.zeros_like(centers_old)
                 weight_in_clusters = np.zeros(op.n_clusters, dtype=x.dtype)
 
-                if xp is np:
+                if is_same_module(xp, np):
                     method = update_chunk_dense
-                elif xp is sparse:
+                elif is_same_module(xp, sparse):
                     method = update_chunk_sparse
                 else:  # pragma: no cover
                     raise NotImplementedError("Does not support run on GPU")
 
                 out_labels, out_upper_bounds, out_lower_bounds = (
                     labels.copy(),
                     upper_bounds.copy(),
```

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_fast.pyx` & `xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_fast.pyx`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_init.py` & `xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_init.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_lloyd.pyx` & `xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_lloyd.pyx`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/cluster/_k_means_lloyd_iter.py` & `xorbits-0.3.0/xorbits/_mars/learn/cluster/_k_means_lloyd_iter.py`

 * *Files 0% similar despite different names*

```diff
@@ -18,15 +18,15 @@
 
 from ... import opcodes
 from ...core import OutputType, recursive_tile
 from ...core.operand import OperandStage
 from ...serialization.serializables import BoolField, Int32Field, KeyField
 from ...tensor.array_utils import as_same_device, device, sparse
 from ...tensor.core import TensorOrder
-from ...utils import has_unknown_shape
+from ...utils import has_unknown_shape, is_same_module
 from ..operands import LearnOperand, LearnOperandMixin
 from ._k_means_common import _execute_merge_update, _relocate_empty_clusters
 from ._k_means_fast import update_center
 from ._k_means_lloyd import update_chunk_dense, update_chunk_sparse
 
 
 class KMeansLloydUpdate(LearnOperand, LearnOperandMixin):
@@ -241,17 +241,17 @@
                 if not op.update_centers:
                     centers_new = centers_old.copy()
                 else:
                     centers_new = np.zeros_like(centers_old)
                 weight_in_clusters = np.zeros(op.n_clusters, dtype=x.dtype)
                 centers_squared_norms = sklearn_row_norms(centers_old, squared=True)
 
-                if xp is np:
+                if is_same_module(xp, np):
                     method = update_chunk_dense
-                elif xp is sparse:
+                elif is_same_module(xp, sparse):
                     method = update_chunk_sparse
                 else:  # pragma: no cover
                     raise NotImplementedError("Does not support run on GPU")
                 out_labels = labels.copy()
                 method(
                     x,
                     sample_weight,
```

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/cluster/_kmeans.py` & `xorbits-0.3.0/xorbits/_mars/learn/cluster/_kmeans.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/joblib/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/joblib/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/joblib/backend.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/joblib/backend.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/_align.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/_align.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/_predict.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/_predict.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/_train.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/_train.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/classifier.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/classifier.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/core.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/ranker.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/ranker.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/lightgbm/regressor.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/lightgbm/regressor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/pytorch/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/pytorch/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/pytorch/dataset.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/pytorch/dataset.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/pytorch/run_script.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/pytorch/run_script.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/pytorch/sampler.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/pytorch/sampler.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/statsmodels/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/statsmodels/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/statsmodels/api.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/statsmodels/api.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/statsmodels/predict.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/statsmodels/predict.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/statsmodels/train.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/statsmodels/train.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/tensorflow/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/tensorflow/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/tensorflow/dataset.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/tensorflow/dataset.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/tensorflow/run_script.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/tensorflow/run_script.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/tsfresh/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/tsfresh/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/tsfresh/core.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/tsfresh/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/utils.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/classifier.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/classifier.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/core.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/dmatrix.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/dmatrix.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/predict.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/predict.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/regressor.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/regressor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/start_tracker.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/start_tracker.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/tracker.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/tracker.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/contrib/xgboost/train.py` & `xorbits-0.3.0/xorbits/_mars/learn/contrib/xgboost/train.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/datasets/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/datasets/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/datasets/samples_generator.py` & `xorbits-0.3.0/xorbits/_mars/learn/datasets/samples_generator.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/decomposition/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/decomposition/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/decomposition/_base.py` & `xorbits-0.3.0/xorbits/_mars/learn/decomposition/_base.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/decomposition/_pca.py` & `xorbits-0.3.0/xorbits/_mars/learn/decomposition/_pca.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/decomposition/_truncated_svd.py` & `xorbits-0.3.0/xorbits/_mars/learn/decomposition/_truncated_svd.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/ensemble/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/ensemble/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/ensemble/_bagging.py` & `xorbits-0.3.0/xorbits/_mars/learn/ensemble/_bagging.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/ensemble/_blockwise.py` & `xorbits-0.3.0/xorbits/_mars/learn/ensemble/_blockwise.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/ensemble/_iforest.py` & `xorbits-0.3.0/xorbits/_mars/learn/ensemble/_iforest.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/glm/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/glm/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/glm/_logistic.py` & `xorbits-0.3.0/xorbits/_mars/learn/glm/_logistic.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/glm/_optimizers.py` & `xorbits-0.3.0/xorbits/_mars/learn/glm/_optimizers.py`

 * *Files 12% similar despite different names*

```diff
@@ -13,43 +13,36 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import math
 
 import numpy as np
 
-from ... import execute
+from ... import remote as mr
 from ... import tensor as mt
 from ...tensor.datasource import tensor as astensor
 
 
-def softmax_loss_and_grad(W, X, y, reg):
+def instance_softmax_loss_and_sgd(W, X, y, loss_reg_W, i):
+    X = X[i].reshape((1, X[i].shape[0]))
+    y = y[i]
+
     N, D = X.shape
     K = W.shape[1]
 
-    y_obs = mt.zeros(shape=(N, K))
-    for i in range(N):
-        y_obs[i] = mt.eye(K)[y[i]]
-
-    loss = -1 / N * mt.sum(
-        y_obs * mt.log(mt.exp(X @ W) / mt.sum(mt.exp(X @ W), axis=1).reshape(-1, 1))
-    ) + 0.5 * reg * mt.sum(mt.square(W))
+    y_obs = mt.eye(K)[y]
+
+    exp_X_W_over_sum = mt.exp(X @ W) / mt.sum(mt.exp(X @ W), axis=1).reshape(-1, 1)
+
+    loss = -1 * mt.sum(y_obs * mt.log(exp_X_W_over_sum)) + loss_reg_W
 
     dW = mt.zeros(shape=(D, K))
 
     # Matrix approach
-    dW = (
-        -1
-        / N
-        * X.T
-        @ (y_obs - (mt.exp(X @ W) / mt.sum(mt.exp(X @ W), axis=1).reshape(-1, 1)))
-        + reg * W
-    )
-
-    execute(loss, dW)
+    dW = -1 * X.T @ (y_obs - (exp_X_W_over_sum))
 
     return loss, dW
 
 
 def gradient_descent(
     X,
     y,
@@ -70,23 +63,43 @@
     if fit_intercept:
         X = mt.hstack((X, mt.ones((num_train, 1))))
         W = 0.001 * mt.random.randn(dim + 1, num_classes).execute()
     else:
         X = astensor(X)
         W = 0.001 * mt.random.randn(dim, num_classes).execute()
 
+    X = X.execute()
+    y = y.execute()
+
     for _ in range(max_epochs):
         # perform mini-batch SGD update
         perm_idx = np.random.permutation(num_train)
         for it in range(num_iters_per_epoch):
-            # print(it, num_iters_per_epoch)
             idx = perm_idx[it * batch_size : (it + 1) * batch_size]
-            batch_x = X[idx]
-            batch_y = y[idx]
+            cur_W = W.execute()
+            loss_reg_W = (0.5 * reg * mt.sum(mt.square(W))).execute()
+            dW_reg_W = (reg * cur_W).execute()
+
+            funcs = [
+                mr.spawn(
+                    instance_softmax_loss_and_sgd,
+                    args=(
+                        cur_W,
+                        X,
+                        y,
+                        loss_reg_W,
+                        i,
+                    ),
+                )
+                for i in idx
+            ]
 
-            # evaluate loss and gradient
-            _, grad = softmax_loss_and_grad(W, batch_x, batch_y, reg)
+            outs = mr.ExecutableTuple(funcs).execute().fetch()
+            grad_tensors = [out[1] for out in outs]
 
             # update parameters
-            W = W - learning_rate * grad
+            W = (
+                cur_W
+                - learning_rate * (mt.sum(grad_tensors, axis=0) / len(idx) + dW_reg_W)
+            ).execute()
 
     return W
```

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/linear_model/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/linear_model/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/linear_model/_base.py` & `xorbits-0.3.0/xorbits/_mars/learn/linear_model/_base.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/_base.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/_base.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/_check_targets.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/_check_targets.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/_classification.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/_classification.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/_ranking.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/_ranking.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/_regresssion.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/_regresssion.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/_scorer.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/_scorer.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/core.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/cosine.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/cosine.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/euclidean.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/euclidean.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/haversine.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/haversine.py`

 * *Files 2% similar despite different names*

```diff
@@ -11,14 +11,16 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import numpy as np
 
+from ....utils import is_same_module
+
 try:
     from sklearn.neighbors import DistanceMetric as SklearnDistanceMetric
 except ImportError:  # pragma: no cover
     SklearnDistanceMetric = None
 
 from .... import opcodes as OperandDef
 from ....core import recursive_tile
@@ -91,15 +93,19 @@
     @classmethod
     def execute(cls, ctx, op):
         (x, y), device_id, xp = as_same_device(
             [ctx[inp.key] for inp in op.inputs], device=op.device, ret_extra=True
         )
 
         with device(device_id):
-            if xp is np and op.use_sklearn and SklearnDistanceMetric is not None:
+            if (
+                is_same_module(xp, np)
+                and op.use_sklearn
+                and SklearnDistanceMetric is not None
+            ):
                 # CPU and sklearn installed, delegate computation to sklearn
                 d = SklearnDistanceMetric.get_metric("haversine").pairwise(x, y)
             else:
                 # try to leverage xp(np, cp) to perform computation
                 sin_0 = xp.sin(0.5 * (x[:, [0]] - y[:, 0]))
                 sin_1 = xp.sin(0.5 * (x[:, [1]] - y[:, 1]))
                 d = 2 * xp.arcsin(
```

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/manhattan.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/manhattan.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/pairwise.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/pairwise.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/pairwise_distances_topk.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/pairwise_distances_topk.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,15 +26,15 @@
     DictField,
     Int64Field,
     KeyField,
 )
 from ....tensor.array_utils import as_same_device, device, get_array_module
 from ....tensor.core import TensorOrder
 from ....tensor.merge import TensorConcatenate
-from ....utils import ensure_own_data, has_unknown_shape
+from ....utils import ensure_own_data, has_unknown_shape, is_same_module
 from ...utils import gen_batches, get_chunk_n_rows
 from ...utils.validation import _num_samples
 from .core import PairwiseDistances
 
 
 def _precompute_metric_params(X, Y, xp, metric=None, **kwds):  # pragma: no cover
     """Precompute data-derived metric parameters if not provided"""
@@ -74,15 +74,15 @@
             % (actual_size if is_tuple else actual_size[0], chunk_size)
         )
 
 
 def _pariwise_distance_chunked(
     X, Y, reduce_func=None, metric="euclidean", working_memory=None, xp=None, **kwds
 ):
-    if xp is np:
+    if is_same_module(xp, np):
         from sklearn.metrics import pairwise_distances
     else:  # pragma: no cover
         from cuml.metrics import pairwise_distances
 
     n_samples_X = _num_samples(X)
     if metric == "precomputed":  # pragma: no cover
         slices = (slice(0, n_samples_X),)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/metrics/pairwise/rbf_kernel.py` & `xorbits-0.3.0/xorbits/_mars/learn/metrics/pairwise/rbf_kernel.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/model_selection/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/model_selection/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/model_selection/_split.py` & `xorbits-0.3.0/xorbits/_mars/learn/model_selection/_split.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/neighbors/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/neighbors/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/neighbors/_ball_tree.py` & `xorbits-0.3.0/xorbits/_mars/learn/neighbors/_ball_tree.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/neighbors/_faiss.py` & `xorbits-0.3.0/xorbits/_mars/learn/neighbors/_faiss.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/neighbors/_kd_tree.py` & `xorbits-0.3.0/xorbits/_mars/learn/neighbors/_kd_tree.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/neighbors/_kneighbors_graph.py` & `xorbits-0.3.0/xorbits/_mars/learn/neighbors/_kneighbors_graph.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/neighbors/_proxima.py` & `xorbits-0.3.0/xorbits/_mars/learn/neighbors/_proxima.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/neighbors/base.py` & `xorbits-0.3.0/xorbits/_mars/learn/neighbors/base.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/neighbors/tree.py` & `xorbits-0.3.0/xorbits/_mars/learn/neighbors/tree.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/neighbors/unsupervised.py` & `xorbits-0.3.0/xorbits/_mars/learn/neighbors/unsupervised.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/operands.py` & `xorbits-0.3.0/xorbits/_mars/learn/operands.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/preprocessing/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/preprocessing/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/preprocessing/_data.py` & `xorbits-0.3.0/xorbits/_mars/learn/preprocessing/_data.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/preprocessing/_label.py` & `xorbits-0.3.0/xorbits/_mars/learn/preprocessing/_label.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/preprocessing/normalize.py` & `xorbits-0.3.0/xorbits/_mars/learn/preprocessing/normalize.py`

 * *Files 1% similar despite different names*

```diff
@@ -11,14 +11,16 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import numpy as np
 
+from ...utils import is_same_module
+
 try:
     from sklearn.preprocessing import normalize as sklearn_normalize
 except ImportError:  # pragma: no cover
     sklearn_normalize = None
 
 from ... import opcodes as OperandDef
 from ... import tensor as mt
@@ -248,15 +250,15 @@
         norm = op.norm
         outs = op.outputs
 
         with device(device_id):
             if device_id < 0 and op.use_sklearn and sklearn_normalize is not None:
                 # no GPU
                 try:
-                    if xp is sparse:
+                    if is_same_module(xp, sparse):
                         if axis == 0:
                             xm = x.raw.tocsc()
                         else:
                             xm = x.raw
                     else:
                         xm = x
                     ret = sklearn_normalize(
```

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/proxima/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/proxima/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/proxima/core.py` & `xorbits-0.3.0/xorbits/_mars/learn/proxima/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/proxima/simple_index/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/proxima/simple_index/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/proxima/simple_index/builder.py` & `xorbits-0.3.0/xorbits/_mars/learn/proxima/simple_index/builder.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/proxima/simple_index/knn.py` & `xorbits-0.3.0/xorbits/_mars/learn/proxima/simple_index/knn.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/proxima/simple_index/recall.py` & `xorbits-0.3.0/xorbits/_mars/learn/proxima/simple_index/recall.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/proxima/simple_index/searcher.py` & `xorbits-0.3.0/xorbits/_mars/learn/proxima/simple_index/searcher.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/semi_supervised/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/semi_supervised/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/semi_supervised/_label_propagation.py` & `xorbits-0.3.0/xorbits/_mars/learn/semi_supervised/_label_propagation.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/utils/__init__.py` & `xorbits-0.3.0/xorbits/_mars/learn/utils/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/utils/_cython_blas.pxd` & `xorbits-0.3.0/xorbits/_mars/learn/utils/_cython_blas.pxd`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/utils/_cython_blas.pyx` & `xorbits-0.3.0/xorbits/_mars/learn/utils/_cython_blas.pyx`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/utils/_encode.py` & `xorbits-0.3.0/xorbits/_mars/learn/utils/_encode.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/utils/checks.py` & `xorbits-0.3.0/xorbits/_mars/learn/utils/checks.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/utils/collect_ports.py` & `xorbits-0.3.0/xorbits/_mars/learn/utils/collect_ports.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/utils/core.py` & `xorbits-0.3.0/xorbits/_mars/learn/utils/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/utils/extmath.py` & `xorbits-0.3.0/xorbits/_mars/learn/utils/extmath.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/utils/multiclass.py` & `xorbits-0.3.0/xorbits/_mars/learn/utils/multiclass.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/utils/shuffle.py` & `xorbits-0.3.0/xorbits/_mars/learn/utils/shuffle.py`

 * *Files 1% similar despite different names*

```diff
@@ -30,15 +30,15 @@
 from ...tensor.array_utils import get_array_module
 from ...tensor.utils import (
     check_random_state,
     decide_unify_split,
     gen_random_seeds,
     validate_axis,
 )
-from ...utils import has_unknown_shape, lazy_import, tokenize
+from ...utils import has_unknown_shape, is_same_module, lazy_import, tokenize
 from ..operands import LearnOperandMixin, LearnShuffleProxy, OutputType
 from ..utils import convert_to_tensor_or_dataframe
 
 cudf = lazy_import("cudf")
 
 
 def _shuffle_index_value(op, index_value, chunk_index=None):
@@ -344,15 +344,15 @@
 
     @classmethod
     def execute_single(cls, ctx, op):
         x = ctx[op.inputs[0].key]
         conv = lambda x: x
         if op.output_types[0] == OutputType.tensor:
             xp = get_array_module(x)
-            if xp is sparse:
+            if is_same_module(xp, sparse):
                 conv = lambda x: x
             else:
                 conv = (
                     xp.ascontiguousarray
                     if op.outputs[0].order.value == "C"
                     else xp.asfortranarray
                 )
@@ -432,15 +432,15 @@
         assert len(axes) == 1
         return xdf.concat(grid, axis=axes[0])
 
     @classmethod
     def _concat_series_grid(cls, grid, axes):
         assert axes == (0,) and grid.ndim == 1
 
-        return reduce(lambda a, b: a.append(b), grid)
+        return reduce(lambda a, b: pd.concat([a, b]), grid)
 
     @classmethod
     def _concat_tensor_grid(cls, grid, axes):
         cur = grid
         xp = get_array_module(grid.ravel()[0])
         for ax, i in zip(axes[:0:-1], range(len(axes) - 1, 0, -1)):
             new_shape = grid.shape[:i]
```

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/utils/sparsefuncs.py` & `xorbits-0.3.0/xorbits/_mars/learn/utils/sparsefuncs.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/utils/validation.py` & `xorbits-0.3.0/xorbits/_mars/learn/utils/validation.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/learn/wrappers.py` & `xorbits-0.3.0/xorbits/_mars/learn/wrappers.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/__init__.py` & `xorbits-0.3.0/xorbits/_mars/lib/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/aio/__init__.py` & `xorbits-0.3.0/xorbits/_mars/lib/aio/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/aio/_runners.py` & `xorbits-0.3.0/xorbits/_mars/lib/aio/_runners.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/aio/_threads.py` & `xorbits-0.3.0/xorbits/_mars/lib/aio/_threads.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/aio/file.py` & `xorbits-0.3.0/xorbits/_mars/lib/aio/file.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/aio/isolation.py` & `xorbits-0.3.0/xorbits/_mars/lib/aio/isolation.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/bloom_filter.py` & `xorbits-0.3.0/xorbits/_mars/lib/bloom_filter.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/compression.py` & `xorbits-0.3.0/xorbits/_mars/lib/compression.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/__init__.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/_glob.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/_glob.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/_oss_lib/__init__.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/_oss_lib/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/_oss_lib/common.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/_oss_lib/common.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/_oss_lib/glob.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/_oss_lib/glob.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/_oss_lib/handle.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/_oss_lib/handle.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/arrow.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/arrow.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/azure.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/azure.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/base.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/base.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/core.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/fsmap.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/fsmap.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/fsspec_adapter.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/fsspec_adapter.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/hdfs.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/hdfs.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/local.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/local.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/oss.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/oss.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/filesystem/s3.py` & `xorbits-0.3.0/xorbits/_mars/lib/filesystem/s3.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/groupby_wrapper.py` & `xorbits-0.3.0/xorbits/_mars/lib/groupby_wrapper.py`

 * *Files 6% similar despite different names*

```diff
@@ -42,15 +42,14 @@
         selection=None,
         as_index=True,
         sort=True,
         group_keys=_default_group_keys,
         squeeze=False,
         observed=False,
         dropna=True,
-        mutated=False,
         grouper_cache=None,
     ):
         def fill_value(v, key):
             return (
                 v if v is not None or groupby_obj is None else getattr(groupby_obj, key)
             )
 
@@ -61,29 +60,27 @@
         self.exclusions = fill_value(exclusions, "exclusions")
         self.selection = selection
         self.as_index = fill_value(as_index, "as_index")
         self.sort = fill_value(sort, "sort")
         self.group_keys = fill_value(group_keys, "group_keys")
         self.squeeze = fill_value(squeeze, "squeeze")
         self.observed = fill_value(observed, "observed")
-        self.mutated = fill_value(mutated, "mutated")
         self.dropna = fill_value(dropna, "dropna")
 
         if groupby_obj is None:
             groupby_kw = dict(
                 keys=keys,
                 axis=axis,
                 level=level,
                 grouper=grouper,
                 exclusions=exclusions,
                 as_index=as_index,
                 group_keys=group_keys,
                 squeeze=squeeze,
                 observed=observed,
-                mutated=mutated,
                 dropna=dropna,
             )
             if not _HAS_SQUEEZE:  # pragma: no branch
                 groupby_kw.pop("squeeze")
             if not _HAS_DROPNA:  # pragma: no branch
                 groupby_kw.pop("dropna")
 
@@ -112,15 +109,14 @@
             selection=item,
             as_index=self.as_index,
             sort=self.sort,
             group_keys=self.group_keys,
             squeeze=self.squeeze,
             observed=self.observed,
             dropna=self.dropna,
-            mutated=self.mutated,
         )
 
     def __getattr__(self, item):
         if item.startswith("_"):  # pragma: no cover
             return object.__getattribute__(self, item)
         if item in getattr(self.obj, "columns", ()):
             return self.__getitem__(item)
@@ -200,15 +196,14 @@
             self.selection,
             self.as_index,
             self.sort,
             self.group_keys,
             self.squeeze,
             self.observed,
             self.dropna,
-            self.mutated,
             getattr(self.groupby_obj.grouper, "_cache", dict()),
         )
 
     @classmethod
     def from_tuple(cls, tp):
         (
             obj,
@@ -219,15 +214,14 @@
             selection,
             as_index,
             sort,
             group_keys,
             squeeze,
             observed,
             dropna,
-            mutated,
             grouper_cache,
         ) = tp
 
         if isinstance(keys, (bytes, bytearray)):
             keys = cloudpickle.loads(keys)
 
         return cls(
@@ -239,15 +233,14 @@
             selection=selection,
             as_index=as_index,
             sort=sort,
             group_keys=group_keys,
             squeeze=squeeze,
             observed=observed,
             dropna=dropna,
-            mutated=mutated,
             grouper_cache=grouper_cache,
         )
 
 
 def wrapped_groupby(
     obj,
     by=None,
```

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/mkl_interface.py` & `xorbits-0.3.0/xorbits/_mars/lib/mkl_interface.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/mmh3_src/MurmurHash3.cpp` & `xorbits-0.3.0/xorbits/_mars/lib/mmh3_src/MurmurHash3.cpp`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/mmh3_src/MurmurHash3.h` & `xorbits-0.3.0/xorbits/_mars/lib/mmh3_src/MurmurHash3.h`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/mmh3_src/mmh3module.cpp` & `xorbits-0.3.0/xorbits/_mars/lib/mmh3_src/mmh3module.cpp`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/nvutils.py` & `xorbits-0.3.0/xorbits/_mars/lib/nvutils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/ordered_set.pyx` & `xorbits-0.3.0/xorbits/_mars/lib/ordered_set.pyx`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/sparse/__init__.py` & `xorbits-0.3.0/xorbits/_mars/lib/sparse/__init__.py`

 * *Files 0% similar despite different names*

```diff
@@ -14,14 +14,15 @@
 # limitations under the License.
 
 import builtins
 import operator
 from collections.abc import Iterable
 from functools import partial, reduce
 
+from ...utils import is_same_module
 from .array import SparseNDArray, call_sparse
 from .core import get_sparse_module, issparse
 from .matrix import SparseMatrix
 from .vector import SparseVector
 
 
 def asarray(x, shape=None):
@@ -116,15 +117,15 @@
         res = call_sparse(method, a, b, **kwargs)
     else:
         assert get_array_module(a) == get_array_module(b)
         xp = get_array_module(a)
         try:
             res = getattr(xp, method)(a, b, **kwargs)
         except TypeError:
-            if xp is cp and issparse(b):
+            if is_same_module(xp, cp) and issparse(b):
                 res = getattr(xp, method)(a, b.toarray(), **kwargs)
             else:
                 raise
 
     if res is NotImplemented:
         raise NotImplementedError
```

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/sparse/array.py` & `xorbits-0.3.0/xorbits/_mars/lib/sparse/array.py`

 * *Files 2% similar despite different names*

```diff
@@ -11,15 +11,15 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from functools import partialmethod
 
-from ...utils import ceildiv
+from ...utils import ceildiv, is_same_module
 from .core import (
     cp,
     cps,
     get_array_module,
     get_sparse_module,
     is_cupy,
     issparse,
@@ -77,15 +77,15 @@
     if make_dense:
         new_args = [arg.toarray() if hasattr(arg, "spmatrix") else arg for arg in args]
 
     xp = get_array_module(spmatrix)
     try:
         new_data = getattr(xp, method)(*new_args, **kwargs)
     except AttributeError:
-        if xp is np:
+        if is_same_module(xp, np):
             from scipy import special
         else:
             from cupyx.scipy import special
         new_data = getattr(special, method)(*new_args, **kwargs)
 
     if not make_dense:
         new_spmatrix = get_sparse_module(spmatrix).csr_matrix(
@@ -112,28 +112,28 @@
         else:
             return self.spmatrix.toarray()
 
     def todense(self):
         return self.toarray()
 
     def ascupy(self):
-        is_cp = get_array_module(self.spmatrix) is cp
+        is_cp = is_same_module(get_array_module(self.spmatrix), cp)
         if is_cp:
             return self
         mat_tuple = (
             cp.asarray(self.data),
             cp.asarray(self.indices),
             cp.asarray(self.indptr),
         )
         return SparseNDArray(
             cps.csr_matrix(mat_tuple, shape=self.spmatrix.shape), shape=self.shape
         )
 
     def asscipy(self):
-        is_cp = get_array_module(self.spmatrix) is cp
+        is_cp = is_same_module(get_array_module(self.spmatrix), cp)
         if not is_cp:
             return self
         return SparseNDArray(self.spmatrix.get(), shape=self.shape)
 
     def __array__(self, dtype=None):
         x = self.toarray()
         if dtype and x.dtype != dtype:
@@ -216,15 +216,15 @@
         x = self.spmatrix.toarray()
         if issparse(imag):
             imag = imag.toarray()
         x.imag = imag
         self.spmatrix = xps.csr_matrix(x)
 
     def __getattr__(self, attr):
-        is_cp = get_array_module(self.spmatrix) is cp
+        is_cp = is_same_module(get_array_module(self.spmatrix), cp)
         if attr == "device" and is_cp:
             try:
                 return self.spmatrix.device
             except NotImplementedError:
                 return cp.cuda.Device(0)
         if attr == "get" and is_cp:
             return lambda: SparseNDArray(self.spmatrix.get(), shape=self.shape)
@@ -676,15 +676,15 @@
 
     def reciprocal(self):
         return call_sparse("reciprocal", self)
 
     def _scipy_unary(self, func_name):
         spmatrix = self.spmatrix
         xp = get_array_module(spmatrix)
-        if xp is np:
+        if is_same_module(xp, np):
             from scipy import special
         else:
             from cupyx.scipy import special
 
         new_data = getattr(special, func_name)(spmatrix.data)
         new_spmatrix = get_sparse_module(spmatrix).csr_matrix(
             (new_data, spmatrix.indices, spmatrix.indptr), spmatrix.shape
@@ -695,15 +695,15 @@
         try:
             naked_other = naked(other)
         except TypeError:  # pragma: no cover
             return NotImplemented
 
         xp = get_array_module(self.spmatrix)
 
-        if xp is np:
+        if is_same_module(xp, np):
             from scipy import special
         else:  # pragma: no cover
             from cupyx.scipy import special
 
         func = getattr(special, func_name)
 
         if get_array_module(naked_other).isscalar(naked_other):  # pragma: no cover
```

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/sparse/core.py` & `xorbits-0.3.0/xorbits/_mars/lib/sparse/core.py`

 * *Files 6% similar despite different names*

```diff
@@ -18,15 +18,15 @@
 try:
     import scipy.sparse as sps
     import scipy.sparse.linalg as splinalg
 except ImportError:  # pragma: no cover
     sps = None
     splinalg = None
 
-from ...utils import lazy_import
+from ...utils import is_same_module, lazy_import
 
 splinalg = splinalg
 cp = lazy_import("cupy", rename="cp")
 cps = lazy_import("cupy.sparse", rename="cps")
 
 
 def issparse(x):
@@ -76,15 +76,15 @@
     m = get_array_module(x)
     if m is np:
         return sps
     return cps
 
 
 def is_cupy(x):
-    return get_array_module(x) is cp
+    return is_same_module(get_array_module(x), cp)
 
 
 def naked(x):
     if hasattr(x, "spmatrix"):
         return x.spmatrix
     if not is_sparse_or_dense(x):
         raise TypeError("only sparse matrix or ndarray accepted")
```

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/sparse/matrix.py` & `xorbits-0.3.0/xorbits/_mars/lib/sparse/matrix.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/sparse/vector.py` & `xorbits-0.3.0/xorbits/_mars/lib/sparse/vector.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/tbcode.py` & `xorbits-0.3.0/xorbits/_mars/lib/tbcode.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/uhashring/monkey.py` & `xorbits-0.3.0/xorbits/_mars/lib/uhashring/monkey.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/uhashring/ring.py` & `xorbits-0.3.0/xorbits/_mars/lib/uhashring/ring.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/uhashring/ring_ketama.py` & `xorbits-0.3.0/xorbits/_mars/lib/uhashring/ring_ketama.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/uhashring/ring_meta.py` & `xorbits-0.3.0/xorbits/_mars/lib/uhashring/ring_meta.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/lib/version.py` & `xorbits-0.3.0/xorbits/_mars/lib/version.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/opcodes.py` & `xorbits-0.3.0/xorbits/_mars/opcodes.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/__init__.py` & `xorbits-0.3.0/xorbits/_mars/optimization/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/__init__.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/chunk/__init__.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/chunk/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/chunk/column_pruning.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/chunk/column_pruning.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/chunk/core.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/chunk/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/chunk/head.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/chunk/head.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/common/__init__.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/common/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/common/column_pruning.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/common/column_pruning.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/common/head.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/common/head.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/core.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/__init__.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/arithmetic_query.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/arithmetic_query.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/column_pruning/__init__.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/column_pruning/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/column_pruning/column_pruning_rule.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/column_pruning/column_pruning_rule.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/column_pruning/input_column_selector.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/column_pruning/input_column_selector.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/column_pruning/self_column_selector.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/column_pruning/self_column_selector.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/column_pruning/utils.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/column_pruning/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/core.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/logical/tileable/head.py` & `xorbits-0.3.0/xorbits/_mars/optimization/logical/tileable/head.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/physical/__init__.py` & `xorbits-0.3.0/xorbits/_mars/optimization/physical/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/physical/core.py` & `xorbits-0.3.0/xorbits/_mars/optimization/physical/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/physical/cupy.py` & `xorbits-0.3.0/xorbits/_mars/optimization/physical/cupy.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/optimization/physical/numexpr.py` & `xorbits-0.3.0/xorbits/_mars/optimization/physical/numexpr.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/oscar.py` & `xorbits-0.3.0/xorbits/_mars/oscar.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/profiling.py` & `xorbits-0.3.0/xorbits/_mars/profiling.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/remote/__init__.py` & `xorbits-0.3.0/xorbits/_mars/remote/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/remote/core.py` & `xorbits-0.3.0/xorbits/_mars/remote/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/remote/operands.py` & `xorbits-0.3.0/xorbits/_mars/remote/operands.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/remote/run_script.py` & `xorbits-0.3.0/xorbits/_mars/remote/run_script.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/resource.py` & `xorbits-0.3.0/xorbits/_mars/resource.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/serialization/__init__.py` & `xorbits-0.3.0/xorbits/_mars/serialization/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/serialization/mars_objects.py` & `xorbits-0.3.0/xorbits/_mars/serialization/mars_objects.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/serialization/serializables/__init__.py` & `xorbits-0.3.0/xorbits/_mars/serialization/serializables/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/serialization/serializables/core.py` & `xorbits-0.3.0/xorbits/_mars/serialization/serializables/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/serialization/serializables/field.py` & `xorbits-0.3.0/xorbits/_mars/serialization/serializables/field.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/serialization/serializables/field_type.py` & `xorbits-0.3.0/xorbits/_mars/serialization/serializables/field_type.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/api/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/api/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/api/core.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/api/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/api/oscar.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/api/oscar.py`

 * *Files 2% similar despite different names*

```diff
@@ -267,14 +267,21 @@
     ) -> str:
         node_allocator_ref = await self._get_node_allocator_ref()
         address = await node_allocator_ref.request_worker(
             worker_cpu, worker_mem, timeout
         )
         return address
 
+    async def request_workers(
+        self, worker_num: int, timeout: Optional[int] = None
+    ) -> List[str]:
+        node_allocator_ref = await self._get_node_allocator_ref()
+        addresses = await node_allocator_ref.request_workers(worker_num, timeout)
+        return addresses
+
     async def release_worker(self, address: str):
         node_allocator_ref = await self._get_node_allocator_ref()
         await node_allocator_ref.release_worker(address)
         node_info_ref = await self._get_node_info_ref()
         await node_info_ref.update_node_info(
             address, NodeRole.WORKER, status=NodeStatus.STOPPED
         )
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/api/web.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/api/web.py`

 * *Files 2% similar despite different names*

```diff
@@ -189,14 +189,24 @@
                     self.write(content)
                     await self.flush()
                 offset = offset + len(content)
                 content = await cluster_api.fetch_node_log(
                     size, address=address, offset=offset
                 )
 
+    @web_api("workers/scale", method=["patch"], cache_blocking=True)
+    async def request_workers(self):
+        worker_num = int(self.get_argument(name="worker_num"))
+        timeout = self.get_argument(name="timeout", default=None)
+        if timeout is not None:
+            timeout = int(timeout)
+        cluster_api = await self._get_cluster_api()
+        addresses = await cluster_api.request_workers(worker_num, timeout=timeout)
+        self.write(json.dumps({"workers": addresses}))  # pragma: no cover
+
 
 web_handlers = {ClusterWebAPIHandler.get_root_pattern(): ClusterWebAPIHandler}
 
 
 class WebClusterAPI(AbstractClusterAPI, MarsWebAPIClientMixin):
     def __init__(self, address: str, request_rewriter: Callable = None):
         self._address = address.rstrip("/")
@@ -373,7 +383,16 @@
         if size is not None:
             path += f"&&size={size}"
         res = await self._request_url("GET", path)
         if size == -1:
             return res.body.decode(encoding="utf8")
         else:
             return str(json.loads(res.body)["content"])
+
+    async def request_workers(
+        self, worker_num: int, timeout: Optional[int] = None
+    ) -> List[str]:
+        path = f"{self._address}/api/cluster/workers/scale?worker_num={worker_num}"
+        if timeout is not None:
+            path += f"&&timeout={timeout}"
+        res = await self._request_url("PATCH", path, data=b"")
+        return json.loads(res.body)["workers"]  # pragma: no cover
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/backends/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/backends/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/backends/base.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/backends/base.py`

 * *Files 4% similar despite different names*

```diff
@@ -75,14 +75,26 @@
         Create a new worker
 
         Returns
         -------
         Address of the new created worker
         """
 
+    async def request_workers(
+        self, worker_num: int, timeout: Optional[int] = None
+    ) -> List[str]:
+        """
+        Create new workers
+
+        Returns
+        -------
+        Addresses of the new created workers
+        """
+        raise NotImplementedError
+
     @abstractmethod
     async def release_worker(self, address: str):
         """
         Return a worker
         """
 
     @abstractmethod
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/backends/fixed.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/backends/fixed.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/core.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/file_logger.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/file_logger.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/gather.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/gather.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/locator.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/locator.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/procinfo.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/procinfo.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/supervisor/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/supervisor/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/supervisor/locator.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/supervisor/locator.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/supervisor/node_allocator.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/supervisor/node_allocator.py`

 * *Files 8% similar despite different names*

```diff
@@ -9,15 +9,15 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from typing import Optional
+from typing import List, Optional
 
 import xoscar as mo
 
 from ...core import NodeRole
 from ..backends import AbstractClusterBackend, get_cluster_backend
 
 
@@ -36,12 +36,17 @@
     async def request_worker(
         self, worker_cpu: int, worker_mem: int, timeout: int = None
     ) -> str:
         return await self._backend.request_worker(
             worker_cpu, worker_mem, timeout=timeout
         )
 
+    async def request_workers(
+        self, worker_num: int, timeout: Optional[int] = None
+    ) -> List[str]:
+        return await self._backend.request_workers(worker_num, timeout)
+
     async def release_worker(self, address: str):
         await self._backend.release_worker(address)
 
     async def reconstruct_worker(self, address: str):
         await self._backend.reconstruct_worker(address)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/supervisor/node_info.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/supervisor/node_info.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/supervisor/service.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/supervisor/service.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/uploader.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/uploader.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/worker/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/worker/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/worker/locator.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/worker/locator.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/cluster/worker/service.py` & `xorbits-0.3.0/xorbits/_mars/services/cluster/worker/service.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/context.py` & `xorbits-0.3.0/xorbits/_mars/services/context.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/core.py` & `xorbits-0.3.0/xorbits/_mars/services/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/lifecycle/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/lifecycle/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/lifecycle/api/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/lifecycle/api/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/lifecycle/api/core.py` & `xorbits-0.3.0/xorbits/_mars/services/lifecycle/api/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/lifecycle/api/oscar.py` & `xorbits-0.3.0/xorbits/_mars/services/lifecycle/api/oscar.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/lifecycle/api/web.py` & `xorbits-0.3.0/xorbits/_mars/services/lifecycle/api/web.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/lifecycle/errors.py` & `xorbits-0.3.0/xorbits/_mars/services/lifecycle/errors.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/lifecycle/supervisor/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/lifecycle/supervisor/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/lifecycle/supervisor/service.py` & `xorbits-0.3.0/xorbits/_mars/services/lifecycle/supervisor/service.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/lifecycle/supervisor/tracker.py` & `xorbits-0.3.0/xorbits/_mars/services/lifecycle/supervisor/tracker.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/lifecycle/worker/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/lifecycle/worker/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/api/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/api/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/api/core.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/api/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/api/oscar.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/api/oscar.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/api/web.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/api/web.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/core.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/metas.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/metas.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/store/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/store/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/store/base.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/store/base.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/store/dictionary.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/store/dictionary.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/supervisor/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/supervisor/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/supervisor/core.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/supervisor/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/supervisor/service.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/supervisor/service.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/worker/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/worker/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/worker/core.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/worker/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/meta/worker/service.py` & `xorbits-0.3.0/xorbits/_mars/services/meta/worker/service.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/mutable/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/web/__init__.py`

 * *Files 14% similar despite different names*

```diff
@@ -9,10 +9,19 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from .api import AbstractMutableAPI, MockMutableAPI, MutableAPI, WebMutableAPI
-from .core import MutableTensor
-from .supervisor import MutableObjectManagerActor, MutableTensorActor
+from .api import OscarWebAPI
+from .core import (
+    MarsRequestHandler,
+    MarsServiceWebAPIHandler,
+    MarsWebAPIClientMixin,
+    web_api,
+)
+
+try:
+    from .supervisor import WebActor
+except ImportError:  # pragma: no cover
+    pass
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/mutable/api/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/web/api/__init__.py`

 * *Files 10% similar despite different names*

```diff
@@ -9,10 +9,8 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from .core import AbstractMutableAPI
-from .oscar import MockMutableAPI, MutableAPI
-from .web import WebMutableAPI
+from .oscar import OscarWebAPI
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/mutable/api/web.py` & `xorbits-0.3.0/xorbits/_mars/services/session/api/web.py`

 * *Files 27% similar despite different names*

```diff
@@ -9,179 +9,172 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from typing import Callable, Union
+import json
+from typing import Callable, Dict, List, Optional, Tuple, Union
 
-import numpy as np
-
-from ....lib.aio import alru_cache
-from ....utils import deserialize_serializable, serialize_serializable
+from ....utils import parse_readable_size
 from ...web import MarsServiceWebAPIHandler, MarsWebAPIClientMixin, web_api
-from .core import AbstractMutableAPI
-
-
-class MutableWebAPIHandler(MarsServiceWebAPIHandler):
-    _root_pattern = "/api/session/(?P<session_id>[^/]+)/mutable"
-
-    @alru_cache(cache_exceptions=False)
-    async def _get_cluster_api(self):
-        from ...cluster import ClusterAPI
-
-        return await ClusterAPI.create(self._supervisor_addr)
-
-    @alru_cache(cache_exceptions=False)
-    async def _get_oscar_mutable_api(self, session_id: str):
-        from .oscar import MutableAPI
+from ..core import SessionInfo
+from .core import AbstractSessionAPI
 
-        cluster_api = await self._get_cluster_api()
-        [address] = await cluster_api.get_supervisors_by_keys([session_id])
-        return await MutableAPI.create(session_id, address)
 
-    @web_api("", method="post")
-    async def create_mutable_tensor(self, session_id: str):
-        body_args = (
-            deserialize_serializable(self.request.body) if self.request.body else None
+def _encode_size(size: Union[str, Dict[str, List[int]]]) -> str:
+    if not isinstance(size, dict):
+        return size
+    else:
+        return ",".join(f"{k}={v}" for k, v in size.items())
+
+
+def _decode_size(encoded: str) -> Union[int, str, Dict[str, Union[int, List[int]]]]:
+    if not encoded:
+        return 0
+    if "," not in encoded and "=" not in encoded:
+        try:
+            return int(encoded)
+        except ValueError:
+            return int(parse_readable_size(encoded)[0])
+    else:
+        ret = dict()
+        for kv in encoded.split(","):
+            k, v = kv.split("=", 1)
+            ret[k] = int(parse_readable_size(v)[0])
+        return ret
+
+
+class SessionWebAPIBaseHandler(MarsServiceWebAPIHandler):
+    async def _get_oscar_session_api(self):
+        from .oscar import SessionAPI
+
+        return await self._get_api_by_key(SessionAPI, "Session", with_key_arg=False)
+
+
+class SessionWebAPIHandler(SessionWebAPIBaseHandler):
+    @classmethod
+    def get_root_pattern(cls):
+        return "/api/session(?:/(?P<sub_path>[^/]*)$|$)"
+
+    @web_api("(?P<session_id>[^/]+)", method="put")
+    async def create_session(self, session_id: str):
+        if session_id == "None":
+            session_id = None
+        oscar_api = await self._get_oscar_session_api()
+        sess_id, addr = await oscar_api.create_session(session_id)
+        self.write({"session_id": sess_id, "address": addr})
+
+    @web_api("(?P<session_id>[^/]+)", method="delete")
+    async def delete_session(self, session_id: str):
+        oscar_api = await self._get_oscar_session_api()
+        await oscar_api.delete_session(session_id)
+
+    @web_api("", method="delete")
+    async def delete_all_sessions(self):
+        oscar_api = await self._get_oscar_session_api()
+        await oscar_api.delete_all_sessions()
+
+    @web_api(
+        "(?P<session_id>[^/]+)", method="get", arg_filter={"action": "check_exist"}
+    )
+    async def has_session(self, session_id: str):
+        oscar_api = await self._get_oscar_session_api()
+        res = await oscar_api.has_session(session_id)
+        self.write("1" if res else "0")
+
+    @web_api(
+        "(?P<session_id>[^/]*)",
+        method="get",
+        arg_filter={"action": "get_last_idle_time"},
+    )
+    async def get_last_idle_time(self, session_id: str):
+        session_id = session_id or None
+        oscar_api = await self._get_oscar_session_api()
+        res = await oscar_api.get_last_idle_time(session_id)
+        self.write(str(res) if res else "")
+
+    @web_api("", method="get")
+    async def get_sessions(self):
+        oscar_api = await self._get_oscar_session_api()
+        res = await oscar_api.get_sessions()
+        self.write(
+            json.dumps({"sessions": [{"session_id": info.session_id} for info in res]})
+        )
+
+
+class SessionWebLogAPIHandler(SessionWebAPIBaseHandler):
+    _root_pattern = "/api/session/(?P<session_id>[^/]+)/op/(?P<op_key>[^/]+)/log"
+
+    @web_api("", method="get")
+    async def fetch_tileable_op_logs(self, session_id: str, op_key: str):
+        oscar_api = await self._get_oscar_session_api()
+        offsets = _decode_size(self.get_argument("offsets", None))
+        sizes = _decode_size(self.get_argument("sizes", None))
+        log_result = await oscar_api.fetch_tileable_op_logs(
+            session_id, op_key, offsets, sizes
         )
-        shape = body_args.get("shape")
-        dtype = body_args.get("dtype")
-        name = body_args.get("name")
-        default_value = body_args.get("default_value")
-        chunk_size = body_args.get("chunk_size")
-
-        oscar_api = await self._get_oscar_mutable_api(session_id)
-        res = await oscar_api.create_mutable_tensor(
-            shape, dtype, name, default_value, chunk_size
-        )
-        self.write(serialize_serializable(res))
-
-    @web_api("(?P<name>[^/]+)", method="get")
-    async def get_mutable_tensor(self, session_id: str, name: str):
-        oscar_api = await self._get_oscar_mutable_api(session_id)
-        res = await oscar_api.get_mutable_tensor(name)
-        self.write(serialize_serializable(res))
-
-    @web_api("(?P<name>[^/]+)/seal", method="post")
-    async def seal_mutable_tensor(self, session_id: str, name: str):  # pragma: no cover
-        body_args = (
-            deserialize_serializable(self.request.body) if self.request.body else None
-        )
-        timestamp = body_args.get("timestamp")
-
-        oscar_api = await self._get_oscar_mutable_api(session_id)
-        res = await oscar_api.seal_mutable_tensor(name, timestamp)
-        self.write(serialize_serializable(res))
-
-    @web_api("(?P<name>[^/]+)/read", method="post")
-    async def read_mutable(self, session_id: str, name: str):  # pragma: no cover
-        body_args = (
-            deserialize_serializable(self.request.body) if self.request.body else None
-        )
-        index = body_args.get("index")
-        timestamp = body_args.get("timestamp")
-
-        oscar_api = await self._get_oscar_mutable_api(session_id)
-        res = await oscar_api.read(name, index, timestamp)
-        self.write(serialize_serializable(res))
-
-    @web_api("(?P<name>[^/]+)/write", method="post")
-    async def write_mutable(self, session_id: str, name: str):  # pragma: no cover
-        body_args = (
-            deserialize_serializable(self.request.body) if self.request.body else None
-        )
-        index = body_args.get("index")
-        value = body_args.get("value")
-        timestamp = body_args.get("timestamp")
-
-        oscar_api = await self._get_oscar_mutable_api(session_id)
-        res = await oscar_api.write(name, index, value, timestamp)
-        self.write(serialize_serializable(res))
+        self.write(json.dumps(log_result))
 
 
 web_handlers = {
-    MutableWebAPIHandler.get_root_pattern(): MutableWebAPIHandler,
+    SessionWebAPIHandler.get_root_pattern(): SessionWebAPIHandler,
+    SessionWebLogAPIHandler.get_root_pattern(): SessionWebLogAPIHandler,
 }
 
 
-class WebMutableAPI(AbstractMutableAPI, MarsWebAPIClientMixin):
-    def __init__(
-        self, session_id: str, address: str, request_rewriter: Callable = None
-    ):
-        self._session_id = session_id
+class WebSessionAPI(AbstractSessionAPI, MarsWebAPIClientMixin):
+    def __init__(self, address: str, request_rewriter: Callable = None):
         self._address = address.rstrip("/")
         self.request_rewriter = request_rewriter
 
-    async def create_mutable_tensor(
+    async def get_sessions(self) -> List[SessionInfo]:
+        addr = f"{self._address}/api/session"
+        res = await self._request_url("GET", addr)
+        res_obj = json.loads(res.body.decode())
+        return [SessionInfo(**kw) for kw in res_obj["sessions"]]
+
+    async def create_session(self, session_id: Optional[str]) -> Tuple[str, str]:
+        addr = f"{self._address}/api/session/{session_id}"
+        res = await self._request_url(path=addr, method="PUT", data=b"")
+        res_obj = json.loads(res.body.decode())
+        return res_obj["session_id"], res_obj["address"]
+
+    async def delete_session(self, session_id: str):
+        addr = f"{self._address}/api/session/{session_id}"
+        await self._request_url(path=addr, method="DELETE")
+
+    async def delete_all_sessions(self):
+        addr = f"{self._address}/api/session"
+        await self._request_url(path=addr, method="DELETE")
+
+    async def has_session(self, session_id: str):
+        addr = f"{self._address}/api/session/{session_id}"
+        params = dict(action="check_exist")
+        res = await self._request_url("GET", addr, params=params)
+        return bool(int(res.body.decode()))
+
+    async def get_last_idle_time(
+        self, session_id: Union[str, None] = None
+    ) -> Union[float, None]:
+        session_id = session_id or ""
+        addr = f"{self._address}/api/session/{session_id}"
+        params = dict(action="get_last_idle_time")
+        res = await self._request_url("GET", addr, params=params)
+        content = res.body.decode()
+        return float(content) if content else None
+
+    async def fetch_tileable_op_logs(
         self,
-        shape: tuple,
-        dtype: Union[np.dtype, str],
-        name: str = None,
-        default_value: Union[int, float] = 0,
-        chunk_size: Union[tuple, int] = None,
-    ):
-        path = f"{self._address}/api/session/{self._session_id}/mutable"
+        session_id: str,
+        tileable_op_key: str,
+        chunk_op_key_to_offsets: Dict[str, List[int]],
+        chunk_op_key_to_sizes: Dict[str, List[int]],
+    ) -> Dict:
+        addr = f"{self._address}/api/session/{session_id}/op/{tileable_op_key}/log"
         params = dict(
-            shape=shape,
-            dtype=dtype,
-            name=name,
-            default_value=default_value,
-            chunk_size=chunk_size,
-        )
-        body = serialize_serializable(params)
-        res = await self._request_url(
-            path=path,
-            method="POST",
-            data=body,
-            headers={"Content-Type": "application/octet-stream"},
-        )
-        return deserialize_serializable(res.body)
-
-    async def get_mutable_tensor(self, name: str):
-        path = f"{self._address}/api/session/{self._session_id}/mutable/{name}"
-        res = await self._request_url(
-            path=path,
-            method="GET",
-            headers={"Content-Type": "application/octet-stream"},
-        )
-        return deserialize_serializable(res.body)
-
-    async def seal_mutable_tensor(self, name: str, timestamp=None):
-        path = f"{self._address}/api/session/{self._session_id}/mutable/{name}/seal"
-        params = dict(timestamp=timestamp)
-        body = serialize_serializable(params)
-        res = await self._request_url(
-            path=path,
-            method="POST",
-            data=body,
-            headers={"Content-Type": "application/octet-stream"},
-            request_timeout=3600,
-        )
-        return deserialize_serializable(res.body)
-
-    async def read(self, name: str, index, timestamp=None):
-        path = f"{self._address}/api/session/{self._session_id}/mutable/{name}/read"
-        params = dict(index=index, timestamp=timestamp)
-        body = serialize_serializable(params)
-        res = await self._request_url(
-            path=path,
-            method="POST",
-            data=body,
-            headers={"Content-Type": "application/octet-stream"},
-            request_timeout=3600,
-        )
-        return deserialize_serializable(res.body)
-
-    async def write(self, name: str, index, value, timestamp=None):
-        path = f"{self._address}/api/session/{self._session_id}/mutable/{name}/write"
-        params = dict(index=index, value=value, timestamp=timestamp)
-        body = serialize_serializable(params)
-        res = await self._request_url(
-            path=path,
-            method="POST",
-            data=body,
-            headers={"Content-Type": "application/octet-stream"},
-            request_timeout=3600,
+            offsets=_encode_size(chunk_op_key_to_offsets),
+            sizes=_encode_size(chunk_op_key_to_sizes),
         )
-        return deserialize_serializable(res.body)
+        res = await self._request_url("GET", addr, params=params)
+        return json.loads(res.body.decode())
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/mutable/supervisor/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/web/worker.py`

 * *Files 10% similar despite different names*

```diff
@@ -9,9 +9,12 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from .core import MutableObjectManagerActor, MutableTensorActor
-from .service import MutableObjectManagerSupervisorService
+from ..core import EmptyService
+
+
+class WebWorkerService(EmptyService):
+    pass
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/mutable/supervisor/core.py` & `xorbits-0.3.0/xorbits/_mars/services/task/supervisor/preprocessor.py`

 * *Files 26% similar despite different names*

```diff
@@ -9,238 +9,257 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import asyncio
-from typing import Dict, List, Optional, Tuple, Union
 
-import numpy as np
-import xoscar as mo
+import asyncio
+import logging
+from functools import partial
+from typing import Callable, Dict, Iterable, List, Set
+
+from ....config import Config
+from ....core import ChunkGraph, ChunkGraphBuilder, TileableGraph, TileContext
+from ....core.graph.builder.chunk import Tiler, _TileableHandler
+from ....core.operand import Fetch, ShuffleFetchType
+from ....resource import Resource
+from ....typing import BandType, ChunkType, TileableType
+from ...subtask import Subtask, SubtaskGraph
+from ..analyzer import GraphAnalyzer
+from ..core import MapReduceInfo, Task
 
-from ....core import tile
-from ....utils import build_fetch
-from ...cluster import ClusterAPI
-from ...core import NodeRole
-from ...meta import MetaAPI
-from ..core import MutableTensorInfo
-from ..utils import (
-    getitem_to_records,
-    normalize_name,
-    normalize_timestamp,
-    setitem_to_records,
-)
-from ..worker import MutableTensorChunkActor
-
-
-class MutableObjectManagerActor(mo.Actor):
-    def __init__(self, session_id: str):
-        self._session_id = session_id
-        self._cluster_api: Optional[ClusterAPI] = None
-
-        self._mutable_objects = dict()
-
-    async def __post_create__(self):
-        self._cluster_api = await ClusterAPI.create(self.address)
-
-    async def __pre_destroy__(self):
-        await asyncio.gather(
-            *[mo.destroy_actor(ref) for ref in self._mutable_objects.values()]
-        )
-
-    @classmethod
-    def gen_uid(cls, session_id: str):
-        return f"mutable-object-manager-{session_id}"
-
-    async def create_mutable_tensor(self, *args, name: Optional[str] = None, **kwargs):
-        name = normalize_name(name)
-        if name in self._mutable_objects:
-            raise ValueError(f"Mutable tensor {name} already exists!")
-
-        workers: List[str] = list(
-            await self._cluster_api.get_nodes_info(role=NodeRole.WORKER)
-        )
-
-        tensor_ref = await mo.create_actor(
-            MutableTensorActor,
-            self._session_id,
-            name,
-            workers,
-            *args,
-            **kwargs,
-            address=self.address,
-            uid=MutableTensorActor.gen_uid(self._session_id, name),
-        )
-        self._mutable_objects[name] = tensor_ref
-        return tensor_ref
-
-    async def get_mutable_tensor(self, name: str):
-        tensor_ref = self._mutable_objects.get(name, None)
-        if tensor_ref is None:
-            raise ValueError(f"Mutable tensor {name} doesn't exist!")
-        return tensor_ref
-
-    async def seal_mutable_tensor(self, name: str, timestamp=None):
-        tensor_ref = self._mutable_objects.get(name, None)
-        if tensor_ref is None:
-            raise ValueError(f"Mutable tensor {name} doesn't exist!")
-        tensor = await tensor_ref.seal(timestamp)
-        await mo.destroy_actor(tensor_ref)
-        self._mutable_objects.pop(name)
-        return tensor
+logger = logging.getLogger(__name__)
 
 
-class MutableTensorActor(mo.Actor):
+class CancellableTiler(Tiler):
     def __init__(
         self,
-        session_id: str,
-        name: str,
-        workers: List[str],
-        shape: Tuple,
-        dtype: Union[np.dtype, str],
-        default_value: Union[int, float] = 0,
-        chunk_size: Union[int, Tuple] = None,
+        tileable_graph: TileableGraph,
+        tile_context: TileContext,
+        processed_chunks: Set[str],
+        chunk_to_fetch: Dict[ChunkType, ChunkType],
+        add_nodes: Callable,
+        cancelled: asyncio.Event = None,
+        check_duplicated_submission: bool = False,
     ):
-        self._session_id = session_id
-        self._name = name
-        self._workers = workers
-        self._shape = shape
-        self._dtype = dtype
-        self._default_value = default_value
-        self._chunk_size = chunk_size
-
-        self._sealed = False
-
-        self._fetch = None
-        self._chunk_actors = []
-        # chunk to actor: {chunk index -> actor uid}
-        self._chunk_to_actor: Dict[
-            Tuple, mo.ActorRefType[MutableTensorChunkActor]
-        ] = dict()
-
-    async def __post_create__(self):
-        self._meta_api = await MetaAPI.create(self._session_id, self.address)
-
-        # tiling a random tensor to generate keys, but we doesn't actually execute
-        # the random generator
-        from ....tensor.random import rand
-
-        self._fetch = build_fetch(
-            tile(rand(*self._shape, dtype=self._dtype, chunk_size=self._chunk_size))
-        )
-
-        chunk_groups = np.array_split(self._fetch.chunks, len(self._workers))
-        for idx, (worker, chunks) in enumerate(zip(self._workers, chunk_groups)):
-            if len(chunks) == 0:
+        super().__init__(
+            tileable_graph, tile_context, processed_chunks, chunk_to_fetch, add_nodes
+        )
+        self._cancelled = cancelled
+        self._check_duplicated_submission = check_duplicated_submission
+
+    @property
+    def cancelled(self):
+        return self._cancelled.is_set()
+
+    def _gen_tileable_handlers(self, next_tileable_handlers: List[_TileableHandler]):
+        for tile_handler in super()._gen_tileable_handlers(next_tileable_handlers):
+            if not self.cancelled:
+                yield tile_handler
+            else:
                 break
-            chunk_actor_ref = await mo.create_actor(
-                MutableTensorChunkActor,
-                self._session_id,
-                self.address,
-                list(chunks),
-                dtype=self._dtype,
-                default_value=self._default_value,
-                address=worker,
-                uid=MutableTensorChunkActor.gen_uid(self._session_id, self._name, idx),
-            )
-            self._chunk_actors.append(chunk_actor_ref)
-            for chunk in chunks:
-                self._chunk_to_actor[chunk.index] = chunk_actor_ref
 
-    async def __pre_destroy__(self):
-        await asyncio.gather(*[mo.destroy_actor(ref) for ref in self._chunk_actors])
+    def _gen_result_chunks(
+        self,
+        chunk_graph: ChunkGraph,
+        next_tileable_handlers: List[_TileableHandler],
+    ):
+        if not self.cancelled:
+            return super()._gen_result_chunks(chunk_graph, next_tileable_handlers)
+        else:
+            return
+
+    def _iter_without_check(self):
+        while self._tileable_handlers:
+            to_update_tileables = self._iter()
+            if not self.cancelled:
+                yield self._cur_chunk_graph
+            if not self.cancelled:
+                for t in to_update_tileables:
+                    t.refresh_params()
+            else:
+                break
 
-    @classmethod
-    def gen_uid(cls, session_id, name):
-        return f"mutable-tensor-{session_id}-{name}"
+    def _iter_with_check(self):
+        chunk_set = set()
+        chunk_graphs = []
+        for chunk_graph in self._iter_without_check():
+            chunk_graphs.append(chunk_graph)
+            chunks = []
+            for chunk in chunk_graph:
+                if isinstance(chunk.op, Fetch):
+                    continue
+                if chunk in chunk_set:
+                    raise RuntimeError(f"chunk {chunk} submitted repeatedly")
+                chunks.append(chunk)
+            chunk_set.update(chunks)
+            yield chunk_graph
+
+    def __iter__(self):
+        if not self._check_duplicated_submission:
+            return self._iter_without_check()
+        else:
+            return self._iter_with_check()
+
+
+class TaskPreprocessor:
+    __slots__ = (
+        "_task",
+        "tileable_graph",
+        "tile_context",
+        "_config",
+        "tileable_optimization_records",
+        "chunk_optimization_records_list",
+        "_cancelled",
+        "_done",
+        "map_reduce_id_to_infos",
+    )
 
-    async def info(self) -> "MutableTensorInfo":
-        return MutableTensorInfo(
-            self._shape, self._dtype, self._name, self._default_value
-        )
+    tile_context: TileContext
+    map_reduce_id_to_infos: Dict[int, MapReduceInfo]
 
-    @mo.extensible
-    async def _read_chunk(
-        self, chunk_actor_ref, chunk_index, records, chunk_value_shape, timestamp
+    def __init__(
+        self,
+        task: Task,
+        tiled_context: TileContext = None,
+        config: Config = None,
     ):
-        return await chunk_actor_ref.read(
-            chunk_index, records, chunk_value_shape, timestamp
-        )
+        self._task = task
+        self.tileable_graph = task.tileable_graph
+        self._config = config
+
+        self.tile_context = tiled_context
+        self.tileable_optimization_records = None
+        self.chunk_optimization_records_list = []
+        self.map_reduce_id_to_infos = dict()
 
-    async def read(self, index, timestamp=None):
+        self._cancelled = asyncio.Event()
+        self._done = asyncio.Event()
+
+    def optimize(self) -> TileableGraph:
         """
-        Read value from mutable tensor.
+        Optimize tileable graph.
 
-        Parameters
-        ----------
-        index:
-            Index to read from the tensor.
+        Returns
+        -------
+        optimized_graph: TileableGraph
 
-        timestamp: optional
-            Timestamp to read value that happened before then.
         """
-        timestamp = normalize_timestamp(timestamp)
-        records, output_shape = getitem_to_records(self._fetch, index)
+        from ....optimization.logical.tileable import (
+            optimize as optimize_tileable_graph,
+        )
 
-        read_tasks, chunk_indices = [], []
-        for chunk_index, (records, chunk_value_shape, indices) in records.items():
-            chunk_actor_ref = self._chunk_to_actor[chunk_index]
-            read_tasks.append(
-                self._read_chunk.delay(
-                    chunk_actor_ref, chunk_index, records, chunk_value_shape, timestamp
-                )
+        if self._config.optimize_tileable_graph:
+            # enable optimization
+            self.tileable_optimization_records = optimize_tileable_graph(
+                self.tileable_graph
             )
-            chunk_indices.append(indices)
-        chunks = await self._read_chunk.batch(*read_tasks)
-        result = np.full(output_shape, fill_value=self._default_value)
-        for chunk, indices in zip(chunks, chunk_indices):
-            result[indices] = chunk
-        return result
-
-    @mo.extensible
-    async def _write_chunk(self, chunk_actor_ref, chunk_index, records):
-        await chunk_actor_ref.write(chunk_index, records)
+        return self.tileable_graph
+
+    def _fill_fetch_tileable_with_chunks(self, tileable_graph: TileableGraph):
+        for t in tileable_graph:
+            if isinstance(t.op, Fetch) and t in self.tile_context:
+                tiled = self.tile_context[t]
+                t._chunks = tiled.chunks
+                t._nsplits = tiled.nsplits
+
+    def _get_tiler_cls(self) -> Callable:
+        extra_config = self._task.extra_config or dict()
+        check_duplicated_submission = extra_config.get(
+            "check_duplicated_submission", False
+        )
+        return partial(
+            CancellableTiler,
+            cancelled=self._cancelled,
+            check_duplicated_submission=check_duplicated_submission,
+        )
 
-    async def write(self, index, value, timestamp=None):
+    def tile(self, tileable_graph: TileableGraph) -> Iterable[ChunkGraph]:
         """
-        Write value to mutable tensor.
+        Generate chunk graphs
 
-        Parameters
-        ----------
-        index:
-            Index to write to the tensor.
+        Returns
+        -------
+        chunk_graph_generator: Generator
+             Chunk graphs.
+        """
+        from ....optimization.logical.chunk import optimize as optimize_chunk_graph
 
-        value:
-            The value that will be filled into the mutable tensor according to `index`.
+        self._fill_fetch_tileable_with_chunks(tileable_graph)
+        # iterative chunk graph builder
+        chunk_graph_builder = ChunkGraphBuilder(
+            tileable_graph,
+            fuse_enabled=self._task.fuse_enabled,
+            tile_context=self.tile_context,
+            tiler_cls=self._get_tiler_cls(),
+        )
+        optimize = self._config.optimize_chunk_graph
+        for t in tileable_graph:
+            if hasattr(t.op, "logic_key") and t.op.logic_key is None:
+                t.op.logic_key = t.op.get_logic_key()
+        for chunk_graph in chunk_graph_builder.build():
+            if len(chunk_graph) == 0:
+                continue
+            # optimize chunk graph
+            if optimize:
+                self.chunk_optimization_records_list.append(
+                    optimize_chunk_graph(chunk_graph)
+                )
+            yield chunk_graph
 
-        timestamp: optional
-            Timestamp to associated with the newly touched value.
-        """
-        timestamp = normalize_timestamp(timestamp)
-        records = setitem_to_records(self._fetch, index, value, timestamp)
+    def post_chunk_graph_execution(self):  # pylint: disable=no-self-use
+        """Post calling after execution of current chunk graph"""
 
-        write_tasks = []
-        for chunk_index, records in records.items():
-            chunk_actor_ref = self._chunk_to_actor[chunk_index]
-            write_tasks.append(
-                self._write_chunk.delay(chunk_actor_ref, chunk_index, records)
-            )
-        await self._write_chunk.batch(*write_tasks)
+    def analyze(
+        self,
+        chunk_graph: ChunkGraph,
+        chunk_to_subtasks: Dict[ChunkType, Subtask],
+        available_bands: Dict[BandType, Resource],
+        stage_id: str = None,
+        op_to_bands: Dict[str, BandType] = None,
+        shuffle_fetch_type: ShuffleFetchType = None,
+    ) -> SubtaskGraph:
+        logger.debug("Start to gen subtask graph for task %s", self._task.task_id)
+        task = self._task
+        analyzer = GraphAnalyzer(
+            chunk_graph,
+            available_bands,
+            task,
+            self._config,
+            chunk_to_subtasks,
+            stage_id=stage_id,
+            shuffle_fetch_type=shuffle_fetch_type,
+            map_reduce_id_to_infos=self.map_reduce_id_to_infos,
+        )
+        graph = analyzer.gen_subtask_graph(op_to_bands)
+        logger.debug(
+            "Generated subtask graph of %s subtasks for task %s",
+            len(graph),
+            self._task.task_id,
+        )
+        return graph
+
+    def _get_done(self):
+        return self._done.is_set()
+
+    def _set_done(self, is_done: bool):
+        if is_done:
+            self._done.set()
+        else:  # pragma: no cover
+            self._done.clear()
+
+    done = property(_get_done, _set_done)
+
+    def cancel(self):
+        self._cancelled.set()
+
+    def get_tiled(self, tileable: TileableType):
+        tileable = tileable.data if hasattr(tileable, "data") else tileable
+        return self.tile_context[tileable]
+
+    def get_map_reduce_info(self, map_reduce_id: int) -> MapReduceInfo:
+        return self.map_reduce_id_to_infos[map_reduce_id]
 
-    @mo.extensible
-    async def _seal_chunk(self, chunk_actor_ref, timestamp):
-        await chunk_actor_ref.seal(timestamp)
-
-    async def seal(self, timestamp=None):
-        if self._sealed:
-            return self._fetch
-
-        timestamp = normalize_timestamp(timestamp)
-        self._sealed = True
-        seal_tasks = []
-        for chunk_actor_ref in self._chunk_actors:
-            seal_tasks.append(self._seal_chunk.delay(chunk_actor_ref, timestamp))
-        await self._seal_chunk.batch(*seal_tasks)
-        self._chunk_actors = []
-        return self._fetch
+    def __await__(self):
+        return self._done.wait().__await__()
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/mutable/supervisor/service.py` & `xorbits-0.3.0/xorbits/_mars/services/session/supervisor/service.py`

 * *Files 22% similar despite different names*

```diff
@@ -12,31 +12,36 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import xoscar as mo
 
 from ...core import AbstractService
-from .core import MutableObjectManagerActor
+from .core import SessionManagerActor
 
 
-class MutableObjectManagerSupervisorService(AbstractService):
-    async def start(self):
-        pass
-
-    async def stop(self):
-        pass
+class SessionSupervisorService(AbstractService):
+    """
+    Session service on supervisor.
+
+    Session Configuration
+    ---------------------
+    {
+        "session" : {
+        }
+    }
+    """
 
-    async def create_session(self, session_id: str):
+    async def start(self):
         await mo.create_actor(
-            MutableObjectManagerActor,
-            session_id,
+            SessionManagerActor,
+            self._config,
+            uid=SessionManagerActor.default_uid(),
             address=self._address,
-            uid=MutableObjectManagerActor.gen_uid(session_id),
         )
 
-    async def destroy_session(self, session_id: str):
+    async def stop(self):
         await mo.destroy_actor(
             mo.create_actor_ref(
-                uid=MutableObjectManagerActor.gen_uid(session_id), address=self._address
+                uid=SessionManagerActor.default_uid(), address=self._address
             )
         )
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/mutable/utils.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/isin.py`

 * *Files 20% similar despite different names*

```diff
@@ -9,212 +9,192 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import itertools
-import uuid
-from datetime import datetime
-from numbers import Integral
-from typing import Optional
+from typing import Union
 
 import numpy as np
 
-from ...core import tile
-
-
-def indexing_to_chunk_indices(output_chunk):
-    """
-    Compute input_indices and value_indices when read from or write to
-    a tensor chunk.
-
-    Parameters
-    ----------
-    output_chunk:
-        A chunk in the output of the `__setitem__` op.
-
-    Returns
-    -------
-        The indices in the input chunk, and value_indices in the value block
-        that will be assigned.
-    """
-    input_indices = []  # index in the chunk of the mutable tensor
-    value_indices = []  # index in the chunk of the assigned value
-    for d, s in zip(output_chunk.op.indexes, output_chunk.op.inputs[0].shape):
-        # expand the index (slice)
-        idx = np.r_[slice(*d.indices(s)) if isinstance(d, slice) else d]
-        input_indices.append(idx)
-        if not isinstance(d, Integral):
-            value_indices.append(np.arange(len(idx)))
-    return input_indices, value_indices
-
-
-def compute_output_of_indexing(tensor, tensor_index):
-    """
-    Compute the output information of `__{set,get}item__` on tensor for every chunk.
-    """
-    from ...tensor.indexing.core import calc_shape, process_index
-    from ...tensor.indexing.getitem import TensorIndex
-
-    tensor_index = process_index(tensor.ndim, tensor_index)
-    output_shape = calc_shape(tensor.shape, tensor_index)
-
-    index_tensor_op = TensorIndex(
-        dtype=tensor.dtype, sparse=False, indexes=list(tensor_index)
-    )
-    index_tensor = tile(index_tensor_op.new_tensor([tensor], shape=tuple(output_shape)))
-    output_chunks = index_tensor.chunks
-
-    nsplits_acc = [
-        np.cumsum(
-            (0,)
-            + tuple(
-                c.shape[i]
-                for c in output_chunks
-                if all(idx == 0 for j, idx in enumerate(c.index) if j != i)
+from ... import opcodes as OperandDef
+from ...serialization.serializables import BoolField
+from ...typing import TileableType
+from ..array_utils import as_same_device, device
+from ..core import TensorOrder
+from ..datasource import tensor as astensor
+from ..operands import TensorOperand, TensorOperandMixin
+
+
+class TensorIsIn(TensorOperand, TensorOperandMixin):
+    _op_type_ = OperandDef.ISIN
+
+    assume_unique = BoolField("assume_unique")
+    invert = BoolField("invert")
+
+    def __call__(self, element, test_elements):
+        self.dtype = np.dtype(bool)
+        return self.new_tensor(
+            [element, test_elements], shape=element.shape, order=TensorOrder.C_ORDER
+        )
+
+    @classmethod
+    def tile(cls, op):
+        from ..merge.stack import TensorStack
+        from ..reduction import TensorAll, TensorAny
+
+        ar1, ar2 = op.inputs
+        invert = op.invert
+        out = op.outputs[0]
+
+        out_chunks = []
+        for ar1_chunk in ar1.chunks:
+            to_concat_chunks = []
+            for ar2_chunk in ar2.chunks:
+                chunk_op = op.copy().reset_key()
+                out_chunk = chunk_op.new_chunk(
+                    [ar1_chunk, ar2_chunk],
+                    dtype=out.dtype,
+                    shape=ar1_chunk.shape,
+                    order=out.order,
+                    index=ar1_chunk.index,
+                )
+                to_concat_chunks.append(out_chunk)
+            if len(to_concat_chunks) == 1:
+                out_chunks.append(to_concat_chunks[0])
+            else:
+                # concat chunks
+                concat_op = TensorStack(axis=0)
+                shape = (len(to_concat_chunks),) + ar1_chunk.shape
+                concat_chunk = concat_op.new_chunk(
+                    to_concat_chunks, shape=shape, dtype=out.dtype, order=out.order
+                )
+                if not invert:
+                    chunk_op = TensorAny(axis=(0,), dtype=out.dtype)
+                    out_chunk = chunk_op.new_chunk(
+                        [concat_chunk],
+                        shape=ar1_chunk.shape,
+                        dtype=out.dtype,
+                        order=out.order,
+                        index=ar1_chunk.index,
+                    )
+                else:
+                    chunk_op = TensorAll(axis=(0,), dtype=out.dtype)
+                    out_chunk = chunk_op.new_chunk(
+                        [concat_chunk],
+                        shape=ar1_chunk.shape,
+                        dtype=out.dtype,
+                        order=out.order,
+                        index=ar1_chunk.index,
+                    )
+                out_chunks.append(out_chunk)
+
+        params = out.params.copy()
+        params["nsplits"] = ar1.nsplits
+        params["chunks"] = out_chunks
+        new_op = op.copy()
+        return new_op.new_tensors(op.inputs, kws=[params])
+
+    @classmethod
+    def execute(cls, ctx, op):
+        (element, test_elements), device_id, xp = as_same_device(
+            [ctx[c.key] for c in op.inputs], device=op.device, ret_extra=True
+        )
+
+        with device(device_id):
+            ctx[op.outputs[0].key] = xp.isin(
+                element, test_elements, assume_unique=op.assume_unique, invert=op.invert
             )
-        )
-        for i in range(len(output_chunks[0].shape))
-    ]
-    return output_shape, output_chunks, nsplits_acc
 
 
-def setitem_on_chunk_to_records(nsplits_acc, output_chunk, value, ts, is_scalar):
-    """
-    Turns a `__setitem__` on chunk to a list of index-value records.
+def isin(
+    element: Union[TileableType, np.ndarray],
+    test_elements: Union[TileableType, np.ndarray, list],
+    assume_unique: bool = False,
+    invert: bool = False,
+):
+    """
+    Calculates `element in test_elements`, broadcasting over `element` only.
+    Returns a boolean array of the same shape as `element` that is True
+    where an element of `element` is in `test_elements` and False otherwise.
 
     Parameters
     ----------
-    nsplits_acc:
-        Accumulate nsplits arrays of the output tensor chunks.
+    element : array_like
+        Input tensor.
+    test_elements : array_like
+        The values against which to test each value of `element`.
+        This argument is flattened if it is a tensor or array_like.
+        See notes for behavior with non-array-like parameters.
+    assume_unique : bool, optional
+        If True, the input tensors are both assumed to be unique, which
+        can speed up the calculation.  Default is False.
+    invert : bool, optional
+        If True, the values in the returned tensor are inverted, as if
+        calculating `element not in test_elements`. Default is False.
+        ``mt.isin(a, b, invert=True)`` is equivalent to (but faster
+        than) ``mt.invert(mt.isin(a, b))``.
 
     Returns
     -------
-        A list of `(index, value, timestamp)`, where `index` is the in-chunk index.
-    """
-    input_indices, value_indices = indexing_to_chunk_indices(output_chunk)
-
-    # normalize assigned value
-    if is_scalar:
-        chunk_value = value
-    else:
-        chunk_value_slice = tuple(
-            slice(
-                nsplits_acc[i][output_chunk.index[i]],
-                nsplits_acc[i][output_chunk.index[i] + 1],
-            )
-            for i in range(len(output_chunk.index))
-        )
-        chunk_value = value[chunk_value_slice]
-
-    records = []
-    for chunk_idx, value_idx in zip(
-        itertools.product(*input_indices), itertools.product(*value_indices)
-    ):
-        new_value = chunk_value if is_scalar else chunk_value[value_idx]
-        index_in_chunk = np.ravel_multi_index(
-            chunk_idx, output_chunk.op.inputs[0].shape
-        )
-        records.append((index_in_chunk, new_value, ts))
-    return records
-
-
-def setitem_to_records(tensor, tensor_index, value, timestamp):
-    """
-    Compute the records of `__setitem__` on tensor for every chunk.
-
-    Returns
-    -------
-        dict, a dict of chunk index to records in that chunk.
-    """
-    output_shape, output_chunks, nsplits_acc = compute_output_of_indexing(
-        tensor, tensor_index
-    )
-
-    is_scalar = (
-        np.isscalar(value)
-        or isinstance(value, tuple)
-        and tensor.dtype.fields is not None
-    )
-    if not is_scalar:
-        value = np.broadcast_to(value, output_shape).astype(tensor.dtype)
-
-    records = dict()
-    for output_chunk in output_chunks:
-        records_in_chunk = setitem_on_chunk_to_records(
-            nsplits_acc, output_chunk, value, timestamp, is_scalar=is_scalar
-        )
-        records[output_chunk.op.inputs[0].index] = records_in_chunk
-    return records
-
-
-def getitem_on_chunk_to_records(nsplits_acc, output_chunk):
-    """
-    Turns a `__getitem__` on chunk to a list of index-value records.
-
-    Parameters
-    ----------
-    nsplits_acc:
-        Accumulate nsplits arrays of the output tensor chunks.
-
-    Returns
-    -------
-        records: A list of `(index, value_index)`, where `index` is the in-chunk index, and
-        `value_index` is the index in the final result block.
-        chunk_value_shape: shape of result of this chunk.
-        chunk_value_slice: index of result of this chunk in the whole result tensor.
-    """
-    input_indices, value_indices = indexing_to_chunk_indices(output_chunk)
-
-    chunk_value_slice = tuple(
-        slice(
-            nsplits_acc[i][output_chunk.index[i]],
-            nsplits_acc[i][output_chunk.index[i] + 1],
-        )
-        for i in range(len(output_chunk.index))
-    )
-
-    records = []
-    for chunk_idx, value_idx in zip(
-        itertools.product(*input_indices), itertools.product(*value_indices)
-    ):
-        index_in_chunk = np.ravel_multi_index(
-            chunk_idx, output_chunk.op.inputs[0].shape
-        )
-        records.append((index_in_chunk, value_idx))
-    return records, output_chunk.shape, chunk_value_slice
-
-
-def getitem_to_records(tensor, tensor_index):
-    """
-    Compute the records of `__getitem__` on tensor for every chunk.
-
-    Returns
-    -------
-        records and output_chunk dict, records is a dict of chunk index to records
-        in that chunk.
-    """
-    output_shape, output_chunks, nsplits_acc = compute_output_of_indexing(
-        tensor, tensor_index
-    )
-
-    records = dict()
-    for output_chunk in output_chunks:
-        records_in_chunk = getitem_on_chunk_to_records(nsplits_acc, output_chunk)
-        records[output_chunk.op.inputs[0].index] = records_in_chunk
-    return records, output_shape
-
-
-def normalize_timestamp(timestamp=None):
-    if timestamp is None:
-        timestamp = np.datetime64(datetime.now())
-    if isinstance(timestamp, datetime):
-        timestamp = np.datetime64(timestamp)
-    return timestamp
-
-
-def normalize_name(name: Optional[str] = None):
-    if not name:
-        return str(uuid.uuid4())
-    return name
+    isin : Tensor, bool
+        Has the same shape as `element`. The values `element[isin]`
+        are in `test_elements`.
+
+    See Also
+    --------
+    in1d                  : Flattened version of this function.
+
+    Notes
+    -----
+
+    `isin` is an element-wise function version of the python keyword `in`.
+    ``isin(a, b)`` is roughly equivalent to
+    ``mt.array([item in b for item in a])`` if `a` and `b` are 1-D sequences.
+
+    `element` and `test_elements` are converted to tensors if they are not
+    already. If `test_elements` is a set (or other non-sequence collection)
+    it will be converted to an object tensor with one element, rather than a
+    tensor of the values contained in `test_elements`. This is a consequence
+    of the `tensor` constructor's way of handling non-sequence collections.
+    Converting the set to a list usually gives the desired behavior.
+
+    Examples
+    --------
+    >>> import mars.tensor as mt
+
+    >>> element = 2*mt.arange(4).reshape((2, 2))
+    >>> element.execute()
+    array([[0, 2],
+           [4, 6]])
+    >>> test_elements = [1, 2, 4, 8]
+    >>> mask = mt.isin(element, test_elements)
+    >>> mask.execute()
+    array([[ False,  True],
+           [ True,  False]])
+    >>> element[mask].execute()
+    array([2, 4])
+    >>> mask = mt.isin(element, test_elements, invert=True)
+    >>> mask.execute()
+    array([[ True, False],
+           [ False, True]])
+    >>> element[mask]
+    array([0, 6])
+
+    Because of how `array` handles sets, the following does not
+    work as expected:
+
+    >>> test_set = {1, 2, 4, 8}
+    >>> mt.isin(element, test_set).execute()
+    array([[ False, False],
+           [ False, False]])
+
+    Casting the set to a list gives the expected result:
+
+    >>> mt.isin(element, list(test_set)).execute()
+    array([[ False,  True],
+           [ True,  False]])
+    """
+    element, test_elements = astensor(element), astensor(test_elements).ravel()
+    op = TensorIsIn(assume_unique=assume_unique, invert=invert)
+    return op(element, test_elements)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/mutable/worker/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/einsum/__init__.py`

 * *Files 4% similar despite different names*

```diff
@@ -9,8 +9,8 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from .core import MutableTensorChunkActor
+from .core import einsum
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/api/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/api/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/api/core.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/api/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/api/oscar.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/api/oscar.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/api/web.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/api/web.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/core.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/errors.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/errors.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/assigner.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/assigner.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/autoscale.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/autoscale.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/globalresource.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/globalresource.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/manager.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/manager.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/queueing.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/queueing.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/service.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/service.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/supervisor/speculation.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/supervisor/speculation.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/utils.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/worker/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/worker/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/worker/execution.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/worker/execution.py`

 * *Files 2% similar despite different names*

```diff
@@ -17,15 +17,15 @@
 import functools
 import logging
 import operator
 import pprint
 import sys
 from collections import defaultdict
 from dataclasses import dataclass, field
-from typing import Dict, Optional
+from typing import Dict, List, Optional
 
 import xoscar as mo
 from xoscar.errors import XoscarError
 from xoscar.metrics import Metrics
 
 from ...._utils import Timer
 from ....core import ExecutionError
@@ -181,44 +181,53 @@
         )
 
     @alru_cache(cache_exceptions=False)
     async def _get_band_quota_ref(self, band: str) -> mo.ActorRefType[QuotaActor]:
         return await mo.actor_ref(QuotaActor.gen_uid(band), address=self.address)
 
     async def _prepare_input_data(self, subtask: Subtask, band_name: str):
-        queries = []
-        shuffle_queries = []
-        storage_api = await StorageAPI.create(
-            subtask.session_id, address=self.address, band_name=band_name
-        )
+        band_to_queries: Dict[str, List] = defaultdict(list)
+        band_to_shuffle_queries: Dict[str, List] = defaultdict(list)
+        band_to_storage_api: Dict[str, StorageAPI] = {}
         chunk_key_to_data_keys = get_chunk_key_to_data_keys(subtask.chunk_graph)
         for chunk in subtask.chunk_graph:
             if chunk.key in subtask.pure_depend_keys:
                 continue
             if chunk.op.gpu:  # pragma: no cover
                 to_fetch_band = band_name
             else:
                 to_fetch_band = "numa-0"
+
+            if not band_to_storage_api.get(to_fetch_band, None):
+                band_to_storage_api[to_fetch_band] = await StorageAPI.create(
+                    subtask.session_id, address=self.address, band_name=to_fetch_band
+                )
+
             if isinstance(chunk.op, Fetch):
-                queries.append(
-                    storage_api.fetch.delay(chunk.key, band_name=to_fetch_band)
+                band_to_queries[to_fetch_band].append(
+                    band_to_storage_api[to_fetch_band].fetch.delay(
+                        chunk.key, band_name=to_fetch_band
+                    )
                 )
             elif isinstance(chunk.op, FetchShuffle):
                 for key in chunk_key_to_data_keys[chunk.key]:
-                    shuffle_queries.append(
-                        storage_api.fetch.delay(
+                    band_to_shuffle_queries[to_fetch_band].append(
+                        band_to_storage_api[to_fetch_band].fetch.delay(
                             key, band_name=to_fetch_band, error="ignore"
                         )
                     )
-        if queries:
+
+        for band, queries in band_to_queries.items():
+            storage_api = band_to_storage_api[band]
             await storage_api.fetch.batch(*queries)
-        if shuffle_queries:
-            # TODO(hks): The batch method doesn't accept different error arguments,
-            #  combine them when it can.
 
+        # TODO(hks): The batch method doesn't accept different error arguments,
+        #  combine them when it can.
+        for band, shuffle_queries in band_to_shuffle_queries.items():
+            storage_api = band_to_storage_api[band]
             await storage_api.fetch.batch(*shuffle_queries)
 
     async def _collect_input_sizes(
         self, subtask: Subtask, supervisor_address: str, band_name: str
     ):
         graph = subtask.chunk_graph
         sizes = dict()
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/worker/quota.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/worker/quota.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/worker/service.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/worker/service.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/scheduling/worker/workerslot.py` & `xorbits-0.3.0/xorbits/_mars/services/scheduling/worker/workerslot.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/session/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/api/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/session/api/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/api/core.py` & `xorbits-0.3.0/xorbits/_mars/services/session/api/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/api/oscar.py` & `xorbits-0.3.0/xorbits/_mars/services/session/api/oscar.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/api/web.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/api/web.py`

 * *Files 24% similar despite different names*

```diff
@@ -9,172 +9,172 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import json
-from typing import Callable, Dict, List, Optional, Tuple, Union
+from collections import defaultdict
+from typing import Any, Callable, List, Optional
 
-from ....utils import parse_readable_size
+import xoscar as mo
+
+from ....storage import StorageLevel
+from ....utils import deserialize_serializable, serialize_serializable
 from ...web import MarsServiceWebAPIHandler, MarsWebAPIClientMixin, web_api
-from ..core import SessionInfo
-from .core import AbstractSessionAPI
+from ..core import DataInfo
+from .core import AbstractStorageAPI
 
 
-def _encode_size(size: Union[str, Dict[str, List[int]]]) -> str:
-    if not isinstance(size, dict):
-        return size
-    else:
-        return ",".join(f"{k}={v}" for k, v in size.items())
-
-
-def _decode_size(encoded: str) -> Union[int, str, Dict[str, Union[int, List[int]]]]:
-    if not encoded:
-        return 0
-    if "," not in encoded and "=" not in encoded:
-        try:
-            return int(encoded)
-        except ValueError:
-            return int(parse_readable_size(encoded)[0])
-    else:
-        ret = dict()
-        for kv in encoded.split(","):
-            k, v = kv.split("=", 1)
-            ret[k] = int(parse_readable_size(v)[0])
-        return ret
-
-
-class SessionWebAPIBaseHandler(MarsServiceWebAPIHandler):
-    async def _get_oscar_session_api(self):
-        from .oscar import SessionAPI
-
-        return await self._get_api_by_key(SessionAPI, "Session", with_key_arg=False)
-
-
-class SessionWebAPIHandler(SessionWebAPIBaseHandler):
-    @classmethod
-    def get_root_pattern(cls):
-        return "/api/session(?:/(?P<sub_path>[^/]*)$|$)"
-
-    @web_api("(?P<session_id>[^/]+)", method="put")
-    async def create_session(self, session_id: str):
-        if session_id == "None":
-            session_id = None
-        oscar_api = await self._get_oscar_session_api()
-        sess_id, addr = await oscar_api.create_session(session_id)
-        self.write({"session_id": sess_id, "address": addr})
-
-    @web_api("(?P<session_id>[^/]+)", method="delete")
-    async def delete_session(self, session_id: str):
-        oscar_api = await self._get_oscar_session_api()
-        await oscar_api.delete_session(session_id)
-
-    @web_api("", method="delete")
-    async def delete_all_sessions(self):
-        oscar_api = await self._get_oscar_session_api()
-        await oscar_api.delete_all_sessions()
-
-    @web_api(
-        "(?P<session_id>[^/]+)", method="get", arg_filter={"action": "check_exist"}
-    )
-    async def has_session(self, session_id: str):
-        oscar_api = await self._get_oscar_session_api()
-        res = await oscar_api.has_session(session_id)
-        self.write("1" if res else "0")
-
-    @web_api(
-        "(?P<session_id>[^/]*)",
-        method="get",
-        arg_filter={"action": "get_last_idle_time"},
-    )
-    async def get_last_idle_time(self, session_id: str):
-        session_id = session_id or None
-        oscar_api = await self._get_oscar_session_api()
-        res = await oscar_api.get_last_idle_time(session_id)
-        self.write(str(res) if res else "")
-
-    @web_api("", method="get")
-    async def get_sessions(self):
-        oscar_api = await self._get_oscar_session_api()
-        res = await oscar_api.get_sessions()
-        self.write(
-            json.dumps({"sessions": [{"session_id": info.session_id} for info in res]})
-        )
-
-
-class SessionWebLogAPIHandler(SessionWebAPIBaseHandler):
-    _root_pattern = "/api/session/(?P<session_id>[^/]+)/op/(?P<op_key>[^/]+)/log"
-
-    @web_api("", method="get")
-    async def fetch_tileable_op_logs(self, session_id: str, op_key: str):
-        oscar_api = await self._get_oscar_session_api()
-        offsets = _decode_size(self.get_argument("offsets", None))
-        sizes = _decode_size(self.get_argument("sizes", None))
-        log_result = await oscar_api.fetch_tileable_op_logs(
-            session_id, op_key, offsets, sizes
-        )
-        self.write(json.dumps(log_result))
-
-
-web_handlers = {
-    SessionWebAPIHandler.get_root_pattern(): SessionWebAPIHandler,
-    SessionWebLogAPIHandler.get_root_pattern(): SessionWebLogAPIHandler,
-}
+class StorageWebAPIHandler(MarsServiceWebAPIHandler):
+    _root_pattern = "/api/session/(?P<session_id>[^/]+)/storage"
 
+    async def _get_oscar_meta_api(self, session_id: str):
+        from ...meta import MetaAPI
+
+        return await self._get_api_by_key(MetaAPI, session_id)
+
+    async def _get_storage_api_by_object_id(self, session_id: str, object_id: str):
+        from .oscar import StorageAPI
+
+        meta_api = await self._get_oscar_meta_api(session_id)
+        bands = (await meta_api.get_chunk_meta(object_id, ["bands"])).get("bands")
+        if not bands:
+            raise KeyError
+        return await StorageAPI.create(session_id, bands[0][0], bands[0][1])
+
+    @web_api("(?P<data_key>[^/]+)", method="get")
+    async def get_data(self, session_id: str, data_key: str):
+        oscar_api = await self._get_storage_api_by_object_id(session_id, data_key)
+        result = await oscar_api.get(data_key)
+        self.write(serialize_serializable(result))
+
+    @web_api("batch/get", method="post")
+    async def get_batch_data(self, session_id: str):
+        body_args = deserialize_serializable(self.request.body)
+        storage_api_to_gets = defaultdict(list)
+        storage_api_to_idx = defaultdict(list)
+        results = [None] * len(body_args)
+        for i, (data_key, conditions, to_cpu, error) in enumerate(body_args):
+            oscar_api = await self._get_storage_api_by_object_id(session_id, data_key)
+            storage_api_to_idx[oscar_api].append(i)
+            storage_api_to_gets[oscar_api].append(
+                oscar_api.get.delay(
+                    data_key, conditions=conditions, to_cpu=to_cpu, error=error
+                )
+            )
+        for api, fetches in storage_api_to_gets.items():
+            data_list = await api.get.batch(*fetches)
+            for idx, data in zip(storage_api_to_idx[api], data_list):
+                results[idx] = data
+        res_data = serialize_serializable(results)
+        self.write(res_data)
+
+    @web_api("(?P<data_key>[^/]+)", method="post")
+    async def get_data_by_post(self, session_id: str, data_key: str):
+        body_args = (
+            deserialize_serializable(self.request.body) if self.request.body else None
+        )
+        conditions = body_args.get("conditions")
+        to_cpu = body_args.get("to_cpu")
 
-class WebSessionAPI(AbstractSessionAPI, MarsWebAPIClientMixin):
-    def __init__(self, address: str, request_rewriter: Callable = None):
-        self._address = address.rstrip("/")
-        self.request_rewriter = request_rewriter
+        oscar_api = await self._get_storage_api_by_object_id(session_id, data_key)
+        result = await oscar_api.get(data_key, conditions, to_cpu=to_cpu)
+        self.write(serialize_serializable(result))
+
+    @web_api("(?P<data_key>[^/]+)", method="put")
+    async def put_data(self, session_id: str, data_key: str):
+        level = self.get_argument("level", None) or "MEMORY"
+        level = getattr(StorageLevel, level.upper())
+
+        oscar_api = await self._get_storage_api_by_object_id(session_id, data_key)
+        res = await oscar_api.put(
+            data_key, deserialize_serializable(self.request.body), level
+        )
+        self.write(serialize_serializable(res))
 
-    async def get_sessions(self) -> List[SessionInfo]:
-        addr = f"{self._address}/api/session"
-        res = await self._request_url("GET", addr)
-        res_obj = json.loads(res.body.decode())
-        return [SessionInfo(**kw) for kw in res_obj["sessions"]]
-
-    async def create_session(self, session_id: Optional[str]) -> Tuple[str, str]:
-        addr = f"{self._address}/api/session/{session_id}"
-        res = await self._request_url(path=addr, method="PUT", data=b"")
-        res_obj = json.loads(res.body.decode())
-        return res_obj["session_id"], res_obj["address"]
-
-    async def delete_session(self, session_id: str):
-        addr = f"{self._address}/api/session/{session_id}"
-        await self._request_url(path=addr, method="DELETE")
-
-    async def delete_all_sessions(self):
-        addr = f"{self._address}/api/session"
-        await self._request_url(path=addr, method="DELETE")
-
-    async def has_session(self, session_id: str):
-        addr = f"{self._address}/api/session/{session_id}"
-        params = dict(action="check_exist")
-        res = await self._request_url("GET", addr, params=params)
-        return bool(int(res.body.decode()))
-
-    async def get_last_idle_time(
-        self, session_id: Union[str, None] = None
-    ) -> Union[float, None]:
-        session_id = session_id or ""
-        addr = f"{self._address}/api/session/{session_id}"
-        params = dict(action="get_last_idle_time")
-        res = await self._request_url("GET", addr, params=params)
-        content = res.body.decode()
-        return float(content) if content else None
+    @web_api("(?P<data_key>[^/]+)", method="get", arg_filter={"action": "get_infos"})
+    async def get_infos(self, session_id: str, data_key: str):
+        oscar_api = await self._get_storage_api_by_object_id(session_id, data_key)
+        res = await oscar_api.get_infos(data_key)
+        self.write(serialize_serializable(res))
 
-    async def fetch_tileable_op_logs(
+
+web_handlers = {StorageWebAPIHandler.get_root_pattern(): StorageWebAPIHandler}
+
+
+class WebStorageAPI(AbstractStorageAPI, MarsWebAPIClientMixin):
+    def __init__(
         self,
         session_id: str,
-        tileable_op_key: str,
-        chunk_op_key_to_offsets: Dict[str, List[int]],
-        chunk_op_key_to_sizes: Dict[str, List[int]],
-    ) -> Dict:
-        addr = f"{self._address}/api/session/{session_id}/op/{tileable_op_key}/log"
-        params = dict(
-            offsets=_encode_size(chunk_op_key_to_offsets),
-            sizes=_encode_size(chunk_op_key_to_sizes),
+        address: str,
+        band_name: str,
+        request_rewriter: Callable = None,
+    ):
+        self._session_id = session_id
+        self._address = address.rstrip("/")
+        self._band_name = band_name
+        self.request_rewriter = request_rewriter
+
+    @mo.extensible
+    async def get(
+        self,
+        data_key: str,
+        conditions: List = None,
+        to_cpu: Optional[bool] = None,
+        error: str = "raise",
+    ) -> Any:
+        path = f"{self._address}/api/session/{self._session_id}/storage/{data_key}"
+        params = dict(error=error)
+        if conditions is not None:
+            params["conditions"] = conditions
+            params["to_cpu"] = to_cpu
+        body = serialize_serializable(params)
+        res = await self._request_url(
+            path=path,
+            method="POST",
+            headers={"Content-Type": "application/octet-stream"},
+            data=body,
+        )
+        return deserialize_serializable(res.body)
+
+    @get.batch
+    async def get_batch(self, args_list, kwargs_list):
+        get_chunks = []
+        for args, kwargs in zip(args_list, kwargs_list):
+            data_key, conditions, to_cpu, error = self.get.bind(*args, **kwargs)
+            get_chunks.append([data_key, conditions, to_cpu, error])
+
+        path = f"{self._address}/api/session/{self._session_id}/storage/batch/get"
+        res = await self._request_url(
+            path=path,
+            method="POST",
+            data=serialize_serializable(get_chunks),
+        )
+        return deserialize_serializable(res.body)
+
+    @mo.extensible
+    async def put(
+        self, data_key: str, obj: object, level: StorageLevel = StorageLevel.MEMORY
+    ) -> DataInfo:
+        params = dict(level=level.name.lower())
+        path = f"{self._address}/api/session/{self._session_id}/storage/{data_key}"
+        res = await self._request_url(
+            path=path,
+            method="PUT",
+            params=params,
+            headers={"Content-Type": "application/octet-stream"},
+            data=serialize_serializable(obj),
+        )
+        return deserialize_serializable(res.body)
+
+    @mo.extensible
+    async def get_infos(self, data_key: str) -> List[DataInfo]:
+        path = f"{self._address}/api/session/{self._session_id}/storage/{data_key}"
+        params = dict(action="get_infos")
+        res = await self._request_url(
+            path=path,
+            method="GET",
+            headers={"Content-Type": "application/octet-stream"},
+            params=params,
         )
-        res = await self._request_url("GET", addr, params=params)
-        return json.loads(res.body.decode())
+        return deserialize_serializable(res.body)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/core.py` & `xorbits-0.3.0/xorbits/_mars/services/session/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/supervisor/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/session/supervisor/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/supervisor/core.py` & `xorbits-0.3.0/xorbits/_mars/services/session/supervisor/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/supervisor/custom_log.py` & `xorbits-0.3.0/xorbits/_mars/services/session/supervisor/custom_log.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/supervisor/service.py` & `xorbits-0.3.0/xorbits/_mars/services/session/worker/service.py`

 * *Files 14% similar despite different names*

```diff
@@ -12,36 +12,36 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import xoscar as mo
 
 from ...core import AbstractService
-from .core import SessionManagerActor
+from .custom_log import CustomLogActor
 
 
-class SessionSupervisorService(AbstractService):
+class SessionWorkerService(AbstractService):
     """
-    Session service on supervisor.
+    Session service on worker.
 
-    Session Configuration
+    Service Configuration
     ---------------------
     {
         "session" : {
         }
     }
     """
 
     async def start(self):
+        session_config = self._config.get("session", dict())
+        custom_log_dir = session_config.get("custom_log_dir")
         await mo.create_actor(
-            SessionManagerActor,
-            self._config,
-            uid=SessionManagerActor.default_uid(),
+            CustomLogActor,
+            custom_log_dir,
             address=self._address,
+            uid=CustomLogActor.default_uid(),
         )
 
     async def stop(self):
         await mo.destroy_actor(
-            mo.create_actor_ref(
-                uid=SessionManagerActor.default_uid(), address=self._address
-            )
+            mo.create_actor_ref(uid=CustomLogActor.default_uid(), address=self._address)
         )
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/worker/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/session/worker/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/worker/custom_log.py` & `xorbits-0.3.0/xorbits/_mars/services/session/worker/custom_log.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/session/worker/service.py` & `xorbits-0.3.0/xorbits/_mars/services/task/worker/service.py`

 * *Files 19% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 # Copyright 2022-2023 XProbe Inc.
-# derived from copyright 1999-2021 Alibaba Group Holding Ltd.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #      http://www.apache.org/licenses/LICENSE-2.0
 #
@@ -12,36 +11,26 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import xoscar as mo
 
 from ...core import AbstractService
-from .custom_log import CustomLogActor
+from ..task_info_collector import TaskInfoCollectorActor
 
 
-class SessionWorkerService(AbstractService):
-    """
-    Session service on worker.
-
-    Service Configuration
-    ---------------------
-    {
-        "session" : {
-        }
-    }
-    """
-
+class TaskWorkerService(AbstractService):
     async def start(self):
-        session_config = self._config.get("session", dict())
-        custom_log_dir = session_config.get("custom_log_dir")
+        profiling_config = self._config.get("profiling", dict())
         await mo.create_actor(
-            CustomLogActor,
-            custom_log_dir,
+            TaskInfoCollectorActor,
+            profiling_config,
+            uid=TaskInfoCollectorActor.default_uid(),
             address=self._address,
-            uid=CustomLogActor.default_uid(),
         )
 
     async def stop(self):
         await mo.destroy_actor(
-            mo.create_actor_ref(uid=CustomLogActor.default_uid(), address=self._address)
+            mo.create_actor_ref(
+                uid=TaskInfoCollectorActor.default_uid(), address=self._address
+            )
         )
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/storage/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/storage/api/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/api/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/storage/api/core.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/api/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/storage/api/oscar.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/api/oscar.py`

 * *Files 2% similar despite different names*

```diff
@@ -10,15 +10,15 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import sys
-from typing import Any, List, Tuple, Type, TypeVar, Union
+from typing import Any, List, Optional, Tuple, Type, TypeVar, Union
 
 import xoscar as mo
 
 from ....lib.aio import alru_cache
 from ....storage.base import StorageFileObject, StorageLevel
 from ...cluster import StorageInfo
 from ..core import (
@@ -89,18 +89,22 @@
         """
         If storage backend is seekable.
         """
         return await self._storage_handler_ref.is_seekable(storage_level)
 
     @mo.extensible
     async def get(
-        self, data_key: str, conditions: List = None, error: str = "raise"
+        self,
+        data_key: str,
+        conditions: List = None,
+        to_cpu: Optional[bool] = None,
+        error: str = "raise",
     ) -> Any:
         return await self._storage_handler_ref.get(
-            self._session_id, data_key, conditions, error
+            self._session_id, data_key, conditions, to_cpu, error
         )
 
     @get.batch
     async def batch_get(self, args_list, kwargs_list):
         gets = []
         for args, kwargs in zip(args_list, kwargs_list):
             gets.append(
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/storage/core.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/storage/errors.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/errors.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/storage/handler.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/handler.py`

 * *Files 3% similar despite different names*

```diff
@@ -12,15 +12,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import asyncio
 import logging
 from collections import defaultdict
-from typing import Any, Dict, List, Union
+from typing import Any, Dict, List, Optional, Union
 
 import xoscar as mo
 from xoscar.serialization import AioDeserializer
 
 from ...storage import StorageLevel, get_storage_backend
 from ...storage.core import StorageFileObject
 from ...typing import BandType
@@ -107,97 +107,112 @@
         else:
             try:
                 res = yield self._clients[data_info.level].get(
                     data_info.object_id, conditions=conditions
                 )
             except NotImplementedError:
                 data = yield self._clients[data_info.level].get(data_info.object_id)
+
                 try:
-                    sliced_value = data.iloc[tuple(conditions)]
+                    from ...dataframe.utils import is_cudf
+
+                    if is_cudf(data) and len(conditions) == 1:
+                        sliced_value = data.iloc[conditions[0]]
+                    else:
+                        sliced_value = data.iloc[tuple(conditions)]
                 except AttributeError:
                     sliced_value = data[tuple(conditions)]
                 res = sliced_value
         raise mo.Return(res)
 
     @mo.extensible
     async def get(
         self,
         session_id: str,
         data_key: str,
         conditions: List = None,
+        to_cpu: Optional[bool] = None,
         error: str = "raise",
     ):
         try:
             data_info = await self._data_manager_ref.get_data_info(
                 session_id, data_key, self._band_name
             )
             data = yield self._get_data(data_info, conditions)
+
+            from ...dataframe.utils import is_cudf
+            from ...tensor.array_utils import is_cupy
+
+            if (is_cudf(data) or is_cupy(data)) and to_cpu is True:
+                data = data.to_pandas() if is_cudf(data) else data.get()
             raise mo.Return(data)
         except DataNotExist:
             if error == "raise":
                 raise
 
     def _get_data_info(
         self,
         session_id: str,
         data_key: str,
         conditions: List = None,
+        to_cpu: Optional[bool] = None,
         error: str = "raise",
     ):
         info = self._data_manager_ref.get_data_info.delay(
             session_id, data_key, self._band_name, error
         )
-        return info, conditions
+        return info, conditions, to_cpu
 
     @get.batch
     async def batch_get(self, args_list, kwargs_list):
         infos = []
         conditions_list = []
+        to_cpus = []
         for args, kwargs in zip(args_list, kwargs_list):
-            info, conditions = self._get_data_info(*args, **kwargs)
+            info, conditions, to_cpu = self._get_data_info(*args, **kwargs)
             infos.append(info)
             conditions_list.append(conditions)
+            to_cpus.append(to_cpu)
         data_infos = await self._data_manager_ref.get_data_info.batch(*infos)
         results = []
         writer_args = [
             (info.object_id, info.level)
             for info in data_infos
             if info is not None and info.offset is not None
         ]
         object_id_to_reader = dict()
         for object_id, level in writer_args:
             object_id_to_reader[object_id] = await self._clients[level].open_reader(
                 object_id
             )
-        for data_info, conditions in zip(data_infos, conditions_list):
-            if data_info is None:
-                results.append(None)
+        for data_info, conditions, to_cpu in zip(data_infos, conditions_list, to_cpus):
+            if data_info is None:  # pragma: no cover
+                result = None
             elif data_info.offset is not None:
                 reader = object_id_to_reader[data_info.object_id]
                 await reader.seek(data_info.offset)
                 result = await AioDeserializer(reader).run()
-                results.append(result)
             else:
                 result = yield self._get_data(data_info, conditions)
-                results.append(result)
+
+            from ...dataframe.utils import is_cudf
+            from ...tensor.array_utils import is_cupy
+
+            if (is_cudf(result) or is_cupy(result)) and to_cpu is True:
+                result = result.to_pandas() if is_cudf(result) else result.get()
+            results.append(result)
         raise mo.Return(results)
 
     def _get_default_level(self, obj):
-        obj = obj[0] if isinstance(obj, (list, tuple)) else obj
+        from ...dataframe.utils import get_storage_level_gpu_or_memory
+
         if self.highest_level != StorageLevel.GPU:
             return self.highest_level
-        else:  # pragma: no cover
-            if cudf is not None and isinstance(
-                obj, (cudf.DataFrame, cudf.Series, cudf.Index)
-            ):
-                return StorageLevel.GPU
-            elif cupy is not None and isinstance(obj, cupy.ndarray):
-                return StorageLevel.GPU
-            else:
-                return StorageLevel.MEMORY
+        else:
+            return get_storage_level_gpu_or_memory(obj)
 
     @mo.extensible
     async def put(
         self, session_id: str, data_key: str, obj: object, level: StorageLevel = None
     ) -> DataInfo:
         if level is None:
             level = self._get_default_level(obj)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/storage/spill.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/spill.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/storage/supervisor/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/supervisor/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/storage/transfer.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/transfer.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/storage/worker/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/worker/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/storage/worker/service.py` & `xorbits-0.3.0/xorbits/_mars/services/storage/worker/service.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/subtask/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/subtask/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/subtask/api.py` & `xorbits-0.3.0/xorbits/_mars/services/subtask/api.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/subtask/core.py` & `xorbits-0.3.0/xorbits/_mars/services/subtask/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/subtask/errors.py` & `xorbits-0.3.0/xorbits/_mars/services/subtask/errors.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/subtask/supervisor/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/subtask/supervisor/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/subtask/utils.py` & `xorbits-0.3.0/xorbits/_mars/services/subtask/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/subtask/worker/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/subtask/worker/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/subtask/worker/manager.py` & `xorbits-0.3.0/xorbits/_mars/services/subtask/worker/manager.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/subtask/worker/processor.py` & `xorbits-0.3.0/xorbits/_mars/services/subtask/worker/processor.py`

 * *Files 6% similar despite different names*

```diff
@@ -23,16 +23,18 @@
 import xoscar as mo
 from xoscar.metrics import Metrics
 from xoscar.serialization import AioSerializer
 
 from ....core import ChunkGraph, ExecutionError, OperandType, enter_mode
 from ....core.context import get_context
 from ....core.operand import Fetch, FetchShuffle, execute
+from ....dataframe.utils import get_storage_level_gpu_or_memory
 from ....lib.aio import alru_cache
 from ....optimization.physical import optimize
+from ....storage import StorageLevel
 from ....typing import BandType, ChunkType
 from ....utils import Timer, calc_data_size, get_chunk_key_to_data_keys
 from ...context import ThreadedServiceContext
 from ...meta.api import MetaAPI, WorkerMetaAPI
 from ...session import SessionAPI
 from ...storage import StorageAPI
 from ...task import TaskAPI, task_options
@@ -304,62 +306,75 @@
         if shuffle_unpins:
             # TODO(hks): The batch method doesn't accept different error arguments,
             #  combine them when it can.
             await self._storage_api.unpin.batch(*shuffle_unpins)
 
     async def _store_data(self, chunk_graph: ChunkGraph):
         # store data into storage
-        data_key_to_puts = {}
+        # The data stored in the storage needs to be separated based on levels
+        # (here we only have two levels: memory and GPU).
+        # Otherwise, it is hard to uniformly plan the storage region when writing data in batch.
+        level_to_data_key_to_puts: Dict[StorageLevel, Dict[str, Any]] = defaultdict(
+            dict
+        )
         shuffle_key_to_data = {}
         is_storage_seekable = await self._storage_api.is_seekable()
         for key, data, _ in iter_output_data(chunk_graph, self._processor_context):
             if isinstance(key, tuple) and is_storage_seekable:
                 shuffle_key_to_data[key] = data
             else:
+                storage_level = get_storage_level_gpu_or_memory(data)
                 put = self._storage_api.put.delay(key, data)
-                data_key_to_puts[key] = put
+                level_to_data_key_to_puts[storage_level][key] = put
 
-        stored_keys = list(data_key_to_puts.keys())
-        puts = data_key_to_puts.values()
-        logger.debug(
-            "Start putting data keys: %s, subtask id: %s",
-            stored_keys,
-            self.subtask.subtask_id,
-        )
+        stored_keys = []
         data_key_to_store_size = dict()
         data_key_to_memory_size = dict()
         data_key_to_object_id = dict()
-        if puts:
-            put_infos = asyncio.create_task(self._storage_api.put.batch(*puts))
-            try:
-                store_infos = await put_infos
-                for store_key, store_info in zip(stored_keys, store_infos):
-                    data_key_to_store_size[store_key] = store_info.store_size
-                    data_key_to_memory_size[store_key] = store_info.memory_size
-                    data_key_to_object_id[store_key] = store_info.object_id
-                logger.debug(
-                    "Finish putting data keys: %s, subtask id: %s",
-                    stored_keys,
-                    self.subtask.subtask_id,
-                )
-            except asyncio.CancelledError:
-                logger.debug(
-                    "Cancelling put data keys: %s, subtask id: %s",
-                    stored_keys,
-                    self.subtask.subtask_id,
-                )
-                put_infos.cancel()
-
-                logger.debug(
-                    "Cancelled put data keys: %s, subtask id: %s",
-                    stored_keys,
-                    self.subtask.subtask_id,
-                )
-                self.result.status = SubtaskStatus.cancelled
-                raise
+        data_info_fmt = "data keys: %s, subtask id: %s, storage level: %s"
+        for storage_level, data_key_to_puts in level_to_data_key_to_puts.items():
+            stored_keys.extend(list(data_key_to_puts.keys()))
+            puts = data_key_to_puts.values()
+            logger.debug(
+                f"Start putting {data_info_fmt}",
+                stored_keys,
+                self.subtask.subtask_id,
+                storage_level,
+            )
+            if puts:
+                put_infos = asyncio.create_task(self._storage_api.put.batch(*puts))
+                try:
+                    store_infos = await put_infos
+                    for store_key, store_info in zip(stored_keys, store_infos):
+                        data_key_to_store_size[store_key] = store_info.store_size
+                        data_key_to_memory_size[store_key] = store_info.memory_size
+                        data_key_to_object_id[store_key] = store_info.object_id
+                    logger.debug(
+                        f"Finish putting {data_info_fmt}",
+                        stored_keys,
+                        self.subtask.subtask_id,
+                        storage_level,
+                    )
+                except asyncio.CancelledError:  # pragma: no cover
+                    logger.debug(
+                        f"Cancelling put {data_info_fmt}",
+                        stored_keys,
+                        self.subtask.subtask_id,
+                        storage_level,
+                    )
+                    put_infos.cancel()
+
+                    logger.debug(
+                        f"Cancelled put {data_info_fmt}",
+                        stored_keys,
+                        self.subtask.subtask_id,
+                        storage_level,
+                    )
+                    self.result.status = SubtaskStatus.cancelled
+                    raise
 
         if shuffle_key_to_data:
             await self._store_mapper_data(
                 shuffle_key_to_data,
                 data_key_to_store_size,
                 data_key_to_memory_size,
                 data_key_to_object_id,
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/subtask/worker/runner.py` & `xorbits-0.3.0/xorbits/_mars/services/subtask/worker/runner.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/subtask/worker/service.py` & `xorbits-0.3.0/xorbits/_mars/services/subtask/worker/service.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/task/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/analyzer/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/task/analyzer/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/analyzer/analyzer.py` & `xorbits-0.3.0/xorbits/_mars/services/task/analyzer/analyzer.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/analyzer/assigner.py` & `xorbits-0.3.0/xorbits/_mars/services/task/analyzer/assigner.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/analyzer/fusion.py` & `xorbits-0.3.0/xorbits/_mars/services/task/analyzer/fusion.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/api/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/task/api/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/api/core.py` & `xorbits-0.3.0/xorbits/_mars/services/task/api/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/api/oscar.py` & `xorbits-0.3.0/xorbits/_mars/services/task/api/oscar.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/api/web.py` & `xorbits-0.3.0/xorbits/_mars/services/task/api/web.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/config.py` & `xorbits-0.3.0/xorbits/_mars/services/task/config.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/core.py` & `xorbits-0.3.0/xorbits/_mars/services/task/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/errors.py` & `xorbits-0.3.0/xorbits/_mars/services/task/errors.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/execution/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/task/execution/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/execution/api.py` & `xorbits-0.3.0/xorbits/_mars/services/task/execution/api.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/config.py` & `xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/config.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/executor.py` & `xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/executor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/fetcher.py` & `xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/fetcher.py`

 * *Files 8% similar despite different names*

```diff
@@ -27,24 +27,32 @@
     name = "mars"
     required_meta_keys = ("bands",)
 
     def __init__(self, get_storage_api, **kwargs):
         self._get_storage_api = get_storage_api
         self._storage_api_to_gets = defaultdict(list)
         self._counter = 0
+        self._to_cpu = kwargs.pop("to_cpu", True)
+
+        if kwargs:  # pragma: no cover
+            unexpected_keys = ", ".join(list(kwargs.keys()))
+            raise TypeError(f"unexpected arguments: {unexpected_keys}")
 
     async def append(self, chunk_key: str, chunk_meta: Dict, conditions: List = None):
         band = None
         if chunk_meta:
             bands = chunk_meta.get("bands")
             if bands:
                 band = bands[0]
         storage_api = await self._get_storage_api(band)
         get = _GetWithIndex(
-            storage_api.get.delay(chunk_key, conditions=conditions), self._counter
+            storage_api.get.delay(
+                chunk_key, conditions=conditions, to_cpu=self._to_cpu
+            ),
+            self._counter,
         )
         self._storage_api_to_gets[storage_api].append(get)
         self._counter += 1
 
     async def get(self):
         results = [None] * self._counter
         for storage_api in self._storage_api_to_gets:
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/resource.py` & `xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/resource.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/execution/mars/stage.py` & `xorbits-0.3.0/xorbits/_mars/services/task/execution/mars/stage.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/execution/utils.py` & `xorbits-0.3.0/xorbits/_mars/services/task/execution/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/supervisor/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/task/supervisor/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/supervisor/graph_visualizer.py` & `xorbits-0.3.0/xorbits/_mars/services/task/supervisor/graph_visualizer.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/supervisor/manager.py` & `xorbits-0.3.0/xorbits/_mars/services/task/supervisor/manager.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/supervisor/processor.py` & `xorbits-0.3.0/xorbits/_mars/services/task/supervisor/processor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/supervisor/service.py` & `xorbits-0.3.0/xorbits/_mars/services/task/supervisor/service.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/supervisor/task.py` & `xorbits-0.3.0/xorbits/_mars/services/task/supervisor/task.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/task_info_collector.py` & `xorbits-0.3.0/xorbits/_mars/services/task/task_info_collector.py`

 * *Files 2% similar despite different names*

```diff
@@ -20,15 +20,15 @@
 import os
 from collections import defaultdict
 from typing import Any, Dict, Optional
 
 import xoscar as mo
 import yaml
 
-from ...constants import MARS_PROFILING_RESULTS_DIR, MARS_PROFILING_RESULTS_DIR_WIN
+from ...constants import MARS_PROFILING_RESULTS_DIR
 from ...core.operand import Fetch, FetchShuffle
 from ...lib.aio import AioFileObject, Isolation, alru_cache
 from ...lib.filesystem import get_fs, get_scheme, open_file
 from ...services.subtask import Subtask, SubtaskGraph
 from ...services.task.core import Task
 from ...typing import ChunkType, TileableType
 from ...utils import calc_data_size
@@ -355,23 +355,16 @@
             )
             self._loop = asyncio.new_event_loop()
             self._isolation = Isolation(self._loop)
             self._isolation.start()
 
     @staticmethod
     def _get_or_create_default_profiling_results_dir():
-        import sys
-
-        if sys.platform.startswith("win"):
-            profiling_results_dir = MARS_PROFILING_RESULTS_DIR_WIN
-        else:
-            profiling_results_dir = MARS_PROFILING_RESULTS_DIR
-        os.makedirs(profiling_results_dir, exist_ok=True)
-        os.chmod(profiling_results_dir, mode=0o777)
-        return profiling_results_dir
+        os.makedirs(MARS_PROFILING_RESULTS_DIR, exist_ok=True)
+        return MARS_PROFILING_RESULTS_DIR
 
     async def __pre_destroy__(self):
         if self._collect_task_info_enabled:
             self._isolation.stop()
 
     async def collect_task_info_enabled(self):
         return self._collect_task_info_enabled
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/task/worker/__init__.py` & `xorbits-0.3.0/xorbits/_mars/services/task/worker/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/web/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/spatial/distance/__init__.py`

 * *Files 16% similar despite different names*

```diff
@@ -9,19 +9,10 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from .api import OscarWebAPI
-from .core import (
-    MarsRequestHandler,
-    MarsServiceWebAPIHandler,
-    MarsWebAPIClientMixin,
-    web_api,
-)
-
-try:
-    from .supervisor import WebActor
-except ImportError:  # pragma: no cover
-    pass
+from .cdist import cdist
+from .pdist import pdist
+from .squareform import squareform
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/web/api/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reshape/__init__.py`

 * *Files 3% similar despite different names*

```diff
@@ -9,8 +9,8 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from .oscar import OscarWebAPI
+from .reshape import reshape
```

### Comparing `xorbits-0.2.2/xorbits/_mars/services/web/api/oscar.py` & `xorbits-0.3.0/xorbits/_mars/services/web/api/oscar.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/web/api/web.py` & `xorbits-0.3.0/xorbits/_mars/services/web/api/web.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/web/core.py` & `xorbits-0.3.0/xorbits/_mars/services/web/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/web/handlers.py` & `xorbits-0.3.0/xorbits/_mars/services/web/handlers.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/web/supervisor.py` & `xorbits-0.3.0/xorbits/_mars/services/web/supervisor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/services/web/worker.py` & `xorbits-0.3.0/xorbits/numpy/lib/__init__.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,20 +1,15 @@
 # Copyright 2022-2023 XProbe Inc.
-# derived from copyright 1999-2021 Alibaba Group Holding Ltd.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #      http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from ..core import EmptyService
-
-
-class WebWorkerService(EmptyService):
-    pass
+from . import index_tricks
```

### Comparing `xorbits-0.2.2/xorbits/_mars/session.py` & `xorbits-0.3.0/xorbits/_mars/session.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/storage/__init__.py` & `xorbits-0.3.0/xorbits/_mars/storage/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/storage/base.py` & `xorbits-0.3.0/xorbits/_mars/storage/base.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/storage/core.py` & `xorbits-0.3.0/xorbits/_mars/storage/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/storage/cuda.py` & `xorbits-0.3.0/xorbits/_mars/storage/cuda.py`

 * *Files 1% similar despite different names*

```diff
@@ -248,14 +248,17 @@
             return cudf.DataFrame.from_pandas(obj)
         elif isinstance(obj, pd.Series):
             return cudf.Series.from_pandas(obj)
         return obj
 
     @implements(StorageBackend.get)
     async def get(self, object_id: str, **kwargs) -> object:
+        if kwargs:
+            raise NotImplementedError(f'Got unsupported args: {",".join(kwargs)}')
+
         from cudf.core.buffer import Buffer as CPBuffer
         from rmm import DeviceBuffer
 
         headers, buffers = _id_to_buffers[object_id]
         new_buffers = []
         for buf in buffers:
             if isinstance(buf, cupy.ndarray):
```

### Comparing `xorbits-0.2.2/xorbits/_mars/storage/errors.py` & `xorbits-0.3.0/xorbits/_mars/storage/errors.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/storage/filesystem.py` & `xorbits-0.3.0/xorbits/_mars/storage/filesystem.py`

 * *Files 22% similar despite different names*

```diff
@@ -8,23 +8,23 @@
 #      http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
-
+import asyncio
 import os
 import uuid
 from typing import Dict, List, Optional, Tuple
 
 from xoscar.serialization import AioDeserializer, AioSerializer
 
 from ..lib.aio import AioFilesystem
-from ..lib.filesystem import FileSystem, get_fs
+from ..lib.filesystem import FileSystem, LocalFileSystem, get_fs
 from ..utils import implements, mod_hash
 from .base import ObjectInfo, StorageBackend, StorageLevel, register_storage_backend
 from .core import StorageFileObject
 
 
 @register_storage_backend
 class FileSystemStorage(StorageBackend):
@@ -145,7 +145,57 @@
     name = "disk"
 
     @classmethod
     @implements(StorageBackend.setup)
     async def setup(cls, **kwargs) -> Tuple[Dict, Dict]:
         kwargs["level"] = StorageLevel.DISK
         return await super().setup(**kwargs)
+
+
+@register_storage_backend
+class AlluxioStorage(FileSystemStorage):
+    name = "alluxio"
+
+    def __init__(
+        self,
+        root_dir: str,
+        local_environ: bool,
+        level: StorageLevel = None,
+        size: int = None,
+    ):
+        self._fs = AioFilesystem(LocalFileSystem())
+        self._root_dirs = [root_dir]
+        self._level = level
+        self._size = size
+        self._local_environ = local_environ
+
+    @classmethod
+    @implements(StorageBackend.setup)
+    async def setup(cls, **kwargs) -> Tuple[Dict, Dict]:
+        kwargs["level"] = StorageLevel.MEMORY
+        root_dir = kwargs.get("root_dir")
+        local_environ = kwargs.get("local_environ")
+        if local_environ:
+            proc = await asyncio.create_subprocess_shell(
+                f"""$ALLUXIO_HOME/bin/alluxio fs mkdir /alluxio-storage
+                $ALLUXIO_HOME/integration/fuse/bin/alluxio-fuse mount {root_dir} /alluxio-storage
+                """
+            )
+            await proc.wait()
+        params = dict(
+            root_dir=root_dir,
+            level=StorageLevel.MEMORY,
+            size=None,
+            local_environ=local_environ,
+        )
+        return params, dict(root_dir=root_dir)
+
+    @staticmethod
+    @implements(StorageBackend.teardown)
+    async def teardown(**kwargs):
+        root_dir = kwargs.get("root_dir")
+        proc = await asyncio.create_subprocess_shell(
+            f"""$ALLUXIO_HOME/integration/fuse/bin/alluxio-fuse unmount {root_dir} /alluxio-storage
+            $ALLUXIO_HOME/bin/alluxio fs rm -R /alluxio-storage
+            """
+        )
+        await proc.wait()
```

### Comparing `xorbits-0.2.2/xorbits/_mars/storage/plasma.py` & `xorbits-0.3.0/xorbits/_mars/storage/plasma.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/storage/shared_memory.py` & `xorbits-0.3.0/xorbits/_mars/storage/shared_memory.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/storage/vineyard.py` & `xorbits-0.3.0/xorbits/_mars/storage/vineyard.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/supervisor.py` & `xorbits-0.3.0/xorbits/_mars/supervisor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/__init__.py`

 * *Files 0% similar despite different names*

```diff
@@ -34,14 +34,15 @@
     diag,
     diagflat,
     eye,
     identity,
     linspace,
     meshgrid,
     indices,
+    tri,
     tril,
     triu,
     fromtiledb,
     fromtiledb as from_tiledb,
     from_dataframe,
     fromhdf5,
     fromhdf5 as from_hdf5,
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/abs.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/abs.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/absolute.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/absolute.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/add.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/add.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/angle.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/angle.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arccos.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arccos.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arccosh.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arccosh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arcsin.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arcsin.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arcsinh.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arcsinh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arctan.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arctan.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arctan2.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arctan2.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/arctanh.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/arctanh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/around.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/around.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/bitand.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/bitand.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/bitor.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/bitor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/bitxor.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/bitxor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/cbrt.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/cbrt.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/ceil.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/ceil.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/clip.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/clip.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/conj.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/conj.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/copysign.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/copysign.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/cos.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/cos.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/cosh.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/cosh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/deg2rad.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/deg2rad.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/degrees.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/degrees.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/divide.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/divide.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/equal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/equal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/exp.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/exp.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/exp2.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/exp2.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/expm1.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/expm1.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/fabs.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/fabs.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/fix.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/fix.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/float_power.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/float_power.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/floor.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/floor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/floordiv.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/floordiv.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/fmax.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/fmax.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/fmin.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/fmin.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/fmod.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/fmod.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/frexp.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/frexp.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/greater.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/greater.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/greater_equal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/greater_equal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/hypot.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/hypot.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/i0.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/i0.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/imag.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/imag.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/invert.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/invert.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/isclose.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/isclose.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/iscomplex.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/iscomplex.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/isfinite.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/isfinite.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/isinf.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/isinf.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/isnan.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/isnan.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/isreal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/isreal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/ldexp.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/ldexp.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/less.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/less.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/less_equal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/less_equal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/log.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/log.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/log10.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/log10.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/log1p.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/log1p.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/log2.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/log2.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/logaddexp.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/logaddexp.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/logaddexp2.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/logaddexp2.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/logical_and.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/logical_and.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/logical_not.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/logical_not.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/logical_or.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/logical_or.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/logical_xor.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/logical_xor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/lshift.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/lshift.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/maximum.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/maximum.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/minimum.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/minimum.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/mod.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/mod.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/modf.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/modf.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/multiply.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/multiply.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/nan_to_num.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/nan_to_num.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/negative.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/negative.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/nextafter.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/nextafter.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/not_equal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/not_equal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/positive.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/positive.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/power.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/power.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/rad2deg.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/rad2deg.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/radians.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/radians.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/real.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/real.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/reciprocal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/reciprocal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/rint.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/rint.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/rshift.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/rshift.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/setimag.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/setimag.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/setreal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/setreal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/sign.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/sign.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/signbit.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/signbit.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/sin.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/sin.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/sinc.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/sinc.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/sinh.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/sinh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/spacing.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/spacing.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/sqrt.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/sqrt.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/square.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/square.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/subtract.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/subtract.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/tan.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/tan.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/tanh.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/tanh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/truediv.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/truediv.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/trunc.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/trunc.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/arithmetic/utils.py` & `xorbits-0.3.0/xorbits/_mars/tensor/arithmetic/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/array_utils.py` & `xorbits-0.3.0/xorbits/_mars/tensor/array_utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -16,15 +16,15 @@
 from collections import defaultdict
 from contextlib import contextmanager
 
 import numpy as np
 
 from ..lib import sparse
 from ..lib.sparse.core import get_dense_module, issparse
-from ..utils import lazy_import
+from ..utils import is_same_module, lazy_import
 
 cp = lazy_import("cupy", rename="cp")
 
 
 def is_array(x):
     if isinstance(x, np.ndarray):
         return True
@@ -161,15 +161,15 @@
 
 def as_np_array(x):
     xp = get_array_module(x)
     return x if xp == np else x.get()
 
 
 def is_sparse_module(xp):
-    return xp is sparse
+    return is_same_module(xp, sparse)
 
 
 @contextmanager
 def device(device_id):
     if device_id is None or device_id < 0:
         yield
     else:  # pragma: no cover
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/argpartition.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/argpartition.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/argsort.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/argsort.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/argtopk.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/argtopk.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/argwhere.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/argwhere.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/array_split.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/array_split.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/astype.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/astype.py`

 * *Files 1% similar despite different names*

```diff
@@ -13,15 +13,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import numpy as np
 
 from ... import opcodes as OperandDef
 from ...serialization.serializables import KeyField, StringField
-from ...utils import get_dtype
+from ...utils import get_dtype, is_same_module
 from ..array_utils import as_same_device, device
 from ..operands import TensorHasInput, TensorOperandMixin
 from ..utils import get_order
 
 
 class TensorAstype(TensorHasInput, TensorOperandMixin):
     _op_type_ = OperandDef.ASTYPE
@@ -78,15 +78,15 @@
             [ctx[c.key] for c in op.inputs], device=op.device, ret_extra=True
         )
 
         with device(device_id):
             if op.sparse:
                 ctx[chunk.key] = x.astype(op.dtype)
             else:
-                if xp is np:
+                if is_same_module(xp, np):
                     ctx[chunk.key] = x.astype(
                         op.dtype, order=op.order, casting=op.casting
                     )
                 else:  # pragma: no cover
                     # cupy does not support casting
                     ctx[chunk.key] = x.astype(op.dtype, order=op.order)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/atleast_1d.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/atleast_1d.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/atleast_2d.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/atleast_2d.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/atleast_3d.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/atleast_3d.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/broadcast_arrays.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/broadcast_arrays.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/broadcast_to.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/broadcast_to.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/copy.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/copy.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/copyto.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/copyto.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/delete.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/delete.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/diff.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/diff.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/dsplit.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/dsplit.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/ediff1d.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/ediff1d.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/expand_dims.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/expand_dims.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/flatten.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/flatten.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/flip.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/flip.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/fliplr.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/fliplr.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/flipud.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/flipud.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/hsplit.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/hsplit.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/in1d.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/in1d.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/insert.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/insert.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/isin.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/ones.py`

 * *Files 18% similar despite different names*

```diff
@@ -9,192 +9,210 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from typing import Union
-
 import numpy as np
 
 from ... import opcodes as OperandDef
-from ...serialization.serializables import BoolField
-from ...typing import TileableType
-from ..array_utils import as_same_device, device
-from ..core import TensorOrder
-from ..datasource import tensor as astensor
-from ..operands import TensorOperand, TensorOperandMixin
-
-
-class TensorIsIn(TensorOperand, TensorOperandMixin):
-    _op_type_ = OperandDef.ISIN
-
-    assume_unique = BoolField("assume_unique")
-    invert = BoolField("invert")
-
-    def __call__(self, element, test_elements):
-        self.dtype = np.dtype(bool)
-        return self.new_tensor(
-            [element, test_elements], shape=element.shape, order=TensorOrder.C_ORDER
-        )
+from ...lib.sparse import SparseNDArray
+from ...lib.sparse.core import get_array_module, get_sparse_module, naked
+from ...serialization.serializables import (
+    AnyField,
+    FieldTypes,
+    KeyField,
+    StringField,
+    TupleField,
+)
+from ..array_utils import convert_order, create_array
+from ..utils import get_order
+from .array import tensor
+from .core import TensorLike, TensorNoInput
+
+
+class TensorOnes(TensorNoInput):
+    _op_type_ = OperandDef.TENSOR_ONES
+
+    order = StringField("order")
+    shape = TupleField("shape", FieldTypes.int64)
+    chunk_size = AnyField("chunk_size")
+
+    def __init__(self, shape=None, **kwargs):
+        if type(shape) is int:
+            shape = (shape,)
+        super().__init__(shape=shape, **kwargs)
+
+    def to_chunk_op(self, *args):
+        chunk_op = super().to_chunk_op(*args)
+        chunk_op.shape = args[0]
+        chunk_op.chunk_size = None
+        return chunk_op
 
     @classmethod
-    def tile(cls, op):
-        from ..merge.stack import TensorStack
-        from ..reduction import TensorAll, TensorAny
-
-        ar1, ar2 = op.inputs
-        invert = op.invert
-        out = op.outputs[0]
-
-        out_chunks = []
-        for ar1_chunk in ar1.chunks:
-            to_concat_chunks = []
-            for ar2_chunk in ar2.chunks:
-                chunk_op = op.copy().reset_key()
-                out_chunk = chunk_op.new_chunk(
-                    [ar1_chunk, ar2_chunk],
-                    dtype=out.dtype,
-                    shape=ar1_chunk.shape,
-                    order=out.order,
-                    index=ar1_chunk.index,
-                )
-                to_concat_chunks.append(out_chunk)
-            if len(to_concat_chunks) == 1:
-                out_chunks.append(to_concat_chunks[0])
-            else:
-                # concat chunks
-                concat_op = TensorStack(axis=0)
-                shape = (len(to_concat_chunks),) + ar1_chunk.shape
-                concat_chunk = concat_op.new_chunk(
-                    to_concat_chunks, shape=shape, dtype=out.dtype, order=out.order
-                )
-                if not invert:
-                    chunk_op = TensorAny(axis=(0,), dtype=out.dtype)
-                    out_chunk = chunk_op.new_chunk(
-                        [concat_chunk],
-                        shape=ar1_chunk.shape,
-                        dtype=out.dtype,
-                        order=out.order,
-                        index=ar1_chunk.index,
-                    )
-                else:
-                    chunk_op = TensorAll(axis=(0,), dtype=out.dtype)
-                    out_chunk = chunk_op.new_chunk(
-                        [concat_chunk],
-                        shape=ar1_chunk.shape,
-                        dtype=out.dtype,
-                        order=out.order,
-                        index=ar1_chunk.index,
-                    )
-                out_chunks.append(out_chunk)
-
-        params = out.params.copy()
-        params["nsplits"] = ar1.nsplits
-        params["chunks"] = out_chunks
-        new_op = op.copy()
-        return new_op.new_tensors(op.inputs, kws=[params])
+    def execute(cls, ctx, op):
+        chunk = op.outputs[0]
+        try:
+            ctx[chunk.key] = create_array(op)(
+                "ones", op.shape, dtype=op.dtype, order=op.order
+            )
+        except TypeError:  # in case that cp.ones does not have arg ``order``
+            x = create_array(op)("ones", op.shape, dtype=op.dtype)
+            ctx[chunk.key] = convert_order(x, op.order)
+
+
+def ones(shape, dtype=None, chunk_size=None, gpu=None, order="C"):
+    """
+    Return a new tensor of given shape and type, filled with ones.
+
+    Parameters
+    ----------
+    shape : int or sequence of ints
+        Shape of the new tensor, e.g., ``(2, 3)`` or ``2``.
+    dtype : data-type, optional
+        The desired data-type for the tensor, e.g., `mt.int8`.  Default is
+        `mt.float64`.
+    chunk_size : int or tuple of int or tuple of ints, optional
+        Desired chunk size on each dimension
+    gpu : bool, optional
+        Allocate the tensor on GPU if True, False as default
+    order : {'C', 'F'}, optional, default: C
+        Whether to store multi-dimensional data in row-major
+        (C-style) or column-major (Fortran-style) order in
+        memory.
+
+    Returns
+    -------
+    out : Tensor
+        Tensor of ones with the given shape, dtype, and order.
+
+    See Also
+    --------
+    zeros, ones_like
+
+    Examples
+    --------
+    >>> import mars.tensor as mt
+
+    >>> mt.ones(5).execute()
+    array([ 1.,  1.,  1.,  1.,  1.])
+
+    >>> mt.ones((5,), dtype=int).execute()
+    array([1, 1, 1, 1, 1])
+
+    >>> mt.ones((2, 1)).execute()
+    array([[ 1.],
+           [ 1.]])
+
+    >>> s = (2,2)
+    >>> mt.ones(s).execute()
+    array([[ 1.,  1.],
+           [ 1.,  1.]])
+
+    """
+    tensor_order = get_order(
+        order,
+        None,
+        available_options="CF",
+        err_msg="only 'C' or 'F' order is permitted",
+    )
+    dtype = np.dtype(dtype or "f8")
+    op = TensorOnes(
+        dtype=dtype, shape=shape, chunk_size=chunk_size, gpu=gpu, order=order
+    )
+    return op(shape, chunk_size=chunk_size, order=tensor_order)
+
+
+class TensorOnesLike(TensorLike):
+    _op_type_ = OperandDef.TENSOR_ONES_LIKE
+
+    _input = KeyField("input")
+
+    def __init__(self, dtype=None, sparse=False, **kw):
+        dtype = np.dtype(dtype) if dtype is not None else None
+        super().__init__(dtype=dtype, sparse=sparse, **kw)
 
     @classmethod
-    def execute(cls, ctx, op):
-        (element, test_elements), device_id, xp = as_same_device(
-            [ctx[c.key] for c in op.inputs], device=op.device, ret_extra=True
+    def execute_sparse(cls, ctx, op):
+        chunk = op.outputs[0]
+        in_data = naked(ctx[op.input.key])
+        xps = get_sparse_module(in_data)
+        xp = get_array_module(in_data)
+        ctx[chunk.key] = SparseNDArray(
+            xps.csr_matrix(
+                (
+                    xp.ones_like(in_data.data, dtype=chunk.op.dtype),
+                    in_data.indices,
+                    in_data.indptr,
+                ),
+                shape=in_data.shape,
+            )
         )
 
-        with device(device_id):
-            ctx[op.outputs[0].key] = xp.isin(
-                element, test_elements, assume_unique=op.assume_unique, invert=op.invert
+    @classmethod
+    def execute(cls, ctx, op):
+        if op.sparse:
+            cls.execute_sparse(ctx, op)
+        else:
+            ctx[op.outputs[0].key] = create_array(op)(
+                "ones_like", ctx[op.inputs[0].key], dtype=op.dtype
             )
 
 
-def isin(
-    element: Union[TileableType, np.ndarray],
-    test_elements: Union[TileableType, np.ndarray, list],
-    assume_unique: bool = False,
-    invert: bool = False,
-):
+def ones_like(a, dtype=None, gpu=None, order="K"):
     """
-    Calculates `element in test_elements`, broadcasting over `element` only.
-    Returns a boolean array of the same shape as `element` that is True
-    where an element of `element` is in `test_elements` and False otherwise.
+    Return a tensor of ones with the same shape and type as a given tensor.
 
     Parameters
     ----------
-    element : array_like
-        Input tensor.
-    test_elements : array_like
-        The values against which to test each value of `element`.
-        This argument is flattened if it is a tensor or array_like.
-        See notes for behavior with non-array-like parameters.
-    assume_unique : bool, optional
-        If True, the input tensors are both assumed to be unique, which
-        can speed up the calculation.  Default is False.
-    invert : bool, optional
-        If True, the values in the returned tensor are inverted, as if
-        calculating `element not in test_elements`. Default is False.
-        ``mt.isin(a, b, invert=True)`` is equivalent to (but faster
-        than) ``mt.invert(mt.isin(a, b))``.
+    a : array_like
+        The shape and data-type of `a` define these same attributes of
+        the returned tensor.
+    dtype : data-type, optional
+        Overrides the data type of the result.
+    gpu : bool, optional
+        Allocate the tensor on GPU if True, None as default
+    order : {'C', 'F', 'A', or 'K'}, optional
+        Overrides the memory layout of the result. 'C' means C-order,
+        'F' means F-order, 'A' means 'F' if `a` is Fortran contiguous,
+        'C' otherwise. 'K' means match the layout of `a` as closely
+        as possible.
 
     Returns
     -------
-    isin : Tensor, bool
-        Has the same shape as `element`. The values `element[isin]`
-        are in `test_elements`.
+    out : Tensor
+        Tensor of ones with the same shape and type as `a`.
 
     See Also
     --------
-    in1d                  : Flattened version of this function.
-
-    Notes
-    -----
-
-    `isin` is an element-wise function version of the python keyword `in`.
-    ``isin(a, b)`` is roughly equivalent to
-    ``mt.array([item in b for item in a])`` if `a` and `b` are 1-D sequences.
-
-    `element` and `test_elements` are converted to tensors if they are not
-    already. If `test_elements` is a set (or other non-sequence collection)
-    it will be converted to an object tensor with one element, rather than a
-    tensor of the values contained in `test_elements`. This is a consequence
-    of the `tensor` constructor's way of handling non-sequence collections.
-    Converting the set to a list usually gives the desired behavior.
+    zeros_like : Return a tensor of zeros with shape and type of input.
+    empty_like : Return a empty tensor with shape and type of input.
+    zeros : Return a new tensor setting values to zero.
+    ones : Return a new tensor setting values to one.
+    empty : Return a new uninitialized tensor.
 
     Examples
     --------
     >>> import mars.tensor as mt
 
-    >>> element = 2*mt.arange(4).reshape((2, 2))
-    >>> element.execute()
-    array([[0, 2],
-           [4, 6]])
-    >>> test_elements = [1, 2, 4, 8]
-    >>> mask = mt.isin(element, test_elements)
-    >>> mask.execute()
-    array([[ False,  True],
-           [ True,  False]])
-    >>> element[mask].execute()
-    array([2, 4])
-    >>> mask = mt.isin(element, test_elements, invert=True)
-    >>> mask.execute()
-    array([[ True, False],
-           [ False, True]])
-    >>> element[mask]
-    array([0, 6])
-
-    Because of how `array` handles sets, the following does not
-    work as expected:
-
-    >>> test_set = {1, 2, 4, 8}
-    >>> mt.isin(element, test_set).execute()
-    array([[ False, False],
-           [ False, False]])
-
-    Casting the set to a list gives the expected result:
-
-    >>> mt.isin(element, list(test_set)).execute()
-    array([[ False,  True],
-           [ True,  False]])
+    >>> x = mt.arange(6)
+    >>> x = x.reshape((2, 3))
+    >>> x.execute()
+    array([[0, 1, 2],
+           [3, 4, 5]])
+    >>> mt.ones_like(x).execute()
+    array([[1, 1, 1],
+           [1, 1, 1]])
+
+    >>> y = mt.arange(3, dtype=float)
+    >>> y.execute()
+    array([ 0.,  1.,  2.])
+    >>> mt.ones_like(y).execute()
+    array([ 1.,  1.,  1.])
+
     """
-    element, test_elements = astensor(element), astensor(test_elements).ravel()
-    op = TensorIsIn(assume_unique=assume_unique, invert=invert)
-    return op(element, test_elements)
+    a = tensor(a)
+    tensor_order = get_order(order, a.order)
+    gpu = a.op.gpu if gpu is None else gpu
+    op = TensorOnesLike(dtype=dtype, gpu=gpu, sparse=a.issparse(), order=order)
+    return op(a, order=tensor_order)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/map_chunk.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/map_chunk.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/moveaxis.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/moveaxis.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/ndim.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/ndim.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/partition.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/partition.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/psrs.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/psrs.py`

 * *Files 2% similar despite different names*

```diff
@@ -25,15 +25,15 @@
     AnyField,
     BoolField,
     FieldTypes,
     Int32Field,
     ListField,
     StringField,
 )
-from ...utils import flatten, stack_back
+from ...utils import flatten, is_same_module, stack_back
 from ..array_utils import as_same_device, cp, device
 from ..core import TensorOrder
 from ..operands import (
     TensorMapReduceOperand,
     TensorOperand,
     TensorOperandMixin,
     TensorShuffleProxy,
@@ -414,36 +414,34 @@
         return align_reduce_value_chunks, align_reduce_indices_chunks
 
 
 def _sort(a, op, xp, axis=None, kind=None, order=None, inplace=False):
     axis = axis if axis is not None else op.axis
     kind = kind if kind is not None else op.kind
     order = order if order is not None else op.order
-    if xp is np:
+    if is_same_module(xp, np):
         method = a.sort if inplace else partial(np.sort, a)
         return method(axis=axis, kind=kind, order=order)
     else:  # pragma: no cover
         # cupy does not support structure type
-        assert xp is cp
-        assert order is not None
+        assert is_same_module(xp, cp)
         method = a.sort if inplace else partial(cp.sort, a)
         # cupy does not support kind, thus just ignore it
         return method(axis=axis)
 
 
 def _argsort(a, op, xp, axis=None, kind=None, order=None):
     axis = axis if axis is not None else op.axis
     kind = kind if kind is not None else op.kind
     order = order if order is not None else op.order
-    if xp is np:
+    if is_same_module(xp, np):
         return np.argsort(a, axis=axis, kind=kind, order=order)
     else:  # pragma: no cover
         # cupy does not support structure type
-        assert xp is cp
-        assert order is not None
+        assert is_same_module(xp, cp)
         return cp.argsort(a, axis=axis)
 
 
 class PSRSSortRegularSample(TensorOperand, TensorOperandMixin):
     _op_type_ = OperandDef.PSRS_SORT_REGULAR_SMAPLE
 
     _axis = Int32Field("axis")
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/ravel.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/ravel.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/rebalance.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/rebalance.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/repeat.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/repeat.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/result_type.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/result_type.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/roll.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/roll.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/rollaxis.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/rollaxis.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/searchsorted.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/searchsorted.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/setdiff1d.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/setdiff1d.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/shape.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/shape.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/sort.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/sort.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/split.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/split.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/squeeze.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/squeeze.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/swapaxes.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/swapaxes.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/tile.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/tile.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/to_cpu.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/to_cpu.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/to_gpu.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/to_gpu.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/topk.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/topk.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/transpose.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/transpose.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/trapz.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/trapz.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/unique.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/unique.py`

 * *Files 2% similar despite different names*

```diff
@@ -20,15 +20,15 @@
 from ... import opcodes as OperandDef
 from ...config import options
 from ...core import recursive_tile
 from ...core.operand import OperandStage
 from ...lib import sparse
 from ...lib.sparse.core import get_array_module as get_sparse_array_module
 from ...serialization.serializables import BoolField, Int32Field, Int64Field
-from ...utils import has_unknown_shape
+from ...utils import has_unknown_shape, is_same_module
 from ..array_utils import as_same_device, device
 from ..core import TensorOrder
 from ..operands import TensorMapReduceOperand, TensorOperandMixin, TensorShuffleProxy
 from ..utils import hash_on_axis, validate_axis
 
 
 class TensorUnique(TensorMapReduceOperand, TensorOperandMixin):
@@ -318,15 +318,15 @@
             results = (results,) if not isinstance(results, tuple) else results
             results_iter = iter(results)
             unique_ar = next(results_iter)
             indices_ar = next(results_iter) + op.start_pos if op.return_index else None
             inverse_ar = next(results_iter) if op.return_inverse else None
             counts_ar = next(results_iter) if op.return_counts else None
 
-            if xp is sparse:
+            if is_same_module(xp, sparse):
                 dense_xp = get_sparse_array_module(unique_ar)
             else:
                 dense_xp = xp
             unique_index = (
                 dense_xp.arange(unique_ar.shape[op.axis])
                 if inverse_ar is not None
                 else None
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/vsplit.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/vsplit.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/base/where.py` & `xorbits-0.3.0/xorbits/_mars/tensor/base/where.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/__init__.py`

 * *Files 0% similar despite different names*

```diff
@@ -38,9 +38,9 @@
 from .full import TensorFull, TensorFullLike, full, full_like
 from .identity import identity
 from .indices import TensorIndices, indices
 from .linspace import TensorLinspace, linspace
 from .meshgrid import meshgrid
 from .ones import TensorOnes, TensorOnesLike, ones, ones_like
 from .scalar import Scalar, scalar
-from .tri import TensorTril, TensorTriu, tril, triu
+from .tri import TensorTril, TensorTriu, tri, tril, triu
 from .zeros import TensorZeros, TensorZerosLike, zeros, zeros_like
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/arange.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/arange.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/array.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/array.py`

 * *Files 1% similar despite different names*

```diff
@@ -20,15 +20,15 @@
 from ...lib.sparse.core import cp, cps, get_array_module, issparse, sps
 from ...serialization.serializables import (
     AnyField,
     FieldTypes,
     NDArrayField,
     TupleField,
 )
-from ...utils import on_deserialize_shape, on_serialize_shape
+from ...utils import is_same_module, on_deserialize_shape, on_serialize_shape
 from ..array_utils import array_module, is_array, is_cupy
 from ..core import TENSOR_TYPE, Tensor, TensorData, TensorOrder
 from ..utils import get_chunk_slices
 from .core import TensorNoInput
 from .scalar import scalar
 
 
@@ -121,17 +121,17 @@
             shape=op.shape,
         )
 
 
 def _from_spmatrix(spmatrix, dtype=None, chunk_size=None, gpu=None):
     if gpu is None:
         m = get_array_module(spmatrix)
-        if cp is not None and m is cp:
+        if cp is not None and is_same_module(m, cp):
             gpu = True
-        elif cp is np:
+        elif is_same_module(cp, np):
             gpu = False
     if dtype and spmatrix.dtype != dtype:
         spmatrix = spmatrix.astype(dtype)
     spmatrix = spmatrix.tocsr()
     op = CSRMatrixDataSource(
         indices=spmatrix.indices,
         indptr=spmatrix.indptr,
@@ -173,15 +173,15 @@
             data = m.asarray(data, dtype=dtype, order=order)
         except ValueError:
             arr = data.__array__(dtype=dtype)
             if isinstance(arr, TENSOR_TYPE):
                 return arr.astype(arr.dtype, order=order, copy=False)
             raise
         if gpu is None:
-            if cp is not None and m is cp:
+            if cp is not None and is_same_module(m, cp):
                 gpu = True
 
     if is_array(data):
         if data.ndim == 0:
             return scalar(data.item(), dtype=dtype)
         tensor_order = (
             TensorOrder.C_ORDER if data.flags["C_CONTIGUOUS"] else TensorOrder.F_ORDER
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/diag.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/diag.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/diagflat.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/diagflat.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/empty.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/empty.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/eye.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/eye.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_dataframe.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_dataframe.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_dense.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_dense.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_hdf5.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_hdf5.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_sparse.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_sparse.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_tiledb.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_tiledb.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_vineyard.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_vineyard.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/from_zarr.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/from_zarr.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/full.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/full.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/identity.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/identity.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/indices.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/indices.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/linspace.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/linspace.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/meshgrid.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/meshgrid.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/ones.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/zeros.py`

 * *Files 8% similar despite different names*

```diff
@@ -9,34 +9,35 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
+
 import numpy as np
 
 from ... import opcodes as OperandDef
-from ...lib.sparse import SparseNDArray
+from ...lib import sparse
 from ...lib.sparse.core import get_array_module, get_sparse_module, naked
 from ...serialization.serializables import (
     AnyField,
     FieldTypes,
     KeyField,
     StringField,
     TupleField,
 )
-from ..array_utils import convert_order, create_array
+from ..array_utils import create_array
 from ..utils import get_order
 from .array import tensor
 from .core import TensorLike, TensorNoInput
 
 
-class TensorOnes(TensorNoInput):
-    _op_type_ = OperandDef.TENSOR_ONES
+class TensorZeros(TensorNoInput):
+    _op_type_ = OperandDef.TENSOR_ZEROS
 
     order = StringField("order")
     shape = TupleField("shape", FieldTypes.int64)
     chunk_size = AnyField("chunk_size")
 
     def __init__(self, shape=None, **kwargs):
         if type(shape) is int:
@@ -48,171 +49,184 @@
         chunk_op.shape = args[0]
         chunk_op.chunk_size = None
         return chunk_op
 
     @classmethod
     def execute(cls, ctx, op):
         chunk = op.outputs[0]
-        try:
+        if op.sparse:
+            ctx[chunk.key] = sparse.zeros(op.shape, dtype=op.dtype, gpu=op.gpu)
+        else:
             ctx[chunk.key] = create_array(op)(
-                "ones", op.shape, dtype=op.dtype, order=op.order
+                "zeros", op.shape, dtype=op.dtype, order=op.order
             )
-        except TypeError:  # in case that cp.ones does not have arg ``order``
-            x = create_array(op)("ones", op.shape, dtype=op.dtype)
-            ctx[chunk.key] = convert_order(x, op.order)
 
 
-def ones(shape, dtype=None, chunk_size=None, gpu=None, order="C"):
+def zeros(shape, dtype=None, chunk_size=None, gpu=None, sparse=False, order="C"):
     """
-    Return a new tensor of given shape and type, filled with ones.
+    Return a new tensor of given shape and type, filled with zeros.
 
     Parameters
     ----------
     shape : int or sequence of ints
         Shape of the new tensor, e.g., ``(2, 3)`` or ``2``.
     dtype : data-type, optional
-        The desired data-type for the tensor, e.g., `mt.int8`.  Default is
+        The desired data-type for the array, e.g., `mt.int8`.  Default is
         `mt.float64`.
     chunk_size : int or tuple of int or tuple of ints, optional
         Desired chunk size on each dimension
     gpu : bool, optional
         Allocate the tensor on GPU if True, False as default
-    order : {'C', 'F'}, optional, default: C
+    sparse: bool, optional
+        Create sparse tensor if True, False as default
+    order : {'C', 'F'}, optional, default: 'C'
         Whether to store multi-dimensional data in row-major
         (C-style) or column-major (Fortran-style) order in
         memory.
 
     Returns
     -------
     out : Tensor
-        Tensor of ones with the given shape, dtype, and order.
+        Tensor of zeros with the given shape, dtype, and order.
 
     See Also
     --------
-    zeros, ones_like
+    zeros_like : Return a tensor of zeros with shape and type of input.
+    ones_like : Return a tensor of ones with shape and type of input.
+    empty_like : Return a empty tensor with shape and type of input.
+    ones : Return a new tensor setting values to one.
+    empty : Return a new uninitialized tensor.
 
     Examples
     --------
     >>> import mars.tensor as mt
+    >>> mt.zeros(5).execute()
+    array([ 0.,  0.,  0.,  0.,  0.])
 
-    >>> mt.ones(5).execute()
-    array([ 1.,  1.,  1.,  1.,  1.])
-
-    >>> mt.ones((5,), dtype=int).execute()
-    array([1, 1, 1, 1, 1])
+    >>> mt.zeros((5,), dtype=int).execute()
+    array([0, 0, 0, 0, 0])
 
-    >>> mt.ones((2, 1)).execute()
-    array([[ 1.],
-           [ 1.]])
+    >>> mt.zeros((2, 1)).execute()
+    array([[ 0.],
+           [ 0.]])
 
     >>> s = (2,2)
-    >>> mt.ones(s).execute()
-    array([[ 1.,  1.],
-           [ 1.,  1.]])
-
+    >>> mt.zeros(s).execute()
+    array([[ 0.,  0.],
+           [ 0.,  0.]])
+
+    >>> mt.zeros((2,), dtype=[('x', 'i4'), ('y', 'i4')]).execute() # custom dtype
+    array([(0, 0), (0, 0)],
+          dtype=[('x', '<i4'), ('y', '<i4')])
     """
     tensor_order = get_order(
         order,
         None,
         available_options="CF",
         err_msg="only 'C' or 'F' order is permitted",
     )
     dtype = np.dtype(dtype or "f8")
-    op = TensorOnes(
-        dtype=dtype, shape=shape, chunk_size=chunk_size, gpu=gpu, order=order
+    op = TensorZeros(
+        dtype=dtype,
+        shape=shape,
+        chunk_size=chunk_size,
+        gpu=gpu,
+        sparse=sparse,
+        order=order,
     )
     return op(shape, chunk_size=chunk_size, order=tensor_order)
 
 
-class TensorOnesLike(TensorLike):
-    _op_type_ = OperandDef.TENSOR_ONES_LIKE
+class TensorZerosLike(TensorLike):
+    _op_type_ = OperandDef.TENSOR_ZEROS_LIKE
 
     _input = KeyField("input")
+    _order = StringField("order")
 
-    def __init__(self, dtype=None, sparse=False, **kw):
+    def __init__(self, dtype=None, gpu=None, sparse=False, order=None, **kw):
         dtype = np.dtype(dtype) if dtype is not None else None
-        super().__init__(dtype=dtype, sparse=sparse, **kw)
+        super().__init__(dtype=dtype, gpu=gpu, sparse=sparse, _order=order, **kw)
 
-    @classmethod
-    def execute_sparse(cls, ctx, op):
-        chunk = op.outputs[0]
-        in_data = naked(ctx[op.input.key])
-        xps = get_sparse_module(in_data)
-        xp = get_array_module(in_data)
-        ctx[chunk.key] = SparseNDArray(
-            xps.csr_matrix(
-                (
-                    xp.ones_like(in_data.data, dtype=chunk.op.dtype),
-                    in_data.indices,
-                    in_data.indptr,
-                ),
-                shape=in_data.shape,
-            )
-        )
+    @property
+    def order(self):
+        return self._order
 
     @classmethod
     def execute(cls, ctx, op):
+        chunk = op.outputs[0]
         if op.sparse:
-            cls.execute_sparse(ctx, op)
+            in_data = naked(ctx[op.inputs[0].key])
+            xps = get_sparse_module(in_data)
+            xp = get_array_module(in_data)
+            ctx[chunk.key] = sparse.SparseNDArray(
+                xps.csr_matrix(
+                    (
+                        xp.zeros_like(in_data.data, dtype=op.dtype),
+                        in_data.indices,
+                        in_data.indptr,
+                    ),
+                    shape=in_data.shape,
+                )
+            )
         else:
-            ctx[op.outputs[0].key] = create_array(op)(
-                "ones_like", ctx[op.inputs[0].key], dtype=op.dtype
+            ctx[chunk.key] = create_array(op)(
+                "zeros_like", ctx[op.inputs[0].key], dtype=op.dtype, order=op.order
             )
 
 
-def ones_like(a, dtype=None, gpu=None, order="K"):
+def zeros_like(a, dtype=None, gpu=None, order="K"):
     """
-    Return a tensor of ones with the same shape and type as a given tensor.
+    Return a tensor of zeros with the same shape and type as a given tensor.
 
     Parameters
     ----------
     a : array_like
         The shape and data-type of `a` define these same attributes of
-        the returned tensor.
+        the returned array.
     dtype : data-type, optional
         Overrides the data type of the result.
     gpu : bool, optional
         Allocate the tensor on GPU if True, None as default
     order : {'C', 'F', 'A', or 'K'}, optional
         Overrides the memory layout of the result. 'C' means C-order,
         'F' means F-order, 'A' means 'F' if `a` is Fortran contiguous,
         'C' otherwise. 'K' means match the layout of `a` as closely
         as possible.
 
     Returns
     -------
     out : Tensor
-        Tensor of ones with the same shape and type as `a`.
+        tensor of zeros with the same shape and type as `a`.
 
     See Also
     --------
-    zeros_like : Return a tensor of zeros with shape and type of input.
-    empty_like : Return a empty tensor with shape and type of input.
-    zeros : Return a new tensor setting values to zero.
-    ones : Return a new tensor setting values to one.
-    empty : Return a new uninitialized tensor.
+    ones_like : Return an array of ones with shape and type of input.
+    empty_like : Return an empty array with shape and type of input.
+    zeros : Return a new array setting values to zero.
+    ones : Return a new array setting values to one.
+    empty : Return a new uninitialized array.
 
     Examples
     --------
-    >>> import mars.tensor as mt
-
+    >>> import mars.tensr as mt
     >>> x = mt.arange(6)
     >>> x = x.reshape((2, 3))
     >>> x.execute()
     array([[0, 1, 2],
            [3, 4, 5]])
-    >>> mt.ones_like(x).execute()
-    array([[1, 1, 1],
-           [1, 1, 1]])
+
+    >>> mt.zeros_like(x).execute()
+    array([[0, 0, 0],
+           [0, 0, 0]])
 
     >>> y = mt.arange(3, dtype=float)
     >>> y.execute()
     array([ 0.,  1.,  2.])
-    >>> mt.ones_like(y).execute()
-    array([ 1.,  1.,  1.])
 
+    >>> mt.zeros_like(y).execute()
+    array([ 0.,  0.,  0.])
     """
     a = tensor(a)
     tensor_order = get_order(order, a.order)
     gpu = a.op.gpu if gpu is None else gpu
-    op = TensorOnesLike(dtype=dtype, gpu=gpu, sparse=a.issparse(), order=order)
+    op = TensorZerosLike(dtype=dtype, gpu=gpu, sparse=a.issparse(), order=order)
     return op(a, order=tensor_order)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/scalar.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/scalar.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datasource/tri.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datasource/tri.py`

 * *Files 12% similar despite different names*

```diff
@@ -21,14 +21,15 @@
 from ...lib import sparse
 from ...serialization.serializables import Int32Field, KeyField
 from ...utils import has_unknown_shape
 from ..array_utils import create_array
 from ..core import TensorOrder
 from .array import tensor as astensor
 from .core import TensorHasInput
+from .ones import ones as asones
 from .zeros import TensorZeros
 
 
 class TensorTri(TensorHasInput):
     def __call__(self, m, order=None):
         order = TensorOrder.C_ORDER if order is None else order
         return self.new_tensor([m], shape=m.shape, order=order)
@@ -208,7 +209,52 @@
            [10, 11, 12]])
 
     """
     m = astensor(m)
     gpu = m.op.gpu if gpu is None else gpu
     op = TensorTril(k, dtype=m.dtype, sparse=m.issparse(), gpu=gpu)
     return op(m)
+
+
+def tri(N, M=None, k=0, dtype=float, chunk_size=None, gpu=None):
+    """
+    An array with ones at and below the given diagonal and zeros elsewhere.
+
+    Parameters
+    ----------
+    N : int
+        Number of rows in the array.
+    M : int, optional
+        Number of columns in the array.
+        By default, `M` is taken equal to `N`.
+    k : int, optional
+        The sub-diagonal at and below which the array is filled.
+        `k` = 0 is the main diagonal, while `k` < 0 is below it,
+        and `k` > 0 is above.  The default is 0.
+    dtype : dtype, optional
+        Data type of the returned array.  The default is float.
+    ${ARRAY_FUNCTION_LIKE}
+
+        .. versionadded:: 1.20.0
+
+    Returns
+    -------
+    tri : ndarray of shape (N, M)
+        Array with its lower triangle filled with ones and zero elsewhere;
+        in other words ``T[i,j] == 1`` for ``j <= i + k``, 0 otherwise.
+
+    Examples
+    --------
+    >>> np.tri(3, 5, 2, dtype=int)
+    array([[1, 1, 1, 0, 0],
+           [1, 1, 1, 1, 0],
+           [1, 1, 1, 1, 1]])
+
+    >>> np.tri(3, 5, -1)
+    array([[0.,  0.,  0.,  0.,  0.],
+           [1.,  0.,  0.,  0.,  0.],
+           [1.,  1.,  0.,  0.,  0.]])
+    """
+    if M is None:
+        M = N
+    m = asones((N, M), dtype=dtype, chunk_size=chunk_size, gpu=gpu)
+    return tril(m, k=k)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datastore/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datastore/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datastore/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datastore/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datastore/to_hdf5.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datastore/to_hdf5.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datastore/to_tiledb.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datastore/to_tiledb.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datastore/to_vineyard.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datastore/to_vineyard.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datastore/to_zarr.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datastore/to_zarr.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/datastore/utils.py` & `xorbits-0.3.0/xorbits/_mars/tensor/datastore/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/einsum/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/images/__init__.py`

 * *Files 3% similar despite different names*

```diff
@@ -9,8 +9,8 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from .core import einsum
+from .imread import imread
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/einsum/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/einsum/core.py`

 * *Files 1% similar despite different names*

```diff
@@ -17,14 +17,15 @@
 from collections import defaultdict
 
 import numpy as np
 
 from ... import opcodes as OperandDef
 from ...core import recursive_tile
 from ...serialization.serializables import AnyField, StringField
+from ...utils import is_same_module
 from ..arithmetic.utils import chunk_tree_add
 from ..array_utils import as_same_device, device
 from ..core import TensorOrder
 from ..operands import TensorOperand, TensorOperandMixin
 from ..utils import decide_unify_split
 from .einsumfunc import einsum_path, parse_einsum_input
 
@@ -171,15 +172,15 @@
     @classmethod
     def execute(cls, ctx, op):
         inputs, device_id, xp = as_same_device(
             [ctx[c.key] for c in op.inputs], device=op.device, ret_extra=True
         )
 
         with device(device_id):
-            if xp is np:
+            if is_same_module(xp, np):
                 ctx[op.outputs[0].key] = xp.einsum(
                     op.subscripts,
                     *inputs,
                     optimize=op.optimize,
                     dtype=op.dtype,
                     order=op.order,
                     casting=op.casting
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/einsum/einsumfunc.py` & `xorbits-0.3.0/xorbits/_mars/tensor/einsum/einsumfunc.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fetch/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fetch/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fetch/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fetch/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/fft.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/fft.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/fft2.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/fft2.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/fftfreq.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/fftfreq.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/fftn.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/fftn.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/fftshift.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/fftshift.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/hfft.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/hfft.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/ifft.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/ifft.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/ifft2.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/ifft2.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/ifftn.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/ifftn.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/ifftshift.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/ifftshift.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/ihfft.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/ihfft.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/irfft.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/irfft.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/irfft2.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/irfft2.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/irfftn.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/irfftn.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/rfft.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/rfft.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/rfft2.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/rfft2.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/rfftfreq.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/rfftfreq.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fft/rfftn.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fft/rfftn.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fuse/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fuse/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fuse/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fuse/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fuse/cupy.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fuse/cupy.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/fuse/numexpr.py` & `xorbits-0.3.0/xorbits/_mars/tensor/fuse/numexpr.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/images/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/spatial/__init__.py`

 * *Files 8% similar despite different names*

```diff
@@ -8,9 +8,7 @@
 #      http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
-
-from .imread import imread
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/images/imread.py` & `xorbits-0.3.0/xorbits/_mars/tensor/images/imread.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/choose.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/choose.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/compress.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/compress.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/extract.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/extract.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/fill_diagonal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/fill_diagonal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/flatnonzero.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/flatnonzero.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/getitem.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/getitem.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/index_lib.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/index_lib.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/nonzero.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/nonzero.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/setitem.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/setitem.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/slice.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/slice.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/take.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/take.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/indexing/unravel_index.py` & `xorbits-0.3.0/xorbits/_mars/tensor/indexing/unravel_index.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/lib/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/lib/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/lib/index_tricks.py` & `xorbits-0.3.0/xorbits/_mars/tensor/lib/index_tricks.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/cholesky.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/cholesky.py`

 * *Files 2% similar despite different names*

```diff
@@ -15,15 +15,15 @@
 
 import numpy as np
 from numpy.linalg import LinAlgError
 
 from ... import opcodes as OperandDef
 from ...core import recursive_tile
 from ...serialization.serializables import BoolField, KeyField
-from ...utils import has_unknown_shape
+from ...utils import has_unknown_shape, is_same_module
 from ..array_utils import as_same_device, device
 from ..core import TensorOrder
 from ..datasource import tensor as astensor
 from ..operands import TensorHasInput, TensorOperand, TensorOperandMixin
 
 
 class TensorCholesky(TensorHasInput, TensorOperandMixin):
@@ -184,15 +184,15 @@
     def execute(cls, ctx, op):
         chunk = op.outputs[0]
         (a,), device_id, xp = as_same_device(
             [ctx[c.key] for c in op.inputs], device=op.device, ret_extra=True
         )
 
         with device(device_id):
-            if xp is np:
+            if is_same_module(xp, np):
                 import scipy.linalg
 
                 ctx[chunk.key] = scipy.linalg.cholesky(a, lower=op.lower)
                 return
 
             r = xp.linalg.cholesky(a)
             if not chunk.op.lower:
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/dot.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/dot.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/inner.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/inner.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/inv.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/inv.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/lu.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/lu.py`

 * *Files 1% similar despite different names*

```diff
@@ -15,15 +15,15 @@
 
 import numpy as np
 from numpy.linalg import LinAlgError
 
 from ... import opcodes as OperandDef
 from ...core import ExecutableTuple, recursive_tile
 from ...serialization.serializables import KeyField
-from ...utils import has_unknown_shape
+from ...utils import has_unknown_shape, is_same_module
 from ..array_utils import as_same_device, device, is_sparse_module
 from ..datasource import tensor as astensor
 from ..operands import TensorHasInput, TensorOperandMixin
 
 
 class TensorLU(TensorHasInput, TensorOperandMixin):
     _op_type_ = OperandDef.LU
@@ -441,15 +441,15 @@
     @classmethod
     def execute(cls, ctx, op):
         (a,), device_id, xp = as_same_device(
             [ctx[c.key] for c in op.inputs], device=op.device, ret_extra=True
         )
 
         with device(device_id):
-            if xp is np:
+            if is_same_module(xp, np):
                 import scipy.linalg
 
                 p, l, u = scipy.linalg.lu(a)
             elif is_sparse_module(xp):
                 p, l, u = xp.lu(a)
             else:
                 raise NotImplementedError
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/matmul.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/matmul.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/norm.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/norm.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/qr.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/qr.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/randomized_svd.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/randomized_svd.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/solve.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/solve.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/solve_triangular.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/solve_triangular.py`

 * *Files 2% similar despite different names*

```diff
@@ -15,15 +15,15 @@
 
 import numpy as np
 from numpy.linalg import LinAlgError
 
 from ... import opcodes as OperandDef
 from ...core import recursive_tile
 from ...serialization.serializables import BoolField, KeyField
-from ...utils import has_unknown_shape
+from ...utils import has_unknown_shape, is_same_module
 from ..array_utils import as_same_device, cp, device
 from ..core import TensorOrder
 from ..datasource import tensor as astensor
 from ..operands import TensorOperand, TensorOperandMixin
 from ..utils import decide_unify_split
 
 
@@ -150,24 +150,24 @@
     def execute(cls, ctx, op):
         (a, b), device_id, xp = as_same_device(
             [ctx[c.key] for c in op.inputs], device=op.device, ret_extra=True
         )
 
         chunk = op.outputs[0]
         with device(device_id):
-            if xp is np:
+            if is_same_module(xp, np):
                 import scipy.linalg
 
                 try:
                     ctx[chunk.key] = scipy.linalg.solve_triangular(a, b, lower=op.lower)
                 except np.linalg.LinAlgError:
                     if op.strict is not False:
                         raise
                     ctx[chunk.key] = np.linalg.lstsq(a, b, rcond=-1)[0]
-            elif xp is cp:
+            elif is_same_module(xp, cp):
                 import cupyx
 
                 ctx[chunk.key] = cupyx.scipy.linalg.solve_triangular(
                     a, b, lower=op.lower
                 )
             else:
                 ctx[chunk.key] = xp.solve_triangular(
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/svd.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/svd.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/tensordot.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/tensordot.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/utils.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/linalg/vdot.py` & `xorbits-0.3.0/xorbits/_mars/tensor/linalg/vdot.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/merge/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/merge/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/merge/append.py` & `xorbits-0.3.0/xorbits/_mars/tensor/merge/append.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/merge/block.py` & `xorbits-0.3.0/xorbits/_mars/tensor/merge/block.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/merge/column_stack.py` & `xorbits-0.3.0/xorbits/_mars/tensor/merge/column_stack.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/merge/concatenate.py` & `xorbits-0.3.0/xorbits/_mars/tensor/merge/concatenate.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/merge/dstack.py` & `xorbits-0.3.0/xorbits/_mars/tensor/merge/dstack.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/merge/hstack.py` & `xorbits-0.3.0/xorbits/_mars/tensor/merge/hstack.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/merge/stack.py` & `xorbits-0.3.0/xorbits/_mars/tensor/merge/stack.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/merge/union1d.py` & `xorbits-0.3.0/xorbits/_mars/tensor/merge/union1d.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/merge/vstack.py` & `xorbits-0.3.0/xorbits/_mars/tensor/merge/vstack.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/operands.py` & `xorbits-0.3.0/xorbits/_mars/tensor/operands.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/beta.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/beta.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/binomial.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/binomial.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/bytes.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/bytes.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/chisquare.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/chisquare.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/choice.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/choice.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/core.py`

 * *Files 1% similar despite different names*

```diff
@@ -19,14 +19,15 @@
 from contextlib import contextmanager
 
 import numpy as np
 
 from ...config import options
 from ...core import recursive_tile
 from ...serialization.serializables import FieldTypes, Int32Field, TupleField
+from ...utils import is_same_module
 from ..array_utils import array_module, device
 from ..base import broadcast_to
 from ..core import TENSOR_CHUNK_TYPE, TENSOR_TYPE
 from ..datasource import tensor as astensor
 from ..operands import TensorMapReduceOperand, TensorOperand, TensorOperandMixin
 from ..utils import broadcast_shape, decide_chunk_sizes, gen_random_seeds
 
@@ -160,15 +161,15 @@
             nsplits=nsplits,
             **tensor.extra_params
         )
 
     @classmethod
     def execute(cls, ctx, op):
         xp = array_module(op.gpu)
-        if xp is np:
+        if is_same_module(xp, np):
             device_id = -1
         else:
             device_id = op.device or 0
         get_val = lambda x: ctx[x.key] if isinstance(x, TENSOR_CHUNK_TYPE) else x
 
         with device(device_id):
             rs = xp.random.RandomState(op.seed)
@@ -371,15 +372,15 @@
 
 class TensorDistribution(TensorRandomOperand):
     size = TupleField("size", FieldTypes.int64)
 
     @classmethod
     def execute(cls, ctx, op):
         xp = array_module(op.gpu)
-        if xp is np:
+        if is_same_module(xp, np):
             device_id = -1
         else:
             device_id = op.device or 0
 
         with device(device_id):
             rs = xp.random.RandomState(op.seed)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/dirichlet.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/dirichlet.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/exponential.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/exponential.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/f.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/f.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/gamma.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/gamma.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/geometric.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/geometric.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/gumbel.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/gumbel.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/hypergeometric.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/hypergeometric.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/laplace.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/laplace.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/logistic.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/logistic.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/lognormal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/lognormal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/logseries.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/logseries.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/multinomial.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/multinomial.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/multivariate_normal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/multivariate_normal.py`

 * *Files 2% similar despite different names*

```diff
@@ -16,14 +16,15 @@
 import itertools
 
 import numpy as np
 
 from ... import opcodes as OperandDef
 from ...config import options
 from ...serialization.serializables import Float64Field, NDArrayField, StringField
+from ...utils import is_same_module
 from ..array_utils import array_module, device
 from ..utils import decide_chunk_sizes, gen_random_seeds
 from .core import TENSOR_CHUNK_TYPE, TensorDistribution, TensorRandomOperandMixin
 
 
 class TensorMultivariateNormal(TensorDistribution, TensorRandomOperandMixin):
     _op_type_ = OperandDef.RAND_MULTIVARIATE_NORMAL
@@ -76,15 +77,15 @@
         return new_op.new_tensors(
             op.inputs, tensor.shape, chunks=out_chunks, nsplits=nsplits
         )
 
     @classmethod
     def execute(cls, ctx, op):
         xp = array_module(op.gpu)
-        if xp is np:
+        if is_same_module(xp, np):
             device_id = -1
         else:
             device_id = op.device or 0
 
         with device(device_id):
             rs = xp.random.RandomState(op.seed)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/negative_binomial.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/negative_binomial.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/noncentral_chisquare.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/noncentral_chisquare.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/noncentral_f.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/noncentral_f.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/normal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/normal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/pareto.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/pareto.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/permutation.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/permutation.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/poisson.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/poisson.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/power.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/power.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/rand.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/rand.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/randint.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/randint.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/randn.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/randn.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/random_integers.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/random_integers.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/random_sample.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/random_sample.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/rayleigh.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/rayleigh.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/shuffle.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/shuffle.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/standard_cauchy.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/standard_cauchy.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/standard_exponential.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/standard_exponential.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/standard_gamma.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/standard_gamma.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/standard_normal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/standard_normal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/standard_t.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/standard_t.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/triangular.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/triangular.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/uniform.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/uniform.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/vonmises.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/vonmises.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/wald.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/wald.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/weibull.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/weibull.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/random/zipf.py` & `xorbits-0.3.0/xorbits/_mars/tensor/random/zipf.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/rechunk/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/rechunk/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/rechunk/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/rechunk/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/rechunk/rechunk.py` & `xorbits-0.3.0/xorbits/_mars/tensor/rechunk/rechunk.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/all.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/all.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/allclose.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/allclose.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/any.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/any.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/argmax.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/argmax.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/argmin.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/argmin.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/array_equal.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/array_equal.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/count_nonzero.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/count_nonzero.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/cumprod.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/cumprod.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/cumsum.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/cumsum.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/max.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/max.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/mean.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/mean.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/min.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/min.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanargmax.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanargmax.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanargmin.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanargmin.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/nancumprod.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/nancumprod.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/nancumsum.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/nancumsum.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanmax.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanmax.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanmean.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanmean.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanmin.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanmin.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanprod.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanprod.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanstd.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanstd.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/nansum.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/nansum.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/nanvar.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/nanvar.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/prod.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/prod.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/std.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/std.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/sum.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/sum.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reduction/var.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reduction/var.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reshape/__init__.py` & `xorbits-0.3.0/xorbits/numpy/numpy_adapters/__init__.py`

 * *Files 13% similar despite different names*

```diff
@@ -1,16 +1,15 @@
 # Copyright 2022-2023 XProbe Inc.
-# derived from copyright 1999-2021 Alibaba Group Holding Ltd.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #      http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from .reshape import reshape
+from .core import collect_numpy_module_members
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/reshape/reshape.py` & `xorbits-0.3.0/xorbits/_mars/tensor/reshape/reshape.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/spatial/__init__.py` & `xorbits-0.3.0/xorbits/supervisor.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,14 +1,18 @@
 # Copyright 2022-2023 XProbe Inc.
-# derived from copyright 1999-2021 Alibaba Group Holding Ltd.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #      http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
+
+from ._mars.supervisor import main
+
+if __name__ == "__main__":
+    main()
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/spatial/distance/__init__.py` & `xorbits-0.3.0/xorbits/_mars/worker.py`

 * *Files 15% similar despite different names*

```diff
@@ -1,18 +1,24 @@
 # Copyright 2022-2023 XProbe Inc.
-# derived from copyright 1999-2021 Alibaba Group Holding Ltd.
+# derived from copyright 1999-2022 Alibaba Group Holding Ltd.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #      http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from .cdist import cdist
-from .pdist import pdist
-from .squareform import squareform
+# shortcut to support
+# python -m mars.worker
+
+from .deploy.oscar.worker import main
+from .utils import ensure_coverage
+
+if __name__ == "__main__":
+    ensure_coverage()
+    main()
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/spatial/distance/cdist.py` & `xorbits-0.3.0/xorbits/_mars/tensor/spatial/distance/cdist.py`

 * *Files 1% similar despite different names*

```diff
@@ -17,15 +17,15 @@
 from typing import Tuple
 
 import numpy as np
 
 from .... import opcodes as OperandDef
 from ....core import recursive_tile
 from ....serialization.serializables import AnyField, Float16Field, KeyField
-from ....utils import ensure_own_data, has_unknown_shape, require_module
+from ....utils import ensure_own_data, has_unknown_shape, is_same_module, require_module
 from ...array_utils import as_same_device, cp, device
 from ...core import TensorOrder
 from ...datasource import tensor as astensor
 from ...operands import TensorOperand, TensorOperandMixin
 
 
 class TensorCdist(TensorOperand, TensorOperandMixin):
@@ -182,15 +182,15 @@
     def execute(cls, ctx, op):
         from scipy.spatial.distance import cdist
 
         inputs, device_id, xp = as_same_device(
             [ctx[inp.key] for inp in op.inputs], device=op.device, ret_extra=True
         )
 
-        if xp is cp:  # pragma: no cover
+        if is_same_module(xp, cp):  # pragma: no cover
             raise NotImplementedError("`cdist` does not support running on GPU yet")
 
         with device(device_id):
             inputs_iter = iter(inputs)
             xa = next(inputs_iter)
             xb = next(inputs_iter)
             kw = dict()
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/spatial/distance/pdist.py` & `xorbits-0.3.0/xorbits/_mars/tensor/spatial/distance/pdist.py`

 * *Files 2% similar despite different names*

```diff
@@ -25,15 +25,15 @@
     AnyField,
     FieldTypes,
     Float16Field,
     Int32Field,
     KeyField,
     TupleField,
 )
-from ....utils import ensure_own_data, has_unknown_shape, require_module
+from ....utils import ensure_own_data, has_unknown_shape, is_same_module, require_module
 from ...array_utils import as_same_device, cp, device
 from ...core import TensorOrder
 from ...datasource.array import tensor as astensor
 from ...operands import TensorMapReduceOperand, TensorOperandMixin, TensorShuffleProxy
 
 
 class TensorPdist(TensorMapReduceOperand, TensorOperandMixin):
@@ -307,15 +307,15 @@
     def _execute_map(cls, ctx, op):
         from scipy.spatial.distance import cdist, pdist
 
         inputs, device_id, xp = as_same_device(
             [ctx[inp.key] for inp in op.inputs], device=op.device, ret_extra=True
         )
 
-        if xp is cp:  # pragma: no cover
+        if is_same_module(xp, cp):  # pragma: no cover
             raise NotImplementedError("`pdist` does not support running on GPU yet")
 
         with device(device_id):
             inputs_iter = iter(inputs)
             a = next(inputs_iter)
             if op.b is not None:
                 b = next(inputs_iter)
@@ -376,15 +376,15 @@
     def _execute_single(cls, ctx, op):
         from scipy.spatial.distance import pdist
 
         inputs, device_id, xp = as_same_device(
             [ctx[inp.key] for inp in op.inputs], device=op.device, ret_extra=True
         )
 
-        if xp is cp:  # pragma: no cover
+        if is_same_module(xp, cp):  # pragma: no cover
             raise NotImplementedError("`pdist` does not support running on GPU yet")
 
         with device(device_id):
             inputs_iter = iter(inputs)
             x = next(inputs_iter)
             kw = dict()
             if op.p is not None:
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/spatial/distance/squareform.py` & `xorbits-0.3.0/xorbits/_mars/tensor/spatial/distance/squareform.py`

 * *Files 2% similar despite different names*

```diff
@@ -18,15 +18,15 @@
 import numpy as np
 
 from .... import opcodes as OperandDef
 from ....config import options
 from ....core import recursive_tile
 from ....core.operand import OperandStage
 from ....serialization.serializables import BoolField, FieldTypes, KeyField, TupleField
-from ....utils import has_unknown_shape, require_module
+from ....utils import has_unknown_shape, is_same_module, require_module
 from ...arithmetic import equal
 from ...array_utils import as_same_device, cp, device
 from ...core import TensorOrder
 from ...datasource import array, ascontiguousarray, zeros
 from ...operands import TensorMapReduceOperand, TensorOperandMixin, TensorShuffleProxy
 from ...utils import decide_chunk_sizes
 
@@ -340,15 +340,15 @@
             [ctx[inp.key] for inp in op.inputs], device=op.device, ret_extra=True
         )
 
         if len(inputs) == 2 and not inputs[1]:
             # check fail
             raise ValueError("Distance matrix X must be symmetric.")
 
-        if xp is cp:  # pragma: no cover
+        if is_same_module(xp, cp):  # pragma: no cover
             raise NotImplementedError(
                 "`squareform` does not support running on GPU yet"
             )
 
         with device(device_id):
             x = inputs[0]
             if x.ndim == 1:
@@ -384,15 +384,15 @@
         else:
             from scipy.spatial.distance import squareform
 
             (x,), device_id, xp = as_same_device(
                 [ctx[inp.key] for inp in op.inputs], device=op.device, ret_extra=True
             )
 
-            if xp is cp:  # pragma: no cover
+            if is_same_module(xp, cp):  # pragma: no cover
                 raise NotImplementedError(
                     "`squareform` does not support running on GPU yet"
                 )
 
             with device(device_id):
                 ctx[op.outputs[0].key] = squareform(x, checks=op.checks)
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/special/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/special/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/special/airy.py` & `xorbits-0.3.0/xorbits/_mars/tensor/special/airy.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/special/bessel.py` & `xorbits-0.3.0/xorbits/_mars/tensor/special/bessel.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/special/convenience.py` & `xorbits-0.3.0/xorbits/_mars/tensor/special/convenience.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/special/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/special/core.py`

 * *Files 6% similar despite different names*

```diff
@@ -13,14 +13,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import scipy.special as spspecial
 
 from ... import opcodes
 from ...core import ExecutableTuple
+from ...utils import is_same_module
 from ..arithmetic.core import TensorBinOp, TensorMultiOp, TensorUnaryOp
 from ..array_utils import (
     as_same_device,
     convert_order,
     cp,
     device,
     issparse,
@@ -45,24 +46,24 @@
     def __new__(cls, *args, **kwargs):
         if cls._func_name is not None:
             return object.__new__(_func_name_to_special_cls[cls._func_name])
         return super().__new__(cls, *args, **kwargs)
 
     @classmethod
     def _get_func(cls, xp):
-        if xp is np:
+        if is_same_module(xp, np):
             from scipy import special
 
             return getattr(special, cls._func_name)
-        elif cp is not None and xp is cp:
+        elif cp is not None and is_same_module(xp, cp):
             from cupyx.scipy import special
 
             return getattr(special, cls._func_name)
         else:
-            assert xp is sparse
+            assert is_same_module(xp, sparse)
             return getattr(sparse, cls._func_name)
 
 
 class TensorSpecialUnaryOp(TensorSpecialOperandMixin, TensorUnaryOp):
     pass
```

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/special/ellip_func_integrals.py` & `xorbits-0.3.0/xorbits/_mars/tensor/special/ellip_func_integrals.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/special/ellip_harm.py` & `xorbits-0.3.0/xorbits/_mars/tensor/special/ellip_harm.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/special/err_fresnel.py` & `xorbits-0.3.0/xorbits/_mars/tensor/special/err_fresnel.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/special/gamma_funcs.py` & `xorbits-0.3.0/xorbits/_mars/tensor/special/gamma_funcs.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/special/hypergeometric_funcs.py` & `xorbits-0.3.0/xorbits/_mars/tensor/special/hypergeometric_funcs.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/special/info_theory.py` & `xorbits-0.3.0/xorbits/_mars/tensor/special/info_theory.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/statistics/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/statistics/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/statistics/average.py` & `xorbits-0.3.0/xorbits/_mars/tensor/statistics/average.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/statistics/bincount.py` & `xorbits-0.3.0/xorbits/_mars/tensor/statistics/bincount.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/statistics/core.py` & `xorbits-0.3.0/xorbits/_mars/tensor/statistics/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/statistics/corrcoef.py` & `xorbits-0.3.0/xorbits/_mars/tensor/statistics/corrcoef.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/statistics/cov.py` & `xorbits-0.3.0/xorbits/_mars/tensor/statistics/cov.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/statistics/digitize.py` & `xorbits-0.3.0/xorbits/_mars/tensor/statistics/digitize.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/statistics/histogram.py` & `xorbits-0.3.0/xorbits/_mars/tensor/statistics/histogram.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/statistics/median.py` & `xorbits-0.3.0/xorbits/_mars/tensor/statistics/median.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/statistics/percentile.py` & `xorbits-0.3.0/xorbits/_mars/tensor/statistics/percentile.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/statistics/ptp.py` & `xorbits-0.3.0/xorbits/_mars/tensor/statistics/ptp.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/statistics/quantile.py` & `xorbits-0.3.0/xorbits/_mars/tensor/statistics/quantile.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/stats/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/stats/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/stats/chisquare.py` & `xorbits-0.3.0/xorbits/_mars/tensor/stats/chisquare.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/stats/entropy.py` & `xorbits-0.3.0/xorbits/_mars/tensor/stats/entropy.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/stats/ks.py` & `xorbits-0.3.0/xorbits/_mars/tensor/stats/ks.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/stats/power_divergence.py` & `xorbits-0.3.0/xorbits/_mars/tensor/stats/power_divergence.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/stats/rankdata.py` & `xorbits-0.3.0/xorbits/_mars/tensor/stats/rankdata.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/stats/ttest.py` & `xorbits-0.3.0/xorbits/_mars/tensor/stats/ttest.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/ufunc/__init__.py` & `xorbits-0.3.0/xorbits/_mars/tensor/ufunc/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/ufunc/ufunc.py` & `xorbits-0.3.0/xorbits/_mars/tensor/ufunc/ufunc.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/tensor/utils.py` & `xorbits-0.3.0/xorbits/_mars/tensor/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/typing.py` & `xorbits-0.3.0/xorbits/_mars/typing.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/_mars/utils.py` & `xorbits-0.3.0/xorbits/_mars/utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -37,15 +37,15 @@
 import types
 import uuid
 import warnings
 import weakref
 import zlib
 from abc import ABC
 from contextlib import contextmanager
-from types import TracebackType
+from types import ModuleType, TracebackType
 from typing import (
     Any,
     Callable,
     Dict,
     List,
     Mapping,
     NamedTuple,
@@ -352,52 +352,56 @@
     def __init__(self, f):
         self.f = f
 
     def __get__(self, obj, owner):
         return self.f(owner)
 
 
+class LazyModule:
+    def __init__(self, name, rename, globals_, locals_):
+        self.name = name
+        self._on_loads = []
+        self._rename = rename
+        self._globals = globals_
+        self._locals = locals_
+
+    def __getattr__(self, item):
+        if item.startswith("_pytest") or item in ("__bases__", "__test__"):
+            raise AttributeError(item)
+
+        real_mod = importlib.import_module(self.name)
+        if self._rename in self._globals:
+            self._globals[self._rename] = real_mod
+        elif self._locals is not None:
+            self._locals[self._rename] = real_mod
+        ret = getattr(real_mod, item)
+        for on_load_func in self._on_loads:
+            on_load_func()
+        # make sure on_load hooks only executed once
+        self._on_loads = []
+        return ret
+
+    def add_load_handler(self, func: Callable):
+        self._on_loads.append(func)
+        return func
+
+
 def lazy_import(
     name: str,
-    package: str = None,
-    globals: Dict = None,  # pylint: disable=redefined-builtin
-    locals: Dict = None,  # pylint: disable=redefined-builtin
+    globals_: Dict = None,  # pylint: disable=redefined-builtin
+    locals_: Dict = None,  # pylint: disable=redefined-builtin
     rename: str = None,
     placeholder: bool = False,
 ):
     rename = rename or name
     prefix_name = name.split(".", 1)[0]
-    globals = globals or inspect.currentframe().f_back.f_globals
-
-    class LazyModule:
-        def __init__(self):
-            self._on_loads = []
-
-        def __getattr__(self, item):
-            if item.startswith("_pytest") or item in ("__bases__", "__test__"):
-                raise AttributeError(item)
-
-            real_mod = importlib.import_module(name, package=package)
-            if rename in globals:
-                globals[rename] = real_mod
-            elif locals is not None:
-                locals[rename] = real_mod
-            ret = getattr(real_mod, item)
-            for on_load_func in self._on_loads:
-                on_load_func()
-            # make sure on_load hooks only executed once
-            self._on_loads = []
-            return ret
-
-        def add_load_handler(self, func: Callable):
-            self._on_loads.append(func)
-            return func
+    globals_ = globals_ or inspect.currentframe().f_back.f_globals
 
     if pkgutil.find_loader(prefix_name) is not None:
-        return LazyModule()
+        return LazyModule(name, rename, globals_, locals_)
     elif placeholder:
         return ModulePlaceholder(prefix_name)
     else:
         return None
 
 
 def lazy_import_on_load(lazy_mod):
@@ -419,14 +423,26 @@
     def __getattr__(self, key):
         self._raises()
 
     def __call__(self, *_args, **_kwargs):
         self._raises()
 
 
+def is_same_module(
+    mod1: Optional[Union[ModuleType, LazyModule]],
+    mod2: Optional[Union[ModuleType, LazyModule]],
+) -> bool:
+    if mod1 is None or mod2 is None:
+        return False
+
+    name1 = mod1.name if isinstance(mod1, LazyModule) else mod1.__name__
+    name2 = mod2.name if isinstance(mod2, LazyModule) else mod2.__name__
+    return name1 == name2
+
+
 def serialize_serializable(serializable, compress: bool = False):
     from xoscar.serialization import serialize
 
     bio = io.BytesIO()
     header, buffers = serialize(serializable)
     buf_sizes = [getattr(buf, "nbytes", len(buf)) for buf in buffers]
     header[0]["buf_sizes"] = buf_sizes
@@ -715,14 +731,16 @@
         return pd.Categorical(
             array, categories=categories[0].categories, ordered=categories[0].ordered
         )
     elif isinstance(v, GroupByWrapper):
         df = pd.concat([r[1].obj for r in chunk_results], axis=0)
         if not isinstance(v.keys, list):
             keys = v.keys
+            if isinstance(v.keys, pd.Series):
+                keys = pd.concat([r[1].keys for r in chunk_results])
         else:
             keys = []
             for idx, k in enumerate(v.keys):
                 if isinstance(k, pd.Series):
                     keys.append(pd.concat([r[1].keys[idx] for r in chunk_results]))
                 else:
                     keys.append(k)
@@ -735,15 +753,14 @@
             exclusions=v.exclusions,
             selection=v.selection,
             as_index=v.as_index,
             sort=v.sort,
             group_keys=v.group_keys,
             squeeze=v.squeeze,
             observed=v.observed,
-            mutated=v.mutated,
         )
         return grouped.groupby_obj
     elif isinstance(v, (str, bytes, memoryview, BaseEstimator)):
         result = [r[1] for r in chunk_results]
         if len(result) == 1:
             return result[0]
         return result
@@ -1163,15 +1180,15 @@
             result = pd.DataFrame(columns=obj.columns)
             for i, dtype in enumerate(obj.dtypes):
                 if isinstance(dtype, ArrowDtype):
                     result.iloc[:, i] = pd.Series(
                         obj.iloc[:, i].to_numpy(), index=obj.index
                     )
                 else:
-                    result.iloc[:, i] = obj.iloc[:, i]
+                    result.isetitem(i, obj.iloc[:, i])
             obj = result
     elif isinstance(obj, pd.Series):
         if isinstance(obj.dtype, ArrowDtype):
             obj = pd.Series(obj.to_numpy(), index=obj.index, name=obj.name)
     return obj
```

### Comparing `xorbits-0.2.2/xorbits/_mars/worker.py` & `xorbits-0.3.0/xorbits/worker.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,24 +1,18 @@
 # Copyright 2022-2023 XProbe Inc.
-# derived from copyright 1999-2022 Alibaba Group Holding Ltd.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #      http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-# shortcut to support
-# python -m mars.worker
-
-from .deploy.oscar.worker import main
-from .utils import ensure_coverage
+from ._mars.worker import main
 
 if __name__ == "__main__":
-    ensure_coverage()
     main()
```

### Comparing `xorbits-0.2.2/xorbits/compat/__init__.py` & `xorbits-0.3.0/xorbits/compat/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/compat/_constants.py` & `xorbits-0.3.0/xorbits/compat/_constants.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/core/__init__.py` & `xorbits-0.3.0/xorbits/core/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/core/adapter.py` & `xorbits-0.3.0/xorbits/core/adapter.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/core/api.py` & `xorbits-0.3.0/xorbits/core/api.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/core/execution.py` & `xorbits-0.3.0/xorbits/core/execution.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/core/utils/__init__.py` & `xorbits-0.3.0/xorbits/core/utils/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/core/utils/docstring.py` & `xorbits-0.3.0/xorbits/core/utils/docstring.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/core/utils/fallback.py` & `xorbits-0.3.0/xorbits/core/utils/fallback.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/deploy/__init__.py` & `xorbits-0.3.0/xorbits/deploy/__init__.py`

 * *Files 3% similar despite different names*

```diff
@@ -137,14 +137,18 @@
 
 def shutdown(**kw) -> None:
     """
     Shutdown current local runtime.
     """
     sess = session.get_default_session()
     if sess:  # pragma: no branch
+        # When connecting to an existing cluster by xorbits.init,
+        # stop_server will not do anything,
+        # so we need to delete the session first to release resources
+        sess.destroy()
         sess.stop_server(**kw)
 
 
 def safe_shutdown(**kw) -> None:  # pragma: no cover
     """
     Shutdown current local runtime, and ignore all the errors.
     """
```

### Comparing `xorbits-0.2.2/xorbits/deploy/kubernetes/__init__.py` & `xorbits-0.3.0/xorbits/deploy/kubernetes/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/deploy/kubernetes/_constants.py` & `xorbits-0.3.0/xorbits/deploy/kubernetes/_constants.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/deploy/kubernetes/client.py` & `xorbits-0.3.0/xorbits/deploy/kubernetes/client.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/deploy/kubernetes/config.py` & `xorbits-0.3.0/xorbits/deploy/kubernetes/config.py`

 * *Files 1% similar despite different names*

```diff
@@ -92,15 +92,20 @@
             "kind": "Role",
             "metadata": {"name": self._name, "namespace": self._namespace},
             "rules": [
                 {
                     "apiGroups": self._api_groups,
                     "resources": self._resources,
                     "verbs": self._verbs,
-                }
+                },
+                {
+                    "apiGroups": ["apps"],
+                    "resources": ["deployments", "deployments/scale"],
+                    "verbs": ["get", "watch", "list", "patch"],
+                },
             ],
         }
 
 
 class RoleBindingConfig(KubeConfig):
     """
     Configuration builder for Kubernetes RBAC role bindings
```

### Comparing `xorbits-0.2.2/xorbits/deploy/kubernetes/core.py` & `xorbits-0.3.0/xorbits/deploy/kubernetes/core.py`

 * *Files 25% similar despite different names*

```diff
@@ -9,27 +9,29 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import asyncio
+import json
 import logging
 import os
+import time
 from typing import Any, AsyncGenerator, Dict, List, Optional, TypeVar
 
 from ..._mars.deploy.utils import next_in_thread, wait_all_supervisors_ready
 from ..._mars.services.cluster import WebClusterAPI
 from ..._mars.services.cluster.backends import (
     AbstractClusterBackend,
     register_cluster_backend,
 )
 from ..._mars.services.cluster.core import NodeRole
 from ._constants import SERVICE_PID_FILE
-from .config import XorbitsReplicationConfig
+from .config import XorbitsReplicationConfig, XorbitsWorkersConfig
 
 logger = logging.getLogger(__name__)
 RetType = TypeVar("RetType")
 
 
 @register_cluster_backend
 class K8SClusterBackend(AbstractClusterBackend):
@@ -56,14 +58,15 @@
 
         self._k8s_namespace = (
             k8s_namespace or os.environ.get("MARS_K8S_POD_NAMESPACE") or "default"
         )
         self._service_name = os.environ.get("MARS_K8S_SERVICE_NAME")
         self._full_label_selector = None
         self._client = client.CoreV1Api(client.ApiClient(self._k8s_config))
+        self._apps_client = client.AppsV1Api(client.ApiClient(self._k8s_config))
 
     @classmethod
     async def create(
         cls, node_role: NodeRole, lookup_address: Optional[str], pool_address: str
     ) -> "AbstractClusterBackend":
         from kubernetes import client, config
 
@@ -192,14 +195,63 @@
         self,
         worker_cpu: Optional[int] = None,
         worker_mem: Optional[int] = None,
         timeout: Optional[int] = None,
     ) -> str:
         raise NotImplementedError
 
+    def _list_workers(self):
+        workers = []
+        pods = self._client.list_namespaced_pod(
+            namespace=self._k8s_namespace,
+            _preload_content=False,
+            label_selector="xorbits/service-type=" + XorbitsWorkersConfig.rc_name,
+        )
+        pods_list = json.loads(pods.data)["items"]
+        port = os.environ["MARS_K8S_SERVICE_PORT"]
+        for p in pods_list:
+            if "podIP" in p["status"]:
+                workers.append(p["status"]["podIP"] + ":" + port)
+            elif (
+                "conditions" in p["status"]
+                and "reason" in p["status"]["conditions"][0]
+                and p["status"]["conditions"][0]["reason"] == "Unschedulable"
+            ):
+                raise SystemError(p["status"]["conditions"][0]["message"])
+        return workers
+
+    async def request_workers(
+        self, worker_num: int, timeout: Optional[int] = None
+    ) -> List[str]:
+        if worker_num <= 0:
+            raise ValueError("Please specify a `worker_num` that is greater than zero")
+        if timeout and timeout < 0:
+            raise ValueError("Please specify a `timeout` that is greater than zero")
+        start_time = time.time()
+        deployment = self._apps_client.read_namespaced_deployment(
+            name=XorbitsWorkersConfig.rc_name,
+            namespace=self._k8s_namespace,
+            _preload_content=False,
+        )
+        deployment_data = json.loads(deployment.data)
+        old_replica = deployment_data["status"]["replicas"]
+        old_workers = self._list_workers()
+        new_replica = old_replica + worker_num
+        body = {"spec": {"replicas": new_replica}}
+        self._apps_client.patch_namespaced_deployment_scale(
+            name=XorbitsWorkersConfig.rc_name, namespace=self._k8s_namespace, body=body
+        )
+        while True:
+            if timeout is not None and (timeout + start_time) < time.time():
+                raise TimeoutError("Request worker timeout")
+            new_workers = self._list_workers()
+            if len(new_workers) == new_replica:
+                return list(set(new_workers) - set(old_workers))
+            await asyncio.sleep(1)
+
     async def release_worker(self, address: str):
         raise NotImplementedError
 
     async def reconstruct_worker(self, address: str):
         raise NotImplementedError
```

### Comparing `xorbits-0.2.2/xorbits/deploy/kubernetes/supervisor.py` & `xorbits-0.3.0/xorbits/deploy/kubernetes/supervisor.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/deploy/kubernetes/worker.py` & `xorbits-0.3.0/xorbits/deploy/kubernetes/worker.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/deploy/oscar/file-logging.conf` & `xorbits-0.3.0/xorbits/deploy/oscar/file-logging.conf`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/numpy/__init__.py` & `xorbits-0.3.0/xorbits/numpy/__init__.py`

 * *Files 18% similar despite different names*

```diff
@@ -67,16 +67,14 @@
     unsignedinteger,
     void,
 )
 from numpy.lib.index_tricks import ndindex
 
 from ..core.utils.fallback import unimplemented_func
 
-NUMPY_MODULE_METHODS: Optional[Dict[str, Callable]] = None
-
 
 def _install():
     from .mars_adapters import _install as _install_mars_adapters
 
     _install_mars_adapters()
 
 
@@ -96,47 +94,39 @@
 
 
 from . import fft, linalg, random
 from .core import ndarray
 
 
 def __dir__():
-    from .mars_adapters import MARS_TENSOR_CALLABLES, MARS_TENSOR_OBJECTS
-    from .numpy_adapters import collect_numpy_module_members
-
-    global NUMPY_MODULE_METHODS
     import numpy
 
-    if NUMPY_MODULE_METHODS is None:  # pragma: no cover
-        NUMPY_MODULE_METHODS = collect_numpy_module_members(numpy)
+    from .mars_adapters import MARS_TENSOR_CALLABLES, MARS_TENSOR_OBJECTS
+    from .numpy_adapters import collect_numpy_module_members
 
     return (
         list(MARS_TENSOR_CALLABLES.keys())
         + list((MARS_TENSOR_OBJECTS.keys()))
-        + list(NUMPY_MODULE_METHODS.keys())
+        + list(collect_numpy_module_members(numpy).keys())
     )
 
 
 def __getattr__(name: str):
     from .mars_adapters import MARS_TENSOR_CALLABLES, MARS_TENSOR_OBJECTS
     from .numpy_adapters import collect_numpy_module_members
 
     if name in MARS_TENSOR_CALLABLES:
         return MARS_TENSOR_CALLABLES[name]
     elif name in MARS_TENSOR_OBJECTS:
         return MARS_TENSOR_OBJECTS[name]
     else:
-        global NUMPY_MODULE_METHODS
         import numpy
 
-        if NUMPY_MODULE_METHODS is None:  # pragma: no cover
-            NUMPY_MODULE_METHODS = collect_numpy_module_members(numpy)
-
         if not hasattr(numpy, name):
             raise AttributeError(name)
-        elif name in NUMPY_MODULE_METHODS:
-            return NUMPY_MODULE_METHODS[name]
+        elif name in collect_numpy_module_members(numpy):
+            return collect_numpy_module_members(numpy)[name]
         else:  # pragma: no cover
             if inspect.ismethod(getattr(numpy, name)):
                 return unimplemented_func
             else:
                 raise AttributeError(name)
```

### Comparing `xorbits-0.2.2/xorbits/numpy/core.py` & `xorbits-0.3.0/xorbits/numpy/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/numpy/fft/__init__.py` & `xorbits-0.3.0/xorbits/numpy/fft/__init__.py`

 * *Files 12% similar despite different names*

```diff
@@ -14,45 +14,38 @@
 
 
 import inspect
 from typing import Any, Callable, Dict, Optional
 
 from ...core.utils.fallback import unimplemented_func
 
-NUMPY_FFT_METHODS: Optional[Dict[str, Callable]] = None
-
 
 def __dir__():
     from ..mars_adapters import MARS_TENSOR_FFT_CALLABLES
     from ..numpy_adapters import collect_numpy_module_members
 
     global NUMPY_FFT_METHODS
     import numpy
 
-    if NUMPY_FFT_METHODS is None:  # pragma: no cover
-        NUMPY_FFT_METHODS = collect_numpy_module_members(numpy.fft)
-
-    return list(MARS_TENSOR_FFT_CALLABLES.keys()) + list(NUMPY_FFT_METHODS.keys())
+    return list(MARS_TENSOR_FFT_CALLABLES.keys()) + list(
+        collect_numpy_module_members(numpy.fft).keys()
+    )
 
 
 def __getattr__(name: str):
     from ..mars_adapters import MARS_TENSOR_FFT_CALLABLES
     from ..numpy_adapters import collect_numpy_module_members
 
     if name in MARS_TENSOR_FFT_CALLABLES:
         return MARS_TENSOR_FFT_CALLABLES[name]
     else:  # pragma: no cover
-        global NUMPY_FFT_METHODS
         import numpy
 
-        if NUMPY_FFT_METHODS is None:
-            NUMPY_FFT_METHODS = collect_numpy_module_members(numpy.fft)
-
         if not hasattr(numpy.fft, name):
             raise AttributeError(name)
-        elif name in NUMPY_FFT_METHODS:
-            return NUMPY_FFT_METHODS[name]
+        elif name in collect_numpy_module_members(numpy.fft):
+            return collect_numpy_module_members(numpy.fft)[name]
         else:
             if inspect.ismethod(getattr(numpy.fft, name)):
                 return unimplemented_func
             else:
                 raise AttributeError(name)
```

### Comparing `xorbits-0.2.2/xorbits/numpy/lib/__init__.py` & `xorbits-0.3.0/xorbits/remote/mars_adapters/__init__.py`

 * *Files 5% similar despite different names*

```diff
@@ -8,8 +8,8 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from . import index_tricks
+from .core import spawn
```

### Comparing `xorbits-0.2.2/xorbits/numpy/lib/index_tricks.py` & `xorbits-0.3.0/xorbits/numpy/lib/index_tricks.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/numpy/linalg/__init__.py` & `xorbits-0.3.0/xorbits/numpy/linalg/__init__.py`

 * *Files 26% similar despite different names*

```diff
@@ -13,45 +13,37 @@
 # limitations under the License.
 
 import inspect
 from typing import Any, Callable, Dict, Optional
 
 from ...core.utils.fallback import unimplemented_func
 
-NUMPY_LINALG_METHODS: Optional[Dict[str, Callable]] = None
-
 
 def __dir__():
-    from ..mars_adapters import MARS_TENSOR_LINALG_CALLABLES
-    from ..numpy_adapters import collect_numpy_module_members
-
-    global NUMPY_LINALG_METHODS
     import numpy
 
-    if NUMPY_LINALG_METHODS is None:  # pragma: no cover
-        NUMPY_LINALG_METHODS = collect_numpy_module_members(numpy.linalg)
+    from ..mars_adapters import MARS_TENSOR_LINALG_CALLABLES
+    from ..numpy_adapters import collect_numpy_module_members
 
-    return list(MARS_TENSOR_LINALG_CALLABLES.keys()) + list(NUMPY_LINALG_METHODS.keys())
+    return list(MARS_TENSOR_LINALG_CALLABLES.keys()) + list(
+        collect_numpy_module_members(numpy.linalg).keys()
+    )
 
 
 def __getattr__(name: str):
     from ..mars_adapters import MARS_TENSOR_LINALG_CALLABLES
     from ..numpy_adapters import collect_numpy_module_members
 
     if name in MARS_TENSOR_LINALG_CALLABLES:
         return MARS_TENSOR_LINALG_CALLABLES[name]
     else:
-        global NUMPY_LINALG_METHODS
         import numpy
 
-        if NUMPY_LINALG_METHODS is None:  # pragma: no cover
-            NUMPY_LINALG_METHODS = collect_numpy_module_members(numpy.linalg)
-
         if not hasattr(numpy.linalg, name):
             raise AttributeError(name)
-        elif name in NUMPY_LINALG_METHODS:
-            return NUMPY_LINALG_METHODS[name]
+        elif name in collect_numpy_module_members(numpy.linalg):
+            return collect_numpy_module_members(numpy.linalg)[name]
         else:  # pragma: no cover
             if inspect.ismethod(getattr(numpy.linalg, name)):
                 return unimplemented_func
             else:
                 raise AttributeError(name)
```

### Comparing `xorbits-0.2.2/xorbits/numpy/mars_adapters/__init__.py` & `xorbits-0.3.0/xorbits/numpy/mars_adapters/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/numpy/mars_adapters/core.py` & `xorbits-0.3.0/xorbits/numpy/mars_adapters/core.py`

 * *Files 2% similar despite different names*

```diff
@@ -77,14 +77,15 @@
         "__init__",
         "__dir__",
         "__repr__",
         "__str__",
         "__setattr__",
         "__getattr__",
         "__len__",
+        "__array__",
     }
 
     for mars_cls in MARS_TENSOR_TYPE:
         for name, _ in inspect.getmembers(mars_cls, inspect.isfunction):
             if (
                 name.startswith("__")
                 and name.endswith("__")
```

### Comparing `xorbits-0.2.2/xorbits/numpy/mars_adapters/flatiter.py` & `xorbits-0.3.0/xorbits/numpy/mars_adapters/flatiter.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/numpy/numpy_adapters/__init__.py` & `xorbits-0.3.0/xorbits/remote/__init__.py`

 * *Files 25% similar despite different names*

```diff
@@ -8,8 +8,8 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from .core import collect_numpy_module_members
+from .mars_adapters import spawn
```

### Comparing `xorbits-0.2.2/xorbits/numpy/numpy_adapters/core.py` & `xorbits-0.3.0/xorbits/numpy/numpy_adapters/core.py`

 * *Files 2% similar despite different names*

```diff
@@ -10,14 +10,15 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import inspect
 import warnings
+from functools import lru_cache
 from types import ModuleType
 from typing import Any, Callable, Dict
 
 import numpy as np
 
 from ...core.adapter import MarsOutputType, wrap_mars_callable
 from ...core.utils.fallback import wrap_fallback_module_method
@@ -67,14 +68,15 @@
         )
     except (
         ValueError
     ):  # some np methods return objects and inspect.signature throws a ValueError
         return _NO_ANNOTATION_FUNCS.get(func, MarsOutputType.object)
 
 
+@lru_cache(maxsize=1)
 def collect_numpy_module_members(np_mod: ModuleType) -> Dict[str, Any]:
     from ..mars_adapters.core import MARS_TENSOR_CALLABLES
 
     module_methods: Dict[str, Any] = dict()
     with warnings.catch_warnings():
         for name, mod_member in inspect.getmembers(np_mod):
             if (
```

### Comparing `xorbits-0.2.2/xorbits/numpy/random/__init__.py` & `xorbits-0.3.0/xorbits/numpy/random/__init__.py`

 * *Files 12% similar despite different names*

```diff
@@ -12,45 +12,38 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import inspect
 from typing import Any, Callable, Dict, Optional
 
 from ...core.utils.fallback import unimplemented_func
 
-NUMPY_RANDOM_METHODS: Optional[Dict[str, Callable]] = None
-
 
 def __dir__():
     from ..mars_adapters import MARS_TENSOR_RANDOM_CALLABLES
     from ..numpy_adapters import collect_numpy_module_members
 
     global NUMPY_RANDOM_METHODS
     import numpy
 
-    if NUMPY_RANDOM_METHODS is None:  # pragma: no cover
-        NUMPY_RANDOM_METHODS = collect_numpy_module_members(numpy.random)
-
-    return list(MARS_TENSOR_RANDOM_CALLABLES.keys()) + list(NUMPY_RANDOM_METHODS.keys())
+    return list(MARS_TENSOR_RANDOM_CALLABLES.keys()) + list(
+        collect_numpy_module_members(numpy.random).keys()
+    )
 
 
 def __getattr__(name: str):
     from ..mars_adapters import MARS_TENSOR_RANDOM_CALLABLES
     from ..numpy_adapters import collect_numpy_module_members
 
     if name in MARS_TENSOR_RANDOM_CALLABLES:
         return MARS_TENSOR_RANDOM_CALLABLES[name]
     else:
-        global NUMPY_RANDOM_METHODS
         import numpy
 
-        if NUMPY_RANDOM_METHODS is None:  # pragma: no cover
-            NUMPY_RANDOM_METHODS = collect_numpy_module_members(numpy.random)
-
         if not hasattr(numpy.random, name):
             raise AttributeError(name)
-        elif name in NUMPY_RANDOM_METHODS:
-            return NUMPY_RANDOM_METHODS[name]
+        elif name in collect_numpy_module_members(numpy.random):
+            return collect_numpy_module_members(numpy.random)[name]
         else:  # pragma: no cover
             if inspect.ismethod(getattr(numpy.random, name)):
                 return unimplemented_func
             else:
                 raise AttributeError(name)
```

### Comparing `xorbits-0.2.2/xorbits/pandas/__init__.py` & `xorbits-0.3.0/xorbits/pandas/__init__.py`

 * *Files 20% similar despite different names*

```diff
@@ -8,14 +8,15 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import inspect
+from typing import Callable, Dict, Optional
 
 # noinspection PyUnresolvedReferences
 from pandas import Timedelta  # noqa: F401
 from pandas import DateOffset, Interval, NaT, Timestamp, offsets
 
 try:
     from pandas import NA, NamedAgg  # noqa: F401
@@ -33,29 +34,32 @@
 
     _install_mars_methods()
     _install_pandas_methods()
 
 
 def __dir__():
     from .mars_adapters import MARS_DATAFRAME_CALLABLES
+    from .pandas_adapters import collect_pandas_module_members
 
-    return list(MARS_DATAFRAME_CALLABLES.keys())
+    return list(MARS_DATAFRAME_CALLABLES.keys()) + list(
+        collect_pandas_module_members().keys()
+    )
 
 
 def __getattr__(name: str):
     from .mars_adapters import MARS_DATAFRAME_CALLABLES
-    from .pandas_adapters import PANDAS_MODULE_METHODS
+    from .pandas_adapters import collect_pandas_module_members
 
     if name in MARS_DATAFRAME_CALLABLES:
         return MARS_DATAFRAME_CALLABLES[name]
     else:
         import pandas
 
         if not hasattr(pandas, name):
             raise AttributeError(name)
-        elif name in PANDAS_MODULE_METHODS:
-            return PANDAS_MODULE_METHODS[name]
+        elif name in collect_pandas_module_members():
+            return collect_pandas_module_members()[name]
         else:  # pragma: no cover
             if inspect.ismethod(getattr(pandas, name)):
                 return unimplemented_func
             else:
                 raise AttributeError(name)
```

### Comparing `xorbits-0.2.2/xorbits/pandas/accessors.py` & `xorbits-0.3.0/xorbits/pandas/accessors.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/pandas/core.py` & `xorbits-0.3.0/xorbits/pandas/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/pandas/groupby.py` & `xorbits-0.3.0/xorbits/pandas/groupby.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/pandas/indexing.py` & `xorbits-0.3.0/xorbits/pandas/indexing.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/pandas/mars_adapters/__init__.py` & `xorbits-0.3.0/xorbits/pandas/mars_adapters/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/pandas/mars_adapters/core.py` & `xorbits-0.3.0/xorbits/pandas/mars_adapters/core.py`

 * *Files 1% similar despite different names*

```diff
@@ -92,14 +92,15 @@
         "__init__",
         "__dir__",
         "__repr__",
         "__str__",
         "__setattr__",
         "__getattr__",
         "__len__",
+        "__array__",
     }
     all_cls = (
         MARS_DATAFRAME_TYPE
         + MARS_SERIES_TYPE
         + MARS_DATAFRAME_GROUPBY_TYPE
         + MARS_SERIES_GROUPBY_TYPE
     )
```

### Comparing `xorbits-0.2.2/xorbits/pandas/pandas_adapters/__init__.py` & `xorbits-0.3.0/xorbits/pandas/pandas_adapters/__init__.py`

 * *Files 14% similar despite different names*

```diff
@@ -8,15 +8,15 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from .core import PANDAS_MODULE_METHODS
+from .core import collect_pandas_module_members
 
 
 def _install():
     from .core import (
         _collect_pandas_dataframe_members,
         _collect_pandas_index_members,
         _collect_pandas_series_members,
```

### Comparing `xorbits-0.2.2/xorbits/pandas/pandas_adapters/core.py` & `xorbits-0.3.0/xorbits/pandas/pandas_adapters/core.py`

 * *Files 2% similar despite different names*

```diff
@@ -11,14 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import functools
 import inspect
 import warnings
+from functools import lru_cache
 from typing import Any, Callable, Dict, Type
 
 import pandas as pd
 
 from ...core.adapter import (
     MarsEntity,
     MarsOutputType,
@@ -169,15 +170,16 @@
     _collect_pandas_cls_members(pd.Series, DataType.series)
 
 
 def _collect_pandas_index_members():
     _collect_pandas_cls_members(pd.Index, DataType.index)
 
 
-def _collect_pandas_module_members() -> Dict[str, Any]:
+@lru_cache(maxsize=1)
+def collect_pandas_module_members() -> Dict[str, Any]:
     from ..mars_adapters.core import MARS_DATAFRAME_CALLABLES
 
     module_methods: Dict[str, Any] = dict()
     with warnings.catch_warnings():
         # suppress warnings raised by pandas when import xorbits.pandas
         warning_members = [
             "pandas.Float64Index",
@@ -206,10 +208,7 @@
                     attach_docstring=True,
                     is_cls_member=False,
                     docstring_src_module=pd,
                     docstring_src=getattr(pd, name, None),
                     fallback_warning=True,
                 )
     return module_methods
-
-
-PANDAS_MODULE_METHODS = _collect_pandas_module_members()
```

### Comparing `xorbits-0.2.2/xorbits/pandas/plotting.py` & `xorbits-0.3.0/xorbits/pandas/plotting.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/pandas/window.py` & `xorbits-0.3.0/xorbits/pandas/window.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/remote/__init__.py` & `xorbits-0.3.0/xorbits/web/version_handler.py`

 * *Files 24% similar despite different names*

```diff
@@ -8,8 +8,19 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from .mars_adapters import spawn
+from .._mars.services.web import MarsRequestHandler
+
+
+class XorbitsVersionHandler(MarsRequestHandler):
+    @staticmethod
+    def _get_version():
+        from .._version import get_versions
+
+        return get_versions()
+
+    def get(self):
+        self.write(self._get_version())
```

### Comparing `xorbits-0.2.2/xorbits/remote/mars_adapters/core.py` & `xorbits-0.3.0/xorbits/remote/mars_adapters/core.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/utils.py` & `xorbits-0.3.0/xorbits/utils.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/web/__init__.py` & `xorbits-0.3.0/xorbits/web/__init__.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/web/index_handler.py` & `xorbits-0.3.0/xorbits/web/index_handler.py`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/web/ui/index.html` & `xorbits-0.3.0/xorbits/web/ui/index.html`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/web/ui/static/546.bundle.js` & `xorbits-0.3.0/xorbits/web/ui/static/546.bundle.js`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/web/ui/static/546.bundle.js.LICENSE.txt` & `xorbits-0.3.0/xorbits/web/ui/static/546.bundle.js.LICENSE.txt`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/web/ui/static/601.bundle.js` & `xorbits-0.3.0/xorbits/web/ui/static/601.bundle.js`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/web/ui/static/615.bundle.js` & `xorbits-0.3.0/xorbits/web/ui/static/615.bundle.js`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/web/ui/static/701.bundle.js` & `xorbits-0.3.0/xorbits/web/ui/static/701.bundle.js`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/web/ui/static/bundle.js` & `xorbits-0.3.0/xorbits/web/ui/static/bundle.js`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/web/ui/static/bundle.js.LICENSE.txt` & `xorbits-0.3.0/xorbits/web/ui/static/bundle.js.LICENSE.txt`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/web/ui/static/resources/assets/images/favicon.svg` & `xorbits-0.3.0/xorbits/web/ui/static/resources/assets/images/favicon.svg`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits/web/ui/static/resources/assets/images/xorbits.svg` & `xorbits-0.3.0/xorbits/web/ui/static/resources/assets/images/xorbits.svg`

 * *Files identical despite different names*

### Comparing `xorbits-0.2.2/xorbits.egg-info/PKG-INFO` & `xorbits-0.3.0/xorbits.egg-info/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: xorbits
-Version: 0.2.2
+Version: 0.3.0
 Summary: Scalable Python data science, in an API compatible & lightning fast way.
 Home-page: http://github.com/xprobe-inc/xorbits
 Author: Qin Xuye
 Author-email: qinxuye@xprobe.io
 Maintainer: Qin Xuye
 Maintainer-email: qinxuye@xprobe.io
 License: Apache License 2.0
@@ -130,14 +130,15 @@
 
 | Deployment                                                                           | Description                                               |
 |--------------------------------------------------------------------------------------|-----------------------------------------------------------|
 | [Local](https://doc.xorbits.io/en/latest/user_guide/deployment_local.html)           | Run Xorbits on a local machine, e.g. your laptop          |
 | [Cluster](https://doc.xorbits.io/en/latest/user_guide/deployment_cluster.html)       | Deploy Xorbits to existing cluster via command lines      |
 | [Kubernetes](https://doc.xorbits.io/en/latest/user_guide/deployment_kubernetes.html) | Deploy Xorbits to existing k8s cluster via python code    |
 | [Cloud](https://doc.xorbits.io/en/latest/user_guide/deployment_cloud.html)           | Deploy Xorbits to various cloud platforms via python code |
+| [SLURM](https://doc.xorbits.io/en/latest/user_guide/deployment_slurm.html)           | Deploy Xorbits to SLURM                                   |
 
 
 ## License
 [Apache 2](LICENSE)
 
 ## Documentation
 The official documentation is hosted on: https://doc.xorbits.io
```

### Comparing `xorbits-0.2.2/xorbits.egg-info/SOURCES.txt` & `xorbits-0.3.0/xorbits.egg-info/SOURCES.txt`

 * *Files 2% similar despite different names*

```diff
@@ -543,26 +543,14 @@
 xorbits/_mars/services/meta/store/dictionary.py
 xorbits/_mars/services/meta/supervisor/__init__.py
 xorbits/_mars/services/meta/supervisor/core.py
 xorbits/_mars/services/meta/supervisor/service.py
 xorbits/_mars/services/meta/worker/__init__.py
 xorbits/_mars/services/meta/worker/core.py
 xorbits/_mars/services/meta/worker/service.py
-xorbits/_mars/services/mutable/__init__.py
-xorbits/_mars/services/mutable/core.py
-xorbits/_mars/services/mutable/utils.py
-xorbits/_mars/services/mutable/api/__init__.py
-xorbits/_mars/services/mutable/api/core.py
-xorbits/_mars/services/mutable/api/oscar.py
-xorbits/_mars/services/mutable/api/web.py
-xorbits/_mars/services/mutable/supervisor/__init__.py
-xorbits/_mars/services/mutable/supervisor/core.py
-xorbits/_mars/services/mutable/supervisor/service.py
-xorbits/_mars/services/mutable/worker/__init__.py
-xorbits/_mars/services/mutable/worker/core.py
 xorbits/_mars/services/scheduling/__init__.py
 xorbits/_mars/services/scheduling/core.py
 xorbits/_mars/services/scheduling/errors.py
 xorbits/_mars/services/scheduling/utils.py
 xorbits/_mars/services/scheduling/api/__init__.py
 xorbits/_mars/services/scheduling/api/core.py
 xorbits/_mars/services/scheduling/api/oscar.py
```

### Comparing `xorbits-0.2.2/xorbits.egg-info/requires.txt` & `xorbits-0.3.0/xorbits.egg-info/requires.txt`

 * *Files identical despite different names*

