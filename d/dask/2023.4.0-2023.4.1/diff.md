# Comparing `tmp/dask-2023.4.0.tar.gz` & `tmp/dask-2023.4.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dask-2023.4.0.tar", last modified: Fri Apr 14 18:42:47 2023, max compression
+gzip compressed data, was "dask-2023.4.1.tar", last modified: Fri Apr 28 17:30:05 2023, max compression
```

## Comparing `dask-2023.4.0.tar` & `dask-2023.4.1.tar`

### file list

```diff
@@ -1,488 +1,486 @@
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.364034 dask-2023.4.0/
--rw-r--r--   0 james      (501) staff       (20)     1531 2022-10-24 20:44:15.000000 dask-2023.4.0/LICENSE.txt
--rw-r--r--   0 james      (501) staff       (20)      325 2022-11-09 22:20:24.000000 dask-2023.4.0/MANIFEST.in
--rw-r--r--   0 james      (501) staff       (20)     2582 2023-04-14 18:42:47.363323 dask-2023.4.0/PKG-INFO
--rw-r--r--   0 james      (501) staff       (20)     1291 2022-11-09 22:20:24.000000 dask-2023.4.0/README.rst
--rw-r--r--   0 james      (501) staff       (20)     2361 2023-04-14 17:41:00.000000 dask-2023.4.0/conftest.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.364757 dask-2023.4.0/dask/
--rw-r--r--   0 james      (501) staff       (20)      428 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/__init__.py
--rw-r--r--   0 james      (501) staff       (20)       97 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/__main__.py
--rw-r--r--   0 james      (501) staff       (20)      607 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/_compatibility.py
--rw-r--r--   0 james      (501) staff       (20)      500 2023-04-14 18:42:47.364946 dask-2023.4.0/dask/_version.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:46.946276 dask-2023.4.0/dask/array/
--rw-r--r--   0 james      (501) staff       (20)     1543 2021-06-08 02:50:30.000000 dask-2023.4.0/dask/array/NUMPY_LICENSE.txt
--rw-r--r--   0 james      (501) staff       (20)     5377 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/array/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    12564 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/backends.py
--rw-r--r--   0 james      (501) staff       (20)     9865 2023-03-14 21:35:42.000000 dask-2023.4.0/dask/array/blockwise.py
--rw-r--r--   0 james      (501) staff       (20)    12268 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/chunk.py
--rw-r--r--   0 james      (501) staff       (20)     5030 2022-11-14 20:10:31.000000 dask-2023.4.0/dask/array/chunk_types.py
--rw-r--r--   0 james      (501) staff       (20)   190909 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/core.py
--rw-r--r--   0 james      (501) staff       (20)    40564 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/array/creation.py
--rw-r--r--   0 james      (501) staff       (20)     2078 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/cupy_entry_point.py
--rw-r--r--   0 james      (501) staff       (20)      490 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/dispatch.py
--rw-r--r--   0 james      (501) staff       (20)     9153 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/array/einsumfuncs.py
--rw-r--r--   0 james      (501) staff       (20)     7216 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/fft.py
--rw-r--r--   0 james      (501) staff       (20)    32620 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/array/gufunc.py
--rw-r--r--   0 james      (501) staff       (20)     1960 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/array/image.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:46.947753 dask-2023.4.0/dask/array/lib/
--rw-r--r--   0 james      (501) staff       (20)       41 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/array/lib/__init__.py
--rw-r--r--   0 james      (501) staff       (20)       65 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/array/lib/stride_tricks.py
--rw-r--r--   0 james      (501) staff       (20)    53299 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/linalg.py
--rw-r--r--   0 james      (501) staff       (20)     6327 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/ma.py
--rw-r--r--   0 james      (501) staff       (20)     5663 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/array/numpy_compat.py
--rw-r--r--   0 james      (501) staff       (20)    12811 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/optimization.py
--rw-r--r--   0 james      (501) staff       (20)    28444 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/overlap.py
--rw-r--r--   0 james      (501) staff       (20)    10616 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/percentile.py
--rw-r--r--   0 james      (501) staff       (20)    40795 2023-04-11 17:23:03.000000 dask-2023.4.0/dask/array/random.py
--rw-r--r--   0 james      (501) staff       (20)    27183 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/array/rechunk.py
--rw-r--r--   0 james      (501) staff       (20)    57251 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/array/reductions.py
--rw-r--r--   0 james      (501) staff       (20)    10729 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/array/reshape.py
--rw-r--r--   0 james      (501) staff       (20)    81898 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/routines.py
--rw-r--r--   0 james      (501) staff       (20)    72595 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/slicing.py
--rw-r--r--   0 james      (501) staff       (20)    14578 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/stats.py
--rw-r--r--   0 james      (501) staff       (20)     8012 2022-08-08 20:45:08.000000 dask-2023.4.0/dask/array/svg.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:46.994241 dask-2023.4.0/dask/array/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/array/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)   161425 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_array_core.py
--rw-r--r--   0 james      (501) staff       (20)     6653 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_array_function.py
--rw-r--r--   0 james      (501) staff       (20)     3123 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/array/tests/test_array_utils.py
--rw-r--r--   0 james      (501) staff       (20)    23186 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_atop.py
--rw-r--r--   0 james      (501) staff       (20)     3055 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/array/tests/test_chunk.py
--rw-r--r--   0 james      (501) staff       (20)    31114 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/array/tests/test_creation.py
--rw-r--r--   0 james      (501) staff       (20)    19852 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_cupy_core.py
--rw-r--r--   0 james      (501) staff       (20)     6420 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_cupy_creation.py
--rw-r--r--   0 james      (501) staff       (20)      558 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_cupy_gufunc.py
--rw-r--r--   0 james      (501) staff       (20)    13376 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_cupy_linalg.py
--rw-r--r--   0 james      (501) staff       (20)     4267 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/array/tests/test_cupy_overlap.py
--rw-r--r--   0 james      (501) staff       (20)     2826 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_cupy_percentile.py
--rw-r--r--   0 james      (501) staff       (20)     6443 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/tests/test_cupy_random.py
--rw-r--r--   0 james      (501) staff       (20)     2188 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_cupy_reductions.py
--rw-r--r--   0 james      (501) staff       (20)     7401 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_cupy_routines.py
--rw-r--r--   0 james      (501) staff       (20)     4841 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/tests/test_cupy_slicing.py
--rw-r--r--   0 james      (501) staff       (20)     2946 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_cupy_sparse.py
--rw-r--r--   0 james      (501) staff       (20)     8829 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_dispatch.py
--rw-r--r--   0 james      (501) staff       (20)     8401 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/array/tests/test_fft.py
--rw-r--r--   0 james      (501) staff       (20)    20977 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_gufunc.py
--rw-r--r--   0 james      (501) staff       (20)     1446 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/array/tests/test_image.py
--rw-r--r--   0 james      (501) staff       (20)    36412 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_linalg.py
--rw-r--r--   0 james      (501) staff       (20)    15599 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_masked.py
--rw-r--r--   0 james      (501) staff       (20)     1051 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/array/tests/test_numpy_compat.py
--rw-r--r--   0 james      (501) staff       (20)    17410 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/tests/test_optimization.py
--rw-r--r--   0 james      (501) staff       (20)    26682 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_overlap.py
--rw-r--r--   0 james      (501) staff       (20)     3407 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_percentiles.py
--rw-r--r--   0 james      (501) staff       (20)    15467 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/array/tests/test_random.py
--rw-r--r--   0 james      (501) staff       (20)    33636 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_rechunk.py
--rw-r--r--   0 james      (501) staff       (20)    32720 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_reductions.py
--rw-r--r--   0 james      (501) staff       (20)     7253 2022-08-08 20:45:08.000000 dask-2023.4.0/dask/array/tests/test_reshape.py
--rw-r--r--   0 james      (501) staff       (20)    83813 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_routines.py
--rw-r--r--   0 james      (501) staff       (20)    32266 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/array/tests/test_slicing.py
--rw-r--r--   0 james      (501) staff       (20)     6556 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/array/tests/test_sparse.py
--rw-r--r--   0 james      (501) staff       (20)     5453 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/tests/test_stats.py
--rw-r--r--   0 james      (501) staff       (20)     2704 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/array/tests/test_svg.py
--rw-r--r--   0 james      (501) staff       (20)      489 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/tests/test_testing.py
--rw-r--r--   0 james      (501) staff       (20)    17354 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/tests/test_ufunc.py
--rw-r--r--   0 james      (501) staff       (20)     2670 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/array/tests/test_wrap.py
--rw-r--r--   0 james      (501) staff       (20)     1281 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/tests/test_xarray.py
--rw-r--r--   0 james      (501) staff       (20)     4701 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/array/tiledb_io.py
--rw-r--r--   0 james      (501) staff       (20)     9907 2023-04-11 17:23:03.000000 dask-2023.4.0/dask/array/ufunc.py
--rw-r--r--   0 james      (501) staff       (20)    18638 2023-03-03 18:04:26.000000 dask-2023.4.0/dask/array/utils.py
--rw-r--r--   0 james      (501) staff       (20)     6870 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/array/wrap.py
--rw-r--r--   0 james      (501) staff       (20)     4909 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/backends.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.001471 dask-2023.4.0/dask/bag/
--rw-r--r--   0 james      (501) staff       (20)      867 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/bag/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     9075 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/bag/avro.py
--rw-r--r--   0 james      (501) staff       (20)      726 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/bag/chunk.py
--rw-r--r--   0 james      (501) staff       (20)    84624 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/bag/core.py
--rw-r--r--   0 james      (501) staff       (20)     5428 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/bag/random.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.007007 dask-2023.4.0/dask/bag/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/bag/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     3772 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/bag/tests/test_avro.py
--rw-r--r--   0 james      (501) staff       (20)    49657 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/bag/tests/test_bag.py
--rw-r--r--   0 james      (501) staff       (20)     6492 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/bag/tests/test_random.py
--rw-r--r--   0 james      (501) staff       (20)     5013 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/bag/tests/test_text.py
--rw-r--r--   0 james      (501) staff       (20)     6729 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/bag/text.py
--rw-r--r--   0 james      (501) staff       (20)      204 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/bag/utils.py
--rw-r--r--   0 james      (501) staff       (20)    52108 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/base.py
--rw-r--r--   0 james      (501) staff       (20)    52987 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/blockwise.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.009997 dask-2023.4.0/dask/bytes/
--rw-r--r--   0 james      (501) staff       (20)       39 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/bytes/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     6897 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/bytes/core.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.016036 dask-2023.4.0/dask/bytes/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/bytes/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     5122 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/bytes/tests/test_bytes_utils.py
--rw-r--r--   0 james      (501) staff       (20)      494 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/bytes/tests/test_compression.py
--rw-r--r--   0 james      (501) staff       (20)     6657 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/bytes/tests/test_http.py
--rw-r--r--   0 james      (501) staff       (20)    11440 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/bytes/tests/test_local.py
--rw-r--r--   0 james      (501) staff       (20)    19631 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/bytes/tests/test_s3.py
--rw-r--r--   0 james      (501) staff       (20)      464 2021-11-11 20:27:17.000000 dask-2023.4.0/dask/bytes/utils.py
--rw-r--r--   0 james      (501) staff       (20)     1965 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/cache.py
--rw-r--r--   0 james      (501) staff       (20)     4067 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/callbacks.py
--rw-r--r--   0 james      (501) staff       (20)     3028 2023-04-11 17:23:03.000000 dask-2023.4.0/dask/cli.py
--rw-r--r--   0 james      (501) staff       (20)      487 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/compatibility.py
--rw-r--r--   0 james      (501) staff       (20)    21645 2023-04-11 17:23:03.000000 dask-2023.4.0/dask/config.py
--rw-r--r--   0 james      (501) staff       (20)     1720 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/context.py
--rw-r--r--   0 james      (501) staff       (20)    14797 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/core.py
--rw-r--r--   0 james      (501) staff       (20)     6944 2023-04-14 17:41:00.000000 dask-2023.4.0/dask/dask-schema.yaml
--rw-r--r--   0 james      (501) staff       (20)     1498 2023-04-14 17:41:00.000000 dask-2023.4.0/dask/dask.yaml
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.039604 dask-2023.4.0/dask/dataframe/
--rw-r--r--   0 james      (501) staff       (20)     1776 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/dataframe/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     5655 2023-04-14 17:41:00.000000 dask-2023.4.0/dask/dataframe/_compat.py
--rw-r--r--   0 james      (501) staff       (20)      851 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/dataframe/_dtypes.py
--rw-r--r--   0 james      (501) staff       (20)     3183 2023-04-14 17:41:00.000000 dask-2023.4.0/dask/dataframe/_pyarrow.py
--rw-r--r--   0 james      (501) staff       (20)     1900 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/dataframe/_pyarrow_compat.py
--rw-r--r--   0 james      (501) staff       (20)    12101 2023-04-14 17:41:00.000000 dask-2023.4.0/dask/dataframe/accessor.py
--rw-r--r--   0 james      (501) staff       (20)    24075 2023-04-14 16:24:56.000000 dask-2023.4.0/dask/dataframe/backends.py
--rw-r--r--   0 james      (501) staff       (20)     9471 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/categorical.py
--rw-r--r--   0 james      (501) staff       (20)   297608 2023-04-14 17:41:00.000000 dask-2023.4.0/dask/dataframe/core.py
--rw-r--r--   0 james      (501) staff       (20)     4437 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/dataframe/dispatch.py
--rw-r--r--   0 james      (501) staff       (20)      516 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/dataframe/extensions.py
--rw-r--r--   0 james      (501) staff       (20)   112712 2023-04-14 17:41:01.000000 dask-2023.4.0/dask/dataframe/groupby.py
--rw-r--r--   0 james      (501) staff       (20)     2427 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/dataframe/hyperloglog.py
--rw-r--r--   0 james      (501) staff       (20)    13376 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/dataframe/indexing.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.048507 dask-2023.4.0/dask/dataframe/io/
--rw-r--r--   0 james      (501) staff       (20)      670 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/dataframe/io/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    33618 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/dataframe/io/csv.py
--rw-r--r--   0 james      (501) staff       (20)     5745 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/dataframe/io/demo.py
--rw-r--r--   0 james      (501) staff       (20)    18059 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/io/hdf.py
--rw-r--r--   0 james      (501) staff       (20)    38497 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/dataframe/io/io.py
--rw-r--r--   0 james      (501) staff       (20)    11127 2023-04-10 20:58:06.000000 dask-2023.4.0/dask/dataframe/io/json.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.052097 dask-2023.4.0/dask/dataframe/io/orc/
--rw-r--r--   0 james      (501) staff       (20)       56 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/dataframe/io/orc/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     4451 2023-03-13 17:40:24.000000 dask-2023.4.0/dask/dataframe/io/orc/arrow.py
--rw-r--r--   0 james      (501) staff       (20)     7062 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/io/orc/core.py
--rw-r--r--   0 james      (501) staff       (20)      473 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/dataframe/io/orc/utils.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.057855 dask-2023.4.0/dask/dataframe/io/parquet/
--rw-r--r--   0 james      (501) staff       (20)      130 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/dataframe/io/parquet/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    71139 2023-04-14 17:41:01.000000 dask-2023.4.0/dask/dataframe/io/parquet/arrow.py
--rw-r--r--   0 james      (501) staff       (20)    66556 2023-04-11 21:12:17.000000 dask-2023.4.0/dask/dataframe/io/parquet/core.py
--rw-r--r--   0 james      (501) staff       (20)    52121 2023-04-14 17:41:01.000000 dask-2023.4.0/dask/dataframe/io/parquet/fastparquet.py
--rw-r--r--   0 james      (501) staff       (20)    32860 2023-04-11 21:12:17.000000 dask-2023.4.0/dask/dataframe/io/parquet/utils.py
--rw-r--r--   0 james      (501) staff       (20)    21112 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/io/sql.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.067354 dask-2023.4.0/dask/dataframe/io/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-03-07 20:03:52.000000 dask-2023.4.0/dask/dataframe/io/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    58831 2023-04-14 17:41:01.000000 dask-2023.4.0/dask/dataframe/io/tests/test_csv.py
--rw-r--r--   0 james      (501) staff       (20)     5000 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/io/tests/test_demo.py
--rw-r--r--   0 james      (501) staff       (20)    27186 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/io/tests/test_hdf.py
--rw-r--r--   0 james      (501) staff       (20)    34402 2023-04-14 17:41:01.000000 dask-2023.4.0/dask/dataframe/io/tests/test_io.py
--rw-r--r--   0 james      (501) staff       (20)     8589 2023-04-10 20:58:06.000000 dask-2023.4.0/dask/dataframe/io/tests/test_json.py
--rw-r--r--   0 james      (501) staff       (20)     5202 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/io/tests/test_orc.py
--rw-r--r--   0 james      (501) staff       (20)   164250 2023-04-14 17:41:01.000000 dask-2023.4.0/dask/dataframe/io/tests/test_parquet.py
--rw-r--r--   0 james      (501) staff       (20)    17640 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/io/tests/test_sql.py
--rw-r--r--   0 james      (501) staff       (20)     7863 2023-04-11 21:12:17.000000 dask-2023.4.0/dask/dataframe/io/utils.py
--rw-r--r--   0 james      (501) staff       (20)    13697 2023-04-14 17:41:01.000000 dask-2023.4.0/dask/dataframe/methods.py
--rw-r--r--   0 james      (501) staff       (20)    53784 2023-04-12 22:26:07.000000 dask-2023.4.0/dask/dataframe/multi.py
--rw-r--r--   0 james      (501) staff       (20)     1564 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/dataframe/numeric.py
--rw-r--r--   0 james      (501) staff       (20)     8742 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/dataframe/optimize.py
--rw-r--r--   0 james      (501) staff       (20)    19848 2023-04-14 16:24:56.000000 dask-2023.4.0/dask/dataframe/partitionquantiles.py
--rw-r--r--   0 james      (501) staff       (20)    11874 2023-04-14 17:41:01.000000 dask-2023.4.0/dask/dataframe/reshape.py
--rw-r--r--   0 james      (501) staff       (20)    22149 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/rolling.py
--rw-r--r--   0 james      (501) staff       (20)    38051 2023-04-12 22:26:07.000000 dask-2023.4.0/dask/dataframe/shuffle.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.093854 dask-2023.4.0/dask/dataframe/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/dataframe/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    10597 2023-04-14 17:41:01.000000 dask-2023.4.0/dask/dataframe/tests/test_accessors.py
--rw-r--r--   0 james      (501) staff       (20)    61992 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/tests/test_arithmetics_reduction.py
--rw-r--r--   0 james      (501) staff       (20)      906 2022-08-08 20:45:08.000000 dask-2023.4.0/dask/dataframe/tests/test_boolean.py
--rw-r--r--   0 james      (501) staff       (20)    17160 2023-04-12 22:26:07.000000 dask-2023.4.0/dask/dataframe/tests/test_categorical.py
--rw-r--r--   0 james      (501) staff       (20)   183270 2023-04-14 17:41:01.000000 dask-2023.4.0/dask/dataframe/tests/test_dataframe.py
--rw-r--r--   0 james      (501) staff       (20)     1420 2022-08-08 20:45:08.000000 dask-2023.4.0/dask/dataframe/tests/test_extensions.py
--rw-r--r--   0 james      (501) staff       (20)    14707 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/tests/test_format.py
--rw-r--r--   0 james      (501) staff       (20)   117342 2023-04-11 21:25:08.000000 dask-2023.4.0/dask/dataframe/tests/test_groupby.py
--rw-r--r--   0 james      (501) staff       (20)     2666 2022-08-08 20:45:08.000000 dask-2023.4.0/dask/dataframe/tests/test_hashing.py
--rw-r--r--   0 james      (501) staff       (20)     2861 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/dataframe/tests/test_hyperloglog.py
--rw-r--r--   0 james      (501) staff       (20)    22346 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/tests/test_indexing.py
--rw-r--r--   0 james      (501) staff       (20)     6998 2022-12-14 03:22:05.000000 dask-2023.4.0/dask/dataframe/tests/test_merge_column_and_index.py
--rw-r--r--   0 james      (501) staff       (20)    89759 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/tests/test_multi.py
--rw-r--r--   0 james      (501) staff       (20)     2084 2023-04-14 17:41:01.000000 dask-2023.4.0/dask/dataframe/tests/test_numeric.py
--rw-r--r--   0 james      (501) staff       (20)     1031 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/dataframe/tests/test_optimize_dataframe.py
--rw-r--r--   0 james      (501) staff       (20)     6626 2023-04-11 18:11:20.000000 dask-2023.4.0/dask/dataframe/tests/test_pyarrow.py
--rw-r--r--   0 james      (501) staff       (20)     4514 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/tests/test_pyarrow_compat.py
--rw-r--r--   0 james      (501) staff       (20)    11505 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/dataframe/tests/test_reshape.py
--rw-r--r--   0 james      (501) staff       (20)    17488 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/dataframe/tests/test_rolling.py
--rw-r--r--   0 james      (501) staff       (20)    51515 2023-04-11 18:11:20.000000 dask-2023.4.0/dask/dataframe/tests/test_shuffle.py
--rw-r--r--   0 james      (501) staff       (20)    16559 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/dataframe/tests/test_ufunc.py
--rw-r--r--   0 james      (501) staff       (20)    21243 2023-04-11 17:23:03.000000 dask-2023.4.0/dask/dataframe/tests/test_utils_dataframe.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.095957 dask-2023.4.0/dask/dataframe/tseries/
--rw-r--r--   0 james      (501) staff       (20)        0 2021-06-08 02:50:30.000000 dask-2023.4.0/dask/dataframe/tseries/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     7628 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/dataframe/tseries/resample.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.097412 dask-2023.4.0/dask/dataframe/tseries/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/dataframe/tseries/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     6830 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/dataframe/tseries/tests/test_resample.py
--rw-r--r--   0 james      (501) staff       (20)    26381 2023-04-14 17:41:01.000000 dask-2023.4.0/dask/dataframe/utils.py
--rw-r--r--   0 james      (501) staff       (20)     4901 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/datasets.py
--rw-r--r--   0 james      (501) staff       (20)    24353 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/delayed.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.100723 dask-2023.4.0/dask/diagnostics/
--rw-r--r--   0 james      (501) staff       (20)      222 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/diagnostics/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    12100 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/diagnostics/profile.py
--rw-r--r--   0 james      (501) staff       (20)    16296 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/diagnostics/profile_visualize.py
--rw-r--r--   0 james      (501) staff       (20)     4965 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/diagnostics/progress.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.102618 dask-2023.4.0/dask/diagnostics/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/diagnostics/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    12009 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/diagnostics/tests/test_profiler.py
--rw-r--r--   0 james      (501) staff       (20)     3352 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/diagnostics/tests/test_progress.py
--rw-r--r--   0 james      (501) staff       (20)      679 2022-08-08 20:45:08.000000 dask-2023.4.0/dask/distributed.py
--rw-r--r--   0 james      (501) staff       (20)    16587 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/dot.py
--rw-r--r--   0 james      (501) staff       (20)    19595 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/graph_manipulation.py
--rw-r--r--   0 james      (501) staff       (20)     2456 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/hashing.py
--rw-r--r--   0 james      (501) staff       (20)    34771 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/highlevelgraph.py
--rw-r--r--   0 james      (501) staff       (20)    46007 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/layers.py
--rw-r--r--   0 james      (501) staff       (20)    18888 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/local.py
--rw-r--r--   0 james      (501) staff       (20)      450 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/ml.py
--rw-r--r--   0 james      (501) staff       (20)     8466 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/multiprocessing.py
--rw-r--r--   0 james      (501) staff       (20)    35602 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/optimization.py
--rw-r--r--   0 james      (501) staff       (20)    45732 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/order.py
--rw-r--r--   0 james      (501) staff       (20)        0 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/py.typed
--rw-r--r--   0 james      (501) staff       (20)    12561 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/rewrite.py
--rw-r--r--   0 james      (501) staff       (20)     7254 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/sizeof.py
--rw-r--r--   0 james      (501) staff       (20)     1474 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/system.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.135175 dask-2023.4.0/dask/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-03-07 20:04:31.000000 dask-2023.4.0/dask/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)      706 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/tests/test_backends.py
--rw-r--r--   0 james      (501) staff       (20)    51088 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/tests/test_base.py
--rw-r--r--   0 james      (501) staff       (20)     1577 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/tests/test_cache.py
--rw-r--r--   0 james      (501) staff       (20)     2534 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/tests/test_callbacks.py
--rw-r--r--   0 james      (501) staff       (20)     1163 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/tests/test_ci.py
--rw-r--r--   0 james      (501) staff       (20)     3230 2023-04-11 17:23:03.000000 dask-2023.4.0/dask/tests/test_cli.py
--rw-r--r--   0 james      (501) staff       (20)      343 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/tests/test_compatibility.py
--rw-r--r--   0 james      (501) staff       (20)    17810 2023-04-11 17:23:03.000000 dask-2023.4.0/dask/tests/test_config.py
--rw-r--r--   0 james      (501) staff       (20)     1101 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/tests/test_context.py
--rw-r--r--   0 james      (501) staff       (20)     7386 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/tests/test_core.py
--rw-r--r--   0 james      (501) staff       (20)     1029 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/tests/test_datasets.py
--rw-r--r--   0 james      (501) staff       (20)    22953 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/tests/test_delayed.py
--rw-r--r--   0 james      (501) staff       (20)    28382 2023-04-10 20:58:06.000000 dask-2023.4.0/dask/tests/test_distributed.py
--rw-r--r--   0 james      (501) staff       (20)      889 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/tests/test_docs.py
--rw-r--r--   0 james      (501) staff       (20)    12235 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/tests/test_dot.py
--rw-r--r--   0 james      (501) staff       (20)    14088 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/tests/test_graph_manipulation.py
--rw-r--r--   0 james      (501) staff       (20)     1059 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/tests/test_hashing.py
--rw-r--r--   0 james      (501) staff       (20)     7929 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/tests/test_highgraph.py
--rw-r--r--   0 james      (501) staff       (20)     9305 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/tests/test_layers.py
--rw-r--r--   0 james      (501) staff       (20)     4972 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/tests/test_local.py
--rw-r--r--   0 james      (501) staff       (20)      382 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/tests/test_ml.py
--rw-r--r--   0 james      (501) staff       (20)     8421 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/tests/test_multiprocessing.py
--rw-r--r--   0 james      (501) staff       (20)    45191 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/tests/test_optimization.py
--rw-r--r--   0 james      (501) staff       (20)    28193 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/tests/test_order.py
--rw-r--r--   0 james      (501) staff       (20)     4648 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/tests/test_rewrite.py
--rw-r--r--   0 james      (501) staff       (20)     7482 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/tests/test_sizeof.py
--rw-r--r--   0 james      (501) staff       (20)     7118 2023-04-11 21:12:17.000000 dask-2023.4.0/dask/tests/test_spark_compat.py
--rw-r--r--   0 james      (501) staff       (20)     1361 2022-02-04 20:18:56.000000 dask-2023.4.0/dask/tests/test_system.py
--rw-r--r--   0 james      (501) staff       (20)     4713 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/tests/test_threaded.py
--rw-r--r--   0 james      (501) staff       (20)     5670 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/tests/test_typing.py
--rw-r--r--   0 james      (501) staff       (20)    21288 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/tests/test_utils.py
--rw-r--r--   0 james      (501) staff       (20)     1562 2023-04-11 17:13:14.000000 dask-2023.4.0/dask/tests/test_utils_test.py
--rw-r--r--   0 james      (501) staff       (20)      175 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/tests/warning_aliases.py
--rw-r--r--   0 james      (501) staff       (20)     2993 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/threaded.py
--rw-r--r--   0 james      (501) staff       (20)    14538 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/typing.py
--rw-r--r--   0 james      (501) staff       (20)    55904 2023-04-07 16:53:50.000000 dask-2023.4.0/dask/utils.py
--rw-r--r--   0 james      (501) staff       (20)     4825 2023-04-11 17:13:14.000000 dask-2023.4.0/dask/utils_test.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.136564 dask-2023.4.0/dask/widgets/
--rw-r--r--   0 james      (501) staff       (20)      756 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/widgets/__init__.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.139446 dask-2023.4.0/dask/widgets/templates/
--rw-r--r--   0 james      (501) staff       (20)     1295 2023-03-13 17:40:25.000000 dask-2023.4.0/dask/widgets/templates/array.html.j2
--rw-r--r--   0 james      (501) staff       (20)      124 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/widgets/templates/dataframe.html.j2
--rw-r--r--   0 james      (501) staff       (20)     2579 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/widgets/templates/highlevelgraph.html.j2
--rw-r--r--   0 james      (501) staff       (20)     1981 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/widgets/templates/highlevelgraph_layer.html.j2
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.140097 dask-2023.4.0/dask/widgets/tests/
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.142425 dask-2023.4.0/dask/widgets/tests/templates/
--rw-r--r--   0 james      (501) staff       (20)       38 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/widgets/tests/templates/bytes.html.j2
--rw-r--r--   0 james      (501) staff       (20)       39 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/widgets/tests/templates/custom_filter.html.j2
--rw-r--r--   0 james      (501) staff       (20)       30 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/widgets/tests/templates/example.html.j2
--rw-r--r--   0 james      (501) staff       (20)     1365 2022-10-24 20:44:15.000000 dask-2023.4.0/dask/widgets/tests/test_widgets.py
--rw-r--r--   0 james      (501) staff       (20)     1084 2022-11-09 22:20:24.000000 dask-2023.4.0/dask/widgets/widgets.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:46.912851 dask-2023.4.0/dask.egg-info/
--rw-r--r--   0 james      (501) staff       (20)     2582 2023-04-14 18:42:46.000000 dask-2023.4.0/dask.egg-info/PKG-INFO
--rw-r--r--   0 james      (501) staff       (20)    13988 2023-04-14 18:42:46.000000 dask-2023.4.0/dask.egg-info/SOURCES.txt
--rw-r--r--   0 james      (501) staff       (20)        1 2023-04-14 18:42:46.000000 dask-2023.4.0/dask.egg-info/dependency_links.txt
--rw-r--r--   0 james      (501) staff       (20)      124 2023-04-14 18:42:46.000000 dask-2023.4.0/dask.egg-info/entry_points.txt
--rw-r--r--   0 james      (501) staff       (20)        1 2023-04-14 18:42:46.000000 dask-2023.4.0/dask.egg-info/not-zip-safe
--rw-r--r--   0 james      (501) staff       (20)      438 2023-04-14 18:42:46.000000 dask-2023.4.0/dask.egg-info/requires.txt
--rw-r--r--   0 james      (501) staff       (20)        5 2023-04-14 18:42:46.000000 dask-2023.4.0/dask.egg-info/top_level.txt
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.145268 dask-2023.4.0/docs/
--rw-r--r--   0 james      (501) staff       (20)     5741 2023-03-22 19:03:53.000000 dask-2023.4.0/docs/Makefile
--rw-r--r--   0 james      (501) staff       (20)     5186 2022-08-08 20:45:08.000000 dask-2023.4.0/docs/make.bat
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.226218 dask-2023.4.0/docs/source/
--rw-r--r--   0 james      (501) staff       (20)    17598 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/10-minutes-to-dask.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.236994 dask-2023.4.0/docs/source/_static/
--rw-r--r--   0 james      (501) staff       (20)    10187 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/_static/config_converter.js
--rw-r--r--   0 james      (501) staff       (20)    11021 2021-06-08 02:50:31.000000 dask-2023.4.0/docs/source/_static/dask-simple.png
--rw-r--r--   0 james      (501) staff       (20)     2375 2021-06-08 02:51:08.000000 dask-2023.4.0/docs/source/_static/main-page.css
--rw-r--r--   0 james      (501) staff       (20)    15598 2022-08-08 20:45:08.000000 dask-2023.4.0/docs/source/_static/profile.html
--rw-r--r--   0 james      (501) staff       (20)    65304 2022-08-08 20:45:08.000000 dask-2023.4.0/docs/source/_static/stacked_profile.html
--rw-r--r--   0 james      (501) staff       (20)      523 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/_static/style.css
--rw-r--r--   0 james      (501) staff       (20)      365 2021-06-16 20:41:28.000000 dask-2023.4.0/docs/source/_static/theme_overrides.css
--rw-r--r--   0 james      (501) staff       (20)   292662 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/_static/transpose_cyto.html
--rw-r--r--   0 james      (501) staff       (20)    49423 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/_static/yaml.min.js
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.238196 dask-2023.4.0/docs/source/_templates/
--rw-r--r--   0 james      (501) staff       (20)      180 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/_templates/layout.html
--rw-r--r--   0 james      (501) staff       (20)     2235 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/api.rst
--rw-r--r--   0 james      (501) staff       (20)     6896 2023-04-07 16:53:50.000000 dask-2023.4.0/docs/source/array-api.rst
--rw-r--r--   0 james      (501) staff       (20)     2943 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/array-assignment.rst
--rw-r--r--   0 james      (501) staff       (20)     4740 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/array-best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)    13035 2023-04-11 17:23:03.000000 dask-2023.4.0/docs/source/array-chunks.rst
--rw-r--r--   0 james      (501) staff       (20)    18437 2023-04-11 17:23:03.000000 dask-2023.4.0/docs/source/array-creation.rst
--rw-r--r--   0 james      (501) staff       (20)     5885 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/array-design.rst
--rw-r--r--   0 james      (501) staff       (20)     2857 2023-04-11 17:23:03.000000 dask-2023.4.0/docs/source/array-gufunc.rst
--rw-r--r--   0 james      (501) staff       (20)     6069 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/array-overlap.rst
--rw-r--r--   0 james      (501) staff       (20)     3423 2023-04-11 17:23:03.000000 dask-2023.4.0/docs/source/array-random.rst
--rw-r--r--   0 james      (501) staff       (20)     4137 2021-11-11 17:33:01.000000 dask-2023.4.0/docs/source/array-slicing.rst
--rw-r--r--   0 james      (501) staff       (20)     3291 2023-04-11 17:23:03.000000 dask-2023.4.0/docs/source/array-sparse.rst
--rw-r--r--   0 james      (501) staff       (20)     2018 2022-10-07 21:37:36.000000 dask-2023.4.0/docs/source/array-stack.rst
--rw-r--r--   0 james      (501) staff       (20)     1140 2023-04-11 17:23:03.000000 dask-2023.4.0/docs/source/array-stats.rst
--rw-r--r--   0 james      (501) staff       (20)     4121 2023-04-11 17:23:03.000000 dask-2023.4.0/docs/source/array.rst
--rw-r--r--   0 james      (501) staff       (20)     1574 2022-08-08 20:45:08.000000 dask-2023.4.0/docs/source/bag-api.rst
--rw-r--r--   0 james      (501) staff       (20)     4557 2021-06-08 02:51:08.000000 dask-2023.4.0/docs/source/bag-creation.rst
--rw-r--r--   0 james      (501) staff       (20)     4068 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/bag.rst
--rw-r--r--   0 james      (501) staff       (20)    14205 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)     5553 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/caching.rst
--rw-r--r--   0 james      (501) staff       (20)   296900 2023-04-14 18:20:10.000000 dask-2023.4.0/docs/source/changelog.rst
--rw-r--r--   0 james      (501) staff       (20)      211 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/cheatsheet.rst
--rw-r--r--   0 james      (501) staff       (20)     4047 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/cli.rst
--rw-r--r--   0 james      (501) staff       (20)    15465 2023-03-13 20:41:19.000000 dask-2023.4.0/docs/source/conf.py
--rw-r--r--   0 james      (501) staff       (20)    16654 2023-04-06 21:35:01.000000 dask-2023.4.0/docs/source/configuration.rst
--rw-r--r--   0 james      (501) staff       (20)    18651 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/custom-collections.rst
--rw-r--r--   0 james      (501) staff       (20)     3604 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/custom-graphs.rst
--rw-r--r--   0 james      (501) staff       (20)      896 2023-03-20 18:17:18.000000 dask-2023.4.0/docs/source/dashboard-progress-script.py
--rw-r--r--   0 james      (501) staff       (20)    15045 2023-04-07 16:53:50.000000 dask-2023.4.0/docs/source/dashboard.rst
--rw-r--r--   0 james      (501) staff       (20)   203552 2021-06-08 02:51:08.000000 dask-2023.4.0/docs/source/daskcheatsheet.pdf
--rw-r--r--   0 james      (501) staff       (20)    11599 2023-04-07 16:53:50.000000 dask-2023.4.0/docs/source/dataframe-api.rst
--rw-r--r--   0 james      (501) staff       (20)     9611 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/dataframe-best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)     3951 2021-11-11 20:27:17.000000 dask-2023.4.0/docs/source/dataframe-categoricals.rst
--rw-r--r--   0 james      (501) staff       (20)     5967 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/dataframe-create.rst
--rw-r--r--   0 james      (501) staff       (20)     5002 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/dataframe-design.rst
--rw-r--r--   0 james      (501) staff       (20)     6224 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/dataframe-extend.rst
--rw-r--r--   0 james      (501) staff       (20)     8050 2023-04-07 16:53:50.000000 dask-2023.4.0/docs/source/dataframe-groupby.rst
--rw-r--r--   0 james      (501) staff       (20)     6115 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/dataframe-indexing.rst
--rw-r--r--   0 james      (501) staff       (20)     3454 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/dataframe-joins.rst
--rw-r--r--   0 james      (501) staff       (20)    10952 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/dataframe-parquet.rst
--rw-r--r--   0 james      (501) staff       (20)    12661 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/dataframe-sql.rst
--rw-r--r--   0 james      (501) staff       (20)     7772 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/dataframe.rst
--rw-r--r--   0 james      (501) staff       (20)      363 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/debugging-performance.rst
--rw-r--r--   0 james      (501) staff       (20)     1696 2022-08-08 20:45:08.000000 dask-2023.4.0/docs/source/delayed-api.rst
--rw-r--r--   0 james      (501) staff       (20)    17616 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/delayed-best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)     1497 2022-10-07 21:37:36.000000 dask-2023.4.0/docs/source/delayed-collections.rst
--rw-r--r--   0 james      (501) staff       (20)     6357 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/delayed.rst
--rw-r--r--   0 james      (501) staff       (20)     3620 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/deploying-cli.rst
--rw-r--r--   0 james      (501) staff       (20)     2978 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/deploying-cloud.rst
--rw-r--r--   0 james      (501) staff       (20)     2868 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/deploying-docker.rst
--rw-r--r--   0 james      (501) staff       (20)     9939 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/deploying-hpc.rst
--rw-r--r--   0 james      (501) staff       (20)    15281 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/deploying-kubernetes-helm.rst
--rw-r--r--   0 james      (501) staff       (20)      156 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/deploying-kubernetes-native.rst
--rw-r--r--   0 james      (501) staff       (20)     3072 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/deploying-kubernetes.rst
--rw-r--r--   0 james      (501) staff       (20)     5823 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/deploying-python-advanced.rst
--rw-r--r--   0 james      (501) staff       (20)     2839 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/deploying-python.rst
--rw-r--r--   0 james      (501) staff       (20)     1619 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/deploying-ssh.rst
--rw-r--r--   0 james      (501) staff       (20)     7201 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/deploying.rst
--rw-r--r--   0 james      (501) staff       (20)    10758 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/deployment-considerations.rst
--rw-r--r--   0 james      (501) staff       (20)    13142 2023-04-11 17:23:03.000000 dask-2023.4.0/docs/source/develop.rst
--rw-r--r--   0 james      (501) staff       (20)     4442 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/diagnostics-distributed.rst
--rw-r--r--   0 james      (501) staff       (20)    10407 2023-04-11 17:23:03.000000 dask-2023.4.0/docs/source/diagnostics-local.rst
--rw-r--r--   0 james      (501) staff       (20)     4323 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/ecosystem.rst
--rw-r--r--   0 james      (501) staff       (20)    19964 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/faq.rst
--rw-r--r--   0 james      (501) staff       (20)    26361 2023-04-11 17:23:03.000000 dask-2023.4.0/docs/source/futures.rst
--rw-r--r--   0 james      (501) staff       (20)     5820 2022-10-07 21:37:14.000000 dask-2023.4.0/docs/source/gpu.rst
--rw-r--r--   0 james      (501) staff       (20)     2541 2023-04-11 17:23:03.000000 dask-2023.4.0/docs/source/graph_manipulation.rst
--rw-r--r--   0 james      (501) staff       (20)     5433 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/graphs.rst
--rw-r--r--   0 james      (501) staff       (20)     5399 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/graphviz.rst
--rw-r--r--   0 james      (501) staff       (20)     6946 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/high-level-graphs.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.245027 dask-2023.4.0/docs/source/how-to/
--rw-r--r--   0 james      (501) staff       (20)     4364 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/how-to/adaptive.rst
--rw-r--r--   0 james      (501) staff       (20)    15360 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/how-to/connect-to-remote-data.rst
--rw-r--r--   0 james      (501) staff       (20)     4209 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/how-to/customize-initialization.rst
--rw-r--r--   0 james      (501) staff       (20)    10859 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/how-to/debug.rst
--rw-r--r--   0 james      (501) staff       (20)     1722 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/how-to/extend-sizeof.rst
--rw-r--r--   0 james      (501) staff       (20)      433 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/how-to/index.rst
--rw-r--r--   0 james      (501) staff       (20)     4562 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/how-to/manage-environments.rst
--rw-r--r--   0 james      (501) staff       (20)     6680 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/how-to/selecting-the-collection-backend.rst
--rw-r--r--   0 james      (501) staff       (20)      902 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/how-to/setup-prometheus.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.361645 dask-2023.4.0/docs/source/images/
--rw-r--r--   0 james      (501) staff       (20)    99565 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/10_minutes_array_graph.png
--rw-r--r--   0 james      (501) staff       (20)    22442 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/10_minutes_bag_graph.png
--rw-r--r--   0 james      (501) staff       (20)    56229 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/10_minutes_dataframe_graph.png
--rw-r--r--   0 james      (501) staff       (20)     4059 2021-06-08 02:51:08.000000 dask-2023.4.0/docs/source/images/HHMI_Janelia_Color.png
--rw-r--r--   0 james      (501) staff       (20)    18406 2021-06-08 02:50:31.000000 dask-2023.4.0/docs/source/images/array.svg
--rw-r--r--   0 james      (501) staff       (20)  1620104 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/async-embarrassing.gif
--rw-r--r--   0 james      (501) staff       (20)    10752 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/concurrent-futures-threaded.webp
--rw-r--r--   0 james      (501) staff       (20)   135129 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/crosstalk.svg
--rw-r--r--   0 james      (501) staff       (20)  2367087 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dashboard_jupyterlab.png
--rw-r--r--   0 james      (501) staff       (20)    37971 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dashboard_link.png
--rw-r--r--   0 james      (501) staff       (20)    68712 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dashboard_memory.png
--rw-r--r--   0 james      (501) staff       (20)   281018 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/images/dashboard_memory_new.gif
--rw-r--r--   0 james      (501) staff       (20)    25435 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/images/dashboard_progress.png
--rw-r--r--   0 james      (501) staff       (20)   276928 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/images/dashboard_status.png
--rw-r--r--   0 james      (501) staff       (20)    12009 2023-04-07 16:53:50.000000 dask-2023.4.0/docs/source/images/dashboard_task_processing.png
--rw-r--r--   0 james      (501) staff       (20)    58238 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dashboard_task_stream_unhealthy.png
--rw-r--r--   0 james      (501) staff       (20)   103654 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dashboard_taskstream_healthy.png
--rw-r--r--   0 james      (501) staff       (20)   112822 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/dask-adaptive.svg
--rw-r--r--   0 james      (501) staff       (20)    14645 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/dask-array.svg
--rw-r--r--   0 james      (501) staff       (20)   222084 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/dask-cluster-manager.svg
--rw-r--r--   0 james      (501) staff       (20)    18782 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/dask-dataframe.svg
--rw-r--r--   0 james      (501) staff       (20)   381903 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dask-overview-distributed-callout.svg
--rw-r--r--   0 james      (501) staff       (20)   357643 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dask-overview-schedulers.svg
--rw-r--r--   0 james      (501) staff       (20)    97471 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/dask-overview.svg
--rw-r--r--   0 james      (501) staff       (20)     3022 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dask_horizontal.svg
--rw-r--r--   0 james      (501) staff       (20)     3651 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dask_horizontal_black.svg
--rw-r--r--   0 james      (501) staff       (20)     3767 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dask_horizontal_on_blue.svg
--rw-r--r--   0 james      (501) staff       (20)     3738 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dask_horizontal_on_pink.svg
--rw-r--r--   0 james      (501) staff       (20)     3738 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dask_horizontal_white.svg
--rw-r--r--   0 james      (501) staff       (20)     1607 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dask_icon.svg
--rw-r--r--   0 james      (501) staff       (20)     1571 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dask_icon_black.svg
--rw-r--r--   0 james      (501) staff       (20)     1607 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dask_icon_on_pink.svg
--rw-r--r--   0 james      (501) staff       (20)     1609 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/dask_icon_white.svg
--rw-r--r--   0 james      (501) staff       (20)    20216 2021-06-08 02:51:08.000000 dask-2023.4.0/docs/source/images/delayed-inc-double-add.svg
--rw-r--r--   0 james      (501) staff       (20)   104628 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/distributed-overview.svg
--rw-r--r--   0 james      (501) staff       (20)    18297 2021-06-08 02:50:31.000000 dask-2023.4.0/docs/source/images/frame-shuffle.svg
--rw-r--r--   0 james      (501) staff       (20)    22979 2021-06-08 02:50:31.000000 dask-2023.4.0/docs/source/images/frame-sort.svg
--rw-r--r--   0 james      (501) staff       (20)    12181 2021-06-08 02:50:31.000000 dask-2023.4.0/docs/source/images/frame.svg
--rw-r--r--   0 james      (501) staff       (20)    41828 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/gputester-msg.png
--rw-r--r--   0 james      (501) staff       (20)   210392 2021-11-11 17:33:01.000000 dask-2023.4.0/docs/source/images/growth_of_languages.png
--rw-r--r--   0 james      (501) staff       (20)   167834 2021-11-11 17:33:01.000000 dask-2023.4.0/docs/source/images/growth_of_libraries.png
--rw-r--r--   0 james      (501) staff       (20)     4097 2021-06-08 02:51:08.000000 dask-2023.4.0/docs/source/images/inc-add.svg
--rw-r--r--   0 james      (501) staff       (20)   123010 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/map-reduce-task-scheduling.svg
--rw-r--r--   0 james      (501) staff       (20)   482302 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/map_blocks_drop_axis.png
--rw-r--r--   0 james      (501) staff       (20)   113067 2021-11-11 20:27:17.000000 dask-2023.4.0/docs/source/images/merge_chunks.png
--rw-r--r--   0 james      (501) staff       (20)    63244 2021-11-11 20:27:17.000000 dask-2023.4.0/docs/source/images/merge_chunks_false.png
--rw-r--r--   0 james      (501) staff       (20)    13024 2021-11-11 17:33:01.000000 dask-2023.4.0/docs/source/images/optimize_dask1.svg
--rw-r--r--   0 james      (501) staff       (20)     8803 2021-11-11 17:33:01.000000 dask-2023.4.0/docs/source/images/optimize_dask2.svg
--rw-r--r--   0 james      (501) staff       (20)     5198 2021-11-11 17:33:01.000000 dask-2023.4.0/docs/source/images/optimize_dask3.svg
--rw-r--r--   0 james      (501) staff       (20)     4104 2021-11-11 17:33:01.000000 dask-2023.4.0/docs/source/images/optimize_dask4.svg
--rw-r--r--   0 james      (501) staff       (20)     2738 2021-11-11 17:33:01.000000 dask-2023.4.0/docs/source/images/optimize_dask5.svg
--rw-r--r--   0 james      (501) staff       (20)   292827 2021-11-11 20:27:17.000000 dask-2023.4.0/docs/source/images/order-failure.png
--rw-r--r--   0 james      (501) staff       (20)   239828 2021-11-11 20:27:17.000000 dask-2023.4.0/docs/source/images/order-success.png
--rw-r--r--   0 james      (501) staff       (20)    40833 2021-06-08 02:51:08.000000 dask-2023.4.0/docs/source/images/overlap.svg
--rw-r--r--   0 james      (501) staff       (20)    18785 2021-06-08 02:51:08.000000 dask-2023.4.0/docs/source/images/overlapping-blocks.svg
--rw-r--r--   0 james      (501) staff       (20)     4537 2021-06-08 02:51:08.000000 dask-2023.4.0/docs/source/images/overlapping-neighbors.svg
--rw-r--r--   0 james      (501) staff       (20)    20533 2021-06-08 02:51:08.000000 dask-2023.4.0/docs/source/images/pipeline.svg
--rw-r--r--   0 james      (501) staff       (20)    31576 2021-11-11 20:27:17.000000 dask-2023.4.0/docs/source/images/reshape.png
--rw-r--r--   0 james      (501) staff       (20)    31410 2021-11-11 20:27:17.000000 dask-2023.4.0/docs/source/images/reshape_problem.png
--rw-r--r--   0 james      (501) staff       (20)    33288 2021-11-11 20:27:17.000000 dask-2023.4.0/docs/source/images/reshape_rechunked.png
--rw-r--r--   0 james      (501) staff       (20)    50209 2021-06-08 02:50:31.000000 dask-2023.4.0/docs/source/images/scaling-edges.png
--rw-r--r--   0 james      (501) staff       (20)    68476 2021-06-08 02:50:31.000000 dask-2023.4.0/docs/source/images/scaling-nodes.png
--rw-r--r--   0 james      (501) staff       (20)    21294 2021-06-08 02:50:31.000000 dask-2023.4.0/docs/source/images/simple-dask.png
--rw-r--r--   0 james      (501) staff       (20)    27572 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/transpose-hlg-hovertooltip.png
--rw-r--r--   0 james      (501) staff       (20)    84492 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/images/transpose-hlg-html-repr.png
--rw-r--r--   0 james      (501) staff       (20)    39365 2021-06-08 02:51:08.000000 dask-2023.4.0/docs/source/images/transpose.svg
--rw-r--r--   0 james      (501) staff       (20)    22446 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/transpose_opt.svg
--rw-r--r--   0 james      (501) staff       (20)   115022 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/images/trivial.svg
--rw-r--r--   0 james      (501) staff       (20)     2451 2021-06-08 02:51:08.000000 dask-2023.4.0/docs/source/images/unoverlapping-neighbors.svg
--rw-r--r--   0 james      (501) staff       (20)     6237 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/index.rst
--rw-r--r--   0 james      (501) staff       (20)     7819 2023-04-10 21:18:33.000000 dask-2023.4.0/docs/source/install.rst
--rw-r--r--   0 james      (501) staff       (20)      341 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/internals.rst
--rw-r--r--   0 james      (501) staff       (20)      868 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/logos.rst
--rw-r--r--   0 james      (501) staff       (20)     3573 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/maintainers.rst
--rw-r--r--   0 james      (501) staff       (20)    12200 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/optimize.rst
--rw-r--r--   0 james      (501) staff       (20)     7119 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/order.rst
--rw-r--r--   0 james      (501) staff       (20)     4810 2022-10-07 21:37:14.000000 dask-2023.4.0/docs/source/phases-of-computation.rst
--rw-r--r--   0 james      (501) staff       (20)     5089 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/presentations.rst
--rw-r--r--   0 james      (501) staff       (20)     6010 2022-10-07 21:37:14.000000 dask-2023.4.0/docs/source/scheduler-overview.rst
--rw-r--r--   0 james      (501) staff       (20)     4493 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/scheduling-policy.rst
--rw-r--r--   0 james      (501) staff       (20)    11014 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/scheduling.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-14 18:42:47.362497 dask-2023.4.0/docs/source/scripts/
--rw-r--r--   0 james      (501) staff       (20)     3258 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/scripts/scheduling.py
--rw-r--r--   0 james      (501) staff       (20)     6104 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/shared.rst
--rw-r--r--   0 james      (501) staff       (20)     9342 2022-11-09 22:20:24.000000 dask-2023.4.0/docs/source/spark.rst
--rw-r--r--   0 james      (501) staff       (20)     3966 2022-10-07 21:37:14.000000 dask-2023.4.0/docs/source/spec.rst
--rw-r--r--   0 james      (501) staff       (20)     4608 2023-03-13 17:40:25.000000 dask-2023.4.0/docs/source/support.rst
--rw-r--r--   0 james      (501) staff       (20)     1831 2021-06-16 20:41:28.000000 dask-2023.4.0/docs/source/understanding-performance.rst
--rw-r--r--   0 james      (501) staff       (20)    12205 2023-04-11 17:23:03.000000 dask-2023.4.0/docs/source/user-interfaces.rst
--rw-r--r--   0 james      (501) staff       (20)    11744 2022-10-24 20:44:15.000000 dask-2023.4.0/docs/source/why.rst
--rw-r--r--   0 james      (501) staff       (20)     5192 2023-04-14 18:33:58.000000 dask-2023.4.0/pyproject.toml
--rw-r--r--   0 james      (501) staff       (20)       38 2023-04-14 18:42:47.364216 dask-2023.4.0/setup.cfg
--rwxr-xr-x   0 james      (501) staff       (20)      194 2023-04-07 16:53:50.000000 dask-2023.4.0/setup.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.892868 dask-2023.4.1/
+-rw-r--r--   0 james      (501) staff       (20)     1531 2022-10-24 20:44:15.000000 dask-2023.4.1/LICENSE.txt
+-rw-r--r--   0 james      (501) staff       (20)      325 2022-11-09 22:20:24.000000 dask-2023.4.1/MANIFEST.in
+-rw-r--r--   0 james      (501) staff       (20)     2582 2023-04-28 17:30:05.892202 dask-2023.4.1/PKG-INFO
+-rw-r--r--   0 james      (501) staff       (20)     1291 2022-11-09 22:20:24.000000 dask-2023.4.1/README.rst
+-rw-r--r--   0 james      (501) staff       (20)     2361 2023-04-26 17:05:49.000000 dask-2023.4.1/conftest.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.893501 dask-2023.4.1/dask/
+-rw-r--r--   0 james      (501) staff       (20)      428 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)       97 2023-03-13 17:40:24.000000 dask-2023.4.1/dask/__main__.py
+-rw-r--r--   0 james      (501) staff       (20)      607 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/_compatibility.py
+-rw-r--r--   0 james      (501) staff       (20)      500 2023-04-28 17:30:05.893655 dask-2023.4.1/dask/_version.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.324088 dask-2023.4.1/dask/array/
+-rw-r--r--   0 james      (501) staff       (20)     1543 2021-06-08 02:50:30.000000 dask-2023.4.1/dask/array/NUMPY_LICENSE.txt
+-rw-r--r--   0 james      (501) staff       (20)     5377 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    12564 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/backends.py
+-rw-r--r--   0 james      (501) staff       (20)     9865 2023-03-14 21:35:42.000000 dask-2023.4.1/dask/array/blockwise.py
+-rw-r--r--   0 james      (501) staff       (20)    12268 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/chunk.py
+-rw-r--r--   0 james      (501) staff       (20)     5030 2022-11-14 20:10:31.000000 dask-2023.4.1/dask/array/chunk_types.py
+-rw-r--r--   0 james      (501) staff       (20)   190909 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/core.py
+-rw-r--r--   0 james      (501) staff       (20)    40564 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/creation.py
+-rw-r--r--   0 james      (501) staff       (20)     2078 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/cupy_entry_point.py
+-rw-r--r--   0 james      (501) staff       (20)      490 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)     9153 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/einsumfuncs.py
+-rw-r--r--   0 james      (501) staff       (20)     7216 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/fft.py
+-rw-r--r--   0 james      (501) staff       (20)    32620 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/gufunc.py
+-rw-r--r--   0 james      (501) staff       (20)     1960 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/image.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.325731 dask-2023.4.1/dask/array/lib/
+-rw-r--r--   0 james      (501) staff       (20)       41 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/lib/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)       65 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/lib/stride_tricks.py
+-rw-r--r--   0 james      (501) staff       (20)    53299 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/linalg.py
+-rw-r--r--   0 james      (501) staff       (20)     6327 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/ma.py
+-rw-r--r--   0 james      (501) staff       (20)     5663 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/numpy_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    12811 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    28444 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/overlap.py
+-rw-r--r--   0 james      (501) staff       (20)    10616 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/percentile.py
+-rw-r--r--   0 james      (501) staff       (20)    40795 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/random.py
+-rw-r--r--   0 james      (501) staff       (20)    27183 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/rechunk.py
+-rw-r--r--   0 james      (501) staff       (20)    57251 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/reductions.py
+-rw-r--r--   0 james      (501) staff       (20)    10729 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    81898 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/routines.py
+-rw-r--r--   0 james      (501) staff       (20)    72595 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/slicing.py
+-rw-r--r--   0 james      (501) staff       (20)    14578 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/stats.py
+-rw-r--r--   0 james      (501) staff       (20)     8012 2022-08-08 20:45:08.000000 dask-2023.4.1/dask/array/svg.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.377364 dask-2023.4.1/dask/array/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/array/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)   161425 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_array_core.py
+-rw-r--r--   0 james      (501) staff       (20)     6653 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_array_function.py
+-rw-r--r--   0 james      (501) staff       (20)     3123 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/tests/test_array_utils.py
+-rw-r--r--   0 james      (501) staff       (20)    23186 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_atop.py
+-rw-r--r--   0 james      (501) staff       (20)     3055 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/array/tests/test_chunk.py
+-rw-r--r--   0 james      (501) staff       (20)    31114 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_creation.py
+-rw-r--r--   0 james      (501) staff       (20)    19852 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_core.py
+-rw-r--r--   0 james      (501) staff       (20)     6420 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_creation.py
+-rw-r--r--   0 james      (501) staff       (20)      558 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_gufunc.py
+-rw-r--r--   0 james      (501) staff       (20)    13376 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_linalg.py
+-rw-r--r--   0 james      (501) staff       (20)     4267 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/tests/test_cupy_overlap.py
+-rw-r--r--   0 james      (501) staff       (20)     2826 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_percentile.py
+-rw-r--r--   0 james      (501) staff       (20)     6443 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_cupy_random.py
+-rw-r--r--   0 james      (501) staff       (20)     2188 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_reductions.py
+-rw-r--r--   0 james      (501) staff       (20)     7401 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_routines.py
+-rw-r--r--   0 james      (501) staff       (20)     4841 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_cupy_slicing.py
+-rw-r--r--   0 james      (501) staff       (20)     2946 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_sparse.py
+-rw-r--r--   0 james      (501) staff       (20)     8829 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)     8401 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/array/tests/test_fft.py
+-rw-r--r--   0 james      (501) staff       (20)    20977 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_gufunc.py
+-rw-r--r--   0 james      (501) staff       (20)     1446 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/array/tests/test_image.py
+-rw-r--r--   0 james      (501) staff       (20)    36412 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_linalg.py
+-rw-r--r--   0 james      (501) staff       (20)    15599 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_masked.py
+-rw-r--r--   0 james      (501) staff       (20)     1051 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/array/tests/test_numpy_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    17410 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    26682 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_overlap.py
+-rw-r--r--   0 james      (501) staff       (20)     3407 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_percentiles.py
+-rw-r--r--   0 james      (501) staff       (20)    15467 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_random.py
+-rw-r--r--   0 james      (501) staff       (20)    33636 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_rechunk.py
+-rw-r--r--   0 james      (501) staff       (20)    32720 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_reductions.py
+-rw-r--r--   0 james      (501) staff       (20)     7253 2022-08-08 20:45:08.000000 dask-2023.4.1/dask/array/tests/test_reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    83813 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_routines.py
+-rw-r--r--   0 james      (501) staff       (20)    32266 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_slicing.py
+-rw-r--r--   0 james      (501) staff       (20)     6556 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/tests/test_sparse.py
+-rw-r--r--   0 james      (501) staff       (20)     5453 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_stats.py
+-rw-r--r--   0 james      (501) staff       (20)     2704 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/array/tests/test_svg.py
+-rw-r--r--   0 james      (501) staff       (20)      489 2023-03-13 17:40:24.000000 dask-2023.4.1/dask/array/tests/test_testing.py
+-rw-r--r--   0 james      (501) staff       (20)    17354 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_ufunc.py
+-rw-r--r--   0 james      (501) staff       (20)     2670 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/tests/test_wrap.py
+-rw-r--r--   0 james      (501) staff       (20)     1281 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_xarray.py
+-rw-r--r--   0 james      (501) staff       (20)     4701 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/tiledb_io.py
+-rw-r--r--   0 james      (501) staff       (20)     9907 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/ufunc.py
+-rw-r--r--   0 james      (501) staff       (20)    18638 2023-03-03 18:04:26.000000 dask-2023.4.1/dask/array/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     6870 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/wrap.py
+-rw-r--r--   0 james      (501) staff       (20)     4909 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/backends.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.384143 dask-2023.4.1/dask/bag/
+-rw-r--r--   0 james      (501) staff       (20)      867 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bag/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     9075 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bag/avro.py
+-rw-r--r--   0 james      (501) staff       (20)      726 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/bag/chunk.py
+-rw-r--r--   0 james      (501) staff       (20)    84624 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/bag/core.py
+-rw-r--r--   0 james      (501) staff       (20)     5428 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bag/random.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.390413 dask-2023.4.1/dask/bag/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/bag/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     3772 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/bag/tests/test_avro.py
+-rw-r--r--   0 james      (501) staff       (20)    49657 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/bag/tests/test_bag.py
+-rw-r--r--   0 james      (501) staff       (20)     6492 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bag/tests/test_random.py
+-rw-r--r--   0 james      (501) staff       (20)     5013 2023-03-13 17:40:24.000000 dask-2023.4.1/dask/bag/tests/test_text.py
+-rw-r--r--   0 james      (501) staff       (20)     6729 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bag/text.py
+-rw-r--r--   0 james      (501) staff       (20)      204 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/bag/utils.py
+-rw-r--r--   0 james      (501) staff       (20)    52102 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/base.py
+-rw-r--r--   0 james      (501) staff       (20)    52987 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/blockwise.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.393371 dask-2023.4.1/dask/bytes/
+-rw-r--r--   0 james      (501) staff       (20)       39 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bytes/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     6897 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bytes/core.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.401112 dask-2023.4.1/dask/bytes/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/bytes/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     5122 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/bytes/tests/test_bytes_utils.py
+-rw-r--r--   0 james      (501) staff       (20)      494 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/bytes/tests/test_compression.py
+-rw-r--r--   0 james      (501) staff       (20)     6657 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/bytes/tests/test_http.py
+-rw-r--r--   0 james      (501) staff       (20)    11440 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/bytes/tests/test_local.py
+-rw-r--r--   0 james      (501) staff       (20)    19631 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/bytes/tests/test_s3.py
+-rw-r--r--   0 james      (501) staff       (20)      464 2021-11-11 20:27:17.000000 dask-2023.4.1/dask/bytes/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     1965 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/cache.py
+-rw-r--r--   0 james      (501) staff       (20)     4067 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/callbacks.py
+-rw-r--r--   0 james      (501) staff       (20)     3028 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/cli.py
+-rw-r--r--   0 james      (501) staff       (20)      487 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/compatibility.py
+-rw-r--r--   0 james      (501) staff       (20)    21645 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/config.py
+-rw-r--r--   0 james      (501) staff       (20)     1720 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/context.py
+-rw-r--r--   0 james      (501) staff       (20)    14797 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/core.py
+-rw-r--r--   0 james      (501) staff       (20)     6944 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dask-schema.yaml
+-rw-r--r--   0 james      (501) staff       (20)     1498 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dask.yaml
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.428717 dask-2023.4.1/dask/dataframe/
+-rw-r--r--   0 james      (501) staff       (20)     1776 2023-03-13 17:40:24.000000 dask-2023.4.1/dask/dataframe/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     6161 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/dataframe/_compat.py
+-rw-r--r--   0 james      (501) staff       (20)     2135 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/_dtypes.py
+-rw-r--r--   0 james      (501) staff       (20)     3183 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/_pyarrow.py
+-rw-r--r--   0 james      (501) staff       (20)     1900 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/_pyarrow_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    12101 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/accessor.py
+-rw-r--r--   0 james      (501) staff       (20)    24289 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/backends.py
+-rw-r--r--   0 james      (501) staff       (20)     9471 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/categorical.py
+-rw-r--r--   0 james      (501) staff       (20)   298004 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/dataframe/core.py
+-rw-r--r--   0 james      (501) staff       (20)     4437 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)      516 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dataframe/extensions.py
+-rw-r--r--   0 james      (501) staff       (20)   114078 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/dataframe/groupby.py
+-rw-r--r--   0 james      (501) staff       (20)     2427 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/dataframe/hyperloglog.py
+-rw-r--r--   0 james      (501) staff       (20)    13376 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/indexing.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.436326 dask-2023.4.1/dask/dataframe/io/
+-rw-r--r--   0 james      (501) staff       (20)      670 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    33618 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/csv.py
+-rw-r--r--   0 james      (501) staff       (20)     5745 2023-03-13 17:40:24.000000 dask-2023.4.1/dask/dataframe/io/demo.py
+-rw-r--r--   0 james      (501) staff       (20)    18043 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/hdf.py
+-rw-r--r--   0 james      (501) staff       (20)    38497 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/io.py
+-rw-r--r--   0 james      (501) staff       (20)    11127 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/json.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.440295 dask-2023.4.1/dask/dataframe/io/orc/
+-rw-r--r--   0 james      (501) staff       (20)       56 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dataframe/io/orc/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     4451 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/orc/arrow.py
+-rw-r--r--   0 james      (501) staff       (20)     7062 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/orc/core.py
+-rw-r--r--   0 james      (501) staff       (20)      473 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/orc/utils.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.447586 dask-2023.4.1/dask/dataframe/io/parquet/
+-rw-r--r--   0 james      (501) staff       (20)      130 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dataframe/io/parquet/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    71139 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/parquet/arrow.py
+-rw-r--r--   0 james      (501) staff       (20)    66556 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/parquet/core.py
+-rw-r--r--   0 james      (501) staff       (20)    52390 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/parquet/fastparquet.py
+-rw-r--r--   0 james      (501) staff       (20)    32860 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/parquet/utils.py
+-rw-r--r--   0 james      (501) staff       (20)    21072 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/sql.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.459095 dask-2023.4.1/dask/dataframe/io/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-03-07 20:03:52.000000 dask-2023.4.1/dask/dataframe/io/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    58831 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/tests/test_csv.py
+-rw-r--r--   0 james      (501) staff       (20)     5000 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/tests/test_demo.py
+-rw-r--r--   0 james      (501) staff       (20)    27186 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/tests/test_hdf.py
+-rw-r--r--   0 james      (501) staff       (20)    34402 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/tests/test_io.py
+-rw-r--r--   0 james      (501) staff       (20)     8589 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/tests/test_json.py
+-rw-r--r--   0 james      (501) staff       (20)     5202 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/tests/test_orc.py
+-rw-r--r--   0 james      (501) staff       (20)   164250 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/tests/test_parquet.py
+-rw-r--r--   0 james      (501) staff       (20)    17596 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/tests/test_sql.py
+-rw-r--r--   0 james      (501) staff       (20)     7863 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/utils.py
+-rw-r--r--   0 james      (501) staff       (20)    13807 2023-04-28 01:51:01.000000 dask-2023.4.1/dask/dataframe/methods.py
+-rw-r--r--   0 james      (501) staff       (20)    53848 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/multi.py
+-rw-r--r--   0 james      (501) staff       (20)     1564 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dataframe/numeric.py
+-rw-r--r--   0 james      (501) staff       (20)     8742 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/optimize.py
+-rw-r--r--   0 james      (501) staff       (20)    20008 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/partitionquantiles.py
+-rw-r--r--   0 james      (501) staff       (20)    11874 2023-04-28 16:31:39.000000 dask-2023.4.1/dask/dataframe/reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    22149 2023-04-28 16:31:39.000000 dask-2023.4.1/dask/dataframe/rolling.py
+-rw-r--r--   0 james      (501) staff       (20)    38047 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/shuffle.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.487825 dask-2023.4.1/dask/dataframe/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/dataframe/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    10597 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_accessors.py
+-rw-r--r--   0 james      (501) staff       (20)    64097 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/dataframe/tests/test_arithmetics_reduction.py
+-rw-r--r--   0 james      (501) staff       (20)      906 2022-08-08 20:45:08.000000 dask-2023.4.1/dask/dataframe/tests/test_boolean.py
+-rw-r--r--   0 james      (501) staff       (20)    16642 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/dataframe/tests/test_categorical.py
+-rw-r--r--   0 james      (501) staff       (20)   183446 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_dataframe.py
+-rw-r--r--   0 james      (501) staff       (20)     1420 2022-08-08 20:45:08.000000 dask-2023.4.1/dask/dataframe/tests/test_extensions.py
+-rw-r--r--   0 james      (501) staff       (20)    14707 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tests/test_format.py
+-rw-r--r--   0 james      (501) staff       (20)   118367 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/dataframe/tests/test_groupby.py
+-rw-r--r--   0 james      (501) staff       (20)     2666 2022-08-08 20:45:08.000000 dask-2023.4.1/dask/dataframe/tests/test_hashing.py
+-rw-r--r--   0 james      (501) staff       (20)     2861 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/dataframe/tests/test_hyperloglog.py
+-rw-r--r--   0 james      (501) staff       (20)    22346 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tests/test_indexing.py
+-rw-r--r--   0 james      (501) staff       (20)     6998 2022-12-14 03:22:05.000000 dask-2023.4.1/dask/dataframe/tests/test_merge_column_and_index.py
+-rw-r--r--   0 james      (501) staff       (20)    90981 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_multi.py
+-rw-r--r--   0 james      (501) staff       (20)     2084 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_numeric.py
+-rw-r--r--   0 james      (501) staff       (20)     1031 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dataframe/tests/test_optimize_dataframe.py
+-rw-r--r--   0 james      (501) staff       (20)     6626 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tests/test_pyarrow.py
+-rw-r--r--   0 james      (501) staff       (20)     4514 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tests/test_pyarrow_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    11535 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    17488 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tests/test_rolling.py
+-rw-r--r--   0 james      (501) staff       (20)    53350 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_shuffle.py
+-rw-r--r--   0 james      (501) staff       (20)    16559 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tests/test_ufunc.py
+-rw-r--r--   0 james      (501) staff       (20)    21243 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_utils_dataframe.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.489379 dask-2023.4.1/dask/dataframe/tseries/
+-rw-r--r--   0 james      (501) staff       (20)        0 2021-06-08 02:50:30.000000 dask-2023.4.1/dask/dataframe/tseries/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     7628 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dataframe/tseries/resample.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.490638 dask-2023.4.1/dask/dataframe/tseries/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/dataframe/tseries/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     6830 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tseries/tests/test_resample.py
+-rw-r--r--   0 james      (501) staff       (20)    26442 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     4901 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/datasets.py
+-rw-r--r--   0 james      (501) staff       (20)    24353 2023-03-13 17:40:25.000000 dask-2023.4.1/dask/delayed.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.494004 dask-2023.4.1/dask/diagnostics/
+-rw-r--r--   0 james      (501) staff       (20)      222 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/diagnostics/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    12100 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/diagnostics/profile.py
+-rw-r--r--   0 james      (501) staff       (20)    16296 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/diagnostics/profile_visualize.py
+-rw-r--r--   0 james      (501) staff       (20)     4965 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/diagnostics/progress.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.496053 dask-2023.4.1/dask/diagnostics/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/diagnostics/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    12009 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/diagnostics/tests/test_profiler.py
+-rw-r--r--   0 james      (501) staff       (20)     3352 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/diagnostics/tests/test_progress.py
+-rw-r--r--   0 james      (501) staff       (20)      679 2022-08-08 20:45:08.000000 dask-2023.4.1/dask/distributed.py
+-rw-r--r--   0 james      (501) staff       (20)    16587 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dot.py
+-rw-r--r--   0 james      (501) staff       (20)    19595 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/graph_manipulation.py
+-rw-r--r--   0 james      (501) staff       (20)     2456 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/hashing.py
+-rw-r--r--   0 james      (501) staff       (20)    34771 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/highlevelgraph.py
+-rw-r--r--   0 james      (501) staff       (20)    46007 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/layers.py
+-rw-r--r--   0 james      (501) staff       (20)    18888 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/local.py
+-rw-r--r--   0 james      (501) staff       (20)      450 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/ml.py
+-rw-r--r--   0 james      (501) staff       (20)     8466 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/multiprocessing.py
+-rw-r--r--   0 james      (501) staff       (20)    35602 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    45732 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/order.py
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/py.typed
+-rw-r--r--   0 james      (501) staff       (20)    12561 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/rewrite.py
+-rw-r--r--   0 james      (501) staff       (20)     7254 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/sizeof.py
+-rw-r--r--   0 james      (501) staff       (20)     1474 2023-03-13 17:40:25.000000 dask-2023.4.1/dask/system.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.533173 dask-2023.4.1/dask/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-03-07 20:04:31.000000 dask-2023.4.1/dask/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)      706 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_backends.py
+-rw-r--r--   0 james      (501) staff       (20)    51088 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_base.py
+-rw-r--r--   0 james      (501) staff       (20)     1577 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/tests/test_cache.py
+-rw-r--r--   0 james      (501) staff       (20)     2534 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/tests/test_callbacks.py
+-rw-r--r--   0 james      (501) staff       (20)     1163 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_ci.py
+-rw-r--r--   0 james      (501) staff       (20)     3230 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_cli.py
+-rw-r--r--   0 james      (501) staff       (20)      343 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_compatibility.py
+-rw-r--r--   0 james      (501) staff       (20)    17810 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_config.py
+-rw-r--r--   0 james      (501) staff       (20)     1101 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/tests/test_context.py
+-rw-r--r--   0 james      (501) staff       (20)     7386 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/tests/test_core.py
+-rw-r--r--   0 james      (501) staff       (20)     1076 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_datasets.py
+-rw-r--r--   0 james      (501) staff       (20)    22953 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_delayed.py
+-rw-r--r--   0 james      (501) staff       (20)    31257 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/tests/test_distributed.py
+-rw-r--r--   0 james      (501) staff       (20)      889 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_docs.py
+-rw-r--r--   0 james      (501) staff       (20)    12235 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_dot.py
+-rw-r--r--   0 james      (501) staff       (20)    14088 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/tests/test_graph_manipulation.py
+-rw-r--r--   0 james      (501) staff       (20)     1059 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/tests/test_hashing.py
+-rw-r--r--   0 james      (501) staff       (20)     7929 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_highgraph.py
+-rw-r--r--   0 james      (501) staff       (20)     9305 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_layers.py
+-rw-r--r--   0 james      (501) staff       (20)     4972 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/tests/test_local.py
+-rw-r--r--   0 james      (501) staff       (20)      382 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/tests/test_ml.py
+-rw-r--r--   0 james      (501) staff       (20)     8421 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/tests/test_multiprocessing.py
+-rw-r--r--   0 james      (501) staff       (20)    45191 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/tests/test_optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    28193 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/tests/test_order.py
+-rw-r--r--   0 james      (501) staff       (20)     4648 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/tests/test_rewrite.py
+-rw-r--r--   0 james      (501) staff       (20)     7482 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_sizeof.py
+-rw-r--r--   0 james      (501) staff       (20)     7118 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_spark_compat.py
+-rw-r--r--   0 james      (501) staff       (20)     1361 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/tests/test_system.py
+-rw-r--r--   0 james      (501) staff       (20)     4713 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_threaded.py
+-rw-r--r--   0 james      (501) staff       (20)     5670 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_typing.py
+-rw-r--r--   0 james      (501) staff       (20)    21288 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/tests/test_utils.py
+-rw-r--r--   0 james      (501) staff       (20)     1562 2023-04-11 17:13:14.000000 dask-2023.4.1/dask/tests/test_utils_test.py
+-rw-r--r--   0 james      (501) staff       (20)      175 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/warning_aliases.py
+-rw-r--r--   0 james      (501) staff       (20)     2993 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/threaded.py
+-rw-r--r--   0 james      (501) staff       (20)    14538 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/typing.py
+-rw-r--r--   0 james      (501) staff       (20)    55904 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     4825 2023-04-11 17:13:14.000000 dask-2023.4.1/dask/utils_test.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.536563 dask-2023.4.1/dask/widgets/
+-rw-r--r--   0 james      (501) staff       (20)      756 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/widgets/__init__.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.540894 dask-2023.4.1/dask/widgets/templates/
+-rw-r--r--   0 james      (501) staff       (20)     1295 2023-03-13 17:40:25.000000 dask-2023.4.1/dask/widgets/templates/array.html.j2
+-rw-r--r--   0 james      (501) staff       (20)      124 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/widgets/templates/dataframe.html.j2
+-rw-r--r--   0 james      (501) staff       (20)     2579 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/widgets/templates/highlevelgraph.html.j2
+-rw-r--r--   0 james      (501) staff       (20)     1981 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/widgets/templates/highlevelgraph_layer.html.j2
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.541859 dask-2023.4.1/dask/widgets/tests/
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.544802 dask-2023.4.1/dask/widgets/tests/templates/
+-rw-r--r--   0 james      (501) staff       (20)       38 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/widgets/tests/templates/bytes.html.j2
+-rw-r--r--   0 james      (501) staff       (20)       39 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/widgets/tests/templates/custom_filter.html.j2
+-rw-r--r--   0 james      (501) staff       (20)       30 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/widgets/tests/templates/example.html.j2
+-rw-r--r--   0 james      (501) staff       (20)     1365 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/widgets/tests/test_widgets.py
+-rw-r--r--   0 james      (501) staff       (20)     1084 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/widgets/widgets.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.281037 dask-2023.4.1/dask.egg-info/
+-rw-r--r--   0 james      (501) staff       (20)     2582 2023-04-28 17:30:05.000000 dask-2023.4.1/dask.egg-info/PKG-INFO
+-rw-r--r--   0 james      (501) staff       (20)    13902 2023-04-28 17:30:05.000000 dask-2023.4.1/dask.egg-info/SOURCES.txt
+-rw-r--r--   0 james      (501) staff       (20)        1 2023-04-28 17:30:05.000000 dask-2023.4.1/dask.egg-info/dependency_links.txt
+-rw-r--r--   0 james      (501) staff       (20)      124 2023-04-28 17:30:05.000000 dask-2023.4.1/dask.egg-info/entry_points.txt
+-rw-r--r--   0 james      (501) staff       (20)        1 2023-04-28 17:30:04.000000 dask-2023.4.1/dask.egg-info/not-zip-safe
+-rw-r--r--   0 james      (501) staff       (20)      443 2023-04-28 17:30:05.000000 dask-2023.4.1/dask.egg-info/requires.txt
+-rw-r--r--   0 james      (501) staff       (20)        5 2023-04-28 17:30:05.000000 dask-2023.4.1/dask.egg-info/top_level.txt
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.547610 dask-2023.4.1/docs/
+-rw-r--r--   0 james      (501) staff       (20)     5741 2023-03-22 19:03:53.000000 dask-2023.4.1/docs/Makefile
+-rw-r--r--   0 james      (501) staff       (20)     5186 2022-08-08 20:45:08.000000 dask-2023.4.1/docs/make.bat
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.693266 dask-2023.4.1/docs/source/
+-rw-r--r--   0 james      (501) staff       (20)    17598 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/10-minutes-to-dask.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.706699 dask-2023.4.1/docs/source/_static/
+-rw-r--r--   0 james      (501) staff       (20)    10187 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/_static/config_converter.js
+-rw-r--r--   0 james      (501) staff       (20)    11021 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/_static/dask-simple.png
+-rw-r--r--   0 james      (501) staff       (20)     2375 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/_static/main-page.css
+-rw-r--r--   0 james      (501) staff       (20)    15598 2022-08-08 20:45:08.000000 dask-2023.4.1/docs/source/_static/profile.html
+-rw-r--r--   0 james      (501) staff       (20)    65304 2022-08-08 20:45:08.000000 dask-2023.4.1/docs/source/_static/stacked_profile.html
+-rw-r--r--   0 james      (501) staff       (20)      523 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/_static/style.css
+-rw-r--r--   0 james      (501) staff       (20)      365 2021-06-16 20:41:28.000000 dask-2023.4.1/docs/source/_static/theme_overrides.css
+-rw-r--r--   0 james      (501) staff       (20)   292662 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/_static/transpose_cyto.html
+-rw-r--r--   0 james      (501) staff       (20)    49423 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/_static/yaml.min.js
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.708309 dask-2023.4.1/docs/source/_templates/
+-rw-r--r--   0 james      (501) staff       (20)      180 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/_templates/layout.html
+-rw-r--r--   0 james      (501) staff       (20)     2235 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/api.rst
+-rw-r--r--   0 james      (501) staff       (20)     6896 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/array-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     2943 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/array-assignment.rst
+-rw-r--r--   0 james      (501) staff       (20)     4740 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/array-best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)    13035 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array-chunks.rst
+-rw-r--r--   0 james      (501) staff       (20)    18437 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array-creation.rst
+-rw-r--r--   0 james      (501) staff       (20)     5885 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/array-design.rst
+-rw-r--r--   0 james      (501) staff       (20)     2857 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array-gufunc.rst
+-rw-r--r--   0 james      (501) staff       (20)     6069 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/array-overlap.rst
+-rw-r--r--   0 james      (501) staff       (20)     3411 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array-random.rst
+-rw-r--r--   0 james      (501) staff       (20)     4137 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/array-slicing.rst
+-rw-r--r--   0 james      (501) staff       (20)     3291 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array-sparse.rst
+-rw-r--r--   0 james      (501) staff       (20)     2018 2022-10-07 21:37:36.000000 dask-2023.4.1/docs/source/array-stack.rst
+-rw-r--r--   0 james      (501) staff       (20)     1140 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array-stats.rst
+-rw-r--r--   0 james      (501) staff       (20)     4121 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array.rst
+-rw-r--r--   0 james      (501) staff       (20)     1574 2022-08-08 20:45:08.000000 dask-2023.4.1/docs/source/bag-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     4557 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/bag-creation.rst
+-rw-r--r--   0 james      (501) staff       (20)     4068 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/bag.rst
+-rw-r--r--   0 james      (501) staff       (20)    14205 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)     5553 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/caching.rst
+-rw-r--r--   0 james      (501) staff       (20)   299276 2023-04-28 17:27:33.000000 dask-2023.4.1/docs/source/changelog.rst
+-rw-r--r--   0 james      (501) staff       (20)      211 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/cheatsheet.rst
+-rw-r--r--   0 james      (501) staff       (20)     4047 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/cli.rst
+-rw-r--r--   0 james      (501) staff       (20)    15465 2023-03-13 20:41:19.000000 dask-2023.4.1/docs/source/conf.py
+-rw-r--r--   0 james      (501) staff       (20)    16654 2023-04-06 21:35:01.000000 dask-2023.4.1/docs/source/configuration.rst
+-rw-r--r--   0 james      (501) staff       (20)    18651 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/custom-collections.rst
+-rw-r--r--   0 james      (501) staff       (20)     3604 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/custom-graphs.rst
+-rw-r--r--   0 james      (501) staff       (20)      896 2023-03-20 18:17:18.000000 dask-2023.4.1/docs/source/dashboard-progress-script.py
+-rw-r--r--   0 james      (501) staff       (20)    15045 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/dashboard.rst
+-rw-r--r--   0 james      (501) staff       (20)   203552 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/daskcheatsheet.pdf
+-rw-r--r--   0 james      (501) staff       (20)    11702 2023-04-28 16:31:41.000000 dask-2023.4.1/docs/source/dataframe-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     9611 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/dataframe-best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)     3951 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/dataframe-categoricals.rst
+-rw-r--r--   0 james      (501) staff       (20)     5967 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/dataframe-create.rst
+-rw-r--r--   0 james      (501) staff       (20)     5002 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/dataframe-design.rst
+-rw-r--r--   0 james      (501) staff       (20)     6224 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/dataframe-extend.rst
+-rw-r--r--   0 james      (501) staff       (20)     8050 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/dataframe-groupby.rst
+-rw-r--r--   0 james      (501) staff       (20)     6115 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/dataframe-indexing.rst
+-rw-r--r--   0 james      (501) staff       (20)     3454 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/dataframe-joins.rst
+-rw-r--r--   0 james      (501) staff       (20)    10952 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/dataframe-parquet.rst
+-rw-r--r--   0 james      (501) staff       (20)    12661 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/dataframe-sql.rst
+-rw-r--r--   0 james      (501) staff       (20)     7772 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/dataframe.rst
+-rw-r--r--   0 james      (501) staff       (20)      363 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/debugging-performance.rst
+-rw-r--r--   0 james      (501) staff       (20)     1696 2022-08-08 20:45:08.000000 dask-2023.4.1/docs/source/delayed-api.rst
+-rw-r--r--   0 james      (501) staff       (20)    17616 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/delayed-best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)     1497 2022-10-07 21:37:36.000000 dask-2023.4.1/docs/source/delayed-collections.rst
+-rw-r--r--   0 james      (501) staff       (20)     6357 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/delayed.rst
+-rw-r--r--   0 james      (501) staff       (20)     3620 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/deploying-cli.rst
+-rw-r--r--   0 james      (501) staff       (20)     2965 2023-04-28 16:31:41.000000 dask-2023.4.1/docs/source/deploying-cloud.rst
+-rw-r--r--   0 james      (501) staff       (20)     2868 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/deploying-docker.rst
+-rw-r--r--   0 james      (501) staff       (20)     9939 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/deploying-hpc.rst
+-rw-r--r--   0 james      (501) staff       (20)     4001 2023-04-28 16:31:41.000000 dask-2023.4.1/docs/source/deploying-kubernetes.rst
+-rw-r--r--   0 james      (501) staff       (20)     5823 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/deploying-python-advanced.rst
+-rw-r--r--   0 james      (501) staff       (20)     2839 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/deploying-python.rst
+-rw-r--r--   0 james      (501) staff       (20)     1619 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/deploying-ssh.rst
+-rw-r--r--   0 james      (501) staff       (20)     7266 2023-04-28 16:31:41.000000 dask-2023.4.1/docs/source/deploying.rst
+-rw-r--r--   0 james      (501) staff       (20)    10758 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/deployment-considerations.rst
+-rw-r--r--   0 james      (501) staff       (20)    13142 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/develop.rst
+-rw-r--r--   0 james      (501) staff       (20)     4442 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/diagnostics-distributed.rst
+-rw-r--r--   0 james      (501) staff       (20)    10407 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/diagnostics-local.rst
+-rw-r--r--   0 james      (501) staff       (20)     4323 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/ecosystem.rst
+-rw-r--r--   0 james      (501) staff       (20)    19964 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/faq.rst
+-rw-r--r--   0 james      (501) staff       (20)    26361 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/futures.rst
+-rw-r--r--   0 james      (501) staff       (20)     5820 2022-10-07 21:37:14.000000 dask-2023.4.1/docs/source/gpu.rst
+-rw-r--r--   0 james      (501) staff       (20)     2541 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/graph_manipulation.rst
+-rw-r--r--   0 james      (501) staff       (20)     5433 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/graphs.rst
+-rw-r--r--   0 james      (501) staff       (20)     5399 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/graphviz.rst
+-rw-r--r--   0 james      (501) staff       (20)     6946 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/high-level-graphs.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.718702 dask-2023.4.1/docs/source/how-to/
+-rw-r--r--   0 james      (501) staff       (20)     4364 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/how-to/adaptive.rst
+-rw-r--r--   0 james      (501) staff       (20)    15360 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/how-to/connect-to-remote-data.rst
+-rw-r--r--   0 james      (501) staff       (20)     4209 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/how-to/customize-initialization.rst
+-rw-r--r--   0 james      (501) staff       (20)    10859 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/how-to/debug.rst
+-rw-r--r--   0 james      (501) staff       (20)     1722 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/how-to/extend-sizeof.rst
+-rw-r--r--   0 james      (501) staff       (20)      433 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/how-to/index.rst
+-rw-r--r--   0 james      (501) staff       (20)     4562 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/how-to/manage-environments.rst
+-rw-r--r--   0 james      (501) staff       (20)     6680 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/how-to/selecting-the-collection-backend.rst
+-rw-r--r--   0 james      (501) staff       (20)      902 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/how-to/setup-prometheus.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.890376 dask-2023.4.1/docs/source/images/
+-rw-r--r--   0 james      (501) staff       (20)    99565 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/10_minutes_array_graph.png
+-rw-r--r--   0 james      (501) staff       (20)    22442 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/10_minutes_bag_graph.png
+-rw-r--r--   0 james      (501) staff       (20)    56229 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/10_minutes_dataframe_graph.png
+-rw-r--r--   0 james      (501) staff       (20)     4059 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/HHMI_Janelia_Color.png
+-rw-r--r--   0 james      (501) staff       (20)    18406 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/array.svg
+-rw-r--r--   0 james      (501) staff       (20)  1620104 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/async-embarrassing.gif
+-rw-r--r--   0 james      (501) staff       (20)    10752 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/concurrent-futures-threaded.webp
+-rw-r--r--   0 james      (501) staff       (20)   135129 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/crosstalk.svg
+-rw-r--r--   0 james      (501) staff       (20)  2367087 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dashboard_jupyterlab.png
+-rw-r--r--   0 james      (501) staff       (20)    37971 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dashboard_link.png
+-rw-r--r--   0 james      (501) staff       (20)    68712 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dashboard_memory.png
+-rw-r--r--   0 james      (501) staff       (20)   281018 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/images/dashboard_memory_new.gif
+-rw-r--r--   0 james      (501) staff       (20)    25435 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/images/dashboard_progress.png
+-rw-r--r--   0 james      (501) staff       (20)   276928 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/images/dashboard_status.png
+-rw-r--r--   0 james      (501) staff       (20)    12009 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/images/dashboard_task_processing.png
+-rw-r--r--   0 james      (501) staff       (20)    58238 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dashboard_task_stream_unhealthy.png
+-rw-r--r--   0 james      (501) staff       (20)   103654 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dashboard_taskstream_healthy.png
+-rw-r--r--   0 james      (501) staff       (20)   112822 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/dask-adaptive.svg
+-rw-r--r--   0 james      (501) staff       (20)    14645 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/dask-array.svg
+-rw-r--r--   0 james      (501) staff       (20)   222084 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/dask-cluster-manager.svg
+-rw-r--r--   0 james      (501) staff       (20)    18782 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/dask-dataframe.svg
+-rw-r--r--   0 james      (501) staff       (20)   381903 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask-overview-distributed-callout.svg
+-rw-r--r--   0 james      (501) staff       (20)   357643 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask-overview-schedulers.svg
+-rw-r--r--   0 james      (501) staff       (20)    97471 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/dask-overview.svg
+-rw-r--r--   0 james      (501) staff       (20)     3022 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_horizontal.svg
+-rw-r--r--   0 james      (501) staff       (20)     3651 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_horizontal_black.svg
+-rw-r--r--   0 james      (501) staff       (20)     3767 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_horizontal_on_blue.svg
+-rw-r--r--   0 james      (501) staff       (20)     3738 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_horizontal_on_pink.svg
+-rw-r--r--   0 james      (501) staff       (20)     3738 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_horizontal_white.svg
+-rw-r--r--   0 james      (501) staff       (20)     1607 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_icon.svg
+-rw-r--r--   0 james      (501) staff       (20)     1571 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_icon_black.svg
+-rw-r--r--   0 james      (501) staff       (20)     1607 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_icon_on_pink.svg
+-rw-r--r--   0 james      (501) staff       (20)     1609 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_icon_white.svg
+-rw-r--r--   0 james      (501) staff       (20)    20216 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/delayed-inc-double-add.svg
+-rw-r--r--   0 james      (501) staff       (20)   104628 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/distributed-overview.svg
+-rw-r--r--   0 james      (501) staff       (20)    18297 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/frame-shuffle.svg
+-rw-r--r--   0 james      (501) staff       (20)    22979 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/frame-sort.svg
+-rw-r--r--   0 james      (501) staff       (20)    12181 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/frame.svg
+-rw-r--r--   0 james      (501) staff       (20)    41828 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/gputester-msg.png
+-rw-r--r--   0 james      (501) staff       (20)   210392 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/growth_of_languages.png
+-rw-r--r--   0 james      (501) staff       (20)   167834 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/growth_of_libraries.png
+-rw-r--r--   0 james      (501) staff       (20)     4097 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/inc-add.svg
+-rw-r--r--   0 james      (501) staff       (20)   123010 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/map-reduce-task-scheduling.svg
+-rw-r--r--   0 james      (501) staff       (20)   482302 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/map_blocks_drop_axis.png
+-rw-r--r--   0 james      (501) staff       (20)   113067 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/merge_chunks.png
+-rw-r--r--   0 james      (501) staff       (20)    63244 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/merge_chunks_false.png
+-rw-r--r--   0 james      (501) staff       (20)    13024 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/optimize_dask1.svg
+-rw-r--r--   0 james      (501) staff       (20)     8803 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/optimize_dask2.svg
+-rw-r--r--   0 james      (501) staff       (20)     5198 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/optimize_dask3.svg
+-rw-r--r--   0 james      (501) staff       (20)     4104 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/optimize_dask4.svg
+-rw-r--r--   0 james      (501) staff       (20)     2738 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/optimize_dask5.svg
+-rw-r--r--   0 james      (501) staff       (20)   292827 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/order-failure.png
+-rw-r--r--   0 james      (501) staff       (20)   239828 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/order-success.png
+-rw-r--r--   0 james      (501) staff       (20)    40833 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/overlap.svg
+-rw-r--r--   0 james      (501) staff       (20)    18785 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/overlapping-blocks.svg
+-rw-r--r--   0 james      (501) staff       (20)     4537 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/overlapping-neighbors.svg
+-rw-r--r--   0 james      (501) staff       (20)    20533 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/pipeline.svg
+-rw-r--r--   0 james      (501) staff       (20)    31576 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/reshape.png
+-rw-r--r--   0 james      (501) staff       (20)    31410 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/reshape_problem.png
+-rw-r--r--   0 james      (501) staff       (20)    33288 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/reshape_rechunked.png
+-rw-r--r--   0 james      (501) staff       (20)    50209 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/scaling-edges.png
+-rw-r--r--   0 james      (501) staff       (20)    68476 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/scaling-nodes.png
+-rw-r--r--   0 james      (501) staff       (20)    21294 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/simple-dask.png
+-rw-r--r--   0 james      (501) staff       (20)    27572 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/transpose-hlg-hovertooltip.png
+-rw-r--r--   0 james      (501) staff       (20)    84492 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/transpose-hlg-html-repr.png
+-rw-r--r--   0 james      (501) staff       (20)    39365 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/transpose.svg
+-rw-r--r--   0 james      (501) staff       (20)    22446 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/transpose_opt.svg
+-rw-r--r--   0 james      (501) staff       (20)   115022 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/trivial.svg
+-rw-r--r--   0 james      (501) staff       (20)     2451 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/unoverlapping-neighbors.svg
+-rw-r--r--   0 james      (501) staff       (20)     6237 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/index.rst
+-rw-r--r--   0 james      (501) staff       (20)    15235 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/install.rst
+-rw-r--r--   0 james      (501) staff       (20)      341 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/internals.rst
+-rw-r--r--   0 james      (501) staff       (20)      868 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/logos.rst
+-rw-r--r--   0 james      (501) staff       (20)     3573 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/maintainers.rst
+-rw-r--r--   0 james      (501) staff       (20)    12200 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/optimize.rst
+-rw-r--r--   0 james      (501) staff       (20)     7119 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/order.rst
+-rw-r--r--   0 james      (501) staff       (20)     4810 2022-10-07 21:37:14.000000 dask-2023.4.1/docs/source/phases-of-computation.rst
+-rw-r--r--   0 james      (501) staff       (20)     5089 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/presentations.rst
+-rw-r--r--   0 james      (501) staff       (20)     6010 2022-10-07 21:37:14.000000 dask-2023.4.1/docs/source/scheduler-overview.rst
+-rw-r--r--   0 james      (501) staff       (20)     4493 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/scheduling-policy.rst
+-rw-r--r--   0 james      (501) staff       (20)    11014 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/scheduling.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.891276 dask-2023.4.1/docs/source/scripts/
+-rw-r--r--   0 james      (501) staff       (20)     3258 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/scripts/scheduling.py
+-rw-r--r--   0 james      (501) staff       (20)     6104 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/shared.rst
+-rw-r--r--   0 james      (501) staff       (20)     9342 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/spark.rst
+-rw-r--r--   0 james      (501) staff       (20)     3966 2022-10-07 21:37:14.000000 dask-2023.4.1/docs/source/spec.rst
+-rw-r--r--   0 james      (501) staff       (20)     4608 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/support.rst
+-rw-r--r--   0 james      (501) staff       (20)     1831 2021-06-16 20:41:28.000000 dask-2023.4.1/docs/source/understanding-performance.rst
+-rw-r--r--   0 james      (501) staff       (20)    12205 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/user-interfaces.rst
+-rw-r--r--   0 james      (501) staff       (20)    11744 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/why.rst
+-rw-r--r--   0 james      (501) staff       (20)     5500 2023-04-28 17:21:18.000000 dask-2023.4.1/pyproject.toml
+-rw-r--r--   0 james      (501) staff       (20)       38 2023-04-28 17:30:05.893028 dask-2023.4.1/setup.cfg
+-rwxr-xr-x   0 james      (501) staff       (20)      194 2023-04-26 17:05:49.000000 dask-2023.4.1/setup.py
```

### Comparing `dask-2023.4.0/LICENSE.txt` & `dask-2023.4.1/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/PKG-INFO` & `dask-2023.4.1/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dask
-Version: 2023.4.0
+Version: 2023.4.1
 Summary: Parallel PyData with Task Scheduling
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD
 Project-URL: Homepage, https://github.com/dask/dask/
 Keywords: task-scheduling parallel numpy pandas pydata
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
```

### Comparing `dask-2023.4.0/README.rst` & `dask-2023.4.1/README.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/conftest.py` & `dask-2023.4.1/conftest.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/_compatibility.py` & `dask-2023.4.1/dask/_compatibility.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/NUMPY_LICENSE.txt` & `dask-2023.4.1/dask/array/NUMPY_LICENSE.txt`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/__init__.py` & `dask-2023.4.1/dask/array/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/backends.py` & `dask-2023.4.1/dask/array/backends.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/blockwise.py` & `dask-2023.4.1/dask/array/blockwise.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/chunk.py` & `dask-2023.4.1/dask/array/chunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/chunk_types.py` & `dask-2023.4.1/dask/array/chunk_types.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/core.py` & `dask-2023.4.1/dask/array/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/creation.py` & `dask-2023.4.1/dask/array/creation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/cupy_entry_point.py` & `dask-2023.4.1/dask/array/cupy_entry_point.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/einsumfuncs.py` & `dask-2023.4.1/dask/array/einsumfuncs.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/fft.py` & `dask-2023.4.1/dask/array/fft.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/gufunc.py` & `dask-2023.4.1/dask/array/gufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/image.py` & `dask-2023.4.1/dask/array/image.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/linalg.py` & `dask-2023.4.1/dask/array/linalg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/ma.py` & `dask-2023.4.1/dask/array/ma.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/numpy_compat.py` & `dask-2023.4.1/dask/array/numpy_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/optimization.py` & `dask-2023.4.1/dask/array/optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/overlap.py` & `dask-2023.4.1/dask/array/overlap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/percentile.py` & `dask-2023.4.1/dask/array/percentile.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/random.py` & `dask-2023.4.1/dask/array/random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/rechunk.py` & `dask-2023.4.1/dask/array/rechunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/reductions.py` & `dask-2023.4.1/dask/array/reductions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/reshape.py` & `dask-2023.4.1/dask/array/reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/routines.py` & `dask-2023.4.1/dask/array/routines.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/slicing.py` & `dask-2023.4.1/dask/array/slicing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/stats.py` & `dask-2023.4.1/dask/array/stats.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/svg.py` & `dask-2023.4.1/dask/array/svg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_array_core.py` & `dask-2023.4.1/dask/array/tests/test_array_core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_array_function.py` & `dask-2023.4.1/dask/array/tests/test_array_function.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_array_utils.py` & `dask-2023.4.1/dask/array/tests/test_array_utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_atop.py` & `dask-2023.4.1/dask/array/tests/test_atop.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_chunk.py` & `dask-2023.4.1/dask/array/tests/test_chunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_creation.py` & `dask-2023.4.1/dask/array/tests/test_creation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_cupy_core.py` & `dask-2023.4.1/dask/array/tests/test_cupy_core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_cupy_creation.py` & `dask-2023.4.1/dask/array/tests/test_cupy_creation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_cupy_gufunc.py` & `dask-2023.4.1/dask/array/tests/test_cupy_gufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_cupy_linalg.py` & `dask-2023.4.1/dask/array/tests/test_cupy_linalg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_cupy_overlap.py` & `dask-2023.4.1/dask/array/tests/test_cupy_overlap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_cupy_percentile.py` & `dask-2023.4.1/dask/array/tests/test_cupy_percentile.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_cupy_random.py` & `dask-2023.4.1/dask/array/tests/test_cupy_random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_cupy_reductions.py` & `dask-2023.4.1/dask/array/tests/test_cupy_reductions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_cupy_routines.py` & `dask-2023.4.1/dask/array/tests/test_cupy_routines.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_cupy_slicing.py` & `dask-2023.4.1/dask/array/tests/test_cupy_slicing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_cupy_sparse.py` & `dask-2023.4.1/dask/array/tests/test_cupy_sparse.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_dispatch.py` & `dask-2023.4.1/dask/array/tests/test_dispatch.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_fft.py` & `dask-2023.4.1/dask/array/tests/test_fft.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_gufunc.py` & `dask-2023.4.1/dask/array/tests/test_gufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_image.py` & `dask-2023.4.1/dask/array/tests/test_image.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_linalg.py` & `dask-2023.4.1/dask/array/tests/test_linalg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_masked.py` & `dask-2023.4.1/dask/array/tests/test_masked.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_numpy_compat.py` & `dask-2023.4.1/dask/array/tests/test_numpy_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_optimization.py` & `dask-2023.4.1/dask/array/tests/test_optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_overlap.py` & `dask-2023.4.1/dask/array/tests/test_overlap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_percentiles.py` & `dask-2023.4.1/dask/array/tests/test_percentiles.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_random.py` & `dask-2023.4.1/dask/array/tests/test_random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_rechunk.py` & `dask-2023.4.1/dask/array/tests/test_rechunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_reductions.py` & `dask-2023.4.1/dask/array/tests/test_reductions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_reshape.py` & `dask-2023.4.1/dask/array/tests/test_reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_routines.py` & `dask-2023.4.1/dask/array/tests/test_routines.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_slicing.py` & `dask-2023.4.1/dask/array/tests/test_slicing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_sparse.py` & `dask-2023.4.1/dask/array/tests/test_sparse.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_stats.py` & `dask-2023.4.1/dask/array/tests/test_stats.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_svg.py` & `dask-2023.4.1/dask/array/tests/test_svg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_ufunc.py` & `dask-2023.4.1/dask/array/tests/test_ufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_wrap.py` & `dask-2023.4.1/dask/array/tests/test_wrap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tests/test_xarray.py` & `dask-2023.4.1/dask/array/tests/test_xarray.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/tiledb_io.py` & `dask-2023.4.1/dask/array/tiledb_io.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/ufunc.py` & `dask-2023.4.1/dask/array/ufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/utils.py` & `dask-2023.4.1/dask/array/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/array/wrap.py` & `dask-2023.4.1/dask/array/wrap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/backends.py` & `dask-2023.4.1/dask/backends.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bag/__init__.py` & `dask-2023.4.1/dask/bag/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bag/avro.py` & `dask-2023.4.1/dask/bag/avro.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bag/chunk.py` & `dask-2023.4.1/dask/bag/chunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bag/core.py` & `dask-2023.4.1/dask/bag/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bag/random.py` & `dask-2023.4.1/dask/bag/random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bag/tests/test_avro.py` & `dask-2023.4.1/dask/bag/tests/test_avro.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bag/tests/test_bag.py` & `dask-2023.4.1/dask/bag/tests/test_bag.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bag/tests/test_random.py` & `dask-2023.4.1/dask/bag/tests/test_random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bag/tests/test_text.py` & `dask-2023.4.1/dask/bag/tests/test_text.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bag/text.py` & `dask-2023.4.1/dask/bag/text.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/base.py` & `dask-2023.4.1/dask/base.py`

 * *Files 0% similar despite different names*

```diff
@@ -224,15 +224,15 @@
         Returns
         -------
         result : IPython.diplay.Image, IPython.display.SVG, or None
             See dask.dot.dot_graph for more information.
 
         See Also
         --------
-        dask.base.visualize
+        dask.visualize
         dask.dot.dot_graph
 
         Notes
         -----
         For more information on optimization see here:
 
         https://docs.dask.org/en/latest/optimize.html
@@ -278,15 +278,15 @@
 
         Returns
         -------
         New dask collections backed by in-memory data
 
         See Also
         --------
-        dask.base.persist
+        dask.persist
         """
         (result,) = persist(self, traverse=False, **kwargs)
         return result
 
     def compute(self, **kwargs):
         """Compute this dask collection
 
@@ -305,15 +305,15 @@
             If True [default], the graph is optimized before computation.
             Otherwise the graph is run as is. This can be useful for debugging.
         kwargs
             Extra keywords to forward to the scheduler function.
 
         See Also
         --------
-        dask.base.compute
+        dask.compute
         """
         (result,) = compute(self, traverse=False, **kwargs)
         return result
 
     def __await__(self):
         try:
             from distributed import futures_of, wait
@@ -1353,17 +1353,17 @@
             return scheduler
         elif "Client" in type(scheduler).__name__ and hasattr(scheduler, "get"):
             return scheduler.get
         elif isinstance(scheduler, str):
             scheduler = scheduler.lower()
 
             try:
-                from distributed import default_client
+                from distributed import Client
 
-                default_client()
+                Client.current(allow_global=True)
                 client_available = True
             except (ImportError, ValueError):
                 client_available = False
             if scheduler in named_schedulers:
                 if client_available:
                     warnings.warn(
                         "Running on a single-machine scheduler when a distributed client "
```

### Comparing `dask-2023.4.0/dask/blockwise.py` & `dask-2023.4.1/dask/blockwise.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bytes/core.py` & `dask-2023.4.1/dask/bytes/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bytes/tests/test_bytes_utils.py` & `dask-2023.4.1/dask/bytes/tests/test_bytes_utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bytes/tests/test_http.py` & `dask-2023.4.1/dask/bytes/tests/test_http.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bytes/tests/test_local.py` & `dask-2023.4.1/dask/bytes/tests/test_local.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/bytes/tests/test_s3.py` & `dask-2023.4.1/dask/bytes/tests/test_s3.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/cache.py` & `dask-2023.4.1/dask/cache.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/callbacks.py` & `dask-2023.4.1/dask/callbacks.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/cli.py` & `dask-2023.4.1/dask/cli.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/config.py` & `dask-2023.4.1/dask/config.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/context.py` & `dask-2023.4.1/dask/context.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/core.py` & `dask-2023.4.1/dask/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dask-schema.yaml` & `dask-2023.4.1/dask/dask-schema.yaml`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dask.yaml` & `dask-2023.4.1/dask/dask.yaml`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/__init__.py` & `dask-2023.4.1/dask/dataframe/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/_compat.py` & `dask-2023.4.1/dask/dataframe/_compat.py`

 * *Files 6% similar despite different names*

```diff
@@ -8,26 +8,27 @@
 
 PANDAS_VERSION = Version(pd.__version__)
 PANDAS_GT_131 = PANDAS_VERSION >= Version("1.3.1")
 PANDAS_GT_133 = PANDAS_VERSION >= Version("1.3.3")
 PANDAS_GT_140 = PANDAS_VERSION >= Version("1.4.0")
 PANDAS_GT_150 = PANDAS_VERSION >= Version("1.5.0")
 PANDAS_GT_200 = PANDAS_VERSION.major >= 2
+PANDAS_GT_201 = PANDAS_VERSION.release >= (2, 0, 1)
 PANDAS_GT_210 = PANDAS_VERSION.release >= (2, 1, 0)
 
 import pandas.testing as tm
 
 
 def assert_categorical_equal(left, right, *args, **kwargs):
     tm.assert_extension_array_equal(left, right, *args, **kwargs)
-    assert pd.api.types.is_categorical_dtype(
-        left.dtype
+    assert isinstance(
+        left.dtype, pd.CategoricalDtype
     ), f"{left} is not categorical dtype"
-    assert pd.api.types.is_categorical_dtype(
-        right.dtype
+    assert isinstance(
+        right.dtype, pd.CategoricalDtype
     ), f"{right} is not categorical dtype"
 
 
 def assert_numpy_array_equal(left, right):
     left_na = pd.isna(left)
     right_na = pd.isna(right)
     np.testing.assert_array_equal(left_na, right_na)
@@ -77,23 +78,34 @@
             "D": pd.date_range("2009-01-01", periods=5),
         }
     )
     return df
 
 
 @contextlib.contextmanager
-def check_numeric_only_deprecation():
-    if PANDAS_GT_150 and not PANDAS_GT_200:
+def check_numeric_only_deprecation(name=None, show_nuisance_warning: bool = False):
+    supported_funcs = ["sum"]
+    if name not in supported_funcs and PANDAS_GT_150 and not PANDAS_GT_200:
         with warnings.catch_warnings():
             warnings.filterwarnings(
                 "ignore",
                 message="The default value of numeric_only",
                 category=FutureWarning,
             )
             yield
+    elif (
+        not show_nuisance_warning and name not in supported_funcs and not PANDAS_GT_150
+    ):
+        with warnings.catch_warnings():
+            warnings.filterwarnings(
+                "ignore",
+                message="Dropping of nuisance columns in DataFrame",
+                category=FutureWarning,
+            )
+            yield
     else:
         yield
 
 
 @contextlib.contextmanager
 def check_nuisance_columns_warning():
     if not PANDAS_GT_150:
```

### Comparing `dask-2023.4.0/dask/dataframe/_pyarrow.py` & `dask-2023.4.1/dask/dataframe/_pyarrow.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/_pyarrow_compat.py` & `dask-2023.4.1/dask/dataframe/_pyarrow_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/accessor.py` & `dask-2023.4.1/dask/dataframe/accessor.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/backends.py` & `dask-2023.4.1/dask/dataframe/backends.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,23 +1,15 @@
 from __future__ import annotations
 
 import warnings
 from typing import Iterable
 
 import numpy as np
 import pandas as pd
-from pandas.api.types import (
-    is_categorical_dtype,
-    is_datetime64tz_dtype,
-    is_interval_dtype,
-    is_period_dtype,
-    is_scalar,
-    is_sparse,
-    union_categoricals,
-)
+from pandas.api.types import is_scalar, union_categoricals
 
 from dask.array.core import Array
 from dask.array.dispatch import percentile_lookup
 from dask.array.percentile import _percentile
 from dask.backends import CreationDispatch, DaskBackendEntrypoint
 from dask.dataframe._compat import is_any_real_numeric_dtype
 from dask.dataframe.core import DataFrame, Index, Scalar, Series, _Frame
@@ -329,22 +321,14 @@
 @meta_nonempty.register(pd.Index)
 def _nonempty_index(idx):
     typ = type(idx)
     if typ is pd.RangeIndex:
         return pd.RangeIndex(2, name=idx.name, dtype=idx.dtype)
     elif is_any_real_numeric_dtype(idx):
         return typ([1, 2], name=idx.name, dtype=idx.dtype)
-    elif typ is pd.Index:
-        if idx.dtype == bool:
-            # pd 1.5 introduce bool dtypes and respect non-uniqueness
-            return pd.Index([True, False], name=idx.name)
-        else:
-            # for pd 1.5 in the case of bool index this would be cast as [True, True]
-            # breaking uniqueness
-            return pd.Index(["a", "b"], name=idx.name, dtype=idx.dtype)
     elif typ is pd.DatetimeIndex:
         start = "1970-01-01"
         # Need a non-monotonic decreasing index to avoid issues with
         # partial string indexing see https://github.com/dask/dask/issues/2389
         # and https://github.com/pandas-dev/pandas/issues/16515
         # This doesn't mean `_meta_nonempty` should ever rely on
         # `self.monotonic_increasing` or `self.monotonic_decreasing`
@@ -384,50 +368,62 @@
     elif typ is pd.MultiIndex:
         levels = [_nonempty_index(l) for l in idx.levels]
         codes = [[0, 0] for i in idx.levels]
         try:
             return pd.MultiIndex(levels=levels, codes=codes, names=idx.names)
         except TypeError:  # older pandas versions
             return pd.MultiIndex(levels=levels, labels=codes, names=idx.names)
+    elif typ is pd.Index:
+        if type(idx.dtype) in make_array_nonempty._lookup:
+            return pd.Index(
+                make_array_nonempty(idx.dtype), dtype=idx.dtype, name=idx.name
+            )
+        elif idx.dtype == bool:
+            # pd 1.5 introduce bool dtypes and respect non-uniqueness
+            return pd.Index([True, False], name=idx.name)
+        else:
+            # for pd 1.5 in the case of bool index this would be cast as [True, True]
+            # breaking uniqueness
+            return pd.Index(["a", "b"], name=idx.name, dtype=idx.dtype)
 
     raise TypeError(f"Don't know how to handle index of type {typename(type(idx))}")
 
 
 @meta_nonempty.register(pd.Series)
 def _nonempty_series(s, idx=None):
     # TODO: Use register dtypes with make_array_nonempty
     if idx is None:
         idx = _nonempty_index(s.index)
     dtype = s.dtype
     if len(s) > 0:
         # use value from meta if provided
         data = [s.iloc[0]] * 2
-    elif is_datetime64tz_dtype(dtype):
+    elif isinstance(dtype, pd.DatetimeTZDtype):
         entry = pd.Timestamp("1970-01-01", tz=dtype.tz)
         data = [entry, entry]
-    elif is_categorical_dtype(dtype):
+    elif isinstance(dtype, pd.CategoricalDtype):
         if len(s.cat.categories):
             data = [s.cat.categories[0]] * 2
             cats = s.cat.categories
         else:
             data = _nonempty_index(s.cat.categories)
             cats = s.cat.categories[:0]
         data = pd.Categorical(data, categories=cats, ordered=s.cat.ordered)
     elif is_integer_na_dtype(dtype):
         data = pd.array([1, None], dtype=dtype)
     elif is_float_na_dtype(dtype):
         data = pd.array([1.0, None], dtype=dtype)
-    elif is_period_dtype(dtype):
+    elif isinstance(dtype, pd.PeriodDtype):
         # pandas 0.24.0+ should infer this to be Series[Period[freq]]
         freq = dtype.freq
         data = [pd.Period("2000", freq), pd.Period("2001", freq)]
-    elif is_sparse(dtype):
+    elif isinstance(dtype, pd.SparseDtype):
         entry = _scalar_from_dtype(dtype.subtype)
         data = pd.array([entry, entry], dtype=dtype)
-    elif is_interval_dtype(dtype):
+    elif isinstance(dtype, pd.IntervalDtype):
         entry = _scalar_from_dtype(dtype.subtype)
         data = pd.array([entry, entry], dtype=dtype)
     elif type(dtype) in make_array_nonempty._lookup:
         data = make_array_nonempty(dtype)
     else:
         entry = _scalar_from_dtype(dtype)
         data = np.array([entry, entry], dtype=dtype)
@@ -650,15 +646,15 @@
             # pandas may raise a RuntimeWarning for comparing ints and strs
             with warnings.catch_warnings():
                 warnings.simplefilter("ignore", RuntimeWarning)
                 if filter_warning:
                     warnings.simplefilter("ignore", FutureWarning)
                 out = pd.concat(dfs3, join=join, sort=False)
     else:
-        if is_categorical_dtype(dfs2[0].dtype):
+        if isinstance(dfs2[0].dtype, pd.CategoricalDtype):
             if ind is None:
                 ind = concat([df.index for df in dfs2])
             return pd.Series(
                 union_categoricals(dfs2, ignore_order=ignore_order),
                 index=ind,
                 name=dfs2[0].name,
             )
@@ -683,15 +679,19 @@
     return obj.tolist()
 
 
 @is_categorical_dtype_dispatch.register(
     (pd.Series, pd.Index, pd.api.extensions.ExtensionDtype, np.dtype)
 )
 def is_categorical_dtype_pandas(obj):
-    return pd.api.types.is_categorical_dtype(obj)
+    if hasattr(obj, "dtype"):
+        dtype = obj.dtype
+    else:
+        dtype = obj
+    return isinstance(dtype, pd.CategoricalDtype)
 
 
 @grouper_dispatch.register((pd.DataFrame, pd.Series))
 def get_grouper_pandas(obj):
     return pd.core.groupby.Grouper
```

### Comparing `dask-2023.4.0/dask/dataframe/categorical.py` & `dask-2023.4.1/dask/dataframe/categorical.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/core.py` & `dask-2023.4.1/dask/dataframe/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -107,18495 +107,18520 @@
 000006a0: 7465 676f 7269 6573 2c0a 2020 2020 6472  tegories,.    dr
 000006b0: 6f70 5f62 795f 7368 616c 6c6f 775f 636f  op_by_shallow_co
 000006c0: 7079 2c0a 2020 2020 6861 735f 6b6e 6f77  py,.    has_know
 000006d0: 6e5f 6361 7465 676f 7269 6573 2c0a 2020  n_categories,.  
 000006e0: 2020 696e 6465 785f 7375 6d6d 6172 792c    index_summary,
 000006f0: 0a20 2020 2069 6e73 6572 745f 6d65 7461  .    insert_meta
 00000700: 5f70 6172 616d 5f64 6573 6372 6970 7469  _param_descripti
-00000710: 6f6e 2c0a 2020 2020 6973 5f63 6174 6567  on,.    is_categ
-00000720: 6f72 6963 616c 5f64 7479 7065 2c0a 2020  orical_dtype,.  
-00000730: 2020 6973 5f64 6174 6166 7261 6d65 5f6c    is_dataframe_l
-00000740: 696b 652c 0a20 2020 2069 735f 696e 6465  ike,.    is_inde
-00000750: 785f 6c69 6b65 2c0a 2020 2020 6973 5f73  x_like,.    is_s
-00000760: 6572 6965 735f 6c69 6b65 2c0a 2020 2020  eries_like,.    
-00000770: 6d61 6b65 5f6d 6574 612c 0a20 2020 206d  make_meta,.    m
-00000780: 6574 615f 6672 616d 655f 636f 6e73 7472  eta_frame_constr
-00000790: 7563 746f 722c 0a20 2020 206d 6574 615f  uctor,.    meta_
-000007a0: 7365 7269 6573 5f63 6f6e 7374 7275 6374  series_construct
-000007b0: 6f72 2c0a 2020 2020 7261 6973 655f 6f6e  or,.    raise_on
-000007c0: 5f6d 6574 615f 6572 726f 722c 0a20 2020  _meta_error,.   
-000007d0: 2076 616c 6964 5f64 6976 6973 696f 6e73   valid_divisions
-000007e0: 2c0a 290a 6672 6f6d 2064 6173 6b2e 6465  ,.).from dask.de
-000007f0: 6c61 7965 6420 696d 706f 7274 2044 656c  layed import Del
-00000800: 6179 6564 2c20 6465 6c61 7965 642c 2075  ayed, delayed, u
-00000810: 6e70 6163 6b5f 636f 6c6c 6563 7469 6f6e  npack_collection
-00000820: 730a 6672 6f6d 2064 6173 6b2e 6869 6768  s.from dask.high
-00000830: 6c65 7665 6c67 7261 7068 2069 6d70 6f72  levelgraph impor
-00000840: 7420 4869 6768 4c65 7665 6c47 7261 7068  t HighLevelGraph
-00000850: 0a66 726f 6d20 6461 736b 2e6c 6179 6572  .from dask.layer
-00000860: 7320 696d 706f 7274 2044 6174 6146 7261  s import DataFra
-00000870: 6d65 5472 6565 5265 6475 6374 696f 6e0a  meTreeReduction.
-00000880: 6672 6f6d 2064 6173 6b2e 7574 696c 7320  from dask.utils 
-00000890: 696d 706f 7274 2028 0a20 2020 2049 6e64  import (.    Ind
-000008a0: 6578 4361 6c6c 6162 6c65 2c0a 2020 2020  exCallable,.    
-000008b0: 4d2c 0a20 2020 204f 7065 7261 746f 724d  M,.    OperatorM
-000008c0: 6574 686f 644d 6978 696e 2c0a 2020 2020  ethodMixin,.    
-000008d0: 5f64 6570 7265 6361 7465 642c 0a20 2020  _deprecated,.   
-000008e0: 2061 7070 6c79 2c0a 2020 2020 6465 7269   apply,.    deri
-000008f0: 7665 645f 6672 6f6d 2c0a 2020 2020 6675  ved_from,.    fu
-00000900: 6e63 6e61 6d65 2c0a 2020 2020 6861 735f  ncname,.    has_
-00000910: 6b65 7977 6f72 642c 0a20 2020 2069 735f  keyword,.    is_
-00000920: 6172 7261 796c 696b 652c 0a20 2020 2069  arraylike,.    i
-00000930: 7465 725f 6368 756e 6b73 2c0a 2020 2020  ter_chunks,.    
-00000940: 6b65 795f 7370 6c69 742c 0a20 2020 206d  key_split,.    m
-00000950: 6179 6265 5f70 6c75 7261 6c69 7a65 2c0a  aybe_pluralize,.
-00000960: 2020 2020 6d65 6d6f 7279 5f72 6570 722c      memory_repr,
-00000970: 0a20 2020 2070 6172 7365 5f62 7974 6573  .    parse_bytes
-00000980: 2c0a 2020 2020 7061 7274 6961 6c5f 6279  ,.    partial_by
-00000990: 5f6f 7264 6572 2c0a 2020 2020 7073 6575  _order,.    pseu
-000009a0: 646f 7261 6e64 6f6d 2c0a 2020 2020 7075  dorandom,.    pu
-000009b0: 745f 6c69 6e65 732c 0a20 2020 2072 616e  t_lines,.    ran
-000009c0: 646f 6d5f 7374 6174 655f 6461 7461 2c0a  dom_state_data,.
-000009d0: 2020 2020 7479 7065 6e61 6d65 2c0a 290a      typename,.).
-000009e0: 6672 6f6d 2064 6173 6b2e 7769 6467 6574  from dask.widget
-000009f0: 7320 696d 706f 7274 2067 6574 5f74 656d  s import get_tem
-00000a00: 706c 6174 650a 0a44 4546 4155 4c54 5f47  plate..DEFAULT_G
-00000a10: 4554 203d 206e 616d 6564 5f73 6368 6564  ET = named_sched
-00000a20: 756c 6572 732e 6765 7428 2274 6872 6561  ulers.get("threa
-00000a30: 6473 222c 206e 616d 6564 5f73 6368 6564  ds", named_sched
-00000a40: 756c 6572 735b 2273 796e 6322 5d29 0a0a  ulers["sync"])..
-00000a50: 6e6f 5f64 6566 6175 6c74 203d 2022 5f5f  no_default = "__
-00000a60: 6e6f 5f64 6566 6175 6c74 5f5f 220a 0a47  no_default__"..G
-00000a70: 524f 5550 5f4b 4559 535f 4445 4641 554c  ROUP_KEYS_DEFAUL
-00000a80: 543a 2062 6f6f 6c20 7c20 4e6f 6e65 203d  T: bool | None =
-00000a90: 2054 7275 650a 6966 2050 414e 4441 535f   True.if PANDAS_
-00000aa0: 4754 5f31 3530 2061 6e64 206e 6f74 2050  GT_150 and not P
-00000ab0: 414e 4441 535f 4754 5f32 3030 3a0a 2020  ANDAS_GT_200:.  
-00000ac0: 2020 4752 4f55 505f 4b45 5953 5f44 4546    GROUP_KEYS_DEF
-00000ad0: 4155 4c54 203d 204e 6f6e 650a 0a70 642e  AULT = None..pd.
-00000ae0: 7365 745f 6f70 7469 6f6e 2822 636f 6d70  set_option("comp
-00000af0: 7574 652e 7573 655f 6e75 6d65 7870 7222  ute.use_numexpr"
-00000b00: 2c20 4661 6c73 6529 0a0a 0a64 6566 205f  , False)...def _
-00000b10: 6e75 6d65 7269 635f 6f6e 6c79 2866 756e  numeric_only(fun
-00000b20: 6329 3a0a 2020 2020 2222 2244 6563 6f72  c):.    """Decor
-00000b30: 6174 6f72 2066 6f72 206d 6574 686f 6473  ator for methods
-00000b40: 2074 6861 7420 6163 6365 7074 2061 206e   that accept a n
-00000b50: 756d 6572 6963 5f6f 6e6c 7920 6b77 6172  umeric_only kwar
-00000b60: 6722 2222 0a0a 2020 2020 4077 7261 7073  g"""..    @wraps
-00000b70: 2866 756e 6329 0a20 2020 2064 6566 2077  (func).    def w
-00000b80: 7261 7070 6572 2873 656c 662c 202a 6172  rapper(self, *ar
-00000b90: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-00000ba0: 2020 2020 2020 2023 206e 756d 6572 6963         # numeric
-00000bb0: 5f6f 6e6c 7920 6973 204e 6f6e 6520 6279  _only is None by
-00000bc0: 2064 6566 6175 6c74 202d 2069 6e20 7468   default - in th
-00000bd0: 6174 2063 6173 6520 7365 6c66 203d 2073  at case self = s
-00000be0: 656c 662e 0a20 2020 2020 2020 2069 6620  elf..        if 
-00000bf0: 6b77 6172 6773 2e67 6574 2822 6e75 6d65  kwargs.get("nume
-00000c00: 7269 635f 6f6e 6c79 2229 2069 7320 4661  ric_only") is Fa
-00000c10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00000c20: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-00000c30: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
-00000c40: 2020 2020 2020 2020 2020 2020 2227 6e75              "'nu
-00000c50: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
-00000c60: 2720 6973 206e 6f74 2069 6d70 6c65 6d65  ' is not impleme
-00000c70: 6e74 6564 2069 6e20 4461 736b 2e22 0a20  nted in Dask.". 
-00000c80: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00000c90: 2020 2020 2065 6c69 6620 6b77 6172 6773       elif kwargs
-00000ca0: 2e67 6574 2822 6e75 6d65 7269 635f 6f6e  .get("numeric_on
-00000cb0: 6c79 2229 2069 7320 5472 7565 3a0a 2020  ly") is True:.  
-00000cc0: 2020 2020 2020 2020 2020 7365 6c66 203d            self =
-00000cd0: 2073 656c 662e 5f67 6574 5f6e 756d 6572   self._get_numer
-00000ce0: 6963 5f64 6174 6128 290a 2020 2020 2020  ic_data().      
-00000cf0: 2020 7265 7475 726e 2066 756e 6328 7365    return func(se
-00000d00: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
-00000d10: 7267 7329 0a0a 2020 2020 7265 7475 726e  rgs)..    return
-00000d20: 2077 7261 7070 6572 0a0a 0a64 6566 205f   wrapper...def _
-00000d30: 6e75 6d65 7269 635f 6461 7461 2866 756e  numeric_data(fun
-00000d40: 6329 3a0a 2020 2020 2222 224d 6f64 6966  c):.    """Modif
-00000d50: 6965 6420 7665 7273 696f 6e20 6f66 2074  ied version of t
-00000d60: 6865 2061 626f 7665 2064 6563 6f72 6174  he above decorat
-00000d70: 6f72 2c20 7269 6768 7420 6e6f 7720 6f6e  or, right now on
-00000d80: 6c79 2075 7365 6420 7769 7468 2073 7464  ly used with std
-00000d90: 2e20 5765 2064 6f6e 2774 0a20 2020 206e  . We don't.    n
-00000da0: 6565 6420 7261 6973 696e 6720 4e6f 7449  eed raising NotI
-00000db0: 6d70 6c65 6d65 6e74 6564 4572 726f 7220  mplementedError 
-00000dc0: 7468 6572 652c 2062 6563 6175 7365 2069  there, because i
-00000dd0: 7427 7320 6861 6e64 6c65 6420 6279 0a20  t's handled by. 
-00000de0: 2020 205f 6e75 6d65 7269 635f 6f6e 6c79     _numeric_only
-00000df0: 5f6d 6179 6265 5f77 6172 6e20 696e 7374  _maybe_warn inst
-00000e00: 6561 642e 2054 6869 7320 6973 2061 2074  ead. This is a t
-00000e10: 656d 706f 7261 7279 2073 6f6c 7574 696f  emporary solutio
-00000e20: 6e20 7468 6174 206e 6565 6473 0a20 2020  n that needs.   
-00000e30: 206d 6f72 6520 7469 6d65 2074 6f20 6265   more time to be
-00000e40: 2067 656e 6572 616c 697a 6564 2e22 2222   generalized."""
-00000e50: 0a0a 2020 2020 4077 7261 7073 2866 756e  ..    @wraps(fun
-00000e60: 6329 0a20 2020 2064 6566 2077 7261 7070  c).    def wrapp
-00000e70: 6572 2873 656c 662c 202a 6172 6773 2c20  er(self, *args, 
-00000e80: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-00000e90: 2020 2069 6620 6b77 6172 6773 2e67 6574     if kwargs.get
-00000ea0: 2822 6e75 6d65 7269 635f 6f6e 6c79 2229  ("numeric_only")
-00000eb0: 2069 7320 5472 7565 3a0a 2020 2020 2020   is True:.      
-00000ec0: 2020 2020 2020 7365 6c66 203d 2073 656c        self = sel
-00000ed0: 662e 5f67 6574 5f6e 756d 6572 6963 5f64  f._get_numeric_d
-00000ee0: 6174 6128 290a 2020 2020 2020 2020 7265  ata().        re
-00000ef0: 7475 726e 2066 756e 6328 7365 6c66 2c20  turn func(self, 
-00000f00: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-00000f10: 0a0a 2020 2020 7265 7475 726e 2077 7261  ..    return wra
-00000f20: 7070 6572 0a0a 0a64 6566 205f 6e75 6d65  pper...def _nume
-00000f30: 7269 635f 6f6e 6c79 5f6d 6179 6265 5f77  ric_only_maybe_w
-00000f40: 6172 6e28 6466 2c20 6e75 6d65 7269 635f  arn(df, numeric_
-00000f50: 6f6e 6c79 2c20 6465 6661 756c 743d 4e6f  only, default=No
-00000f60: 6e65 293a 0a20 2020 2022 2222 5570 6461  ne):.    """Upda
-00000f70: 7465 206e 756d 6572 6963 5f6f 6e6c 7920  te numeric_only 
-00000f80: 746f 2067 6574 2072 6964 206f 6620 6e6f  to get rid of no
-00000f90: 5f64 6566 6175 6c74 2c20 616e 6420 706f  _default, and po
-00000fa0: 7373 6962 6c79 2077 6172 6e20 6162 6f75  ssibly warn abou
-00000fb0: 7420 6465 6661 756c 7420 7661 6c75 652e  t default value.
-00000fc0: 0a20 2020 2054 4f44 4f3a 2073 686f 756c  .    TODO: shoul
-00000fd0: 6420 6d6f 7665 2074 6f20 6e75 6d65 7269  d move to numeri
-00000fe0: 635f 6f6e 6c79 2064 6563 6f72 6174 6f72  c_only decorator
-00000ff0: 2e20 5365 6520 6874 7470 733a 2f2f 6769  . See https://gi
-00001000: 7468 7562 2e63 6f6d 2f64 6173 6b2f 6461  thub.com/dask/da
-00001010: 736b 2f70 756c 6c2f 3939 3532 0a20 2020  sk/pull/9952.   
-00001020: 2022 2222 0a20 2020 2069 6620 6973 5f64   """.    if is_d
-00001030: 6174 6166 7261 6d65 5f6c 696b 6528 6466  ataframe_like(df
-00001040: 293a 0a20 2020 2020 2020 2077 6172 6e5f  ):.        warn_
-00001050: 6e75 6d65 7269 635f 6f6e 6c79 203d 2046  numeric_only = F
-00001060: 616c 7365 0a20 2020 2020 2020 2069 6620  alse.        if 
-00001070: 6e75 6d65 7269 635f 6f6e 6c79 2069 7320  numeric_only is 
-00001080: 6e6f 5f64 6566 6175 6c74 3a0a 2020 2020  no_default:.    
-00001090: 2020 2020 2020 2020 6966 2050 414e 4441          if PANDA
-000010a0: 535f 4754 5f32 3030 3a0a 2020 2020 2020  S_GT_200:.      
-000010b0: 2020 2020 2020 2020 2020 6e75 6d65 7269            numeri
-000010c0: 635f 6f6e 6c79 203d 2046 616c 7365 0a20  c_only = False. 
-000010d0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000010e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000010f0: 2077 6172 6e5f 6e75 6d65 7269 635f 6f6e   warn_numeric_on
-00001100: 6c79 203d 2054 7275 650a 0a20 2020 2020  ly = True..     
-00001110: 2020 206e 756d 6572 6963 7320 3d20 6466     numerics = df
-00001120: 2e5f 6d65 7461 2e5f 6765 745f 6e75 6d65  ._meta._get_nume
-00001130: 7269 635f 6461 7461 2829 0a20 2020 2020  ric_data().     
-00001140: 2020 2068 6173 5f6e 6f6e 5f6e 756d 6572     has_non_numer
-00001150: 6963 7320 3d20 6c65 6e28 6e75 6d65 7269  ics = len(numeri
-00001160: 6373 2e63 6f6c 756d 6e73 2920 3c20 6c65  cs.columns) < le
-00001170: 6e28 6466 2e5f 6d65 7461 2e63 6f6c 756d  n(df._meta.colum
-00001180: 6e73 290a 2020 2020 2020 2020 6966 2068  ns).        if h
-00001190: 6173 5f6e 6f6e 5f6e 756d 6572 6963 733a  as_non_numerics:
-000011a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000011b0: 6e75 6d65 7269 635f 6f6e 6c79 2069 7320  numeric_only is 
-000011c0: 4661 6c73 653a 0a20 2020 2020 2020 2020  False:.         
-000011d0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-000011e0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-000011f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00001200: 2020 2020 2020 2227 6e75 6d65 7269 635f        "'numeric_
-00001210: 6f6e 6c79 3d46 616c 7365 2720 6973 206e  only=False' is n
-00001220: 6f74 2069 6d70 6c65 6d65 6e74 6564 2069  ot implemented i
-00001230: 6e20 4461 736b 2e22 0a20 2020 2020 2020  n Dask.".       
-00001240: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00001250: 2020 2020 2020 2065 6c69 6620 7761 726e         elif warn
-00001260: 5f6e 756d 6572 6963 5f6f 6e6c 793a 0a20  _numeric_only:. 
-00001270: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-00001280: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-00001290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000012a0: 2020 2254 6865 2064 6566 6175 6c74 2076    "The default v
-000012b0: 616c 7565 206f 6620 6e75 6d65 7269 635f  alue of numeric_
-000012c0: 6f6e 6c79 2069 6e20 6461 736b 2077 696c  only in dask wil
-000012d0: 6c20 6265 2063 6861 6e67 6564 2074 6f20  l be changed to 
-000012e0: 4661 6c73 6520 696e 2022 0a20 2020 2020  False in ".     
-000012f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00001300: 7468 6520 6675 7475 7265 2077 6865 6e20  the future when 
-00001310: 7573 696e 6720 6461 736b 2077 6974 6820  using dask with 
-00001320: 7061 6e64 6173 2032 2e30 222c 0a20 2020  pandas 2.0",.   
-00001330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001340: 2046 7574 7572 6557 6172 6e69 6e67 2c0a   FutureWarning,.
-00001350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001360: 290a 2020 2020 6966 206e 756d 6572 6963  ).    if numeric
-00001370: 5f6f 6e6c 7920 6973 206e 6f5f 6465 6661  _only is no_defa
-00001380: 756c 7420 616e 6420 6465 6661 756c 7420  ult and default 
-00001390: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-000013a0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-000013b0: 7920 3d20 6465 6661 756c 740a 2020 2020  y = default.    
-000013c0: 7265 7475 726e 207b 7d20 6966 206e 756d  return {} if num
-000013d0: 6572 6963 5f6f 6e6c 7920 6973 206e 6f5f  eric_only is no_
-000013e0: 6465 6661 756c 7420 656c 7365 207b 226e  default else {"n
-000013f0: 756d 6572 6963 5f6f 6e6c 7922 3a20 6e75  umeric_only": nu
-00001400: 6d65 7269 635f 6f6e 6c79 7d0a 0a0a 6465  meric_only}...de
-00001410: 6620 5f63 6f6e 6361 7428 6172 6773 2c20  f _concat(args, 
-00001420: 6967 6e6f 7265 5f69 6e64 6578 3d46 616c  ignore_index=Fal
-00001430: 7365 293a 0a20 2020 2069 6620 6e6f 7420  se):.    if not 
-00001440: 6172 6773 3a0a 2020 2020 2020 2020 7265  args:.        re
-00001450: 7475 726e 2061 7267 730a 2020 2020 6966  turn args.    if
-00001460: 2069 7369 6e73 7461 6e63 6528 6669 7273   isinstance(firs
-00001470: 7428 636f 7265 2e66 6c61 7474 656e 2861  t(core.flatten(a
-00001480: 7267 7329 292c 206e 702e 6e64 6172 7261  rgs)), np.ndarra
-00001490: 7929 3a0a 2020 2020 2020 2020 7265 7475  y):.        retu
-000014a0: 726e 2064 612e 636f 7265 2e63 6f6e 6361  rn da.core.conca
-000014b0: 7465 6e61 7465 3328 6172 6773 290a 2020  tenate3(args).  
-000014c0: 2020 6966 206e 6f74 2068 6173 5f70 6172    if not has_par
-000014d0: 616c 6c65 6c5f 7479 7065 2861 7267 735b  allel_type(args[
-000014e0: 305d 293a 0a20 2020 2020 2020 2074 7279  0]):.        try
-000014f0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00001500: 7475 726e 2070 642e 5365 7269 6573 2861  turn pd.Series(a
-00001510: 7267 7329 0a20 2020 2020 2020 2065 7863  rgs).        exc
-00001520: 6570 7420 4578 6365 7074 696f 6e3a 0a20  ept Exception:. 
-00001530: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00001540: 6e20 6172 6773 0a20 2020 2023 2057 6520  n args.    # We 
-00001550: 6669 6c74 6572 206f 7574 2065 6d70 7479  filter out empty
-00001560: 2070 6172 7469 7469 6f6e 7320 6865 7265   partitions here
-00001570: 2062 6563 6175 7365 2070 616e 6461 7320   because pandas 
-00001580: 6672 6571 7565 6e74 6c79 2068 6173 0a20  frequently has. 
-00001590: 2020 2023 2069 6e63 6f6e 7369 7374 656e     # inconsisten
-000015a0: 7420 6474 7970 6573 2069 6e20 7265 7375  t dtypes in resu
-000015b0: 6c74 7320 6265 7477 6565 6e20 656d 7074  lts between empt
-000015c0: 7920 616e 6420 6e6f 6e2d 656d 7074 7920  y and non-empty 
-000015d0: 6672 616d 6573 2e0a 2020 2020 2320 4964  frames..    # Id
-000015e0: 6561 6c6c 7920 7468 6973 2077 6f75 6c64  eally this would
-000015f0: 2062 6520 6861 6e64 6c65 6420 6c6f 6361   be handled loca
-00001600: 6c6c 7920 666f 7220 6561 6368 206f 7065  lly for each ope
-00001610: 7261 7469 6f6e 2c20 6275 7420 696e 2070  ration, but in p
-00001620: 7261 6374 6963 650a 2020 2020 2320 7468  ractice.    # th
-00001630: 6973 2073 6565 6d73 2065 6173 6965 722e  is seems easier.
-00001640: 2054 4f44 4f3a 2064 6f6e 2774 2064 6f20   TODO: don't do 
-00001650: 7468 6973 2e0a 2020 2020 6172 6773 3220  this..    args2 
-00001660: 3d20 5b69 2066 6f72 2069 2069 6e20 6172  = [i for i in ar
-00001670: 6773 2069 6620 6c65 6e28 6929 5d0a 2020  gs if len(i)].  
-00001680: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
-00001690: 2020 2061 7267 735b 305d 0a20 2020 2020     args[0].     
-000016a0: 2020 2069 6620 6e6f 7420 6172 6773 320a     if not args2.
-000016b0: 2020 2020 2020 2020 656c 7365 206d 6574          else met
-000016c0: 686f 6473 2e63 6f6e 6361 7428 6172 6773  hods.concat(args
-000016d0: 322c 2075 6e69 666f 726d 3d54 7275 652c  2, uniform=True,
-000016e0: 2069 676e 6f72 655f 696e 6465 783d 6967   ignore_index=ig
-000016f0: 6e6f 7265 5f69 6e64 6578 290a 2020 2020  nore_index).    
-00001700: 290a 0a0a 6465 6620 6669 6e61 6c69 7a65  )...def finalize
-00001710: 2872 6573 756c 7473 293a 0a20 2020 2072  (results):.    r
-00001720: 6574 7572 6e20 5f63 6f6e 6361 7428 7265  eturn _concat(re
-00001730: 7375 6c74 7329 0a0a 0a63 6c61 7373 2053  sults)...class S
-00001740: 6361 6c61 7228 4461 736b 4d65 7468 6f64  calar(DaskMethod
-00001750: 734d 6978 696e 2c20 4f70 6572 6174 6f72  sMixin, Operator
-00001760: 4d65 7468 6f64 4d69 7869 6e29 3a0a 2020  MethodMixin):.  
-00001770: 2020 2222 2241 2044 6173 6b20 6f62 6a65    """A Dask obje
-00001780: 6374 2074 6f20 7265 7072 6573 656e 7420  ct to represent 
-00001790: 6120 7061 6e64 6173 2073 6361 6c61 7222  a pandas scalar"
-000017a0: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
-000017b0: 6974 5f5f 2873 656c 662c 2064 736b 2c20  it__(self, dsk, 
-000017c0: 6e61 6d65 2c20 6d65 7461 2c20 6469 7669  name, meta, divi
-000017d0: 7369 6f6e 733d 4e6f 6e65 293a 0a20 2020  sions=None):.   
-000017e0: 2020 2020 2023 2064 6976 6973 696f 6e73       # divisions
-000017f0: 2069 7320 6967 6e6f 7265 642c 206f 6e6c   is ignored, onl
-00001800: 7920 7072 6573 656e 7420 746f 2062 6520  y present to be 
-00001810: 636f 6d70 6174 6962 6c65 2077 6974 6820  compatible with 
-00001820: 6f74 6865 720a 2020 2020 2020 2020 2320  other.        # 
-00001830: 6f62 6a65 6374 732e 0a20 2020 2020 2020  objects..       
-00001840: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-00001850: 6365 2864 736b 2c20 4869 6768 4c65 7665  ce(dsk, HighLeve
-00001860: 6c47 7261 7068 293a 0a20 2020 2020 2020  lGraph):.       
-00001870: 2020 2020 2064 736b 203d 2048 6967 684c       dsk = HighL
-00001880: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-00001890: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
-000018a0: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-000018b0: 6573 3d5b 5d29 0a20 2020 2020 2020 2073  es=[]).        s
-000018c0: 656c 662e 6461 736b 203d 2064 736b 0a20  elf.dask = dsk. 
-000018d0: 2020 2020 2020 2073 656c 662e 5f6e 616d         self._nam
-000018e0: 6520 3d20 6e61 6d65 0a20 2020 2020 2020  e = name.       
-000018f0: 2073 656c 662e 5f70 6172 656e 745f 6d65   self._parent_me
-00001900: 7461 203d 2070 642e 5365 7269 6573 2864  ta = pd.Series(d
-00001910: 7479 7065 3d22 666c 6f61 7436 3422 290a  type="float64").
-00001920: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
-00001930: 6d61 6b65 5f6d 6574 6128 6d65 7461 2c20  make_meta(meta, 
-00001940: 7061 7265 6e74 5f6d 6574 613d 7365 6c66  parent_meta=self
-00001950: 2e5f 7061 7265 6e74 5f6d 6574 6129 0a20  ._parent_meta). 
-00001960: 2020 2020 2020 2069 6620 6973 5f64 6174         if is_dat
-00001970: 6166 7261 6d65 5f6c 696b 6528 6d65 7461  aframe_like(meta
-00001980: 2920 6f72 2069 735f 7365 7269 6573 5f6c  ) or is_series_l
-00001990: 696b 6528 6d65 7461 2920 6f72 2069 735f  ike(meta) or is_
-000019a0: 696e 6465 785f 6c69 6b65 286d 6574 6129  index_like(meta)
-000019b0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-000019c0: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
-000019d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000019e0: 2245 7870 6563 7465 6420 6d65 7461 2074  "Expected meta t
-000019f0: 6f20 7370 6563 6966 7920 7363 616c 6172  o specify scalar
-00001a00: 2c20 676f 7420 7b74 7970 656e 616d 6528  , got {typename(
-00001a10: 7479 7065 286d 6574 6129 297d 220a 2020  type(meta))}".  
-00001a20: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00001a30: 2020 2020 7365 6c66 2e5f 6d65 7461 203d      self._meta =
-00001a40: 206d 6574 610a 0a20 2020 2064 6566 205f   meta..    def _
-00001a50: 5f64 6173 6b5f 6772 6170 685f 5f28 7365  _dask_graph__(se
-00001a60: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00001a70: 7572 6e20 7365 6c66 2e64 6173 6b0a 0a20  urn self.dask.. 
-00001a80: 2020 2064 6566 205f 5f64 6173 6b5f 6b65     def __dask_ke
-00001a90: 7973 5f5f 2873 656c 6629 3a0a 2020 2020  ys__(self):.    
-00001aa0: 2020 2020 7265 7475 726e 205b 7365 6c66      return [self
-00001ab0: 2e6b 6579 5d0a 0a20 2020 2064 6566 205f  .key]..    def _
-00001ac0: 5f64 6173 6b5f 746f 6b65 6e69 7a65 5f5f  _dask_tokenize__
-00001ad0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00001ae0: 7265 7475 726e 2073 656c 662e 5f6e 616d  return self._nam
-00001af0: 650a 0a20 2020 2064 6566 205f 5f64 6173  e..    def __das
-00001b00: 6b5f 6c61 7965 7273 5f5f 2873 656c 6629  k_layers__(self)
-00001b10: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00001b20: 2028 7365 6c66 2e5f 6e61 6d65 2c29 0a0a   (self._name,)..
-00001b30: 2020 2020 5f5f 6461 736b 5f6f 7074 696d      __dask_optim
-00001b40: 697a 655f 5f20 3d20 676c 6f62 616c 6d65  ize__ = globalme
-00001b50: 7468 6f64 280a 2020 2020 2020 2020 6f70  thod(.        op
-00001b60: 7469 6d69 7a65 2c20 6b65 793d 2264 6174  timize, key="dat
-00001b70: 6166 7261 6d65 5f6f 7074 696d 697a 6522  aframe_optimize"
-00001b80: 2c20 6661 6c73 6579 3d64 6f6e 745f 6f70  , falsey=dont_op
-00001b90: 7469 6d69 7a65 0a20 2020 2029 0a20 2020  timize.    ).   
-00001ba0: 205f 5f64 6173 6b5f 7363 6865 6475 6c65   __dask_schedule
-00001bb0: 725f 5f20 3d20 7374 6174 6963 6d65 7468  r__ = staticmeth
-00001bc0: 6f64 2844 4546 4155 4c54 5f47 4554 290a  od(DEFAULT_GET).
-00001bd0: 0a20 2020 2064 6566 205f 5f64 6173 6b5f  .    def __dask_
-00001be0: 706f 7374 636f 6d70 7574 655f 5f28 7365  postcompute__(se
-00001bf0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00001c00: 7572 6e20 6669 7273 742c 2028 290a 0a20  urn first, ().. 
-00001c10: 2020 2064 6566 205f 5f64 6173 6b5f 706f     def __dask_po
-00001c20: 7374 7065 7273 6973 745f 5f28 7365 6c66  stpersist__(self
-00001c30: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00001c40: 6e20 7365 6c66 2e5f 7265 6275 696c 642c  n self._rebuild,
-00001c50: 2028 290a 0a20 2020 2064 6566 205f 7265   ()..    def _re
-00001c60: 6275 696c 6428 7365 6c66 2c20 6473 6b2c  build(self, dsk,
-00001c70: 202a 2c20 7265 6e61 6d65 3d4e 6f6e 6529   *, rename=None)
-00001c80: 3a0a 2020 2020 2020 2020 6e61 6d65 203d  :.        name =
-00001c90: 2073 656c 662e 5f6e 616d 650a 2020 2020   self._name.    
-00001ca0: 2020 2020 6966 2072 656e 616d 653a 0a20      if rename:. 
-00001cb0: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-00001cc0: 3d20 7265 6e61 6d65 2e67 6574 286e 616d  = rename.get(nam
-00001cd0: 652c 206e 616d 6529 0a20 2020 2020 2020  e, name).       
-00001ce0: 2072 6574 7572 6e20 5363 616c 6172 2864   return Scalar(d
-00001cf0: 736b 2c20 6e61 6d65 2c20 7365 6c66 2e5f  sk, name, self._
-00001d00: 6d65 7461 2c20 7365 6c66 2e64 6976 6973  meta, self.divis
-00001d10: 696f 6e73 290a 0a20 2020 2040 7072 6f70  ions)..    @prop
-00001d20: 6572 7479 0a20 2020 2064 6566 205f 6d65  erty.    def _me
-00001d30: 7461 5f6e 6f6e 656d 7074 7928 7365 6c66  ta_nonempty(self
-00001d40: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00001d50: 6e20 7365 6c66 2e5f 6d65 7461 0a0a 2020  n self._meta..  
-00001d60: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00001d70: 6465 6620 6474 7970 6528 7365 6c66 293a  def dtype(self):
-00001d80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00001d90: 7365 6c66 2e5f 6d65 7461 2e64 7479 7065  self._meta.dtype
-00001da0: 0a0a 2020 2020 6465 6620 5f5f 6469 725f  ..    def __dir_
-00001db0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00001dc0: 206f 203d 2073 6574 2864 6972 2874 7970   o = set(dir(typ
-00001dd0: 6528 7365 6c66 2929 290a 2020 2020 2020  e(self))).      
-00001de0: 2020 6f2e 7570 6461 7465 2873 656c 662e    o.update(self.
-00001df0: 5f5f 6469 6374 5f5f 290a 2020 2020 2020  __dict__).      
-00001e00: 2020 6966 206e 6f74 2068 6173 6174 7472    if not hasattr
-00001e10: 2873 656c 662e 5f6d 6574 612c 2022 6474  (self._meta, "dt
-00001e20: 7970 6522 293a 0a20 2020 2020 2020 2020  ype"):.         
-00001e30: 2020 206f 2e72 656d 6f76 6528 2264 7479     o.remove("dty
-00001e40: 7065 2229 2020 2320 6474 7970 6520 6f6e  pe")  # dtype on
-00001e50: 6c79 2069 6e20 6064 6972 6020 6966 2061  ly in `dir` if a
-00001e60: 7661 696c 6162 6c65 0a20 2020 2020 2020  vailable.       
-00001e70: 2072 6574 7572 6e20 6c69 7374 286f 290a   return list(o).
-00001e80: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00001e90: 2020 2064 6566 2064 6976 6973 696f 6e73     def divisions
-00001ea0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00001eb0: 2222 2244 756d 6d79 2064 6976 6973 696f  """Dummy divisio
-00001ec0: 6e73 2074 6f20 6265 2063 6f6d 7061 7420  ns to be compat 
-00001ed0: 7769 7468 2053 6572 6965 7320 616e 6420  with Series and 
-00001ee0: 4461 7461 4672 616d 6522 2222 0a20 2020  DataFrame""".   
-00001ef0: 2020 2020 2072 6574 7572 6e20 284e 6f6e       return (Non
-00001f00: 652c 204e 6f6e 6529 0a0a 2020 2020 6465  e, None)..    de
-00001f10: 6620 5f5f 7265 7072 5f5f 2873 656c 6629  f __repr__(self)
-00001f20: 3a0a 2020 2020 2020 2020 6e61 6d65 203d  :.        name =
-00001f30: 2073 656c 662e 5f6e 616d 6520 6966 206c   self._name if l
-00001f40: 656e 2873 656c 662e 5f6e 616d 6529 203c  en(self._name) <
-00001f50: 2031 3020 656c 7365 2073 656c 662e 5f6e   10 else self._n
-00001f60: 616d 655b 3a37 5d20 2b20 222e 2e2e 220a  ame[:7] + "...".
-00001f70: 2020 2020 2020 2020 6966 2068 6173 6174          if hasat
-00001f80: 7472 2873 656c 662e 5f6d 6574 612c 2022  tr(self._meta, "
-00001f90: 6474 7970 6522 293a 0a20 2020 2020 2020  dtype"):.       
-00001fa0: 2020 2020 2065 7874 7261 203d 2022 2c20       extra = ", 
-00001fb0: 6474 7970 653d 2573 2220 2520 7365 6c66  dtype=%s" % self
-00001fc0: 2e5f 6d65 7461 2e64 7479 7065 0a20 2020  ._meta.dtype.   
-00001fd0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00001fe0: 2020 2020 2020 2065 7874 7261 203d 2022         extra = "
-00001ff0: 2c20 7479 7065 3d25 7322 2025 2074 7970  , type=%s" % typ
-00002000: 6528 7365 6c66 2e5f 6d65 7461 292e 5f5f  e(self._meta).__
-00002010: 6e61 6d65 5f5f 0a20 2020 2020 2020 2072  name__.        r
-00002020: 6574 7572 6e20 6622 6464 2e53 6361 6c61  eturn f"dd.Scala
-00002030: 723c 7b6e 616d 657d 7b65 7874 7261 7d3e  r<{name}{extra}>
-00002040: 220a 0a20 2020 2064 6566 205f 5f61 7272  "..    def __arr
-00002050: 6179 5f5f 2873 656c 6629 3a0a 2020 2020  ay__(self):.    
-00002060: 2020 2020 2320 6172 7261 7920 696e 7465      # array inte
-00002070: 7266 6163 6520 6973 2072 6571 7569 7265  rface is require
-00002080: 6420 746f 2073 7570 706f 7274 2070 616e  d to support pan
-00002090: 6461 7320 696e 7374 616e 6365 202b 2053  das instance + S
-000020a0: 6361 6c61 720a 2020 2020 2020 2020 2320  calar.        # 
-000020b0: 4f74 6865 7277 6973 652c 2061 626f 7665  Otherwise, above
-000020c0: 206f 7020 7265 7375 6c74 7320 696e 2070   op results in p
-000020d0: 642e 5365 7269 6573 206f 6620 5363 616c  d.Series of Scal
-000020e0: 6172 2028 6f62 6a65 6374 2064 7479 7065  ar (object dtype
-000020f0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00002100: 206e 702e 6173 6172 7261 7928 7365 6c66   np.asarray(self
-00002110: 2e63 6f6d 7075 7465 2829 290a 0a20 2020  .compute())..   
-00002120: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00002130: 6566 205f 6172 6773 2873 656c 6629 3a0a  ef _args(self):.
-00002140: 2020 2020 2020 2020 7265 7475 726e 2028          return (
-00002150: 7365 6c66 2e64 6173 6b2c 2073 656c 662e  self.dask, self.
-00002160: 5f6e 616d 652c 2073 656c 662e 5f6d 6574  _name, self._met
-00002170: 6129 0a0a 2020 2020 6465 6620 5f5f 6765  a)..    def __ge
-00002180: 7473 7461 7465 5f5f 2873 656c 6629 3a0a  tstate__(self):.
-00002190: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000021a0: 656c 662e 5f61 7267 730a 0a20 2020 2064  elf._args..    d
-000021b0: 6566 205f 5f73 6574 7374 6174 655f 5f28  ef __setstate__(
-000021c0: 7365 6c66 2c20 7374 6174 6529 3a0a 2020  self, state):.  
-000021d0: 2020 2020 2020 7365 6c66 2e64 6173 6b2c        self.dask,
-000021e0: 2073 656c 662e 5f6e 616d 652c 2073 656c   self._name, sel
-000021f0: 662e 5f6d 6574 6120 3d20 7374 6174 650a  f._meta = state.
-00002200: 0a20 2020 2064 6566 205f 5f62 6f6f 6c5f  .    def __bool_
-00002210: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00002220: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00002230: 280a 2020 2020 2020 2020 2020 2020 6622  (.            f"
-00002240: 5472 7969 6e67 2074 6f20 636f 6e76 6572  Trying to conver
-00002250: 7420 7b73 656c 667d 2074 6f20 6120 626f  t {self} to a bo
-00002260: 6f6c 6561 6e20 7661 6c75 652e 2042 6563  olean value. Bec
-00002270: 6175 7365 2044 6173 6b20 6f62 6a65 6374  ause Dask object
-00002280: 7320 6172 6520 220a 2020 2020 2020 2020  s are ".        
-00002290: 2020 2020 226c 617a 696c 7920 6576 616c      "lazily eval
-000022a0: 7561 7465 642c 2074 6865 7920 6361 6e6e  uated, they cann
-000022b0: 6f74 2062 6520 636f 6e76 6572 7465 6420  ot be converted 
-000022c0: 746f 2061 2062 6f6f 6c65 616e 2076 616c  to a boolean val
-000022d0: 7565 206f 7220 7573 6564 2022 0a20 2020  ue or used ".   
-000022e0: 2020 2020 2020 2020 2022 696e 2062 6f6f           "in boo
-000022f0: 6c65 616e 2063 6f6e 6469 7469 6f6e 7320  lean conditions 
-00002300: 6c69 6b65 2069 6620 7374 6174 656d 656e  like if statemen
-00002310: 7473 2e20 5472 7920 6361 6c6c 696e 6720  ts. Try calling 
-00002320: 2e63 6f6d 7075 7465 2829 2074 6f20 220a  .compute() to ".
-00002330: 2020 2020 2020 2020 2020 2020 2266 6f72              "for
-00002340: 6365 2063 6f6d 7075 7461 7469 6f6e 2070  ce computation p
-00002350: 7269 6f72 2074 6f20 636f 6e76 6572 7469  rior to converti
-00002360: 6e67 2074 6f20 6120 626f 6f6c 6561 6e20  ng to a boolean 
-00002370: 7661 6c75 6520 6f72 2075 7369 6e67 2069  value or using i
-00002380: 6e20 220a 2020 2020 2020 2020 2020 2020  n ".            
-00002390: 2261 2063 6f6e 6469 7469 6f6e 616c 2073  "a conditional s
-000023a0: 7461 7465 6d65 6e74 2e22 0a20 2020 2020  tatement.".     
-000023b0: 2020 2029 0a0a 2020 2020 4070 726f 7065     )..    @prope
-000023c0: 7274 790a 2020 2020 6465 6620 6b65 7928  rty.    def key(
-000023d0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-000023e0: 6574 7572 6e20 2873 656c 662e 5f6e 616d  eturn (self._nam
-000023f0: 652c 2030 290a 0a20 2020 2040 636c 6173  e, 0)..    @clas
-00002400: 736d 6574 686f 640a 2020 2020 6465 6620  smethod.    def 
-00002410: 5f67 6574 5f75 6e61 7279 5f6f 7065 7261  _get_unary_opera
-00002420: 746f 7228 636c 732c 206f 7029 3a0a 2020  tor(cls, op):.  
-00002430: 2020 2020 2020 6465 6620 6628 7365 6c66        def f(self
-00002440: 293a 0a20 2020 2020 2020 2020 2020 206e  ):.            n
-00002450: 616d 6520 3d20 6675 6e63 6e61 6d65 286f  ame = funcname(o
-00002460: 7029 202b 2022 2d22 202b 2074 6f6b 656e  p) + "-" + token
-00002470: 697a 6528 7365 6c66 290a 2020 2020 2020  ize(self).      
-00002480: 2020 2020 2020 6473 6b20 3d20 7b28 6e61        dsk = {(na
-00002490: 6d65 2c20 3029 3a20 286f 702c 2028 7365  me, 0): (op, (se
-000024a0: 6c66 2e5f 6e61 6d65 2c20 3029 297d 0a20  lf._name, 0))}. 
-000024b0: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
-000024c0: 3d20 6f70 2873 656c 662e 5f6d 6574 615f  = op(self._meta_
-000024d0: 6e6f 6e65 6d70 7479 290a 2020 2020 2020  nonempty).      
-000024e0: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
-000024f0: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-00002500: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
-00002510: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
-00002520: 6e63 6965 733d 5b73 656c 665d 290a 2020  ncies=[self]).  
-00002530: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00002540: 2053 6361 6c61 7228 6772 6170 682c 206e   Scalar(graph, n
-00002550: 616d 652c 206d 6574 6129 0a0a 2020 2020  ame, meta)..    
-00002560: 2020 2020 7265 7475 726e 2066 0a0a 2020      return f..  
-00002570: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
-00002580: 2020 2064 6566 205f 6765 745f 6269 6e61     def _get_bina
-00002590: 7279 5f6f 7065 7261 746f 7228 636c 732c  ry_operator(cls,
-000025a0: 206f 702c 2069 6e76 3d46 616c 7365 293a   op, inv=False):
-000025b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000025c0: 6c61 6d62 6461 2073 656c 662c 206f 7468  lambda self, oth
-000025d0: 6572 3a20 5f73 6361 6c61 725f 6269 6e61  er: _scalar_bina
-000025e0: 7279 286f 702c 2073 656c 662c 206f 7468  ry(op, self, oth
-000025f0: 6572 2c20 696e 763d 696e 7629 0a0a 2020  er, inv=inv)..  
-00002600: 2020 6465 6620 746f 5f64 656c 6179 6564    def to_delayed
-00002610: 2873 656c 662c 206f 7074 696d 697a 655f  (self, optimize_
-00002620: 6772 6170 683d 5472 7565 293a 0a20 2020  graph=True):.   
-00002630: 2020 2020 2022 2222 436f 6e76 6572 7420       """Convert 
-00002640: 696e 746f 2061 2060 6064 6173 6b2e 6465  into a ``dask.de
-00002650: 6c61 7965 6460 6020 6f62 6a65 6374 2e0a  layed`` object..
-00002660: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00002670: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00002680: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206f  ------.        o
-00002690: 7074 696d 697a 655f 6772 6170 6820 3a20  ptimize_graph : 
-000026a0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
-000026b0: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
-000026c0: 7565 205b 6465 6661 756c 745d 2c20 7468  ue [default], th
-000026d0: 6520 6772 6170 6820 6973 206f 7074 696d  e graph is optim
-000026e0: 697a 6564 2062 6566 6f72 6520 636f 6e76  ized before conv
-000026f0: 6572 7469 6e67 2069 6e74 6f0a 2020 2020  erting into.    
-00002700: 2020 2020 2020 2020 6060 6461 736b 2e64          ``dask.d
-00002710: 656c 6179 6564 6060 206f 626a 6563 7473  elayed`` objects
-00002720: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00002730: 2020 2020 2020 6473 6b20 3d20 7365 6c66        dsk = self
-00002740: 2e5f 5f64 6173 6b5f 6772 6170 685f 5f28  .__dask_graph__(
-00002750: 290a 2020 2020 2020 2020 6c61 7965 7220  ).        layer 
-00002760: 3d20 7365 6c66 2e5f 5f64 6173 6b5f 6c61  = self.__dask_la
-00002770: 7965 7273 5f5f 2829 5b30 5d0a 2020 2020  yers__()[0].    
-00002780: 2020 2020 6966 206f 7074 696d 697a 655f      if optimize_
-00002790: 6772 6170 683a 0a20 2020 2020 2020 2020  graph:.         
-000027a0: 2020 2064 736b 203d 2073 656c 662e 5f5f     dsk = self.__
-000027b0: 6461 736b 5f6f 7074 696d 697a 655f 5f28  dask_optimize__(
-000027c0: 6473 6b2c 2073 656c 662e 5f5f 6461 736b  dsk, self.__dask
-000027d0: 5f6b 6579 735f 5f28 2929 0a20 2020 2020  _keys__()).     
-000027e0: 2020 2020 2020 206c 6179 6572 203d 2022         layer = "
-000027f0: 6465 6c61 7965 642d 2220 2b20 7365 6c66  delayed-" + self
-00002800: 2e5f 6e61 6d65 0a20 2020 2020 2020 2020  ._name.         
-00002810: 2020 2064 736b 203d 2048 6967 684c 6576     dsk = HighLev
-00002820: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-00002830: 6c65 6374 696f 6e73 286c 6179 6572 2c20  lections(layer, 
-00002840: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
-00002850: 733d 2829 290a 2020 2020 2020 2020 7265  s=()).        re
-00002860: 7475 726e 2044 656c 6179 6564 2873 656c  turn Delayed(sel
-00002870: 662e 6b65 792c 2064 736b 2c20 6c61 7965  f.key, dsk, laye
-00002880: 723d 6c61 7965 7229 0a0a 0a64 6566 205f  r=layer)...def _
-00002890: 7363 616c 6172 5f62 696e 6172 7928 6f70  scalar_binary(op
-000028a0: 2c20 7365 6c66 2c20 6f74 6865 722c 2069  , self, other, i
-000028b0: 6e76 3d46 616c 7365 293a 0a20 2020 206e  nv=False):.    n
-000028c0: 616d 6520 3d20 6622 7b66 756e 636e 616d  ame = f"{funcnam
-000028d0: 6528 6f70 297d 2d7b 746f 6b65 6e69 7a65  e(op)}-{tokenize
-000028e0: 2873 656c 662c 206f 7468 6572 297d 220a  (self, other)}".
-000028f0: 2020 2020 6465 7065 6e64 656e 6369 6573      dependencies
-00002900: 203d 205b 7365 6c66 5d0a 0a20 2020 2064   = [self]..    d
-00002910: 736b 203d 207b 7d0a 2020 2020 7265 7475  sk = {}.    retu
-00002920: 726e 5f74 7970 6520 3d20 6765 745f 7061  rn_type = get_pa
-00002930: 7261 6c6c 656c 5f74 7970 6528 6f74 6865  rallel_type(othe
-00002940: 7229 0a0a 2020 2020 6966 2069 7369 6e73  r)..    if isins
-00002950: 7461 6e63 6528 6f74 6865 722c 2053 6361  tance(other, Sca
-00002960: 6c61 7229 3a0a 2020 2020 2020 2020 6465  lar):.        de
-00002970: 7065 6e64 656e 6369 6573 2e61 7070 656e  pendencies.appen
-00002980: 6428 6f74 6865 7229 0a20 2020 2020 2020  d(other).       
-00002990: 206f 7468 6572 5f6b 6579 203d 2028 6f74   other_key = (ot
-000029a0: 6865 722e 5f6e 616d 652c 2030 290a 2020  her._name, 0).  
-000029b0: 2020 656c 6966 2069 735f 6461 736b 5f63    elif is_dask_c
-000029c0: 6f6c 6c65 6374 696f 6e28 6f74 6865 7229  ollection(other)
-000029d0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000029e0: 204e 6f74 496d 706c 656d 656e 7465 640a   NotImplemented.
-000029f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00002a00: 2020 6f74 6865 725f 6b65 7920 3d20 6f74    other_key = ot
-00002a10: 6865 720a 0a20 2020 2064 736b 5b28 6e61  her..    dsk[(na
-00002a20: 6d65 2c20 3029 5d20 3d20 280a 2020 2020  me, 0)] = (.    
-00002a30: 2020 2020 286f 702c 206f 7468 6572 5f6b      (op, other_k
-00002a40: 6579 2c20 2873 656c 662e 5f6e 616d 652c  ey, (self._name,
-00002a50: 2030 2929 2069 6620 696e 7620 656c 7365   0)) if inv else
-00002a60: 2028 6f70 2c20 2873 656c 662e 5f6e 616d   (op, (self._nam
-00002a70: 652c 2030 292c 206f 7468 6572 5f6b 6579  e, 0), other_key
-00002a80: 290a 2020 2020 290a 0a20 2020 206f 7468  ).    )..    oth
-00002a90: 6572 5f6d 6574 6120 3d20 6d61 6b65 5f6d  er_meta = make_m
-00002aa0: 6574 6128 6f74 6865 722c 2070 6172 656e  eta(other, paren
-00002ab0: 745f 6d65 7461 3d73 656c 662e 5f70 6172  t_meta=self._par
-00002ac0: 656e 745f 6d65 7461 290a 2020 2020 6f74  ent_meta).    ot
-00002ad0: 6865 725f 6d65 7461 5f6e 6f6e 656d 7074  her_meta_nonempt
-00002ae0: 7920 3d20 6d65 7461 5f6e 6f6e 656d 7074  y = meta_nonempt
-00002af0: 7928 6f74 6865 725f 6d65 7461 290a 2020  y(other_meta).  
-00002b00: 2020 6966 2069 6e76 3a0a 2020 2020 2020    if inv:.      
-00002b10: 2020 6d65 7461 203d 206f 7028 6f74 6865    meta = op(othe
-00002b20: 725f 6d65 7461 5f6e 6f6e 656d 7074 792c  r_meta_nonempty,
-00002b30: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
-00002b40: 6d70 7479 290a 2020 2020 656c 7365 3a0a  mpty).    else:.
-00002b50: 2020 2020 2020 2020 6d65 7461 203d 206f          meta = o
-00002b60: 7028 7365 6c66 2e5f 6d65 7461 5f6e 6f6e  p(self._meta_non
-00002b70: 656d 7074 792c 206f 7468 6572 5f6d 6574  empty, other_met
-00002b80: 615f 6e6f 6e65 6d70 7479 290a 0a20 2020  a_nonempty)..   
-00002b90: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-00002ba0: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-00002bb0: 6c65 6374 696f 6e73 286e 616d 652c 2064  lections(name, d
-00002bc0: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
-00002bd0: 3d64 6570 656e 6465 6e63 6965 7329 0a20  =dependencies). 
-00002be0: 2020 2069 6620 7265 7475 726e 5f74 7970     if return_typ
-00002bf0: 6520 6973 206e 6f74 2053 6361 6c61 723a  e is not Scalar:
-00002c00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00002c10: 7265 7475 726e 5f74 7970 6528 6772 6170  return_type(grap
-00002c20: 682c 206e 616d 652c 206d 6574 612c 205b  h, name, meta, [
-00002c30: 6f74 6865 722e 696e 6465 782e 6d69 6e28  other.index.min(
-00002c40: 292c 206f 7468 6572 2e69 6e64 6578 2e6d  ), other.index.m
-00002c50: 6178 2829 5d29 0a20 2020 2065 6c73 653a  ax()]).    else:
-00002c60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00002c70: 5363 616c 6172 2867 7261 7068 2c20 6e61  Scalar(graph, na
-00002c80: 6d65 2c20 6d65 7461 290a 0a0a 636c 6173  me, meta)...clas
-00002c90: 7320 5f46 7261 6d65 2844 6173 6b4d 6574  s _Frame(DaskMet
-00002ca0: 686f 6473 4d69 7869 6e2c 204f 7065 7261  hodsMixin, Opera
-00002cb0: 746f 724d 6574 686f 644d 6978 696e 293a  torMethodMixin):
-00002cc0: 0a20 2020 2022 2222 5375 7065 7263 6c61  .    """Supercla
-00002cd0: 7373 2066 6f72 2044 6174 6146 7261 6d65  ss for DataFrame
-00002ce0: 2061 6e64 2053 6572 6965 730a 0a20 2020   and Series..   
-00002cf0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00002d00: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064  ----------.    d
-00002d10: 736b 3a20 6469 6374 0a20 2020 2020 2020  sk: dict.       
-00002d20: 2054 6865 2064 6173 6b20 6772 6170 6820   The dask graph 
-00002d30: 746f 2063 6f6d 7075 7465 2074 6869 7320  to compute this 
-00002d40: 4461 7461 4672 616d 650a 2020 2020 6e61  DataFrame.    na
-00002d50: 6d65 3a20 7374 720a 2020 2020 2020 2020  me: str.        
-00002d60: 5468 6520 6b65 7920 7072 6566 6978 2074  The key prefix t
-00002d70: 6861 7420 7370 6563 6966 6965 7320 7768  hat specifies wh
-00002d80: 6963 6820 6b65 7973 2069 6e20 7468 6520  ich keys in the 
-00002d90: 6461 736b 2063 6f6d 7072 6973 6520 7468  dask comprise th
-00002da0: 6973 0a20 2020 2020 2020 2070 6172 7469  is.        parti
-00002db0: 6375 6c61 7220 4461 7461 4672 616d 6520  cular DataFrame 
-00002dc0: 2f20 5365 7269 6573 0a20 2020 206d 6574  / Series.    met
-00002dd0: 613a 2070 616e 6461 732e 4461 7461 4672  a: pandas.DataFr
-00002de0: 616d 652c 2070 616e 6461 732e 5365 7269  ame, pandas.Seri
-00002df0: 6573 2c20 6f72 2070 616e 6461 732e 496e  es, or pandas.In
-00002e00: 6465 780a 2020 2020 2020 2020 416e 2065  dex.        An e
-00002e10: 6d70 7479 2070 616e 6461 7320 6f62 6a65  mpty pandas obje
-00002e20: 6374 2077 6974 6820 6e61 6d65 732c 2064  ct with names, d
-00002e30: 7479 7065 732c 2061 6e64 2069 6e64 6963  types, and indic
-00002e40: 6573 206d 6174 6368 696e 6720 7468 650a  es matching the.
-00002e50: 2020 2020 2020 2020 6578 7065 6374 6564          expected
-00002e60: 206f 7574 7075 742e 0a20 2020 2064 6976   output..    div
-00002e70: 6973 696f 6e73 3a20 7475 706c 6520 6f66  isions: tuple of
-00002e80: 2069 6e64 6578 2076 616c 7565 730a 2020   index values.  
-00002e90: 2020 2020 2020 5661 6c75 6573 2061 6c6f        Values alo
-00002ea0: 6e67 2077 6869 6368 2077 6520 7061 7274  ng which we part
-00002eb0: 6974 696f 6e20 6f75 7220 626c 6f63 6b73  ition our blocks
-00002ec0: 206f 6e20 7468 6520 696e 6465 780a 2020   on the index.  
-00002ed0: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
-00002ee0: 5f69 6e69 745f 5f28 7365 6c66 2c20 6473  _init__(self, ds
-00002ef0: 6b2c 206e 616d 652c 206d 6574 612c 2064  k, name, meta, d
-00002f00: 6976 6973 696f 6e73 293a 0a20 2020 2020  ivisions):.     
-00002f10: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00002f20: 616e 6365 2864 736b 2c20 4869 6768 4c65  ance(dsk, HighLe
-00002f30: 7665 6c47 7261 7068 293a 0a20 2020 2020  velGraph):.     
-00002f40: 2020 2020 2020 2064 736b 203d 2048 6967         dsk = Hig
-00002f50: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-00002f60: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
-00002f70: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
-00002f80: 6369 6573 3d5b 5d29 0a20 2020 2020 2020  cies=[]).       
-00002f90: 2073 656c 662e 6461 736b 203d 2064 736b   self.dask = dsk
-00002fa0: 0a20 2020 2020 2020 2073 656c 662e 5f6e  .        self._n
-00002fb0: 616d 6520 3d20 6e61 6d65 0a20 2020 2020  ame = name.     
-00002fc0: 2020 206d 6574 6120 3d20 6d61 6b65 5f6d     meta = make_m
-00002fd0: 6574 6128 6d65 7461 290a 2020 2020 2020  eta(meta).      
-00002fe0: 2020 6966 206e 6f74 2073 656c 662e 5f69    if not self._i
-00002ff0: 735f 7061 7274 6974 696f 6e5f 7479 7065  s_partition_type
-00003000: 286d 6574 6129 3a0a 2020 2020 2020 2020  (meta):.        
-00003010: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00003020: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00003030: 2020 2020 2066 2245 7870 6563 7465 6420       f"Expected 
-00003040: 6d65 7461 2074 6f20 7370 6563 6966 7920  meta to specify 
-00003050: 7479 7065 207b 7479 7065 2873 656c 6629  type {type(self)
-00003060: 2e5f 5f6e 616d 655f 5f7d 2c20 676f 7420  .__name__}, got 
-00003070: 7479 7065 2022 0a20 2020 2020 2020 2020  type ".         
-00003080: 2020 2020 2020 2066 227b 7479 7065 6e61         f"{typena
-00003090: 6d65 2874 7970 6528 6d65 7461 2929 7d22  me(type(meta))}"
-000030a0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000030b0: 2020 2020 2020 2073 656c 662e 5f6d 6574         self._met
-000030c0: 6120 3d20 6d65 7461 0a20 2020 2020 2020  a = meta.       
-000030d0: 2073 656c 662e 6469 7669 7369 6f6e 7320   self.divisions 
-000030e0: 3d20 7475 706c 6528 6469 7669 7369 6f6e  = tuple(division
-000030f0: 7329 0a0a 2020 2020 2020 2020 2320 4f70  s)..        # Op
-00003100: 7469 6f6e 616c 6c79 2063 6173 7420 6f62  tionally cast ob
-00003110: 6a65 6374 2064 7479 7065 7320 746f 2060  ject dtypes to `
-00003120: 7079 6172 726f 7760 2073 7472 696e 6773  pyarrow` strings
-00003130: 0a20 2020 2020 2020 2069 6620 6461 736b  .        if dask
-00003140: 2e63 6f6e 6669 672e 6765 7428 2264 6174  .config.get("dat
-00003150: 6166 7261 6d65 2e63 6f6e 7665 7274 2d73  aframe.convert-s
-00003160: 7472 696e 6722 293a 0a20 2020 2020 2020  tring"):.       
-00003170: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-00003180: 6174 6166 7261 6d65 2e5f 7079 6172 726f  ataframe._pyarro
-00003190: 7720 696d 706f 7274 2063 6865 636b 5f70  w import check_p
-000031a0: 7961 7272 6f77 5f73 7472 696e 675f 7375  yarrow_string_su
-000031b0: 7070 6f72 7465 640a 0a20 2020 2020 2020  pported..       
-000031c0: 2020 2020 2063 6865 636b 5f70 7961 7272       check_pyarr
-000031d0: 6f77 5f73 7472 696e 675f 7375 7070 6f72  ow_string_suppor
-000031e0: 7465 6428 290a 0a20 2020 2020 2020 2020  ted()..         
-000031f0: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-00003200: 6166 7261 6d65 2e5f 7079 6172 726f 7720  aframe._pyarrow 
-00003210: 696d 706f 7274 2028 0a20 2020 2020 2020  import (.       
-00003220: 2020 2020 2020 2020 2069 735f 6f62 6a65           is_obje
-00003230: 6374 5f73 7472 696e 675f 6461 7461 6672  ct_string_datafr
-00003240: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00003250: 2020 2020 2069 735f 6f62 6a65 6374 5f73       is_object_s
-00003260: 7472 696e 675f 6474 7970 652c 0a20 2020  tring_dtype,.   
-00003270: 2020 2020 2020 2020 2020 2020 2069 735f               is_
-00003280: 6f62 6a65 6374 5f73 7472 696e 675f 696e  object_string_in
-00003290: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
-000032a0: 2020 2020 2069 735f 6f62 6a65 6374 5f73       is_object_s
-000032b0: 7472 696e 675f 7365 7269 6573 2c0a 2020  tring_series,.  
-000032c0: 2020 2020 2020 2020 2020 2020 2020 746f                to
-000032d0: 5f70 7961 7272 6f77 5f73 7472 696e 672c  _pyarrow_string,
-000032e0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-000032f0: 2020 2020 2020 2020 2020 2020 6966 2028              if (
-00003300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003310: 2069 735f 6f62 6a65 6374 5f73 7472 696e   is_object_strin
-00003320: 675f 6461 7461 6672 616d 6528 6d65 7461  g_dataframe(meta
-00003330: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00003340: 2020 6f72 2069 735f 6f62 6a65 6374 5f73    or is_object_s
-00003350: 7472 696e 675f 7365 7269 6573 286d 6574  tring_series(met
-00003360: 6129 0a20 2020 2020 2020 2020 2020 2020  a).             
-00003370: 2020 206f 7220 6973 5f6f 626a 6563 745f     or is_object_
-00003380: 7374 7269 6e67 5f69 6e64 6578 286d 6574  string_index(met
-00003390: 6129 0a20 2020 2020 2020 2020 2020 2029  a).            )
-000033a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000033b0: 2020 2320 5072 696f 7220 746f 2070 616e    # Prior to pan
-000033c0: 6461 733d 312e 342c 2060 7064 2e49 6e64  das=1.4, `pd.Ind
-000033d0: 6578 6020 636f 756c 646e 2774 2063 6f6e  ex` couldn't con
-000033e0: 7461 696e 2065 7874 656e 7369 6f6e 2064  tain extension d
-000033f0: 7479 7065 732e 0a20 2020 2020 2020 2020  types..         
-00003400: 2020 2020 2020 2023 2048 6572 6520 7765         # Here we
-00003410: 2064 6f6e 2774 2063 6173 7420 6f62 6a65   don't cast obje
-00003420: 6374 7320 746f 2070 7961 7272 6f77 2073  cts to pyarrow s
-00003430: 7472 696e 6773 2077 6865 7265 206f 6e6c  trings where onl
-00003440: 7920 7468 6520 696e 6465 780a 2020 2020  y the index.    
-00003450: 2020 2020 2020 2020 2020 2020 2320 636f              # co
-00003460: 6e74 6169 6e73 206e 6f6e 2d70 7961 7272  ntains non-pyarr
-00003470: 6f77 2073 7472 696e 6720 6461 7461 2e0a  ow string data..
-00003480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003490: 6966 206e 6f74 2050 414e 4441 535f 4754  if not PANDAS_GT
-000034a0: 5f31 3430 2061 6e64 2028 0a20 2020 2020  _140 and (.     
-000034b0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-000034c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000034d0: 2020 2020 2020 2020 2069 735f 6f62 6a65           is_obje
-000034e0: 6374 5f73 7472 696e 675f 6461 7461 6672  ct_string_datafr
-000034f0: 616d 6528 6d65 7461 290a 2020 2020 2020  ame(meta).      
-00003500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003510: 2020 616e 6420 6e6f 7420 616e 7928 6973    and not any(is
-00003520: 5f6f 626a 6563 745f 7374 7269 6e67 5f64  _object_string_d
-00003530: 7479 7065 2864 2920 666f 7220 6420 696e  type(d) for d in
-00003540: 206d 6574 612e 6474 7970 6573 290a 2020   meta.dtypes).  
-00003550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003560: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00003570: 2020 2020 2020 2020 6f72 2028 0a20 2020          or (.   
-00003580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003590: 2020 2020 2069 735f 6f62 6a65 6374 5f73       is_object_s
-000035a0: 7472 696e 675f 7365 7269 6573 286d 6574  tring_series(met
-000035b0: 6129 0a20 2020 2020 2020 2020 2020 2020  a).             
-000035c0: 2020 2020 2020 2020 2020 2061 6e64 206e             and n
-000035d0: 6f74 2069 735f 6f62 6a65 6374 5f73 7472  ot is_object_str
-000035e0: 696e 675f 6474 7970 6528 6d65 7461 2e64  ing_dtype(meta.d
-000035f0: 7479 7065 290a 2020 2020 2020 2020 2020  type).          
-00003600: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00003610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003620: 6f72 2069 735f 6f62 6a65 6374 5f73 7472  or is_object_str
-00003630: 696e 675f 696e 6465 7828 6d65 7461 290a  ing_index(meta).
-00003640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003650: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00003660: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-00003670: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00003680: 2074 6869 7320 6973 2061 6e20 696e 7465   this is an inte
-00003690: 726e 616c 2063 616c 6c2c 2061 6e64 2069  rnal call, and i
-000036a0: 6620 7765 2065 6e66 6f72 6365 206d 6574  f we enforce met
-000036b0: 6164 6174 612c 0a20 2020 2020 2020 2020  adata,.         
-000036c0: 2020 2020 2020 2023 2069 7420 6d61 7920         # it may 
-000036d0: 696e 7465 7266 6572 6520 7768 656e 2072  interfere when r
-000036e0: 6561 6469 6e67 2063 7376 2077 6974 6820  eading csv with 
-000036f0: 656e 666f 7263 653d 4661 6c73 650a 2020  enforce=False.  
-00003700: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00003710: 7375 6c74 203d 2073 656c 662e 6d61 705f  sult = self.map_
-00003720: 7061 7274 6974 696f 6e73 2874 6f5f 7079  partitions(to_py
-00003730: 6172 726f 775f 7374 7269 6e67 2c20 656e  arrow_string, en
-00003740: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
-00003750: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
-00003760: 2020 2020 2020 7365 6c66 2e64 6173 6b20        self.dask 
-00003770: 3d20 7265 7375 6c74 2e64 6173 6b0a 2020  = result.dask.  
-00003780: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00003790: 6c66 2e5f 6e61 6d65 203d 2072 6573 756c  lf._name = resul
-000037a0: 742e 5f6e 616d 650a 2020 2020 2020 2020  t._name.        
-000037b0: 2020 2020 2020 2020 7365 6c66 2e5f 6d65          self._me
-000037c0: 7461 203d 2072 6573 756c 742e 5f6d 6574  ta = result._met
-000037d0: 610a 2020 2020 2020 2020 2020 2020 2020  a.              
-000037e0: 2020 7365 6c66 2e64 6976 6973 696f 6e73    self.divisions
-000037f0: 203d 2072 6573 756c 742e 6469 7669 7369   = result.divisi
-00003800: 6f6e 730a 0a20 2020 2064 6566 205f 5f64  ons..    def __d
-00003810: 6173 6b5f 6772 6170 685f 5f28 7365 6c66  ask_graph__(self
-00003820: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00003830: 6e20 7365 6c66 2e64 6173 6b0a 0a20 2020  n self.dask..   
-00003840: 2064 6566 205f 5f64 6173 6b5f 6b65 7973   def __dask_keys
-00003850: 5f5f 2873 656c 6629 202d 3e20 6c69 7374  __(self) -> list
-00003860: 5b48 6173 6861 626c 655d 3a0a 2020 2020  [Hashable]:.    
-00003870: 2020 2020 7265 7475 726e 205b 2873 656c      return [(sel
-00003880: 662e 5f6e 616d 652c 2069 2920 666f 7220  f._name, i) for 
-00003890: 6920 696e 2072 616e 6765 2873 656c 662e  i in range(self.
-000038a0: 6e70 6172 7469 7469 6f6e 7329 5d0a 0a20  npartitions)].. 
-000038b0: 2020 2064 6566 205f 5f64 6173 6b5f 6c61     def __dask_la
-000038c0: 7965 7273 5f5f 2873 656c 6629 3a0a 2020  yers__(self):.  
-000038d0: 2020 2020 2020 7265 7475 726e 2028 7365        return (se
-000038e0: 6c66 2e5f 6e61 6d65 2c29 0a0a 2020 2020  lf._name,)..    
-000038f0: 6465 6620 5f5f 6461 736b 5f74 6f6b 656e  def __dask_token
-00003900: 697a 655f 5f28 7365 6c66 293a 0a20 2020  ize__(self):.   
-00003910: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00003920: 2e5f 6e61 6d65 0a0a 2020 2020 5f5f 6461  ._name..    __da
-00003930: 736b 5f6f 7074 696d 697a 655f 5f20 3d20  sk_optimize__ = 
-00003940: 676c 6f62 616c 6d65 7468 6f64 280a 2020  globalmethod(.  
-00003950: 2020 2020 2020 6f70 7469 6d69 7a65 2c20        optimize, 
-00003960: 6b65 793d 2264 6174 6166 7261 6d65 5f6f  key="dataframe_o
-00003970: 7074 696d 697a 6522 2c20 6661 6c73 6579  ptimize", falsey
-00003980: 3d64 6f6e 745f 6f70 7469 6d69 7a65 0a20  =dont_optimize. 
-00003990: 2020 2029 0a20 2020 205f 5f64 6173 6b5f     ).    __dask_
-000039a0: 7363 6865 6475 6c65 725f 5f20 3d20 7374  scheduler__ = st
-000039b0: 6174 6963 6d65 7468 6f64 2844 4546 4155  aticmethod(DEFAU
-000039c0: 4c54 5f47 4554 290a 0a20 2020 2064 6566  LT_GET)..    def
-000039d0: 205f 5f64 6173 6b5f 706f 7374 636f 6d70   __dask_postcomp
-000039e0: 7574 655f 5f28 7365 6c66 293a 0a20 2020  ute__(self):.   
-000039f0: 2020 2020 2072 6574 7572 6e20 6669 6e61       return fina
-00003a00: 6c69 7a65 2c20 2829 0a0a 2020 2020 6465  lize, ()..    de
-00003a10: 6620 5f5f 6461 736b 5f70 6f73 7470 6572  f __dask_postper
-00003a20: 7369 7374 5f5f 2873 656c 6629 3a0a 2020  sist__(self):.  
-00003a30: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00003a40: 662e 5f72 6562 7569 6c64 2c20 2829 0a0a  f._rebuild, ()..
-00003a50: 2020 2020 6465 6620 5f72 6562 7569 6c64      def _rebuild
-00003a60: 2873 656c 662c 2064 736b 2c20 2a2c 2072  (self, dsk, *, r
-00003a70: 656e 616d 653d 4e6f 6e65 293a 0a20 2020  ename=None):.   
-00003a80: 2020 2020 206e 616d 6520 3d20 7365 6c66       name = self
-00003a90: 2e5f 6e61 6d65 0a20 2020 2020 2020 2069  ._name.        i
-00003aa0: 6620 7265 6e61 6d65 3a0a 2020 2020 2020  f rename:.      
-00003ab0: 2020 2020 2020 6e61 6d65 203d 2072 656e        name = ren
-00003ac0: 616d 652e 6765 7428 6e61 6d65 2c20 6e61  ame.get(name, na
-00003ad0: 6d65 290a 2020 2020 2020 2020 7265 7475  me).        retu
-00003ae0: 726e 2074 7970 6528 7365 6c66 2928 6473  rn type(self)(ds
-00003af0: 6b2c 206e 616d 652c 2073 656c 662e 5f6d  k, name, self._m
-00003b00: 6574 612c 2073 656c 662e 6469 7669 7369  eta, self.divisi
-00003b10: 6f6e 7329 0a0a 2020 2020 4070 726f 7065  ons)..    @prope
-00003b20: 7274 790a 2020 2020 6465 6620 5f63 6f6e  rty.    def _con
-00003b30: 7374 7275 6374 6f72 2873 656c 6629 3a0a  structor(self):.
-00003b40: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-00003b50: 6577 5f64 645f 6f62 6a65 6374 0a0a 2020  ew_dd_object..  
-00003b60: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00003b70: 6465 6620 6469 7669 7369 6f6e 7328 7365  def divisions(se
-00003b80: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00003b90: 0a20 2020 2020 2020 2054 7570 6c65 206f  .        Tuple o
-00003ba0: 6620 6060 6e70 6172 7469 7469 6f6e 7320  f ``npartitions 
-00003bb0: 2b20 3160 6020 7661 6c75 6573 2c20 696e  + 1`` values, in
-00003bc0: 2061 7363 656e 6469 6e67 206f 7264 6572   ascending order
-00003bd0: 2c20 6d61 726b 696e 6720 7468 650a 2020  , marking the.  
-00003be0: 2020 2020 2020 6c6f 7765 722f 7570 7065        lower/uppe
-00003bf0: 7220 626f 756e 6473 206f 6620 6561 6368  r bounds of each
-00003c00: 2070 6172 7469 7469 6f6e 2773 2069 6e64   partition's ind
-00003c10: 6578 2e20 4469 7669 7369 6f6e 7320 616c  ex. Divisions al
-00003c20: 6c6f 7720 4461 736b 0a20 2020 2020 2020  low Dask.       
-00003c30: 2074 6f20 6b6e 6f77 2077 6869 6368 2070   to know which p
-00003c40: 6172 7469 7469 6f6e 2077 696c 6c20 636f  artition will co
-00003c50: 6e74 6169 6e20 6120 6769 7665 6e20 7661  ntain a given va
-00003c60: 6c75 652c 2073 6967 6e69 6669 6361 6e74  lue, significant
-00003c70: 6c79 0a20 2020 2020 2020 2073 7065 6564  ly.        speed
-00003c80: 696e 6720 7570 206f 7065 7261 7469 6f6e  ing up operation
-00003c90: 7320 6c69 6b65 2060 6c6f 6360 2c20 606d  s like `loc`, `m
-00003ca0: 6572 6765 602c 2061 6e64 2060 6772 6f75  erge`, and `grou
-00003cb0: 7062 7960 2062 7920 6e6f 740a 2020 2020  pby` by not.    
-00003cc0: 2020 2020 6861 7669 6e67 2074 6f20 7365      having to se
-00003cd0: 6172 6368 2074 6865 2066 756c 6c20 6461  arch the full da
-00003ce0: 7461 7365 742e 0a0a 2020 2020 2020 2020  taset...        
-00003cf0: 4578 616d 706c 653a 2066 6f72 2060 6064  Example: for ``d
-00003d00: 6976 6973 696f 6e73 203d 2028 302c 2031  ivisions = (0, 1
-00003d10: 302c 2035 302c 2031 3030 2960 602c 2074  0, 50, 100)``, t
-00003d20: 6865 7265 2061 7265 2074 6872 6565 2070  here are three p
-00003d30: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
-00003d40: 2020 2077 6865 7265 2074 6865 2069 6e64     where the ind
-00003d50: 6578 2069 6e20 6561 6368 2070 6172 7469  ex in each parti
-00003d60: 7469 6f6e 2063 6f6e 7461 696e 7320 7661  tion contains va
-00003d70: 6c75 6573 205b 302c 2031 3029 2c20 5b31  lues [0, 10), [1
-00003d80: 302c 2035 3029 2c0a 2020 2020 2020 2020  0, 50),.        
-00003d90: 616e 6420 5b35 302c 2031 3030 5d2c 2072  and [50, 100], r
-00003da0: 6573 7065 6374 6976 656c 792e 2044 6173  espectively. Das
-00003db0: 6b20 7468 6572 6566 6f72 6520 6b6e 6f77  k therefore know
-00003dc0: 7320 6060 6466 2e6c 6f63 5b34 355d 6060  s ``df.loc[45]``
-00003dd0: 0a20 2020 2020 2020 2077 696c 6c20 6265  .        will be
-00003de0: 2069 6e20 7468 6520 7365 636f 6e64 2070   in the second p
-00003df0: 6172 7469 7469 6f6e 2e0a 0a20 2020 2020  artition...     
-00003e00: 2020 2057 6865 6e20 6576 6572 7920 6974     When every it
-00003e10: 656d 2069 6e20 6060 6469 7669 7369 6f6e  em in ``division
-00003e20: 7360 6020 6973 2060 604e 6f6e 6560 602c  s`` is ``None``,
-00003e30: 2074 6865 2064 6976 6973 696f 6e73 2061   the divisions a
-00003e40: 7265 2075 6e6b 6e6f 776e 2e0a 2020 2020  re unknown..    
-00003e50: 2020 2020 4d6f 7374 206f 7065 7261 7469      Most operati
-00003e60: 6f6e 7320 6361 6e20 7374 696c 6c20 6265  ons can still be
-00003e70: 2070 6572 666f 726d 6564 2c20 6275 7420   performed, but 
-00003e80: 736f 6d65 2077 696c 6c20 6265 206d 7563  some will be muc
-00003e90: 6820 736c 6f77 6572 2c0a 2020 2020 2020  h slower,.      
-00003ea0: 2020 616e 6420 6120 6665 7720 6d61 7920    and a few may 
-00003eb0: 6661 696c 2e0a 0a20 2020 2020 2020 2049  fail...        I
-00003ec0: 7420 6973 2075 6e63 6f6d 6d6f 6e20 746f  t is uncommon to
-00003ed0: 2073 6574 2060 6064 6976 6973 696f 6e73   set ``divisions
-00003ee0: 6060 2064 6972 6563 746c 792e 2049 6e73  `` directly. Ins
-00003ef0: 7465 6164 2c20 7573 6520 6060 7365 745f  tead, use ``set_
-00003f00: 696e 6465 7860 602c 0a20 2020 2020 2020  index``,.       
-00003f10: 2077 6869 6368 2073 6f72 7473 2061 6e64   which sorts and
-00003f20: 2073 706c 6974 7320 7468 6520 6461 7461   splits the data
-00003f30: 2061 7320 6e65 6564 6564 2e0a 2020 2020   as needed..    
-00003f40: 2020 2020 5365 6520 6874 7470 733a 2f2f      See https://
-00003f50: 646f 6373 2e64 6173 6b2e 6f72 672f 656e  docs.dask.org/en
-00003f60: 2f6c 6174 6573 742f 6461 7461 6672 616d  /latest/datafram
-00003f70: 652d 6465 7369 676e 2e68 746d 6c23 7061  e-design.html#pa
-00003f80: 7274 6974 696f 6e73 2e0a 2020 2020 2020  rtitions..      
-00003f90: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-00003fa0: 7475 726e 2073 656c 662e 5f64 6976 6973  turn self._divis
-00003fb0: 696f 6e73 0a0a 2020 2020 4064 6976 6973  ions..    @divis
-00003fc0: 696f 6e73 2e73 6574 7465 720a 2020 2020  ions.setter.    
-00003fd0: 6465 6620 6469 7669 7369 6f6e 7328 7365  def divisions(se
-00003fe0: 6c66 2c20 7661 6c75 6529 3a0a 2020 2020  lf, value):.    
-00003ff0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-00004000: 7461 6e63 6528 7661 6c75 652c 2074 7570  tance(value, tup
-00004010: 6c65 293a 0a20 2020 2020 2020 2020 2020  le):.           
-00004020: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00004030: 2822 6469 7669 7369 6f6e 7320 6d75 7374  ("divisions must
-00004040: 2062 6520 6120 7475 706c 6522 290a 0a20   be a tuple").. 
-00004050: 2020 2020 2020 2069 6620 6861 7361 7474         if hasatt
-00004060: 7228 7365 6c66 2c20 225f 6469 7669 7369  r(self, "_divisi
-00004070: 6f6e 7322 2920 616e 6420 6c65 6e28 7661  ons") and len(va
-00004080: 6c75 6529 2021 3d20 6c65 6e28 7365 6c66  lue) != len(self
-00004090: 2e5f 6469 7669 7369 6f6e 7329 3a0a 2020  ._divisions):.  
-000040a0: 2020 2020 2020 2020 2020 6e20 3d20 6c65            n = le
-000040b0: 6e28 7365 6c66 2e5f 6469 7669 7369 6f6e  n(self._division
-000040c0: 7329 0a20 2020 2020 2020 2020 2020 2072  s).            r
-000040d0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-000040e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000040f0: 2066 2254 6869 7320 6461 7461 6672 616d   f"This datafram
-00004100: 6520 6861 7320 6e70 6172 7469 7469 6f6e  e has npartition
-00004110: 733d 7b6e 202d 2031 7d2c 2064 6976 6973  s={n - 1}, divis
-00004120: 696f 6e73 2073 686f 756c 6420 6265 2061  ions should be a
-00004130: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00004140: 2020 2066 2274 7570 6c65 206f 6620 6c65     f"tuple of le
-00004150: 6e67 7468 3d7b 6e7d 2c20 676f 7420 7b6c  ngth={n}, got {l
-00004160: 656e 2876 616c 7565 297d 220a 2020 2020  en(value)}".    
-00004170: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00004180: 2020 2069 6620 4e6f 6e65 2069 6e20 7661     if None in va
-00004190: 6c75 653a 0a20 2020 2020 2020 2020 2020  lue:.           
-000041a0: 2069 6620 616e 7928 7620 6973 206e 6f74   if any(v is not
-000041b0: 204e 6f6e 6520 666f 7220 7620 696e 2076   None for v in v
-000041c0: 616c 7565 293a 0a20 2020 2020 2020 2020  alue):.         
-000041d0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-000041e0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
-000041f0: 2020 2020 2020 2020 2020 2020 2022 6469               "di
-00004200: 7669 7369 6f6e 7320 6d61 7920 6e6f 7420  visions may not 
-00004210: 636f 6e74 6169 6e20 6120 6d69 7820 6f66  contain a mix of
-00004220: 204e 6f6e 6520 616e 6420 6e6f 6e2d 4e6f   None and non-No
-00004230: 6e65 2076 616c 7565 7322 0a20 2020 2020  ne values".     
-00004240: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00004250: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00004260: 2020 2020 2020 2023 204b 6e6f 776e 2064         # Known d
-00004270: 6976 6973 696f 6e73 2c20 6368 6563 6b20  ivisions, check 
-00004280: 6d6f 6e6f 746f 6e69 6361 6c6c 7920 696e  monotonically in
-00004290: 6372 6561 7369 6e67 0a0a 2020 2020 2020  creasing..      
-000042a0: 2020 2020 2020 2320 5858 583a 2069 6620        # XXX: if 
-000042b0: 7468 6520 696e 6465 7820 6474 7970 6520  the index dtype 
-000042c0: 6973 2061 6e20 6f72 6465 7265 6420 6361  is an ordered ca
-000042d0: 7465 676f 7269 6361 6c20 6474 7970 652c  tegorical dtype,
-000042e0: 2074 6865 6e20 7765 2073 6b69 7020 7468   then we skip th
-000042f0: 650a 2020 2020 2020 2020 2020 2020 2320  e.            # 
-00004300: 736f 7274 6564 6e65 7373 2063 6865 636b  sortedness check
-00004310: 2c20 7369 6e63 6520 7468 6520 6f72 6465  , since the orde
-00004320: 7220 6973 2064 7479 7065 2064 6570 656e  r is dtype depen
-00004330: 6465 6e74 0a20 2020 2020 2020 2020 2020  dent.           
-00004340: 2069 6e64 6578 5f64 7479 7065 203d 2067   index_dtype = g
-00004350: 6574 6174 7472 2873 656c 662e 5f6d 6574  etattr(self._met
-00004360: 612c 2022 696e 6465 7822 2c20 7365 6c66  a, "index", self
-00004370: 2e5f 6d65 7461 292e 6474 7970 650a 2020  ._meta).dtype.  
-00004380: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00004390: 2028 6973 5f63 6174 6567 6f72 6963 616c   (is_categorical
-000043a0: 5f64 7479 7065 2869 6e64 6578 5f64 7479  _dtype(index_dty
-000043b0: 7065 2920 616e 6420 696e 6465 785f 6474  pe) and index_dt
-000043c0: 7970 652e 6f72 6465 7265 6429 3a0a 2020  ype.ordered):.  
-000043d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000043e0: 2076 616c 7565 2021 3d20 7475 706c 6528   value != tuple(
-000043f0: 736f 7274 6564 2876 616c 7565 2929 3a0a  sorted(value)):.
-00004400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004410: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00004420: 7272 6f72 2822 6469 7669 7369 6f6e 7320  rror("divisions 
-00004430: 6d75 7374 2062 6520 736f 7274 6564 2229  must be sorted")
-00004440: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00004450: 6469 7669 7369 6f6e 7320 3d20 7661 6c75  divisions = valu
-00004460: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
-00004470: 0a20 2020 2064 6566 206e 7061 7274 6974  .    def npartit
-00004480: 696f 6e73 2873 656c 6629 202d 3e20 696e  ions(self) -> in
-00004490: 743a 0a20 2020 2020 2020 2022 2222 5265  t:.        """Re
-000044a0: 7475 726e 206e 756d 6265 7220 6f66 2070  turn number of p
-000044b0: 6172 7469 7469 6f6e 7322 2222 0a20 2020  artitions""".   
-000044c0: 2020 2020 2072 6574 7572 6e20 6c65 6e28       return len(
-000044d0: 7365 6c66 2e64 6976 6973 696f 6e73 2920  self.divisions) 
-000044e0: 2d20 310a 0a20 2020 2040 7072 6f70 6572  - 1..    @proper
-000044f0: 7479 0a20 2020 2040 6465 7269 7665 645f  ty.    @derived_
-00004500: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00004510: 6529 0a20 2020 2064 6566 2061 7474 7273  e).    def attrs
-00004520: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00004530: 7265 7475 726e 2073 656c 662e 5f6d 6574  return self._met
-00004540: 612e 6174 7472 730a 0a20 2020 2040 6174  a.attrs..    @at
-00004550: 7472 732e 7365 7474 6572 0a20 2020 2064  trs.setter.    d
-00004560: 6566 2061 7474 7273 2873 656c 662c 2076  ef attrs(self, v
-00004570: 616c 7565 293a 0a20 2020 2020 2020 2073  alue):.        s
-00004580: 656c 662e 5f6d 6574 612e 6174 7472 7320  elf._meta.attrs 
-00004590: 3d20 6469 6374 2876 616c 7565 290a 0a20  = dict(value).. 
-000045a0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-000045b0: 2064 6566 2073 697a 6528 7365 6c66 293a   def size(self):
-000045c0: 0a20 2020 2020 2020 2022 2222 5369 7a65  .        """Size
-000045d0: 206f 6620 7468 6520 5365 7269 6573 206f   of the Series o
-000045e0: 7220 4461 7461 4672 616d 6520 6173 2061  r DataFrame as a
-000045f0: 2044 656c 6179 6564 206f 626a 6563 742e   Delayed object.
-00004600: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00004610: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-00004620: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
-00004630: 7365 7269 6573 2e73 697a 6520 2023 2064  series.size  # d
-00004640: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
-00004650: 2020 2020 2020 6464 2e53 6361 6c61 723c        dd.Scalar<
-00004660: 7369 7a65 2d61 672e 2e2e 2c20 6474 7970  size-ag..., dtyp
-00004670: 653d 696e 7436 343e 0a20 2020 2020 2020  e=int64>.       
-00004680: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-00004690: 7572 6e20 7365 6c66 2e72 6564 7563 7469  urn self.reducti
-000046a0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-000046b0: 6d65 7468 6f64 732e 7369 7a65 2c20 6e70  methods.size, np
-000046c0: 2e73 756d 2c20 746f 6b65 6e3d 2273 697a  .sum, token="siz
-000046d0: 6522 2c20 6d65 7461 3d69 6e74 2c20 7370  e", meta=int, sp
-000046e0: 6c69 745f 6576 6572 793d 4661 6c73 650a  lit_every=False.
-000046f0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00004700: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00004710: 205f 6d65 7461 5f6e 6f6e 656d 7074 7928   _meta_nonempty(
-00004720: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00004730: 2222 4120 6e6f 6e2d 656d 7074 7920 7665  ""A non-empty ve
-00004740: 7273 696f 6e20 6f66 2060 5f6d 6574 6160  rsion of `_meta`
-00004750: 2077 6974 6820 6661 6b65 2064 6174 612e   with fake data.
-00004760: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00004770: 726e 206d 6574 615f 6e6f 6e65 6d70 7479  rn meta_nonempty
-00004780: 2873 656c 662e 5f6d 6574 6129 0a0a 2020  (self._meta)..  
-00004790: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-000047a0: 6465 6620 5f61 7267 7328 7365 6c66 293a  def _args(self):
-000047b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000047c0: 2873 656c 662e 6461 736b 2c20 7365 6c66  (self.dask, self
-000047d0: 2e5f 6e61 6d65 2c20 7365 6c66 2e5f 6d65  ._name, self._me
-000047e0: 7461 2c20 7365 6c66 2e64 6976 6973 696f  ta, self.divisio
-000047f0: 6e73 290a 0a20 2020 2064 6566 205f 5f67  ns)..    def __g
-00004800: 6574 7374 6174 655f 5f28 7365 6c66 293a  etstate__(self):
-00004810: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00004820: 7365 6c66 2e5f 6172 6773 0a0a 2020 2020  self._args..    
-00004830: 6465 6620 5f5f 7365 7473 7461 7465 5f5f  def __setstate__
-00004840: 2873 656c 662c 2073 7461 7465 293a 0a20  (self, state):. 
-00004850: 2020 2020 2020 2073 656c 662e 6461 736b         self.dask
-00004860: 2c20 7365 6c66 2e5f 6e61 6d65 2c20 7365  , self._name, se
-00004870: 6c66 2e5f 6d65 7461 2c20 7365 6c66 2e5f  lf._meta, self._
-00004880: 6469 7669 7369 6f6e 7320 3d20 7374 6174  divisions = stat
-00004890: 650a 0a20 2020 2064 6566 2063 6f70 7928  e..    def copy(
-000048a0: 7365 6c66 2c20 6465 6570 3d46 616c 7365  self, deep=False
-000048b0: 293a 0a20 2020 2020 2020 2022 2222 4d61  ):.        """Ma
-000048c0: 6b65 2061 2063 6f70 7920 6f66 2074 6865  ke a copy of the
-000048d0: 2064 6174 6166 7261 6d65 0a0a 2020 2020   dataframe..    
-000048e0: 2020 2020 5468 6973 2069 7320 7374 7269      This is stri
-000048f0: 6374 6c79 2061 2073 6861 6c6c 6f77 2063  ctly a shallow c
-00004900: 6f70 7920 6f66 2074 6865 2075 6e64 6572  opy of the under
-00004910: 6c79 696e 6720 636f 6d70 7574 6174 696f  lying computatio
-00004920: 6e61 6c20 6772 6170 682e 0a20 2020 2020  nal graph..     
-00004930: 2020 2049 7420 646f 6573 206e 6f74 2061     It does not a
-00004940: 6666 6563 7420 7468 6520 756e 6465 726c  ffect the underl
-00004950: 7969 6e67 2064 6174 610a 0a20 2020 2020  ying data..     
-00004960: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00004970: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00004980: 0a20 2020 2020 2020 2064 6565 7020 3a20  .        deep : 
-00004990: 626f 6f6c 6561 6e2c 2064 6566 6175 6c74  boolean, default
-000049a0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-000049b0: 2020 2054 6865 2064 6565 7020 7661 6c75     The deep valu
-000049c0: 6520 6d75 7374 2062 6520 6046 616c 7365  e must be `False
-000049d0: 6020 616e 6420 6974 2069 7320 6465 636c  ` and it is decl
-000049e0: 6172 6564 2061 7320 6120 7061 7261 6d65  ared as a parame
-000049f0: 7465 7220 6a75 7374 2066 6f72 0a20 2020  ter just for.   
-00004a00: 2020 2020 2020 2020 2063 6f6d 7061 7469           compati
-00004a10: 6269 6c69 7479 2077 6974 6820 7468 6972  bility with thir
-00004a20: 642d 7061 7274 7920 6c69 6272 6172 6965  d-party librarie
-00004a30: 7320 6c69 6b65 2063 7544 460a 2020 2020  s like cuDF.    
-00004a40: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00004a50: 6966 2064 6565 7020 6973 206e 6f74 2046  if deep is not F
-00004a60: 616c 7365 3a0a 2020 2020 2020 2020 2020  alse:.          
-00004a70: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00004a80: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00004a90: 2020 2020 2254 6865 2060 6465 6570 6020      "The `deep` 
-00004aa0: 7661 6c75 6520 6d75 7374 2062 6520 4661  value must be Fa
-00004ab0: 6c73 652e 2054 6869 7320 6973 2073 7472  lse. This is str
-00004ac0: 6963 746c 7920 6120 7368 616c 6c6f 7720  ictly a shallow 
-00004ad0: 636f 7079 2022 0a20 2020 2020 2020 2020  copy ".         
-00004ae0: 2020 2020 2020 2022 6f66 2074 6865 2075         "of the u
-00004af0: 6e64 6572 6c79 696e 6720 636f 6d70 7574  nderlying comput
-00004b00: 6174 696f 6e61 6c20 6772 6170 682e 220a  ational graph.".
-00004b10: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00004b20: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-00004b30: 5f64 645f 6f62 6a65 6374 2873 656c 662e  _dd_object(self.
-00004b40: 6461 736b 2c20 7365 6c66 2e5f 6e61 6d65  dask, self._name
-00004b50: 2c20 7365 6c66 2e5f 6d65 7461 2c20 7365  , self._meta, se
-00004b60: 6c66 2e64 6976 6973 696f 6e73 290a 0a20  lf.divisions).. 
-00004b70: 2020 2064 6566 205f 5f61 7272 6179 5f5f     def __array__
-00004b80: 2873 656c 662c 2064 7479 7065 3d4e 6f6e  (self, dtype=Non
-00004b90: 652c 202a 2a6b 7761 7267 7329 3a0a 2020  e, **kwargs):.  
-00004ba0: 2020 2020 2020 7365 6c66 2e5f 636f 6d70        self._comp
-00004bb0: 7574 6564 203d 2073 656c 662e 636f 6d70  uted = self.comp
-00004bc0: 7574 6528 290a 2020 2020 2020 2020 7820  ute().        x 
-00004bd0: 3d20 6e70 2e61 7272 6179 2873 656c 662e  = np.array(self.
-00004be0: 5f63 6f6d 7075 7465 6429 0a20 2020 2020  _computed).     
-00004bf0: 2020 2072 6574 7572 6e20 780a 0a20 2020     return x..   
-00004c00: 2064 6566 205f 5f61 7272 6179 5f77 7261   def __array_wra
-00004c10: 705f 5f28 7365 6c66 2c20 6172 7261 792c  p__(self, array,
-00004c20: 2063 6f6e 7465 7874 3d4e 6f6e 6529 3a0a   context=None):.
-00004c30: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-00004c40: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-00004c50: 720a 0a20 2020 2064 6566 205f 5f61 7272  r..    def __arr
-00004c60: 6179 5f75 6675 6e63 5f5f 2873 656c 662c  ay_ufunc__(self,
-00004c70: 206e 756d 7079 5f75 6675 6e63 2c20 6d65   numpy_ufunc, me
-00004c80: 7468 6f64 2c20 2a69 6e70 7574 732c 202a  thod, *inputs, *
-00004c90: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00004ca0: 2020 6f75 7420 3d20 6b77 6172 6773 2e67    out = kwargs.g
-00004cb0: 6574 2822 6f75 7422 2c20 2829 290a 2020  et("out", ()).  
-00004cc0: 2020 2020 2020 666f 7220 7820 696e 2069        for x in i
-00004cd0: 6e70 7574 7320 2b20 6f75 743a 0a20 2020  nputs + out:.   
-00004ce0: 2020 2020 2020 2020 2023 2075 6675 6e63           # ufunc
-00004cf0: 7320 776f 726b 2077 6974 6820 302d 6469  s work with 0-di
-00004d00: 6d65 6e73 696f 6e61 6c20 4e75 6d50 7920  mensional NumPy 
-00004d10: 6e64 6172 7261 7973 0a20 2020 2020 2020  ndarrays.       
-00004d20: 2020 2020 2023 2073 6f20 7765 2064 6f6e       # so we don
-00004d30: 2774 2077 616e 7420 746f 2072 6169 7365  't want to raise
-00004d40: 204e 6f74 496d 706c 656d 656e 7465 640a   NotImplemented.
-00004d50: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00004d60: 7369 6e73 7461 6e63 6528 782c 206e 702e  sinstance(x, np.
-00004d70: 6e64 6172 7261 7929 2061 6e64 2078 2e73  ndarray) and x.s
-00004d80: 6861 7065 203d 3d20 2829 3a0a 2020 2020  hape == ():.    
-00004d90: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-00004da0: 696e 7565 0a20 2020 2020 2020 2020 2020  inue.           
-00004db0: 2065 6c69 6620 6e6f 7420 6973 696e 7374   elif not isinst
-00004dc0: 616e 6365 280a 2020 2020 2020 2020 2020  ance(.          
-00004dd0: 2020 2020 2020 782c 2028 4e75 6d62 6572        x, (Number
-00004de0: 2c20 5363 616c 6172 2c20 5f46 7261 6d65  , Scalar, _Frame
-00004df0: 2c20 4172 7261 792c 2070 642e 4461 7461  , Array, pd.Data
-00004e00: 4672 616d 652c 2070 642e 5365 7269 6573  Frame, pd.Series
-00004e10: 2c20 7064 2e49 6e64 6578 290a 2020 2020  , pd.Index).    
-00004e20: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-00004e30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00004e40: 6e20 4e6f 7449 6d70 6c65 6d65 6e74 6564  n NotImplemented
-00004e50: 0a0a 2020 2020 2020 2020 6966 206d 6574  ..        if met
-00004e60: 686f 6420 3d3d 2022 5f5f 6361 6c6c 5f5f  hod == "__call__
-00004e70: 223a 0a20 2020 2020 2020 2020 2020 2069  ":.            i
-00004e80: 6620 6e75 6d70 795f 7566 756e 632e 7369  f numpy_ufunc.si
-00004e90: 676e 6174 7572 6520 6973 206e 6f74 204e  gnature is not N
-00004ea0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00004eb0: 2020 2020 2072 6574 7572 6e20 4e6f 7449       return NotI
-00004ec0: 6d70 6c65 6d65 6e74 6564 0a20 2020 2020  mplemented.     
-00004ed0: 2020 2020 2020 2069 6620 6e75 6d70 795f         if numpy_
-00004ee0: 7566 756e 632e 6e6f 7574 203e 2031 3a0a  ufunc.nout > 1:.
-00004ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004f00: 2320 7566 756e 6373 2077 6974 6820 6d75  # ufuncs with mu
-00004f10: 6c74 6970 6c65 206f 7574 7075 7420 7661  ltiple output va
-00004f20: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
-00004f30: 2020 2020 2023 2061 7265 206e 6f74 2079       # are not y
-00004f40: 6574 2073 7570 706f 7274 6564 2066 6f72  et supported for
-00004f50: 2066 7261 6d65 730a 2020 2020 2020 2020   frames.        
-00004f60: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-00004f70: 6f74 496d 706c 656d 656e 7465 640a 2020  otImplemented.  
-00004f80: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00004f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004fa0: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
-00004fb0: 6e75 6d70 795f 7566 756e 632c 202a 696e  numpy_ufunc, *in
-00004fc0: 7075 7473 2c20 2a2a 6b77 6172 6773 290a  puts, **kwargs).
-00004fd0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00004fe0: 2020 2020 2020 2020 2020 2320 7566 756e            # ufun
-00004ff0: 6320 6d65 7468 6f64 7320 6172 6520 6e6f  c methods are no
-00005000: 7420 7965 7420 7375 7070 6f72 7465 6420  t yet supported 
-00005010: 666f 7220 6672 616d 6573 0a20 2020 2020  for frames.     
-00005020: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-00005030: 7449 6d70 6c65 6d65 6e74 6564 0a0a 2020  tImplemented..  
-00005040: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00005050: 6465 6620 5f65 6c65 6d77 6973 6528 7365  def _elemwise(se
-00005060: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00005070: 7572 6e20 656c 656d 7769 7365 0a0a 2020  urn elemwise..  
-00005080: 2020 6465 6620 5f72 6570 725f 6461 7461    def _repr_data
-00005090: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000050a0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-000050b0: 6e74 6564 4572 726f 720a 0a20 2020 2040  ntedError..    @
-000050c0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-000050d0: 205f 7265 7072 5f64 6976 6973 696f 6e73   _repr_divisions
-000050e0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000050f0: 6e61 6d65 203d 2066 226e 7061 7274 6974  name = f"npartit
-00005100: 696f 6e73 3d7b 7365 6c66 2e6e 7061 7274  ions={self.npart
-00005110: 6974 696f 6e73 7d22 0a20 2020 2020 2020  itions}".       
-00005120: 2069 6620 7365 6c66 2e6b 6e6f 776e 5f64   if self.known_d
-00005130: 6976 6973 696f 6e73 3a0a 2020 2020 2020  ivisions:.      
-00005140: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
-00005150: 3d20 7064 2e49 6e64 6578 2873 656c 662e  = pd.Index(self.
-00005160: 6469 7669 7369 6f6e 732c 206e 616d 653d  divisions, name=
-00005170: 6e61 6d65 290a 2020 2020 2020 2020 656c  name).        el
-00005180: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00005190: 2320 6176 6f69 6420 746f 2062 6520 636f  # avoid to be co
-000051a0: 6e76 6572 7465 6420 746f 204e 614e 0a20  nverted to NaN. 
-000051b0: 2020 2020 2020 2020 2020 2064 6976 6973             divis
-000051c0: 696f 6e73 203d 2070 642e 496e 6465 7828  ions = pd.Index(
-000051d0: 5b22 225d 202a 2028 7365 6c66 2e6e 7061  [""] * (self.npa
-000051e0: 7274 6974 696f 6e73 202b 2031 292c 206e  rtitions + 1), n
-000051f0: 616d 653d 6e61 6d65 290a 2020 2020 2020  ame=name).      
-00005200: 2020 7265 7475 726e 2064 6976 6973 696f    return divisio
-00005210: 6e73 0a0a 2020 2020 6465 6620 5f5f 7265  ns..    def __re
-00005220: 7072 5f5f 2873 656c 6629 3a0a 2020 2020  pr__(self):.    
-00005230: 2020 2020 6461 7461 203d 2073 656c 662e      data = self.
-00005240: 5f72 6570 725f 6461 7461 2829 2e74 6f5f  _repr_data().to_
-00005250: 7374 7269 6e67 286d 6178 5f72 6f77 733d  string(max_rows=
-00005260: 352c 2073 686f 775f 6469 6d65 6e73 696f  5, show_dimensio
-00005270: 6e73 3d46 616c 7365 290a 2020 2020 2020  ns=False).      
-00005280: 2020 5f73 7472 5f66 6d74 203d 2022 2222    _str_fmt = """
-00005290: 4461 736b 207b 6b6c 6173 737d 2053 7472  Dask {klass} Str
-000052a0: 7563 7475 7265 3a0a 7b64 6174 617d 0a44  ucture:.{data}.D
-000052b0: 6173 6b20 4e61 6d65 3a20 7b6e 616d 657d  ask Name: {name}
-000052c0: 2c20 7b6c 6179 6572 737d 2222 220a 2020  , {layers}""".  
-000052d0: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-000052e0: 662e 636f 6c75 6d6e 7329 203d 3d20 303a  f.columns) == 0:
-000052f0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00005300: 6120 3d20 6461 7461 2e70 6172 7469 7469  a = data.partiti
-00005310: 6f6e 2822 5c6e 2229 5b2d 315d 2e72 6570  on("\n")[-1].rep
-00005320: 6c61 6365 2822 496e 6465 7822 2c20 2244  lace("Index", "D
-00005330: 6976 6973 696f 6e73 2229 0a20 2020 2020  ivisions").     
-00005340: 2020 2020 2020 205f 7374 725f 666d 7420         _str_fmt 
-00005350: 3d20 6622 456d 7074 7920 7b5f 7374 725f  = f"Empty {_str_
-00005360: 666d 747d 220a 2020 2020 2020 2020 7265  fmt}".        re
-00005370: 7475 726e 205f 7374 725f 666d 742e 666f  turn _str_fmt.fo
-00005380: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
-00005390: 2020 6b6c 6173 733d 7365 6c66 2e5f 5f63    klass=self.__c
-000053a0: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f2c  lass__.__name__,
-000053b0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-000053c0: 613d 6461 7461 2c0a 2020 2020 2020 2020  a=data,.        
-000053d0: 2020 2020 6e61 6d65 3d6b 6579 5f73 706c      name=key_spl
-000053e0: 6974 2873 656c 662e 5f6e 616d 6529 2c0a  it(self._name),.
-000053f0: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
-00005400: 7273 3d6d 6179 6265 5f70 6c75 7261 6c69  rs=maybe_plurali
-00005410: 7a65 286c 656e 2873 656c 662e 6461 736b  ze(len(self.dask
-00005420: 2e6c 6179 6572 7329 2c20 2267 7261 7068  .layers), "graph
-00005430: 206c 6179 6572 2229 2c0a 2020 2020 2020   layer"),.      
-00005440: 2020 290a 0a20 2020 2040 7072 6f70 6572    )..    @proper
-00005450: 7479 0a20 2020 2064 6566 2069 6e64 6578  ty.    def index
-00005460: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00005470: 2222 2252 6574 7572 6e20 6461 736b 2049  """Return dask I
-00005480: 6e64 6578 2069 6e73 7461 6e63 6522 2222  ndex instance"""
-00005490: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000054a0: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-000054b0: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-000054c0: 2067 6574 6174 7472 2c0a 2020 2020 2020   getattr,.      
-000054d0: 2020 2020 2020 2269 6e64 6578 222c 0a20        "index",. 
-000054e0: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
-000054f0: 3d6b 6579 5f73 706c 6974 2873 656c 662e  =key_split(self.
-00005500: 5f6e 616d 6529 202b 2022 2d69 6e64 6578  _name) + "-index
-00005510: 222c 0a20 2020 2020 2020 2020 2020 206d  ",.            m
-00005520: 6574 613d 7365 6c66 2e5f 6d65 7461 2e69  eta=self._meta.i
-00005530: 6e64 6578 2c0a 2020 2020 2020 2020 2020  ndex,.          
-00005540: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
-00005550: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
-00005560: 2020 290a 0a20 2020 2040 696e 6465 782e    )..    @index.
-00005570: 7365 7474 6572 0a20 2020 2064 6566 2069  setter.    def i
-00005580: 6e64 6578 2873 656c 662c 2076 616c 7565  ndex(self, value
-00005590: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-000055a0: 6469 7669 7369 6f6e 7320 3d20 7661 6c75  divisions = valu
-000055b0: 652e 6469 7669 7369 6f6e 730a 2020 2020  e.divisions.    
-000055c0: 2020 2020 7265 7375 6c74 203d 206d 6170      result = map
-000055d0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-000055e0: 2020 2020 2020 2020 206d 6574 686f 6473           methods
-000055f0: 2e61 7373 6967 6e5f 696e 6465 782c 2073  .assign_index, s
-00005600: 656c 662c 2076 616c 7565 2c20 656e 666f  elf, value, enfo
-00005610: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
-00005620: 7365 0a20 2020 2020 2020 2029 0a20 2020  se.        ).   
-00005630: 2020 2020 2073 656c 662e 6461 736b 203d       self.dask =
-00005640: 2072 6573 756c 742e 6461 736b 0a20 2020   result.dask.   
-00005650: 2020 2020 2073 656c 662e 5f6e 616d 6520       self._name 
-00005660: 3d20 7265 7375 6c74 2e5f 6e61 6d65 0a20  = result._name. 
-00005670: 2020 2020 2020 2073 656c 662e 5f6d 6574         self._met
-00005680: 6120 3d20 7265 7375 6c74 2e5f 6d65 7461  a = result._meta
-00005690: 0a0a 2020 2020 6465 6620 7265 7365 745f  ..    def reset_
-000056a0: 696e 6465 7828 7365 6c66 2c20 6472 6f70  index(self, drop
-000056b0: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
-000056c0: 2022 2222 5265 7365 7420 7468 6520 696e   """Reset the in
-000056d0: 6465 7820 746f 2074 6865 2064 6566 6175  dex to the defau
-000056e0: 6c74 2069 6e64 6578 2e0a 0a20 2020 2020  lt index...     
-000056f0: 2020 204e 6f74 6520 7468 6174 2075 6e6c     Note that unl
-00005700: 696b 6520 696e 2060 6070 616e 6461 7360  ike in ``pandas`
-00005710: 602c 2074 6865 2072 6573 6574 2060 6064  `, the reset ``d
-00005720: 6173 6b2e 6461 7461 6672 616d 6560 6020  ask.dataframe`` 
-00005730: 696e 6465 7820 7769 6c6c 0a20 2020 2020  index will.     
-00005740: 2020 206e 6f74 2062 6520 6d6f 6e6f 746f     not be monoto
-00005750: 6e69 6361 6c6c 7920 696e 6372 6561 7369  nically increasi
-00005760: 6e67 2066 726f 6d20 302e 2049 6e73 7465  ng from 0. Inste
-00005770: 6164 2c20 6974 2077 696c 6c20 7265 7374  ad, it will rest
-00005780: 6172 7420 6174 2030 0a20 2020 2020 2020  art at 0.       
-00005790: 2066 6f72 2065 6163 6820 7061 7274 6974   for each partit
-000057a0: 696f 6e20 2865 2e67 2e20 6060 696e 6465  ion (e.g. ``inde
-000057b0: 7831 203d 205b 302c 202e 2e2e 2c20 3130  x1 = [0, ..., 10
-000057c0: 5d2c 2069 6e64 6578 3220 3d20 5b30 2c20  ], index2 = [0, 
-000057d0: 2e2e 2e5d 6060 292e 0a20 2020 2020 2020  ...]``)..       
-000057e0: 2054 6869 7320 6973 2064 7565 2074 6f20   This is due to 
-000057f0: 7468 6520 696e 6162 696c 6974 7920 746f  the inability to
-00005800: 2073 7461 7469 6361 6c6c 7920 6b6e 6f77   statically know
-00005810: 2074 6865 2066 756c 6c20 6c65 6e67 7468   the full length
-00005820: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
-00005830: 696e 6465 782e 0a0a 2020 2020 2020 2020  index...        
-00005840: 466f 7220 4461 7461 4672 616d 6520 7769  For DataFrame wi
-00005850: 7468 206d 756c 7469 2d6c 6576 656c 2069  th multi-level i
-00005860: 6e64 6578 2c20 7265 7475 726e 7320 6120  ndex, returns a 
-00005870: 6e65 7720 4461 7461 4672 616d 6520 7769  new DataFrame wi
-00005880: 7468 0a20 2020 2020 2020 206c 6162 656c  th.        label
-00005890: 696e 6720 696e 666f 726d 6174 696f 6e20  ing information 
-000058a0: 696e 2074 6865 2063 6f6c 756d 6e73 2075  in the columns u
-000058b0: 6e64 6572 2074 6865 2069 6e64 6578 206e  nder the index n
-000058c0: 616d 6573 2c20 6465 6661 756c 7469 6e67  ames, defaulting
-000058d0: 0a20 2020 2020 2020 2074 6f20 276c 6576  .        to 'lev
-000058e0: 656c 5f30 272c 2027 6c65 7665 6c5f 3127  el_0', 'level_1'
-000058f0: 2c20 6574 632e 2069 6620 616e 7920 6172  , etc. if any ar
-00005900: 6520 4e6f 6e65 2e20 466f 7220 6120 7374  e None. For a st
-00005910: 616e 6461 7264 2069 6e64 6578 2c0a 2020  andard index,.  
-00005920: 2020 2020 2020 7468 6520 696e 6465 7820        the index 
-00005930: 6e61 6d65 2077 696c 6c20 6265 2075 7365  name will be use
-00005940: 6420 2869 6620 7365 7429 2c20 6f74 6865  d (if set), othe
-00005950: 7277 6973 6520 6120 6465 6661 756c 7420  rwise a default 
-00005960: 2769 6e64 6578 2720 6f72 0a20 2020 2020  'index' or.     
-00005970: 2020 2027 6c65 7665 6c5f 3027 2028 6966     'level_0' (if
-00005980: 2027 696e 6465 7827 2069 7320 616c 7265   'index' is alre
-00005990: 6164 7920 7461 6b65 6e29 2077 696c 6c20  ady taken) will 
-000059a0: 6265 2075 7365 642e 0a0a 2020 2020 2020  be used...      
-000059b0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-000059c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-000059d0: 2020 2020 2020 2020 6472 6f70 203a 2062          drop : b
-000059e0: 6f6f 6c65 616e 2c20 6465 6661 756c 7420  oolean, default 
-000059f0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00005a00: 2020 446f 206e 6f74 2074 7279 2074 6f20    Do not try to 
-00005a10: 696e 7365 7274 2069 6e64 6578 2069 6e74  insert index int
-00005a20: 6f20 6461 7461 6672 616d 6520 636f 6c75  o dataframe colu
-00005a30: 6d6e 732e 0a20 2020 2020 2020 2022 2222  mns..        """
-00005a40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00005a50: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-00005a60: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-00005a70: 204d 2e72 6573 6574 5f69 6e64 6578 2c20   M.reset_index, 
-00005a80: 6472 6f70 3d64 726f 702c 2065 6e66 6f72  drop=drop, enfor
-00005a90: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-00005aa0: 650a 2020 2020 2020 2020 292e 636c 6561  e.        ).clea
-00005ab0: 725f 6469 7669 7369 6f6e 7328 290a 0a20  r_divisions().. 
-00005ac0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00005ad0: 2064 6566 206b 6e6f 776e 5f64 6976 6973   def known_divis
-00005ae0: 696f 6e73 2873 656c 6629 3a0a 2020 2020  ions(self):.    
-00005af0: 2020 2020 2222 2257 6865 7468 6572 2064      """Whether d
-00005b00: 6976 6973 696f 6e73 2061 7265 2061 6c72  ivisions are alr
-00005b10: 6561 6479 206b 6e6f 776e 2222 220a 2020  eady known""".  
-00005b20: 2020 2020 2020 7265 7475 726e 206c 656e        return len
-00005b30: 2873 656c 662e 6469 7669 7369 6f6e 7329  (self.divisions)
-00005b40: 203e 2030 2061 6e64 2073 656c 662e 6469   > 0 and self.di
-00005b50: 7669 7369 6f6e 735b 305d 2069 7320 6e6f  visions[0] is no
-00005b60: 7420 4e6f 6e65 0a0a 2020 2020 6465 6620  t None..    def 
-00005b70: 636c 6561 725f 6469 7669 7369 6f6e 7328  clear_divisions(
-00005b80: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00005b90: 2222 466f 7267 6574 2064 6976 6973 696f  ""Forget divisio
-00005ba0: 6e20 696e 666f 726d 6174 696f 6e22 2222  n information"""
-00005bb0: 0a20 2020 2020 2020 2064 6976 6973 696f  .        divisio
-00005bc0: 6e73 203d 2028 4e6f 6e65 2c29 202a 2028  ns = (None,) * (
-00005bd0: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
-00005be0: 202b 2031 290a 2020 2020 2020 2020 7265   + 1).        re
-00005bf0: 7475 726e 2074 7970 6528 7365 6c66 2928  turn type(self)(
-00005c00: 7365 6c66 2e64 6173 6b2c 2073 656c 662e  self.dask, self.
-00005c10: 5f6e 616d 652c 2073 656c 662e 5f6d 6574  _name, self._met
-00005c20: 612c 2064 6976 6973 696f 6e73 290a 0a20  a, divisions).. 
-00005c30: 2020 2064 6566 2063 6f6d 7075 7465 5f63     def compute_c
-00005c40: 7572 7265 6e74 5f64 6976 6973 696f 6e73  urrent_divisions
-00005c50: 2873 656c 662c 2063 6f6c 3d4e 6f6e 6529  (self, col=None)
-00005c60: 3a0a 2020 2020 2020 2020 2222 2243 6f6d  :.        """Com
-00005c70: 7075 7465 2074 6865 2063 7572 7265 6e74  pute the current
-00005c80: 2064 6976 6973 696f 6e73 206f 6620 7468   divisions of th
-00005c90: 6520 4461 7461 4672 616d 652e 0a0a 2020  e DataFrame...  
-00005ca0: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
-00005cb0: 6420 7472 6967 6765 7273 2069 6d6d 6564  d triggers immed
-00005cc0: 6961 7465 2063 6f6d 7075 7461 7469 6f6e  iate computation
-00005cd0: 2e20 4966 2079 6f75 2066 696e 6420 796f  . If you find yo
-00005ce0: 7572 7365 6c66 2072 756e 6e69 6e67 2074  urself running t
-00005cf0: 6869 7320 636f 6d6d 616e 640a 2020 2020  his command.    
-00005d00: 2020 2020 7265 7065 6174 6564 6c79 2066      repeatedly f
-00005d10: 6f72 2074 6865 2073 616d 6520 6461 7461  or the same data
-00005d20: 6672 616d 652c 2077 6520 7265 636f 6d6d  frame, we recomm
-00005d30: 656e 6420 7374 6f72 696e 6720 7468 6520  end storing the 
-00005d40: 7265 7375 6c74 0a20 2020 2020 2020 2073  result.        s
-00005d50: 6f20 796f 7520 646f 6e27 7420 6861 7665  o you don't have
-00005d60: 2074 6f20 7265 7275 6e20 6974 2e0a 0a20   to rerun it... 
-00005d70: 2020 2020 2020 2049 6620 7468 6520 636f         If the co
-00005d80: 6c75 6d6e 206f 7220 696e 6465 7820 7661  lumn or index va
-00005d90: 6c75 6573 206f 7665 726c 6170 2062 6574  lues overlap bet
-00005da0: 7765 656e 2070 6172 7469 7469 6f6e 732c  ween partitions,
-00005db0: 2072 6169 7365 7320 6060 5661 6c75 6545   raises ``ValueE
-00005dc0: 7272 6f72 6060 2e0a 2020 2020 2020 2020  rror``..        
-00005dd0: 546f 2070 7265 7665 6e74 2074 6869 732c  To prevent this,
-00005de0: 206d 616b 6520 7375 7265 2074 6865 2064   make sure the d
-00005df0: 6174 6120 6172 6520 736f 7274 6564 2062  ata are sorted b
-00005e00: 7920 7468 6520 636f 6c75 6d6e 206f 7220  y the column or 
-00005e10: 696e 6465 782e 0a0a 2020 2020 2020 2020  index...        
-00005e20: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00005e30: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00005e40: 2020 2020 2020 636f 6c20 3a20 7374 7269        col : stri
-00005e50: 6e67 2c20 6f70 7469 6f6e 616c 0a20 2020  ng, optional.   
-00005e60: 2020 2020 2020 2020 2043 616c 6375 6c61           Calcula
-00005e70: 7465 2074 6865 2064 6976 6973 696f 6e73  te the divisions
-00005e80: 2066 6f72 2061 206e 6f6e 2d69 6e64 6578   for a non-index
-00005e90: 2063 6f6c 756d 6e20 6279 2070 6173 7369   column by passi
-00005ea0: 6e67 2069 6e20 7468 6520 6e61 6d65 206f  ng in the name o
-00005eb0: 6620 7468 6520 636f 6c75 6d6e 2e0a 2020  f the column..  
-00005ec0: 2020 2020 2020 2020 2020 4966 2063 6f6c            If col
-00005ed0: 2069 7320 6e6f 7420 7370 6563 6966 6965   is not specifie
-00005ee0: 642c 2074 6865 2069 6e64 6578 2077 696c  d, the index wil
-00005ef0: 6c20 6265 2075 7365 6420 746f 2063 616c  l be used to cal
-00005f00: 6375 6c61 7465 2064 6976 6973 696f 6e73  culate divisions
-00005f10: 2e0a 2020 2020 2020 2020 2020 2020 496e  ..            In
-00005f20: 2074 6869 7320 6361 7365 2c20 6966 2074   this case, if t
-00005f30: 6865 2064 6976 6973 696f 6e73 2061 7265  he divisions are
-00005f40: 2061 6c72 6561 6479 206b 6e6f 776e 2c20   already known, 
-00005f50: 7468 6579 2077 696c 6c20 6265 2072 6574  they will be ret
-00005f60: 7572 6e65 640a 2020 2020 2020 2020 2020  urned.          
-00005f70: 2020 696d 6d65 6469 6174 656c 7920 7769    immediately wi
-00005f80: 7468 6f75 7420 636f 6d70 7574 696e 672e  thout computing.
-00005f90: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00005fa0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-00005fb0: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
-00005fc0: 696d 706f 7274 2064 6173 6b0a 2020 2020  import dask.    
-00005fd0: 2020 2020 3e3e 3e20 6464 6620 3d20 6461      >>> ddf = da
-00005fe0: 736b 2e64 6174 6173 6574 732e 7469 6d65  sk.datasets.time
-00005ff0: 7365 7269 6573 2873 7461 7274 3d22 3230  series(start="20
-00006000: 3231 2d30 312d 3031 222c 2065 6e64 3d22  21-01-01", end="
-00006010: 3230 3231 2d30 312d 3037 222c 2066 7265  2021-01-07", fre
-00006020: 713d 2231 4822 292e 636c 6561 725f 6469  q="1H").clear_di
-00006030: 7669 7369 6f6e 7328 290a 2020 2020 2020  visions().      
-00006040: 2020 3e3e 3e20 6469 7669 7369 6f6e 7320    >>> divisions 
-00006050: 3d20 6464 662e 636f 6d70 7574 655f 6375  = ddf.compute_cu
-00006060: 7272 656e 745f 6469 7669 7369 6f6e 7328  rrent_divisions(
-00006070: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
-00006080: 696e 7428 6469 7669 7369 6f6e 7329 2020  int(divisions)  
-00006090: 2320 646f 6374 6573 743a 202b 4e4f 524d  # doctest: +NORM
-000060a0: 414c 495a 455f 5748 4954 4553 5041 4345  ALIZE_WHITESPACE
-000060b0: 0a20 2020 2020 2020 2028 5469 6d65 7374  .        (Timest
-000060c0: 616d 7028 2732 3032 312d 3031 2d30 3120  amp('2021-01-01 
-000060d0: 3030 3a30 303a 3030 2729 2c0a 2020 2020  00:00:00'),.    
-000060e0: 2020 2020 2054 696d 6573 7461 6d70 2827       Timestamp('
-000060f0: 3230 3231 2d30 312d 3032 2030 303a 3030  2021-01-02 00:00
-00006100: 3a30 3027 292c 0a20 2020 2020 2020 2020  :00'),.         
-00006110: 5469 6d65 7374 616d 7028 2732 3032 312d  Timestamp('2021-
-00006120: 3031 2d30 3320 3030 3a30 303a 3030 2729  01-03 00:00:00')
-00006130: 2c0a 2020 2020 2020 2020 2054 696d 6573  ,.         Times
-00006140: 7461 6d70 2827 3230 3231 2d30 312d 3034  tamp('2021-01-04
-00006150: 2030 303a 3030 3a30 3027 292c 0a20 2020   00:00:00'),.   
-00006160: 2020 2020 2020 5469 6d65 7374 616d 7028        Timestamp(
-00006170: 2732 3032 312d 3031 2d30 3520 3030 3a30  '2021-01-05 00:0
-00006180: 303a 3030 2729 2c0a 2020 2020 2020 2020  0:00'),.        
-00006190: 2054 696d 6573 7461 6d70 2827 3230 3231   Timestamp('2021
-000061a0: 2d30 312d 3036 2030 303a 3030 3a30 3027  -01-06 00:00:00'
-000061b0: 292c 0a20 2020 2020 2020 2020 5469 6d65  ),.         Time
-000061c0: 7374 616d 7028 2732 3032 312d 3031 2d30  stamp('2021-01-0
-000061d0: 3620 3233 3a30 303a 3030 2729 290a 0a20  6 23:00:00')).. 
-000061e0: 2020 2020 2020 203e 3e3e 2064 6466 2e64         >>> ddf.d
-000061f0: 6976 6973 696f 6e73 203d 2064 6976 6973  ivisions = divis
-00006200: 696f 6e73 0a20 2020 2020 2020 203e 3e3e  ions.        >>>
-00006210: 2064 6466 2e6b 6e6f 776e 5f64 6976 6973   ddf.known_divis
-00006220: 696f 6e73 0a20 2020 2020 2020 2054 7275  ions.        Tru
-00006230: 650a 0a20 2020 2020 2020 203e 3e3e 2064  e..        >>> d
-00006240: 6466 203d 2064 6466 2e72 6573 6574 5f69  df = ddf.reset_i
-00006250: 6e64 6578 2829 2e63 6c65 6172 5f64 6976  ndex().clear_div
-00006260: 6973 696f 6e73 2829 0a20 2020 2020 2020  isions().       
-00006270: 203e 3e3e 2064 6976 6973 696f 6e73 203d   >>> divisions =
-00006280: 2064 6466 2e63 6f6d 7075 7465 5f63 7572   ddf.compute_cur
-00006290: 7265 6e74 5f64 6976 6973 696f 6e73 2822  rent_divisions("
-000062a0: 7469 6d65 7374 616d 7022 290a 2020 2020  timestamp").    
-000062b0: 2020 2020 3e3e 3e20 7072 696e 7428 6469      >>> print(di
-000062c0: 7669 7369 6f6e 7329 2020 2320 646f 6374  visions)  # doct
-000062d0: 6573 743a 202b 4e4f 524d 414c 495a 455f  est: +NORMALIZE_
-000062e0: 5748 4954 4553 5041 4345 0a20 2020 2020  WHITESPACE.     
-000062f0: 2020 2028 5469 6d65 7374 616d 7028 2732     (Timestamp('2
-00006300: 3032 312d 3031 2d30 3120 3030 3a30 303a  021-01-01 00:00:
-00006310: 3030 2729 2c0a 2020 2020 2020 2020 2054  00'),.         T
-00006320: 696d 6573 7461 6d70 2827 3230 3231 2d30  imestamp('2021-0
-00006330: 312d 3032 2030 303a 3030 3a30 3027 292c  1-02 00:00:00'),
-00006340: 0a20 2020 2020 2020 2020 5469 6d65 7374  .         Timest
-00006350: 616d 7028 2732 3032 312d 3031 2d30 3320  amp('2021-01-03 
-00006360: 3030 3a30 303a 3030 2729 2c0a 2020 2020  00:00:00'),.    
-00006370: 2020 2020 2054 696d 6573 7461 6d70 2827       Timestamp('
-00006380: 3230 3231 2d30 312d 3034 2030 303a 3030  2021-01-04 00:00
-00006390: 3a30 3027 292c 0a20 2020 2020 2020 2020  :00'),.         
-000063a0: 5469 6d65 7374 616d 7028 2732 3032 312d  Timestamp('2021-
-000063b0: 3031 2d30 3520 3030 3a30 303a 3030 2729  01-05 00:00:00')
-000063c0: 2c0a 2020 2020 2020 2020 2054 696d 6573  ,.         Times
-000063d0: 7461 6d70 2827 3230 3231 2d30 312d 3036  tamp('2021-01-06
-000063e0: 2030 303a 3030 3a30 3027 292c 0a20 2020   00:00:00'),.   
-000063f0: 2020 2020 2020 5469 6d65 7374 616d 7028        Timestamp(
-00006400: 2732 3032 312d 3031 2d30 3620 3233 3a30  '2021-01-06 23:0
-00006410: 303a 3030 2729 290a 0a20 2020 2020 2020  0:00'))..       
-00006420: 203e 3e3e 2064 6466 203d 2064 6466 2e73   >>> ddf = ddf.s
-00006430: 6574 5f69 6e64 6578 2822 7469 6d65 7374  et_index("timest
-00006440: 616d 7022 2c20 6469 7669 7369 6f6e 733d  amp", divisions=
-00006450: 6469 7669 7369 6f6e 732c 2073 6f72 7465  divisions, sorte
-00006460: 643d 5472 7565 290a 2020 2020 2020 2020  d=True).        
-00006470: 2222 220a 2020 2020 2020 2020 6966 2063  """.        if c
-00006480: 6f6c 2069 7320 4e6f 6e65 2061 6e64 2073  ol is None and s
-00006490: 656c 662e 6b6e 6f77 6e5f 6469 7669 7369  elf.known_divisi
-000064a0: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
-000064b0: 2072 6574 7572 6e20 7365 6c66 2e64 6976   return self.div
-000064c0: 6973 696f 6e73 0a0a 2020 2020 2020 2020  isions..        
-000064d0: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
-000064e0: 616d 652e 7368 7566 666c 6520 696d 706f  ame.shuffle impo
-000064f0: 7274 2063 6f6d 7075 7465 5f64 6976 6973  rt compute_divis
-00006500: 696f 6e73 0a0a 2020 2020 2020 2020 7265  ions..        re
-00006510: 7475 726e 2063 6f6d 7075 7465 5f64 6976  turn compute_div
-00006520: 6973 696f 6e73 2873 656c 662c 2063 6f6c  isions(self, col
-00006530: 3d63 6f6c 290a 0a20 2020 2064 6566 2067  =col)..    def g
-00006540: 6574 5f70 6172 7469 7469 6f6e 2873 656c  et_partition(sel
-00006550: 662c 206e 293a 0a20 2020 2020 2020 2022  f, n):.        "
-00006560: 2222 0a20 2020 2020 2020 2047 6574 2061  "".        Get a
-00006570: 2064 6173 6b20 4461 7461 4672 616d 652f   dask DataFrame/
-00006580: 5365 7269 6573 2072 6570 7265 7365 6e74  Series represent
-00006590: 696e 6720 7468 6520 606e 7468 6020 7061  ing the `nth` pa
-000065a0: 7274 6974 696f 6e2e 0a0a 2020 2020 2020  rtition...      
-000065b0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-000065c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-000065d0: 2020 2020 2020 2020 6e20 3a20 696e 740a          n : int.
-000065e0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-000065f0: 302d 696e 6465 7865 6420 7061 7274 6974  0-indexed partit
-00006600: 696f 6e20 6e75 6d62 6572 2074 6f20 7365  ion number to se
-00006610: 6c65 6374 2e0a 0a20 2020 2020 2020 2052  lect...        R
-00006620: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-00006630: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
-00006640: 6173 6b20 4461 7461 4672 616d 6520 6f72  ask DataFrame or
-00006650: 2053 6572 6965 730a 2020 2020 2020 2020   Series.        
-00006660: 2020 2020 5468 6520 7361 6d65 2074 7970      The same typ
-00006670: 6520 6173 2074 6865 206f 7269 6769 6e61  e as the origina
-00006680: 6c20 6f62 6a65 6374 2e0a 0a20 2020 2020  l object...     
-00006690: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-000066a0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-000066b0: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
-000066c0: 6461 736b 0a20 2020 2020 2020 203e 3e3e  dask.        >>>
-000066d0: 2064 6466 203d 2064 6173 6b2e 6461 7461   ddf = dask.data
-000066e0: 7365 7473 2e74 696d 6573 6572 6965 7328  sets.timeseries(
-000066f0: 7374 6172 743d 2232 3032 312d 3031 2d30  start="2021-01-0
-00006700: 3122 2c20 656e 643d 2232 3032 312d 3031  1", end="2021-01
-00006710: 2d30 3722 2c20 6672 6571 3d22 3148 2229  -07", freq="1H")
-00006720: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
-00006730: 2e67 6574 5f70 6172 7469 7469 6f6e 2830  .get_partition(0
-00006740: 2920 2023 2064 6f63 7465 7374 3a20 2b4e  )  # doctest: +N
-00006750: 4f52 4d41 4c49 5a45 5f57 4849 5445 5350  ORMALIZE_WHITESP
-00006760: 4143 450a 2020 2020 2020 2020 4461 736b  ACE.        Dask
-00006770: 2044 6174 6146 7261 6d65 2053 7472 7563   DataFrame Struc
-00006780: 7475 7265 3a0a 2020 2020 2020 2020 2020  ture:.          
-00006790: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-000067a0: 616d 6520 2020 2020 6964 2020 2020 2020  ame     id      
-000067b0: 2020 7820 2020 2020 2020 2079 0a20 2020    x        y.   
-000067c0: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
-000067d0: 3d31 0a20 2020 2020 2020 2032 3032 312d  =1.        2021-
-000067e0: 3031 2d30 3120 2020 2020 6f62 6a65 6374  01-01     object
-000067f0: 2020 696e 7436 3420 2066 6c6f 6174 3634    int64  float64
-00006800: 2020 666c 6f61 7436 340a 2020 2020 2020    float64.      
-00006810: 2020 3230 3231 2d30 312d 3032 2020 2020    2021-01-02    
-00006820: 2020 2020 2e2e 2e20 2020 202e 2e2e 2020      ...    ...  
-00006830: 2020 2020 2e2e 2e20 2020 2020 202e 2e2e      ...      ...
-00006840: 0a20 2020 2020 2020 2044 6173 6b20 4e61  .        Dask Na
-00006850: 6d65 3a20 6765 742d 7061 7274 6974 696f  me: get-partitio
-00006860: 6e2c 2032 2067 7261 7068 206c 6179 6572  n, 2 graph layer
-00006870: 730a 0a20 2020 2020 2020 2053 6565 2041  s..        See A
-00006880: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-00006890: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
-000068a0: 6146 7261 6d65 2e70 6172 7469 7469 6f6e  aFrame.partition
-000068b0: 730a 2020 2020 2020 2020 2222 220a 2020  s.        """.  
-000068c0: 2020 2020 2020 6966 2030 203c 3d20 6e20        if 0 <= n 
-000068d0: 3c20 7365 6c66 2e6e 7061 7274 6974 696f  < self.npartitio
-000068e0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-000068f0: 6e61 6d65 203d 2066 2267 6574 2d70 6172  name = f"get-par
-00006900: 7469 7469 6f6e 2d7b 7374 7228 6e29 7d2d  tition-{str(n)}-
-00006910: 7b73 656c 662e 5f6e 616d 657d 220a 2020  {self._name}".  
-00006920: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
-00006930: 6f6e 7320 3d20 7365 6c66 2e64 6976 6973  ons = self.divis
-00006940: 696f 6e73 5b6e 203a 206e 202b 2032 5d0a  ions[n : n + 2].
-00006950: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
-00006960: 7220 3d20 7b28 6e61 6d65 2c20 3029 3a20  r = {(name, 0): 
-00006970: 2873 656c 662e 5f6e 616d 652c 206e 297d  (self._name, n)}
-00006980: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
-00006990: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
-000069a0: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
-000069b0: 696f 6e73 286e 616d 652c 206c 6179 6572  ions(name, layer
-000069c0: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
-000069d0: 7365 6c66 5d29 0a20 2020 2020 2020 2020  self]).         
-000069e0: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
-000069f0: 5f6f 626a 6563 7428 6772 6170 682c 206e  _object(graph, n
-00006a00: 616d 652c 2073 656c 662e 5f6d 6574 612c  ame, self._meta,
-00006a10: 2064 6976 6973 696f 6e73 290a 2020 2020   divisions).    
-00006a20: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00006a30: 2020 2020 2020 6d73 6720 3d20 6622 6e20        msg = f"n 
-00006a40: 6d75 7374 2062 6520 3020 3c3d 206e 203c  must be 0 <= n <
-00006a50: 207b 7365 6c66 2e6e 7061 7274 6974 696f   {self.npartitio
-00006a60: 6e73 7d22 0a20 2020 2020 2020 2020 2020  ns}".           
-00006a70: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00006a80: 7228 6d73 6729 0a0a 2020 2020 4064 6572  r(msg)..    @der
-00006a90: 6976 6564 5f66 726f 6d28 0a20 2020 2020  ived_from(.     
-00006aa0: 2020 2070 642e 4461 7461 4672 616d 652c     pd.DataFrame,
-00006ab0: 0a20 2020 2020 2020 2069 6e63 6f6e 7369  .        inconsi
-00006ac0: 7374 656e 6369 6573 3d22 6b65 6570 3d46  stencies="keep=F
-00006ad0: 616c 7365 2077 696c 6c20 7261 6973 6520  alse will raise 
-00006ae0: 6120 6060 4e6f 7449 6d70 6c65 6d65 6e74  a ``NotImplement
-00006af0: 6564 4572 726f 7260 6022 2c0a 2020 2020  edError``",.    
-00006b00: 290a 2020 2020 6465 6620 6472 6f70 5f64  ).    def drop_d
-00006b10: 7570 6c69 6361 7465 7328 0a20 2020 2020  uplicates(.     
-00006b20: 2020 2073 656c 662c 2073 7562 7365 743d     self, subset=
-00006b30: 4e6f 6e65 2c20 7370 6c69 745f 6576 6572  None, split_ever
-00006b40: 793d 4e6f 6e65 2c20 7370 6c69 745f 6f75  y=None, split_ou
-00006b50: 743d 312c 2069 676e 6f72 655f 696e 6465  t=1, ignore_inde
-00006b60: 783d 4661 6c73 652c 202a 2a6b 7761 7267  x=False, **kwarg
-00006b70: 730a 2020 2020 293a 0a20 2020 2020 2020  s.    ):.       
-00006b80: 2069 6620 7375 6273 6574 2069 7320 6e6f   if subset is no
-00006b90: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00006ba0: 2020 2020 2320 4c65 7420 7061 6e64 6173      # Let pandas
-00006bb0: 2065 7272 6f72 206f 6e20 6261 6420 696e   error on bad in
-00006bc0: 7075 7473 0a20 2020 2020 2020 2020 2020  puts.           
-00006bd0: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
-00006be0: 6d70 7479 2e64 726f 705f 6475 706c 6963  mpty.drop_duplic
-00006bf0: 6174 6573 2873 7562 7365 743d 7375 6273  ates(subset=subs
-00006c00: 6574 2c20 2a2a 6b77 6172 6773 290a 2020  et, **kwargs).  
-00006c10: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-00006c20: 5b22 7375 6273 6574 225d 203d 2073 7562  ["subset"] = sub
-00006c30: 7365 740a 2020 2020 2020 2020 2020 2020  set.            
-00006c40: 7370 6c69 745f 6f75 745f 7365 7475 7020  split_out_setup 
-00006c50: 3d20 7370 6c69 745f 6f75 745f 6f6e 5f63  = split_out_on_c
-00006c60: 6f6c 730a 2020 2020 2020 2020 2020 2020  ols.            
-00006c70: 7370 6c69 745f 6f75 745f 7365 7475 705f  split_out_setup_
-00006c80: 6b77 6172 6773 203d 207b 2263 6f6c 7322  kwargs = {"cols"
-00006c90: 3a20 7375 6273 6574 7d0a 2020 2020 2020  : subset}.      
-00006ca0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00006cb0: 2020 2020 7365 6c66 2e5f 6d65 7461 5f6e      self._meta_n
-00006cc0: 6f6e 656d 7074 792e 6472 6f70 5f64 7570  onempty.drop_dup
-00006cd0: 6c69 6361 7465 7328 2a2a 6b77 6172 6773  licates(**kwargs
-00006ce0: 290a 2020 2020 2020 2020 2020 2020 7370  ).            sp
-00006cf0: 6c69 745f 6f75 745f 7365 7475 7020 3d20  lit_out_setup = 
-00006d00: 7370 6c69 745f 6f75 745f 7365 7475 705f  split_out_setup_
-00006d10: 6b77 6172 6773 203d 204e 6f6e 650a 0a20  kwargs = None.. 
-00006d20: 2020 2020 2020 2069 6620 6b77 6172 6773         if kwargs
-00006d30: 2e67 6574 2822 6b65 6570 222c 2054 7275  .get("keep", Tru
-00006d40: 6529 2069 7320 4661 6c73 653a 0a20 2020  e) is False:.   
-00006d50: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-00006d60: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-00006d70: 6f72 2822 6472 6f70 5f64 7570 6c69 6361  or("drop_duplica
-00006d80: 7465 7320 7769 7468 206b 6565 703d 4661  tes with keep=Fa
-00006d90: 6c73 6522 290a 0a20 2020 2020 2020 2063  lse")..        c
-00006da0: 6875 6e6b 203d 204d 2e64 726f 705f 6475  hunk = M.drop_du
-00006db0: 706c 6963 6174 6573 0a20 2020 2020 2020  plicates.       
-00006dc0: 2072 6574 7572 6e20 6163 6128 0a20 2020   return aca(.   
-00006dd0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-00006de0: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
-00006df0: 3d63 6875 6e6b 2c0a 2020 2020 2020 2020  =chunk,.        
-00006e00: 2020 2020 6167 6772 6567 6174 653d 6368      aggregate=ch
-00006e10: 756e 6b2c 0a20 2020 2020 2020 2020 2020  unk,.           
-00006e20: 206d 6574 613d 7365 6c66 2e5f 6d65 7461   meta=self._meta
-00006e30: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
-00006e40: 6b65 6e3d 2264 726f 702d 6475 706c 6963  ken="drop-duplic
-00006e50: 6174 6573 222c 0a20 2020 2020 2020 2020  ates",.         
-00006e60: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
-00006e70: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
-00006e80: 2020 2020 2020 2020 7370 6c69 745f 6f75          split_ou
-00006e90: 743d 7370 6c69 745f 6f75 742c 0a20 2020  t=split_out,.   
-00006ea0: 2020 2020 2020 2020 2073 706c 6974 5f6f           split_o
-00006eb0: 7574 5f73 6574 7570 3d73 706c 6974 5f6f  ut_setup=split_o
-00006ec0: 7574 5f73 6574 7570 2c0a 2020 2020 2020  ut_setup,.      
-00006ed0: 2020 2020 2020 7370 6c69 745f 6f75 745f        split_out_
-00006ee0: 7365 7475 705f 6b77 6172 6773 3d73 706c  setup_kwargs=spl
-00006ef0: 6974 5f6f 7574 5f73 6574 7570 5f6b 7761  it_out_setup_kwa
-00006f00: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-00006f10: 2069 676e 6f72 655f 696e 6465 783d 6967   ignore_index=ig
-00006f20: 6e6f 7265 5f69 6e64 6578 2c0a 2020 2020  nore_index,.    
-00006f30: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-00006f40: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00006f50: 2064 6566 205f 5f6c 656e 5f5f 2873 656c   def __len__(sel
-00006f60: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00006f70: 726e 2073 656c 662e 7265 6475 6374 696f  rn self.reductio
-00006f80: 6e28 0a20 2020 2020 2020 2020 2020 206c  n(.            l
-00006f90: 656e 2c20 6e70 2e73 756d 2c20 746f 6b65  en, np.sum, toke
-00006fa0: 6e3d 226c 656e 222c 206d 6574 613d 696e  n="len", meta=in
-00006fb0: 742c 2073 706c 6974 5f65 7665 7279 3d46  t, split_every=F
-00006fc0: 616c 7365 0a20 2020 2020 2020 2029 2e63  alse.        ).c
-00006fd0: 6f6d 7075 7465 2829 0a0a 2020 2020 6465  ompute()..    de
-00006fe0: 6620 5f5f 626f 6f6c 5f5f 2873 656c 6629  f __bool__(self)
-00006ff0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-00007000: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00007010: 2020 2020 2020 2020 6622 5468 6520 7472          f"The tr
-00007020: 7574 6820 7661 6c75 6520 6f66 2061 207b  uth value of a {
-00007030: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
-00007040: 5f6e 616d 655f 5f7d 2069 7320 616d 6269  _name__} is ambi
-00007050: 6775 6f75 732e 2022 0a20 2020 2020 2020  guous. ".       
-00007060: 2020 2020 2022 5573 6520 612e 616e 7928       "Use a.any(
-00007070: 2920 6f72 2061 2e61 6c6c 2829 2e22 0a20  ) or a.all().". 
-00007080: 2020 2020 2020 2029 0a0a 2020 2020 5f5f         )..    __
-00007090: 6e6f 6e7a 6572 6f5f 5f20 3d20 5f5f 626f  nonzero__ = __bo
-000070a0: 6f6c 5f5f 2020 2320 7079 7468 6f6e 2032  ol__  # python 2
-000070b0: 0a0a 2020 2020 6465 6620 5f73 6361 6c61  ..    def _scala
-000070c0: 7266 756e 6328 7365 6c66 2c20 6361 7374  rfunc(self, cast
-000070d0: 5f74 7970 6529 3a0a 2020 2020 2020 2020  _type):.        
-000070e0: 6465 6620 7772 6170 7065 7228 293a 0a20  def wrapper():. 
-000070f0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00007100: 2054 7970 6545 7272 6f72 2866 2263 616e   TypeError(f"can
-00007110: 6e6f 7420 636f 6e76 6572 7420 7468 6520  not convert the 
-00007120: 7365 7269 6573 2074 6f20 7b63 6173 745f  series to {cast_
-00007130: 7479 7065 7d22 290a 0a20 2020 2020 2020  type}")..       
-00007140: 2072 6574 7572 6e20 7772 6170 7065 720a   return wrapper.
-00007150: 0a20 2020 2064 6566 205f 5f66 6c6f 6174  .    def __float
-00007160: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00007170: 2020 7265 7475 726e 2073 656c 662e 5f73    return self._s
-00007180: 6361 6c61 7266 756e 6328 666c 6f61 7429  calarfunc(float)
-00007190: 0a0a 2020 2020 6465 6620 5f5f 696e 745f  ..    def __int_
-000071a0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-000071b0: 2072 6574 7572 6e20 7365 6c66 2e5f 7363   return self._sc
-000071c0: 616c 6172 6675 6e63 2869 6e74 290a 0a20  alarfunc(int).. 
-000071d0: 2020 205f 5f6c 6f6e 675f 5f20 3d20 5f5f     __long__ = __
-000071e0: 696e 745f 5f20 2023 2070 7974 686f 6e20  int__  # python 
-000071f0: 320a 0a20 2020 2064 6566 205f 5f63 6f6d  2..    def __com
-00007200: 706c 6578 5f5f 2873 656c 6629 3a0a 2020  plex__(self):.  
-00007210: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00007220: 662e 5f73 6361 6c61 7266 756e 6328 636f  f._scalarfunc(co
-00007230: 6d70 6c65 7829 0a0a 2020 2020 4069 6e73  mplex)..    @ins
-00007240: 6572 745f 6d65 7461 5f70 6172 616d 5f64  ert_meta_param_d
-00007250: 6573 6372 6970 7469 6f6e 2870 6164 3d31  escription(pad=1
-00007260: 3229 0a20 2020 2064 6566 206d 6170 5f70  2).    def map_p
-00007270: 6172 7469 7469 6f6e 7328 7365 6c66 2c20  artitions(self, 
-00007280: 6675 6e63 2c20 2a61 7267 732c 202a 2a6b  func, *args, **k
-00007290: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-000072a0: 2222 2241 7070 6c79 2050 7974 686f 6e20  """Apply Python 
-000072b0: 6675 6e63 7469 6f6e 206f 6e20 6561 6368  function on each
-000072c0: 2044 6174 6146 7261 6d65 2070 6172 7469   DataFrame parti
-000072d0: 7469 6f6e 2e0a 0a20 2020 2020 2020 204e  tion...        N
-000072e0: 6f74 6520 7468 6174 2074 6865 2069 6e64  ote that the ind
-000072f0: 6578 2061 6e64 2064 6976 6973 696f 6e73  ex and divisions
-00007300: 2061 7265 2061 7373 756d 6564 2074 6f20   are assumed to 
-00007310: 7265 6d61 696e 2075 6e63 6861 6e67 6564  remain unchanged
-00007320: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00007330: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00007340: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00007350: 2066 756e 6320 3a20 6675 6e63 7469 6f6e   func : function
-00007360: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-00007370: 2066 756e 6374 696f 6e20 6170 706c 6965   function applie
-00007380: 6420 746f 2065 6163 6820 7061 7274 6974  d to each partit
-00007390: 696f 6e2e 2049 6620 7468 6973 2066 756e  ion. If this fun
-000073a0: 6374 696f 6e20 6163 6365 7074 730a 2020  ction accepts.  
-000073b0: 2020 2020 2020 2020 2020 7468 6520 7370            the sp
-000073c0: 6563 6961 6c20 6060 7061 7274 6974 696f  ecial ``partitio
-000073d0: 6e5f 696e 666f 6060 206b 6579 776f 7264  n_info`` keyword
-000073e0: 2061 7267 756d 656e 742c 2069 7420 7769   argument, it wi
-000073f0: 6c6c 2072 6563 6569 7665 0a20 2020 2020  ll receive.     
-00007400: 2020 2020 2020 2069 6e66 6f72 6d61 7469         informati
-00007410: 6f6e 206f 6e20 7468 6520 7061 7274 6974  on on the partit
-00007420: 696f 6e27 7320 7265 6c61 7469 7665 206c  ion's relative l
-00007430: 6f63 6174 696f 6e20 7769 7468 696e 2074  ocation within t
-00007440: 6865 0a20 2020 2020 2020 2020 2020 2064  he.            d
-00007450: 6174 6166 7261 6d65 2e0a 2020 2020 2020  ataframe..      
-00007460: 2020 6172 6773 2c20 6b77 6172 6773 203a    args, kwargs :
-00007470: 0a20 2020 2020 2020 2020 2020 2050 6f73  .            Pos
-00007480: 6974 696f 6e61 6c20 616e 6420 6b65 7977  itional and keyw
-00007490: 6f72 6420 6172 6775 6d65 6e74 7320 746f  ord arguments to
-000074a0: 2070 6173 7320 746f 2074 6865 2066 756e   pass to the fun
-000074b0: 6374 696f 6e2e 0a20 2020 2020 2020 2020  ction..         
-000074c0: 2020 2050 6f73 6974 696f 6e61 6c20 6172     Positional ar
-000074d0: 6775 6d65 6e74 7320 6172 6520 636f 6d70  guments are comp
-000074e0: 7574 6564 206f 6e20 6120 7065 722d 7061  uted on a per-pa
-000074f0: 7274 6974 696f 6e20 6261 7369 732c 2077  rtition basis, w
-00007500: 6869 6c65 0a20 2020 2020 2020 2020 2020  hile.           
-00007510: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
-00007520: 7473 2061 7265 2073 6861 7265 6420 6163  ts are shared ac
-00007530: 726f 7373 2061 6c6c 2070 6172 7469 7469  ross all partiti
-00007540: 6f6e 732e 2054 6865 2070 6172 7469 7469  ons. The partiti
-00007550: 6f6e 0a20 2020 2020 2020 2020 2020 2069  on.            i
-00007560: 7473 656c 6620 7769 6c6c 2062 6520 7468  tself will be th
-00007570: 6520 6669 7273 7420 706f 7369 7469 6f6e  e first position
-00007580: 616c 2061 7267 756d 656e 742c 2077 6974  al argument, wit
-00007590: 6820 616c 6c20 6f74 6865 720a 2020 2020  h all other.    
-000075a0: 2020 2020 2020 2020 6172 6775 6d65 6e74          argument
-000075b0: 7320 7061 7373 6564 202a 6166 7465 722a  s passed *after*
-000075c0: 2e20 4172 6775 6d65 6e74 7320 6361 6e20  . Arguments can 
-000075d0: 6265 2060 6053 6361 6c61 7260 602c 2060  be ``Scalar``, `
-000075e0: 6044 656c 6179 6564 6060 2c0a 2020 2020  `Delayed``,.    
-000075f0: 2020 2020 2020 2020 6f72 2072 6567 756c          or regul
-00007600: 6172 2050 7974 686f 6e20 6f62 6a65 6374  ar Python object
-00007610: 732e 2044 6174 6146 7261 6d65 2d6c 696b  s. DataFrame-lik
-00007620: 6520 6172 6773 2028 626f 7468 2064 6173  e args (both das
-00007630: 6b20 616e 640a 2020 2020 2020 2020 2020  k and.          
-00007640: 2020 7061 6e64 6173 2920 7769 6c6c 2062    pandas) will b
-00007650: 6520 7265 7061 7274 6974 696f 6e65 6420  e repartitioned 
-00007660: 746f 2061 6c69 676e 2028 6966 206e 6563  to align (if nec
-00007670: 6573 7361 7279 2920 6265 666f 7265 0a20  essary) before. 
-00007680: 2020 2020 2020 2020 2020 2061 7070 6c79             apply
-00007690: 696e 6720 7468 6520 6675 6e63 7469 6f6e  ing the function
-000076a0: 3b20 7365 6520 6060 616c 6967 6e5f 6461  ; see ``align_da
-000076b0: 7461 6672 616d 6573 6060 2074 6f20 636f  taframes`` to co
-000076c0: 6e74 726f 6c20 7468 6973 0a20 2020 2020  ntrol this.     
-000076d0: 2020 2020 2020 2062 6568 6176 696f 722e         behavior.
-000076e0: 0a20 2020 2020 2020 2065 6e66 6f72 6365  .        enforce
-000076f0: 5f6d 6574 6164 6174 6120 3a20 626f 6f6c  _metadata : bool
-00007700: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
-00007710: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-00007720: 6572 2074 6f20 656e 666f 7263 6520 6174  er to enforce at
-00007730: 2072 756e 7469 6d65 2074 6861 7420 7468   runtime that th
-00007740: 6520 7374 7275 6374 7572 6520 6f66 2074  e structure of t
-00007750: 6865 2044 6174 6146 7261 6d65 0a20 2020  he DataFrame.   
-00007760: 2020 2020 2020 2020 2070 726f 6475 6365           produce
-00007770: 6420 6279 2060 6066 756e 6360 6020 6163  d by ``func`` ac
-00007780: 7475 616c 6c79 206d 6174 6368 6573 2074  tually matches t
-00007790: 6865 2073 7472 7563 7475 7265 206f 6620  he structure of 
-000077a0: 6060 6d65 7461 6060 2e0a 2020 2020 2020  ``meta``..      
-000077b0: 2020 2020 2020 5468 6973 2077 696c 6c20        This will 
-000077c0: 7265 6e61 6d65 2061 6e64 2072 656f 7264  rename and reord
-000077d0: 6572 2063 6f6c 756d 6e73 2066 6f72 2065  er columns for e
-000077e0: 6163 6820 7061 7274 6974 696f 6e2c 0a20  ach partition,. 
-000077f0: 2020 2020 2020 2020 2020 2061 6e64 2077             and w
-00007800: 696c 6c20 7261 6973 6520 616e 2065 7272  ill raise an err
-00007810: 6f72 2069 6620 7468 6973 2064 6f65 736e  or if this doesn
-00007820: 2774 2077 6f72 6b2c 0a20 2020 2020 2020  't work,.       
-00007830: 2020 2020 2062 7574 2069 7420 776f 6e27       but it won'
-00007840: 7420 7261 6973 6520 6966 2064 7479 7065  t raise if dtype
-00007850: 7320 646f 6e27 7420 6d61 7463 682e 0a20  s don't match.. 
-00007860: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
-00007870: 5f64 6976 6973 696f 6e73 203a 2062 6f6f  _divisions : boo
-00007880: 6c2c 2064 6566 6175 6c74 2054 7275 650a  l, default True.
-00007890: 2020 2020 2020 2020 2020 2020 5768 6574              Whet
-000078a0: 6865 7220 746f 2061 7070 6c79 2074 6865  her to apply the
-000078b0: 2066 756e 6374 696f 6e20 6f6e 746f 2074   function onto t
-000078c0: 6865 2064 6976 6973 696f 6e73 2061 6e64  he divisions and
-000078d0: 2061 7070 6c79 2074 686f 7365 0a20 2020   apply those.   
-000078e0: 2020 2020 2020 2020 2074 7261 6e73 666f           transfo
-000078f0: 726d 6564 2064 6976 6973 696f 6e73 2074  rmed divisions t
-00007900: 6f20 7468 6520 6f75 7470 7574 2e0a 2020  o the output..  
-00007910: 2020 2020 2020 616c 6967 6e5f 6461 7461        align_data
-00007920: 6672 616d 6573 203a 2062 6f6f 6c2c 2064  frames : bool, d
-00007930: 6566 6175 6c74 2054 7275 650a 2020 2020  efault True.    
-00007940: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
-00007950: 746f 2072 6570 6172 7469 7469 6f6e 2044  to repartition D
-00007960: 6174 6146 7261 6d65 2d20 6f72 2053 6572  ataFrame- or Ser
-00007970: 6965 732d 6c69 6b65 2061 7267 730a 2020  ies-like args.  
-00007980: 2020 2020 2020 2020 2020 2862 6f74 6820            (both 
-00007990: 6461 736b 2061 6e64 2070 616e 6461 7329  dask and pandas)
-000079a0: 2073 6f20 7468 6569 7220 6469 7669 7369   so their divisi
-000079b0: 6f6e 7320 616c 6967 6e20 6265 666f 7265  ons align before
-000079c0: 2061 7070 6c79 696e 670a 2020 2020 2020   applying.      
-000079d0: 2020 2020 2020 7468 6520 6675 6e63 7469        the functi
-000079e0: 6f6e 2e20 5468 6973 2072 6571 7569 7265  on. This require
-000079f0: 7320 616c 6c20 696e 7075 7473 2074 6f20  s all inputs to 
-00007a00: 6861 7665 206b 6e6f 776e 2064 6976 6973  have known divis
-00007a10: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
-00007a20: 2020 5369 6e67 6c65 2d70 6172 7469 7469    Single-partiti
-00007a30: 6f6e 2069 6e70 7574 7320 7769 6c6c 2062  on inputs will b
-00007a40: 6520 7370 6c69 7420 696e 746f 206d 756c  e split into mul
-00007a50: 7469 706c 6520 7061 7274 6974 696f 6e73  tiple partitions
-00007a60: 2e0a 0a20 2020 2020 2020 2020 2020 2049  ...            I
-00007a70: 6620 4661 6c73 652c 2061 6c6c 2069 6e70  f False, all inp
-00007a80: 7574 7320 6d75 7374 2068 6176 6520 6569  uts must have ei
-00007a90: 7468 6572 2074 6865 2073 616d 6520 6e75  ther the same nu
-00007aa0: 6d62 6572 206f 6620 7061 7274 6974 696f  mber of partitio
-00007ab0: 6e73 0a20 2020 2020 2020 2020 2020 206f  ns.            o
-00007ac0: 7220 6120 7369 6e67 6c65 2070 6172 7469  r a single parti
-00007ad0: 7469 6f6e 2e20 5369 6e67 6c65 2d70 6172  tion. Single-par
-00007ae0: 7469 7469 6f6e 2069 6e70 7574 7320 7769  tition inputs wi
-00007af0: 6c6c 2062 6520 6272 6f61 6463 6173 7420  ll be broadcast 
-00007b00: 746f 0a20 2020 2020 2020 2020 2020 2065  to.            e
-00007b10: 7665 7279 2070 6172 7469 7469 6f6e 206f  very partition o
-00007b20: 6620 6d75 6c74 692d 7061 7274 6974 696f  f multi-partitio
-00007b30: 6e20 696e 7075 7473 2e0a 2020 2020 2020  n inputs..      
-00007b40: 2020 244d 4554 410a 0a20 2020 2020 2020    $META..       
-00007b50: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
-00007b60: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00007b70: 2020 2047 6976 656e 2061 2044 6174 6146     Given a DataF
-00007b80: 7261 6d65 2c20 5365 7269 6573 2c20 6f72  rame, Series, or
-00007b90: 2049 6e64 6578 2c20 7375 6368 2061 733a   Index, such as:
-00007ba0: 0a0a 2020 2020 2020 2020 3e3e 3e20 696d  ..        >>> im
-00007bb0: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
-00007bc0: 640a 2020 2020 2020 2020 3e3e 3e20 696d  d.        >>> im
-00007bd0: 706f 7274 2064 6173 6b2e 6461 7461 6672  port dask.datafr
-00007be0: 616d 6520 6173 2064 640a 2020 2020 2020  ame as dd.      
-00007bf0: 2020 3e3e 3e20 6466 203d 2070 642e 4461    >>> df = pd.Da
-00007c00: 7461 4672 616d 6528 7b27 7827 3a20 5b31  taFrame({'x': [1
-00007c10: 2c20 322c 2033 2c20 342c 2035 5d2c 0a20  , 2, 3, 4, 5],. 
-00007c20: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-00007c30: 2020 2020 2020 2020 2020 2020 2020 2779                'y
-00007c40: 273a 205b 312e 2c20 322e 2c20 332e 2c20  ': [1., 2., 3., 
-00007c50: 342e 2c20 352e 5d7d 290a 2020 2020 2020  4., 5.]}).      
-00007c60: 2020 3e3e 3e20 6464 6620 3d20 6464 2e66    >>> ddf = dd.f
-00007c70: 726f 6d5f 7061 6e64 6173 2864 662c 206e  rom_pandas(df, n
-00007c80: 7061 7274 6974 696f 6e73 3d32 290a 0a20  partitions=2).. 
-00007c90: 2020 2020 2020 204f 6e65 2063 616e 2075         One can u
-00007ca0: 7365 2060 606d 6170 5f70 6172 7469 7469  se ``map_partiti
-00007cb0: 6f6e 7360 6020 746f 2061 7070 6c79 2061  ons`` to apply a
-00007cc0: 2066 756e 6374 696f 6e20 6f6e 2065 6163   function on eac
-00007cd0: 6820 7061 7274 6974 696f 6e2e 0a20 2020  h partition..   
-00007ce0: 2020 2020 2045 7874 7261 2061 7267 756d       Extra argum
-00007cf0: 656e 7473 2061 6e64 206b 6579 776f 7264  ents and keyword
-00007d00: 7320 6361 6e20 6f70 7469 6f6e 616c 6c79  s can optionally
-00007d10: 2062 6520 7072 6f76 6964 6564 2c20 616e   be provided, an
-00007d20: 6420 7769 6c6c 2062 650a 2020 2020 2020  d will be.      
-00007d30: 2020 7061 7373 6564 2074 6f20 7468 6520    passed to the 
-00007d40: 6675 6e63 7469 6f6e 2061 6674 6572 2074  function after t
-00007d50: 6865 2070 6172 7469 7469 6f6e 2e0a 0a20  he partition... 
-00007d60: 2020 2020 2020 2048 6572 6520 7765 2061         Here we a
-00007d70: 7070 6c79 2061 2066 756e 6374 696f 6e20  pply a function 
-00007d80: 7769 7468 2061 7267 756d 656e 7473 2061  with arguments a
-00007d90: 6e64 206b 6579 776f 7264 7320 746f 2061  nd keywords to a
-00007da0: 2044 6174 6146 7261 6d65 2c0a 2020 2020   DataFrame,.    
-00007db0: 2020 2020 7265 7375 6c74 696e 6720 696e      resulting in
-00007dc0: 2061 2053 6572 6965 733a 0a0a 2020 2020   a Series:..    
-00007dd0: 2020 2020 3e3e 3e20 6465 6620 6d79 6164      >>> def myad
-00007de0: 6428 6466 2c20 612c 2062 3d31 293a 0a20  d(df, a, b=1):. 
-00007df0: 2020 2020 2020 202e 2e2e 2020 2020 2072         ...     r
-00007e00: 6574 7572 6e20 6466 2e78 202b 2064 662e  eturn df.x + df.
-00007e10: 7920 2b20 6120 2b20 620a 2020 2020 2020  y + a + b.      
-00007e20: 2020 3e3e 3e20 7265 7320 3d20 6464 662e    >>> res = ddf.
-00007e30: 6d61 705f 7061 7274 6974 696f 6e73 286d  map_partitions(m
-00007e40: 7961 6464 2c20 312c 2062 3d32 290a 2020  yadd, 1, b=2).  
-00007e50: 2020 2020 2020 3e3e 3e20 7265 732e 6474        >>> res.dt
-00007e60: 7970 650a 2020 2020 2020 2020 6474 7970  ype.        dtyp
-00007e70: 6528 2766 6c6f 6174 3634 2729 0a0a 2020  e('float64')..  
-00007e80: 2020 2020 2020 4865 7265 2077 6520 6170        Here we ap
-00007e90: 706c 7920 6120 6675 6e63 7469 6f6e 2074  ply a function t
-00007ea0: 6f20 6120 5365 7269 6573 2072 6573 756c  o a Series resul
-00007eb0: 7469 6e67 2069 6e20 6120 5365 7269 6573  ting in a Series
-00007ec0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2072  :..        >>> r
-00007ed0: 6573 203d 2064 6466 2e78 2e6d 6170 5f70  es = ddf.x.map_p
-00007ee0: 6172 7469 7469 6f6e 7328 6c61 6d62 6461  artitions(lambda
-00007ef0: 2078 3a20 6c65 6e28 7829 2920 2320 6464   x: len(x)) # dd
-00007f00: 662e 7820 6973 2061 2044 6173 6b20 5365  f.x is a Dask Se
-00007f10: 7269 6573 2053 7472 7563 7475 7265 0a20  ries Structure. 
-00007f20: 2020 2020 2020 203e 3e3e 2072 6573 2e64         >>> res.d
-00007f30: 7479 7065 0a20 2020 2020 2020 2064 7479  type.        dty
-00007f40: 7065 2827 696e 7436 3427 290a 0a20 2020  pe('int64')..   
-00007f50: 2020 2020 2042 7920 6465 6661 756c 742c       By default,
-00007f60: 2064 6173 6b20 7472 6965 7320 746f 2069   dask tries to i
-00007f70: 6e66 6572 2074 6865 206f 7574 7075 7420  nfer the output 
-00007f80: 6d65 7461 6461 7461 2062 7920 7275 6e6e  metadata by runn
-00007f90: 696e 6720 796f 7572 0a20 2020 2020 2020  ing your.       
-00007fa0: 2070 726f 7669 6465 6420 6675 6e63 7469   provided functi
-00007fb0: 6f6e 206f 6e20 736f 6d65 2066 616b 6520  on on some fake 
-00007fc0: 6461 7461 2e20 5468 6973 2077 6f72 6b73  data. This works
-00007fd0: 2077 656c 6c20 696e 206d 616e 7920 6361   well in many ca
-00007fe0: 7365 732c 2062 7574 0a20 2020 2020 2020  ses, but.       
-00007ff0: 2063 616e 2073 6f6d 6574 696d 6573 2062   can sometimes b
-00008000: 6520 6578 7065 6e73 6976 652c 206f 7220  e expensive, or 
-00008010: 6576 656e 2066 6169 6c2e 2054 6f20 6176  even fail. To av
-00008020: 6f69 6420 7468 6973 2c20 796f 7520 6361  oid this, you ca
-00008030: 6e0a 2020 2020 2020 2020 6d61 6e75 616c  n.        manual
-00008040: 6c79 2073 7065 6369 6679 2074 6865 206f  ly specify the o
-00008050: 7574 7075 7420 6d65 7461 6461 7461 2077  utput metadata w
-00008060: 6974 6820 7468 6520 6060 6d65 7461 6060  ith the ``meta``
-00008070: 206b 6579 776f 7264 2e20 5468 6973 0a20   keyword. This. 
-00008080: 2020 2020 2020 2063 616e 2062 6520 7370         can be sp
-00008090: 6563 6966 6965 6420 696e 206d 616e 7920  ecified in many 
-000080a0: 666f 726d 732c 2066 6f72 206d 6f72 6520  forms, for more 
-000080b0: 696e 666f 726d 6174 696f 6e20 7365 650a  information see.
-000080c0: 2020 2020 2020 2020 6060 6461 736b 2e64          ``dask.d
-000080d0: 6174 6166 7261 6d65 2e75 7469 6c73 2e6d  ataframe.utils.m
-000080e0: 616b 655f 6d65 7461 6060 2e0a 0a20 2020  ake_meta``...   
-000080f0: 2020 2020 2048 6572 6520 7765 2073 7065       Here we spe
-00008100: 6369 6679 2074 6865 206f 7574 7075 7420  cify the output 
-00008110: 6973 2061 2053 6572 6965 7320 7769 7468  is a Series with
-00008120: 206e 6f20 6e61 6d65 2c20 616e 6420 6474   no name, and dt
-00008130: 7970 650a 2020 2020 2020 2020 6060 666c  ype.        ``fl
-00008140: 6f61 7436 3460 603a 0a0a 2020 2020 2020  oat64``:..      
-00008150: 2020 3e3e 3e20 7265 7320 3d20 6464 662e    >>> res = ddf.
-00008160: 6d61 705f 7061 7274 6974 696f 6e73 286d  map_partitions(m
-00008170: 7961 6464 2c20 312c 2062 3d32 2c20 6d65  yadd, 1, b=2, me
-00008180: 7461 3d28 4e6f 6e65 2c20 2766 3827 2929  ta=(None, 'f8'))
-00008190: 0a0a 2020 2020 2020 2020 4865 7265 2077  ..        Here w
-000081a0: 6520 6d61 7020 6120 6675 6e63 7469 6f6e  e map a function
-000081b0: 2074 6861 7420 7461 6b65 7320 696e 2061   that takes in a
-000081c0: 2044 6174 6146 7261 6d65 2c20 616e 6420   DataFrame, and 
-000081d0: 7265 7475 726e 7320 610a 2020 2020 2020  returns a.      
-000081e0: 2020 4461 7461 4672 616d 6520 7769 7468    DataFrame with
-000081f0: 2061 206e 6577 2063 6f6c 756d 6e3a 0a0a   a new column:..
-00008200: 2020 2020 2020 2020 3e3e 3e20 7265 7320          >>> res 
-00008210: 3d20 6464 662e 6d61 705f 7061 7274 6974  = ddf.map_partit
-00008220: 696f 6e73 286c 616d 6264 6120 6466 3a20  ions(lambda df: 
-00008230: 6466 2e61 7373 6967 6e28 7a3d 6466 2e78  df.assign(z=df.x
-00008240: 202a 2064 662e 7929 290a 2020 2020 2020   * df.y)).      
-00008250: 2020 3e3e 3e20 7265 732e 6474 7970 6573    >>> res.dtypes
-00008260: 0a20 2020 2020 2020 2078 2020 2020 2020  .        x      
-00008270: 696e 7436 340a 2020 2020 2020 2020 7920  int64.        y 
-00008280: 2020 2066 6c6f 6174 3634 0a20 2020 2020     float64.     
-00008290: 2020 207a 2020 2020 666c 6f61 7436 340a     z    float64.
-000082a0: 2020 2020 2020 2020 6474 7970 653a 206f          dtype: o
-000082b0: 626a 6563 740a 0a20 2020 2020 2020 2041  bject..        A
-000082c0: 7320 6265 666f 7265 2c20 7468 6520 6f75  s before, the ou
-000082d0: 7470 7574 206d 6574 6164 6174 6120 6361  tput metadata ca
-000082e0: 6e20 616c 736f 2062 6520 7370 6563 6966  n also be specif
-000082f0: 6965 6420 6d61 6e75 616c 6c79 2e20 5468  ied manually. Th
-00008300: 6973 0a20 2020 2020 2020 2074 696d 6520  is.        time 
-00008310: 7765 2070 6173 7320 696e 2061 2060 6064  we pass in a ``d
-00008320: 6963 7460 602c 2061 7320 7468 6520 6f75  ict``, as the ou
-00008330: 7470 7574 2069 7320 6120 4461 7461 4672  tput is a DataFr
-00008340: 616d 653a 0a0a 2020 2020 2020 2020 3e3e  ame:..        >>
-00008350: 3e20 7265 7320 3d20 6464 662e 6d61 705f  > res = ddf.map_
-00008360: 7061 7274 6974 696f 6e73 286c 616d 6264  partitions(lambd
-00008370: 6120 6466 3a20 6466 2e61 7373 6967 6e28  a df: df.assign(
-00008380: 7a3d 6466 2e78 202a 2064 662e 7929 2c0a  z=df.x * df.y),.
-00008390: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-000083a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083b0: 2020 2020 206d 6574 613d 7b27 7827 3a20       meta={'x': 
-000083c0: 2769 3827 2c20 2779 273a 2027 6638 272c  'i8', 'y': 'f8',
-000083d0: 2027 7a27 3a20 2766 3827 7d29 0a0a 2020   'z': 'f8'})..  
-000083e0: 2020 2020 2020 496e 2074 6865 2063 6173        In the cas
-000083f0: 6520 7768 6572 6520 7468 6520 6d65 7461  e where the meta
-00008400: 6461 7461 2064 6f65 736e 2774 2063 6861  data doesn't cha
-00008410: 6e67 652c 2079 6f75 2063 616e 2061 6c73  nge, you can als
-00008420: 6f20 7061 7373 2069 6e0a 2020 2020 2020  o pass in.      
-00008430: 2020 7468 6520 6f62 6a65 6374 2069 7473    the object its
-00008440: 656c 6620 6469 7265 6374 6c79 3a0a 0a20  elf directly:.. 
-00008450: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
-00008460: 2064 6466 2e6d 6170 5f70 6172 7469 7469   ddf.map_partiti
-00008470: 6f6e 7328 6c61 6d62 6461 2064 663a 2064  ons(lambda df: d
-00008480: 662e 6865 6164 2829 2c20 6d65 7461 3d64  f.head(), meta=d
-00008490: 6466 290a 0a20 2020 2020 2020 2041 6c73  df)..        Als
-000084a0: 6f20 6e6f 7465 2074 6861 7420 7468 6520  o note that the 
-000084b0: 696e 6465 7820 616e 6420 6469 7669 7369  index and divisi
-000084c0: 6f6e 7320 6172 6520 6173 7375 6d65 6420  ons are assumed 
-000084d0: 746f 2072 656d 6169 6e20 756e 6368 616e  to remain unchan
-000084e0: 6765 642e 0a20 2020 2020 2020 2049 6620  ged..        If 
-000084f0: 7468 6520 6675 6e63 7469 6f6e 2079 6f75  the function you
-00008500: 2772 6520 6d61 7070 696e 6720 6368 616e  're mapping chan
-00008510: 6765 7320 7468 6520 696e 6465 782f 6469  ges the index/di
-00008520: 7669 7369 6f6e 732c 2079 6f75 276c 6c20  visions, you'll 
-00008530: 6e65 6564 0a20 2020 2020 2020 2074 6f20  need.        to 
-00008540: 636c 6561 7220 7468 656d 2061 6674 6572  clear them after
-00008550: 7761 7264 733a 0a0a 2020 2020 2020 2020  wards:..        
-00008560: 3e3e 3e20 6464 662e 6d61 705f 7061 7274  >>> ddf.map_part
-00008570: 6974 696f 6e73 2866 756e 6329 2e63 6c65  itions(func).cle
-00008580: 6172 5f64 6976 6973 696f 6e73 2829 2020  ar_divisions()  
-00008590: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
-000085a0: 0a0a 2020 2020 2020 2020 596f 7572 206d  ..        Your m
-000085b0: 6170 2066 756e 6374 696f 6e20 6765 7473  ap function gets
-000085c0: 2069 6e66 6f72 6d61 7469 6f6e 2061 626f   information abo
-000085d0: 7574 2077 6865 7265 2069 7420 6973 2069  ut where it is i
-000085e0: 6e20 7468 6520 6461 7461 6672 616d 6520  n the dataframe 
-000085f0: 6279 0a20 2020 2020 2020 2061 6363 6570  by.        accep
-00008600: 7469 6e67 2061 2073 7065 6369 616c 2060  ting a special `
-00008610: 6070 6172 7469 7469 6f6e 5f69 6e66 6f60  `partition_info`
-00008620: 6020 6b65 7977 6f72 6420 6172 6775 6d65  ` keyword argume
-00008630: 6e74 2e0a 0a20 2020 2020 2020 203e 3e3e  nt...        >>>
-00008640: 2064 6566 2066 756e 6328 7061 7274 6974   def func(partit
-00008650: 696f 6e2c 2070 6172 7469 7469 6f6e 5f69  ion, partition_i
-00008660: 6e66 6f3d 4e6f 6e65 293a 0a20 2020 2020  nfo=None):.     
-00008670: 2020 202e 2e2e 2020 2020 2070 6173 730a     ...     pass.
-00008680: 0a20 2020 2020 2020 2054 6869 7320 7769  .        This wi
-00008690: 6c6c 2072 6563 6569 7665 2074 6865 2066  ll receive the f
-000086a0: 6f6c 6c6f 7769 6e67 2069 6e66 6f72 6d61  ollowing informa
-000086b0: 7469 6f6e 3a0a 0a20 2020 2020 2020 203e  tion:..        >
-000086c0: 3e3e 2070 6172 7469 7469 6f6e 5f69 6e66  >> partition_inf
-000086d0: 6f20 2023 2064 6f63 7465 7374 3a20 2b53  o  # doctest: +S
-000086e0: 4b49 500a 2020 2020 2020 2020 7b27 6e75  KIP.        {'nu
-000086f0: 6d62 6572 273a 2031 2c20 2764 6976 6973  mber': 1, 'divis
-00008700: 696f 6e27 3a20 337d 0a0a 2020 2020 2020  ion': 3}..      
-00008710: 2020 466f 7220 6561 6368 2061 7267 756d    For each argum
-00008720: 656e 7420 616e 6420 6b65 7977 6f72 6420  ent and keyword 
-00008730: 6172 6775 6d65 6e74 7320 7468 6174 2061  arguments that a
-00008740: 7265 2064 6173 6b20 6461 7461 6672 616d  re dask datafram
-00008750: 6573 2079 6f75 2077 696c 6c0a 2020 2020  es you will.    
-00008760: 2020 2020 7265 6365 6976 6520 7468 6520      receive the 
-00008770: 6e75 6d62 6572 2028 6e29 2077 6869 6368  number (n) which
-00008780: 2072 6570 7265 7365 6e74 7320 7468 6520   represents the 
-00008790: 6e74 6820 7061 7274 6974 696f 6e20 6f66  nth partition of
-000087a0: 2074 6865 2064 6174 6166 7261 6d65 0a20   the dataframe. 
-000087b0: 2020 2020 2020 2061 6e64 2074 6865 2064         and the d
-000087c0: 6976 6973 696f 6e20 2874 6865 2066 6972  ivision (the fir
-000087d0: 7374 2069 6e64 6578 2076 616c 7565 2069  st index value i
-000087e0: 6e20 7468 6520 7061 7274 6974 696f 6e29  n the partition)
-000087f0: 2e20 4966 2064 6976 6973 696f 6e73 0a20  . If divisions. 
-00008800: 2020 2020 2020 2061 7265 206e 6f74 206b         are not k
-00008810: 6e6f 776e 2028 666f 7220 696e 7374 616e  nown (for instan
-00008820: 6365 2069 6620 7468 6520 696e 6465 7820  ce if the index 
-00008830: 6973 206e 6f74 2073 6f72 7465 6429 2074  is not sorted) t
-00008840: 6865 6e20 796f 7520 7769 6c6c 2067 6574  hen you will get
-00008850: 0a20 2020 2020 2020 204e 6f6e 6520 6173  .        None as
-00008860: 2074 6865 2064 6976 6973 696f 6e2e 0a20   the division.. 
-00008870: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00008880: 2020 2072 6574 7572 6e20 6d61 705f 7061     return map_pa
-00008890: 7274 6974 696f 6e73 2866 756e 632c 2073  rtitions(func, s
-000088a0: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
-000088b0: 6172 6773 290a 0a20 2020 2040 696e 7365  args)..    @inse
-000088c0: 7274 5f6d 6574 615f 7061 7261 6d5f 6465  rt_meta_param_de
-000088d0: 7363 7269 7074 696f 6e28 7061 643d 3132  scription(pad=12
-000088e0: 290a 2020 2020 6465 6620 6d61 705f 6f76  ).    def map_ov
-000088f0: 6572 6c61 7028 7365 6c66 2c20 6675 6e63  erlap(self, func
-00008900: 2c20 6265 666f 7265 2c20 6166 7465 722c  , before, after,
-00008910: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00008920: 293a 0a20 2020 2020 2020 2022 2222 4170  ):.        """Ap
-00008930: 706c 7920 6120 6675 6e63 7469 6f6e 2074  ply a function t
-00008940: 6f20 6561 6368 2070 6172 7469 7469 6f6e  o each partition
-00008950: 2c20 7368 6172 696e 6720 726f 7773 2077  , sharing rows w
-00008960: 6974 6820 6164 6a61 6365 6e74 2070 6172  ith adjacent par
-00008970: 7469 7469 6f6e 732e 0a0a 2020 2020 2020  titions...      
-00008980: 2020 5468 6973 2063 616e 2062 6520 7573    This can be us
-00008990: 6566 756c 2066 6f72 2069 6d70 6c65 6d65  eful for impleme
-000089a0: 6e74 696e 6720 7769 6e64 6f77 696e 6720  nting windowing 
-000089b0: 6675 6e63 7469 6f6e 7320 7375 6368 2061  functions such a
-000089c0: 730a 2020 2020 2020 2020 6060 6466 2e72  s.        ``df.r
-000089d0: 6f6c 6c69 6e67 282e 2e2e 292e 6d65 616e  olling(...).mean
-000089e0: 2829 6060 206f 7220 6060 6466 2e64 6966  ()`` or ``df.dif
-000089f0: 6628 2960 602e 0a0a 2020 2020 2020 2020  f()``...        
-00008a00: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00008a10: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00008a20: 2020 2020 2020 6675 6e63 203a 2066 756e        func : fun
-00008a30: 6374 696f 6e0a 2020 2020 2020 2020 2020  ction.          
-00008a40: 2020 4675 6e63 7469 6f6e 2061 7070 6c69    Function appli
-00008a50: 6564 2074 6f20 6561 6368 2070 6172 7469  ed to each parti
-00008a60: 7469 6f6e 2e0a 2020 2020 2020 2020 6265  tion..        be
-00008a70: 666f 7265 203a 2069 6e74 2c20 7469 6d65  fore : int, time
-00008a80: 6465 6c74 6120 6f72 2073 7472 696e 6720  delta or string 
-00008a90: 7469 6d65 6465 6c74 610a 2020 2020 2020  timedelta.      
-00008aa0: 2020 2020 2020 5468 6520 726f 7773 2074        The rows t
-00008ab0: 6f20 7072 6570 656e 6420 746f 2070 6172  o prepend to par
-00008ac0: 7469 7469 6f6e 2060 6069 6060 2066 726f  tition ``i`` fro
-00008ad0: 6d20 7468 6520 656e 6420 6f66 0a20 2020  m the end of.   
-00008ae0: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
-00008af0: 6f6e 2060 6069 202d 2031 6060 2e0a 2020  on ``i - 1``..  
-00008b00: 2020 2020 2020 6166 7465 7220 3a20 696e        after : in
-00008b10: 742c 2074 696d 6564 656c 7461 206f 7220  t, timedelta or 
-00008b20: 7374 7269 6e67 2074 696d 6564 656c 7461  string timedelta
-00008b30: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-00008b40: 2072 6f77 7320 746f 2061 7070 656e 6420   rows to append 
-00008b50: 746f 2070 6172 7469 7469 6f6e 2060 6069  to partition ``i
-00008b60: 6060 2066 726f 6d20 7468 6520 6265 6769  `` from the begi
-00008b70: 6e6e 696e 670a 2020 2020 2020 2020 2020  nning.          
-00008b80: 2020 6f66 2070 6172 7469 7469 6f6e 2060    of partition `
-00008b90: 6069 202b 2031 6060 2e0a 2020 2020 2020  `i + 1``..      
-00008ba0: 2020 6172 6773 2c20 6b77 6172 6773 203a    args, kwargs :
-00008bb0: 0a20 2020 2020 2020 2020 2020 2050 6f73  .            Pos
-00008bc0: 6974 696f 6e61 6c20 616e 6420 6b65 7977  itional and keyw
-00008bd0: 6f72 6420 6172 6775 6d65 6e74 7320 746f  ord arguments to
-00008be0: 2070 6173 7320 746f 2074 6865 2066 756e   pass to the fun
-00008bf0: 6374 696f 6e2e 0a20 2020 2020 2020 2020  ction..         
-00008c00: 2020 2050 6f73 6974 696f 6e61 6c20 6172     Positional ar
-00008c10: 6775 6d65 6e74 7320 6172 6520 636f 6d70  guments are comp
-00008c20: 7574 6564 206f 6e20 6120 7065 722d 7061  uted on a per-pa
-00008c30: 7274 6974 696f 6e20 6261 7369 732c 2077  rtition basis, w
-00008c40: 6869 6c65 0a20 2020 2020 2020 2020 2020  hile.           
-00008c50: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
-00008c60: 7473 2061 7265 2073 6861 7265 6420 6163  ts are shared ac
-00008c70: 726f 7373 2061 6c6c 2070 6172 7469 7469  ross all partiti
-00008c80: 6f6e 732e 2054 6865 2070 6172 7469 7469  ons. The partiti
-00008c90: 6f6e 0a20 2020 2020 2020 2020 2020 2069  on.            i
-00008ca0: 7473 656c 6620 7769 6c6c 2062 6520 7468  tself will be th
-00008cb0: 6520 6669 7273 7420 706f 7369 7469 6f6e  e first position
-00008cc0: 616c 2061 7267 756d 656e 742c 2077 6974  al argument, wit
-00008cd0: 6820 616c 6c20 6f74 6865 720a 2020 2020  h all other.    
-00008ce0: 2020 2020 2020 2020 6172 6775 6d65 6e74          argument
-00008cf0: 7320 7061 7373 6564 202a 6166 7465 722a  s passed *after*
-00008d00: 2e20 4172 6775 6d65 6e74 7320 6361 6e20  . Arguments can 
-00008d10: 6265 2060 6053 6361 6c61 7260 602c 2060  be ``Scalar``, `
-00008d20: 6044 656c 6179 6564 6060 2c0a 2020 2020  `Delayed``,.    
-00008d30: 2020 2020 2020 2020 6f72 2072 6567 756c          or regul
-00008d40: 6172 2050 7974 686f 6e20 6f62 6a65 6374  ar Python object
-00008d50: 732e 2044 6174 6146 7261 6d65 2d6c 696b  s. DataFrame-lik
-00008d60: 6520 6172 6773 2028 626f 7468 2064 6173  e args (both das
-00008d70: 6b20 616e 640a 2020 2020 2020 2020 2020  k and.          
-00008d80: 2020 7061 6e64 6173 2920 7769 6c6c 2062    pandas) will b
-00008d90: 6520 7265 7061 7274 6974 696f 6e65 6420  e repartitioned 
-00008da0: 746f 2061 6c69 676e 2028 6966 206e 6563  to align (if nec
-00008db0: 6573 7361 7279 2920 6265 666f 7265 0a20  essary) before. 
-00008dc0: 2020 2020 2020 2020 2020 2061 7070 6c79             apply
-00008dd0: 696e 6720 7468 6520 6675 6e63 7469 6f6e  ing the function
-00008de0: 3b20 7365 6520 6060 616c 6967 6e5f 6461  ; see ``align_da
-00008df0: 7461 6672 616d 6573 6060 2074 6f20 636f  taframes`` to co
-00008e00: 6e74 726f 6c20 7468 6973 0a20 2020 2020  ntrol this.     
-00008e10: 2020 2020 2020 2062 6568 6176 696f 722e         behavior.
-00008e20: 0a20 2020 2020 2020 2065 6e66 6f72 6365  .        enforce
-00008e30: 5f6d 6574 6164 6174 6120 3a20 626f 6f6c  _metadata : bool
-00008e40: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
-00008e50: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-00008e60: 6572 2074 6f20 656e 666f 7263 6520 6174  er to enforce at
-00008e70: 2072 756e 7469 6d65 2074 6861 7420 7468   runtime that th
-00008e80: 6520 7374 7275 6374 7572 6520 6f66 2074  e structure of t
-00008e90: 6865 2044 6174 6146 7261 6d65 0a20 2020  he DataFrame.   
-00008ea0: 2020 2020 2020 2020 2070 726f 6475 6365           produce
-00008eb0: 6420 6279 2060 6066 756e 6360 6020 6163  d by ``func`` ac
-00008ec0: 7475 616c 6c79 206d 6174 6368 6573 2074  tually matches t
-00008ed0: 6865 2073 7472 7563 7475 7265 206f 6620  he structure of 
-00008ee0: 6060 6d65 7461 6060 2e0a 2020 2020 2020  ``meta``..      
-00008ef0: 2020 2020 2020 5468 6973 2077 696c 6c20        This will 
-00008f00: 7265 6e61 6d65 2061 6e64 2072 656f 7264  rename and reord
-00008f10: 6572 2063 6f6c 756d 6e73 2066 6f72 2065  er columns for e
-00008f20: 6163 6820 7061 7274 6974 696f 6e2c 0a20  ach partition,. 
-00008f30: 2020 2020 2020 2020 2020 2061 6e64 2077             and w
-00008f40: 696c 6c20 7261 6973 6520 616e 2065 7272  ill raise an err
-00008f50: 6f72 2069 6620 7468 6973 2064 6f65 736e  or if this doesn
-00008f60: 2774 2077 6f72 6b2c 0a20 2020 2020 2020  't work,.       
-00008f70: 2020 2020 2062 7574 2069 7420 776f 6e27       but it won'
-00008f80: 7420 7261 6973 6520 6966 2064 7479 7065  t raise if dtype
-00008f90: 7320 646f 6e27 7420 6d61 7463 682e 0a20  s don't match.. 
-00008fa0: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
-00008fb0: 5f64 6976 6973 696f 6e73 203a 2062 6f6f  _divisions : boo
-00008fc0: 6c2c 2064 6566 6175 6c74 2054 7275 650a  l, default True.
-00008fd0: 2020 2020 2020 2020 2020 2020 5768 6574              Whet
-00008fe0: 6865 7220 746f 2061 7070 6c79 2074 6865  her to apply the
-00008ff0: 2066 756e 6374 696f 6e20 6f6e 746f 2074   function onto t
-00009000: 6865 2064 6976 6973 696f 6e73 2061 6e64  he divisions and
-00009010: 2061 7070 6c79 2074 686f 7365 0a20 2020   apply those.   
-00009020: 2020 2020 2020 2020 2074 7261 6e73 666f           transfo
-00009030: 726d 6564 2064 6976 6973 696f 6e73 2074  rmed divisions t
-00009040: 6f20 7468 6520 6f75 7470 7574 2e0a 2020  o the output..  
-00009050: 2020 2020 2020 616c 6967 6e5f 6461 7461        align_data
-00009060: 6672 616d 6573 203a 2062 6f6f 6c2c 2064  frames : bool, d
-00009070: 6566 6175 6c74 2054 7275 650a 2020 2020  efault True.    
-00009080: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
-00009090: 746f 2072 6570 6172 7469 7469 6f6e 2044  to repartition D
-000090a0: 6174 6146 7261 6d65 2d20 6f72 2053 6572  ataFrame- or Ser
-000090b0: 6965 732d 6c69 6b65 2061 7267 730a 2020  ies-like args.  
-000090c0: 2020 2020 2020 2020 2020 2862 6f74 6820            (both 
-000090d0: 6461 736b 2061 6e64 2070 616e 6461 7329  dask and pandas)
-000090e0: 2073 6f20 7468 6569 7220 6469 7669 7369   so their divisi
-000090f0: 6f6e 7320 616c 6967 6e20 6265 666f 7265  ons align before
-00009100: 2061 7070 6c79 696e 670a 2020 2020 2020   applying.      
-00009110: 2020 2020 2020 7468 6520 6675 6e63 7469        the functi
-00009120: 6f6e 2e20 5468 6973 2072 6571 7569 7265  on. This require
-00009130: 7320 616c 6c20 696e 7075 7473 2074 6f20  s all inputs to 
-00009140: 6861 7665 206b 6e6f 776e 2064 6976 6973  have known divis
-00009150: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
-00009160: 2020 5369 6e67 6c65 2d70 6172 7469 7469    Single-partiti
-00009170: 6f6e 2069 6e70 7574 7320 7769 6c6c 2062  on inputs will b
-00009180: 6520 7370 6c69 7420 696e 746f 206d 756c  e split into mul
-00009190: 7469 706c 6520 7061 7274 6974 696f 6e73  tiple partitions
-000091a0: 2e0a 0a20 2020 2020 2020 2020 2020 2049  ...            I
-000091b0: 6620 4661 6c73 652c 2061 6c6c 2069 6e70  f False, all inp
-000091c0: 7574 7320 6d75 7374 2068 6176 6520 6569  uts must have ei
-000091d0: 7468 6572 2074 6865 2073 616d 6520 6e75  ther the same nu
-000091e0: 6d62 6572 206f 6620 7061 7274 6974 696f  mber of partitio
-000091f0: 6e73 0a20 2020 2020 2020 2020 2020 206f  ns.            o
-00009200: 7220 6120 7369 6e67 6c65 2070 6172 7469  r a single parti
-00009210: 7469 6f6e 2e20 5369 6e67 6c65 2d70 6172  tion. Single-par
-00009220: 7469 7469 6f6e 2069 6e70 7574 7320 7769  tition inputs wi
-00009230: 6c6c 2062 6520 6272 6f61 6463 6173 7420  ll be broadcast 
-00009240: 746f 0a20 2020 2020 2020 2020 2020 2065  to.            e
-00009250: 7665 7279 2070 6172 7469 7469 6f6e 206f  very partition o
-00009260: 6620 6d75 6c74 692d 7061 7274 6974 696f  f multi-partitio
-00009270: 6e20 696e 7075 7473 2e0a 2020 2020 2020  n inputs..      
-00009280: 2020 244d 4554 410a 0a20 2020 2020 2020    $META..       
-00009290: 204e 6f74 6573 0a20 2020 2020 2020 202d   Notes.        -
-000092a0: 2d2d 2d2d 0a20 2020 2020 2020 2047 6976  ----.        Giv
-000092b0: 656e 2070 6f73 6974 6976 6520 696e 7465  en positive inte
-000092c0: 6765 7273 2060 6062 6566 6f72 6560 6020  gers ``before`` 
-000092d0: 616e 6420 6060 6166 7465 7260 602c 2061  and ``after``, a
-000092e0: 6e64 2061 2066 756e 6374 696f 6e0a 2020  nd a function.  
-000092f0: 2020 2020 2020 6060 6675 6e63 6060 2c20        ``func``, 
-00009300: 6060 6d61 705f 6f76 6572 6c61 7060 6020  ``map_overlap`` 
-00009310: 646f 6573 2074 6865 2066 6f6c 6c6f 7769  does the followi
-00009320: 6e67 3a0a 0a20 2020 2020 2020 2031 2e20  ng:..        1. 
-00009330: 5072 6570 656e 6420 6060 6265 666f 7265  Prepend ``before
-00009340: 6060 2072 6f77 7320 746f 2065 6163 6820  `` rows to each 
-00009350: 7061 7274 6974 696f 6e20 6060 6960 6020  partition ``i`` 
-00009360: 6672 6f6d 2074 6865 2065 6e64 206f 660a  from the end of.
-00009370: 2020 2020 2020 2020 2020 2070 6172 7469             parti
-00009380: 7469 6f6e 2060 6069 202d 2031 6060 2e20  tion ``i - 1``. 
-00009390: 5468 6520 6669 7273 7420 7061 7274 6974  The first partit
-000093a0: 696f 6e20 6861 7320 6e6f 2072 6f77 7320  ion has no rows 
-000093b0: 7072 6570 656e 6465 642e 0a0a 2020 2020  prepended...    
-000093c0: 2020 2020 322e 2041 7070 656e 6420 6060      2. Append ``
-000093d0: 6166 7465 7260 6020 726f 7773 2074 6f20  after`` rows to 
-000093e0: 6561 6368 2070 6172 7469 7469 6f6e 2060  each partition `
-000093f0: 6069 6060 2066 726f 6d20 7468 6520 6265  `i`` from the be
-00009400: 6769 6e6e 696e 6720 6f66 0a20 2020 2020  ginning of.     
-00009410: 2020 2020 2020 7061 7274 6974 696f 6e20        partition 
-00009420: 6060 6920 2b20 3160 602e 2054 6865 206c  ``i + 1``. The l
-00009430: 6173 7420 7061 7274 6974 696f 6e20 6861  ast partition ha
-00009440: 7320 6e6f 2072 6f77 7320 6170 7065 6e64  s no rows append
-00009450: 6564 2e0a 0a20 2020 2020 2020 2033 2e20  ed...        3. 
-00009460: 4170 706c 7920 6060 6675 6e63 6060 2074  Apply ``func`` t
-00009470: 6f20 6561 6368 2070 6172 7469 7469 6f6e  o each partition
-00009480: 2c20 7061 7373 696e 6720 696e 2061 6e79  , passing in any
-00009490: 2065 7874 7261 2060 6061 7267 7360 6020   extra ``args`` 
-000094a0: 616e 640a 2020 2020 2020 2020 2020 2060  and.           `
-000094b0: 606b 7761 7267 7360 6020 6966 2070 726f  `kwargs`` if pro
-000094c0: 7669 6465 642e 0a0a 2020 2020 2020 2020  vided...        
-000094d0: 342e 2054 7269 6d20 6060 6265 666f 7265  4. Trim ``before
-000094e0: 6060 2072 6f77 7320 6672 6f6d 2074 6865  `` rows from the
-000094f0: 2062 6567 696e 6e69 6e67 206f 6620 616c   beginning of al
-00009500: 6c20 6275 7420 7468 6520 6669 7273 740a  l but the first.
-00009510: 2020 2020 2020 2020 2020 2070 6172 7469             parti
-00009520: 7469 6f6e 2e0a 0a20 2020 2020 2020 2035  tion...        5
-00009530: 2e20 5472 696d 2060 6061 6674 6572 6060  . Trim ``after``
-00009540: 2072 6f77 7320 6672 6f6d 2074 6865 2065   rows from the e
-00009550: 6e64 206f 6620 616c 6c20 6275 7420 7468  nd of all but th
-00009560: 6520 6c61 7374 2070 6172 7469 7469 6f6e  e last partition
-00009570: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-00009580: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
-00009590: 2d2d 2d2d 0a20 2020 2020 2020 2047 6976  ----.        Giv
-000095a0: 656e 2061 2044 6174 6146 7261 6d65 2c20  en a DataFrame, 
-000095b0: 5365 7269 6573 2c20 6f72 2049 6e64 6578  Series, or Index
-000095c0: 2c20 7375 6368 2061 733a 0a0a 2020 2020  , such as:..    
-000095d0: 2020 2020 3e3e 3e20 696d 706f 7274 2070      >>> import p
-000095e0: 616e 6461 7320 6173 2070 640a 2020 2020  andas as pd.    
-000095f0: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-00009600: 6173 6b2e 6461 7461 6672 616d 6520 6173  ask.dataframe as
-00009610: 2064 640a 2020 2020 2020 2020 3e3e 3e20   dd.        >>> 
-00009620: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
-00009630: 6528 7b27 7827 3a20 5b31 2c20 322c 2034  e({'x': [1, 2, 4
-00009640: 2c20 372c 2031 315d 2c0a 2020 2020 2020  , 7, 11],.      
-00009650: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-00009660: 2020 2020 2020 2020 2027 7927 3a20 5b31           'y': [1
-00009670: 2e2c 2032 2e2c 2033 2e2c 2034 2e2c 2035  ., 2., 3., 4., 5
-00009680: 2e5d 7d29 0a20 2020 2020 2020 203e 3e3e  .]}).        >>>
-00009690: 2064 6466 203d 2064 642e 6672 6f6d 5f70   ddf = dd.from_p
-000096a0: 616e 6461 7328 6466 2c20 6e70 6172 7469  andas(df, nparti
-000096b0: 7469 6f6e 733d 3229 0a0a 2020 2020 2020  tions=2)..      
-000096c0: 2020 4120 726f 6c6c 696e 6720 7375 6d20    A rolling sum 
-000096d0: 7769 7468 2061 2074 7261 696c 696e 6720  with a trailing 
-000096e0: 6d6f 7669 6e67 2077 696e 646f 7720 6f66  moving window of
-000096f0: 2073 697a 6520 3220 6361 6e20 6265 2063   size 2 can be c
-00009700: 6f6d 7075 7465 6420 6279 0a20 2020 2020  omputed by.     
-00009710: 2020 206f 7665 726c 6170 7069 6e67 2032     overlapping 2
-00009720: 2072 6f77 7320 6265 666f 7265 2065 6163   rows before eac
-00009730: 6820 7061 7274 6974 696f 6e2c 2061 6e64  h partition, and
-00009740: 2074 6865 6e20 6d61 7070 696e 6720 6361   then mapping ca
-00009750: 6c6c 7320 746f 0a20 2020 2020 2020 2060  lls to.        `
-00009760: 6064 662e 726f 6c6c 696e 6728 3229 2e73  `df.rolling(2).s
-00009770: 756d 2829 6060 3a0a 0a20 2020 2020 2020  um()``:..       
-00009780: 203e 3e3e 2064 6466 2e63 6f6d 7075 7465   >>> ddf.compute
-00009790: 2829 0a20 2020 2020 2020 2020 2020 2078  ().            x
-000097a0: 2020 2020 790a 2020 2020 2020 2020 3020      y.        0 
-000097b0: 2020 3120 2031 2e30 0a20 2020 2020 2020    1  1.0.       
-000097c0: 2031 2020 2032 2020 322e 300a 2020 2020   1   2  2.0.    
-000097d0: 2020 2020 3220 2020 3420 2033 2e30 0a20      2   4  3.0. 
-000097e0: 2020 2020 2020 2033 2020 2037 2020 342e         3   7  4.
-000097f0: 300a 2020 2020 2020 2020 3420 2031 3120  0.        4  11 
-00009800: 2035 2e30 0a20 2020 2020 2020 203e 3e3e   5.0.        >>>
-00009810: 2064 6466 2e6d 6170 5f6f 7665 726c 6170   ddf.map_overlap
-00009820: 286c 616d 6264 6120 6466 3a20 6466 2e72  (lambda df: df.r
-00009830: 6f6c 6c69 6e67 2832 292e 7375 6d28 292c  olling(2).sum(),
-00009840: 2032 2c20 3029 2e63 6f6d 7075 7465 2829   2, 0).compute()
-00009850: 0a20 2020 2020 2020 2020 2020 2020 2078  .              x
-00009860: 2020 2020 790a 2020 2020 2020 2020 3020      y.        0 
-00009870: 2020 4e61 4e20 204e 614e 0a20 2020 2020    NaN  NaN.     
-00009880: 2020 2031 2020 2033 2e30 2020 332e 300a     1   3.0  3.0.
-00009890: 2020 2020 2020 2020 3220 2020 362e 3020          2   6.0 
-000098a0: 2035 2e30 0a20 2020 2020 2020 2033 2020   5.0.        3  
-000098b0: 3131 2e30 2020 372e 300a 2020 2020 2020  11.0  7.0.      
-000098c0: 2020 3420 2031 382e 3020 2039 2e30 0a0a    4  18.0  9.0..
-000098d0: 2020 2020 2020 2020 5468 6520 7061 6e64          The pand
-000098e0: 6173 2060 6064 6966 6660 6020 6d65 7468  as ``diff`` meth
-000098f0: 6f64 2063 6f6d 7075 7465 7320 6120 6469  od computes a di
-00009900: 7363 7265 7465 2064 6966 6665 7265 6e63  screte differenc
-00009910: 6520 7368 6966 7465 6420 6279 2061 0a20  e shifted by a. 
-00009920: 2020 2020 2020 206e 756d 6265 7220 6f66         number of
-00009930: 2070 6572 696f 6473 2028 6361 6e20 6265   periods (can be
-00009940: 2070 6f73 6974 6976 6520 6f72 206e 6567   positive or neg
-00009950: 6174 6976 6529 2e20 5468 6973 2063 616e  ative). This can
-00009960: 2062 650a 2020 2020 2020 2020 696d 706c   be.        impl
-00009970: 656d 656e 7465 6420 6279 206d 6170 7069  emented by mappi
-00009980: 6e67 2063 616c 6c73 2074 6f20 6060 6466  ng calls to ``df
-00009990: 2e64 6966 6660 6020 746f 2065 6163 6820  .diff`` to each 
-000099a0: 7061 7274 6974 696f 6e20 6166 7465 720a  partition after.
-000099b0: 2020 2020 2020 2020 7072 6570 656e 6469          prependi
-000099c0: 6e67 2f61 7070 656e 6469 6e67 2074 6861  ng/appending tha
-000099d0: 7420 6d61 6e79 2072 6f77 732c 2064 6570  t many rows, dep
-000099e0: 656e 6469 6e67 206f 6e20 7369 676e 3a0a  ending on sign:.
-000099f0: 0a20 2020 2020 2020 203e 3e3e 2064 6566  .        >>> def
-00009a00: 2064 6966 6628 6466 2c20 7065 7269 6f64   diff(df, period
-00009a10: 733d 3129 3a0a 2020 2020 2020 2020 2e2e  s=1):.        ..
-00009a20: 2e20 2020 2020 6265 666f 7265 2c20 6166  .     before, af
-00009a30: 7465 7220 3d20 2870 6572 696f 6473 2c20  ter = (periods, 
-00009a40: 3029 2069 6620 7065 7269 6f64 7320 3e20  0) if periods > 
-00009a50: 3020 656c 7365 2028 302c 202d 7065 7269  0 else (0, -peri
-00009a60: 6f64 7329 0a20 2020 2020 2020 202e 2e2e  ods).        ...
-00009a70: 2020 2020 2072 6574 7572 6e20 6466 2e6d       return df.m
-00009a80: 6170 5f6f 7665 726c 6170 286c 616d 6264  ap_overlap(lambd
-00009a90: 6120 6466 2c20 7065 7269 6f64 733d 313a  a df, periods=1:
-00009aa0: 2064 662e 6469 6666 2870 6572 696f 6473   df.diff(periods
-00009ab0: 292c 0a20 2020 2020 2020 202e 2e2e 2020  ),.        ...  
-00009ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009ad0: 2020 2020 2020 2020 2070 6572 696f 6473           periods
-00009ae0: 2c20 302c 2070 6572 696f 6473 3d70 6572  , 0, periods=per
-00009af0: 696f 6473 290a 2020 2020 2020 2020 3e3e  iods).        >>
-00009b00: 3e20 6469 6666 2864 6466 2c20 3129 2e63  > diff(ddf, 1).c
-00009b10: 6f6d 7075 7465 2829 0a20 2020 2020 2020  ompute().       
-00009b20: 2020 2020 2020 7820 2020 2079 0a20 2020        x    y.   
-00009b30: 2020 2020 2030 2020 4e61 4e20 204e 614e       0  NaN  NaN
-00009b40: 0a20 2020 2020 2020 2031 2020 312e 3020  .        1  1.0 
-00009b50: 2031 2e30 0a20 2020 2020 2020 2032 2020   1.0.        2  
-00009b60: 322e 3020 2031 2e30 0a20 2020 2020 2020  2.0  1.0.       
-00009b70: 2033 2020 332e 3020 2031 2e30 0a20 2020   3  3.0  1.0.   
-00009b80: 2020 2020 2034 2020 342e 3020 2031 2e30       4  4.0  1.0
-00009b90: 0a0a 2020 2020 2020 2020 4966 2079 6f75  ..        If you
-00009ba0: 2068 6176 6520 6120 6060 4461 7465 7469   have a ``Dateti
-00009bb0: 6d65 496e 6465 7860 602c 2079 6f75 2063  meIndex``, you c
-00009bc0: 616e 2075 7365 2061 2060 6070 642e 5469  an use a ``pd.Ti
-00009bd0: 6d65 6465 6c74 6160 6020 666f 7220 7469  medelta`` for ti
-00009be0: 6d65 2d0a 2020 2020 2020 2020 6261 7365  me-.        base
-00009bf0: 6420 7769 6e64 6f77 7320 6f72 2061 6e79  d windows or any
-00009c00: 2060 6070 642e 5469 6d65 6465 6c74 6160   ``pd.Timedelta`
-00009c10: 6020 636f 6e76 6572 7469 626c 6520 7374  ` convertible st
-00009c20: 7269 6e67 3a0a 0a20 2020 2020 2020 203e  ring:..        >
-00009c30: 3e3e 2074 7320 3d20 7064 2e53 6572 6965  >> ts = pd.Serie
-00009c40: 7328 7261 6e67 6528 3130 292c 2069 6e64  s(range(10), ind
-00009c50: 6578 3d70 642e 6461 7465 5f72 616e 6765  ex=pd.date_range
-00009c60: 2827 3230 3137 272c 2070 6572 696f 6473  ('2017', periods
-00009c70: 3d31 3029 290a 2020 2020 2020 2020 3e3e  =10)).        >>
-00009c80: 3e20 6474 7320 3d20 6464 2e66 726f 6d5f  > dts = dd.from_
-00009c90: 7061 6e64 6173 2874 732c 206e 7061 7274  pandas(ts, npart
-00009ca0: 6974 696f 6e73 3d32 290a 2020 2020 2020  itions=2).      
-00009cb0: 2020 3e3e 3e20 6474 732e 6d61 705f 6f76    >>> dts.map_ov
-00009cc0: 6572 6c61 7028 6c61 6d62 6461 2064 663a  erlap(lambda df:
-00009cd0: 2064 662e 726f 6c6c 696e 6728 2732 4427   df.rolling('2D'
-00009ce0: 292e 7375 6d28 292c 0a20 2020 2020 2020  ).sum(),.       
-00009cf0: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-00009d00: 2020 2020 2070 642e 5469 6d65 6465 6c74       pd.Timedelt
-00009d10: 6128 2732 4427 292c 2030 292e 636f 6d70  a('2D'), 0).comp
-00009d20: 7574 6528 290a 2020 2020 2020 2020 3230  ute().        20
-00009d30: 3137 2d30 312d 3031 2020 2020 2030 2e30  17-01-01     0.0
-00009d40: 0a20 2020 2020 2020 2032 3031 372d 3031  .        2017-01
-00009d50: 2d30 3220 2020 2020 312e 300a 2020 2020  -02     1.0.    
-00009d60: 2020 2020 3230 3137 2d30 312d 3033 2020      2017-01-03  
-00009d70: 2020 2033 2e30 0a20 2020 2020 2020 2032     3.0.        2
-00009d80: 3031 372d 3031 2d30 3420 2020 2020 352e  017-01-04     5.
-00009d90: 300a 2020 2020 2020 2020 3230 3137 2d30  0.        2017-0
-00009da0: 312d 3035 2020 2020 2037 2e30 0a20 2020  1-05     7.0.   
-00009db0: 2020 2020 2032 3031 372d 3031 2d30 3620       2017-01-06 
-00009dc0: 2020 2020 392e 300a 2020 2020 2020 2020      9.0.        
-00009dd0: 3230 3137 2d30 312d 3037 2020 2020 3131  2017-01-07    11
-00009de0: 2e30 0a20 2020 2020 2020 2032 3031 372d  .0.        2017-
-00009df0: 3031 2d30 3820 2020 2031 332e 300a 2020  01-08    13.0.  
-00009e00: 2020 2020 2020 3230 3137 2d30 312d 3039        2017-01-09
-00009e10: 2020 2020 3135 2e30 0a20 2020 2020 2020      15.0.       
-00009e20: 2032 3031 372d 3031 2d31 3020 2020 2031   2017-01-10    1
-00009e30: 372e 300a 2020 2020 2020 2020 4672 6571  7.0.        Freq
-00009e40: 3a20 442c 2064 7479 7065 3a20 666c 6f61  : D, dtype: floa
-00009e50: 7436 340a 2020 2020 2020 2020 2222 220a  t64.        """.
-00009e60: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00009e70: 6b2e 6461 7461 6672 616d 652e 726f 6c6c  k.dataframe.roll
-00009e80: 696e 6720 696d 706f 7274 206d 6170 5f6f  ing import map_o
-00009e90: 7665 726c 6170 0a0a 2020 2020 2020 2020  verlap..        
-00009ea0: 7265 7475 726e 206d 6170 5f6f 7665 726c  return map_overl
-00009eb0: 6170 2866 756e 632c 2073 656c 662c 2062  ap(func, self, b
-00009ec0: 6566 6f72 652c 2061 6674 6572 2c20 2a61  efore, after, *a
-00009ed0: 7267 732c 202a 2a6b 7761 7267 7329 0a0a  rgs, **kwargs)..
-00009ee0: 2020 2020 6465 6620 6d65 6d6f 7279 5f75      def memory_u
-00009ef0: 7361 6765 5f70 6572 5f70 6172 7469 7469  sage_per_partiti
-00009f00: 6f6e 2873 656c 662c 2069 6e64 6578 3d54  on(self, index=T
-00009f10: 7275 652c 2064 6565 703d 4661 6c73 6529  rue, deep=False)
-00009f20: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00009f30: 7572 6e20 7468 6520 6d65 6d6f 7279 2075  urn the memory u
-00009f40: 7361 6765 206f 6620 6561 6368 2070 6172  sage of each par
-00009f50: 7469 7469 6f6e 0a0a 2020 2020 2020 2020  tition..        
-00009f60: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00009f70: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00009f80: 2020 2020 2020 696e 6465 7820 3a20 626f        index : bo
-00009f90: 6f6c 2c20 6465 6661 756c 7420 5472 7565  ol, default True
-00009fa0: 0a20 2020 2020 2020 2020 2020 2053 7065  .            Spe
-00009fb0: 6369 6669 6573 2077 6865 7468 6572 2074  cifies whether t
-00009fc0: 6f20 696e 636c 7564 6520 7468 6520 6d65  o include the me
-00009fd0: 6d6f 7279 2075 7361 6765 206f 6620 7468  mory usage of th
-00009fe0: 6520 696e 6465 7820 696e 0a20 2020 2020  e index in.     
-00009ff0: 2020 2020 2020 2072 6574 7572 6e65 6420         returned 
-0000a000: 5365 7269 6573 2e0a 2020 2020 2020 2020  Series..        
-0000a010: 6465 6570 203a 2062 6f6f 6c2c 2064 6566  deep : bool, def
-0000a020: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
-0000a030: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-0000a040: 696e 7472 6f73 7065 6374 2074 6865 2064  introspect the d
-0000a050: 6174 6120 6465 6570 6c79 2062 7920 696e  ata deeply by in
-0000a060: 7465 7272 6f67 6174 696e 670a 2020 2020  terrogating.    
-0000a070: 2020 2020 2020 2020 6060 6f62 6a65 6374          ``object
-0000a080: 6060 2064 7479 7065 7320 666f 7220 7379  `` dtypes for sy
-0000a090: 7374 656d 2d6c 6576 656c 206d 656d 6f72  stem-level memor
-0000a0a0: 7920 636f 6e73 756d 7074 696f 6e2c 2061  y consumption, a
-0000a0b0: 6e64 2069 6e63 6c75 6465 0a20 2020 2020  nd include.     
-0000a0c0: 2020 2020 2020 2069 7420 696e 2074 6865         it in the
-0000a0d0: 2072 6574 7572 6e65 6420 7661 6c75 6573   returned values
-0000a0e0: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-0000a0f0: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
-0000a100: 2d2d 0a20 2020 2020 2020 2053 6572 6965  --.        Serie
-0000a110: 730a 2020 2020 2020 2020 2020 2020 4120  s.            A 
-0000a120: 5365 7269 6573 2077 686f 7365 2069 6e64  Series whose ind
-0000a130: 6578 2069 7320 7468 6520 7061 7274 6974  ex is the partit
-0000a140: 696f 6e20 6e75 6d62 6572 2061 6e64 2077  ion number and w
-0000a150: 686f 7365 2076 616c 7565 730a 2020 2020  hose values.    
-0000a160: 2020 2020 2020 2020 6172 6520 7468 6520          are the 
-0000a170: 6d65 6d6f 7279 2075 7361 6765 206f 6620  memory usage of 
-0000a180: 6561 6368 2070 6172 7469 7469 6f6e 2069  each partition i
-0000a190: 6e20 6279 7465 732e 0a20 2020 2020 2020  n bytes..       
-0000a1a0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-0000a1b0: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
-0000a1c0: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
-0000a1d0: 2020 2020 2074 6f74 616c 5f6d 656d 5f75       total_mem_u
-0000a1e0: 7361 6765 2c20 696e 6465 783d 696e 6465  sage, index=inde
-0000a1f0: 782c 2064 6565 703d 6465 6570 0a20 2020  x, deep=deep.   
-0000a200: 2020 2020 2029 2e63 6c65 6172 5f64 6976       ).clear_div
-0000a210: 6973 696f 6e73 2829 0a0a 2020 2020 4069  isions()..    @i
-0000a220: 6e73 6572 745f 6d65 7461 5f70 6172 616d  nsert_meta_param
-0000a230: 5f64 6573 6372 6970 7469 6f6e 2870 6164  _description(pad
-0000a240: 3d31 3229 0a20 2020 2064 6566 2072 6564  =12).    def red
-0000a250: 7563 7469 6f6e 280a 2020 2020 2020 2020  uction(.        
-0000a260: 7365 6c66 2c0a 2020 2020 2020 2020 6368  self,.        ch
-0000a270: 756e 6b2c 0a20 2020 2020 2020 2061 6767  unk,.        agg
-0000a280: 7265 6761 7465 3d4e 6f6e 652c 0a20 2020  regate=None,.   
-0000a290: 2020 2020 2063 6f6d 6269 6e65 3d4e 6f6e       combine=Non
-0000a2a0: 652c 0a20 2020 2020 2020 206d 6574 613d  e,.        meta=
-0000a2b0: 6e6f 5f64 6566 6175 6c74 2c0a 2020 2020  no_default,.    
-0000a2c0: 2020 2020 746f 6b65 6e3d 4e6f 6e65 2c0a      token=None,.
-0000a2d0: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-0000a2e0: 6572 793d 4e6f 6e65 2c0a 2020 2020 2020  ery=None,.      
-0000a2f0: 2020 6368 756e 6b5f 6b77 6172 6773 3d4e    chunk_kwargs=N
-0000a300: 6f6e 652c 0a20 2020 2020 2020 2061 6767  one,.        agg
-0000a310: 7265 6761 7465 5f6b 7761 7267 733d 4e6f  regate_kwargs=No
-0000a320: 6e65 2c0a 2020 2020 2020 2020 636f 6d62  ne,.        comb
-0000a330: 696e 655f 6b77 6172 6773 3d4e 6f6e 652c  ine_kwargs=None,
-0000a340: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-0000a350: 732c 0a20 2020 2029 3a0a 2020 2020 2020  s,.    ):.      
-0000a360: 2020 2222 2247 656e 6572 6963 2072 6f77    """Generic row
-0000a370: 2d77 6973 6520 7265 6475 6374 696f 6e73  -wise reductions
-0000a380: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0000a390: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-0000a3a0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0000a3b0: 2063 6875 6e6b 203a 2063 616c 6c61 626c   chunk : callabl
-0000a3c0: 650a 2020 2020 2020 2020 2020 2020 4675  e.            Fu
-0000a3d0: 6e63 7469 6f6e 2074 6f20 6f70 6572 6174  nction to operat
-0000a3e0: 6520 6f6e 2065 6163 6820 7061 7274 6974  e on each partit
-0000a3f0: 696f 6e2e 2053 686f 756c 6420 7265 7475  ion. Should retu
-0000a400: 726e 2061 0a20 2020 2020 2020 2020 2020  rn a.           
-0000a410: 2060 6070 616e 6461 732e 4461 7461 4672   ``pandas.DataFr
-0000a420: 616d 6560 602c 2060 6070 616e 6461 732e  ame``, ``pandas.
-0000a430: 5365 7269 6573 6060 2c20 6f72 2061 2073  Series``, or a s
-0000a440: 6361 6c61 722e 0a20 2020 2020 2020 2061  calar..        a
-0000a450: 6767 7265 6761 7465 203a 2063 616c 6c61  ggregate : calla
-0000a460: 626c 652c 206f 7074 696f 6e61 6c0a 2020  ble, optional.  
-0000a470: 2020 2020 2020 2020 2020 4675 6e63 7469            Functi
-0000a480: 6f6e 2074 6f20 6f70 6572 6174 6520 6f6e  on to operate on
-0000a490: 2074 6865 2063 6f6e 6361 7465 6e61 7465   the concatenate
-0000a4a0: 6420 7265 7375 6c74 206f 6620 6060 6368  d result of ``ch
-0000a4b0: 756e 6b60 602e 2049 6620 6e6f 740a 2020  unk``. If not.  
-0000a4c0: 2020 2020 2020 2020 2020 7370 6563 6966            specif
-0000a4d0: 6965 642c 2064 6566 6175 6c74 7320 746f  ied, defaults to
-0000a4e0: 2060 6063 6875 6e6b 6060 2e20 5573 6564   ``chunk``. Used
-0000a4f0: 2074 6f20 646f 2074 6865 2066 696e 616c   to do the final
-0000a500: 2061 6767 7265 6761 7469 6f6e 0a20 2020   aggregation.   
-0000a510: 2020 2020 2020 2020 2069 6e20 6120 7472           in a tr
-0000a520: 6565 2072 6564 7563 7469 6f6e 2e0a 0a20  ee reduction... 
-0000a530: 2020 2020 2020 2020 2020 2054 6865 2069             The i
-0000a540: 6e70 7574 2074 6f20 6060 6167 6772 6567  nput to ``aggreg
-0000a550: 6174 6560 6020 6465 7065 6e64 7320 6f6e  ate`` depends on
-0000a560: 2074 6865 206f 7574 7075 7420 6f66 2060   the output of `
-0000a570: 6063 6875 6e6b 6060 2e0a 2020 2020 2020  `chunk``..      
-0000a580: 2020 2020 2020 4966 2074 6865 206f 7574        If the out
-0000a590: 7075 7420 6f66 2060 6063 6875 6e6b 6060  put of ``chunk``
-0000a5a0: 2069 7320 613a 0a0a 2020 2020 2020 2020   is a:..        
-0000a5b0: 2020 2020 2d20 7363 616c 6172 3a20 496e      - scalar: In
-0000a5c0: 7075 7420 6973 2061 2053 6572 6965 732c  put is a Series,
-0000a5d0: 2077 6974 6820 6f6e 6520 726f 7720 7065   with one row pe
-0000a5e0: 7220 7061 7274 6974 696f 6e2e 0a20 2020  r partition..   
-0000a5f0: 2020 2020 2020 2020 202d 2053 6572 6965           - Serie
-0000a600: 733a 2049 6e70 7574 2069 7320 6120 4461  s: Input is a Da
-0000a610: 7461 4672 616d 652c 2077 6974 6820 6f6e  taFrame, with on
-0000a620: 6520 726f 7720 7065 7220 7061 7274 6974  e row per partit
-0000a630: 696f 6e2e 2043 6f6c 756d 6e73 0a20 2020  ion. Columns.   
-0000a640: 2020 2020 2020 2020 2020 2061 7265 2074             are t
-0000a650: 6865 2072 6f77 7320 696e 2074 6865 206f  he rows in the o
-0000a660: 7574 7075 7420 7365 7269 6573 2e0a 2020  utput series..  
-0000a670: 2020 2020 2020 2020 2020 2d20 4461 7461            - Data
-0000a680: 4672 616d 653a 2049 6e70 7574 2069 7320  Frame: Input is 
-0000a690: 6120 4461 7461 4672 616d 652c 2077 6974  a DataFrame, wit
-0000a6a0: 6820 6f6e 6520 726f 7720 7065 7220 7061  h one row per pa
-0000a6b0: 7274 6974 696f 6e2e 0a20 2020 2020 2020  rtition..       
-0000a6c0: 2020 2020 2020 2043 6f6c 756d 6e73 2061         Columns a
-0000a6d0: 7265 2074 6865 2063 6f6c 756d 6e73 2069  re the columns i
-0000a6e0: 6e20 7468 6520 6f75 7470 7574 2064 6174  n the output dat
-0000a6f0: 6166 7261 6d65 732e 0a0a 2020 2020 2020  aframes...      
-0000a700: 2020 2020 2020 5368 6f75 6c64 2072 6574        Should ret
-0000a710: 7572 6e20 6120 6060 7061 6e64 6173 2e44  urn a ``pandas.D
-0000a720: 6174 6146 7261 6d65 6060 2c20 6060 7061  ataFrame``, ``pa
-0000a730: 6e64 6173 2e53 6572 6965 7360 602c 206f  ndas.Series``, o
-0000a740: 7220 610a 2020 2020 2020 2020 2020 2020  r a.            
-0000a750: 7363 616c 6172 2e0a 2020 2020 2020 2020  scalar..        
-0000a760: 636f 6d62 696e 6520 3a20 6361 6c6c 6162  combine : callab
-0000a770: 6c65 2c20 6f70 7469 6f6e 616c 0a20 2020  le, optional.   
-0000a780: 2020 2020 2020 2020 2046 756e 6374 696f           Functio
-0000a790: 6e20 746f 206f 7065 7261 7465 206f 6e20  n to operate on 
-0000a7a0: 696e 7465 726d 6564 6961 7465 2063 6f6e  intermediate con
-0000a7b0: 6361 7465 6e61 7465 6420 7265 7375 6c74  catenated result
-0000a7c0: 7320 6f66 0a20 2020 2020 2020 2020 2020  s of.           
-0000a7d0: 2060 6063 6875 6e6b 6060 2069 6e20 6120   ``chunk`` in a 
-0000a7e0: 7472 6565 2d72 6564 7563 7469 6f6e 2e20  tree-reduction. 
-0000a7f0: 4966 206e 6f74 2070 726f 7669 6465 642c  If not provided,
-0000a800: 2064 6566 6175 6c74 7320 746f 0a20 2020   defaults to.   
-0000a810: 2020 2020 2020 2020 2060 6061 6767 7265           ``aggre
-0000a820: 6761 7465 6060 2e20 5468 6520 696e 7075  gate``. The inpu
-0000a830: 742f 6f75 7470 7574 2072 6571 7569 7265  t/output require
-0000a840: 6d65 6e74 7320 7368 6f75 6c64 206d 6174  ments should mat
-0000a850: 6368 2074 6861 7420 6f66 0a20 2020 2020  ch that of.     
-0000a860: 2020 2020 2020 2060 6061 6767 7265 6761         ``aggrega
-0000a870: 7465 6060 2064 6573 6372 6962 6564 2061  te`` described a
-0000a880: 626f 7665 2e0a 2020 2020 2020 2020 244d  bove..        $M
-0000a890: 4554 410a 2020 2020 2020 2020 746f 6b65  ETA.        toke
-0000a8a0: 6e20 3a20 7374 722c 206f 7074 696f 6e61  n : str, optiona
-0000a8b0: 6c0a 2020 2020 2020 2020 2020 2020 5468  l.            Th
-0000a8c0: 6520 6e61 6d65 2074 6f20 7573 6520 666f  e name to use fo
-0000a8d0: 7220 7468 6520 6f75 7470 7574 206b 6579  r the output key
-0000a8e0: 732e 0a20 2020 2020 2020 2073 706c 6974  s..        split
-0000a8f0: 5f65 7665 7279 203a 2069 6e74 2c20 6f70  _every : int, op
-0000a900: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0000a910: 2020 2047 726f 7570 2070 6172 7469 7469     Group partiti
-0000a920: 6f6e 7320 696e 746f 2067 726f 7570 7320  ons into groups 
-0000a930: 6f66 2074 6869 7320 7369 7a65 2077 6869  of this size whi
-0000a940: 6c65 2070 6572 666f 726d 696e 6720 610a  le performing a.
-0000a950: 2020 2020 2020 2020 2020 2020 7472 6565              tree
-0000a960: 2d72 6564 7563 7469 6f6e 2e20 4966 2073  -reduction. If s
-0000a970: 6574 2074 6f20 4661 6c73 652c 206e 6f20  et to False, no 
-0000a980: 7472 6565 2d72 6564 7563 7469 6f6e 2077  tree-reduction w
-0000a990: 696c 6c20 6265 2075 7365 642c 0a20 2020  ill be used,.   
-0000a9a0: 2020 2020 2020 2020 2061 6e64 2061 6c6c           and all
-0000a9b0: 2069 6e74 6572 6d65 6469 6174 6573 2077   intermediates w
-0000a9c0: 696c 6c20 6265 2063 6f6e 6361 7465 6e61  ill be concatena
-0000a9d0: 7465 6420 616e 6420 7061 7373 6564 2074  ted and passed t
-0000a9e0: 6f0a 2020 2020 2020 2020 2020 2020 6060  o.            ``
-0000a9f0: 6167 6772 6567 6174 6560 602e 2044 6566  aggregate``. Def
-0000aa00: 6175 6c74 2069 7320 382e 0a20 2020 2020  ault is 8..     
-0000aa10: 2020 2063 6875 6e6b 5f6b 7761 7267 7320     chunk_kwargs 
-0000aa20: 3a20 6469 6374 2c20 6f70 7469 6f6e 616c  : dict, optional
-0000aa30: 0a20 2020 2020 2020 2020 2020 204b 6579  .            Key
-0000aa40: 776f 7264 2061 7267 756d 656e 7473 2074  word arguments t
-0000aa50: 6f20 7061 7373 206f 6e20 746f 2060 6063  o pass on to ``c
-0000aa60: 6875 6e6b 6060 206f 6e6c 792e 0a20 2020  hunk`` only..   
-0000aa70: 2020 2020 2061 6767 7265 6761 7465 5f6b       aggregate_k
-0000aa80: 7761 7267 7320 3a20 6469 6374 2c20 6f70  wargs : dict, op
-0000aa90: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0000aaa0: 2020 204b 6579 776f 7264 2061 7267 756d     Keyword argum
-0000aab0: 656e 7473 2074 6f20 7061 7373 206f 6e20  ents to pass on 
-0000aac0: 746f 2060 6061 6767 7265 6761 7465 6060  to ``aggregate``
-0000aad0: 206f 6e6c 792e 0a20 2020 2020 2020 2063   only..        c
-0000aae0: 6f6d 6269 6e65 5f6b 7761 7267 7320 3a20  ombine_kwargs : 
-0000aaf0: 6469 6374 2c20 6f70 7469 6f6e 616c 0a20  dict, optional. 
-0000ab00: 2020 2020 2020 2020 2020 204b 6579 776f             Keywo
-0000ab10: 7264 2061 7267 756d 656e 7473 2074 6f20  rd arguments to 
-0000ab20: 7061 7373 206f 6e20 746f 2060 6063 6f6d  pass on to ``com
-0000ab30: 6269 6e65 6060 206f 6e6c 792e 0a20 2020  bine`` only..   
-0000ab40: 2020 2020 206b 7761 7267 7320 3a0a 2020       kwargs :.  
-0000ab50: 2020 2020 2020 2020 2020 416c 6c20 7265            All re
-0000ab60: 6d61 696e 696e 6720 6b65 7977 6f72 6473  maining keywords
-0000ab70: 2077 696c 6c20 6265 2070 6173 7365 6420   will be passed 
-0000ab80: 746f 2060 6063 6875 6e6b 6060 2c20 6060  to ``chunk``, ``
-0000ab90: 636f 6d62 696e 6560 602c 0a20 2020 2020  combine``,.     
-0000aba0: 2020 2020 2020 2061 6e64 2060 6061 6767         and ``agg
-0000abb0: 7265 6761 7465 6060 2e0a 0a20 2020 2020  regate``...     
-0000abc0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-0000abd0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0000abe0: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
-0000abf0: 7061 6e64 6173 2061 7320 7064 0a20 2020  pandas as pd.   
-0000ac00: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
-0000ac10: 6461 736b 2e64 6174 6166 7261 6d65 2061  dask.dataframe a
-0000ac20: 7320 6464 0a20 2020 2020 2020 203e 3e3e  s dd.        >>>
-0000ac30: 2064 6620 3d20 7064 2e44 6174 6146 7261   df = pd.DataFra
-0000ac40: 6d65 287b 2778 273a 2072 616e 6765 2835  me({'x': range(5
-0000ac50: 3029 2c20 2779 273a 2072 616e 6765 2835  0), 'y': range(5
-0000ac60: 302c 2031 3030 297d 290a 2020 2020 2020  0, 100)}).      
-0000ac70: 2020 3e3e 3e20 6464 6620 3d20 6464 2e66    >>> ddf = dd.f
-0000ac80: 726f 6d5f 7061 6e64 6173 2864 662c 206e  rom_pandas(df, n
-0000ac90: 7061 7274 6974 696f 6e73 3d34 290a 0a20  partitions=4).. 
-0000aca0: 2020 2020 2020 2043 6f75 6e74 2074 6865         Count the
-0000acb0: 206e 756d 6265 7220 6f66 2072 6f77 7320   number of rows 
-0000acc0: 696e 2061 2044 6174 6146 7261 6d65 2e20  in a DataFrame. 
-0000acd0: 546f 2064 6f20 7468 6973 2c20 636f 756e  To do this, coun
-0000ace0: 7420 7468 6520 6e75 6d62 6572 0a20 2020  t the number.   
-0000acf0: 2020 2020 206f 6620 726f 7773 2069 6e20       of rows in 
-0000ad00: 6561 6368 2070 6172 7469 7469 6f6e 2c20  each partition, 
-0000ad10: 7468 656e 2073 756d 2074 6865 2072 6573  then sum the res
-0000ad20: 756c 7473 3a0a 0a20 2020 2020 2020 203e  ults:..        >
-0000ad30: 3e3e 2072 6573 203d 2064 6466 2e72 6564  >> res = ddf.red
-0000ad40: 7563 7469 6f6e 286c 616d 6264 6120 783a  uction(lambda x:
-0000ad50: 2078 2e63 6f75 6e74 2829 2c0a 2020 2020   x.count(),.    
-0000ad60: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-0000ad70: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
-0000ad80: 6567 6174 653d 6c61 6d62 6461 2078 3a20  egate=lambda x: 
-0000ad90: 782e 7375 6d28 2929 0a20 2020 2020 2020  x.sum()).       
-0000ada0: 203e 3e3e 2072 6573 2e63 6f6d 7075 7465   >>> res.compute
-0000adb0: 2829 0a20 2020 2020 2020 2078 2020 2020  ().        x    
-0000adc0: 3530 0a20 2020 2020 2020 2079 2020 2020  50.        y    
-0000add0: 3530 0a20 2020 2020 2020 2064 7479 7065  50.        dtype
-0000ade0: 3a20 696e 7436 340a 0a20 2020 2020 2020  : int64..       
-0000adf0: 2043 6f75 6e74 2074 6865 206e 756d 6265   Count the numbe
-0000ae00: 7220 6f66 2072 6f77 7320 696e 2061 2053  r of rows in a S
-0000ae10: 6572 6965 7320 7769 7468 2065 6c65 6d65  eries with eleme
-0000ae20: 6e74 7320 6772 6561 7465 7220 7468 616e  nts greater than
-0000ae30: 206f 720a 2020 2020 2020 2020 6571 7561   or.        equa
-0000ae40: 6c20 746f 2061 2076 616c 7565 2028 7072  l to a value (pr
-0000ae50: 6f76 6964 6564 2076 6961 2061 206b 6579  ovided via a key
-0000ae60: 776f 7264 292e 0a0a 2020 2020 2020 2020  word)...        
-0000ae70: 3e3e 3e20 6465 6620 636f 756e 745f 6772  >>> def count_gr
-0000ae80: 6561 7465 7228 782c 2076 616c 7565 3d30  eater(x, value=0
-0000ae90: 293a 0a20 2020 2020 2020 202e 2e2e 2020  ):.        ...  
-0000aea0: 2020 2072 6574 7572 6e20 2878 203e 3d20     return (x >= 
-0000aeb0: 7661 6c75 6529 2e73 756d 2829 0a20 2020  value).sum().   
-0000aec0: 2020 2020 203e 3e3e 2072 6573 203d 2064       >>> res = d
-0000aed0: 6466 2e78 2e72 6564 7563 7469 6f6e 2863  df.x.reduction(c
-0000aee0: 6f75 6e74 5f67 7265 6174 6572 2c20 6167  ount_greater, ag
-0000aef0: 6772 6567 6174 653d 6c61 6d62 6461 2078  gregate=lambda x
-0000af00: 3a20 782e 7375 6d28 292c 0a20 2020 2020  : x.sum(),.     
-0000af10: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-0000af20: 2020 2020 2020 2020 2020 2020 2063 6875               chu
-0000af30: 6e6b 5f6b 7761 7267 733d 7b27 7661 6c75  nk_kwargs={'valu
-0000af40: 6527 3a20 3235 7d29 0a20 2020 2020 2020  e': 25}).       
-0000af50: 203e 3e3e 2072 6573 2e63 6f6d 7075 7465   >>> res.compute
-0000af60: 2829 0a20 2020 2020 2020 2032 350a 0a20  ().        25.. 
-0000af70: 2020 2020 2020 2041 6767 7265 6761 7465         Aggregate
-0000af80: 2062 6f74 6820 7468 6520 7375 6d20 616e   both the sum an
-0000af90: 6420 636f 756e 7420 6f66 2061 2053 6572  d count of a Ser
-0000afa0: 6965 7320 6174 2074 6865 2073 616d 6520  ies at the same 
-0000afb0: 7469 6d65 3a0a 0a20 2020 2020 2020 203e  time:..        >
-0000afc0: 3e3e 2064 6566 2073 756d 5f61 6e64 5f63  >> def sum_and_c
-0000afd0: 6f75 6e74 2878 293a 0a20 2020 2020 2020  ount(x):.       
-0000afe0: 202e 2e2e 2020 2020 2072 6574 7572 6e20   ...     return 
-0000aff0: 7064 2e53 6572 6965 7328 7b27 636f 756e  pd.Series({'coun
-0000b000: 7427 3a20 782e 636f 756e 7428 292c 2027  t': x.count(), '
-0000b010: 7375 6d27 3a20 782e 7375 6d28 297d 2c0a  sum': x.sum()},.
-0000b020: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0000b030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b040: 2069 6e64 6578 3d5b 2763 6f75 6e74 272c   index=['count',
-0000b050: 2027 7375 6d27 5d29 0a20 2020 2020 2020   'sum']).       
-0000b060: 203e 3e3e 2072 6573 203d 2064 6466 2e78   >>> res = ddf.x
-0000b070: 2e72 6564 7563 7469 6f6e 2873 756d 5f61  .reduction(sum_a
-0000b080: 6e64 5f63 6f75 6e74 2c20 6167 6772 6567  nd_count, aggreg
-0000b090: 6174 653d 6c61 6d62 6461 2078 3a20 782e  ate=lambda x: x.
-0000b0a0: 7375 6d28 2929 0a20 2020 2020 2020 203e  sum()).        >
-0000b0b0: 3e3e 2072 6573 2e63 6f6d 7075 7465 2829  >> res.compute()
-0000b0c0: 0a20 2020 2020 2020 2063 6f75 6e74 2020  .        count  
-0000b0d0: 2020 2020 3530 0a20 2020 2020 2020 2073      50.        s
-0000b0e0: 756d 2020 2020 2020 3132 3235 0a20 2020  um      1225.   
-0000b0f0: 2020 2020 2064 7479 7065 3a20 696e 7436       dtype: int6
-0000b100: 340a 0a20 2020 2020 2020 2044 6f69 6e67  4..        Doing
-0000b110: 2074 6865 2073 616d 652c 2062 7574 2066   the same, but f
-0000b120: 6f72 2061 2044 6174 6146 7261 6d65 2e20  or a DataFrame. 
-0000b130: 4865 7265 2060 6063 6875 6e6b 6060 2072  Here ``chunk`` r
-0000b140: 6574 7572 6e73 2061 0a20 2020 2020 2020  eturns a.       
-0000b150: 2044 6174 6146 7261 6d65 2c20 6d65 616e   DataFrame, mean
-0000b160: 696e 6720 7468 6520 696e 7075 7420 746f  ing the input to
-0000b170: 2060 6061 6767 7265 6761 7465 6060 2069   ``aggregate`` i
-0000b180: 7320 6120 4461 7461 4672 616d 6520 7769  s a DataFrame wi
-0000b190: 7468 2061 6e0a 2020 2020 2020 2020 696e  th an.        in
-0000b1a0: 6465 7820 7769 7468 206e 6f6e 2d75 6e69  dex with non-uni
-0000b1b0: 7175 6520 656e 7472 6965 7320 666f 7220  que entries for 
-0000b1c0: 626f 7468 2027 7827 2061 6e64 2027 7927  both 'x' and 'y'
-0000b1d0: 2e20 5765 2067 726f 7570 6279 2074 6865  . We groupby the
-0000b1e0: 0a20 2020 2020 2020 2069 6e64 6578 2c20  .        index, 
-0000b1f0: 616e 6420 7375 6d20 6561 6368 2067 726f  and sum each gro
-0000b200: 7570 2074 6f20 6765 7420 7468 6520 6669  up to get the fi
-0000b210: 6e61 6c20 7265 7375 6c74 2e0a 0a20 2020  nal result...   
-0000b220: 2020 2020 203e 3e3e 2064 6566 2073 756d       >>> def sum
-0000b230: 5f61 6e64 5f63 6f75 6e74 2878 293a 0a20  _and_count(x):. 
-0000b240: 2020 2020 2020 202e 2e2e 2020 2020 2072         ...     r
-0000b250: 6574 7572 6e20 7064 2e44 6174 6146 7261  eturn pd.DataFra
-0000b260: 6d65 287b 2763 6f75 6e74 273a 2078 2e63  me({'count': x.c
-0000b270: 6f75 6e74 2829 2c20 2773 756d 273a 2078  ount(), 'sum': x
-0000b280: 2e73 756d 2829 7d2c 0a20 2020 2020 2020  .sum()},.       
-0000b290: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-0000b2a0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-0000b2b0: 756d 6e73 3d5b 2763 6f75 6e74 272c 2027  umns=['count', '
-0000b2c0: 7375 6d27 5d29 0a20 2020 2020 2020 203e  sum']).        >
-0000b2d0: 3e3e 2072 6573 203d 2064 6466 2e72 6564  >> res = ddf.red
-0000b2e0: 7563 7469 6f6e 2873 756d 5f61 6e64 5f63  uction(sum_and_c
-0000b2f0: 6f75 6e74 2c0a 2020 2020 2020 2020 2e2e  ount,.        ..
-0000b300: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b310: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
-0000b320: 6c61 6d62 6461 2078 3a20 782e 6772 6f75  lambda x: x.grou
-0000b330: 7062 7928 6c65 7665 6c3d 3029 2e73 756d  pby(level=0).sum
-0000b340: 2829 290a 2020 2020 2020 2020 3e3e 3e20  ()).        >>> 
-0000b350: 7265 732e 636f 6d70 7574 6528 290a 2020  res.compute().  
-0000b360: 2020 2020 2020 2020 2063 6f75 6e74 2020           count  
-0000b370: 2073 756d 0a20 2020 2020 2020 2078 2020   sum.        x  
-0000b380: 2020 2035 3020 2031 3232 350a 2020 2020     50  1225.    
-0000b390: 2020 2020 7920 2020 2020 3530 2020 3337      y     50  37
-0000b3a0: 3235 0a20 2020 2020 2020 2022 2222 0a20  25.        """. 
-0000b3b0: 2020 2020 2020 2069 6620 6167 6772 6567         if aggreg
-0000b3c0: 6174 6520 6973 204e 6f6e 653a 0a20 2020  ate is None:.   
-0000b3d0: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
-0000b3e0: 7465 203d 2063 6875 6e6b 0a0a 2020 2020  te = chunk..    
-0000b3f0: 2020 2020 6966 2063 6f6d 6269 6e65 2069      if combine i
-0000b400: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0000b410: 2020 2020 6966 2063 6f6d 6269 6e65 5f6b      if combine_k
-0000b420: 7761 7267 733a 0a20 2020 2020 2020 2020  wargs:.         
-0000b430: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000b440: 7565 4572 726f 7228 2260 636f 6d62 696e  ueError("`combin
-0000b450: 655f 6b77 6172 6773 6020 7072 6f76 6964  e_kwargs` provid
-0000b460: 6564 2077 6974 6820 6e6f 2060 636f 6d62  ed with no `comb
-0000b470: 696e 6560 2229 0a20 2020 2020 2020 2020  ine`").         
-0000b480: 2020 2063 6f6d 6269 6e65 203d 2061 6767     combine = agg
-0000b490: 7265 6761 7465 0a20 2020 2020 2020 2020  regate.         
-0000b4a0: 2020 2063 6f6d 6269 6e65 5f6b 7761 7267     combine_kwarg
-0000b4b0: 7320 3d20 6167 6772 6567 6174 655f 6b77  s = aggregate_kw
-0000b4c0: 6172 6773 0a0a 2020 2020 2020 2020 6368  args..        ch
-0000b4d0: 756e 6b5f 6b77 6172 6773 203d 2063 6875  unk_kwargs = chu
-0000b4e0: 6e6b 5f6b 7761 7267 732e 636f 7079 2829  nk_kwargs.copy()
-0000b4f0: 2069 6620 6368 756e 6b5f 6b77 6172 6773   if chunk_kwargs
-0000b500: 2065 6c73 6520 7b7d 0a20 2020 2020 2020   else {}.       
-0000b510: 2063 6875 6e6b 5f6b 7761 7267 735b 2261   chunk_kwargs["a
-0000b520: 6361 5f63 6875 6e6b 225d 203d 2063 6875  ca_chunk"] = chu
-0000b530: 6e6b 0a0a 2020 2020 2020 2020 636f 6d62  nk..        comb
-0000b540: 696e 655f 6b77 6172 6773 203d 2063 6f6d  ine_kwargs = com
-0000b550: 6269 6e65 5f6b 7761 7267 732e 636f 7079  bine_kwargs.copy
-0000b560: 2829 2069 6620 636f 6d62 696e 655f 6b77  () if combine_kw
-0000b570: 6172 6773 2065 6c73 6520 7b7d 0a20 2020  args else {}.   
-0000b580: 2020 2020 2063 6f6d 6269 6e65 5f6b 7761       combine_kwa
-0000b590: 7267 735b 2261 6361 5f63 6f6d 6269 6e65  rgs["aca_combine
-0000b5a0: 225d 203d 2063 6f6d 6269 6e65 0a0a 2020  "] = combine..  
-0000b5b0: 2020 2020 2020 6167 6772 6567 6174 655f        aggregate_
-0000b5c0: 6b77 6172 6773 203d 2061 6767 7265 6761  kwargs = aggrega
-0000b5d0: 7465 5f6b 7761 7267 732e 636f 7079 2829  te_kwargs.copy()
-0000b5e0: 2069 6620 6167 6772 6567 6174 655f 6b77   if aggregate_kw
-0000b5f0: 6172 6773 2065 6c73 6520 7b7d 0a20 2020  args else {}.   
-0000b600: 2020 2020 2061 6767 7265 6761 7465 5f6b       aggregate_k
-0000b610: 7761 7267 735b 2261 6361 5f61 6767 7265  wargs["aca_aggre
-0000b620: 6761 7465 225d 203d 2061 6767 7265 6761  gate"] = aggrega
-0000b630: 7465 0a0a 2020 2020 2020 2020 7265 7475  te..        retu
-0000b640: 726e 2061 6361 280a 2020 2020 2020 2020  rn aca(.        
-0000b650: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0000b660: 2020 2020 2020 6368 756e 6b3d 5f72 6564        chunk=_red
-0000b670: 7563 7469 6f6e 5f63 6875 6e6b 2c0a 2020  uction_chunk,.  
-0000b680: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
-0000b690: 6174 653d 5f72 6564 7563 7469 6f6e 5f61  ate=_reduction_a
-0000b6a0: 6767 7265 6761 7465 2c0a 2020 2020 2020  ggregate,.      
-0000b6b0: 2020 2020 2020 636f 6d62 696e 653d 5f72        combine=_r
-0000b6c0: 6564 7563 7469 6f6e 5f63 6f6d 6269 6e65  eduction_combine
-0000b6d0: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
-0000b6e0: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
-0000b6f0: 2020 2020 2074 6f6b 656e 3d74 6f6b 656e       token=token
-0000b700: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
-0000b710: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-0000b720: 6576 6572 792c 0a20 2020 2020 2020 2020  every,.         
-0000b730: 2020 2063 6875 6e6b 5f6b 7761 7267 733d     chunk_kwargs=
-0000b740: 6368 756e 6b5f 6b77 6172 6773 2c0a 2020  chunk_kwargs,.  
-0000b750: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
-0000b760: 6174 655f 6b77 6172 6773 3d61 6767 7265  ate_kwargs=aggre
-0000b770: 6761 7465 5f6b 7761 7267 732c 0a20 2020  gate_kwargs,.   
-0000b780: 2020 2020 2020 2020 2063 6f6d 6269 6e65           combine
-0000b790: 5f6b 7761 7267 733d 636f 6d62 696e 655f  _kwargs=combine_
-0000b7a0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-0000b7b0: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
-0000b7c0: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
-0000b7d0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0000b7e0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0000b7f0: 2070 6970 6528 7365 6c66 2c20 6675 6e63   pipe(self, func
-0000b800: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-0000b810: 7329 3a0a 2020 2020 2020 2020 2320 5461  s):.        # Ta
-0000b820: 6b65 6e20 6672 6f6d 2070 616e 6461 733a  ken from pandas:
-0000b830: 0a20 2020 2020 2020 2023 2068 7474 7073  .        # https
-0000b840: 3a2f 2f67 6974 6875 622e 636f 6d2f 7079  ://github.com/py
-0000b850: 6461 7461 2f70 616e 6461 732f 626c 6f62  data/pandas/blob
-0000b860: 2f6d 6173 7465 722f 7061 6e64 6173 2f63  /master/pandas/c
-0000b870: 6f72 652f 6765 6e65 7269 632e 7079 234c  ore/generic.py#L
-0000b880: 3236 3938 2d4c 3237 3037 0a20 2020 2020  2698-L2707.     
-0000b890: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0000b8a0: 2866 756e 632c 2074 7570 6c65 293a 0a20  (func, tuple):. 
-0000b8b0: 2020 2020 2020 2020 2020 2066 756e 632c             func,
-0000b8c0: 2074 6172 6765 7420 3d20 6675 6e63 0a20   target = func. 
-0000b8d0: 2020 2020 2020 2020 2020 2069 6620 7461             if ta
-0000b8e0: 7267 6574 2069 6e20 6b77 6172 6773 3a0a  rget in kwargs:.
-0000b8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b900: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0000b910: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000b920: 2020 2020 2020 2225 7320 6973 2062 6f74        "%s is bot
-0000b930: 6820 7468 6520 7069 7065 2074 6172 6765  h the pipe targe
-0000b940: 7420 616e 6420 6120 6b65 7977 6f72 6420  t and a keyword 
-0000b950: 6172 6775 6d65 6e74 2220 2520 7461 7267  argument" % targ
-0000b960: 6574 0a20 2020 2020 2020 2020 2020 2020  et.             
-0000b970: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000b980: 206b 7761 7267 735b 7461 7267 6574 5d20   kwargs[target] 
-0000b990: 3d20 7365 6c66 0a20 2020 2020 2020 2020  = self.         
-0000b9a0: 2020 2072 6574 7572 6e20 6675 6e63 282a     return func(*
-0000b9b0: 6172 6773 2c20 2a2a 6b77 6172 6773 290a  args, **kwargs).
-0000b9c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000b9d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000b9e0: 2066 756e 6328 7365 6c66 2c20 2a61 7267   func(self, *arg
-0000b9f0: 732c 202a 2a6b 7761 7267 7329 0a0a 2020  s, **kwargs)..  
-0000ba00: 2020 6465 6620 7261 6e64 6f6d 5f73 706c    def random_spl
-0000ba10: 6974 2873 656c 662c 2066 7261 632c 2072  it(self, frac, r
-0000ba20: 616e 646f 6d5f 7374 6174 653d 4e6f 6e65  andom_state=None
-0000ba30: 2c20 7368 7566 666c 653d 4661 6c73 6529  , shuffle=False)
-0000ba40: 3a0a 2020 2020 2020 2020 2222 2250 7365  :.        """Pse
-0000ba50: 7564 6f72 616e 646f 6d6c 7920 7370 6c69  udorandomly spli
-0000ba60: 7420 6461 7461 6672 616d 6520 696e 746f  t dataframe into
-0000ba70: 2064 6966 6665 7265 6e74 2070 6965 6365   different piece
-0000ba80: 7320 726f 772d 7769 7365 0a0a 2020 2020  s row-wise..    
-0000ba90: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-0000baa0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000bab0: 2d0a 2020 2020 2020 2020 6672 6163 203a  -.        frac :
-0000bac0: 206c 6973 740a 2020 2020 2020 2020 2020   list.          
-0000bad0: 2020 4c69 7374 206f 6620 666c 6f61 7473    List of floats
-0000bae0: 2074 6861 7420 7368 6f75 6c64 2073 756d   that should sum
-0000baf0: 2074 6f20 6f6e 652e 0a20 2020 2020 2020   to one..       
-0000bb00: 2072 616e 646f 6d5f 7374 6174 6520 3a20   random_state : 
-0000bb10: 696e 7420 6f72 206e 702e 7261 6e64 6f6d  int or np.random
-0000bb20: 2e52 616e 646f 6d53 7461 7465 0a20 2020  .RandomState.   
-0000bb30: 2020 2020 2020 2020 2049 6620 696e 7420           If int 
-0000bb40: 6372 6561 7465 2061 206e 6577 2052 616e  create a new Ran
-0000bb50: 646f 6d53 7461 7465 2077 6974 6820 7468  domState with th
-0000bb60: 6973 2061 7320 7468 6520 7365 6564 2e0a  is as the seed..
-0000bb70: 2020 2020 2020 2020 2020 2020 4f74 6865              Othe
-0000bb80: 7277 6973 6520 6472 6177 2066 726f 6d20  rwise draw from 
-0000bb90: 7468 6520 7061 7373 6564 2052 616e 646f  the passed Rando
-0000bba0: 6d53 7461 7465 2e0a 2020 2020 2020 2020  mState..        
-0000bbb0: 7368 7566 666c 6520 3a20 626f 6f6c 2c20  shuffle : bool, 
-0000bbc0: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
-0000bbd0: 2020 2020 2020 2020 2020 4966 2073 6574            If set
-0000bbe0: 2074 6f20 5472 7565 2c20 7468 6520 6461   to True, the da
-0000bbf0: 7461 6672 616d 6520 6973 2073 6875 6666  taframe is shuff
-0000bc00: 6c65 6420 2877 6974 6869 6e20 7061 7274  led (within part
-0000bc10: 6974 696f 6e29 0a20 2020 2020 2020 2020  ition).         
-0000bc20: 2020 2062 6566 6f72 6520 7468 6520 7370     before the sp
-0000bc30: 6c69 742e 0a0a 2020 2020 2020 2020 4578  lit...        Ex
-0000bc40: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
-0000bc50: 2d2d 2d2d 2d2d 2d0a 0a20 2020 2020 2020  -------..       
-0000bc60: 2035 302f 3530 2073 706c 6974 0a0a 2020   50/50 split..  
-0000bc70: 2020 2020 2020 3e3e 3e20 612c 2062 203d        >>> a, b =
-0000bc80: 2064 662e 7261 6e64 6f6d 5f73 706c 6974   df.random_split
-0000bc90: 285b 302e 352c 2030 2e35 5d29 2020 2320  ([0.5, 0.5])  # 
-0000bca0: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
-0000bcb0: 2020 2020 2020 2020 3830 2f31 302f 3130          80/10/10
-0000bcc0: 2073 706c 6974 2c20 636f 6e73 6973 7465   split, consiste
-0000bcd0: 6e74 2072 616e 646f 6d5f 7374 6174 650a  nt random_state.
-0000bce0: 0a20 2020 2020 2020 203e 3e3e 2061 2c20  .        >>> a, 
-0000bcf0: 622c 2063 203d 2064 662e 7261 6e64 6f6d  b, c = df.random
-0000bd00: 5f73 706c 6974 285b 302e 382c 2030 2e31  _split([0.8, 0.1
-0000bd10: 2c20 302e 315d 2c20 7261 6e64 6f6d 5f73  , 0.1], random_s
-0000bd20: 7461 7465 3d31 3233 2920 2023 2064 6f63  tate=123)  # doc
-0000bd30: 7465 7374 3a20 2b53 4b49 500a 0a20 2020  test: +SKIP..   
-0000bd40: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
-0000bd50: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-0000bd60: 2020 2020 2020 2064 6173 6b2e 4461 7461         dask.Data
-0000bd70: 4672 616d 652e 7361 6d70 6c65 0a20 2020  Frame.sample.   
-0000bd80: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000bd90: 2069 6620 6e6f 7420 6e70 2e61 6c6c 636c   if not np.allcl
-0000bda0: 6f73 6528 7375 6d28 6672 6163 292c 2031  ose(sum(frac), 1
-0000bdb0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0000bdc0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0000bdd0: 2266 7261 6320 7368 6f75 6c64 2073 756d  "frac should sum
-0000bde0: 2074 6f20 3122 290a 2020 2020 2020 2020   to 1").        
-0000bdf0: 7374 6174 655f 6461 7461 203d 2072 616e  state_data = ran
-0000be00: 646f 6d5f 7374 6174 655f 6461 7461 2873  dom_state_data(s
-0000be10: 656c 662e 6e70 6172 7469 7469 6f6e 732c  elf.npartitions,
-0000be20: 2072 616e 646f 6d5f 7374 6174 6529 0a20   random_state). 
-0000be30: 2020 2020 2020 2074 6f6b 656e 203d 2074         token = t
-0000be40: 6f6b 656e 697a 6528 7365 6c66 2c20 6672  okenize(self, fr
-0000be50: 6163 2c20 7261 6e64 6f6d 5f73 7461 7465  ac, random_state
-0000be60: 290a 2020 2020 2020 2020 6e61 6d65 203d  ).        name =
-0000be70: 2022 7370 6c69 742d 2220 2b20 746f 6b65   "split-" + toke
-0000be80: 6e0a 2020 2020 2020 2020 6c61 7965 7220  n.        layer 
-0000be90: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-0000bea0: 286e 616d 652c 2069 293a 2028 7064 5f73  (name, i): (pd_s
-0000beb0: 706c 6974 2c20 2873 656c 662e 5f6e 616d  plit, (self._nam
-0000bec0: 652c 2069 292c 2066 7261 632c 2073 7461  e, i), frac, sta
-0000bed0: 7465 2c20 7368 7566 666c 6529 0a20 2020  te, shuffle).   
-0000bee0: 2020 2020 2020 2020 2066 6f72 2069 2c20           for i, 
-0000bef0: 7374 6174 6520 696e 2065 6e75 6d65 7261  state in enumera
-0000bf00: 7465 2873 7461 7465 5f64 6174 6129 0a20  te(state_data). 
-0000bf10: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
-0000bf20: 2020 6f75 7420 3d20 5b5d 0a20 2020 2020    out = [].     
-0000bf30: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-0000bf40: 6528 6c65 6e28 6672 6163 2929 3a0a 2020  e(len(frac)):.  
-0000bf50: 2020 2020 2020 2020 2020 6e61 6d65 3220            name2 
-0000bf60: 3d20 2273 706c 6974 2d25 642d 2573 2220  = "split-%d-%s" 
-0000bf70: 2520 2869 2c20 746f 6b65 6e29 0a20 2020  % (i, token).   
-0000bf80: 2020 2020 2020 2020 2064 736b 3220 3d20           dsk2 = 
-0000bf90: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-0000bfa0: 2020 286e 616d 6532 2c20 6a29 3a20 2867    (name2, j): (g
-0000bfb0: 6574 6974 656d 2c20 286e 616d 652c 206a  etitem, (name, j
-0000bfc0: 292c 2069 2920 666f 7220 6a20 696e 2072  ), i) for j in r
-0000bfd0: 616e 6765 2873 656c 662e 6e70 6172 7469  ange(self.nparti
-0000bfe0: 7469 6f6e 7329 0a20 2020 2020 2020 2020  tions).         
-0000bff0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-0000c000: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-0000c010: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-0000c020: 6c65 6374 696f 6e73 280a 2020 2020 2020  lections(.      
-0000c030: 2020 2020 2020 2020 2020 6e61 6d65 322c            name2,
-0000c040: 206d 6572 6765 2864 736b 322c 206c 6179   merge(dsk2, lay
-0000c050: 6572 292c 2064 6570 656e 6465 6e63 6965  er), dependencie
-0000c060: 733d 5b73 656c 665d 0a20 2020 2020 2020  s=[self].       
-0000c070: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0000c080: 2020 206f 7574 5f64 6620 3d20 7479 7065     out_df = type
-0000c090: 2873 656c 6629 2867 7261 7068 2c20 6e61  (self)(graph, na
-0000c0a0: 6d65 322c 2073 656c 662e 5f6d 6574 612c  me2, self._meta,
-0000c0b0: 2073 656c 662e 6469 7669 7369 6f6e 7329   self.divisions)
-0000c0c0: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-0000c0d0: 2e61 7070 656e 6428 6f75 745f 6466 290a  .append(out_df).
-0000c0e0: 2020 2020 2020 2020 7265 7475 726e 206f          return o
-0000c0f0: 7574 0a0a 2020 2020 6465 6620 6865 6164  ut..    def head
-0000c100: 2873 656c 662c 206e 3d35 2c20 6e70 6172  (self, n=5, npar
-0000c110: 7469 7469 6f6e 733d 312c 2063 6f6d 7075  titions=1, compu
-0000c120: 7465 3d54 7275 6529 3a0a 2020 2020 2020  te=True):.      
-0000c130: 2020 2222 2246 6972 7374 206e 2072 6f77    """First n row
-0000c140: 7320 6f66 2074 6865 2064 6174 6173 6574  s of the dataset
-0000c150: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0000c160: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-0000c170: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000c180: 6e20 3a20 696e 742c 206f 7074 696f 6e61  n : int, optiona
-0000c190: 6c0a 2020 2020 2020 2020 2020 2020 5468  l.            Th
-0000c1a0: 6520 6e75 6d62 6572 206f 6620 726f 7773  e number of rows
-0000c1b0: 2074 6f20 7265 7475 726e 2e20 4465 6661   to return. Defa
-0000c1c0: 756c 7420 6973 2035 2e0a 2020 2020 2020  ult is 5..      
-0000c1d0: 2020 6e70 6172 7469 7469 6f6e 7320 3a20    npartitions : 
-0000c1e0: 696e 742c 206f 7074 696f 6e61 6c0a 2020  int, optional.  
-0000c1f0: 2020 2020 2020 2020 2020 456c 656d 656e            Elemen
-0000c200: 7473 2061 7265 206f 6e6c 7920 7461 6b65  ts are only take
-0000c210: 6e20 6672 6f6d 2074 6865 2066 6972 7374  n from the first
-0000c220: 2060 606e 7061 7274 6974 696f 6e73 6060   ``npartitions``
-0000c230: 2c20 7769 7468 2061 0a20 2020 2020 2020  , with a.       
-0000c240: 2020 2020 2064 6566 6175 6c74 206f 6620       default of 
-0000c250: 312e 2049 6620 7468 6572 6520 6172 6520  1. If there are 
-0000c260: 6665 7765 7220 7468 616e 2060 606e 6060  fewer than ``n``
-0000c270: 2072 6f77 7320 696e 2074 6865 2066 6972   rows in the fir
-0000c280: 7374 0a20 2020 2020 2020 2020 2020 2060  st.            `
-0000c290: 606e 7061 7274 6974 696f 6e73 6060 2061  `npartitions`` a
-0000c2a0: 2077 6172 6e69 6e67 2077 696c 6c20 6265   warning will be
-0000c2b0: 2072 6169 7365 6420 616e 6420 616e 7920   raised and any 
-0000c2c0: 666f 756e 6420 726f 7773 0a20 2020 2020  found rows.     
-0000c2d0: 2020 2020 2020 2072 6574 7572 6e65 642e         returned.
-0000c2e0: 2050 6173 7320 2d31 2074 6f20 7573 6520   Pass -1 to use 
-0000c2f0: 616c 6c20 7061 7274 6974 696f 6e73 2e0a  all partitions..
-0000c300: 2020 2020 2020 2020 636f 6d70 7574 6520          compute 
-0000c310: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
-0000c320: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
-0000c330: 7468 6572 2074 6f20 636f 6d70 7574 6520  ther to compute 
-0000c340: 7468 6520 7265 7375 6c74 2c20 6465 6661  the result, defa
-0000c350: 756c 7420 6973 2054 7275 652e 0a20 2020  ult is True..   
-0000c360: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000c370: 2069 6620 6e70 6172 7469 7469 6f6e 7320   if npartitions 
-0000c380: 3c3d 202d 313a 0a20 2020 2020 2020 2020  <= -1:.         
-0000c390: 2020 206e 7061 7274 6974 696f 6e73 203d     npartitions =
-0000c3a0: 2073 656c 662e 6e70 6172 7469 7469 6f6e   self.npartition
-0000c3b0: 730a 2020 2020 2020 2020 2320 4e6f 206e  s.        # No n
-0000c3c0: 6565 6420 746f 2077 6172 6e20 6966 2077  eed to warn if w
-0000c3d0: 6527 7265 2061 6c72 6561 6479 206c 6f6f  e're already loo
-0000c3e0: 6b69 6e67 2061 7420 616c 6c20 7061 7274  king at all part
-0000c3f0: 6974 696f 6e73 0a20 2020 2020 2020 2073  itions.        s
-0000c400: 6166 6520 3d20 6e70 6172 7469 7469 6f6e  afe = npartition
-0000c410: 7320 213d 2073 656c 662e 6e70 6172 7469  s != self.nparti
-0000c420: 7469 6f6e 730a 2020 2020 2020 2020 7265  tions.        re
-0000c430: 7475 726e 2073 656c 662e 5f68 6561 6428  turn self._head(
-0000c440: 6e3d 6e2c 206e 7061 7274 6974 696f 6e73  n=n, npartitions
-0000c450: 3d6e 7061 7274 6974 696f 6e73 2c20 636f  =npartitions, co
-0000c460: 6d70 7574 653d 636f 6d70 7574 652c 2073  mpute=compute, s
-0000c470: 6166 653d 7361 6665 290a 0a20 2020 2064  afe=safe)..    d
-0000c480: 6566 205f 6865 6164 2873 656c 662c 206e  ef _head(self, n
-0000c490: 2c20 6e70 6172 7469 7469 6f6e 732c 2063  , npartitions, c
-0000c4a0: 6f6d 7075 7465 2c20 7361 6665 293a 0a20  ompute, safe):. 
-0000c4b0: 2020 2020 2020 2069 6620 6e70 6172 7469         if nparti
-0000c4c0: 7469 6f6e 7320 3c3d 202d 313a 0a20 2020  tions <= -1:.   
-0000c4d0: 2020 2020 2020 2020 206e 7061 7274 6974           npartit
-0000c4e0: 696f 6e73 203d 2073 656c 662e 6e70 6172  ions = self.npar
-0000c4f0: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
-0000c500: 6966 206e 7061 7274 6974 696f 6e73 203e  if npartitions >
-0000c510: 2073 656c 662e 6e70 6172 7469 7469 6f6e   self.npartition
-0000c520: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-0000c530: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0000c540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c550: 2066 226f 6e6c 7920 7b73 656c 662e 6e70   f"only {self.np
-0000c560: 6172 7469 7469 6f6e 737d 2070 6172 7469  artitions} parti
-0000c570: 7469 6f6e 732c 2068 6561 6420 7265 6365  tions, head rece
-0000c580: 6976 6564 207b 6e70 6172 7469 7469 6f6e  ived {npartition
-0000c590: 737d 220a 2020 2020 2020 2020 2020 2020  s}".            
-0000c5a0: 290a 0a20 2020 2020 2020 206e 616d 6520  )..        name 
-0000c5b0: 3d20 6622 6865 6164 2d7b 6e70 6172 7469  = f"head-{nparti
-0000c5c0: 7469 6f6e 737d 2d7b 6e7d 2d7b 7365 6c66  tions}-{n}-{self
-0000c5d0: 2e5f 6e61 6d65 7d22 0a20 2020 2020 2020  ._name}".       
-0000c5e0: 2069 6620 7361 6665 3a0a 2020 2020 2020   if safe:.      
-0000c5f0: 2020 2020 2020 6865 6164 203d 2073 6166        head = saf
-0000c600: 655f 6865 6164 0a20 2020 2020 2020 2065  e_head.        e
-0000c610: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000c620: 2068 6561 6420 3d20 4d2e 6865 6164 0a0a   head = M.head..
-0000c630: 2020 2020 2020 2020 6966 206e 7061 7274          if npart
-0000c640: 6974 696f 6e73 203e 2031 3a0a 2020 2020  itions > 1:.    
-0000c650: 2020 2020 2020 2020 6e61 6d65 5f70 203d          name_p =
-0000c660: 2066 2268 6561 642d 7061 7274 6961 6c2d   f"head-partial-
-0000c670: 7b6e 7d2d 7b73 656c 662e 5f6e 616d 657d  {n}-{self._name}
-0000c680: 220a 0a20 2020 2020 2020 2020 2020 2064  "..            d
-0000c690: 736b 203d 207b 7d0a 2020 2020 2020 2020  sk = {}.        
-0000c6a0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-0000c6b0: 6765 286e 7061 7274 6974 696f 6e73 293a  ge(npartitions):
-0000c6c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c6d0: 2064 736b 5b28 6e61 6d65 5f70 2c20 6929   dsk[(name_p, i)
-0000c6e0: 5d20 3d20 284d 2e68 6561 642c 2028 7365  ] = (M.head, (se
-0000c6f0: 6c66 2e5f 6e61 6d65 2c20 6929 2c20 6e29  lf._name, i), n)
-0000c700: 0a0a 2020 2020 2020 2020 2020 2020 636f  ..            co
-0000c710: 6e63 6174 203d 2028 5f63 6f6e 6361 742c  ncat = (_concat,
-0000c720: 205b 286e 616d 655f 702c 2069 2920 666f   [(name_p, i) fo
-0000c730: 7220 6920 696e 2072 616e 6765 286e 7061  r i in range(npa
-0000c740: 7274 6974 696f 6e73 295d 290a 2020 2020  rtitions)]).    
-0000c750: 2020 2020 2020 2020 6473 6b5b 286e 616d          dsk[(nam
-0000c760: 652c 2030 295d 203d 2028 6865 6164 2c20  e, 0)] = (head, 
-0000c770: 636f 6e63 6174 2c20 6e29 0a20 2020 2020  concat, n).     
-0000c780: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000c790: 2020 2020 2064 736b 203d 207b 286e 616d       dsk = {(nam
-0000c7a0: 652c 2030 293a 2028 6865 6164 2c20 2873  e, 0): (head, (s
-0000c7b0: 656c 662e 5f6e 616d 652c 2030 292c 206e  elf._name, 0), n
-0000c7c0: 297d 0a0a 2020 2020 2020 2020 6772 6170  )}..        grap
-0000c7d0: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
-0000c7e0: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
-0000c7f0: 6f6e 7328 6e61 6d65 2c20 6473 6b2c 2064  ons(name, dsk, d
-0000c800: 6570 656e 6465 6e63 6965 733d 5b73 656c  ependencies=[sel
-0000c810: 665d 290a 2020 2020 2020 2020 7265 7375  f]).        resu
-0000c820: 6c74 203d 206e 6577 5f64 645f 6f62 6a65  lt = new_dd_obje
-0000c830: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
-0000c840: 6772 6170 682c 206e 616d 652c 2073 656c  graph, name, sel
-0000c850: 662e 5f6d 6574 612c 205b 7365 6c66 2e64  f._meta, [self.d
-0000c860: 6976 6973 696f 6e73 5b30 5d2c 2073 656c  ivisions[0], sel
-0000c870: 662e 6469 7669 7369 6f6e 735b 6e70 6172  f.divisions[npar
-0000c880: 7469 7469 6f6e 735d 5d0a 2020 2020 2020  titions]].      
-0000c890: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
-0000c8a0: 636f 6d70 7574 653a 0a20 2020 2020 2020  compute:.       
-0000c8b0: 2020 2020 2072 6573 756c 7420 3d20 7265       result = re
-0000c8c0: 7375 6c74 2e63 6f6d 7075 7465 2829 0a20  sult.compute(). 
-0000c8d0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-0000c8e0: 7375 6c74 0a0a 2020 2020 6465 6620 7461  sult..    def ta
-0000c8f0: 696c 2873 656c 662c 206e 3d35 2c20 636f  il(self, n=5, co
-0000c900: 6d70 7574 653d 5472 7565 293a 0a20 2020  mpute=True):.   
-0000c910: 2020 2020 2022 2222 4c61 7374 206e 2072       """Last n r
-0000c920: 6f77 7320 6f66 2074 6865 2064 6174 6173  ows of the datas
-0000c930: 6574 0a0a 2020 2020 2020 2020 4361 7665  et..        Cave
-0000c940: 6174 2c20 7468 6520 6f6e 6c79 2063 6865  at, the only che
-0000c950: 636b 7320 7468 6520 6c61 7374 206e 2072  cks the last n r
-0000c960: 6f77 7320 6f66 2074 6865 206c 6173 7420  ows of the last 
-0000c970: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
-0000c980: 2020 2022 2222 0a20 2020 2020 2020 206e     """.        n
-0000c990: 616d 6520 3d20 2274 6169 6c2d 2564 2d25  ame = "tail-%d-%
-0000c9a0: 7322 2025 2028 6e2c 2073 656c 662e 5f6e  s" % (n, self._n
-0000c9b0: 616d 6529 0a20 2020 2020 2020 2064 736b  ame).        dsk
-0000c9c0: 203d 207b 286e 616d 652c 2030 293a 2028   = {(name, 0): (
-0000c9d0: 4d2e 7461 696c 2c20 2873 656c 662e 5f6e  M.tail, (self._n
-0000c9e0: 616d 652c 2073 656c 662e 6e70 6172 7469  ame, self.nparti
-0000c9f0: 7469 6f6e 7320 2d20 3129 2c20 6e29 7d0a  tions - 1), n)}.
-0000ca00: 0a20 2020 2020 2020 2067 7261 7068 203d  .        graph =
-0000ca10: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-0000ca20: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-0000ca30: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
-0000ca40: 6e64 656e 6369 6573 3d5b 7365 6c66 5d29  ndencies=[self])
-0000ca50: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
-0000ca60: 3d20 6e65 775f 6464 5f6f 626a 6563 7428  = new_dd_object(
-0000ca70: 6772 6170 682c 206e 616d 652c 2073 656c  graph, name, sel
-0000ca80: 662e 5f6d 6574 612c 2073 656c 662e 6469  f._meta, self.di
-0000ca90: 7669 7369 6f6e 735b 2d32 3a5d 290a 0a20  visions[-2:]).. 
-0000caa0: 2020 2020 2020 2069 6620 636f 6d70 7574         if comput
-0000cab0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000cac0: 6573 756c 7420 3d20 7265 7375 6c74 2e63  esult = result.c
-0000cad0: 6f6d 7075 7465 2829 0a20 2020 2020 2020  ompute().       
-0000cae0: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
-0000caf0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000cb00: 2020 6465 6620 6c6f 6328 7365 6c66 293a    def loc(self):
-0000cb10: 0a20 2020 2020 2020 2022 2222 5075 7265  .        """Pure
-0000cb20: 6c79 206c 6162 656c 2d6c 6f63 6174 696f  ly label-locatio
-0000cb30: 6e20 6261 7365 6420 696e 6465 7865 7220  n based indexer 
-0000cb40: 666f 7220 7365 6c65 6374 696f 6e20 6279  for selection by
-0000cb50: 206c 6162 656c 2e0a 0a20 2020 2020 2020   label...       
-0000cb60: 203e 3e3e 2064 662e 6c6f 635b 2262 225d   >>> df.loc["b"]
-0000cb70: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0000cb80: 4950 0a20 2020 2020 2020 203e 3e3e 2064  IP.        >>> d
-0000cb90: 662e 6c6f 635b 2262 223a 2264 225d 2020  f.loc["b":"d"]  
-0000cba0: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
-0000cbb0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000cbc0: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-0000cbd0: 6174 6166 7261 6d65 2e69 6e64 6578 696e  ataframe.indexin
-0000cbe0: 6720 696d 706f 7274 205f 4c6f 6349 6e64  g import _LocInd
-0000cbf0: 6578 6572 0a0a 2020 2020 2020 2020 7265  exer..        re
-0000cc00: 7475 726e 205f 4c6f 6349 6e64 6578 6572  turn _LocIndexer
-0000cc10: 2873 656c 6629 0a0a 2020 2020 6465 6620  (self)..    def 
-0000cc20: 5f70 6172 7469 7469 6f6e 7328 7365 6c66  _partitions(self
-0000cc30: 2c20 696e 6465 7829 3a0a 2020 2020 2020  , index):.      
-0000cc40: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-0000cc50: 6e63 6528 696e 6465 782c 2074 7570 6c65  nce(index, tuple
-0000cc60: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-0000cc70: 6e64 6578 203d 2028 696e 6465 782c 290a  ndex = (index,).
-0000cc80: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-0000cc90: 6b2e 6172 7261 792e 736c 6963 696e 6720  k.array.slicing 
-0000cca0: 696d 706f 7274 206e 6f72 6d61 6c69 7a65  import normalize
-0000ccb0: 5f69 6e64 6578 0a0a 2020 2020 2020 2020  _index..        
-0000ccc0: 696e 6465 7820 3d20 6e6f 726d 616c 697a  index = normaliz
-0000ccd0: 655f 696e 6465 7828 696e 6465 782c 2028  e_index(index, (
-0000cce0: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
-0000ccf0: 2c29 290a 2020 2020 2020 2020 696e 6465  ,)).        inde
-0000cd00: 7820 3d20 7475 706c 6528 736c 6963 6528  x = tuple(slice(
-0000cd10: 6b2c 206b 202b 2031 2920 6966 2069 7369  k, k + 1) if isi
-0000cd20: 6e73 7461 6e63 6528 6b2c 204e 756d 6265  nstance(k, Numbe
-0000cd30: 7229 2065 6c73 6520 6b20 666f 7220 6b20  r) else k for k 
-0000cd40: 696e 2069 6e64 6578 290a 2020 2020 2020  in index).      
-0000cd50: 2020 6e61 6d65 203d 2022 626c 6f63 6b73    name = "blocks
-0000cd60: 2d22 202b 2074 6f6b 656e 697a 6528 7365  -" + tokenize(se
-0000cd70: 6c66 2c20 696e 6465 7829 0a20 2020 2020  lf, index).     
-0000cd80: 2020 206e 6577 5f6b 6579 7320 3d20 6e70     new_keys = np
-0000cd90: 2e61 7272 6179 2873 656c 662e 5f5f 6461  .array(self.__da
-0000cda0: 736b 5f6b 6579 735f 5f28 292c 2064 7479  sk_keys__(), dty
-0000cdb0: 7065 3d6f 626a 6563 7429 5b69 6e64 6578  pe=object)[index
-0000cdc0: 5d2e 746f 6c69 7374 2829 0a0a 2020 2020  ].tolist()..    
-0000cdd0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
-0000cde0: 5b73 656c 662e 6469 7669 7369 6f6e 735b  [self.divisions[
-0000cdf0: 695d 2066 6f72 205f 2c20 6920 696e 206e  i] for _, i in n
-0000ce00: 6577 5f6b 6579 735d 202b 205b 0a20 2020  ew_keys] + [.   
-0000ce10: 2020 2020 2020 2020 2073 656c 662e 6469           self.di
-0000ce20: 7669 7369 6f6e 735b 6e65 775f 6b65 7973  visions[new_keys
-0000ce30: 5b2d 315d 5b31 5d20 2b20 315d 0a20 2020  [-1][1] + 1].   
-0000ce40: 2020 2020 205d 0a20 2020 2020 2020 2064       ].        d
-0000ce50: 736b 203d 207b 286e 616d 652c 2069 293a  sk = {(name, i):
-0000ce60: 2074 7570 6c65 286b 6579 2920 666f 7220   tuple(key) for 
-0000ce70: 692c 206b 6579 2069 6e20 656e 756d 6572  i, key in enumer
-0000ce80: 6174 6528 6e65 775f 6b65 7973 297d 0a0a  ate(new_keys)}..
-0000ce90: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
-0000cea0: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-0000ceb0: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-0000cec0: 6e61 6d65 2c20 6473 6b2c 2064 6570 656e  name, dsk, depen
-0000ced0: 6465 6e63 6965 733d 5b73 656c 665d 290a  dencies=[self]).
-0000cee0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-0000cef0: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
-0000cf00: 7068 2c20 6e61 6d65 2c20 7365 6c66 2e5f  ph, name, self._
-0000cf10: 6d65 7461 2c20 6469 7669 7369 6f6e 7329  meta, divisions)
-0000cf20: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000cf30: 2020 2020 6465 6620 7061 7274 6974 696f      def partitio
-0000cf40: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
-0000cf50: 2020 2222 2253 6c69 6365 2064 6174 6166    """Slice dataf
-0000cf60: 7261 6d65 2062 7920 7061 7274 6974 696f  rame by partitio
-0000cf70: 6e73 0a0a 2020 2020 2020 2020 5468 6973  ns..        This
-0000cf80: 2061 6c6c 6f77 7320 7061 7274 6974 696f   allows partitio
-0000cf90: 6e77 6973 6520 736c 6963 696e 6720 6f66  nwise slicing of
-0000cfa0: 2061 2044 6173 6b20 4461 7461 6672 616d   a Dask Datafram
-0000cfb0: 652e 2020 596f 7520 6361 6e20 7065 7266  e.  You can perf
-0000cfc0: 6f72 6d20 6e6f 726d 616c 0a20 2020 2020  orm normal.     
-0000cfd0: 2020 204e 756d 7079 2d73 7479 6c65 2073     Numpy-style s
-0000cfe0: 6c69 6369 6e67 2c20 6275 7420 6e6f 7720  licing, but now 
-0000cff0: 7261 7468 6572 2074 6861 6e20 736c 6963  rather than slic
-0000d000: 6520 656c 656d 656e 7473 206f 6620 7468  e elements of th
-0000d010: 6520 6172 7261 7920 796f 750a 2020 2020  e array you.    
-0000d020: 2020 2020 736c 6963 6520 616c 6f6e 6720      slice along 
-0000d030: 7061 7274 6974 696f 6e73 2073 6f2c 2066  partitions so, f
-0000d040: 6f72 2065 7861 6d70 6c65 2c20 6060 6466  or example, ``df
-0000d050: 2e70 6172 7469 7469 6f6e 735b 3a35 5d60  .partitions[:5]`
-0000d060: 6020 7072 6f64 7563 6573 2061 206e 6577  ` produces a new
-0000d070: 0a20 2020 2020 2020 2044 6173 6b20 4461  .        Dask Da
-0000d080: 7461 6672 616d 6520 6f66 2074 6865 2066  taframe of the f
-0000d090: 6972 7374 2066 6976 6520 7061 7274 6974  irst five partit
-0000d0a0: 696f 6e73 2e20 5661 6c69 6420 696e 6465  ions. Valid inde
-0000d0b0: 7865 7273 2061 7265 2069 6e74 6567 6572  xers are integer
-0000d0c0: 732c 2073 6571 7565 6e63 6573 0a20 2020  s, sequences.   
-0000d0d0: 2020 2020 206f 6620 696e 7465 6765 7273       of integers
-0000d0e0: 2c20 736c 6963 6573 2c20 6f72 2062 6f6f  , slices, or boo
-0000d0f0: 6c65 616e 206d 6173 6b73 2e0a 0a20 2020  lean masks...   
-0000d100: 2020 2020 2045 7861 6d70 6c65 730a 2020       Examples.  
-0000d110: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-0000d120: 2020 2020 2020 203e 3e3e 2064 662e 7061         >>> df.pa
-0000d130: 7274 6974 696f 6e73 5b30 5d20 2023 2064  rtitions[0]  # d
-0000d140: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
-0000d150: 2020 2020 2020 3e3e 3e20 6466 2e70 6172        >>> df.par
-0000d160: 7469 7469 6f6e 735b 3a33 5d20 2023 2064  titions[:3]  # d
-0000d170: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
-0000d180: 2020 2020 2020 3e3e 3e20 6466 2e70 6172        >>> df.par
-0000d190: 7469 7469 6f6e 735b 3a3a 3130 5d20 2023  titions[::10]  #
-0000d1a0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-0000d1b0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0000d1c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000d1d0: 0a20 2020 2020 2020 2041 2044 6173 6b20  .        A Dask 
-0000d1e0: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
-0000d1f0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-0000d200: 7475 726e 2049 6e64 6578 4361 6c6c 6162  turn IndexCallab
-0000d210: 6c65 2873 656c 662e 5f70 6172 7469 7469  le(self._partiti
-0000d220: 6f6e 7329 0a0a 2020 2020 2320 4e6f 7465  ons)..    # Note
-0000d230: 3a20 696c 6f63 2069 7320 696d 706c 656d  : iloc is implem
-0000d240: 656e 7465 6420 6f6e 6c79 206f 6e20 4461  ented only on Da
-0000d250: 7461 4672 616d 650a 0a20 2020 2064 6566  taFrame..    def
-0000d260: 2072 6570 6172 7469 7469 6f6e 280a 2020   repartition(.  
-0000d270: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0000d280: 2020 2020 6469 7669 7369 6f6e 733d 4e6f      divisions=No
-0000d290: 6e65 2c0a 2020 2020 2020 2020 6e70 6172  ne,.        npar
-0000d2a0: 7469 7469 6f6e 733d 4e6f 6e65 2c0a 2020  titions=None,.  
-0000d2b0: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-0000d2c0: 7369 7a65 3d4e 6f6e 652c 0a20 2020 2020  size=None,.     
-0000d2d0: 2020 2066 7265 713d 4e6f 6e65 2c0a 2020     freq=None,.  
-0000d2e0: 2020 2020 2020 666f 7263 653d 4661 6c73        force=Fals
-0000d2f0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-0000d300: 2020 2222 2252 6570 6172 7469 7469 6f6e    """Repartition
-0000d310: 2064 6174 6166 7261 6d65 2061 6c6f 6e67   dataframe along
-0000d320: 206e 6577 2064 6976 6973 696f 6e73 0a0a   new divisions..
-0000d330: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0000d340: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0000d350: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6469  -----.        di
-0000d360: 7669 7369 6f6e 7320 3a20 6c69 7374 2c20  visions : list, 
-0000d370: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-0000d380: 2020 2020 2054 6865 2022 6469 7669 6469       The "dividi
-0000d390: 6e67 206c 696e 6573 2220 7573 6564 2074  ng lines" used t
-0000d3a0: 6f20 7370 6c69 7420 7468 6520 6461 7461  o split the data
-0000d3b0: 6672 616d 6520 696e 746f 2070 6172 7469  frame into parti
-0000d3c0: 7469 6f6e 732e 0a20 2020 2020 2020 2020  tions..         
-0000d3d0: 2020 2046 6f72 2060 6064 6976 6973 696f     For ``divisio
-0000d3e0: 6e73 3d5b 302c 2031 302c 2035 302c 2031  ns=[0, 10, 50, 1
-0000d3f0: 3030 5d60 602c 2074 6865 7265 2077 6f75  00]``, there wou
-0000d400: 6c64 2062 6520 7468 7265 6520 6f75 7470  ld be three outp
-0000d410: 7574 2070 6172 7469 7469 6f6e 732c 0a20  ut partitions,. 
-0000d420: 2020 2020 2020 2020 2020 2077 6865 7265             where
-0000d430: 2074 6865 206e 6577 2069 6e64 6578 2063   the new index c
-0000d440: 6f6e 7461 696e 6564 205b 302c 2031 3029  ontained [0, 10)
-0000d450: 2c20 5b31 302c 2035 3029 2c20 616e 6420  , [10, 50), and 
-0000d460: 5b35 302c 2031 3030 292c 2072 6573 7065  [50, 100), respe
-0000d470: 6374 6976 656c 792e 0a20 2020 2020 2020  ctively..       
-0000d480: 2020 2020 2053 6565 2068 7474 7073 3a2f       See https:/
-0000d490: 2f64 6f63 732e 6461 736b 2e6f 7267 2f65  /docs.dask.org/e
-0000d4a0: 6e2f 6c61 7465 7374 2f64 6174 6166 7261  n/latest/datafra
-0000d4b0: 6d65 2d64 6573 6967 6e2e 6874 6d6c 2370  me-design.html#p
-0000d4c0: 6172 7469 7469 6f6e 732e 0a20 2020 2020  artitions..     
-0000d4d0: 2020 2020 2020 204f 6e6c 7920 7573 6564         Only used
-0000d4e0: 2069 6620 6e70 6172 7469 7469 6f6e 7320   if npartitions 
-0000d4f0: 616e 6420 7061 7274 6974 696f 6e5f 7369  and partition_si
-0000d500: 7a65 2069 736e 2774 2073 7065 6369 6669  ze isn't specifi
-0000d510: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
-0000d520: 466f 7220 636f 6e76 656e 6965 6e63 6520  For convenience 
-0000d530: 6966 2067 6976 656e 2061 6e20 696e 7465  if given an inte
-0000d540: 6765 7220 7468 6973 2077 696c 6c20 6465  ger this will de
-0000d550: 6665 7220 746f 206e 7061 7274 6974 696f  fer to npartitio
-0000d560: 6e73 0a20 2020 2020 2020 2020 2020 2061  ns.            a
-0000d570: 6e64 2069 6620 6769 7665 6e20 6120 7374  nd if given a st
-0000d580: 7269 6e67 2069 7420 7769 6c6c 2064 6566  ring it will def
-0000d590: 6572 2074 6f20 7061 7274 6974 696f 6e5f  er to partition_
-0000d5a0: 7369 7a65 2028 7365 6520 6265 6c6f 7729  size (see below)
-0000d5b0: 0a20 2020 2020 2020 206e 7061 7274 6974  .        npartit
-0000d5c0: 696f 6e73 203a 2069 6e74 2c20 6f70 7469  ions : int, opti
-0000d5d0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0000d5e0: 2041 7070 726f 7869 6d61 7465 206e 756d   Approximate num
-0000d5f0: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
-0000d600: 7320 6f66 206f 7574 7075 742e 204f 6e6c  s of output. Onl
-0000d610: 7920 7573 6564 2069 6620 7061 7274 6974  y used if partit
-0000d620: 696f 6e5f 7369 7a65 0a20 2020 2020 2020  ion_size.       
-0000d630: 2020 2020 2069 736e 2774 2073 7065 6369       isn't speci
-0000d640: 6669 6564 2e20 5468 6520 6e75 6d62 6572  fied. The number
-0000d650: 206f 6620 7061 7274 6974 696f 6e73 2075   of partitions u
-0000d660: 7365 6420 6d61 7920 6265 2073 6c69 6768  sed may be sligh
-0000d670: 746c 790a 2020 2020 2020 2020 2020 2020  tly.            
-0000d680: 6c6f 7765 7220 7468 616e 206e 7061 7274  lower than npart
-0000d690: 6974 696f 6e73 2064 6570 656e 6469 6e67  itions depending
-0000d6a0: 206f 6e20 6461 7461 2064 6973 7472 6962   on data distrib
-0000d6b0: 7574 696f 6e2c 2062 7574 2077 696c 6c20  ution, but will 
-0000d6c0: 6e65 7665 7220 6265 0a20 2020 2020 2020  never be.       
-0000d6d0: 2020 2020 2068 6967 6865 722e 0a20 2020       higher..   
-0000d6e0: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
-0000d6f0: 697a 653a 2069 6e74 206f 7220 7374 7269  ize: int or stri
-0000d700: 6e67 2c20 6f70 7469 6f6e 616c 0a20 2020  ng, optional.   
-0000d710: 2020 2020 2020 2020 204d 6178 206e 756d           Max num
-0000d720: 6265 7220 6f66 2062 7974 6573 206f 6620  ber of bytes of 
-0000d730: 6d65 6d6f 7279 2066 6f72 2065 6163 6820  memory for each 
-0000d740: 7061 7274 6974 696f 6e2e 2055 7365 206e  partition. Use n
-0000d750: 756d 6265 7273 206f 720a 2020 2020 2020  umbers or.      
-0000d760: 2020 2020 2020 7374 7269 6e67 7320 6c69        strings li
-0000d770: 6b65 2035 4d42 2e20 4966 2073 7065 6369  ke 5MB. If speci
-0000d780: 6669 6564 206e 7061 7274 6974 696f 6e73  fied npartitions
-0000d790: 2061 6e64 2064 6976 6973 696f 6e73 2077   and divisions w
-0000d7a0: 696c 6c20 6265 0a20 2020 2020 2020 2020  ill be.         
-0000d7b0: 2020 2069 676e 6f72 6564 2e20 4e6f 7465     ignored. Note
-0000d7c0: 2074 6861 7420 7468 6520 7369 7a65 2072   that the size r
-0000d7d0: 6566 6c65 6374 7320 7468 6520 6e75 6d62  eflects the numb
-0000d7e0: 6572 206f 6620 6279 7465 7320 7573 6564  er of bytes used
-0000d7f0: 2061 730a 2020 2020 2020 2020 2020 2020   as.            
-0000d800: 636f 6d70 7574 6564 2062 7920 6060 7061  computed by ``pa
-0000d810: 6e64 6173 2e44 6174 6146 7261 6d65 2e6d  ndas.DataFrame.m
-0000d820: 656d 6f72 795f 7573 6167 6560 602c 2077  emory_usage``, w
-0000d830: 6869 6368 2077 696c 6c20 6e6f 740a 2020  hich will not.  
-0000d840: 2020 2020 2020 2020 2020 6e65 6365 7373            necess
-0000d850: 6172 696c 7920 6d61 7463 6820 7468 6520  arily match the 
-0000d860: 7369 7a65 2077 6865 6e20 7374 6f72 696e  size when storin
-0000d870: 6720 746f 2064 6973 6b2e 0a0a 2020 2020  g to disk...    
-0000d880: 2020 2020 2020 2020 2e2e 2077 6172 6e69          .. warni
-0000d890: 6e67 3a3a 0a0a 2020 2020 2020 2020 2020  ng::..          
-0000d8a0: 2020 2020 2054 6869 7320 6b65 7977 6f72       This keywor
-0000d8b0: 6420 6172 6775 6d65 6e74 2074 7269 6767  d argument trigg
-0000d8c0: 6572 7320 636f 6d70 7574 6174 696f 6e20  ers computation 
-0000d8d0: 746f 2064 6574 6572 6d69 6e65 0a20 2020  to determine.   
-0000d8e0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-0000d8f0: 6d65 6d6f 7279 2073 697a 6520 6f66 2065  memory size of e
-0000d900: 6163 6820 7061 7274 6974 696f 6e2c 2077  ach partition, w
-0000d910: 6869 6368 206d 6179 2062 6520 6578 7065  hich may be expe
-0000d920: 6e73 6976 652e 0a0a 2020 2020 2020 2020  nsive...        
-0000d930: 6672 6571 203a 2073 7472 2c20 7064 2e54  freq : str, pd.T
-0000d940: 696d 6564 656c 7461 0a20 2020 2020 2020  imedelta.       
-0000d950: 2020 2020 2041 2070 6572 696f 6420 6f6e       A period on
-0000d960: 2077 6869 6368 2074 6f20 7061 7274 6974   which to partit
-0000d970: 696f 6e20 7469 6d65 7365 7269 6573 2064  ion timeseries d
-0000d980: 6174 6120 6c69 6b65 2060 6027 3744 2760  ata like ``'7D'`
-0000d990: 6020 6f72 0a20 2020 2020 2020 2020 2020  ` or.           
-0000d9a0: 2060 6027 3132 6827 6060 206f 7220 6060   ``'12h'`` or ``
-0000d9b0: 7064 2e54 696d 6564 656c 7461 2868 6f75  pd.Timedelta(hou
-0000d9c0: 7273 3d31 3229 6060 2e20 2041 7373 756d  rs=12)``.  Assum
-0000d9d0: 6573 2061 2064 6174 6574 696d 6520 696e  es a datetime in
-0000d9e0: 6465 782e 0a20 2020 2020 2020 2066 6f72  dex..        for
-0000d9f0: 6365 203a 2062 6f6f 6c2c 2064 6566 6175  ce : bool, defau
-0000da00: 6c74 2046 616c 7365 0a20 2020 2020 2020  lt False.       
-0000da10: 2020 2020 2041 6c6c 6f77 7320 7468 6520       Allows the 
-0000da20: 6578 7061 6e73 696f 6e20 6f66 2074 6865  expansion of the
-0000da30: 2065 7869 7374 696e 6720 6469 7669 7369   existing divisi
-0000da40: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
-0000da50: 2049 6620 4661 6c73 6520 7468 656e 2074   If False then t
-0000da60: 6865 206e 6577 2064 6976 6973 696f 6e73  he new divisions
-0000da70: 2720 6c6f 7765 7220 616e 6420 7570 7065  ' lower and uppe
-0000da80: 7220 626f 756e 6473 206d 7573 7420 6265  r bounds must be
-0000da90: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-0000daa0: 2073 616d 6520 6173 2074 6865 206f 6c64   same as the old
-0000dab0: 2064 6976 6973 696f 6e73 272e 0a0a 2020   divisions'...  
-0000dac0: 2020 2020 2020 4e6f 7465 730a 2020 2020        Notes.    
-0000dad0: 2020 2020 2d2d 2d2d 2d0a 2020 2020 2020      -----.      
-0000dae0: 2020 4578 6163 746c 7920 6f6e 6520 6f66    Exactly one of
-0000daf0: 2060 6469 7669 7369 6f6e 7360 2c20 606e   `divisions`, `n
-0000db00: 7061 7274 6974 696f 6e73 602c 2060 7061  partitions`, `pa
-0000db10: 7274 6974 696f 6e5f 7369 7a65 602c 206f  rtition_size`, o
-0000db20: 7220 6066 7265 7160 0a20 2020 2020 2020  r `freq`.       
-0000db30: 2073 686f 756c 6420 6265 2073 7065 6369   should be speci
-0000db40: 6669 6564 2e20 4120 6060 5661 6c75 6545  fied. A ``ValueE
-0000db50: 7272 6f72 6060 2077 696c 6c20 6265 2072  rror`` will be r
-0000db60: 6169 7365 6420 7768 656e 2074 6861 7420  aised when that 
-0000db70: 6973 0a20 2020 2020 2020 206e 6f74 2074  is.        not t
-0000db80: 6865 2063 6173 652e 0a0a 2020 2020 2020  he case...      
-0000db90: 2020 416c 736f 206e 6f74 6520 7468 6174    Also note that
-0000dba0: 2060 606c 656e 2864 6976 6973 6f6e 7329   ``len(divisons)
-0000dbb0: 6060 2069 7320 6571 7561 6c20 746f 2060  `` is equal to `
-0000dbc0: 606e 7061 7274 6974 696f 6e73 202b 2031  `npartitions + 1
-0000dbd0: 6060 2e20 5468 6973 2069 7320 6265 6361  ``. This is beca
-0000dbe0: 7573 6520 6060 6469 7669 7369 6f6e 7360  use ``divisions`
-0000dbf0: 600a 2020 2020 2020 2020 7265 7072 6573  `.        repres
-0000dc00: 656e 7473 2074 6865 2075 7070 6572 2061  ents the upper a
-0000dc10: 6e64 206c 6f77 6572 2062 6f75 6e64 7320  nd lower bounds 
-0000dc20: 6f66 2065 6163 6820 7061 7274 6974 696f  of each partitio
-0000dc30: 6e2e 2054 6865 2066 6972 7374 2069 7465  n. The first ite
-0000dc40: 6d20 6973 2074 6865 0a20 2020 2020 2020  m is the.       
-0000dc50: 206c 6f77 6572 2062 6f75 6e64 206f 6620   lower bound of 
-0000dc60: 7468 6520 6669 7273 7420 7061 7274 6974  the first partit
-0000dc70: 696f 6e2c 2074 6865 2073 6563 6f6e 6420  ion, the second 
-0000dc80: 6974 656d 2069 7320 7468 6520 6c6f 7765  item is the lowe
-0000dc90: 7220 626f 756e 6420 6f66 2074 6865 0a20  r bound of the. 
-0000dca0: 2020 2020 2020 2073 6563 6f6e 6420 7061         second pa
-0000dcb0: 7274 6974 696f 6e20 616e 6420 7468 6520  rtition and the 
-0000dcc0: 7570 7065 7220 626f 756e 6420 6f66 2074  upper bound of t
-0000dcd0: 6865 2066 6972 7374 2070 6172 7469 7469  he first partiti
-0000dce0: 6f6e 2c20 616e 6420 736f 206f 6e2e 0a20  on, and so on.. 
-0000dcf0: 2020 2020 2020 2054 6865 2073 6563 6f6e         The secon
-0000dd00: 642d 746f 2d6c 6173 7420 6974 656d 2069  d-to-last item i
-0000dd10: 7320 7468 6520 6c6f 7765 7220 626f 756e  s the lower boun
-0000dd20: 6420 6f66 2074 6865 206c 6173 7420 7061  d of the last pa
-0000dd30: 7274 6974 696f 6e2c 2061 6e64 2074 6865  rtition, and the
-0000dd40: 206c 6173 740a 2020 2020 2020 2020 2865   last.        (e
-0000dd50: 7874 7261 2920 6974 656d 2069 7320 7468  xtra) item is th
-0000dd60: 6520 7570 7065 7220 626f 756e 6420 6f66  e upper bound of
-0000dd70: 2074 6865 206c 6173 7420 7061 7274 6974   the last partit
-0000dd80: 696f 6e2e 0a0a 2020 2020 2020 2020 4578  ion...        Ex
-0000dd90: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
-0000dda0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000ddb0: 3e3e 3e20 6466 203d 2064 662e 7265 7061  >>> df = df.repa
-0000ddc0: 7274 6974 696f 6e28 6e70 6172 7469 7469  rtition(npartiti
-0000ddd0: 6f6e 733d 3130 2920 2023 2064 6f63 7465  ons=10)  # docte
-0000dde0: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
-0000ddf0: 2020 3e3e 3e20 6466 203d 2064 662e 7265    >>> df = df.re
-0000de00: 7061 7274 6974 696f 6e28 6469 7669 7369  partition(divisi
-0000de10: 6f6e 733d 5b30 2c20 352c 2031 302c 2032  ons=[0, 5, 10, 2
-0000de20: 305d 2920 2023 2064 6f63 7465 7374 3a20  0])  # doctest: 
-0000de30: 2b53 4b49 500a 2020 2020 2020 2020 3e3e  +SKIP.        >>
-0000de40: 3e20 6466 203d 2064 662e 7265 7061 7274  > df = df.repart
-0000de50: 6974 696f 6e28 6672 6571 3d27 3764 2729  ition(freq='7d')
-0000de60: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0000de70: 4950 0a0a 2020 2020 2020 2020 5365 6520  IP..        See 
-0000de80: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
-0000de90: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
-0000dea0: 7461 4672 616d 652e 6d65 6d6f 7279 5f75  taFrame.memory_u
-0000deb0: 7361 6765 5f70 6572 5f70 6172 7469 7469  sage_per_partiti
-0000dec0: 6f6e 0a20 2020 2020 2020 2070 616e 6461  on.        panda
-0000ded0: 732e 4461 7461 4672 616d 652e 6d65 6d6f  s.DataFrame.memo
-0000dee0: 7279 5f75 7361 6765 0a20 2020 2020 2020  ry_usage.       
-0000def0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-0000df00: 6973 696e 7374 616e 6365 2864 6976 6973  isinstance(divis
-0000df10: 696f 6e73 2c20 696e 7429 3a0a 2020 2020  ions, int):.    
-0000df20: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
-0000df30: 6f6e 7320 3d20 6469 7669 7369 6f6e 730a  ons = divisions.
-0000df40: 2020 2020 2020 2020 2020 2020 6469 7669              divi
-0000df50: 7369 6f6e 7320 3d20 4e6f 6e65 0a20 2020  sions = None.   
-0000df60: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0000df70: 6365 2864 6976 6973 696f 6e73 2c20 7374  ce(divisions, st
-0000df80: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-0000df90: 7061 7274 6974 696f 6e5f 7369 7a65 203d  partition_size =
-0000dfa0: 2064 6976 6973 696f 6e73 0a20 2020 2020   divisions.     
-0000dfb0: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
-0000dfc0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-0000dfd0: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
-0000dfe0: 2073 756d 280a 2020 2020 2020 2020 2020   sum(.          
-0000dff0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-0000e000: 2020 2020 2020 2020 2020 2020 7061 7274              part
-0000e010: 6974 696f 6e5f 7369 7a65 2069 7320 6e6f  ition_size is no
-0000e020: 7420 4e6f 6e65 2c0a 2020 2020 2020 2020  t None,.        
-0000e030: 2020 2020 2020 2020 2020 2020 6469 7669              divi
-0000e040: 7369 6f6e 7320 6973 206e 6f74 204e 6f6e  sions is not Non
-0000e050: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0000e060: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
-0000e070: 6e73 2069 7320 6e6f 7420 4e6f 6e65 2c0a  ns is not None,.
-0000e080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e090: 2020 2020 6672 6571 2069 7320 6e6f 7420      freq is not 
-0000e0a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0000e0b0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-0000e0c0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000e0d0: 2020 213d 2031 0a20 2020 2020 2020 2029    != 1.        )
-0000e0e0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000e0f0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0000e100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e110: 2250 6c65 6173 6520 7072 6f76 6964 6520  "Please provide 
-0000e120: 6578 6163 746c 7920 6f6e 6520 6f66 2060  exactly one of `
-0000e130: 606e 7061 7274 6974 696f 6e73 3d60 602c  `npartitions=``,
-0000e140: 2060 6066 7265 713d 6060 2c20 220a 2020   ``freq=``, ".  
-0000e150: 2020 2020 2020 2020 2020 2020 2020 2260                "`
-0000e160: 6064 6976 6973 696f 6e73 3d60 602c 2060  `divisions=``, `
-0000e170: 6070 6172 7469 7469 6f6e 5f73 697a 653d  `partition_size=
-0000e180: 6060 206b 6579 776f 7264 2061 7267 756d  `` keyword argum
-0000e190: 656e 7473 220a 2020 2020 2020 2020 2020  ents".          
-0000e1a0: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
-0000e1b0: 7061 7274 6974 696f 6e5f 7369 7a65 2069  partition_size i
-0000e1c0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000e1d0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0000e1e0: 6570 6172 7469 7469 6f6e 5f73 697a 6528  epartition_size(
-0000e1f0: 7365 6c66 2c20 7061 7274 6974 696f 6e5f  self, partition_
-0000e200: 7369 7a65 290a 2020 2020 2020 2020 656c  size).        el
-0000e210: 6966 206e 7061 7274 6974 696f 6e73 2069  if npartitions i
-0000e220: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000e230: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0000e240: 6570 6172 7469 7469 6f6e 5f6e 7061 7274  epartition_npart
-0000e250: 6974 696f 6e73 2873 656c 662c 206e 7061  itions(self, npa
-0000e260: 7274 6974 696f 6e73 290a 2020 2020 2020  rtitions).      
-0000e270: 2020 656c 6966 2064 6976 6973 696f 6e73    elif divisions
-0000e280: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000e290: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000e2a0: 2072 6570 6172 7469 7469 6f6e 2873 656c   repartition(sel
-0000e2b0: 662c 2064 6976 6973 696f 6e73 2c20 666f  f, divisions, fo
-0000e2c0: 7263 653d 666f 7263 6529 0a20 2020 2020  rce=force).     
-0000e2d0: 2020 2065 6c69 6620 6672 6571 2069 7320     elif freq is 
-0000e2e0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0000e2f0: 2020 2020 2020 7265 7475 726e 2072 6570        return rep
-0000e300: 6172 7469 7469 6f6e 5f66 7265 7128 7365  artition_freq(se
-0000e310: 6c66 2c20 6672 6571 3d66 7265 7129 0a0a  lf, freq=freq)..
-0000e320: 2020 2020 6465 6620 7368 7566 666c 6528      def shuffle(
-0000e330: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000e340: 2020 2020 2020 206f 6e2c 0a20 2020 2020         on,.     
-0000e350: 2020 206e 7061 7274 6974 696f 6e73 3d4e     npartitions=N
-0000e360: 6f6e 652c 0a20 2020 2020 2020 206d 6178  one,.        max
-0000e370: 5f62 7261 6e63 683d 4e6f 6e65 2c0a 2020  _branch=None,.  
-0000e380: 2020 2020 2020 7368 7566 666c 653d 4e6f        shuffle=No
-0000e390: 6e65 2c0a 2020 2020 2020 2020 6967 6e6f  ne,.        igno
-0000e3a0: 7265 5f69 6e64 6578 3d46 616c 7365 2c0a  re_index=False,.
-0000e3b0: 2020 2020 2020 2020 636f 6d70 7574 653d          compute=
-0000e3c0: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
-0000e3d0: 2020 2020 2022 2222 5265 6172 7261 6e67       """Rearrang
-0000e3e0: 6520 4461 7461 4672 616d 6520 696e 746f  e DataFrame into
-0000e3f0: 206e 6577 2070 6172 7469 7469 6f6e 730a   new partitions.
-0000e400: 0a20 2020 2020 2020 2055 7365 7320 6861  .        Uses ha
-0000e410: 7368 696e 6720 6f66 2060 6f6e 6020 746f  shing of `on` to
-0000e420: 206d 6170 2072 6f77 7320 746f 206f 7574   map rows to out
-0000e430: 7075 7420 7061 7274 6974 696f 6e73 2e20  put partitions. 
-0000e440: 4166 7465 7220 7468 6973 0a20 2020 2020  After this.     
-0000e450: 2020 206f 7065 7261 7469 6f6e 2c20 726f     operation, ro
-0000e460: 7773 2077 6974 6820 7468 6520 7361 6d65  ws with the same
-0000e470: 2076 616c 7565 206f 6620 606f 6e60 2077   value of `on` w
-0000e480: 696c 6c20 6265 2069 6e20 7468 6520 7361  ill be in the sa
-0000e490: 6d65 0a20 2020 2020 2020 2070 6172 7469  me.        parti
-0000e4a0: 7469 6f6e 2e0a 0a20 2020 2020 2020 2050  tion...        P
-0000e4b0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-0000e4c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0000e4d0: 2020 2020 206f 6e20 3a20 7374 722c 206c       on : str, l
-0000e4e0: 6973 7420 6f66 2073 7472 2c20 6f72 2053  ist of str, or S
-0000e4f0: 6572 6965 732c 2049 6e64 6578 2c20 6f72  eries, Index, or
-0000e500: 2044 6174 6146 7261 6d65 0a20 2020 2020   DataFrame.     
-0000e510: 2020 2020 2020 2043 6f6c 756d 6e28 7329         Column(s)
-0000e520: 206f 7220 696e 6465 7820 746f 2062 6520   or index to be 
-0000e530: 7573 6564 2074 6f20 6d61 7020 726f 7773  used to map rows
-0000e540: 2074 6f20 6f75 7470 7574 2070 6172 7469   to output parti
-0000e550: 7469 6f6e 730a 2020 2020 2020 2020 6e70  tions.        np
-0000e560: 6172 7469 7469 6f6e 7320 3a20 696e 742c  artitions : int,
-0000e570: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0000e580: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
-0000e590: 7061 7274 6974 696f 6e73 206f 6620 6f75  partitions of ou
-0000e5a0: 7470 7574 2e20 5061 7274 6974 696f 6e20  tput. Partition 
-0000e5b0: 636f 756e 7420 7769 6c6c 206e 6f74 2062  count will not b
-0000e5c0: 650a 2020 2020 2020 2020 2020 2020 6368  e.            ch
-0000e5d0: 616e 6765 6420 6279 2064 6566 6175 6c74  anged by default
-0000e5e0: 2e0a 2020 2020 2020 2020 6d61 785f 6272  ..        max_br
-0000e5f0: 616e 6368 3a20 696e 742c 206f 7074 696f  anch: int, optio
-0000e600: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-0000e610: 5468 6520 6d61 7869 6d75 6d20 6e75 6d62  The maximum numb
-0000e620: 6572 206f 6620 7370 6c69 7473 2070 6572  er of splits per
-0000e630: 2069 6e70 7574 2070 6172 7469 7469 6f6e   input partition
-0000e640: 2e20 5573 6564 2077 6974 6869 6e0a 2020  . Used within.  
-0000e650: 2020 2020 2020 2020 2020 7468 6520 7374            the st
-0000e660: 6167 6564 2073 6875 6666 6c69 6e67 2061  aged shuffling a
-0000e670: 6c67 6f72 6974 686d 2e0a 2020 2020 2020  lgorithm..      
-0000e680: 2020 7368 7566 666c 653a 207b 2764 6973    shuffle: {'dis
-0000e690: 6b27 2c20 2774 6173 6b73 277d 2c20 6f70  k', 'tasks'}, op
-0000e6a0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0000e6b0: 2020 2045 6974 6865 7220 6060 2764 6973     Either ``'dis
-0000e6c0: 6b27 6060 2066 6f72 2073 696e 676c 652d  k'`` for single-
-0000e6d0: 6e6f 6465 206f 7065 7261 7469 6f6e 206f  node operation o
-0000e6e0: 7220 6060 2774 6173 6b73 2760 6020 666f  r ``'tasks'`` fo
-0000e6f0: 720a 2020 2020 2020 2020 2020 2020 6469  r.            di
-0000e700: 7374 7269 6275 7465 6420 6f70 6572 6174  stributed operat
-0000e710: 696f 6e2e 2020 5769 6c6c 2062 6520 696e  ion.  Will be in
-0000e720: 6665 7272 6564 2062 7920 796f 7572 2063  ferred by your c
-0000e730: 7572 7265 6e74 2073 6368 6564 756c 6572  urrent scheduler
-0000e740: 2e0a 2020 2020 2020 2020 6967 6e6f 7265  ..        ignore
-0000e750: 5f69 6e64 6578 3a20 626f 6f6c 2c20 6465  _index: bool, de
-0000e760: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
-0000e770: 2020 2020 2020 2020 4967 6e6f 7265 2069          Ignore i
-0000e780: 6e64 6578 2064 7572 696e 6720 7368 7566  ndex during shuf
-0000e790: 666c 652e 2020 4966 2060 6054 7275 6560  fle.  If ``True`
-0000e7a0: 602c 2070 6572 666f 726d 616e 6365 206d  `, performance m
-0000e7b0: 6179 2069 6d70 726f 7665 2c0a 2020 2020  ay improve,.    
-0000e7c0: 2020 2020 2020 2020 6275 7420 696e 6465          but inde
-0000e7d0: 7820 7661 6c75 6573 2077 696c 6c20 6e6f  x values will no
-0000e7e0: 7420 6265 2070 7265 7365 7276 6564 2e0a  t be preserved..
-0000e7f0: 2020 2020 2020 2020 636f 6d70 7574 653a          compute:
-0000e800: 2062 6f6f 6c0a 2020 2020 2020 2020 2020   bool.          
-0000e810: 2020 5768 6574 6865 7220 6f72 206e 6f74    Whether or not
-0000e820: 2074 6f20 7472 6967 6765 7220 616e 2069   to trigger an i
-0000e830: 6d6d 6564 6961 7465 2063 6f6d 7075 7461  mmediate computa
-0000e840: 7469 6f6e 2e20 4465 6661 756c 7473 2074  tion. Defaults t
-0000e850: 6f20 4661 6c73 652e 0a0a 2020 2020 2020  o False...      
-0000e860: 2020 4e6f 7465 730a 2020 2020 2020 2020    Notes.        
-0000e870: 2d2d 2d2d 2d0a 2020 2020 2020 2020 5468  -----.        Th
-0000e880: 6973 2064 6f65 7320 6e6f 7420 7072 6573  is does not pres
-0000e890: 6572 7665 2061 206d 6561 6e69 6e67 6675  erve a meaningfu
-0000e8a0: 6c20 696e 6465 782f 7061 7274 6974 696f  l index/partitio
-0000e8b0: 6e69 6e67 2073 6368 656d 652e 2054 6869  ning scheme. Thi
-0000e8c0: 730a 2020 2020 2020 2020 6973 206e 6f74  s.        is not
-0000e8d0: 2064 6574 6572 6d69 6e69 7374 6963 2069   deterministic i
-0000e8e0: 6620 646f 6e65 2069 6e20 7061 7261 6c6c  f done in parall
-0000e8f0: 656c 2e0a 0a20 2020 2020 2020 2045 7861  el...        Exa
-0000e900: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
-0000e910: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
-0000e920: 3e3e 2064 6620 3d20 6466 2e73 6875 6666  >> df = df.shuff
-0000e930: 6c65 2864 662e 636f 6c75 6d6e 735b 305d  le(df.columns[0]
-0000e940: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-0000e950: 4b49 500a 2020 2020 2020 2020 2222 220a  KIP.        """.
-0000e960: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-0000e970: 6b2e 6461 7461 6672 616d 652e 7368 7566  k.dataframe.shuf
-0000e980: 666c 6520 696d 706f 7274 2073 6875 6666  fle import shuff
-0000e990: 6c65 2061 7320 6464 5f73 6875 6666 6c65  le as dd_shuffle
-0000e9a0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000e9b0: 2064 645f 7368 7566 666c 6528 0a20 2020   dd_shuffle(.   
-0000e9c0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-0000e9d0: 2020 2020 2020 2020 2020 206f 6e2c 0a20             on,. 
-0000e9e0: 2020 2020 2020 2020 2020 206e 7061 7274             npart
-0000e9f0: 6974 696f 6e73 3d6e 7061 7274 6974 696f  itions=npartitio
-0000ea00: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-0000ea10: 6d61 785f 6272 616e 6368 3d6d 6178 5f62  max_branch=max_b
-0000ea20: 7261 6e63 682c 0a20 2020 2020 2020 2020  ranch,.         
-0000ea30: 2020 2073 6875 6666 6c65 3d73 6875 6666     shuffle=shuff
-0000ea40: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
-0000ea50: 6967 6e6f 7265 5f69 6e64 6578 3d69 676e  ignore_index=ign
-0000ea60: 6f72 655f 696e 6465 782c 0a20 2020 2020  ore_index,.     
-0000ea70: 2020 2020 2020 2063 6f6d 7075 7465 3d63         compute=c
-0000ea80: 6f6d 7075 7465 2c0a 2020 2020 2020 2020  ompute,.        
-0000ea90: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-0000eaa0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-0000eab0: 6529 0a20 2020 2064 6566 2066 696c 6c6e  e).    def filln
-0000eac0: 6128 7365 6c66 2c20 7661 6c75 653d 4e6f  a(self, value=No
-0000ead0: 6e65 2c20 6d65 7468 6f64 3d4e 6f6e 652c  ne, method=None,
-0000eae0: 206c 696d 6974 3d4e 6f6e 652c 2061 7869   limit=None, axi
-0000eaf0: 733d 4e6f 6e65 293a 0a20 2020 2020 2020  s=None):.       
-0000eb00: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
-0000eb10: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
-0000eb20: 290a 2020 2020 2020 2020 6966 206d 6574  ).        if met
-0000eb30: 686f 6420 6973 204e 6f6e 6520 616e 6420  hod is None and 
-0000eb40: 6c69 6d69 7420 6973 206e 6f74 204e 6f6e  limit is not Non
-0000eb50: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000eb60: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-0000eb70: 7465 6445 7272 6f72 2822 6669 6c6c 6e61  tedError("fillna
-0000eb80: 2077 6974 6820 7365 7420 6c69 6d69 7420   with set limit 
-0000eb90: 616e 6420 6d65 7468 6f64 3d4e 6f6e 6522  and method=None"
-0000eba0: 290a 2020 2020 2020 2020 6966 2069 7369  ).        if isi
-0000ebb0: 6e73 7461 6e63 6528 7661 6c75 652c 2028  nstance(value, (
-0000ebc0: 5f46 7261 6d65 2c20 5363 616c 6172 2929  _Frame, Scalar))
-0000ebd0: 3a0a 2020 2020 2020 2020 2020 2020 7465  :.            te
-0000ebe0: 7374 5f76 616c 7565 203d 2076 616c 7565  st_value = value
-0000ebf0: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 790a  ._meta_nonempty.
-0000ec00: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000ec10: 2020 2020 2020 2020 2020 7465 7374 5f76            test_v
-0000ec20: 616c 7565 203d 2076 616c 7565 0a20 2020  alue = value.   
-0000ec30: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
-0000ec40: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-0000ec50: 6669 6c6c 6e61 280a 2020 2020 2020 2020  fillna(.        
-0000ec60: 2020 2020 7661 6c75 653d 7465 7374 5f76      value=test_v
-0000ec70: 616c 7565 2c20 6d65 7468 6f64 3d6d 6574  alue, method=met
-0000ec80: 686f 642c 206c 696d 6974 3d6c 696d 6974  hod, limit=limit
-0000ec90: 2c20 6178 6973 3d61 7869 730a 2020 2020  , axis=axis.    
-0000eca0: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-0000ecb0: 6620 6178 6973 203d 3d20 3120 6f72 206d  f axis == 1 or m
-0000ecc0: 6574 686f 6420 6973 204e 6f6e 653a 0a20  ethod is None:. 
-0000ecd0: 2020 2020 2020 2020 2020 2023 2043 6f6e             # Con
-0000ece0: 7472 6f6c 2077 6865 7468 6572 206f 7220  trol whether or 
-0000ecf0: 6e6f 7420 6461 736b 2773 2070 6172 7469  not dask's parti
-0000ed00: 7469 6f6e 2061 6c69 676e 6d65 6e74 2068  tion alignment h
-0000ed10: 6170 7065 6e73 2e0a 2020 2020 2020 2020  appens..        
-0000ed20: 2020 2020 2320 5765 2064 6f6e 2774 2077      # We don't w
-0000ed30: 616e 7420 666f 7220 6120 7061 6e64 6173  ant for a pandas
-0000ed40: 2053 6572 6965 732e 0a20 2020 2020 2020   Series..       
-0000ed50: 2020 2020 2023 2057 6520 646f 2077 616e       # We do wan
-0000ed60: 7420 6974 2066 6f72 2061 2064 6173 6b20  t it for a dask 
-0000ed70: 5365 7269 6573 0a20 2020 2020 2020 2020  Series.         
-0000ed80: 2020 2069 6620 6973 5f73 6572 6965 735f     if is_series_
-0000ed90: 6c69 6b65 2876 616c 7565 2920 616e 6420  like(value) and 
-0000eda0: 6e6f 7420 6973 5f64 6173 6b5f 636f 6c6c  not is_dask_coll
-0000edb0: 6563 7469 6f6e 2876 616c 7565 293a 0a20  ection(value):. 
-0000edc0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0000edd0: 7267 7320 3d20 2829 0a20 2020 2020 2020  rgs = ().       
-0000ede0: 2020 2020 2020 2020 206b 7761 7267 7320           kwargs 
-0000edf0: 3d20 7b22 7661 6c75 6522 3a20 7661 6c75  = {"value": valu
-0000ee00: 657d 0a20 2020 2020 2020 2020 2020 2065  e}.            e
-0000ee10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000ee20: 2020 2020 2061 7267 7320 3d20 2876 616c       args = (val
-0000ee30: 7565 2c29 0a20 2020 2020 2020 2020 2020  ue,).           
-0000ee40: 2020 2020 206b 7761 7267 7320 3d20 7b7d       kwargs = {}
-0000ee50: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000ee60: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
-0000ee70: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
-0000ee80: 2020 2020 2020 2020 204d 2e66 696c 6c6e           M.filln
-0000ee90: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-0000eea0: 2020 202a 6172 6773 2c0a 2020 2020 2020     *args,.      
-0000eeb0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-0000eec0: 3d6d 6574 686f 642c 0a20 2020 2020 2020  =method,.       
-0000eed0: 2020 2020 2020 2020 206c 696d 6974 3d6c           limit=l
-0000eee0: 696d 6974 2c0a 2020 2020 2020 2020 2020  imit,.          
-0000eef0: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
-0000ef00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ef10: 206d 6574 613d 6d65 7461 2c0a 2020 2020   meta=meta,.    
-0000ef20: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
-0000ef30: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
-0000ef40: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-0000ef50: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
-0000ef60: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000ef70: 2020 2020 2069 6620 6d65 7468 6f64 2069       if method i
-0000ef80: 6e20 2822 7061 6422 2c20 2266 6669 6c6c  n ("pad", "ffill
-0000ef90: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
-0000efa0: 6d65 7468 6f64 203d 2022 6666 696c 6c22  method = "ffill"
-0000efb0: 0a20 2020 2020 2020 2020 2020 2073 6b69  .            ski
-0000efc0: 705f 6368 6563 6b20 3d20 300a 2020 2020  p_check = 0.    
-0000efd0: 2020 2020 2020 2020 6265 666f 7265 2c20          before, 
-0000efe0: 6166 7465 7220 3d20 3120 6966 206c 696d  after = 1 if lim
-0000eff0: 6974 2069 7320 4e6f 6e65 2065 6c73 6520  it is None else 
-0000f000: 6c69 6d69 742c 2030 0a20 2020 2020 2020  limit, 0.       
-0000f010: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000f020: 2020 206d 6574 686f 6420 3d20 2262 6669     method = "bfi
-0000f030: 6c6c 220a 2020 2020 2020 2020 2020 2020  ll".            
-0000f040: 736b 6970 5f63 6865 636b 203d 2073 656c  skip_check = sel
-0000f050: 662e 6e70 6172 7469 7469 6f6e 7320 2d20  f.npartitions - 
-0000f060: 310a 2020 2020 2020 2020 2020 2020 6265  1.            be
-0000f070: 666f 7265 2c20 6166 7465 7220 3d20 302c  fore, after = 0,
-0000f080: 2031 2069 6620 6c69 6d69 7420 6973 204e   1 if limit is N
-0000f090: 6f6e 6520 656c 7365 206c 696d 6974 0a0a  one else limit..
-0000f0a0: 2020 2020 2020 2020 6966 206c 696d 6974          if limit
-0000f0b0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0000f0c0: 2020 2020 2020 6e61 6d65 203d 2022 6669        name = "fi
-0000f0d0: 6c6c 6e61 2d63 6875 6e6b 2d22 202b 2074  llna-chunk-" + t
-0000f0e0: 6f6b 656e 697a 6528 7365 6c66 2c20 6d65  okenize(self, me
-0000f0f0: 7468 6f64 290a 2020 2020 2020 2020 2020  thod).          
-0000f100: 2020 6473 6b20 3d20 7b0a 2020 2020 2020    dsk = {.      
-0000f110: 2020 2020 2020 2020 2020 286e 616d 652c            (name,
-0000f120: 2069 293a 2028 0a20 2020 2020 2020 2020   i): (.         
-0000f130: 2020 2020 2020 2020 2020 206d 6574 686f             metho
-0000f140: 6473 2e66 696c 6c6e 615f 6368 6563 6b2c  ds.fillna_check,
-0000f150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f160: 2020 2020 2028 7365 6c66 2e5f 6e61 6d65       (self._name
-0000f170: 2c20 6929 2c0a 2020 2020 2020 2020 2020  , i),.          
-0000f180: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-0000f190: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000f1a0: 2020 2020 2020 6920 213d 2073 6b69 705f        i != skip_
-0000f1b0: 6368 6563 6b2c 0a20 2020 2020 2020 2020  check,.         
-0000f1c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000f1d0: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-0000f1e0: 6e20 7261 6e67 6528 7365 6c66 2e6e 7061  n range(self.npa
-0000f1f0: 7274 6974 696f 6e73 290a 2020 2020 2020  rtitions).      
-0000f200: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0000f210: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
-0000f220: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
-0000f230: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
-0000f240: 2c20 6473 6b2c 2064 6570 656e 6465 6e63  , dsk, dependenc
-0000f250: 6965 733d 5b73 656c 665d 290a 2020 2020  ies=[self]).    
-0000f260: 2020 2020 2020 2020 7061 7274 7320 3d20          parts = 
-0000f270: 6e65 775f 6464 5f6f 626a 6563 7428 6772  new_dd_object(gr
-0000f280: 6170 682c 206e 616d 652c 206d 6574 612c  aph, name, meta,
-0000f290: 2073 656c 662e 6469 7669 7369 6f6e 7329   self.divisions)
-0000f2a0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0000f2b0: 2020 2020 2020 2020 2020 2070 6172 7473             parts
-0000f2c0: 203d 2073 656c 660a 0a20 2020 2020 2020   = self..       
-0000f2d0: 2072 6574 7572 6e20 7061 7274 732e 6d61   return parts.ma
-0000f2e0: 705f 6f76 6572 6c61 7028 0a20 2020 2020  p_overlap(.     
-0000f2f0: 2020 2020 2020 204d 2e66 696c 6c6e 612c         M.fillna,
-0000f300: 2062 6566 6f72 652c 2061 6674 6572 2c20   before, after, 
-0000f310: 6d65 7468 6f64 3d6d 6574 686f 642c 206c  method=method, l
-0000f320: 696d 6974 3d6c 696d 6974 2c20 6d65 7461  imit=limit, meta
-0000f330: 3d6d 6574 610a 2020 2020 2020 2020 290a  =meta.        ).
-0000f340: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0000f350: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0000f360: 0a20 2020 2064 6566 2066 6669 6c6c 2873  .    def ffill(s
-0000f370: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
-0000f380: 6c69 6d69 743d 4e6f 6e65 293a 0a20 2020  limit=None):.   
-0000f390: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000f3a0: 2e66 696c 6c6e 6128 6d65 7468 6f64 3d22  .fillna(method="
-0000f3b0: 6666 696c 6c22 2c20 6c69 6d69 743d 6c69  ffill", limit=li
-0000f3c0: 6d69 742c 2061 7869 733d 6178 6973 290a  mit, axis=axis).
-0000f3d0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0000f3e0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0000f3f0: 0a20 2020 2064 6566 2062 6669 6c6c 2873  .    def bfill(s
-0000f400: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
-0000f410: 6c69 6d69 743d 4e6f 6e65 293a 0a20 2020  limit=None):.   
-0000f420: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000f430: 2e66 696c 6c6e 6128 6d65 7468 6f64 3d22  .fillna(method="
-0000f440: 6266 696c 6c22 2c20 6c69 6d69 743d 6c69  bfill", limit=li
-0000f450: 6d69 742c 2061 7869 733d 6178 6973 290a  mit, axis=axis).
-0000f460: 0a20 2020 2064 6566 2073 616d 706c 6528  .    def sample(
-0000f470: 7365 6c66 2c20 6e3d 4e6f 6e65 2c20 6672  self, n=None, fr
-0000f480: 6163 3d4e 6f6e 652c 2072 6570 6c61 6365  ac=None, replace
-0000f490: 3d46 616c 7365 2c20 7261 6e64 6f6d 5f73  =False, random_s
-0000f4a0: 7461 7465 3d4e 6f6e 6529 3a0a 2020 2020  tate=None):.    
-0000f4b0: 2020 2020 2222 2252 616e 646f 6d20 7361      """Random sa
-0000f4c0: 6d70 6c65 206f 6620 6974 656d 730a 0a20  mple of items.. 
-0000f4d0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0000f4e0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0000f4f0: 2d2d 2d2d 0a20 2020 2020 2020 206e 203a  ----.        n :
-0000f500: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-0000f510: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
-0000f520: 7220 6f66 2069 7465 6d73 2074 6f20 7265  r of items to re
-0000f530: 7475 726e 2069 7320 6e6f 7420 7375 7070  turn is not supp
-0000f540: 6f72 7465 6420 6279 2064 6173 6b2e 2055  orted by dask. U
-0000f550: 7365 2066 7261 630a 2020 2020 2020 2020  se frac.        
-0000f560: 2020 2020 696e 7374 6561 642e 0a20 2020      instead..   
-0000f570: 2020 2020 2066 7261 6320 3a20 666c 6f61       frac : floa
-0000f580: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-0000f590: 2020 2020 2020 2020 4170 7072 6f78 696d          Approxim
-0000f5a0: 6174 6520 6672 6163 7469 6f6e 206f 6620  ate fraction of 
-0000f5b0: 6974 656d 7320 746f 2072 6574 7572 6e2e  items to return.
-0000f5c0: 2054 6869 7320 7361 6d70 6c69 6e67 2066   This sampling f
-0000f5d0: 7261 6374 696f 6e20 6973 0a20 2020 2020  raction is.     
-0000f5e0: 2020 2020 2020 2061 7070 6c69 6564 2074         applied t
-0000f5f0: 6f20 616c 6c20 7061 7274 6974 696f 6e73  o all partitions
-0000f600: 2065 7175 616c 6c79 2e20 4e6f 7465 2074   equally. Note t
-0000f610: 6861 7420 7468 6973 2069 7320 616e 0a20  hat this is an. 
-0000f620: 2020 2020 2020 2020 2020 202a 2a61 7070             **app
-0000f630: 726f 7869 6d61 7465 2066 7261 6374 696f  roximate fractio
-0000f640: 6e2a 2a2e 2059 6f75 2073 686f 756c 6420  n**. You should 
-0000f650: 6e6f 7420 6578 7065 6374 2065 7861 6374  not expect exact
-0000f660: 6c79 2060 606c 656e 2864 6629 202a 2066  ly ``len(df) * f
-0000f670: 7261 6360 600a 2020 2020 2020 2020 2020  rac``.          
-0000f680: 2020 6974 656d 7320 746f 2062 6520 7265    items to be re
-0000f690: 7475 726e 6564 2c20 6173 2074 6865 2065  turned, as the e
-0000f6a0: 7861 6374 206e 756d 6265 7220 6f66 2065  xact number of e
-0000f6b0: 6c65 6d65 6e74 7320 7365 6c65 6374 6564  lements selected
-0000f6c0: 2077 696c 6c0a 2020 2020 2020 2020 2020   will.          
-0000f6d0: 2020 6465 7065 6e64 206f 6e20 686f 7720    depend on how 
-0000f6e0: 796f 7572 2064 6174 6120 6973 2070 6172  your data is par
-0000f6f0: 7469 7469 6f6e 6564 2028 6275 7420 7368  titioned (but sh
-0000f700: 6f75 6c64 2062 6520 7072 6574 7479 2063  ould be pretty c
-0000f710: 6c6f 7365 0a20 2020 2020 2020 2020 2020  lose.           
-0000f720: 2069 6e20 7072 6163 7469 6365 292e 0a20   in practice).. 
-0000f730: 2020 2020 2020 2072 6570 6c61 6365 203a         replace :
-0000f740: 2062 6f6f 6c65 616e 2c20 6f70 7469 6f6e   boolean, option
-0000f750: 616c 0a20 2020 2020 2020 2020 2020 2053  al.            S
-0000f760: 616d 706c 6520 7769 7468 206f 7220 7769  ample with or wi
-0000f770: 7468 6f75 7420 7265 706c 6163 656d 656e  thout replacemen
-0000f780: 742e 2044 6566 6175 6c74 203d 2046 616c  t. Default = Fal
-0000f790: 7365 2e0a 2020 2020 2020 2020 7261 6e64  se..        rand
-0000f7a0: 6f6d 5f73 7461 7465 203a 2069 6e74 206f  om_state : int o
-0000f7b0: 7220 6060 6e70 2e72 616e 646f 6d2e 5261  r ``np.random.Ra
-0000f7c0: 6e64 6f6d 5374 6174 6560 600a 2020 2020  ndomState``.    
-0000f7d0: 2020 2020 2020 2020 4966 2061 6e20 696e          If an in
-0000f7e0: 742c 2077 6520 6372 6561 7465 2061 206e  t, we create a n
-0000f7f0: 6577 2052 616e 646f 6d53 7461 7465 2077  ew RandomState w
-0000f800: 6974 6820 7468 6973 2061 7320 7468 6520  ith this as the 
-0000f810: 7365 6564 3b0a 2020 2020 2020 2020 2020  seed;.          
-0000f820: 2020 4f74 6865 7277 6973 6520 7765 2064    Otherwise we d
-0000f830: 7261 7720 6672 6f6d 2074 6865 2070 6173  raw from the pas
-0000f840: 7365 6420 5261 6e64 6f6d 5374 6174 652e  sed RandomState.
-0000f850: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
-0000f860: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
-0000f870: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
-0000f880: 4672 616d 652e 7261 6e64 6f6d 5f73 706c  Frame.random_spl
-0000f890: 6974 0a20 2020 2020 2020 2070 616e 6461  it.        panda
-0000f8a0: 732e 4461 7461 4672 616d 652e 7361 6d70  s.DataFrame.samp
-0000f8b0: 6c65 0a20 2020 2020 2020 2022 2222 0a20  le.        """. 
-0000f8c0: 2020 2020 2020 2069 6620 6e20 6973 206e         if n is n
-0000f8d0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0000f8e0: 2020 2020 206d 7367 203d 2028 0a20 2020       msg = (.   
-0000f8f0: 2020 2020 2020 2020 2020 2020 2022 7361               "sa
-0000f900: 6d70 6c65 2064 6f65 7320 6e6f 7420 7375  mple does not su
-0000f910: 7070 6f72 7420 7468 6520 6e75 6d62 6572  pport the number
-0000f920: 206f 6620 7361 6d70 6c65 6420 6974 656d   of sampled item
-0000f930: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
-0000f940: 2020 2020 2270 6172 616d 6574 6572 2c20      "parameter, 
-0000f950: 276e 272e 2050 6c65 6173 6520 7573 6520  'n'. Please use 
-0000f960: 7468 6520 2766 7261 6327 2070 6172 616d  the 'frac' param
-0000f970: 6574 6572 2069 6e73 7465 6164 2e22 0a20  eter instead.". 
-0000f980: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000f990: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-0000f9a0: 7374 616e 6365 286e 2c20 4e75 6d62 6572  stance(n, Number
-0000f9b0: 2920 616e 6420 3020 3c3d 206e 203c 3d20  ) and 0 <= n <= 
-0000f9c0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-0000f9d0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-0000f9e0: 286d 7367 290a 2020 2020 2020 2020 2020  (msg).          
-0000f9f0: 2020 2020 2020 6672 6163 203d 206e 0a20        frac = n. 
-0000fa00: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0000fa10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fa20: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0000fa30: 7228 6d73 6729 0a0a 2020 2020 2020 2020  r(msg)..        
-0000fa40: 6966 2066 7261 6320 6973 204e 6f6e 653a  if frac is None:
-0000fa50: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000fa60: 7365 2056 616c 7565 4572 726f 7228 2266  se ValueError("f
-0000fa70: 7261 6320 6d75 7374 206e 6f74 2062 6520  rac must not be 
-0000fa80: 4e6f 6e65 2229 0a0a 2020 2020 2020 2020  None")..        
-0000fa90: 6966 2072 616e 646f 6d5f 7374 6174 6520  if random_state 
-0000faa0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0000fab0: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
-0000fac0: 6520 3d20 6e70 2e72 616e 646f 6d2e 5261  e = np.random.Ra
-0000fad0: 6e64 6f6d 5374 6174 6528 290a 0a20 2020  ndomState()..   
-0000fae0: 2020 2020 206e 616d 6520 3d20 2273 616d       name = "sam
-0000faf0: 706c 652d 2220 2b20 746f 6b65 6e69 7a65  ple-" + tokenize
-0000fb00: 2873 656c 662c 2066 7261 632c 2072 6570  (self, frac, rep
-0000fb10: 6c61 6365 2c20 7261 6e64 6f6d 5f73 7461  lace, random_sta
-0000fb20: 7465 290a 0a20 2020 2020 2020 2073 7461  te)..        sta
-0000fb30: 7465 5f64 6174 6120 3d20 7261 6e64 6f6d  te_data = random
-0000fb40: 5f73 7461 7465 5f64 6174 6128 7365 6c66  _state_data(self
-0000fb50: 2e6e 7061 7274 6974 696f 6e73 2c20 7261  .npartitions, ra
-0000fb60: 6e64 6f6d 5f73 7461 7465 290a 2020 2020  ndom_state).    
-0000fb70: 2020 2020 6473 6b20 3d20 7b0a 2020 2020      dsk = {.    
-0000fb80: 2020 2020 2020 2020 286e 616d 652c 2069          (name, i
-0000fb90: 293a 2028 6d65 7468 6f64 732e 7361 6d70  ): (methods.samp
-0000fba0: 6c65 2c20 2873 656c 662e 5f6e 616d 652c  le, (self._name,
-0000fbb0: 2069 292c 2073 7461 7465 2c20 6672 6163   i), state, frac
-0000fbc0: 2c20 7265 706c 6163 6529 0a20 2020 2020  , replace).     
-0000fbd0: 2020 2020 2020 2066 6f72 2069 2c20 7374         for i, st
-0000fbe0: 6174 6520 696e 2065 6e75 6d65 7261 7465  ate in enumerate
-0000fbf0: 2873 7461 7465 5f64 6174 6129 0a20 2020  (state_data).   
-0000fc00: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
-0000fc10: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
-0000fc20: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
-0000fc30: 6563 7469 6f6e 7328 6e61 6d65 2c20 6473  ections(name, ds
-0000fc40: 6b2c 2064 6570 656e 6465 6e63 6965 733d  k, dependencies=
-0000fc50: 5b73 656c 665d 290a 2020 2020 2020 2020  [self]).        
-0000fc60: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
-0000fc70: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
-0000fc80: 2c20 7365 6c66 2e5f 6d65 7461 2c20 7365  , self._meta, se
-0000fc90: 6c66 2e64 6976 6973 696f 6e73 290a 0a20  lf.divisions).. 
-0000fca0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0000fcb0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0000fcc0: 2020 2064 6566 2072 6570 6c61 6365 2873     def replace(s
-0000fcd0: 656c 662c 2074 6f5f 7265 706c 6163 653d  elf, to_replace=
-0000fce0: 4e6f 6e65 2c20 7661 6c75 653d 4e6f 6e65  None, value=None
-0000fcf0: 2c20 7265 6765 783d 4661 6c73 6529 3a0a  , regex=False):.
-0000fd00: 2020 2020 2020 2020 2320 496e 2050 414e          # In PAN
-0000fd10: 4441 535f 4754 5f31 3430 2070 616e 6461  DAS_GT_140 panda
-0000fd20: 7320 7374 6172 7473 2075 7369 6e67 206e  s starts using n
-0000fd30: 6f5f 6465 6661 756c 7420 696e 7374 6561  o_default instea
-0000fd40: 6420 6f66 204e 6f6e 650a 2020 2020 2020  d of None.      
-0000fd50: 2020 7661 6c75 655f 6b77 6172 6720 3d20    value_kwarg = 
-0000fd60: 7b22 7661 6c75 6522 3a20 7661 6c75 657d  {"value": value}
-0000fd70: 2069 6620 7661 6c75 6520 6973 206e 6f74   if value is not
-0000fd80: 204e 6f6e 6520 656c 7365 207b 7d0a 2020   None else {}.  
-0000fd90: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000fda0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-0000fdb0: 280a 2020 2020 2020 2020 2020 2020 4d2e  (.            M.
-0000fdc0: 7265 706c 6163 652c 0a20 2020 2020 2020  replace,.       
-0000fdd0: 2020 2020 2074 6f5f 7265 706c 6163 653d       to_replace=
-0000fde0: 746f 5f72 6570 6c61 6365 2c0a 2020 2020  to_replace,.    
-0000fdf0: 2020 2020 2020 2020 2a2a 7661 6c75 655f          **value_
-0000fe00: 6b77 6172 672c 0a20 2020 2020 2020 2020  kwarg,.         
-0000fe10: 2020 2072 6567 6578 3d72 6567 6578 2c0a     regex=regex,.
-0000fe20: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
-0000fe30: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
-0000fe40: 7365 2c0a 2020 2020 2020 2020 290a 0a20  se,.        ).. 
-0000fe50: 2020 2064 6566 2074 6f5f 6461 736b 5f61     def to_dask_a
-0000fe60: 7272 6179 2873 656c 662c 206c 656e 6774  rray(self, lengt
-0000fe70: 6873 3d4e 6f6e 652c 206d 6574 613d 4e6f  hs=None, meta=No
-0000fe80: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
-0000fe90: 436f 6e76 6572 7420 6120 6461 736b 2044  Convert a dask D
-0000fea0: 6174 6146 7261 6d65 2074 6f20 6120 6461  ataFrame to a da
-0000feb0: 736b 2061 7272 6179 2e0a 0a20 2020 2020  sk array...     
-0000fec0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0000fed0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0000fee0: 0a20 2020 2020 2020 206c 656e 6774 6873  .        lengths
-0000fef0: 203a 2062 6f6f 6c20 6f72 2053 6571 7565   : bool or Seque
-0000ff00: 6e63 6520 6f66 2069 6e74 732c 206f 7074  nce of ints, opt
-0000ff10: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0000ff20: 2020 486f 7720 746f 2064 6574 6572 6d69    How to determi
-0000ff30: 6e65 2074 6865 2063 6875 6e6b 7320 7369  ne the chunks si
-0000ff40: 7a65 7320 666f 7220 7468 6520 6f75 7470  zes for the outp
-0000ff50: 7574 2061 7272 6179 2e0a 2020 2020 2020  ut array..      
-0000ff60: 2020 2020 2020 4279 2064 6566 6175 6c74        By default
-0000ff70: 2c20 7468 6520 6f75 7470 7574 2061 7272  , the output arr
-0000ff80: 6179 2077 696c 6c20 6861 7665 2075 6e6b  ay will have unk
-0000ff90: 6e6f 776e 2063 6875 6e6b 206c 656e 6774  nown chunk lengt
-0000ffa0: 6873 0a20 2020 2020 2020 2020 2020 2061  hs.            a
-0000ffb0: 6c6f 6e67 2074 6865 2066 6972 7374 2061  long the first a
-0000ffc0: 7869 732c 2077 6869 6368 2063 616e 2063  xis, which can c
-0000ffd0: 6175 7365 2073 6f6d 6520 6c61 7465 7220  ause some later 
-0000ffe0: 6f70 6572 6174 696f 6e73 0a20 2020 2020  operations.     
-0000fff0: 2020 2020 2020 2074 6f20 6661 696c 2e0a         to fail..
-00010000: 0a20 2020 2020 2020 2020 2020 202a 2054  .            * T
-00010010: 7275 6520 3a20 696d 6d65 6469 6174 656c  rue : immediatel
-00010020: 7920 636f 6d70 7574 6520 7468 6520 6c65  y compute the le
-00010030: 6e67 7468 206f 6620 6561 6368 2070 6172  ngth of each par
-00010040: 7469 7469 6f6e 0a20 2020 2020 2020 2020  tition.         
-00010050: 2020 202a 2053 6571 7565 6e63 6520 3a20     * Sequence : 
-00010060: 6120 7365 7175 656e 6365 206f 6620 696e  a sequence of in
-00010070: 7465 6765 7273 2074 6f20 7573 6520 666f  tegers to use fo
-00010080: 7220 7468 6520 6368 756e 6b20 7369 7a65  r the chunk size
-00010090: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-000100a0: 6f6e 2074 6865 2066 6972 7374 2061 7869  on the first axi
-000100b0: 732e 2054 6865 7365 2076 616c 7565 7320  s. These values 
-000100c0: 6172 6520 2a6e 6f74 2a20 7661 6c69 6461  are *not* valida
-000100d0: 7465 6420 666f 720a 2020 2020 2020 2020  ted for.        
-000100e0: 2020 2020 2020 636f 7272 6563 746e 6573        correctnes
-000100f0: 732c 2062 6579 6f6e 6420 656e 7375 7269  s, beyond ensuri
-00010100: 6e67 2074 6861 7420 7468 6520 6e75 6d62  ng that the numb
-00010110: 6572 206f 6620 6974 656d 730a 2020 2020  er of items.    
-00010120: 2020 2020 2020 2020 2020 6d61 7463 6865            matche
-00010130: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
-00010140: 7061 7274 6974 696f 6e73 2e0a 2020 2020  partitions..    
-00010150: 2020 2020 6d65 7461 203a 206f 626a 6563      meta : objec
-00010160: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00010170: 2020 2020 2020 2020 416e 206f 7074 696f          An optio
-00010180: 6e61 6c20 606d 6574 6160 2070 6172 616d  nal `meta` param
-00010190: 6574 6572 2063 616e 2062 6520 7061 7373  eter can be pass
-000101a0: 6564 2066 6f72 2064 6173 6b20 746f 206f  ed for dask to o
-000101b0: 7665 7272 6964 6520 7468 650a 2020 2020  verride the.    
-000101c0: 2020 2020 2020 2020 6465 6661 756c 7420          default 
-000101d0: 6d65 7461 6461 7461 206f 6e20 7468 6520  metadata on the 
-000101e0: 756e 6465 726c 7969 6e67 2064 6173 6b20  underlying dask 
-000101f0: 6172 7261 792e 0a0a 2020 2020 2020 2020  array...        
-00010200: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-00010210: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00010220: 2222 220a 2020 2020 2020 2020 6966 206c  """.        if l
-00010230: 656e 6774 6873 2069 7320 5472 7565 3a0a  engths is True:.
-00010240: 2020 2020 2020 2020 2020 2020 6c65 6e67              leng
-00010250: 7468 7320 3d20 7475 706c 6528 7365 6c66  ths = tuple(self
-00010260: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-00010270: 6c65 6e2c 2065 6e66 6f72 6365 5f6d 6574  len, enforce_met
-00010280: 6164 6174 613d 4661 6c73 6529 2e63 6f6d  adata=False).com
-00010290: 7075 7465 2829 290a 0a20 2020 2020 2020  pute())..       
-000102a0: 2061 7272 203d 2073 656c 662e 7661 6c75   arr = self.valu
-000102b0: 6573 0a0a 2020 2020 2020 2020 6368 756e  es..        chun
-000102c0: 6b73 203d 2073 656c 662e 5f76 616c 6964  ks = self._valid
-000102d0: 6174 655f 6368 756e 6b73 2861 7272 2c20  ate_chunks(arr, 
-000102e0: 6c65 6e67 7468 7329 0a20 2020 2020 2020  lengths).       
-000102f0: 2061 7272 2e5f 6368 756e 6b73 203d 2063   arr._chunks = c
-00010300: 6875 6e6b 730a 0a20 2020 2020 2020 2069  hunks..        i
-00010310: 6620 6d65 7461 2069 7320 6e6f 7420 4e6f  f meta is not No
-00010320: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00010330: 6172 722e 5f6d 6574 6120 3d20 6d65 7461  arr._meta = meta
-00010340: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00010350: 2061 7272 0a0a 2020 2020 6465 6620 746f   arr..    def to
-00010360: 5f68 6466 2873 656c 662c 2070 6174 685f  _hdf(self, path_
-00010370: 6f72 5f62 7566 2c20 6b65 792c 206d 6f64  or_buf, key, mod
-00010380: 653d 2261 222c 2061 7070 656e 643d 4661  e="a", append=Fa
-00010390: 6c73 652c 202a 2a6b 7761 7267 7329 3a0a  lse, **kwargs):.
-000103a0: 2020 2020 2020 2020 2222 2253 6565 2064          """See d
-000103b0: 642e 746f 5f68 6466 2064 6f63 7374 7269  d.to_hdf docstri
-000103c0: 6e67 2066 6f72 206d 6f72 6520 696e 666f  ng for more info
-000103d0: 726d 6174 696f 6e22 2222 0a20 2020 2020  rmation""".     
-000103e0: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-000103f0: 6166 7261 6d65 2e69 6f20 696d 706f 7274  aframe.io import
-00010400: 2074 6f5f 6864 660a 0a20 2020 2020 2020   to_hdf..       
-00010410: 2072 6574 7572 6e20 746f 5f68 6466 2873   return to_hdf(s
-00010420: 656c 662c 2070 6174 685f 6f72 5f62 7566  elf, path_or_buf
-00010430: 2c20 6b65 792c 206d 6f64 652c 2061 7070  , key, mode, app
-00010440: 656e 642c 202a 2a6b 7761 7267 7329 0a0a  end, **kwargs)..
-00010450: 2020 2020 6465 6620 746f 5f63 7376 2873      def to_csv(s
-00010460: 656c 662c 2066 696c 656e 616d 652c 202a  elf, filename, *
-00010470: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00010480: 2020 2222 2253 6565 2064 642e 746f 5f63    """See dd.to_c
-00010490: 7376 2064 6f63 7374 7269 6e67 2066 6f72  sv docstring for
-000104a0: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-000104b0: 6e22 2222 0a20 2020 2020 2020 2066 726f  n""".        fro
-000104c0: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
-000104d0: 2e69 6f20 696d 706f 7274 2074 6f5f 6373  .io import to_cs
-000104e0: 760a 0a20 2020 2020 2020 2072 6574 7572  v..        retur
-000104f0: 6e20 746f 5f63 7376 2873 656c 662c 2066  n to_csv(self, f
-00010500: 696c 656e 616d 652c 202a 2a6b 7761 7267  ilename, **kwarg
-00010510: 7329 0a0a 2020 2020 6465 6620 746f 5f73  s)..    def to_s
-00010520: 716c 280a 2020 2020 2020 2020 7365 6c66  ql(.        self
-00010530: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
-00010540: 7374 722c 0a20 2020 2020 2020 2075 7269  str,.        uri
-00010550: 3a20 7374 722c 0a20 2020 2020 2020 2073  : str,.        s
-00010560: 6368 656d 613d 4e6f 6e65 2c0a 2020 2020  chema=None,.    
-00010570: 2020 2020 6966 5f65 7869 7374 733a 2073      if_exists: s
-00010580: 7472 203d 2022 6661 696c 222c 0a20 2020  tr = "fail",.   
-00010590: 2020 2020 2069 6e64 6578 3a20 626f 6f6c       index: bool
-000105a0: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
-000105b0: 2069 6e64 6578 5f6c 6162 656c 3d4e 6f6e   index_label=Non
-000105c0: 652c 0a20 2020 2020 2020 2063 6875 6e6b  e,.        chunk
-000105d0: 7369 7a65 3d4e 6f6e 652c 0a20 2020 2020  size=None,.     
-000105e0: 2020 2064 7479 7065 3d4e 6f6e 652c 0a20     dtype=None,. 
-000105f0: 2020 2020 2020 206d 6574 686f 643d 4e6f         method=No
-00010600: 6e65 2c0a 2020 2020 2020 2020 636f 6d70  ne,.        comp
-00010610: 7574 653d 5472 7565 2c0a 2020 2020 2020  ute=True,.      
-00010620: 2020 7061 7261 6c6c 656c 3d46 616c 7365    parallel=False
-00010630: 2c0a 2020 2020 2020 2020 656e 6769 6e65  ,.        engine
-00010640: 5f6b 7761 7267 733d 4e6f 6e65 2c0a 2020  _kwargs=None,.  
-00010650: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-00010660: 5365 6520 6464 2e74 6f5f 7371 6c20 646f  See dd.to_sql do
-00010670: 6373 7472 696e 6720 666f 7220 6d6f 7265  cstring for more
-00010680: 2069 6e66 6f72 6d61 7469 6f6e 2222 220a   information""".
-00010690: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-000106a0: 6b2e 6461 7461 6672 616d 652e 696f 2069  k.dataframe.io i
-000106b0: 6d70 6f72 7420 746f 5f73 716c 0a0a 2020  mport to_sql..  
-000106c0: 2020 2020 2020 7265 7475 726e 2074 6f5f        return to_
-000106d0: 7371 6c28 0a20 2020 2020 2020 2020 2020  sql(.           
-000106e0: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-000106f0: 2020 206e 616d 653d 6e61 6d65 2c0a 2020     name=name,.  
-00010700: 2020 2020 2020 2020 2020 7572 693d 7572            uri=ur
-00010710: 692c 0a20 2020 2020 2020 2020 2020 2073  i,.            s
-00010720: 6368 656d 613d 7363 6865 6d61 2c0a 2020  chema=schema,.  
-00010730: 2020 2020 2020 2020 2020 6966 5f65 7869            if_exi
-00010740: 7374 733d 6966 5f65 7869 7374 732c 0a20  sts=if_exists,. 
-00010750: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-00010760: 3d69 6e64 6578 2c0a 2020 2020 2020 2020  =index,.        
-00010770: 2020 2020 696e 6465 785f 6c61 6265 6c3d      index_label=
-00010780: 696e 6465 785f 6c61 6265 6c2c 0a20 2020  index_label,.   
-00010790: 2020 2020 2020 2020 2063 6875 6e6b 7369           chunksi
-000107a0: 7a65 3d63 6875 6e6b 7369 7a65 2c0a 2020  ze=chunksize,.  
-000107b0: 2020 2020 2020 2020 2020 6474 7970 653d            dtype=
-000107c0: 6474 7970 652c 0a20 2020 2020 2020 2020  dtype,.         
-000107d0: 2020 206d 6574 686f 643d 6d65 7468 6f64     method=method
-000107e0: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
-000107f0: 6d70 7574 653d 636f 6d70 7574 652c 0a20  mpute=compute,. 
-00010800: 2020 2020 2020 2020 2020 2070 6172 616c             paral
-00010810: 6c65 6c3d 7061 7261 6c6c 656c 2c0a 2020  lel=parallel,.  
-00010820: 2020 2020 2020 2020 2020 656e 6769 6e65            engine
-00010830: 5f6b 7761 7267 733d 656e 6769 6e65 5f6b  _kwargs=engine_k
-00010840: 7761 7267 732c 0a20 2020 2020 2020 2029  wargs,.        )
-00010850: 0a0a 2020 2020 6465 6620 746f 5f6a 736f  ..    def to_jso
-00010860: 6e28 7365 6c66 2c20 6669 6c65 6e61 6d65  n(self, filename
-00010870: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00010880: 7329 3a0a 2020 2020 2020 2020 2222 2253  s):.        """S
-00010890: 6565 2064 642e 746f 5f6a 736f 6e20 646f  ee dd.to_json do
-000108a0: 6373 7472 696e 6720 666f 7220 6d6f 7265  cstring for more
-000108b0: 2069 6e66 6f72 6d61 7469 6f6e 2222 220a   information""".
-000108c0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-000108d0: 6b2e 6461 7461 6672 616d 652e 696f 2069  k.dataframe.io i
-000108e0: 6d70 6f72 7420 746f 5f6a 736f 6e0a 0a20  mport to_json.. 
-000108f0: 2020 2020 2020 2072 6574 7572 6e20 746f         return to
-00010900: 5f6a 736f 6e28 7365 6c66 2c20 6669 6c65  _json(self, file
-00010910: 6e61 6d65 2c20 2a61 7267 732c 202a 2a6b  name, *args, **k
-00010920: 7761 7267 7329 0a0a 2020 2020 6465 6620  wargs)..    def 
-00010930: 746f 5f64 656c 6179 6564 2873 656c 662c  to_delayed(self,
-00010940: 206f 7074 696d 697a 655f 6772 6170 683d   optimize_graph=
-00010950: 5472 7565 293a 0a20 2020 2020 2020 2022  True):.        "
-00010960: 2222 436f 6e76 6572 7420 696e 746f 2061  ""Convert into a
-00010970: 206c 6973 7420 6f66 2060 6064 6173 6b2e   list of ``dask.
-00010980: 6465 6c61 7965 6460 6020 6f62 6a65 6374  delayed`` object
-00010990: 732c 206f 6e65 2070 6572 2070 6172 7469  s, one per parti
-000109a0: 7469 6f6e 2e0a 0a20 2020 2020 2020 2050  tion...        P
-000109b0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-000109c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-000109d0: 2020 2020 206f 7074 696d 697a 655f 6772       optimize_gr
-000109e0: 6170 6820 3a20 626f 6f6c 2c20 6f70 7469  aph : bool, opti
-000109f0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00010a00: 2049 6620 5472 7565 205b 6465 6661 756c   If True [defaul
-00010a10: 745d 2c20 7468 6520 6772 6170 6820 6973  t], the graph is
-00010a20: 206f 7074 696d 697a 6564 2062 6566 6f72   optimized befor
-00010a30: 6520 636f 6e76 6572 7469 6e67 2069 6e74  e converting int
-00010a40: 6f0a 2020 2020 2020 2020 2020 2020 6060  o.            ``
-00010a50: 6461 736b 2e64 656c 6179 6564 6060 206f  dask.delayed`` o
-00010a60: 626a 6563 7473 2e0a 0a20 2020 2020 2020  bjects...       
-00010a70: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
-00010a80: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00010a90: 2020 203e 3e3e 2070 6172 7469 7469 6f6e     >>> partition
-00010aa0: 7320 3d20 6466 2e74 6f5f 6465 6c61 7965  s = df.to_delaye
-00010ab0: 6428 2920 2023 2064 6f63 7465 7374 3a20  d()  # doctest: 
-00010ac0: 2b53 4b49 500a 0a20 2020 2020 2020 2053  +SKIP..        S
-00010ad0: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
-00010ae0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00010af0: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
-00010b00: 6672 6f6d 5f64 656c 6179 6564 0a20 2020  from_delayed.   
-00010b10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00010b20: 206b 6579 7320 3d20 7365 6c66 2e5f 5f64   keys = self.__d
-00010b30: 6173 6b5f 6b65 7973 5f5f 2829 0a20 2020  ask_keys__().   
-00010b40: 2020 2020 2067 7261 7068 203d 2073 656c       graph = sel
-00010b50: 662e 5f5f 6461 736b 5f67 7261 7068 5f5f  f.__dask_graph__
-00010b60: 2829 0a20 2020 2020 2020 206c 6179 6572  ().        layer
-00010b70: 203d 2073 656c 662e 5f5f 6461 736b 5f6c   = self.__dask_l
-00010b80: 6179 6572 735f 5f28 295b 305d 0a20 2020  ayers__()[0].   
-00010b90: 2020 2020 2069 6620 6f70 7469 6d69 7a65       if optimize
-00010ba0: 5f67 7261 7068 3a0a 2020 2020 2020 2020  _graph:.        
-00010bb0: 2020 2020 6772 6170 6820 3d20 7365 6c66      graph = self
-00010bc0: 2e5f 5f64 6173 6b5f 6f70 7469 6d69 7a65  .__dask_optimize
-00010bd0: 5f5f 2867 7261 7068 2c20 7365 6c66 2e5f  __(graph, self._
-00010be0: 5f64 6173 6b5f 6b65 7973 5f5f 2829 290a  _dask_keys__()).
-00010bf0: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
-00010c00: 7220 3d20 2264 656c 6179 6564 2d22 202b  r = "delayed-" +
-00010c10: 2073 656c 662e 5f6e 616d 650a 2020 2020   self._name.    
-00010c20: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
-00010c30: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-00010c40: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-00010c50: 6c61 7965 722c 2067 7261 7068 2c20 6465  layer, graph, de
-00010c60: 7065 6e64 656e 6369 6573 3d28 2929 0a20  pendencies=()). 
-00010c70: 2020 2020 2020 2072 6574 7572 6e20 5b44         return [D
-00010c80: 656c 6179 6564 286b 2c20 6772 6170 682c  elayed(k, graph,
-00010c90: 206c 6179 6572 3d6c 6179 6572 2920 666f   layer=layer) fo
-00010ca0: 7220 6b20 696e 206b 6579 735d 0a0a 2020  r k in keys]..  
-00010cb0: 2020 6465 6620 746f 5f62 6163 6b65 6e64    def to_backend
-00010cc0: 2873 656c 662c 2062 6163 6b65 6e64 3a20  (self, backend: 
-00010cd0: 7374 7220 7c20 4e6f 6e65 203d 204e 6f6e  str | None = Non
-00010ce0: 652c 202a 2a6b 7761 7267 7329 3a0a 2020  e, **kwargs):.  
-00010cf0: 2020 2020 2020 2222 224d 6f76 6520 746f        """Move to
-00010d00: 2061 206e 6577 2044 6174 6146 7261 6d65   a new DataFrame
-00010d10: 2062 6163 6b65 6e64 0a0a 2020 2020 2020   backend..      
-00010d20: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00010d30: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00010d40: 2020 2020 2020 2020 6261 636b 656e 6420          backend 
-00010d50: 3a20 7374 722c 204f 7074 696f 6e61 6c0a  : str, Optional.
-00010d60: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00010d70: 6e61 6d65 206f 6620 7468 6520 6e65 7720  name of the new 
-00010d80: 6261 636b 656e 6420 746f 206d 6f76 6520  backend to move 
-00010d90: 746f 2e20 5468 6520 6465 6661 756c 740a  to. The default.
-00010da0: 2020 2020 2020 2020 2020 2020 6973 2074              is t
-00010db0: 6865 2063 7572 7265 6e74 2022 6461 7461  he current "data
-00010dc0: 6672 616d 652e 6261 636b 656e 6422 2063  frame.backend" c
-00010dd0: 6f6e 6669 6775 7261 7469 6f6e 2e0a 0a20  onfiguration... 
-00010de0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-00010df0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-00010e00: 2020 2020 2020 2044 6174 6146 7261 6d65         DataFrame
-00010e10: 2c20 5365 7269 6573 206f 7220 496e 6465  , Series or Inde
-00010e20: 780a 2020 2020 2020 2020 2222 220a 2020  x.        """.  
-00010e30: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-00010e40: 6461 7461 6672 616d 652e 696f 2069 6d70  dataframe.io imp
-00010e50: 6f72 7420 746f 5f62 6163 6b65 6e64 0a0a  ort to_backend..
-00010e60: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-00010e70: 6f5f 6261 636b 656e 6428 7365 6c66 2c20  o_backend(self, 
-00010e80: 6261 636b 656e 643d 6261 636b 656e 642c  backend=backend,
-00010e90: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
-00010ea0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
-00010eb0: 2064 6566 205f 6765 745f 756e 6172 795f   def _get_unary_
-00010ec0: 6f70 6572 6174 6f72 2863 6c73 2c20 6f70  operator(cls, op
-00010ed0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00010ee0: 6e20 6c61 6d62 6461 2073 656c 663a 2065  n lambda self: e
-00010ef0: 6c65 6d77 6973 6528 6f70 2c20 7365 6c66  lemwise(op, self
-00010f00: 290a 0a20 2020 2040 636c 6173 736d 6574  )..    @classmet
-00010f10: 686f 640a 2020 2020 6465 6620 5f67 6574  hod.    def _get
-00010f20: 5f62 696e 6172 795f 6f70 6572 6174 6f72  _binary_operator
-00010f30: 2863 6c73 2c20 6f70 2c20 696e 763d 4661  (cls, op, inv=Fa
-00010f40: 6c73 6529 3a0a 2020 2020 2020 2020 6966  lse):.        if
-00010f50: 2069 6e76 3a0a 2020 2020 2020 2020 2020   inv:.          
-00010f60: 2020 7265 7475 726e 206c 616d 6264 6120    return lambda 
-00010f70: 7365 6c66 2c20 6f74 6865 723a 2065 6c65  self, other: ele
-00010f80: 6d77 6973 6528 6f70 2c20 6f74 6865 722c  mwise(op, other,
-00010f90: 2073 656c 6629 0a20 2020 2020 2020 2065   self).        e
-00010fa0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00010fb0: 2072 6574 7572 6e20 6c61 6d62 6461 2073   return lambda s
-00010fc0: 656c 662c 206f 7468 6572 3a20 656c 656d  elf, other: elem
-00010fd0: 7769 7365 286f 702c 2073 656c 662c 206f  wise(op, self, o
-00010fe0: 7468 6572 290a 0a20 2020 2064 6566 2072  ther)..    def r
-00010ff0: 6f6c 6c69 6e67 280a 2020 2020 2020 2020  olling(.        
-00011000: 7365 6c66 2c20 7769 6e64 6f77 2c20 6d69  self, window, mi
-00011010: 6e5f 7065 7269 6f64 733d 4e6f 6e65 2c20  n_periods=None, 
-00011020: 6365 6e74 6572 3d46 616c 7365 2c20 7769  center=False, wi
-00011030: 6e5f 7479 7065 3d4e 6f6e 652c 2061 7869  n_type=None, axi
-00011040: 733d 6e6f 5f64 6566 6175 6c74 0a20 2020  s=no_default.   
-00011050: 2029 3a0a 2020 2020 2020 2020 2222 2250   ):.        """P
-00011060: 726f 7669 6465 7320 726f 6c6c 696e 6720  rovides rolling 
-00011070: 7472 616e 7366 6f72 6d61 7469 6f6e 732e  transformations.
-00011080: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00011090: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-000110a0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000110b0: 7769 6e64 6f77 203a 2069 6e74 2c20 7374  window : int, st
-000110c0: 722c 206f 6666 7365 740a 2020 2020 2020  r, offset.      
-000110d0: 2020 2020 2053 697a 6520 6f66 2074 6865       Size of the
-000110e0: 206d 6f76 696e 6720 7769 6e64 6f77 2e20   moving window. 
-000110f0: 5468 6973 2069 7320 7468 6520 6e75 6d62  This is the numb
-00011100: 6572 206f 6620 6f62 7365 7276 6174 696f  er of observatio
-00011110: 6e73 2075 7365 640a 2020 2020 2020 2020  ns used.        
-00011120: 2020 2066 6f72 2063 616c 6375 6c61 7469     for calculati
-00011130: 6e67 2074 6865 2073 7461 7469 7374 6963  ng the statistic
-00011140: 2e20 5768 656e 206e 6f74 2075 7369 6e67  . When not using
-00011150: 2061 2060 6044 6174 6574 696d 6549 6e64   a ``DatetimeInd
-00011160: 6578 6060 2c0a 2020 2020 2020 2020 2020  ex``,.          
-00011170: 2074 6865 2077 696e 646f 7720 7369 7a65   the window size
-00011180: 206d 7573 7420 6e6f 7420 6265 2073 6f20   must not be so 
-00011190: 6c61 7267 6520 6173 2074 6f20 7370 616e  large as to span
-000111a0: 206d 6f72 6520 7468 616e 206f 6e65 0a20   more than one. 
-000111b0: 2020 2020 2020 2020 2020 6164 6a61 6365            adjace
-000111c0: 6e74 2070 6172 7469 7469 6f6e 2e20 4966  nt partition. If
-000111d0: 2075 7369 6e67 2061 6e20 6f66 6673 6574   using an offset
-000111e0: 206f 7220 6f66 6673 6574 2061 6c69 6173   or offset alias
-000111f0: 206c 696b 6520 2735 4427 2c0a 2020 2020   like '5D',.    
-00011200: 2020 2020 2020 2074 6865 2064 6174 6120         the data 
-00011210: 6d75 7374 2068 6176 6520 6120 6060 4461  must have a ``Da
-00011220: 7465 7469 6d65 496e 6465 7860 600a 0a20  tetimeIndex``.. 
-00011230: 2020 2020 2020 2020 2020 2e2e 2076 6572            .. ver
-00011240: 7369 6f6e 6368 616e 6765 643a 3a20 302e  sionchanged:: 0.
-00011250: 3135 2e30 0a0a 2020 2020 2020 2020 2020  15.0..          
-00011260: 2020 2020 4e6f 7720 6163 6365 7074 7320      Now accepts 
-00011270: 6f66 6673 6574 7320 616e 6420 7374 7269  offsets and stri
-00011280: 6e67 206f 6666 7365 7420 616c 6961 7365  ng offset aliase
-00011290: 730a 0a20 2020 2020 2020 206d 696e 5f70  s..        min_p
-000112a0: 6572 696f 6473 203a 2069 6e74 2c20 6465  eriods : int, de
-000112b0: 6661 756c 7420 4e6f 6e65 0a20 2020 2020  fault None.     
-000112c0: 2020 2020 2020 204d 696e 696d 756d 206e         Minimum n
-000112d0: 756d 6265 7220 6f66 206f 6273 6572 7661  umber of observa
-000112e0: 7469 6f6e 7320 696e 2077 696e 646f 7720  tions in window 
-000112f0: 7265 7175 6972 6564 2074 6f20 6861 7665  required to have
-00011300: 2061 2076 616c 7565 0a20 2020 2020 2020   a value.       
-00011310: 2020 2020 2028 6f74 6865 7277 6973 6520       (otherwise 
-00011320: 7265 7375 6c74 2069 7320 4e41 292e 0a20  result is NA).. 
-00011330: 2020 2020 2020 2063 656e 7465 7220 3a20         center : 
-00011340: 626f 6f6c 6561 6e2c 2064 6566 6175 6c74  boolean, default
-00011350: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-00011360: 2020 2053 6574 2074 6865 206c 6162 656c     Set the label
-00011370: 7320 6174 2074 6865 2063 656e 7465 7220  s at the center 
-00011380: 6f66 2074 6865 2077 696e 646f 772e 0a20  of the window.. 
-00011390: 2020 2020 2020 2077 696e 5f74 7970 6520         win_type 
-000113a0: 3a20 7374 7269 6e67 2c20 6465 6661 756c  : string, defaul
-000113b0: 7420 4e6f 6e65 0a20 2020 2020 2020 2020  t None.         
-000113c0: 2020 2050 726f 7669 6465 2061 2077 696e     Provide a win
-000113d0: 646f 7720 7479 7065 2e20 5468 6520 7265  dow type. The re
-000113e0: 636f 676e 697a 6564 2077 696e 646f 7720  cognized window 
-000113f0: 7479 7065 7320 6172 6520 6964 656e 7469  types are identi
-00011400: 6361 6c0a 2020 2020 2020 2020 2020 2020  cal.            
-00011410: 746f 2070 616e 6461 732e 0a20 2020 2020  to pandas..     
-00011420: 2020 2061 7869 7320 3a20 696e 742c 2073     axis : int, s
-00011430: 7472 2c20 4e6f 6e65 2c20 6465 6661 756c  tr, None, defaul
-00011440: 7420 300a 2020 2020 2020 2020 2020 2020  t 0.            
-00011450: 5468 6973 2070 6172 616d 6574 6572 2069  This parameter i
-00011460: 7320 6465 7072 6563 6174 6564 2077 6974  s deprecated wit
-00011470: 6820 6060 7061 6e64 6173 3e3d 322e 3160  h ``pandas>=2.1`
-00011480: 602e 0a0a 2020 2020 2020 2020 5265 7475  `...        Retu
-00011490: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-000114a0: 2d2d 2d0a 2020 2020 2020 2020 6120 526f  ---.        a Ro
-000114b0: 6c6c 696e 6720 6f62 6a65 6374 206f 6e20  lling object on 
-000114c0: 7768 6963 6820 746f 2063 616c 6c20 6120  which to call a 
-000114d0: 6d65 7468 6f64 2074 6f20 636f 6d70 7574  method to comput
-000114e0: 6520 6120 7374 6174 6973 7469 630a 2020  e a statistic.  
-000114f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00011500: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
-00011510: 6672 616d 652e 726f 6c6c 696e 6720 696d  frame.rolling im
-00011520: 706f 7274 2052 6f6c 6c69 6e67 0a0a 2020  port Rolling..  
-00011530: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00011540: 6e63 6528 7769 6e64 6f77 2c20 496e 7465  nce(window, Inte
-00011550: 6772 616c 293a 0a20 2020 2020 2020 2020  gral):.         
-00011560: 2020 2069 6620 7769 6e64 6f77 203c 2030     if window < 0
-00011570: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00011580: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00011590: 6f72 2822 7769 6e64 6f77 206d 7573 7420  or("window must 
-000115a0: 6265 203e 3d20 3022 290a 0a20 2020 2020  be >= 0")..     
-000115b0: 2020 2069 6620 6d69 6e5f 7065 7269 6f64     if min_period
-000115c0: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
-000115d0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-000115e0: 7420 6973 696e 7374 616e 6365 286d 696e  t isinstance(min
-000115f0: 5f70 6572 696f 6473 2c20 496e 7465 6772  _periods, Integr
-00011600: 616c 293a 0a20 2020 2020 2020 2020 2020  al):.           
-00011610: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00011620: 4572 726f 7228 226d 696e 5f70 6572 696f  Error("min_perio
-00011630: 6473 206d 7573 7420 6265 2061 6e20 696e  ds must be an in
-00011640: 7465 6765 7222 290a 2020 2020 2020 2020  teger").        
-00011650: 2020 2020 6966 206d 696e 5f70 6572 696f      if min_perio
-00011660: 6473 203c 2030 3a0a 2020 2020 2020 2020  ds < 0:.        
-00011670: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00011680: 6c75 6545 7272 6f72 2822 6d69 6e5f 7065  lueError("min_pe
-00011690: 7269 6f64 7320 6d75 7374 2062 6520 3e3d  riods must be >=
-000116a0: 2030 2229 0a0a 2020 2020 2020 2020 7265   0")..        re
-000116b0: 7475 726e 2052 6f6c 6c69 6e67 280a 2020  turn Rolling(.  
-000116c0: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-000116d0: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
-000116e0: 6f77 3d77 696e 646f 772c 0a20 2020 2020  ow=window,.     
-000116f0: 2020 2020 2020 206d 696e 5f70 6572 696f         min_perio
-00011700: 6473 3d6d 696e 5f70 6572 696f 6473 2c0a  ds=min_periods,.
-00011710: 2020 2020 2020 2020 2020 2020 6365 6e74              cent
-00011720: 6572 3d63 656e 7465 722c 0a20 2020 2020  er=center,.     
-00011730: 2020 2020 2020 2077 696e 5f74 7970 653d         win_type=
-00011740: 7769 6e5f 7479 7065 2c0a 2020 2020 2020  win_type,.      
-00011750: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
-00011760: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00011770: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00011780: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-00011790: 6465 6620 6469 6666 2873 656c 662c 2070  def diff(self, p
-000117a0: 6572 696f 6473 3d31 2c20 6178 6973 3d30  eriods=1, axis=0
-000117b0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-000117c0: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
-000117d0: 0a0a 2020 2020 2020 2020 2020 2050 616e  ..           Pan
-000117e0: 6461 7320 6375 7272 656e 746c 7920 7573  das currently us
-000117f0: 6573 2061 6e20 6060 6f62 6a65 6374 6060  es an ``object``
-00011800: 2d64 7479 7065 2063 6f6c 756d 6e20 746f  -dtype column to
-00011810: 2072 6570 7265 7365 6e74 0a20 2020 2020   represent.     
-00011820: 2020 2020 2020 626f 6f6c 6561 6e20 6461        boolean da
-00011830: 7461 2077 6974 6820 6d69 7373 696e 6720  ta with missing 
-00011840: 7661 6c75 6573 2e20 5468 6973 2063 616e  values. This can
-00011850: 2063 6175 7365 2069 7373 7565 7320 666f   cause issues fo
-00011860: 720a 2020 2020 2020 2020 2020 2062 6f6f  r.           boo
-00011870: 6c65 616e 2d73 7065 6369 6669 6320 6f70  lean-specific op
-00011880: 6572 6174 696f 6e73 2c20 6c69 6b65 2060  erations, like `
-00011890: 607c 6060 2e20 546f 2065 6e61 626c 6520  `|``. To enable 
-000118a0: 626f 6f6c 6561 6e2d 0a20 2020 2020 2020  boolean-.       
-000118b0: 2020 2020 7370 6563 6966 6963 206f 7065      specific ope
-000118c0: 7261 7469 6f6e 732c 2061 7420 7468 6520  rations, at the 
-000118d0: 636f 7374 206f 6620 6d65 7461 6461 7461  cost of metadata
-000118e0: 2074 6861 7420 646f 6573 6e27 7420 6d61   that doesn't ma
-000118f0: 7463 680a 2020 2020 2020 2020 2020 2070  tch.           p
-00011900: 616e 6461 732c 2075 7365 2060 602e 6173  andas, use ``.as
-00011910: 7479 7065 2862 6f6f 6c29 6060 2061 6674  type(bool)`` aft
-00011920: 6572 2074 6865 2060 6073 6869 6674 6060  er the ``shift``
-00011930: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00011940: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
-00011950: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
-00011960: 2861 7869 7329 0a20 2020 2020 2020 2069  (axis).        i
-00011970: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-00011980: 2870 6572 696f 6473 2c20 496e 7465 6772  (periods, Integr
-00011990: 616c 293a 0a20 2020 2020 2020 2020 2020  al):.           
-000119a0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-000119b0: 2822 7065 7269 6f64 7320 6d75 7374 2062  ("periods must b
-000119c0: 6520 616e 2069 6e74 6567 6572 2229 0a0a  e an integer")..
-000119d0: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-000119e0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-000119f0: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-00011a00: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-00011a10: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
-00011a20: 6469 6666 2c20 746f 6b65 6e3d 2264 6966  diff, token="dif
-00011a30: 6622 2c20 7065 7269 6f64 733d 7065 7269  f", periods=peri
-00011a40: 6f64 732c 2061 7869 733d 312c 2065 6e66  ods, axis=1, enf
-00011a50: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-00011a60: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00011a70: 290a 0a20 2020 2020 2020 2062 6566 6f72  )..        befor
-00011a80: 652c 2061 6674 6572 203d 2028 7065 7269  e, after = (peri
-00011a90: 6f64 732c 2030 2920 6966 2070 6572 696f  ods, 0) if perio
-00011aa0: 6473 203e 2030 2065 6c73 6520 2830 2c20  ds > 0 else (0, 
-00011ab0: 2d70 6572 696f 6473 290a 2020 2020 2020  -periods).      
-00011ac0: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-00011ad0: 705f 6f76 6572 6c61 7028 4d2e 6469 6666  p_overlap(M.diff
-00011ae0: 2c20 6265 666f 7265 2c20 6166 7465 722c  , before, after,
-00011af0: 2074 6f6b 656e 3d22 6469 6666 222c 2070   token="diff", p
-00011b00: 6572 696f 6473 3d70 6572 696f 6473 290a  eriods=periods).
-00011b10: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00011b20: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-00011b30: 0a20 2020 2064 6566 2073 6869 6674 2873  .    def shift(s
-00011b40: 656c 662c 2070 6572 696f 6473 3d31 2c20  elf, periods=1, 
-00011b50: 6672 6571 3d4e 6f6e 652c 2061 7869 733d  freq=None, axis=
-00011b60: 3029 3a0a 2020 2020 2020 2020 6178 6973  0):.        axis
-00011b70: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
-00011b80: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
-00011b90: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00011ba0: 7374 616e 6365 2870 6572 696f 6473 2c20  stance(periods, 
-00011bb0: 496e 7465 6772 616c 293a 0a20 2020 2020  Integral):.     
-00011bc0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00011bd0: 6545 7272 6f72 2822 7065 7269 6f64 7320  eError("periods 
-00011be0: 6d75 7374 2062 6520 616e 2069 6e74 6567  must be an integ
-00011bf0: 6572 2229 0a0a 2020 2020 2020 2020 6966  er")..        if
-00011c00: 2061 7869 7320 3d3d 2031 3a0a 2020 2020   axis == 1:.    
-00011c10: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00011c20: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-00011c30: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-00011c40: 2020 2020 4d2e 7368 6966 742c 0a20 2020      M.shift,.   
-00011c50: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
-00011c60: 656e 3d22 7368 6966 7422 2c0a 2020 2020  en="shift",.    
-00011c70: 2020 2020 2020 2020 2020 2020 7065 7269              peri
-00011c80: 6f64 733d 7065 7269 6f64 732c 0a20 2020  ods=periods,.   
-00011c90: 2020 2020 2020 2020 2020 2020 2066 7265               fre
-00011ca0: 713d 6672 6571 2c0a 2020 2020 2020 2020  q=freq,.        
-00011cb0: 2020 2020 2020 2020 6178 6973 3d31 2c0a          axis=1,.
-00011cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011cd0: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-00011ce0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00011cf0: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-00011d00: 6620 6672 6571 2069 7320 4e6f 6e65 3a0a  f freq is None:.
-00011d10: 2020 2020 2020 2020 2020 2020 6265 666f              befo
-00011d20: 7265 2c20 6166 7465 7220 3d20 2870 6572  re, after = (per
-00011d30: 696f 6473 2c20 3029 2069 6620 7065 7269  iods, 0) if peri
-00011d40: 6f64 7320 3e20 3020 656c 7365 2028 302c  ods > 0 else (0,
-00011d50: 202d 7065 7269 6f64 7329 0a20 2020 2020   -periods).     
-00011d60: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00011d70: 6c66 2e6d 6170 5f6f 7665 726c 6170 280a  lf.map_overlap(.
-00011d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d90: 4d2e 7368 6966 742c 2062 6566 6f72 652c  M.shift, before,
-00011da0: 2061 6674 6572 2c20 746f 6b65 6e3d 2273   after, token="s
-00011db0: 6869 6674 222c 2070 6572 696f 6473 3d70  hift", periods=p
-00011dc0: 6572 696f 6473 0a20 2020 2020 2020 2020  eriods.         
-00011dd0: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-00011de0: 4c65 7420 7061 6e64 6173 2065 7272 6f72  Let pandas error
-00011df0: 206f 6e20 696e 7661 6c69 6420 6172 6775   on invalid argu
-00011e00: 6d65 6e74 730a 2020 2020 2020 2020 6d65  ments.        me
-00011e10: 7461 203d 2073 656c 662e 5f6d 6574 615f  ta = self._meta_
-00011e20: 6e6f 6e65 6d70 7479 2e73 6869 6674 2870  nonempty.shift(p
-00011e30: 6572 696f 6473 2c20 6672 6571 3d66 7265  eriods, freq=fre
-00011e40: 7129 0a20 2020 2020 2020 206f 7574 203d  q).        out =
-00011e50: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-00011e60: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
-00011e70: 2020 4d2e 7368 6966 742c 0a20 2020 2020    M.shift,.     
-00011e80: 2020 2020 2020 2074 6f6b 656e 3d22 7368         token="sh
-00011e90: 6966 7422 2c0a 2020 2020 2020 2020 2020  ift",.          
-00011ea0: 2020 7065 7269 6f64 733d 7065 7269 6f64    periods=period
-00011eb0: 732c 0a20 2020 2020 2020 2020 2020 2066  s,.            f
-00011ec0: 7265 713d 6672 6571 2c0a 2020 2020 2020  req=freq,.      
-00011ed0: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
-00011ee0: 0a20 2020 2020 2020 2020 2020 2065 6e66  .            enf
-00011ef0: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-00011f00: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00011f10: 2074 7261 6e73 666f 726d 5f64 6976 6973   transform_divis
-00011f20: 696f 6e73 3d46 616c 7365 2c0a 2020 2020  ions=False,.    
-00011f30: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-00011f40: 7475 726e 206d 6179 6265 5f73 6869 6674  turn maybe_shift
-00011f50: 5f64 6976 6973 696f 6e73 286f 7574 2c20  _divisions(out, 
-00011f60: 7065 7269 6f64 732c 2066 7265 713d 6672  periods, freq=fr
-00011f70: 6571 290a 0a20 2020 2064 6566 205f 7265  eq)..    def _re
-00011f80: 6475 6374 696f 6e5f 6167 6728 0a20 2020  duction_agg(.   
-00011f90: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00011fa0: 2020 206e 616d 652c 0a20 2020 2020 2020     name,.       
-00011fb0: 2061 7869 733d 4e6f 6e65 2c0a 2020 2020   axis=None,.    
-00011fc0: 2020 2020 736b 6970 6e61 3d54 7275 652c      skipna=True,
-00011fd0: 0a20 2020 2020 2020 2073 706c 6974 5f65  .        split_e
-00011fe0: 7665 7279 3d46 616c 7365 2c0a 2020 2020  very=False,.    
-00011ff0: 2020 2020 6f75 743d 4e6f 6e65 2c0a 2020      out=None,.  
-00012000: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
-00012010: 6c79 3d4e 6f6e 652c 0a20 2020 2020 2020  ly=None,.       
-00012020: 206e 6f6e 655f 6973 5f7a 6572 6f3d 5472   none_is_zero=Tr
-00012030: 7565 2c0a 2020 2020 293a 0a20 2020 2020  ue,.    ):.     
-00012040: 2020 2061 7869 7320 3d20 7365 6c66 2e5f     axis = self._
-00012050: 7661 6c69 6461 7465 5f61 7869 7328 6178  validate_axis(ax
-00012060: 6973 2c20 6e6f 6e65 5f69 735f 7a65 726f  is, none_is_zero
-00012070: 3d6e 6f6e 655f 6973 5f7a 6572 6f29 0a0a  =none_is_zero)..
-00012080: 2020 2020 2020 2020 6966 2068 6173 5f6b          if has_k
-00012090: 6579 776f 7264 2867 6574 6174 7472 2873  eyword(getattr(s
-000120a0: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
-000120b0: 7479 2c20 6e61 6d65 292c 2022 6e75 6d65  ty, name), "nume
-000120c0: 7269 635f 6f6e 6c79 2229 3a0a 2020 2020  ric_only"):.    
-000120d0: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
-000120e0: 6f6e 6c79 5f6b 7761 7267 7320 3d20 7b22  only_kwargs = {"
-000120f0: 6e75 6d65 7269 635f 6f6e 6c79 223a 206e  numeric_only": n
-00012100: 756d 6572 6963 5f6f 6e6c 797d 0a20 2020  umeric_only}.   
-00012110: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00012120: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
-00012130: 6e6c 795f 6b77 6172 6773 203d 207b 7d0a  nly_kwargs = {}.
-00012140: 0a20 2020 2020 2020 2077 6974 6820 6368  .        with ch
-00012150: 6563 6b5f 6e75 6d65 7269 635f 6f6e 6c79  eck_numeric_only
-00012160: 5f64 6570 7265 6361 7469 6f6e 2829 3a0a  _deprecation():.
-00012170: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00012180: 203d 2067 6574 6174 7472 2873 656c 662e   = getattr(self.
-00012190: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2c20  _meta_nonempty, 
-000121a0: 6e61 6d65 2928 0a20 2020 2020 2020 2020  name)(.         
-000121b0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
-000121c0: 2c20 736b 6970 6e61 3d73 6b69 706e 612c  , skipna=skipna,
-000121d0: 202a 2a6e 756d 6572 6963 5f6f 6e6c 795f   **numeric_only_
-000121e0: 6b77 6172 6773 0a20 2020 2020 2020 2020  kwargs.         
-000121f0: 2020 2029 0a0a 2020 2020 2020 2020 746f     )..        to
-00012200: 6b65 6e20 3d20 7365 6c66 2e5f 746f 6b65  ken = self._toke
-00012210: 6e5f 7072 6566 6978 202b 206e 616d 650a  n_prefix + name.
-00012220: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-00012230: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-00012240: 2020 7265 7375 6c74 203d 2073 656c 662e    result = self.
-00012250: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
-00012260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012270: 5f67 6574 6174 7472 5f6e 756d 6572 6963  _getattr_numeric
-00012280: 5f6f 6e6c 792c 0a20 2020 2020 2020 2020  _only,.         
-00012290: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
-000122a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000122b0: 2020 746f 6b65 6e3d 746f 6b65 6e2c 0a20    token=token,. 
-000122c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000122d0: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
-000122e0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-000122f0: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
-00012300: 2020 2020 2020 2020 205f 6461 736b 5f6d           _dask_m
-00012310: 6574 686f 645f 6e61 6d65 3d6e 616d 652c  ethod_name=name,
-00012320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012330: 202a 2a6e 756d 6572 6963 5f6f 6e6c 795f   **numeric_only_
-00012340: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-00012350: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00012360: 2020 7265 7475 726e 2068 616e 646c 655f    return handle_
-00012370: 6f75 7428 6f75 742c 2072 6573 756c 7429  out(out, result)
-00012380: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00012390: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-000123a0: 7420 3d20 7365 6c66 2e72 6564 7563 7469  t = self.reducti
-000123b0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-000123c0: 2020 2020 5f67 6574 6174 7472 5f6e 756d      _getattr_num
-000123d0: 6572 6963 5f6f 6e6c 792c 0a20 2020 2020  eric_only,.     
-000123e0: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
-000123f0: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-00012400: 2020 2020 2020 746f 6b65 6e3d 746f 6b65        token=toke
-00012410: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-00012420: 2020 2073 6b69 706e 613d 736b 6970 6e61     skipna=skipna
-00012430: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00012440: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
-00012450: 2020 2020 2020 2020 2020 2020 2073 706c               spl
-00012460: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-00012470: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
-00012480: 2020 2020 2020 5f64 6173 6b5f 6d65 7468        _dask_meth
-00012490: 6f64 5f6e 616d 653d 6e61 6d65 2c0a 2020  od_name=name,.  
-000124a0: 2020 2020 2020 2020 2020 2020 2020 2a2a                **
-000124b0: 6e75 6d65 7269 635f 6f6e 6c79 5f6b 7761  numeric_only_kwa
-000124c0: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-000124d0: 2029 0a20 2020 2020 2020 2020 2020 2069   ).            i
-000124e0: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
-000124f0: 662c 2044 6174 6146 7261 6d65 2920 616e  f, DataFrame) an
-00012500: 6420 6973 696e 7374 616e 6365 2872 6573  d isinstance(res
-00012510: 756c 742c 2053 6572 6965 7329 3a0a 2020  ult, Series):.  
-00012520: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00012530: 7375 6c74 2e64 6976 6973 696f 6e73 203d  sult.divisions =
-00012540: 2028 7365 6c66 2e63 6f6c 756d 6e73 2e6d   (self.columns.m
-00012550: 696e 2829 2c20 7365 6c66 2e63 6f6c 756d  in(), self.colum
-00012560: 6e73 2e6d 6178 2829 290a 2020 2020 2020  ns.max()).      
-00012570: 2020 2020 2020 7265 7475 726e 2068 616e        return han
-00012580: 646c 655f 6f75 7428 6f75 742c 2072 6573  dle_out(out, res
-00012590: 756c 7429 0a0a 2020 2020 4064 6572 6976  ult)..    @deriv
-000125a0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-000125b0: 7261 6d65 290a 2020 2020 6465 6620 6164  rame).    def ad
-000125c0: 645f 7072 6566 6978 2873 656c 662c 2070  d_prefix(self, p
-000125d0: 7265 6669 7829 3a0a 2020 2020 2020 2020  refix):.        
-000125e0: 7265 7320 3d20 7365 6c66 2e6d 6170 5f70  res = self.map_p
-000125f0: 6172 7469 7469 6f6e 7328 4d2e 6164 645f  artitions(M.add_
-00012600: 7072 6566 6978 2c20 7072 6566 6978 290a  prefix, prefix).
-00012610: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00012620: 6b6e 6f77 6e5f 6469 7669 7369 6f6e 7320  known_divisions 
-00012630: 616e 6420 6973 5f73 6572 6965 735f 6c69  and is_series_li
-00012640: 6b65 2873 656c 6629 3a0a 2020 2020 2020  ke(self):.      
-00012650: 2020 2020 2020 7265 732e 6469 7669 7369        res.divisi
-00012660: 6f6e 7320 3d20 7475 706c 6528 7072 6566  ons = tuple(pref
-00012670: 6978 202b 2073 7472 2864 6976 6973 696f  ix + str(divisio
-00012680: 6e29 2066 6f72 2064 6976 6973 696f 6e20  n) for division 
-00012690: 696e 2073 656c 662e 6469 7669 7369 6f6e  in self.division
-000126a0: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
-000126b0: 6e20 7265 730a 0a20 2020 2040 6465 7269  n res..    @deri
-000126c0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-000126d0: 4672 616d 6529 0a20 2020 2064 6566 2061  Frame).    def a
-000126e0: 6464 5f73 7566 6669 7828 7365 6c66 2c20  dd_suffix(self, 
-000126f0: 7375 6666 6978 293a 0a20 2020 2020 2020  suffix):.       
-00012700: 2072 6573 203d 2073 656c 662e 6d61 705f   res = self.map_
-00012710: 7061 7274 6974 696f 6e73 284d 2e61 6464  partitions(M.add
-00012720: 5f73 7566 6669 782c 2073 7566 6669 7829  _suffix, suffix)
-00012730: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00012740: 2e6b 6e6f 776e 5f64 6976 6973 696f 6e73  .known_divisions
-00012750: 2061 6e64 2069 735f 7365 7269 6573 5f6c   and is_series_l
-00012760: 696b 6528 7365 6c66 293a 0a20 2020 2020  ike(self):.     
-00012770: 2020 2020 2020 2072 6573 2e64 6976 6973         res.divis
-00012780: 696f 6e73 203d 2074 7570 6c65 2873 7472  ions = tuple(str
-00012790: 2864 6976 6973 696f 6e29 202b 2073 7566  (division) + suf
-000127a0: 6669 7820 666f 7220 6469 7669 7369 6f6e  fix for division
-000127b0: 2069 6e20 7365 6c66 2e64 6976 6973 696f   in self.divisio
-000127c0: 6e73 290a 2020 2020 2020 2020 7265 7475  ns).        retu
-000127d0: 726e 2072 6573 0a0a 2020 2020 4064 6572  rn res..    @der
-000127e0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-000127f0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00012800: 6162 7328 7365 6c66 293a 0a20 2020 2020  abs(self):.     
-00012810: 2020 205f 7261 6973 655f 6966 5f6f 626a     _raise_if_obj
-00012820: 6563 745f 7365 7269 6573 2873 656c 662c  ect_series(self,
-00012830: 2022 6162 7322 290a 2020 2020 2020 2020   "abs").        
-00012840: 6d65 7461 203d 2073 656c 662e 5f6d 6574  meta = self._met
-00012850: 615f 6e6f 6e65 6d70 7479 2e61 6273 2829  a_nonempty.abs()
-00012860: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00012870: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-00012880: 6f6e 7328 4d2e 6162 732c 206d 6574 613d  ons(M.abs, meta=
-00012890: 6d65 7461 2c20 656e 666f 7263 655f 6d65  meta, enforce_me
-000128a0: 7461 6461 7461 3d46 616c 7365 290a 0a20  tadata=False).. 
-000128b0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-000128c0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-000128d0: 2020 2064 6566 2061 6c6c 2873 656c 662c     def all(self,
-000128e0: 2061 7869 733d 4e6f 6e65 2c20 736b 6970   axis=None, skip
-000128f0: 6e61 3d54 7275 652c 2073 706c 6974 5f65  na=True, split_e
-00012900: 7665 7279 3d46 616c 7365 2c20 6f75 743d  very=False, out=
-00012910: 4e6f 6e65 293a 0a20 2020 2020 2020 2072  None):.        r
-00012920: 6574 7572 6e20 7365 6c66 2e5f 7265 6475  eturn self._redu
-00012930: 6374 696f 6e5f 6167 6728 0a20 2020 2020  ction_agg(.     
-00012940: 2020 2020 2020 2022 616c 6c22 2c20 6178         "all", ax
-00012950: 6973 3d61 7869 732c 2073 6b69 706e 613d  is=axis, skipna=
-00012960: 736b 6970 6e61 2c20 7370 6c69 745f 6576  skipna, split_ev
-00012970: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
-00012980: 206f 7574 3d6f 7574 0a20 2020 2020 2020   out=out.       
-00012990: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
-000129a0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-000129b0: 6d65 290a 2020 2020 6465 6620 616e 7928  me).    def any(
-000129c0: 7365 6c66 2c20 6178 6973 3d4e 6f6e 652c  self, axis=None,
-000129d0: 2073 6b69 706e 613d 5472 7565 2c20 7370   skipna=True, sp
-000129e0: 6c69 745f 6576 6572 793d 4661 6c73 652c  lit_every=False,
-000129f0: 206f 7574 3d4e 6f6e 6529 3a0a 2020 2020   out=None):.    
-00012a00: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00012a10: 5f72 6564 7563 7469 6f6e 5f61 6767 280a  _reduction_agg(.
-00012a20: 2020 2020 2020 2020 2020 2020 2261 6e79              "any
-00012a30: 222c 2061 7869 733d 6178 6973 2c20 736b  ", axis=axis, sk
-00012a40: 6970 6e61 3d73 6b69 706e 612c 2073 706c  ipna=skipna, spl
-00012a50: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-00012a60: 7665 7279 2c20 6f75 743d 6f75 740a 2020  very, out=out.  
-00012a70: 2020 2020 2020 290a 0a20 2020 2040 5f6e        )..    @_n
-00012a80: 756d 6572 6963 5f6f 6e6c 790a 2020 2020  umeric_only.    
-00012a90: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00012aa0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-00012ab0: 6465 6620 7375 6d28 0a20 2020 2020 2020  def sum(.       
-00012ac0: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
-00012ad0: 7869 733d 4e6f 6e65 2c0a 2020 2020 2020  xis=None,.      
-00012ae0: 2020 736b 6970 6e61 3d54 7275 652c 0a20    skipna=True,. 
-00012af0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-00012b00: 7279 3d46 616c 7365 2c0a 2020 2020 2020  ry=False,.      
-00012b10: 2020 6474 7970 653d 4e6f 6e65 2c0a 2020    dtype=None,.  
-00012b20: 2020 2020 2020 6f75 743d 4e6f 6e65 2c0a        out=None,.
-00012b30: 2020 2020 2020 2020 6d69 6e5f 636f 756e          min_coun
-00012b40: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
-00012b50: 6e75 6d65 7269 635f 6f6e 6c79 3d4e 6f6e  numeric_only=Non
-00012b60: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00012b70: 2020 7265 7375 6c74 203d 2073 656c 662e    result = self.
-00012b80: 5f72 6564 7563 7469 6f6e 5f61 6767 280a  _reduction_agg(.
-00012b90: 2020 2020 2020 2020 2020 2020 2273 756d              "sum
-00012ba0: 222c 2061 7869 733d 6178 6973 2c20 736b  ", axis=axis, sk
-00012bb0: 6970 6e61 3d73 6b69 706e 612c 2073 706c  ipna=skipna, spl
-00012bc0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-00012bd0: 7665 7279 2c20 6f75 743d 6f75 740a 2020  very, out=out.  
-00012be0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00012bf0: 6966 206d 696e 5f63 6f75 6e74 3a0a 2020  if min_count:.  
-00012c00: 2020 2020 2020 2020 2020 636f 6e64 203d            cond =
-00012c10: 2073 656c 662e 6e6f 746e 756c 6c28 292e   self.notnull().
-00012c20: 7375 6d28 6178 6973 3d61 7869 7329 203e  sum(axis=axis) >
-00012c30: 3d20 6d69 6e5f 636f 756e 740a 2020 2020  = min_count.    
-00012c40: 2020 2020 2020 2020 6966 2069 735f 7365          if is_se
-00012c50: 7269 6573 5f6c 696b 6528 636f 6e64 293a  ries_like(cond):
-00012c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012c70: 2072 6574 7572 6e20 7265 7375 6c74 2e77   return result.w
-00012c80: 6865 7265 2863 6f6e 642c 206f 7468 6572  here(cond, other
-00012c90: 3d6e 702e 4e61 4e29 0a20 2020 2020 2020  =np.NaN).       
-00012ca0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00012cb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00012cc0: 6e20 5f73 6361 6c61 725f 6269 6e61 7279  n _scalar_binary
-00012cd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00012ce0: 2020 2020 2020 6c61 6d62 6461 2078 2c20        lambda x, 
-00012cf0: 793a 2072 6573 756c 7420 6966 2078 2069  y: result if x i
-00012d00: 7320 7920 656c 7365 206e 702e 4e61 4e2c  s y else np.NaN,
-00012d10: 2063 6f6e 642c 2054 7275 650a 2020 2020   cond, True.    
-00012d20: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00012d30: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00012d40: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00012d50: 6573 756c 740a 0a20 2020 2040 5f6e 756d  esult..    @_num
-00012d60: 6572 6963 5f6f 6e6c 790a 2020 2020 4064  eric_only.    @d
-00012d70: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00012d80: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00012d90: 6620 7072 6f64 280a 2020 2020 2020 2020  f prod(.        
-00012da0: 7365 6c66 2c0a 2020 2020 2020 2020 6178  self,.        ax
-00012db0: 6973 3d4e 6f6e 652c 0a20 2020 2020 2020  is=None,.       
-00012dc0: 2073 6b69 706e 613d 5472 7565 2c0a 2020   skipna=True,.  
-00012dd0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-00012de0: 793d 4661 6c73 652c 0a20 2020 2020 2020  y=False,.       
-00012df0: 2064 7479 7065 3d4e 6f6e 652c 0a20 2020   dtype=None,.   
-00012e00: 2020 2020 206f 7574 3d4e 6f6e 652c 0a20       out=None,. 
-00012e10: 2020 2020 2020 206d 696e 5f63 6f75 6e74         min_count
-00012e20: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
-00012e30: 756d 6572 6963 5f6f 6e6c 793d 4e6f 6e65  umeric_only=None
-00012e40: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00012e50: 2072 6573 756c 7420 3d20 7365 6c66 2e5f   result = self._
-00012e60: 7265 6475 6374 696f 6e5f 6167 6728 0a20  reduction_agg(. 
-00012e70: 2020 2020 2020 2020 2020 2022 7072 6f64             "prod
-00012e80: 222c 0a20 2020 2020 2020 2020 2020 2061  ",.            a
-00012e90: 7869 733d 6178 6973 2c0a 2020 2020 2020  xis=axis,.      
-00012ea0: 2020 2020 2020 736b 6970 6e61 3d73 6b69        skipna=ski
-00012eb0: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
-00012ec0: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-00012ed0: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
-00012ee0: 2020 2020 2020 6f75 743d 6f75 742c 0a20        out=out,. 
-00012ef0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00012f00: 2069 6620 6d69 6e5f 636f 756e 743a 0a20   if min_count:. 
-00012f10: 2020 2020 2020 2020 2020 2063 6f6e 6420             cond 
-00012f20: 3d20 7365 6c66 2e6e 6f74 6e75 6c6c 2829  = self.notnull()
-00012f30: 2e73 756d 2861 7869 733d 6178 6973 2920  .sum(axis=axis) 
-00012f40: 3e3d 206d 696e 5f63 6f75 6e74 0a20 2020  >= min_count.   
-00012f50: 2020 2020 2020 2020 2069 6620 6973 5f73           if is_s
-00012f60: 6572 6965 735f 6c69 6b65 2863 6f6e 6429  eries_like(cond)
-00012f70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00012f80: 2020 7265 7475 726e 2072 6573 756c 742e    return result.
-00012f90: 7768 6572 6528 636f 6e64 2c20 6f74 6865  where(cond, othe
-00012fa0: 723d 6e70 2e4e 614e 290a 2020 2020 2020  r=np.NaN).      
-00012fb0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00012fc0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00012fd0: 726e 205f 7363 616c 6172 5f62 696e 6172  rn _scalar_binar
-00012fe0: 7928 0a20 2020 2020 2020 2020 2020 2020  y(.             
-00012ff0: 2020 2020 2020 206c 616d 6264 6120 782c         lambda x,
-00013000: 2079 3a20 7265 7375 6c74 2069 6620 7820   y: result if x 
-00013010: 6973 2079 2065 6c73 6520 6e70 2e4e 614e  is y else np.NaN
-00013020: 2c20 636f 6e64 2c20 5472 7565 0a20 2020  , cond, True.   
-00013030: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00013040: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00013050: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00013060: 7265 7375 6c74 0a0a 2020 2020 7072 6f64  result..    prod
-00013070: 7563 7420 3d20 7072 6f64 2020 2320 616c  uct = prod  # al
-00013080: 6961 7365 6420 6464 2e70 726f 6475 6374  iased dd.product
-00013090: 0a0a 2020 2020 405f 6e75 6d65 7269 635f  ..    @_numeric_
-000130a0: 6f6e 6c79 0a20 2020 2040 6465 7269 7665  only.    @derive
-000130b0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-000130c0: 616d 6529 0a20 2020 2064 6566 206d 6178  ame).    def max
-000130d0: 2873 656c 662c 2061 7869 733d 302c 2073  (self, axis=0, s
-000130e0: 6b69 706e 613d 5472 7565 2c20 7370 6c69  kipna=True, spli
-000130f0: 745f 6576 6572 793d 4661 6c73 652c 206f  t_every=False, o
-00013100: 7574 3d4e 6f6e 652c 206e 756d 6572 6963  ut=None, numeric
-00013110: 5f6f 6e6c 793d 4e6f 6e65 293a 0a20 2020  _only=None):.   
-00013120: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
-00013130: 2020 2020 2020 5041 4e44 4153 5f47 545f        PANDAS_GT_
-00013140: 3134 300a 2020 2020 2020 2020 2020 2020  140.            
-00013150: 616e 6420 6e6f 7420 5041 4e44 4153 5f47  and not PANDAS_G
-00013160: 545f 3230 300a 2020 2020 2020 2020 2020  T_200.          
-00013170: 2020 616e 6420 6178 6973 2069 7320 4e6f    and axis is No
-00013180: 6e65 0a20 2020 2020 2020 2020 2020 2061  ne.            a
-00013190: 6e64 2069 7369 6e73 7461 6e63 6528 7365  nd isinstance(se
-000131a0: 6c66 2c20 4461 7461 4672 616d 6529 0a20  lf, DataFrame). 
-000131b0: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-000131c0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-000131d0: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-000131e0: 2020 2020 2022 496e 2061 2066 7574 7572       "In a futur
-000131f0: 6520 7665 7273 696f 6e2c 2044 6174 6146  e version, DataF
-00013200: 7261 6d65 2e6d 6178 2861 7869 733d 4e6f  rame.max(axis=No
-00013210: 6e65 2920 7769 6c6c 2072 6574 7572 6e20  ne) will return 
-00013220: 6120 7363 616c 6172 206d 6178 206f 7665  a scalar max ove
-00013230: 7220 7468 6520 656e 7469 7265 2044 6174  r the entire Dat
-00013240: 6146 7261 6d65 2e20 220a 2020 2020 2020  aFrame. ".      
-00013250: 2020 2020 2020 2020 2020 2254 6f20 7265            "To re
-00013260: 7461 696e 2074 6865 206f 6c64 2062 6568  tain the old beh
-00013270: 6176 696f 722c 2075 7365 2027 6672 616d  avior, use 'fram
-00013280: 652e 6d61 7828 6178 6973 3d30 2927 206f  e.max(axis=0)' o
-00013290: 7220 6a75 7374 2027 6672 616d 652e 6d61  r just 'frame.ma
-000132a0: 7828 2927 222c 0a20 2020 2020 2020 2020  x()'",.         
-000132b0: 2020 2020 2020 2046 7574 7572 6557 6172         FutureWar
-000132c0: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
-000132d0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000132e0: 6178 6973 203d 2030 0a0a 2020 2020 2020  axis = 0..      
-000132f0: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
-00013300: 6564 7563 7469 6f6e 5f61 6767 280a 2020  eduction_agg(.  
-00013310: 2020 2020 2020 2020 2020 226d 6178 222c            "max",
-00013320: 0a20 2020 2020 2020 2020 2020 2061 7869  .            axi
-00013330: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
-00013340: 2020 2020 736b 6970 6e61 3d73 6b69 706e      skipna=skipn
-00013350: 612c 0a20 2020 2020 2020 2020 2020 2073  a,.            s
-00013360: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-00013370: 5f65 7665 7279 2c0a 2020 2020 2020 2020  _every,.        
-00013380: 2020 2020 6f75 743d 6f75 742c 0a20 2020      out=out,.   
-00013390: 2020 2020 2020 2020 2023 2053 7461 7274           # Start
-000133a0: 696e 6720 696e 2070 616e 6461 7320 322e  ing in pandas 2.
-000133b0: 302c 2060 6178 6973 3d4e 6f6e 6560 2064  0, `axis=None` d
-000133c0: 6f65 7320 6120 6675 6c6c 2061 6767 7265  oes a full aggre
-000133d0: 6761 7469 6f6e 2061 6372 6f73 7320 626f  gation across bo
-000133e0: 7468 2061 7865 730a 2020 2020 2020 2020  th axes.        
-000133f0: 2020 2020 6e6f 6e65 5f69 735f 7a65 726f      none_is_zero
-00013400: 3d6e 6f74 2050 414e 4441 535f 4754 5f32  =not PANDAS_GT_2
-00013410: 3030 2c0a 2020 2020 2020 2020 290a 0a20  00,.        ).. 
-00013420: 2020 2040 5f6e 756d 6572 6963 5f6f 6e6c     @_numeric_onl
-00013430: 790a 2020 2020 4064 6572 6976 6564 5f66  y.    @derived_f
-00013440: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-00013450: 290a 2020 2020 6465 6620 6d69 6e28 7365  ).    def min(se
-00013460: 6c66 2c20 6178 6973 3d30 2c20 736b 6970  lf, axis=0, skip
-00013470: 6e61 3d54 7275 652c 2073 706c 6974 5f65  na=True, split_e
-00013480: 7665 7279 3d46 616c 7365 2c20 6f75 743d  very=False, out=
-00013490: 4e6f 6e65 2c20 6e75 6d65 7269 635f 6f6e  None, numeric_on
-000134a0: 6c79 3d4e 6f6e 6529 3a0a 2020 2020 2020  ly=None):.      
-000134b0: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
-000134c0: 2020 2050 414e 4441 535f 4754 5f31 3430     PANDAS_GT_140
-000134d0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-000134e0: 206e 6f74 2050 414e 4441 535f 4754 5f32   not PANDAS_GT_2
-000134f0: 3030 0a20 2020 2020 2020 2020 2020 2061  00.            a
-00013500: 6e64 2061 7869 7320 6973 204e 6f6e 650a  nd axis is None.
-00013510: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00013520: 6973 696e 7374 616e 6365 2873 656c 662c  isinstance(self,
-00013530: 2044 6174 6146 7261 6d65 290a 2020 2020   DataFrame).    
-00013540: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00013550: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-00013560: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00013570: 2020 2249 6e20 6120 6675 7475 7265 2076    "In a future v
-00013580: 6572 7369 6f6e 2c20 4461 7461 4672 616d  ersion, DataFram
-00013590: 652e 6d69 6e28 6178 6973 3d4e 6f6e 6529  e.min(axis=None)
-000135a0: 2077 696c 6c20 7265 7475 726e 2061 2073   will return a s
-000135b0: 6361 6c61 7220 6d69 6e20 6f76 6572 2074  calar min over t
-000135c0: 6865 2065 6e74 6972 6520 4461 7461 4672  he entire DataFr
-000135d0: 616d 652e 2022 0a20 2020 2020 2020 2020  ame. ".         
-000135e0: 2020 2020 2020 2022 546f 2072 6574 6169         "To retai
-000135f0: 6e20 7468 6520 6f6c 6420 6265 6861 7669  n the old behavi
-00013600: 6f72 2c20 7573 6520 2766 7261 6d65 2e6d  or, use 'frame.m
-00013610: 696e 2861 7869 733d 3029 2720 6f72 206a  in(axis=0)' or j
-00013620: 7573 7420 2766 7261 6d65 2e6d 696e 2829  ust 'frame.min()
-00013630: 2722 2c0a 2020 2020 2020 2020 2020 2020  '",.            
-00013640: 2020 2020 4675 7475 7265 5761 726e 696e      FutureWarnin
-00013650: 672c 0a20 2020 2020 2020 2020 2020 2029  g,.            )
-00013660: 0a20 2020 2020 2020 2020 2020 2061 7869  .            axi
-00013670: 7320 3d20 300a 0a20 2020 2020 2020 2072  s = 0..        r
-00013680: 6574 7572 6e20 7365 6c66 2e5f 7265 6475  eturn self._redu
-00013690: 6374 696f 6e5f 6167 6728 0a20 2020 2020  ction_agg(.     
-000136a0: 2020 2020 2020 2022 6d69 6e22 2c0a 2020         "min",.  
-000136b0: 2020 2020 2020 2020 2020 6178 6973 3d61            axis=a
-000136c0: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
-000136d0: 2073 6b69 706e 613d 736b 6970 6e61 2c0a   skipna=skipna,.
-000136e0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-000136f0: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-00013700: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
-00013710: 206f 7574 3d6f 7574 2c0a 2020 2020 2020   out=out,.      
-00013720: 2020 2020 2020 2320 5374 6172 7469 6e67        # Starting
-00013730: 2069 6e20 7061 6e64 6173 2032 2e30 2c20   in pandas 2.0, 
-00013740: 6061 7869 733d 4e6f 6e65 6020 646f 6573  `axis=None` does
-00013750: 2061 2066 756c 6c20 6167 6772 6567 6174   a full aggregat
-00013760: 696f 6e20 6163 726f 7373 2062 6f74 6820  ion across both 
-00013770: 6178 6573 0a20 2020 2020 2020 2020 2020  axes.           
-00013780: 206e 6f6e 655f 6973 5f7a 6572 6f3d 6e6f   none_is_zero=no
-00013790: 7420 5041 4e44 4153 5f47 545f 3230 302c  t PANDAS_GT_200,
-000137a0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000137b0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-000137c0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-000137d0: 6465 6620 6964 786d 6178 2873 656c 662c  def idxmax(self,
-000137e0: 2061 7869 733d 4e6f 6e65 2c20 736b 6970   axis=None, skip
-000137f0: 6e61 3d54 7275 652c 2073 706c 6974 5f65  na=True, split_e
-00013800: 7665 7279 3d46 616c 7365 293a 0a20 2020  very=False):.   
-00013810: 2020 2020 2066 6e20 3d20 2269 6478 6d61       fn = "idxma
-00013820: 7822 0a20 2020 2020 2020 2061 7869 7320  x".        axis 
-00013830: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
-00013840: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
-00013850: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
-00013860: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e69  _meta_nonempty.i
-00013870: 6478 6d61 7828 6178 6973 3d61 7869 732c  dxmax(axis=axis,
-00013880: 2073 6b69 706e 613d 736b 6970 6e61 290a   skipna=skipna).
-00013890: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-000138a0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-000138b0: 2020 7265 7475 726e 206d 6170 5f70 6172    return map_par
-000138c0: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
-000138d0: 2020 2020 2020 2020 204d 2e69 6478 6d61           M.idxma
-000138e0: 782c 0a20 2020 2020 2020 2020 2020 2020  x,.             
-000138f0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00013900: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
-00013910: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-00013920: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
-00013930: 746f 6b65 6e5f 7072 6566 6978 202b 2066  token_prefix + f
-00013940: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-00013950: 2020 2073 6b69 706e 613d 736b 6970 6e61     skipna=skipna
-00013960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013970: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
-00013980: 2020 2020 2020 2020 2020 2020 2065 6e66               enf
-00013990: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-000139a0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-000139b0: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
-000139c0: 0a20 2020 2020 2020 2020 2020 2073 6361  .            sca
-000139d0: 6c61 7220 3d20 6e6f 7420 6973 5f73 6572  lar = not is_ser
-000139e0: 6965 735f 6c69 6b65 286d 6574 6129 0a20  ies_like(meta). 
-000139f0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00013a00: 7420 3d20 6163 6128 0a20 2020 2020 2020  t = aca(.       
-00013a10: 2020 2020 2020 2020 205b 7365 6c66 5d2c           [self],
-00013a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013a30: 2063 6875 6e6b 3d69 6478 6d61 786d 696e   chunk=idxmaxmin
-00013a40: 5f63 6875 6e6b 2c0a 2020 2020 2020 2020  _chunk,.        
-00013a50: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-00013a60: 653d 6964 786d 6178 6d69 6e5f 6167 672c  e=idxmaxmin_agg,
-00013a70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013a80: 2063 6f6d 6269 6e65 3d69 6478 6d61 786d   combine=idxmaxm
-00013a90: 696e 5f63 6f6d 6269 6e65 2c0a 2020 2020  in_combine,.    
-00013aa0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00013ab0: 3d6d 6574 612c 0a20 2020 2020 2020 2020  =meta,.         
-00013ac0: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
-00013ad0: 5f6b 7761 7267 733d 7b22 7363 616c 6172  _kwargs={"scalar
-00013ae0: 223a 2073 6361 6c61 727d 2c0a 2020 2020  ": scalar},.    
-00013af0: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-00013b00: 6e3d 7365 6c66 2e5f 746f 6b65 6e5f 7072  n=self._token_pr
-00013b10: 6566 6978 202b 2066 6e2c 0a20 2020 2020  efix + fn,.     
-00013b20: 2020 2020 2020 2020 2020 2073 706c 6974             split
-00013b30: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-00013b40: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
-00013b50: 2020 2020 736b 6970 6e61 3d73 6b69 706e      skipna=skipn
-00013b60: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-00013b70: 2020 2066 6e3d 666e 2c0a 2020 2020 2020     fn=fn,.      
-00013b80: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00013b90: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00013ba0: 6528 7365 6c66 2c20 4461 7461 4672 616d  e(self, DataFram
-00013bb0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00013bc0: 2020 2020 7265 7375 6c74 2e64 6976 6973      result.divis
-00013bd0: 696f 6e73 203d 2028 6d69 6e28 7365 6c66  ions = (min(self
-00013be0: 2e63 6f6c 756d 6e73 292c 206d 6178 2873  .columns), max(s
-00013bf0: 656c 662e 636f 6c75 6d6e 7329 290a 2020  elf.columns)).  
-00013c00: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00013c10: 2072 6573 756c 740a 0a20 2020 2040 6465   result..    @de
-00013c20: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-00013c30: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-00013c40: 2069 6478 6d69 6e28 7365 6c66 2c20 6178   idxmin(self, ax
-00013c50: 6973 3d4e 6f6e 652c 2073 6b69 706e 613d  is=None, skipna=
-00013c60: 5472 7565 2c20 7370 6c69 745f 6576 6572  True, split_ever
-00013c70: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
-00013c80: 2020 666e 203d 2022 6964 786d 696e 220a    fn = "idxmin".
-00013c90: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
-00013ca0: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
-00013cb0: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
-00013cc0: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
-00013cd0: 7461 5f6e 6f6e 656d 7074 792e 6964 786d  ta_nonempty.idxm
-00013ce0: 6178 2861 7869 733d 6178 6973 290a 2020  ax(axis=axis).  
-00013cf0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
-00013d00: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00013d10: 7265 7475 726e 206d 6170 5f70 6172 7469  return map_parti
-00013d20: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
-00013d30: 2020 2020 2020 204d 2e69 6478 6d69 6e2c         M.idxmin,
-00013d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013d50: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-00013d60: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
-00013d70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013d80: 2020 746f 6b65 6e3d 7365 6c66 2e5f 746f    token=self._to
-00013d90: 6b65 6e5f 7072 6566 6978 202b 2066 6e2c  ken_prefix + fn,
-00013da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013db0: 2073 6b69 706e 613d 736b 6970 6e61 2c0a   skipna=skipna,.
-00013dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013dd0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
-00013de0: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
-00013df0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-00013e00: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
-00013e10: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00013e20: 2020 2020 2020 2020 2020 2073 6361 6c61             scala
-00013e30: 7220 3d20 6e6f 7420 6973 5f73 6572 6965  r = not is_serie
-00013e40: 735f 6c69 6b65 286d 6574 6129 0a20 2020  s_like(meta).   
-00013e50: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-00013e60: 3d20 6163 6128 0a20 2020 2020 2020 2020  = aca(.         
-00013e70: 2020 2020 2020 205b 7365 6c66 5d2c 0a20         [self],. 
-00013e80: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00013e90: 6875 6e6b 3d69 6478 6d61 786d 696e 5f63  hunk=idxmaxmin_c
-00013ea0: 6875 6e6b 2c0a 2020 2020 2020 2020 2020  hunk,.          
-00013eb0: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
-00013ec0: 6964 786d 6178 6d69 6e5f 6167 672c 0a20  idxmaxmin_agg,. 
-00013ed0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00013ee0: 6f6d 6269 6e65 3d69 6478 6d61 786d 696e  ombine=idxmaxmin
-00013ef0: 5f63 6f6d 6269 6e65 2c0a 2020 2020 2020  _combine,.      
-00013f00: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
-00013f10: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-00013f20: 2020 2020 2061 6767 7265 6761 7465 5f6b       aggregate_k
-00013f30: 7761 7267 733d 7b22 7363 616c 6172 223a  wargs={"scalar":
-00013f40: 2073 6361 6c61 727d 2c0a 2020 2020 2020   scalar},.      
-00013f50: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
-00013f60: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
-00013f70: 6978 202b 2066 6e2c 0a20 2020 2020 2020  ix + fn,.       
-00013f80: 2020 2020 2020 2020 2073 706c 6974 5f65           split_e
-00013f90: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-00013fa0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013fb0: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
-00013fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013fd0: 2066 6e3d 666e 2c0a 2020 2020 2020 2020   fn=fn,.        
-00013fe0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00013ff0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00014000: 7365 6c66 2c20 4461 7461 4672 616d 6529  self, DataFrame)
-00014010: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00014020: 2020 7265 7375 6c74 2e64 6976 6973 696f    result.divisio
-00014030: 6e73 203d 2028 6d69 6e28 7365 6c66 2e63  ns = (min(self.c
-00014040: 6f6c 756d 6e73 292c 206d 6178 2873 656c  olumns), max(sel
-00014050: 662e 636f 6c75 6d6e 7329 290a 2020 2020  f.columns)).    
-00014060: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00014070: 6573 756c 740a 0a20 2020 2040 5f6e 756d  esult..    @_num
-00014080: 6572 6963 5f6f 6e6c 790a 2020 2020 4064  eric_only.    @d
-00014090: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-000140a0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-000140b0: 6620 636f 756e 7428 7365 6c66 2c20 6178  f count(self, ax
-000140c0: 6973 3d4e 6f6e 652c 2073 706c 6974 5f65  is=None, split_e
-000140d0: 7665 7279 3d46 616c 7365 2c20 6e75 6d65  very=False, nume
-000140e0: 7269 635f 6f6e 6c79 3d4e 6f6e 6529 3a0a  ric_only=None):.
-000140f0: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
-00014100: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
-00014110: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
-00014120: 2074 6f6b 656e 203d 2073 656c 662e 5f74   token = self._t
-00014130: 6f6b 656e 5f70 7265 6669 7820 2b20 2263  oken_prefix + "c
-00014140: 6f75 6e74 220a 2020 2020 2020 2020 6966  ount".        if
-00014150: 2061 7869 7320 3d3d 2031 3a0a 2020 2020   axis == 1:.    
-00014160: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
-00014170: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
-00014180: 7479 2e63 6f75 6e74 2861 7869 733d 6178  ty.count(axis=ax
-00014190: 6973 290a 2020 2020 2020 2020 2020 2020  is).            
-000141a0: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-000141b0: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-000141c0: 2020 2020 2020 2020 2020 2020 4d2e 636f              M.co
-000141d0: 756e 742c 206d 6574 613d 6d65 7461 2c20  unt, meta=meta, 
-000141e0: 746f 6b65 6e3d 746f 6b65 6e2c 2061 7869  token=token, axi
-000141f0: 733d 6178 6973 2c20 656e 666f 7263 655f  s=axis, enforce_
-00014200: 6d65 7461 6461 7461 3d46 616c 7365 0a20  metadata=False. 
-00014210: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00014220: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00014230: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
-00014240: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
-00014250: 792e 636f 756e 7428 290a 0a20 2020 2020  y.count()..     
-00014260: 2020 2020 2020 2023 204e 6565 6420 7468         # Need th
-00014270: 6520 6173 7479 7065 2869 6e74 2920 666f  e astype(int) fo
-00014280: 7220 656d 7074 7920 6461 7461 6672 616d  r empty datafram
-00014290: 6573 2c20 7768 6963 6820 7375 6d20 746f  es, which sum to
-000142a0: 2066 6c6f 6174 2064 7479 7065 0a20 2020   float dtype.   
-000142b0: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-000142c0: 3d20 7365 6c66 2e72 6564 7563 7469 6f6e  = self.reduction
-000142d0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000142e0: 2020 4d2e 636f 756e 742c 0a20 2020 2020    M.count,.     
-000142f0: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
-00014300: 6761 7465 3d5f 636f 756e 745f 6167 6772  gate=_count_aggr
-00014310: 6567 6174 652c 0a20 2020 2020 2020 2020  egate,.         
-00014320: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
-00014330: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014340: 2020 746f 6b65 6e3d 746f 6b65 6e2c 0a20    token=token,. 
-00014350: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00014360: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-00014370: 5f65 7665 7279 2c0a 2020 2020 2020 2020  _every,.        
-00014380: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00014390: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000143a0: 7365 6c66 2c20 4461 7461 4672 616d 6529  self, DataFrame)
-000143b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000143c0: 2020 7265 7375 6c74 2e64 6976 6973 696f    result.divisio
-000143d0: 6e73 203d 2028 7365 6c66 2e63 6f6c 756d  ns = (self.colum
-000143e0: 6e73 2e6d 696e 2829 2c20 7365 6c66 2e63  ns.min(), self.c
-000143f0: 6f6c 756d 6e73 2e6d 6178 2829 290a 2020  olumns.max()).  
-00014400: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00014410: 2072 6573 756c 740a 0a20 2020 2040 6465   result..    @de
-00014420: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-00014430: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-00014440: 206d 6f64 6528 7365 6c66 2c20 6472 6f70   mode(self, drop
-00014450: 6e61 3d54 7275 652c 2073 706c 6974 5f65  na=True, split_e
-00014460: 7665 7279 3d46 616c 7365 293a 0a20 2020  very=False):.   
-00014470: 2020 2020 206d 6f64 655f 7365 7269 6573       mode_series
-00014480: 203d 2073 656c 662e 7265 6475 6374 696f   = self.reductio
-00014490: 6e28 0a20 2020 2020 2020 2020 2020 2063  n(.            c
-000144a0: 6875 6e6b 3d4d 2e76 616c 7565 5f63 6f75  hunk=M.value_cou
-000144b0: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
-000144c0: 2063 6f6d 6269 6e65 3d4d 2e73 756d 2c0a   combine=M.sum,.
-000144d0: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
-000144e0: 6567 6174 653d 5f6d 6f64 655f 6167 6772  egate=_mode_aggr
-000144f0: 6567 6174 652c 0a20 2020 2020 2020 2020  egate,.         
-00014500: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
-00014510: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
-00014520: 2020 2020 2020 2020 6368 756e 6b5f 6b77          chunk_kw
-00014530: 6172 6773 3d7b 2264 726f 706e 6122 3a20  args={"dropna": 
-00014540: 6472 6f70 6e61 7d2c 0a20 2020 2020 2020  dropna},.       
-00014550: 2020 2020 2061 6767 7265 6761 7465 5f6b       aggregate_k
-00014560: 7761 7267 733d 7b22 6472 6f70 6e61 223a  wargs={"dropna":
-00014570: 2064 726f 706e 617d 2c0a 2020 2020 2020   dropna},.      
-00014580: 2020 290a 2020 2020 2020 2020 6d6f 6465    ).        mode
-00014590: 5f73 6572 6965 732e 6e61 6d65 203d 2073  _series.name = s
-000145a0: 656c 662e 6e61 6d65 0a20 2020 2020 2020  elf.name.       
-000145b0: 2072 6574 7572 6e20 6d6f 6465 5f73 6572   return mode_ser
-000145c0: 6965 730a 0a20 2020 2040 5f6e 756d 6572  ies..    @_numer
-000145d0: 6963 5f6f 6e6c 790a 2020 2020 4064 6572  ic_only.    @der
-000145e0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-000145f0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00014600: 6d65 616e 280a 2020 2020 2020 2020 7365  mean(.        se
-00014610: 6c66 2c0a 2020 2020 2020 2020 6178 6973  lf,.        axis
-00014620: 3d30 2c0a 2020 2020 2020 2020 736b 6970  =0,.        skip
-00014630: 6e61 3d54 7275 652c 0a20 2020 2020 2020  na=True,.       
-00014640: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-00014650: 7365 2c0a 2020 2020 2020 2020 6474 7970  se,.        dtyp
-00014660: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-00014670: 6f75 743d 4e6f 6e65 2c0a 2020 2020 2020  out=None,.      
-00014680: 2020 6e75 6d65 7269 635f 6f6e 6c79 3d4e    numeric_only=N
-00014690: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
-000146a0: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
-000146b0: 2020 2020 2050 414e 4441 535f 4754 5f31       PANDAS_GT_1
-000146c0: 3430 0a20 2020 2020 2020 2020 2020 2061  40.            a
-000146d0: 6e64 206e 6f74 2050 414e 4441 535f 4754  nd not PANDAS_GT
-000146e0: 5f32 3030 0a20 2020 2020 2020 2020 2020  _200.           
-000146f0: 2061 6e64 2061 7869 7320 6973 204e 6f6e   and axis is Non
-00014700: 650a 2020 2020 2020 2020 2020 2020 616e  e.            an
-00014710: 6420 6973 696e 7374 616e 6365 2873 656c  d isinstance(sel
-00014720: 662c 2044 6174 6146 7261 6d65 290a 2020  f, DataFrame).  
-00014730: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-00014740: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00014750: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
-00014760: 2020 2020 2249 6e20 6120 6675 7475 7265      "In a future
-00014770: 2076 6572 7369 6f6e 2c20 4461 7461 4672   version, DataFr
-00014780: 616d 652e 6d65 616e 2861 7869 733d 4e6f  ame.mean(axis=No
-00014790: 6e65 2920 7769 6c6c 2072 6574 7572 6e20  ne) will return 
-000147a0: 6120 7363 616c 6172 206d 6561 6e20 6f76  a scalar mean ov
-000147b0: 6572 2074 6865 2065 6e74 6972 6520 4461  er the entire Da
-000147c0: 7461 4672 616d 652e 2022 0a20 2020 2020  taFrame. ".     
-000147d0: 2020 2020 2020 2020 2020 2022 546f 2072             "To r
-000147e0: 6574 6169 6e20 7468 6520 6f6c 6420 6265  etain the old be
-000147f0: 6861 7669 6f72 2c20 7573 6520 2766 7261  havior, use 'fra
-00014800: 6d65 2e6d 6561 6e28 6178 6973 3d30 2927  me.mean(axis=0)'
-00014810: 206f 7220 6a75 7374 2027 6672 616d 652e   or just 'frame.
-00014820: 6d65 616e 2829 2722 2c0a 2020 2020 2020  mean()'",.      
-00014830: 2020 2020 2020 2020 2020 4675 7475 7265            Future
-00014840: 5761 726e 696e 672c 0a20 2020 2020 2020  Warning,.       
-00014850: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
-00014860: 7869 7320 3d20 7365 6c66 2e5f 7661 6c69  xis = self._vali
-00014870: 6461 7465 5f61 7869 7328 6178 6973 2c20  date_axis(axis, 
-00014880: 6e6f 6e65 5f69 735f 7a65 726f 3d6e 6f74  none_is_zero=not
-00014890: 2050 414e 4441 535f 4754 5f32 3030 290a   PANDAS_GT_200).
-000148a0: 2020 2020 2020 2020 5f72 6169 7365 5f69          _raise_i
-000148b0: 665f 6f62 6a65 6374 5f73 6572 6965 7328  f_object_series(
-000148c0: 7365 6c66 2c20 226d 6561 6e22 290a 2020  self, "mean").  
-000148d0: 2020 2020 2020 2320 4e4f 5445 3a20 446f        # NOTE: Do
-000148e0: 2077 6520 7761 6e74 2074 6f20 7761 726e   we want to warn
-000148f0: 2068 6572 653f 0a20 2020 2020 2020 2077   here?.        w
-00014900: 6974 6820 6368 6563 6b5f 6e75 6d65 7269  ith check_numeri
-00014910: 635f 6f6e 6c79 5f64 6570 7265 6361 7469  c_only_deprecati
-00014920: 6f6e 2829 2c20 6368 6563 6b5f 6e75 6973  on(), check_nuis
-00014930: 616e 6365 5f63 6f6c 756d 6e73 5f77 6172  ance_columns_war
-00014940: 6e69 6e67 2829 3a0a 2020 2020 2020 2020  ning():.        
-00014950: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
-00014960: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e6d  _meta_nonempty.m
-00014970: 6561 6e28 0a20 2020 2020 2020 2020 2020  ean(.           
-00014980: 2020 2020 2061 7869 733d 6178 6973 2c20       axis=axis, 
-00014990: 736b 6970 6e61 3d73 6b69 706e 612c 206e  skipna=skipna, n
-000149a0: 756d 6572 6963 5f6f 6e6c 793d 6e75 6d65  umeric_only=nume
-000149b0: 7269 635f 6f6e 6c79 0a20 2020 2020 2020  ric_only.       
-000149c0: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-000149d0: 6620 6178 6973 203d 3d20 313a 0a20 2020  f axis == 1:.   
-000149e0: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-000149f0: 3d20 6d61 705f 7061 7274 6974 696f 6e73  = map_partitions
-00014a00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00014a10: 2020 4d2e 6d65 616e 2c0a 2020 2020 2020    M.mean,.      
-00014a20: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-00014a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a40: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
-00014a50: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
-00014a60: 3d73 656c 662e 5f74 6f6b 656e 5f70 7265  =self._token_pre
-00014a70: 6669 7820 2b20 226d 6561 6e22 2c0a 2020  fix + "mean",.  
-00014a80: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00014a90: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
-00014aa0: 2020 2020 2020 2020 2073 6b69 706e 613d           skipna=
-00014ab0: 736b 6970 6e61 2c0a 2020 2020 2020 2020  skipna,.        
-00014ac0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
-00014ad0: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
-00014ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014af0: 6e75 6d65 7269 635f 6f6e 6c79 3d6e 756d  numeric_only=num
-00014b00: 6572 6963 5f6f 6e6c 792c 0a20 2020 2020  eric_only,.     
-00014b10: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00014b20: 2020 2020 2072 6574 7572 6e20 6861 6e64       return hand
-00014b30: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
-00014b40: 6c74 290a 2020 2020 2020 2020 656c 7365  lt).        else
-00014b50: 3a0a 2020 2020 2020 2020 2020 2020 6e75  :.            nu
-00014b60: 6d20 3d20 7365 6c66 2e5f 6765 745f 6e75  m = self._get_nu
-00014b70: 6d65 7269 635f 6461 7461 2829 0a20 2020  meric_data().   
-00014b80: 2020 2020 2020 2020 2073 203d 206e 756d           s = num
-00014b90: 2e73 756d 2873 6b69 706e 613d 736b 6970  .sum(skipna=skip
-00014ba0: 6e61 2c20 7370 6c69 745f 6576 6572 793d  na, split_every=
-00014bb0: 7370 6c69 745f 6576 6572 7929 0a20 2020  split_every).   
-00014bc0: 2020 2020 2020 2020 206e 203d 206e 756d           n = num
-00014bd0: 2e63 6f75 6e74 2873 706c 6974 5f65 7665  .count(split_eve
-00014be0: 7279 3d73 706c 6974 5f65 7665 7279 290a  ry=split_every).
-00014bf0: 2020 2020 2020 2020 2020 2020 2320 5374              # St
-00014c00: 6172 7469 6e67 2069 6e20 7061 6e64 6173  arting in pandas
-00014c10: 2032 2e30 2c20 6061 7869 733d 4e6f 6e65   2.0, `axis=None
-00014c20: 6020 646f 6573 2061 2066 756c 6c20 6167  ` does a full ag
-00014c30: 6772 6567 6174 696f 6e20 6163 726f 7373  gregation across
-00014c40: 2062 6f74 6820 6178 6573 0a20 2020 2020   both axes.     
-00014c50: 2020 2020 2020 2069 6620 5041 4e44 4153         if PANDAS
-00014c60: 5f47 545f 3230 3020 616e 6420 6178 6973  _GT_200 and axis
-00014c70: 2069 7320 4e6f 6e65 2061 6e64 2069 7369   is None and isi
-00014c80: 6e73 7461 6e63 6528 7365 6c66 2c20 4461  nstance(self, Da
-00014c90: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
-00014ca0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00014cb0: 203d 2073 2e73 756d 2829 202f 206e 2e73   = s.sum() / n.s
-00014cc0: 756d 2829 0a20 2020 2020 2020 2020 2020  um().           
-00014cd0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00014ce0: 2020 2020 2020 206e 616d 6520 3d20 7365         name = se
-00014cf0: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
-00014d00: 202b 2022 6d65 616e 2d25 7322 2025 2074   + "mean-%s" % t
-00014d10: 6f6b 656e 697a 6528 7365 6c66 2c20 6178  okenize(self, ax
-00014d20: 6973 2c20 736b 6970 6e61 290a 2020 2020  is, skipna).    
-00014d30: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00014d40: 6c74 203d 206d 6170 5f70 6172 7469 7469  lt = map_partiti
-00014d50: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-00014d60: 2020 2020 2020 2020 206d 6574 686f 6473           methods
-00014d70: 2e6d 6561 6e5f 6167 6772 6567 6174 652c  .mean_aggregate,
-00014d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014d90: 2020 2020 2073 2c0a 2020 2020 2020 2020       s,.        
-00014da0: 2020 2020 2020 2020 2020 2020 6e2c 0a20              n,. 
-00014db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014dc0: 2020 2074 6f6b 656e 3d6e 616d 652c 0a20     token=name,. 
-00014dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014de0: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
-00014df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e00: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
-00014e10: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
-00014e20: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00014e30: 7265 6e74 5f6d 6574 613d 7365 6c66 2e5f  rent_meta=self._
-00014e40: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-00014e50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00014e60: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00014e70: 7461 6e63 6528 7365 6c66 2c20 4461 7461  tance(self, Data
-00014e80: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
-00014e90: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00014ea0: 6c74 2e64 6976 6973 696f 6e73 203d 2028  lt.divisions = (
-00014eb0: 7365 6c66 2e63 6f6c 756d 6e73 2e6d 696e  self.columns.min
-00014ec0: 2829 2c20 7365 6c66 2e63 6f6c 756d 6e73  (), self.columns
-00014ed0: 2e6d 6178 2829 290a 2020 2020 2020 2020  .max()).        
-00014ee0: 2020 2020 7265 7475 726e 2068 616e 646c      return handl
-00014ef0: 655f 6f75 7428 6f75 742c 2072 6573 756c  e_out(out, resul
-00014f00: 7429 0a0a 2020 2020 6465 6620 6d65 6469  t)..    def medi
-00014f10: 616e 5f61 7070 726f 7869 6d61 7465 280a  an_approximate(.
-00014f20: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00014f30: 2020 2020 2020 6178 6973 3d4e 6f6e 652c        axis=None,
-00014f40: 0a20 2020 2020 2020 206d 6574 686f 643d  .        method=
-00014f50: 2264 6566 6175 6c74 222c 0a20 2020 2029  "default",.    )
-00014f60: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00014f70: 7572 6e20 7468 6520 6170 7072 6f78 696d  urn the approxim
-00014f80: 6174 6520 6d65 6469 616e 206f 6620 7468  ate median of th
-00014f90: 6520 7661 6c75 6573 206f 7665 7220 7468  e values over th
-00014fa0: 6520 7265 7175 6573 7465 6420 6178 6973  e requested axis
-00014fb0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00014fc0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00014fd0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00014fe0: 2061 7869 7320 3a20 7b30 2c20 312c 2022   axis : {0, 1, "
-00014ff0: 696e 6465 7822 2c20 2263 6f6c 756d 6e73  index", "columns
-00015000: 227d 2028 6465 6661 756c 7420 3029 0a20  "} (default 0). 
-00015010: 2020 2020 2020 2020 2020 2030 206f 7220             0 or 
-00015020: 6060 2269 6e64 6578 2260 6020 666f 7220  ``"index"`` for 
-00015030: 726f 772d 7769 7365 2c20 3120 6f72 2060  row-wise, 1 or `
-00015040: 6022 636f 6c75 6d6e 7322 6060 2066 6f72  `"columns"`` for
-00015050: 2063 6f6c 756d 6e2d 7769 7365 0a20 2020   column-wise.   
-00015060: 2020 2020 206d 6574 686f 6420 3a20 7b27       method : {'
-00015070: 6465 6661 756c 7427 2c20 2774 6469 6765  default', 'tdige
-00015080: 7374 272c 2027 6461 736b 277d 2c20 6f70  st', 'dask'}, op
-00015090: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-000150a0: 2020 2057 6861 7420 6d65 7468 6f64 2074     What method t
-000150b0: 6f20 7573 652e 2042 7920 6465 6661 756c  o use. By defaul
-000150c0: 7420 7769 6c6c 2075 7365 2044 6173 6b27  t will use Dask'
-000150d0: 7320 696e 7465 726e 616c 2063 7573 746f  s internal custo
-000150e0: 6d0a 2020 2020 2020 2020 2020 2020 616c  m.            al
-000150f0: 676f 7269 7468 6d20 2860 6022 6461 736b  gorithm (``"dask
-00015100: 2260 6029 2e20 2049 6620 7365 7420 746f  "``).  If set to
-00015110: 2060 6022 7464 6967 6573 7422 6060 2077   ``"tdigest"`` w
-00015120: 696c 6c20 7573 6520 7464 6967 6573 740a  ill use tdigest.
-00015130: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00015140: 666c 6f61 7473 2061 6e64 2069 6e74 7320  floats and ints 
-00015150: 616e 6420 6661 6c6c 6261 636b 2074 6f20  and fallback to 
-00015160: 7468 6520 6060 2264 6173 6b22 6060 206f  the ``"dask"`` o
-00015170: 7468 6572 7769 7365 2e0a 2020 2020 2020  therwise..      
-00015180: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-00015190: 7475 726e 2073 656c 662e 7175 616e 7469  turn self.quanti
-000151a0: 6c65 2871 3d30 2e35 2c20 6178 6973 3d61  le(q=0.5, axis=a
-000151b0: 7869 732c 206d 6574 686f 643d 6d65 7468  xis, method=meth
-000151c0: 6f64 292e 7265 6e61 6d65 284e 6f6e 6529  od).rename(None)
-000151d0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-000151e0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-000151f0: 290a 2020 2020 6465 6620 6d65 6469 616e  ).    def median
-00015200: 2873 656c 662c 2061 7869 733d 4e6f 6e65  (self, axis=None
-00015210: 2c20 6d65 7468 6f64 3d22 6465 6661 756c  , method="defaul
-00015220: 7422 293a 0a20 2020 2020 2020 2069 6620  t"):.        if 
-00015230: 6178 6973 2069 6e20 2831 2c20 2263 6f6c  axis in (1, "col
-00015240: 756d 6e73 2229 206f 7220 7365 6c66 2e6e  umns") or self.n
-00015250: 7061 7274 6974 696f 6e73 203d 3d20 313a  partitions == 1:
-00015260: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
-00015270: 616e 2070 726f 7669 6465 2061 6e20 6578  an provide an ex
-00015280: 6163 7420 6d65 6469 616e 2069 6e20 7468  act median in th
-00015290: 6573 6520 6361 7365 730a 2020 2020 2020  ese cases.      
-000152a0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000152b0: 662e 6d65 6469 616e 5f61 7070 726f 7869  f.median_approxi
-000152c0: 6d61 7465 2861 7869 733d 6178 6973 2c20  mate(axis=axis, 
-000152d0: 6d65 7468 6f64 3d6d 6574 686f 6429 0a20  method=method). 
-000152e0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-000152f0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-00015300: 280a 2020 2020 2020 2020 2020 2020 2244  (.            "D
-00015310: 6173 6b20 646f 6573 6e27 7420 696d 706c  ask doesn't impl
-00015320: 656d 656e 7420 616e 2065 7861 6374 206d  ement an exact m
-00015330: 6564 6961 6e20 696e 2061 6c6c 2063 6173  edian in all cas
-00015340: 6573 2061 7320 7468 6973 2069 7320 6861  es as this is ha
-00015350: 7264 2074 6f20 646f 2069 6e20 7061 7261  rd to do in para
-00015360: 6c6c 656c 2e20 220a 2020 2020 2020 2020  llel. ".        
-00015370: 2020 2020 2253 6565 2074 6865 2060 6d65      "See the `me
-00015380: 6469 616e 5f61 7070 726f 7869 6d61 7465  dian_approximate
-00015390: 6020 6d65 7468 6f64 2069 6e73 7465 6164  ` method instead
-000153a0: 2c20 7768 6963 6820 7573 6573 2061 6e20  , which uses an 
-000153b0: 6170 7072 6f78 696d 6174 6520 616c 676f  approximate algo
-000153c0: 7269 7468 6d2e 220a 2020 2020 2020 2020  rithm.".        
-000153d0: 290a 0a20 2020 2040 5f6e 756d 6572 6963  )..    @_numeric
-000153e0: 5f6f 6e6c 790a 2020 2020 4064 6572 6976  _only.    @deriv
-000153f0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-00015400: 7261 6d65 290a 2020 2020 6465 6620 7661  rame).    def va
-00015410: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
-00015420: 0a20 2020 2020 2020 2061 7869 733d 4e6f  .        axis=No
-00015430: 6e65 2c0a 2020 2020 2020 2020 736b 6970  ne,.        skip
-00015440: 6e61 3d54 7275 652c 0a20 2020 2020 2020  na=True,.       
-00015450: 2064 646f 663d 312c 0a20 2020 2020 2020   ddof=1,.       
-00015460: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-00015470: 7365 2c0a 2020 2020 2020 2020 6474 7970  se,.        dtyp
-00015480: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-00015490: 6f75 743d 4e6f 6e65 2c0a 2020 2020 2020  out=None,.      
-000154a0: 2020 6e75 6d65 7269 635f 6f6e 6c79 3d4e    numeric_only=N
-000154b0: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
-000154c0: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
-000154d0: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
-000154e0: 7869 7329 0a20 2020 2020 2020 205f 7261  xis).        _ra
-000154f0: 6973 655f 6966 5f6f 626a 6563 745f 7365  ise_if_object_se
-00015500: 7269 6573 2873 656c 662c 2022 7661 7222  ries(self, "var"
-00015510: 290a 2020 2020 2020 2020 7769 7468 2063  ).        with c
-00015520: 6865 636b 5f6e 756d 6572 6963 5f6f 6e6c  heck_numeric_onl
-00015530: 795f 6465 7072 6563 6174 696f 6e28 292c  y_deprecation(),
-00015540: 2063 6865 636b 5f6e 7569 7361 6e63 655f   check_nuisance_
-00015550: 636f 6c75 6d6e 735f 7761 726e 696e 6728  columns_warning(
-00015560: 293a 0a20 2020 2020 2020 2020 2020 206d  ):.            m
-00015570: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
-00015580: 5f6e 6f6e 656d 7074 792e 7661 7228 0a20  _nonempty.var(. 
-00015590: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000155a0: 7869 733d 6178 6973 2c20 736b 6970 6e61  xis=axis, skipna
-000155b0: 3d73 6b69 706e 612c 206e 756d 6572 6963  =skipna, numeric
-000155c0: 5f6f 6e6c 793d 6e75 6d65 7269 635f 6f6e  _only=numeric_on
-000155d0: 6c79 0a20 2020 2020 2020 2020 2020 2029  ly.            )
-000155e0: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
-000155f0: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
-00015600: 2020 2072 6573 756c 7420 3d20 6d61 705f     result = map_
-00015610: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-00015620: 2020 2020 2020 2020 2020 2020 4d2e 7661              M.va
-00015630: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-00015640: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00015650: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
-00015660: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-00015670: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
-00015680: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
-00015690: 7661 7222 2c0a 2020 2020 2020 2020 2020  var",.          
-000156a0: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
-000156b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000156c0: 2073 6b69 706e 613d 736b 6970 6e61 2c0a   skipna=skipna,.
-000156d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000156e0: 6464 6f66 3d64 646f 662c 0a20 2020 2020  ddof=ddof,.     
-000156f0: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
-00015700: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-00015710: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00015720: 2020 206e 756d 6572 6963 5f6f 6e6c 793d     numeric_only=
-00015730: 6e75 6d65 7269 635f 6f6e 6c79 2c0a 2020  numeric_only,.  
-00015740: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00015750: 2020 2020 2020 2020 7265 7475 726e 2068          return h
-00015760: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
-00015770: 6573 756c 7429 0a20 2020 2020 2020 2065  esult).        e
-00015780: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00015790: 2069 6620 7365 6c66 2e6e 6469 6d20 3d3d   if self.ndim ==
-000157a0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-000157b0: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
-000157c0: 662e 5f76 6172 5f31 6428 7365 6c66 2c20  f._var_1d(self, 
-000157d0: 736b 6970 6e61 2c20 6464 6f66 2c20 7370  skipna, ddof, sp
-000157e0: 6c69 745f 6576 6572 7929 0a20 2020 2020  lit_every).     
-000157f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00015800: 6e20 6861 6e64 6c65 5f6f 7574 286f 7574  n handle_out(out
-00015810: 2c20 7265 7375 6c74 290a 0a20 2020 2020  , result)..     
-00015820: 2020 2020 2020 2023 2070 616e 6461 7320         # pandas 
-00015830: 312e 302b 2064 6f65 7320 6e6f 7420 696d  1.0+ does not im
-00015840: 706c 656d 656e 7420 7661 7220 6f6e 2074  plement var on t
-00015850: 696d 6564 656c 7461 0a20 2020 2020 2020  imedelta.       
-00015860: 2020 2020 2072 6573 756c 7420 3d20 7365       result = se
-00015870: 6c66 2e5f 7661 725f 6e75 6d65 7269 6328  lf._var_numeric(
-00015880: 736b 6970 6e61 2c20 6464 6f66 2c20 7370  skipna, ddof, sp
-00015890: 6c69 745f 6576 6572 7929 0a0a 2020 2020  lit_every)..    
-000158a0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-000158b0: 7461 6e63 6528 7365 6c66 2c20 4461 7461  tance(self, Data
-000158c0: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
-000158d0: 2020 2020 2020 2020 7265 7375 6c74 2e64          result.d
-000158e0: 6976 6973 696f 6e73 203d 2028 7365 6c66  ivisions = (self
-000158f0: 2e63 6f6c 756d 6e73 2e6d 696e 2829 2c20  .columns.min(), 
-00015900: 7365 6c66 2e63 6f6c 756d 6e73 2e6d 6178  self.columns.max
-00015910: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
-00015920: 7265 7475 726e 2068 616e 646c 655f 6f75  return handle_ou
-00015930: 7428 6f75 742c 2072 6573 756c 7429 0a0a  t(out, result)..
-00015940: 2020 2020 6465 6620 5f76 6172 5f6e 756d      def _var_num
-00015950: 6572 6963 2873 656c 662c 2073 6b69 706e  eric(self, skipn
-00015960: 613d 5472 7565 2c20 6464 6f66 3d31 2c20  a=True, ddof=1, 
-00015970: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
-00015980: 6529 3a0a 2020 2020 2020 2020 6e75 6d20  e):.        num 
-00015990: 3d20 7365 6c66 2e73 656c 6563 745f 6474  = self.select_dt
-000159a0: 7970 6573 2869 6e63 6c75 6465 3d5b 226e  ypes(include=["n
-000159b0: 756d 6265 7222 2c20 2262 6f6f 6c22 5d2c  umber", "bool"],
-000159c0: 2065 7863 6c75 6465 3d5b 6e70 2e74 696d   exclude=[np.tim
-000159d0: 6564 656c 7461 3634 5d29 0a0a 2020 2020  edelta64])..    
-000159e0: 2020 2020 7661 6c75 6573 5f64 7479 7065      values_dtype
-000159f0: 203d 206e 756d 2e76 616c 7565 732e 6474   = num.values.dt
-00015a00: 7970 650a 2020 2020 2020 2020 6172 7261  ype.        arra
-00015a10: 795f 7661 6c75 6573 203d 206e 756d 2e76  y_values = num.v
-00015a20: 616c 7565 730a 0a20 2020 2020 2020 2069  alues..        i
-00015a30: 6620 6e6f 7420 6e70 2e69 7373 7562 6474  f not np.issubdt
-00015a40: 7970 6528 7661 6c75 6573 5f64 7479 7065  ype(values_dtype
-00015a50: 2c20 6e70 2e6e 756d 6265 7229 3a0a 2020  , np.number):.  
-00015a60: 2020 2020 2020 2020 2020 6172 7261 795f            array_
+00000710: 6f6e 2c0a 2020 2020 6973 5f64 6174 6166  on,.    is_dataf
+00000720: 7261 6d65 5f6c 696b 652c 0a20 2020 2069  rame_like,.    i
+00000730: 735f 696e 6465 785f 6c69 6b65 2c0a 2020  s_index_like,.  
+00000740: 2020 6973 5f73 6572 6965 735f 6c69 6b65    is_series_like
+00000750: 2c0a 2020 2020 6d61 6b65 5f6d 6574 612c  ,.    make_meta,
+00000760: 0a20 2020 206d 6574 615f 6672 616d 655f  .    meta_frame_
+00000770: 636f 6e73 7472 7563 746f 722c 0a20 2020  constructor,.   
+00000780: 206d 6574 615f 7365 7269 6573 5f63 6f6e   meta_series_con
+00000790: 7374 7275 6374 6f72 2c0a 2020 2020 7261  structor,.    ra
+000007a0: 6973 655f 6f6e 5f6d 6574 615f 6572 726f  ise_on_meta_erro
+000007b0: 722c 0a20 2020 2076 616c 6964 5f64 6976  r,.    valid_div
+000007c0: 6973 696f 6e73 2c0a 290a 6672 6f6d 2064  isions,.).from d
+000007d0: 6173 6b2e 6465 6c61 7965 6420 696d 706f  ask.delayed impo
+000007e0: 7274 2044 656c 6179 6564 2c20 6465 6c61  rt Delayed, dela
+000007f0: 7965 642c 2075 6e70 6163 6b5f 636f 6c6c  yed, unpack_coll
+00000800: 6563 7469 6f6e 730a 6672 6f6d 2064 6173  ections.from das
+00000810: 6b2e 6869 6768 6c65 7665 6c67 7261 7068  k.highlevelgraph
+00000820: 2069 6d70 6f72 7420 4869 6768 4c65 7665   import HighLeve
+00000830: 6c47 7261 7068 0a66 726f 6d20 6461 736b  lGraph.from dask
+00000840: 2e6c 6179 6572 7320 696d 706f 7274 2044  .layers import D
+00000850: 6174 6146 7261 6d65 5472 6565 5265 6475  ataFrameTreeRedu
+00000860: 6374 696f 6e0a 6672 6f6d 2064 6173 6b2e  ction.from dask.
+00000870: 7574 696c 7320 696d 706f 7274 2028 0a20  utils import (. 
+00000880: 2020 2049 6e64 6578 4361 6c6c 6162 6c65     IndexCallable
+00000890: 2c0a 2020 2020 4d2c 0a20 2020 204f 7065  ,.    M,.    Ope
+000008a0: 7261 746f 724d 6574 686f 644d 6978 696e  ratorMethodMixin
+000008b0: 2c0a 2020 2020 5f64 6570 7265 6361 7465  ,.    _deprecate
+000008c0: 642c 0a20 2020 2061 7070 6c79 2c0a 2020  d,.    apply,.  
+000008d0: 2020 6465 7269 7665 645f 6672 6f6d 2c0a    derived_from,.
+000008e0: 2020 2020 6675 6e63 6e61 6d65 2c0a 2020      funcname,.  
+000008f0: 2020 6861 735f 6b65 7977 6f72 642c 0a20    has_keyword,. 
+00000900: 2020 2069 735f 6172 7261 796c 696b 652c     is_arraylike,
+00000910: 0a20 2020 2069 7465 725f 6368 756e 6b73  .    iter_chunks
+00000920: 2c0a 2020 2020 6b65 795f 7370 6c69 742c  ,.    key_split,
+00000930: 0a20 2020 206d 6179 6265 5f70 6c75 7261  .    maybe_plura
+00000940: 6c69 7a65 2c0a 2020 2020 6d65 6d6f 7279  lize,.    memory
+00000950: 5f72 6570 722c 0a20 2020 2070 6172 7365  _repr,.    parse
+00000960: 5f62 7974 6573 2c0a 2020 2020 7061 7274  _bytes,.    part
+00000970: 6961 6c5f 6279 5f6f 7264 6572 2c0a 2020  ial_by_order,.  
+00000980: 2020 7073 6575 646f 7261 6e64 6f6d 2c0a    pseudorandom,.
+00000990: 2020 2020 7075 745f 6c69 6e65 732c 0a20      put_lines,. 
+000009a0: 2020 2072 616e 646f 6d5f 7374 6174 655f     random_state_
+000009b0: 6461 7461 2c0a 2020 2020 7479 7065 6e61  data,.    typena
+000009c0: 6d65 2c0a 290a 6672 6f6d 2064 6173 6b2e  me,.).from dask.
+000009d0: 7769 6467 6574 7320 696d 706f 7274 2067  widgets import g
+000009e0: 6574 5f74 656d 706c 6174 650a 0a44 4546  et_template..DEF
+000009f0: 4155 4c54 5f47 4554 203d 206e 616d 6564  AULT_GET = named
+00000a00: 5f73 6368 6564 756c 6572 732e 6765 7428  _schedulers.get(
+00000a10: 2274 6872 6561 6473 222c 206e 616d 6564  "threads", named
+00000a20: 5f73 6368 6564 756c 6572 735b 2273 796e  _schedulers["syn
+00000a30: 6322 5d29 0a0a 6e6f 5f64 6566 6175 6c74  c"])..no_default
+00000a40: 203d 2022 5f5f 6e6f 5f64 6566 6175 6c74   = "__no_default
+00000a50: 5f5f 220a 0a47 524f 5550 5f4b 4559 535f  __"..GROUP_KEYS_
+00000a60: 4445 4641 554c 543a 2062 6f6f 6c20 7c20  DEFAULT: bool | 
+00000a70: 4e6f 6e65 203d 2054 7275 650a 6966 2050  None = True.if P
+00000a80: 414e 4441 535f 4754 5f31 3530 2061 6e64  ANDAS_GT_150 and
+00000a90: 206e 6f74 2050 414e 4441 535f 4754 5f32   not PANDAS_GT_2
+00000aa0: 3030 3a0a 2020 2020 4752 4f55 505f 4b45  00:.    GROUP_KE
+00000ab0: 5953 5f44 4546 4155 4c54 203d 204e 6f6e  YS_DEFAULT = Non
+00000ac0: 650a 0a70 642e 7365 745f 6f70 7469 6f6e  e..pd.set_option
+00000ad0: 2822 636f 6d70 7574 652e 7573 655f 6e75  ("compute.use_nu
+00000ae0: 6d65 7870 7222 2c20 4661 6c73 6529 0a0a  mexpr", False)..
+00000af0: 0a64 6566 205f 6e75 6d65 7269 635f 6f6e  .def _numeric_on
+00000b00: 6c79 2866 756e 6329 3a0a 2020 2020 2222  ly(func):.    ""
+00000b10: 2244 6563 6f72 6174 6f72 2066 6f72 206d  "Decorator for m
+00000b20: 6574 686f 6473 2074 6861 7420 6163 6365  ethods that acce
+00000b30: 7074 2061 206e 756d 6572 6963 5f6f 6e6c  pt a numeric_onl
+00000b40: 7920 6b77 6172 6722 2222 0a0a 2020 2020  y kwarg"""..    
+00000b50: 4077 7261 7073 2866 756e 6329 0a20 2020  @wraps(func).   
+00000b60: 2064 6566 2077 7261 7070 6572 2873 656c   def wrapper(sel
+00000b70: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00000b80: 6773 293a 0a20 2020 2020 2020 2023 206e  gs):.        # n
+00000b90: 756d 6572 6963 5f6f 6e6c 7920 6973 204e  umeric_only is N
+00000ba0: 6f6e 6520 6279 2064 6566 6175 6c74 202d  one by default -
+00000bb0: 2069 6e20 7468 6174 2063 6173 6520 7365   in that case se
+00000bc0: 6c66 203d 2073 656c 662e 0a20 2020 2020  lf = self..     
+00000bd0: 2020 2069 6620 6b77 6172 6773 2e67 6574     if kwargs.get
+00000be0: 2822 6e75 6d65 7269 635f 6f6e 6c79 2229  ("numeric_only")
+00000bf0: 2069 7320 4661 6c73 653a 0a20 2020 2020   is False:.     
+00000c00: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00000c10: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00000c20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00000c30: 2020 2227 6e75 6d65 7269 635f 6f6e 6c79    "'numeric_only
+00000c40: 3d46 616c 7365 2720 6973 206e 6f74 2069  =False' is not i
+00000c50: 6d70 6c65 6d65 6e74 6564 2069 6e20 4461  mplemented in Da
+00000c60: 736b 2e22 0a20 2020 2020 2020 2020 2020  sk.".           
+00000c70: 2029 0a20 2020 2020 2020 2065 6c69 6620   ).        elif 
+00000c80: 6b77 6172 6773 2e67 6574 2822 6e75 6d65  kwargs.get("nume
+00000c90: 7269 635f 6f6e 6c79 2229 2069 7320 5472  ric_only") is Tr
+00000ca0: 7565 3a0a 2020 2020 2020 2020 2020 2020  ue:.            
+00000cb0: 7365 6c66 203d 2073 656c 662e 5f67 6574  self = self._get
+00000cc0: 5f6e 756d 6572 6963 5f64 6174 6128 290a  _numeric_data().
+00000cd0: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+00000ce0: 756e 6328 7365 6c66 2c20 2a61 7267 732c  unc(self, *args,
+00000cf0: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
+00000d00: 7265 7475 726e 2077 7261 7070 6572 0a0a  return wrapper..
+00000d10: 0a64 6566 205f 6e75 6d65 7269 635f 6461  .def _numeric_da
+00000d20: 7461 2866 756e 6329 3a0a 2020 2020 2222  ta(func):.    ""
+00000d30: 224d 6f64 6966 6965 6420 7665 7273 696f  "Modified versio
+00000d40: 6e20 6f66 2074 6865 2061 626f 7665 2064  n of the above d
+00000d50: 6563 6f72 6174 6f72 2c20 7269 6768 7420  ecorator, right 
+00000d60: 6e6f 7720 6f6e 6c79 2075 7365 6420 7769  now only used wi
+00000d70: 7468 2073 7464 2e20 5765 2064 6f6e 2774  th std. We don't
+00000d80: 0a20 2020 206e 6565 6420 7261 6973 696e  .    need raisin
+00000d90: 6720 4e6f 7449 6d70 6c65 6d65 6e74 6564  g NotImplemented
+00000da0: 4572 726f 7220 7468 6572 652c 2062 6563  Error there, bec
+00000db0: 6175 7365 2069 7427 7320 6861 6e64 6c65  ause it's handle
+00000dc0: 6420 6279 0a20 2020 205f 6e75 6d65 7269  d by.    _numeri
+00000dd0: 635f 6f6e 6c79 5f6d 6179 6265 5f77 6172  c_only_maybe_war
+00000de0: 6e20 696e 7374 6561 642e 2054 6869 7320  n instead. This 
+00000df0: 6973 2061 2074 656d 706f 7261 7279 2073  is a temporary s
+00000e00: 6f6c 7574 696f 6e20 7468 6174 206e 6565  olution that nee
+00000e10: 6473 0a20 2020 206d 6f72 6520 7469 6d65  ds.    more time
+00000e20: 2074 6f20 6265 2067 656e 6572 616c 697a   to be generaliz
+00000e30: 6564 2e22 2222 0a0a 2020 2020 4077 7261  ed."""..    @wra
+00000e40: 7073 2866 756e 6329 0a20 2020 2064 6566  ps(func).    def
+00000e50: 2077 7261 7070 6572 2873 656c 662c 202a   wrapper(self, *
+00000e60: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+00000e70: 0a20 2020 2020 2020 2069 6620 6b77 6172  .        if kwar
+00000e80: 6773 2e67 6574 2822 6e75 6d65 7269 635f  gs.get("numeric_
+00000e90: 6f6e 6c79 2229 2069 7320 5472 7565 3a0a  only") is True:.
+00000ea0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00000eb0: 203d 2073 656c 662e 5f67 6574 5f6e 756d   = self._get_num
+00000ec0: 6572 6963 5f64 6174 6128 290a 2020 2020  eric_data().    
+00000ed0: 2020 2020 7265 7475 726e 2066 756e 6328      return func(
+00000ee0: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+00000ef0: 7761 7267 7329 0a0a 2020 2020 7265 7475  wargs)..    retu
+00000f00: 726e 2077 7261 7070 6572 0a0a 0a64 6566  rn wrapper...def
+00000f10: 205f 6e75 6d65 7269 635f 6f6e 6c79 5f6d   _numeric_only_m
+00000f20: 6179 6265 5f77 6172 6e28 6466 2c20 6e75  aybe_warn(df, nu
+00000f30: 6d65 7269 635f 6f6e 6c79 2c20 6465 6661  meric_only, defa
+00000f40: 756c 743d 4e6f 6e65 293a 0a20 2020 2022  ult=None):.    "
+00000f50: 2222 5570 6461 7465 206e 756d 6572 6963  ""Update numeric
+00000f60: 5f6f 6e6c 7920 746f 2067 6574 2072 6964  _only to get rid
+00000f70: 206f 6620 6e6f 5f64 6566 6175 6c74 2c20   of no_default, 
+00000f80: 616e 6420 706f 7373 6962 6c79 2077 6172  and possibly war
+00000f90: 6e20 6162 6f75 7420 6465 6661 756c 7420  n about default 
+00000fa0: 7661 6c75 652e 0a20 2020 2054 4f44 4f3a  value..    TODO:
+00000fb0: 2073 686f 756c 6420 6d6f 7665 2074 6f20   should move to 
+00000fc0: 6e75 6d65 7269 635f 6f6e 6c79 2064 6563  numeric_only dec
+00000fd0: 6f72 6174 6f72 2e20 5365 6520 6874 7470  orator. See http
+00000fe0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f64  s://github.com/d
+00000ff0: 6173 6b2f 6461 736b 2f70 756c 6c2f 3939  ask/dask/pull/99
+00001000: 3532 0a20 2020 2022 2222 0a20 2020 2069  52.    """.    i
+00001010: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
+00001020: 696b 6528 6466 293a 0a20 2020 2020 2020  ike(df):.       
+00001030: 2077 6172 6e5f 6e75 6d65 7269 635f 6f6e   warn_numeric_on
+00001040: 6c79 203d 2046 616c 7365 0a20 2020 2020  ly = False.     
+00001050: 2020 2069 6620 6e75 6d65 7269 635f 6f6e     if numeric_on
+00001060: 6c79 2069 7320 6e6f 5f64 6566 6175 6c74  ly is no_default
+00001070: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00001080: 2050 414e 4441 535f 4754 5f32 3030 3a0a   PANDAS_GT_200:.
+00001090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000010a0: 6e75 6d65 7269 635f 6f6e 6c79 203d 2046  numeric_only = F
+000010b0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+000010c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000010d0: 2020 2020 2020 2077 6172 6e5f 6e75 6d65         warn_nume
+000010e0: 7269 635f 6f6e 6c79 203d 2054 7275 650a  ric_only = True.
+000010f0: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
+00001100: 7320 3d20 6466 2e5f 6d65 7461 2e5f 6765  s = df._meta._ge
+00001110: 745f 6e75 6d65 7269 635f 6461 7461 2829  t_numeric_data()
+00001120: 0a20 2020 2020 2020 2068 6173 5f6e 6f6e  .        has_non
+00001130: 5f6e 756d 6572 6963 7320 3d20 6c65 6e28  _numerics = len(
+00001140: 6e75 6d65 7269 6373 2e63 6f6c 756d 6e73  numerics.columns
+00001150: 2920 3c20 6c65 6e28 6466 2e5f 6d65 7461  ) < len(df._meta
+00001160: 2e63 6f6c 756d 6e73 290a 2020 2020 2020  .columns).      
+00001170: 2020 6966 2068 6173 5f6e 6f6e 5f6e 756d    if has_non_num
+00001180: 6572 6963 733a 0a20 2020 2020 2020 2020  erics:.         
+00001190: 2020 2069 6620 6e75 6d65 7269 635f 6f6e     if numeric_on
+000011a0: 6c79 2069 7320 4661 6c73 653a 0a20 2020  ly is False:.   
+000011b0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000011c0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+000011d0: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
+000011e0: 2020 2020 2020 2020 2020 2020 2227 6e75              "'nu
+000011f0: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
+00001200: 2720 6973 206e 6f74 2069 6d70 6c65 6d65  ' is not impleme
+00001210: 6e74 6564 2069 6e20 4461 736b 2e22 0a20  nted in Dask.". 
+00001220: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00001230: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00001240: 6620 7761 726e 5f6e 756d 6572 6963 5f6f  f warn_numeric_o
+00001250: 6e6c 793a 0a20 2020 2020 2020 2020 2020  nly:.           
+00001260: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00001270: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+00001280: 2020 2020 2020 2020 2254 6865 2064 6566          "The def
+00001290: 6175 6c74 2076 616c 7565 206f 6620 6e75  ault value of nu
+000012a0: 6d65 7269 635f 6f6e 6c79 2069 6e20 6461  meric_only in da
+000012b0: 736b 2077 696c 6c20 6265 2063 6861 6e67  sk will be chang
+000012c0: 6564 2074 6f20 4661 6c73 6520 696e 2022  ed to False in "
+000012d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000012e0: 2020 2020 2022 7468 6520 6675 7475 7265       "the future
+000012f0: 2077 6865 6e20 7573 696e 6720 6461 736b   when using dask
+00001300: 2077 6974 6820 7061 6e64 6173 2032 2e30   with pandas 2.0
+00001310: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00001320: 2020 2020 2020 2046 7574 7572 6557 6172         FutureWar
+00001330: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
+00001340: 2020 2020 2020 290a 2020 2020 6966 206e        ).    if n
+00001350: 756d 6572 6963 5f6f 6e6c 7920 6973 206e  umeric_only is n
+00001360: 6f5f 6465 6661 756c 7420 616e 6420 6465  o_default and de
+00001370: 6661 756c 7420 6973 206e 6f74 204e 6f6e  fault is not Non
+00001380: 653a 0a20 2020 2020 2020 206e 756d 6572  e:.        numer
+00001390: 6963 5f6f 6e6c 7920 3d20 6465 6661 756c  ic_only = defaul
+000013a0: 740a 2020 2020 7265 7475 726e 207b 7d20  t.    return {} 
+000013b0: 6966 206e 756d 6572 6963 5f6f 6e6c 7920  if numeric_only 
+000013c0: 6973 206e 6f5f 6465 6661 756c 7420 656c  is no_default el
+000013d0: 7365 207b 226e 756d 6572 6963 5f6f 6e6c  se {"numeric_onl
+000013e0: 7922 3a20 6e75 6d65 7269 635f 6f6e 6c79  y": numeric_only
+000013f0: 7d0a 0a0a 6465 6620 5f63 6f6e 6361 7428  }...def _concat(
+00001400: 6172 6773 2c20 6967 6e6f 7265 5f69 6e64  args, ignore_ind
+00001410: 6578 3d46 616c 7365 293a 0a20 2020 2069  ex=False):.    i
+00001420: 6620 6e6f 7420 6172 6773 3a0a 2020 2020  f not args:.    
+00001430: 2020 2020 7265 7475 726e 2061 7267 730a      return args.
+00001440: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00001450: 6528 6669 7273 7428 636f 7265 2e66 6c61  e(first(core.fla
+00001460: 7474 656e 2861 7267 7329 292c 206e 702e  tten(args)), np.
+00001470: 6e64 6172 7261 7929 3a0a 2020 2020 2020  ndarray):.      
+00001480: 2020 7265 7475 726e 2064 612e 636f 7265    return da.core
+00001490: 2e63 6f6e 6361 7465 6e61 7465 3328 6172  .concatenate3(ar
+000014a0: 6773 290a 2020 2020 6966 206e 6f74 2068  gs).    if not h
+000014b0: 6173 5f70 6172 616c 6c65 6c5f 7479 7065  as_parallel_type
+000014c0: 2861 7267 735b 305d 293a 0a20 2020 2020  (args[0]):.     
+000014d0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+000014e0: 2020 2020 7265 7475 726e 2070 642e 5365      return pd.Se
+000014f0: 7269 6573 2861 7267 7329 0a20 2020 2020  ries(args).     
+00001500: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
+00001510: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
+00001520: 2072 6574 7572 6e20 6172 6773 0a20 2020   return args.   
+00001530: 2023 2057 6520 6669 6c74 6572 206f 7574   # We filter out
+00001540: 2065 6d70 7479 2070 6172 7469 7469 6f6e   empty partition
+00001550: 7320 6865 7265 2062 6563 6175 7365 2070  s here because p
+00001560: 616e 6461 7320 6672 6571 7565 6e74 6c79  andas frequently
+00001570: 2068 6173 0a20 2020 2023 2069 6e63 6f6e   has.    # incon
+00001580: 7369 7374 656e 7420 6474 7970 6573 2069  sistent dtypes i
+00001590: 6e20 7265 7375 6c74 7320 6265 7477 6565  n results betwee
+000015a0: 6e20 656d 7074 7920 616e 6420 6e6f 6e2d  n empty and non-
+000015b0: 656d 7074 7920 6672 616d 6573 2e0a 2020  empty frames..  
+000015c0: 2020 2320 4964 6561 6c6c 7920 7468 6973    # Ideally this
+000015d0: 2077 6f75 6c64 2062 6520 6861 6e64 6c65   would be handle
+000015e0: 6420 6c6f 6361 6c6c 7920 666f 7220 6561  d locally for ea
+000015f0: 6368 206f 7065 7261 7469 6f6e 2c20 6275  ch operation, bu
+00001600: 7420 696e 2070 7261 6374 6963 650a 2020  t in practice.  
+00001610: 2020 2320 7468 6973 2073 6565 6d73 2065    # this seems e
+00001620: 6173 6965 722e 2054 4f44 4f3a 2064 6f6e  asier. TODO: don
+00001630: 2774 2064 6f20 7468 6973 2e0a 2020 2020  't do this..    
+00001640: 6172 6773 3220 3d20 5b69 2066 6f72 2069  args2 = [i for i
+00001650: 2069 6e20 6172 6773 2069 6620 6c65 6e28   in args if len(
+00001660: 6929 5d0a 2020 2020 7265 7475 726e 2028  i)].    return (
+00001670: 0a20 2020 2020 2020 2061 7267 735b 305d  .        args[0]
+00001680: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00001690: 6172 6773 320a 2020 2020 2020 2020 656c  args2.        el
+000016a0: 7365 206d 6574 686f 6473 2e63 6f6e 6361  se methods.conca
+000016b0: 7428 6172 6773 322c 2075 6e69 666f 726d  t(args2, uniform
+000016c0: 3d54 7275 652c 2069 676e 6f72 655f 696e  =True, ignore_in
+000016d0: 6465 783d 6967 6e6f 7265 5f69 6e64 6578  dex=ignore_index
+000016e0: 290a 2020 2020 290a 0a0a 6465 6620 6669  ).    )...def fi
+000016f0: 6e61 6c69 7a65 2872 6573 756c 7473 293a  nalize(results):
+00001700: 0a20 2020 2072 6574 7572 6e20 5f63 6f6e  .    return _con
+00001710: 6361 7428 7265 7375 6c74 7329 0a0a 0a63  cat(results)...c
+00001720: 6c61 7373 2053 6361 6c61 7228 4461 736b  lass Scalar(Dask
+00001730: 4d65 7468 6f64 734d 6978 696e 2c20 4f70  MethodsMixin, Op
+00001740: 6572 6174 6f72 4d65 7468 6f64 4d69 7869  eratorMethodMixi
+00001750: 6e29 3a0a 2020 2020 2222 2241 2044 6173  n):.    """A Das
+00001760: 6b20 6f62 6a65 6374 2074 6f20 7265 7072  k object to repr
+00001770: 6573 656e 7420 6120 7061 6e64 6173 2073  esent a pandas s
+00001780: 6361 6c61 7222 2222 0a0a 2020 2020 6465  calar"""..    de
+00001790: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+000017a0: 2064 736b 2c20 6e61 6d65 2c20 6d65 7461   dsk, name, meta
+000017b0: 2c20 6469 7669 7369 6f6e 733d 4e6f 6e65  , divisions=None
+000017c0: 293a 0a20 2020 2020 2020 2023 2064 6976  ):.        # div
+000017d0: 6973 696f 6e73 2069 7320 6967 6e6f 7265  isions is ignore
+000017e0: 642c 206f 6e6c 7920 7072 6573 656e 7420  d, only present 
+000017f0: 746f 2062 6520 636f 6d70 6174 6962 6c65  to be compatible
+00001800: 2077 6974 6820 6f74 6865 720a 2020 2020   with other.    
+00001810: 2020 2020 2320 6f62 6a65 6374 732e 0a20      # objects.. 
+00001820: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00001830: 696e 7374 616e 6365 2864 736b 2c20 4869  instance(dsk, Hi
+00001840: 6768 4c65 7665 6c47 7261 7068 293a 0a20  ghLevelGraph):. 
+00001850: 2020 2020 2020 2020 2020 2064 736b 203d             dsk =
+00001860: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
+00001870: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
+00001880: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
+00001890: 6e64 656e 6369 6573 3d5b 5d29 0a20 2020  ndencies=[]).   
+000018a0: 2020 2020 2073 656c 662e 6461 736b 203d       self.dask =
+000018b0: 2064 736b 0a20 2020 2020 2020 2073 656c   dsk.        sel
+000018c0: 662e 5f6e 616d 6520 3d20 6e61 6d65 0a20  f._name = name. 
+000018d0: 2020 2020 2020 2073 656c 662e 5f70 6172         self._par
+000018e0: 656e 745f 6d65 7461 203d 2070 642e 5365  ent_meta = pd.Se
+000018f0: 7269 6573 2864 7479 7065 3d22 666c 6f61  ries(dtype="floa
+00001900: 7436 3422 290a 0a20 2020 2020 2020 206d  t64")..        m
+00001910: 6574 6120 3d20 6d61 6b65 5f6d 6574 6128  eta = make_meta(
+00001920: 6d65 7461 2c20 7061 7265 6e74 5f6d 6574  meta, parent_met
+00001930: 613d 7365 6c66 2e5f 7061 7265 6e74 5f6d  a=self._parent_m
+00001940: 6574 6129 0a20 2020 2020 2020 2069 6620  eta).        if 
+00001950: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+00001960: 6528 6d65 7461 2920 6f72 2069 735f 7365  e(meta) or is_se
+00001970: 7269 6573 5f6c 696b 6528 6d65 7461 2920  ries_like(meta) 
+00001980: 6f72 2069 735f 696e 6465 785f 6c69 6b65  or is_index_like
+00001990: 286d 6574 6129 3a0a 2020 2020 2020 2020  (meta):.        
+000019a0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+000019b0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+000019c0: 2020 2020 2066 2245 7870 6563 7465 6420       f"Expected 
+000019d0: 6d65 7461 2074 6f20 7370 6563 6966 7920  meta to specify 
+000019e0: 7363 616c 6172 2c20 676f 7420 7b74 7970  scalar, got {typ
+000019f0: 656e 616d 6528 7479 7065 286d 6574 6129  ename(type(meta)
+00001a00: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00001a10: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+00001a20: 6d65 7461 203d 206d 6574 610a 0a20 2020  meta = meta..   
+00001a30: 2064 6566 205f 5f64 6173 6b5f 6772 6170   def __dask_grap
+00001a40: 685f 5f28 7365 6c66 293a 0a20 2020 2020  h__(self):.     
+00001a50: 2020 2072 6574 7572 6e20 7365 6c66 2e64     return self.d
+00001a60: 6173 6b0a 0a20 2020 2064 6566 205f 5f64  ask..    def __d
+00001a70: 6173 6b5f 6b65 7973 5f5f 2873 656c 6629  ask_keys__(self)
+00001a80: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00001a90: 205b 7365 6c66 2e6b 6579 5d0a 0a20 2020   [self.key]..   
+00001aa0: 2064 6566 205f 5f64 6173 6b5f 746f 6b65   def __dask_toke
+00001ab0: 6e69 7a65 5f5f 2873 656c 6629 3a0a 2020  nize__(self):.  
+00001ac0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00001ad0: 662e 5f6e 616d 650a 0a20 2020 2064 6566  f._name..    def
+00001ae0: 205f 5f64 6173 6b5f 6c61 7965 7273 5f5f   __dask_layers__
+00001af0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00001b00: 7265 7475 726e 2028 7365 6c66 2e5f 6e61  return (self._na
+00001b10: 6d65 2c29 0a0a 2020 2020 5f5f 6461 736b  me,)..    __dask
+00001b20: 5f6f 7074 696d 697a 655f 5f20 3d20 676c  _optimize__ = gl
+00001b30: 6f62 616c 6d65 7468 6f64 280a 2020 2020  obalmethod(.    
+00001b40: 2020 2020 6f70 7469 6d69 7a65 2c20 6b65      optimize, ke
+00001b50: 793d 2264 6174 6166 7261 6d65 5f6f 7074  y="dataframe_opt
+00001b60: 696d 697a 6522 2c20 6661 6c73 6579 3d64  imize", falsey=d
+00001b70: 6f6e 745f 6f70 7469 6d69 7a65 0a20 2020  ont_optimize.   
+00001b80: 2029 0a20 2020 205f 5f64 6173 6b5f 7363   ).    __dask_sc
+00001b90: 6865 6475 6c65 725f 5f20 3d20 7374 6174  heduler__ = stat
+00001ba0: 6963 6d65 7468 6f64 2844 4546 4155 4c54  icmethod(DEFAULT
+00001bb0: 5f47 4554 290a 0a20 2020 2064 6566 205f  _GET)..    def _
+00001bc0: 5f64 6173 6b5f 706f 7374 636f 6d70 7574  _dask_postcomput
+00001bd0: 655f 5f28 7365 6c66 293a 0a20 2020 2020  e__(self):.     
+00001be0: 2020 2072 6574 7572 6e20 6669 7273 742c     return first,
+00001bf0: 2028 290a 0a20 2020 2064 6566 205f 5f64   ()..    def __d
+00001c00: 6173 6b5f 706f 7374 7065 7273 6973 745f  ask_postpersist_
+00001c10: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00001c20: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
+00001c30: 6275 696c 642c 2028 290a 0a20 2020 2064  build, ()..    d
+00001c40: 6566 205f 7265 6275 696c 6428 7365 6c66  ef _rebuild(self
+00001c50: 2c20 6473 6b2c 202a 2c20 7265 6e61 6d65  , dsk, *, rename
+00001c60: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00001c70: 6e61 6d65 203d 2073 656c 662e 5f6e 616d  name = self._nam
+00001c80: 650a 2020 2020 2020 2020 6966 2072 656e  e.        if ren
+00001c90: 616d 653a 0a20 2020 2020 2020 2020 2020  ame:.           
+00001ca0: 206e 616d 6520 3d20 7265 6e61 6d65 2e67   name = rename.g
+00001cb0: 6574 286e 616d 652c 206e 616d 6529 0a20  et(name, name). 
+00001cc0: 2020 2020 2020 2072 6574 7572 6e20 5363         return Sc
+00001cd0: 616c 6172 2864 736b 2c20 6e61 6d65 2c20  alar(dsk, name, 
+00001ce0: 7365 6c66 2e5f 6d65 7461 2c20 7365 6c66  self._meta, self
+00001cf0: 2e64 6976 6973 696f 6e73 290a 0a20 2020  .divisions)..   
+00001d00: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00001d10: 6566 205f 6d65 7461 5f6e 6f6e 656d 7074  ef _meta_nonempt
+00001d20: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
+00001d30: 2072 6574 7572 6e20 7365 6c66 2e5f 6d65   return self._me
+00001d40: 7461 0a0a 2020 2020 4070 726f 7065 7274  ta..    @propert
+00001d50: 790a 2020 2020 6465 6620 6474 7970 6528  y.    def dtype(
+00001d60: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00001d70: 6574 7572 6e20 7365 6c66 2e5f 6d65 7461  eturn self._meta
+00001d80: 2e64 7479 7065 0a0a 2020 2020 6465 6620  .dtype..    def 
+00001d90: 5f5f 6469 725f 5f28 7365 6c66 293a 0a20  __dir__(self):. 
+00001da0: 2020 2020 2020 206f 203d 2073 6574 2864         o = set(d
+00001db0: 6972 2874 7970 6528 7365 6c66 2929 290a  ir(type(self))).
+00001dc0: 2020 2020 2020 2020 6f2e 7570 6461 7465          o.update
+00001dd0: 2873 656c 662e 5f5f 6469 6374 5f5f 290a  (self.__dict__).
+00001de0: 2020 2020 2020 2020 6966 206e 6f74 2068          if not h
+00001df0: 6173 6174 7472 2873 656c 662e 5f6d 6574  asattr(self._met
+00001e00: 612c 2022 6474 7970 6522 293a 0a20 2020  a, "dtype"):.   
+00001e10: 2020 2020 2020 2020 206f 2e72 656d 6f76           o.remov
+00001e20: 6528 2264 7479 7065 2229 2020 2320 6474  e("dtype")  # dt
+00001e30: 7970 6520 6f6e 6c79 2069 6e20 6064 6972  ype only in `dir
+00001e40: 6020 6966 2061 7661 696c 6162 6c65 0a20  ` if available. 
+00001e50: 2020 2020 2020 2072 6574 7572 6e20 6c69         return li
+00001e60: 7374 286f 290a 0a20 2020 2040 7072 6f70  st(o)..    @prop
+00001e70: 6572 7479 0a20 2020 2064 6566 2064 6976  erty.    def div
+00001e80: 6973 696f 6e73 2873 656c 6629 3a0a 2020  isions(self):.  
+00001e90: 2020 2020 2020 2222 2244 756d 6d79 2064        """Dummy d
+00001ea0: 6976 6973 696f 6e73 2074 6f20 6265 2063  ivisions to be c
+00001eb0: 6f6d 7061 7420 7769 7468 2053 6572 6965  ompat with Serie
+00001ec0: 7320 616e 6420 4461 7461 4672 616d 6522  s and DataFrame"
+00001ed0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00001ee0: 6e20 284e 6f6e 652c 204e 6f6e 6529 0a0a  n (None, None)..
+00001ef0: 2020 2020 6465 6620 5f5f 7265 7072 5f5f      def __repr__
+00001f00: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00001f10: 6e61 6d65 203d 2073 656c 662e 5f6e 616d  name = self._nam
+00001f20: 6520 6966 206c 656e 2873 656c 662e 5f6e  e if len(self._n
+00001f30: 616d 6529 203c 2031 3020 656c 7365 2073  ame) < 10 else s
+00001f40: 656c 662e 5f6e 616d 655b 3a37 5d20 2b20  elf._name[:7] + 
+00001f50: 222e 2e2e 220a 2020 2020 2020 2020 6966  "...".        if
+00001f60: 2068 6173 6174 7472 2873 656c 662e 5f6d   hasattr(self._m
+00001f70: 6574 612c 2022 6474 7970 6522 293a 0a20  eta, "dtype"):. 
+00001f80: 2020 2020 2020 2020 2020 2065 7874 7261             extra
+00001f90: 203d 2022 2c20 6474 7970 653d 2573 2220   = ", dtype=%s" 
+00001fa0: 2520 7365 6c66 2e5f 6d65 7461 2e64 7479  % self._meta.dty
+00001fb0: 7065 0a20 2020 2020 2020 2065 6c73 653a  pe.        else:
+00001fc0: 0a20 2020 2020 2020 2020 2020 2065 7874  .            ext
+00001fd0: 7261 203d 2022 2c20 7479 7065 3d25 7322  ra = ", type=%s"
+00001fe0: 2025 2074 7970 6528 7365 6c66 2e5f 6d65   % type(self._me
+00001ff0: 7461 292e 5f5f 6e61 6d65 5f5f 0a20 2020  ta).__name__.   
+00002000: 2020 2020 2072 6574 7572 6e20 6622 6464       return f"dd
+00002010: 2e53 6361 6c61 723c 7b6e 616d 657d 7b65  .Scalar<{name}{e
+00002020: 7874 7261 7d3e 220a 0a20 2020 2064 6566  xtra}>"..    def
+00002030: 205f 5f61 7272 6179 5f5f 2873 656c 6629   __array__(self)
+00002040: 3a0a 2020 2020 2020 2020 2320 6172 7261  :.        # arra
+00002050: 7920 696e 7465 7266 6163 6520 6973 2072  y interface is r
+00002060: 6571 7569 7265 6420 746f 2073 7570 706f  equired to suppo
+00002070: 7274 2070 616e 6461 7320 696e 7374 616e  rt pandas instan
+00002080: 6365 202b 2053 6361 6c61 720a 2020 2020  ce + Scalar.    
+00002090: 2020 2020 2320 4f74 6865 7277 6973 652c      # Otherwise,
+000020a0: 2061 626f 7665 206f 7020 7265 7375 6c74   above op result
+000020b0: 7320 696e 2070 642e 5365 7269 6573 206f  s in pd.Series o
+000020c0: 6620 5363 616c 6172 2028 6f62 6a65 6374  f Scalar (object
+000020d0: 2064 7479 7065 290a 2020 2020 2020 2020   dtype).        
+000020e0: 7265 7475 726e 206e 702e 6173 6172 7261  return np.asarra
+000020f0: 7928 7365 6c66 2e63 6f6d 7075 7465 2829  y(self.compute()
+00002100: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00002110: 0a20 2020 2064 6566 205f 6172 6773 2873  .    def _args(s
+00002120: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00002130: 7475 726e 2028 7365 6c66 2e64 6173 6b2c  turn (self.dask,
+00002140: 2073 656c 662e 5f6e 616d 652c 2073 656c   self._name, sel
+00002150: 662e 5f6d 6574 6129 0a0a 2020 2020 6465  f._meta)..    de
+00002160: 6620 5f5f 6765 7473 7461 7465 5f5f 2873  f __getstate__(s
+00002170: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00002180: 7475 726e 2073 656c 662e 5f61 7267 730a  turn self._args.
+00002190: 0a20 2020 2064 6566 205f 5f73 6574 7374  .    def __setst
+000021a0: 6174 655f 5f28 7365 6c66 2c20 7374 6174  ate__(self, stat
+000021b0: 6529 3a0a 2020 2020 2020 2020 7365 6c66  e):.        self
+000021c0: 2e64 6173 6b2c 2073 656c 662e 5f6e 616d  .dask, self._nam
+000021d0: 652c 2073 656c 662e 5f6d 6574 6120 3d20  e, self._meta = 
+000021e0: 7374 6174 650a 0a20 2020 2064 6566 205f  state..    def _
+000021f0: 5f62 6f6f 6c5f 5f28 7365 6c66 293a 0a20  _bool__(self):. 
+00002200: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00002210: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00002220: 2020 2020 6622 5472 7969 6e67 2074 6f20      f"Trying to 
+00002230: 636f 6e76 6572 7420 7b73 656c 667d 2074  convert {self} t
+00002240: 6f20 6120 626f 6f6c 6561 6e20 7661 6c75  o a boolean valu
+00002250: 652e 2042 6563 6175 7365 2044 6173 6b20  e. Because Dask 
+00002260: 6f62 6a65 6374 7320 6172 6520 220a 2020  objects are ".  
+00002270: 2020 2020 2020 2020 2020 226c 617a 696c            "lazil
+00002280: 7920 6576 616c 7561 7465 642c 2074 6865  y evaluated, the
+00002290: 7920 6361 6e6e 6f74 2062 6520 636f 6e76  y cannot be conv
+000022a0: 6572 7465 6420 746f 2061 2062 6f6f 6c65  erted to a boole
+000022b0: 616e 2076 616c 7565 206f 7220 7573 6564  an value or used
+000022c0: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+000022d0: 696e 2062 6f6f 6c65 616e 2063 6f6e 6469  in boolean condi
+000022e0: 7469 6f6e 7320 6c69 6b65 2069 6620 7374  tions like if st
+000022f0: 6174 656d 656e 7473 2e20 5472 7920 6361  atements. Try ca
+00002300: 6c6c 696e 6720 2e63 6f6d 7075 7465 2829  lling .compute()
+00002310: 2074 6f20 220a 2020 2020 2020 2020 2020   to ".          
+00002320: 2020 2266 6f72 6365 2063 6f6d 7075 7461    "force computa
+00002330: 7469 6f6e 2070 7269 6f72 2074 6f20 636f  tion prior to co
+00002340: 6e76 6572 7469 6e67 2074 6f20 6120 626f  nverting to a bo
+00002350: 6f6c 6561 6e20 7661 6c75 6520 6f72 2075  olean value or u
+00002360: 7369 6e67 2069 6e20 220a 2020 2020 2020  sing in ".      
+00002370: 2020 2020 2020 2261 2063 6f6e 6469 7469        "a conditi
+00002380: 6f6e 616c 2073 7461 7465 6d65 6e74 2e22  onal statement."
+00002390: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000023a0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+000023b0: 6620 6b65 7928 7365 6c66 293a 0a20 2020  f key(self):.   
+000023c0: 2020 2020 2072 6574 7572 6e20 2873 656c       return (sel
+000023d0: 662e 5f6e 616d 652c 2030 290a 0a20 2020  f._name, 0)..   
+000023e0: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+000023f0: 2020 6465 6620 5f67 6574 5f75 6e61 7279    def _get_unary
+00002400: 5f6f 7065 7261 746f 7228 636c 732c 206f  _operator(cls, o
+00002410: 7029 3a0a 2020 2020 2020 2020 6465 6620  p):.        def 
+00002420: 6628 7365 6c66 293a 0a20 2020 2020 2020  f(self):.       
+00002430: 2020 2020 206e 616d 6520 3d20 6675 6e63       name = func
+00002440: 6e61 6d65 286f 7029 202b 2022 2d22 202b  name(op) + "-" +
+00002450: 2074 6f6b 656e 697a 6528 7365 6c66 290a   tokenize(self).
+00002460: 2020 2020 2020 2020 2020 2020 6473 6b20              dsk 
+00002470: 3d20 7b28 6e61 6d65 2c20 3029 3a20 286f  = {(name, 0): (o
+00002480: 702c 2028 7365 6c66 2e5f 6e61 6d65 2c20  p, (self._name, 
+00002490: 3029 297d 0a20 2020 2020 2020 2020 2020  0))}.           
+000024a0: 206d 6574 6120 3d20 6f70 2873 656c 662e   meta = op(self.
+000024b0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 290a  _meta_nonempty).
+000024c0: 2020 2020 2020 2020 2020 2020 6772 6170              grap
+000024d0: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
+000024e0: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
+000024f0: 6f6e 7328 6e61 6d65 2c20 6473 6b2c 2064  ons(name, dsk, d
+00002500: 6570 656e 6465 6e63 6965 733d 5b73 656c  ependencies=[sel
+00002510: 665d 290a 2020 2020 2020 2020 2020 2020  f]).            
+00002520: 7265 7475 726e 2053 6361 6c61 7228 6772  return Scalar(gr
+00002530: 6170 682c 206e 616d 652c 206d 6574 6129  aph, name, meta)
+00002540: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00002550: 2066 0a0a 2020 2020 4063 6c61 7373 6d65   f..    @classme
+00002560: 7468 6f64 0a20 2020 2064 6566 205f 6765  thod.    def _ge
+00002570: 745f 6269 6e61 7279 5f6f 7065 7261 746f  t_binary_operato
+00002580: 7228 636c 732c 206f 702c 2069 6e76 3d46  r(cls, op, inv=F
+00002590: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
+000025a0: 6574 7572 6e20 6c61 6d62 6461 2073 656c  eturn lambda sel
+000025b0: 662c 206f 7468 6572 3a20 5f73 6361 6c61  f, other: _scala
+000025c0: 725f 6269 6e61 7279 286f 702c 2073 656c  r_binary(op, sel
+000025d0: 662c 206f 7468 6572 2c20 696e 763d 696e  f, other, inv=in
+000025e0: 7629 0a0a 2020 2020 6465 6620 746f 5f64  v)..    def to_d
+000025f0: 656c 6179 6564 2873 656c 662c 206f 7074  elayed(self, opt
+00002600: 696d 697a 655f 6772 6170 683d 5472 7565  imize_graph=True
+00002610: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
+00002620: 6e76 6572 7420 696e 746f 2061 2060 6064  nvert into a ``d
+00002630: 6173 6b2e 6465 6c61 7965 6460 6020 6f62  ask.delayed`` ob
+00002640: 6a65 6374 2e0a 0a20 2020 2020 2020 2050  ject...        P
+00002650: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00002660: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00002670: 2020 2020 206f 7074 696d 697a 655f 6772       optimize_gr
+00002680: 6170 6820 3a20 626f 6f6c 2c20 6f70 7469  aph : bool, opti
+00002690: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+000026a0: 2049 6620 5472 7565 205b 6465 6661 756c   If True [defaul
+000026b0: 745d 2c20 7468 6520 6772 6170 6820 6973  t], the graph is
+000026c0: 206f 7074 696d 697a 6564 2062 6566 6f72   optimized befor
+000026d0: 6520 636f 6e76 6572 7469 6e67 2069 6e74  e converting int
+000026e0: 6f0a 2020 2020 2020 2020 2020 2020 6060  o.            ``
+000026f0: 6461 736b 2e64 656c 6179 6564 6060 206f  dask.delayed`` o
+00002700: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
+00002710: 2222 220a 2020 2020 2020 2020 6473 6b20  """.        dsk 
+00002720: 3d20 7365 6c66 2e5f 5f64 6173 6b5f 6772  = self.__dask_gr
+00002730: 6170 685f 5f28 290a 2020 2020 2020 2020  aph__().        
+00002740: 6c61 7965 7220 3d20 7365 6c66 2e5f 5f64  layer = self.__d
+00002750: 6173 6b5f 6c61 7965 7273 5f5f 2829 5b30  ask_layers__()[0
+00002760: 5d0a 2020 2020 2020 2020 6966 206f 7074  ].        if opt
+00002770: 696d 697a 655f 6772 6170 683a 0a20 2020  imize_graph:.   
+00002780: 2020 2020 2020 2020 2064 736b 203d 2073           dsk = s
+00002790: 656c 662e 5f5f 6461 736b 5f6f 7074 696d  elf.__dask_optim
+000027a0: 697a 655f 5f28 6473 6b2c 2073 656c 662e  ize__(dsk, self.
+000027b0: 5f5f 6461 736b 5f6b 6579 735f 5f28 2929  __dask_keys__())
+000027c0: 0a20 2020 2020 2020 2020 2020 206c 6179  .            lay
+000027d0: 6572 203d 2022 6465 6c61 7965 642d 2220  er = "delayed-" 
+000027e0: 2b20 7365 6c66 2e5f 6e61 6d65 0a20 2020  + self._name.   
+000027f0: 2020 2020 2020 2020 2064 736b 203d 2048           dsk = H
+00002800: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+00002810: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286c  om_collections(l
+00002820: 6179 6572 2c20 6473 6b2c 2064 6570 656e  ayer, dsk, depen
+00002830: 6465 6e63 6965 733d 2829 290a 2020 2020  dencies=()).    
+00002840: 2020 2020 7265 7475 726e 2044 656c 6179      return Delay
+00002850: 6564 2873 656c 662e 6b65 792c 2064 736b  ed(self.key, dsk
+00002860: 2c20 6c61 7965 723d 6c61 7965 7229 0a0a  , layer=layer)..
+00002870: 0a64 6566 205f 7363 616c 6172 5f62 696e  .def _scalar_bin
+00002880: 6172 7928 6f70 2c20 7365 6c66 2c20 6f74  ary(op, self, ot
+00002890: 6865 722c 2069 6e76 3d46 616c 7365 293a  her, inv=False):
+000028a0: 0a20 2020 206e 616d 6520 3d20 6622 7b66  .    name = f"{f
+000028b0: 756e 636e 616d 6528 6f70 297d 2d7b 746f  uncname(op)}-{to
+000028c0: 6b65 6e69 7a65 2873 656c 662c 206f 7468  kenize(self, oth
+000028d0: 6572 297d 220a 2020 2020 6465 7065 6e64  er)}".    depend
+000028e0: 656e 6369 6573 203d 205b 7365 6c66 5d0a  encies = [self].
+000028f0: 0a20 2020 2064 736b 203d 207b 7d0a 2020  .    dsk = {}.  
+00002900: 2020 7265 7475 726e 5f74 7970 6520 3d20    return_type = 
+00002910: 6765 745f 7061 7261 6c6c 656c 5f74 7970  get_parallel_typ
+00002920: 6528 6f74 6865 7229 0a0a 2020 2020 6966  e(other)..    if
+00002930: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
+00002940: 722c 2053 6361 6c61 7229 3a0a 2020 2020  r, Scalar):.    
+00002950: 2020 2020 6465 7065 6e64 656e 6369 6573      dependencies
+00002960: 2e61 7070 656e 6428 6f74 6865 7229 0a20  .append(other). 
+00002970: 2020 2020 2020 206f 7468 6572 5f6b 6579         other_key
+00002980: 203d 2028 6f74 6865 722e 5f6e 616d 652c   = (other._name,
+00002990: 2030 290a 2020 2020 656c 6966 2069 735f   0).    elif is_
+000029a0: 6461 736b 5f63 6f6c 6c65 6374 696f 6e28  dask_collection(
+000029b0: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
+000029c0: 7265 7475 726e 204e 6f74 496d 706c 656d  return NotImplem
+000029d0: 656e 7465 640a 2020 2020 656c 7365 3a0a  ented.    else:.
+000029e0: 2020 2020 2020 2020 6f74 6865 725f 6b65          other_ke
+000029f0: 7920 3d20 6f74 6865 720a 0a20 2020 2064  y = other..    d
+00002a00: 736b 5b28 6e61 6d65 2c20 3029 5d20 3d20  sk[(name, 0)] = 
+00002a10: 280a 2020 2020 2020 2020 286f 702c 206f  (.        (op, o
+00002a20: 7468 6572 5f6b 6579 2c20 2873 656c 662e  ther_key, (self.
+00002a30: 5f6e 616d 652c 2030 2929 2069 6620 696e  _name, 0)) if in
+00002a40: 7620 656c 7365 2028 6f70 2c20 2873 656c  v else (op, (sel
+00002a50: 662e 5f6e 616d 652c 2030 292c 206f 7468  f._name, 0), oth
+00002a60: 6572 5f6b 6579 290a 2020 2020 290a 0a20  er_key).    ).. 
+00002a70: 2020 206f 7468 6572 5f6d 6574 6120 3d20     other_meta = 
+00002a80: 6d61 6b65 5f6d 6574 6128 6f74 6865 722c  make_meta(other,
+00002a90: 2070 6172 656e 745f 6d65 7461 3d73 656c   parent_meta=sel
+00002aa0: 662e 5f70 6172 656e 745f 6d65 7461 290a  f._parent_meta).
+00002ab0: 2020 2020 6f74 6865 725f 6d65 7461 5f6e      other_meta_n
+00002ac0: 6f6e 656d 7074 7920 3d20 6d65 7461 5f6e  onempty = meta_n
+00002ad0: 6f6e 656d 7074 7928 6f74 6865 725f 6d65  onempty(other_me
+00002ae0: 7461 290a 2020 2020 6966 2069 6e76 3a0a  ta).    if inv:.
+00002af0: 2020 2020 2020 2020 6d65 7461 203d 206f          meta = o
+00002b00: 7028 6f74 6865 725f 6d65 7461 5f6e 6f6e  p(other_meta_non
+00002b10: 656d 7074 792c 2073 656c 662e 5f6d 6574  empty, self._met
+00002b20: 615f 6e6f 6e65 6d70 7479 290a 2020 2020  a_nonempty).    
+00002b30: 656c 7365 3a0a 2020 2020 2020 2020 6d65  else:.        me
+00002b40: 7461 203d 206f 7028 7365 6c66 2e5f 6d65  ta = op(self._me
+00002b50: 7461 5f6e 6f6e 656d 7074 792c 206f 7468  ta_nonempty, oth
+00002b60: 6572 5f6d 6574 615f 6e6f 6e65 6d70 7479  er_meta_nonempty
+00002b70: 290a 0a20 2020 2067 7261 7068 203d 2048  )..    graph = H
+00002b80: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+00002b90: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
+00002ba0: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
+00002bb0: 656e 6369 6573 3d64 6570 656e 6465 6e63  encies=dependenc
+00002bc0: 6965 7329 0a20 2020 2069 6620 7265 7475  ies).    if retu
+00002bd0: 726e 5f74 7970 6520 6973 206e 6f74 2053  rn_type is not S
+00002be0: 6361 6c61 723a 0a20 2020 2020 2020 2072  calar:.        r
+00002bf0: 6574 7572 6e20 7265 7475 726e 5f74 7970  eturn return_typ
+00002c00: 6528 6772 6170 682c 206e 616d 652c 206d  e(graph, name, m
+00002c10: 6574 612c 205b 6f74 6865 722e 696e 6465  eta, [other.inde
+00002c20: 782e 6d69 6e28 292c 206f 7468 6572 2e69  x.min(), other.i
+00002c30: 6e64 6578 2e6d 6178 2829 5d29 0a20 2020  ndex.max()]).   
+00002c40: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
+00002c50: 6574 7572 6e20 5363 616c 6172 2867 7261  eturn Scalar(gra
+00002c60: 7068 2c20 6e61 6d65 2c20 6d65 7461 290a  ph, name, meta).
+00002c70: 0a0a 636c 6173 7320 5f46 7261 6d65 2844  ..class _Frame(D
+00002c80: 6173 6b4d 6574 686f 6473 4d69 7869 6e2c  askMethodsMixin,
+00002c90: 204f 7065 7261 746f 724d 6574 686f 644d   OperatorMethodM
+00002ca0: 6978 696e 293a 0a20 2020 2022 2222 5375  ixin):.    """Su
+00002cb0: 7065 7263 6c61 7373 2066 6f72 2044 6174  perclass for Dat
+00002cc0: 6146 7261 6d65 2061 6e64 2053 6572 6965  aFrame and Serie
+00002cd0: 730a 0a20 2020 2050 6172 616d 6574 6572  s..    Parameter
+00002ce0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00002cf0: 0a20 2020 2064 736b 3a20 6469 6374 0a20  .    dsk: dict. 
+00002d00: 2020 2020 2020 2054 6865 2064 6173 6b20         The dask 
+00002d10: 6772 6170 6820 746f 2063 6f6d 7075 7465  graph to compute
+00002d20: 2074 6869 7320 4461 7461 4672 616d 650a   this DataFrame.
+00002d30: 2020 2020 6e61 6d65 3a20 7374 720a 2020      name: str.  
+00002d40: 2020 2020 2020 5468 6520 6b65 7920 7072        The key pr
+00002d50: 6566 6978 2074 6861 7420 7370 6563 6966  efix that specif
+00002d60: 6965 7320 7768 6963 6820 6b65 7973 2069  ies which keys i
+00002d70: 6e20 7468 6520 6461 736b 2063 6f6d 7072  n the dask compr
+00002d80: 6973 6520 7468 6973 0a20 2020 2020 2020  ise this.       
+00002d90: 2070 6172 7469 6375 6c61 7220 4461 7461   particular Data
+00002da0: 4672 616d 6520 2f20 5365 7269 6573 0a20  Frame / Series. 
+00002db0: 2020 206d 6574 613a 2070 616e 6461 732e     meta: pandas.
+00002dc0: 4461 7461 4672 616d 652c 2070 616e 6461  DataFrame, panda
+00002dd0: 732e 5365 7269 6573 2c20 6f72 2070 616e  s.Series, or pan
+00002de0: 6461 732e 496e 6465 780a 2020 2020 2020  das.Index.      
+00002df0: 2020 416e 2065 6d70 7479 2070 616e 6461    An empty panda
+00002e00: 7320 6f62 6a65 6374 2077 6974 6820 6e61  s object with na
+00002e10: 6d65 732c 2064 7479 7065 732c 2061 6e64  mes, dtypes, and
+00002e20: 2069 6e64 6963 6573 206d 6174 6368 696e   indices matchin
+00002e30: 6720 7468 650a 2020 2020 2020 2020 6578  g the.        ex
+00002e40: 7065 6374 6564 206f 7574 7075 742e 0a20  pected output.. 
+00002e50: 2020 2064 6976 6973 696f 6e73 3a20 7475     divisions: tu
+00002e60: 706c 6520 6f66 2069 6e64 6578 2076 616c  ple of index val
+00002e70: 7565 730a 2020 2020 2020 2020 5661 6c75  ues.        Valu
+00002e80: 6573 2061 6c6f 6e67 2077 6869 6368 2077  es along which w
+00002e90: 6520 7061 7274 6974 696f 6e20 6f75 7220  e partition our 
+00002ea0: 626c 6f63 6b73 206f 6e20 7468 6520 696e  blocks on the in
+00002eb0: 6465 780a 2020 2020 2222 220a 0a20 2020  dex.    """..   
+00002ec0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+00002ed0: 6c66 2c20 6473 6b2c 206e 616d 652c 206d  lf, dsk, name, m
+00002ee0: 6574 612c 2064 6976 6973 696f 6e73 293a  eta, divisions):
+00002ef0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00002f00: 6973 696e 7374 616e 6365 2864 736b 2c20  isinstance(dsk, 
+00002f10: 4869 6768 4c65 7665 6c47 7261 7068 293a  HighLevelGraph):
+00002f20: 0a20 2020 2020 2020 2020 2020 2064 736b  .            dsk
+00002f30: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+00002f40: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+00002f50: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
+00002f60: 7065 6e64 656e 6369 6573 3d5b 5d29 0a20  pendencies=[]). 
+00002f70: 2020 2020 2020 2073 656c 662e 6461 736b         self.dask
+00002f80: 203d 2064 736b 0a20 2020 2020 2020 2073   = dsk.        s
+00002f90: 656c 662e 5f6e 616d 6520 3d20 6e61 6d65  elf._name = name
+00002fa0: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
+00002fb0: 6d61 6b65 5f6d 6574 6128 6d65 7461 290a  make_meta(meta).
+00002fc0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00002fd0: 656c 662e 5f69 735f 7061 7274 6974 696f  elf._is_partitio
+00002fe0: 6e5f 7479 7065 286d 6574 6129 3a0a 2020  n_type(meta):.  
+00002ff0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00003000: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+00003010: 2020 2020 2020 2020 2020 2066 2245 7870             f"Exp
+00003020: 6563 7465 6420 6d65 7461 2074 6f20 7370  ected meta to sp
+00003030: 6563 6966 7920 7479 7065 207b 7479 7065  ecify type {type
+00003040: 2873 656c 6629 2e5f 5f6e 616d 655f 5f7d  (self).__name__}
+00003050: 2c20 676f 7420 7479 7065 2022 0a20 2020  , got type ".   
+00003060: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
+00003070: 7479 7065 6e61 6d65 2874 7970 6528 6d65  typename(type(me
+00003080: 7461 2929 7d22 0a20 2020 2020 2020 2020  ta))}".         
+00003090: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+000030a0: 662e 5f6d 6574 6120 3d20 6d65 7461 0a20  f._meta = meta. 
+000030b0: 2020 2020 2020 2073 656c 662e 6469 7669         self.divi
+000030c0: 7369 6f6e 7320 3d20 7475 706c 6528 6469  sions = tuple(di
+000030d0: 7669 7369 6f6e 7329 0a0a 2020 2020 2020  visions)..      
+000030e0: 2020 2320 4f70 7469 6f6e 616c 6c79 2063    # Optionally c
+000030f0: 6173 7420 6f62 6a65 6374 2064 7479 7065  ast object dtype
+00003100: 7320 746f 2060 7079 6172 726f 7760 2073  s to `pyarrow` s
+00003110: 7472 696e 6773 0a20 2020 2020 2020 2069  trings.        i
+00003120: 6620 6461 736b 2e63 6f6e 6669 672e 6765  f dask.config.ge
+00003130: 7428 2264 6174 6166 7261 6d65 2e63 6f6e  t("dataframe.con
+00003140: 7665 7274 2d73 7472 696e 6722 293a 0a20  vert-string"):. 
+00003150: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
+00003160: 6461 736b 2e64 6174 6166 7261 6d65 2e5f  dask.dataframe._
+00003170: 7079 6172 726f 7720 696d 706f 7274 2063  pyarrow import c
+00003180: 6865 636b 5f70 7961 7272 6f77 5f73 7472  heck_pyarrow_str
+00003190: 696e 675f 7375 7070 6f72 7465 640a 0a20  ing_supported.. 
+000031a0: 2020 2020 2020 2020 2020 2063 6865 636b             check
+000031b0: 5f70 7961 7272 6f77 5f73 7472 696e 675f  _pyarrow_string_
+000031c0: 7375 7070 6f72 7465 6428 290a 0a20 2020  supported()..   
+000031d0: 2020 2020 2020 2020 2066 726f 6d20 6461           from da
+000031e0: 736b 2e64 6174 6166 7261 6d65 2e5f 7079  sk.dataframe._py
+000031f0: 6172 726f 7720 696d 706f 7274 2028 0a20  arrow import (. 
+00003200: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00003210: 735f 6f62 6a65 6374 5f73 7472 696e 675f  s_object_string_
+00003220: 6461 7461 6672 616d 652c 0a20 2020 2020  dataframe,.     
+00003230: 2020 2020 2020 2020 2020 2069 735f 6f62             is_ob
+00003240: 6a65 6374 5f73 7472 696e 675f 6474 7970  ject_string_dtyp
+00003250: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00003260: 2020 2069 735f 6f62 6a65 6374 5f73 7472     is_object_str
+00003270: 696e 675f 696e 6465 782c 0a20 2020 2020  ing_index,.     
+00003280: 2020 2020 2020 2020 2020 2069 735f 6f62             is_ob
+00003290: 6a65 6374 5f73 7472 696e 675f 7365 7269  ject_string_seri
+000032a0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+000032b0: 2020 2020 746f 5f70 7961 7272 6f77 5f73      to_pyarrow_s
+000032c0: 7472 696e 672c 0a20 2020 2020 2020 2020  tring,.         
+000032d0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+000032e0: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
+000032f0: 2020 2020 2020 2069 735f 6f62 6a65 6374         is_object
+00003300: 5f73 7472 696e 675f 6461 7461 6672 616d  _string_datafram
+00003310: 6528 6d65 7461 290a 2020 2020 2020 2020  e(meta).        
+00003320: 2020 2020 2020 2020 6f72 2069 735f 6f62          or is_ob
+00003330: 6a65 6374 5f73 7472 696e 675f 7365 7269  ject_string_seri
+00003340: 6573 286d 6574 6129 0a20 2020 2020 2020  es(meta).       
+00003350: 2020 2020 2020 2020 206f 7220 6973 5f6f           or is_o
+00003360: 626a 6563 745f 7374 7269 6e67 5f69 6e64  bject_string_ind
+00003370: 6578 286d 6574 6129 0a20 2020 2020 2020  ex(meta).       
+00003380: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00003390: 2020 2020 2020 2020 2320 5072 696f 7220          # Prior 
+000033a0: 746f 2070 616e 6461 733d 312e 342c 2060  to pandas=1.4, `
+000033b0: 7064 2e49 6e64 6578 6020 636f 756c 646e  pd.Index` couldn
+000033c0: 2774 2063 6f6e 7461 696e 2065 7874 656e  't contain exten
+000033d0: 7369 6f6e 2064 7479 7065 732e 0a20 2020  sion dtypes..   
+000033e0: 2020 2020 2020 2020 2020 2020 2023 2048               # H
+000033f0: 6572 6520 7765 2064 6f6e 2774 2063 6173  ere we don't cas
+00003400: 7420 6f62 6a65 6374 7320 746f 2070 7961  t objects to pya
+00003410: 7272 6f77 2073 7472 696e 6773 2077 6865  rrow strings whe
+00003420: 7265 206f 6e6c 7920 7468 6520 696e 6465  re only the inde
+00003430: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
+00003440: 2020 2320 636f 6e74 6169 6e73 206e 6f6e    # contains non
+00003450: 2d70 7961 7272 6f77 2073 7472 696e 6720  -pyarrow string 
+00003460: 6461 7461 2e0a 2020 2020 2020 2020 2020  data..          
+00003470: 2020 2020 2020 6966 206e 6f74 2050 414e        if not PAN
+00003480: 4441 535f 4754 5f31 3430 2061 6e64 2028  DAS_GT_140 and (
+00003490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000034a0: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
+000034b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000034c0: 735f 6f62 6a65 6374 5f73 7472 696e 675f  s_object_string_
+000034d0: 6461 7461 6672 616d 6528 6d65 7461 290a  dataframe(meta).
+000034e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000034f0: 2020 2020 2020 2020 616e 6420 6e6f 7420          and not 
+00003500: 616e 7928 6973 5f6f 626a 6563 745f 7374  any(is_object_st
+00003510: 7269 6e67 5f64 7479 7065 2864 2920 666f  ring_dtype(d) fo
+00003520: 7220 6420 696e 206d 6574 612e 6474 7970  r d in meta.dtyp
+00003530: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+00003540: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00003550: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+00003560: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00003570: 2020 2020 2020 2020 2020 2069 735f 6f62             is_ob
+00003580: 6a65 6374 5f73 7472 696e 675f 7365 7269  ject_string_seri
+00003590: 6573 286d 6574 6129 0a20 2020 2020 2020  es(meta).       
+000035a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000035b0: 2061 6e64 206e 6f74 2069 735f 6f62 6a65   and not is_obje
+000035c0: 6374 5f73 7472 696e 675f 6474 7970 6528  ct_string_dtype(
+000035d0: 6d65 7461 2e64 7479 7065 290a 2020 2020  meta.dtype).    
+000035e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000035f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00003600: 2020 2020 2020 6f72 2069 735f 6f62 6a65        or is_obje
+00003610: 6374 5f73 7472 696e 675f 696e 6465 7828  ct_string_index(
+00003620: 6d65 7461 290a 2020 2020 2020 2020 2020  meta).          
+00003630: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00003640: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00003650: 7572 6e0a 0a20 2020 2020 2020 2020 2020  urn..           
+00003660: 2020 2020 2023 2074 6869 7320 6973 2061       # this is a
+00003670: 6e20 696e 7465 726e 616c 2063 616c 6c2c  n internal call,
+00003680: 2061 6e64 2069 6620 7765 2065 6e66 6f72   and if we enfor
+00003690: 6365 206d 6574 6164 6174 612c 0a20 2020  ce metadata,.   
+000036a0: 2020 2020 2020 2020 2020 2020 2023 2069               # i
+000036b0: 7420 6d61 7920 696e 7465 7266 6572 6520  t may interfere 
+000036c0: 7768 656e 2072 6561 6469 6e67 2063 7376  when reading csv
+000036d0: 2077 6974 6820 656e 666f 7263 653d 4661   with enforce=Fa
+000036e0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+000036f0: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
+00003700: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+00003710: 2874 6f5f 7079 6172 726f 775f 7374 7269  (to_pyarrow_stri
+00003720: 6e67 2c20 656e 666f 7263 655f 6d65 7461  ng, enforce_meta
+00003730: 6461 7461 3d46 616c 7365 290a 2020 2020  data=False).    
+00003740: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00003750: 2e64 6173 6b20 3d20 7265 7375 6c74 2e64  .dask = result.d
+00003760: 6173 6b0a 2020 2020 2020 2020 2020 2020  ask.            
+00003770: 2020 2020 7365 6c66 2e5f 6e61 6d65 203d      self._name =
+00003780: 2072 6573 756c 742e 5f6e 616d 650a 2020   result._name.  
+00003790: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000037a0: 6c66 2e5f 6d65 7461 203d 2072 6573 756c  lf._meta = resul
+000037b0: 742e 5f6d 6574 610a 2020 2020 2020 2020  t._meta.        
+000037c0: 2020 2020 2020 2020 7365 6c66 2e64 6976          self.div
+000037d0: 6973 696f 6e73 203d 2072 6573 756c 742e  isions = result.
+000037e0: 6469 7669 7369 6f6e 730a 0a20 2020 2064  divisions..    d
+000037f0: 6566 205f 5f64 6173 6b5f 6772 6170 685f  ef __dask_graph_
+00003800: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00003810: 2072 6574 7572 6e20 7365 6c66 2e64 6173   return self.das
+00003820: 6b0a 0a20 2020 2064 6566 205f 5f64 6173  k..    def __das
+00003830: 6b5f 6b65 7973 5f5f 2873 656c 6629 202d  k_keys__(self) -
+00003840: 3e20 6c69 7374 5b48 6173 6861 626c 655d  > list[Hashable]
+00003850: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00003860: 205b 2873 656c 662e 5f6e 616d 652c 2069   [(self._name, i
+00003870: 2920 666f 7220 6920 696e 2072 616e 6765  ) for i in range
+00003880: 2873 656c 662e 6e70 6172 7469 7469 6f6e  (self.npartition
+00003890: 7329 5d0a 0a20 2020 2064 6566 205f 5f64  s)]..    def __d
+000038a0: 6173 6b5f 6c61 7965 7273 5f5f 2873 656c  ask_layers__(sel
+000038b0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+000038c0: 726e 2028 7365 6c66 2e5f 6e61 6d65 2c29  rn (self._name,)
+000038d0: 0a0a 2020 2020 6465 6620 5f5f 6461 736b  ..    def __dask
+000038e0: 5f74 6f6b 656e 697a 655f 5f28 7365 6c66  _tokenize__(self
+000038f0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00003900: 6e20 7365 6c66 2e5f 6e61 6d65 0a0a 2020  n self._name..  
+00003910: 2020 5f5f 6461 736b 5f6f 7074 696d 697a    __dask_optimiz
+00003920: 655f 5f20 3d20 676c 6f62 616c 6d65 7468  e__ = globalmeth
+00003930: 6f64 280a 2020 2020 2020 2020 6f70 7469  od(.        opti
+00003940: 6d69 7a65 2c20 6b65 793d 2264 6174 6166  mize, key="dataf
+00003950: 7261 6d65 5f6f 7074 696d 697a 6522 2c20  rame_optimize", 
+00003960: 6661 6c73 6579 3d64 6f6e 745f 6f70 7469  falsey=dont_opti
+00003970: 6d69 7a65 0a20 2020 2029 0a20 2020 205f  mize.    ).    _
+00003980: 5f64 6173 6b5f 7363 6865 6475 6c65 725f  _dask_scheduler_
+00003990: 5f20 3d20 7374 6174 6963 6d65 7468 6f64  _ = staticmethod
+000039a0: 2844 4546 4155 4c54 5f47 4554 290a 0a20  (DEFAULT_GET).. 
+000039b0: 2020 2064 6566 205f 5f64 6173 6b5f 706f     def __dask_po
+000039c0: 7374 636f 6d70 7574 655f 5f28 7365 6c66  stcompute__(self
+000039d0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000039e0: 6e20 6669 6e61 6c69 7a65 2c20 2829 0a0a  n finalize, ()..
+000039f0: 2020 2020 6465 6620 5f5f 6461 736b 5f70      def __dask_p
+00003a00: 6f73 7470 6572 7369 7374 5f5f 2873 656c  ostpersist__(sel
+00003a10: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00003a20: 726e 2073 656c 662e 5f72 6562 7569 6c64  rn self._rebuild
+00003a30: 2c20 2829 0a0a 2020 2020 6465 6620 5f72  , ()..    def _r
+00003a40: 6562 7569 6c64 2873 656c 662c 2064 736b  ebuild(self, dsk
+00003a50: 2c20 2a2c 2072 656e 616d 653d 4e6f 6e65  , *, rename=None
+00003a60: 293a 0a20 2020 2020 2020 206e 616d 6520  ):.        name 
+00003a70: 3d20 7365 6c66 2e5f 6e61 6d65 0a20 2020  = self._name.   
+00003a80: 2020 2020 2069 6620 7265 6e61 6d65 3a0a       if rename:.
+00003a90: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00003aa0: 203d 2072 656e 616d 652e 6765 7428 6e61   = rename.get(na
+00003ab0: 6d65 2c20 6e61 6d65 290a 2020 2020 2020  me, name).      
+00003ac0: 2020 7265 7475 726e 2074 7970 6528 7365    return type(se
+00003ad0: 6c66 2928 6473 6b2c 206e 616d 652c 2073  lf)(dsk, name, s
+00003ae0: 656c 662e 5f6d 6574 612c 2073 656c 662e  elf._meta, self.
+00003af0: 6469 7669 7369 6f6e 7329 0a0a 2020 2020  divisions)..    
+00003b00: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00003b10: 6620 5f63 6f6e 7374 7275 6374 6f72 2873  f _constructor(s
+00003b20: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00003b30: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
+00003b40: 6374 0a0a 2020 2020 4070 726f 7065 7274  ct..    @propert
+00003b50: 790a 2020 2020 6465 6620 6469 7669 7369  y.    def divisi
+00003b60: 6f6e 7328 7365 6c66 293a 0a20 2020 2020  ons(self):.     
+00003b70: 2020 2022 2222 0a20 2020 2020 2020 2054     """.        T
+00003b80: 7570 6c65 206f 6620 6060 6e70 6172 7469  uple of ``nparti
+00003b90: 7469 6f6e 7320 2b20 3160 6020 7661 6c75  tions + 1`` valu
+00003ba0: 6573 2c20 696e 2061 7363 656e 6469 6e67  es, in ascending
+00003bb0: 206f 7264 6572 2c20 6d61 726b 696e 6720   order, marking 
+00003bc0: 7468 650a 2020 2020 2020 2020 6c6f 7765  the.        lowe
+00003bd0: 722f 7570 7065 7220 626f 756e 6473 206f  r/upper bounds o
+00003be0: 6620 6561 6368 2070 6172 7469 7469 6f6e  f each partition
+00003bf0: 2773 2069 6e64 6578 2e20 4469 7669 7369  's index. Divisi
+00003c00: 6f6e 7320 616c 6c6f 7720 4461 736b 0a20  ons allow Dask. 
+00003c10: 2020 2020 2020 2074 6f20 6b6e 6f77 2077         to know w
+00003c20: 6869 6368 2070 6172 7469 7469 6f6e 2077  hich partition w
+00003c30: 696c 6c20 636f 6e74 6169 6e20 6120 6769  ill contain a gi
+00003c40: 7665 6e20 7661 6c75 652c 2073 6967 6e69  ven value, signi
+00003c50: 6669 6361 6e74 6c79 0a20 2020 2020 2020  ficantly.       
+00003c60: 2073 7065 6564 696e 6720 7570 206f 7065   speeding up ope
+00003c70: 7261 7469 6f6e 7320 6c69 6b65 2060 6c6f  rations like `lo
+00003c80: 6360 2c20 606d 6572 6765 602c 2061 6e64  c`, `merge`, and
+00003c90: 2060 6772 6f75 7062 7960 2062 7920 6e6f   `groupby` by no
+00003ca0: 740a 2020 2020 2020 2020 6861 7669 6e67  t.        having
+00003cb0: 2074 6f20 7365 6172 6368 2074 6865 2066   to search the f
+00003cc0: 756c 6c20 6461 7461 7365 742e 0a0a 2020  ull dataset...  
+00003cd0: 2020 2020 2020 4578 616d 706c 653a 2066        Example: f
+00003ce0: 6f72 2060 6064 6976 6973 696f 6e73 203d  or ``divisions =
+00003cf0: 2028 302c 2031 302c 2035 302c 2031 3030   (0, 10, 50, 100
+00003d00: 2960 602c 2074 6865 7265 2061 7265 2074  )``, there are t
+00003d10: 6872 6565 2070 6172 7469 7469 6f6e 732c  hree partitions,
+00003d20: 0a20 2020 2020 2020 2077 6865 7265 2074  .        where t
+00003d30: 6865 2069 6e64 6578 2069 6e20 6561 6368  he index in each
+00003d40: 2070 6172 7469 7469 6f6e 2063 6f6e 7461   partition conta
+00003d50: 696e 7320 7661 6c75 6573 205b 302c 2031  ins values [0, 1
+00003d60: 3029 2c20 5b31 302c 2035 3029 2c0a 2020  0), [10, 50),.  
+00003d70: 2020 2020 2020 616e 6420 5b35 302c 2031        and [50, 1
+00003d80: 3030 5d2c 2072 6573 7065 6374 6976 656c  00], respectivel
+00003d90: 792e 2044 6173 6b20 7468 6572 6566 6f72  y. Dask therefor
+00003da0: 6520 6b6e 6f77 7320 6060 6466 2e6c 6f63  e knows ``df.loc
+00003db0: 5b34 355d 6060 0a20 2020 2020 2020 2077  [45]``.        w
+00003dc0: 696c 6c20 6265 2069 6e20 7468 6520 7365  ill be in the se
+00003dd0: 636f 6e64 2070 6172 7469 7469 6f6e 2e0a  cond partition..
+00003de0: 0a20 2020 2020 2020 2057 6865 6e20 6576  .        When ev
+00003df0: 6572 7920 6974 656d 2069 6e20 6060 6469  ery item in ``di
+00003e00: 7669 7369 6f6e 7360 6020 6973 2060 604e  visions`` is ``N
+00003e10: 6f6e 6560 602c 2074 6865 2064 6976 6973  one``, the divis
+00003e20: 696f 6e73 2061 7265 2075 6e6b 6e6f 776e  ions are unknown
+00003e30: 2e0a 2020 2020 2020 2020 4d6f 7374 206f  ..        Most o
+00003e40: 7065 7261 7469 6f6e 7320 6361 6e20 7374  perations can st
+00003e50: 696c 6c20 6265 2070 6572 666f 726d 6564  ill be performed
+00003e60: 2c20 6275 7420 736f 6d65 2077 696c 6c20  , but some will 
+00003e70: 6265 206d 7563 6820 736c 6f77 6572 2c0a  be much slower,.
+00003e80: 2020 2020 2020 2020 616e 6420 6120 6665          and a fe
+00003e90: 7720 6d61 7920 6661 696c 2e0a 0a20 2020  w may fail...   
+00003ea0: 2020 2020 2049 7420 6973 2075 6e63 6f6d       It is uncom
+00003eb0: 6d6f 6e20 746f 2073 6574 2060 6064 6976  mon to set ``div
+00003ec0: 6973 696f 6e73 6060 2064 6972 6563 746c  isions`` directl
+00003ed0: 792e 2049 6e73 7465 6164 2c20 7573 6520  y. Instead, use 
+00003ee0: 6060 7365 745f 696e 6465 7860 602c 0a20  ``set_index``,. 
+00003ef0: 2020 2020 2020 2077 6869 6368 2073 6f72         which sor
+00003f00: 7473 2061 6e64 2073 706c 6974 7320 7468  ts and splits th
+00003f10: 6520 6461 7461 2061 7320 6e65 6564 6564  e data as needed
+00003f20: 2e0a 2020 2020 2020 2020 5365 6520 6874  ..        See ht
+00003f30: 7470 733a 2f2f 646f 6373 2e64 6173 6b2e  tps://docs.dask.
+00003f40: 6f72 672f 656e 2f6c 6174 6573 742f 6461  org/en/latest/da
+00003f50: 7461 6672 616d 652d 6465 7369 676e 2e68  taframe-design.h
+00003f60: 746d 6c23 7061 7274 6974 696f 6e73 2e0a  tml#partitions..
+00003f70: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00003f80: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00003f90: 5f64 6976 6973 696f 6e73 0a0a 2020 2020  _divisions..    
+00003fa0: 4064 6976 6973 696f 6e73 2e73 6574 7465  @divisions.sette
+00003fb0: 720a 2020 2020 6465 6620 6469 7669 7369  r.    def divisi
+00003fc0: 6f6e 7328 7365 6c66 2c20 7661 6c75 6529  ons(self, value)
+00003fd0: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
+00003fe0: 2069 7369 6e73 7461 6e63 6528 7661 6c75   isinstance(valu
+00003ff0: 652c 2074 7570 6c65 293a 0a20 2020 2020  e, tuple):.     
+00004000: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00004010: 6545 7272 6f72 2822 6469 7669 7369 6f6e  eError("division
+00004020: 7320 6d75 7374 2062 6520 6120 7475 706c  s must be a tupl
+00004030: 6522 290a 0a20 2020 2020 2020 2069 6620  e")..        if 
+00004040: 6861 7361 7474 7228 7365 6c66 2c20 225f  hasattr(self, "_
+00004050: 6469 7669 7369 6f6e 7322 2920 616e 6420  divisions") and 
+00004060: 6c65 6e28 7661 6c75 6529 2021 3d20 6c65  len(value) != le
+00004070: 6e28 7365 6c66 2e5f 6469 7669 7369 6f6e  n(self._division
+00004080: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00004090: 6e20 3d20 6c65 6e28 7365 6c66 2e5f 6469  n = len(self._di
+000040a0: 7669 7369 6f6e 7329 0a20 2020 2020 2020  visions).       
+000040b0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+000040c0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000040d0: 2020 2020 2020 2066 2254 6869 7320 6461         f"This da
+000040e0: 7461 6672 616d 6520 6861 7320 6e70 6172  taframe has npar
+000040f0: 7469 7469 6f6e 733d 7b6e 202d 2031 7d2c  titions={n - 1},
+00004100: 2064 6976 6973 696f 6e73 2073 686f 756c   divisions shoul
+00004110: 6420 6265 2061 2022 0a20 2020 2020 2020  d be a ".       
+00004120: 2020 2020 2020 2020 2066 2274 7570 6c65           f"tuple
+00004130: 206f 6620 6c65 6e67 7468 3d7b 6e7d 2c20   of length={n}, 
+00004140: 676f 7420 7b6c 656e 2876 616c 7565 297d  got {len(value)}
+00004150: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+00004160: 0a20 2020 2020 2020 2069 6620 4e6f 6e65  .        if None
+00004170: 2069 6e20 7661 6c75 653a 0a20 2020 2020   in value:.     
+00004180: 2020 2020 2020 2069 6620 616e 7928 7620         if any(v 
+00004190: 6973 206e 6f74 204e 6f6e 6520 666f 7220  is not None for 
+000041a0: 7620 696e 2076 616c 7565 293a 0a20 2020  v in value):.   
+000041b0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000041c0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+000041d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000041e0: 2020 2022 6469 7669 7369 6f6e 7320 6d61     "divisions ma
+000041f0: 7920 6e6f 7420 636f 6e74 6169 6e20 6120  y not contain a 
+00004200: 6d69 7820 6f66 204e 6f6e 6520 616e 6420  mix of None and 
+00004210: 6e6f 6e2d 4e6f 6e65 2076 616c 7565 7322  non-None values"
+00004220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004230: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
+00004240: 0a20 2020 2020 2020 2020 2020 2023 204b  .            # K
+00004250: 6e6f 776e 2064 6976 6973 696f 6e73 2c20  nown divisions, 
+00004260: 6368 6563 6b20 6d6f 6e6f 746f 6e69 6361  check monotonica
+00004270: 6c6c 7920 696e 6372 6561 7369 6e67 0a0a  lly increasing..
+00004280: 2020 2020 2020 2020 2020 2020 2320 5858              # XX
+00004290: 583a 2069 6620 7468 6520 696e 6465 7820  X: if the index 
+000042a0: 6474 7970 6520 6973 2061 6e20 6f72 6465  dtype is an orde
+000042b0: 7265 6420 6361 7465 676f 7269 6361 6c20  red categorical 
+000042c0: 6474 7970 652c 2074 6865 6e20 7765 2073  dtype, then we s
+000042d0: 6b69 7020 7468 650a 2020 2020 2020 2020  kip the.        
+000042e0: 2020 2020 2320 736f 7274 6564 6e65 7373      # sortedness
+000042f0: 2063 6865 636b 2c20 7369 6e63 6520 7468   check, since th
+00004300: 6520 6f72 6465 7220 6973 2064 7479 7065  e order is dtype
+00004310: 2064 6570 656e 6465 6e74 0a20 2020 2020   dependent.     
+00004320: 2020 2020 2020 2069 6e64 6578 5f64 7479         index_dty
+00004330: 7065 203d 2067 6574 6174 7472 2873 656c  pe = getattr(sel
+00004340: 662e 5f6d 6574 612c 2022 696e 6465 7822  f._meta, "index"
+00004350: 2c20 7365 6c66 2e5f 6d65 7461 292e 6474  , self._meta).dt
+00004360: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
+00004370: 6966 206e 6f74 2028 0a20 2020 2020 2020  if not (.       
+00004380: 2020 2020 2020 2020 2069 7369 6e73 7461           isinsta
+00004390: 6e63 6528 696e 6465 785f 6474 7970 652c  nce(index_dtype,
+000043a0: 2070 642e 4361 7465 676f 7269 6361 6c44   pd.CategoricalD
+000043b0: 7479 7065 2920 616e 6420 696e 6465 785f  type) and index_
+000043c0: 6474 7970 652e 6f72 6465 7265 640a 2020  dtype.ordered.  
+000043d0: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
+000043e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000043f0: 7661 6c75 6520 213d 2074 7570 6c65 2873  value != tuple(s
+00004400: 6f72 7465 6428 7661 6c75 6529 293a 0a20  orted(value)):. 
+00004410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004420: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00004430: 726f 7228 2264 6976 6973 696f 6e73 206d  ror("divisions m
+00004440: 7573 7420 6265 2073 6f72 7465 6422 290a  ust be sorted").
+00004450: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
+00004460: 6976 6973 696f 6e73 203d 2076 616c 7565  ivisions = value
+00004470: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00004480: 2020 2020 6465 6620 6e70 6172 7469 7469      def npartiti
+00004490: 6f6e 7328 7365 6c66 2920 2d3e 2069 6e74  ons(self) -> int
+000044a0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+000044b0: 7572 6e20 6e75 6d62 6572 206f 6620 7061  urn number of pa
+000044c0: 7274 6974 696f 6e73 2222 220a 2020 2020  rtitions""".    
+000044d0: 2020 2020 7265 7475 726e 206c 656e 2873      return len(s
+000044e0: 656c 662e 6469 7669 7369 6f6e 7329 202d  elf.divisions) -
+000044f0: 2031 0a0a 2020 2020 4070 726f 7065 7274   1..    @propert
+00004500: 790a 2020 2020 4064 6572 6976 6564 5f66  y.    @derived_f
+00004510: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+00004520: 290a 2020 2020 6465 6620 6174 7472 7328  ).    def attrs(
+00004530: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00004540: 6574 7572 6e20 7365 6c66 2e5f 6d65 7461  eturn self._meta
+00004550: 2e61 7474 7273 0a0a 2020 2020 4061 7474  .attrs..    @att
+00004560: 7273 2e73 6574 7465 720a 2020 2020 6465  rs.setter.    de
+00004570: 6620 6174 7472 7328 7365 6c66 2c20 7661  f attrs(self, va
+00004580: 6c75 6529 3a0a 2020 2020 2020 2020 7365  lue):.        se
+00004590: 6c66 2e5f 6d65 7461 2e61 7474 7273 203d  lf._meta.attrs =
+000045a0: 2064 6963 7428 7661 6c75 6529 0a0a 2020   dict(value)..  
+000045b0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+000045c0: 6465 6620 7369 7a65 2873 656c 6629 3a0a  def size(self):.
+000045d0: 2020 2020 2020 2020 2222 2253 697a 6520          """Size 
+000045e0: 6f66 2074 6865 2053 6572 6965 7320 6f72  of the Series or
+000045f0: 2044 6174 6146 7261 6d65 2061 7320 6120   DataFrame as a 
+00004600: 4465 6c61 7965 6420 6f62 6a65 6374 2e0a  Delayed object..
+00004610: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00004620: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00004630: 2d2d 0a20 2020 2020 2020 203e 3e3e 2073  --.        >>> s
+00004640: 6572 6965 732e 7369 7a65 2020 2320 646f  eries.size  # do
+00004650: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
+00004660: 2020 2020 2064 642e 5363 616c 6172 3c73       dd.Scalar<s
+00004670: 697a 652d 6167 2e2e 2e2c 2064 7479 7065  ize-ag..., dtype
+00004680: 3d69 6e74 3634 3e0a 2020 2020 2020 2020  =int64>.        
+00004690: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+000046a0: 726e 2073 656c 662e 7265 6475 6374 696f  rn self.reductio
+000046b0: 6e28 0a20 2020 2020 2020 2020 2020 206d  n(.            m
+000046c0: 6574 686f 6473 2e73 697a 652c 206e 702e  ethods.size, np.
+000046d0: 7375 6d2c 2074 6f6b 656e 3d22 7369 7a65  sum, token="size
+000046e0: 222c 206d 6574 613d 696e 742c 2073 706c  ", meta=int, spl
+000046f0: 6974 5f65 7665 7279 3d46 616c 7365 0a20  it_every=False. 
+00004700: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
+00004710: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00004720: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2873  _meta_nonempty(s
+00004730: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00004740: 2241 206e 6f6e 2d65 6d70 7479 2076 6572  "A non-empty ver
+00004750: 7369 6f6e 206f 6620 605f 6d65 7461 6020  sion of `_meta` 
+00004760: 7769 7468 2066 616b 6520 6461 7461 2e22  with fake data."
+00004770: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00004780: 6e20 6d65 7461 5f6e 6f6e 656d 7074 7928  n meta_nonempty(
+00004790: 7365 6c66 2e5f 6d65 7461 290a 0a20 2020  self._meta)..   
+000047a0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000047b0: 6566 205f 6172 6773 2873 656c 6629 3a0a  ef _args(self):.
+000047c0: 2020 2020 2020 2020 7265 7475 726e 2028          return (
+000047d0: 7365 6c66 2e64 6173 6b2c 2073 656c 662e  self.dask, self.
+000047e0: 5f6e 616d 652c 2073 656c 662e 5f6d 6574  _name, self._met
+000047f0: 612c 2073 656c 662e 6469 7669 7369 6f6e  a, self.division
+00004800: 7329 0a0a 2020 2020 6465 6620 5f5f 6765  s)..    def __ge
+00004810: 7473 7461 7465 5f5f 2873 656c 6629 3a0a  tstate__(self):.
+00004820: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00004830: 656c 662e 5f61 7267 730a 0a20 2020 2064  elf._args..    d
+00004840: 6566 205f 5f73 6574 7374 6174 655f 5f28  ef __setstate__(
+00004850: 7365 6c66 2c20 7374 6174 6529 3a0a 2020  self, state):.  
+00004860: 2020 2020 2020 7365 6c66 2e64 6173 6b2c        self.dask,
+00004870: 2073 656c 662e 5f6e 616d 652c 2073 656c   self._name, sel
+00004880: 662e 5f6d 6574 612c 2073 656c 662e 5f64  f._meta, self._d
+00004890: 6976 6973 696f 6e73 203d 2073 7461 7465  ivisions = state
+000048a0: 0a0a 2020 2020 6465 6620 636f 7079 2873  ..    def copy(s
+000048b0: 656c 662c 2064 6565 703d 4661 6c73 6529  elf, deep=False)
+000048c0: 3a0a 2020 2020 2020 2020 2222 224d 616b  :.        """Mak
+000048d0: 6520 6120 636f 7079 206f 6620 7468 6520  e a copy of the 
+000048e0: 6461 7461 6672 616d 650a 0a20 2020 2020  dataframe..     
+000048f0: 2020 2054 6869 7320 6973 2073 7472 6963     This is stric
+00004900: 746c 7920 6120 7368 616c 6c6f 7720 636f  tly a shallow co
+00004910: 7079 206f 6620 7468 6520 756e 6465 726c  py of the underl
+00004920: 7969 6e67 2063 6f6d 7075 7461 7469 6f6e  ying computation
+00004930: 616c 2067 7261 7068 2e0a 2020 2020 2020  al graph..      
+00004940: 2020 4974 2064 6f65 7320 6e6f 7420 6166    It does not af
+00004950: 6665 6374 2074 6865 2075 6e64 6572 6c79  fect the underly
+00004960: 696e 6720 6461 7461 0a0a 2020 2020 2020  ing data..      
+00004970: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00004980: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00004990: 2020 2020 2020 2020 6465 6570 203a 2062          deep : b
+000049a0: 6f6f 6c65 616e 2c20 6465 6661 756c 7420  oolean, default 
+000049b0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+000049c0: 2020 5468 6520 6465 6570 2076 616c 7565    The deep value
+000049d0: 206d 7573 7420 6265 2060 4661 6c73 6560   must be `False`
+000049e0: 2061 6e64 2069 7420 6973 2064 6563 6c61   and it is decla
+000049f0: 7265 6420 6173 2061 2070 6172 616d 6574  red as a paramet
+00004a00: 6572 206a 7573 7420 666f 720a 2020 2020  er just for.    
+00004a10: 2020 2020 2020 2020 636f 6d70 6174 6962          compatib
+00004a20: 696c 6974 7920 7769 7468 2074 6869 7264  ility with third
+00004a30: 2d70 6172 7479 206c 6962 7261 7269 6573  -party libraries
+00004a40: 206c 696b 6520 6375 4446 0a20 2020 2020   like cuDF.     
+00004a50: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+00004a60: 6620 6465 6570 2069 7320 6e6f 7420 4661  f deep is not Fa
+00004a70: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00004a80: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00004a90: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00004aa0: 2020 2022 5468 6520 6064 6565 7060 2076     "The `deep` v
+00004ab0: 616c 7565 206d 7573 7420 6265 2046 616c  alue must be Fal
+00004ac0: 7365 2e20 5468 6973 2069 7320 7374 7269  se. This is stri
+00004ad0: 6374 6c79 2061 2073 6861 6c6c 6f77 2063  ctly a shallow c
+00004ae0: 6f70 7920 220a 2020 2020 2020 2020 2020  opy ".          
+00004af0: 2020 2020 2020 226f 6620 7468 6520 756e        "of the un
+00004b00: 6465 726c 7969 6e67 2063 6f6d 7075 7461  derlying computa
+00004b10: 7469 6f6e 616c 2067 7261 7068 2e22 0a20  tional graph.". 
+00004b20: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00004b30: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00004b40: 6464 5f6f 626a 6563 7428 7365 6c66 2e64  dd_object(self.d
+00004b50: 6173 6b2c 2073 656c 662e 5f6e 616d 652c  ask, self._name,
+00004b60: 2073 656c 662e 5f6d 6574 612c 2073 656c   self._meta, sel
+00004b70: 662e 6469 7669 7369 6f6e 7329 0a0a 2020  f.divisions)..  
+00004b80: 2020 6465 6620 5f5f 6172 7261 795f 5f28    def __array__(
+00004b90: 7365 6c66 2c20 6474 7970 653d 4e6f 6e65  self, dtype=None
+00004ba0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00004bb0: 2020 2020 2073 656c 662e 5f63 6f6d 7075       self._compu
+00004bc0: 7465 6420 3d20 7365 6c66 2e63 6f6d 7075  ted = self.compu
+00004bd0: 7465 2829 0a20 2020 2020 2020 2078 203d  te().        x =
+00004be0: 206e 702e 6172 7261 7928 7365 6c66 2e5f   np.array(self._
+00004bf0: 636f 6d70 7574 6564 290a 2020 2020 2020  computed).      
+00004c00: 2020 7265 7475 726e 2078 0a0a 2020 2020    return x..    
+00004c10: 6465 6620 5f5f 6172 7261 795f 7772 6170  def __array_wrap
+00004c20: 5f5f 2873 656c 662c 2061 7272 6179 2c20  __(self, array, 
+00004c30: 636f 6e74 6578 743d 4e6f 6e65 293a 0a20  context=None):. 
+00004c40: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00004c50: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00004c60: 0a0a 2020 2020 6465 6620 5f5f 6172 7261  ..    def __arra
+00004c70: 795f 7566 756e 635f 5f28 7365 6c66 2c20  y_ufunc__(self, 
+00004c80: 6e75 6d70 795f 7566 756e 632c 206d 6574  numpy_ufunc, met
+00004c90: 686f 642c 202a 696e 7075 7473 2c20 2a2a  hod, *inputs, **
+00004ca0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+00004cb0: 206f 7574 203d 206b 7761 7267 732e 6765   out = kwargs.ge
+00004cc0: 7428 226f 7574 222c 2028 2929 0a20 2020  t("out", ()).   
+00004cd0: 2020 2020 2066 6f72 2078 2069 6e20 696e       for x in in
+00004ce0: 7075 7473 202b 206f 7574 3a0a 2020 2020  puts + out:.    
+00004cf0: 2020 2020 2020 2020 2320 7566 756e 6373          # ufuncs
+00004d00: 2077 6f72 6b20 7769 7468 2030 2d64 696d   work with 0-dim
+00004d10: 656e 7369 6f6e 616c 204e 756d 5079 206e  ensional NumPy n
+00004d20: 6461 7272 6179 730a 2020 2020 2020 2020  darrays.        
+00004d30: 2020 2020 2320 736f 2077 6520 646f 6e27      # so we don'
+00004d40: 7420 7761 6e74 2074 6f20 7261 6973 6520  t want to raise 
+00004d50: 4e6f 7449 6d70 6c65 6d65 6e74 6564 0a20  NotImplemented. 
+00004d60: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00004d70: 696e 7374 616e 6365 2878 2c20 6e70 2e6e  instance(x, np.n
+00004d80: 6461 7272 6179 2920 616e 6420 782e 7368  darray) and x.sh
+00004d90: 6170 6520 3d3d 2028 293a 0a20 2020 2020  ape == ():.     
+00004da0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+00004db0: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
+00004dc0: 656c 6966 206e 6f74 2069 7369 6e73 7461  elif not isinsta
+00004dd0: 6e63 6528 0a20 2020 2020 2020 2020 2020  nce(.           
+00004de0: 2020 2020 2078 2c20 284e 756d 6265 722c       x, (Number,
+00004df0: 2053 6361 6c61 722c 205f 4672 616d 652c   Scalar, _Frame,
+00004e00: 2041 7272 6179 2c20 7064 2e44 6174 6146   Array, pd.DataF
+00004e10: 7261 6d65 2c20 7064 2e53 6572 6965 732c  rame, pd.Series,
+00004e20: 2070 642e 496e 6465 7829 0a20 2020 2020   pd.Index).     
+00004e30: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00004e40: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00004e50: 204e 6f74 496d 706c 656d 656e 7465 640a   NotImplemented.
+00004e60: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
+00004e70: 6f64 203d 3d20 225f 5f63 616c 6c5f 5f22  od == "__call__"
+00004e80: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00004e90: 206e 756d 7079 5f75 6675 6e63 2e73 6967   numpy_ufunc.sig
+00004ea0: 6e61 7475 7265 2069 7320 6e6f 7420 4e6f  nature is not No
+00004eb0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00004ec0: 2020 2020 7265 7475 726e 204e 6f74 496d      return NotIm
+00004ed0: 706c 656d 656e 7465 640a 2020 2020 2020  plemented.      
+00004ee0: 2020 2020 2020 6966 206e 756d 7079 5f75        if numpy_u
+00004ef0: 6675 6e63 2e6e 6f75 7420 3e20 313a 0a20  func.nout > 1:. 
+00004f00: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00004f10: 2075 6675 6e63 7320 7769 7468 206d 756c   ufuncs with mul
+00004f20: 7469 706c 6520 6f75 7470 7574 2076 616c  tiple output val
+00004f30: 7565 730a 2020 2020 2020 2020 2020 2020  ues.            
+00004f40: 2020 2020 2320 6172 6520 6e6f 7420 7965      # are not ye
+00004f50: 7420 7375 7070 6f72 7465 6420 666f 7220  t supported for 
+00004f60: 6672 616d 6573 0a20 2020 2020 2020 2020  frames.         
+00004f70: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+00004f80: 7449 6d70 6c65 6d65 6e74 6564 0a20 2020  tImplemented.   
+00004f90: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00004fa0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00004fb0: 6574 7572 6e20 656c 656d 7769 7365 286e  eturn elemwise(n
+00004fc0: 756d 7079 5f75 6675 6e63 2c20 2a69 6e70  umpy_ufunc, *inp
+00004fd0: 7574 732c 202a 2a6b 7761 7267 7329 0a20  uts, **kwargs). 
+00004fe0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00004ff0: 2020 2020 2020 2020 2023 2075 6675 6e63           # ufunc
+00005000: 206d 6574 686f 6473 2061 7265 206e 6f74   methods are not
+00005010: 2079 6574 2073 7570 706f 7274 6564 2066   yet supported f
+00005020: 6f72 2066 7261 6d65 730a 2020 2020 2020  or frames.      
+00005030: 2020 2020 2020 7265 7475 726e 204e 6f74        return Not
+00005040: 496d 706c 656d 656e 7465 640a 0a20 2020  Implemented..   
+00005050: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00005060: 6566 205f 656c 656d 7769 7365 2873 656c  ef _elemwise(sel
+00005070: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00005080: 726e 2065 6c65 6d77 6973 650a 0a20 2020  rn elemwise..   
+00005090: 2064 6566 205f 7265 7072 5f64 6174 6128   def _repr_data(
+000050a0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+000050b0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+000050c0: 7465 6445 7272 6f72 0a0a 2020 2020 4070  tedError..    @p
+000050d0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+000050e0: 5f72 6570 725f 6469 7669 7369 6f6e 7328  _repr_divisions(
+000050f0: 7365 6c66 293a 0a20 2020 2020 2020 206e  self):.        n
+00005100: 616d 6520 3d20 6622 6e70 6172 7469 7469  ame = f"npartiti
+00005110: 6f6e 733d 7b73 656c 662e 6e70 6172 7469  ons={self.nparti
+00005120: 7469 6f6e 737d 220a 2020 2020 2020 2020  tions}".        
+00005130: 6966 2073 656c 662e 6b6e 6f77 6e5f 6469  if self.known_di
+00005140: 7669 7369 6f6e 733a 0a20 2020 2020 2020  visions:.       
+00005150: 2020 2020 2064 6976 6973 696f 6e73 203d       divisions =
+00005160: 2070 642e 496e 6465 7828 7365 6c66 2e64   pd.Index(self.d
+00005170: 6976 6973 696f 6e73 2c20 6e61 6d65 3d6e  ivisions, name=n
+00005180: 616d 6529 0a20 2020 2020 2020 2065 6c73  ame).        els
+00005190: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+000051a0: 2061 766f 6964 2074 6f20 6265 2063 6f6e   avoid to be con
+000051b0: 7665 7274 6564 2074 6f20 4e61 4e0a 2020  verted to NaN.  
+000051c0: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
+000051d0: 6f6e 7320 3d20 7064 2e49 6e64 6578 285b  ons = pd.Index([
+000051e0: 2222 5d20 2a20 2873 656c 662e 6e70 6172  ""] * (self.npar
+000051f0: 7469 7469 6f6e 7320 2b20 3129 2c20 6e61  titions + 1), na
+00005200: 6d65 3d6e 616d 6529 0a20 2020 2020 2020  me=name).       
+00005210: 2072 6574 7572 6e20 6469 7669 7369 6f6e   return division
+00005220: 730a 0a20 2020 2064 6566 205f 5f72 6570  s..    def __rep
+00005230: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
+00005240: 2020 2064 6174 6120 3d20 7365 6c66 2e5f     data = self._
+00005250: 7265 7072 5f64 6174 6128 292e 746f 5f73  repr_data().to_s
+00005260: 7472 696e 6728 6d61 785f 726f 7773 3d35  tring(max_rows=5
+00005270: 2c20 7368 6f77 5f64 696d 656e 7369 6f6e  , show_dimension
+00005280: 733d 4661 6c73 6529 0a20 2020 2020 2020  s=False).       
+00005290: 205f 7374 725f 666d 7420 3d20 2222 2244   _str_fmt = """D
+000052a0: 6173 6b20 7b6b 6c61 7373 7d20 5374 7275  ask {klass} Stru
+000052b0: 6374 7572 653a 0a7b 6461 7461 7d0a 4461  cture:.{data}.Da
+000052c0: 736b 204e 616d 653a 207b 6e61 6d65 7d2c  sk Name: {name},
+000052d0: 207b 6c61 7965 7273 7d22 2222 0a20 2020   {layers}""".   
+000052e0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+000052f0: 2e63 6f6c 756d 6e73 2920 3d3d 2030 3a0a  .columns) == 0:.
+00005300: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00005310: 203d 2064 6174 612e 7061 7274 6974 696f   = data.partitio
+00005320: 6e28 225c 6e22 295b 2d31 5d2e 7265 706c  n("\n")[-1].repl
+00005330: 6163 6528 2249 6e64 6578 222c 2022 4469  ace("Index", "Di
+00005340: 7669 7369 6f6e 7322 290a 2020 2020 2020  visions").      
+00005350: 2020 2020 2020 5f73 7472 5f66 6d74 203d        _str_fmt =
+00005360: 2066 2245 6d70 7479 207b 5f73 7472 5f66   f"Empty {_str_f
+00005370: 6d74 7d22 0a20 2020 2020 2020 2072 6574  mt}".        ret
+00005380: 7572 6e20 5f73 7472 5f66 6d74 2e66 6f72  urn _str_fmt.for
+00005390: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
+000053a0: 206b 6c61 7373 3d73 656c 662e 5f5f 636c   klass=self.__cl
+000053b0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2c0a  ass__.__name__,.
+000053c0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000053d0: 3d64 6174 612c 0a20 2020 2020 2020 2020  =data,.         
+000053e0: 2020 206e 616d 653d 6b65 795f 7370 6c69     name=key_spli
+000053f0: 7428 7365 6c66 2e5f 6e61 6d65 292c 0a20  t(self._name),. 
+00005400: 2020 2020 2020 2020 2020 206c 6179 6572             layer
+00005410: 733d 6d61 7962 655f 706c 7572 616c 697a  s=maybe_pluraliz
+00005420: 6528 6c65 6e28 7365 6c66 2e64 6173 6b2e  e(len(self.dask.
+00005430: 6c61 7965 7273 292c 2022 6772 6170 6820  layers), "graph 
+00005440: 6c61 7965 7222 292c 0a20 2020 2020 2020  layer"),.       
+00005450: 2029 0a0a 2020 2020 4070 726f 7065 7274   )..    @propert
+00005460: 790a 2020 2020 6465 6620 696e 6465 7828  y.    def index(
+00005470: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00005480: 2222 5265 7475 726e 2064 6173 6b20 496e  ""Return dask In
+00005490: 6465 7820 696e 7374 616e 6365 2222 220a  dex instance""".
+000054a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000054b0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+000054c0: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+000054d0: 6765 7461 7474 722c 0a20 2020 2020 2020  getattr,.       
+000054e0: 2020 2020 2022 696e 6465 7822 2c0a 2020       "index",.  
+000054f0: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
+00005500: 6b65 795f 7370 6c69 7428 7365 6c66 2e5f  key_split(self._
+00005510: 6e61 6d65 2920 2b20 222d 696e 6465 7822  name) + "-index"
+00005520: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
+00005530: 7461 3d73 656c 662e 5f6d 6574 612e 696e  ta=self._meta.in
+00005540: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
+00005550: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+00005560: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
+00005570: 2029 0a0a 2020 2020 4069 6e64 6578 2e73   )..    @index.s
+00005580: 6574 7465 720a 2020 2020 6465 6620 696e  etter.    def in
+00005590: 6465 7828 7365 6c66 2c20 7661 6c75 6529  dex(self, value)
+000055a0: 3a0a 2020 2020 2020 2020 7365 6c66 2e64  :.        self.d
+000055b0: 6976 6973 696f 6e73 203d 2076 616c 7565  ivisions = value
+000055c0: 2e64 6976 6973 696f 6e73 0a20 2020 2020  .divisions.     
+000055d0: 2020 2072 6573 756c 7420 3d20 6d61 705f     result = map_
+000055e0: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+000055f0: 2020 2020 2020 2020 6d65 7468 6f64 732e          methods.
+00005600: 6173 7369 676e 5f69 6e64 6578 2c20 7365  assign_index, se
+00005610: 6c66 2c20 7661 6c75 652c 2065 6e66 6f72  lf, value, enfor
+00005620: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+00005630: 650a 2020 2020 2020 2020 290a 2020 2020  e.        ).    
+00005640: 2020 2020 7365 6c66 2e64 6173 6b20 3d20      self.dask = 
+00005650: 7265 7375 6c74 2e64 6173 6b0a 2020 2020  result.dask.    
+00005660: 2020 2020 7365 6c66 2e5f 6e61 6d65 203d      self._name =
+00005670: 2072 6573 756c 742e 5f6e 616d 650a 2020   result._name.  
+00005680: 2020 2020 2020 7365 6c66 2e5f 6d65 7461        self._meta
+00005690: 203d 2072 6573 756c 742e 5f6d 6574 610a   = result._meta.
+000056a0: 0a20 2020 2064 6566 2072 6573 6574 5f69  .    def reset_i
+000056b0: 6e64 6578 2873 656c 662c 2064 726f 703d  ndex(self, drop=
+000056c0: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+000056d0: 2222 2252 6573 6574 2074 6865 2069 6e64  """Reset the ind
+000056e0: 6578 2074 6f20 7468 6520 6465 6661 756c  ex to the defaul
+000056f0: 7420 696e 6465 782e 0a0a 2020 2020 2020  t index...      
+00005700: 2020 4e6f 7465 2074 6861 7420 756e 6c69    Note that unli
+00005710: 6b65 2069 6e20 6060 7061 6e64 6173 6060  ke in ``pandas``
+00005720: 2c20 7468 6520 7265 7365 7420 6060 6461  , the reset ``da
+00005730: 736b 2e64 6174 6166 7261 6d65 6060 2069  sk.dataframe`` i
+00005740: 6e64 6578 2077 696c 6c0a 2020 2020 2020  ndex will.      
+00005750: 2020 6e6f 7420 6265 206d 6f6e 6f74 6f6e    not be monoton
+00005760: 6963 616c 6c79 2069 6e63 7265 6173 696e  ically increasin
+00005770: 6720 6672 6f6d 2030 2e20 496e 7374 6561  g from 0. Instea
+00005780: 642c 2069 7420 7769 6c6c 2072 6573 7461  d, it will resta
+00005790: 7274 2061 7420 300a 2020 2020 2020 2020  rt at 0.        
+000057a0: 666f 7220 6561 6368 2070 6172 7469 7469  for each partiti
+000057b0: 6f6e 2028 652e 672e 2060 6069 6e64 6578  on (e.g. ``index
+000057c0: 3120 3d20 5b30 2c20 2e2e 2e2c 2031 305d  1 = [0, ..., 10]
+000057d0: 2c20 696e 6465 7832 203d 205b 302c 202e  , index2 = [0, .
+000057e0: 2e2e 5d60 6029 2e0a 2020 2020 2020 2020  ..]``)..        
+000057f0: 5468 6973 2069 7320 6475 6520 746f 2074  This is due to t
+00005800: 6865 2069 6e61 6269 6c69 7479 2074 6f20  he inability to 
+00005810: 7374 6174 6963 616c 6c79 206b 6e6f 7720  statically know 
+00005820: 7468 6520 6675 6c6c 206c 656e 6774 6820  the full length 
+00005830: 6f66 2074 6865 0a20 2020 2020 2020 2069  of the.        i
+00005840: 6e64 6578 2e0a 0a20 2020 2020 2020 2046  ndex...        F
+00005850: 6f72 2044 6174 6146 7261 6d65 2077 6974  or DataFrame wit
+00005860: 6820 6d75 6c74 692d 6c65 7665 6c20 696e  h multi-level in
+00005870: 6465 782c 2072 6574 7572 6e73 2061 206e  dex, returns a n
+00005880: 6577 2044 6174 6146 7261 6d65 2077 6974  ew DataFrame wit
+00005890: 680a 2020 2020 2020 2020 6c61 6265 6c69  h.        labeli
+000058a0: 6e67 2069 6e66 6f72 6d61 7469 6f6e 2069  ng information i
+000058b0: 6e20 7468 6520 636f 6c75 6d6e 7320 756e  n the columns un
+000058c0: 6465 7220 7468 6520 696e 6465 7820 6e61  der the index na
+000058d0: 6d65 732c 2064 6566 6175 6c74 696e 670a  mes, defaulting.
+000058e0: 2020 2020 2020 2020 746f 2027 6c65 7665          to 'leve
+000058f0: 6c5f 3027 2c20 276c 6576 656c 5f31 272c  l_0', 'level_1',
+00005900: 2065 7463 2e20 6966 2061 6e79 2061 7265   etc. if any are
+00005910: 204e 6f6e 652e 2046 6f72 2061 2073 7461   None. For a sta
+00005920: 6e64 6172 6420 696e 6465 782c 0a20 2020  ndard index,.   
+00005930: 2020 2020 2074 6865 2069 6e64 6578 206e       the index n
+00005940: 616d 6520 7769 6c6c 2062 6520 7573 6564  ame will be used
+00005950: 2028 6966 2073 6574 292c 206f 7468 6572   (if set), other
+00005960: 7769 7365 2061 2064 6566 6175 6c74 2027  wise a default '
+00005970: 696e 6465 7827 206f 720a 2020 2020 2020  index' or.      
+00005980: 2020 276c 6576 656c 5f30 2720 2869 6620    'level_0' (if 
+00005990: 2769 6e64 6578 2720 6973 2061 6c72 6561  'index' is alrea
+000059a0: 6479 2074 616b 656e 2920 7769 6c6c 2062  dy taken) will b
+000059b0: 6520 7573 6564 2e0a 0a20 2020 2020 2020  e used...       
+000059c0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+000059d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+000059e0: 2020 2020 2020 2064 726f 7020 3a20 626f         drop : bo
+000059f0: 6f6c 6561 6e2c 2064 6566 6175 6c74 2046  olean, default F
+00005a00: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00005a10: 2044 6f20 6e6f 7420 7472 7920 746f 2069   Do not try to i
+00005a20: 6e73 6572 7420 696e 6465 7820 696e 746f  nsert index into
+00005a30: 2064 6174 6166 7261 6d65 2063 6f6c 756d   dataframe colum
+00005a40: 6e73 2e0a 2020 2020 2020 2020 2222 220a  ns..        """.
+00005a50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00005a60: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+00005a70: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+00005a80: 4d2e 7265 7365 745f 696e 6465 782c 2064  M.reset_index, d
+00005a90: 726f 703d 6472 6f70 2c20 656e 666f 7263  rop=drop, enforc
+00005aa0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+00005ab0: 0a20 2020 2020 2020 2029 2e63 6c65 6172  .        ).clear
+00005ac0: 5f64 6976 6973 696f 6e73 2829 0a0a 2020  _divisions()..  
+00005ad0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00005ae0: 6465 6620 6b6e 6f77 6e5f 6469 7669 7369  def known_divisi
+00005af0: 6f6e 7328 7365 6c66 293a 0a20 2020 2020  ons(self):.     
+00005b00: 2020 2022 2222 5768 6574 6865 7220 6469     """Whether di
+00005b10: 7669 7369 6f6e 7320 6172 6520 616c 7265  visions are alre
+00005b20: 6164 7920 6b6e 6f77 6e22 2222 0a20 2020  ady known""".   
+00005b30: 2020 2020 2072 6574 7572 6e20 6c65 6e28       return len(
+00005b40: 7365 6c66 2e64 6976 6973 696f 6e73 2920  self.divisions) 
+00005b50: 3e20 3020 616e 6420 7365 6c66 2e64 6976  > 0 and self.div
+00005b60: 6973 696f 6e73 5b30 5d20 6973 206e 6f74  isions[0] is not
+00005b70: 204e 6f6e 650a 0a20 2020 2064 6566 2063   None..    def c
+00005b80: 6c65 6172 5f64 6976 6973 696f 6e73 2873  lear_divisions(s
+00005b90: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00005ba0: 2246 6f72 6765 7420 6469 7669 7369 6f6e  "Forget division
+00005bb0: 2069 6e66 6f72 6d61 7469 6f6e 2222 220a   information""".
+00005bc0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+00005bd0: 7320 3d20 284e 6f6e 652c 2920 2a20 2873  s = (None,) * (s
+00005be0: 656c 662e 6e70 6172 7469 7469 6f6e 7320  elf.npartitions 
+00005bf0: 2b20 3129 0a20 2020 2020 2020 2072 6574  + 1).        ret
+00005c00: 7572 6e20 7479 7065 2873 656c 6629 2873  urn type(self)(s
+00005c10: 656c 662e 6461 736b 2c20 7365 6c66 2e5f  elf.dask, self._
+00005c20: 6e61 6d65 2c20 7365 6c66 2e5f 6d65 7461  name, self._meta
+00005c30: 2c20 6469 7669 7369 6f6e 7329 0a0a 2020  , divisions)..  
+00005c40: 2020 6465 6620 636f 6d70 7574 655f 6375    def compute_cu
+00005c50: 7272 656e 745f 6469 7669 7369 6f6e 7328  rrent_divisions(
+00005c60: 7365 6c66 2c20 636f 6c3d 4e6f 6e65 293a  self, col=None):
+00005c70: 0a20 2020 2020 2020 2022 2222 436f 6d70  .        """Comp
+00005c80: 7574 6520 7468 6520 6375 7272 656e 7420  ute the current 
+00005c90: 6469 7669 7369 6f6e 7320 6f66 2074 6865  divisions of the
+00005ca0: 2044 6174 6146 7261 6d65 2e0a 0a20 2020   DataFrame...   
+00005cb0: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
+00005cc0: 2074 7269 6767 6572 7320 696d 6d65 6469   triggers immedi
+00005cd0: 6174 6520 636f 6d70 7574 6174 696f 6e2e  ate computation.
+00005ce0: 2049 6620 796f 7520 6669 6e64 2079 6f75   If you find you
+00005cf0: 7273 656c 6620 7275 6e6e 696e 6720 7468  rself running th
+00005d00: 6973 2063 6f6d 6d61 6e64 0a20 2020 2020  is command.     
+00005d10: 2020 2072 6570 6561 7465 646c 7920 666f     repeatedly fo
+00005d20: 7220 7468 6520 7361 6d65 2064 6174 6166  r the same dataf
+00005d30: 7261 6d65 2c20 7765 2072 6563 6f6d 6d65  rame, we recomme
+00005d40: 6e64 2073 746f 7269 6e67 2074 6865 2072  nd storing the r
+00005d50: 6573 756c 740a 2020 2020 2020 2020 736f  esult.        so
+00005d60: 2079 6f75 2064 6f6e 2774 2068 6176 6520   you don't have 
+00005d70: 746f 2072 6572 756e 2069 742e 0a0a 2020  to rerun it...  
+00005d80: 2020 2020 2020 4966 2074 6865 2063 6f6c        If the col
+00005d90: 756d 6e20 6f72 2069 6e64 6578 2076 616c  umn or index val
+00005da0: 7565 7320 6f76 6572 6c61 7020 6265 7477  ues overlap betw
+00005db0: 6565 6e20 7061 7274 6974 696f 6e73 2c20  een partitions, 
+00005dc0: 7261 6973 6573 2060 6056 616c 7565 4572  raises ``ValueEr
+00005dd0: 726f 7260 602e 0a20 2020 2020 2020 2054  ror``..        T
+00005de0: 6f20 7072 6576 656e 7420 7468 6973 2c20  o prevent this, 
+00005df0: 6d61 6b65 2073 7572 6520 7468 6520 6461  make sure the da
+00005e00: 7461 2061 7265 2073 6f72 7465 6420 6279  ta are sorted by
+00005e10: 2074 6865 2063 6f6c 756d 6e20 6f72 2069   the column or i
+00005e20: 6e64 6578 2e0a 0a20 2020 2020 2020 2050  ndex...        P
+00005e30: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00005e40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00005e50: 2020 2020 2063 6f6c 203a 2073 7472 696e       col : strin
+00005e60: 672c 206f 7074 696f 6e61 6c0a 2020 2020  g, optional.    
+00005e70: 2020 2020 2020 2020 4361 6c63 756c 6174          Calculat
+00005e80: 6520 7468 6520 6469 7669 7369 6f6e 7320  e the divisions 
+00005e90: 666f 7220 6120 6e6f 6e2d 696e 6465 7820  for a non-index 
+00005ea0: 636f 6c75 6d6e 2062 7920 7061 7373 696e  column by passin
+00005eb0: 6720 696e 2074 6865 206e 616d 6520 6f66  g in the name of
+00005ec0: 2074 6865 2063 6f6c 756d 6e2e 0a20 2020   the column..   
+00005ed0: 2020 2020 2020 2020 2049 6620 636f 6c20           If col 
+00005ee0: 6973 206e 6f74 2073 7065 6369 6669 6564  is not specified
+00005ef0: 2c20 7468 6520 696e 6465 7820 7769 6c6c  , the index will
+00005f00: 2062 6520 7573 6564 2074 6f20 6361 6c63   be used to calc
+00005f10: 756c 6174 6520 6469 7669 7369 6f6e 732e  ulate divisions.
+00005f20: 0a20 2020 2020 2020 2020 2020 2049 6e20  .            In 
+00005f30: 7468 6973 2063 6173 652c 2069 6620 7468  this case, if th
+00005f40: 6520 6469 7669 7369 6f6e 7320 6172 6520  e divisions are 
+00005f50: 616c 7265 6164 7920 6b6e 6f77 6e2c 2074  already known, t
+00005f60: 6865 7920 7769 6c6c 2062 6520 7265 7475  hey will be retu
+00005f70: 726e 6564 0a20 2020 2020 2020 2020 2020  rned.           
+00005f80: 2069 6d6d 6564 6961 7465 6c79 2077 6974   immediately wit
+00005f90: 686f 7574 2063 6f6d 7075 7469 6e67 2e0a  hout computing..
+00005fa0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00005fb0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00005fc0: 2d2d 0a20 2020 2020 2020 203e 3e3e 2069  --.        >>> i
+00005fd0: 6d70 6f72 7420 6461 736b 0a20 2020 2020  mport dask.     
+00005fe0: 2020 203e 3e3e 2064 6466 203d 2064 6173     >>> ddf = das
+00005ff0: 6b2e 6461 7461 7365 7473 2e74 696d 6573  k.datasets.times
+00006000: 6572 6965 7328 7374 6172 743d 2232 3032  eries(start="202
+00006010: 312d 3031 2d30 3122 2c20 656e 643d 2232  1-01-01", end="2
+00006020: 3032 312d 3031 2d30 3722 2c20 6672 6571  021-01-07", freq
+00006030: 3d22 3148 2229 2e63 6c65 6172 5f64 6976  ="1H").clear_div
+00006040: 6973 696f 6e73 2829 0a20 2020 2020 2020  isions().       
+00006050: 203e 3e3e 2064 6976 6973 696f 6e73 203d   >>> divisions =
+00006060: 2064 6466 2e63 6f6d 7075 7465 5f63 7572   ddf.compute_cur
+00006070: 7265 6e74 5f64 6976 6973 696f 6e73 2829  rent_divisions()
+00006080: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
+00006090: 6e74 2864 6976 6973 696f 6e73 2920 2023  nt(divisions)  #
+000060a0: 2064 6f63 7465 7374 3a20 2b4e 4f52 4d41   doctest: +NORMA
+000060b0: 4c49 5a45 5f57 4849 5445 5350 4143 450a  LIZE_WHITESPACE.
+000060c0: 2020 2020 2020 2020 2854 696d 6573 7461          (Timesta
+000060d0: 6d70 2827 3230 3231 2d30 312d 3031 2030  mp('2021-01-01 0
+000060e0: 303a 3030 3a30 3027 292c 0a20 2020 2020  0:00:00'),.     
+000060f0: 2020 2020 5469 6d65 7374 616d 7028 2732      Timestamp('2
+00006100: 3032 312d 3031 2d30 3220 3030 3a30 303a  021-01-02 00:00:
+00006110: 3030 2729 2c0a 2020 2020 2020 2020 2054  00'),.         T
+00006120: 696d 6573 7461 6d70 2827 3230 3231 2d30  imestamp('2021-0
+00006130: 312d 3033 2030 303a 3030 3a30 3027 292c  1-03 00:00:00'),
+00006140: 0a20 2020 2020 2020 2020 5469 6d65 7374  .         Timest
+00006150: 616d 7028 2732 3032 312d 3031 2d30 3420  amp('2021-01-04 
+00006160: 3030 3a30 303a 3030 2729 2c0a 2020 2020  00:00:00'),.    
+00006170: 2020 2020 2054 696d 6573 7461 6d70 2827       Timestamp('
+00006180: 3230 3231 2d30 312d 3035 2030 303a 3030  2021-01-05 00:00
+00006190: 3a30 3027 292c 0a20 2020 2020 2020 2020  :00'),.         
+000061a0: 5469 6d65 7374 616d 7028 2732 3032 312d  Timestamp('2021-
+000061b0: 3031 2d30 3620 3030 3a30 303a 3030 2729  01-06 00:00:00')
+000061c0: 2c0a 2020 2020 2020 2020 2054 696d 6573  ,.         Times
+000061d0: 7461 6d70 2827 3230 3231 2d30 312d 3036  tamp('2021-01-06
+000061e0: 2032 333a 3030 3a30 3027 2929 0a0a 2020   23:00:00'))..  
+000061f0: 2020 2020 2020 3e3e 3e20 6464 662e 6469        >>> ddf.di
+00006200: 7669 7369 6f6e 7320 3d20 6469 7669 7369  visions = divisi
+00006210: 6f6e 730a 2020 2020 2020 2020 3e3e 3e20  ons.        >>> 
+00006220: 6464 662e 6b6e 6f77 6e5f 6469 7669 7369  ddf.known_divisi
+00006230: 6f6e 730a 2020 2020 2020 2020 5472 7565  ons.        True
+00006240: 0a0a 2020 2020 2020 2020 3e3e 3e20 6464  ..        >>> dd
+00006250: 6620 3d20 6464 662e 7265 7365 745f 696e  f = ddf.reset_in
+00006260: 6465 7828 292e 636c 6561 725f 6469 7669  dex().clear_divi
+00006270: 7369 6f6e 7328 290a 2020 2020 2020 2020  sions().        
+00006280: 3e3e 3e20 6469 7669 7369 6f6e 7320 3d20  >>> divisions = 
+00006290: 6464 662e 636f 6d70 7574 655f 6375 7272  ddf.compute_curr
+000062a0: 656e 745f 6469 7669 7369 6f6e 7328 2274  ent_divisions("t
+000062b0: 696d 6573 7461 6d70 2229 0a20 2020 2020  imestamp").     
+000062c0: 2020 203e 3e3e 2070 7269 6e74 2864 6976     >>> print(div
+000062d0: 6973 696f 6e73 2920 2023 2064 6f63 7465  isions)  # docte
+000062e0: 7374 3a20 2b4e 4f52 4d41 4c49 5a45 5f57  st: +NORMALIZE_W
+000062f0: 4849 5445 5350 4143 450a 2020 2020 2020  HITESPACE.      
+00006300: 2020 2854 696d 6573 7461 6d70 2827 3230    (Timestamp('20
+00006310: 3231 2d30 312d 3031 2030 303a 3030 3a30  21-01-01 00:00:0
+00006320: 3027 292c 0a20 2020 2020 2020 2020 5469  0'),.         Ti
+00006330: 6d65 7374 616d 7028 2732 3032 312d 3031  mestamp('2021-01
+00006340: 2d30 3220 3030 3a30 303a 3030 2729 2c0a  -02 00:00:00'),.
+00006350: 2020 2020 2020 2020 2054 696d 6573 7461           Timesta
+00006360: 6d70 2827 3230 3231 2d30 312d 3033 2030  mp('2021-01-03 0
+00006370: 303a 3030 3a30 3027 292c 0a20 2020 2020  0:00:00'),.     
+00006380: 2020 2020 5469 6d65 7374 616d 7028 2732      Timestamp('2
+00006390: 3032 312d 3031 2d30 3420 3030 3a30 303a  021-01-04 00:00:
+000063a0: 3030 2729 2c0a 2020 2020 2020 2020 2054  00'),.         T
+000063b0: 696d 6573 7461 6d70 2827 3230 3231 2d30  imestamp('2021-0
+000063c0: 312d 3035 2030 303a 3030 3a30 3027 292c  1-05 00:00:00'),
+000063d0: 0a20 2020 2020 2020 2020 5469 6d65 7374  .         Timest
+000063e0: 616d 7028 2732 3032 312d 3031 2d30 3620  amp('2021-01-06 
+000063f0: 3030 3a30 303a 3030 2729 2c0a 2020 2020  00:00:00'),.    
+00006400: 2020 2020 2054 696d 6573 7461 6d70 2827       Timestamp('
+00006410: 3230 3231 2d30 312d 3036 2032 333a 3030  2021-01-06 23:00
+00006420: 3a30 3027 2929 0a0a 2020 2020 2020 2020  :00'))..        
+00006430: 3e3e 3e20 6464 6620 3d20 6464 662e 7365  >>> ddf = ddf.se
+00006440: 745f 696e 6465 7828 2274 696d 6573 7461  t_index("timesta
+00006450: 6d70 222c 2064 6976 6973 696f 6e73 3d64  mp", divisions=d
+00006460: 6976 6973 696f 6e73 2c20 736f 7274 6564  ivisions, sorted
+00006470: 3d54 7275 6529 0a20 2020 2020 2020 2022  =True).        "
+00006480: 2222 0a20 2020 2020 2020 2069 6620 636f  "".        if co
+00006490: 6c20 6973 204e 6f6e 6520 616e 6420 7365  l is None and se
+000064a0: 6c66 2e6b 6e6f 776e 5f64 6976 6973 696f  lf.known_divisio
+000064b0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+000064c0: 7265 7475 726e 2073 656c 662e 6469 7669  return self.divi
+000064d0: 7369 6f6e 730a 0a20 2020 2020 2020 2066  sions..        f
+000064e0: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+000064f0: 6d65 2e73 6875 6666 6c65 2069 6d70 6f72  me.shuffle impor
+00006500: 7420 636f 6d70 7574 655f 6469 7669 7369  t compute_divisi
+00006510: 6f6e 730a 0a20 2020 2020 2020 2072 6574  ons..        ret
+00006520: 7572 6e20 636f 6d70 7574 655f 6469 7669  urn compute_divi
+00006530: 7369 6f6e 7328 7365 6c66 2c20 636f 6c3d  sions(self, col=
+00006540: 636f 6c29 0a0a 2020 2020 6465 6620 6765  col)..    def ge
+00006550: 745f 7061 7274 6974 696f 6e28 7365 6c66  t_partition(self
+00006560: 2c20 6e29 3a0a 2020 2020 2020 2020 2222  , n):.        ""
+00006570: 220a 2020 2020 2020 2020 4765 7420 6120  ".        Get a 
+00006580: 6461 736b 2044 6174 6146 7261 6d65 2f53  dask DataFrame/S
+00006590: 6572 6965 7320 7265 7072 6573 656e 7469  eries representi
+000065a0: 6e67 2074 6865 2060 6e74 6860 2070 6172  ng the `nth` par
+000065b0: 7469 7469 6f6e 2e0a 0a20 2020 2020 2020  tition...       
+000065c0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+000065d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+000065e0: 2020 2020 2020 206e 203a 2069 6e74 0a20         n : int. 
+000065f0: 2020 2020 2020 2020 2020 2054 6865 2030             The 0
+00006600: 2d69 6e64 6578 6564 2070 6172 7469 7469  -indexed partiti
+00006610: 6f6e 206e 756d 6265 7220 746f 2073 656c  on number to sel
+00006620: 6563 742e 0a0a 2020 2020 2020 2020 5265  ect...        Re
+00006630: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+00006640: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
+00006650: 736b 2044 6174 6146 7261 6d65 206f 7220  sk DataFrame or 
+00006660: 5365 7269 6573 0a20 2020 2020 2020 2020  Series.         
+00006670: 2020 2054 6865 2073 616d 6520 7479 7065     The same type
+00006680: 2061 7320 7468 6520 6f72 6967 696e 616c   as the original
+00006690: 206f 626a 6563 742e 0a0a 2020 2020 2020   object...      
+000066a0: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
+000066b0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+000066c0: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
+000066d0: 6173 6b0a 2020 2020 2020 2020 3e3e 3e20  ask.        >>> 
+000066e0: 6464 6620 3d20 6461 736b 2e64 6174 6173  ddf = dask.datas
+000066f0: 6574 732e 7469 6d65 7365 7269 6573 2873  ets.timeseries(s
+00006700: 7461 7274 3d22 3230 3231 2d30 312d 3031  tart="2021-01-01
+00006710: 222c 2065 6e64 3d22 3230 3231 2d30 312d  ", end="2021-01-
+00006720: 3037 222c 2066 7265 713d 2231 4822 290a  07", freq="1H").
+00006730: 2020 2020 2020 2020 3e3e 3e20 6464 662e          >>> ddf.
+00006740: 6765 745f 7061 7274 6974 696f 6e28 3029  get_partition(0)
+00006750: 2020 2320 646f 6374 6573 743a 202b 4e4f    # doctest: +NO
+00006760: 524d 414c 495a 455f 5748 4954 4553 5041  RMALIZE_WHITESPA
+00006770: 4345 0a20 2020 2020 2020 2044 6173 6b20  CE.        Dask 
+00006780: 4461 7461 4672 616d 6520 5374 7275 6374  DataFrame Struct
+00006790: 7572 653a 0a20 2020 2020 2020 2020 2020  ure:.           
+000067a0: 2020 2020 2020 2020 2020 2020 2020 6e61                na
+000067b0: 6d65 2020 2020 2069 6420 2020 2020 2020  me     id       
+000067c0: 2078 2020 2020 2020 2020 790a 2020 2020   x        y.    
+000067d0: 2020 2020 6e70 6172 7469 7469 6f6e 733d      npartitions=
+000067e0: 310a 2020 2020 2020 2020 3230 3231 2d30  1.        2021-0
+000067f0: 312d 3031 2020 2020 206f 626a 6563 7420  1-01     object 
+00006800: 2069 6e74 3634 2020 666c 6f61 7436 3420   int64  float64 
+00006810: 2066 6c6f 6174 3634 0a20 2020 2020 2020   float64.       
+00006820: 2032 3032 312d 3031 2d30 3220 2020 2020   2021-01-02     
+00006830: 2020 202e 2e2e 2020 2020 2e2e 2e20 2020     ...    ...   
+00006840: 2020 202e 2e2e 2020 2020 2020 2e2e 2e0a     ...      ....
+00006850: 2020 2020 2020 2020 4461 736b 204e 616d          Dask Nam
+00006860: 653a 2067 6574 2d70 6172 7469 7469 6f6e  e: get-partition
+00006870: 2c20 3220 6772 6170 6820 6c61 7965 7273  , 2 graph layers
+00006880: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+00006890: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+000068a0: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
+000068b0: 4672 616d 652e 7061 7274 6974 696f 6e73  Frame.partitions
+000068c0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000068d0: 2020 2020 2069 6620 3020 3c3d 206e 203c       if 0 <= n <
+000068e0: 2073 656c 662e 6e70 6172 7469 7469 6f6e   self.npartition
+000068f0: 733a 0a20 2020 2020 2020 2020 2020 206e  s:.            n
+00006900: 616d 6520 3d20 6622 6765 742d 7061 7274  ame = f"get-part
+00006910: 6974 696f 6e2d 7b73 7472 286e 297d 2d7b  ition-{str(n)}-{
+00006920: 7365 6c66 2e5f 6e61 6d65 7d22 0a20 2020  self._name}".   
+00006930: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
+00006940: 6e73 203d 2073 656c 662e 6469 7669 7369  ns = self.divisi
+00006950: 6f6e 735b 6e20 3a20 6e20 2b20 325d 0a20  ons[n : n + 2]. 
+00006960: 2020 2020 2020 2020 2020 206c 6179 6572             layer
+00006970: 203d 207b 286e 616d 652c 2030 293a 2028   = {(name, 0): (
+00006980: 7365 6c66 2e5f 6e61 6d65 2c20 6e29 7d0a  self._name, n)}.
+00006990: 2020 2020 2020 2020 2020 2020 6772 6170              grap
+000069a0: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
+000069b0: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
+000069c0: 6f6e 7328 6e61 6d65 2c20 6c61 7965 722c  ons(name, layer,
+000069d0: 2064 6570 656e 6465 6e63 6965 733d 5b73   dependencies=[s
+000069e0: 656c 665d 290a 2020 2020 2020 2020 2020  elf]).          
+000069f0: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
+00006a00: 6f62 6a65 6374 2867 7261 7068 2c20 6e61  object(graph, na
+00006a10: 6d65 2c20 7365 6c66 2e5f 6d65 7461 2c20  me, self._meta, 
+00006a20: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
+00006a30: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00006a40: 2020 2020 206d 7367 203d 2066 226e 206d       msg = f"n m
+00006a50: 7573 7420 6265 2030 203c 3d20 6e20 3c20  ust be 0 <= n < 
+00006a60: 7b73 656c 662e 6e70 6172 7469 7469 6f6e  {self.npartition
+00006a70: 737d 220a 2020 2020 2020 2020 2020 2020  s}".            
+00006a80: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00006a90: 286d 7367 290a 0a20 2020 2040 6465 7269  (msg)..    @deri
+00006aa0: 7665 645f 6672 6f6d 280a 2020 2020 2020  ved_from(.      
+00006ab0: 2020 7064 2e44 6174 6146 7261 6d65 2c0a    pd.DataFrame,.
+00006ac0: 2020 2020 2020 2020 696e 636f 6e73 6973          inconsis
+00006ad0: 7465 6e63 6965 733d 226b 6565 703d 4661  tencies="keep=Fa
+00006ae0: 6c73 6520 7769 6c6c 2072 6169 7365 2061  lse will raise a
+00006af0: 2060 604e 6f74 496d 706c 656d 656e 7465   ``NotImplemente
+00006b00: 6445 7272 6f72 6060 222c 0a20 2020 2029  dError``",.    )
+00006b10: 0a20 2020 2064 6566 2064 726f 705f 6475  .    def drop_du
+00006b20: 706c 6963 6174 6573 280a 2020 2020 2020  plicates(.      
+00006b30: 2020 7365 6c66 2c20 7375 6273 6574 3d4e    self, subset=N
+00006b40: 6f6e 652c 2073 706c 6974 5f65 7665 7279  one, split_every
+00006b50: 3d4e 6f6e 652c 2073 706c 6974 5f6f 7574  =None, split_out
+00006b60: 3d31 2c20 6967 6e6f 7265 5f69 6e64 6578  =1, ignore_index
+00006b70: 3d46 616c 7365 2c20 2a2a 6b77 6172 6773  =False, **kwargs
+00006b80: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00006b90: 6966 2073 7562 7365 7420 6973 206e 6f74  if subset is not
+00006ba0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00006bb0: 2020 2023 204c 6574 2070 616e 6461 7320     # Let pandas 
+00006bc0: 6572 726f 7220 6f6e 2062 6164 2069 6e70  error on bad inp
+00006bd0: 7574 730a 2020 2020 2020 2020 2020 2020  uts.            
+00006be0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
+00006bf0: 7074 792e 6472 6f70 5f64 7570 6c69 6361  pty.drop_duplica
+00006c00: 7465 7328 7375 6273 6574 3d73 7562 7365  tes(subset=subse
+00006c10: 742c 202a 2a6b 7761 7267 7329 0a20 2020  t, **kwargs).   
+00006c20: 2020 2020 2020 2020 206b 7761 7267 735b           kwargs[
+00006c30: 2273 7562 7365 7422 5d20 3d20 7375 6273  "subset"] = subs
+00006c40: 6574 0a20 2020 2020 2020 2020 2020 2073  et.            s
+00006c50: 706c 6974 5f6f 7574 5f73 6574 7570 203d  plit_out_setup =
+00006c60: 2073 706c 6974 5f6f 7574 5f6f 6e5f 636f   split_out_on_co
+00006c70: 6c73 0a20 2020 2020 2020 2020 2020 2073  ls.            s
+00006c80: 706c 6974 5f6f 7574 5f73 6574 7570 5f6b  plit_out_setup_k
+00006c90: 7761 7267 7320 3d20 7b22 636f 6c73 223a  wargs = {"cols":
+00006ca0: 2073 7562 7365 747d 0a20 2020 2020 2020   subset}.       
+00006cb0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00006cc0: 2020 2073 656c 662e 5f6d 6574 615f 6e6f     self._meta_no
+00006cd0: 6e65 6d70 7479 2e64 726f 705f 6475 706c  nempty.drop_dupl
+00006ce0: 6963 6174 6573 282a 2a6b 7761 7267 7329  icates(**kwargs)
+00006cf0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+00006d00: 6974 5f6f 7574 5f73 6574 7570 203d 2073  it_out_setup = s
+00006d10: 706c 6974 5f6f 7574 5f73 6574 7570 5f6b  plit_out_setup_k
+00006d20: 7761 7267 7320 3d20 4e6f 6e65 0a0a 2020  wargs = None..  
+00006d30: 2020 2020 2020 6966 206b 7761 7267 732e        if kwargs.
+00006d40: 6765 7428 226b 6565 7022 2c20 5472 7565  get("keep", True
+00006d50: 2920 6973 2046 616c 7365 3a0a 2020 2020  ) is False:.    
+00006d60: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+00006d70: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+00006d80: 7228 2264 726f 705f 6475 706c 6963 6174  r("drop_duplicat
+00006d90: 6573 2077 6974 6820 6b65 6570 3d46 616c  es with keep=Fal
+00006da0: 7365 2229 0a0a 2020 2020 2020 2020 6368  se")..        ch
+00006db0: 756e 6b20 3d20 4d2e 6472 6f70 5f64 7570  unk = M.drop_dup
+00006dc0: 6c69 6361 7465 730a 2020 2020 2020 2020  licates.        
+00006dd0: 7265 7475 726e 2061 6361 280a 2020 2020  return aca(.    
+00006de0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00006df0: 2020 2020 2020 2020 2020 6368 756e 6b3d            chunk=
+00006e00: 6368 756e 6b2c 0a20 2020 2020 2020 2020  chunk,.         
+00006e10: 2020 2061 6767 7265 6761 7465 3d63 6875     aggregate=chu
+00006e20: 6e6b 2c0a 2020 2020 2020 2020 2020 2020  nk,.            
+00006e30: 6d65 7461 3d73 656c 662e 5f6d 6574 612c  meta=self._meta,
+00006e40: 0a20 2020 2020 2020 2020 2020 2074 6f6b  .            tok
+00006e50: 656e 3d22 6472 6f70 2d64 7570 6c69 6361  en="drop-duplica
+00006e60: 7465 7322 2c0a 2020 2020 2020 2020 2020  tes",.          
+00006e70: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
+00006e80: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
+00006e90: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
+00006ea0: 3d73 706c 6974 5f6f 7574 2c0a 2020 2020  =split_out,.    
+00006eb0: 2020 2020 2020 2020 7370 6c69 745f 6f75          split_ou
+00006ec0: 745f 7365 7475 703d 7370 6c69 745f 6f75  t_setup=split_ou
+00006ed0: 745f 7365 7475 702c 0a20 2020 2020 2020  t_setup,.       
+00006ee0: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
+00006ef0: 6574 7570 5f6b 7761 7267 733d 7370 6c69  etup_kwargs=spli
+00006f00: 745f 6f75 745f 7365 7475 705f 6b77 6172  t_out_setup_kwar
+00006f10: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+00006f20: 6967 6e6f 7265 5f69 6e64 6578 3d69 676e  ignore_index=ign
+00006f30: 6f72 655f 696e 6465 782c 0a20 2020 2020  ore_index,.     
+00006f40: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+00006f50: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00006f60: 6465 6620 5f5f 6c65 6e5f 5f28 7365 6c66  def __len__(self
+00006f70: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00006f80: 6e20 7365 6c66 2e72 6564 7563 7469 6f6e  n self.reduction
+00006f90: 280a 2020 2020 2020 2020 2020 2020 6c65  (.            le
+00006fa0: 6e2c 206e 702e 7375 6d2c 2074 6f6b 656e  n, np.sum, token
+00006fb0: 3d22 6c65 6e22 2c20 6d65 7461 3d69 6e74  ="len", meta=int
+00006fc0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+00006fd0: 6c73 650a 2020 2020 2020 2020 292e 636f  lse.        ).co
+00006fe0: 6d70 7574 6528 290a 0a20 2020 2064 6566  mpute()..    def
+00006ff0: 205f 5f62 6f6f 6c5f 5f28 7365 6c66 293a   __bool__(self):
+00007000: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+00007010: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00007020: 2020 2020 2020 2066 2254 6865 2074 7275         f"The tru
+00007030: 7468 2076 616c 7565 206f 6620 6120 7b73  th value of a {s
+00007040: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
+00007050: 6e61 6d65 5f5f 7d20 6973 2061 6d62 6967  name__} is ambig
+00007060: 756f 7573 2e20 220a 2020 2020 2020 2020  uous. ".        
+00007070: 2020 2020 2255 7365 2061 2e61 6e79 2829      "Use a.any()
+00007080: 206f 7220 612e 616c 6c28 292e 220a 2020   or a.all().".  
+00007090: 2020 2020 2020 290a 0a20 2020 205f 5f6e        )..    __n
+000070a0: 6f6e 7a65 726f 5f5f 203d 205f 5f62 6f6f  onzero__ = __boo
+000070b0: 6c5f 5f20 2023 2070 7974 686f 6e20 320a  l__  # python 2.
+000070c0: 0a20 2020 2064 6566 205f 7363 616c 6172  .    def _scalar
+000070d0: 6675 6e63 2873 656c 662c 2063 6173 745f  func(self, cast_
+000070e0: 7479 7065 293a 0a20 2020 2020 2020 2064  type):.        d
+000070f0: 6566 2077 7261 7070 6572 2829 3a0a 2020  ef wrapper():.  
+00007100: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00007110: 5479 7065 4572 726f 7228 6622 6361 6e6e  TypeError(f"cann
+00007120: 6f74 2063 6f6e 7665 7274 2074 6865 2073  ot convert the s
+00007130: 6572 6965 7320 746f 207b 6361 7374 5f74  eries to {cast_t
+00007140: 7970 657d 2229 0a0a 2020 2020 2020 2020  ype}")..        
+00007150: 7265 7475 726e 2077 7261 7070 6572 0a0a  return wrapper..
+00007160: 2020 2020 6465 6620 5f5f 666c 6f61 745f      def __float_
+00007170: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00007180: 2072 6574 7572 6e20 7365 6c66 2e5f 7363   return self._sc
+00007190: 616c 6172 6675 6e63 2866 6c6f 6174 290a  alarfunc(float).
+000071a0: 0a20 2020 2064 6566 205f 5f69 6e74 5f5f  .    def __int__
+000071b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000071c0: 7265 7475 726e 2073 656c 662e 5f73 6361  return self._sca
+000071d0: 6c61 7266 756e 6328 696e 7429 0a0a 2020  larfunc(int)..  
+000071e0: 2020 5f5f 6c6f 6e67 5f5f 203d 205f 5f69    __long__ = __i
+000071f0: 6e74 5f5f 2020 2320 7079 7468 6f6e 2032  nt__  # python 2
+00007200: 0a0a 2020 2020 6465 6620 5f5f 636f 6d70  ..    def __comp
+00007210: 6c65 785f 5f28 7365 6c66 293a 0a20 2020  lex__(self):.   
+00007220: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00007230: 2e5f 7363 616c 6172 6675 6e63 2863 6f6d  ._scalarfunc(com
+00007240: 706c 6578 290a 0a20 2020 2040 696e 7365  plex)..    @inse
+00007250: 7274 5f6d 6574 615f 7061 7261 6d5f 6465  rt_meta_param_de
+00007260: 7363 7269 7074 696f 6e28 7061 643d 3132  scription(pad=12
+00007270: 290a 2020 2020 6465 6620 6d61 705f 7061  ).    def map_pa
+00007280: 7274 6974 696f 6e73 2873 656c 662c 2066  rtitions(self, f
+00007290: 756e 632c 202a 6172 6773 2c20 2a2a 6b77  unc, *args, **kw
+000072a0: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
+000072b0: 2222 4170 706c 7920 5079 7468 6f6e 2066  ""Apply Python f
+000072c0: 756e 6374 696f 6e20 6f6e 2065 6163 6820  unction on each 
+000072d0: 4461 7461 4672 616d 6520 7061 7274 6974  DataFrame partit
+000072e0: 696f 6e2e 0a0a 2020 2020 2020 2020 4e6f  ion...        No
+000072f0: 7465 2074 6861 7420 7468 6520 696e 6465  te that the inde
+00007300: 7820 616e 6420 6469 7669 7369 6f6e 7320  x and divisions 
+00007310: 6172 6520 6173 7375 6d65 6420 746f 2072  are assumed to r
+00007320: 656d 6169 6e20 756e 6368 616e 6765 642e  emain unchanged.
+00007330: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00007340: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00007350: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00007360: 6675 6e63 203a 2066 756e 6374 696f 6e0a  func : function.
+00007370: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00007380: 6675 6e63 7469 6f6e 2061 7070 6c69 6564  function applied
+00007390: 2074 6f20 6561 6368 2070 6172 7469 7469   to each partiti
+000073a0: 6f6e 2e20 4966 2074 6869 7320 6675 6e63  on. If this func
+000073b0: 7469 6f6e 2061 6363 6570 7473 0a20 2020  tion accepts.   
+000073c0: 2020 2020 2020 2020 2074 6865 2073 7065           the spe
+000073d0: 6369 616c 2060 6070 6172 7469 7469 6f6e  cial ``partition
+000073e0: 5f69 6e66 6f60 6020 6b65 7977 6f72 6420  _info`` keyword 
+000073f0: 6172 6775 6d65 6e74 2c20 6974 2077 696c  argument, it wil
+00007400: 6c20 7265 6365 6976 650a 2020 2020 2020  l receive.      
+00007410: 2020 2020 2020 696e 666f 726d 6174 696f        informatio
+00007420: 6e20 6f6e 2074 6865 2070 6172 7469 7469  n on the partiti
+00007430: 6f6e 2773 2072 656c 6174 6976 6520 6c6f  on's relative lo
+00007440: 6361 7469 6f6e 2077 6974 6869 6e20 7468  cation within th
+00007450: 650a 2020 2020 2020 2020 2020 2020 6461  e.            da
+00007460: 7461 6672 616d 652e 0a20 2020 2020 2020  taframe..       
+00007470: 2061 7267 732c 206b 7761 7267 7320 3a0a   args, kwargs :.
+00007480: 2020 2020 2020 2020 2020 2020 506f 7369              Posi
+00007490: 7469 6f6e 616c 2061 6e64 206b 6579 776f  tional and keywo
+000074a0: 7264 2061 7267 756d 656e 7473 2074 6f20  rd arguments to 
+000074b0: 7061 7373 2074 6f20 7468 6520 6675 6e63  pass to the func
+000074c0: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
+000074d0: 2020 506f 7369 7469 6f6e 616c 2061 7267    Positional arg
+000074e0: 756d 656e 7473 2061 7265 2063 6f6d 7075  uments are compu
+000074f0: 7465 6420 6f6e 2061 2070 6572 2d70 6172  ted on a per-par
+00007500: 7469 7469 6f6e 2062 6173 6973 2c20 7768  tition basis, wh
+00007510: 696c 650a 2020 2020 2020 2020 2020 2020  ile.            
+00007520: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+00007530: 7320 6172 6520 7368 6172 6564 2061 6372  s are shared acr
+00007540: 6f73 7320 616c 6c20 7061 7274 6974 696f  oss all partitio
+00007550: 6e73 2e20 5468 6520 7061 7274 6974 696f  ns. The partitio
+00007560: 6e0a 2020 2020 2020 2020 2020 2020 6974  n.            it
+00007570: 7365 6c66 2077 696c 6c20 6265 2074 6865  self will be the
+00007580: 2066 6972 7374 2070 6f73 6974 696f 6e61   first positiona
+00007590: 6c20 6172 6775 6d65 6e74 2c20 7769 7468  l argument, with
+000075a0: 2061 6c6c 206f 7468 6572 0a20 2020 2020   all other.     
+000075b0: 2020 2020 2020 2061 7267 756d 656e 7473         arguments
+000075c0: 2070 6173 7365 6420 2a61 6674 6572 2a2e   passed *after*.
+000075d0: 2041 7267 756d 656e 7473 2063 616e 2062   Arguments can b
+000075e0: 6520 6060 5363 616c 6172 6060 2c20 6060  e ``Scalar``, ``
+000075f0: 4465 6c61 7965 6460 602c 0a20 2020 2020  Delayed``,.     
+00007600: 2020 2020 2020 206f 7220 7265 6775 6c61         or regula
+00007610: 7220 5079 7468 6f6e 206f 626a 6563 7473  r Python objects
+00007620: 2e20 4461 7461 4672 616d 652d 6c69 6b65  . DataFrame-like
+00007630: 2061 7267 7320 2862 6f74 6820 6461 736b   args (both dask
+00007640: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
+00007650: 2070 616e 6461 7329 2077 696c 6c20 6265   pandas) will be
+00007660: 2072 6570 6172 7469 7469 6f6e 6564 2074   repartitioned t
+00007670: 6f20 616c 6967 6e20 2869 6620 6e65 6365  o align (if nece
+00007680: 7373 6172 7929 2062 6566 6f72 650a 2020  ssary) before.  
+00007690: 2020 2020 2020 2020 2020 6170 706c 7969            applyi
+000076a0: 6e67 2074 6865 2066 756e 6374 696f 6e3b  ng the function;
+000076b0: 2073 6565 2060 6061 6c69 676e 5f64 6174   see ``align_dat
+000076c0: 6166 7261 6d65 7360 6020 746f 2063 6f6e  aframes`` to con
+000076d0: 7472 6f6c 2074 6869 730a 2020 2020 2020  trol this.      
+000076e0: 2020 2020 2020 6265 6861 7669 6f72 2e0a        behavior..
+000076f0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
+00007700: 6d65 7461 6461 7461 203a 2062 6f6f 6c2c  metadata : bool,
+00007710: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
+00007720: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
+00007730: 7220 746f 2065 6e66 6f72 6365 2061 7420  r to enforce at 
+00007740: 7275 6e74 696d 6520 7468 6174 2074 6865  runtime that the
+00007750: 2073 7472 7563 7475 7265 206f 6620 7468   structure of th
+00007760: 6520 4461 7461 4672 616d 650a 2020 2020  e DataFrame.    
+00007770: 2020 2020 2020 2020 7072 6f64 7563 6564          produced
+00007780: 2062 7920 6060 6675 6e63 6060 2061 6374   by ``func`` act
+00007790: 7561 6c6c 7920 6d61 7463 6865 7320 7468  ually matches th
+000077a0: 6520 7374 7275 6374 7572 6520 6f66 2060  e structure of `
+000077b0: 606d 6574 6160 602e 0a20 2020 2020 2020  `meta``..       
+000077c0: 2020 2020 2054 6869 7320 7769 6c6c 2072       This will r
+000077d0: 656e 616d 6520 616e 6420 7265 6f72 6465  ename and reorde
+000077e0: 7220 636f 6c75 6d6e 7320 666f 7220 6561  r columns for ea
+000077f0: 6368 2070 6172 7469 7469 6f6e 2c0a 2020  ch partition,.  
+00007800: 2020 2020 2020 2020 2020 616e 6420 7769            and wi
+00007810: 6c6c 2072 6169 7365 2061 6e20 6572 726f  ll raise an erro
+00007820: 7220 6966 2074 6869 7320 646f 6573 6e27  r if this doesn'
+00007830: 7420 776f 726b 2c0a 2020 2020 2020 2020  t work,.        
+00007840: 2020 2020 6275 7420 6974 2077 6f6e 2774      but it won't
+00007850: 2072 6169 7365 2069 6620 6474 7970 6573   raise if dtypes
+00007860: 2064 6f6e 2774 206d 6174 6368 2e0a 2020   don't match..  
+00007870: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
+00007880: 6469 7669 7369 6f6e 7320 3a20 626f 6f6c  divisions : bool
+00007890: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
+000078a0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
+000078b0: 6572 2074 6f20 6170 706c 7920 7468 6520  er to apply the 
+000078c0: 6675 6e63 7469 6f6e 206f 6e74 6f20 7468  function onto th
+000078d0: 6520 6469 7669 7369 6f6e 7320 616e 6420  e divisions and 
+000078e0: 6170 706c 7920 7468 6f73 650a 2020 2020  apply those.    
+000078f0: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
+00007900: 6d65 6420 6469 7669 7369 6f6e 7320 746f  med divisions to
+00007910: 2074 6865 206f 7574 7075 742e 0a20 2020   the output..   
+00007920: 2020 2020 2061 6c69 676e 5f64 6174 6166       align_dataf
+00007930: 7261 6d65 7320 3a20 626f 6f6c 2c20 6465  rames : bool, de
+00007940: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
+00007950: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
+00007960: 6f20 7265 7061 7274 6974 696f 6e20 4461  o repartition Da
+00007970: 7461 4672 616d 652d 206f 7220 5365 7269  taFrame- or Seri
+00007980: 6573 2d6c 696b 6520 6172 6773 0a20 2020  es-like args.   
+00007990: 2020 2020 2020 2020 2028 626f 7468 2064           (both d
+000079a0: 6173 6b20 616e 6420 7061 6e64 6173 2920  ask and pandas) 
+000079b0: 736f 2074 6865 6972 2064 6976 6973 696f  so their divisio
+000079c0: 6e73 2061 6c69 676e 2062 6566 6f72 6520  ns align before 
+000079d0: 6170 706c 7969 6e67 0a20 2020 2020 2020  applying.       
+000079e0: 2020 2020 2074 6865 2066 756e 6374 696f       the functio
+000079f0: 6e2e 2054 6869 7320 7265 7175 6972 6573  n. This requires
+00007a00: 2061 6c6c 2069 6e70 7574 7320 746f 2068   all inputs to h
+00007a10: 6176 6520 6b6e 6f77 6e20 6469 7669 7369  ave known divisi
+00007a20: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
+00007a30: 2053 696e 676c 652d 7061 7274 6974 696f   Single-partitio
+00007a40: 6e20 696e 7075 7473 2077 696c 6c20 6265  n inputs will be
+00007a50: 2073 706c 6974 2069 6e74 6f20 6d75 6c74   split into mult
+00007a60: 6970 6c65 2070 6172 7469 7469 6f6e 732e  iple partitions.
+00007a70: 0a0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+00007a80: 2046 616c 7365 2c20 616c 6c20 696e 7075   False, all inpu
+00007a90: 7473 206d 7573 7420 6861 7665 2065 6974  ts must have eit
+00007aa0: 6865 7220 7468 6520 7361 6d65 206e 756d  her the same num
+00007ab0: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
+00007ac0: 730a 2020 2020 2020 2020 2020 2020 6f72  s.            or
+00007ad0: 2061 2073 696e 676c 6520 7061 7274 6974   a single partit
+00007ae0: 696f 6e2e 2053 696e 676c 652d 7061 7274  ion. Single-part
+00007af0: 6974 696f 6e20 696e 7075 7473 2077 696c  ition inputs wil
+00007b00: 6c20 6265 2062 726f 6164 6361 7374 2074  l be broadcast t
+00007b10: 6f0a 2020 2020 2020 2020 2020 2020 6576  o.            ev
+00007b20: 6572 7920 7061 7274 6974 696f 6e20 6f66  ery partition of
+00007b30: 206d 756c 7469 2d70 6172 7469 7469 6f6e   multi-partition
+00007b40: 2069 6e70 7574 732e 0a20 2020 2020 2020   inputs..       
+00007b50: 2024 4d45 5441 0a0a 2020 2020 2020 2020   $META..        
+00007b60: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+00007b70: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00007b80: 2020 4769 7665 6e20 6120 4461 7461 4672    Given a DataFr
+00007b90: 616d 652c 2053 6572 6965 732c 206f 7220  ame, Series, or 
+00007ba0: 496e 6465 782c 2073 7563 6820 6173 3a0a  Index, such as:.
+00007bb0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+00007bc0: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
+00007bd0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+00007be0: 6f72 7420 6461 736b 2e64 6174 6166 7261  ort dask.datafra
+00007bf0: 6d65 2061 7320 6464 0a20 2020 2020 2020  me as dd.       
+00007c00: 203e 3e3e 2064 6620 3d20 7064 2e44 6174   >>> df = pd.Dat
+00007c10: 6146 7261 6d65 287b 2778 273a 205b 312c  aFrame({'x': [1,
+00007c20: 2032 2c20 332c 2034 2c20 355d 2c0a 2020   2, 3, 4, 5],.  
+00007c30: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+00007c40: 2020 2020 2020 2020 2020 2020 2027 7927               'y'
+00007c50: 3a20 5b31 2e2c 2032 2e2c 2033 2e2c 2034  : [1., 2., 3., 4
+00007c60: 2e2c 2035 2e5d 7d29 0a20 2020 2020 2020  ., 5.]}).       
+00007c70: 203e 3e3e 2064 6466 203d 2064 642e 6672   >>> ddf = dd.fr
+00007c80: 6f6d 5f70 616e 6461 7328 6466 2c20 6e70  om_pandas(df, np
+00007c90: 6172 7469 7469 6f6e 733d 3229 0a0a 2020  artitions=2)..  
+00007ca0: 2020 2020 2020 4f6e 6520 6361 6e20 7573        One can us
+00007cb0: 6520 6060 6d61 705f 7061 7274 6974 696f  e ``map_partitio
+00007cc0: 6e73 6060 2074 6f20 6170 706c 7920 6120  ns`` to apply a 
+00007cd0: 6675 6e63 7469 6f6e 206f 6e20 6561 6368  function on each
+00007ce0: 2070 6172 7469 7469 6f6e 2e0a 2020 2020   partition..    
+00007cf0: 2020 2020 4578 7472 6120 6172 6775 6d65      Extra argume
+00007d00: 6e74 7320 616e 6420 6b65 7977 6f72 6473  nts and keywords
+00007d10: 2063 616e 206f 7074 696f 6e61 6c6c 7920   can optionally 
+00007d20: 6265 2070 726f 7669 6465 642c 2061 6e64  be provided, and
+00007d30: 2077 696c 6c20 6265 0a20 2020 2020 2020   will be.       
+00007d40: 2070 6173 7365 6420 746f 2074 6865 2066   passed to the f
+00007d50: 756e 6374 696f 6e20 6166 7465 7220 7468  unction after th
+00007d60: 6520 7061 7274 6974 696f 6e2e 0a0a 2020  e partition...  
+00007d70: 2020 2020 2020 4865 7265 2077 6520 6170        Here we ap
+00007d80: 706c 7920 6120 6675 6e63 7469 6f6e 2077  ply a function w
+00007d90: 6974 6820 6172 6775 6d65 6e74 7320 616e  ith arguments an
+00007da0: 6420 6b65 7977 6f72 6473 2074 6f20 6120  d keywords to a 
+00007db0: 4461 7461 4672 616d 652c 0a20 2020 2020  DataFrame,.     
+00007dc0: 2020 2072 6573 756c 7469 6e67 2069 6e20     resulting in 
+00007dd0: 6120 5365 7269 6573 3a0a 0a20 2020 2020  a Series:..     
+00007de0: 2020 203e 3e3e 2064 6566 206d 7961 6464     >>> def myadd
+00007df0: 2864 662c 2061 2c20 623d 3129 3a0a 2020  (df, a, b=1):.  
+00007e00: 2020 2020 2020 2e2e 2e20 2020 2020 7265        ...     re
+00007e10: 7475 726e 2064 662e 7820 2b20 6466 2e79  turn df.x + df.y
+00007e20: 202b 2061 202b 2062 0a20 2020 2020 2020   + a + b.       
+00007e30: 203e 3e3e 2072 6573 203d 2064 6466 2e6d   >>> res = ddf.m
+00007e40: 6170 5f70 6172 7469 7469 6f6e 7328 6d79  ap_partitions(my
+00007e50: 6164 642c 2031 2c20 623d 3229 0a20 2020  add, 1, b=2).   
+00007e60: 2020 2020 203e 3e3e 2072 6573 2e64 7479       >>> res.dty
+00007e70: 7065 0a20 2020 2020 2020 2064 7479 7065  pe.        dtype
+00007e80: 2827 666c 6f61 7436 3427 290a 0a20 2020  ('float64')..   
+00007e90: 2020 2020 2048 6572 6520 7765 2061 7070       Here we app
+00007ea0: 6c79 2061 2066 756e 6374 696f 6e20 746f  ly a function to
+00007eb0: 2061 2053 6572 6965 7320 7265 7375 6c74   a Series result
+00007ec0: 696e 6720 696e 2061 2053 6572 6965 733a  ing in a Series:
+00007ed0: 0a0a 2020 2020 2020 2020 3e3e 3e20 7265  ..        >>> re
+00007ee0: 7320 3d20 6464 662e 782e 6d61 705f 7061  s = ddf.x.map_pa
+00007ef0: 7274 6974 696f 6e73 286c 616d 6264 6120  rtitions(lambda 
+00007f00: 783a 206c 656e 2878 2929 2023 2064 6466  x: len(x)) # ddf
+00007f10: 2e78 2069 7320 6120 4461 736b 2053 6572  .x is a Dask Ser
+00007f20: 6965 7320 5374 7275 6374 7572 650a 2020  ies Structure.  
+00007f30: 2020 2020 2020 3e3e 3e20 7265 732e 6474        >>> res.dt
+00007f40: 7970 650a 2020 2020 2020 2020 6474 7970  ype.        dtyp
+00007f50: 6528 2769 6e74 3634 2729 0a0a 2020 2020  e('int64')..    
+00007f60: 2020 2020 4279 2064 6566 6175 6c74 2c20      By default, 
+00007f70: 6461 736b 2074 7269 6573 2074 6f20 696e  dask tries to in
+00007f80: 6665 7220 7468 6520 6f75 7470 7574 206d  fer the output m
+00007f90: 6574 6164 6174 6120 6279 2072 756e 6e69  etadata by runni
+00007fa0: 6e67 2079 6f75 720a 2020 2020 2020 2020  ng your.        
+00007fb0: 7072 6f76 6964 6564 2066 756e 6374 696f  provided functio
+00007fc0: 6e20 6f6e 2073 6f6d 6520 6661 6b65 2064  n on some fake d
+00007fd0: 6174 612e 2054 6869 7320 776f 726b 7320  ata. This works 
+00007fe0: 7765 6c6c 2069 6e20 6d61 6e79 2063 6173  well in many cas
+00007ff0: 6573 2c20 6275 740a 2020 2020 2020 2020  es, but.        
+00008000: 6361 6e20 736f 6d65 7469 6d65 7320 6265  can sometimes be
+00008010: 2065 7870 656e 7369 7665 2c20 6f72 2065   expensive, or e
+00008020: 7665 6e20 6661 696c 2e20 546f 2061 766f  ven fail. To avo
+00008030: 6964 2074 6869 732c 2079 6f75 2063 616e  id this, you can
+00008040: 0a20 2020 2020 2020 206d 616e 7561 6c6c  .        manuall
+00008050: 7920 7370 6563 6966 7920 7468 6520 6f75  y specify the ou
+00008060: 7470 7574 206d 6574 6164 6174 6120 7769  tput metadata wi
+00008070: 7468 2074 6865 2060 606d 6574 6160 6020  th the ``meta`` 
+00008080: 6b65 7977 6f72 642e 2054 6869 730a 2020  keyword. This.  
+00008090: 2020 2020 2020 6361 6e20 6265 2073 7065        can be spe
+000080a0: 6369 6669 6564 2069 6e20 6d61 6e79 2066  cified in many f
+000080b0: 6f72 6d73 2c20 666f 7220 6d6f 7265 2069  orms, for more i
+000080c0: 6e66 6f72 6d61 7469 6f6e 2073 6565 0a20  nformation see. 
+000080d0: 2020 2020 2020 2060 6064 6173 6b2e 6461         ``dask.da
+000080e0: 7461 6672 616d 652e 7574 696c 732e 6d61  taframe.utils.ma
+000080f0: 6b65 5f6d 6574 6160 602e 0a0a 2020 2020  ke_meta``...    
+00008100: 2020 2020 4865 7265 2077 6520 7370 6563      Here we spec
+00008110: 6966 7920 7468 6520 6f75 7470 7574 2069  ify the output i
+00008120: 7320 6120 5365 7269 6573 2077 6974 6820  s a Series with 
+00008130: 6e6f 206e 616d 652c 2061 6e64 2064 7479  no name, and dty
+00008140: 7065 0a20 2020 2020 2020 2060 6066 6c6f  pe.        ``flo
+00008150: 6174 3634 6060 3a0a 0a20 2020 2020 2020  at64``:..       
+00008160: 203e 3e3e 2072 6573 203d 2064 6466 2e6d   >>> res = ddf.m
+00008170: 6170 5f70 6172 7469 7469 6f6e 7328 6d79  ap_partitions(my
+00008180: 6164 642c 2031 2c20 623d 322c 206d 6574  add, 1, b=2, met
+00008190: 613d 284e 6f6e 652c 2027 6638 2729 290a  a=(None, 'f8')).
+000081a0: 0a20 2020 2020 2020 2048 6572 6520 7765  .        Here we
+000081b0: 206d 6170 2061 2066 756e 6374 696f 6e20   map a function 
+000081c0: 7468 6174 2074 616b 6573 2069 6e20 6120  that takes in a 
+000081d0: 4461 7461 4672 616d 652c 2061 6e64 2072  DataFrame, and r
+000081e0: 6574 7572 6e73 2061 0a20 2020 2020 2020  eturns a.       
+000081f0: 2044 6174 6146 7261 6d65 2077 6974 6820   DataFrame with 
+00008200: 6120 6e65 7720 636f 6c75 6d6e 3a0a 0a20  a new column:.. 
+00008210: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
+00008220: 2064 6466 2e6d 6170 5f70 6172 7469 7469   ddf.map_partiti
+00008230: 6f6e 7328 6c61 6d62 6461 2064 663a 2064  ons(lambda df: d
+00008240: 662e 6173 7369 676e 287a 3d64 662e 7820  f.assign(z=df.x 
+00008250: 2a20 6466 2e79 2929 0a20 2020 2020 2020  * df.y)).       
+00008260: 203e 3e3e 2072 6573 2e64 7479 7065 730a   >>> res.dtypes.
+00008270: 2020 2020 2020 2020 7820 2020 2020 2069          x      i
+00008280: 6e74 3634 0a20 2020 2020 2020 2079 2020  nt64.        y  
+00008290: 2020 666c 6f61 7436 340a 2020 2020 2020    float64.      
+000082a0: 2020 7a20 2020 2066 6c6f 6174 3634 0a20    z    float64. 
+000082b0: 2020 2020 2020 2064 7479 7065 3a20 6f62         dtype: ob
+000082c0: 6a65 6374 0a0a 2020 2020 2020 2020 4173  ject..        As
+000082d0: 2062 6566 6f72 652c 2074 6865 206f 7574   before, the out
+000082e0: 7075 7420 6d65 7461 6461 7461 2063 616e  put metadata can
+000082f0: 2061 6c73 6f20 6265 2073 7065 6369 6669   also be specifi
+00008300: 6564 206d 616e 7561 6c6c 792e 2054 6869  ed manually. Thi
+00008310: 730a 2020 2020 2020 2020 7469 6d65 2077  s.        time w
+00008320: 6520 7061 7373 2069 6e20 6120 6060 6469  e pass in a ``di
+00008330: 6374 6060 2c20 6173 2074 6865 206f 7574  ct``, as the out
+00008340: 7075 7420 6973 2061 2044 6174 6146 7261  put is a DataFra
+00008350: 6d65 3a0a 0a20 2020 2020 2020 203e 3e3e  me:..        >>>
+00008360: 2072 6573 203d 2064 6466 2e6d 6170 5f70   res = ddf.map_p
+00008370: 6172 7469 7469 6f6e 7328 6c61 6d62 6461  artitions(lambda
+00008380: 2064 663a 2064 662e 6173 7369 676e 287a   df: df.assign(z
+00008390: 3d64 662e 7820 2a20 6466 2e79 292c 0a20  =df.x * df.y),. 
+000083a0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+000083b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000083c0: 2020 2020 6d65 7461 3d7b 2778 273a 2027      meta={'x': '
+000083d0: 6938 272c 2027 7927 3a20 2766 3827 2c20  i8', 'y': 'f8', 
+000083e0: 277a 273a 2027 6638 277d 290a 0a20 2020  'z': 'f8'})..   
+000083f0: 2020 2020 2049 6e20 7468 6520 6361 7365       In the case
+00008400: 2077 6865 7265 2074 6865 206d 6574 6164   where the metad
+00008410: 6174 6120 646f 6573 6e27 7420 6368 616e  ata doesn't chan
+00008420: 6765 2c20 796f 7520 6361 6e20 616c 736f  ge, you can also
+00008430: 2070 6173 7320 696e 0a20 2020 2020 2020   pass in.       
+00008440: 2074 6865 206f 626a 6563 7420 6974 7365   the object itse
+00008450: 6c66 2064 6972 6563 746c 793a 0a0a 2020  lf directly:..  
+00008460: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
+00008470: 6464 662e 6d61 705f 7061 7274 6974 696f  ddf.map_partitio
+00008480: 6e73 286c 616d 6264 6120 6466 3a20 6466  ns(lambda df: df
+00008490: 2e68 6561 6428 292c 206d 6574 613d 6464  .head(), meta=dd
+000084a0: 6629 0a0a 2020 2020 2020 2020 416c 736f  f)..        Also
+000084b0: 206e 6f74 6520 7468 6174 2074 6865 2069   note that the i
+000084c0: 6e64 6578 2061 6e64 2064 6976 6973 696f  ndex and divisio
+000084d0: 6e73 2061 7265 2061 7373 756d 6564 2074  ns are assumed t
+000084e0: 6f20 7265 6d61 696e 2075 6e63 6861 6e67  o remain unchang
+000084f0: 6564 2e0a 2020 2020 2020 2020 4966 2074  ed..        If t
+00008500: 6865 2066 756e 6374 696f 6e20 796f 7527  he function you'
+00008510: 7265 206d 6170 7069 6e67 2063 6861 6e67  re mapping chang
+00008520: 6573 2074 6865 2069 6e64 6578 2f64 6976  es the index/div
+00008530: 6973 696f 6e73 2c20 796f 7527 6c6c 206e  isions, you'll n
+00008540: 6565 640a 2020 2020 2020 2020 746f 2063  eed.        to c
+00008550: 6c65 6172 2074 6865 6d20 6166 7465 7277  lear them afterw
+00008560: 6172 6473 3a0a 0a20 2020 2020 2020 203e  ards:..        >
+00008570: 3e3e 2064 6466 2e6d 6170 5f70 6172 7469  >> ddf.map_parti
+00008580: 7469 6f6e 7328 6675 6e63 292e 636c 6561  tions(func).clea
+00008590: 725f 6469 7669 7369 6f6e 7328 2920 2023  r_divisions()  #
+000085a0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
+000085b0: 0a20 2020 2020 2020 2059 6f75 7220 6d61  .        Your ma
+000085c0: 7020 6675 6e63 7469 6f6e 2067 6574 7320  p function gets 
+000085d0: 696e 666f 726d 6174 696f 6e20 6162 6f75  information abou
+000085e0: 7420 7768 6572 6520 6974 2069 7320 696e  t where it is in
+000085f0: 2074 6865 2064 6174 6166 7261 6d65 2062   the dataframe b
+00008600: 790a 2020 2020 2020 2020 6163 6365 7074  y.        accept
+00008610: 696e 6720 6120 7370 6563 6961 6c20 6060  ing a special ``
+00008620: 7061 7274 6974 696f 6e5f 696e 666f 6060  partition_info``
+00008630: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
+00008640: 742e 0a0a 2020 2020 2020 2020 3e3e 3e20  t...        >>> 
+00008650: 6465 6620 6675 6e63 2870 6172 7469 7469  def func(partiti
+00008660: 6f6e 2c20 7061 7274 6974 696f 6e5f 696e  on, partition_in
+00008670: 666f 3d4e 6f6e 6529 3a0a 2020 2020 2020  fo=None):.      
+00008680: 2020 2e2e 2e20 2020 2020 7061 7373 0a0a    ...     pass..
+00008690: 2020 2020 2020 2020 5468 6973 2077 696c          This wil
+000086a0: 6c20 7265 6365 6976 6520 7468 6520 666f  l receive the fo
+000086b0: 6c6c 6f77 696e 6720 696e 666f 726d 6174  llowing informat
+000086c0: 696f 6e3a 0a0a 2020 2020 2020 2020 3e3e  ion:..        >>
+000086d0: 3e20 7061 7274 6974 696f 6e5f 696e 666f  > partition_info
+000086e0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+000086f0: 4950 0a20 2020 2020 2020 207b 276e 756d  IP.        {'num
+00008700: 6265 7227 3a20 312c 2027 6469 7669 7369  ber': 1, 'divisi
+00008710: 6f6e 273a 2033 7d0a 0a20 2020 2020 2020  on': 3}..       
+00008720: 2046 6f72 2065 6163 6820 6172 6775 6d65   For each argume
+00008730: 6e74 2061 6e64 206b 6579 776f 7264 2061  nt and keyword a
+00008740: 7267 756d 656e 7473 2074 6861 7420 6172  rguments that ar
+00008750: 6520 6461 736b 2064 6174 6166 7261 6d65  e dask dataframe
+00008760: 7320 796f 7520 7769 6c6c 0a20 2020 2020  s you will.     
+00008770: 2020 2072 6563 6569 7665 2074 6865 206e     receive the n
+00008780: 756d 6265 7220 286e 2920 7768 6963 6820  umber (n) which 
+00008790: 7265 7072 6573 656e 7473 2074 6865 206e  represents the n
+000087a0: 7468 2070 6172 7469 7469 6f6e 206f 6620  th partition of 
+000087b0: 7468 6520 6461 7461 6672 616d 650a 2020  the dataframe.  
+000087c0: 2020 2020 2020 616e 6420 7468 6520 6469        and the di
+000087d0: 7669 7369 6f6e 2028 7468 6520 6669 7273  vision (the firs
+000087e0: 7420 696e 6465 7820 7661 6c75 6520 696e  t index value in
+000087f0: 2074 6865 2070 6172 7469 7469 6f6e 292e   the partition).
+00008800: 2049 6620 6469 7669 7369 6f6e 730a 2020   If divisions.  
+00008810: 2020 2020 2020 6172 6520 6e6f 7420 6b6e        are not kn
+00008820: 6f77 6e20 2866 6f72 2069 6e73 7461 6e63  own (for instanc
+00008830: 6520 6966 2074 6865 2069 6e64 6578 2069  e if the index i
+00008840: 7320 6e6f 7420 736f 7274 6564 2920 7468  s not sorted) th
+00008850: 656e 2079 6f75 2077 696c 6c20 6765 740a  en you will get.
+00008860: 2020 2020 2020 2020 4e6f 6e65 2061 7320          None as 
+00008870: 7468 6520 6469 7669 7369 6f6e 2e0a 2020  the division..  
+00008880: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00008890: 2020 7265 7475 726e 206d 6170 5f70 6172    return map_par
+000088a0: 7469 7469 6f6e 7328 6675 6e63 2c20 7365  titions(func, se
+000088b0: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
+000088c0: 7267 7329 0a0a 2020 2020 4069 6e73 6572  rgs)..    @inser
+000088d0: 745f 6d65 7461 5f70 6172 616d 5f64 6573  t_meta_param_des
+000088e0: 6372 6970 7469 6f6e 2870 6164 3d31 3229  cription(pad=12)
+000088f0: 0a20 2020 2064 6566 206d 6170 5f6f 7665  .    def map_ove
+00008900: 726c 6170 2873 656c 662c 2066 756e 632c  rlap(self, func,
+00008910: 2062 6566 6f72 652c 2061 6674 6572 2c20   before, after, 
+00008920: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00008930: 3a0a 2020 2020 2020 2020 2222 2241 7070  :.        """App
+00008940: 6c79 2061 2066 756e 6374 696f 6e20 746f  ly a function to
+00008950: 2065 6163 6820 7061 7274 6974 696f 6e2c   each partition,
+00008960: 2073 6861 7269 6e67 2072 6f77 7320 7769   sharing rows wi
+00008970: 7468 2061 646a 6163 656e 7420 7061 7274  th adjacent part
+00008980: 6974 696f 6e73 2e0a 0a20 2020 2020 2020  itions...       
+00008990: 2054 6869 7320 6361 6e20 6265 2075 7365   This can be use
+000089a0: 6675 6c20 666f 7220 696d 706c 656d 656e  ful for implemen
+000089b0: 7469 6e67 2077 696e 646f 7769 6e67 2066  ting windowing f
+000089c0: 756e 6374 696f 6e73 2073 7563 6820 6173  unctions such as
+000089d0: 0a20 2020 2020 2020 2060 6064 662e 726f  .        ``df.ro
+000089e0: 6c6c 696e 6728 2e2e 2e29 2e6d 6561 6e28  lling(...).mean(
+000089f0: 2960 6020 6f72 2060 6064 662e 6469 6666  )`` or ``df.diff
+00008a00: 2829 6060 2e0a 0a20 2020 2020 2020 2050  ()``...        P
+00008a10: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00008a20: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00008a30: 2020 2020 2066 756e 6320 3a20 6675 6e63       func : func
+00008a40: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+00008a50: 2046 756e 6374 696f 6e20 6170 706c 6965   Function applie
+00008a60: 6420 746f 2065 6163 6820 7061 7274 6974  d to each partit
+00008a70: 696f 6e2e 0a20 2020 2020 2020 2062 6566  ion..        bef
+00008a80: 6f72 6520 3a20 696e 742c 2074 696d 6564  ore : int, timed
+00008a90: 656c 7461 206f 7220 7374 7269 6e67 2074  elta or string t
+00008aa0: 696d 6564 656c 7461 0a20 2020 2020 2020  imedelta.       
+00008ab0: 2020 2020 2054 6865 2072 6f77 7320 746f       The rows to
+00008ac0: 2070 7265 7065 6e64 2074 6f20 7061 7274   prepend to part
+00008ad0: 6974 696f 6e20 6060 6960 6020 6672 6f6d  ition ``i`` from
+00008ae0: 2074 6865 2065 6e64 206f 660a 2020 2020   the end of.    
+00008af0: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
+00008b00: 6e20 6060 6920 2d20 3160 602e 0a20 2020  n ``i - 1``..   
+00008b10: 2020 2020 2061 6674 6572 203a 2069 6e74       after : int
+00008b20: 2c20 7469 6d65 6465 6c74 6120 6f72 2073  , timedelta or s
+00008b30: 7472 696e 6720 7469 6d65 6465 6c74 610a  tring timedelta.
+00008b40: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00008b50: 726f 7773 2074 6f20 6170 7065 6e64 2074  rows to append t
+00008b60: 6f20 7061 7274 6974 696f 6e20 6060 6960  o partition ``i`
+00008b70: 6020 6672 6f6d 2074 6865 2062 6567 696e  ` from the begin
+00008b80: 6e69 6e67 0a20 2020 2020 2020 2020 2020  ning.           
+00008b90: 206f 6620 7061 7274 6974 696f 6e20 6060   of partition ``
+00008ba0: 6920 2b20 3160 602e 0a20 2020 2020 2020  i + 1``..       
+00008bb0: 2061 7267 732c 206b 7761 7267 7320 3a0a   args, kwargs :.
+00008bc0: 2020 2020 2020 2020 2020 2020 506f 7369              Posi
+00008bd0: 7469 6f6e 616c 2061 6e64 206b 6579 776f  tional and keywo
+00008be0: 7264 2061 7267 756d 656e 7473 2074 6f20  rd arguments to 
+00008bf0: 7061 7373 2074 6f20 7468 6520 6675 6e63  pass to the func
+00008c00: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
+00008c10: 2020 506f 7369 7469 6f6e 616c 2061 7267    Positional arg
+00008c20: 756d 656e 7473 2061 7265 2063 6f6d 7075  uments are compu
+00008c30: 7465 6420 6f6e 2061 2070 6572 2d70 6172  ted on a per-par
+00008c40: 7469 7469 6f6e 2062 6173 6973 2c20 7768  tition basis, wh
+00008c50: 696c 650a 2020 2020 2020 2020 2020 2020  ile.            
+00008c60: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+00008c70: 7320 6172 6520 7368 6172 6564 2061 6372  s are shared acr
+00008c80: 6f73 7320 616c 6c20 7061 7274 6974 696f  oss all partitio
+00008c90: 6e73 2e20 5468 6520 7061 7274 6974 696f  ns. The partitio
+00008ca0: 6e0a 2020 2020 2020 2020 2020 2020 6974  n.            it
+00008cb0: 7365 6c66 2077 696c 6c20 6265 2074 6865  self will be the
+00008cc0: 2066 6972 7374 2070 6f73 6974 696f 6e61   first positiona
+00008cd0: 6c20 6172 6775 6d65 6e74 2c20 7769 7468  l argument, with
+00008ce0: 2061 6c6c 206f 7468 6572 0a20 2020 2020   all other.     
+00008cf0: 2020 2020 2020 2061 7267 756d 656e 7473         arguments
+00008d00: 2070 6173 7365 6420 2a61 6674 6572 2a2e   passed *after*.
+00008d10: 2041 7267 756d 656e 7473 2063 616e 2062   Arguments can b
+00008d20: 6520 6060 5363 616c 6172 6060 2c20 6060  e ``Scalar``, ``
+00008d30: 4465 6c61 7965 6460 602c 0a20 2020 2020  Delayed``,.     
+00008d40: 2020 2020 2020 206f 7220 7265 6775 6c61         or regula
+00008d50: 7220 5079 7468 6f6e 206f 626a 6563 7473  r Python objects
+00008d60: 2e20 4461 7461 4672 616d 652d 6c69 6b65  . DataFrame-like
+00008d70: 2061 7267 7320 2862 6f74 6820 6461 736b   args (both dask
+00008d80: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
+00008d90: 2070 616e 6461 7329 2077 696c 6c20 6265   pandas) will be
+00008da0: 2072 6570 6172 7469 7469 6f6e 6564 2074   repartitioned t
+00008db0: 6f20 616c 6967 6e20 2869 6620 6e65 6365  o align (if nece
+00008dc0: 7373 6172 7929 2062 6566 6f72 650a 2020  ssary) before.  
+00008dd0: 2020 2020 2020 2020 2020 6170 706c 7969            applyi
+00008de0: 6e67 2074 6865 2066 756e 6374 696f 6e3b  ng the function;
+00008df0: 2073 6565 2060 6061 6c69 676e 5f64 6174   see ``align_dat
+00008e00: 6166 7261 6d65 7360 6020 746f 2063 6f6e  aframes`` to con
+00008e10: 7472 6f6c 2074 6869 730a 2020 2020 2020  trol this.      
+00008e20: 2020 2020 2020 6265 6861 7669 6f72 2e0a        behavior..
+00008e30: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
+00008e40: 6d65 7461 6461 7461 203a 2062 6f6f 6c2c  metadata : bool,
+00008e50: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
+00008e60: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
+00008e70: 7220 746f 2065 6e66 6f72 6365 2061 7420  r to enforce at 
+00008e80: 7275 6e74 696d 6520 7468 6174 2074 6865  runtime that the
+00008e90: 2073 7472 7563 7475 7265 206f 6620 7468   structure of th
+00008ea0: 6520 4461 7461 4672 616d 650a 2020 2020  e DataFrame.    
+00008eb0: 2020 2020 2020 2020 7072 6f64 7563 6564          produced
+00008ec0: 2062 7920 6060 6675 6e63 6060 2061 6374   by ``func`` act
+00008ed0: 7561 6c6c 7920 6d61 7463 6865 7320 7468  ually matches th
+00008ee0: 6520 7374 7275 6374 7572 6520 6f66 2060  e structure of `
+00008ef0: 606d 6574 6160 602e 0a20 2020 2020 2020  `meta``..       
+00008f00: 2020 2020 2054 6869 7320 7769 6c6c 2072       This will r
+00008f10: 656e 616d 6520 616e 6420 7265 6f72 6465  ename and reorde
+00008f20: 7220 636f 6c75 6d6e 7320 666f 7220 6561  r columns for ea
+00008f30: 6368 2070 6172 7469 7469 6f6e 2c0a 2020  ch partition,.  
+00008f40: 2020 2020 2020 2020 2020 616e 6420 7769            and wi
+00008f50: 6c6c 2072 6169 7365 2061 6e20 6572 726f  ll raise an erro
+00008f60: 7220 6966 2074 6869 7320 646f 6573 6e27  r if this doesn'
+00008f70: 7420 776f 726b 2c0a 2020 2020 2020 2020  t work,.        
+00008f80: 2020 2020 6275 7420 6974 2077 6f6e 2774      but it won't
+00008f90: 2072 6169 7365 2069 6620 6474 7970 6573   raise if dtypes
+00008fa0: 2064 6f6e 2774 206d 6174 6368 2e0a 2020   don't match..  
+00008fb0: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
+00008fc0: 6469 7669 7369 6f6e 7320 3a20 626f 6f6c  divisions : bool
+00008fd0: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
+00008fe0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
+00008ff0: 6572 2074 6f20 6170 706c 7920 7468 6520  er to apply the 
+00009000: 6675 6e63 7469 6f6e 206f 6e74 6f20 7468  function onto th
+00009010: 6520 6469 7669 7369 6f6e 7320 616e 6420  e divisions and 
+00009020: 6170 706c 7920 7468 6f73 650a 2020 2020  apply those.    
+00009030: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
+00009040: 6d65 6420 6469 7669 7369 6f6e 7320 746f  med divisions to
+00009050: 2074 6865 206f 7574 7075 742e 0a20 2020   the output..   
+00009060: 2020 2020 2061 6c69 676e 5f64 6174 6166       align_dataf
+00009070: 7261 6d65 7320 3a20 626f 6f6c 2c20 6465  rames : bool, de
+00009080: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
+00009090: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
+000090a0: 6f20 7265 7061 7274 6974 696f 6e20 4461  o repartition Da
+000090b0: 7461 4672 616d 652d 206f 7220 5365 7269  taFrame- or Seri
+000090c0: 6573 2d6c 696b 6520 6172 6773 0a20 2020  es-like args.   
+000090d0: 2020 2020 2020 2020 2028 626f 7468 2064           (both d
+000090e0: 6173 6b20 616e 6420 7061 6e64 6173 2920  ask and pandas) 
+000090f0: 736f 2074 6865 6972 2064 6976 6973 696f  so their divisio
+00009100: 6e73 2061 6c69 676e 2062 6566 6f72 6520  ns align before 
+00009110: 6170 706c 7969 6e67 0a20 2020 2020 2020  applying.       
+00009120: 2020 2020 2074 6865 2066 756e 6374 696f       the functio
+00009130: 6e2e 2054 6869 7320 7265 7175 6972 6573  n. This requires
+00009140: 2061 6c6c 2069 6e70 7574 7320 746f 2068   all inputs to h
+00009150: 6176 6520 6b6e 6f77 6e20 6469 7669 7369  ave known divisi
+00009160: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
+00009170: 2053 696e 676c 652d 7061 7274 6974 696f   Single-partitio
+00009180: 6e20 696e 7075 7473 2077 696c 6c20 6265  n inputs will be
+00009190: 2073 706c 6974 2069 6e74 6f20 6d75 6c74   split into mult
+000091a0: 6970 6c65 2070 6172 7469 7469 6f6e 732e  iple partitions.
+000091b0: 0a0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+000091c0: 2046 616c 7365 2c20 616c 6c20 696e 7075   False, all inpu
+000091d0: 7473 206d 7573 7420 6861 7665 2065 6974  ts must have eit
+000091e0: 6865 7220 7468 6520 7361 6d65 206e 756d  her the same num
+000091f0: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
+00009200: 730a 2020 2020 2020 2020 2020 2020 6f72  s.            or
+00009210: 2061 2073 696e 676c 6520 7061 7274 6974   a single partit
+00009220: 696f 6e2e 2053 696e 676c 652d 7061 7274  ion. Single-part
+00009230: 6974 696f 6e20 696e 7075 7473 2077 696c  ition inputs wil
+00009240: 6c20 6265 2062 726f 6164 6361 7374 2074  l be broadcast t
+00009250: 6f0a 2020 2020 2020 2020 2020 2020 6576  o.            ev
+00009260: 6572 7920 7061 7274 6974 696f 6e20 6f66  ery partition of
+00009270: 206d 756c 7469 2d70 6172 7469 7469 6f6e   multi-partition
+00009280: 2069 6e70 7574 732e 0a20 2020 2020 2020   inputs..       
+00009290: 2024 4d45 5441 0a0a 2020 2020 2020 2020   $META..        
+000092a0: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
+000092b0: 2d2d 2d0a 2020 2020 2020 2020 4769 7665  ---.        Give
+000092c0: 6e20 706f 7369 7469 7665 2069 6e74 6567  n positive integ
+000092d0: 6572 7320 6060 6265 666f 7265 6060 2061  ers ``before`` a
+000092e0: 6e64 2060 6061 6674 6572 6060 2c20 616e  nd ``after``, an
+000092f0: 6420 6120 6675 6e63 7469 6f6e 0a20 2020  d a function.   
+00009300: 2020 2020 2060 6066 756e 6360 602c 2060       ``func``, `
+00009310: 606d 6170 5f6f 7665 726c 6170 6060 2064  `map_overlap`` d
+00009320: 6f65 7320 7468 6520 666f 6c6c 6f77 696e  oes the followin
+00009330: 673a 0a0a 2020 2020 2020 2020 312e 2050  g:..        1. P
+00009340: 7265 7065 6e64 2060 6062 6566 6f72 6560  repend ``before`
+00009350: 6020 726f 7773 2074 6f20 6561 6368 2070  ` rows to each p
+00009360: 6172 7469 7469 6f6e 2060 6069 6060 2066  artition ``i`` f
+00009370: 726f 6d20 7468 6520 656e 6420 6f66 0a20  rom the end of. 
+00009380: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+00009390: 696f 6e20 6060 6920 2d20 3160 602e 2054  ion ``i - 1``. T
+000093a0: 6865 2066 6972 7374 2070 6172 7469 7469  he first partiti
+000093b0: 6f6e 2068 6173 206e 6f20 726f 7773 2070  on has no rows p
+000093c0: 7265 7065 6e64 6564 2e0a 0a20 2020 2020  repended...     
+000093d0: 2020 2032 2e20 4170 7065 6e64 2060 6061     2. Append ``a
+000093e0: 6674 6572 6060 2072 6f77 7320 746f 2065  fter`` rows to e
+000093f0: 6163 6820 7061 7274 6974 696f 6e20 6060  ach partition ``
+00009400: 6960 6020 6672 6f6d 2074 6865 2062 6567  i`` from the beg
+00009410: 696e 6e69 6e67 206f 660a 2020 2020 2020  inning of.      
+00009420: 2020 2020 2070 6172 7469 7469 6f6e 2060       partition `
+00009430: 6069 202b 2031 6060 2e20 5468 6520 6c61  `i + 1``. The la
+00009440: 7374 2070 6172 7469 7469 6f6e 2068 6173  st partition has
+00009450: 206e 6f20 726f 7773 2061 7070 656e 6465   no rows appende
+00009460: 642e 0a0a 2020 2020 2020 2020 332e 2041  d...        3. A
+00009470: 7070 6c79 2060 6066 756e 6360 6020 746f  pply ``func`` to
+00009480: 2065 6163 6820 7061 7274 6974 696f 6e2c   each partition,
+00009490: 2070 6173 7369 6e67 2069 6e20 616e 7920   passing in any 
+000094a0: 6578 7472 6120 6060 6172 6773 6060 2061  extra ``args`` a
+000094b0: 6e64 0a20 2020 2020 2020 2020 2020 6060  nd.           ``
+000094c0: 6b77 6172 6773 6060 2069 6620 7072 6f76  kwargs`` if prov
+000094d0: 6964 6564 2e0a 0a20 2020 2020 2020 2034  ided...        4
+000094e0: 2e20 5472 696d 2060 6062 6566 6f72 6560  . Trim ``before`
+000094f0: 6020 726f 7773 2066 726f 6d20 7468 6520  ` rows from the 
+00009500: 6265 6769 6e6e 696e 6720 6f66 2061 6c6c  beginning of all
+00009510: 2062 7574 2074 6865 2066 6972 7374 0a20   but the first. 
+00009520: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+00009530: 696f 6e2e 0a0a 2020 2020 2020 2020 352e  ion...        5.
+00009540: 2054 7269 6d20 6060 6166 7465 7260 6020   Trim ``after`` 
+00009550: 726f 7773 2066 726f 6d20 7468 6520 656e  rows from the en
+00009560: 6420 6f66 2061 6c6c 2062 7574 2074 6865  d of all but the
+00009570: 206c 6173 7420 7061 7274 6974 696f 6e2e   last partition.
+00009580: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+00009590: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+000095a0: 2d2d 2d0a 2020 2020 2020 2020 4769 7665  ---.        Give
+000095b0: 6e20 6120 4461 7461 4672 616d 652c 2053  n a DataFrame, S
+000095c0: 6572 6965 732c 206f 7220 496e 6465 782c  eries, or Index,
+000095d0: 2073 7563 6820 6173 3a0a 0a20 2020 2020   such as:..     
+000095e0: 2020 203e 3e3e 2069 6d70 6f72 7420 7061     >>> import pa
+000095f0: 6e64 6173 2061 7320 7064 0a20 2020 2020  ndas as pd.     
+00009600: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+00009610: 736b 2e64 6174 6166 7261 6d65 2061 7320  sk.dataframe as 
+00009620: 6464 0a20 2020 2020 2020 203e 3e3e 2064  dd.        >>> d
+00009630: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
+00009640: 287b 2778 273a 205b 312c 2032 2c20 342c  ({'x': [1, 2, 4,
+00009650: 2037 2c20 3131 5d2c 0a20 2020 2020 2020   7, 11],.       
+00009660: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
+00009670: 2020 2020 2020 2020 2779 273a 205b 312e          'y': [1.
+00009680: 2c20 322e 2c20 332e 2c20 342e 2c20 352e  , 2., 3., 4., 5.
+00009690: 5d7d 290a 2020 2020 2020 2020 3e3e 3e20  ]}).        >>> 
+000096a0: 6464 6620 3d20 6464 2e66 726f 6d5f 7061  ddf = dd.from_pa
+000096b0: 6e64 6173 2864 662c 206e 7061 7274 6974  ndas(df, npartit
+000096c0: 696f 6e73 3d32 290a 0a20 2020 2020 2020  ions=2)..       
+000096d0: 2041 2072 6f6c 6c69 6e67 2073 756d 2077   A rolling sum w
+000096e0: 6974 6820 6120 7472 6169 6c69 6e67 206d  ith a trailing m
+000096f0: 6f76 696e 6720 7769 6e64 6f77 206f 6620  oving window of 
+00009700: 7369 7a65 2032 2063 616e 2062 6520 636f  size 2 can be co
+00009710: 6d70 7574 6564 2062 790a 2020 2020 2020  mputed by.      
+00009720: 2020 6f76 6572 6c61 7070 696e 6720 3220    overlapping 2 
+00009730: 726f 7773 2062 6566 6f72 6520 6561 6368  rows before each
+00009740: 2070 6172 7469 7469 6f6e 2c20 616e 6420   partition, and 
+00009750: 7468 656e 206d 6170 7069 6e67 2063 616c  then mapping cal
+00009760: 6c73 2074 6f0a 2020 2020 2020 2020 6060  ls to.        ``
+00009770: 6466 2e72 6f6c 6c69 6e67 2832 292e 7375  df.rolling(2).su
+00009780: 6d28 2960 603a 0a0a 2020 2020 2020 2020  m()``:..        
+00009790: 3e3e 3e20 6464 662e 636f 6d70 7574 6528  >>> ddf.compute(
+000097a0: 290a 2020 2020 2020 2020 2020 2020 7820  ).            x 
+000097b0: 2020 2079 0a20 2020 2020 2020 2030 2020     y.        0  
+000097c0: 2031 2020 312e 300a 2020 2020 2020 2020   1  1.0.        
+000097d0: 3120 2020 3220 2032 2e30 0a20 2020 2020  1   2  2.0.     
+000097e0: 2020 2032 2020 2034 2020 332e 300a 2020     2   4  3.0.  
+000097f0: 2020 2020 2020 3320 2020 3720 2034 2e30        3   7  4.0
+00009800: 0a20 2020 2020 2020 2034 2020 3131 2020  .        4  11  
+00009810: 352e 300a 2020 2020 2020 2020 3e3e 3e20  5.0.        >>> 
+00009820: 6464 662e 6d61 705f 6f76 6572 6c61 7028  ddf.map_overlap(
+00009830: 6c61 6d62 6461 2064 663a 2064 662e 726f  lambda df: df.ro
+00009840: 6c6c 696e 6728 3229 2e73 756d 2829 2c20  lling(2).sum(), 
+00009850: 322c 2030 292e 636f 6d70 7574 6528 290a  2, 0).compute().
+00009860: 2020 2020 2020 2020 2020 2020 2020 7820                x 
+00009870: 2020 2079 0a20 2020 2020 2020 2030 2020     y.        0  
+00009880: 204e 614e 2020 4e61 4e0a 2020 2020 2020   NaN  NaN.      
+00009890: 2020 3120 2020 332e 3020 2033 2e30 0a20    1   3.0  3.0. 
+000098a0: 2020 2020 2020 2032 2020 2036 2e30 2020         2   6.0  
+000098b0: 352e 300a 2020 2020 2020 2020 3320 2031  5.0.        3  1
+000098c0: 312e 3020 2037 2e30 0a20 2020 2020 2020  1.0  7.0.       
+000098d0: 2034 2020 3138 2e30 2020 392e 300a 0a20   4  18.0  9.0.. 
+000098e0: 2020 2020 2020 2054 6865 2070 616e 6461         The panda
+000098f0: 7320 6060 6469 6666 6060 206d 6574 686f  s ``diff`` metho
+00009900: 6420 636f 6d70 7574 6573 2061 2064 6973  d computes a dis
+00009910: 6372 6574 6520 6469 6666 6572 656e 6365  crete difference
+00009920: 2073 6869 6674 6564 2062 7920 610a 2020   shifted by a.  
+00009930: 2020 2020 2020 6e75 6d62 6572 206f 6620        number of 
+00009940: 7065 7269 6f64 7320 2863 616e 2062 6520  periods (can be 
+00009950: 706f 7369 7469 7665 206f 7220 6e65 6761  positive or nega
+00009960: 7469 7665 292e 2054 6869 7320 6361 6e20  tive). This can 
+00009970: 6265 0a20 2020 2020 2020 2069 6d70 6c65  be.        imple
+00009980: 6d65 6e74 6564 2062 7920 6d61 7070 696e  mented by mappin
+00009990: 6720 6361 6c6c 7320 746f 2060 6064 662e  g calls to ``df.
+000099a0: 6469 6666 6060 2074 6f20 6561 6368 2070  diff`` to each p
+000099b0: 6172 7469 7469 6f6e 2061 6674 6572 0a20  artition after. 
+000099c0: 2020 2020 2020 2070 7265 7065 6e64 696e         prependin
+000099d0: 672f 6170 7065 6e64 696e 6720 7468 6174  g/appending that
+000099e0: 206d 616e 7920 726f 7773 2c20 6465 7065   many rows, depe
+000099f0: 6e64 696e 6720 6f6e 2073 6967 6e3a 0a0a  nding on sign:..
+00009a00: 2020 2020 2020 2020 3e3e 3e20 6465 6620          >>> def 
+00009a10: 6469 6666 2864 662c 2070 6572 696f 6473  diff(df, periods
+00009a20: 3d31 293a 0a20 2020 2020 2020 202e 2e2e  =1):.        ...
+00009a30: 2020 2020 2062 6566 6f72 652c 2061 6674       before, aft
+00009a40: 6572 203d 2028 7065 7269 6f64 732c 2030  er = (periods, 0
+00009a50: 2920 6966 2070 6572 696f 6473 203e 2030  ) if periods > 0
+00009a60: 2065 6c73 6520 2830 2c20 2d70 6572 696f   else (0, -perio
+00009a70: 6473 290a 2020 2020 2020 2020 2e2e 2e20  ds).        ... 
+00009a80: 2020 2020 7265 7475 726e 2064 662e 6d61      return df.ma
+00009a90: 705f 6f76 6572 6c61 7028 6c61 6d62 6461  p_overlap(lambda
+00009aa0: 2064 662c 2070 6572 696f 6473 3d31 3a20   df, periods=1: 
+00009ab0: 6466 2e64 6966 6628 7065 7269 6f64 7329  df.diff(periods)
+00009ac0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+00009ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ae0: 2020 2020 2020 2020 7065 7269 6f64 732c          periods,
+00009af0: 2030 2c20 7065 7269 6f64 733d 7065 7269   0, periods=peri
+00009b00: 6f64 7329 0a20 2020 2020 2020 203e 3e3e  ods).        >>>
+00009b10: 2064 6966 6628 6464 662c 2031 292e 636f   diff(ddf, 1).co
+00009b20: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
+00009b30: 2020 2020 2078 2020 2020 790a 2020 2020       x    y.    
+00009b40: 2020 2020 3020 204e 614e 2020 4e61 4e0a      0  NaN  NaN.
+00009b50: 2020 2020 2020 2020 3120 2031 2e30 2020          1  1.0  
+00009b60: 312e 300a 2020 2020 2020 2020 3220 2032  1.0.        2  2
+00009b70: 2e30 2020 312e 300a 2020 2020 2020 2020  .0  1.0.        
+00009b80: 3320 2033 2e30 2020 312e 300a 2020 2020  3  3.0  1.0.    
+00009b90: 2020 2020 3420 2034 2e30 2020 312e 300a      4  4.0  1.0.
+00009ba0: 0a20 2020 2020 2020 2049 6620 796f 7520  .        If you 
+00009bb0: 6861 7665 2061 2060 6044 6174 6574 696d  have a ``Datetim
+00009bc0: 6549 6e64 6578 6060 2c20 796f 7520 6361  eIndex``, you ca
+00009bd0: 6e20 7573 6520 6120 6060 7064 2e54 696d  n use a ``pd.Tim
+00009be0: 6564 656c 7461 6060 2066 6f72 2074 696d  edelta`` for tim
+00009bf0: 652d 0a20 2020 2020 2020 2062 6173 6564  e-.        based
+00009c00: 2077 696e 646f 7773 206f 7220 616e 7920   windows or any 
+00009c10: 6060 7064 2e54 696d 6564 656c 7461 6060  ``pd.Timedelta``
+00009c20: 2063 6f6e 7665 7274 6962 6c65 2073 7472   convertible str
+00009c30: 696e 673a 0a0a 2020 2020 2020 2020 3e3e  ing:..        >>
+00009c40: 3e20 7473 203d 2070 642e 5365 7269 6573  > ts = pd.Series
+00009c50: 2872 616e 6765 2831 3029 2c20 696e 6465  (range(10), inde
+00009c60: 783d 7064 2e64 6174 655f 7261 6e67 6528  x=pd.date_range(
+00009c70: 2732 3031 3727 2c20 7065 7269 6f64 733d  '2017', periods=
+00009c80: 3130 2929 0a20 2020 2020 2020 203e 3e3e  10)).        >>>
+00009c90: 2064 7473 203d 2064 642e 6672 6f6d 5f70   dts = dd.from_p
+00009ca0: 616e 6461 7328 7473 2c20 6e70 6172 7469  andas(ts, nparti
+00009cb0: 7469 6f6e 733d 3229 0a20 2020 2020 2020  tions=2).       
+00009cc0: 203e 3e3e 2064 7473 2e6d 6170 5f6f 7665   >>> dts.map_ove
+00009cd0: 726c 6170 286c 616d 6264 6120 6466 3a20  rlap(lambda df: 
+00009ce0: 6466 2e72 6f6c 6c69 6e67 2827 3244 2729  df.rolling('2D')
+00009cf0: 2e73 756d 2829 2c0a 2020 2020 2020 2020  .sum(),.        
+00009d00: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+00009d10: 2020 2020 7064 2e54 696d 6564 656c 7461      pd.Timedelta
+00009d20: 2827 3244 2729 2c20 3029 2e63 6f6d 7075  ('2D'), 0).compu
+00009d30: 7465 2829 0a20 2020 2020 2020 2032 3031  te().        201
+00009d40: 372d 3031 2d30 3120 2020 2020 302e 300a  7-01-01     0.0.
+00009d50: 2020 2020 2020 2020 3230 3137 2d30 312d          2017-01-
+00009d60: 3032 2020 2020 2031 2e30 0a20 2020 2020  02     1.0.     
+00009d70: 2020 2032 3031 372d 3031 2d30 3320 2020     2017-01-03   
+00009d80: 2020 332e 300a 2020 2020 2020 2020 3230    3.0.        20
+00009d90: 3137 2d30 312d 3034 2020 2020 2035 2e30  17-01-04     5.0
+00009da0: 0a20 2020 2020 2020 2032 3031 372d 3031  .        2017-01
+00009db0: 2d30 3520 2020 2020 372e 300a 2020 2020  -05     7.0.    
+00009dc0: 2020 2020 3230 3137 2d30 312d 3036 2020      2017-01-06  
+00009dd0: 2020 2039 2e30 0a20 2020 2020 2020 2032     9.0.        2
+00009de0: 3031 372d 3031 2d30 3720 2020 2031 312e  017-01-07    11.
+00009df0: 300a 2020 2020 2020 2020 3230 3137 2d30  0.        2017-0
+00009e00: 312d 3038 2020 2020 3133 2e30 0a20 2020  1-08    13.0.   
+00009e10: 2020 2020 2032 3031 372d 3031 2d30 3920       2017-01-09 
+00009e20: 2020 2031 352e 300a 2020 2020 2020 2020     15.0.        
+00009e30: 3230 3137 2d30 312d 3130 2020 2020 3137  2017-01-10    17
+00009e40: 2e30 0a20 2020 2020 2020 2046 7265 713a  .0.        Freq:
+00009e50: 2044 2c20 6474 7970 653a 2066 6c6f 6174   D, dtype: float
+00009e60: 3634 0a20 2020 2020 2020 2022 2222 0a20  64.        """. 
+00009e70: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00009e80: 2e64 6174 6166 7261 6d65 2e72 6f6c 6c69  .dataframe.rolli
+00009e90: 6e67 2069 6d70 6f72 7420 6d61 705f 6f76  ng import map_ov
+00009ea0: 6572 6c61 700a 0a20 2020 2020 2020 2072  erlap..        r
+00009eb0: 6574 7572 6e20 6d61 705f 6f76 6572 6c61  eturn map_overla
+00009ec0: 7028 6675 6e63 2c20 7365 6c66 2c20 6265  p(func, self, be
+00009ed0: 666f 7265 2c20 6166 7465 722c 202a 6172  fore, after, *ar
+00009ee0: 6773 2c20 2a2a 6b77 6172 6773 290a 0a20  gs, **kwargs).. 
+00009ef0: 2020 2064 6566 206d 656d 6f72 795f 7573     def memory_us
+00009f00: 6167 655f 7065 725f 7061 7274 6974 696f  age_per_partitio
+00009f10: 6e28 7365 6c66 2c20 696e 6465 783d 5472  n(self, index=Tr
+00009f20: 7565 2c20 6465 6570 3d46 616c 7365 293a  ue, deep=False):
+00009f30: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00009f40: 726e 2074 6865 206d 656d 6f72 7920 7573  rn the memory us
+00009f50: 6167 6520 6f66 2065 6163 6820 7061 7274  age of each part
+00009f60: 6974 696f 6e0a 0a20 2020 2020 2020 2050  ition..        P
+00009f70: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00009f80: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00009f90: 2020 2020 2069 6e64 6578 203a 2062 6f6f       index : boo
+00009fa0: 6c2c 2064 6566 6175 6c74 2054 7275 650a  l, default True.
+00009fb0: 2020 2020 2020 2020 2020 2020 5370 6563              Spec
+00009fc0: 6966 6965 7320 7768 6574 6865 7220 746f  ifies whether to
+00009fd0: 2069 6e63 6c75 6465 2074 6865 206d 656d   include the mem
+00009fe0: 6f72 7920 7573 6167 6520 6f66 2074 6865  ory usage of the
+00009ff0: 2069 6e64 6578 2069 6e0a 2020 2020 2020   index in.      
+0000a000: 2020 2020 2020 7265 7475 726e 6564 2053        returned S
+0000a010: 6572 6965 732e 0a20 2020 2020 2020 2064  eries..        d
+0000a020: 6565 7020 3a20 626f 6f6c 2c20 6465 6661  eep : bool, defa
+0000a030: 756c 7420 4661 6c73 650a 2020 2020 2020  ult False.      
+0000a040: 2020 2020 2020 4966 2054 7275 652c 2069        If True, i
+0000a050: 6e74 726f 7370 6563 7420 7468 6520 6461  ntrospect the da
+0000a060: 7461 2064 6565 706c 7920 6279 2069 6e74  ta deeply by int
+0000a070: 6572 726f 6761 7469 6e67 0a20 2020 2020  errogating.     
+0000a080: 2020 2020 2020 2060 606f 626a 6563 7460         ``object`
+0000a090: 6020 6474 7970 6573 2066 6f72 2073 7973  ` dtypes for sys
+0000a0a0: 7465 6d2d 6c65 7665 6c20 6d65 6d6f 7279  tem-level memory
+0000a0b0: 2063 6f6e 7375 6d70 7469 6f6e 2c20 616e   consumption, an
+0000a0c0: 6420 696e 636c 7564 650a 2020 2020 2020  d include.      
+0000a0d0: 2020 2020 2020 6974 2069 6e20 7468 6520        it in the 
+0000a0e0: 7265 7475 726e 6564 2076 616c 7565 732e  returned values.
+0000a0f0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0000a100: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0000a110: 2d0a 2020 2020 2020 2020 5365 7269 6573  -.        Series
+0000a120: 0a20 2020 2020 2020 2020 2020 2041 2053  .            A S
+0000a130: 6572 6965 7320 7768 6f73 6520 696e 6465  eries whose inde
+0000a140: 7820 6973 2074 6865 2070 6172 7469 7469  x is the partiti
+0000a150: 6f6e 206e 756d 6265 7220 616e 6420 7768  on number and wh
+0000a160: 6f73 6520 7661 6c75 6573 0a20 2020 2020  ose values.     
+0000a170: 2020 2020 2020 2061 7265 2074 6865 206d         are the m
+0000a180: 656d 6f72 7920 7573 6167 6520 6f66 2065  emory usage of e
+0000a190: 6163 6820 7061 7274 6974 696f 6e20 696e  ach partition in
+0000a1a0: 2062 7974 6573 2e0a 2020 2020 2020 2020   bytes..        
+0000a1b0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0000a1c0: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+0000a1d0: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+0000a1e0: 2020 2020 746f 7461 6c5f 6d65 6d5f 7573      total_mem_us
+0000a1f0: 6167 652c 2069 6e64 6578 3d69 6e64 6578  age, index=index
+0000a200: 2c20 6465 6570 3d64 6565 700a 2020 2020  , deep=deep.    
+0000a210: 2020 2020 292e 636c 6561 725f 6469 7669      ).clear_divi
+0000a220: 7369 6f6e 7328 290a 0a20 2020 2040 696e  sions()..    @in
+0000a230: 7365 7274 5f6d 6574 615f 7061 7261 6d5f  sert_meta_param_
+0000a240: 6465 7363 7269 7074 696f 6e28 7061 643d  description(pad=
+0000a250: 3132 290a 2020 2020 6465 6620 7265 6475  12).    def redu
+0000a260: 6374 696f 6e28 0a20 2020 2020 2020 2073  ction(.        s
+0000a270: 656c 662c 0a20 2020 2020 2020 2063 6875  elf,.        chu
+0000a280: 6e6b 2c0a 2020 2020 2020 2020 6167 6772  nk,.        aggr
+0000a290: 6567 6174 653d 4e6f 6e65 2c0a 2020 2020  egate=None,.    
+0000a2a0: 2020 2020 636f 6d62 696e 653d 4e6f 6e65      combine=None
+0000a2b0: 2c0a 2020 2020 2020 2020 6d65 7461 3d6e  ,.        meta=n
+0000a2c0: 6f5f 6465 6661 756c 742c 0a20 2020 2020  o_default,.     
+0000a2d0: 2020 2074 6f6b 656e 3d4e 6f6e 652c 0a20     token=None,. 
+0000a2e0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+0000a2f0: 7279 3d4e 6f6e 652c 0a20 2020 2020 2020  ry=None,.       
+0000a300: 2063 6875 6e6b 5f6b 7761 7267 733d 4e6f   chunk_kwargs=No
+0000a310: 6e65 2c0a 2020 2020 2020 2020 6167 6772  ne,.        aggr
+0000a320: 6567 6174 655f 6b77 6172 6773 3d4e 6f6e  egate_kwargs=Non
+0000a330: 652c 0a20 2020 2020 2020 2063 6f6d 6269  e,.        combi
+0000a340: 6e65 5f6b 7761 7267 733d 4e6f 6e65 2c0a  ne_kwargs=None,.
+0000a350: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+0000a360: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0000a370: 2022 2222 4765 6e65 7269 6320 726f 772d   """Generic row-
+0000a380: 7769 7365 2072 6564 7563 7469 6f6e 732e  wise reductions.
+0000a390: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0000a3a0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+0000a3b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000a3c0: 6368 756e 6b20 3a20 6361 6c6c 6162 6c65  chunk : callable
+0000a3d0: 0a20 2020 2020 2020 2020 2020 2046 756e  .            Fun
+0000a3e0: 6374 696f 6e20 746f 206f 7065 7261 7465  ction to operate
+0000a3f0: 206f 6e20 6561 6368 2070 6172 7469 7469   on each partiti
+0000a400: 6f6e 2e20 5368 6f75 6c64 2072 6574 7572  on. Should retur
+0000a410: 6e20 610a 2020 2020 2020 2020 2020 2020  n a.            
+0000a420: 6060 7061 6e64 6173 2e44 6174 6146 7261  ``pandas.DataFra
+0000a430: 6d65 6060 2c20 6060 7061 6e64 6173 2e53  me``, ``pandas.S
+0000a440: 6572 6965 7360 602c 206f 7220 6120 7363  eries``, or a sc
+0000a450: 616c 6172 2e0a 2020 2020 2020 2020 6167  alar..        ag
+0000a460: 6772 6567 6174 6520 3a20 6361 6c6c 6162  gregate : callab
+0000a470: 6c65 2c20 6f70 7469 6f6e 616c 0a20 2020  le, optional.   
+0000a480: 2020 2020 2020 2020 2046 756e 6374 696f           Functio
+0000a490: 6e20 746f 206f 7065 7261 7465 206f 6e20  n to operate on 
+0000a4a0: 7468 6520 636f 6e63 6174 656e 6174 6564  the concatenated
+0000a4b0: 2072 6573 756c 7420 6f66 2060 6063 6875   result of ``chu
+0000a4c0: 6e6b 6060 2e20 4966 206e 6f74 0a20 2020  nk``. If not.   
+0000a4d0: 2020 2020 2020 2020 2073 7065 6369 6669           specifi
+0000a4e0: 6564 2c20 6465 6661 756c 7473 2074 6f20  ed, defaults to 
+0000a4f0: 6060 6368 756e 6b60 602e 2055 7365 6420  ``chunk``. Used 
+0000a500: 746f 2064 6f20 7468 6520 6669 6e61 6c20  to do the final 
+0000a510: 6167 6772 6567 6174 696f 6e0a 2020 2020  aggregation.    
+0000a520: 2020 2020 2020 2020 696e 2061 2074 7265          in a tre
+0000a530: 6520 7265 6475 6374 696f 6e2e 0a0a 2020  e reduction...  
+0000a540: 2020 2020 2020 2020 2020 5468 6520 696e            The in
+0000a550: 7075 7420 746f 2060 6061 6767 7265 6761  put to ``aggrega
+0000a560: 7465 6060 2064 6570 656e 6473 206f 6e20  te`` depends on 
+0000a570: 7468 6520 6f75 7470 7574 206f 6620 6060  the output of ``
+0000a580: 6368 756e 6b60 602e 0a20 2020 2020 2020  chunk``..       
+0000a590: 2020 2020 2049 6620 7468 6520 6f75 7470       If the outp
+0000a5a0: 7574 206f 6620 6060 6368 756e 6b60 6020  ut of ``chunk`` 
+0000a5b0: 6973 2061 3a0a 0a20 2020 2020 2020 2020  is a:..         
+0000a5c0: 2020 202d 2073 6361 6c61 723a 2049 6e70     - scalar: Inp
+0000a5d0: 7574 2069 7320 6120 5365 7269 6573 2c20  ut is a Series, 
+0000a5e0: 7769 7468 206f 6e65 2072 6f77 2070 6572  with one row per
+0000a5f0: 2070 6172 7469 7469 6f6e 2e0a 2020 2020   partition..    
+0000a600: 2020 2020 2020 2020 2d20 5365 7269 6573          - Series
+0000a610: 3a20 496e 7075 7420 6973 2061 2044 6174  : Input is a Dat
+0000a620: 6146 7261 6d65 2c20 7769 7468 206f 6e65  aFrame, with one
+0000a630: 2072 6f77 2070 6572 2070 6172 7469 7469   row per partiti
+0000a640: 6f6e 2e20 436f 6c75 6d6e 730a 2020 2020  on. Columns.    
+0000a650: 2020 2020 2020 2020 2020 6172 6520 7468            are th
+0000a660: 6520 726f 7773 2069 6e20 7468 6520 6f75  e rows in the ou
+0000a670: 7470 7574 2073 6572 6965 732e 0a20 2020  tput series..   
+0000a680: 2020 2020 2020 2020 202d 2044 6174 6146           - DataF
+0000a690: 7261 6d65 3a20 496e 7075 7420 6973 2061  rame: Input is a
+0000a6a0: 2044 6174 6146 7261 6d65 2c20 7769 7468   DataFrame, with
+0000a6b0: 206f 6e65 2072 6f77 2070 6572 2070 6172   one row per par
+0000a6c0: 7469 7469 6f6e 2e0a 2020 2020 2020 2020  tition..        
+0000a6d0: 2020 2020 2020 436f 6c75 6d6e 7320 6172        Columns ar
+0000a6e0: 6520 7468 6520 636f 6c75 6d6e 7320 696e  e the columns in
+0000a6f0: 2074 6865 206f 7574 7075 7420 6461 7461   the output data
+0000a700: 6672 616d 6573 2e0a 0a20 2020 2020 2020  frames...       
+0000a710: 2020 2020 2053 686f 756c 6420 7265 7475       Should retu
+0000a720: 726e 2061 2060 6070 616e 6461 732e 4461  rn a ``pandas.Da
+0000a730: 7461 4672 616d 6560 602c 2060 6070 616e  taFrame``, ``pan
+0000a740: 6461 732e 5365 7269 6573 6060 2c20 6f72  das.Series``, or
+0000a750: 2061 0a20 2020 2020 2020 2020 2020 2073   a.            s
+0000a760: 6361 6c61 722e 0a20 2020 2020 2020 2063  calar..        c
+0000a770: 6f6d 6269 6e65 203a 2063 616c 6c61 626c  ombine : callabl
+0000a780: 652c 206f 7074 696f 6e61 6c0a 2020 2020  e, optional.    
+0000a790: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
+0000a7a0: 2074 6f20 6f70 6572 6174 6520 6f6e 2069   to operate on i
+0000a7b0: 6e74 6572 6d65 6469 6174 6520 636f 6e63  ntermediate conc
+0000a7c0: 6174 656e 6174 6564 2072 6573 756c 7473  atenated results
+0000a7d0: 206f 660a 2020 2020 2020 2020 2020 2020   of.            
+0000a7e0: 6060 6368 756e 6b60 6020 696e 2061 2074  ``chunk`` in a t
+0000a7f0: 7265 652d 7265 6475 6374 696f 6e2e 2049  ree-reduction. I
+0000a800: 6620 6e6f 7420 7072 6f76 6964 6564 2c20  f not provided, 
+0000a810: 6465 6661 756c 7473 2074 6f0a 2020 2020  defaults to.    
+0000a820: 2020 2020 2020 2020 6060 6167 6772 6567          ``aggreg
+0000a830: 6174 6560 602e 2054 6865 2069 6e70 7574  ate``. The input
+0000a840: 2f6f 7574 7075 7420 7265 7175 6972 656d  /output requirem
+0000a850: 656e 7473 2073 686f 756c 6420 6d61 7463  ents should matc
+0000a860: 6820 7468 6174 206f 660a 2020 2020 2020  h that of.      
+0000a870: 2020 2020 2020 6060 6167 6772 6567 6174        ``aggregat
+0000a880: 6560 6020 6465 7363 7269 6265 6420 6162  e`` described ab
+0000a890: 6f76 652e 0a20 2020 2020 2020 2024 4d45  ove..        $ME
+0000a8a0: 5441 0a20 2020 2020 2020 2074 6f6b 656e  TA.        token
+0000a8b0: 203a 2073 7472 2c20 6f70 7469 6f6e 616c   : str, optional
+0000a8c0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+0000a8d0: 206e 616d 6520 746f 2075 7365 2066 6f72   name to use for
+0000a8e0: 2074 6865 206f 7574 7075 7420 6b65 7973   the output keys
+0000a8f0: 2e0a 2020 2020 2020 2020 7370 6c69 745f  ..        split_
+0000a900: 6576 6572 7920 3a20 696e 742c 206f 7074  every : int, opt
+0000a910: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0000a920: 2020 4772 6f75 7020 7061 7274 6974 696f    Group partitio
+0000a930: 6e73 2069 6e74 6f20 6772 6f75 7073 206f  ns into groups o
+0000a940: 6620 7468 6973 2073 697a 6520 7768 696c  f this size whil
+0000a950: 6520 7065 7266 6f72 6d69 6e67 2061 0a20  e performing a. 
+0000a960: 2020 2020 2020 2020 2020 2074 7265 652d             tree-
+0000a970: 7265 6475 6374 696f 6e2e 2049 6620 7365  reduction. If se
+0000a980: 7420 746f 2046 616c 7365 2c20 6e6f 2074  t to False, no t
+0000a990: 7265 652d 7265 6475 6374 696f 6e20 7769  ree-reduction wi
+0000a9a0: 6c6c 2062 6520 7573 6564 2c0a 2020 2020  ll be used,.    
+0000a9b0: 2020 2020 2020 2020 616e 6420 616c 6c20          and all 
+0000a9c0: 696e 7465 726d 6564 6961 7465 7320 7769  intermediates wi
+0000a9d0: 6c6c 2062 6520 636f 6e63 6174 656e 6174  ll be concatenat
+0000a9e0: 6564 2061 6e64 2070 6173 7365 6420 746f  ed and passed to
+0000a9f0: 0a20 2020 2020 2020 2020 2020 2060 6061  .            ``a
+0000aa00: 6767 7265 6761 7465 6060 2e20 4465 6661  ggregate``. Defa
+0000aa10: 756c 7420 6973 2038 2e0a 2020 2020 2020  ult is 8..      
+0000aa20: 2020 6368 756e 6b5f 6b77 6172 6773 203a    chunk_kwargs :
+0000aa30: 2064 6963 742c 206f 7074 696f 6e61 6c0a   dict, optional.
+0000aa40: 2020 2020 2020 2020 2020 2020 4b65 7977              Keyw
+0000aa50: 6f72 6420 6172 6775 6d65 6e74 7320 746f  ord arguments to
+0000aa60: 2070 6173 7320 6f6e 2074 6f20 6060 6368   pass on to ``ch
+0000aa70: 756e 6b60 6020 6f6e 6c79 2e0a 2020 2020  unk`` only..    
+0000aa80: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
+0000aa90: 6172 6773 203a 2064 6963 742c 206f 7074  args : dict, opt
+0000aaa0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0000aab0: 2020 4b65 7977 6f72 6420 6172 6775 6d65    Keyword argume
+0000aac0: 6e74 7320 746f 2070 6173 7320 6f6e 2074  nts to pass on t
+0000aad0: 6f20 6060 6167 6772 6567 6174 6560 6020  o ``aggregate`` 
+0000aae0: 6f6e 6c79 2e0a 2020 2020 2020 2020 636f  only..        co
+0000aaf0: 6d62 696e 655f 6b77 6172 6773 203a 2064  mbine_kwargs : d
+0000ab00: 6963 742c 206f 7074 696f 6e61 6c0a 2020  ict, optional.  
+0000ab10: 2020 2020 2020 2020 2020 4b65 7977 6f72            Keywor
+0000ab20: 6420 6172 6775 6d65 6e74 7320 746f 2070  d arguments to p
+0000ab30: 6173 7320 6f6e 2074 6f20 6060 636f 6d62  ass on to ``comb
+0000ab40: 696e 6560 6020 6f6e 6c79 2e0a 2020 2020  ine`` only..    
+0000ab50: 2020 2020 6b77 6172 6773 203a 0a20 2020      kwargs :.   
+0000ab60: 2020 2020 2020 2020 2041 6c6c 2072 656d           All rem
+0000ab70: 6169 6e69 6e67 206b 6579 776f 7264 7320  aining keywords 
+0000ab80: 7769 6c6c 2062 6520 7061 7373 6564 2074  will be passed t
+0000ab90: 6f20 6060 6368 756e 6b60 602c 2060 6063  o ``chunk``, ``c
+0000aba0: 6f6d 6269 6e65 6060 2c0a 2020 2020 2020  ombine``,.      
+0000abb0: 2020 2020 2020 616e 6420 6060 6167 6772        and ``aggr
+0000abc0: 6567 6174 6560 602e 0a0a 2020 2020 2020  egate``...      
+0000abd0: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
+0000abe0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+0000abf0: 2020 2020 3e3e 3e20 696d 706f 7274 2070      >>> import p
+0000ac00: 616e 6461 7320 6173 2070 640a 2020 2020  andas as pd.    
+0000ac10: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
+0000ac20: 6173 6b2e 6461 7461 6672 616d 6520 6173  ask.dataframe as
+0000ac30: 2064 640a 2020 2020 2020 2020 3e3e 3e20   dd.        >>> 
+0000ac40: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
+0000ac50: 6528 7b27 7827 3a20 7261 6e67 6528 3530  e({'x': range(50
+0000ac60: 292c 2027 7927 3a20 7261 6e67 6528 3530  ), 'y': range(50
+0000ac70: 2c20 3130 3029 7d29 0a20 2020 2020 2020  , 100)}).       
+0000ac80: 203e 3e3e 2064 6466 203d 2064 642e 6672   >>> ddf = dd.fr
+0000ac90: 6f6d 5f70 616e 6461 7328 6466 2c20 6e70  om_pandas(df, np
+0000aca0: 6172 7469 7469 6f6e 733d 3429 0a0a 2020  artitions=4)..  
+0000acb0: 2020 2020 2020 436f 756e 7420 7468 6520        Count the 
+0000acc0: 6e75 6d62 6572 206f 6620 726f 7773 2069  number of rows i
+0000acd0: 6e20 6120 4461 7461 4672 616d 652e 2054  n a DataFrame. T
+0000ace0: 6f20 646f 2074 6869 732c 2063 6f75 6e74  o do this, count
+0000acf0: 2074 6865 206e 756d 6265 720a 2020 2020   the number.    
+0000ad00: 2020 2020 6f66 2072 6f77 7320 696e 2065      of rows in e
+0000ad10: 6163 6820 7061 7274 6974 696f 6e2c 2074  ach partition, t
+0000ad20: 6865 6e20 7375 6d20 7468 6520 7265 7375  hen sum the resu
+0000ad30: 6c74 733a 0a0a 2020 2020 2020 2020 3e3e  lts:..        >>
+0000ad40: 3e20 7265 7320 3d20 6464 662e 7265 6475  > res = ddf.redu
+0000ad50: 6374 696f 6e28 6c61 6d62 6461 2078 3a20  ction(lambda x: 
+0000ad60: 782e 636f 756e 7428 292c 0a20 2020 2020  x.count(),.     
+0000ad70: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+0000ad80: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
+0000ad90: 6761 7465 3d6c 616d 6264 6120 783a 2078  gate=lambda x: x
+0000ada0: 2e73 756d 2829 290a 2020 2020 2020 2020  .sum()).        
+0000adb0: 3e3e 3e20 7265 732e 636f 6d70 7574 6528  >>> res.compute(
+0000adc0: 290a 2020 2020 2020 2020 7820 2020 2035  ).        x    5
+0000add0: 300a 2020 2020 2020 2020 7920 2020 2035  0.        y    5
+0000ade0: 300a 2020 2020 2020 2020 6474 7970 653a  0.        dtype:
+0000adf0: 2069 6e74 3634 0a0a 2020 2020 2020 2020   int64..        
+0000ae00: 436f 756e 7420 7468 6520 6e75 6d62 6572  Count the number
+0000ae10: 206f 6620 726f 7773 2069 6e20 6120 5365   of rows in a Se
+0000ae20: 7269 6573 2077 6974 6820 656c 656d 656e  ries with elemen
+0000ae30: 7473 2067 7265 6174 6572 2074 6861 6e20  ts greater than 
+0000ae40: 6f72 0a20 2020 2020 2020 2065 7175 616c  or.        equal
+0000ae50: 2074 6f20 6120 7661 6c75 6520 2870 726f   to a value (pro
+0000ae60: 7669 6465 6420 7669 6120 6120 6b65 7977  vided via a keyw
+0000ae70: 6f72 6429 2e0a 0a20 2020 2020 2020 203e  ord)...        >
+0000ae80: 3e3e 2064 6566 2063 6f75 6e74 5f67 7265  >> def count_gre
+0000ae90: 6174 6572 2878 2c20 7661 6c75 653d 3029  ater(x, value=0)
+0000aea0: 3a0a 2020 2020 2020 2020 2e2e 2e20 2020  :.        ...   
+0000aeb0: 2020 7265 7475 726e 2028 7820 3e3d 2076    return (x >= v
+0000aec0: 616c 7565 292e 7375 6d28 290a 2020 2020  alue).sum().    
+0000aed0: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
+0000aee0: 662e 782e 7265 6475 6374 696f 6e28 636f  f.x.reduction(co
+0000aef0: 756e 745f 6772 6561 7465 722c 2061 6767  unt_greater, agg
+0000af00: 7265 6761 7465 3d6c 616d 6264 6120 783a  regate=lambda x:
+0000af10: 2078 2e73 756d 2829 2c0a 2020 2020 2020   x.sum(),.      
+0000af20: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+0000af30: 2020 2020 2020 2020 2020 2020 6368 756e              chun
+0000af40: 6b5f 6b77 6172 6773 3d7b 2776 616c 7565  k_kwargs={'value
+0000af50: 273a 2032 357d 290a 2020 2020 2020 2020  ': 25}).        
+0000af60: 3e3e 3e20 7265 732e 636f 6d70 7574 6528  >>> res.compute(
+0000af70: 290a 2020 2020 2020 2020 3235 0a0a 2020  ).        25..  
+0000af80: 2020 2020 2020 4167 6772 6567 6174 6520        Aggregate 
+0000af90: 626f 7468 2074 6865 2073 756d 2061 6e64  both the sum and
+0000afa0: 2063 6f75 6e74 206f 6620 6120 5365 7269   count of a Seri
+0000afb0: 6573 2061 7420 7468 6520 7361 6d65 2074  es at the same t
+0000afc0: 696d 653a 0a0a 2020 2020 2020 2020 3e3e  ime:..        >>
+0000afd0: 3e20 6465 6620 7375 6d5f 616e 645f 636f  > def sum_and_co
+0000afe0: 756e 7428 7829 3a0a 2020 2020 2020 2020  unt(x):.        
+0000aff0: 2e2e 2e20 2020 2020 7265 7475 726e 2070  ...     return p
+0000b000: 642e 5365 7269 6573 287b 2763 6f75 6e74  d.Series({'count
+0000b010: 273a 2078 2e63 6f75 6e74 2829 2c20 2773  ': x.count(), 's
+0000b020: 756d 273a 2078 2e73 756d 2829 7d2c 0a20  um': x.sum()},. 
+0000b030: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0000b040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b050: 696e 6465 783d 5b27 636f 756e 7427 2c20  index=['count', 
+0000b060: 2773 756d 275d 290a 2020 2020 2020 2020  'sum']).        
+0000b070: 3e3e 3e20 7265 7320 3d20 6464 662e 782e  >>> res = ddf.x.
+0000b080: 7265 6475 6374 696f 6e28 7375 6d5f 616e  reduction(sum_an
+0000b090: 645f 636f 756e 742c 2061 6767 7265 6761  d_count, aggrega
+0000b0a0: 7465 3d6c 616d 6264 6120 783a 2078 2e73  te=lambda x: x.s
+0000b0b0: 756d 2829 290a 2020 2020 2020 2020 3e3e  um()).        >>
+0000b0c0: 3e20 7265 732e 636f 6d70 7574 6528 290a  > res.compute().
+0000b0d0: 2020 2020 2020 2020 636f 756e 7420 2020          count   
+0000b0e0: 2020 2035 300a 2020 2020 2020 2020 7375     50.        su
+0000b0f0: 6d20 2020 2020 2031 3232 350a 2020 2020  m      1225.    
+0000b100: 2020 2020 6474 7970 653a 2069 6e74 3634      dtype: int64
+0000b110: 0a0a 2020 2020 2020 2020 446f 696e 6720  ..        Doing 
+0000b120: 7468 6520 7361 6d65 2c20 6275 7420 666f  the same, but fo
+0000b130: 7220 6120 4461 7461 4672 616d 652e 2048  r a DataFrame. H
+0000b140: 6572 6520 6060 6368 756e 6b60 6020 7265  ere ``chunk`` re
+0000b150: 7475 726e 7320 610a 2020 2020 2020 2020  turns a.        
+0000b160: 4461 7461 4672 616d 652c 206d 6561 6e69  DataFrame, meani
+0000b170: 6e67 2074 6865 2069 6e70 7574 2074 6f20  ng the input to 
+0000b180: 6060 6167 6772 6567 6174 6560 6020 6973  ``aggregate`` is
+0000b190: 2061 2044 6174 6146 7261 6d65 2077 6974   a DataFrame wit
+0000b1a0: 6820 616e 0a20 2020 2020 2020 2069 6e64  h an.        ind
+0000b1b0: 6578 2077 6974 6820 6e6f 6e2d 756e 6971  ex with non-uniq
+0000b1c0: 7565 2065 6e74 7269 6573 2066 6f72 2062  ue entries for b
+0000b1d0: 6f74 6820 2778 2720 616e 6420 2779 272e  oth 'x' and 'y'.
+0000b1e0: 2057 6520 6772 6f75 7062 7920 7468 650a   We groupby the.
+0000b1f0: 2020 2020 2020 2020 696e 6465 782c 2061          index, a
+0000b200: 6e64 2073 756d 2065 6163 6820 6772 6f75  nd sum each grou
+0000b210: 7020 746f 2067 6574 2074 6865 2066 696e  p to get the fin
+0000b220: 616c 2072 6573 756c 742e 0a0a 2020 2020  al result...    
+0000b230: 2020 2020 3e3e 3e20 6465 6620 7375 6d5f      >>> def sum_
+0000b240: 616e 645f 636f 756e 7428 7829 3a0a 2020  and_count(x):.  
+0000b250: 2020 2020 2020 2e2e 2e20 2020 2020 7265        ...     re
+0000b260: 7475 726e 2070 642e 4461 7461 4672 616d  turn pd.DataFram
+0000b270: 6528 7b27 636f 756e 7427 3a20 782e 636f  e({'count': x.co
+0000b280: 756e 7428 292c 2027 7375 6d27 3a20 782e  unt(), 'sum': x.
+0000b290: 7375 6d28 297d 2c0a 2020 2020 2020 2020  sum()},.        
+0000b2a0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+0000b2b0: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+0000b2c0: 6d6e 733d 5b27 636f 756e 7427 2c20 2773  mns=['count', 's
+0000b2d0: 756d 275d 290a 2020 2020 2020 2020 3e3e  um']).        >>
+0000b2e0: 3e20 7265 7320 3d20 6464 662e 7265 6475  > res = ddf.redu
+0000b2f0: 6374 696f 6e28 7375 6d5f 616e 645f 636f  ction(sum_and_co
+0000b300: 756e 742c 0a20 2020 2020 2020 202e 2e2e  unt,.        ...
+0000b310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b320: 2020 2020 2061 6767 7265 6761 7465 3d6c       aggregate=l
+0000b330: 616d 6264 6120 783a 2078 2e67 726f 7570  ambda x: x.group
+0000b340: 6279 286c 6576 656c 3d30 292e 7375 6d28  by(level=0).sum(
+0000b350: 2929 0a20 2020 2020 2020 203e 3e3e 2072  )).        >>> r
+0000b360: 6573 2e63 6f6d 7075 7465 2829 0a20 2020  es.compute().   
+0000b370: 2020 2020 2020 2020 636f 756e 7420 2020          count   
+0000b380: 7375 6d0a 2020 2020 2020 2020 7820 2020  sum.        x   
+0000b390: 2020 3530 2020 3132 3235 0a20 2020 2020    50  1225.     
+0000b3a0: 2020 2079 2020 2020 2035 3020 2033 3732     y     50  372
+0000b3b0: 350a 2020 2020 2020 2020 2222 220a 2020  5.        """.  
+0000b3c0: 2020 2020 2020 6966 2061 6767 7265 6761        if aggrega
+0000b3d0: 7465 2069 7320 4e6f 6e65 3a0a 2020 2020  te is None:.    
+0000b3e0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+0000b3f0: 6520 3d20 6368 756e 6b0a 0a20 2020 2020  e = chunk..     
+0000b400: 2020 2069 6620 636f 6d62 696e 6520 6973     if combine is
+0000b410: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0000b420: 2020 2069 6620 636f 6d62 696e 655f 6b77     if combine_kw
+0000b430: 6172 6773 3a0a 2020 2020 2020 2020 2020  args:.          
+0000b440: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000b450: 6545 7272 6f72 2822 6063 6f6d 6269 6e65  eError("`combine
+0000b460: 5f6b 7761 7267 7360 2070 726f 7669 6465  _kwargs` provide
+0000b470: 6420 7769 7468 206e 6f20 6063 6f6d 6269  d with no `combi
+0000b480: 6e65 6022 290a 2020 2020 2020 2020 2020  ne`").          
+0000b490: 2020 636f 6d62 696e 6520 3d20 6167 6772    combine = aggr
+0000b4a0: 6567 6174 650a 2020 2020 2020 2020 2020  egate.          
+0000b4b0: 2020 636f 6d62 696e 655f 6b77 6172 6773    combine_kwargs
+0000b4c0: 203d 2061 6767 7265 6761 7465 5f6b 7761   = aggregate_kwa
+0000b4d0: 7267 730a 0a20 2020 2020 2020 2063 6875  rgs..        chu
+0000b4e0: 6e6b 5f6b 7761 7267 7320 3d20 6368 756e  nk_kwargs = chun
+0000b4f0: 6b5f 6b77 6172 6773 2e63 6f70 7928 2920  k_kwargs.copy() 
+0000b500: 6966 2063 6875 6e6b 5f6b 7761 7267 7320  if chunk_kwargs 
+0000b510: 656c 7365 207b 7d0a 2020 2020 2020 2020  else {}.        
+0000b520: 6368 756e 6b5f 6b77 6172 6773 5b22 6163  chunk_kwargs["ac
+0000b530: 615f 6368 756e 6b22 5d20 3d20 6368 756e  a_chunk"] = chun
+0000b540: 6b0a 0a20 2020 2020 2020 2063 6f6d 6269  k..        combi
+0000b550: 6e65 5f6b 7761 7267 7320 3d20 636f 6d62  ne_kwargs = comb
+0000b560: 696e 655f 6b77 6172 6773 2e63 6f70 7928  ine_kwargs.copy(
+0000b570: 2920 6966 2063 6f6d 6269 6e65 5f6b 7761  ) if combine_kwa
+0000b580: 7267 7320 656c 7365 207b 7d0a 2020 2020  rgs else {}.    
+0000b590: 2020 2020 636f 6d62 696e 655f 6b77 6172      combine_kwar
+0000b5a0: 6773 5b22 6163 615f 636f 6d62 696e 6522  gs["aca_combine"
+0000b5b0: 5d20 3d20 636f 6d62 696e 650a 0a20 2020  ] = combine..   
+0000b5c0: 2020 2020 2061 6767 7265 6761 7465 5f6b       aggregate_k
+0000b5d0: 7761 7267 7320 3d20 6167 6772 6567 6174  wargs = aggregat
+0000b5e0: 655f 6b77 6172 6773 2e63 6f70 7928 2920  e_kwargs.copy() 
+0000b5f0: 6966 2061 6767 7265 6761 7465 5f6b 7761  if aggregate_kwa
+0000b600: 7267 7320 656c 7365 207b 7d0a 2020 2020  rgs else {}.    
+0000b610: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
+0000b620: 6172 6773 5b22 6163 615f 6167 6772 6567  args["aca_aggreg
+0000b630: 6174 6522 5d20 3d20 6167 6772 6567 6174  ate"] = aggregat
+0000b640: 650a 0a20 2020 2020 2020 2072 6574 7572  e..        retur
+0000b650: 6e20 6163 6128 0a20 2020 2020 2020 2020  n aca(.         
+0000b660: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000b670: 2020 2020 2063 6875 6e6b 3d5f 7265 6475       chunk=_redu
+0000b680: 6374 696f 6e5f 6368 756e 6b2c 0a20 2020  ction_chunk,.   
+0000b690: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
+0000b6a0: 7465 3d5f 7265 6475 6374 696f 6e5f 6167  te=_reduction_ag
+0000b6b0: 6772 6567 6174 652c 0a20 2020 2020 2020  gregate,.       
+0000b6c0: 2020 2020 2063 6f6d 6269 6e65 3d5f 7265       combine=_re
+0000b6d0: 6475 6374 696f 6e5f 636f 6d62 696e 652c  duction_combine,
+0000b6e0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+0000b6f0: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
+0000b700: 2020 2020 746f 6b65 6e3d 746f 6b65 6e2c      token=token,
+0000b710: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+0000b720: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+0000b730: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
+0000b740: 2020 6368 756e 6b5f 6b77 6172 6773 3d63    chunk_kwargs=c
+0000b750: 6875 6e6b 5f6b 7761 7267 732c 0a20 2020  hunk_kwargs,.   
+0000b760: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
+0000b770: 7465 5f6b 7761 7267 733d 6167 6772 6567  te_kwargs=aggreg
+0000b780: 6174 655f 6b77 6172 6773 2c0a 2020 2020  ate_kwargs,.    
+0000b790: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
+0000b7a0: 6b77 6172 6773 3d63 6f6d 6269 6e65 5f6b  kwargs=combine_k
+0000b7b0: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
+0000b7c0: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
+0000b7d0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+0000b7e0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+0000b7f0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+0000b800: 7069 7065 2873 656c 662c 2066 756e 632c  pipe(self, func,
+0000b810: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+0000b820: 293a 0a20 2020 2020 2020 2023 2054 616b  ):.        # Tak
+0000b830: 656e 2066 726f 6d20 7061 6e64 6173 3a0a  en from pandas:.
+0000b840: 2020 2020 2020 2020 2320 6874 7470 733a          # https:
+0000b850: 2f2f 6769 7468 7562 2e63 6f6d 2f70 7964  //github.com/pyd
+0000b860: 6174 612f 7061 6e64 6173 2f62 6c6f 622f  ata/pandas/blob/
+0000b870: 6d61 7374 6572 2f70 616e 6461 732f 636f  master/pandas/co
+0000b880: 7265 2f67 656e 6572 6963 2e70 7923 4c32  re/generic.py#L2
+0000b890: 3639 382d 4c32 3730 370a 2020 2020 2020  698-L2707.      
+0000b8a0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0000b8b0: 6675 6e63 2c20 7475 706c 6529 3a0a 2020  func, tuple):.  
+0000b8c0: 2020 2020 2020 2020 2020 6675 6e63 2c20            func, 
+0000b8d0: 7461 7267 6574 203d 2066 756e 630a 2020  target = func.  
+0000b8e0: 2020 2020 2020 2020 2020 6966 2074 6172            if tar
+0000b8f0: 6765 7420 696e 206b 7761 7267 733a 0a20  get in kwargs:. 
+0000b900: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000b910: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0000b920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b930: 2020 2020 2022 2573 2069 7320 626f 7468       "%s is both
+0000b940: 2074 6865 2070 6970 6520 7461 7267 6574   the pipe target
+0000b950: 2061 6e64 2061 206b 6579 776f 7264 2061   and a keyword a
+0000b960: 7267 756d 656e 7422 2025 2074 6172 6765  rgument" % targe
+0000b970: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+0000b980: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000b990: 6b77 6172 6773 5b74 6172 6765 745d 203d  kwargs[target] =
+0000b9a0: 2073 656c 660a 2020 2020 2020 2020 2020   self.          
+0000b9b0: 2020 7265 7475 726e 2066 756e 6328 2a61    return func(*a
+0000b9c0: 7267 732c 202a 2a6b 7761 7267 7329 0a20  rgs, **kwargs). 
+0000b9d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000b9e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000b9f0: 6675 6e63 2873 656c 662c 202a 6172 6773  func(self, *args
+0000ba00: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
+0000ba10: 2064 6566 2072 616e 646f 6d5f 7370 6c69   def random_spli
+0000ba20: 7428 7365 6c66 2c20 6672 6163 2c20 7261  t(self, frac, ra
+0000ba30: 6e64 6f6d 5f73 7461 7465 3d4e 6f6e 652c  ndom_state=None,
+0000ba40: 2073 6875 6666 6c65 3d46 616c 7365 293a   shuffle=False):
+0000ba50: 0a20 2020 2020 2020 2022 2222 5073 6575  .        """Pseu
+0000ba60: 646f 7261 6e64 6f6d 6c79 2073 706c 6974  dorandomly split
+0000ba70: 2064 6174 6166 7261 6d65 2069 6e74 6f20   dataframe into 
+0000ba80: 6469 6666 6572 656e 7420 7069 6563 6573  different pieces
+0000ba90: 2072 6f77 2d77 6973 650a 0a20 2020 2020   row-wise..     
+0000baa0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0000bab0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000bac0: 0a20 2020 2020 2020 2066 7261 6320 3a20  .        frac : 
+0000bad0: 6c69 7374 0a20 2020 2020 2020 2020 2020  list.           
+0000bae0: 204c 6973 7420 6f66 2066 6c6f 6174 7320   List of floats 
+0000baf0: 7468 6174 2073 686f 756c 6420 7375 6d20  that should sum 
+0000bb00: 746f 206f 6e65 2e0a 2020 2020 2020 2020  to one..        
+0000bb10: 7261 6e64 6f6d 5f73 7461 7465 203a 2069  random_state : i
+0000bb20: 6e74 206f 7220 6e70 2e72 616e 646f 6d2e  nt or np.random.
+0000bb30: 5261 6e64 6f6d 5374 6174 650a 2020 2020  RandomState.    
+0000bb40: 2020 2020 2020 2020 4966 2069 6e74 2063          If int c
+0000bb50: 7265 6174 6520 6120 6e65 7720 5261 6e64  reate a new Rand
+0000bb60: 6f6d 5374 6174 6520 7769 7468 2074 6869  omState with thi
+0000bb70: 7320 6173 2074 6865 2073 6565 642e 0a20  s as the seed.. 
+0000bb80: 2020 2020 2020 2020 2020 204f 7468 6572             Other
+0000bb90: 7769 7365 2064 7261 7720 6672 6f6d 2074  wise draw from t
+0000bba0: 6865 2070 6173 7365 6420 5261 6e64 6f6d  he passed Random
+0000bbb0: 5374 6174 652e 0a20 2020 2020 2020 2073  State..        s
+0000bbc0: 6875 6666 6c65 203a 2062 6f6f 6c2c 2064  huffle : bool, d
+0000bbd0: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+0000bbe0: 2020 2020 2020 2020 2049 6620 7365 7420           If set 
+0000bbf0: 746f 2054 7275 652c 2074 6865 2064 6174  to True, the dat
+0000bc00: 6166 7261 6d65 2069 7320 7368 7566 666c  aframe is shuffl
+0000bc10: 6564 2028 7769 7468 696e 2070 6172 7469  ed (within parti
+0000bc20: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
+0000bc30: 2020 6265 666f 7265 2074 6865 2073 706c    before the spl
+0000bc40: 6974 2e0a 0a20 2020 2020 2020 2045 7861  it...        Exa
+0000bc50: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+0000bc60: 2d2d 2d2d 2d2d 0a0a 2020 2020 2020 2020  ------..        
+0000bc70: 3530 2f35 3020 7370 6c69 740a 0a20 2020  50/50 split..   
+0000bc80: 2020 2020 203e 3e3e 2061 2c20 6220 3d20       >>> a, b = 
+0000bc90: 6466 2e72 616e 646f 6d5f 7370 6c69 7428  df.random_split(
+0000bca0: 5b30 2e35 2c20 302e 355d 2920 2023 2064  [0.5, 0.5])  # d
+0000bcb0: 6f63 7465 7374 3a20 2b53 4b49 500a 0a20  octest: +SKIP.. 
+0000bcc0: 2020 2020 2020 2038 302f 3130 2f31 3020         80/10/10 
+0000bcd0: 7370 6c69 742c 2063 6f6e 7369 7374 656e  split, consisten
+0000bce0: 7420 7261 6e64 6f6d 5f73 7461 7465 0a0a  t random_state..
+0000bcf0: 2020 2020 2020 2020 3e3e 3e20 612c 2062          >>> a, b
+0000bd00: 2c20 6320 3d20 6466 2e72 616e 646f 6d5f  , c = df.random_
+0000bd10: 7370 6c69 7428 5b30 2e38 2c20 302e 312c  split([0.8, 0.1,
+0000bd20: 2030 2e31 5d2c 2072 616e 646f 6d5f 7374   0.1], random_st
+0000bd30: 6174 653d 3132 3329 2020 2320 646f 6374  ate=123)  # doct
+0000bd40: 6573 743a 202b 534b 4950 0a0a 2020 2020  est: +SKIP..    
+0000bd50: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+0000bd60: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+0000bd70: 2020 2020 2020 6461 736b 2e44 6174 6146        dask.DataF
+0000bd80: 7261 6d65 2e73 616d 706c 650a 2020 2020  rame.sample.    
+0000bd90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000bda0: 6966 206e 6f74 206e 702e 616c 6c63 6c6f  if not np.allclo
+0000bdb0: 7365 2873 756d 2866 7261 6329 2c20 3129  se(sum(frac), 1)
+0000bdc0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000bdd0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+0000bde0: 6672 6163 2073 686f 756c 6420 7375 6d20  frac should sum 
+0000bdf0: 746f 2031 2229 0a20 2020 2020 2020 2073  to 1").        s
+0000be00: 7461 7465 5f64 6174 6120 3d20 7261 6e64  tate_data = rand
+0000be10: 6f6d 5f73 7461 7465 5f64 6174 6128 7365  om_state_data(se
+0000be20: 6c66 2e6e 7061 7274 6974 696f 6e73 2c20  lf.npartitions, 
+0000be30: 7261 6e64 6f6d 5f73 7461 7465 290a 2020  random_state).  
+0000be40: 2020 2020 2020 746f 6b65 6e20 3d20 746f        token = to
+0000be50: 6b65 6e69 7a65 2873 656c 662c 2066 7261  kenize(self, fra
+0000be60: 632c 2072 616e 646f 6d5f 7374 6174 6529  c, random_state)
+0000be70: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
+0000be80: 2273 706c 6974 2d22 202b 2074 6f6b 656e  "split-" + token
+0000be90: 0a20 2020 2020 2020 206c 6179 6572 203d  .        layer =
+0000bea0: 207b 0a20 2020 2020 2020 2020 2020 2028   {.            (
+0000beb0: 6e61 6d65 2c20 6929 3a20 2870 645f 7370  name, i): (pd_sp
+0000bec0: 6c69 742c 2028 7365 6c66 2e5f 6e61 6d65  lit, (self._name
+0000bed0: 2c20 6929 2c20 6672 6163 2c20 7374 6174  , i), frac, stat
+0000bee0: 652c 2073 6875 6666 6c65 290a 2020 2020  e, shuffle).    
+0000bef0: 2020 2020 2020 2020 666f 7220 692c 2073          for i, s
+0000bf00: 7461 7465 2069 6e20 656e 756d 6572 6174  tate in enumerat
+0000bf10: 6528 7374 6174 655f 6461 7461 290a 2020  e(state_data).  
+0000bf20: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
+0000bf30: 206f 7574 203d 205b 5d0a 2020 2020 2020   out = [].      
+0000bf40: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+0000bf50: 286c 656e 2866 7261 6329 293a 0a20 2020  (len(frac)):.   
+0000bf60: 2020 2020 2020 2020 206e 616d 6532 203d           name2 =
+0000bf70: 2022 7370 6c69 742d 2564 2d25 7322 2025   "split-%d-%s" %
+0000bf80: 2028 692c 2074 6f6b 656e 290a 2020 2020   (i, token).    
+0000bf90: 2020 2020 2020 2020 6473 6b32 203d 207b          dsk2 = {
+0000bfa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000bfb0: 2028 6e61 6d65 322c 206a 293a 2028 6765   (name2, j): (ge
+0000bfc0: 7469 7465 6d2c 2028 6e61 6d65 2c20 6a29  titem, (name, j)
+0000bfd0: 2c20 6929 2066 6f72 206a 2069 6e20 7261  , i) for j in ra
+0000bfe0: 6e67 6528 7365 6c66 2e6e 7061 7274 6974  nge(self.npartit
+0000bff0: 696f 6e73 290a 2020 2020 2020 2020 2020  ions).          
+0000c000: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+0000c010: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
+0000c020: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
+0000c030: 6563 7469 6f6e 7328 0a20 2020 2020 2020  ections(.       
+0000c040: 2020 2020 2020 2020 206e 616d 6532 2c20           name2, 
+0000c050: 6d65 7267 6528 6473 6b32 2c20 6c61 7965  merge(dsk2, laye
+0000c060: 7229 2c20 6465 7065 6e64 656e 6369 6573  r), dependencies
+0000c070: 3d5b 7365 6c66 5d0a 2020 2020 2020 2020  =[self].        
+0000c080: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000c090: 2020 6f75 745f 6466 203d 2074 7970 6528    out_df = type(
+0000c0a0: 7365 6c66 2928 6772 6170 682c 206e 616d  self)(graph, nam
+0000c0b0: 6532 2c20 7365 6c66 2e5f 6d65 7461 2c20  e2, self._meta, 
+0000c0c0: 7365 6c66 2e64 6976 6973 696f 6e73 290a  self.divisions).
+0000c0d0: 2020 2020 2020 2020 2020 2020 6f75 742e              out.
+0000c0e0: 6170 7065 6e64 286f 7574 5f64 6629 0a20  append(out_df). 
+0000c0f0: 2020 2020 2020 2072 6574 7572 6e20 6f75         return ou
+0000c100: 740a 0a20 2020 2064 6566 2068 6561 6428  t..    def head(
+0000c110: 7365 6c66 2c20 6e3d 352c 206e 7061 7274  self, n=5, npart
+0000c120: 6974 696f 6e73 3d31 2c20 636f 6d70 7574  itions=1, comput
+0000c130: 653d 5472 7565 293a 0a20 2020 2020 2020  e=True):.       
+0000c140: 2022 2222 4669 7273 7420 6e20 726f 7773   """First n rows
+0000c150: 206f 6620 7468 6520 6461 7461 7365 740a   of the dataset.
+0000c160: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0000c170: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0000c180: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
+0000c190: 203a 2069 6e74 2c20 6f70 7469 6f6e 616c   : int, optional
+0000c1a0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+0000c1b0: 206e 756d 6265 7220 6f66 2072 6f77 7320   number of rows 
+0000c1c0: 746f 2072 6574 7572 6e2e 2044 6566 6175  to return. Defau
+0000c1d0: 6c74 2069 7320 352e 0a20 2020 2020 2020  lt is 5..       
+0000c1e0: 206e 7061 7274 6974 696f 6e73 203a 2069   npartitions : i
+0000c1f0: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
+0000c200: 2020 2020 2020 2020 2045 6c65 6d65 6e74           Element
+0000c210: 7320 6172 6520 6f6e 6c79 2074 616b 656e  s are only taken
+0000c220: 2066 726f 6d20 7468 6520 6669 7273 7420   from the first 
+0000c230: 6060 6e70 6172 7469 7469 6f6e 7360 602c  ``npartitions``,
+0000c240: 2077 6974 6820 610a 2020 2020 2020 2020   with a.        
+0000c250: 2020 2020 6465 6661 756c 7420 6f66 2031      default of 1
+0000c260: 2e20 4966 2074 6865 7265 2061 7265 2066  . If there are f
+0000c270: 6577 6572 2074 6861 6e20 6060 6e60 6020  ewer than ``n`` 
+0000c280: 726f 7773 2069 6e20 7468 6520 6669 7273  rows in the firs
+0000c290: 740a 2020 2020 2020 2020 2020 2020 6060  t.            ``
+0000c2a0: 6e70 6172 7469 7469 6f6e 7360 6020 6120  npartitions`` a 
+0000c2b0: 7761 726e 696e 6720 7769 6c6c 2062 6520  warning will be 
+0000c2c0: 7261 6973 6564 2061 6e64 2061 6e79 2066  raised and any f
+0000c2d0: 6f75 6e64 2072 6f77 730a 2020 2020 2020  ound rows.      
+0000c2e0: 2020 2020 2020 7265 7475 726e 6564 2e20        returned. 
+0000c2f0: 5061 7373 202d 3120 746f 2075 7365 2061  Pass -1 to use a
+0000c300: 6c6c 2070 6172 7469 7469 6f6e 732e 0a20  ll partitions.. 
+0000c310: 2020 2020 2020 2063 6f6d 7075 7465 203a         compute :
+0000c320: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0a   bool, optional.
+0000c330: 2020 2020 2020 2020 2020 2020 5768 6574              Whet
+0000c340: 6865 7220 746f 2063 6f6d 7075 7465 2074  her to compute t
+0000c350: 6865 2072 6573 756c 742c 2064 6566 6175  he result, defau
+0000c360: 6c74 2069 7320 5472 7565 2e0a 2020 2020  lt is True..    
+0000c370: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000c380: 6966 206e 7061 7274 6974 696f 6e73 203c  if npartitions <
+0000c390: 3d20 2d31 3a0a 2020 2020 2020 2020 2020  = -1:.          
+0000c3a0: 2020 6e70 6172 7469 7469 6f6e 7320 3d20    npartitions = 
+0000c3b0: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
+0000c3c0: 0a20 2020 2020 2020 2023 204e 6f20 6e65  .        # No ne
+0000c3d0: 6564 2074 6f20 7761 726e 2069 6620 7765  ed to warn if we
+0000c3e0: 2772 6520 616c 7265 6164 7920 6c6f 6f6b  're already look
+0000c3f0: 696e 6720 6174 2061 6c6c 2070 6172 7469  ing at all parti
+0000c400: 7469 6f6e 730a 2020 2020 2020 2020 7361  tions.        sa
+0000c410: 6665 203d 206e 7061 7274 6974 696f 6e73  fe = npartitions
+0000c420: 2021 3d20 7365 6c66 2e6e 7061 7274 6974   != self.npartit
+0000c430: 696f 6e73 0a20 2020 2020 2020 2072 6574  ions.        ret
+0000c440: 7572 6e20 7365 6c66 2e5f 6865 6164 286e  urn self._head(n
+0000c450: 3d6e 2c20 6e70 6172 7469 7469 6f6e 733d  =n, npartitions=
+0000c460: 6e70 6172 7469 7469 6f6e 732c 2063 6f6d  npartitions, com
+0000c470: 7075 7465 3d63 6f6d 7075 7465 2c20 7361  pute=compute, sa
+0000c480: 6665 3d73 6166 6529 0a0a 2020 2020 6465  fe=safe)..    de
+0000c490: 6620 5f68 6561 6428 7365 6c66 2c20 6e2c  f _head(self, n,
+0000c4a0: 206e 7061 7274 6974 696f 6e73 2c20 636f   npartitions, co
+0000c4b0: 6d70 7574 652c 2073 6166 6529 3a0a 2020  mpute, safe):.  
+0000c4c0: 2020 2020 2020 6966 206e 7061 7274 6974        if npartit
+0000c4d0: 696f 6e73 203c 3d20 2d31 3a0a 2020 2020  ions <= -1:.    
+0000c4e0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+0000c4f0: 6f6e 7320 3d20 7365 6c66 2e6e 7061 7274  ons = self.npart
+0000c500: 6974 696f 6e73 0a20 2020 2020 2020 2069  itions.        i
+0000c510: 6620 6e70 6172 7469 7469 6f6e 7320 3e20  f npartitions > 
+0000c520: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
+0000c530: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000c540: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+0000c550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c560: 6622 6f6e 6c79 207b 7365 6c66 2e6e 7061  f"only {self.npa
+0000c570: 7274 6974 696f 6e73 7d20 7061 7274 6974  rtitions} partit
+0000c580: 696f 6e73 2c20 6865 6164 2072 6563 6569  ions, head recei
+0000c590: 7665 6420 7b6e 7061 7274 6974 696f 6e73  ved {npartitions
+0000c5a0: 7d22 0a20 2020 2020 2020 2020 2020 2029  }".            )
+0000c5b0: 0a0a 2020 2020 2020 2020 6e61 6d65 203d  ..        name =
+0000c5c0: 2066 2268 6561 642d 7b6e 7061 7274 6974   f"head-{npartit
+0000c5d0: 696f 6e73 7d2d 7b6e 7d2d 7b73 656c 662e  ions}-{n}-{self.
+0000c5e0: 5f6e 616d 657d 220a 2020 2020 2020 2020  _name}".        
+0000c5f0: 6966 2073 6166 653a 0a20 2020 2020 2020  if safe:.       
+0000c600: 2020 2020 2068 6561 6420 3d20 7361 6665       head = safe
+0000c610: 5f68 6561 640a 2020 2020 2020 2020 656c  _head.        el
+0000c620: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000c630: 6865 6164 203d 204d 2e68 6561 640a 0a20  head = M.head.. 
+0000c640: 2020 2020 2020 2069 6620 6e70 6172 7469         if nparti
+0000c650: 7469 6f6e 7320 3e20 313a 0a20 2020 2020  tions > 1:.     
+0000c660: 2020 2020 2020 206e 616d 655f 7020 3d20         name_p = 
+0000c670: 6622 6865 6164 2d70 6172 7469 616c 2d7b  f"head-partial-{
+0000c680: 6e7d 2d7b 7365 6c66 2e5f 6e61 6d65 7d22  n}-{self._name}"
+0000c690: 0a0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
+0000c6a0: 6b20 3d20 7b7d 0a20 2020 2020 2020 2020  k = {}.         
+0000c6b0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+0000c6c0: 6528 6e70 6172 7469 7469 6f6e 7329 3a0a  e(npartitions):.
+0000c6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c6e0: 6473 6b5b 286e 616d 655f 702c 2069 295d  dsk[(name_p, i)]
+0000c6f0: 203d 2028 4d2e 6865 6164 2c20 2873 656c   = (M.head, (sel
+0000c700: 662e 5f6e 616d 652c 2069 292c 206e 290a  f._name, i), n).
+0000c710: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+0000c720: 6361 7420 3d20 285f 636f 6e63 6174 2c20  cat = (_concat, 
+0000c730: 5b28 6e61 6d65 5f70 2c20 6929 2066 6f72  [(name_p, i) for
+0000c740: 2069 2069 6e20 7261 6e67 6528 6e70 6172   i in range(npar
+0000c750: 7469 7469 6f6e 7329 5d29 0a20 2020 2020  titions)]).     
+0000c760: 2020 2020 2020 2064 736b 5b28 6e61 6d65         dsk[(name
+0000c770: 2c20 3029 5d20 3d20 2868 6561 642c 2063  , 0)] = (head, c
+0000c780: 6f6e 6361 742c 206e 290a 2020 2020 2020  oncat, n).      
+0000c790: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000c7a0: 2020 2020 6473 6b20 3d20 7b28 6e61 6d65      dsk = {(name
+0000c7b0: 2c20 3029 3a20 2868 6561 642c 2028 7365  , 0): (head, (se
+0000c7c0: 6c66 2e5f 6e61 6d65 2c20 3029 2c20 6e29  lf._name, 0), n)
+0000c7d0: 7d0a 0a20 2020 2020 2020 2067 7261 7068  }..        graph
+0000c7e0: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+0000c7f0: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+0000c800: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
+0000c810: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
+0000c820: 5d29 0a20 2020 2020 2020 2072 6573 756c  ]).        resul
+0000c830: 7420 3d20 6e65 775f 6464 5f6f 626a 6563  t = new_dd_objec
+0000c840: 7428 0a20 2020 2020 2020 2020 2020 2067  t(.            g
+0000c850: 7261 7068 2c20 6e61 6d65 2c20 7365 6c66  raph, name, self
+0000c860: 2e5f 6d65 7461 2c20 5b73 656c 662e 6469  ._meta, [self.di
+0000c870: 7669 7369 6f6e 735b 305d 2c20 7365 6c66  visions[0], self
+0000c880: 2e64 6976 6973 696f 6e73 5b6e 7061 7274  .divisions[npart
+0000c890: 6974 696f 6e73 5d5d 0a20 2020 2020 2020  itions]].       
+0000c8a0: 2029 0a0a 2020 2020 2020 2020 6966 2063   )..        if c
+0000c8b0: 6f6d 7075 7465 3a0a 2020 2020 2020 2020  ompute:.        
+0000c8c0: 2020 2020 7265 7375 6c74 203d 2072 6573      result = res
+0000c8d0: 756c 742e 636f 6d70 7574 6528 290a 2020  ult.compute().  
+0000c8e0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0000c8f0: 756c 740a 0a20 2020 2064 6566 2074 6169  ult..    def tai
+0000c900: 6c28 7365 6c66 2c20 6e3d 352c 2063 6f6d  l(self, n=5, com
+0000c910: 7075 7465 3d54 7275 6529 3a0a 2020 2020  pute=True):.    
+0000c920: 2020 2020 2222 224c 6173 7420 6e20 726f      """Last n ro
+0000c930: 7773 206f 6620 7468 6520 6461 7461 7365  ws of the datase
+0000c940: 740a 0a20 2020 2020 2020 2043 6176 6561  t..        Cavea
+0000c950: 742c 2074 6865 206f 6e6c 7920 6368 6563  t, the only chec
+0000c960: 6b73 2074 6865 206c 6173 7420 6e20 726f  ks the last n ro
+0000c970: 7773 206f 6620 7468 6520 6c61 7374 2070  ws of the last p
+0000c980: 6172 7469 7469 6f6e 2e0a 2020 2020 2020  artition..      
+0000c990: 2020 2222 220a 2020 2020 2020 2020 6e61    """.        na
+0000c9a0: 6d65 203d 2022 7461 696c 2d25 642d 2573  me = "tail-%d-%s
+0000c9b0: 2220 2520 286e 2c20 7365 6c66 2e5f 6e61  " % (n, self._na
+0000c9c0: 6d65 290a 2020 2020 2020 2020 6473 6b20  me).        dsk 
+0000c9d0: 3d20 7b28 6e61 6d65 2c20 3029 3a20 284d  = {(name, 0): (M
+0000c9e0: 2e74 6169 6c2c 2028 7365 6c66 2e5f 6e61  .tail, (self._na
+0000c9f0: 6d65 2c20 7365 6c66 2e6e 7061 7274 6974  me, self.npartit
+0000ca00: 696f 6e73 202d 2031 292c 206e 297d 0a0a  ions - 1), n)}..
+0000ca10: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
+0000ca20: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
+0000ca30: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
+0000ca40: 6e61 6d65 2c20 6473 6b2c 2064 6570 656e  name, dsk, depen
+0000ca50: 6465 6e63 6965 733d 5b73 656c 665d 290a  dencies=[self]).
+0000ca60: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+0000ca70: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
+0000ca80: 7261 7068 2c20 6e61 6d65 2c20 7365 6c66  raph, name, self
+0000ca90: 2e5f 6d65 7461 2c20 7365 6c66 2e64 6976  ._meta, self.div
+0000caa0: 6973 696f 6e73 5b2d 323a 5d29 0a0a 2020  isions[-2:])..  
+0000cab0: 2020 2020 2020 6966 2063 6f6d 7075 7465        if compute
+0000cac0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000cad0: 7375 6c74 203d 2072 6573 756c 742e 636f  sult = result.co
+0000cae0: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
+0000caf0: 7265 7475 726e 2072 6573 756c 740a 0a20  return result.. 
+0000cb00: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0000cb10: 2064 6566 206c 6f63 2873 656c 6629 3a0a   def loc(self):.
+0000cb20: 2020 2020 2020 2020 2222 2250 7572 656c          """Purel
+0000cb30: 7920 6c61 6265 6c2d 6c6f 6361 7469 6f6e  y label-location
+0000cb40: 2062 6173 6564 2069 6e64 6578 6572 2066   based indexer f
+0000cb50: 6f72 2073 656c 6563 7469 6f6e 2062 7920  or selection by 
+0000cb60: 6c61 6265 6c2e 0a0a 2020 2020 2020 2020  label...        
+0000cb70: 3e3e 3e20 6466 2e6c 6f63 5b22 6222 5d20  >>> df.loc["b"] 
+0000cb80: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+0000cb90: 500a 2020 2020 2020 2020 3e3e 3e20 6466  P.        >>> df
+0000cba0: 2e6c 6f63 5b22 6222 3a22 6422 5d20 2023  .loc["b":"d"]  #
+0000cbb0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
+0000cbc0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000cbd0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+0000cbe0: 7461 6672 616d 652e 696e 6465 7869 6e67  taframe.indexing
+0000cbf0: 2069 6d70 6f72 7420 5f4c 6f63 496e 6465   import _LocInde
+0000cc00: 7865 720a 0a20 2020 2020 2020 2072 6574  xer..        ret
+0000cc10: 7572 6e20 5f4c 6f63 496e 6465 7865 7228  urn _LocIndexer(
+0000cc20: 7365 6c66 290a 0a20 2020 2064 6566 205f  self)..    def _
+0000cc30: 7061 7274 6974 696f 6e73 2873 656c 662c  partitions(self,
+0000cc40: 2069 6e64 6578 293a 0a20 2020 2020 2020   index):.       
+0000cc50: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+0000cc60: 6365 2869 6e64 6578 2c20 7475 706c 6529  ce(index, tuple)
+0000cc70: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+0000cc80: 6465 7820 3d20 2869 6e64 6578 2c29 0a20  dex = (index,). 
+0000cc90: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+0000cca0: 2e61 7272 6179 2e73 6c69 6369 6e67 2069  .array.slicing i
+0000ccb0: 6d70 6f72 7420 6e6f 726d 616c 697a 655f  mport normalize_
+0000ccc0: 696e 6465 780a 0a20 2020 2020 2020 2069  index..        i
+0000ccd0: 6e64 6578 203d 206e 6f72 6d61 6c69 7a65  ndex = normalize
+0000cce0: 5f69 6e64 6578 2869 6e64 6578 2c20 2873  _index(index, (s
+0000ccf0: 656c 662e 6e70 6172 7469 7469 6f6e 732c  elf.npartitions,
+0000cd00: 2929 0a20 2020 2020 2020 2069 6e64 6578  )).        index
+0000cd10: 203d 2074 7570 6c65 2873 6c69 6365 286b   = tuple(slice(k
+0000cd20: 2c20 6b20 2b20 3129 2069 6620 6973 696e  , k + 1) if isin
+0000cd30: 7374 616e 6365 286b 2c20 4e75 6d62 6572  stance(k, Number
+0000cd40: 2920 656c 7365 206b 2066 6f72 206b 2069  ) else k for k i
+0000cd50: 6e20 696e 6465 7829 0a20 2020 2020 2020  n index).       
+0000cd60: 206e 616d 6520 3d20 2262 6c6f 636b 732d   name = "blocks-
+0000cd70: 2220 2b20 746f 6b65 6e69 7a65 2873 656c  " + tokenize(sel
+0000cd80: 662c 2069 6e64 6578 290a 2020 2020 2020  f, index).      
+0000cd90: 2020 6e65 775f 6b65 7973 203d 206e 702e    new_keys = np.
+0000cda0: 6172 7261 7928 7365 6c66 2e5f 5f64 6173  array(self.__das
+0000cdb0: 6b5f 6b65 7973 5f5f 2829 2c20 6474 7970  k_keys__(), dtyp
+0000cdc0: 653d 6f62 6a65 6374 295b 696e 6465 785d  e=object)[index]
+0000cdd0: 2e74 6f6c 6973 7428 290a 0a20 2020 2020  .tolist()..     
+0000cde0: 2020 2064 6976 6973 696f 6e73 203d 205b     divisions = [
+0000cdf0: 7365 6c66 2e64 6976 6973 696f 6e73 5b69  self.divisions[i
+0000ce00: 5d20 666f 7220 5f2c 2069 2069 6e20 6e65  ] for _, i in ne
+0000ce10: 775f 6b65 7973 5d20 2b20 5b0a 2020 2020  w_keys] + [.    
+0000ce20: 2020 2020 2020 2020 7365 6c66 2e64 6976          self.div
+0000ce30: 6973 696f 6e73 5b6e 6577 5f6b 6579 735b  isions[new_keys[
+0000ce40: 2d31 5d5b 315d 202b 2031 5d0a 2020 2020  -1][1] + 1].    
+0000ce50: 2020 2020 5d0a 2020 2020 2020 2020 6473      ].        ds
+0000ce60: 6b20 3d20 7b28 6e61 6d65 2c20 6929 3a20  k = {(name, i): 
+0000ce70: 7475 706c 6528 6b65 7929 2066 6f72 2069  tuple(key) for i
+0000ce80: 2c20 6b65 7920 696e 2065 6e75 6d65 7261  , key in enumera
+0000ce90: 7465 286e 6577 5f6b 6579 7329 7d0a 0a20  te(new_keys)}.. 
+0000cea0: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
+0000ceb0: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+0000cec0: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
+0000ced0: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
+0000cee0: 656e 6369 6573 3d5b 7365 6c66 5d29 0a20  encies=[self]). 
+0000cef0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+0000cf00: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
+0000cf10: 682c 206e 616d 652c 2073 656c 662e 5f6d  h, name, self._m
+0000cf20: 6574 612c 2064 6976 6973 696f 6e73 290a  eta, divisions).
+0000cf30: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000cf40: 2020 2064 6566 2070 6172 7469 7469 6f6e     def partition
+0000cf50: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+0000cf60: 2022 2222 536c 6963 6520 6461 7461 6672   """Slice datafr
+0000cf70: 616d 6520 6279 2070 6172 7469 7469 6f6e  ame by partition
+0000cf80: 730a 0a20 2020 2020 2020 2054 6869 7320  s..        This 
+0000cf90: 616c 6c6f 7773 2070 6172 7469 7469 6f6e  allows partition
+0000cfa0: 7769 7365 2073 6c69 6369 6e67 206f 6620  wise slicing of 
+0000cfb0: 6120 4461 736b 2044 6174 6166 7261 6d65  a Dask Dataframe
+0000cfc0: 2e20 2059 6f75 2063 616e 2070 6572 666f  .  You can perfo
+0000cfd0: 726d 206e 6f72 6d61 6c0a 2020 2020 2020  rm normal.      
+0000cfe0: 2020 4e75 6d70 792d 7374 796c 6520 736c    Numpy-style sl
+0000cff0: 6963 696e 672c 2062 7574 206e 6f77 2072  icing, but now r
+0000d000: 6174 6865 7220 7468 616e 2073 6c69 6365  ather than slice
+0000d010: 2065 6c65 6d65 6e74 7320 6f66 2074 6865   elements of the
+0000d020: 2061 7272 6179 2079 6f75 0a20 2020 2020   array you.     
+0000d030: 2020 2073 6c69 6365 2061 6c6f 6e67 2070     slice along p
+0000d040: 6172 7469 7469 6f6e 7320 736f 2c20 666f  artitions so, fo
+0000d050: 7220 6578 616d 706c 652c 2060 6064 662e  r example, ``df.
+0000d060: 7061 7274 6974 696f 6e73 5b3a 355d 6060  partitions[:5]``
+0000d070: 2070 726f 6475 6365 7320 6120 6e65 770a   produces a new.
+0000d080: 2020 2020 2020 2020 4461 736b 2044 6174          Dask Dat
+0000d090: 6166 7261 6d65 206f 6620 7468 6520 6669  aframe of the fi
+0000d0a0: 7273 7420 6669 7665 2070 6172 7469 7469  rst five partiti
+0000d0b0: 6f6e 732e 2056 616c 6964 2069 6e64 6578  ons. Valid index
+0000d0c0: 6572 7320 6172 6520 696e 7465 6765 7273  ers are integers
+0000d0d0: 2c20 7365 7175 656e 6365 730a 2020 2020  , sequences.    
+0000d0e0: 2020 2020 6f66 2069 6e74 6567 6572 732c      of integers,
+0000d0f0: 2073 6c69 6365 732c 206f 7220 626f 6f6c   slices, or bool
+0000d100: 6561 6e20 6d61 736b 732e 0a0a 2020 2020  ean masks...    
+0000d110: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+0000d120: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+0000d130: 2020 2020 2020 3e3e 3e20 6466 2e70 6172        >>> df.par
+0000d140: 7469 7469 6f6e 735b 305d 2020 2320 646f  titions[0]  # do
+0000d150: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
+0000d160: 2020 2020 203e 3e3e 2064 662e 7061 7274       >>> df.part
+0000d170: 6974 696f 6e73 5b3a 335d 2020 2320 646f  itions[:3]  # do
+0000d180: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
+0000d190: 2020 2020 203e 3e3e 2064 662e 7061 7274       >>> df.part
+0000d1a0: 6974 696f 6e73 5b3a 3a31 305d 2020 2320  itions[::10]  # 
+0000d1b0: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
+0000d1c0: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+0000d1d0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+0000d1e0: 2020 2020 2020 2020 4120 4461 736b 2044          A Dask D
+0000d1f0: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
+0000d200: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+0000d210: 7572 6e20 496e 6465 7843 616c 6c61 626c  urn IndexCallabl
+0000d220: 6528 7365 6c66 2e5f 7061 7274 6974 696f  e(self._partitio
+0000d230: 6e73 290a 0a20 2020 2023 204e 6f74 653a  ns)..    # Note:
+0000d240: 2069 6c6f 6320 6973 2069 6d70 6c65 6d65   iloc is impleme
+0000d250: 6e74 6564 206f 6e6c 7920 6f6e 2044 6174  nted only on Dat
+0000d260: 6146 7261 6d65 0a0a 2020 2020 6465 6620  aFrame..    def 
+0000d270: 7265 7061 7274 6974 696f 6e28 0a20 2020  repartition(.   
+0000d280: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0000d290: 2020 2064 6976 6973 696f 6e73 3d4e 6f6e     divisions=Non
+0000d2a0: 652c 0a20 2020 2020 2020 206e 7061 7274  e,.        npart
+0000d2b0: 6974 696f 6e73 3d4e 6f6e 652c 0a20 2020  itions=None,.   
+0000d2c0: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
+0000d2d0: 697a 653d 4e6f 6e65 2c0a 2020 2020 2020  ize=None,.      
+0000d2e0: 2020 6672 6571 3d4e 6f6e 652c 0a20 2020    freq=None,.   
+0000d2f0: 2020 2020 2066 6f72 6365 3d46 616c 7365       force=False
+0000d300: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0000d310: 2022 2222 5265 7061 7274 6974 696f 6e20   """Repartition 
+0000d320: 6461 7461 6672 616d 6520 616c 6f6e 6720  dataframe along 
+0000d330: 6e65 7720 6469 7669 7369 6f6e 730a 0a20  new divisions.. 
+0000d340: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0000d350: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0000d360: 2d2d 2d2d 0a20 2020 2020 2020 2064 6976  ----.        div
+0000d370: 6973 696f 6e73 203a 206c 6973 742c 206f  isions : list, o
+0000d380: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0000d390: 2020 2020 5468 6520 2264 6976 6964 696e      The "dividin
+0000d3a0: 6720 6c69 6e65 7322 2075 7365 6420 746f  g lines" used to
+0000d3b0: 2073 706c 6974 2074 6865 2064 6174 6166   split the dataf
+0000d3c0: 7261 6d65 2069 6e74 6f20 7061 7274 6974  rame into partit
+0000d3d0: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
+0000d3e0: 2020 466f 7220 6060 6469 7669 7369 6f6e    For ``division
+0000d3f0: 733d 5b30 2c20 3130 2c20 3530 2c20 3130  s=[0, 10, 50, 10
+0000d400: 305d 6060 2c20 7468 6572 6520 776f 756c  0]``, there woul
+0000d410: 6420 6265 2074 6872 6565 206f 7574 7075  d be three outpu
+0000d420: 7420 7061 7274 6974 696f 6e73 2c0a 2020  t partitions,.  
+0000d430: 2020 2020 2020 2020 2020 7768 6572 6520            where 
+0000d440: 7468 6520 6e65 7720 696e 6465 7820 636f  the new index co
+0000d450: 6e74 6169 6e65 6420 5b30 2c20 3130 292c  ntained [0, 10),
+0000d460: 205b 3130 2c20 3530 292c 2061 6e64 205b   [10, 50), and [
+0000d470: 3530 2c20 3130 3029 2c20 7265 7370 6563  50, 100), respec
+0000d480: 7469 7665 6c79 2e0a 2020 2020 2020 2020  tively..        
+0000d490: 2020 2020 5365 6520 6874 7470 733a 2f2f      See https://
+0000d4a0: 646f 6373 2e64 6173 6b2e 6f72 672f 656e  docs.dask.org/en
+0000d4b0: 2f6c 6174 6573 742f 6461 7461 6672 616d  /latest/datafram
+0000d4c0: 652d 6465 7369 676e 2e68 746d 6c23 7061  e-design.html#pa
+0000d4d0: 7274 6974 696f 6e73 2e0a 2020 2020 2020  rtitions..      
+0000d4e0: 2020 2020 2020 4f6e 6c79 2075 7365 6420        Only used 
+0000d4f0: 6966 206e 7061 7274 6974 696f 6e73 2061  if npartitions a
+0000d500: 6e64 2070 6172 7469 7469 6f6e 5f73 697a  nd partition_siz
+0000d510: 6520 6973 6e27 7420 7370 6563 6966 6965  e isn't specifie
+0000d520: 642e 0a20 2020 2020 2020 2020 2020 2046  d..            F
+0000d530: 6f72 2063 6f6e 7665 6e69 656e 6365 2069  or convenience i
+0000d540: 6620 6769 7665 6e20 616e 2069 6e74 6567  f given an integ
+0000d550: 6572 2074 6869 7320 7769 6c6c 2064 6566  er this will def
+0000d560: 6572 2074 6f20 6e70 6172 7469 7469 6f6e  er to npartition
+0000d570: 730a 2020 2020 2020 2020 2020 2020 616e  s.            an
+0000d580: 6420 6966 2067 6976 656e 2061 2073 7472  d if given a str
+0000d590: 696e 6720 6974 2077 696c 6c20 6465 6665  ing it will defe
+0000d5a0: 7220 746f 2070 6172 7469 7469 6f6e 5f73  r to partition_s
+0000d5b0: 697a 6520 2873 6565 2062 656c 6f77 290a  ize (see below).
+0000d5c0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+0000d5d0: 6f6e 7320 3a20 696e 742c 206f 7074 696f  ons : int, optio
+0000d5e0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0000d5f0: 4170 7072 6f78 696d 6174 6520 6e75 6d62  Approximate numb
+0000d600: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
+0000d610: 206f 6620 6f75 7470 7574 2e20 4f6e 6c79   of output. Only
+0000d620: 2075 7365 6420 6966 2070 6172 7469 7469   used if partiti
+0000d630: 6f6e 5f73 697a 650a 2020 2020 2020 2020  on_size.        
+0000d640: 2020 2020 6973 6e27 7420 7370 6563 6966      isn't specif
+0000d650: 6965 642e 2054 6865 206e 756d 6265 7220  ied. The number 
+0000d660: 6f66 2070 6172 7469 7469 6f6e 7320 7573  of partitions us
+0000d670: 6564 206d 6179 2062 6520 736c 6967 6874  ed may be slight
+0000d680: 6c79 0a20 2020 2020 2020 2020 2020 206c  ly.            l
+0000d690: 6f77 6572 2074 6861 6e20 6e70 6172 7469  ower than nparti
+0000d6a0: 7469 6f6e 7320 6465 7065 6e64 696e 6720  tions depending 
+0000d6b0: 6f6e 2064 6174 6120 6469 7374 7269 6275  on data distribu
+0000d6c0: 7469 6f6e 2c20 6275 7420 7769 6c6c 206e  tion, but will n
+0000d6d0: 6576 6572 2062 650a 2020 2020 2020 2020  ever be.        
+0000d6e0: 2020 2020 6869 6768 6572 2e0a 2020 2020      higher..    
+0000d6f0: 2020 2020 7061 7274 6974 696f 6e5f 7369      partition_si
+0000d700: 7a65 3a20 696e 7420 6f72 2073 7472 696e  ze: int or strin
+0000d710: 672c 206f 7074 696f 6e61 6c0a 2020 2020  g, optional.    
+0000d720: 2020 2020 2020 2020 4d61 7820 6e75 6d62          Max numb
+0000d730: 6572 206f 6620 6279 7465 7320 6f66 206d  er of bytes of m
+0000d740: 656d 6f72 7920 666f 7220 6561 6368 2070  emory for each p
+0000d750: 6172 7469 7469 6f6e 2e20 5573 6520 6e75  artition. Use nu
+0000d760: 6d62 6572 7320 6f72 0a20 2020 2020 2020  mbers or.       
+0000d770: 2020 2020 2073 7472 696e 6773 206c 696b       strings lik
+0000d780: 6520 354d 422e 2049 6620 7370 6563 6966  e 5MB. If specif
+0000d790: 6965 6420 6e70 6172 7469 7469 6f6e 7320  ied npartitions 
+0000d7a0: 616e 6420 6469 7669 7369 6f6e 7320 7769  and divisions wi
+0000d7b0: 6c6c 2062 650a 2020 2020 2020 2020 2020  ll be.          
+0000d7c0: 2020 6967 6e6f 7265 642e 204e 6f74 6520    ignored. Note 
+0000d7d0: 7468 6174 2074 6865 2073 697a 6520 7265  that the size re
+0000d7e0: 666c 6563 7473 2074 6865 206e 756d 6265  flects the numbe
+0000d7f0: 7220 6f66 2062 7974 6573 2075 7365 6420  r of bytes used 
+0000d800: 6173 0a20 2020 2020 2020 2020 2020 2063  as.            c
+0000d810: 6f6d 7075 7465 6420 6279 2060 6070 616e  omputed by ``pan
+0000d820: 6461 732e 4461 7461 4672 616d 652e 6d65  das.DataFrame.me
+0000d830: 6d6f 7279 5f75 7361 6765 6060 2c20 7768  mory_usage``, wh
+0000d840: 6963 6820 7769 6c6c 206e 6f74 0a20 2020  ich will not.   
+0000d850: 2020 2020 2020 2020 206e 6563 6573 7361           necessa
+0000d860: 7269 6c79 206d 6174 6368 2074 6865 2073  rily match the s
+0000d870: 697a 6520 7768 656e 2073 746f 7269 6e67  ize when storing
+0000d880: 2074 6f20 6469 736b 2e0a 0a20 2020 2020   to disk...     
+0000d890: 2020 2020 2020 202e 2e20 7761 726e 696e         .. warnin
+0000d8a0: 673a 3a0a 0a20 2020 2020 2020 2020 2020  g::..           
+0000d8b0: 2020 2020 5468 6973 206b 6579 776f 7264      This keyword
+0000d8c0: 2061 7267 756d 656e 7420 7472 6967 6765   argument trigge
+0000d8d0: 7273 2063 6f6d 7075 7461 7469 6f6e 2074  rs computation t
+0000d8e0: 6f20 6465 7465 726d 696e 650a 2020 2020  o determine.    
+0000d8f0: 2020 2020 2020 2020 2020 2074 6865 206d             the m
+0000d900: 656d 6f72 7920 7369 7a65 206f 6620 6561  emory size of ea
+0000d910: 6368 2070 6172 7469 7469 6f6e 2c20 7768  ch partition, wh
+0000d920: 6963 6820 6d61 7920 6265 2065 7870 656e  ich may be expen
+0000d930: 7369 7665 2e0a 0a20 2020 2020 2020 2066  sive...        f
+0000d940: 7265 7120 3a20 7374 722c 2070 642e 5469  req : str, pd.Ti
+0000d950: 6d65 6465 6c74 610a 2020 2020 2020 2020  medelta.        
+0000d960: 2020 2020 4120 7065 7269 6f64 206f 6e20      A period on 
+0000d970: 7768 6963 6820 746f 2070 6172 7469 7469  which to partiti
+0000d980: 6f6e 2074 696d 6573 6572 6965 7320 6461  on timeseries da
+0000d990: 7461 206c 696b 6520 6060 2737 4427 6060  ta like ``'7D'``
+0000d9a0: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
+0000d9b0: 6060 2731 3268 2760 6020 6f72 2060 6070  ``'12h'`` or ``p
+0000d9c0: 642e 5469 6d65 6465 6c74 6128 686f 7572  d.Timedelta(hour
+0000d9d0: 733d 3132 2960 602e 2020 4173 7375 6d65  s=12)``.  Assume
+0000d9e0: 7320 6120 6461 7465 7469 6d65 2069 6e64  s a datetime ind
+0000d9f0: 6578 2e0a 2020 2020 2020 2020 666f 7263  ex..        forc
+0000da00: 6520 3a20 626f 6f6c 2c20 6465 6661 756c  e : bool, defaul
+0000da10: 7420 4661 6c73 650a 2020 2020 2020 2020  t False.        
+0000da20: 2020 2020 416c 6c6f 7773 2074 6865 2065      Allows the e
+0000da30: 7870 616e 7369 6f6e 206f 6620 7468 6520  xpansion of the 
+0000da40: 6578 6973 7469 6e67 2064 6976 6973 696f  existing divisio
+0000da50: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
+0000da60: 4966 2046 616c 7365 2074 6865 6e20 7468  If False then th
+0000da70: 6520 6e65 7720 6469 7669 7369 6f6e 7327  e new divisions'
+0000da80: 206c 6f77 6572 2061 6e64 2075 7070 6572   lower and upper
+0000da90: 2062 6f75 6e64 7320 6d75 7374 2062 650a   bounds must be.
+0000daa0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+0000dab0: 7361 6d65 2061 7320 7468 6520 6f6c 6420  same as the old 
+0000dac0: 6469 7669 7369 6f6e 7327 2e0a 0a20 2020  divisions'...   
+0000dad0: 2020 2020 204e 6f74 6573 0a20 2020 2020       Notes.     
+0000dae0: 2020 202d 2d2d 2d2d 0a20 2020 2020 2020     -----.       
+0000daf0: 2045 7861 6374 6c79 206f 6e65 206f 6620   Exactly one of 
+0000db00: 6064 6976 6973 696f 6e73 602c 2060 6e70  `divisions`, `np
+0000db10: 6172 7469 7469 6f6e 7360 2c20 6070 6172  artitions`, `par
+0000db20: 7469 7469 6f6e 5f73 697a 6560 2c20 6f72  tition_size`, or
+0000db30: 2060 6672 6571 600a 2020 2020 2020 2020   `freq`.        
+0000db40: 7368 6f75 6c64 2062 6520 7370 6563 6966  should be specif
+0000db50: 6965 642e 2041 2060 6056 616c 7565 4572  ied. A ``ValueEr
+0000db60: 726f 7260 6020 7769 6c6c 2062 6520 7261  ror`` will be ra
+0000db70: 6973 6564 2077 6865 6e20 7468 6174 2069  ised when that i
+0000db80: 730a 2020 2020 2020 2020 6e6f 7420 7468  s.        not th
+0000db90: 6520 6361 7365 2e0a 0a20 2020 2020 2020  e case...       
+0000dba0: 2041 6c73 6f20 6e6f 7465 2074 6861 7420   Also note that 
+0000dbb0: 6060 6c65 6e28 6469 7669 736f 6e73 2960  ``len(divisons)`
+0000dbc0: 6020 6973 2065 7175 616c 2074 6f20 6060  ` is equal to ``
+0000dbd0: 6e70 6172 7469 7469 6f6e 7320 2b20 3160  npartitions + 1`
+0000dbe0: 602e 2054 6869 7320 6973 2062 6563 6175  `. This is becau
+0000dbf0: 7365 2060 6064 6976 6973 696f 6e73 6060  se ``divisions``
+0000dc00: 0a20 2020 2020 2020 2072 6570 7265 7365  .        represe
+0000dc10: 6e74 7320 7468 6520 7570 7065 7220 616e  nts the upper an
+0000dc20: 6420 6c6f 7765 7220 626f 756e 6473 206f  d lower bounds o
+0000dc30: 6620 6561 6368 2070 6172 7469 7469 6f6e  f each partition
+0000dc40: 2e20 5468 6520 6669 7273 7420 6974 656d  . The first item
+0000dc50: 2069 7320 7468 650a 2020 2020 2020 2020   is the.        
+0000dc60: 6c6f 7765 7220 626f 756e 6420 6f66 2074  lower bound of t
+0000dc70: 6865 2066 6972 7374 2070 6172 7469 7469  he first partiti
+0000dc80: 6f6e 2c20 7468 6520 7365 636f 6e64 2069  on, the second i
+0000dc90: 7465 6d20 6973 2074 6865 206c 6f77 6572  tem is the lower
+0000dca0: 2062 6f75 6e64 206f 6620 7468 650a 2020   bound of the.  
+0000dcb0: 2020 2020 2020 7365 636f 6e64 2070 6172        second par
+0000dcc0: 7469 7469 6f6e 2061 6e64 2074 6865 2075  tition and the u
+0000dcd0: 7070 6572 2062 6f75 6e64 206f 6620 7468  pper bound of th
+0000dce0: 6520 6669 7273 7420 7061 7274 6974 696f  e first partitio
+0000dcf0: 6e2c 2061 6e64 2073 6f20 6f6e 2e0a 2020  n, and so on..  
+0000dd00: 2020 2020 2020 5468 6520 7365 636f 6e64        The second
+0000dd10: 2d74 6f2d 6c61 7374 2069 7465 6d20 6973  -to-last item is
+0000dd20: 2074 6865 206c 6f77 6572 2062 6f75 6e64   the lower bound
+0000dd30: 206f 6620 7468 6520 6c61 7374 2070 6172   of the last par
+0000dd40: 7469 7469 6f6e 2c20 616e 6420 7468 6520  tition, and the 
+0000dd50: 6c61 7374 0a20 2020 2020 2020 2028 6578  last.        (ex
+0000dd60: 7472 6129 2069 7465 6d20 6973 2074 6865  tra) item is the
+0000dd70: 2075 7070 6572 2062 6f75 6e64 206f 6620   upper bound of 
+0000dd80: 7468 6520 6c61 7374 2070 6172 7469 7469  the last partiti
+0000dd90: 6f6e 2e0a 0a20 2020 2020 2020 2045 7861  on...        Exa
+0000dda0: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+0000ddb0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+0000ddc0: 3e3e 2064 6620 3d20 6466 2e72 6570 6172  >> df = df.repar
+0000ddd0: 7469 7469 6f6e 286e 7061 7274 6974 696f  tition(npartitio
+0000dde0: 6e73 3d31 3029 2020 2320 646f 6374 6573  ns=10)  # doctes
+0000ddf0: 743a 202b 534b 4950 0a20 2020 2020 2020  t: +SKIP.       
+0000de00: 203e 3e3e 2064 6620 3d20 6466 2e72 6570   >>> df = df.rep
+0000de10: 6172 7469 7469 6f6e 2864 6976 6973 696f  artition(divisio
+0000de20: 6e73 3d5b 302c 2035 2c20 3130 2c20 3230  ns=[0, 5, 10, 20
+0000de30: 5d29 2020 2320 646f 6374 6573 743a 202b  ])  # doctest: +
+0000de40: 534b 4950 0a20 2020 2020 2020 203e 3e3e  SKIP.        >>>
+0000de50: 2064 6620 3d20 6466 2e72 6570 6172 7469   df = df.reparti
+0000de60: 7469 6f6e 2866 7265 713d 2737 6427 2920  tion(freq='7d') 
+0000de70: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+0000de80: 500a 0a20 2020 2020 2020 2053 6565 2041  P..        See A
+0000de90: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+0000dea0: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
+0000deb0: 6146 7261 6d65 2e6d 656d 6f72 795f 7573  aFrame.memory_us
+0000dec0: 6167 655f 7065 725f 7061 7274 6974 696f  age_per_partitio
+0000ded0: 6e0a 2020 2020 2020 2020 7061 6e64 6173  n.        pandas
+0000dee0: 2e44 6174 6146 7261 6d65 2e6d 656d 6f72  .DataFrame.memor
+0000def0: 795f 7573 6167 650a 2020 2020 2020 2020  y_usage.        
+0000df00: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
+0000df10: 7369 6e73 7461 6e63 6528 6469 7669 7369  sinstance(divisi
+0000df20: 6f6e 732c 2069 6e74 293a 0a20 2020 2020  ons, int):.     
+0000df30: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
+0000df40: 6e73 203d 2064 6976 6973 696f 6e73 0a20  ns = divisions. 
+0000df50: 2020 2020 2020 2020 2020 2064 6976 6973             divis
+0000df60: 696f 6e73 203d 204e 6f6e 650a 2020 2020  ions = None.    
+0000df70: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0000df80: 6528 6469 7669 7369 6f6e 732c 2073 7472  e(divisions, str
+0000df90: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
+0000dfa0: 6172 7469 7469 6f6e 5f73 697a 6520 3d20  artition_size = 
+0000dfb0: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
+0000dfc0: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
+0000dfd0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2069  = None.        i
+0000dfe0: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+0000dff0: 7375 6d28 0a20 2020 2020 2020 2020 2020  sum(.           
+0000e000: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
+0000e010: 2020 2020 2020 2020 2020 2070 6172 7469             parti
+0000e020: 7469 6f6e 5f73 697a 6520 6973 206e 6f74  tion_size is not
+0000e030: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+0000e040: 2020 2020 2020 2020 2020 2064 6976 6973             divis
+0000e050: 696f 6e73 2069 7320 6e6f 7420 4e6f 6e65  ions is not None
+0000e060: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000e070: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
+0000e080: 7320 6973 206e 6f74 204e 6f6e 652c 0a20  s is not None,. 
+0000e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e0a0: 2020 2066 7265 7120 6973 206e 6f74 204e     freq is not N
+0000e0b0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+0000e0c0: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+0000e0d0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0000e0e0: 2021 3d20 310a 2020 2020 2020 2020 293a   != 1.        ):
+0000e0f0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000e100: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+0000e110: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000e120: 506c 6561 7365 2070 726f 7669 6465 2065  Please provide e
+0000e130: 7861 6374 6c79 206f 6e65 206f 6620 6060  xactly one of ``
+0000e140: 6e70 6172 7469 7469 6f6e 733d 6060 2c20  npartitions=``, 
+0000e150: 6060 6672 6571 3d60 602c 2022 0a20 2020  ``freq=``, ".   
+0000e160: 2020 2020 2020 2020 2020 2020 2022 6060               "``
+0000e170: 6469 7669 7369 6f6e 733d 6060 2c20 6060  divisions=``, ``
+0000e180: 7061 7274 6974 696f 6e5f 7369 7a65 3d60  partition_size=`
+0000e190: 6020 6b65 7977 6f72 6420 6172 6775 6d65  ` keyword argume
+0000e1a0: 6e74 7322 0a20 2020 2020 2020 2020 2020  nts".           
+0000e1b0: 2029 0a0a 2020 2020 2020 2020 6966 2070   )..        if p
+0000e1c0: 6172 7469 7469 6f6e 5f73 697a 6520 6973  artition_size is
+0000e1d0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0000e1e0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+0000e1f0: 7061 7274 6974 696f 6e5f 7369 7a65 2873  partition_size(s
+0000e200: 656c 662c 2070 6172 7469 7469 6f6e 5f73  elf, partition_s
+0000e210: 697a 6529 0a20 2020 2020 2020 2065 6c69  ize).        eli
+0000e220: 6620 6e70 6172 7469 7469 6f6e 7320 6973  f npartitions is
+0000e230: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0000e240: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+0000e250: 7061 7274 6974 696f 6e5f 6e70 6172 7469  partition_nparti
+0000e260: 7469 6f6e 7328 7365 6c66 2c20 6e70 6172  tions(self, npar
+0000e270: 7469 7469 6f6e 7329 0a20 2020 2020 2020  titions).       
+0000e280: 2065 6c69 6620 6469 7669 7369 6f6e 7320   elif divisions 
+0000e290: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0000e2a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000e2b0: 7265 7061 7274 6974 696f 6e28 7365 6c66  repartition(self
+0000e2c0: 2c20 6469 7669 7369 6f6e 732c 2066 6f72  , divisions, for
+0000e2d0: 6365 3d66 6f72 6365 290a 2020 2020 2020  ce=force).      
+0000e2e0: 2020 656c 6966 2066 7265 7120 6973 206e    elif freq is n
+0000e2f0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0000e300: 2020 2020 2072 6574 7572 6e20 7265 7061       return repa
+0000e310: 7274 6974 696f 6e5f 6672 6571 2873 656c  rtition_freq(sel
+0000e320: 662c 2066 7265 713d 6672 6571 290a 0a20  f, freq=freq).. 
+0000e330: 2020 2064 6566 2073 6875 6666 6c65 280a     def shuffle(.
+0000e340: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000e350: 2020 2020 2020 6f6e 2c0a 2020 2020 2020        on,.      
+0000e360: 2020 6e70 6172 7469 7469 6f6e 733d 4e6f    npartitions=No
+0000e370: 6e65 2c0a 2020 2020 2020 2020 6d61 785f  ne,.        max_
+0000e380: 6272 616e 6368 3d4e 6f6e 652c 0a20 2020  branch=None,.   
+0000e390: 2020 2020 2073 6875 6666 6c65 3d4e 6f6e       shuffle=Non
+0000e3a0: 652c 0a20 2020 2020 2020 2069 676e 6f72  e,.        ignor
+0000e3b0: 655f 696e 6465 783d 4661 6c73 652c 0a20  e_index=False,. 
+0000e3c0: 2020 2020 2020 2063 6f6d 7075 7465 3d4e         compute=N
+0000e3d0: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
+0000e3e0: 2020 2020 2222 2252 6561 7272 616e 6765      """Rearrange
+0000e3f0: 2044 6174 6146 7261 6d65 2069 6e74 6f20   DataFrame into 
+0000e400: 6e65 7720 7061 7274 6974 696f 6e73 0a0a  new partitions..
+0000e410: 2020 2020 2020 2020 5573 6573 2068 6173          Uses has
+0000e420: 6869 6e67 206f 6620 606f 6e60 2074 6f20  hing of `on` to 
+0000e430: 6d61 7020 726f 7773 2074 6f20 6f75 7470  map rows to outp
+0000e440: 7574 2070 6172 7469 7469 6f6e 732e 2041  ut partitions. A
+0000e450: 6674 6572 2074 6869 730a 2020 2020 2020  fter this.      
+0000e460: 2020 6f70 6572 6174 696f 6e2c 2072 6f77    operation, row
+0000e470: 7320 7769 7468 2074 6865 2073 616d 6520  s with the same 
+0000e480: 7661 6c75 6520 6f66 2060 6f6e 6020 7769  value of `on` wi
+0000e490: 6c6c 2062 6520 696e 2074 6865 2073 616d  ll be in the sam
+0000e4a0: 650a 2020 2020 2020 2020 7061 7274 6974  e.        partit
+0000e4b0: 696f 6e2e 0a0a 2020 2020 2020 2020 5061  ion...        Pa
+0000e4c0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+0000e4d0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0000e4e0: 2020 2020 6f6e 203a 2073 7472 2c20 6c69      on : str, li
+0000e4f0: 7374 206f 6620 7374 722c 206f 7220 5365  st of str, or Se
+0000e500: 7269 6573 2c20 496e 6465 782c 206f 7220  ries, Index, or 
+0000e510: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
+0000e520: 2020 2020 2020 436f 6c75 6d6e 2873 2920        Column(s) 
+0000e530: 6f72 2069 6e64 6578 2074 6f20 6265 2075  or index to be u
+0000e540: 7365 6420 746f 206d 6170 2072 6f77 7320  sed to map rows 
+0000e550: 746f 206f 7574 7075 7420 7061 7274 6974  to output partit
+0000e560: 696f 6e73 0a20 2020 2020 2020 206e 7061  ions.        npa
+0000e570: 7274 6974 696f 6e73 203a 2069 6e74 2c20  rtitions : int, 
+0000e580: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0000e590: 2020 2020 204e 756d 6265 7220 6f66 2070       Number of p
+0000e5a0: 6172 7469 7469 6f6e 7320 6f66 206f 7574  artitions of out
+0000e5b0: 7075 742e 2050 6172 7469 7469 6f6e 2063  put. Partition c
+0000e5c0: 6f75 6e74 2077 696c 6c20 6e6f 7420 6265  ount will not be
+0000e5d0: 0a20 2020 2020 2020 2020 2020 2063 6861  .            cha
+0000e5e0: 6e67 6564 2062 7920 6465 6661 756c 742e  nged by default.
+0000e5f0: 0a20 2020 2020 2020 206d 6178 5f62 7261  .        max_bra
+0000e600: 6e63 683a 2069 6e74 2c20 6f70 7469 6f6e  nch: int, option
+0000e610: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
+0000e620: 6865 206d 6178 696d 756d 206e 756d 6265  he maximum numbe
+0000e630: 7220 6f66 2073 706c 6974 7320 7065 7220  r of splits per 
+0000e640: 696e 7075 7420 7061 7274 6974 696f 6e2e  input partition.
+0000e650: 2055 7365 6420 7769 7468 696e 0a20 2020   Used within.   
+0000e660: 2020 2020 2020 2020 2074 6865 2073 7461           the sta
+0000e670: 6765 6420 7368 7566 666c 696e 6720 616c  ged shuffling al
+0000e680: 676f 7269 7468 6d2e 0a20 2020 2020 2020  gorithm..       
+0000e690: 2073 6875 6666 6c65 3a20 7b27 6469 736b   shuffle: {'disk
+0000e6a0: 272c 2027 7461 736b 7327 7d2c 206f 7074  ', 'tasks'}, opt
+0000e6b0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0000e6c0: 2020 4569 7468 6572 2060 6027 6469 736b    Either ``'disk
+0000e6d0: 2760 6020 666f 7220 7369 6e67 6c65 2d6e  '`` for single-n
+0000e6e0: 6f64 6520 6f70 6572 6174 696f 6e20 6f72  ode operation or
+0000e6f0: 2060 6027 7461 736b 7327 6060 2066 6f72   ``'tasks'`` for
+0000e700: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+0000e710: 7472 6962 7574 6564 206f 7065 7261 7469  tributed operati
+0000e720: 6f6e 2e20 2057 696c 6c20 6265 2069 6e66  on.  Will be inf
+0000e730: 6572 7265 6420 6279 2079 6f75 7220 6375  erred by your cu
+0000e740: 7272 656e 7420 7363 6865 6475 6c65 722e  rrent scheduler.
+0000e750: 0a20 2020 2020 2020 2069 676e 6f72 655f  .        ignore_
+0000e760: 696e 6465 783a 2062 6f6f 6c2c 2064 6566  index: bool, def
+0000e770: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
+0000e780: 2020 2020 2020 2049 676e 6f72 6520 696e         Ignore in
+0000e790: 6465 7820 6475 7269 6e67 2073 6875 6666  dex during shuff
+0000e7a0: 6c65 2e20 2049 6620 6060 5472 7565 6060  le.  If ``True``
+0000e7b0: 2c20 7065 7266 6f72 6d61 6e63 6520 6d61  , performance ma
+0000e7c0: 7920 696d 7072 6f76 652c 0a20 2020 2020  y improve,.     
+0000e7d0: 2020 2020 2020 2062 7574 2069 6e64 6578         but index
+0000e7e0: 2076 616c 7565 7320 7769 6c6c 206e 6f74   values will not
+0000e7f0: 2062 6520 7072 6573 6572 7665 642e 0a20   be preserved.. 
+0000e800: 2020 2020 2020 2063 6f6d 7075 7465 3a20         compute: 
+0000e810: 626f 6f6c 0a20 2020 2020 2020 2020 2020  bool.           
+0000e820: 2057 6865 7468 6572 206f 7220 6e6f 7420   Whether or not 
+0000e830: 746f 2074 7269 6767 6572 2061 6e20 696d  to trigger an im
+0000e840: 6d65 6469 6174 6520 636f 6d70 7574 6174  mediate computat
+0000e850: 696f 6e2e 2044 6566 6175 6c74 7320 746f  ion. Defaults to
+0000e860: 2046 616c 7365 2e0a 0a20 2020 2020 2020   False...       
+0000e870: 204e 6f74 6573 0a20 2020 2020 2020 202d   Notes.        -
+0000e880: 2d2d 2d2d 0a20 2020 2020 2020 2054 6869  ----.        Thi
+0000e890: 7320 646f 6573 206e 6f74 2070 7265 7365  s does not prese
+0000e8a0: 7276 6520 6120 6d65 616e 696e 6766 756c  rve a meaningful
+0000e8b0: 2069 6e64 6578 2f70 6172 7469 7469 6f6e   index/partition
+0000e8c0: 696e 6720 7363 6865 6d65 2e20 5468 6973  ing scheme. This
+0000e8d0: 0a20 2020 2020 2020 2069 7320 6e6f 7420  .        is not 
+0000e8e0: 6465 7465 726d 696e 6973 7469 6320 6966  deterministic if
+0000e8f0: 2064 6f6e 6520 696e 2070 6172 616c 6c65   done in paralle
+0000e900: 6c2e 0a0a 2020 2020 2020 2020 4578 616d  l...        Exam
+0000e910: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
+0000e920: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
+0000e930: 3e20 6466 203d 2064 662e 7368 7566 666c  > df = df.shuffl
+0000e940: 6528 6466 2e63 6f6c 756d 6e73 5b30 5d29  e(df.columns[0])
+0000e950: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+0000e960: 4950 0a20 2020 2020 2020 2022 2222 0a20  IP.        """. 
+0000e970: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+0000e980: 2e64 6174 6166 7261 6d65 2e73 6875 6666  .dataframe.shuff
+0000e990: 6c65 2069 6d70 6f72 7420 7368 7566 666c  le import shuffl
+0000e9a0: 6520 6173 2064 645f 7368 7566 666c 650a  e as dd_shuffle.
+0000e9b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000e9c0: 6464 5f73 6875 6666 6c65 280a 2020 2020  dd_shuffle(.    
+0000e9d0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000e9e0: 2020 2020 2020 2020 2020 6f6e 2c0a 2020            on,.  
+0000e9f0: 2020 2020 2020 2020 2020 6e70 6172 7469            nparti
+0000ea00: 7469 6f6e 733d 6e70 6172 7469 7469 6f6e  tions=npartition
+0000ea10: 732c 0a20 2020 2020 2020 2020 2020 206d  s,.            m
+0000ea20: 6178 5f62 7261 6e63 683d 6d61 785f 6272  ax_branch=max_br
+0000ea30: 616e 6368 2c0a 2020 2020 2020 2020 2020  anch,.          
+0000ea40: 2020 7368 7566 666c 653d 7368 7566 666c    shuffle=shuffl
+0000ea50: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
+0000ea60: 676e 6f72 655f 696e 6465 783d 6967 6e6f  gnore_index=igno
+0000ea70: 7265 5f69 6e64 6578 2c0a 2020 2020 2020  re_index,.      
+0000ea80: 2020 2020 2020 636f 6d70 7574 653d 636f        compute=co
+0000ea90: 6d70 7574 652c 0a20 2020 2020 2020 2029  mpute,.        )
+0000eaa0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+0000eab0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+0000eac0: 290a 2020 2020 6465 6620 6669 6c6c 6e61  ).    def fillna
+0000ead0: 2873 656c 662c 2076 616c 7565 3d4e 6f6e  (self, value=Non
+0000eae0: 652c 206d 6574 686f 643d 4e6f 6e65 2c20  e, method=None, 
+0000eaf0: 6c69 6d69 743d 4e6f 6e65 2c20 6178 6973  limit=None, axis
+0000eb00: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+0000eb10: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
+0000eb20: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
+0000eb30: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
+0000eb40: 6f64 2069 7320 4e6f 6e65 2061 6e64 206c  od is None and l
+0000eb50: 696d 6974 2069 7320 6e6f 7420 4e6f 6e65  imit is not None
+0000eb60: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000eb70: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+0000eb80: 6564 4572 726f 7228 2266 696c 6c6e 6120  edError("fillna 
+0000eb90: 7769 7468 2073 6574 206c 696d 6974 2061  with set limit a
+0000eba0: 6e64 206d 6574 686f 643d 4e6f 6e65 2229  nd method=None")
+0000ebb0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0000ebc0: 7374 616e 6365 2876 616c 7565 2c20 285f  stance(value, (_
+0000ebd0: 4672 616d 652c 2053 6361 6c61 7229 293a  Frame, Scalar)):
+0000ebe0: 0a20 2020 2020 2020 2020 2020 2074 6573  .            tes
+0000ebf0: 745f 7661 6c75 6520 3d20 7661 6c75 652e  t_value = value.
+0000ec00: 5f6d 6574 615f 6e6f 6e65 6d70 7479 0a20  _meta_nonempty. 
+0000ec10: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000ec20: 2020 2020 2020 2020 2074 6573 745f 7661           test_va
+0000ec30: 6c75 6520 3d20 7661 6c75 650a 2020 2020  lue = value.    
+0000ec40: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
+0000ec50: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e66  _meta_nonempty.f
+0000ec60: 696c 6c6e 6128 0a20 2020 2020 2020 2020  illna(.         
+0000ec70: 2020 2076 616c 7565 3d74 6573 745f 7661     value=test_va
+0000ec80: 6c75 652c 206d 6574 686f 643d 6d65 7468  lue, method=meth
+0000ec90: 6f64 2c20 6c69 6d69 743d 6c69 6d69 742c  od, limit=limit,
+0000eca0: 2061 7869 733d 6178 6973 0a20 2020 2020   axis=axis.     
+0000ecb0: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
+0000ecc0: 2061 7869 7320 3d3d 2031 206f 7220 6d65   axis == 1 or me
+0000ecd0: 7468 6f64 2069 7320 4e6f 6e65 3a0a 2020  thod is None:.  
+0000ece0: 2020 2020 2020 2020 2020 2320 436f 6e74            # Cont
+0000ecf0: 726f 6c20 7768 6574 6865 7220 6f72 206e  rol whether or n
+0000ed00: 6f74 2064 6173 6b27 7320 7061 7274 6974  ot dask's partit
+0000ed10: 696f 6e20 616c 6967 6e6d 656e 7420 6861  ion alignment ha
+0000ed20: 7070 656e 732e 0a20 2020 2020 2020 2020  ppens..         
+0000ed30: 2020 2023 2057 6520 646f 6e27 7420 7761     # We don't wa
+0000ed40: 6e74 2066 6f72 2061 2070 616e 6461 7320  nt for a pandas 
+0000ed50: 5365 7269 6573 2e0a 2020 2020 2020 2020  Series..        
+0000ed60: 2020 2020 2320 5765 2064 6f20 7761 6e74      # We do want
+0000ed70: 2069 7420 666f 7220 6120 6461 736b 2053   it for a dask S
+0000ed80: 6572 6965 730a 2020 2020 2020 2020 2020  eries.          
+0000ed90: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
+0000eda0: 696b 6528 7661 6c75 6529 2061 6e64 206e  ike(value) and n
+0000edb0: 6f74 2069 735f 6461 736b 5f63 6f6c 6c65  ot is_dask_colle
+0000edc0: 6374 696f 6e28 7661 6c75 6529 3a0a 2020  ction(value):.  
+0000edd0: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+0000ede0: 6773 203d 2028 290a 2020 2020 2020 2020  gs = ().        
+0000edf0: 2020 2020 2020 2020 6b77 6172 6773 203d          kwargs =
+0000ee00: 207b 2276 616c 7565 223a 2076 616c 7565   {"value": value
+0000ee10: 7d0a 2020 2020 2020 2020 2020 2020 656c  }.            el
+0000ee20: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000ee30: 2020 2020 6172 6773 203d 2028 7661 6c75      args = (valu
+0000ee40: 652c 290a 2020 2020 2020 2020 2020 2020  e,).            
+0000ee50: 2020 2020 6b77 6172 6773 203d 207b 7d0a      kwargs = {}.
+0000ee60: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000ee70: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+0000ee80: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+0000ee90: 2020 2020 2020 2020 4d2e 6669 6c6c 6e61          M.fillna
+0000eea0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000eeb0: 2020 2a61 7267 732c 0a20 2020 2020 2020    *args,.       
+0000eec0: 2020 2020 2020 2020 206d 6574 686f 643d           method=
+0000eed0: 6d65 7468 6f64 2c0a 2020 2020 2020 2020  method,.        
+0000eee0: 2020 2020 2020 2020 6c69 6d69 743d 6c69          limit=li
+0000eef0: 6d69 742c 0a20 2020 2020 2020 2020 2020  mit,.           
+0000ef00: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
+0000ef10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ef20: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
+0000ef30: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
+0000ef40: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+0000ef50: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0000ef60: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
+0000ef70: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0000ef80: 2020 2020 6966 206d 6574 686f 6420 696e      if method in
+0000ef90: 2028 2270 6164 222c 2022 6666 696c 6c22   ("pad", "ffill"
+0000efa0: 293a 0a20 2020 2020 2020 2020 2020 206d  ):.            m
+0000efb0: 6574 686f 6420 3d20 2266 6669 6c6c 220a  ethod = "ffill".
+0000efc0: 2020 2020 2020 2020 2020 2020 736b 6970              skip
+0000efd0: 5f63 6865 636b 203d 2030 0a20 2020 2020  _check = 0.     
+0000efe0: 2020 2020 2020 2062 6566 6f72 652c 2061         before, a
+0000eff0: 6674 6572 203d 2031 2069 6620 6c69 6d69  fter = 1 if limi
+0000f000: 7420 6973 204e 6f6e 6520 656c 7365 206c  t is None else l
+0000f010: 696d 6974 2c20 300a 2020 2020 2020 2020  imit, 0.        
+0000f020: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000f030: 2020 6d65 7468 6f64 203d 2022 6266 696c    method = "bfil
+0000f040: 6c22 0a20 2020 2020 2020 2020 2020 2073  l".            s
+0000f050: 6b69 705f 6368 6563 6b20 3d20 7365 6c66  kip_check = self
+0000f060: 2e6e 7061 7274 6974 696f 6e73 202d 2031  .npartitions - 1
+0000f070: 0a20 2020 2020 2020 2020 2020 2062 6566  .            bef
+0000f080: 6f72 652c 2061 6674 6572 203d 2030 2c20  ore, after = 0, 
+0000f090: 3120 6966 206c 696d 6974 2069 7320 4e6f  1 if limit is No
+0000f0a0: 6e65 2065 6c73 6520 6c69 6d69 740a 0a20  ne else limit.. 
+0000f0b0: 2020 2020 2020 2069 6620 6c69 6d69 7420         if limit 
+0000f0c0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0000f0d0: 2020 2020 206e 616d 6520 3d20 2266 696c       name = "fil
+0000f0e0: 6c6e 612d 6368 756e 6b2d 2220 2b20 746f  lna-chunk-" + to
+0000f0f0: 6b65 6e69 7a65 2873 656c 662c 206d 6574  kenize(self, met
+0000f100: 686f 6429 0a20 2020 2020 2020 2020 2020  hod).           
+0000f110: 2064 736b 203d 207b 0a20 2020 2020 2020   dsk = {.       
+0000f120: 2020 2020 2020 2020 2028 6e61 6d65 2c20           (name, 
+0000f130: 6929 3a20 280a 2020 2020 2020 2020 2020  i): (.          
+0000f140: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+0000f150: 732e 6669 6c6c 6e61 5f63 6865 636b 2c0a  s.fillna_check,.
+0000f160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f170: 2020 2020 2873 656c 662e 5f6e 616d 652c      (self._name,
+0000f180: 2069 292c 0a20 2020 2020 2020 2020 2020   i),.           
+0000f190: 2020 2020 2020 2020 206d 6574 686f 642c           method,
+0000f1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f1b0: 2020 2020 2069 2021 3d20 736b 6970 5f63       i != skip_c
+0000f1c0: 6865 636b 2c0a 2020 2020 2020 2020 2020  heck,.          
+0000f1d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000f1e0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+0000f1f0: 2072 616e 6765 2873 656c 662e 6e70 6172   range(self.npar
+0000f200: 7469 7469 6f6e 7329 0a20 2020 2020 2020  titions).       
+0000f210: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+0000f220: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+0000f230: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+0000f240: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
+0000f250: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+0000f260: 6573 3d5b 7365 6c66 5d29 0a20 2020 2020  es=[self]).     
+0000f270: 2020 2020 2020 2070 6172 7473 203d 206e         parts = n
+0000f280: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
+0000f290: 7068 2c20 6e61 6d65 2c20 6d65 7461 2c20  ph, name, meta, 
+0000f2a0: 7365 6c66 2e64 6976 6973 696f 6e73 290a  self.divisions).
+0000f2b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000f2c0: 2020 2020 2020 2020 2020 7061 7274 7320            parts 
+0000f2d0: 3d20 7365 6c66 0a0a 2020 2020 2020 2020  = self..        
+0000f2e0: 7265 7475 726e 2070 6172 7473 2e6d 6170  return parts.map
+0000f2f0: 5f6f 7665 726c 6170 280a 2020 2020 2020  _overlap(.      
+0000f300: 2020 2020 2020 4d2e 6669 6c6c 6e61 2c20        M.fillna, 
+0000f310: 6265 666f 7265 2c20 6166 7465 722c 206d  before, after, m
+0000f320: 6574 686f 643d 6d65 7468 6f64 2c20 6c69  ethod=method, li
+0000f330: 6d69 743d 6c69 6d69 742c 206d 6574 613d  mit=limit, meta=
+0000f340: 6d65 7461 0a20 2020 2020 2020 2029 0a0a  meta.        )..
+0000f350: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+0000f360: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+0000f370: 2020 2020 6465 6620 6666 696c 6c28 7365      def ffill(se
+0000f380: 6c66 2c20 6178 6973 3d4e 6f6e 652c 206c  lf, axis=None, l
+0000f390: 696d 6974 3d4e 6f6e 6529 3a0a 2020 2020  imit=None):.    
+0000f3a0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000f3b0: 6669 6c6c 6e61 286d 6574 686f 643d 2266  fillna(method="f
+0000f3c0: 6669 6c6c 222c 206c 696d 6974 3d6c 696d  fill", limit=lim
+0000f3d0: 6974 2c20 6178 6973 3d61 7869 7329 0a0a  it, axis=axis)..
+0000f3e0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+0000f3f0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+0000f400: 2020 2020 6465 6620 6266 696c 6c28 7365      def bfill(se
+0000f410: 6c66 2c20 6178 6973 3d4e 6f6e 652c 206c  lf, axis=None, l
+0000f420: 696d 6974 3d4e 6f6e 6529 3a0a 2020 2020  imit=None):.    
+0000f430: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000f440: 6669 6c6c 6e61 286d 6574 686f 643d 2262  fillna(method="b
+0000f450: 6669 6c6c 222c 206c 696d 6974 3d6c 696d  fill", limit=lim
+0000f460: 6974 2c20 6178 6973 3d61 7869 7329 0a0a  it, axis=axis)..
+0000f470: 2020 2020 6465 6620 7361 6d70 6c65 2873      def sample(s
+0000f480: 656c 662c 206e 3d4e 6f6e 652c 2066 7261  elf, n=None, fra
+0000f490: 633d 4e6f 6e65 2c20 7265 706c 6163 653d  c=None, replace=
+0000f4a0: 4661 6c73 652c 2072 616e 646f 6d5f 7374  False, random_st
+0000f4b0: 6174 653d 4e6f 6e65 293a 0a20 2020 2020  ate=None):.     
+0000f4c0: 2020 2022 2222 5261 6e64 6f6d 2073 616d     """Random sam
+0000f4d0: 706c 6520 6f66 2069 7465 6d73 0a0a 2020  ple of items..  
+0000f4e0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0000f4f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000f500: 2d2d 2d0a 2020 2020 2020 2020 6e20 3a20  ---.        n : 
+0000f510: 696e 742c 206f 7074 696f 6e61 6c0a 2020  int, optional.  
+0000f520: 2020 2020 2020 2020 2020 4e75 6d62 6572            Number
+0000f530: 206f 6620 6974 656d 7320 746f 2072 6574   of items to ret
+0000f540: 7572 6e20 6973 206e 6f74 2073 7570 706f  urn is not suppo
+0000f550: 7274 6564 2062 7920 6461 736b 2e20 5573  rted by dask. Us
+0000f560: 6520 6672 6163 0a20 2020 2020 2020 2020  e frac.         
+0000f570: 2020 2069 6e73 7465 6164 2e0a 2020 2020     instead..    
+0000f580: 2020 2020 6672 6163 203a 2066 6c6f 6174      frac : float
+0000f590: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0000f5a0: 2020 2020 2020 2041 7070 726f 7869 6d61         Approxima
+0000f5b0: 7465 2066 7261 6374 696f 6e20 6f66 2069  te fraction of i
+0000f5c0: 7465 6d73 2074 6f20 7265 7475 726e 2e20  tems to return. 
+0000f5d0: 5468 6973 2073 616d 706c 696e 6720 6672  This sampling fr
+0000f5e0: 6163 7469 6f6e 2069 730a 2020 2020 2020  action is.      
+0000f5f0: 2020 2020 2020 6170 706c 6965 6420 746f        applied to
+0000f600: 2061 6c6c 2070 6172 7469 7469 6f6e 7320   all partitions 
+0000f610: 6571 7561 6c6c 792e 204e 6f74 6520 7468  equally. Note th
+0000f620: 6174 2074 6869 7320 6973 2061 6e0a 2020  at this is an.  
+0000f630: 2020 2020 2020 2020 2020 2a2a 6170 7072            **appr
+0000f640: 6f78 696d 6174 6520 6672 6163 7469 6f6e  oximate fraction
+0000f650: 2a2a 2e20 596f 7520 7368 6f75 6c64 206e  **. You should n
+0000f660: 6f74 2065 7870 6563 7420 6578 6163 746c  ot expect exactl
+0000f670: 7920 6060 6c65 6e28 6466 2920 2a20 6672  y ``len(df) * fr
+0000f680: 6163 6060 0a20 2020 2020 2020 2020 2020  ac``.           
+0000f690: 2069 7465 6d73 2074 6f20 6265 2072 6574   items to be ret
+0000f6a0: 7572 6e65 642c 2061 7320 7468 6520 6578  urned, as the ex
+0000f6b0: 6163 7420 6e75 6d62 6572 206f 6620 656c  act number of el
+0000f6c0: 656d 656e 7473 2073 656c 6563 7465 6420  ements selected 
+0000f6d0: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
+0000f6e0: 2064 6570 656e 6420 6f6e 2068 6f77 2079   depend on how y
+0000f6f0: 6f75 7220 6461 7461 2069 7320 7061 7274  our data is part
+0000f700: 6974 696f 6e65 6420 2862 7574 2073 686f  itioned (but sho
+0000f710: 756c 6420 6265 2070 7265 7474 7920 636c  uld be pretty cl
+0000f720: 6f73 650a 2020 2020 2020 2020 2020 2020  ose.            
+0000f730: 696e 2070 7261 6374 6963 6529 2e0a 2020  in practice)..  
+0000f740: 2020 2020 2020 7265 706c 6163 6520 3a20        replace : 
+0000f750: 626f 6f6c 6561 6e2c 206f 7074 696f 6e61  boolean, optiona
+0000f760: 6c0a 2020 2020 2020 2020 2020 2020 5361  l.            Sa
+0000f770: 6d70 6c65 2077 6974 6820 6f72 2077 6974  mple with or wit
+0000f780: 686f 7574 2072 6570 6c61 6365 6d65 6e74  hout replacement
+0000f790: 2e20 4465 6661 756c 7420 3d20 4661 6c73  . Default = Fals
+0000f7a0: 652e 0a20 2020 2020 2020 2072 616e 646f  e..        rando
+0000f7b0: 6d5f 7374 6174 6520 3a20 696e 7420 6f72  m_state : int or
+0000f7c0: 2060 606e 702e 7261 6e64 6f6d 2e52 616e   ``np.random.Ran
+0000f7d0: 646f 6d53 7461 7465 6060 0a20 2020 2020  domState``.     
+0000f7e0: 2020 2020 2020 2049 6620 616e 2069 6e74         If an int
+0000f7f0: 2c20 7765 2063 7265 6174 6520 6120 6e65  , we create a ne
+0000f800: 7720 5261 6e64 6f6d 5374 6174 6520 7769  w RandomState wi
+0000f810: 7468 2074 6869 7320 6173 2074 6865 2073  th this as the s
+0000f820: 6565 643b 0a20 2020 2020 2020 2020 2020  eed;.           
+0000f830: 204f 7468 6572 7769 7365 2077 6520 6472   Otherwise we dr
+0000f840: 6177 2066 726f 6d20 7468 6520 7061 7373  aw from the pass
+0000f850: 6564 2052 616e 646f 6d53 7461 7465 2e0a  ed RandomState..
+0000f860: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
+0000f870: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
+0000f880: 2d2d 0a20 2020 2020 2020 2044 6174 6146  --.        DataF
+0000f890: 7261 6d65 2e72 616e 646f 6d5f 7370 6c69  rame.random_spli
+0000f8a0: 740a 2020 2020 2020 2020 7061 6e64 6173  t.        pandas
+0000f8b0: 2e44 6174 6146 7261 6d65 2e73 616d 706c  .DataFrame.sampl
+0000f8c0: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
+0000f8d0: 2020 2020 2020 6966 206e 2069 7320 6e6f        if n is no
+0000f8e0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0000f8f0: 2020 2020 6d73 6720 3d20 280a 2020 2020      msg = (.    
+0000f900: 2020 2020 2020 2020 2020 2020 2273 616d              "sam
+0000f910: 706c 6520 646f 6573 206e 6f74 2073 7570  ple does not sup
+0000f920: 706f 7274 2074 6865 206e 756d 6265 7220  port the number 
+0000f930: 6f66 2073 616d 706c 6564 2069 7465 6d73  of sampled items
+0000f940: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0000f950: 2020 2022 7061 7261 6d65 7465 722c 2027     "parameter, '
+0000f960: 6e27 2e20 506c 6561 7365 2075 7365 2074  n'. Please use t
+0000f970: 6865 2027 6672 6163 2720 7061 7261 6d65  he 'frac' parame
+0000f980: 7465 7220 696e 7374 6561 642e 220a 2020  ter instead.".  
+0000f990: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000f9a0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0000f9b0: 7461 6e63 6528 6e2c 204e 756d 6265 7229  tance(n, Number)
+0000f9c0: 2061 6e64 2030 203c 3d20 6e20 3c3d 2031   and 0 <= n <= 1
+0000f9d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000f9e0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+0000f9f0: 6d73 6729 0a20 2020 2020 2020 2020 2020  msg).           
+0000fa00: 2020 2020 2066 7261 6320 3d20 6e0a 2020       frac = n.  
+0000fa10: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0000fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa30: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0000fa40: 286d 7367 290a 0a20 2020 2020 2020 2069  (msg)..        i
+0000fa50: 6620 6672 6163 2069 7320 4e6f 6e65 3a0a  f frac is None:.
+0000fa60: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000fa70: 6520 5661 6c75 6545 7272 6f72 2822 6672  e ValueError("fr
+0000fa80: 6163 206d 7573 7420 6e6f 7420 6265 204e  ac must not be N
+0000fa90: 6f6e 6522 290a 0a20 2020 2020 2020 2069  one")..        i
+0000faa0: 6620 7261 6e64 6f6d 5f73 7461 7465 2069  f random_state i
+0000fab0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0000fac0: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
+0000fad0: 203d 206e 702e 7261 6e64 6f6d 2e52 616e   = np.random.Ran
+0000fae0: 646f 6d53 7461 7465 2829 0a0a 2020 2020  domState()..    
+0000faf0: 2020 2020 6e61 6d65 203d 2022 7361 6d70      name = "samp
+0000fb00: 6c65 2d22 202b 2074 6f6b 656e 697a 6528  le-" + tokenize(
+0000fb10: 7365 6c66 2c20 6672 6163 2c20 7265 706c  self, frac, repl
+0000fb20: 6163 652c 2072 616e 646f 6d5f 7374 6174  ace, random_stat
+0000fb30: 6529 0a0a 2020 2020 2020 2020 7374 6174  e)..        stat
+0000fb40: 655f 6461 7461 203d 2072 616e 646f 6d5f  e_data = random_
+0000fb50: 7374 6174 655f 6461 7461 2873 656c 662e  state_data(self.
+0000fb60: 6e70 6172 7469 7469 6f6e 732c 2072 616e  npartitions, ran
+0000fb70: 646f 6d5f 7374 6174 6529 0a20 2020 2020  dom_state).     
+0000fb80: 2020 2064 736b 203d 207b 0a20 2020 2020     dsk = {.     
+0000fb90: 2020 2020 2020 2028 6e61 6d65 2c20 6929         (name, i)
+0000fba0: 3a20 286d 6574 686f 6473 2e73 616d 706c  : (methods.sampl
+0000fbb0: 652c 2028 7365 6c66 2e5f 6e61 6d65 2c20  e, (self._name, 
+0000fbc0: 6929 2c20 7374 6174 652c 2066 7261 632c  i), state, frac,
+0000fbd0: 2072 6570 6c61 6365 290a 2020 2020 2020   replace).      
+0000fbe0: 2020 2020 2020 666f 7220 692c 2073 7461        for i, sta
+0000fbf0: 7465 2069 6e20 656e 756d 6572 6174 6528  te in enumerate(
+0000fc00: 7374 6174 655f 6461 7461 290a 2020 2020  state_data).    
+0000fc10: 2020 2020 7d0a 0a20 2020 2020 2020 2067      }..        g
+0000fc20: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
+0000fc30: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+0000fc40: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
+0000fc50: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
+0000fc60: 7365 6c66 5d29 0a20 2020 2020 2020 2072  self]).        r
+0000fc70: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
+0000fc80: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
+0000fc90: 2073 656c 662e 5f6d 6574 612c 2073 656c   self._meta, sel
+0000fca0: 662e 6469 7669 7369 6f6e 7329 0a0a 2020  f.divisions)..  
+0000fcb0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+0000fcc0: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+0000fcd0: 2020 6465 6620 7265 706c 6163 6528 7365    def replace(se
+0000fce0: 6c66 2c20 746f 5f72 6570 6c61 6365 3d4e  lf, to_replace=N
+0000fcf0: 6f6e 652c 2076 616c 7565 3d4e 6f6e 652c  one, value=None,
+0000fd00: 2072 6567 6578 3d46 616c 7365 293a 0a20   regex=False):. 
+0000fd10: 2020 2020 2020 2023 2049 6e20 5041 4e44         # In PAND
+0000fd20: 4153 5f47 545f 3134 3020 7061 6e64 6173  AS_GT_140 pandas
+0000fd30: 2073 7461 7274 7320 7573 696e 6720 6e6f   starts using no
+0000fd40: 5f64 6566 6175 6c74 2069 6e73 7465 6164  _default instead
+0000fd50: 206f 6620 4e6f 6e65 0a20 2020 2020 2020   of None.       
+0000fd60: 2076 616c 7565 5f6b 7761 7267 203d 207b   value_kwarg = {
+0000fd70: 2276 616c 7565 223a 2076 616c 7565 7d20  "value": value} 
+0000fd80: 6966 2076 616c 7565 2069 7320 6e6f 7420  if value is not 
+0000fd90: 4e6f 6e65 2065 6c73 6520 7b7d 0a20 2020  None else {}.   
+0000fda0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000fdb0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+0000fdc0: 0a20 2020 2020 2020 2020 2020 204d 2e72  .            M.r
+0000fdd0: 6570 6c61 6365 2c0a 2020 2020 2020 2020  eplace,.        
+0000fde0: 2020 2020 746f 5f72 6570 6c61 6365 3d74      to_replace=t
+0000fdf0: 6f5f 7265 706c 6163 652c 0a20 2020 2020  o_replace,.     
+0000fe00: 2020 2020 2020 202a 2a76 616c 7565 5f6b         **value_k
+0000fe10: 7761 7267 2c0a 2020 2020 2020 2020 2020  warg,.          
+0000fe20: 2020 7265 6765 783d 7265 6765 782c 0a20    regex=regex,. 
+0000fe30: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
+0000fe40: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+0000fe50: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
+0000fe60: 2020 6465 6620 746f 5f64 6173 6b5f 6172    def to_dask_ar
+0000fe70: 7261 7928 7365 6c66 2c20 6c65 6e67 7468  ray(self, length
+0000fe80: 733d 4e6f 6e65 2c20 6d65 7461 3d4e 6f6e  s=None, meta=Non
+0000fe90: 6529 3a0a 2020 2020 2020 2020 2222 2243  e):.        """C
+0000fea0: 6f6e 7665 7274 2061 2064 6173 6b20 4461  onvert a dask Da
+0000feb0: 7461 4672 616d 6520 746f 2061 2064 6173  taFrame to a das
+0000fec0: 6b20 6172 7261 792e 0a0a 2020 2020 2020  k array...      
+0000fed0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0000fee0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+0000fef0: 2020 2020 2020 2020 6c65 6e67 7468 7320          lengths 
+0000ff00: 3a20 626f 6f6c 206f 7220 5365 7175 656e  : bool or Sequen
+0000ff10: 6365 206f 6620 696e 7473 2c20 6f70 7469  ce of ints, opti
+0000ff20: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+0000ff30: 2048 6f77 2074 6f20 6465 7465 726d 696e   How to determin
+0000ff40: 6520 7468 6520 6368 756e 6b73 2073 697a  e the chunks siz
+0000ff50: 6573 2066 6f72 2074 6865 206f 7574 7075  es for the outpu
+0000ff60: 7420 6172 7261 792e 0a20 2020 2020 2020  t array..       
+0000ff70: 2020 2020 2042 7920 6465 6661 756c 742c       By default,
+0000ff80: 2074 6865 206f 7574 7075 7420 6172 7261   the output arra
+0000ff90: 7920 7769 6c6c 2068 6176 6520 756e 6b6e  y will have unkn
+0000ffa0: 6f77 6e20 6368 756e 6b20 6c65 6e67 7468  own chunk length
+0000ffb0: 730a 2020 2020 2020 2020 2020 2020 616c  s.            al
+0000ffc0: 6f6e 6720 7468 6520 6669 7273 7420 6178  ong the first ax
+0000ffd0: 6973 2c20 7768 6963 6820 6361 6e20 6361  is, which can ca
+0000ffe0: 7573 6520 736f 6d65 206c 6174 6572 206f  use some later o
+0000fff0: 7065 7261 7469 6f6e 730a 2020 2020 2020  perations.      
+00010000: 2020 2020 2020 746f 2066 6169 6c2e 0a0a        to fail...
+00010010: 2020 2020 2020 2020 2020 2020 2a20 5472              * Tr
+00010020: 7565 203a 2069 6d6d 6564 6961 7465 6c79  ue : immediately
+00010030: 2063 6f6d 7075 7465 2074 6865 206c 656e   compute the len
+00010040: 6774 6820 6f66 2065 6163 6820 7061 7274  gth of each part
+00010050: 6974 696f 6e0a 2020 2020 2020 2020 2020  ition.          
+00010060: 2020 2a20 5365 7175 656e 6365 203a 2061    * Sequence : a
+00010070: 2073 6571 7565 6e63 6520 6f66 2069 6e74   sequence of int
+00010080: 6567 6572 7320 746f 2075 7365 2066 6f72  egers to use for
+00010090: 2074 6865 2063 6875 6e6b 2073 697a 6573   the chunk sizes
+000100a0: 0a20 2020 2020 2020 2020 2020 2020 206f  .              o
+000100b0: 6e20 7468 6520 6669 7273 7420 6178 6973  n the first axis
+000100c0: 2e20 5468 6573 6520 7661 6c75 6573 2061  . These values a
+000100d0: 7265 202a 6e6f 742a 2076 616c 6964 6174  re *not* validat
+000100e0: 6564 2066 6f72 0a20 2020 2020 2020 2020  ed for.         
+000100f0: 2020 2020 2063 6f72 7265 6374 6e65 7373       correctness
+00010100: 2c20 6265 796f 6e64 2065 6e73 7572 696e  , beyond ensurin
+00010110: 6720 7468 6174 2074 6865 206e 756d 6265  g that the numbe
+00010120: 7220 6f66 2069 7465 6d73 0a20 2020 2020  r of items.     
+00010130: 2020 2020 2020 2020 206d 6174 6368 6573           matches
+00010140: 2074 6865 206e 756d 6265 7220 6f66 2070   the number of p
+00010150: 6172 7469 7469 6f6e 732e 0a20 2020 2020  artitions..     
+00010160: 2020 206d 6574 6120 3a20 6f62 6a65 6374     meta : object
+00010170: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00010180: 2020 2020 2020 2041 6e20 6f70 7469 6f6e         An option
+00010190: 616c 2060 6d65 7461 6020 7061 7261 6d65  al `meta` parame
+000101a0: 7465 7220 6361 6e20 6265 2070 6173 7365  ter can be passe
+000101b0: 6420 666f 7220 6461 736b 2074 6f20 6f76  d for dask to ov
+000101c0: 6572 7269 6465 2074 6865 0a20 2020 2020  erride the.     
+000101d0: 2020 2020 2020 2064 6566 6175 6c74 206d         default m
+000101e0: 6574 6164 6174 6120 6f6e 2074 6865 2075  etadata on the u
+000101f0: 6e64 6572 6c79 696e 6720 6461 736b 2061  nderlying dask a
+00010200: 7272 6179 2e0a 0a20 2020 2020 2020 2052  rray...        R
+00010210: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+00010220: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2022  ------.        "
+00010230: 2222 0a20 2020 2020 2020 2069 6620 6c65  "".        if le
+00010240: 6e67 7468 7320 6973 2054 7275 653a 0a20  ngths is True:. 
+00010250: 2020 2020 2020 2020 2020 206c 656e 6774             lengt
+00010260: 6873 203d 2074 7570 6c65 2873 656c 662e  hs = tuple(self.
+00010270: 6d61 705f 7061 7274 6974 696f 6e73 286c  map_partitions(l
+00010280: 656e 2c20 656e 666f 7263 655f 6d65 7461  en, enforce_meta
+00010290: 6461 7461 3d46 616c 7365 292e 636f 6d70  data=False).comp
+000102a0: 7574 6528 2929 0a0a 2020 2020 2020 2020  ute())..        
+000102b0: 6172 7220 3d20 7365 6c66 2e76 616c 7565  arr = self.value
+000102c0: 730a 0a20 2020 2020 2020 2063 6875 6e6b  s..        chunk
+000102d0: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
+000102e0: 7465 5f63 6875 6e6b 7328 6172 722c 206c  te_chunks(arr, l
+000102f0: 656e 6774 6873 290a 2020 2020 2020 2020  engths).        
+00010300: 6172 722e 5f63 6875 6e6b 7320 3d20 6368  arr._chunks = ch
+00010310: 756e 6b73 0a0a 2020 2020 2020 2020 6966  unks..        if
+00010320: 206d 6574 6120 6973 206e 6f74 204e 6f6e   meta is not Non
+00010330: 653a 0a20 2020 2020 2020 2020 2020 2061  e:.            a
+00010340: 7272 2e5f 6d65 7461 203d 206d 6574 610a  rr._meta = meta.
+00010350: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00010360: 6172 720a 0a20 2020 2064 6566 2074 6f5f  arr..    def to_
+00010370: 6864 6628 7365 6c66 2c20 7061 7468 5f6f  hdf(self, path_o
+00010380: 725f 6275 662c 206b 6579 2c20 6d6f 6465  r_buf, key, mode
+00010390: 3d22 6122 2c20 6170 7065 6e64 3d46 616c  ="a", append=Fal
+000103a0: 7365 2c20 2a2a 6b77 6172 6773 293a 0a20  se, **kwargs):. 
+000103b0: 2020 2020 2020 2022 2222 5365 6520 6464         """See dd
+000103c0: 2e74 6f5f 6864 6620 646f 6373 7472 696e  .to_hdf docstrin
+000103d0: 6720 666f 7220 6d6f 7265 2069 6e66 6f72  g for more infor
+000103e0: 6d61 7469 6f6e 2222 220a 2020 2020 2020  mation""".      
+000103f0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+00010400: 6672 616d 652e 696f 2069 6d70 6f72 7420  frame.io import 
+00010410: 746f 5f68 6466 0a0a 2020 2020 2020 2020  to_hdf..        
+00010420: 7265 7475 726e 2074 6f5f 6864 6628 7365  return to_hdf(se
+00010430: 6c66 2c20 7061 7468 5f6f 725f 6275 662c  lf, path_or_buf,
+00010440: 206b 6579 2c20 6d6f 6465 2c20 6170 7065   key, mode, appe
+00010450: 6e64 2c20 2a2a 6b77 6172 6773 290a 0a20  nd, **kwargs).. 
+00010460: 2020 2064 6566 2074 6f5f 6373 7628 7365     def to_csv(se
+00010470: 6c66 2c20 6669 6c65 6e61 6d65 2c20 2a2a  lf, filename, **
+00010480: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+00010490: 2022 2222 5365 6520 6464 2e74 6f5f 6373   """See dd.to_cs
+000104a0: 7620 646f 6373 7472 696e 6720 666f 7220  v docstring for 
+000104b0: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
+000104c0: 2222 220a 2020 2020 2020 2020 6672 6f6d  """.        from
+000104d0: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+000104e0: 696f 2069 6d70 6f72 7420 746f 5f63 7376  io import to_csv
+000104f0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00010500: 2074 6f5f 6373 7628 7365 6c66 2c20 6669   to_csv(self, fi
+00010510: 6c65 6e61 6d65 2c20 2a2a 6b77 6172 6773  lename, **kwargs
+00010520: 290a 0a20 2020 2064 6566 2074 6f5f 7371  )..    def to_sq
+00010530: 6c28 0a20 2020 2020 2020 2073 656c 662c  l(.        self,
+00010540: 0a20 2020 2020 2020 206e 616d 653a 2073  .        name: s
+00010550: 7472 2c0a 2020 2020 2020 2020 7572 693a  tr,.        uri:
+00010560: 2073 7472 2c0a 2020 2020 2020 2020 7363   str,.        sc
+00010570: 6865 6d61 3d4e 6f6e 652c 0a20 2020 2020  hema=None,.     
+00010580: 2020 2069 665f 6578 6973 7473 3a20 7374     if_exists: st
+00010590: 7220 3d20 2266 6169 6c22 2c0a 2020 2020  r = "fail",.    
+000105a0: 2020 2020 696e 6465 783a 2062 6f6f 6c20      index: bool 
+000105b0: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
+000105c0: 696e 6465 785f 6c61 6265 6c3d 4e6f 6e65  index_label=None
+000105d0: 2c0a 2020 2020 2020 2020 6368 756e 6b73  ,.        chunks
+000105e0: 697a 653d 4e6f 6e65 2c0a 2020 2020 2020  ize=None,.      
+000105f0: 2020 6474 7970 653d 4e6f 6e65 2c0a 2020    dtype=None,.  
+00010600: 2020 2020 2020 6d65 7468 6f64 3d4e 6f6e        method=Non
+00010610: 652c 0a20 2020 2020 2020 2063 6f6d 7075  e,.        compu
+00010620: 7465 3d54 7275 652c 0a20 2020 2020 2020  te=True,.       
+00010630: 2070 6172 616c 6c65 6c3d 4661 6c73 652c   parallel=False,
+00010640: 0a20 2020 2020 2020 2065 6e67 696e 655f  .        engine_
+00010650: 6b77 6172 6773 3d4e 6f6e 652c 0a20 2020  kwargs=None,.   
+00010660: 2029 3a0a 2020 2020 2020 2020 2222 2253   ):.        """S
+00010670: 6565 2064 642e 746f 5f73 716c 2064 6f63  ee dd.to_sql doc
+00010680: 7374 7269 6e67 2066 6f72 206d 6f72 6520  string for more 
+00010690: 696e 666f 726d 6174 696f 6e22 2222 0a20  information""". 
+000106a0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+000106b0: 2e64 6174 6166 7261 6d65 2e69 6f20 696d  .dataframe.io im
+000106c0: 706f 7274 2074 6f5f 7371 6c0a 0a20 2020  port to_sql..   
+000106d0: 2020 2020 2072 6574 7572 6e20 746f 5f73       return to_s
+000106e0: 716c 280a 2020 2020 2020 2020 2020 2020  ql(.            
+000106f0: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+00010700: 2020 6e61 6d65 3d6e 616d 652c 0a20 2020    name=name,.   
+00010710: 2020 2020 2020 2020 2075 7269 3d75 7269           uri=uri
+00010720: 2c0a 2020 2020 2020 2020 2020 2020 7363  ,.            sc
+00010730: 6865 6d61 3d73 6368 656d 612c 0a20 2020  hema=schema,.   
+00010740: 2020 2020 2020 2020 2069 665f 6578 6973           if_exis
+00010750: 7473 3d69 665f 6578 6973 7473 2c0a 2020  ts=if_exists,.  
+00010760: 2020 2020 2020 2020 2020 696e 6465 783d            index=
+00010770: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
+00010780: 2020 2069 6e64 6578 5f6c 6162 656c 3d69     index_label=i
+00010790: 6e64 6578 5f6c 6162 656c 2c0a 2020 2020  ndex_label,.    
+000107a0: 2020 2020 2020 2020 6368 756e 6b73 697a          chunksiz
+000107b0: 653d 6368 756e 6b73 697a 652c 0a20 2020  e=chunksize,.   
+000107c0: 2020 2020 2020 2020 2064 7479 7065 3d64           dtype=d
+000107d0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+000107e0: 2020 6d65 7468 6f64 3d6d 6574 686f 642c    method=method,
+000107f0: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
+00010800: 7075 7465 3d63 6f6d 7075 7465 2c0a 2020  pute=compute,.  
+00010810: 2020 2020 2020 2020 2020 7061 7261 6c6c            parall
+00010820: 656c 3d70 6172 616c 6c65 6c2c 0a20 2020  el=parallel,.   
+00010830: 2020 2020 2020 2020 2065 6e67 696e 655f           engine_
+00010840: 6b77 6172 6773 3d65 6e67 696e 655f 6b77  kwargs=engine_kw
+00010850: 6172 6773 2c0a 2020 2020 2020 2020 290a  args,.        ).
+00010860: 0a20 2020 2064 6566 2074 6f5f 6a73 6f6e  .    def to_json
+00010870: 2873 656c 662c 2066 696c 656e 616d 652c  (self, filename,
+00010880: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+00010890: 293a 0a20 2020 2020 2020 2022 2222 5365  ):.        """Se
+000108a0: 6520 6464 2e74 6f5f 6a73 6f6e 2064 6f63  e dd.to_json doc
+000108b0: 7374 7269 6e67 2066 6f72 206d 6f72 6520  string for more 
+000108c0: 696e 666f 726d 6174 696f 6e22 2222 0a20  information""". 
+000108d0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+000108e0: 2e64 6174 6166 7261 6d65 2e69 6f20 696d  .dataframe.io im
+000108f0: 706f 7274 2074 6f5f 6a73 6f6e 0a0a 2020  port to_json..  
+00010900: 2020 2020 2020 7265 7475 726e 2074 6f5f        return to_
+00010910: 6a73 6f6e 2873 656c 662c 2066 696c 656e  json(self, filen
+00010920: 616d 652c 202a 6172 6773 2c20 2a2a 6b77  ame, *args, **kw
+00010930: 6172 6773 290a 0a20 2020 2064 6566 2074  args)..    def t
+00010940: 6f5f 6465 6c61 7965 6428 7365 6c66 2c20  o_delayed(self, 
+00010950: 6f70 7469 6d69 7a65 5f67 7261 7068 3d54  optimize_graph=T
+00010960: 7275 6529 3a0a 2020 2020 2020 2020 2222  rue):.        ""
+00010970: 2243 6f6e 7665 7274 2069 6e74 6f20 6120  "Convert into a 
+00010980: 6c69 7374 206f 6620 6060 6461 736b 2e64  list of ``dask.d
+00010990: 656c 6179 6564 6060 206f 626a 6563 7473  elayed`` objects
+000109a0: 2c20 6f6e 6520 7065 7220 7061 7274 6974  , one per partit
+000109b0: 696f 6e2e 0a0a 2020 2020 2020 2020 5061  ion...        Pa
+000109c0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+000109d0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+000109e0: 2020 2020 6f70 7469 6d69 7a65 5f67 7261      optimize_gra
+000109f0: 7068 203a 2062 6f6f 6c2c 206f 7074 696f  ph : bool, optio
+00010a00: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00010a10: 4966 2054 7275 6520 5b64 6566 6175 6c74  If True [default
+00010a20: 5d2c 2074 6865 2067 7261 7068 2069 7320  ], the graph is 
+00010a30: 6f70 7469 6d69 7a65 6420 6265 666f 7265  optimized before
+00010a40: 2063 6f6e 7665 7274 696e 6720 696e 746f   converting into
+00010a50: 0a20 2020 2020 2020 2020 2020 2060 6064  .            ``d
+00010a60: 6173 6b2e 6465 6c61 7965 6460 6020 6f62  ask.delayed`` ob
+00010a70: 6a65 6374 732e 0a0a 2020 2020 2020 2020  jects...        
+00010a80: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+00010a90: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00010aa0: 2020 3e3e 3e20 7061 7274 6974 696f 6e73    >>> partitions
+00010ab0: 203d 2064 662e 746f 5f64 656c 6179 6564   = df.to_delayed
+00010ac0: 2829 2020 2320 646f 6374 6573 743a 202b  ()  # doctest: +
+00010ad0: 534b 4950 0a0a 2020 2020 2020 2020 5365  SKIP..        Se
+00010ae0: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
+00010af0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00010b00: 6461 736b 2e64 6174 6166 7261 6d65 2e66  dask.dataframe.f
+00010b10: 726f 6d5f 6465 6c61 7965 640a 2020 2020  rom_delayed.    
+00010b20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00010b30: 6b65 7973 203d 2073 656c 662e 5f5f 6461  keys = self.__da
+00010b40: 736b 5f6b 6579 735f 5f28 290a 2020 2020  sk_keys__().    
+00010b50: 2020 2020 6772 6170 6820 3d20 7365 6c66      graph = self
+00010b60: 2e5f 5f64 6173 6b5f 6772 6170 685f 5f28  .__dask_graph__(
+00010b70: 290a 2020 2020 2020 2020 6c61 7965 7220  ).        layer 
+00010b80: 3d20 7365 6c66 2e5f 5f64 6173 6b5f 6c61  = self.__dask_la
+00010b90: 7965 7273 5f5f 2829 5b30 5d0a 2020 2020  yers__()[0].    
+00010ba0: 2020 2020 6966 206f 7074 696d 697a 655f      if optimize_
+00010bb0: 6772 6170 683a 0a20 2020 2020 2020 2020  graph:.         
+00010bc0: 2020 2067 7261 7068 203d 2073 656c 662e     graph = self.
+00010bd0: 5f5f 6461 736b 5f6f 7074 696d 697a 655f  __dask_optimize_
+00010be0: 5f28 6772 6170 682c 2073 656c 662e 5f5f  _(graph, self.__
+00010bf0: 6461 736b 5f6b 6579 735f 5f28 2929 0a20  dask_keys__()). 
+00010c00: 2020 2020 2020 2020 2020 206c 6179 6572             layer
+00010c10: 203d 2022 6465 6c61 7965 642d 2220 2b20   = "delayed-" + 
+00010c20: 7365 6c66 2e5f 6e61 6d65 0a20 2020 2020  self._name.     
+00010c30: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
+00010c40: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+00010c50: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286c  om_collections(l
+00010c60: 6179 6572 2c20 6772 6170 682c 2064 6570  ayer, graph, dep
+00010c70: 656e 6465 6e63 6965 733d 2829 290a 2020  endencies=()).  
+00010c80: 2020 2020 2020 7265 7475 726e 205b 4465        return [De
+00010c90: 6c61 7965 6428 6b2c 2067 7261 7068 2c20  layed(k, graph, 
+00010ca0: 6c61 7965 723d 6c61 7965 7229 2066 6f72  layer=layer) for
+00010cb0: 206b 2069 6e20 6b65 7973 5d0a 0a20 2020   k in keys]..   
+00010cc0: 2064 6566 2074 6f5f 6261 636b 656e 6428   def to_backend(
+00010cd0: 7365 6c66 2c20 6261 636b 656e 643a 2073  self, backend: s
+00010ce0: 7472 207c 204e 6f6e 6520 3d20 4e6f 6e65  tr | None = None
+00010cf0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00010d00: 2020 2020 2022 2222 4d6f 7665 2074 6f20       """Move to 
+00010d10: 6120 6e65 7720 4461 7461 4672 616d 6520  a new DataFrame 
+00010d20: 6261 636b 656e 640a 0a20 2020 2020 2020  backend..       
+00010d30: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00010d40: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00010d50: 2020 2020 2020 2062 6163 6b65 6e64 203a         backend :
+00010d60: 2073 7472 2c20 4f70 7469 6f6e 616c 0a20   str, Optional. 
+00010d70: 2020 2020 2020 2020 2020 2054 6865 206e             The n
+00010d80: 616d 6520 6f66 2074 6865 206e 6577 2062  ame of the new b
+00010d90: 6163 6b65 6e64 2074 6f20 6d6f 7665 2074  ackend to move t
+00010da0: 6f2e 2054 6865 2064 6566 6175 6c74 0a20  o. The default. 
+00010db0: 2020 2020 2020 2020 2020 2069 7320 7468             is th
+00010dc0: 6520 6375 7272 656e 7420 2264 6174 6166  e current "dataf
+00010dd0: 7261 6d65 2e62 6163 6b65 6e64 2220 636f  rame.backend" co
+00010de0: 6e66 6967 7572 6174 696f 6e2e 0a0a 2020  nfiguration...  
+00010df0: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00010e00: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00010e10: 2020 2020 2020 4461 7461 4672 616d 652c        DataFrame,
+00010e20: 2053 6572 6965 7320 6f72 2049 6e64 6578   Series or Index
+00010e30: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00010e40: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
+00010e50: 6174 6166 7261 6d65 2e69 6f20 696d 706f  ataframe.io impo
+00010e60: 7274 2074 6f5f 6261 636b 656e 640a 0a20  rt to_backend.. 
+00010e70: 2020 2020 2020 2072 6574 7572 6e20 746f         return to
+00010e80: 5f62 6163 6b65 6e64 2873 656c 662c 2062  _backend(self, b
+00010e90: 6163 6b65 6e64 3d62 6163 6b65 6e64 2c20  ackend=backend, 
+00010ea0: 2a2a 6b77 6172 6773 290a 0a20 2020 2040  **kwargs)..    @
+00010eb0: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
+00010ec0: 6465 6620 5f67 6574 5f75 6e61 7279 5f6f  def _get_unary_o
+00010ed0: 7065 7261 746f 7228 636c 732c 206f 7029  perator(cls, op)
+00010ee0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00010ef0: 206c 616d 6264 6120 7365 6c66 3a20 656c   lambda self: el
+00010f00: 656d 7769 7365 286f 702c 2073 656c 6629  emwise(op, self)
+00010f10: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+00010f20: 6f64 0a20 2020 2064 6566 205f 6765 745f  od.    def _get_
+00010f30: 6269 6e61 7279 5f6f 7065 7261 746f 7228  binary_operator(
+00010f40: 636c 732c 206f 702c 2069 6e76 3d46 616c  cls, op, inv=Fal
+00010f50: 7365 293a 0a20 2020 2020 2020 2069 6620  se):.        if 
+00010f60: 696e 763a 0a20 2020 2020 2020 2020 2020  inv:.           
+00010f70: 2072 6574 7572 6e20 6c61 6d62 6461 2073   return lambda s
+00010f80: 656c 662c 206f 7468 6572 3a20 656c 656d  elf, other: elem
+00010f90: 7769 7365 286f 702c 206f 7468 6572 2c20  wise(op, other, 
+00010fa0: 7365 6c66 290a 2020 2020 2020 2020 656c  self).        el
+00010fb0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00010fc0: 7265 7475 726e 206c 616d 6264 6120 7365  return lambda se
+00010fd0: 6c66 2c20 6f74 6865 723a 2065 6c65 6d77  lf, other: elemw
+00010fe0: 6973 6528 6f70 2c20 7365 6c66 2c20 6f74  ise(op, self, ot
+00010ff0: 6865 7229 0a0a 2020 2020 6465 6620 726f  her)..    def ro
+00011000: 6c6c 696e 6728 0a20 2020 2020 2020 2073  lling(.        s
+00011010: 656c 662c 2077 696e 646f 772c 206d 696e  elf, window, min
+00011020: 5f70 6572 696f 6473 3d4e 6f6e 652c 2063  _periods=None, c
+00011030: 656e 7465 723d 4661 6c73 652c 2077 696e  enter=False, win
+00011040: 5f74 7970 653d 4e6f 6e65 2c20 6178 6973  _type=None, axis
+00011050: 3d6e 6f5f 6465 6661 756c 740a 2020 2020  =no_default.    
+00011060: 293a 0a20 2020 2020 2020 2022 2222 5072  ):.        """Pr
+00011070: 6f76 6964 6573 2072 6f6c 6c69 6e67 2074  ovides rolling t
+00011080: 7261 6e73 666f 726d 6174 696f 6e73 2e0a  ransformations..
+00011090: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+000110a0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+000110b0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2077  ------.        w
+000110c0: 696e 646f 7720 3a20 696e 742c 2073 7472  indow : int, str
+000110d0: 2c20 6f66 6673 6574 0a20 2020 2020 2020  , offset.       
+000110e0: 2020 2020 5369 7a65 206f 6620 7468 6520      Size of the 
+000110f0: 6d6f 7669 6e67 2077 696e 646f 772e 2054  moving window. T
+00011100: 6869 7320 6973 2074 6865 206e 756d 6265  his is the numbe
+00011110: 7220 6f66 206f 6273 6572 7661 7469 6f6e  r of observation
+00011120: 7320 7573 6564 0a20 2020 2020 2020 2020  s used.         
+00011130: 2020 666f 7220 6361 6c63 756c 6174 696e    for calculatin
+00011140: 6720 7468 6520 7374 6174 6973 7469 632e  g the statistic.
+00011150: 2057 6865 6e20 6e6f 7420 7573 696e 6720   When not using 
+00011160: 6120 6060 4461 7465 7469 6d65 496e 6465  a ``DatetimeInde
+00011170: 7860 602c 0a20 2020 2020 2020 2020 2020  x``,.           
+00011180: 7468 6520 7769 6e64 6f77 2073 697a 6520  the window size 
+00011190: 6d75 7374 206e 6f74 2062 6520 736f 206c  must not be so l
+000111a0: 6172 6765 2061 7320 746f 2073 7061 6e20  arge as to span 
+000111b0: 6d6f 7265 2074 6861 6e20 6f6e 650a 2020  more than one.  
+000111c0: 2020 2020 2020 2020 2061 646a 6163 656e           adjacen
+000111d0: 7420 7061 7274 6974 696f 6e2e 2049 6620  t partition. If 
+000111e0: 7573 696e 6720 616e 206f 6666 7365 7420  using an offset 
+000111f0: 6f72 206f 6666 7365 7420 616c 6961 7320  or offset alias 
+00011200: 6c69 6b65 2027 3544 272c 0a20 2020 2020  like '5D',.     
+00011210: 2020 2020 2020 7468 6520 6461 7461 206d        the data m
+00011220: 7573 7420 6861 7665 2061 2060 6044 6174  ust have a ``Dat
+00011230: 6574 696d 6549 6e64 6578 6060 0a0a 2020  etimeIndex``..  
+00011240: 2020 2020 2020 2020 202e 2e20 7665 7273           .. vers
+00011250: 696f 6e63 6861 6e67 6564 3a3a 2030 2e31  ionchanged:: 0.1
+00011260: 352e 300a 0a20 2020 2020 2020 2020 2020  5.0..           
+00011270: 2020 204e 6f77 2061 6363 6570 7473 206f     Now accepts o
+00011280: 6666 7365 7473 2061 6e64 2073 7472 696e  ffsets and strin
+00011290: 6720 6f66 6673 6574 2061 6c69 6173 6573  g offset aliases
+000112a0: 0a0a 2020 2020 2020 2020 6d69 6e5f 7065  ..        min_pe
+000112b0: 7269 6f64 7320 3a20 696e 742c 2064 6566  riods : int, def
+000112c0: 6175 6c74 204e 6f6e 650a 2020 2020 2020  ault None.      
+000112d0: 2020 2020 2020 4d69 6e69 6d75 6d20 6e75        Minimum nu
+000112e0: 6d62 6572 206f 6620 6f62 7365 7276 6174  mber of observat
+000112f0: 696f 6e73 2069 6e20 7769 6e64 6f77 2072  ions in window r
+00011300: 6571 7569 7265 6420 746f 2068 6176 6520  equired to have 
+00011310: 6120 7661 6c75 650a 2020 2020 2020 2020  a value.        
+00011320: 2020 2020 286f 7468 6572 7769 7365 2072      (otherwise r
+00011330: 6573 756c 7420 6973 204e 4129 2e0a 2020  esult is NA)..  
+00011340: 2020 2020 2020 6365 6e74 6572 203a 2062        center : b
+00011350: 6f6f 6c65 616e 2c20 6465 6661 756c 7420  oolean, default 
+00011360: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00011370: 2020 5365 7420 7468 6520 6c61 6265 6c73    Set the labels
+00011380: 2061 7420 7468 6520 6365 6e74 6572 206f   at the center o
+00011390: 6620 7468 6520 7769 6e64 6f77 2e0a 2020  f the window..  
+000113a0: 2020 2020 2020 7769 6e5f 7479 7065 203a        win_type :
+000113b0: 2073 7472 696e 672c 2064 6566 6175 6c74   string, default
+000113c0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+000113d0: 2020 5072 6f76 6964 6520 6120 7769 6e64    Provide a wind
+000113e0: 6f77 2074 7970 652e 2054 6865 2072 6563  ow type. The rec
+000113f0: 6f67 6e69 7a65 6420 7769 6e64 6f77 2074  ognized window t
+00011400: 7970 6573 2061 7265 2069 6465 6e74 6963  ypes are identic
+00011410: 616c 0a20 2020 2020 2020 2020 2020 2074  al.            t
+00011420: 6f20 7061 6e64 6173 2e0a 2020 2020 2020  o pandas..      
+00011430: 2020 6178 6973 203a 2069 6e74 2c20 7374    axis : int, st
+00011440: 722c 204e 6f6e 652c 2064 6566 6175 6c74  r, None, default
+00011450: 2030 0a20 2020 2020 2020 2020 2020 2054   0.            T
+00011460: 6869 7320 7061 7261 6d65 7465 7220 6973  his parameter is
+00011470: 2064 6570 7265 6361 7465 6420 7769 7468   deprecated with
+00011480: 2060 6070 616e 6461 733e 3d32 2e31 6060   ``pandas>=2.1``
+00011490: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+000114a0: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
+000114b0: 2d2d 0a20 2020 2020 2020 2061 2052 6f6c  --.        a Rol
+000114c0: 6c69 6e67 206f 626a 6563 7420 6f6e 2077  ling object on w
+000114d0: 6869 6368 2074 6f20 6361 6c6c 2061 206d  hich to call a m
+000114e0: 6574 686f 6420 746f 2063 6f6d 7075 7465  ethod to compute
+000114f0: 2061 2073 7461 7469 7374 6963 0a20 2020   a statistic.   
+00011500: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00011510: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+00011520: 7261 6d65 2e72 6f6c 6c69 6e67 2069 6d70  rame.rolling imp
+00011530: 6f72 7420 526f 6c6c 696e 670a 0a20 2020  ort Rolling..   
+00011540: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00011550: 6365 2877 696e 646f 772c 2049 6e74 6567  ce(window, Integ
+00011560: 7261 6c29 3a0a 2020 2020 2020 2020 2020  ral):.          
+00011570: 2020 6966 2077 696e 646f 7720 3c20 303a    if window < 0:
+00011580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011590: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+000115a0: 7228 2277 696e 646f 7720 6d75 7374 2062  r("window must b
+000115b0: 6520 3e3d 2030 2229 0a0a 2020 2020 2020  e >= 0")..      
+000115c0: 2020 6966 206d 696e 5f70 6572 696f 6473    if min_periods
+000115d0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000115e0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+000115f0: 2069 7369 6e73 7461 6e63 6528 6d69 6e5f   isinstance(min_
+00011600: 7065 7269 6f64 732c 2049 6e74 6567 7261  periods, Integra
+00011610: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+00011620: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00011630: 7272 6f72 2822 6d69 6e5f 7065 7269 6f64  rror("min_period
+00011640: 7320 6d75 7374 2062 6520 616e 2069 6e74  s must be an int
+00011650: 6567 6572 2229 0a20 2020 2020 2020 2020  eger").         
+00011660: 2020 2069 6620 6d69 6e5f 7065 7269 6f64     if min_period
+00011670: 7320 3c20 303a 0a20 2020 2020 2020 2020  s < 0:.         
+00011680: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00011690: 7565 4572 726f 7228 226d 696e 5f70 6572  ueError("min_per
+000116a0: 696f 6473 206d 7573 7420 6265 203e 3d20  iods must be >= 
+000116b0: 3022 290a 0a20 2020 2020 2020 2072 6574  0")..        ret
+000116c0: 7572 6e20 526f 6c6c 696e 6728 0a20 2020  urn Rolling(.   
+000116d0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
+000116e0: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+000116f0: 773d 7769 6e64 6f77 2c0a 2020 2020 2020  w=window,.      
+00011700: 2020 2020 2020 6d69 6e5f 7065 7269 6f64        min_period
+00011710: 733d 6d69 6e5f 7065 7269 6f64 732c 0a20  s=min_periods,. 
+00011720: 2020 2020 2020 2020 2020 2063 656e 7465             cente
+00011730: 723d 6365 6e74 6572 2c0a 2020 2020 2020  r=center,.      
+00011740: 2020 2020 2020 7769 6e5f 7479 7065 3d77        win_type=w
+00011750: 696e 5f74 7970 652c 0a20 2020 2020 2020  in_type,.       
+00011760: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
+00011770: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+00011780: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00011790: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+000117a0: 6566 2064 6966 6628 7365 6c66 2c20 7065  ef diff(self, pe
+000117b0: 7269 6f64 733d 312c 2061 7869 733d 3029  riods=1, axis=0)
+000117c0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000117d0: 2020 2020 2020 2e2e 206e 6f74 653a 3a0a        .. note::.
+000117e0: 0a20 2020 2020 2020 2020 2020 5061 6e64  .           Pand
+000117f0: 6173 2063 7572 7265 6e74 6c79 2075 7365  as currently use
+00011800: 7320 616e 2060 606f 626a 6563 7460 602d  s an ``object``-
+00011810: 6474 7970 6520 636f 6c75 6d6e 2074 6f20  dtype column to 
+00011820: 7265 7072 6573 656e 740a 2020 2020 2020  represent.      
+00011830: 2020 2020 2062 6f6f 6c65 616e 2064 6174       boolean dat
+00011840: 6120 7769 7468 206d 6973 7369 6e67 2076  a with missing v
+00011850: 616c 7565 732e 2054 6869 7320 6361 6e20  alues. This can 
+00011860: 6361 7573 6520 6973 7375 6573 2066 6f72  cause issues for
+00011870: 0a20 2020 2020 2020 2020 2020 626f 6f6c  .           bool
+00011880: 6561 6e2d 7370 6563 6966 6963 206f 7065  ean-specific ope
+00011890: 7261 7469 6f6e 732c 206c 696b 6520 6060  rations, like ``
+000118a0: 7c60 602e 2054 6f20 656e 6162 6c65 2062  |``. To enable b
+000118b0: 6f6f 6c65 616e 2d0a 2020 2020 2020 2020  oolean-.        
+000118c0: 2020 2073 7065 6369 6669 6320 6f70 6572     specific oper
+000118d0: 6174 696f 6e73 2c20 6174 2074 6865 2063  ations, at the c
+000118e0: 6f73 7420 6f66 206d 6574 6164 6174 6120  ost of metadata 
+000118f0: 7468 6174 2064 6f65 736e 2774 206d 6174  that doesn't mat
+00011900: 6368 0a20 2020 2020 2020 2020 2020 7061  ch.           pa
+00011910: 6e64 6173 2c20 7573 6520 6060 2e61 7374  ndas, use ``.ast
+00011920: 7970 6528 626f 6f6c 2960 6020 6166 7465  ype(bool)`` afte
+00011930: 7220 7468 6520 6060 7368 6966 7460 602e  r the ``shift``.
+00011940: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00011950: 2020 2020 2061 7869 7320 3d20 7365 6c66       axis = self
+00011960: 2e5f 7661 6c69 6461 7465 5f61 7869 7328  ._validate_axis(
+00011970: 6178 6973 290a 2020 2020 2020 2020 6966  axis).        if
+00011980: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00011990: 7065 7269 6f64 732c 2049 6e74 6567 7261  periods, Integra
+000119a0: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+000119b0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+000119c0: 2270 6572 696f 6473 206d 7573 7420 6265  "periods must be
+000119d0: 2061 6e20 696e 7465 6765 7222 290a 0a20   an integer").. 
+000119e0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+000119f0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00011a00: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+00011a10: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+00011a20: 2020 2020 2020 2020 2020 2020 204d 2e64               M.d
+00011a30: 6966 662c 2074 6f6b 656e 3d22 6469 6666  iff, token="diff
+00011a40: 222c 2070 6572 696f 6473 3d70 6572 696f  ", periods=perio
+00011a50: 6473 2c20 6178 6973 3d31 2c20 656e 666f  ds, axis=1, enfo
+00011a60: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
+00011a70: 7365 0a20 2020 2020 2020 2020 2020 2029  se.            )
+00011a80: 0a0a 2020 2020 2020 2020 6265 666f 7265  ..        before
+00011a90: 2c20 6166 7465 7220 3d20 2870 6572 696f  , after = (perio
+00011aa0: 6473 2c20 3029 2069 6620 7065 7269 6f64  ds, 0) if period
+00011ab0: 7320 3e20 3020 656c 7365 2028 302c 202d  s > 0 else (0, -
+00011ac0: 7065 7269 6f64 7329 0a20 2020 2020 2020  periods).       
+00011ad0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+00011ae0: 5f6f 7665 726c 6170 284d 2e64 6966 662c  _overlap(M.diff,
+00011af0: 2062 6566 6f72 652c 2061 6674 6572 2c20   before, after, 
+00011b00: 746f 6b65 6e3d 2264 6966 6622 2c20 7065  token="diff", pe
+00011b10: 7269 6f64 733d 7065 7269 6f64 7329 0a0a  riods=periods)..
+00011b20: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00011b30: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+00011b40: 2020 2020 6465 6620 7368 6966 7428 7365      def shift(se
+00011b50: 6c66 2c20 7065 7269 6f64 733d 312c 2066  lf, periods=1, f
+00011b60: 7265 713d 4e6f 6e65 2c20 6178 6973 3d30  req=None, axis=0
+00011b70: 293a 0a20 2020 2020 2020 2061 7869 7320  ):.        axis 
+00011b80: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
+00011b90: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
+00011ba0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00011bb0: 7461 6e63 6528 7065 7269 6f64 732c 2049  tance(periods, I
+00011bc0: 6e74 6567 7261 6c29 3a0a 2020 2020 2020  ntegral):.      
+00011bd0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00011be0: 4572 726f 7228 2270 6572 696f 6473 206d  Error("periods m
+00011bf0: 7573 7420 6265 2061 6e20 696e 7465 6765  ust be an intege
+00011c00: 7222 290a 0a20 2020 2020 2020 2069 6620  r")..        if 
+00011c10: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
+00011c20: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00011c30: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00011c40: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00011c50: 2020 204d 2e73 6869 6674 2c0a 2020 2020     M.shift,.    
+00011c60: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
+00011c70: 6e3d 2273 6869 6674 222c 0a20 2020 2020  n="shift",.     
+00011c80: 2020 2020 2020 2020 2020 2070 6572 696f             perio
+00011c90: 6473 3d70 6572 696f 6473 2c0a 2020 2020  ds=periods,.    
+00011ca0: 2020 2020 2020 2020 2020 2020 6672 6571              freq
+00011cb0: 3d66 7265 712c 0a20 2020 2020 2020 2020  =freq,.         
+00011cc0: 2020 2020 2020 2061 7869 733d 312c 0a20         axis=1,. 
+00011cd0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00011ce0: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+00011cf0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+00011d00: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
+00011d10: 2066 7265 7120 6973 204e 6f6e 653a 0a20   freq is None:. 
+00011d20: 2020 2020 2020 2020 2020 2062 6566 6f72             befor
+00011d30: 652c 2061 6674 6572 203d 2028 7065 7269  e, after = (peri
+00011d40: 6f64 732c 2030 2920 6966 2070 6572 696f  ods, 0) if perio
+00011d50: 6473 203e 2030 2065 6c73 6520 2830 2c20  ds > 0 else (0, 
+00011d60: 2d70 6572 696f 6473 290a 2020 2020 2020  -periods).      
+00011d70: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00011d80: 662e 6d61 705f 6f76 6572 6c61 7028 0a20  f.map_overlap(. 
+00011d90: 2020 2020 2020 2020 2020 2020 2020 204d                 M
+00011da0: 2e73 6869 6674 2c20 6265 666f 7265 2c20  .shift, before, 
+00011db0: 6166 7465 722c 2074 6f6b 656e 3d22 7368  after, token="sh
+00011dc0: 6966 7422 2c20 7065 7269 6f64 733d 7065  ift", periods=pe
+00011dd0: 7269 6f64 730a 2020 2020 2020 2020 2020  riods.          
+00011de0: 2020 290a 0a20 2020 2020 2020 2023 204c    )..        # L
+00011df0: 6574 2070 616e 6461 7320 6572 726f 7220  et pandas error 
+00011e00: 6f6e 2069 6e76 616c 6964 2061 7267 756d  on invalid argum
+00011e10: 656e 7473 0a20 2020 2020 2020 206d 6574  ents.        met
+00011e20: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
+00011e30: 6f6e 656d 7074 792e 7368 6966 7428 7065  onempty.shift(pe
+00011e40: 7269 6f64 732c 2066 7265 713d 6672 6571  riods, freq=freq
+00011e50: 290a 2020 2020 2020 2020 6f75 7420 3d20  ).        out = 
+00011e60: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
+00011e70: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+00011e80: 204d 2e73 6869 6674 2c0a 2020 2020 2020   M.shift,.      
+00011e90: 2020 2020 2020 746f 6b65 6e3d 2273 6869        token="shi
+00011ea0: 6674 222c 0a20 2020 2020 2020 2020 2020  ft",.           
+00011eb0: 2070 6572 696f 6473 3d70 6572 696f 6473   periods=periods
+00011ec0: 2c0a 2020 2020 2020 2020 2020 2020 6672  ,.            fr
+00011ed0: 6571 3d66 7265 712c 0a20 2020 2020 2020  eq=freq,.       
+00011ee0: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
+00011ef0: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
+00011f00: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
+00011f10: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+00011f20: 7472 616e 7366 6f72 6d5f 6469 7669 7369  transform_divisi
+00011f30: 6f6e 733d 4661 6c73 652c 0a20 2020 2020  ons=False,.     
+00011f40: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00011f50: 7572 6e20 6d61 7962 655f 7368 6966 745f  urn maybe_shift_
+00011f60: 6469 7669 7369 6f6e 7328 6f75 742c 2070  divisions(out, p
+00011f70: 6572 696f 6473 2c20 6672 6571 3d66 7265  eriods, freq=fre
+00011f80: 7129 0a0a 2020 2020 6465 6620 5f72 6564  q)..    def _red
+00011f90: 7563 7469 6f6e 5f61 6767 280a 2020 2020  uction_agg(.    
+00011fa0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00011fb0: 2020 6e61 6d65 2c0a 2020 2020 2020 2020    name,.        
+00011fc0: 6178 6973 3d4e 6f6e 652c 0a20 2020 2020  axis=None,.     
+00011fd0: 2020 2073 6b69 706e 613d 5472 7565 2c0a     skipna=True,.
+00011fe0: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+00011ff0: 6572 793d 4661 6c73 652c 0a20 2020 2020  ery=False,.     
+00012000: 2020 206f 7574 3d4e 6f6e 652c 0a20 2020     out=None,.   
+00012010: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+00012020: 793d 4e6f 6e65 2c0a 2020 2020 2020 2020  y=None,.        
+00012030: 6e6f 6e65 5f69 735f 7a65 726f 3d54 7275  none_is_zero=Tru
+00012040: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00012050: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
+00012060: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
+00012070: 732c 206e 6f6e 655f 6973 5f7a 6572 6f3d  s, none_is_zero=
+00012080: 6e6f 6e65 5f69 735f 7a65 726f 290a 0a20  none_is_zero).. 
+00012090: 2020 2020 2020 2069 6620 6861 735f 6b65         if has_ke
+000120a0: 7977 6f72 6428 6765 7461 7474 7228 7365  yword(getattr(se
+000120b0: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
+000120c0: 792c 206e 616d 6529 2c20 226e 756d 6572  y, name), "numer
+000120d0: 6963 5f6f 6e6c 7922 293a 0a20 2020 2020  ic_only"):.     
+000120e0: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
+000120f0: 6e6c 795f 6b77 6172 6773 203d 207b 226e  nly_kwargs = {"n
+00012100: 756d 6572 6963 5f6f 6e6c 7922 3a20 6e75  umeric_only": nu
+00012110: 6d65 7269 635f 6f6e 6c79 7d0a 2020 2020  meric_only}.    
+00012120: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00012130: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+00012140: 6c79 5f6b 7761 7267 7320 3d20 7b7d 0a0a  ly_kwargs = {}..
+00012150: 2020 2020 2020 2020 7769 7468 2063 6865          with che
+00012160: 636b 5f6e 756d 6572 6963 5f6f 6e6c 795f  ck_numeric_only_
+00012170: 6465 7072 6563 6174 696f 6e28 6e61 6d65  deprecation(name
+00012180: 2c20 5472 7565 293a 0a20 2020 2020 2020  , True):.       
+00012190: 2020 2020 206d 6574 6120 3d20 6765 7461       meta = geta
+000121a0: 7474 7228 7365 6c66 2e5f 6d65 7461 5f6e  ttr(self._meta_n
+000121b0: 6f6e 656d 7074 792c 206e 616d 6529 280a  onempty, name)(.
+000121c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121d0: 6178 6973 3d61 7869 732c 2073 6b69 706e  axis=axis, skipn
+000121e0: 613d 736b 6970 6e61 2c20 2a2a 6e75 6d65  a=skipna, **nume
+000121f0: 7269 635f 6f6e 6c79 5f6b 7761 7267 730a  ric_only_kwargs.
+00012200: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00012210: 2020 2020 2020 2074 6f6b 656e 203d 2073         token = s
+00012220: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
+00012230: 7820 2b20 6e61 6d65 0a20 2020 2020 2020  x + name.       
+00012240: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
+00012250: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00012260: 7420 3d20 7365 6c66 2e6d 6170 5f70 6172  t = self.map_par
+00012270: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
+00012280: 2020 2020 2020 2020 205f 6765 7461 7474           _getatt
+00012290: 725f 6e75 6d65 7269 635f 6f6e 6c79 2c0a  r_numeric_only,.
+000122a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000122b0: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
+000122c0: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
+000122d0: 3d74 6f6b 656e 2c0a 2020 2020 2020 2020  =token,.        
+000122e0: 2020 2020 2020 2020 736b 6970 6e61 3d73          skipna=s
+000122f0: 6b69 706e 612c 0a20 2020 2020 2020 2020  kipna,.         
+00012300: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+00012310: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00012320: 2020 5f64 6173 6b5f 6d65 7468 6f64 5f6e    _dask_method_n
+00012330: 616d 653d 6e61 6d65 2c0a 2020 2020 2020  ame=name,.      
+00012340: 2020 2020 2020 2020 2020 2a2a 6e75 6d65            **nume
+00012350: 7269 635f 6f6e 6c79 5f6b 7761 7267 732c  ric_only_kwargs,
+00012360: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00012370: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00012380: 6e20 6861 6e64 6c65 5f6f 7574 286f 7574  n handle_out(out
+00012390: 2c20 7265 7375 6c74 290a 2020 2020 2020  , result).      
+000123a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000123b0: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
+000123c0: 662e 7265 6475 6374 696f 6e28 0a20 2020  f.reduction(.   
+000123d0: 2020 2020 2020 2020 2020 2020 205f 6765               _ge
+000123e0: 7461 7474 725f 6e75 6d65 7269 635f 6f6e  tattr_numeric_on
+000123f0: 6c79 2c0a 2020 2020 2020 2020 2020 2020  ly,.            
+00012400: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
+00012410: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00012420: 6f6b 656e 3d74 6f6b 656e 2c0a 2020 2020  oken=token,.    
+00012430: 2020 2020 2020 2020 2020 2020 736b 6970              skip
+00012440: 6e61 3d73 6b69 706e 612c 0a20 2020 2020  na=skipna,.     
+00012450: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+00012460: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+00012470: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
+00012480: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
+00012490: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+000124a0: 6461 736b 5f6d 6574 686f 645f 6e61 6d65  dask_method_name
+000124b0: 3d6e 616d 652c 0a20 2020 2020 2020 2020  =name,.         
+000124c0: 2020 2020 2020 202a 2a6e 756d 6572 6963         **numeric
+000124d0: 5f6f 6e6c 795f 6b77 6172 6773 2c0a 2020  _only_kwargs,.  
+000124e0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000124f0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00012500: 7461 6e63 6528 7365 6c66 2c20 4461 7461  tance(self, Data
+00012510: 4672 616d 6529 2061 6e64 2069 7369 6e73  Frame) and isins
+00012520: 7461 6e63 6528 7265 7375 6c74 2c20 5365  tance(result, Se
+00012530: 7269 6573 293a 0a20 2020 2020 2020 2020  ries):.         
+00012540: 2020 2020 2020 2072 6573 756c 742e 6469         result.di
+00012550: 7669 7369 6f6e 7320 3d20 2873 656c 662e  visions = (self.
+00012560: 636f 6c75 6d6e 732e 6d69 6e28 292c 2073  columns.min(), s
+00012570: 656c 662e 636f 6c75 6d6e 732e 6d61 7828  elf.columns.max(
+00012580: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
+00012590: 6574 7572 6e20 6861 6e64 6c65 5f6f 7574  eturn handle_out
+000125a0: 286f 7574 2c20 7265 7375 6c74 290a 0a20  (out, result).. 
+000125b0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+000125c0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+000125d0: 2020 2064 6566 2061 6464 5f70 7265 6669     def add_prefi
+000125e0: 7828 7365 6c66 2c20 7072 6566 6978 293a  x(self, prefix):
+000125f0: 0a20 2020 2020 2020 2072 6573 203d 2073  .        res = s
+00012600: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+00012610: 6e73 284d 2e61 6464 5f70 7265 6669 782c  ns(M.add_prefix,
+00012620: 2070 7265 6669 7829 0a20 2020 2020 2020   prefix).       
+00012630: 2069 6620 7365 6c66 2e6b 6e6f 776e 5f64   if self.known_d
+00012640: 6976 6973 696f 6e73 2061 6e64 2069 735f  ivisions and is_
+00012650: 7365 7269 6573 5f6c 696b 6528 7365 6c66  series_like(self
+00012660: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00012670: 6573 2e64 6976 6973 696f 6e73 203d 2074  es.divisions = t
+00012680: 7570 6c65 2870 7265 6669 7820 2b20 7374  uple(prefix + st
+00012690: 7228 6469 7669 7369 6f6e 2920 666f 7220  r(division) for 
+000126a0: 6469 7669 7369 6f6e 2069 6e20 7365 6c66  division in self
+000126b0: 2e64 6976 6973 696f 6e73 290a 2020 2020  .divisions).    
+000126c0: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
+000126d0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+000126e0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+000126f0: 2020 2020 6465 6620 6164 645f 7375 6666      def add_suff
+00012700: 6978 2873 656c 662c 2073 7566 6669 7829  ix(self, suffix)
+00012710: 3a0a 2020 2020 2020 2020 7265 7320 3d20  :.        res = 
+00012720: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
+00012730: 6f6e 7328 4d2e 6164 645f 7375 6666 6978  ons(M.add_suffix
+00012740: 2c20 7375 6666 6978 290a 2020 2020 2020  , suffix).      
+00012750: 2020 6966 2073 656c 662e 6b6e 6f77 6e5f    if self.known_
+00012760: 6469 7669 7369 6f6e 7320 616e 6420 6973  divisions and is
+00012770: 5f73 6572 6965 735f 6c69 6b65 2873 656c  _series_like(sel
+00012780: 6629 3a0a 2020 2020 2020 2020 2020 2020  f):.            
+00012790: 7265 732e 6469 7669 7369 6f6e 7320 3d20  res.divisions = 
+000127a0: 7475 706c 6528 7374 7228 6469 7669 7369  tuple(str(divisi
+000127b0: 6f6e 2920 2b20 7375 6666 6978 2066 6f72  on) + suffix for
+000127c0: 2064 6976 6973 696f 6e20 696e 2073 656c   division in sel
+000127d0: 662e 6469 7669 7369 6f6e 7329 0a20 2020  f.divisions).   
+000127e0: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
+000127f0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00012800: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+00012810: 0a20 2020 2064 6566 2061 6273 2873 656c  .    def abs(sel
+00012820: 6629 3a0a 2020 2020 2020 2020 5f72 6169  f):.        _rai
+00012830: 7365 5f69 665f 6f62 6a65 6374 5f73 6572  se_if_object_ser
+00012840: 6965 7328 7365 6c66 2c20 2261 6273 2229  ies(self, "abs")
+00012850: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
+00012860: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
+00012870: 7074 792e 6162 7328 290a 2020 2020 2020  pty.abs().      
+00012880: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
+00012890: 705f 7061 7274 6974 696f 6e73 284d 2e61  p_partitions(M.a
+000128a0: 6273 2c20 6d65 7461 3d6d 6574 612c 2065  bs, meta=meta, e
+000128b0: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+000128c0: 4661 6c73 6529 0a0a 2020 2020 4064 6572  False)..    @der
+000128d0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+000128e0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+000128f0: 616c 6c28 7365 6c66 2c20 6178 6973 3d4e  all(self, axis=N
+00012900: 6f6e 652c 2073 6b69 706e 613d 5472 7565  one, skipna=True
+00012910: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+00012920: 6c73 652c 206f 7574 3d4e 6f6e 6529 3a0a  lse, out=None):.
+00012930: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00012940: 656c 662e 5f72 6564 7563 7469 6f6e 5f61  elf._reduction_a
+00012950: 6767 280a 2020 2020 2020 2020 2020 2020  gg(.            
+00012960: 2261 6c6c 222c 2061 7869 733d 6178 6973  "all", axis=axis
+00012970: 2c20 736b 6970 6e61 3d73 6b69 706e 612c  , skipna=skipna,
+00012980: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+00012990: 6974 5f65 7665 7279 2c20 6f75 743d 6f75  it_every, out=ou
+000129a0: 740a 2020 2020 2020 2020 290a 0a20 2020  t.        )..   
+000129b0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+000129c0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+000129d0: 2064 6566 2061 6e79 2873 656c 662c 2061   def any(self, a
+000129e0: 7869 733d 4e6f 6e65 2c20 736b 6970 6e61  xis=None, skipna
+000129f0: 3d54 7275 652c 2073 706c 6974 5f65 7665  =True, split_eve
+00012a00: 7279 3d46 616c 7365 2c20 6f75 743d 4e6f  ry=False, out=No
+00012a10: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
+00012a20: 7572 6e20 7365 6c66 2e5f 7265 6475 6374  urn self._reduct
+00012a30: 696f 6e5f 6167 6728 0a20 2020 2020 2020  ion_agg(.       
+00012a40: 2020 2020 2022 616e 7922 2c20 6178 6973       "any", axis
+00012a50: 3d61 7869 732c 2073 6b69 706e 613d 736b  =axis, skipna=sk
+00012a60: 6970 6e61 2c20 7370 6c69 745f 6576 6572  ipna, split_ever
+00012a70: 793d 7370 6c69 745f 6576 6572 792c 206f  y=split_every, o
+00012a80: 7574 3d6f 7574 0a20 2020 2020 2020 2029  ut=out.        )
+00012a90: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00012aa0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+00012ab0: 290a 2020 2020 6465 6620 7375 6d28 0a20  ).    def sum(. 
+00012ac0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00012ad0: 2020 2020 2061 7869 733d 4e6f 6e65 2c0a       axis=None,.
+00012ae0: 2020 2020 2020 2020 736b 6970 6e61 3d54          skipna=T
+00012af0: 7275 652c 0a20 2020 2020 2020 2073 706c  rue,.        spl
+00012b00: 6974 5f65 7665 7279 3d46 616c 7365 2c0a  it_every=False,.
+00012b10: 2020 2020 2020 2020 6474 7970 653d 4e6f          dtype=No
+00012b20: 6e65 2c0a 2020 2020 2020 2020 6f75 743d  ne,.        out=
+00012b30: 4e6f 6e65 2c0a 2020 2020 2020 2020 6d69  None,.        mi
+00012b40: 6e5f 636f 756e 743d 4e6f 6e65 2c0a 2020  n_count=None,.  
+00012b50: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+00012b60: 6c79 3d4e 6f6e 652c 0a20 2020 2029 3a0a  ly=None,.    ):.
+00012b70: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+00012b80: 2073 656c 662e 5f72 6564 7563 7469 6f6e   self._reduction
+00012b90: 5f61 6767 280a 2020 2020 2020 2020 2020  _agg(.          
+00012ba0: 2020 2273 756d 222c 0a20 2020 2020 2020    "sum",.       
+00012bb0: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
+00012bc0: 2020 2020 2020 2020 2020 2020 736b 6970              skip
+00012bd0: 6e61 3d73 6b69 706e 612c 0a20 2020 2020  na=skipna,.     
+00012be0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+00012bf0: 7279 3d73 706c 6974 5f65 7665 7279 2c0a  ry=split_every,.
+00012c00: 2020 2020 2020 2020 2020 2020 6f75 743d              out=
+00012c10: 6f75 742c 0a20 2020 2020 2020 2020 2020  out,.           
+00012c20: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
+00012c30: 6d65 7269 635f 6f6e 6c79 2c0a 2020 2020  meric_only,.    
+00012c40: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
+00012c50: 206d 696e 5f63 6f75 6e74 3a0a 2020 2020   min_count:.    
+00012c60: 2020 2020 2020 2020 636f 6e64 203d 2073          cond = s
+00012c70: 656c 662e 6e6f 746e 756c 6c28 292e 7375  elf.notnull().su
+00012c80: 6d28 6178 6973 3d61 7869 7329 203e 3d20  m(axis=axis) >= 
+00012c90: 6d69 6e5f 636f 756e 740a 2020 2020 2020  min_count.      
+00012ca0: 2020 2020 2020 6966 2069 735f 7365 7269        if is_seri
+00012cb0: 6573 5f6c 696b 6528 636f 6e64 293a 0a20  es_like(cond):. 
+00012cc0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00012cd0: 6574 7572 6e20 7265 7375 6c74 2e77 6865  eturn result.whe
+00012ce0: 7265 2863 6f6e 642c 206f 7468 6572 3d6e  re(cond, other=n
+00012cf0: 702e 4e61 4e29 0a20 2020 2020 2020 2020  p.NaN).         
+00012d00: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00012d10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00012d20: 5f73 6361 6c61 725f 6269 6e61 7279 280a  _scalar_binary(.
+00012d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012d40: 2020 2020 6c61 6d62 6461 2078 2c20 793a      lambda x, y:
+00012d50: 2072 6573 756c 7420 6966 2078 2069 7320   result if x is 
+00012d60: 7920 656c 7365 206e 702e 4e61 4e2c 2063  y else np.NaN, c
+00012d70: 6f6e 642c 2054 7275 650a 2020 2020 2020  ond, True.      
+00012d80: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00012d90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00012da0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00012db0: 756c 740a 0a20 2020 2040 5f6e 756d 6572  ult..    @_numer
+00012dc0: 6963 5f6f 6e6c 790a 2020 2020 4064 6572  ic_only.    @der
+00012dd0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00012de0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00012df0: 7072 6f64 280a 2020 2020 2020 2020 7365  prod(.        se
+00012e00: 6c66 2c0a 2020 2020 2020 2020 6178 6973  lf,.        axis
+00012e10: 3d4e 6f6e 652c 0a20 2020 2020 2020 2073  =None,.        s
+00012e20: 6b69 706e 613d 5472 7565 2c0a 2020 2020  kipna=True,.    
+00012e30: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+00012e40: 4661 6c73 652c 0a20 2020 2020 2020 2064  False,.        d
+00012e50: 7479 7065 3d4e 6f6e 652c 0a20 2020 2020  type=None,.     
+00012e60: 2020 206f 7574 3d4e 6f6e 652c 0a20 2020     out=None,.   
+00012e70: 2020 2020 206d 696e 5f63 6f75 6e74 3d4e       min_count=N
+00012e80: 6f6e 652c 0a20 2020 2020 2020 206e 756d  one,.        num
+00012e90: 6572 6963 5f6f 6e6c 793d 4e6f 6e65 2c0a  eric_only=None,.
+00012ea0: 2020 2020 293a 0a20 2020 2020 2020 2072      ):.        r
+00012eb0: 6573 756c 7420 3d20 7365 6c66 2e5f 7265  esult = self._re
+00012ec0: 6475 6374 696f 6e5f 6167 6728 0a20 2020  duction_agg(.   
+00012ed0: 2020 2020 2020 2020 2022 7072 6f64 222c           "prod",
+00012ee0: 0a20 2020 2020 2020 2020 2020 2061 7869  .            axi
+00012ef0: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
+00012f00: 2020 2020 736b 6970 6e61 3d73 6b69 706e      skipna=skipn
+00012f10: 612c 0a20 2020 2020 2020 2020 2020 2073  a,.            s
+00012f20: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+00012f30: 5f65 7665 7279 2c0a 2020 2020 2020 2020  _every,.        
+00012f40: 2020 2020 6f75 743d 6f75 742c 0a20 2020      out=out,.   
+00012f50: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+00012f60: 6620 6d69 6e5f 636f 756e 743a 0a20 2020  f min_count:.   
+00012f70: 2020 2020 2020 2020 2063 6f6e 6420 3d20           cond = 
+00012f80: 7365 6c66 2e6e 6f74 6e75 6c6c 2829 2e73  self.notnull().s
+00012f90: 756d 2861 7869 733d 6178 6973 2920 3e3d  um(axis=axis) >=
+00012fa0: 206d 696e 5f63 6f75 6e74 0a20 2020 2020   min_count.     
+00012fb0: 2020 2020 2020 2069 6620 6973 5f73 6572         if is_ser
+00012fc0: 6965 735f 6c69 6b65 2863 6f6e 6429 3a0a  ies_like(cond):.
+00012fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012fe0: 7265 7475 726e 2072 6573 756c 742e 7768  return result.wh
+00012ff0: 6572 6528 636f 6e64 2c20 6f74 6865 723d  ere(cond, other=
+00013000: 6e70 2e4e 614e 290a 2020 2020 2020 2020  np.NaN).        
+00013010: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00013020: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00013030: 205f 7363 616c 6172 5f62 696e 6172 7928   _scalar_binary(
+00013040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013050: 2020 2020 206c 616d 6264 6120 782c 2079       lambda x, y
+00013060: 3a20 7265 7375 6c74 2069 6620 7820 6973  : result if x is
+00013070: 2079 2065 6c73 6520 6e70 2e4e 614e 2c20   y else np.NaN, 
+00013080: 636f 6e64 2c20 5472 7565 0a20 2020 2020  cond, True.     
+00013090: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000130a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000130b0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+000130c0: 7375 6c74 0a0a 2020 2020 7072 6f64 7563  sult..    produc
+000130d0: 7420 3d20 7072 6f64 2020 2320 616c 6961  t = prod  # alia
+000130e0: 7365 6420 6464 2e70 726f 6475 6374 0a0a  sed dd.product..
+000130f0: 2020 2020 405f 6e75 6d65 7269 635f 6f6e      @_numeric_on
+00013100: 6c79 0a20 2020 2040 6465 7269 7665 645f  ly.    @derived_
+00013110: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00013120: 6529 0a20 2020 2064 6566 206d 6178 2873  e).    def max(s
+00013130: 656c 662c 2061 7869 733d 302c 2073 6b69  elf, axis=0, ski
+00013140: 706e 613d 5472 7565 2c20 7370 6c69 745f  pna=True, split_
+00013150: 6576 6572 793d 4661 6c73 652c 206f 7574  every=False, out
+00013160: 3d4e 6f6e 652c 206e 756d 6572 6963 5f6f  =None, numeric_o
+00013170: 6e6c 793d 4e6f 6e65 293a 0a20 2020 2020  nly=None):.     
+00013180: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+00013190: 2020 2020 5041 4e44 4153 5f47 545f 3134      PANDAS_GT_14
+000131a0: 300a 2020 2020 2020 2020 2020 2020 616e  0.            an
+000131b0: 6420 6e6f 7420 5041 4e44 4153 5f47 545f  d not PANDAS_GT_
+000131c0: 3230 300a 2020 2020 2020 2020 2020 2020  200.            
+000131d0: 616e 6420 6178 6973 2069 7320 4e6f 6e65  and axis is None
+000131e0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+000131f0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+00013200: 2c20 4461 7461 4672 616d 6529 0a20 2020  , DataFrame).   
+00013210: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00013220: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00013230: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+00013240: 2020 2022 496e 2061 2066 7574 7572 6520     "In a future 
+00013250: 7665 7273 696f 6e2c 2044 6174 6146 7261  version, DataFra
+00013260: 6d65 2e6d 6178 2861 7869 733d 4e6f 6e65  me.max(axis=None
+00013270: 2920 7769 6c6c 2072 6574 7572 6e20 6120  ) will return a 
+00013280: 7363 616c 6172 206d 6178 206f 7665 7220  scalar max over 
+00013290: 7468 6520 656e 7469 7265 2044 6174 6146  the entire DataF
+000132a0: 7261 6d65 2e20 220a 2020 2020 2020 2020  rame. ".        
+000132b0: 2020 2020 2020 2020 2254 6f20 7265 7461          "To reta
+000132c0: 696e 2074 6865 206f 6c64 2062 6568 6176  in the old behav
+000132d0: 696f 722c 2075 7365 2027 6672 616d 652e  ior, use 'frame.
+000132e0: 6d61 7828 6178 6973 3d30 2927 206f 7220  max(axis=0)' or 
+000132f0: 6a75 7374 2027 6672 616d 652e 6d61 7828  just 'frame.max(
+00013300: 2927 222c 0a20 2020 2020 2020 2020 2020  )'",.           
+00013310: 2020 2020 2046 7574 7572 6557 6172 6e69       FutureWarni
+00013320: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
+00013330: 290a 2020 2020 2020 2020 2020 2020 6178  ).            ax
+00013340: 6973 203d 2030 0a0a 2020 2020 2020 2020  is = 0..        
+00013350: 7265 7475 726e 2073 656c 662e 5f72 6564  return self._red
+00013360: 7563 7469 6f6e 5f61 6767 280a 2020 2020  uction_agg(.    
+00013370: 2020 2020 2020 2020 226d 6178 222c 0a20          "max",. 
+00013380: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+00013390: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+000133a0: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
+000133b0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+000133c0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+000133d0: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
+000133e0: 2020 6f75 743d 6f75 742c 0a20 2020 2020    out=out,.     
+000133f0: 2020 2020 2020 2023 2053 7461 7274 696e         # Startin
+00013400: 6720 696e 2070 616e 6461 7320 322e 302c  g in pandas 2.0,
+00013410: 2060 6178 6973 3d4e 6f6e 6560 2064 6f65   `axis=None` doe
+00013420: 7320 6120 6675 6c6c 2061 6767 7265 6761  s a full aggrega
+00013430: 7469 6f6e 2061 6372 6f73 7320 626f 7468  tion across both
+00013440: 2061 7865 730a 2020 2020 2020 2020 2020   axes.          
+00013450: 2020 6e6f 6e65 5f69 735f 7a65 726f 3d6e    none_is_zero=n
+00013460: 6f74 2050 414e 4441 535f 4754 5f32 3030  ot PANDAS_GT_200
+00013470: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00013480: 2040 5f6e 756d 6572 6963 5f6f 6e6c 790a   @_numeric_only.
+00013490: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+000134a0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+000134b0: 2020 2020 6465 6620 6d69 6e28 7365 6c66      def min(self
+000134c0: 2c20 6178 6973 3d30 2c20 736b 6970 6e61  , axis=0, skipna
+000134d0: 3d54 7275 652c 2073 706c 6974 5f65 7665  =True, split_eve
+000134e0: 7279 3d46 616c 7365 2c20 6f75 743d 4e6f  ry=False, out=No
+000134f0: 6e65 2c20 6e75 6d65 7269 635f 6f6e 6c79  ne, numeric_only
+00013500: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00013510: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
+00013520: 2050 414e 4441 535f 4754 5f31 3430 0a20   PANDAS_GT_140. 
+00013530: 2020 2020 2020 2020 2020 2061 6e64 206e             and n
+00013540: 6f74 2050 414e 4441 535f 4754 5f32 3030  ot PANDAS_GT_200
+00013550: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00013560: 2061 7869 7320 6973 204e 6f6e 650a 2020   axis is None.  
+00013570: 2020 2020 2020 2020 2020 616e 6420 6973            and is
+00013580: 696e 7374 616e 6365 2873 656c 662c 2044  instance(self, D
+00013590: 6174 6146 7261 6d65 290a 2020 2020 2020  ataFrame).      
+000135a0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+000135b0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
+000135c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000135d0: 2249 6e20 6120 6675 7475 7265 2076 6572  "In a future ver
+000135e0: 7369 6f6e 2c20 4461 7461 4672 616d 652e  sion, DataFrame.
+000135f0: 6d69 6e28 6178 6973 3d4e 6f6e 6529 2077  min(axis=None) w
+00013600: 696c 6c20 7265 7475 726e 2061 2073 6361  ill return a sca
+00013610: 6c61 7220 6d69 6e20 6f76 6572 2074 6865  lar min over the
+00013620: 2065 6e74 6972 6520 4461 7461 4672 616d   entire DataFram
+00013630: 652e 2022 0a20 2020 2020 2020 2020 2020  e. ".           
+00013640: 2020 2020 2022 546f 2072 6574 6169 6e20       "To retain 
+00013650: 7468 6520 6f6c 6420 6265 6861 7669 6f72  the old behavior
+00013660: 2c20 7573 6520 2766 7261 6d65 2e6d 696e  , use 'frame.min
+00013670: 2861 7869 733d 3029 2720 6f72 206a 7573  (axis=0)' or jus
+00013680: 7420 2766 7261 6d65 2e6d 696e 2829 2722  t 'frame.min()'"
+00013690: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000136a0: 2020 4675 7475 7265 5761 726e 696e 672c    FutureWarning,
+000136b0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+000136c0: 2020 2020 2020 2020 2020 2061 7869 7320             axis 
+000136d0: 3d20 300a 0a20 2020 2020 2020 2072 6574  = 0..        ret
+000136e0: 7572 6e20 7365 6c66 2e5f 7265 6475 6374  urn self._reduct
+000136f0: 696f 6e5f 6167 6728 0a20 2020 2020 2020  ion_agg(.       
+00013700: 2020 2020 2022 6d69 6e22 2c0a 2020 2020       "min",.    
+00013710: 2020 2020 2020 2020 6178 6973 3d61 7869          axis=axi
+00013720: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
+00013730: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
+00013740: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
+00013750: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00013760: 792c 0a20 2020 2020 2020 2020 2020 206f  y,.            o
+00013770: 7574 3d6f 7574 2c0a 2020 2020 2020 2020  ut=out,.        
+00013780: 2020 2020 2320 5374 6172 7469 6e67 2069      # Starting i
+00013790: 6e20 7061 6e64 6173 2032 2e30 2c20 6061  n pandas 2.0, `a
+000137a0: 7869 733d 4e6f 6e65 6020 646f 6573 2061  xis=None` does a
+000137b0: 2066 756c 6c20 6167 6772 6567 6174 696f   full aggregatio
+000137c0: 6e20 6163 726f 7373 2062 6f74 6820 6178  n across both ax
+000137d0: 6573 0a20 2020 2020 2020 2020 2020 206e  es.            n
+000137e0: 6f6e 655f 6973 5f7a 6572 6f3d 6e6f 7420  one_is_zero=not 
+000137f0: 5041 4e44 4153 5f47 545f 3230 302c 0a20  PANDAS_GT_200,. 
+00013800: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+00013810: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00013820: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+00013830: 6620 6964 786d 6178 2873 656c 662c 2061  f idxmax(self, a
+00013840: 7869 733d 4e6f 6e65 2c20 736b 6970 6e61  xis=None, skipna
+00013850: 3d54 7275 652c 2073 706c 6974 5f65 7665  =True, split_eve
+00013860: 7279 3d46 616c 7365 293a 0a20 2020 2020  ry=False):.     
+00013870: 2020 2066 6e20 3d20 2269 6478 6d61 7822     fn = "idxmax"
+00013880: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
+00013890: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
+000138a0: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
+000138b0: 2020 6d65 7461 203d 2073 656c 662e 5f6d    meta = self._m
+000138c0: 6574 615f 6e6f 6e65 6d70 7479 2e69 6478  eta_nonempty.idx
+000138d0: 6d61 7828 6178 6973 3d61 7869 732c 2073  max(axis=axis, s
+000138e0: 6b69 706e 613d 736b 6970 6e61 290a 2020  kipna=skipna).  
+000138f0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
+00013900: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00013910: 7265 7475 726e 206d 6170 5f70 6172 7469  return map_parti
+00013920: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+00013930: 2020 2020 2020 204d 2e69 6478 6d61 782c         M.idxmax,
+00013940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013950: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
+00013960: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
+00013970: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013980: 2020 746f 6b65 6e3d 7365 6c66 2e5f 746f    token=self._to
+00013990: 6b65 6e5f 7072 6566 6978 202b 2066 6e2c  ken_prefix + fn,
+000139a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000139b0: 2073 6b69 706e 613d 736b 6970 6e61 2c0a   skipna=skipna,.
+000139c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000139d0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
+000139e0: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
+000139f0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+00013a00: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
+00013a10: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00013a20: 2020 2020 2020 2020 2020 2073 6361 6c61             scala
+00013a30: 7220 3d20 6e6f 7420 6973 5f73 6572 6965  r = not is_serie
+00013a40: 735f 6c69 6b65 286d 6574 6129 0a20 2020  s_like(meta).   
+00013a50: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+00013a60: 3d20 6163 6128 0a20 2020 2020 2020 2020  = aca(.         
+00013a70: 2020 2020 2020 205b 7365 6c66 5d2c 0a20         [self],. 
+00013a80: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00013a90: 6875 6e6b 3d69 6478 6d61 786d 696e 5f63  hunk=idxmaxmin_c
+00013aa0: 6875 6e6b 2c0a 2020 2020 2020 2020 2020  hunk,.          
+00013ab0: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
+00013ac0: 6964 786d 6178 6d69 6e5f 6167 672c 0a20  idxmaxmin_agg,. 
+00013ad0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00013ae0: 6f6d 6269 6e65 3d69 6478 6d61 786d 696e  ombine=idxmaxmin
+00013af0: 5f63 6f6d 6269 6e65 2c0a 2020 2020 2020  _combine,.      
+00013b00: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
+00013b10: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
+00013b20: 2020 2020 2061 6767 7265 6761 7465 5f6b       aggregate_k
+00013b30: 7761 7267 733d 7b22 7363 616c 6172 223a  wargs={"scalar":
+00013b40: 2073 6361 6c61 727d 2c0a 2020 2020 2020   scalar},.      
+00013b50: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
+00013b60: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
+00013b70: 6978 202b 2066 6e2c 0a20 2020 2020 2020  ix + fn,.       
+00013b80: 2020 2020 2020 2020 2073 706c 6974 5f65           split_e
+00013b90: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+00013ba0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013bb0: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
+00013bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013bd0: 2066 6e3d 666e 2c0a 2020 2020 2020 2020   fn=fn,.        
+00013be0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00013bf0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00013c00: 7365 6c66 2c20 4461 7461 4672 616d 6529  self, DataFrame)
+00013c10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00013c20: 2020 7265 7375 6c74 2e64 6976 6973 696f    result.divisio
+00013c30: 6e73 203d 2028 6d69 6e28 7365 6c66 2e63  ns = (min(self.c
+00013c40: 6f6c 756d 6e73 292c 206d 6178 2873 656c  olumns), max(sel
+00013c50: 662e 636f 6c75 6d6e 7329 290a 2020 2020  f.columns)).    
+00013c60: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00013c70: 6573 756c 740a 0a20 2020 2040 6465 7269  esult..    @deri
+00013c80: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+00013c90: 4672 616d 6529 0a20 2020 2064 6566 2069  Frame).    def i
+00013ca0: 6478 6d69 6e28 7365 6c66 2c20 6178 6973  dxmin(self, axis
+00013cb0: 3d4e 6f6e 652c 2073 6b69 706e 613d 5472  =None, skipna=Tr
+00013cc0: 7565 2c20 7370 6c69 745f 6576 6572 793d  ue, split_every=
+00013cd0: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00013ce0: 666e 203d 2022 6964 786d 696e 220a 2020  fn = "idxmin".  
+00013cf0: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
+00013d00: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
+00013d10: 2861 7869 7329 0a20 2020 2020 2020 206d  (axis).        m
+00013d20: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
+00013d30: 5f6e 6f6e 656d 7074 792e 6964 786d 6178  _nonempty.idxmax
+00013d40: 2861 7869 733d 6178 6973 290a 2020 2020  (axis=axis).    
+00013d50: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
+00013d60: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00013d70: 7475 726e 206d 6170 5f70 6172 7469 7469  turn map_partiti
+00013d80: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+00013d90: 2020 2020 204d 2e69 6478 6d69 6e2c 0a20       M.idxmin,. 
+00013da0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00013db0: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+00013dc0: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
+00013dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013de0: 746f 6b65 6e3d 7365 6c66 2e5f 746f 6b65  token=self._toke
+00013df0: 6e5f 7072 6566 6978 202b 2066 6e2c 0a20  n_prefix + fn,. 
+00013e00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00013e10: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
+00013e20: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00013e30: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+00013e40: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
+00013e50: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
+00013e60: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00013e70: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00013e80: 2020 2020 2020 2020 2073 6361 6c61 7220           scalar 
+00013e90: 3d20 6e6f 7420 6973 5f73 6572 6965 735f  = not is_series_
+00013ea0: 6c69 6b65 286d 6574 6129 0a20 2020 2020  like(meta).     
+00013eb0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00013ec0: 6163 6128 0a20 2020 2020 2020 2020 2020  aca(.           
+00013ed0: 2020 2020 205b 7365 6c66 5d2c 0a20 2020       [self],.   
+00013ee0: 2020 2020 2020 2020 2020 2020 2063 6875               chu
+00013ef0: 6e6b 3d69 6478 6d61 786d 696e 5f63 6875  nk=idxmaxmin_chu
+00013f00: 6e6b 2c0a 2020 2020 2020 2020 2020 2020  nk,.            
+00013f10: 2020 2020 6167 6772 6567 6174 653d 6964      aggregate=id
+00013f20: 786d 6178 6d69 6e5f 6167 672c 0a20 2020  xmaxmin_agg,.   
+00013f30: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
+00013f40: 6269 6e65 3d69 6478 6d61 786d 696e 5f63  bine=idxmaxmin_c
+00013f50: 6f6d 6269 6e65 2c0a 2020 2020 2020 2020  ombine,.        
+00013f60: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
+00013f70: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+00013f80: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
+00013f90: 7267 733d 7b22 7363 616c 6172 223a 2073  rgs={"scalar": s
+00013fa0: 6361 6c61 727d 2c0a 2020 2020 2020 2020  calar},.        
+00013fb0: 2020 2020 2020 2020 746f 6b65 6e3d 7365          token=se
+00013fc0: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
+00013fd0: 202b 2066 6e2c 0a20 2020 2020 2020 2020   + fn,.         
+00013fe0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+00013ff0: 7279 3d73 706c 6974 5f65 7665 7279 2c0a  ry=split_every,.
+00014000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014010: 736b 6970 6e61 3d73 6b69 706e 612c 0a20  skipna=skipna,. 
+00014020: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00014030: 6e3d 666e 2c0a 2020 2020 2020 2020 2020  n=fn,.          
+00014040: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00014050: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
+00014060: 6c66 2c20 4461 7461 4672 616d 6529 3a0a  lf, DataFrame):.
+00014070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014080: 7265 7375 6c74 2e64 6976 6973 696f 6e73  result.divisions
+00014090: 203d 2028 6d69 6e28 7365 6c66 2e63 6f6c   = (min(self.col
+000140a0: 756d 6e73 292c 206d 6178 2873 656c 662e  umns), max(self.
+000140b0: 636f 6c75 6d6e 7329 290a 2020 2020 2020  columns)).      
+000140c0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+000140d0: 756c 740a 0a20 2020 2040 5f6e 756d 6572  ult..    @_numer
+000140e0: 6963 5f6f 6e6c 790a 2020 2020 4064 6572  ic_only.    @der
+000140f0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00014100: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00014110: 636f 756e 7428 7365 6c66 2c20 6178 6973  count(self, axis
+00014120: 3d4e 6f6e 652c 2073 706c 6974 5f65 7665  =None, split_eve
+00014130: 7279 3d46 616c 7365 2c20 6e75 6d65 7269  ry=False, numeri
+00014140: 635f 6f6e 6c79 3d4e 6f6e 6529 3a0a 2020  c_only=None):.  
+00014150: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
+00014160: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
+00014170: 2861 7869 7329 0a20 2020 2020 2020 2074  (axis).        t
+00014180: 6f6b 656e 203d 2073 656c 662e 5f74 6f6b  oken = self._tok
+00014190: 656e 5f70 7265 6669 7820 2b20 2263 6f75  en_prefix + "cou
+000141a0: 6e74 220a 2020 2020 2020 2020 6966 2061  nt".        if a
+000141b0: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
+000141c0: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
+000141d0: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
+000141e0: 2e63 6f75 6e74 2861 7869 733d 6178 6973  .count(axis=axis
+000141f0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00014200: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
+00014210: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+00014220: 2020 2020 2020 2020 2020 4d2e 636f 756e            M.coun
+00014230: 742c 206d 6574 613d 6d65 7461 2c20 746f  t, meta=meta, to
+00014240: 6b65 6e3d 746f 6b65 6e2c 2061 7869 733d  ken=token, axis=
+00014250: 6178 6973 2c20 656e 666f 7263 655f 6d65  axis, enforce_me
+00014260: 7461 6461 7461 3d46 616c 7365 0a20 2020  tadata=False.   
+00014270: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00014280: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00014290: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
+000142a0: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
+000142b0: 636f 756e 7428 290a 0a20 2020 2020 2020  count()..       
+000142c0: 2020 2020 2023 204e 6565 6420 7468 6520       # Need the 
+000142d0: 6173 7479 7065 2869 6e74 2920 666f 7220  astype(int) for 
+000142e0: 656d 7074 7920 6461 7461 6672 616d 6573  empty dataframes
+000142f0: 2c20 7768 6963 6820 7375 6d20 746f 2066  , which sum to f
+00014300: 6c6f 6174 2064 7479 7065 0a20 2020 2020  loat dtype.     
+00014310: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00014320: 7365 6c66 2e72 6564 7563 7469 6f6e 280a  self.reduction(.
+00014330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014340: 4d2e 636f 756e 742c 0a20 2020 2020 2020  M.count,.       
+00014350: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
+00014360: 7465 3d5f 636f 756e 745f 6167 6772 6567  te=_count_aggreg
+00014370: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+00014380: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
+00014390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000143a0: 746f 6b65 6e3d 746f 6b65 6e2c 0a20 2020  token=token,.   
+000143b0: 2020 2020 2020 2020 2020 2020 2073 706c               spl
+000143c0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+000143d0: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
+000143e0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+000143f0: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
+00014400: 6c66 2c20 4461 7461 4672 616d 6529 3a0a  lf, DataFrame):.
+00014410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014420: 7265 7375 6c74 2e64 6976 6973 696f 6e73  result.divisions
+00014430: 203d 2028 7365 6c66 2e63 6f6c 756d 6e73   = (self.columns
+00014440: 2e6d 696e 2829 2c20 7365 6c66 2e63 6f6c  .min(), self.col
+00014450: 756d 6e73 2e6d 6178 2829 290a 2020 2020  umns.max()).    
+00014460: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00014470: 6573 756c 740a 0a20 2020 2040 6465 7269  esult..    @deri
+00014480: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+00014490: 4672 616d 6529 0a20 2020 2064 6566 206d  Frame).    def m
+000144a0: 6f64 6528 7365 6c66 2c20 6472 6f70 6e61  ode(self, dropna
+000144b0: 3d54 7275 652c 2073 706c 6974 5f65 7665  =True, split_eve
+000144c0: 7279 3d46 616c 7365 293a 0a20 2020 2020  ry=False):.     
+000144d0: 2020 206d 6f64 655f 7365 7269 6573 203d     mode_series =
+000144e0: 2073 656c 662e 7265 6475 6374 696f 6e28   self.reduction(
+000144f0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
+00014500: 6e6b 3d4d 2e76 616c 7565 5f63 6f75 6e74  nk=M.value_count
+00014510: 732c 0a20 2020 2020 2020 2020 2020 2063  s,.            c
+00014520: 6f6d 6269 6e65 3d4d 2e73 756d 2c0a 2020  ombine=M.sum,.  
+00014530: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
+00014540: 6174 653d 5f6d 6f64 655f 6167 6772 6567  ate=_mode_aggreg
+00014550: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+00014560: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+00014570: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
+00014580: 2020 2020 2020 6368 756e 6b5f 6b77 6172        chunk_kwar
+00014590: 6773 3d7b 2264 726f 706e 6122 3a20 6472  gs={"dropna": dr
+000145a0: 6f70 6e61 7d2c 0a20 2020 2020 2020 2020  opna},.         
+000145b0: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
+000145c0: 7267 733d 7b22 6472 6f70 6e61 223a 2064  rgs={"dropna": d
+000145d0: 726f 706e 617d 2c0a 2020 2020 2020 2020  ropna},.        
+000145e0: 290a 2020 2020 2020 2020 6d6f 6465 5f73  ).        mode_s
+000145f0: 6572 6965 732e 6e61 6d65 203d 2073 656c  eries.name = sel
+00014600: 662e 6e61 6d65 0a20 2020 2020 2020 2072  f.name.        r
+00014610: 6574 7572 6e20 6d6f 6465 5f73 6572 6965  eturn mode_serie
+00014620: 730a 0a20 2020 2040 5f6e 756d 6572 6963  s..    @_numeric
+00014630: 5f6f 6e6c 790a 2020 2020 4064 6572 6976  _only.    @deriv
+00014640: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00014650: 7261 6d65 290a 2020 2020 6465 6620 6d65  rame).    def me
+00014660: 616e 280a 2020 2020 2020 2020 7365 6c66  an(.        self
+00014670: 2c0a 2020 2020 2020 2020 6178 6973 3d30  ,.        axis=0
+00014680: 2c0a 2020 2020 2020 2020 736b 6970 6e61  ,.        skipna
+00014690: 3d54 7275 652c 0a20 2020 2020 2020 2073  =True,.        s
+000146a0: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+000146b0: 2c0a 2020 2020 2020 2020 6474 7970 653d  ,.        dtype=
+000146c0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6f75  None,.        ou
+000146d0: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
+000146e0: 6e75 6d65 7269 635f 6f6e 6c79 3d4e 6f6e  numeric_only=Non
+000146f0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00014700: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
+00014710: 2020 2050 414e 4441 535f 4754 5f31 3430     PANDAS_GT_140
+00014720: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00014730: 206e 6f74 2050 414e 4441 535f 4754 5f32   not PANDAS_GT_2
+00014740: 3030 0a20 2020 2020 2020 2020 2020 2061  00.            a
+00014750: 6e64 2061 7869 7320 6973 204e 6f6e 650a  nd axis is None.
+00014760: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00014770: 6973 696e 7374 616e 6365 2873 656c 662c  isinstance(self,
+00014780: 2044 6174 6146 7261 6d65 290a 2020 2020   DataFrame).    
+00014790: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+000147a0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+000147b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000147c0: 2020 2249 6e20 6120 6675 7475 7265 2076    "In a future v
+000147d0: 6572 7369 6f6e 2c20 4461 7461 4672 616d  ersion, DataFram
+000147e0: 652e 6d65 616e 2861 7869 733d 4e6f 6e65  e.mean(axis=None
+000147f0: 2920 7769 6c6c 2072 6574 7572 6e20 6120  ) will return a 
+00014800: 7363 616c 6172 206d 6561 6e20 6f76 6572  scalar mean over
+00014810: 2074 6865 2065 6e74 6972 6520 4461 7461   the entire Data
+00014820: 4672 616d 652e 2022 0a20 2020 2020 2020  Frame. ".       
+00014830: 2020 2020 2020 2020 2022 546f 2072 6574           "To ret
+00014840: 6169 6e20 7468 6520 6f6c 6420 6265 6861  ain the old beha
+00014850: 7669 6f72 2c20 7573 6520 2766 7261 6d65  vior, use 'frame
+00014860: 2e6d 6561 6e28 6178 6973 3d30 2927 206f  .mean(axis=0)' o
+00014870: 7220 6a75 7374 2027 6672 616d 652e 6d65  r just 'frame.me
+00014880: 616e 2829 2722 2c0a 2020 2020 2020 2020  an()'",.        
+00014890: 2020 2020 2020 2020 4675 7475 7265 5761          FutureWa
+000148a0: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
+000148b0: 2020 2029 0a20 2020 2020 2020 2061 7869     ).        axi
+000148c0: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
+000148d0: 7465 5f61 7869 7328 6178 6973 2c20 6e6f  te_axis(axis, no
+000148e0: 6e65 5f69 735f 7a65 726f 3d6e 6f74 2050  ne_is_zero=not P
+000148f0: 414e 4441 535f 4754 5f32 3030 290a 2020  ANDAS_GT_200).  
+00014900: 2020 2020 2020 5f72 6169 7365 5f69 665f        _raise_if_
+00014910: 6f62 6a65 6374 5f73 6572 6965 7328 7365  object_series(se
+00014920: 6c66 2c20 226d 6561 6e22 290a 2020 2020  lf, "mean").    
+00014930: 2020 2020 2320 4e4f 5445 3a20 446f 2077      # NOTE: Do w
+00014940: 6520 7761 6e74 2074 6f20 7761 726e 2068  e want to warn h
+00014950: 6572 653f 0a20 2020 2020 2020 2077 6974  ere?.        wit
+00014960: 6820 6368 6563 6b5f 6e75 6d65 7269 635f  h check_numeric_
+00014970: 6f6e 6c79 5f64 6570 7265 6361 7469 6f6e  only_deprecation
+00014980: 2829 2c20 6368 6563 6b5f 6e75 6973 616e  (), check_nuisan
+00014990: 6365 5f63 6f6c 756d 6e73 5f77 6172 6e69  ce_columns_warni
+000149a0: 6e67 2829 3a0a 2020 2020 2020 2020 2020  ng():.          
+000149b0: 2020 6d65 7461 203d 2073 656c 662e 5f6d    meta = self._m
+000149c0: 6574 615f 6e6f 6e65 6d70 7479 2e6d 6561  eta_nonempty.mea
+000149d0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+000149e0: 2020 2061 7869 733d 6178 6973 2c20 736b     axis=axis, sk
+000149f0: 6970 6e61 3d73 6b69 706e 612c 206e 756d  ipna=skipna, num
+00014a00: 6572 6963 5f6f 6e6c 793d 6e75 6d65 7269  eric_only=numeri
+00014a10: 635f 6f6e 6c79 0a20 2020 2020 2020 2020  c_only.         
+00014a20: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+00014a30: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
+00014a40: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00014a50: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+00014a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a70: 4d2e 6d65 616e 2c0a 2020 2020 2020 2020  M.mean,.        
+00014a80: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00014a90: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00014aa0: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
+00014ab0: 2020 2020 2020 2020 2074 6f6b 656e 3d73           token=s
+00014ac0: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
+00014ad0: 7820 2b20 226d 6561 6e22 2c0a 2020 2020  x + "mean",.    
+00014ae0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+00014af0: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
+00014b00: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
+00014b10: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
+00014b20: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
+00014b30: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
+00014b40: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+00014b50: 6d65 7269 635f 6f6e 6c79 3d6e 756d 6572  meric_only=numer
+00014b60: 6963 5f6f 6e6c 792c 0a20 2020 2020 2020  ic_only,.       
+00014b70: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00014b80: 2020 2072 6574 7572 6e20 6861 6e64 6c65     return handle
+00014b90: 5f6f 7574 286f 7574 2c20 7265 7375 6c74  _out(out, result
+00014ba0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00014bb0: 2020 2020 2020 2020 2020 2020 6e75 6d20              num 
+00014bc0: 3d20 7365 6c66 2e5f 6765 745f 6e75 6d65  = self._get_nume
+00014bd0: 7269 635f 6461 7461 2829 0a20 2020 2020  ric_data().     
+00014be0: 2020 2020 2020 2073 203d 206e 756d 2e73         s = num.s
+00014bf0: 756d 2873 6b69 706e 613d 736b 6970 6e61  um(skipna=skipna
+00014c00: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
+00014c10: 6c69 745f 6576 6572 7929 0a20 2020 2020  lit_every).     
+00014c20: 2020 2020 2020 206e 203d 206e 756d 2e63         n = num.c
+00014c30: 6f75 6e74 2873 706c 6974 5f65 7665 7279  ount(split_every
+00014c40: 3d73 706c 6974 5f65 7665 7279 290a 2020  =split_every).  
+00014c50: 2020 2020 2020 2020 2020 2320 5374 6172            # Star
+00014c60: 7469 6e67 2069 6e20 7061 6e64 6173 2032  ting in pandas 2
+00014c70: 2e30 2c20 6061 7869 733d 4e6f 6e65 6020  .0, `axis=None` 
+00014c80: 646f 6573 2061 2066 756c 6c20 6167 6772  does a full aggr
+00014c90: 6567 6174 696f 6e20 6163 726f 7373 2062  egation across b
+00014ca0: 6f74 6820 6178 6573 0a20 2020 2020 2020  oth axes.       
+00014cb0: 2020 2020 2069 6620 5041 4e44 4153 5f47       if PANDAS_G
+00014cc0: 545f 3230 3020 616e 6420 6178 6973 2069  T_200 and axis i
+00014cd0: 7320 4e6f 6e65 2061 6e64 2069 7369 6e73  s None and isins
+00014ce0: 7461 6e63 6528 7365 6c66 2c20 4461 7461  tance(self, Data
+00014cf0: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
+00014d00: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+00014d10: 2073 2e73 756d 2829 202f 206e 2e73 756d   s.sum() / n.sum
+00014d20: 2829 0a20 2020 2020 2020 2020 2020 2065  ().            e
+00014d30: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00014d40: 2020 2020 206e 616d 6520 3d20 7365 6c66       name = self
+00014d50: 2e5f 746f 6b65 6e5f 7072 6566 6978 202b  ._token_prefix +
+00014d60: 2022 6d65 616e 2d25 7322 2025 2074 6f6b   "mean-%s" % tok
+00014d70: 656e 697a 6528 7365 6c66 2c20 6178 6973  enize(self, axis
+00014d80: 2c20 736b 6970 6e61 290a 2020 2020 2020  , skipna).      
+00014d90: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00014da0: 203d 206d 6170 5f70 6172 7469 7469 6f6e   = map_partition
+00014db0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00014dc0: 2020 2020 2020 206d 6574 686f 6473 2e6d         methods.m
+00014dd0: 6561 6e5f 6167 6772 6567 6174 652c 0a20  ean_aggregate,. 
+00014de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014df0: 2020 2073 2c0a 2020 2020 2020 2020 2020     s,.          
+00014e00: 2020 2020 2020 2020 2020 6e2c 0a20 2020            n,.   
+00014e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e20: 2074 6f6b 656e 3d6e 616d 652c 0a20 2020   token=name,.   
+00014e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e40: 206d 6574 613d 6d65 7461 2c0a 2020 2020   meta=meta,.    
+00014e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e60: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+00014e70: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00014e80: 2020 2020 2020 2020 2020 2020 7061 7265              pare
+00014e90: 6e74 5f6d 6574 613d 7365 6c66 2e5f 6d65  nt_meta=self._me
+00014ea0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+00014eb0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00014ec0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00014ed0: 6e63 6528 7365 6c66 2c20 4461 7461 4672  nce(self, DataFr
+00014ee0: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
+00014ef0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00014f00: 2e64 6976 6973 696f 6e73 203d 2028 7365  .divisions = (se
+00014f10: 6c66 2e63 6f6c 756d 6e73 2e6d 696e 2829  lf.columns.min()
+00014f20: 2c20 7365 6c66 2e63 6f6c 756d 6e73 2e6d  , self.columns.m
+00014f30: 6178 2829 290a 2020 2020 2020 2020 2020  ax()).          
+00014f40: 2020 7265 7475 726e 2068 616e 646c 655f    return handle_
+00014f50: 6f75 7428 6f75 742c 2072 6573 756c 7429  out(out, result)
+00014f60: 0a0a 2020 2020 6465 6620 6d65 6469 616e  ..    def median
+00014f70: 5f61 7070 726f 7869 6d61 7465 280a 2020  _approximate(.  
+00014f80: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00014f90: 2020 2020 6178 6973 3d4e 6f6e 652c 0a20      axis=None,. 
+00014fa0: 2020 2020 2020 206d 6574 686f 643d 2264         method="d
+00014fb0: 6566 6175 6c74 222c 0a20 2020 2029 3a0a  efault",.    ):.
+00014fc0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00014fd0: 6e20 7468 6520 6170 7072 6f78 696d 6174  n the approximat
+00014fe0: 6520 6d65 6469 616e 206f 6620 7468 6520  e median of the 
+00014ff0: 7661 6c75 6573 206f 7665 7220 7468 6520  values over the 
+00015000: 7265 7175 6573 7465 6420 6178 6973 2e0a  requested axis..
+00015010: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00015020: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00015030: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2061  ------.        a
+00015040: 7869 7320 3a20 7b30 2c20 312c 2022 696e  xis : {0, 1, "in
+00015050: 6465 7822 2c20 2263 6f6c 756d 6e73 227d  dex", "columns"}
+00015060: 2028 6465 6661 756c 7420 3029 0a20 2020   (default 0).   
+00015070: 2020 2020 2020 2020 2030 206f 7220 6060           0 or ``
+00015080: 2269 6e64 6578 2260 6020 666f 7220 726f  "index"`` for ro
+00015090: 772d 7769 7365 2c20 3120 6f72 2060 6022  w-wise, 1 or ``"
+000150a0: 636f 6c75 6d6e 7322 6060 2066 6f72 2063  columns"`` for c
+000150b0: 6f6c 756d 6e2d 7769 7365 0a20 2020 2020  olumn-wise.     
+000150c0: 2020 206d 6574 686f 6420 3a20 7b27 6465     method : {'de
+000150d0: 6661 756c 7427 2c20 2774 6469 6765 7374  fault', 'tdigest
+000150e0: 272c 2027 6461 736b 277d 2c20 6f70 7469  ', 'dask'}, opti
+000150f0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00015100: 2057 6861 7420 6d65 7468 6f64 2074 6f20   What method to 
+00015110: 7573 652e 2042 7920 6465 6661 756c 7420  use. By default 
+00015120: 7769 6c6c 2075 7365 2044 6173 6b27 7320  will use Dask's 
+00015130: 696e 7465 726e 616c 2063 7573 746f 6d0a  internal custom.
+00015140: 2020 2020 2020 2020 2020 2020 616c 676f              algo
+00015150: 7269 7468 6d20 2860 6022 6461 736b 2260  rithm (``"dask"`
+00015160: 6029 2e20 2049 6620 7365 7420 746f 2060  `).  If set to `
+00015170: 6022 7464 6967 6573 7422 6060 2077 696c  `"tdigest"`` wil
+00015180: 6c20 7573 6520 7464 6967 6573 740a 2020  l use tdigest.  
+00015190: 2020 2020 2020 2020 2020 666f 7220 666c            for fl
+000151a0: 6f61 7473 2061 6e64 2069 6e74 7320 616e  oats and ints an
+000151b0: 6420 6661 6c6c 6261 636b 2074 6f20 7468  d fallback to th
+000151c0: 6520 6060 2264 6173 6b22 6060 206f 7468  e ``"dask"`` oth
+000151d0: 6572 7769 7365 2e0a 2020 2020 2020 2020  erwise..        
+000151e0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+000151f0: 726e 2073 656c 662e 7175 616e 7469 6c65  rn self.quantile
+00015200: 2871 3d30 2e35 2c20 6178 6973 3d61 7869  (q=0.5, axis=axi
+00015210: 732c 206d 6574 686f 643d 6d65 7468 6f64  s, method=method
+00015220: 292e 7265 6e61 6d65 284e 6f6e 6529 0a0a  ).rename(None)..
+00015230: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00015240: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+00015250: 2020 2020 6465 6620 6d65 6469 616e 2873      def median(s
+00015260: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
+00015270: 6d65 7468 6f64 3d22 6465 6661 756c 7422  method="default"
+00015280: 293a 0a20 2020 2020 2020 2069 6620 6178  ):.        if ax
+00015290: 6973 2069 6e20 2831 2c20 2263 6f6c 756d  is in (1, "colum
+000152a0: 6e73 2229 206f 7220 7365 6c66 2e6e 7061  ns") or self.npa
+000152b0: 7274 6974 696f 6e73 203d 3d20 313a 0a20  rtitions == 1:. 
+000152c0: 2020 2020 2020 2020 2020 2023 2043 616e             # Can
+000152d0: 2070 726f 7669 6465 2061 6e20 6578 6163   provide an exac
+000152e0: 7420 6d65 6469 616e 2069 6e20 7468 6573  t median in thes
+000152f0: 6520 6361 7365 730a 2020 2020 2020 2020  e cases.        
+00015300: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00015310: 6d65 6469 616e 5f61 7070 726f 7869 6d61  median_approxima
+00015320: 7465 2861 7869 733d 6178 6973 2c20 6d65  te(axis=axis, me
+00015330: 7468 6f64 3d6d 6574 686f 6429 0a20 2020  thod=method).   
+00015340: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00015350: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
+00015360: 2020 2020 2020 2020 2020 2020 2244 6173              "Das
+00015370: 6b20 646f 6573 6e27 7420 696d 706c 656d  k doesn't implem
+00015380: 656e 7420 616e 2065 7861 6374 206d 6564  ent an exact med
+00015390: 6961 6e20 696e 2061 6c6c 2063 6173 6573  ian in all cases
+000153a0: 2061 7320 7468 6973 2069 7320 6861 7264   as this is hard
+000153b0: 2074 6f20 646f 2069 6e20 7061 7261 6c6c   to do in parall
+000153c0: 656c 2e20 220a 2020 2020 2020 2020 2020  el. ".          
+000153d0: 2020 2253 6565 2074 6865 2060 6d65 6469    "See the `medi
+000153e0: 616e 5f61 7070 726f 7869 6d61 7465 6020  an_approximate` 
+000153f0: 6d65 7468 6f64 2069 6e73 7465 6164 2c20  method instead, 
+00015400: 7768 6963 6820 7573 6573 2061 6e20 6170  which uses an ap
+00015410: 7072 6f78 696d 6174 6520 616c 676f 7269  proximate algori
+00015420: 7468 6d2e 220a 2020 2020 2020 2020 290a  thm.".        ).
+00015430: 0a20 2020 2040 5f6e 756d 6572 6963 5f6f  .    @_numeric_o
+00015440: 6e6c 790a 2020 2020 4064 6572 6976 6564  nly.    @derived
+00015450: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00015460: 6d65 290a 2020 2020 6465 6620 7661 7228  me).    def var(
+00015470: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00015480: 2020 2020 2020 2061 7869 733d 4e6f 6e65         axis=None
+00015490: 2c0a 2020 2020 2020 2020 736b 6970 6e61  ,.        skipna
+000154a0: 3d54 7275 652c 0a20 2020 2020 2020 2064  =True,.        d
+000154b0: 646f 663d 312c 0a20 2020 2020 2020 2073  dof=1,.        s
+000154c0: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+000154d0: 2c0a 2020 2020 2020 2020 6474 7970 653d  ,.        dtype=
+000154e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6f75  None,.        ou
+000154f0: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
+00015500: 6e75 6d65 7269 635f 6f6e 6c79 3d4e 6f6e  numeric_only=Non
+00015510: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00015520: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
+00015530: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
+00015540: 7329 0a20 2020 2020 2020 205f 7261 6973  s).        _rais
+00015550: 655f 6966 5f6f 626a 6563 745f 7365 7269  e_if_object_seri
+00015560: 6573 2873 656c 662c 2022 7661 7222 290a  es(self, "var").
+00015570: 2020 2020 2020 2020 7769 7468 2063 6865          with che
+00015580: 636b 5f6e 756d 6572 6963 5f6f 6e6c 795f  ck_numeric_only_
+00015590: 6465 7072 6563 6174 696f 6e28 292c 2063  deprecation(), c
+000155a0: 6865 636b 5f6e 7569 7361 6e63 655f 636f  heck_nuisance_co
+000155b0: 6c75 6d6e 735f 7761 726e 696e 6728 293a  lumns_warning():
+000155c0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+000155d0: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
+000155e0: 6f6e 656d 7074 792e 7661 7228 0a20 2020  onempty.var(.   
+000155f0: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+00015600: 733d 6178 6973 2c20 736b 6970 6e61 3d73  s=axis, skipna=s
+00015610: 6b69 706e 612c 206e 756d 6572 6963 5f6f  kipna, numeric_o
+00015620: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
+00015630: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00015640: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+00015650: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00015660: 2072 6573 756c 7420 3d20 6d61 705f 7061   result = map_pa
+00015670: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+00015680: 2020 2020 2020 2020 2020 4d2e 7661 722c            M.var,
+00015690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000156a0: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
+000156b0: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
+000156c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000156d0: 2020 746f 6b65 6e3d 7365 6c66 2e5f 746f    token=self._to
+000156e0: 6b65 6e5f 7072 6566 6978 202b 2022 7661  ken_prefix + "va
+000156f0: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+00015700: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
+00015710: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00015720: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
+00015730: 2020 2020 2020 2020 2020 2020 2020 6464                dd
+00015740: 6f66 3d64 646f 662c 0a20 2020 2020 2020  of=ddof,.       
+00015750: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
+00015760: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
+00015770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015780: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
+00015790: 6d65 7269 635f 6f6e 6c79 2c0a 2020 2020  meric_only,.    
+000157a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000157b0: 2020 2020 2020 7265 7475 726e 2068 616e        return han
+000157c0: 646c 655f 6f75 7428 6f75 742c 2072 6573  dle_out(out, res
+000157d0: 756c 7429 0a20 2020 2020 2020 2065 6c73  ult).        els
+000157e0: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+000157f0: 6620 7365 6c66 2e6e 6469 6d20 3d3d 2031  f self.ndim == 1
+00015800: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00015810: 2020 7265 7375 6c74 203d 2073 656c 662e    result = self.
+00015820: 5f76 6172 5f31 6428 7365 6c66 2c20 736b  _var_1d(self, sk
+00015830: 6970 6e61 2c20 6464 6f66 2c20 7370 6c69  ipna, ddof, spli
+00015840: 745f 6576 6572 7929 0a20 2020 2020 2020  t_every).       
+00015850: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00015860: 6861 6e64 6c65 5f6f 7574 286f 7574 2c20  handle_out(out, 
+00015870: 7265 7375 6c74 290a 0a20 2020 2020 2020  result)..       
+00015880: 2020 2020 2023 2070 616e 6461 7320 312e       # pandas 1.
+00015890: 302b 2064 6f65 7320 6e6f 7420 696d 706c  0+ does not impl
+000158a0: 656d 656e 7420 7661 7220 6f6e 2074 696d  ement var on tim
+000158b0: 6564 656c 7461 0a20 2020 2020 2020 2020  edelta.         
+000158c0: 2020 2072 6573 756c 7420 3d20 7365 6c66     result = self
+000158d0: 2e5f 7661 725f 6e75 6d65 7269 6328 736b  ._var_numeric(sk
+000158e0: 6970 6e61 2c20 6464 6f66 2c20 7370 6c69  ipna, ddof, spli
+000158f0: 745f 6576 6572 7929 0a0a 2020 2020 2020  t_every)..      
+00015900: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00015910: 6e63 6528 7365 6c66 2c20 4461 7461 4672  nce(self, DataFr
+00015920: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
+00015930: 2020 2020 2020 7265 7375 6c74 2e64 6976        result.div
+00015940: 6973 696f 6e73 203d 2028 7365 6c66 2e63  isions = (self.c
+00015950: 6f6c 756d 6e73 2e6d 696e 2829 2c20 7365  olumns.min(), se
+00015960: 6c66 2e63 6f6c 756d 6e73 2e6d 6178 2829  lf.columns.max()
+00015970: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00015980: 7475 726e 2068 616e 646c 655f 6f75 7428  turn handle_out(
+00015990: 6f75 742c 2072 6573 756c 7429 0a0a 2020  out, result)..  
+000159a0: 2020 6465 6620 5f76 6172 5f6e 756d 6572    def _var_numer
+000159b0: 6963 2873 656c 662c 2073 6b69 706e 613d  ic(self, skipna=
+000159c0: 5472 7565 2c20 6464 6f66 3d31 2c20 7370  True, ddof=1, sp
+000159d0: 6c69 745f 6576 6572 793d 4661 6c73 6529  lit_every=False)
+000159e0: 3a0a 2020 2020 2020 2020 6e75 6d20 3d20  :.        num = 
+000159f0: 7365 6c66 2e73 656c 6563 745f 6474 7970  self.select_dtyp
+00015a00: 6573 2869 6e63 6c75 6465 3d5b 226e 756d  es(include=["num
+00015a10: 6265 7222 2c20 2262 6f6f 6c22 5d2c 2065  ber", "bool"], e
+00015a20: 7863 6c75 6465 3d5b 6e70 2e74 696d 6564  xclude=[np.timed
+00015a30: 656c 7461 3634 5d29 0a0a 2020 2020 2020  elta64])..      
+00015a40: 2020 7661 6c75 6573 5f64 7479 7065 203d    values_dtype =
+00015a50: 206e 756d 2e76 616c 7565 732e 6474 7970   num.values.dtyp
+00015a60: 650a 2020 2020 2020 2020 6172 7261 795f  e.        array_
 00015a70: 7661 6c75 6573 203d 206e 756d 2e76 616c  values = num.val
-00015a80: 7565 732e 6173 7479 7065 2822 6638 2229  ues.astype("f8")
-00015a90: 0a0a 2020 2020 2020 2020 7661 7220 3d20  ..        var = 
-00015aa0: 6461 2e6e 616e 7661 7220 6966 2073 6b69  da.nanvar if ski
-00015ab0: 706e 6120 6f72 2073 6b69 706e 6120 6973  pna or skipna is
-00015ac0: 204e 6f6e 6520 656c 7365 2064 612e 7661   None else da.va
-00015ad0: 720a 2020 2020 2020 2020 6172 7261 795f  r.        array_
-00015ae0: 7661 7220 3d20 7661 7228 6172 7261 795f  var = var(array_
-00015af0: 7661 6c75 6573 2c20 6178 6973 3d30 2c20  values, axis=0, 
-00015b00: 6464 6f66 3d64 646f 662c 2073 706c 6974  ddof=ddof, split
-00015b10: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-00015b20: 7279 290a 0a20 2020 2020 2020 206e 616d  ry)..        nam
-00015b30: 6520 3d20 7365 6c66 2e5f 746f 6b65 6e5f  e = self._token_
-00015b40: 7072 6566 6978 202b 2022 7661 722d 6e75  prefix + "var-nu
-00015b50: 6d65 7269 6322 202b 2074 6f6b 656e 697a  meric" + tokeniz
-00015b60: 6528 6e75 6d2c 2073 706c 6974 5f65 7665  e(num, split_eve
-00015b70: 7279 290a 2020 2020 2020 2020 636f 6c73  ry).        cols
-00015b80: 203d 206e 756d 2e5f 6d65 7461 2e63 6f6c   = num._meta.col
-00015b90: 756d 6e73 2069 6620 6973 5f64 6174 6166  umns if is_dataf
-00015ba0: 7261 6d65 5f6c 696b 6528 6e75 6d29 2065  rame_like(num) e
-00015bb0: 6c73 6520 4e6f 6e65 0a0a 2020 2020 2020  lse None..      
-00015bc0: 2020 7661 725f 7368 6170 6520 3d20 6e75    var_shape = nu
-00015bd0: 6d2e 5f6d 6574 615f 6e6f 6e65 6d70 7479  m._meta_nonempty
-00015be0: 2e76 616c 7565 732e 7661 7228 6178 6973  .values.var(axis
-00015bf0: 3d30 292e 7368 6170 650a 2020 2020 2020  =0).shape.      
-00015c00: 2020 6172 7261 795f 7661 725f 6e61 6d65    array_var_name
-00015c10: 203d 2028 6172 7261 795f 7661 722e 5f6e   = (array_var._n
-00015c20: 616d 652c 2920 2b20 2830 2c29 202a 206c  ame,) + (0,) * l
-00015c30: 656e 2876 6172 5f73 6861 7065 290a 0a20  en(var_shape).. 
-00015c40: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
-00015c50: 286e 616d 652c 2030 293a 2028 6d65 7468  (name, 0): (meth
-00015c60: 6f64 732e 7772 6170 5f76 6172 5f72 6564  ods.wrap_var_red
-00015c70: 7563 7469 6f6e 2c20 6172 7261 795f 7661  uction, array_va
-00015c80: 725f 6e61 6d65 2c20 636f 6c73 297d 0a20  r_name, cols)}. 
-00015c90: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
-00015ca0: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-00015cb0: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
-00015cc0: 616d 652c 206c 6179 6572 2c20 6465 7065  ame, layer, depe
-00015cd0: 6e64 656e 6369 6573 3d5b 6172 7261 795f  ndencies=[array_
-00015ce0: 7661 725d 290a 0a20 2020 2020 2020 2072  var])..        r
-00015cf0: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
-00015d00: 6563 7428 0a20 2020 2020 2020 2020 2020  ect(.           
-00015d10: 2067 7261 7068 2c20 6e61 6d65 2c20 6e75   graph, name, nu
-00015d20: 6d2e 5f6d 6574 615f 6e6f 6e65 6d70 7479  m._meta_nonempty
-00015d30: 2e76 6172 2829 2c20 6469 7669 7369 6f6e  .var(), division
-00015d40: 733d 5b4e 6f6e 652c 204e 6f6e 655d 0a20  s=[None, None]. 
-00015d50: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00015d60: 6620 5f76 6172 5f74 696d 6564 656c 7461  f _var_timedelta
-00015d70: 7328 7365 6c66 2c20 736b 6970 6e61 3d54  s(self, skipna=T
-00015d80: 7275 652c 2064 646f 663d 312c 2073 706c  rue, ddof=1, spl
-00015d90: 6974 5f65 7665 7279 3d46 616c 7365 293a  it_every=False):
-00015da0: 0a20 2020 2020 2020 2074 696d 6564 656c  .        timedel
-00015db0: 7461 7320 3d20 7365 6c66 2e73 656c 6563  tas = self.selec
-00015dc0: 745f 6474 7970 6573 2869 6e63 6c75 6465  t_dtypes(include
-00015dd0: 3d5b 6e70 2e74 696d 6564 656c 7461 3634  =[np.timedelta64
-00015de0: 5d29 0a0a 2020 2020 2020 2020 7661 725f  ])..        var_
-00015df0: 7469 6d65 6465 6c74 6173 203d 205b 0a20  timedeltas = [. 
-00015e00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00015e10: 5f76 6172 5f31 6428 7469 6d65 6465 6c74  _var_1d(timedelt
-00015e20: 6173 5b63 6f6c 5f69 6478 5d2c 2073 6b69  as[col_idx], ski
-00015e30: 706e 612c 2064 646f 662c 2073 706c 6974  pna, ddof, split
-00015e40: 5f65 7665 7279 290a 2020 2020 2020 2020  _every).        
-00015e50: 2020 2020 666f 7220 636f 6c5f 6964 7820      for col_idx 
-00015e60: 696e 2074 696d 6564 656c 7461 732e 5f6d  in timedeltas._m
-00015e70: 6574 612e 636f 6c75 6d6e 730a 2020 2020  eta.columns.    
-00015e80: 2020 2020 5d0a 2020 2020 2020 2020 7661      ].        va
-00015e90: 725f 7469 6d65 6465 6c74 615f 6e61 6d65  r_timedelta_name
-00015ea0: 7320 3d20 5b28 762e 5f6e 616d 652c 2030  s = [(v._name, 0
-00015eb0: 2920 666f 7220 7620 696e 2076 6172 5f74  ) for v in var_t
-00015ec0: 696d 6564 656c 7461 735d 0a0a 2020 2020  imedeltas]..    
-00015ed0: 2020 2020 6e61 6d65 203d 2028 0a20 2020      name = (.   
-00015ee0: 2020 2020 2020 2020 2073 656c 662e 5f74           self._t
-00015ef0: 6f6b 656e 5f70 7265 6669 7820 2b20 2276  oken_prefix + "v
-00015f00: 6172 2d74 696d 6564 656c 7461 732d 2220  ar-timedeltas-" 
-00015f10: 2b20 746f 6b65 6e69 7a65 2874 696d 6564  + tokenize(timed
-00015f20: 656c 7461 732c 2073 706c 6974 5f65 7665  eltas, split_eve
-00015f30: 7279 290a 2020 2020 2020 2020 290a 0a20  ry).        ).. 
-00015f40: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
-00015f50: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
-00015f60: 6d65 2c20 3029 3a20 280a 2020 2020 2020  me, 0): (.      
-00015f70: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-00015f80: 732e 7772 6170 5f76 6172 5f72 6564 7563  s.wrap_var_reduc
-00015f90: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-00015fa0: 2020 2020 2020 7661 725f 7469 6d65 6465        var_timede
-00015fb0: 6c74 615f 6e61 6d65 732c 0a20 2020 2020  lta_names,.     
-00015fc0: 2020 2020 2020 2020 2020 2074 696d 6564             timed
-00015fd0: 656c 7461 732e 5f6d 6574 612e 636f 6c75  eltas._meta.colu
-00015fe0: 6d6e 732c 0a20 2020 2020 2020 2020 2020  mns,.           
-00015ff0: 2029 0a20 2020 2020 2020 207d 0a20 2020   ).        }.   
-00016000: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
-00016010: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-00016020: 5f63 6f6c 6c65 6374 696f 6e73 280a 2020  _collections(.  
-00016030: 2020 2020 2020 2020 2020 6e61 6d65 2c20            name, 
-00016040: 6c61 7965 722c 2064 6570 656e 6465 6e63  layer, dependenc
-00016050: 6965 733d 7661 725f 7469 6d65 6465 6c74  ies=var_timedelt
-00016060: 6173 0a20 2020 2020 2020 2029 0a0a 2020  as.        )..  
-00016070: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-00016080: 5f64 645f 6f62 6a65 6374 280a 2020 2020  _dd_object(.    
-00016090: 2020 2020 2020 2020 6772 6170 682c 206e          graph, n
-000160a0: 616d 652c 2074 696d 6564 656c 7461 732e  ame, timedeltas.
-000160b0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e76  _meta_nonempty.v
-000160c0: 6172 2829 2c20 6469 7669 7369 6f6e 733d  ar(), divisions=
-000160d0: 5b4e 6f6e 652c 204e 6f6e 655d 0a20 2020  [None, None].   
-000160e0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-000160f0: 5f76 6172 5f6d 6978 6564 2873 656c 662c  _var_mixed(self,
-00016100: 2073 6b69 706e 613d 5472 7565 2c20 6464   skipna=True, dd
-00016110: 6f66 3d31 2c20 7370 6c69 745f 6576 6572  of=1, split_ever
-00016120: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
-00016130: 2020 6461 7461 203d 2073 656c 662e 7365    data = self.se
-00016140: 6c65 6374 5f64 7479 7065 7328 696e 636c  lect_dtypes(incl
-00016150: 7564 653d 5b22 6e75 6d62 6572 222c 2022  ude=["number", "
-00016160: 626f 6f6c 222c 206e 702e 7469 6d65 6465  bool", np.timede
-00016170: 6c74 6136 345d 290a 0a20 2020 2020 2020  lta64])..       
-00016180: 2074 696d 6564 656c 7461 5f76 6172 7320   timedelta_vars 
-00016190: 3d20 7365 6c66 2e5f 7661 725f 7469 6d65  = self._var_time
-000161a0: 6465 6c74 6173 2873 6b69 706e 612c 2064  deltas(skipna, d
-000161b0: 646f 662c 2073 706c 6974 5f65 7665 7279  dof, split_every
-000161c0: 290a 2020 2020 2020 2020 6e75 6d65 7269  ).        numeri
-000161d0: 635f 7661 7273 203d 2073 656c 662e 5f76  c_vars = self._v
-000161e0: 6172 5f6e 756d 6572 6963 2873 6b69 706e  ar_numeric(skipn
-000161f0: 612c 2064 646f 662c 2073 706c 6974 5f65  a, ddof, split_e
-00016200: 7665 7279 290a 0a20 2020 2020 2020 206e  very)..        n
-00016210: 616d 6520 3d20 7365 6c66 2e5f 746f 6b65  ame = self._toke
-00016220: 6e5f 7072 6566 6978 202b 2022 7661 722d  n_prefix + "var-
-00016230: 6d69 7865 642d 2220 2b20 746f 6b65 6e69  mixed-" + tokeni
-00016240: 7a65 2864 6174 612c 2073 706c 6974 5f65  ze(data, split_e
-00016250: 7665 7279 290a 0a20 2020 2020 2020 206c  very)..        l
-00016260: 6179 6572 203d 207b 0a20 2020 2020 2020  ayer = {.       
-00016270: 2020 2020 2028 6e61 6d65 2c20 3029 3a20       (name, 0): 
-00016280: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00016290: 2020 6d65 7468 6f64 732e 7661 725f 6d69    methods.var_mi
-000162a0: 7865 645f 636f 6e63 6174 2c0a 2020 2020  xed_concat,.    
-000162b0: 2020 2020 2020 2020 2020 2020 286e 756d              (num
-000162c0: 6572 6963 5f76 6172 732e 5f6e 616d 652c  eric_vars._name,
-000162d0: 2030 292c 0a20 2020 2020 2020 2020 2020   0),.           
-000162e0: 2020 2020 2028 7469 6d65 6465 6c74 615f       (timedelta_
-000162f0: 7661 7273 2e5f 6e61 6d65 2c20 3029 2c0a  vars._name, 0),.
-00016300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016310: 6461 7461 2e5f 6d65 7461 2e63 6f6c 756d  data._meta.colum
-00016320: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-00016330: 290a 2020 2020 2020 2020 7d0a 0a20 2020  ).        }..   
-00016340: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
-00016350: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-00016360: 5f63 6f6c 6c65 6374 696f 6e73 280a 2020  _collections(.  
-00016370: 2020 2020 2020 2020 2020 6e61 6d65 2c20            name, 
-00016380: 6c61 7965 722c 2064 6570 656e 6465 6e63  layer, dependenc
-00016390: 6965 733d 5b6e 756d 6572 6963 5f76 6172  ies=[numeric_var
-000163a0: 732c 2074 696d 6564 656c 7461 5f76 6172  s, timedelta_var
-000163b0: 735d 0a20 2020 2020 2020 2029 0a20 2020  s].        ).   
-000163c0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-000163d0: 6464 5f6f 626a 6563 7428 0a20 2020 2020  dd_object(.     
-000163e0: 2020 2020 2020 2067 7261 7068 2c20 6e61         graph, na
-000163f0: 6d65 2c20 7365 6c66 2e5f 6d65 7461 5f6e  me, self._meta_n
-00016400: 6f6e 656d 7074 792e 7661 7228 292c 2064  onempty.var(), d
-00016410: 6976 6973 696f 6e73 3d5b 4e6f 6e65 2c20  ivisions=[None, 
-00016420: 4e6f 6e65 5d0a 2020 2020 2020 2020 290a  None].        ).
-00016430: 0a20 2020 2064 6566 205f 7661 725f 3164  .    def _var_1d
-00016440: 2873 656c 662c 2063 6f6c 756d 6e2c 2073  (self, column, s
-00016450: 6b69 706e 613d 5472 7565 2c20 6464 6f66  kipna=True, ddof
-00016460: 3d31 2c20 7370 6c69 745f 6576 6572 793d  =1, split_every=
-00016470: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
-00016480: 6973 5f74 696d 6564 656c 7461 203d 2069  is_timedelta = i
-00016490: 735f 7469 6d65 6465 6c74 6136 345f 6474  s_timedelta64_dt
-000164a0: 7970 6528 636f 6c75 6d6e 2e5f 6d65 7461  ype(column._meta
-000164b0: 290a 0a20 2020 2020 2020 2069 6620 6973  )..        if is
-000164c0: 5f74 696d 6564 656c 7461 3a0a 2020 2020  _timedelta:.    
-000164d0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-000164e0: 6b69 706e 613a 0a20 2020 2020 2020 2020  kipna:.         
-000164f0: 2020 2020 2020 2069 735f 6e61 6e20 3d20         is_nan = 
-00016500: 636f 6c75 6d6e 2e69 736e 6128 290a 2020  column.isna().  
-00016510: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00016520: 6c75 6d6e 203d 2063 6f6c 756d 6e2e 6173  lumn = column.as
-00016530: 7479 7065 2822 6938 2229 0a20 2020 2020  type("i8").     
-00016540: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-00016550: 6e20 3d20 636f 6c75 6d6e 2e6d 6173 6b28  n = column.mask(
-00016560: 6973 5f6e 616e 290a 2020 2020 2020 2020  is_nan).        
-00016570: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00016580: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-00016590: 203d 2063 6f6c 756d 6e2e 6472 6f70 6e61   = column.dropna
-000165a0: 2829 2e61 7374 7970 6528 2269 3822 290a  ().astype("i8").
-000165b0: 0a20 2020 2020 2020 2069 6620 7064 2e49  .        if pd.I
-000165c0: 6e74 3634 4474 7970 652e 6973 5f64 7479  nt64Dtype.is_dty
-000165d0: 7065 2863 6f6c 756d 6e2e 5f6d 6574 615f  pe(column._meta_
-000165e0: 6e6f 6e65 6d70 7479 293a 0a20 2020 2020  nonempty):.     
-000165f0: 2020 2020 2020 2063 6f6c 756d 6e20 3d20         column = 
-00016600: 636f 6c75 6d6e 2e61 7374 7970 6528 2266  column.astype("f
-00016610: 3822 290a 0a20 2020 2020 2020 2069 6620  8")..        if 
-00016620: 6e6f 7420 6e70 2e69 7373 7562 6474 7970  not np.issubdtyp
-00016630: 6528 636f 6c75 6d6e 2e64 7479 7065 2c20  e(column.dtype, 
-00016640: 6e70 2e6e 756d 6265 7229 3a0a 2020 2020  np.number):.    
-00016650: 2020 2020 2020 2020 636f 6c75 6d6e 203d          column =
-00016660: 2063 6f6c 756d 6e2e 6173 7479 7065 2822   column.astype("
-00016670: 6638 2229 0a0a 2020 2020 2020 2020 6e61  f8")..        na
-00016680: 6d65 203d 2073 656c 662e 5f74 6f6b 656e  me = self._token
-00016690: 5f70 7265 6669 7820 2b20 2276 6172 2d31  _prefix + "var-1
-000166a0: 642d 2220 2b20 746f 6b65 6e69 7a65 2863  d-" + tokenize(c
-000166b0: 6f6c 756d 6e2c 2073 706c 6974 5f65 7665  olumn, split_eve
-000166c0: 7279 290a 0a20 2020 2020 2020 2076 6172  ry)..        var
-000166d0: 203d 2064 612e 6e61 6e76 6172 2069 6620   = da.nanvar if 
-000166e0: 736b 6970 6e61 206f 7220 736b 6970 6e61  skipna or skipna
-000166f0: 2069 7320 4e6f 6e65 2065 6c73 6520 6461   is None else da
-00016700: 2e76 6172 0a20 2020 2020 2020 2061 7272  .var.        arr
-00016710: 6179 5f76 6172 203d 2076 6172 2863 6f6c  ay_var = var(col
-00016720: 756d 6e2e 7661 6c75 6573 2c20 6178 6973  umn.values, axis
-00016730: 3d30 2c20 6464 6f66 3d64 646f 662c 2073  =0, ddof=ddof, s
-00016740: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-00016750: 5f65 7665 7279 290a 0a20 2020 2020 2020  _every)..       
-00016760: 206c 6179 6572 203d 207b 286e 616d 652c   layer = {(name,
-00016770: 2030 293a 2028 6d65 7468 6f64 732e 7772   0): (methods.wr
-00016780: 6170 5f76 6172 5f72 6564 7563 7469 6f6e  ap_var_reduction
-00016790: 2c20 2861 7272 6179 5f76 6172 2e5f 6e61  , (array_var._na
-000167a0: 6d65 2c29 2c20 4e6f 6e65 297d 0a20 2020  me,), None)}.   
-000167b0: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
-000167c0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-000167d0: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
-000167e0: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
-000167f0: 656e 6369 6573 3d5b 6172 7261 795f 7661  encies=[array_va
-00016800: 725d 290a 0a20 2020 2020 2020 2072 6574  r])..        ret
-00016810: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
-00016820: 7428 0a20 2020 2020 2020 2020 2020 2067  t(.            g
-00016830: 7261 7068 2c20 6e61 6d65 2c20 636f 6c75  raph, name, colu
-00016840: 6d6e 2e5f 6d65 7461 5f6e 6f6e 656d 7074  mn._meta_nonempt
-00016850: 792e 7661 7228 292c 2064 6976 6973 696f  y.var(), divisio
-00016860: 6e73 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d0a  ns=[None, None].
-00016870: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00016880: 5f6e 756d 6572 6963 5f64 6174 610a 2020  _numeric_data.  
-00016890: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-000168a0: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-000168b0: 2020 6465 6620 7374 6428 0a20 2020 2020    def std(.     
-000168c0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-000168d0: 2061 7869 733d 4e6f 6e65 2c0a 2020 2020   axis=None,.    
-000168e0: 2020 2020 736b 6970 6e61 3d54 7275 652c      skipna=True,
-000168f0: 0a20 2020 2020 2020 2064 646f 663d 312c  .        ddof=1,
-00016900: 0a20 2020 2020 2020 2073 706c 6974 5f65  .        split_e
-00016910: 7665 7279 3d46 616c 7365 2c0a 2020 2020  very=False,.    
-00016920: 2020 2020 6474 7970 653d 4e6f 6e65 2c0a      dtype=None,.
-00016930: 2020 2020 2020 2020 6f75 743d 4e6f 6e65          out=None
-00016940: 2c0a 2020 2020 2020 2020 6e75 6d65 7269  ,.        numeri
-00016950: 635f 6f6e 6c79 3d6e 6f5f 6465 6661 756c  c_only=no_defaul
-00016960: 742c 0a20 2020 2029 3a0a 2020 2020 2020  t,.    ):.      
-00016970: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
-00016980: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
-00016990: 7329 0a20 2020 2020 2020 205f 7261 6973  s).        _rais
-000169a0: 655f 6966 5f6f 626a 6563 745f 7365 7269  e_if_object_seri
-000169b0: 6573 2873 656c 662c 2022 7374 6422 290a  es(self, "std").
-000169c0: 2020 2020 2020 2020 5f72 6169 7365 5f69          _raise_i
-000169d0: 665f 6e6f 745f 7365 7269 6573 5f6f 725f  f_not_series_or_
-000169e0: 6461 7461 6672 616d 6528 7365 6c66 2c20  dataframe(self, 
-000169f0: 2273 7464 2229 0a20 2020 2020 2020 206e  "std").        n
-00016a00: 756d 6572 6963 5f6b 7761 7267 7320 3d20  umeric_kwargs = 
-00016a10: 5f6e 756d 6572 6963 5f6f 6e6c 795f 6d61  _numeric_only_ma
-00016a20: 7962 655f 7761 726e 2873 656c 662c 206e  ybe_warn(self, n
-00016a30: 756d 6572 6963 5f6f 6e6c 7929 0a0a 2020  umeric_only)..  
-00016a40: 2020 2020 2020 7769 7468 2063 6865 636b        with check
-00016a50: 5f6e 756d 6572 6963 5f6f 6e6c 795f 6465  _numeric_only_de
-00016a60: 7072 6563 6174 696f 6e28 292c 2063 6865  precation(), che
-00016a70: 636b 5f6e 7569 7361 6e63 655f 636f 6c75  ck_nuisance_colu
-00016a80: 6d6e 735f 7761 726e 696e 6728 293a 0a20  mns_warning():. 
-00016a90: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
-00016aa0: 3d20 7365 6c66 2e5f 6d65 7461 5f6e 6f6e  = self._meta_non
-00016ab0: 656d 7074 792e 7374 6428 6178 6973 3d61  empty.std(axis=a
-00016ac0: 7869 732c 2073 6b69 706e 613d 736b 6970  xis, skipna=skip
-00016ad0: 6e61 2c20 2a2a 6e75 6d65 7269 635f 6b77  na, **numeric_kw
-00016ae0: 6172 6773 290a 2020 2020 2020 2020 6973  args).        is
-00016af0: 5f64 665f 6c69 6b65 203d 2069 735f 6461  _df_like = is_da
-00016b00: 7461 6672 616d 655f 6c69 6b65 2873 656c  taframe_like(sel
-00016b10: 662e 5f6d 6574 6129 0a20 2020 2020 2020  f._meta).       
-00016b20: 206e 6565 6473 5f74 696d 655f 636f 6e76   needs_time_conv
-00016b30: 6572 7369 6f6e 203d 2046 616c 7365 0a20  ersion = False. 
-00016b40: 2020 2020 2020 206e 756d 6572 6963 5f64         numeric_d
-00016b50: 6420 3d20 7365 6c66 0a0a 2020 2020 2020  d = self..      
-00016b60: 2020 6966 2069 735f 6466 5f6c 696b 653a    if is_df_like:
-00016b70: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
-00016b80: 655f 636f 6c73 203d 2073 656c 662e 5f6d  e_cols = self._m
-00016b90: 6574 612e 7365 6c65 6374 5f64 7479 7065  eta.select_dtype
-00016ba0: 7328 696e 636c 7564 653d 2264 6174 6574  s(include="datet
-00016bb0: 696d 6522 292e 636f 6c75 6d6e 730a 2020  ime").columns.  
-00016bc0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00016bd0: 2874 696d 655f 636f 6c73 2920 3e20 303a  (time_cols) > 0:
-00016be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016bf0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00016c00: 2020 2020 2020 206e 756d 6572 6963 5f64         numeric_d
-00016c10: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
-00016c20: 2020 2020 2020 206e 6565 6473 5f74 696d         needs_tim
-00016c30: 655f 636f 6e76 6572 7369 6f6e 2c0a 2020  e_conversion,.  
-00016c40: 2020 2020 2020 2020 2020 2020 2020 2920                ) 
-00016c50: 3d20 7365 6c66 2e5f 636f 6e76 6572 745f  = self._convert_
-00016c60: 7469 6d65 5f63 6f6c 735f 746f 5f6e 756d  time_cols_to_num
-00016c70: 6572 6963 2874 696d 655f 636f 6c73 2c20  eric(time_cols, 
-00016c80: 6178 6973 2c20 6d65 7461 2c20 736b 6970  axis, meta, skip
-00016c90: 6e61 290a 2020 2020 2020 2020 656c 7365  na).        else
-00016ca0: 3a0a 2020 2020 2020 2020 2020 2020 6e65  :.            ne
-00016cb0: 6564 735f 7469 6d65 5f63 6f6e 7665 7273  eds_time_convers
-00016cc0: 696f 6e20 3d20 6973 5f64 6174 6574 696d  ion = is_datetim
-00016cd0: 6536 345f 616e 795f 6474 7970 6528 7365  e64_any_dtype(se
-00016ce0: 6c66 2e5f 6d65 7461 290a 2020 2020 2020  lf._meta).      
-00016cf0: 2020 2020 2020 6966 206e 6565 6473 5f74        if needs_t
-00016d00: 696d 655f 636f 6e76 6572 7369 6f6e 3a0a  ime_conversion:.
-00016d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d20: 6e75 6d65 7269 635f 6464 203d 205f 636f  numeric_dd = _co
-00016d30: 6e76 6572 745f 746f 5f6e 756d 6572 6963  nvert_to_numeric
-00016d40: 2873 656c 662c 2073 6b69 706e 6129 0a0a  (self, skipna)..
-00016d50: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-00016d60: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-00016d70: 2020 7265 7375 6c74 203d 206d 6170 5f70    result = map_p
-00016d80: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-00016d90: 2020 2020 2020 2020 2020 204d 2e73 7464             M.std
-00016da0: 2069 6620 6e6f 7420 6e65 6564 735f 7469   if not needs_ti
-00016db0: 6d65 5f63 6f6e 7665 7273 696f 6e20 656c  me_conversion el
-00016dc0: 7365 205f 7371 7274 5f61 6e64 5f63 6f6e  se _sqrt_and_con
-00016dd0: 7665 7274 5f74 6f5f 7469 6d65 6465 6c74  vert_to_timedelt
-00016de0: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-00016df0: 2020 206e 756d 6572 6963 5f64 642c 0a20     numeric_dd,. 
-00016e00: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00016e10: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
-00016e20: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
-00016e30: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
-00016e40: 6978 202b 2022 7374 6422 2c0a 2020 2020  ix + "std",.    
-00016e50: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00016e60: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
-00016e70: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
-00016e80: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
-00016e90: 2020 2020 2020 6464 6f66 3d64 646f 662c        ddof=ddof,
-00016ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016eb0: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-00016ec0: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
-00016ed0: 2020 2020 2020 2020 202a 2a6e 756d 6572           **numer
-00016ee0: 6963 5f6b 7761 7267 732c 0a20 2020 2020  ic_kwargs,.     
-00016ef0: 2020 2020 2020 2020 2020 2070 6172 656e             paren
-00016f00: 745f 6d65 7461 3d73 656c 662e 5f6d 6574  t_meta=self._met
-00016f10: 612c 0a20 2020 2020 2020 2020 2020 2029  a,.            )
-00016f20: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00016f30: 7572 6e20 6861 6e64 6c65 5f6f 7574 286f  urn handle_out(o
-00016f40: 7574 2c20 7265 7375 6c74 290a 0a20 2020  ut, result)..   
-00016f50: 2020 2020 2023 2043 6173 6520 7768 6572       # Case wher
-00016f60: 6520 6178 6973 3d30 206f 7220 6178 6973  e axis=0 or axis
-00016f70: 3d4e 6f6e 650a 2020 2020 2020 2020 7620  =None.        v 
-00016f80: 3d20 6e75 6d65 7269 635f 6464 2e76 6172  = numeric_dd.var
-00016f90: 2873 6b69 706e 613d 736b 6970 6e61 2c20  (skipna=skipna, 
-00016fa0: 6464 6f66 3d64 646f 662c 2073 706c 6974  ddof=ddof, split
-00016fb0: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-00016fc0: 7279 290a 2020 2020 2020 2020 6e61 6d65  ry).        name
-00016fd0: 203d 2073 656c 662e 5f74 6f6b 656e 5f70   = self._token_p
-00016fe0: 7265 6669 7820 2b20 2273 7464 220a 0a20  refix + "std".. 
-00016ff0: 2020 2020 2020 2069 6620 6e65 6564 735f         if needs_
-00017000: 7469 6d65 5f63 6f6e 7665 7273 696f 6e3a  time_conversion:
-00017010: 0a20 2020 2020 2020 2020 2020 2073 7172  .            sqr
-00017020: 745f 6675 6e63 5f6b 7761 7267 7320 3d20  t_func_kwargs = 
-00017030: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00017040: 2020 2269 735f 6466 5f6c 696b 6522 3a20    "is_df_like": 
-00017050: 6973 5f64 665f 6c69 6b65 2c0a 2020 2020  is_df_like,.    
-00017060: 2020 2020 2020 2020 2020 2020 2274 696d              "tim
-00017070: 655f 636f 6c73 223a 2074 696d 655f 636f  e_cols": time_co
-00017080: 6c73 2069 6620 6973 5f64 665f 6c69 6b65  ls if is_df_like
-00017090: 2065 6c73 6520 4e6f 6e65 2c0a 2020 2020   else None,.    
-000170a0: 2020 2020 2020 2020 2020 2020 2261 7869              "axi
-000170b0: 7322 3a20 6178 6973 2c0a 2020 2020 2020  s": axis,.      
-000170c0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-000170d0: 2020 2020 7371 7274 5f66 756e 6320 3d20      sqrt_func = 
-000170e0: 5f73 7172 745f 616e 645f 636f 6e76 6572  _sqrt_and_conver
-000170f0: 745f 746f 5f74 696d 6564 656c 7461 0a20  t_to_timedelta. 
-00017100: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00017110: 2020 2020 2020 2020 2073 7172 745f 6675           sqrt_fu
-00017120: 6e63 5f6b 7761 7267 7320 3d20 7b7d 0a20  nc_kwargs = {}. 
-00017130: 2020 2020 2020 2020 2020 2073 7172 745f             sqrt_
-00017140: 6675 6e63 203d 206e 702e 7371 7274 0a0a  func = np.sqrt..
-00017150: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-00017160: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
-00017170: 0a20 2020 2020 2020 2020 2020 2073 7172  .            sqr
-00017180: 745f 6675 6e63 2c0a 2020 2020 2020 2020  t_func,.        
-00017190: 2020 2020 762c 0a20 2020 2020 2020 2020      v,.         
-000171a0: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
-000171b0: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
-000171c0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-000171d0: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
-000171e0: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
-000171f0: 2020 2020 2020 7061 7265 6e74 5f6d 6574        parent_met
-00017200: 613d 7365 6c66 2e5f 6d65 7461 2c0a 2020  a=self._meta,.  
-00017210: 2020 2020 2020 2020 2020 2a2a 7371 7274            **sqrt
-00017220: 5f66 756e 635f 6b77 6172 6773 2c0a 2020  _func_kwargs,.  
-00017230: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00017240: 2023 2054 7279 2074 6f20 6d61 7463 6820   # Try to match 
-00017250: 7468 6520 5061 6e64 6173 2072 6573 756c  the Pandas resul
-00017260: 7420 6474 7970 650a 2020 2020 2020 2020  t dtype.        
-00017270: 6966 2069 735f 6466 5f6c 696b 6520 616e  if is_df_like an
-00017280: 6420 6861 7361 7474 7228 6d65 7461 2c20  d hasattr(meta, 
-00017290: 2264 7479 7065 2229 3a0a 2020 2020 2020  "dtype"):.      
-000172a0: 2020 2020 2020 7265 7375 6c74 203d 2072        result = r
-000172b0: 6573 756c 742e 6173 7479 7065 286d 6574  esult.astype(met
-000172c0: 612e 6474 7970 6529 0a0a 2020 2020 2020  a.dtype)..      
-000172d0: 2020 7265 7475 726e 2068 616e 646c 655f    return handle_
-000172e0: 6f75 7428 6f75 742c 2072 6573 756c 7429  out(out, result)
-000172f0: 0a0a 2020 2020 6465 6620 5f63 6f6e 7665  ..    def _conve
-00017300: 7274 5f74 696d 655f 636f 6c73 5f74 6f5f  rt_time_cols_to_
-00017310: 6e75 6d65 7269 6328 7365 6c66 2c20 7469  numeric(self, ti
-00017320: 6d65 5f63 6f6c 732c 2061 7869 732c 206d  me_cols, axis, m
-00017330: 6574 612c 2073 6b69 706e 6129 3a0a 2020  eta, skipna):.  
-00017340: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-00017350: 6461 7461 6672 616d 652e 696f 2069 6d70  dataframe.io imp
-00017360: 6f72 7420 6672 6f6d 5f70 616e 6461 730a  ort from_pandas.
-00017370: 0a20 2020 2020 2020 206e 6565 6473 5f74  .        needs_t
-00017380: 696d 655f 636f 6e76 6572 7369 6f6e 203d  ime_conversion =
-00017390: 2054 7275 650a 0a20 2020 2020 2020 2023   True..        #
-000173a0: 2045 6e73 7572 6520 616c 6c20 636f 6c75   Ensure all colu
-000173b0: 6d6e 7320 6172 6520 636f 7272 6563 7420  mns are correct 
-000173c0: 7479 7065 2e20 4e65 6564 2074 6f20 7368  type. Need to sh
-000173d0: 616c 6c6f 7720 636f 7079 2073 696e 6365  allow copy since
-000173e0: 2063 6f6c 7320 7769 6c6c 2062 6520 6d6f   cols will be mo
-000173f0: 6469 6669 6564 0a20 2020 2020 2020 2069  dified.        i
-00017400: 6620 6178 6973 203d 3d20 303a 0a20 2020  f axis == 0:.   
-00017410: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
-00017420: 5f64 6420 3d20 7365 6c66 5b6d 6574 612e  _dd = self[meta.
-00017430: 696e 6465 785d 2e63 6f70 7928 290a 2020  index].copy().  
-00017440: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00017450: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
-00017460: 6464 203d 2073 656c 662e 636f 7079 2829  dd = self.copy()
-00017470: 0a0a 2020 2020 2020 2020 2320 4d69 7820  ..        # Mix 
-00017480: 6f66 2064 6174 6574 696d 6573 2077 6974  of datetimes wit
-00017490: 6820 6f74 6865 7220 6e75 6d65 7269 6320  h other numeric 
-000174a0: 7479 7065 7320 7072 6f64 7563 6573 204e  types produces N
-000174b0: 614e 7320 666f 7220 6561 6368 2076 616c  aNs for each val
-000174c0: 7565 2069 6e20 7374 6428 2920 7365 7269  ue in std() seri
-000174d0: 6573 0a20 2020 2020 2020 2069 6620 6178  es.        if ax
-000174e0: 6973 203d 3d20 3120 616e 6420 6c65 6e28  is == 1 and len(
-000174f0: 7469 6d65 5f63 6f6c 7329 2021 3d20 6c65  time_cols) != le
-00017500: 6e28 7365 6c66 2e63 6f6c 756d 6e73 293a  n(self.columns):
-00017510: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
-00017520: 6869 7320 6973 2066 6173 7465 7220 7468  his is faster th
-00017530: 616e 2063 6f6e 7665 7274 696e 6720 6561  an converting ea
-00017540: 6368 2063 6f6c 756d 6e20 746f 206e 756d  ch column to num
-00017550: 6572 6963 2077 6865 6e20 6974 2773 206e  eric when it's n
-00017560: 6f74 206e 6563 6573 7361 7279 0a20 2020  ot necessary.   
-00017570: 2020 2020 2020 2020 2023 2073 696e 6365           # since
-00017580: 2065 6163 6820 7374 616e 6461 7264 2064   each standard d
-00017590: 6576 6961 7469 6f6e 2077 696c 6c20 6a75  eviation will ju
-000175a0: 7374 2062 6520 4e61 4e0a 2020 2020 2020  st be NaN.      
-000175b0: 2020 2020 2020 6e65 6564 735f 7469 6d65        needs_time
-000175c0: 5f63 6f6e 7665 7273 696f 6e20 3d20 4661  _conversion = Fa
-000175d0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-000175e0: 6e75 6d65 7269 635f 6464 203d 2066 726f  numeric_dd = fro
-000175f0: 6d5f 7061 6e64 6173 280a 2020 2020 2020  m_pandas(.      
-00017600: 2020 2020 2020 2020 2020 6d65 7461 5f66            meta_f
-00017610: 7261 6d65 5f63 6f6e 7374 7275 6374 6f72  rame_constructor
-00017620: 2873 656c 6629 280a 2020 2020 2020 2020  (self)(.        
-00017630: 2020 2020 2020 2020 2020 2020 7b22 5f22              {"_"
-00017640: 3a20 6d65 7461 5f73 6572 6965 735f 636f  : meta_series_co
-00017650: 6e73 7472 7563 746f 7228 7365 6c66 2928  nstructor(self)(
-00017660: 5b6e 702e 6e61 6e5d 297d 2c0a 2020 2020  [np.nan])},.    
-00017670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017680: 696e 6465 783d 7365 6c66 2e69 6e64 6578  index=self.index
-00017690: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000176a0: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
-000176b0: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
-000176c0: 3d73 656c 662e 6e70 6172 7469 7469 6f6e  =self.npartition
-000176d0: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
-000176e0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000176f0: 2020 2020 2020 2020 2020 2023 2043 6f6e             # Con
-00017700: 7665 7274 2074 696d 6564 656c 7461 2061  vert timedelta a
-00017710: 6e64 2064 6174 6574 696d 6520 636f 6c75  nd datetime colu
-00017720: 6d6e 7320 746f 2069 6e74 6567 6572 2074  mns to integer t
-00017730: 7970 6573 2073 6f20 7765 2063 616e 2075  ypes so we can u
-00017740: 7365 2076 6172 0a20 2020 2020 2020 2020  se var.         
-00017750: 2020 2066 6f72 2063 6f6c 2069 6e20 7469     for col in ti
-00017760: 6d65 5f63 6f6c 733a 0a20 2020 2020 2020  me_cols:.       
-00017770: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
-00017780: 5f64 645b 636f 6c5d 203d 205f 636f 6e76  _dd[col] = _conv
-00017790: 6572 745f 746f 5f6e 756d 6572 6963 286e  ert_to_numeric(n
-000177a0: 756d 6572 6963 5f64 645b 636f 6c5d 2c20  umeric_dd[col], 
-000177b0: 736b 6970 6e61 290a 0a20 2020 2020 2020  skipna)..       
-000177c0: 2072 6574 7572 6e20 6e75 6d65 7269 635f   return numeric_
-000177d0: 6464 2c20 6e65 6564 735f 7469 6d65 5f63  dd, needs_time_c
-000177e0: 6f6e 7665 7273 696f 6e0a 0a20 2020 2040  onversion..    @
-000177f0: 5f6e 756d 6572 6963 5f6f 6e6c 790a 2020  _numeric_only.  
-00017800: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00017810: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00017820: 2020 6465 6620 736b 6577 280a 2020 2020    def skew(.    
-00017830: 2020 2020 7365 6c66 2c20 6178 6973 3d30      self, axis=0
-00017840: 2c20 6269 6173 3d54 7275 652c 206e 616e  , bias=True, nan
-00017850: 5f70 6f6c 6963 793d 2270 726f 7061 6761  _policy="propaga
-00017860: 7465 222c 206f 7574 3d4e 6f6e 652c 206e  te", out=None, n
-00017870: 756d 6572 6963 5f6f 6e6c 793d 4e6f 6e65  umeric_only=None
-00017880: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00017890: 2222 220a 2020 2020 2020 2020 2e2e 206e  """.        .. n
-000178a0: 6f74 653a 3a0a 0a20 2020 2020 2020 2020  ote::..         
-000178b0: 2020 5468 6973 2069 6d70 6c65 6d65 6e74    This implement
-000178c0: 6174 696f 6e20 666f 6c6c 6f77 7320 7468  ation follows th
-000178d0: 6520 6461 736b 2e61 7272 6179 2e73 7461  e dask.array.sta
-000178e0: 7473 2069 6d70 6c65 6d65 6e74 6174 696f  ts implementatio
-000178f0: 6e0a 2020 2020 2020 2020 2020 206f 6620  n.           of 
-00017900: 736b 6577 6e65 7373 2061 6e64 2063 616c  skewness and cal
-00017910: 6375 6c61 7465 7320 736b 6577 6e65 7373  culates skewness
-00017920: 2077 6974 686f 7574 2074 616b 696e 6720   without taking 
-00017930: 696e 746f 2061 6363 6f75 6e74 0a20 2020  into account.   
-00017940: 2020 2020 2020 2020 6120 6269 6173 2074          a bias t
-00017950: 6572 6d20 666f 7220 6669 6e69 7465 2073  erm for finite s
-00017960: 616d 706c 6520 7369 7a65 2c20 7768 6963  ample size, whic
-00017970: 6820 636f 7272 6573 706f 6e64 7320 746f  h corresponds to
-00017980: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00017990: 6465 6661 756c 7420 7365 7474 696e 6773  default settings
-000179a0: 206f 6620 7468 6520 7363 6970 792e 7374   of the scipy.st
-000179b0: 6174 7320 736b 6577 6e65 7373 2063 616c  ats skewness cal
-000179c0: 6375 6c61 7469 6f6e 2e20 486f 7765 7665  culation. Howeve
-000179d0: 722c 0a20 2020 2020 2020 2020 2020 5061  r,.           Pa
-000179e0: 6e64 6173 2063 6f72 7265 6374 7320 666f  ndas corrects fo
-000179f0: 7220 7468 6973 2c20 736f 2074 6865 2076  r this, so the v
-00017a00: 616c 7565 7320 6469 6666 6572 2062 7920  alues differ by 
-00017a10: 6120 6661 6374 6f72 206f 660a 2020 2020  a factor of.    
-00017a20: 2020 2020 2020 2028 6e20 2a20 286e 202d         (n * (n -
-00017a30: 2031 2929 202a 2a20 302e 3520 2f20 286e   1)) ** 0.5 / (n
-00017a40: 202d 2032 292c 2077 6865 7265 206e 2069   - 2), where n i
-00017a50: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
-00017a60: 7361 6d70 6c65 732e 0a0a 2020 2020 2020  samples...      
-00017a70: 2020 2020 2046 7572 7468 6572 2c20 7468       Further, th
-00017a80: 6973 206d 6574 686f 6420 6375 7272 656e  is method curren
-00017a90: 746c 7920 646f 6573 206e 6f74 2073 7570  tly does not sup
-00017aa0: 706f 7274 2066 696c 7465 7269 6e67 206f  port filtering o
-00017ab0: 7574 204e 614e 0a20 2020 2020 2020 2020  ut NaN.         
-00017ac0: 2020 7661 6c75 6573 2c20 7768 6963 6820    values, which 
-00017ad0: 6973 2061 6761 696e 2061 2064 6966 6665  is again a diffe
-00017ae0: 7265 6e63 6520 746f 2050 616e 6461 732e  rence to Pandas.
-00017af0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00017b00: 2020 2020 2069 6620 5041 4e44 4153 5f47       if PANDAS_G
-00017b10: 545f 3230 3020 616e 6420 6178 6973 2069  T_200 and axis i
-00017b20: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00017b30: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00017b40: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00017b50: 2020 2020 2020 2260 6178 6973 3d4e 6f6e        "`axis=Non
-00017b60: 6560 2069 736e 2774 2063 7572 7265 6e74  e` isn't current
-00017b70: 6c79 2073 7570 706f 7274 6564 2066 6f72  ly supported for
-00017b80: 2060 736b 6577 6020 7768 656e 2075 7369   `skew` when usi
-00017b90: 6e67 2060 7061 6e64 6173 203e 3d32 6020  ng `pandas >=2` 
-00017ba0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00017bb0: 2020 6622 2870 616e 6461 733d 7b73 7472    f"(pandas={str
-00017bc0: 2850 414e 4441 535f 5645 5253 494f 4e29  (PANDAS_VERSION)
-00017bd0: 7d20 6973 2069 6e73 7461 6c6c 6564 292e  } is installed).
-00017be0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00017bf0: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
-00017c00: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
-00017c10: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
-00017c20: 205f 7261 6973 655f 6966 5f6f 626a 6563   _raise_if_objec
-00017c30: 745f 7365 7269 6573 2873 656c 662c 2022  t_series(self, "
-00017c40: 736b 6577 2229 0a20 2020 2020 2020 206d  skew").        m
-00017c50: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
-00017c60: 5f6e 6f6e 656d 7074 792e 736b 6577 2829  _nonempty.skew()
-00017c70: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
-00017c80: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
-00017c90: 2020 2072 6573 756c 7420 3d20 6d61 705f     result = map_
-00017ca0: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-00017cb0: 2020 2020 2020 2020 2020 2020 4d2e 736b              M.sk
-00017cc0: 6577 2c0a 2020 2020 2020 2020 2020 2020  ew,.            
-00017cd0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00017ce0: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
-00017cf0: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-00017d00: 2020 2020 2074 6f6b 656e 3d73 656c 662e       token=self.
-00017d10: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
-00017d20: 2273 6b65 7722 2c0a 2020 2020 2020 2020  "skew",.        
-00017d30: 2020 2020 2020 2020 6178 6973 3d61 7869          axis=axi
-00017d40: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00017d50: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
-00017d60: 6174 613d 4661 6c73 652c 0a20 2020 2020  ata=False,.     
-00017d70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00017d80: 2020 2020 2072 6574 7572 6e20 6861 6e64       return hand
-00017d90: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
-00017da0: 6c74 290a 2020 2020 2020 2020 656c 7365  lt).        else
-00017db0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00017dc0: 2073 656c 662e 6e64 696d 203d 3d20 313a   self.ndim == 1:
-00017dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017de0: 2072 6573 756c 7420 3d20 7365 6c66 2e5f   result = self._
-00017df0: 736b 6577 5f31 6428 7365 6c66 2c20 6269  skew_1d(self, bi
-00017e00: 6173 3d62 6961 732c 206e 616e 5f70 6f6c  as=bias, nan_pol
-00017e10: 6963 793d 6e61 6e5f 706f 6c69 6379 290a  icy=nan_policy).
-00017e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e30: 7265 7475 726e 2068 616e 646c 655f 6f75  return handle_ou
-00017e40: 7428 6f75 742c 2072 6573 756c 7429 0a20  t(out, result). 
-00017e50: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00017e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017e70: 2072 6573 756c 7420 3d20 7365 6c66 2e5f   result = self._
-00017e80: 736b 6577 5f6e 756d 6572 6963 2862 6961  skew_numeric(bia
-00017e90: 733d 6269 6173 2c20 6e61 6e5f 706f 6c69  s=bias, nan_poli
-00017ea0: 6379 3d6e 616e 5f70 6f6c 6963 7929 0a0a  cy=nan_policy)..
-00017eb0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00017ec0: 7369 6e73 7461 6e63 6528 7365 6c66 2c20  sinstance(self, 
-00017ed0: 4461 7461 4672 616d 6529 3a0a 2020 2020  DataFrame):.    
-00017ee0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00017ef0: 6c74 2e64 6976 6973 696f 6e73 203d 2028  lt.divisions = (
-00017f00: 7365 6c66 2e63 6f6c 756d 6e73 2e6d 696e  self.columns.min
-00017f10: 2829 2c20 7365 6c66 2e63 6f6c 756d 6e73  (), self.columns
-00017f20: 2e6d 6178 2829 290a 0a20 2020 2020 2020  .max())..       
-00017f30: 2020 2020 2072 6574 7572 6e20 6861 6e64       return hand
-00017f40: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
-00017f50: 6c74 290a 0a20 2020 2064 6566 205f 736b  lt)..    def _sk
-00017f60: 6577 5f31 6428 7365 6c66 2c20 636f 6c75  ew_1d(self, colu
-00017f70: 6d6e 2c20 6269 6173 3d54 7275 652c 206e  mn, bias=True, n
-00017f80: 616e 5f70 6f6c 6963 793d 2270 726f 7061  an_policy="propa
-00017f90: 6761 7465 2229 3a0a 2020 2020 2020 2020  gate"):.        
-00017fa0: 2222 2231 4420 7665 7273 696f 6e20 6f66  """1D version of
-00017fb0: 2074 6865 2073 6b65 7720 6361 6c63 756c   the skew calcul
-00017fc0: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-00017fd0: 5573 6573 2074 6865 2061 7272 6179 2076  Uses the array v
-00017fe0: 6572 7369 6f6e 2066 726f 6d20 6461 2e73  ersion from da.s
-00017ff0: 7461 7473 2069 6e20 6361 7365 2077 6520  tats in case we 
-00018000: 6172 6520 7061 7373 696e 6720 696e 2061  are passing in a
-00018010: 2073 696e 676c 6520 7365 7269 6573 0a20   single series. 
-00018020: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00018030: 2020 2023 2069 6d70 6f72 7420 6465 7065     # import depe
-00018040: 6e64 7320 6f6e 2073 6369 7079 2c20 6e6f  nds on scipy, no
-00018050: 7420 696e 7374 616c 6c65 6420 6279 2064  t installed by d
-00018060: 6566 6175 6c74 0a20 2020 2020 2020 2066  efault.        f
-00018070: 726f 6d20 6461 736b 2e61 7272 6179 2069  rom dask.array i
-00018080: 6d70 6f72 7420 7374 6174 7320 6173 2064  mport stats as d
-00018090: 615f 7374 6174 730a 0a20 2020 2020 2020  a_stats..       
-000180a0: 2069 6620 7064 2e49 6e74 3634 4474 7970   if pd.Int64Dtyp
-000180b0: 652e 6973 5f64 7479 7065 2863 6f6c 756d  e.is_dtype(colum
-000180c0: 6e2e 5f6d 6574 615f 6e6f 6e65 6d70 7479  n._meta_nonempty
-000180d0: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
-000180e0: 6f6c 756d 6e20 3d20 636f 6c75 6d6e 2e61  olumn = column.a
-000180f0: 7374 7970 6528 2266 3822 290a 0a20 2020  stype("f8")..   
-00018100: 2020 2020 2069 6620 6e6f 7420 6e70 2e69       if not np.i
-00018110: 7373 7562 6474 7970 6528 636f 6c75 6d6e  ssubdtype(column
-00018120: 2e64 7479 7065 2c20 6e70 2e6e 756d 6265  .dtype, np.numbe
-00018130: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-00018140: 636f 6c75 6d6e 203d 2063 6f6c 756d 6e2e  column = column.
-00018150: 6173 7479 7065 2822 6638 2229 0a0a 2020  astype("f8")..  
-00018160: 2020 2020 2020 6e61 6d65 203d 2073 656c        name = sel
-00018170: 662e 5f74 6f6b 656e 5f70 7265 6669 7820  f._token_prefix 
-00018180: 2b20 2273 6b65 772d 3164 2d22 202b 2074  + "skew-1d-" + t
-00018190: 6f6b 656e 697a 6528 636f 6c75 6d6e 290a  okenize(column).
-000181a0: 0a20 2020 2020 2020 2061 7272 6179 5f73  .        array_s
-000181b0: 6b65 7720 3d20 6461 5f73 7461 7473 2e73  kew = da_stats.s
-000181c0: 6b65 7728 0a20 2020 2020 2020 2020 2020  kew(.           
-000181d0: 2063 6f6c 756d 6e2e 7661 6c75 6573 2c20   column.values, 
-000181e0: 6178 6973 3d30 2c20 6269 6173 3d62 6961  axis=0, bias=bia
-000181f0: 732c 206e 616e 5f70 6f6c 6963 793d 6e61  s, nan_policy=na
-00018200: 6e5f 706f 6c69 6379 0a20 2020 2020 2020  n_policy.       
-00018210: 2029 0a0a 2020 2020 2020 2020 6c61 7965   )..        laye
-00018220: 7220 3d20 7b28 6e61 6d65 2c20 3029 3a20  r = {(name, 0): 
-00018230: 286d 6574 686f 6473 2e77 7261 705f 736b  (methods.wrap_sk
-00018240: 6577 5f72 6564 7563 7469 6f6e 2c20 2861  ew_reduction, (a
-00018250: 7272 6179 5f73 6b65 772e 5f6e 616d 652c  rray_skew._name,
-00018260: 292c 204e 6f6e 6529 7d0a 2020 2020 2020  ), None)}.      
-00018270: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-00018280: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-00018290: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
-000182a0: 6c61 7965 722c 2064 6570 656e 6465 6e63  layer, dependenc
-000182b0: 6965 733d 5b61 7272 6179 5f73 6b65 775d  ies=[array_skew]
-000182c0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-000182d0: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
-000182e0: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
-000182f0: 7068 2c20 6e61 6d65 2c20 636f 6c75 6d6e  ph, name, column
-00018300: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-00018310: 736b 6577 2829 2c20 6469 7669 7369 6f6e  skew(), division
-00018320: 733d 5b4e 6f6e 652c 204e 6f6e 655d 0a20  s=[None, None]. 
-00018330: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00018340: 6620 5f73 6b65 775f 6e75 6d65 7269 6328  f _skew_numeric(
-00018350: 7365 6c66 2c20 6269 6173 3d54 7275 652c  self, bias=True,
-00018360: 206e 616e 5f70 6f6c 6963 793d 2270 726f   nan_policy="pro
-00018370: 7061 6761 7465 2229 3a0a 2020 2020 2020  pagate"):.      
-00018380: 2020 2222 224d 6574 686f 6420 666f 7220    """Method for 
-00018390: 6461 7461 6672 616d 6573 2077 6974 6820  dataframes with 
-000183a0: 6e75 6d65 7269 6320 636f 6c75 6d6e 732e  numeric columns.
-000183b0: 0a0a 2020 2020 2020 2020 4d61 7073 2074  ..        Maps t
-000183c0: 6865 2061 7272 6179 2076 6572 7369 6f6e  he array version
-000183d0: 2066 726f 6d20 6461 2e73 7461 7473 206f   from da.stats o
-000183e0: 6e74 6f20 7468 6520 6e75 6d65 7269 6320  nto the numeric 
-000183f0: 6172 7261 7920 6f66 2063 6f6c 756d 6e73  array of columns
-00018400: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00018410: 2020 2020 2020 2320 696d 706f 7274 2064        # import d
-00018420: 6570 656e 6473 206f 6e20 7363 6970 792c  epends on scipy,
-00018430: 206e 6f74 2069 6e73 7461 6c6c 6564 2062   not installed b
-00018440: 7920 6465 6661 756c 740a 2020 2020 2020  y default.      
-00018450: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-00018460: 7920 696d 706f 7274 2073 7461 7473 2061  y import stats a
-00018470: 7320 6461 5f73 7461 7473 0a0a 2020 2020  s da_stats..    
-00018480: 2020 2020 6e75 6d20 3d20 7365 6c66 2e73      num = self.s
-00018490: 656c 6563 745f 6474 7970 6573 2869 6e63  elect_dtypes(inc
-000184a0: 6c75 6465 3d5b 226e 756d 6265 7222 2c20  lude=["number", 
-000184b0: 2262 6f6f 6c22 5d2c 2065 7863 6c75 6465  "bool"], exclude
-000184c0: 3d5b 6e70 2e74 696d 6564 656c 7461 3634  =[np.timedelta64
-000184d0: 5d29 0a0a 2020 2020 2020 2020 7661 6c75  ])..        valu
-000184e0: 6573 5f64 7479 7065 203d 206e 756d 2e76  es_dtype = num.v
-000184f0: 616c 7565 732e 6474 7970 650a 2020 2020  alues.dtype.    
-00018500: 2020 2020 6172 7261 795f 7661 6c75 6573      array_values
-00018510: 203d 206e 756d 2e76 616c 7565 730a 0a20   = num.values.. 
-00018520: 2020 2020 2020 2069 6620 6e6f 7420 6e70         if not np
-00018530: 2e69 7373 7562 6474 7970 6528 7661 6c75  .issubdtype(valu
-00018540: 6573 5f64 7479 7065 2c20 6e70 2e6e 756d  es_dtype, np.num
-00018550: 6265 7229 3a0a 2020 2020 2020 2020 2020  ber):.          
+00015a80: 7565 730a 0a20 2020 2020 2020 2069 6620  ues..        if 
+00015a90: 6e6f 7420 6e70 2e69 7373 7562 6474 7970  not np.issubdtyp
+00015aa0: 6528 7661 6c75 6573 5f64 7479 7065 2c20  e(values_dtype, 
+00015ab0: 6e70 2e6e 756d 6265 7229 3a0a 2020 2020  np.number):.    
+00015ac0: 2020 2020 2020 2020 6172 7261 795f 7661          array_va
+00015ad0: 6c75 6573 203d 206e 756d 2e76 616c 7565  lues = num.value
+00015ae0: 732e 6173 7479 7065 2822 6638 2229 0a0a  s.astype("f8")..
+00015af0: 2020 2020 2020 2020 7661 7220 3d20 6461          var = da
+00015b00: 2e6e 616e 7661 7220 6966 2073 6b69 706e  .nanvar if skipn
+00015b10: 6120 6f72 2073 6b69 706e 6120 6973 204e  a or skipna is N
+00015b20: 6f6e 6520 656c 7365 2064 612e 7661 720a  one else da.var.
+00015b30: 2020 2020 2020 2020 6172 7261 795f 7661          array_va
+00015b40: 7220 3d20 7661 7228 6172 7261 795f 7661  r = var(array_va
+00015b50: 6c75 6573 2c20 6178 6973 3d30 2c20 6464  lues, axis=0, dd
+00015b60: 6f66 3d64 646f 662c 2073 706c 6974 5f65  of=ddof, split_e
+00015b70: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+00015b80: 290a 0a20 2020 2020 2020 206e 616d 6520  )..        name 
+00015b90: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
+00015ba0: 6566 6978 202b 2022 7661 722d 6e75 6d65  efix + "var-nume
+00015bb0: 7269 6322 202b 2074 6f6b 656e 697a 6528  ric" + tokenize(
+00015bc0: 6e75 6d2c 2073 706c 6974 5f65 7665 7279  num, split_every
+00015bd0: 290a 2020 2020 2020 2020 636f 6c73 203d  ).        cols =
+00015be0: 206e 756d 2e5f 6d65 7461 2e63 6f6c 756d   num._meta.colum
+00015bf0: 6e73 2069 6620 6973 5f64 6174 6166 7261  ns if is_datafra
+00015c00: 6d65 5f6c 696b 6528 6e75 6d29 2065 6c73  me_like(num) els
+00015c10: 6520 4e6f 6e65 0a0a 2020 2020 2020 2020  e None..        
+00015c20: 7661 725f 7368 6170 6520 3d20 6e75 6d2e  var_shape = num.
+00015c30: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e76  _meta_nonempty.v
+00015c40: 616c 7565 732e 7661 7228 6178 6973 3d30  alues.var(axis=0
+00015c50: 292e 7368 6170 650a 2020 2020 2020 2020  ).shape.        
+00015c60: 6172 7261 795f 7661 725f 6e61 6d65 203d  array_var_name =
+00015c70: 2028 6172 7261 795f 7661 722e 5f6e 616d   (array_var._nam
+00015c80: 652c 2920 2b20 2830 2c29 202a 206c 656e  e,) + (0,) * len
+00015c90: 2876 6172 5f73 6861 7065 290a 0a20 2020  (var_shape)..   
+00015ca0: 2020 2020 206c 6179 6572 203d 207b 286e       layer = {(n
+00015cb0: 616d 652c 2030 293a 2028 6d65 7468 6f64  ame, 0): (method
+00015cc0: 732e 7772 6170 5f76 6172 5f72 6564 7563  s.wrap_var_reduc
+00015cd0: 7469 6f6e 2c20 6172 7261 795f 7661 725f  tion, array_var_
+00015ce0: 6e61 6d65 2c20 636f 6c73 297d 0a20 2020  name, cols)}.   
+00015cf0: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+00015d00: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+00015d10: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+00015d20: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
+00015d30: 656e 6369 6573 3d5b 6172 7261 795f 7661  encies=[array_va
+00015d40: 725d 290a 0a20 2020 2020 2020 2072 6574  r])..        ret
+00015d50: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
+00015d60: 7428 0a20 2020 2020 2020 2020 2020 2067  t(.            g
+00015d70: 7261 7068 2c20 6e61 6d65 2c20 6e75 6d2e  raph, name, num.
+00015d80: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e76  _meta_nonempty.v
+00015d90: 6172 2829 2c20 6469 7669 7369 6f6e 733d  ar(), divisions=
+00015da0: 5b4e 6f6e 652c 204e 6f6e 655d 0a20 2020  [None, None].   
+00015db0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00015dc0: 5f76 6172 5f74 696d 6564 656c 7461 7328  _var_timedeltas(
+00015dd0: 7365 6c66 2c20 736b 6970 6e61 3d54 7275  self, skipna=Tru
+00015de0: 652c 2064 646f 663d 312c 2073 706c 6974  e, ddof=1, split
+00015df0: 5f65 7665 7279 3d46 616c 7365 293a 0a20  _every=False):. 
+00015e00: 2020 2020 2020 2074 696d 6564 656c 7461         timedelta
+00015e10: 7320 3d20 7365 6c66 2e73 656c 6563 745f  s = self.select_
+00015e20: 6474 7970 6573 2869 6e63 6c75 6465 3d5b  dtypes(include=[
+00015e30: 6e70 2e74 696d 6564 656c 7461 3634 5d29  np.timedelta64])
+00015e40: 0a0a 2020 2020 2020 2020 7661 725f 7469  ..        var_ti
+00015e50: 6d65 6465 6c74 6173 203d 205b 0a20 2020  medeltas = [.   
+00015e60: 2020 2020 2020 2020 2073 656c 662e 5f76           self._v
+00015e70: 6172 5f31 6428 7469 6d65 6465 6c74 6173  ar_1d(timedeltas
+00015e80: 5b63 6f6c 5f69 6478 5d2c 2073 6b69 706e  [col_idx], skipn
+00015e90: 612c 2064 646f 662c 2073 706c 6974 5f65  a, ddof, split_e
+00015ea0: 7665 7279 290a 2020 2020 2020 2020 2020  very).          
+00015eb0: 2020 666f 7220 636f 6c5f 6964 7820 696e    for col_idx in
+00015ec0: 2074 696d 6564 656c 7461 732e 5f6d 6574   timedeltas._met
+00015ed0: 612e 636f 6c75 6d6e 730a 2020 2020 2020  a.columns.      
+00015ee0: 2020 5d0a 2020 2020 2020 2020 7661 725f    ].        var_
+00015ef0: 7469 6d65 6465 6c74 615f 6e61 6d65 7320  timedelta_names 
+00015f00: 3d20 5b28 762e 5f6e 616d 652c 2030 2920  = [(v._name, 0) 
+00015f10: 666f 7220 7620 696e 2076 6172 5f74 696d  for v in var_tim
+00015f20: 6564 656c 7461 735d 0a0a 2020 2020 2020  edeltas]..      
+00015f30: 2020 6e61 6d65 203d 2028 0a20 2020 2020    name = (.     
+00015f40: 2020 2020 2020 2073 656c 662e 5f74 6f6b         self._tok
+00015f50: 656e 5f70 7265 6669 7820 2b20 2276 6172  en_prefix + "var
+00015f60: 2d74 696d 6564 656c 7461 732d 2220 2b20  -timedeltas-" + 
+00015f70: 746f 6b65 6e69 7a65 2874 696d 6564 656c  tokenize(timedel
+00015f80: 7461 732c 2073 706c 6974 5f65 7665 7279  tas, split_every
+00015f90: 290a 2020 2020 2020 2020 290a 0a20 2020  ).        )..   
+00015fa0: 2020 2020 206c 6179 6572 203d 207b 0a20       layer = {. 
+00015fb0: 2020 2020 2020 2020 2020 2028 6e61 6d65             (name
+00015fc0: 2c20 3029 3a20 280a 2020 2020 2020 2020  , 0): (.        
+00015fd0: 2020 2020 2020 2020 6d65 7468 6f64 732e          methods.
+00015fe0: 7772 6170 5f76 6172 5f72 6564 7563 7469  wrap_var_reducti
+00015ff0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00016000: 2020 2020 7661 725f 7469 6d65 6465 6c74      var_timedelt
+00016010: 615f 6e61 6d65 732c 0a20 2020 2020 2020  a_names,.       
+00016020: 2020 2020 2020 2020 2074 696d 6564 656c           timedel
+00016030: 7461 732e 5f6d 6574 612e 636f 6c75 6d6e  tas._meta.column
+00016040: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
+00016050: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00016060: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+00016070: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+00016080: 6f6c 6c65 6374 696f 6e73 280a 2020 2020  ollections(.    
+00016090: 2020 2020 2020 2020 6e61 6d65 2c20 6c61          name, la
+000160a0: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
+000160b0: 733d 7661 725f 7469 6d65 6465 6c74 6173  s=var_timedeltas
+000160c0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000160d0: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
+000160e0: 645f 6f62 6a65 6374 280a 2020 2020 2020  d_object(.      
+000160f0: 2020 2020 2020 6772 6170 682c 206e 616d        graph, nam
+00016100: 652c 2074 696d 6564 656c 7461 732e 5f6d  e, timedeltas._m
+00016110: 6574 615f 6e6f 6e65 6d70 7479 2e76 6172  eta_nonempty.var
+00016120: 2829 2c20 6469 7669 7369 6f6e 733d 5b4e  (), divisions=[N
+00016130: 6f6e 652c 204e 6f6e 655d 0a20 2020 2020  one, None].     
+00016140: 2020 2029 0a0a 2020 2020 6465 6620 5f76     )..    def _v
+00016150: 6172 5f6d 6978 6564 2873 656c 662c 2073  ar_mixed(self, s
+00016160: 6b69 706e 613d 5472 7565 2c20 6464 6f66  kipna=True, ddof
+00016170: 3d31 2c20 7370 6c69 745f 6576 6572 793d  =1, split_every=
+00016180: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00016190: 6461 7461 203d 2073 656c 662e 7365 6c65  data = self.sele
+000161a0: 6374 5f64 7479 7065 7328 696e 636c 7564  ct_dtypes(includ
+000161b0: 653d 5b22 6e75 6d62 6572 222c 2022 626f  e=["number", "bo
+000161c0: 6f6c 222c 206e 702e 7469 6d65 6465 6c74  ol", np.timedelt
+000161d0: 6136 345d 290a 0a20 2020 2020 2020 2074  a64])..        t
+000161e0: 696d 6564 656c 7461 5f76 6172 7320 3d20  imedelta_vars = 
+000161f0: 7365 6c66 2e5f 7661 725f 7469 6d65 6465  self._var_timede
+00016200: 6c74 6173 2873 6b69 706e 612c 2064 646f  ltas(skipna, ddo
+00016210: 662c 2073 706c 6974 5f65 7665 7279 290a  f, split_every).
+00016220: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
+00016230: 7661 7273 203d 2073 656c 662e 5f76 6172  vars = self._var
+00016240: 5f6e 756d 6572 6963 2873 6b69 706e 612c  _numeric(skipna,
+00016250: 2064 646f 662c 2073 706c 6974 5f65 7665   ddof, split_eve
+00016260: 7279 290a 0a20 2020 2020 2020 206e 616d  ry)..        nam
+00016270: 6520 3d20 7365 6c66 2e5f 746f 6b65 6e5f  e = self._token_
+00016280: 7072 6566 6978 202b 2022 7661 722d 6d69  prefix + "var-mi
+00016290: 7865 642d 2220 2b20 746f 6b65 6e69 7a65  xed-" + tokenize
+000162a0: 2864 6174 612c 2073 706c 6974 5f65 7665  (data, split_eve
+000162b0: 7279 290a 0a20 2020 2020 2020 206c 6179  ry)..        lay
+000162c0: 6572 203d 207b 0a20 2020 2020 2020 2020  er = {.         
+000162d0: 2020 2028 6e61 6d65 2c20 3029 3a20 280a     (name, 0): (.
+000162e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000162f0: 6d65 7468 6f64 732e 7661 725f 6d69 7865  methods.var_mixe
+00016300: 645f 636f 6e63 6174 2c0a 2020 2020 2020  d_concat,.      
+00016310: 2020 2020 2020 2020 2020 286e 756d 6572            (numer
+00016320: 6963 5f76 6172 732e 5f6e 616d 652c 2030  ic_vars._name, 0
+00016330: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00016340: 2020 2028 7469 6d65 6465 6c74 615f 7661     (timedelta_va
+00016350: 7273 2e5f 6e61 6d65 2c20 3029 2c0a 2020  rs._name, 0),.  
+00016360: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00016370: 7461 2e5f 6d65 7461 2e63 6f6c 756d 6e73  ta._meta.columns
+00016380: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00016390: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
+000163a0: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+000163b0: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+000163c0: 6f6c 6c65 6374 696f 6e73 280a 2020 2020  ollections(.    
+000163d0: 2020 2020 2020 2020 6e61 6d65 2c20 6c61          name, la
+000163e0: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
+000163f0: 733d 5b6e 756d 6572 6963 5f76 6172 732c  s=[numeric_vars,
+00016400: 2074 696d 6564 656c 7461 5f76 6172 735d   timedelta_vars]
+00016410: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00016420: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
+00016430: 5f6f 626a 6563 7428 0a20 2020 2020 2020  _object(.       
+00016440: 2020 2020 2067 7261 7068 2c20 6e61 6d65       graph, name
+00016450: 2c20 7365 6c66 2e5f 6d65 7461 5f6e 6f6e  , self._meta_non
+00016460: 656d 7074 792e 7661 7228 292c 2064 6976  empty.var(), div
+00016470: 6973 696f 6e73 3d5b 4e6f 6e65 2c20 4e6f  isions=[None, No
+00016480: 6e65 5d0a 2020 2020 2020 2020 290a 0a20  ne].        ).. 
+00016490: 2020 2064 6566 205f 7661 725f 3164 2873     def _var_1d(s
+000164a0: 656c 662c 2063 6f6c 756d 6e2c 2073 6b69  elf, column, ski
+000164b0: 706e 613d 5472 7565 2c20 6464 6f66 3d31  pna=True, ddof=1
+000164c0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+000164d0: 6c73 6529 3a0a 2020 2020 2020 2020 6973  lse):.        is
+000164e0: 5f74 696d 6564 656c 7461 203d 2069 735f  _timedelta = is_
+000164f0: 7469 6d65 6465 6c74 6136 345f 6474 7970  timedelta64_dtyp
+00016500: 6528 636f 6c75 6d6e 2e5f 6d65 7461 290a  e(column._meta).
+00016510: 0a20 2020 2020 2020 2069 6620 6973 5f74  .        if is_t
+00016520: 696d 6564 656c 7461 3a0a 2020 2020 2020  imedelta:.      
+00016530: 2020 2020 2020 6966 206e 6f74 2073 6b69        if not ski
+00016540: 706e 613a 0a20 2020 2020 2020 2020 2020  pna:.           
+00016550: 2020 2020 2069 735f 6e61 6e20 3d20 636f       is_nan = co
+00016560: 6c75 6d6e 2e69 736e 6128 290a 2020 2020  lumn.isna().    
+00016570: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+00016580: 6d6e 203d 2063 6f6c 756d 6e2e 6173 7479  mn = column.asty
+00016590: 7065 2822 6938 2229 0a20 2020 2020 2020  pe("i8").       
+000165a0: 2020 2020 2020 2020 2063 6f6c 756d 6e20           column 
+000165b0: 3d20 636f 6c75 6d6e 2e6d 6173 6b28 6973  = column.mask(is
+000165c0: 5f6e 616e 290a 2020 2020 2020 2020 2020  _nan).          
+000165d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000165e0: 2020 2020 2020 2020 636f 6c75 6d6e 203d          column =
+000165f0: 2063 6f6c 756d 6e2e 6472 6f70 6e61 2829   column.dropna()
+00016600: 2e61 7374 7970 6528 2269 3822 290a 0a20  .astype("i8").. 
+00016610: 2020 2020 2020 2069 6620 7064 2e49 6e74         if pd.Int
+00016620: 3634 4474 7970 652e 6973 5f64 7479 7065  64Dtype.is_dtype
+00016630: 2863 6f6c 756d 6e2e 5f6d 6574 615f 6e6f  (column._meta_no
+00016640: 6e65 6d70 7479 293a 0a20 2020 2020 2020  nempty):.       
+00016650: 2020 2020 2063 6f6c 756d 6e20 3d20 636f       column = co
+00016660: 6c75 6d6e 2e61 7374 7970 6528 2266 3822  lumn.astype("f8"
+00016670: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+00016680: 7420 6e70 2e69 7373 7562 6474 7970 6528  t np.issubdtype(
+00016690: 636f 6c75 6d6e 2e64 7479 7065 2c20 6e70  column.dtype, np
+000166a0: 2e6e 756d 6265 7229 3a0a 2020 2020 2020  .number):.      
+000166b0: 2020 2020 2020 636f 6c75 6d6e 203d 2063        column = c
+000166c0: 6f6c 756d 6e2e 6173 7479 7065 2822 6638  olumn.astype("f8
+000166d0: 2229 0a0a 2020 2020 2020 2020 6e61 6d65  ")..        name
+000166e0: 203d 2073 656c 662e 5f74 6f6b 656e 5f70   = self._token_p
+000166f0: 7265 6669 7820 2b20 2276 6172 2d31 642d  refix + "var-1d-
+00016700: 2220 2b20 746f 6b65 6e69 7a65 2863 6f6c  " + tokenize(col
+00016710: 756d 6e2c 2073 706c 6974 5f65 7665 7279  umn, split_every
+00016720: 290a 0a20 2020 2020 2020 2076 6172 203d  )..        var =
+00016730: 2064 612e 6e61 6e76 6172 2069 6620 736b   da.nanvar if sk
+00016740: 6970 6e61 206f 7220 736b 6970 6e61 2069  ipna or skipna i
+00016750: 7320 4e6f 6e65 2065 6c73 6520 6461 2e76  s None else da.v
+00016760: 6172 0a20 2020 2020 2020 2061 7272 6179  ar.        array
+00016770: 5f76 6172 203d 2076 6172 2863 6f6c 756d  _var = var(colum
+00016780: 6e2e 7661 6c75 6573 2c20 6178 6973 3d30  n.values, axis=0
+00016790: 2c20 6464 6f66 3d64 646f 662c 2073 706c  , ddof=ddof, spl
+000167a0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+000167b0: 7665 7279 290a 0a20 2020 2020 2020 206c  very)..        l
+000167c0: 6179 6572 203d 207b 286e 616d 652c 2030  ayer = {(name, 0
+000167d0: 293a 2028 6d65 7468 6f64 732e 7772 6170  ): (methods.wrap
+000167e0: 5f76 6172 5f72 6564 7563 7469 6f6e 2c20  _var_reduction, 
+000167f0: 2861 7272 6179 5f76 6172 2e5f 6e61 6d65  (array_var._name
+00016800: 2c29 2c20 4e6f 6e65 297d 0a20 2020 2020  ,), None)}.     
+00016810: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+00016820: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+00016830: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
+00016840: 206c 6179 6572 2c20 6465 7065 6e64 656e   layer, dependen
+00016850: 6369 6573 3d5b 6172 7261 795f 7661 725d  cies=[array_var]
+00016860: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00016870: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
+00016880: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
+00016890: 7068 2c20 6e61 6d65 2c20 636f 6c75 6d6e  ph, name, column
+000168a0: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
+000168b0: 7661 7228 292c 2064 6976 6973 696f 6e73  var(), divisions
+000168c0: 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d0a 2020  =[None, None].  
+000168d0: 2020 2020 2020 290a 0a20 2020 2040 5f6e        )..    @_n
+000168e0: 756d 6572 6963 5f64 6174 610a 2020 2020  umeric_data.    
+000168f0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00016900: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00016910: 6465 6620 7374 6428 0a20 2020 2020 2020  def std(.       
+00016920: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
+00016930: 7869 733d 4e6f 6e65 2c0a 2020 2020 2020  xis=None,.      
+00016940: 2020 736b 6970 6e61 3d54 7275 652c 0a20    skipna=True,. 
+00016950: 2020 2020 2020 2064 646f 663d 312c 0a20         ddof=1,. 
+00016960: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+00016970: 7279 3d46 616c 7365 2c0a 2020 2020 2020  ry=False,.      
+00016980: 2020 6474 7970 653d 4e6f 6e65 2c0a 2020    dtype=None,.  
+00016990: 2020 2020 2020 6f75 743d 4e6f 6e65 2c0a        out=None,.
+000169a0: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
+000169b0: 6f6e 6c79 3d6e 6f5f 6465 6661 756c 742c  only=no_default,
+000169c0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000169d0: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
+000169e0: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
+000169f0: 0a20 2020 2020 2020 205f 7261 6973 655f  .        _raise_
+00016a00: 6966 5f6f 626a 6563 745f 7365 7269 6573  if_object_series
+00016a10: 2873 656c 662c 2022 7374 6422 290a 2020  (self, "std").  
+00016a20: 2020 2020 2020 5f72 6169 7365 5f69 665f        _raise_if_
+00016a30: 6e6f 745f 7365 7269 6573 5f6f 725f 6461  not_series_or_da
+00016a40: 7461 6672 616d 6528 7365 6c66 2c20 2273  taframe(self, "s
+00016a50: 7464 2229 0a20 2020 2020 2020 206e 756d  td").        num
+00016a60: 6572 6963 5f6b 7761 7267 7320 3d20 5f6e  eric_kwargs = _n
+00016a70: 756d 6572 6963 5f6f 6e6c 795f 6d61 7962  umeric_only_mayb
+00016a80: 655f 7761 726e 2873 656c 662c 206e 756d  e_warn(self, num
+00016a90: 6572 6963 5f6f 6e6c 7929 0a0a 2020 2020  eric_only)..    
+00016aa0: 2020 2020 7769 7468 2063 6865 636b 5f6e      with check_n
+00016ab0: 756d 6572 6963 5f6f 6e6c 795f 6465 7072  umeric_only_depr
+00016ac0: 6563 6174 696f 6e28 292c 2063 6865 636b  ecation(), check
+00016ad0: 5f6e 7569 7361 6e63 655f 636f 6c75 6d6e  _nuisance_column
+00016ae0: 735f 7761 726e 696e 6728 293a 0a20 2020  s_warning():.   
+00016af0: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
+00016b00: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
+00016b10: 7074 792e 7374 6428 6178 6973 3d61 7869  pty.std(axis=axi
+00016b20: 732c 2073 6b69 706e 613d 736b 6970 6e61  s, skipna=skipna
+00016b30: 2c20 2a2a 6e75 6d65 7269 635f 6b77 6172  , **numeric_kwar
+00016b40: 6773 290a 2020 2020 2020 2020 6973 5f64  gs).        is_d
+00016b50: 665f 6c69 6b65 203d 2069 735f 6461 7461  f_like = is_data
+00016b60: 6672 616d 655f 6c69 6b65 2873 656c 662e  frame_like(self.
+00016b70: 5f6d 6574 6129 0a20 2020 2020 2020 206e  _meta).        n
+00016b80: 6565 6473 5f74 696d 655f 636f 6e76 6572  eeds_time_conver
+00016b90: 7369 6f6e 203d 2046 616c 7365 0a20 2020  sion = False.   
+00016ba0: 2020 2020 206e 756d 6572 6963 5f64 6420       numeric_dd 
+00016bb0: 3d20 7365 6c66 0a0a 2020 2020 2020 2020  = self..        
+00016bc0: 6966 2069 735f 6466 5f6c 696b 653a 0a20  if is_df_like:. 
+00016bd0: 2020 2020 2020 2020 2020 2074 696d 655f             time_
+00016be0: 636f 6c73 203d 2073 656c 662e 5f6d 6574  cols = self._met
+00016bf0: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
+00016c00: 696e 636c 7564 653d 2264 6174 6574 696d  include="datetim
+00016c10: 6522 292e 636f 6c75 6d6e 730a 2020 2020  e").columns.    
+00016c20: 2020 2020 2020 2020 6966 206c 656e 2874          if len(t
+00016c30: 696d 655f 636f 6c73 2920 3e20 303a 0a20  ime_cols) > 0:. 
+00016c40: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00016c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016c60: 2020 2020 206e 756d 6572 6963 5f64 642c       numeric_dd,
+00016c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016c80: 2020 2020 206e 6565 6473 5f74 696d 655f       needs_time_
+00016c90: 636f 6e76 6572 7369 6f6e 2c0a 2020 2020  conversion,.    
+00016ca0: 2020 2020 2020 2020 2020 2020 2920 3d20              ) = 
+00016cb0: 7365 6c66 2e5f 636f 6e76 6572 745f 7469  self._convert_ti
+00016cc0: 6d65 5f63 6f6c 735f 746f 5f6e 756d 6572  me_cols_to_numer
+00016cd0: 6963 2874 696d 655f 636f 6c73 2c20 6178  ic(time_cols, ax
+00016ce0: 6973 2c20 6d65 7461 2c20 736b 6970 6e61  is, meta, skipna
+00016cf0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00016d00: 2020 2020 2020 2020 2020 2020 6e65 6564              need
+00016d10: 735f 7469 6d65 5f63 6f6e 7665 7273 696f  s_time_conversio
+00016d20: 6e20 3d20 6973 5f64 6174 6574 696d 6536  n = is_datetime6
+00016d30: 345f 616e 795f 6474 7970 6528 7365 6c66  4_any_dtype(self
+00016d40: 2e5f 6d65 7461 290a 2020 2020 2020 2020  ._meta).        
+00016d50: 2020 2020 6966 206e 6565 6473 5f74 696d      if needs_tim
+00016d60: 655f 636f 6e76 6572 7369 6f6e 3a0a 2020  e_conversion:.  
+00016d70: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+00016d80: 6d65 7269 635f 6464 203d 205f 636f 6e76  meric_dd = _conv
+00016d90: 6572 745f 746f 5f6e 756d 6572 6963 2873  ert_to_numeric(s
+00016da0: 656c 662c 2073 6b69 706e 6129 0a0a 2020  elf, skipna)..  
+00016db0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
+00016dc0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00016dd0: 7265 7375 6c74 203d 206d 6170 5f70 6172  result = map_par
+00016de0: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
+00016df0: 2020 2020 2020 2020 204d 2e73 7464 2069           M.std i
+00016e00: 6620 6e6f 7420 6e65 6564 735f 7469 6d65  f not needs_time
+00016e10: 5f63 6f6e 7665 7273 696f 6e20 656c 7365  _conversion else
+00016e20: 205f 7371 7274 5f61 6e64 5f63 6f6e 7665   _sqrt_and_conve
+00016e30: 7274 5f74 6f5f 7469 6d65 6465 6c74 612c  rt_to_timedelta,
+00016e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016e50: 206e 756d 6572 6963 5f64 642c 0a20 2020   numeric_dd,.   
+00016e60: 2020 2020 2020 2020 2020 2020 206d 6574               met
+00016e70: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
+00016e80: 2020 2020 2020 2020 746f 6b65 6e3d 7365          token=se
+00016e90: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
+00016ea0: 202b 2022 7374 6422 2c0a 2020 2020 2020   + "std",.      
+00016eb0: 2020 2020 2020 2020 2020 6178 6973 3d61            axis=a
+00016ec0: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
+00016ed0: 2020 2020 2073 6b69 706e 613d 736b 6970       skipna=skip
+00016ee0: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
+00016ef0: 2020 2020 6464 6f66 3d64 646f 662c 0a20      ddof=ddof,. 
+00016f00: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00016f10: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+00016f20: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+00016f30: 2020 2020 2020 202a 2a6e 756d 6572 6963         **numeric
+00016f40: 5f6b 7761 7267 732c 0a20 2020 2020 2020  _kwargs,.       
+00016f50: 2020 2020 2020 2020 2070 6172 656e 745f           parent_
+00016f60: 6d65 7461 3d73 656c 662e 5f6d 6574 612c  meta=self._meta,
+00016f70: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00016f80: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00016f90: 6e20 6861 6e64 6c65 5f6f 7574 286f 7574  n handle_out(out
+00016fa0: 2c20 7265 7375 6c74 290a 0a20 2020 2020  , result)..     
+00016fb0: 2020 2023 2043 6173 6520 7768 6572 6520     # Case where 
+00016fc0: 6178 6973 3d30 206f 7220 6178 6973 3d4e  axis=0 or axis=N
+00016fd0: 6f6e 650a 2020 2020 2020 2020 7620 3d20  one.        v = 
+00016fe0: 6e75 6d65 7269 635f 6464 2e76 6172 2873  numeric_dd.var(s
+00016ff0: 6b69 706e 613d 736b 6970 6e61 2c20 6464  kipna=skipna, dd
+00017000: 6f66 3d64 646f 662c 2073 706c 6974 5f65  of=ddof, split_e
+00017010: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+00017020: 290a 2020 2020 2020 2020 6e61 6d65 203d  ).        name =
+00017030: 2073 656c 662e 5f74 6f6b 656e 5f70 7265   self._token_pre
+00017040: 6669 7820 2b20 2273 7464 220a 0a20 2020  fix + "std"..   
+00017050: 2020 2020 2069 6620 6e65 6564 735f 7469       if needs_ti
+00017060: 6d65 5f63 6f6e 7665 7273 696f 6e3a 0a20  me_conversion:. 
+00017070: 2020 2020 2020 2020 2020 2073 7172 745f             sqrt_
+00017080: 6675 6e63 5f6b 7761 7267 7320 3d20 7b0a  func_kwargs = {.
+00017090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000170a0: 2269 735f 6466 5f6c 696b 6522 3a20 6973  "is_df_like": is
+000170b0: 5f64 665f 6c69 6b65 2c0a 2020 2020 2020  _df_like,.      
+000170c0: 2020 2020 2020 2020 2020 2274 696d 655f            "time_
+000170d0: 636f 6c73 223a 2074 696d 655f 636f 6c73  cols": time_cols
+000170e0: 2069 6620 6973 5f64 665f 6c69 6b65 2065   if is_df_like e
+000170f0: 6c73 6520 4e6f 6e65 2c0a 2020 2020 2020  lse None,.      
+00017100: 2020 2020 2020 2020 2020 2261 7869 7322            "axis"
+00017110: 3a20 6178 6973 2c0a 2020 2020 2020 2020  : axis,.        
+00017120: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+00017130: 2020 7371 7274 5f66 756e 6320 3d20 5f73    sqrt_func = _s
+00017140: 7172 745f 616e 645f 636f 6e76 6572 745f  qrt_and_convert_
+00017150: 746f 5f74 696d 6564 656c 7461 0a20 2020  to_timedelta.   
+00017160: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00017170: 2020 2020 2020 2073 7172 745f 6675 6e63         sqrt_func
+00017180: 5f6b 7761 7267 7320 3d20 7b7d 0a20 2020  _kwargs = {}.   
+00017190: 2020 2020 2020 2020 2073 7172 745f 6675           sqrt_fu
+000171a0: 6e63 203d 206e 702e 7371 7274 0a0a 2020  nc = np.sqrt..  
+000171b0: 2020 2020 2020 7265 7375 6c74 203d 206d        result = m
+000171c0: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+000171d0: 2020 2020 2020 2020 2020 2073 7172 745f             sqrt_
+000171e0: 6675 6e63 2c0a 2020 2020 2020 2020 2020  func,.          
+000171f0: 2020 762c 0a20 2020 2020 2020 2020 2020    v,.           
+00017200: 206d 6574 613d 6d65 7461 2c0a 2020 2020   meta=meta,.    
+00017210: 2020 2020 2020 2020 746f 6b65 6e3d 6e61          token=na
+00017220: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+00017230: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+00017240: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00017250: 2020 2020 7061 7265 6e74 5f6d 6574 613d      parent_meta=
+00017260: 7365 6c66 2e5f 6d65 7461 2c0a 2020 2020  self._meta,.    
+00017270: 2020 2020 2020 2020 2a2a 7371 7274 5f66          **sqrt_f
+00017280: 756e 635f 6b77 6172 6773 2c0a 2020 2020  unc_kwargs,.    
+00017290: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
+000172a0: 2054 7279 2074 6f20 6d61 7463 6820 7468   Try to match th
+000172b0: 6520 5061 6e64 6173 2072 6573 756c 7420  e Pandas result 
+000172c0: 6474 7970 650a 2020 2020 2020 2020 6966  dtype.        if
+000172d0: 2069 735f 6466 5f6c 696b 6520 616e 6420   is_df_like and 
+000172e0: 6861 7361 7474 7228 6d65 7461 2c20 2264  hasattr(meta, "d
+000172f0: 7479 7065 2229 3a0a 2020 2020 2020 2020  type"):.        
+00017300: 2020 2020 7265 7375 6c74 203d 2072 6573      result = res
+00017310: 756c 742e 6173 7479 7065 286d 6574 612e  ult.astype(meta.
+00017320: 6474 7970 6529 0a0a 2020 2020 2020 2020  dtype)..        
+00017330: 7265 7475 726e 2068 616e 646c 655f 6f75  return handle_ou
+00017340: 7428 6f75 742c 2072 6573 756c 7429 0a0a  t(out, result)..
+00017350: 2020 2020 6465 6620 5f63 6f6e 7665 7274      def _convert
+00017360: 5f74 696d 655f 636f 6c73 5f74 6f5f 6e75  _time_cols_to_nu
+00017370: 6d65 7269 6328 7365 6c66 2c20 7469 6d65  meric(self, time
+00017380: 5f63 6f6c 732c 2061 7869 732c 206d 6574  _cols, axis, met
+00017390: 612c 2073 6b69 706e 6129 3a0a 2020 2020  a, skipna):.    
+000173a0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+000173b0: 7461 6672 616d 652e 696f 2069 6d70 6f72  taframe.io impor
+000173c0: 7420 6672 6f6d 5f70 616e 6461 730a 0a20  t from_pandas.. 
+000173d0: 2020 2020 2020 206e 6565 6473 5f74 696d         needs_tim
+000173e0: 655f 636f 6e76 6572 7369 6f6e 203d 2054  e_conversion = T
+000173f0: 7275 650a 0a20 2020 2020 2020 2023 2045  rue..        # E
+00017400: 6e73 7572 6520 616c 6c20 636f 6c75 6d6e  nsure all column
+00017410: 7320 6172 6520 636f 7272 6563 7420 7479  s are correct ty
+00017420: 7065 2e20 4e65 6564 2074 6f20 7368 616c  pe. Need to shal
+00017430: 6c6f 7720 636f 7079 2073 696e 6365 2063  low copy since c
+00017440: 6f6c 7320 7769 6c6c 2062 6520 6d6f 6469  ols will be modi
+00017450: 6669 6564 0a20 2020 2020 2020 2069 6620  fied.        if 
+00017460: 6178 6973 203d 3d20 303a 0a20 2020 2020  axis == 0:.     
+00017470: 2020 2020 2020 206e 756d 6572 6963 5f64         numeric_d
+00017480: 6420 3d20 7365 6c66 5b6d 6574 612e 696e  d = self[meta.in
+00017490: 6465 785d 2e63 6f70 7928 290a 2020 2020  dex].copy().    
+000174a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000174b0: 2020 2020 2020 6e75 6d65 7269 635f 6464        numeric_dd
+000174c0: 203d 2073 656c 662e 636f 7079 2829 0a0a   = self.copy()..
+000174d0: 2020 2020 2020 2020 2320 4d69 7820 6f66          # Mix of
+000174e0: 2064 6174 6574 696d 6573 2077 6974 6820   datetimes with 
+000174f0: 6f74 6865 7220 6e75 6d65 7269 6320 7479  other numeric ty
+00017500: 7065 7320 7072 6f64 7563 6573 204e 614e  pes produces NaN
+00017510: 7320 666f 7220 6561 6368 2076 616c 7565  s for each value
+00017520: 2069 6e20 7374 6428 2920 7365 7269 6573   in std() series
+00017530: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
+00017540: 203d 3d20 3120 616e 6420 6c65 6e28 7469   == 1 and len(ti
+00017550: 6d65 5f63 6f6c 7329 2021 3d20 6c65 6e28  me_cols) != len(
+00017560: 7365 6c66 2e63 6f6c 756d 6e73 293a 0a20  self.columns):. 
+00017570: 2020 2020 2020 2020 2020 2023 2054 6869             # Thi
+00017580: 7320 6973 2066 6173 7465 7220 7468 616e  s is faster than
+00017590: 2063 6f6e 7665 7274 696e 6720 6561 6368   converting each
+000175a0: 2063 6f6c 756d 6e20 746f 206e 756d 6572   column to numer
+000175b0: 6963 2077 6865 6e20 6974 2773 206e 6f74  ic when it's not
+000175c0: 206e 6563 6573 7361 7279 0a20 2020 2020   necessary.     
+000175d0: 2020 2020 2020 2023 2073 696e 6365 2065         # since e
+000175e0: 6163 6820 7374 616e 6461 7264 2064 6576  ach standard dev
+000175f0: 6961 7469 6f6e 2077 696c 6c20 6a75 7374  iation will just
+00017600: 2062 6520 4e61 4e0a 2020 2020 2020 2020   be NaN.        
+00017610: 2020 2020 6e65 6564 735f 7469 6d65 5f63      needs_time_c
+00017620: 6f6e 7665 7273 696f 6e20 3d20 4661 6c73  onversion = Fals
+00017630: 650a 2020 2020 2020 2020 2020 2020 6e75  e.            nu
+00017640: 6d65 7269 635f 6464 203d 2066 726f 6d5f  meric_dd = from_
+00017650: 7061 6e64 6173 280a 2020 2020 2020 2020  pandas(.        
+00017660: 2020 2020 2020 2020 6d65 7461 5f66 7261          meta_fra
+00017670: 6d65 5f63 6f6e 7374 7275 6374 6f72 2873  me_constructor(s
+00017680: 656c 6629 280a 2020 2020 2020 2020 2020  elf)(.          
+00017690: 2020 2020 2020 2020 2020 7b22 5f22 3a20            {"_": 
+000176a0: 6d65 7461 5f73 6572 6965 735f 636f 6e73  meta_series_cons
+000176b0: 7472 7563 746f 7228 7365 6c66 2928 5b6e  tructor(self)([n
+000176c0: 702e 6e61 6e5d 297d 2c0a 2020 2020 2020  p.nan])},.      
+000176d0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000176e0: 6465 783d 7365 6c66 2e69 6e64 6578 2c0a  dex=self.index,.
+000176f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017700: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00017710: 2020 206e 7061 7274 6974 696f 6e73 3d73     npartitions=s
+00017720: 656c 662e 6e70 6172 7469 7469 6f6e 732c  elf.npartitions,
+00017730: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00017740: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00017750: 2020 2020 2020 2020 2023 2043 6f6e 7665           # Conve
+00017760: 7274 2074 696d 6564 656c 7461 2061 6e64  rt timedelta and
+00017770: 2064 6174 6574 696d 6520 636f 6c75 6d6e   datetime column
+00017780: 7320 746f 2069 6e74 6567 6572 2074 7970  s to integer typ
+00017790: 6573 2073 6f20 7765 2063 616e 2075 7365  es so we can use
+000177a0: 2076 6172 0a20 2020 2020 2020 2020 2020   var.           
+000177b0: 2066 6f72 2063 6f6c 2069 6e20 7469 6d65   for col in time
+000177c0: 5f63 6f6c 733a 0a20 2020 2020 2020 2020  _cols:.         
+000177d0: 2020 2020 2020 206e 756d 6572 6963 5f64         numeric_d
+000177e0: 645b 636f 6c5d 203d 205f 636f 6e76 6572  d[col] = _conver
+000177f0: 745f 746f 5f6e 756d 6572 6963 286e 756d  t_to_numeric(num
+00017800: 6572 6963 5f64 645b 636f 6c5d 2c20 736b  eric_dd[col], sk
+00017810: 6970 6e61 290a 0a20 2020 2020 2020 2072  ipna)..        r
+00017820: 6574 7572 6e20 6e75 6d65 7269 635f 6464  eturn numeric_dd
+00017830: 2c20 6e65 6564 735f 7469 6d65 5f63 6f6e  , needs_time_con
+00017840: 7665 7273 696f 6e0a 0a20 2020 2040 5f6e  version..    @_n
+00017850: 756d 6572 6963 5f6f 6e6c 790a 2020 2020  umeric_only.    
+00017860: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00017870: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00017880: 6465 6620 736b 6577 280a 2020 2020 2020  def skew(.      
+00017890: 2020 7365 6c66 2c20 6178 6973 3d30 2c20    self, axis=0, 
+000178a0: 6269 6173 3d54 7275 652c 206e 616e 5f70  bias=True, nan_p
+000178b0: 6f6c 6963 793d 2270 726f 7061 6761 7465  olicy="propagate
+000178c0: 222c 206f 7574 3d4e 6f6e 652c 206e 756d  ", out=None, num
+000178d0: 6572 6963 5f6f 6e6c 793d 4e6f 6e65 0a20  eric_only=None. 
+000178e0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+000178f0: 220a 2020 2020 2020 2020 2e2e 206e 6f74  ".        .. not
+00017900: 653a 3a0a 0a20 2020 2020 2020 2020 2020  e::..           
+00017910: 5468 6973 2069 6d70 6c65 6d65 6e74 6174  This implementat
+00017920: 696f 6e20 666f 6c6c 6f77 7320 7468 6520  ion follows the 
+00017930: 6461 736b 2e61 7272 6179 2e73 7461 7473  dask.array.stats
+00017940: 2069 6d70 6c65 6d65 6e74 6174 696f 6e0a   implementation.
+00017950: 2020 2020 2020 2020 2020 206f 6620 736b             of sk
+00017960: 6577 6e65 7373 2061 6e64 2063 616c 6375  ewness and calcu
+00017970: 6c61 7465 7320 736b 6577 6e65 7373 2077  lates skewness w
+00017980: 6974 686f 7574 2074 616b 696e 6720 696e  ithout taking in
+00017990: 746f 2061 6363 6f75 6e74 0a20 2020 2020  to account.     
+000179a0: 2020 2020 2020 6120 6269 6173 2074 6572        a bias ter
+000179b0: 6d20 666f 7220 6669 6e69 7465 2073 616d  m for finite sam
+000179c0: 706c 6520 7369 7a65 2c20 7768 6963 6820  ple size, which 
+000179d0: 636f 7272 6573 706f 6e64 7320 746f 2074  corresponds to t
+000179e0: 6865 0a20 2020 2020 2020 2020 2020 6465  he.           de
+000179f0: 6661 756c 7420 7365 7474 696e 6773 206f  fault settings o
+00017a00: 6620 7468 6520 7363 6970 792e 7374 6174  f the scipy.stat
+00017a10: 7320 736b 6577 6e65 7373 2063 616c 6375  s skewness calcu
+00017a20: 6c61 7469 6f6e 2e20 486f 7765 7665 722c  lation. However,
+00017a30: 0a20 2020 2020 2020 2020 2020 5061 6e64  .           Pand
+00017a40: 6173 2063 6f72 7265 6374 7320 666f 7220  as corrects for 
+00017a50: 7468 6973 2c20 736f 2074 6865 2076 616c  this, so the val
+00017a60: 7565 7320 6469 6666 6572 2062 7920 6120  ues differ by a 
+00017a70: 6661 6374 6f72 206f 660a 2020 2020 2020  factor of.      
+00017a80: 2020 2020 2028 6e20 2a20 286e 202d 2031       (n * (n - 1
+00017a90: 2929 202a 2a20 302e 3520 2f20 286e 202d  )) ** 0.5 / (n -
+00017aa0: 2032 292c 2077 6865 7265 206e 2069 7320   2), where n is 
+00017ab0: 7468 6520 6e75 6d62 6572 206f 6620 7361  the number of sa
+00017ac0: 6d70 6c65 732e 0a0a 2020 2020 2020 2020  mples...        
+00017ad0: 2020 2046 7572 7468 6572 2c20 7468 6973     Further, this
+00017ae0: 206d 6574 686f 6420 6375 7272 656e 746c   method currentl
+00017af0: 7920 646f 6573 206e 6f74 2073 7570 706f  y does not suppo
+00017b00: 7274 2066 696c 7465 7269 6e67 206f 7574  rt filtering out
+00017b10: 204e 614e 0a20 2020 2020 2020 2020 2020   NaN.           
+00017b20: 7661 6c75 6573 2c20 7768 6963 6820 6973  values, which is
+00017b30: 2061 6761 696e 2061 2064 6966 6665 7265   again a differe
+00017b40: 6e63 6520 746f 2050 616e 6461 732e 0a20  nce to Pandas.. 
+00017b50: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00017b60: 2020 2069 6620 5041 4e44 4153 5f47 545f     if PANDAS_GT_
+00017b70: 3230 3020 616e 6420 6178 6973 2069 7320  200 and axis is 
+00017b80: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00017b90: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00017ba0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00017bb0: 2020 2020 2260 6178 6973 3d4e 6f6e 6560      "`axis=None`
+00017bc0: 2069 736e 2774 2063 7572 7265 6e74 6c79   isn't currently
+00017bd0: 2073 7570 706f 7274 6564 2066 6f72 2060   supported for `
+00017be0: 736b 6577 6020 7768 656e 2075 7369 6e67  skew` when using
+00017bf0: 2060 7061 6e64 6173 203e 3d32 6020 220a   `pandas >=2` ".
+00017c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017c10: 6622 2870 616e 6461 733d 7b73 7472 2850  f"(pandas={str(P
+00017c20: 414e 4441 535f 5645 5253 494f 4e29 7d20  ANDAS_VERSION)} 
+00017c30: 6973 2069 6e73 7461 6c6c 6564 292e 220a  is installed).".
+00017c40: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00017c50: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
+00017c60: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
+00017c70: 2861 7869 7329 0a20 2020 2020 2020 205f  (axis).        _
+00017c80: 7261 6973 655f 6966 5f6f 626a 6563 745f  raise_if_object_
+00017c90: 7365 7269 6573 2873 656c 662c 2022 736b  series(self, "sk
+00017ca0: 6577 2229 0a20 2020 2020 2020 206d 6574  ew").        met
+00017cb0: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
+00017cc0: 6f6e 656d 7074 792e 736b 6577 2829 0a20  onempty.skew(). 
+00017cd0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+00017ce0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00017cf0: 2072 6573 756c 7420 3d20 6d61 705f 7061   result = map_pa
+00017d00: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+00017d10: 2020 2020 2020 2020 2020 4d2e 736b 6577            M.skew
+00017d20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017d30: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00017d40: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
+00017d50: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+00017d60: 2020 2074 6f6b 656e 3d73 656c 662e 5f74     token=self._t
+00017d70: 6f6b 656e 5f70 7265 6669 7820 2b20 2273  oken_prefix + "s
+00017d80: 6b65 7722 2c0a 2020 2020 2020 2020 2020  kew",.          
+00017d90: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
+00017da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017db0: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+00017dc0: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
+00017dd0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00017de0: 2020 2072 6574 7572 6e20 6861 6e64 6c65     return handle
+00017df0: 5f6f 7574 286f 7574 2c20 7265 7375 6c74  _out(out, result
+00017e00: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00017e10: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00017e20: 656c 662e 6e64 696d 203d 3d20 313a 0a20  elf.ndim == 1:. 
+00017e30: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00017e40: 6573 756c 7420 3d20 7365 6c66 2e5f 736b  esult = self._sk
+00017e50: 6577 5f31 6428 7365 6c66 2c20 6269 6173  ew_1d(self, bias
+00017e60: 3d62 6961 732c 206e 616e 5f70 6f6c 6963  =bias, nan_polic
+00017e70: 793d 6e61 6e5f 706f 6c69 6379 290a 2020  y=nan_policy).  
+00017e80: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00017e90: 7475 726e 2068 616e 646c 655f 6f75 7428  turn handle_out(
+00017ea0: 6f75 742c 2072 6573 756c 7429 0a20 2020  out, result).   
+00017eb0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00017ec0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00017ed0: 6573 756c 7420 3d20 7365 6c66 2e5f 736b  esult = self._sk
+00017ee0: 6577 5f6e 756d 6572 6963 2862 6961 733d  ew_numeric(bias=
+00017ef0: 6269 6173 2c20 6e61 6e5f 706f 6c69 6379  bias, nan_policy
+00017f00: 3d6e 616e 5f70 6f6c 6963 7929 0a0a 2020  =nan_policy)..  
+00017f10: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00017f20: 6e73 7461 6e63 6528 7365 6c66 2c20 4461  nstance(self, Da
+00017f30: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
+00017f40: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00017f50: 2e64 6976 6973 696f 6e73 203d 2028 7365  .divisions = (se
+00017f60: 6c66 2e63 6f6c 756d 6e73 2e6d 696e 2829  lf.columns.min()
+00017f70: 2c20 7365 6c66 2e63 6f6c 756d 6e73 2e6d  , self.columns.m
+00017f80: 6178 2829 290a 0a20 2020 2020 2020 2020  ax())..         
+00017f90: 2020 2072 6574 7572 6e20 6861 6e64 6c65     return handle
+00017fa0: 5f6f 7574 286f 7574 2c20 7265 7375 6c74  _out(out, result
+00017fb0: 290a 0a20 2020 2064 6566 205f 736b 6577  )..    def _skew
+00017fc0: 5f31 6428 7365 6c66 2c20 636f 6c75 6d6e  _1d(self, column
+00017fd0: 2c20 6269 6173 3d54 7275 652c 206e 616e  , bias=True, nan
+00017fe0: 5f70 6f6c 6963 793d 2270 726f 7061 6761  _policy="propaga
+00017ff0: 7465 2229 3a0a 2020 2020 2020 2020 2222  te"):.        ""
+00018000: 2231 4420 7665 7273 696f 6e20 6f66 2074  "1D version of t
+00018010: 6865 2073 6b65 7720 6361 6c63 756c 6174  he skew calculat
+00018020: 696f 6e2e 0a0a 2020 2020 2020 2020 5573  ion...        Us
+00018030: 6573 2074 6865 2061 7272 6179 2076 6572  es the array ver
+00018040: 7369 6f6e 2066 726f 6d20 6461 2e73 7461  sion from da.sta
+00018050: 7473 2069 6e20 6361 7365 2077 6520 6172  ts in case we ar
+00018060: 6520 7061 7373 696e 6720 696e 2061 2073  e passing in a s
+00018070: 696e 676c 6520 7365 7269 6573 0a20 2020  ingle series.   
+00018080: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00018090: 2023 2069 6d70 6f72 7420 6465 7065 6e64   # import depend
+000180a0: 7320 6f6e 2073 6369 7079 2c20 6e6f 7420  s on scipy, not 
+000180b0: 696e 7374 616c 6c65 6420 6279 2064 6566  installed by def
+000180c0: 6175 6c74 0a20 2020 2020 2020 2066 726f  ault.        fro
+000180d0: 6d20 6461 736b 2e61 7272 6179 2069 6d70  m dask.array imp
+000180e0: 6f72 7420 7374 6174 7320 6173 2064 615f  ort stats as da_
+000180f0: 7374 6174 730a 0a20 2020 2020 2020 2069  stats..        i
+00018100: 6620 7064 2e49 6e74 3634 4474 7970 652e  f pd.Int64Dtype.
+00018110: 6973 5f64 7479 7065 2863 6f6c 756d 6e2e  is_dtype(column.
+00018120: 5f6d 6574 615f 6e6f 6e65 6d70 7479 293a  _meta_nonempty):
+00018130: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00018140: 756d 6e20 3d20 636f 6c75 6d6e 2e61 7374  umn = column.ast
+00018150: 7970 6528 2266 3822 290a 0a20 2020 2020  ype("f8")..     
+00018160: 2020 2069 6620 6e6f 7420 6e70 2e69 7373     if not np.iss
+00018170: 7562 6474 7970 6528 636f 6c75 6d6e 2e64  ubdtype(column.d
+00018180: 7479 7065 2c20 6e70 2e6e 756d 6265 7229  type, np.number)
+00018190: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+000181a0: 6c75 6d6e 203d 2063 6f6c 756d 6e2e 6173  lumn = column.as
+000181b0: 7479 7065 2822 6638 2229 0a0a 2020 2020  type("f8")..    
+000181c0: 2020 2020 6e61 6d65 203d 2073 656c 662e      name = self.
+000181d0: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
+000181e0: 2273 6b65 772d 3164 2d22 202b 2074 6f6b  "skew-1d-" + tok
+000181f0: 656e 697a 6528 636f 6c75 6d6e 290a 0a20  enize(column).. 
+00018200: 2020 2020 2020 2061 7272 6179 5f73 6b65         array_ske
+00018210: 7720 3d20 6461 5f73 7461 7473 2e73 6b65  w = da_stats.ske
+00018220: 7728 0a20 2020 2020 2020 2020 2020 2063  w(.            c
+00018230: 6f6c 756d 6e2e 7661 6c75 6573 2c20 6178  olumn.values, ax
+00018240: 6973 3d30 2c20 6269 6173 3d62 6961 732c  is=0, bias=bias,
+00018250: 206e 616e 5f70 6f6c 6963 793d 6e61 6e5f   nan_policy=nan_
+00018260: 706f 6c69 6379 0a20 2020 2020 2020 2029  policy.        )
+00018270: 0a0a 2020 2020 2020 2020 6c61 7965 7220  ..        layer 
+00018280: 3d20 7b28 6e61 6d65 2c20 3029 3a20 286d  = {(name, 0): (m
+00018290: 6574 686f 6473 2e77 7261 705f 736b 6577  ethods.wrap_skew
+000182a0: 5f72 6564 7563 7469 6f6e 2c20 2861 7272  _reduction, (arr
+000182b0: 6179 5f73 6b65 772e 5f6e 616d 652c 292c  ay_skew._name,),
+000182c0: 204e 6f6e 6529 7d0a 2020 2020 2020 2020   None)}.        
+000182d0: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
+000182e0: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
+000182f0: 6563 7469 6f6e 7328 6e61 6d65 2c20 6c61  ections(name, la
+00018300: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
+00018310: 733d 5b61 7272 6179 5f73 6b65 775d 290a  s=[array_skew]).
+00018320: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00018330: 6e65 775f 6464 5f6f 626a 6563 7428 0a20  new_dd_object(. 
+00018340: 2020 2020 2020 2020 2020 2067 7261 7068             graph
+00018350: 2c20 6e61 6d65 2c20 636f 6c75 6d6e 2e5f  , name, column._
+00018360: 6d65 7461 5f6e 6f6e 656d 7074 792e 736b  meta_nonempty.sk
+00018370: 6577 2829 2c20 6469 7669 7369 6f6e 733d  ew(), divisions=
+00018380: 5b4e 6f6e 652c 204e 6f6e 655d 0a20 2020  [None, None].   
+00018390: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+000183a0: 5f73 6b65 775f 6e75 6d65 7269 6328 7365  _skew_numeric(se
+000183b0: 6c66 2c20 6269 6173 3d54 7275 652c 206e  lf, bias=True, n
+000183c0: 616e 5f70 6f6c 6963 793d 2270 726f 7061  an_policy="propa
+000183d0: 6761 7465 2229 3a0a 2020 2020 2020 2020  gate"):.        
+000183e0: 2222 224d 6574 686f 6420 666f 7220 6461  """Method for da
+000183f0: 7461 6672 616d 6573 2077 6974 6820 6e75  taframes with nu
+00018400: 6d65 7269 6320 636f 6c75 6d6e 732e 0a0a  meric columns...
+00018410: 2020 2020 2020 2020 4d61 7073 2074 6865          Maps the
+00018420: 2061 7272 6179 2076 6572 7369 6f6e 2066   array version f
+00018430: 726f 6d20 6461 2e73 7461 7473 206f 6e74  rom da.stats ont
+00018440: 6f20 7468 6520 6e75 6d65 7269 6320 6172  o the numeric ar
+00018450: 7261 7920 6f66 2063 6f6c 756d 6e73 2e0a  ray of columns..
+00018460: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00018470: 2020 2020 2320 696d 706f 7274 2064 6570      # import dep
+00018480: 656e 6473 206f 6e20 7363 6970 792c 206e  ends on scipy, n
+00018490: 6f74 2069 6e73 7461 6c6c 6564 2062 7920  ot installed by 
+000184a0: 6465 6661 756c 740a 2020 2020 2020 2020  default.        
+000184b0: 6672 6f6d 2064 6173 6b2e 6172 7261 7920  from dask.array 
+000184c0: 696d 706f 7274 2073 7461 7473 2061 7320  import stats as 
+000184d0: 6461 5f73 7461 7473 0a0a 2020 2020 2020  da_stats..      
+000184e0: 2020 6e75 6d20 3d20 7365 6c66 2e73 656c    num = self.sel
+000184f0: 6563 745f 6474 7970 6573 2869 6e63 6c75  ect_dtypes(inclu
+00018500: 6465 3d5b 226e 756d 6265 7222 2c20 2262  de=["number", "b
+00018510: 6f6f 6c22 5d2c 2065 7863 6c75 6465 3d5b  ool"], exclude=[
+00018520: 6e70 2e74 696d 6564 656c 7461 3634 5d29  np.timedelta64])
+00018530: 0a0a 2020 2020 2020 2020 7661 6c75 6573  ..        values
+00018540: 5f64 7479 7065 203d 206e 756d 2e76 616c  _dtype = num.val
+00018550: 7565 732e 6474 7970 650a 2020 2020 2020  ues.dtype.      
 00018560: 2020 6172 7261 795f 7661 6c75 6573 203d    array_values =
-00018570: 206e 756d 2e76 616c 7565 732e 6173 7479   num.values.asty
-00018580: 7065 2822 6638 2229 0a0a 2020 2020 2020  pe("f8")..      
-00018590: 2020 6172 7261 795f 736b 6577 203d 2064    array_skew = d
-000185a0: 615f 7374 6174 732e 736b 6577 280a 2020  a_stats.skew(.  
-000185b0: 2020 2020 2020 2020 2020 6172 7261 795f            array_
-000185c0: 7661 6c75 6573 2c20 6178 6973 3d30 2c20  values, axis=0, 
-000185d0: 6269 6173 3d62 6961 732c 206e 616e 5f70  bias=bias, nan_p
-000185e0: 6f6c 6963 793d 6e61 6e5f 706f 6c69 6379  olicy=nan_policy
-000185f0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00018600: 2020 2020 6e61 6d65 203d 2073 656c 662e      name = self.
-00018610: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
-00018620: 2276 6172 2d6e 756d 6572 6963 2220 2b20  "var-numeric" + 
-00018630: 746f 6b65 6e69 7a65 286e 756d 290a 2020  tokenize(num).  
-00018640: 2020 2020 2020 636f 6c73 203d 206e 756d        cols = num
-00018650: 2e5f 6d65 7461 2e63 6f6c 756d 6e73 2069  ._meta.columns i
-00018660: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
-00018670: 696b 6528 6e75 6d29 2065 6c73 6520 4e6f  ike(num) else No
-00018680: 6e65 0a0a 2020 2020 2020 2020 736b 6577  ne..        skew
-00018690: 5f73 6861 7065 203d 206e 756d 2e5f 6d65  _shape = num._me
-000186a0: 7461 5f6e 6f6e 656d 7074 792e 7661 6c75  ta_nonempty.valu
-000186b0: 6573 2e76 6172 2861 7869 733d 3029 2e73  es.var(axis=0).s
-000186c0: 6861 7065 0a20 2020 2020 2020 2061 7272  hape.        arr
-000186d0: 6179 5f73 6b65 775f 6e61 6d65 203d 2028  ay_skew_name = (
-000186e0: 6172 7261 795f 736b 6577 2e5f 6e61 6d65  array_skew._name
-000186f0: 2c29 202b 2028 302c 2920 2a20 6c65 6e28  ,) + (0,) * len(
-00018700: 736b 6577 5f73 6861 7065 290a 0a20 2020  skew_shape)..   
-00018710: 2020 2020 206c 6179 6572 203d 207b 286e       layer = {(n
-00018720: 616d 652c 2030 293a 2028 6d65 7468 6f64  ame, 0): (method
-00018730: 732e 7772 6170 5f73 6b65 775f 7265 6475  s.wrap_skew_redu
-00018740: 6374 696f 6e2c 2061 7272 6179 5f73 6b65  ction, array_ske
-00018750: 775f 6e61 6d65 2c20 636f 6c73 297d 0a20  w_name, cols)}. 
-00018760: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
-00018770: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-00018780: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
-00018790: 616d 652c 206c 6179 6572 2c20 6465 7065  ame, layer, depe
-000187a0: 6e64 656e 6369 6573 3d5b 6172 7261 795f  ndencies=[array_
-000187b0: 736b 6577 5d29 0a0a 2020 2020 2020 2020  skew])..        
-000187c0: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
-000187d0: 6a65 6374 280a 2020 2020 2020 2020 2020  ject(.          
-000187e0: 2020 6772 6170 682c 206e 616d 652c 206e    graph, name, n
-000187f0: 756d 2e5f 6d65 7461 5f6e 6f6e 656d 7074  um._meta_nonempt
-00018800: 792e 736b 6577 2829 2c20 6469 7669 7369  y.skew(), divisi
-00018810: 6f6e 733d 5b4e 6f6e 652c 204e 6f6e 655d  ons=[None, None]
-00018820: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00018830: 405f 6e75 6d65 7269 635f 6f6e 6c79 0a20  @_numeric_only. 
-00018840: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00018850: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-00018860: 2020 2064 6566 206b 7572 746f 7369 7328     def kurtosis(
-00018870: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00018880: 2020 2020 2020 2061 7869 733d 302c 0a20         axis=0,. 
-00018890: 2020 2020 2020 2066 6973 6865 723d 5472         fisher=Tr
-000188a0: 7565 2c0a 2020 2020 2020 2020 6269 6173  ue,.        bias
-000188b0: 3d54 7275 652c 0a20 2020 2020 2020 206e  =True,.        n
-000188c0: 616e 5f70 6f6c 6963 793d 2270 726f 7061  an_policy="propa
-000188d0: 6761 7465 222c 0a20 2020 2020 2020 206f  gate",.        o
-000188e0: 7574 3d4e 6f6e 652c 0a20 2020 2020 2020  ut=None,.       
-000188f0: 206e 756d 6572 6963 5f6f 6e6c 793d 4e6f   numeric_only=No
-00018900: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-00018910: 2020 2022 2222 0a20 2020 2020 2020 202e     """.        .
-00018920: 2e20 6e6f 7465 3a3a 0a0a 2020 2020 2020  . note::..      
-00018930: 2020 2020 2054 6869 7320 696d 706c 656d       This implem
-00018940: 656e 7461 7469 6f6e 2066 6f6c 6c6f 7773  entation follows
-00018950: 2074 6865 2064 6173 6b2e 6172 7261 792e   the dask.array.
-00018960: 7374 6174 7320 696d 706c 656d 656e 7461  stats implementa
-00018970: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-00018980: 6f66 206b 7572 746f 7369 7320 616e 6420  of kurtosis and 
-00018990: 6361 6c63 756c 6174 6573 206b 7572 746f  calculates kurto
-000189a0: 7369 7320 7769 7468 6f75 7420 7461 6b69  sis without taki
-000189b0: 6e67 2069 6e74 6f20 6163 636f 756e 740a  ng into account.
-000189c0: 2020 2020 2020 2020 2020 2061 2062 6961             a bia
-000189d0: 7320 7465 726d 2066 6f72 2066 696e 6974  s term for finit
-000189e0: 6520 7361 6d70 6c65 2073 697a 652c 2077  e sample size, w
-000189f0: 6869 6368 2063 6f72 7265 7370 6f6e 6473  hich corresponds
-00018a00: 2074 6f20 7468 650a 2020 2020 2020 2020   to the.        
-00018a10: 2020 2064 6566 6175 6c74 2073 6574 7469     default setti
-00018a20: 6e67 7320 6f66 2074 6865 2073 6369 7079  ngs of the scipy
-00018a30: 2e73 7461 7473 206b 7572 746f 7369 7320  .stats kurtosis 
-00018a40: 6361 6c63 756c 6174 696f 6e2e 2054 6869  calculation. Thi
-00018a50: 7320 6469 6666 6572 730a 2020 2020 2020  s differs.      
-00018a60: 2020 2020 2066 726f 6d20 7061 6e64 6173       from pandas
-00018a70: 2e0a 0a20 2020 2020 2020 2020 2020 4675  ...           Fu
-00018a80: 7274 6865 722c 2074 6869 7320 6d65 7468  rther, this meth
-00018a90: 6f64 2063 7572 7265 6e74 6c79 2064 6f65  od currently doe
-00018aa0: 7320 6e6f 7420 7375 7070 6f72 7420 6669  s not support fi
-00018ab0: 6c74 6572 696e 6720 6f75 7420 4e61 4e0a  ltering out NaN.
-00018ac0: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00018ad0: 732c 2077 6869 6368 2069 7320 6167 6169  s, which is agai
-00018ae0: 6e20 6120 6469 6666 6572 656e 6365 2074  n a difference t
-00018af0: 6f20 5061 6e64 6173 2e0a 2020 2020 2020  o Pandas..      
-00018b00: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00018b10: 2050 414e 4441 535f 4754 5f32 3030 2061   PANDAS_GT_200 a
-00018b20: 6e64 2061 7869 7320 6973 204e 6f6e 653a  nd axis is None:
-00018b30: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00018b40: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-00018b50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00018b60: 6061 7869 733d 4e6f 6e65 6020 6973 6e27  `axis=None` isn'
-00018b70: 7420 6375 7272 656e 746c 7920 7375 7070  t currently supp
-00018b80: 6f72 7465 6420 666f 7220 606b 7572 746f  orted for `kurto
-00018b90: 7369 7360 2077 6865 6e20 7573 696e 6720  sis` when using 
-00018ba0: 6070 616e 6461 7320 3e3d 3260 2022 0a20  `pandas >=2` ". 
-00018bb0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00018bc0: 2228 7061 6e64 6173 3d7b 7374 7228 5041  "(pandas={str(PA
-00018bd0: 4e44 4153 5f56 4552 5349 4f4e 297d 2069  NDAS_VERSION)} i
-00018be0: 7320 696e 7374 616c 6c65 6429 2e22 0a20  s installed).". 
-00018bf0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00018c00: 2020 2020 2061 7869 7320 3d20 7365 6c66       axis = self
-00018c10: 2e5f 7661 6c69 6461 7465 5f61 7869 7328  ._validate_axis(
-00018c20: 6178 6973 290a 2020 2020 2020 2020 5f72  axis).        _r
-00018c30: 6169 7365 5f69 665f 6f62 6a65 6374 5f73  aise_if_object_s
-00018c40: 6572 6965 7328 7365 6c66 2c20 226b 7572  eries(self, "kur
-00018c50: 746f 7369 7322 290a 2020 2020 2020 2020  tosis").        
-00018c60: 6d65 7461 203d 2073 656c 662e 5f6d 6574  meta = self._met
-00018c70: 615f 6e6f 6e65 6d70 7479 2e6b 7572 746f  a_nonempty.kurto
-00018c80: 7369 7328 290a 2020 2020 2020 2020 6966  sis().        if
-00018c90: 2061 7869 7320 3d3d 2031 3a0a 2020 2020   axis == 1:.    
-00018ca0: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-00018cb0: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
-00018cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018cd0: 204d 2e6b 7572 746f 7369 732c 0a20 2020   M.kurtosis,.   
-00018ce0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00018cf0: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
-00018d00: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
-00018d10: 2020 2020 2020 2020 2020 2020 2020 746f                to
-00018d20: 6b65 6e3d 7365 6c66 2e5f 746f 6b65 6e5f  ken=self._token_
-00018d30: 7072 6566 6978 202b 2022 6b75 7274 6f73  prefix + "kurtos
-00018d40: 6973 222c 0a20 2020 2020 2020 2020 2020  is",.           
-00018d50: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
-00018d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d70: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-00018d80: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00018d90: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00018da0: 2020 7265 7475 726e 2068 616e 646c 655f    return handle_
-00018db0: 6f75 7428 6f75 742c 2072 6573 756c 7429  out(out, result)
-00018dc0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00018dd0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00018de0: 6c66 2e6e 6469 6d20 3d3d 2031 3a0a 2020  lf.ndim == 1:.  
-00018df0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00018e00: 7375 6c74 203d 2073 656c 662e 5f6b 7572  sult = self._kur
-00018e10: 746f 7369 735f 3164 280a 2020 2020 2020  tosis_1d(.      
-00018e20: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00018e30: 6c66 2c20 6669 7368 6572 3d66 6973 6865  lf, fisher=fishe
-00018e40: 722c 2062 6961 733d 6269 6173 2c20 6e61  r, bias=bias, na
-00018e50: 6e5f 706f 6c69 6379 3d6e 616e 5f70 6f6c  n_policy=nan_pol
-00018e60: 6963 790a 2020 2020 2020 2020 2020 2020  icy.            
-00018e70: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00018e80: 2020 2020 2020 7265 7475 726e 2068 616e        return han
-00018e90: 646c 655f 6f75 7428 6f75 742c 2072 6573  dle_out(out, res
-00018ea0: 756c 7429 0a20 2020 2020 2020 2020 2020  ult).           
-00018eb0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00018ec0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00018ed0: 7365 6c66 2e5f 6b75 7274 6f73 6973 5f6e  self._kurtosis_n
-00018ee0: 756d 6572 6963 280a 2020 2020 2020 2020  umeric(.        
-00018ef0: 2020 2020 2020 2020 2020 2020 6669 7368              fish
-00018f00: 6572 3d66 6973 6865 722c 2062 6961 733d  er=fisher, bias=
-00018f10: 6269 6173 2c20 6e61 6e5f 706f 6c69 6379  bias, nan_policy
-00018f20: 3d6e 616e 5f70 6f6c 6963 790a 2020 2020  =nan_policy.    
-00018f30: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00018f40: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-00018f50: 696e 7374 616e 6365 2873 656c 662c 2044  instance(self, D
-00018f60: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
-00018f70: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00018f80: 742e 6469 7669 7369 6f6e 7320 3d20 2873  t.divisions = (s
-00018f90: 656c 662e 636f 6c75 6d6e 732e 6d69 6e28  elf.columns.min(
-00018fa0: 292c 2073 656c 662e 636f 6c75 6d6e 732e  ), self.columns.
-00018fb0: 6d61 7828 2929 0a0a 2020 2020 2020 2020  max())..        
-00018fc0: 2020 2020 7265 7475 726e 2068 616e 646c      return handl
-00018fd0: 655f 6f75 7428 6f75 742c 2072 6573 756c  e_out(out, resul
-00018fe0: 7429 0a0a 2020 2020 6465 6620 5f6b 7572  t)..    def _kur
-00018ff0: 746f 7369 735f 3164 2873 656c 662c 2063  tosis_1d(self, c
-00019000: 6f6c 756d 6e2c 2066 6973 6865 723d 5472  olumn, fisher=Tr
-00019010: 7565 2c20 6269 6173 3d54 7275 652c 206e  ue, bias=True, n
-00019020: 616e 5f70 6f6c 6963 793d 2270 726f 7061  an_policy="propa
-00019030: 6761 7465 2229 3a0a 2020 2020 2020 2020  gate"):.        
-00019040: 2222 2231 4420 7665 7273 696f 6e20 6f66  """1D version of
-00019050: 2074 6865 206b 7572 746f 7369 7320 6361   the kurtosis ca
-00019060: 6c63 756c 6174 696f 6e2e 0a0a 2020 2020  lculation...    
-00019070: 2020 2020 5573 6573 2074 6865 2061 7272      Uses the arr
-00019080: 6179 2076 6572 7369 6f6e 2066 726f 6d20  ay version from 
-00019090: 6461 2e73 7461 7473 2069 6e20 6361 7365  da.stats in case
-000190a0: 2077 6520 6172 6520 7061 7373 696e 6720   we are passing 
-000190b0: 696e 2061 2073 696e 676c 6520 7365 7269  in a single seri
-000190c0: 6573 0a20 2020 2020 2020 2022 2222 0a20  es.        """. 
-000190d0: 2020 2020 2020 2023 2069 6d70 6f72 7420         # import 
-000190e0: 6465 7065 6e64 7320 6f6e 2073 6369 7079  depends on scipy
-000190f0: 2c20 6e6f 7420 696e 7374 616c 6c65 6420  , not installed 
-00019100: 6279 2064 6566 6175 6c74 0a20 2020 2020  by default.     
-00019110: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
-00019120: 6179 2069 6d70 6f72 7420 7374 6174 7320  ay import stats 
-00019130: 6173 2064 615f 7374 6174 730a 0a20 2020  as da_stats..   
-00019140: 2020 2020 2069 6620 7064 2e61 7069 2e74       if pd.api.t
-00019150: 7970 6573 2e69 735f 696e 7465 6765 725f  ypes.is_integer_
-00019160: 6474 7970 6528 636f 6c75 6d6e 2e5f 6d65  dtype(column._me
-00019170: 7461 5f6e 6f6e 656d 7074 7929 3a0a 2020  ta_nonempty):.  
-00019180: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-00019190: 203d 2063 6f6c 756d 6e2e 6173 7479 7065   = column.astype
-000191a0: 2822 6638 2229 0a0a 2020 2020 2020 2020  ("f8")..        
-000191b0: 6966 206e 6f74 206e 702e 6973 7375 6264  if not np.issubd
-000191c0: 7479 7065 2863 6f6c 756d 6e2e 6474 7970  type(column.dtyp
-000191d0: 652c 206e 702e 6e75 6d62 6572 293a 0a20  e, np.number):. 
-000191e0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-000191f0: 6e20 3d20 636f 6c75 6d6e 2e61 7374 7970  n = column.astyp
-00019200: 6528 2266 3822 290a 0a20 2020 2020 2020  e("f8")..       
-00019210: 206e 616d 6520 3d20 7365 6c66 2e5f 746f   name = self._to
-00019220: 6b65 6e5f 7072 6566 6978 202b 2022 6b75  ken_prefix + "ku
-00019230: 7274 6f73 6973 2d31 642d 2220 2b20 746f  rtosis-1d-" + to
-00019240: 6b65 6e69 7a65 2863 6f6c 756d 6e29 0a0a  kenize(column)..
-00019250: 2020 2020 2020 2020 6172 7261 795f 6b75          array_ku
-00019260: 7274 6f73 6973 203d 2064 615f 7374 6174  rtosis = da_stat
-00019270: 732e 6b75 7274 6f73 6973 280a 2020 2020  s.kurtosis(.    
-00019280: 2020 2020 2020 2020 636f 6c75 6d6e 2e76          column.v
-00019290: 616c 7565 732c 2061 7869 733d 302c 2066  alues, axis=0, f
-000192a0: 6973 6865 723d 6669 7368 6572 2c20 6269  isher=fisher, bi
-000192b0: 6173 3d62 6961 732c 206e 616e 5f70 6f6c  as=bias, nan_pol
-000192c0: 6963 793d 6e61 6e5f 706f 6c69 6379 0a20  icy=nan_policy. 
-000192d0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-000192e0: 2020 6c61 7965 7220 3d20 7b0a 2020 2020    layer = {.    
-000192f0: 2020 2020 2020 2020 286e 616d 652c 2030          (name, 0
-00019300: 293a 2028 6d65 7468 6f64 732e 7772 6170  ): (methods.wrap
-00019310: 5f6b 7572 746f 7369 735f 7265 6475 6374  _kurtosis_reduct
-00019320: 696f 6e2c 2028 6172 7261 795f 6b75 7274  ion, (array_kurt
-00019330: 6f73 6973 2e5f 6e61 6d65 2c29 2c20 4e6f  osis._name,), No
-00019340: 6e65 290a 2020 2020 2020 2020 7d0a 2020  ne).        }.  
-00019350: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
-00019360: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-00019370: 6d5f 636f 6c6c 6563 7469 6f6e 7328 0a20  m_collections(. 
-00019380: 2020 2020 2020 2020 2020 206e 616d 652c             name,
-00019390: 206c 6179 6572 2c20 6465 7065 6e64 656e   layer, dependen
-000193a0: 6369 6573 3d5b 6172 7261 795f 6b75 7274  cies=[array_kurt
-000193b0: 6f73 6973 5d0a 2020 2020 2020 2020 290a  osis].        ).
-000193c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000193d0: 6e65 775f 6464 5f6f 626a 6563 7428 0a20  new_dd_object(. 
-000193e0: 2020 2020 2020 2020 2020 2067 7261 7068             graph
-000193f0: 2c20 6e61 6d65 2c20 636f 6c75 6d6e 2e5f  , name, column._
-00019400: 6d65 7461 5f6e 6f6e 656d 7074 792e 6b75  meta_nonempty.ku
-00019410: 7274 6f73 6973 2829 2c20 6469 7669 7369  rtosis(), divisi
-00019420: 6f6e 733d 5b4e 6f6e 652c 204e 6f6e 655d  ons=[None, None]
-00019430: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00019440: 6465 6620 5f6b 7572 746f 7369 735f 6e75  def _kurtosis_nu
-00019450: 6d65 7269 6328 7365 6c66 2c20 6669 7368  meric(self, fish
-00019460: 6572 3d54 7275 652c 2062 6961 733d 5472  er=True, bias=Tr
-00019470: 7565 2c20 6e61 6e5f 706f 6c69 6379 3d22  ue, nan_policy="
-00019480: 7072 6f70 6167 6174 6522 293a 0a20 2020  propagate"):.   
-00019490: 2020 2020 2022 2222 4d65 7468 6f64 2066       """Method f
-000194a0: 6f72 2064 6174 6166 7261 6d65 7320 7769  or dataframes wi
-000194b0: 7468 206e 756d 6572 6963 2063 6f6c 756d  th numeric colum
-000194c0: 6e73 2e0a 0a20 2020 2020 2020 204d 6170  ns...        Map
-000194d0: 7320 7468 6520 6172 7261 7920 7665 7273  s the array vers
-000194e0: 696f 6e20 6672 6f6d 2064 612e 7374 6174  ion from da.stat
-000194f0: 7320 6f6e 746f 2074 6865 206e 756d 6572  s onto the numer
-00019500: 6963 2061 7272 6179 206f 6620 636f 6c75  ic array of colu
-00019510: 6d6e 732e 0a20 2020 2020 2020 2022 2222  mns..        """
-00019520: 0a20 2020 2020 2020 2023 2069 6d70 6f72  .        # impor
-00019530: 7420 6465 7065 6e64 7320 6f6e 2073 6369  t depends on sci
-00019540: 7079 2c20 6e6f 7420 696e 7374 616c 6c65  py, not installe
-00019550: 6420 6279 2064 6566 6175 6c74 0a20 2020  d by default.   
-00019560: 2020 2020 2066 726f 6d20 6461 736b 2e61       from dask.a
-00019570: 7272 6179 2069 6d70 6f72 7420 7374 6174  rray import stat
-00019580: 7320 6173 2064 615f 7374 6174 730a 0a20  s as da_stats.. 
-00019590: 2020 2020 2020 206e 756d 203d 2073 656c         num = sel
-000195a0: 662e 7365 6c65 6374 5f64 7479 7065 7328  f.select_dtypes(
-000195b0: 696e 636c 7564 653d 5b22 6e75 6d62 6572  include=["number
-000195c0: 222c 2022 626f 6f6c 225d 2c20 6578 636c  ", "bool"], excl
-000195d0: 7564 653d 5b6e 702e 7469 6d65 6465 6c74  ude=[np.timedelt
-000195e0: 6136 345d 290a 0a20 2020 2020 2020 2076  a64])..        v
-000195f0: 616c 7565 735f 6474 7970 6520 3d20 6e75  alues_dtype = nu
-00019600: 6d2e 7661 6c75 6573 2e64 7479 7065 0a20  m.values.dtype. 
-00019610: 2020 2020 2020 2061 7272 6179 5f76 616c         array_val
-00019620: 7565 7320 3d20 6e75 6d2e 7661 6c75 6573  ues = num.values
-00019630: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-00019640: 206e 702e 6973 7375 6264 7479 7065 2876   np.issubdtype(v
-00019650: 616c 7565 735f 6474 7970 652c 206e 702e  alues_dtype, np.
-00019660: 6e75 6d62 6572 293a 0a20 2020 2020 2020  number):.       
+00018570: 206e 756d 2e76 616c 7565 730a 0a20 2020   num.values..   
+00018580: 2020 2020 2069 6620 6e6f 7420 6e70 2e69       if not np.i
+00018590: 7373 7562 6474 7970 6528 7661 6c75 6573  ssubdtype(values
+000185a0: 5f64 7479 7065 2c20 6e70 2e6e 756d 6265  _dtype, np.numbe
+000185b0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+000185c0: 6172 7261 795f 7661 6c75 6573 203d 206e  array_values = n
+000185d0: 756d 2e76 616c 7565 732e 6173 7479 7065  um.values.astype
+000185e0: 2822 6638 2229 0a0a 2020 2020 2020 2020  ("f8")..        
+000185f0: 6172 7261 795f 736b 6577 203d 2064 615f  array_skew = da_
+00018600: 7374 6174 732e 736b 6577 280a 2020 2020  stats.skew(.    
+00018610: 2020 2020 2020 2020 6172 7261 795f 7661          array_va
+00018620: 6c75 6573 2c20 6178 6973 3d30 2c20 6269  lues, axis=0, bi
+00018630: 6173 3d62 6961 732c 206e 616e 5f70 6f6c  as=bias, nan_pol
+00018640: 6963 793d 6e61 6e5f 706f 6c69 6379 0a20  icy=nan_policy. 
+00018650: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00018660: 2020 6e61 6d65 203d 2073 656c 662e 5f74    name = self._t
+00018670: 6f6b 656e 5f70 7265 6669 7820 2b20 2276  oken_prefix + "v
+00018680: 6172 2d6e 756d 6572 6963 2220 2b20 746f  ar-numeric" + to
+00018690: 6b65 6e69 7a65 286e 756d 290a 2020 2020  kenize(num).    
+000186a0: 2020 2020 636f 6c73 203d 206e 756d 2e5f      cols = num._
+000186b0: 6d65 7461 2e63 6f6c 756d 6e73 2069 6620  meta.columns if 
+000186c0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+000186d0: 6528 6e75 6d29 2065 6c73 6520 4e6f 6e65  e(num) else None
+000186e0: 0a0a 2020 2020 2020 2020 736b 6577 5f73  ..        skew_s
+000186f0: 6861 7065 203d 206e 756d 2e5f 6d65 7461  hape = num._meta
+00018700: 5f6e 6f6e 656d 7074 792e 7661 6c75 6573  _nonempty.values
+00018710: 2e76 6172 2861 7869 733d 3029 2e73 6861  .var(axis=0).sha
+00018720: 7065 0a20 2020 2020 2020 2061 7272 6179  pe.        array
+00018730: 5f73 6b65 775f 6e61 6d65 203d 2028 6172  _skew_name = (ar
+00018740: 7261 795f 736b 6577 2e5f 6e61 6d65 2c29  ray_skew._name,)
+00018750: 202b 2028 302c 2920 2a20 6c65 6e28 736b   + (0,) * len(sk
+00018760: 6577 5f73 6861 7065 290a 0a20 2020 2020  ew_shape)..     
+00018770: 2020 206c 6179 6572 203d 207b 286e 616d     layer = {(nam
+00018780: 652c 2030 293a 2028 6d65 7468 6f64 732e  e, 0): (methods.
+00018790: 7772 6170 5f73 6b65 775f 7265 6475 6374  wrap_skew_reduct
+000187a0: 696f 6e2c 2061 7272 6179 5f73 6b65 775f  ion, array_skew_
+000187b0: 6e61 6d65 2c20 636f 6c73 297d 0a20 2020  name, cols)}.   
+000187c0: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+000187d0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+000187e0: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+000187f0: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
+00018800: 656e 6369 6573 3d5b 6172 7261 795f 736b  encies=[array_sk
+00018810: 6577 5d29 0a0a 2020 2020 2020 2020 7265  ew])..        re
+00018820: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
+00018830: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
+00018840: 6772 6170 682c 206e 616d 652c 206e 756d  graph, name, num
+00018850: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
+00018860: 736b 6577 2829 2c20 6469 7669 7369 6f6e  skew(), division
+00018870: 733d 5b4e 6f6e 652c 204e 6f6e 655d 0a20  s=[None, None]. 
+00018880: 2020 2020 2020 2029 0a0a 2020 2020 405f         )..    @_
+00018890: 6e75 6d65 7269 635f 6f6e 6c79 0a20 2020  numeric_only.   
+000188a0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+000188b0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+000188c0: 2064 6566 206b 7572 746f 7369 7328 0a20   def kurtosis(. 
+000188d0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+000188e0: 2020 2020 2061 7869 733d 302c 0a20 2020       axis=0,.   
+000188f0: 2020 2020 2066 6973 6865 723d 5472 7565       fisher=True
+00018900: 2c0a 2020 2020 2020 2020 6269 6173 3d54  ,.        bias=T
+00018910: 7275 652c 0a20 2020 2020 2020 206e 616e  rue,.        nan
+00018920: 5f70 6f6c 6963 793d 2270 726f 7061 6761  _policy="propaga
+00018930: 7465 222c 0a20 2020 2020 2020 206f 7574  te",.        out
+00018940: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
+00018950: 756d 6572 6963 5f6f 6e6c 793d 4e6f 6e65  umeric_only=None
+00018960: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+00018970: 2022 2222 0a20 2020 2020 2020 202e 2e20   """.        .. 
+00018980: 6e6f 7465 3a3a 0a0a 2020 2020 2020 2020  note::..        
+00018990: 2020 2054 6869 7320 696d 706c 656d 656e     This implemen
+000189a0: 7461 7469 6f6e 2066 6f6c 6c6f 7773 2074  tation follows t
+000189b0: 6865 2064 6173 6b2e 6172 7261 792e 7374  he dask.array.st
+000189c0: 6174 7320 696d 706c 656d 656e 7461 7469  ats implementati
+000189d0: 6f6e 0a20 2020 2020 2020 2020 2020 6f66  on.           of
+000189e0: 206b 7572 746f 7369 7320 616e 6420 6361   kurtosis and ca
+000189f0: 6c63 756c 6174 6573 206b 7572 746f 7369  lculates kurtosi
+00018a00: 7320 7769 7468 6f75 7420 7461 6b69 6e67  s without taking
+00018a10: 2069 6e74 6f20 6163 636f 756e 740a 2020   into account.  
+00018a20: 2020 2020 2020 2020 2061 2062 6961 7320           a bias 
+00018a30: 7465 726d 2066 6f72 2066 696e 6974 6520  term for finite 
+00018a40: 7361 6d70 6c65 2073 697a 652c 2077 6869  sample size, whi
+00018a50: 6368 2063 6f72 7265 7370 6f6e 6473 2074  ch corresponds t
+00018a60: 6f20 7468 650a 2020 2020 2020 2020 2020  o the.          
+00018a70: 2064 6566 6175 6c74 2073 6574 7469 6e67   default setting
+00018a80: 7320 6f66 2074 6865 2073 6369 7079 2e73  s of the scipy.s
+00018a90: 7461 7473 206b 7572 746f 7369 7320 6361  tats kurtosis ca
+00018aa0: 6c63 756c 6174 696f 6e2e 2054 6869 7320  lculation. This 
+00018ab0: 6469 6666 6572 730a 2020 2020 2020 2020  differs.        
+00018ac0: 2020 2066 726f 6d20 7061 6e64 6173 2e0a     from pandas..
+00018ad0: 0a20 2020 2020 2020 2020 2020 4675 7274  .           Furt
+00018ae0: 6865 722c 2074 6869 7320 6d65 7468 6f64  her, this method
+00018af0: 2063 7572 7265 6e74 6c79 2064 6f65 7320   currently does 
+00018b00: 6e6f 7420 7375 7070 6f72 7420 6669 6c74  not support filt
+00018b10: 6572 696e 6720 6f75 7420 4e61 4e0a 2020  ering out NaN.  
+00018b20: 2020 2020 2020 2020 2076 616c 7565 732c           values,
+00018b30: 2077 6869 6368 2069 7320 6167 6169 6e20   which is again 
+00018b40: 6120 6469 6666 6572 656e 6365 2074 6f20  a difference to 
+00018b50: 5061 6e64 6173 2e0a 2020 2020 2020 2020  Pandas..        
+00018b60: 2222 220a 2020 2020 2020 2020 6966 2050  """.        if P
+00018b70: 414e 4441 535f 4754 5f32 3030 2061 6e64  ANDAS_GT_200 and
+00018b80: 2061 7869 7320 6973 204e 6f6e 653a 0a20   axis is None:. 
+00018b90: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00018ba0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+00018bb0: 2020 2020 2020 2020 2020 2020 2022 6061               "`a
+00018bc0: 7869 733d 4e6f 6e65 6020 6973 6e27 7420  xis=None` isn't 
+00018bd0: 6375 7272 656e 746c 7920 7375 7070 6f72  currently suppor
+00018be0: 7465 6420 666f 7220 606b 7572 746f 7369  ted for `kurtosi
+00018bf0: 7360 2077 6865 6e20 7573 696e 6720 6070  s` when using `p
+00018c00: 616e 6461 7320 3e3d 3260 2022 0a20 2020  andas >=2` ".   
+00018c10: 2020 2020 2020 2020 2020 2020 2066 2228               f"(
+00018c20: 7061 6e64 6173 3d7b 7374 7228 5041 4e44  pandas={str(PAND
+00018c30: 4153 5f56 4552 5349 4f4e 297d 2069 7320  AS_VERSION)} is 
+00018c40: 696e 7374 616c 6c65 6429 2e22 0a20 2020  installed).".   
+00018c50: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00018c60: 2020 2061 7869 7320 3d20 7365 6c66 2e5f     axis = self._
+00018c70: 7661 6c69 6461 7465 5f61 7869 7328 6178  validate_axis(ax
+00018c80: 6973 290a 2020 2020 2020 2020 5f72 6169  is).        _rai
+00018c90: 7365 5f69 665f 6f62 6a65 6374 5f73 6572  se_if_object_ser
+00018ca0: 6965 7328 7365 6c66 2c20 226b 7572 746f  ies(self, "kurto
+00018cb0: 7369 7322 290a 2020 2020 2020 2020 6d65  sis").        me
+00018cc0: 7461 203d 2073 656c 662e 5f6d 6574 615f  ta = self._meta_
+00018cd0: 6e6f 6e65 6d70 7479 2e6b 7572 746f 7369  nonempty.kurtosi
+00018ce0: 7328 290a 2020 2020 2020 2020 6966 2061  s().        if a
+00018cf0: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
+00018d00: 2020 2020 2020 7265 7375 6c74 203d 206d        result = m
+00018d10: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+00018d20: 2020 2020 2020 2020 2020 2020 2020 204d                 M
+00018d30: 2e6b 7572 746f 7369 732c 0a20 2020 2020  .kurtosis,.     
+00018d40: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+00018d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018d60: 206d 6574 613d 6d65 7461 2c0a 2020 2020   meta=meta,.    
+00018d70: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
+00018d80: 6e3d 7365 6c66 2e5f 746f 6b65 6e5f 7072  n=self._token_pr
+00018d90: 6566 6978 202b 2022 6b75 7274 6f73 6973  efix + "kurtosis
+00018da0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00018db0: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
+00018dc0: 2020 2020 2020 2020 2020 2020 2020 656e                en
+00018dd0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+00018de0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00018df0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00018e00: 7265 7475 726e 2068 616e 646c 655f 6f75  return handle_ou
+00018e10: 7428 6f75 742c 2072 6573 756c 7429 0a20  t(out, result). 
+00018e20: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00018e30: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00018e40: 2e6e 6469 6d20 3d3d 2031 3a0a 2020 2020  .ndim == 1:.    
+00018e50: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00018e60: 6c74 203d 2073 656c 662e 5f6b 7572 746f  lt = self._kurto
+00018e70: 7369 735f 3164 280a 2020 2020 2020 2020  sis_1d(.        
+00018e80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00018e90: 2c20 6669 7368 6572 3d66 6973 6865 722c  , fisher=fisher,
+00018ea0: 2062 6961 733d 6269 6173 2c20 6e61 6e5f   bias=bias, nan_
+00018eb0: 706f 6c69 6379 3d6e 616e 5f70 6f6c 6963  policy=nan_polic
+00018ec0: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
+00018ed0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00018ee0: 2020 2020 7265 7475 726e 2068 616e 646c      return handl
+00018ef0: 655f 6f75 7428 6f75 742c 2072 6573 756c  e_out(out, resul
+00018f00: 7429 0a20 2020 2020 2020 2020 2020 2065  t).            e
+00018f10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00018f20: 2020 2020 2072 6573 756c 7420 3d20 7365       result = se
+00018f30: 6c66 2e5f 6b75 7274 6f73 6973 5f6e 756d  lf._kurtosis_num
+00018f40: 6572 6963 280a 2020 2020 2020 2020 2020  eric(.          
+00018f50: 2020 2020 2020 2020 2020 6669 7368 6572            fisher
+00018f60: 3d66 6973 6865 722c 2062 6961 733d 6269  =fisher, bias=bi
+00018f70: 6173 2c20 6e61 6e5f 706f 6c69 6379 3d6e  as, nan_policy=n
+00018f80: 616e 5f70 6f6c 6963 790a 2020 2020 2020  an_policy.      
+00018f90: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00018fa0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+00018fb0: 7374 616e 6365 2873 656c 662c 2044 6174  stance(self, Dat
+00018fc0: 6146 7261 6d65 293a 0a20 2020 2020 2020  aFrame):.       
+00018fd0: 2020 2020 2020 2020 2072 6573 756c 742e           result.
+00018fe0: 6469 7669 7369 6f6e 7320 3d20 2873 656c  divisions = (sel
+00018ff0: 662e 636f 6c75 6d6e 732e 6d69 6e28 292c  f.columns.min(),
+00019000: 2073 656c 662e 636f 6c75 6d6e 732e 6d61   self.columns.ma
+00019010: 7828 2929 0a0a 2020 2020 2020 2020 2020  x())..          
+00019020: 2020 7265 7475 726e 2068 616e 646c 655f    return handle_
+00019030: 6f75 7428 6f75 742c 2072 6573 756c 7429  out(out, result)
+00019040: 0a0a 2020 2020 6465 6620 5f6b 7572 746f  ..    def _kurto
+00019050: 7369 735f 3164 2873 656c 662c 2063 6f6c  sis_1d(self, col
+00019060: 756d 6e2c 2066 6973 6865 723d 5472 7565  umn, fisher=True
+00019070: 2c20 6269 6173 3d54 7275 652c 206e 616e  , bias=True, nan
+00019080: 5f70 6f6c 6963 793d 2270 726f 7061 6761  _policy="propaga
+00019090: 7465 2229 3a0a 2020 2020 2020 2020 2222  te"):.        ""
+000190a0: 2231 4420 7665 7273 696f 6e20 6f66 2074  "1D version of t
+000190b0: 6865 206b 7572 746f 7369 7320 6361 6c63  he kurtosis calc
+000190c0: 756c 6174 696f 6e2e 0a0a 2020 2020 2020  ulation...      
+000190d0: 2020 5573 6573 2074 6865 2061 7272 6179    Uses the array
+000190e0: 2076 6572 7369 6f6e 2066 726f 6d20 6461   version from da
+000190f0: 2e73 7461 7473 2069 6e20 6361 7365 2077  .stats in case w
+00019100: 6520 6172 6520 7061 7373 696e 6720 696e  e are passing in
+00019110: 2061 2073 696e 676c 6520 7365 7269 6573   a single series
+00019120: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00019130: 2020 2020 2023 2069 6d70 6f72 7420 6465       # import de
+00019140: 7065 6e64 7320 6f6e 2073 6369 7079 2c20  pends on scipy, 
+00019150: 6e6f 7420 696e 7374 616c 6c65 6420 6279  not installed by
+00019160: 2064 6566 6175 6c74 0a20 2020 2020 2020   default.       
+00019170: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
+00019180: 2069 6d70 6f72 7420 7374 6174 7320 6173   import stats as
+00019190: 2064 615f 7374 6174 730a 0a20 2020 2020   da_stats..     
+000191a0: 2020 2069 6620 7064 2e61 7069 2e74 7970     if pd.api.typ
+000191b0: 6573 2e69 735f 696e 7465 6765 725f 6474  es.is_integer_dt
+000191c0: 7970 6528 636f 6c75 6d6e 2e5f 6d65 7461  ype(column._meta
+000191d0: 5f6e 6f6e 656d 7074 7929 3a0a 2020 2020  _nonempty):.    
+000191e0: 2020 2020 2020 2020 636f 6c75 6d6e 203d          column =
+000191f0: 2063 6f6c 756d 6e2e 6173 7479 7065 2822   column.astype("
+00019200: 6638 2229 0a0a 2020 2020 2020 2020 6966  f8")..        if
+00019210: 206e 6f74 206e 702e 6973 7375 6264 7479   not np.issubdty
+00019220: 7065 2863 6f6c 756d 6e2e 6474 7970 652c  pe(column.dtype,
+00019230: 206e 702e 6e75 6d62 6572 293a 0a20 2020   np.number):.   
+00019240: 2020 2020 2020 2020 2063 6f6c 756d 6e20           column 
+00019250: 3d20 636f 6c75 6d6e 2e61 7374 7970 6528  = column.astype(
+00019260: 2266 3822 290a 0a20 2020 2020 2020 206e  "f8")..        n
+00019270: 616d 6520 3d20 7365 6c66 2e5f 746f 6b65  ame = self._toke
+00019280: 6e5f 7072 6566 6978 202b 2022 6b75 7274  n_prefix + "kurt
+00019290: 6f73 6973 2d31 642d 2220 2b20 746f 6b65  osis-1d-" + toke
+000192a0: 6e69 7a65 2863 6f6c 756d 6e29 0a0a 2020  nize(column)..  
+000192b0: 2020 2020 2020 6172 7261 795f 6b75 7274        array_kurt
+000192c0: 6f73 6973 203d 2064 615f 7374 6174 732e  osis = da_stats.
+000192d0: 6b75 7274 6f73 6973 280a 2020 2020 2020  kurtosis(.      
+000192e0: 2020 2020 2020 636f 6c75 6d6e 2e76 616c        column.val
+000192f0: 7565 732c 2061 7869 733d 302c 2066 6973  ues, axis=0, fis
+00019300: 6865 723d 6669 7368 6572 2c20 6269 6173  her=fisher, bias
+00019310: 3d62 6961 732c 206e 616e 5f70 6f6c 6963  =bias, nan_polic
+00019320: 793d 6e61 6e5f 706f 6c69 6379 0a20 2020  y=nan_policy.   
+00019330: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00019340: 6c61 7965 7220 3d20 7b0a 2020 2020 2020  layer = {.      
+00019350: 2020 2020 2020 286e 616d 652c 2030 293a        (name, 0):
+00019360: 2028 6d65 7468 6f64 732e 7772 6170 5f6b   (methods.wrap_k
+00019370: 7572 746f 7369 735f 7265 6475 6374 696f  urtosis_reductio
+00019380: 6e2c 2028 6172 7261 795f 6b75 7274 6f73  n, (array_kurtos
+00019390: 6973 2e5f 6e61 6d65 2c29 2c20 4e6f 6e65  is._name,), None
+000193a0: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
+000193b0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
+000193c0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+000193d0: 636f 6c6c 6563 7469 6f6e 7328 0a20 2020  collections(.   
+000193e0: 2020 2020 2020 2020 206e 616d 652c 206c           name, l
+000193f0: 6179 6572 2c20 6465 7065 6e64 656e 6369  ayer, dependenci
+00019400: 6573 3d5b 6172 7261 795f 6b75 7274 6f73  es=[array_kurtos
+00019410: 6973 5d0a 2020 2020 2020 2020 290a 0a20  is].        ).. 
+00019420: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+00019430: 775f 6464 5f6f 626a 6563 7428 0a20 2020  w_dd_object(.   
+00019440: 2020 2020 2020 2020 2067 7261 7068 2c20           graph, 
+00019450: 6e61 6d65 2c20 636f 6c75 6d6e 2e5f 6d65  name, column._me
+00019460: 7461 5f6e 6f6e 656d 7074 792e 6b75 7274  ta_nonempty.kurt
+00019470: 6f73 6973 2829 2c20 6469 7669 7369 6f6e  osis(), division
+00019480: 733d 5b4e 6f6e 652c 204e 6f6e 655d 0a20  s=[None, None]. 
+00019490: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+000194a0: 6620 5f6b 7572 746f 7369 735f 6e75 6d65  f _kurtosis_nume
+000194b0: 7269 6328 7365 6c66 2c20 6669 7368 6572  ric(self, fisher
+000194c0: 3d54 7275 652c 2062 6961 733d 5472 7565  =True, bias=True
+000194d0: 2c20 6e61 6e5f 706f 6c69 6379 3d22 7072  , nan_policy="pr
+000194e0: 6f70 6167 6174 6522 293a 0a20 2020 2020  opagate"):.     
+000194f0: 2020 2022 2222 4d65 7468 6f64 2066 6f72     """Method for
+00019500: 2064 6174 6166 7261 6d65 7320 7769 7468   dataframes with
+00019510: 206e 756d 6572 6963 2063 6f6c 756d 6e73   numeric columns
+00019520: 2e0a 0a20 2020 2020 2020 204d 6170 7320  ...        Maps 
+00019530: 7468 6520 6172 7261 7920 7665 7273 696f  the array versio
+00019540: 6e20 6672 6f6d 2064 612e 7374 6174 7320  n from da.stats 
+00019550: 6f6e 746f 2074 6865 206e 756d 6572 6963  onto the numeric
+00019560: 2061 7272 6179 206f 6620 636f 6c75 6d6e   array of column
+00019570: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
+00019580: 2020 2020 2020 2023 2069 6d70 6f72 7420         # import 
+00019590: 6465 7065 6e64 7320 6f6e 2073 6369 7079  depends on scipy
+000195a0: 2c20 6e6f 7420 696e 7374 616c 6c65 6420  , not installed 
+000195b0: 6279 2064 6566 6175 6c74 0a20 2020 2020  by default.     
+000195c0: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
+000195d0: 6179 2069 6d70 6f72 7420 7374 6174 7320  ay import stats 
+000195e0: 6173 2064 615f 7374 6174 730a 0a20 2020  as da_stats..   
+000195f0: 2020 2020 206e 756d 203d 2073 656c 662e       num = self.
+00019600: 7365 6c65 6374 5f64 7479 7065 7328 696e  select_dtypes(in
+00019610: 636c 7564 653d 5b22 6e75 6d62 6572 222c  clude=["number",
+00019620: 2022 626f 6f6c 225d 2c20 6578 636c 7564   "bool"], exclud
+00019630: 653d 5b6e 702e 7469 6d65 6465 6c74 6136  e=[np.timedelta6
+00019640: 345d 290a 0a20 2020 2020 2020 2076 616c  4])..        val
+00019650: 7565 735f 6474 7970 6520 3d20 6e75 6d2e  ues_dtype = num.
+00019660: 7661 6c75 6573 2e64 7479 7065 0a20 2020  values.dtype.   
 00019670: 2020 2020 2061 7272 6179 5f76 616c 7565       array_value
-00019680: 7320 3d20 6e75 6d2e 7661 6c75 6573 2e61  s = num.values.a
-00019690: 7374 7970 6528 2266 3822 290a 0a20 2020  stype("f8")..   
-000196a0: 2020 2020 2061 7272 6179 5f6b 7572 746f       array_kurto
-000196b0: 7369 7320 3d20 6461 5f73 7461 7473 2e6b  sis = da_stats.k
-000196c0: 7572 746f 7369 7328 0a20 2020 2020 2020  urtosis(.       
-000196d0: 2020 2020 2061 7272 6179 5f76 616c 7565       array_value
-000196e0: 732c 2061 7869 733d 302c 2066 6973 6865  s, axis=0, fishe
-000196f0: 723d 6669 7368 6572 2c20 6269 6173 3d62  r=fisher, bias=b
-00019700: 6961 732c 206e 616e 5f70 6f6c 6963 793d  ias, nan_policy=
-00019710: 6e61 6e5f 706f 6c69 6379 0a20 2020 2020  nan_policy.     
-00019720: 2020 2029 0a0a 2020 2020 2020 2020 6e61     )..        na
-00019730: 6d65 203d 2073 656c 662e 5f74 6f6b 656e  me = self._token
-00019740: 5f70 7265 6669 7820 2b20 226b 7572 746f  _prefix + "kurto
-00019750: 7369 732d 6e75 6d65 7269 6322 202b 2074  sis-numeric" + t
-00019760: 6f6b 656e 697a 6528 6e75 6d29 0a20 2020  okenize(num).   
-00019770: 2020 2020 2063 6f6c 7320 3d20 6e75 6d2e       cols = num.
-00019780: 5f6d 6574 612e 636f 6c75 6d6e 7320 6966  _meta.columns if
-00019790: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
-000197a0: 6b65 286e 756d 2920 656c 7365 204e 6f6e  ke(num) else Non
-000197b0: 650a 0a20 2020 2020 2020 206b 7572 746f  e..        kurto
-000197c0: 7369 735f 7368 6170 6520 3d20 6e75 6d2e  sis_shape = num.
-000197d0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e76  _meta_nonempty.v
-000197e0: 616c 7565 732e 7661 7228 6178 6973 3d30  alues.var(axis=0
-000197f0: 292e 7368 6170 650a 2020 2020 2020 2020  ).shape.        
-00019800: 6172 7261 795f 6b75 7274 6f73 6973 5f6e  array_kurtosis_n
-00019810: 616d 6520 3d20 2861 7272 6179 5f6b 7572  ame = (array_kur
-00019820: 746f 7369 732e 5f6e 616d 652c 2920 2b20  tosis._name,) + 
-00019830: 2830 2c29 202a 206c 656e 286b 7572 746f  (0,) * len(kurto
-00019840: 7369 735f 7368 6170 6529 0a0a 2020 2020  sis_shape)..    
-00019850: 2020 2020 6c61 7965 7220 3d20 7b0a 2020      layer = {.  
-00019860: 2020 2020 2020 2020 2020 286e 616d 652c            (name,
-00019870: 2030 293a 2028 6d65 7468 6f64 732e 7772   0): (methods.wr
-00019880: 6170 5f6b 7572 746f 7369 735f 7265 6475  ap_kurtosis_redu
-00019890: 6374 696f 6e2c 2061 7272 6179 5f6b 7572  ction, array_kur
-000198a0: 746f 7369 735f 6e61 6d65 2c20 636f 6c73  tosis_name, cols
-000198b0: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
-000198c0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
-000198d0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
-000198e0: 636f 6c6c 6563 7469 6f6e 7328 0a20 2020  collections(.   
-000198f0: 2020 2020 2020 2020 206e 616d 652c 206c           name, l
-00019900: 6179 6572 2c20 6465 7065 6e64 656e 6369  ayer, dependenci
-00019910: 6573 3d5b 6172 7261 795f 6b75 7274 6f73  es=[array_kurtos
-00019920: 6973 5d0a 2020 2020 2020 2020 290a 0a20  is].        ).. 
-00019930: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00019940: 775f 6464 5f6f 626a 6563 7428 0a20 2020  w_dd_object(.   
-00019950: 2020 2020 2020 2020 2067 7261 7068 2c20           graph, 
-00019960: 6e61 6d65 2c20 6e75 6d2e 5f6d 6574 615f  name, num._meta_
-00019970: 6e6f 6e65 6d70 7479 2e6b 7572 746f 7369  nonempty.kurtosi
-00019980: 7328 292c 2064 6976 6973 696f 6e73 3d5b  s(), divisions=[
-00019990: 4e6f 6e65 2c20 4e6f 6e65 5d0a 2020 2020  None, None].    
-000199a0: 2020 2020 290a 0a20 2020 2040 5f6e 756d      )..    @_num
-000199b0: 6572 6963 5f6f 6e6c 790a 2020 2020 4064  eric_only.    @d
-000199c0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-000199d0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-000199e0: 6620 7365 6d28 7365 6c66 2c20 6178 6973  f sem(self, axis
-000199f0: 3d4e 6f6e 652c 2073 6b69 706e 613d 5472  =None, skipna=Tr
-00019a00: 7565 2c20 6464 6f66 3d31 2c20 7370 6c69  ue, ddof=1, spli
-00019a10: 745f 6576 6572 793d 4661 6c73 652c 206e  t_every=False, n
-00019a20: 756d 6572 6963 5f6f 6e6c 793d 4e6f 6e65  umeric_only=None
-00019a30: 293a 0a20 2020 2020 2020 2061 7869 7320  ):.        axis 
-00019a40: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
-00019a50: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
-00019a60: 2020 2020 5f72 6169 7365 5f69 665f 6f62      _raise_if_ob
-00019a70: 6a65 6374 5f73 6572 6965 7328 7365 6c66  ject_series(self
-00019a80: 2c20 2273 656d 2229 0a20 2020 2020 2020  , "sem").       
-00019a90: 2077 6974 6820 6368 6563 6b5f 6e75 6d65   with check_nume
-00019aa0: 7269 635f 6f6e 6c79 5f64 6570 7265 6361  ric_only_depreca
-00019ab0: 7469 6f6e 2829 3a0a 2020 2020 2020 2020  tion():.        
-00019ac0: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
-00019ad0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e73  _meta_nonempty.s
-00019ae0: 656d 280a 2020 2020 2020 2020 2020 2020  em(.            
-00019af0: 2020 2020 6178 6973 3d61 7869 732c 2073      axis=axis, s
-00019b00: 6b69 706e 613d 736b 6970 6e61 2c20 6464  kipna=skipna, dd
-00019b10: 6f66 3d64 646f 662c 206e 756d 6572 6963  of=ddof, numeric
-00019b20: 5f6f 6e6c 793d 6e75 6d65 7269 635f 6f6e  _only=numeric_on
-00019b30: 6c79 0a20 2020 2020 2020 2020 2020 2029  ly.            )
-00019b40: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
-00019b50: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
-00019b60: 2020 2072 6574 7572 6e20 6d61 705f 7061     return map_pa
-00019b70: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-00019b80: 2020 2020 2020 2020 2020 4d2e 7365 6d2c            M.sem,
-00019b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019ba0: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-00019bb0: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
-00019bc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00019bd0: 2020 746f 6b65 6e3d 7365 6c66 2e5f 746f    token=self._to
-00019be0: 6b65 6e5f 7072 6566 6978 202b 2022 7365  ken_prefix + "se
-00019bf0: 6d22 2c0a 2020 2020 2020 2020 2020 2020  m",.            
-00019c00: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
-00019c10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00019c20: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
-00019c30: 2020 2020 2020 2020 2020 2020 2020 6464                dd
-00019c40: 6f66 3d64 646f 662c 0a20 2020 2020 2020  of=ddof,.       
-00019c50: 2020 2020 2020 2020 2070 6172 656e 745f           parent_
-00019c60: 6d65 7461 3d73 656c 662e 5f6d 6574 612c  meta=self._meta,
-00019c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019c80: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
-00019c90: 6d65 7269 635f 6f6e 6c79 2c0a 2020 2020  meric_only,.    
-00019ca0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00019cb0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00019cc0: 2020 2020 6e75 6d20 3d20 7365 6c66 2e5f      num = self._
-00019cd0: 6765 745f 6e75 6d65 7269 635f 6461 7461  get_numeric_data
-00019ce0: 2829 0a20 2020 2020 2020 2020 2020 2076  ().            v
-00019cf0: 203d 206e 756d 2e76 6172 2873 6b69 706e   = num.var(skipn
-00019d00: 613d 736b 6970 6e61 2c20 6464 6f66 3d64  a=skipna, ddof=d
-00019d10: 646f 662c 2073 706c 6974 5f65 7665 7279  dof, split_every
-00019d20: 3d73 706c 6974 5f65 7665 7279 290a 2020  =split_every).  
-00019d30: 2020 2020 2020 2020 2020 6e20 3d20 6e75            n = nu
-00019d40: 6d2e 636f 756e 7428 7370 6c69 745f 6576  m.count(split_ev
-00019d50: 6572 793d 7370 6c69 745f 6576 6572 7929  ery=split_every)
-00019d60: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00019d70: 6520 3d20 7365 6c66 2e5f 746f 6b65 6e5f  e = self._token_
-00019d80: 7072 6566 6978 202b 2022 7365 6d22 0a20  prefix + "sem". 
-00019d90: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00019da0: 7420 3d20 6d61 705f 7061 7274 6974 696f  t = map_partitio
-00019db0: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-00019dc0: 2020 2020 6e70 2e73 7172 742c 0a20 2020      np.sqrt,.   
-00019dd0: 2020 2020 2020 2020 2020 2020 2076 202f               v /
-00019de0: 206e 2c0a 2020 2020 2020 2020 2020 2020   n,.            
-00019df0: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
-00019e00: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00019e10: 6f6b 656e 3d6e 616d 652c 0a20 2020 2020  oken=name,.     
-00019e20: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
-00019e30: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-00019e40: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00019e50: 2020 2070 6172 656e 745f 6d65 7461 3d73     parent_meta=s
-00019e60: 656c 662e 5f6d 6574 612c 0a20 2020 2020  elf._meta,.     
-00019e70: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00019e80: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00019e90: 6e63 6528 7365 6c66 2c20 4461 7461 4672  nce(self, DataFr
-00019ea0: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
-00019eb0: 2020 2020 2020 7265 7375 6c74 2e64 6976        result.div
-00019ec0: 6973 696f 6e73 203d 2028 7365 6c66 2e63  isions = (self.c
-00019ed0: 6f6c 756d 6e73 2e6d 696e 2829 2c20 7365  olumns.min(), se
-00019ee0: 6c66 2e63 6f6c 756d 6e73 2e6d 6178 2829  lf.columns.max()
-00019ef0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00019f00: 7475 726e 2072 6573 756c 740a 0a20 2020  turn result..   
-00019f10: 2040 5f6e 756d 6572 6963 5f64 6174 610a   @_numeric_data.
-00019f20: 2020 2020 6465 6620 7175 616e 7469 6c65      def quantile
-00019f30: 2873 656c 662c 2071 3d30 2e35 2c20 6178  (self, q=0.5, ax
-00019f40: 6973 3d30 2c20 6e75 6d65 7269 635f 6f6e  is=0, numeric_on
-00019f50: 6c79 3d6e 6f5f 6465 6661 756c 742c 206d  ly=no_default, m
-00019f60: 6574 686f 643d 2264 6566 6175 6c74 2229  ethod="default")
-00019f70: 3a0a 2020 2020 2020 2020 2222 2241 7070  :.        """App
-00019f80: 726f 7869 6d61 7465 2072 6f77 2d77 6973  roximate row-wis
-00019f90: 6520 616e 6420 7072 6563 6973 6520 636f  e and precise co
-00019fa0: 6c75 6d6e 2d77 6973 6520 7175 616e 7469  lumn-wise quanti
-00019fb0: 6c65 7320 6f66 2044 6174 6146 7261 6d65  les of DataFrame
-00019fc0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00019fd0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00019fe0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00019ff0: 7120 3a20 6c69 7374 2f61 7272 6179 206f  q : list/array o
-0001a000: 6620 666c 6f61 7473 2c20 6465 6661 756c  f floats, defaul
-0001a010: 7420 302e 3520 2835 3025 290a 2020 2020  t 0.5 (50%).    
-0001a020: 2020 2020 2020 2020 4974 6572 6162 6c65          Iterable
-0001a030: 206f 6620 6e75 6d62 6572 7320 7261 6e67   of numbers rang
-0001a040: 696e 6720 6672 6f6d 2030 2074 6f20 3120  ing from 0 to 1 
-0001a050: 666f 7220 7468 6520 6465 7369 7265 6420  for the desired 
-0001a060: 7175 616e 7469 6c65 730a 2020 2020 2020  quantiles.      
-0001a070: 2020 6178 6973 203a 207b 302c 2031 2c20    axis : {0, 1, 
-0001a080: 2769 6e64 6578 272c 2027 636f 6c75 6d6e  'index', 'column
-0001a090: 7327 7d20 2864 6566 6175 6c74 2030 290a  s'} (default 0).
-0001a0a0: 2020 2020 2020 2020 2020 2020 3020 6f72              0 or
-0001a0b0: 2027 696e 6465 7827 2066 6f72 2072 6f77   'index' for row
-0001a0c0: 2d77 6973 652c 2031 206f 7220 2763 6f6c  -wise, 1 or 'col
-0001a0d0: 756d 6e73 2720 666f 7220 636f 6c75 6d6e  umns' for column
-0001a0e0: 2d77 6973 650a 2020 2020 2020 2020 6d65  -wise.        me
-0001a0f0: 7468 6f64 203a 207b 2764 6566 6175 6c74  thod : {'default
-0001a100: 272c 2027 7464 6967 6573 7427 2c20 2764  ', 'tdigest', 'd
-0001a110: 6173 6b27 7d2c 206f 7074 696f 6e61 6c0a  ask'}, optional.
-0001a120: 2020 2020 2020 2020 2020 2020 5768 6174              What
-0001a130: 206d 6574 686f 6420 746f 2075 7365 2e20   method to use. 
-0001a140: 4279 2064 6566 6175 6c74 2077 696c 6c20  By default will 
-0001a150: 7573 6520 6461 736b 2773 2069 6e74 6572  use dask's inter
-0001a160: 6e61 6c20 6375 7374 6f6d 0a20 2020 2020  nal custom.     
-0001a170: 2020 2020 2020 2061 6c67 6f72 6974 686d         algorithm
-0001a180: 2028 6060 2764 6173 6b27 6060 292e 2020   (``'dask'``).  
-0001a190: 4966 2073 6574 2074 6f20 6060 2774 6469  If set to ``'tdi
-0001a1a0: 6765 7374 2760 6020 7769 6c6c 2075 7365  gest'`` will use
-0001a1b0: 2074 6469 6765 7374 0a20 2020 2020 2020   tdigest.       
-0001a1c0: 2020 2020 2066 6f72 2066 6c6f 6174 7320       for floats 
-0001a1d0: 616e 6420 696e 7473 2061 6e64 2066 616c  and ints and fal
-0001a1e0: 6c62 6163 6b20 746f 2074 6865 2060 6027  lback to the ``'
-0001a1f0: 6461 736b 2760 6020 6f74 6865 7277 6973  dask'`` otherwis
-0001a200: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
-0001a210: 2020 2020 2020 206e 756d 6572 6963 5f6b         numeric_k
-0001a220: 7761 7267 7320 3d20 5f6e 756d 6572 6963  wargs = _numeric
-0001a230: 5f6f 6e6c 795f 6d61 7962 655f 7761 726e  _only_maybe_warn
-0001a240: 2873 656c 662c 206e 756d 6572 6963 5f6f  (self, numeric_o
-0001a250: 6e6c 792c 2064 6566 6175 6c74 3d54 7275  nly, default=Tru
-0001a260: 6529 0a0a 2020 2020 2020 2020 6178 6973  e)..        axis
-0001a270: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
-0001a280: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
-0001a290: 2020 2020 206b 6579 6e61 6d65 203d 2022       keyname = "
-0001a2a0: 7175 616e 7469 6c65 732d 636f 6e63 6174  quantiles-concat
-0001a2b0: 2d2d 2220 2b20 746f 6b65 6e69 7a65 2873  --" + tokenize(s
-0001a2c0: 656c 662c 2071 2c20 6178 6973 290a 0a20  elf, q, axis).. 
-0001a2d0: 2020 2020 2020 2077 6974 6820 6368 6563         with chec
-0001a2e0: 6b5f 6e75 6d65 7269 635f 6f6e 6c79 5f64  k_numeric_only_d
-0001a2f0: 6570 7265 6361 7469 6f6e 2829 3a0a 2020  eprecation():.  
-0001a300: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
-0001a310: 2073 656c 662e 5f6d 6574 612e 7175 616e   self._meta.quan
-0001a320: 7469 6c65 2871 2c20 6178 6973 3d61 7869  tile(q, axis=axi
-0001a330: 732c 202a 2a6e 756d 6572 6963 5f6b 7761  s, **numeric_kwa
-0001a340: 7267 7329 0a0a 2020 2020 2020 2020 6966  rgs)..        if
-0001a350: 2061 7869 7320 3d3d 2031 3a0a 2020 2020   axis == 1:.    
-0001a360: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0001a370: 7461 6e63 6528 712c 206c 6973 7429 3a0a  tance(q, list):.
-0001a380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a390: 2320 4e6f 7420 7375 7070 6f72 7465 642c  # Not supported,
-0001a3a0: 2074 6865 2072 6573 756c 7420 7769 6c6c   the result will
-0001a3b0: 2068 6176 6520 6375 7272 656e 7420 696e   have current in
-0001a3c0: 6465 7820 6173 2063 6f6c 756d 6e73 0a20  dex as columns. 
-0001a3d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001a3e0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0001a3f0: 2227 7127 206d 7573 7420 6265 2073 6361  "'q' must be sca
-0001a400: 6c61 7220 7768 656e 2061 7869 733d 3120  lar when axis=1 
-0001a410: 6973 2073 7065 6369 6669 6564 2229 0a0a  is specified")..
-0001a420: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001a430: 726e 206d 6170 5f70 6172 7469 7469 6f6e  rn map_partition
-0001a440: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-0001a450: 2020 204d 2e71 7561 6e74 696c 652c 0a20     M.quantile,. 
-0001a460: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001a470: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-0001a480: 2020 2020 2071 2c0a 2020 2020 2020 2020       q,.        
-0001a490: 2020 2020 2020 2020 6178 6973 2c0a 2020          axis,.  
-0001a4a0: 2020 2020 2020 2020 2020 2020 2020 746f                to
-0001a4b0: 6b65 6e3d 6b65 796e 616d 652c 0a20 2020  ken=keyname,.   
-0001a4c0: 2020 2020 2020 2020 2020 2020 2065 6e66               enf
-0001a4d0: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-0001a4e0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-0001a4f0: 2020 2020 202a 2a6e 756d 6572 6963 5f6b       **numeric_k
-0001a500: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
-0001a510: 2020 2020 2020 206d 6574 613d 2871 2c20         meta=(q, 
-0001a520: 2266 3822 292c 0a20 2020 2020 2020 2020  "f8"),.         
-0001a530: 2020 2020 2020 2070 6172 656e 745f 6d65         parent_me
-0001a540: 7461 3d73 656c 662e 5f6d 6574 612c 0a20  ta=self._meta,. 
-0001a550: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001a560: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001a570: 2020 2020 2020 205f 7261 6973 655f 6966         _raise_if
-0001a580: 5f6f 626a 6563 745f 7365 7269 6573 2873  _object_series(s
-0001a590: 656c 662c 2022 7175 616e 7469 6c65 2229  elf, "quantile")
-0001a5a0: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-0001a5b0: 203d 2073 656c 662e 5f67 6574 5f6e 756d   = self._get_num
-0001a5c0: 6572 6963 5f64 6174 6128 290a 2020 2020  eric_data().    
-0001a5d0: 2020 2020 2020 2020 7175 616e 7469 6c65          quantile
-0001a5e0: 7320 3d20 7475 706c 6528 7175 616e 7469  s = tuple(quanti
-0001a5f0: 6c65 2873 656c 665b 635d 2c20 712c 206d  le(self[c], q, m
-0001a600: 6574 686f 6429 2066 6f72 2063 2069 6e20  ethod) for c in 
-0001a610: 6e75 6d2e 636f 6c75 6d6e 7329 0a0a 2020  num.columns)..  
-0001a620: 2020 2020 2020 2020 2020 716e 616d 6573            qnames
-0001a630: 203d 205b 285f 712e 5f6e 616d 652c 2030   = [(_q._name, 0
-0001a640: 2920 666f 7220 5f71 2069 6e20 7175 616e  ) for _q in quan
-0001a650: 7469 6c65 735d 0a0a 2020 2020 2020 2020  tiles]..        
-0001a660: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0001a670: 6528 7175 616e 7469 6c65 735b 305d 2c20  e(quantiles[0], 
-0001a680: 5363 616c 6172 293a 0a20 2020 2020 2020  Scalar):.       
-0001a690: 2020 2020 2020 2020 206c 6179 6572 203d           layer =
-0001a6a0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-0001a6b0: 2020 2020 2020 2028 6b65 796e 616d 652c         (keyname,
-0001a6c0: 2030 293a 2028 7479 7065 286d 6574 6129   0): (type(meta)
-0001a6d0: 2c20 716e 616d 6573 2c20 6e75 6d2e 636f  , qnames, num.co
-0001a6e0: 6c75 6d6e 732c 204e 6f6e 652c 206d 6574  lumns, None, met
-0001a6f0: 612e 6e61 6d65 290a 2020 2020 2020 2020  a.name).        
-0001a700: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-0001a710: 2020 2020 2020 2020 2020 6772 6170 6820            graph 
-0001a720: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-0001a730: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-0001a740: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-0001a750: 2020 2020 2020 206b 6579 6e61 6d65 2c20         keyname, 
-0001a760: 6c61 7965 722c 2064 6570 656e 6465 6e63  layer, dependenc
-0001a770: 6965 733d 7175 616e 7469 6c65 730a 2020  ies=quantiles.  
-0001a780: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0001a790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a7a0: 6469 7669 7369 6f6e 7320 3d20 286d 696e  divisions = (min
-0001a7b0: 286e 756d 2e63 6f6c 756d 6e73 292c 206d  (num.columns), m
-0001a7c0: 6178 286e 756d 2e63 6f6c 756d 6e73 2929  ax(num.columns))
-0001a7d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a7e0: 2072 6574 7572 6e20 5365 7269 6573 2867   return Series(g
-0001a7f0: 7261 7068 2c20 6b65 796e 616d 652c 206d  raph, keyname, m
-0001a800: 6574 612c 2064 6976 6973 696f 6e73 290a  eta, divisions).
-0001a810: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001a820: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001a830: 2020 6c61 7965 7220 3d20 7b28 6b65 796e    layer = {(keyn
-0001a840: 616d 652c 2030 293a 2028 6d65 7468 6f64  ame, 0): (method
-0001a850: 732e 636f 6e63 6174 2c20 716e 616d 6573  s.concat, qnames
-0001a860: 2c20 3129 7d0a 2020 2020 2020 2020 2020  , 1)}.          
-0001a870: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
-0001a880: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-0001a890: 6d5f 636f 6c6c 6563 7469 6f6e 7328 0a20  m_collections(. 
-0001a8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a8b0: 2020 206b 6579 6e61 6d65 2c20 6c61 7965     keyname, laye
-0001a8c0: 722c 2064 6570 656e 6465 6e63 6965 733d  r, dependencies=
-0001a8d0: 7175 616e 7469 6c65 730a 2020 2020 2020  quantiles.      
-0001a8e0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0001a8f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001a900: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
-0001a910: 2867 7261 7068 2c20 6b65 796e 616d 652c  (graph, keyname,
-0001a920: 206d 6574 612c 2071 7561 6e74 696c 6573   meta, quantiles
-0001a930: 5b30 5d2e 6469 7669 7369 6f6e 7329 0a0a  [0].divisions)..
-0001a940: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0001a950: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-0001a960: 2020 2020 6465 6620 6465 7363 7269 6265      def describe
-0001a970: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001a980: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-0001a990: 6572 793d 4661 6c73 652c 0a20 2020 2020  ery=False,.     
-0001a9a0: 2020 2070 6572 6365 6e74 696c 6573 3d4e     percentiles=N
-0001a9b0: 6f6e 652c 0a20 2020 2020 2020 2070 6572  one,.        per
-0001a9c0: 6365 6e74 696c 6573 5f6d 6574 686f 643d  centiles_method=
-0001a9d0: 2264 6566 6175 6c74 222c 0a20 2020 2020  "default",.     
-0001a9e0: 2020 2069 6e63 6c75 6465 3d4e 6f6e 652c     include=None,
-0001a9f0: 0a20 2020 2020 2020 2065 7863 6c75 6465  .        exclude
-0001aa00: 3d4e 6f6e 652c 0a20 2020 2020 2020 2064  =None,.        d
-0001aa10: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
-0001aa20: 6963 3d6e 6f5f 6465 6661 756c 742c 0a20  ic=no_default,. 
-0001aa30: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
-0001aa40: 2050 414e 4441 535f 4754 5f32 3030 3a0a   PANDAS_GT_200:.
-0001aa50: 2020 2020 2020 2020 2020 2020 6966 2064              if d
-0001aa60: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
-0001aa70: 6963 2069 7320 6e6f 5f64 6566 6175 6c74  ic is no_default
-0001aa80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001aa90: 2020 6461 7465 7469 6d65 5f69 735f 6e75    datetime_is_nu
-0001aaa0: 6d65 7269 6320 3d20 5472 7565 0a20 2020  meric = True.   
-0001aab0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+00019680: 7320 3d20 6e75 6d2e 7661 6c75 6573 0a0a  s = num.values..
+00019690: 2020 2020 2020 2020 6966 206e 6f74 206e          if not n
+000196a0: 702e 6973 7375 6264 7479 7065 2876 616c  p.issubdtype(val
+000196b0: 7565 735f 6474 7970 652c 206e 702e 6e75  ues_dtype, np.nu
+000196c0: 6d62 6572 293a 0a20 2020 2020 2020 2020  mber):.         
+000196d0: 2020 2061 7272 6179 5f76 616c 7565 7320     array_values 
+000196e0: 3d20 6e75 6d2e 7661 6c75 6573 2e61 7374  = num.values.ast
+000196f0: 7970 6528 2266 3822 290a 0a20 2020 2020  ype("f8")..     
+00019700: 2020 2061 7272 6179 5f6b 7572 746f 7369     array_kurtosi
+00019710: 7320 3d20 6461 5f73 7461 7473 2e6b 7572  s = da_stats.kur
+00019720: 746f 7369 7328 0a20 2020 2020 2020 2020  tosis(.         
+00019730: 2020 2061 7272 6179 5f76 616c 7565 732c     array_values,
+00019740: 2061 7869 733d 302c 2066 6973 6865 723d   axis=0, fisher=
+00019750: 6669 7368 6572 2c20 6269 6173 3d62 6961  fisher, bias=bia
+00019760: 732c 206e 616e 5f70 6f6c 6963 793d 6e61  s, nan_policy=na
+00019770: 6e5f 706f 6c69 6379 0a20 2020 2020 2020  n_policy.       
+00019780: 2029 0a0a 2020 2020 2020 2020 6e61 6d65   )..        name
+00019790: 203d 2073 656c 662e 5f74 6f6b 656e 5f70   = self._token_p
+000197a0: 7265 6669 7820 2b20 226b 7572 746f 7369  refix + "kurtosi
+000197b0: 732d 6e75 6d65 7269 6322 202b 2074 6f6b  s-numeric" + tok
+000197c0: 656e 697a 6528 6e75 6d29 0a20 2020 2020  enize(num).     
+000197d0: 2020 2063 6f6c 7320 3d20 6e75 6d2e 5f6d     cols = num._m
+000197e0: 6574 612e 636f 6c75 6d6e 7320 6966 2069  eta.columns if i
+000197f0: 735f 6461 7461 6672 616d 655f 6c69 6b65  s_dataframe_like
+00019800: 286e 756d 2920 656c 7365 204e 6f6e 650a  (num) else None.
+00019810: 0a20 2020 2020 2020 206b 7572 746f 7369  .        kurtosi
+00019820: 735f 7368 6170 6520 3d20 6e75 6d2e 5f6d  s_shape = num._m
+00019830: 6574 615f 6e6f 6e65 6d70 7479 2e76 616c  eta_nonempty.val
+00019840: 7565 732e 7661 7228 6178 6973 3d30 292e  ues.var(axis=0).
+00019850: 7368 6170 650a 2020 2020 2020 2020 6172  shape.        ar
+00019860: 7261 795f 6b75 7274 6f73 6973 5f6e 616d  ray_kurtosis_nam
+00019870: 6520 3d20 2861 7272 6179 5f6b 7572 746f  e = (array_kurto
+00019880: 7369 732e 5f6e 616d 652c 2920 2b20 2830  sis._name,) + (0
+00019890: 2c29 202a 206c 656e 286b 7572 746f 7369  ,) * len(kurtosi
+000198a0: 735f 7368 6170 6529 0a0a 2020 2020 2020  s_shape)..      
+000198b0: 2020 6c61 7965 7220 3d20 7b0a 2020 2020    layer = {.    
+000198c0: 2020 2020 2020 2020 286e 616d 652c 2030          (name, 0
+000198d0: 293a 2028 6d65 7468 6f64 732e 7772 6170  ): (methods.wrap
+000198e0: 5f6b 7572 746f 7369 735f 7265 6475 6374  _kurtosis_reduct
+000198f0: 696f 6e2c 2061 7272 6179 5f6b 7572 746f  ion, array_kurto
+00019900: 7369 735f 6e61 6d65 2c20 636f 6c73 290a  sis_name, cols).
+00019910: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00019920: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+00019930: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+00019940: 6c6c 6563 7469 6f6e 7328 0a20 2020 2020  llections(.     
+00019950: 2020 2020 2020 206e 616d 652c 206c 6179         name, lay
+00019960: 6572 2c20 6465 7065 6e64 656e 6369 6573  er, dependencies
+00019970: 3d5b 6172 7261 795f 6b75 7274 6f73 6973  =[array_kurtosis
+00019980: 5d0a 2020 2020 2020 2020 290a 0a20 2020  ].        )..   
+00019990: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+000199a0: 6464 5f6f 626a 6563 7428 0a20 2020 2020  dd_object(.     
+000199b0: 2020 2020 2020 2067 7261 7068 2c20 6e61         graph, na
+000199c0: 6d65 2c20 6e75 6d2e 5f6d 6574 615f 6e6f  me, num._meta_no
+000199d0: 6e65 6d70 7479 2e6b 7572 746f 7369 7328  nempty.kurtosis(
+000199e0: 292c 2064 6976 6973 696f 6e73 3d5b 4e6f  ), divisions=[No
+000199f0: 6e65 2c20 4e6f 6e65 5d0a 2020 2020 2020  ne, None].      
+00019a00: 2020 290a 0a20 2020 2040 5f6e 756d 6572    )..    @_numer
+00019a10: 6963 5f6f 6e6c 790a 2020 2020 4064 6572  ic_only.    @der
+00019a20: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00019a30: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00019a40: 7365 6d28 7365 6c66 2c20 6178 6973 3d4e  sem(self, axis=N
+00019a50: 6f6e 652c 2073 6b69 706e 613d 5472 7565  one, skipna=True
+00019a60: 2c20 6464 6f66 3d31 2c20 7370 6c69 745f  , ddof=1, split_
+00019a70: 6576 6572 793d 4661 6c73 652c 206e 756d  every=False, num
+00019a80: 6572 6963 5f6f 6e6c 793d 4e6f 6e65 293a  eric_only=None):
+00019a90: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
+00019aa0: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
+00019ab0: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
+00019ac0: 2020 5f72 6169 7365 5f69 665f 6f62 6a65    _raise_if_obje
+00019ad0: 6374 5f73 6572 6965 7328 7365 6c66 2c20  ct_series(self, 
+00019ae0: 2273 656d 2229 0a20 2020 2020 2020 2077  "sem").        w
+00019af0: 6974 6820 6368 6563 6b5f 6e75 6d65 7269  ith check_numeri
+00019b00: 635f 6f6e 6c79 5f64 6570 7265 6361 7469  c_only_deprecati
+00019b10: 6f6e 2829 3a0a 2020 2020 2020 2020 2020  on():.          
+00019b20: 2020 6d65 7461 203d 2073 656c 662e 5f6d    meta = self._m
+00019b30: 6574 615f 6e6f 6e65 6d70 7479 2e73 656d  eta_nonempty.sem
+00019b40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00019b50: 2020 6178 6973 3d61 7869 732c 2073 6b69    axis=axis, ski
+00019b60: 706e 613d 736b 6970 6e61 2c20 6464 6f66  pna=skipna, ddof
+00019b70: 3d64 646f 662c 206e 756d 6572 6963 5f6f  =ddof, numeric_o
+00019b80: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
+00019b90: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00019ba0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+00019bb0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00019bc0: 2072 6574 7572 6e20 6d61 705f 7061 7274   return map_part
+00019bd0: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+00019be0: 2020 2020 2020 2020 4d2e 7365 6d2c 0a20          M.sem,. 
+00019bf0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00019c00: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+00019c10: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
+00019c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c30: 746f 6b65 6e3d 7365 6c66 2e5f 746f 6b65  token=self._toke
+00019c40: 6e5f 7072 6566 6978 202b 2022 7365 6d22  n_prefix + "sem"
+00019c50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019c60: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
+00019c70: 2020 2020 2020 2020 2020 2020 2073 6b69               ski
+00019c80: 706e 613d 736b 6970 6e61 2c0a 2020 2020  pna=skipna,.    
+00019c90: 2020 2020 2020 2020 2020 2020 6464 6f66              ddof
+00019ca0: 3d64 646f 662c 0a20 2020 2020 2020 2020  =ddof,.         
+00019cb0: 2020 2020 2020 2070 6172 656e 745f 6d65         parent_me
+00019cc0: 7461 3d73 656c 662e 5f6d 6574 612c 0a20  ta=self._meta,. 
+00019cd0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00019ce0: 756d 6572 6963 5f6f 6e6c 793d 6e75 6d65  umeric_only=nume
+00019cf0: 7269 635f 6f6e 6c79 2c0a 2020 2020 2020  ric_only,.      
+00019d00: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00019d10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00019d20: 2020 6e75 6d20 3d20 7365 6c66 2e5f 6765    num = self._ge
+00019d30: 745f 6e75 6d65 7269 635f 6461 7461 2829  t_numeric_data()
+00019d40: 0a20 2020 2020 2020 2020 2020 2076 203d  .            v =
+00019d50: 206e 756d 2e76 6172 2873 6b69 706e 613d   num.var(skipna=
+00019d60: 736b 6970 6e61 2c20 6464 6f66 3d64 646f  skipna, ddof=ddo
+00019d70: 662c 2073 706c 6974 5f65 7665 7279 3d73  f, split_every=s
+00019d80: 706c 6974 5f65 7665 7279 290a 2020 2020  plit_every).    
+00019d90: 2020 2020 2020 2020 6e20 3d20 6e75 6d2e          n = num.
+00019da0: 636f 756e 7428 7370 6c69 745f 6576 6572  count(split_ever
+00019db0: 793d 7370 6c69 745f 6576 6572 7929 0a20  y=split_every). 
+00019dc0: 2020 2020 2020 2020 2020 206e 616d 6520             name 
+00019dd0: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
+00019de0: 6566 6978 202b 2022 7365 6d22 0a20 2020  efix + "sem".   
+00019df0: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+00019e00: 3d20 6d61 705f 7061 7274 6974 696f 6e73  = map_partitions
+00019e10: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00019e20: 2020 6e70 2e73 7172 742c 0a20 2020 2020    np.sqrt,.     
+00019e30: 2020 2020 2020 2020 2020 2076 202f 206e             v / n
+00019e40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019e50: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
+00019e60: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
+00019e70: 656e 3d6e 616d 652c 0a20 2020 2020 2020  en=name,.       
+00019e80: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
+00019e90: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
+00019ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019eb0: 2070 6172 656e 745f 6d65 7461 3d73 656c   parent_meta=sel
+00019ec0: 662e 5f6d 6574 612c 0a20 2020 2020 2020  f._meta,.       
+00019ed0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00019ee0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00019ef0: 6528 7365 6c66 2c20 4461 7461 4672 616d  e(self, DataFram
+00019f00: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00019f10: 2020 2020 7265 7375 6c74 2e64 6976 6973      result.divis
+00019f20: 696f 6e73 203d 2028 7365 6c66 2e63 6f6c  ions = (self.col
+00019f30: 756d 6e73 2e6d 696e 2829 2c20 7365 6c66  umns.min(), self
+00019f40: 2e63 6f6c 756d 6e73 2e6d 6178 2829 290a  .columns.max()).
+00019f50: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00019f60: 726e 2072 6573 756c 740a 0a20 2020 2040  rn result..    @
+00019f70: 5f6e 756d 6572 6963 5f64 6174 610a 2020  _numeric_data.  
+00019f80: 2020 6465 6620 7175 616e 7469 6c65 2873    def quantile(s
+00019f90: 656c 662c 2071 3d30 2e35 2c20 6178 6973  elf, q=0.5, axis
+00019fa0: 3d30 2c20 6e75 6d65 7269 635f 6f6e 6c79  =0, numeric_only
+00019fb0: 3d6e 6f5f 6465 6661 756c 742c 206d 6574  =no_default, met
+00019fc0: 686f 643d 2264 6566 6175 6c74 2229 3a0a  hod="default"):.
+00019fd0: 2020 2020 2020 2020 2222 2241 7070 726f          """Appro
+00019fe0: 7869 6d61 7465 2072 6f77 2d77 6973 6520  ximate row-wise 
+00019ff0: 616e 6420 7072 6563 6973 6520 636f 6c75  and precise colu
+0001a000: 6d6e 2d77 6973 6520 7175 616e 7469 6c65  mn-wise quantile
+0001a010: 7320 6f66 2044 6174 6146 7261 6d65 0a0a  s of DataFrame..
+0001a020: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0001a030: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+0001a040: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7120  -----.        q 
+0001a050: 3a20 6c69 7374 2f61 7272 6179 206f 6620  : list/array of 
+0001a060: 666c 6f61 7473 2c20 6465 6661 756c 7420  floats, default 
+0001a070: 302e 3520 2835 3025 290a 2020 2020 2020  0.5 (50%).      
+0001a080: 2020 2020 2020 4974 6572 6162 6c65 206f        Iterable o
+0001a090: 6620 6e75 6d62 6572 7320 7261 6e67 696e  f numbers rangin
+0001a0a0: 6720 6672 6f6d 2030 2074 6f20 3120 666f  g from 0 to 1 fo
+0001a0b0: 7220 7468 6520 6465 7369 7265 6420 7175  r the desired qu
+0001a0c0: 616e 7469 6c65 730a 2020 2020 2020 2020  antiles.        
+0001a0d0: 6178 6973 203a 207b 302c 2031 2c20 2769  axis : {0, 1, 'i
+0001a0e0: 6e64 6578 272c 2027 636f 6c75 6d6e 7327  ndex', 'columns'
+0001a0f0: 7d20 2864 6566 6175 6c74 2030 290a 2020  } (default 0).  
+0001a100: 2020 2020 2020 2020 2020 3020 6f72 2027            0 or '
+0001a110: 696e 6465 7827 2066 6f72 2072 6f77 2d77  index' for row-w
+0001a120: 6973 652c 2031 206f 7220 2763 6f6c 756d  ise, 1 or 'colum
+0001a130: 6e73 2720 666f 7220 636f 6c75 6d6e 2d77  ns' for column-w
+0001a140: 6973 650a 2020 2020 2020 2020 6d65 7468  ise.        meth
+0001a150: 6f64 203a 207b 2764 6566 6175 6c74 272c  od : {'default',
+0001a160: 2027 7464 6967 6573 7427 2c20 2764 6173   'tdigest', 'das
+0001a170: 6b27 7d2c 206f 7074 696f 6e61 6c0a 2020  k'}, optional.  
+0001a180: 2020 2020 2020 2020 2020 5768 6174 206d            What m
+0001a190: 6574 686f 6420 746f 2075 7365 2e20 4279  ethod to use. By
+0001a1a0: 2064 6566 6175 6c74 2077 696c 6c20 7573   default will us
+0001a1b0: 6520 6461 736b 2773 2069 6e74 6572 6e61  e dask's interna
+0001a1c0: 6c20 6375 7374 6f6d 0a20 2020 2020 2020  l custom.       
+0001a1d0: 2020 2020 2061 6c67 6f72 6974 686d 2028       algorithm (
+0001a1e0: 6060 2764 6173 6b27 6060 292e 2020 4966  ``'dask'``).  If
+0001a1f0: 2073 6574 2074 6f20 6060 2774 6469 6765   set to ``'tdige
+0001a200: 7374 2760 6020 7769 6c6c 2075 7365 2074  st'`` will use t
+0001a210: 6469 6765 7374 0a20 2020 2020 2020 2020  digest.         
+0001a220: 2020 2066 6f72 2066 6c6f 6174 7320 616e     for floats an
+0001a230: 6420 696e 7473 2061 6e64 2066 616c 6c62  d ints and fallb
+0001a240: 6163 6b20 746f 2074 6865 2060 6027 6461  ack to the ``'da
+0001a250: 736b 2760 6020 6f74 6865 7277 6973 652e  sk'`` otherwise.
+0001a260: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001a270: 2020 2020 206e 756d 6572 6963 5f6b 7761       numeric_kwa
+0001a280: 7267 7320 3d20 5f6e 756d 6572 6963 5f6f  rgs = _numeric_o
+0001a290: 6e6c 795f 6d61 7962 655f 7761 726e 2873  nly_maybe_warn(s
+0001a2a0: 656c 662c 206e 756d 6572 6963 5f6f 6e6c  elf, numeric_onl
+0001a2b0: 792c 2064 6566 6175 6c74 3d54 7275 6529  y, default=True)
+0001a2c0: 0a0a 2020 2020 2020 2020 6178 6973 203d  ..        axis =
+0001a2d0: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
+0001a2e0: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
+0001a2f0: 2020 206b 6579 6e61 6d65 203d 2022 7175     keyname = "qu
+0001a300: 616e 7469 6c65 732d 636f 6e63 6174 2d2d  antiles-concat--
+0001a310: 2220 2b20 746f 6b65 6e69 7a65 2873 656c  " + tokenize(sel
+0001a320: 662c 2071 2c20 6178 6973 290a 0a20 2020  f, q, axis)..   
+0001a330: 2020 2020 2077 6974 6820 6368 6563 6b5f       with check_
+0001a340: 6e75 6d65 7269 635f 6f6e 6c79 5f64 6570  numeric_only_dep
+0001a350: 7265 6361 7469 6f6e 2829 3a0a 2020 2020  recation():.    
+0001a360: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
+0001a370: 656c 662e 5f6d 6574 612e 7175 616e 7469  elf._meta.quanti
+0001a380: 6c65 2871 2c20 6178 6973 3d61 7869 732c  le(q, axis=axis,
+0001a390: 202a 2a6e 756d 6572 6963 5f6b 7761 7267   **numeric_kwarg
+0001a3a0: 7329 0a0a 2020 2020 2020 2020 6966 2061  s)..        if a
+0001a3b0: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
+0001a3c0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0001a3d0: 6e63 6528 712c 206c 6973 7429 3a0a 2020  nce(q, list):.  
+0001a3e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0001a3f0: 4e6f 7420 7375 7070 6f72 7465 642c 2074  Not supported, t
+0001a400: 6865 2072 6573 756c 7420 7769 6c6c 2068  he result will h
+0001a410: 6176 6520 6375 7272 656e 7420 696e 6465  ave current inde
+0001a420: 7820 6173 2063 6f6c 756d 6e73 0a20 2020  x as columns.   
+0001a430: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0001a440: 7365 2056 616c 7565 4572 726f 7228 2227  se ValueError("'
+0001a450: 7127 206d 7573 7420 6265 2073 6361 6c61  q' must be scala
+0001a460: 7220 7768 656e 2061 7869 733d 3120 6973  r when axis=1 is
+0001a470: 2073 7065 6369 6669 6564 2229 0a0a 2020   specified")..  
+0001a480: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001a490: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
+0001a4a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a4b0: 204d 2e71 7561 6e74 696c 652c 0a20 2020   M.quantile,.   
+0001a4c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001a4d0: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
+0001a4e0: 2020 2071 2c0a 2020 2020 2020 2020 2020     q,.          
+0001a4f0: 2020 2020 2020 6178 6973 2c0a 2020 2020        axis,.    
+0001a500: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
+0001a510: 6e3d 6b65 796e 616d 652c 0a20 2020 2020  n=keyname,.     
+0001a520: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
+0001a530: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+0001a540: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0001a550: 2020 202a 2a6e 756d 6572 6963 5f6b 7761     **numeric_kwa
+0001a560: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+0001a570: 2020 2020 206d 6574 613d 2871 2c20 2266       meta=(q, "f
+0001a580: 3822 292c 0a20 2020 2020 2020 2020 2020  8"),.           
+0001a590: 2020 2020 2070 6172 656e 745f 6d65 7461       parent_meta
+0001a5a0: 3d73 656c 662e 5f6d 6574 612c 0a20 2020  =self._meta,.   
+0001a5b0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001a5c0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001a5d0: 2020 2020 205f 7261 6973 655f 6966 5f6f       _raise_if_o
+0001a5e0: 626a 6563 745f 7365 7269 6573 2873 656c  bject_series(sel
+0001a5f0: 662c 2022 7175 616e 7469 6c65 2229 0a20  f, "quantile"). 
+0001a600: 2020 2020 2020 2020 2020 206e 756d 203d             num =
+0001a610: 2073 656c 662e 5f67 6574 5f6e 756d 6572   self._get_numer
+0001a620: 6963 5f64 6174 6128 290a 2020 2020 2020  ic_data().      
+0001a630: 2020 2020 2020 7175 616e 7469 6c65 7320        quantiles 
+0001a640: 3d20 7475 706c 6528 7175 616e 7469 6c65  = tuple(quantile
+0001a650: 2873 656c 665b 635d 2c20 712c 206d 6574  (self[c], q, met
+0001a660: 686f 6429 2066 6f72 2063 2069 6e20 6e75  hod) for c in nu
+0001a670: 6d2e 636f 6c75 6d6e 7329 0a0a 2020 2020  m.columns)..    
+0001a680: 2020 2020 2020 2020 716e 616d 6573 203d          qnames =
+0001a690: 205b 285f 712e 5f6e 616d 652c 2030 2920   [(_q._name, 0) 
+0001a6a0: 666f 7220 5f71 2069 6e20 7175 616e 7469  for _q in quanti
+0001a6b0: 6c65 735d 0a0a 2020 2020 2020 2020 2020  les]..          
+0001a6c0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0001a6d0: 7175 616e 7469 6c65 735b 305d 2c20 5363  quantiles[0], Sc
+0001a6e0: 616c 6172 293a 0a20 2020 2020 2020 2020  alar):.         
+0001a6f0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
+0001a700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a710: 2020 2020 2028 6b65 796e 616d 652c 2030       (keyname, 0
+0001a720: 293a 2028 7479 7065 286d 6574 6129 2c20  ): (type(meta), 
+0001a730: 716e 616d 6573 2c20 6e75 6d2e 636f 6c75  qnames, num.colu
+0001a740: 6d6e 732c 204e 6f6e 652c 206d 6574 612e  mns, None, meta.
+0001a750: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
+0001a760: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+0001a770: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
+0001a780: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
+0001a790: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
+0001a7a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a7b0: 2020 2020 206b 6579 6e61 6d65 2c20 6c61       keyname, la
+0001a7c0: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
+0001a7d0: 733d 7175 616e 7469 6c65 730a 2020 2020  s=quantiles.    
+0001a7e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001a7f0: 2020 2020 2020 2020 2020 2020 2020 6469                di
+0001a800: 7669 7369 6f6e 7320 3d20 286d 696e 286e  visions = (min(n
+0001a810: 756d 2e63 6f6c 756d 6e73 292c 206d 6178  um.columns), max
+0001a820: 286e 756d 2e63 6f6c 756d 6e73 2929 0a20  (num.columns)). 
+0001a830: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001a840: 6574 7572 6e20 5365 7269 6573 2867 7261  eturn Series(gra
+0001a850: 7068 2c20 6b65 796e 616d 652c 206d 6574  ph, keyname, met
+0001a860: 612c 2064 6976 6973 696f 6e73 290a 2020  a, divisions).  
+0001a870: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0001a880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a890: 6c61 7965 7220 3d20 7b28 6b65 796e 616d  layer = {(keynam
+0001a8a0: 652c 2030 293a 2028 6d65 7468 6f64 732e  e, 0): (methods.
+0001a8b0: 636f 6e63 6174 2c20 716e 616d 6573 2c20  concat, qnames, 
+0001a8c0: 3129 7d0a 2020 2020 2020 2020 2020 2020  1)}.            
+0001a8d0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
+0001a8e0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+0001a8f0: 636f 6c6c 6563 7469 6f6e 7328 0a20 2020  collections(.   
+0001a900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a910: 206b 6579 6e61 6d65 2c20 6c61 7965 722c   keyname, layer,
+0001a920: 2064 6570 656e 6465 6e63 6965 733d 7175   dependencies=qu
+0001a930: 616e 7469 6c65 730a 2020 2020 2020 2020  antiles.        
+0001a940: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001a950: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001a960: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
+0001a970: 7261 7068 2c20 6b65 796e 616d 652c 206d  raph, keyname, m
+0001a980: 6574 612c 2071 7561 6e74 696c 6573 5b30  eta, quantiles[0
+0001a990: 5d2e 6469 7669 7369 6f6e 7329 0a0a 2020  ].divisions)..  
+0001a9a0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+0001a9b0: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+0001a9c0: 2020 6465 6620 6465 7363 7269 6265 280a    def describe(.
+0001a9d0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0001a9e0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
+0001a9f0: 793d 4661 6c73 652c 0a20 2020 2020 2020  y=False,.       
+0001aa00: 2070 6572 6365 6e74 696c 6573 3d4e 6f6e   percentiles=Non
+0001aa10: 652c 0a20 2020 2020 2020 2070 6572 6365  e,.        perce
+0001aa20: 6e74 696c 6573 5f6d 6574 686f 643d 2264  ntiles_method="d
+0001aa30: 6566 6175 6c74 222c 0a20 2020 2020 2020  efault",.       
+0001aa40: 2069 6e63 6c75 6465 3d4e 6f6e 652c 0a20   include=None,. 
+0001aa50: 2020 2020 2020 2065 7863 6c75 6465 3d4e         exclude=N
+0001aa60: 6f6e 652c 0a20 2020 2020 2020 2064 6174  one,.        dat
+0001aa70: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
+0001aa80: 3d6e 6f5f 6465 6661 756c 742c 0a20 2020  =no_default,.   
+0001aa90: 2029 3a0a 2020 2020 2020 2020 6966 2050   ):.        if P
+0001aaa0: 414e 4441 535f 4754 5f32 3030 3a0a 2020  ANDAS_GT_200:.  
+0001aab0: 2020 2020 2020 2020 2020 6966 2064 6174            if dat
 0001aac0: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
-0001aad0: 5f6b 7761 7267 203d 207b 7d0a 2020 2020  _kwarg = {}.    
-0001aae0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001aaf0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0001ab00: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
-0001ab10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ab20: 2020 2022 6461 7465 7469 6d65 5f69 735f     "datetime_is_
-0001ab30: 6e75 6d65 7269 6320 6973 2072 656d 6f76  numeric is remov
-0001ab40: 6564 2069 6e20 7061 6e64 6173 3e3d 322e  ed in pandas>=2.
-0001ab50: 302e 302c 2064 6174 6574 696d 6520 6461  0.0, datetime da
-0001ab60: 7461 2077 696c 6c20 616c 7761 7973 2062  ta will always b
-0001ab70: 6520 220a 2020 2020 2020 2020 2020 2020  e ".            
-0001ab80: 2020 2020 2020 2020 2273 756d 6d61 7269          "summari
-0001ab90: 7a65 6420 6173 206e 756d 6572 6963 220a  zed as numeric".
-0001aba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001abb0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0001abc0: 2020 2020 2020 2020 2020 2020 6461 7465              date
-0001abd0: 7469 6d65 5f69 735f 6e75 6d65 7269 6320  time_is_numeric 
-0001abe0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-0001abf0: 2020 2020 4661 6c73 6520 6966 2064 6174      False if dat
-0001ac00: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
-0001ac10: 2069 7320 6e6f 5f64 6566 6175 6c74 2065   is no_default e
-0001ac20: 6c73 6520 6461 7465 7469 6d65 5f69 735f  lse datetime_is_
-0001ac30: 6e75 6d65 7269 630a 2020 2020 2020 2020  numeric.        
-0001ac40: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0001ac50: 2020 6461 7465 7469 6d65 5f69 735f 6e75    datetime_is_nu
-0001ac60: 6d65 7269 635f 6b77 6172 6720 3d20 7b22  meric_kwarg = {"
-0001ac70: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
-0001ac80: 7269 6322 3a20 6461 7465 7469 6d65 5f69  ric": datetime_i
-0001ac90: 735f 6e75 6d65 7269 637d 0a0a 2020 2020  s_numeric}..    
-0001aca0: 2020 2020 6966 2073 656c 662e 5f6d 6574      if self._met
-0001acb0: 612e 6e64 696d 203d 3d20 313a 0a20 2020  a.ndim == 1:.   
-0001acc0: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-0001acd0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-0001ace0: 7074 792e 6465 7363 7269 6265 280a 2020  pty.describe(.  
-0001acf0: 2020 2020 2020 2020 2020 2020 2020 7065                pe
-0001ad00: 7263 656e 7469 6c65 733d 7065 7263 656e  rcentiles=percen
-0001ad10: 7469 6c65 732c 0a20 2020 2020 2020 2020  tiles,.         
-0001ad20: 2020 2020 2020 2069 6e63 6c75 6465 3d69         include=i
-0001ad30: 6e63 6c75 6465 2c0a 2020 2020 2020 2020  nclude,.        
-0001ad40: 2020 2020 2020 2020 6578 636c 7564 653d          exclude=
-0001ad50: 6578 636c 7564 652c 0a20 2020 2020 2020  exclude,.       
-0001ad60: 2020 2020 2020 2020 202a 2a64 6174 6574           **datet
-0001ad70: 696d 655f 6973 5f6e 756d 6572 6963 5f6b  ime_is_numeric_k
-0001ad80: 7761 7267 2c0a 2020 2020 2020 2020 2020  warg,.          
-0001ad90: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0001ada0: 6f75 7470 7574 203d 2073 656c 662e 5f64  output = self._d
-0001adb0: 6573 6372 6962 655f 3164 280a 2020 2020  escribe_1d(.    
-0001adc0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001add0: 2c20 7370 6c69 745f 6576 6572 792c 2070  , split_every, p
-0001ade0: 6572 6365 6e74 696c 6573 2c20 7065 7263  ercentiles, perc
-0001adf0: 656e 7469 6c65 735f 6d65 7468 6f64 2c20  entiles_method, 
-0001ae00: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
-0001ae10: 7269 630a 2020 2020 2020 2020 2020 2020  ric.            
-0001ae20: 290a 2020 2020 2020 2020 2020 2020 6f75  ).            ou
-0001ae30: 7470 7574 2e5f 6d65 7461 203d 206d 6574  tput._meta = met
-0001ae40: 610a 2020 2020 2020 2020 2020 2020 7265  a.            re
-0001ae50: 7475 726e 206f 7574 7075 740a 2020 2020  turn output.    
-0001ae60: 2020 2020 656c 6966 2028 696e 636c 7564      elif (includ
-0001ae70: 6520 6973 204e 6f6e 6529 2061 6e64 2028  e is None) and (
-0001ae80: 6578 636c 7564 6520 6973 204e 6f6e 6529  exclude is None)
-0001ae90: 3a0a 2020 2020 2020 2020 2020 2020 5f69  :.            _i
-0001aea0: 6e63 6c75 6465 203d 205b 6e70 2e6e 756d  nclude = [np.num
-0001aeb0: 6265 722c 206e 702e 7469 6d65 6465 6c74  ber, np.timedelt
-0001aec0: 6136 345d 0a20 2020 2020 2020 2020 2020  a64].           
-0001aed0: 2069 6620 6461 7465 7469 6d65 5f69 735f   if datetime_is_
-0001aee0: 6e75 6d65 7269 633a 0a20 2020 2020 2020  numeric:.       
-0001aef0: 2020 2020 2020 2020 205f 696e 636c 7564           _includ
-0001af00: 652e 6170 7065 6e64 286e 702e 6461 7465  e.append(np.date
-0001af10: 7469 6d65 3634 290a 2020 2020 2020 2020  time64).        
-0001af20: 2020 2020 6461 7461 203d 2073 656c 662e      data = self.
-0001af30: 5f6d 6574 612e 7365 6c65 6374 5f64 7479  _meta.select_dty
-0001af40: 7065 7328 696e 636c 7564 653d 5f69 6e63  pes(include=_inc
-0001af50: 6c75 6465 290a 0a20 2020 2020 2020 2020  lude)..         
-0001af60: 2020 2023 2077 6865 6e20 736f 6d65 206e     # when some n
-0001af70: 756d 6572 6963 732f 7469 6d65 6465 6c74  umerics/timedelt
-0001af80: 6173 2061 7265 2066 6f75 6e64 2c20 6279  as are found, by
-0001af90: 2064 6566 6175 6c74 206b 6565 7020 7468   default keep th
-0001afa0: 656d 0a20 2020 2020 2020 2020 2020 2069  em.            i
-0001afb0: 6620 6c65 6e28 6461 7461 2e63 6f6c 756d  f len(data.colum
-0001afc0: 6e73 2920 3d3d 2030 3a0a 2020 2020 2020  ns) == 0:.      
-0001afd0: 2020 2020 2020 2020 2020 6368 6f73 656e            chosen
-0001afe0: 5f63 6f6c 756d 6e73 203d 2073 656c 662e  _columns = self.
-0001aff0: 5f6d 6574 612e 636f 6c75 6d6e 730a 2020  _meta.columns.  
-0001b000: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001b010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b020: 2320 6368 6563 6b20 6966 2074 6865 7265  # check if there
-0001b030: 2061 7265 2074 696d 6564 656c 7461 2c20   are timedelta, 
-0001b040: 626f 6f6c 6561 6e2c 206f 7220 6461 7465  boolean, or date
-0001b050: 7469 6d65 2063 6f6c 756d 6e73 0a20 2020  time columns.   
-0001b060: 2020 2020 2020 2020 2020 2020 205f 696e               _in
-0001b070: 636c 7564 6520 3d20 5b6e 702e 7469 6d65  clude = [np.time
-0001b080: 6465 6c74 6136 342c 2062 6f6f 6c5d 0a20  delta64, bool]. 
-0001b090: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001b0a0: 6620 6461 7465 7469 6d65 5f69 735f 6e75  f datetime_is_nu
-0001b0b0: 6d65 7269 633a 0a20 2020 2020 2020 2020  meric:.         
+0001aad0: 2069 7320 6e6f 5f64 6566 6175 6c74 3a0a   is no_default:.
+0001aae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aaf0: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
+0001ab00: 7269 6320 3d20 5472 7565 0a20 2020 2020  ric = True.     
+0001ab10: 2020 2020 2020 2020 2020 2064 6174 6574             datet
+0001ab20: 696d 655f 6973 5f6e 756d 6572 6963 5f6b  ime_is_numeric_k
+0001ab30: 7761 7267 203d 207b 7d0a 2020 2020 2020  warg = {}.      
+0001ab40: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001ab50: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001ab60: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
+0001ab70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ab80: 2022 6461 7465 7469 6d65 5f69 735f 6e75   "datetime_is_nu
+0001ab90: 6d65 7269 6320 6973 2072 656d 6f76 6564  meric is removed
+0001aba0: 2069 6e20 7061 6e64 6173 3e3d 322e 302e   in pandas>=2.0.
+0001abb0: 302c 2064 6174 6574 696d 6520 6461 7461  0, datetime data
+0001abc0: 2077 696c 6c20 616c 7761 7973 2062 6520   will always be 
+0001abd0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0001abe0: 2020 2020 2020 2273 756d 6d61 7269 7a65        "summarize
+0001abf0: 6420 6173 206e 756d 6572 6963 220a 2020  d as numeric".  
+0001ac00: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0001ac10: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001ac20: 2020 2020 2020 2020 2020 6461 7465 7469            dateti
+0001ac30: 6d65 5f69 735f 6e75 6d65 7269 6320 3d20  me_is_numeric = 
+0001ac40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001ac50: 2020 4661 6c73 6520 6966 2064 6174 6574    False if datet
+0001ac60: 696d 655f 6973 5f6e 756d 6572 6963 2069  ime_is_numeric i
+0001ac70: 7320 6e6f 5f64 6566 6175 6c74 2065 6c73  s no_default els
+0001ac80: 6520 6461 7465 7469 6d65 5f69 735f 6e75  e datetime_is_nu
+0001ac90: 6d65 7269 630a 2020 2020 2020 2020 2020  meric.          
+0001aca0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0001acb0: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
+0001acc0: 7269 635f 6b77 6172 6720 3d20 7b22 6461  ric_kwarg = {"da
+0001acd0: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
+0001ace0: 6322 3a20 6461 7465 7469 6d65 5f69 735f  c": datetime_is_
+0001acf0: 6e75 6d65 7269 637d 0a0a 2020 2020 2020  numeric}..      
+0001ad00: 2020 6966 2073 656c 662e 5f6d 6574 612e    if self._meta.
+0001ad10: 6e64 696d 203d 3d20 313a 0a20 2020 2020  ndim == 1:.     
+0001ad20: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
+0001ad30: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
+0001ad40: 792e 6465 7363 7269 6265 280a 2020 2020  y.describe(.    
+0001ad50: 2020 2020 2020 2020 2020 2020 7065 7263              perc
+0001ad60: 656e 7469 6c65 733d 7065 7263 656e 7469  entiles=percenti
+0001ad70: 6c65 732c 0a20 2020 2020 2020 2020 2020  les,.           
+0001ad80: 2020 2020 2069 6e63 6c75 6465 3d69 6e63       include=inc
+0001ad90: 6c75 6465 2c0a 2020 2020 2020 2020 2020  lude,.          
+0001ada0: 2020 2020 2020 6578 636c 7564 653d 6578        exclude=ex
+0001adb0: 636c 7564 652c 0a20 2020 2020 2020 2020  clude,.         
+0001adc0: 2020 2020 2020 202a 2a64 6174 6574 696d         **datetim
+0001add0: 655f 6973 5f6e 756d 6572 6963 5f6b 7761  e_is_numeric_kwa
+0001ade0: 7267 2c0a 2020 2020 2020 2020 2020 2020  rg,.            
+0001adf0: 290a 2020 2020 2020 2020 2020 2020 6f75  ).            ou
+0001ae00: 7470 7574 203d 2073 656c 662e 5f64 6573  tput = self._des
+0001ae10: 6372 6962 655f 3164 280a 2020 2020 2020  cribe_1d(.      
+0001ae20: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
+0001ae30: 7370 6c69 745f 6576 6572 792c 2070 6572  split_every, per
+0001ae40: 6365 6e74 696c 6573 2c20 7065 7263 656e  centiles, percen
+0001ae50: 7469 6c65 735f 6d65 7468 6f64 2c20 6461  tiles_method, da
+0001ae60: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
+0001ae70: 630a 2020 2020 2020 2020 2020 2020 290a  c.            ).
+0001ae80: 2020 2020 2020 2020 2020 2020 6f75 7470              outp
+0001ae90: 7574 2e5f 6d65 7461 203d 206d 6574 610a  ut._meta = meta.
+0001aea0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001aeb0: 726e 206f 7574 7075 740a 2020 2020 2020  rn output.      
+0001aec0: 2020 656c 6966 2028 696e 636c 7564 6520    elif (include 
+0001aed0: 6973 204e 6f6e 6529 2061 6e64 2028 6578  is None) and (ex
+0001aee0: 636c 7564 6520 6973 204e 6f6e 6529 3a0a  clude is None):.
+0001aef0: 2020 2020 2020 2020 2020 2020 5f69 6e63              _inc
+0001af00: 6c75 6465 203d 205b 6e70 2e6e 756d 6265  lude = [np.numbe
+0001af10: 722c 206e 702e 7469 6d65 6465 6c74 6136  r, np.timedelta6
+0001af20: 345d 0a20 2020 2020 2020 2020 2020 2069  4].            i
+0001af30: 6620 6461 7465 7469 6d65 5f69 735f 6e75  f datetime_is_nu
+0001af40: 6d65 7269 633a 0a20 2020 2020 2020 2020  meric:.         
+0001af50: 2020 2020 2020 205f 696e 636c 7564 652e         _include.
+0001af60: 6170 7065 6e64 286e 702e 6461 7465 7469  append(np.dateti
+0001af70: 6d65 3634 290a 2020 2020 2020 2020 2020  me64).          
+0001af80: 2020 6461 7461 203d 2073 656c 662e 5f6d    data = self._m
+0001af90: 6574 612e 7365 6c65 6374 5f64 7479 7065  eta.select_dtype
+0001afa0: 7328 696e 636c 7564 653d 5f69 6e63 6c75  s(include=_inclu
+0001afb0: 6465 290a 0a20 2020 2020 2020 2020 2020  de)..           
+0001afc0: 2023 2077 6865 6e20 736f 6d65 206e 756d   # when some num
+0001afd0: 6572 6963 732f 7469 6d65 6465 6c74 6173  erics/timedeltas
+0001afe0: 2061 7265 2066 6f75 6e64 2c20 6279 2064   are found, by d
+0001aff0: 6566 6175 6c74 206b 6565 7020 7468 656d  efault keep them
+0001b000: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001b010: 6c65 6e28 6461 7461 2e63 6f6c 756d 6e73  len(data.columns
+0001b020: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
+0001b030: 2020 2020 2020 2020 6368 6f73 656e 5f63          chosen_c
+0001b040: 6f6c 756d 6e73 203d 2073 656c 662e 5f6d  olumns = self._m
+0001b050: 6574 612e 636f 6c75 6d6e 730a 2020 2020  eta.columns.    
+0001b060: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001b070: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0001b080: 6368 6563 6b20 6966 2074 6865 7265 2061  check if there a
+0001b090: 7265 2074 696d 6564 656c 7461 2c20 626f  re timedelta, bo
+0001b0a0: 6f6c 6561 6e2c 206f 7220 6461 7465 7469  olean, or dateti
+0001b0b0: 6d65 2063 6f6c 756d 6e73 0a20 2020 2020  me columns.     
 0001b0c0: 2020 2020 2020 2020 2020 205f 696e 636c             _incl
-0001b0d0: 7564 652e 6170 7065 6e64 286e 702e 6461  ude.append(np.da
-0001b0e0: 7465 7469 6d65 3634 290a 2020 2020 2020  tetime64).      
-0001b0f0: 2020 2020 2020 2020 2020 626f 6f6c 735f            bools_
-0001b100: 616e 645f 7469 6d65 7320 3d20 7365 6c66  and_times = self
-0001b110: 2e5f 6d65 7461 2e73 656c 6563 745f 6474  ._meta.select_dt
-0001b120: 7970 6573 2869 6e63 6c75 6465 3d5f 696e  ypes(include=_in
-0001b130: 636c 7564 6529 0a20 2020 2020 2020 2020  clude).         
-0001b140: 2020 2020 2020 2069 6620 6c65 6e28 626f         if len(bo
-0001b150: 6f6c 735f 616e 645f 7469 6d65 732e 636f  ols_and_times.co
-0001b160: 6c75 6d6e 7329 203d 3d20 303a 0a20 2020  lumns) == 0:.   
-0001b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b180: 2072 6574 7572 6e20 7365 6c66 2e5f 6465   return self._de
-0001b190: 7363 7269 6265 5f6e 756d 6572 6963 280a  scribe_numeric(.
-0001b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b1b0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0001b1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b1d0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-0001b1e0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-0001b1f0: 2020 2020 2020 2020 2020 2070 6572 6365             perce
-0001b200: 6e74 696c 6573 2c0a 2020 2020 2020 2020  ntiles,.        
-0001b210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b220: 7065 7263 656e 7469 6c65 735f 6d65 7468  percentiles_meth
-0001b230: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
-0001b240: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001b250: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001b260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b270: 2020 2020 6368 6f73 656e 5f63 6f6c 756d      chosen_colum
-0001b280: 6e73 203d 2064 6174 612e 636f 6c75 6d6e  ns = data.column
-0001b290: 730a 2020 2020 2020 2020 656c 6966 2069  s.        elif i
-0001b2a0: 6e63 6c75 6465 203d 3d20 2261 6c6c 223a  nclude == "all":
-0001b2b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001b2c0: 6578 636c 7564 6520 6973 206e 6f74 204e  exclude is not N
-0001b2d0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0001b2e0: 2020 2020 206d 7367 203d 2022 6578 636c       msg = "excl
-0001b2f0: 7564 6520 6d75 7374 2062 6520 4e6f 6e65  ude must be None
-0001b300: 2077 6865 6e20 696e 636c 7564 6520 6973   when include is
-0001b310: 2027 616c 6c27 220a 2020 2020 2020 2020   'all'".        
-0001b320: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0001b330: 6c75 6545 7272 6f72 286d 7367 290a 2020  lueError(msg).  
-0001b340: 2020 2020 2020 2020 2020 6368 6f73 656e            chosen
-0001b350: 5f63 6f6c 756d 6e73 203d 2073 656c 662e  _columns = self.
-0001b360: 5f6d 6574 612e 636f 6c75 6d6e 730a 2020  _meta.columns.  
-0001b370: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001b380: 2020 2020 2020 2020 6368 6f73 656e 5f63          chosen_c
-0001b390: 6f6c 756d 6e73 203d 2073 656c 662e 5f6d  olumns = self._m
-0001b3a0: 6574 612e 7365 6c65 6374 5f64 7479 7065  eta.select_dtype
-0001b3b0: 7328 696e 636c 7564 653d 696e 636c 7564  s(include=includ
-0001b3c0: 652c 2065 7863 6c75 6465 3d65 7863 6c75  e, exclude=exclu
-0001b3d0: 6465 290a 0a20 2020 2020 2020 2073 7461  de)..        sta
-0001b3e0: 7473 203d 205b 0a20 2020 2020 2020 2020  ts = [.         
-0001b3f0: 2020 2073 656c 662e 5f64 6573 6372 6962     self._describ
-0001b400: 655f 3164 280a 2020 2020 2020 2020 2020  e_1d(.          
-0001b410: 2020 2020 2020 7365 6c66 5b63 6f6c 5f69        self[col_i
-0001b420: 6478 5d2c 0a20 2020 2020 2020 2020 2020  dx],.           
-0001b430: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-0001b440: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001b450: 2020 7065 7263 656e 7469 6c65 732c 0a20    percentiles,. 
-0001b460: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001b470: 6572 6365 6e74 696c 6573 5f6d 6574 686f  ercentiles_metho
-0001b480: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
-0001b490: 2020 2064 6174 6574 696d 655f 6973 5f6e     datetime_is_n
-0001b4a0: 756d 6572 6963 2c0a 2020 2020 2020 2020  umeric,.        
-0001b4b0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0001b4c0: 2020 666f 7220 636f 6c5f 6964 7820 696e    for col_idx in
-0001b4d0: 2063 686f 7365 6e5f 636f 6c75 6d6e 730a   chosen_columns.
-0001b4e0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-0001b4f0: 2020 7374 6174 735f 6e61 6d65 7320 3d20    stats_names = 
-0001b500: 5b28 732e 5f6e 616d 652c 2030 2920 666f  [(s._name, 0) fo
-0001b510: 7220 7320 696e 2073 7461 7473 5d0a 0a20  r s in stats].. 
-0001b520: 2020 2020 2020 206e 616d 6520 3d20 2264         name = "d
-0001b530: 6573 6372 6962 652d 2d22 202b 2074 6f6b  escribe--" + tok
-0001b540: 656e 697a 6528 7365 6c66 2c20 7370 6c69  enize(self, spli
-0001b550: 745f 6576 6572 7929 0a20 2020 2020 2020  t_every).       
-0001b560: 206c 6179 6572 203d 207b 286e 616d 652c   layer = {(name,
-0001b570: 2030 293a 2028 6d65 7468 6f64 732e 6465   0): (methods.de
-0001b580: 7363 7269 6265 5f61 6767 7265 6761 7465  scribe_aggregate
-0001b590: 2c20 7374 6174 735f 6e61 6d65 7329 7d0a  , stats_names)}.
-0001b5a0: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
-0001b5b0: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-0001b5c0: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-0001b5d0: 6e61 6d65 2c20 6c61 7965 722c 2064 6570  name, layer, dep
-0001b5e0: 656e 6465 6e63 6965 733d 7374 6174 7329  endencies=stats)
-0001b5f0: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
-0001b600: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-0001b610: 7074 792e 6465 7363 7269 6265 280a 2020  pty.describe(.  
-0001b620: 2020 2020 2020 2020 2020 696e 636c 7564            includ
-0001b630: 653d 696e 636c 7564 652c 2065 7863 6c75  e=include, exclu
-0001b640: 6465 3d65 7863 6c75 6465 2c20 2a2a 6461  de=exclude, **da
-0001b650: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
-0001b660: 635f 6b77 6172 670a 2020 2020 2020 2020  c_kwarg.        
-0001b670: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0001b680: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
-0001b690: 7261 7068 2c20 6e61 6d65 2c20 6d65 7461  raph, name, meta
-0001b6a0: 2c20 6469 7669 7369 6f6e 733d 5b4e 6f6e  , divisions=[Non
-0001b6b0: 652c 204e 6f6e 655d 290a 0a20 2020 2064  e, None])..    d
-0001b6c0: 6566 205f 6465 7363 7269 6265 5f31 6428  ef _describe_1d(
-0001b6d0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0001b6e0: 2020 2020 2020 2064 6174 612c 0a20 2020         data,.   
-0001b6f0: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-0001b700: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-0001b710: 7065 7263 656e 7469 6c65 733d 4e6f 6e65  percentiles=None
-0001b720: 2c0a 2020 2020 2020 2020 7065 7263 656e  ,.        percen
-0001b730: 7469 6c65 735f 6d65 7468 6f64 3d22 6465  tiles_method="de
-0001b740: 6661 756c 7422 2c0a 2020 2020 2020 2020  fault",.        
-0001b750: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
-0001b760: 7269 633d 4661 6c73 652c 0a20 2020 2029  ric=False,.    )
-0001b770: 3a0a 2020 2020 2020 2020 6966 2069 735f  :.        if is_
-0001b780: 626f 6f6c 5f64 7479 7065 2864 6174 612e  bool_dtype(data.
-0001b790: 5f6d 6574 6129 3a0a 2020 2020 2020 2020  _meta):.        
-0001b7a0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001b7b0: 5f64 6573 6372 6962 655f 6e6f 6e6e 756d  _describe_nonnum
-0001b7c0: 6572 6963 5f31 6428 0a20 2020 2020 2020  eric_1d(.       
-0001b7d0: 2020 2020 2020 2020 2064 6174 612c 2073           data, s
-0001b7e0: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-0001b7f0: 5f65 7665 7279 2c20 6461 7465 7469 6d65  _every, datetime
-0001b800: 5f69 735f 6e75 6d65 7269 633d 6461 7465  _is_numeric=date
-0001b810: 7469 6d65 5f69 735f 6e75 6d65 7269 630a  time_is_numeric.
-0001b820: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001b830: 2020 2020 2020 656c 6966 2069 735f 6e75        elif is_nu
-0001b840: 6d65 7269 635f 6474 7970 6528 6461 7461  meric_dtype(data
-0001b850: 2e5f 6d65 7461 293a 0a20 2020 2020 2020  ._meta):.       
-0001b860: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001b870: 2e5f 6465 7363 7269 6265 5f6e 756d 6572  ._describe_numer
-0001b880: 6963 280a 2020 2020 2020 2020 2020 2020  ic(.            
-0001b890: 2020 2020 6461 7461 2c0a 2020 2020 2020      data,.      
-0001b8a0: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
-0001b8b0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-0001b8c0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-0001b8d0: 2020 2070 6572 6365 6e74 696c 6573 3d70     percentiles=p
-0001b8e0: 6572 6365 6e74 696c 6573 2c0a 2020 2020  ercentiles,.    
-0001b8f0: 2020 2020 2020 2020 2020 2020 7065 7263              perc
-0001b900: 656e 7469 6c65 735f 6d65 7468 6f64 3d70  entiles_method=p
-0001b910: 6572 6365 6e74 696c 6573 5f6d 6574 686f  ercentiles_metho
-0001b920: 642c 0a20 2020 2020 2020 2020 2020 2029  d,.            )
-0001b930: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
-0001b940: 5f74 696d 6564 656c 7461 3634 5f64 7479  _timedelta64_dty
-0001b950: 7065 2864 6174 612e 5f6d 6574 6129 3a0a  pe(data._meta):.
-0001b960: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001b970: 726e 2073 656c 662e 5f64 6573 6372 6962  rn self._describ
-0001b980: 655f 6e75 6d65 7269 6328 0a20 2020 2020  e_numeric(.     
-0001b990: 2020 2020 2020 2020 2020 2064 6174 612e             data.
-0001b9a0: 6472 6f70 6e61 2829 2c0a 2020 2020 2020  dropna(),.      
-0001b9b0: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
-0001b9c0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-0001b9d0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-0001b9e0: 2020 2070 6572 6365 6e74 696c 6573 3d70     percentiles=p
-0001b9f0: 6572 6365 6e74 696c 6573 2c0a 2020 2020  ercentiles,.    
-0001ba00: 2020 2020 2020 2020 2020 2020 7065 7263              perc
-0001ba10: 656e 7469 6c65 735f 6d65 7468 6f64 3d70  entiles_method=p
-0001ba20: 6572 6365 6e74 696c 6573 5f6d 6574 686f  ercentiles_metho
-0001ba30: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
-0001ba40: 2020 2069 735f 7469 6d65 6465 6c74 615f     is_timedelta_
-0001ba50: 636f 6c75 6d6e 3d54 7275 652c 0a20 2020  column=True,.   
-0001ba60: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001ba70: 2020 2065 6c69 6620 6973 5f64 6174 6574     elif is_datet
-0001ba80: 696d 6536 345f 616e 795f 6474 7970 6528  ime64_any_dtype(
-0001ba90: 6461 7461 2e5f 6d65 7461 2920 616e 6420  data._meta) and 
-0001baa0: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
-0001bab0: 7269 633a 0a20 2020 2020 2020 2020 2020  ric:.           
-0001bac0: 2072 6574 7572 6e20 7365 6c66 2e5f 6465   return self._de
-0001bad0: 7363 7269 6265 5f6e 756d 6572 6963 280a  scribe_numeric(.
-0001bae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001baf0: 6461 7461 2e64 726f 706e 6128 292c 0a20  data.dropna(),. 
-0001bb00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001bb10: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-0001bb20: 5f65 7665 7279 2c0a 2020 2020 2020 2020  _every,.        
-0001bb30: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
-0001bb40: 6c65 733d 7065 7263 656e 7469 6c65 732c  les=percentiles,
-0001bb50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001bb60: 2070 6572 6365 6e74 696c 6573 5f6d 6574   percentiles_met
-0001bb70: 686f 643d 7065 7263 656e 7469 6c65 735f  hod=percentiles_
-0001bb80: 6d65 7468 6f64 2c0a 2020 2020 2020 2020  method,.        
-0001bb90: 2020 2020 2020 2020 6973 5f64 6174 6574          is_datet
-0001bba0: 696d 655f 636f 6c75 6d6e 3d54 7275 652c  ime_column=True,
-0001bbb0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001bbc0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001bbd0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001bbe0: 7365 6c66 2e5f 6465 7363 7269 6265 5f6e  self._describe_n
-0001bbf0: 6f6e 6e75 6d65 7269 635f 3164 280a 2020  onnumeric_1d(.  
-0001bc00: 2020 2020 2020 2020 2020 2020 2020 6461                da
-0001bc10: 7461 2c20 7370 6c69 745f 6576 6572 793d  ta, split_every=
-0001bc20: 7370 6c69 745f 6576 6572 792c 2064 6174  split_every, dat
-0001bc30: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
-0001bc40: 3d64 6174 6574 696d 655f 6973 5f6e 756d  =datetime_is_num
-0001bc50: 6572 6963 0a20 2020 2020 2020 2020 2020  eric.           
-0001bc60: 2029 0a0a 2020 2020 6465 6620 5f64 6573   )..    def _des
-0001bc70: 6372 6962 655f 6e75 6d65 7269 6328 0a20  cribe_numeric(. 
-0001bc80: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0001bc90: 2020 2020 2064 6174 612c 0a20 2020 2020       data,.     
-0001bca0: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
-0001bcb0: 616c 7365 2c0a 2020 2020 2020 2020 7065  alse,.        pe
-0001bcc0: 7263 656e 7469 6c65 733d 4e6f 6e65 2c0a  rcentiles=None,.
-0001bcd0: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
-0001bce0: 6c65 735f 6d65 7468 6f64 3d22 6465 6661  les_method="defa
-0001bcf0: 756c 7422 2c0a 2020 2020 2020 2020 6973  ult",.        is
-0001bd00: 5f74 696d 6564 656c 7461 5f63 6f6c 756d  _timedelta_colum
-0001bd10: 6e3d 4661 6c73 652c 0a20 2020 2020 2020  n=False,.       
-0001bd20: 2069 735f 6461 7465 7469 6d65 5f63 6f6c   is_datetime_col
-0001bd30: 756d 6e3d 4661 6c73 652c 0a20 2020 2029  umn=False,.    )
-0001bd40: 3a0a 2020 2020 2020 2020 6672 6f6d 2064  :.        from d
-0001bd50: 6173 6b2e 6461 7461 6672 616d 652e 6e75  ask.dataframe.nu
-0001bd60: 6d65 7269 6320 696d 706f 7274 2074 6f5f  meric import to_
-0001bd70: 6e75 6d65 7269 630a 0a20 2020 2020 2020  numeric..       
-0001bd80: 2069 6620 6973 5f74 696d 6564 656c 7461   if is_timedelta
-0001bd90: 5f63 6f6c 756d 6e20 6f72 2069 735f 6461  _column or is_da
-0001bda0: 7465 7469 6d65 5f63 6f6c 756d 6e3a 0a20  tetime_column:. 
-0001bdb0: 2020 2020 2020 2020 2020 206e 756d 203d             num =
-0001bdc0: 2074 6f5f 6e75 6d65 7269 6328 6461 7461   to_numeric(data
-0001bdd0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0001bde0: 2020 2020 2020 2020 2020 2020 6e75 6d20              num 
-0001bdf0: 3d20 6461 7461 2e5f 6765 745f 6e75 6d65  = data._get_nume
-0001be00: 7269 635f 6461 7461 2829 0a0a 2020 2020  ric_data()..    
-0001be10: 2020 2020 6966 2064 6174 612e 6e64 696d      if data.ndim
-0001be20: 203d 3d20 3220 616e 6420 6c65 6e28 6e75   == 2 and len(nu
-0001be30: 6d2e 636f 6c75 6d6e 7329 203d 3d20 303a  m.columns) == 0:
-0001be40: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001be50: 7365 2056 616c 7565 4572 726f 7228 2244  se ValueError("D
-0001be60: 6174 6146 7261 6d65 2063 6f6e 7461 696e  ataFrame contain
-0001be70: 7320 6f6e 6c79 206e 6f6e 2d6e 756d 6572  s only non-numer
-0001be80: 6963 2064 6174 612e 2229 0a20 2020 2020  ic data.").     
-0001be90: 2020 2065 6c69 6620 6461 7461 2e6e 6469     elif data.ndi
-0001bea0: 6d20 3d3d 2031 2061 6e64 2064 6174 612e  m == 1 and data.
-0001beb0: 6474 7970 6520 3d3d 2022 6f62 6a65 6374  dtype == "object
-0001bec0: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
-0001bed0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0001bee0: 2243 616e 6e6f 7420 636f 6d70 7574 6520  "Cannot compute 
-0001bef0: 6060 6465 7363 7269 6265 6060 206f 6e20  ``describe`` on 
-0001bf00: 6f62 6a65 6374 2064 7479 7065 2e22 290a  object dtype.").
-0001bf10: 2020 2020 2020 2020 6966 2070 6572 6365          if perce
-0001bf20: 6e74 696c 6573 2069 7320 4e6f 6e65 3a0a  ntiles is None:.
-0001bf30: 2020 2020 2020 2020 2020 2020 7065 7263              perc
-0001bf40: 656e 7469 6c65 7320 3d20 5b30 2e32 352c  entiles = [0.25,
-0001bf50: 2030 2e35 2c20 302e 3735 5d0a 2020 2020   0.5, 0.75].    
-0001bf60: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001bf70: 2020 2020 2020 2320 616c 7761 7973 2069        # always i
-0001bf80: 6e63 6c75 6465 2074 6865 2074 6865 2035  nclude the the 5
-0001bf90: 3025 746c 6520 746f 2063 616c 6375 6c61  0%tle to calcula
-0001bfa0: 7465 2074 6865 206d 6564 6961 6e0a 2020  te the median.  
-0001bfb0: 2020 2020 2020 2020 2020 2320 756e 6971            # uniq
-0001bfc0: 7565 2072 656d 6f76 6573 2064 7570 6c69  ue removes dupli
-0001bfd0: 6361 7465 7320 616e 6420 736f 7274 7320  cates and sorts 
-0001bfe0: 7175 616e 7469 6c65 730a 2020 2020 2020  quantiles.      
-0001bff0: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
-0001c000: 7320 3d20 6e70 2e61 7272 6179 2870 6572  s = np.array(per
-0001c010: 6365 6e74 696c 6573 290a 2020 2020 2020  centiles).      
-0001c020: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
-0001c030: 7320 3d20 6e70 2e61 7070 656e 6428 7065  s = np.append(pe
-0001c040: 7263 656e 7469 6c65 732c 2030 2e35 290a  rcentiles, 0.5).
-0001c050: 2020 2020 2020 2020 2020 2020 7065 7263              perc
-0001c060: 656e 7469 6c65 7320 3d20 6e70 2e75 6e69  entiles = np.uni
-0001c070: 7175 6528 7065 7263 656e 7469 6c65 7329  que(percentiles)
-0001c080: 0a20 2020 2020 2020 2020 2020 2070 6572  .            per
-0001c090: 6365 6e74 696c 6573 203d 206c 6973 7428  centiles = list(
-0001c0a0: 7065 7263 656e 7469 6c65 7329 0a20 2020  percentiles).   
-0001c0b0: 2020 2020 2073 7461 7473 203d 205b 0a20       stats = [. 
-0001c0c0: 2020 2020 2020 2020 2020 206e 756d 2e63             num.c
-0001c0d0: 6f75 6e74 2873 706c 6974 5f65 7665 7279  ount(split_every
-0001c0e0: 3d73 706c 6974 5f65 7665 7279 292c 0a20  =split_every),. 
-0001c0f0: 2020 2020 2020 2020 2020 206e 756d 2e6d             num.m
-0001c100: 6561 6e28 7370 6c69 745f 6576 6572 793d  ean(split_every=
-0001c110: 7370 6c69 745f 6576 6572 7929 2c0a 2020  split_every),.  
-0001c120: 2020 2020 2020 2020 2020 6e75 6d2e 7374            num.st
-0001c130: 6428 7370 6c69 745f 6576 6572 793d 7370  d(split_every=sp
-0001c140: 6c69 745f 6576 6572 7929 2c0a 2020 2020  lit_every),.    
-0001c150: 2020 2020 2020 2020 6e75 6d2e 6d69 6e28          num.min(
-0001c160: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-0001c170: 745f 6576 6572 7929 2c0a 2020 2020 2020  t_every),.      
-0001c180: 2020 2020 2020 6e75 6d2e 7175 616e 7469        num.quanti
-0001c190: 6c65 2870 6572 6365 6e74 696c 6573 2c20  le(percentiles, 
-0001c1a0: 6d65 7468 6f64 3d70 6572 6365 6e74 696c  method=percentil
-0001c1b0: 6573 5f6d 6574 686f 6429 2c0a 2020 2020  es_method),.    
-0001c1c0: 2020 2020 2020 2020 6e75 6d2e 6d61 7828          num.max(
-0001c1d0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-0001c1e0: 745f 6576 6572 7929 2c0a 2020 2020 2020  t_every),.      
-0001c1f0: 2020 5d0a 2020 2020 2020 2020 7374 6174    ].        stat
-0001c200: 735f 6e61 6d65 7320 3d20 5b28 732e 5f6e  s_names = [(s._n
-0001c210: 616d 652c 2030 2920 666f 7220 7320 696e  ame, 0) for s in
-0001c220: 2073 7461 7473 5d0a 0a20 2020 2020 2020   stats]..       
-0001c230: 2063 6f6c 6e61 6d65 203d 2064 6174 612e   colname = data.
-0001c240: 5f6d 6574 612e 6e61 6d65 2069 6620 6973  _meta.name if is
-0001c250: 5f73 6572 6965 735f 6c69 6b65 2864 6174  _series_like(dat
-0001c260: 612e 5f6d 6574 6129 2065 6c73 6520 4e6f  a._meta) else No
-0001c270: 6e65 0a0a 2020 2020 2020 2020 6e61 6d65  ne..        name
-0001c280: 203d 2022 6465 7363 7269 6265 2d6e 756d   = "describe-num
-0001c290: 6572 6963 2d2d 2220 2b20 746f 6b65 6e69  eric--" + tokeni
-0001c2a0: 7a65 286e 756d 2c20 7370 6c69 745f 6576  ze(num, split_ev
-0001c2b0: 6572 7929 0a20 2020 2020 2020 206c 6179  ery).        lay
-0001c2c0: 6572 203d 207b 0a20 2020 2020 2020 2020  er = {.         
-0001c2d0: 2020 2028 6e61 6d65 2c20 3029 3a20 280a     (name, 0): (.
-0001c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2f0: 6d65 7468 6f64 732e 6465 7363 7269 6265  methods.describe
-0001c300: 5f6e 756d 6572 6963 5f61 6767 7265 6761  _numeric_aggrega
-0001c310: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
-0001c320: 2020 2020 7374 6174 735f 6e61 6d65 732c      stats_names,
-0001c330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c340: 2063 6f6c 6e61 6d65 2c0a 2020 2020 2020   colname,.      
-0001c350: 2020 2020 2020 2020 2020 6973 5f74 696d            is_tim
-0001c360: 6564 656c 7461 5f63 6f6c 756d 6e2c 0a20  edelta_column,. 
-0001c370: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001c380: 735f 6461 7465 7469 6d65 5f63 6f6c 756d  s_datetime_colum
-0001c390: 6e2c 0a20 2020 2020 2020 2020 2020 2029  n,.            )
-0001c3a0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-0001c3b0: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-0001c3c0: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-0001c3d0: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
-0001c3e0: 206c 6179 6572 2c20 6465 7065 6e64 656e   layer, dependen
-0001c3f0: 6369 6573 3d73 7461 7473 290a 2020 2020  cies=stats).    
-0001c400: 2020 2020 6d65 7461 203d 206e 756d 2e5f      meta = num._
-0001c410: 6d65 7461 5f6e 6f6e 656d 7074 792e 6465  meta_nonempty.de
-0001c420: 7363 7269 6265 2829 0a20 2020 2020 2020  scribe().       
-0001c430: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
-0001c440: 626a 6563 7428 6772 6170 682c 206e 616d  bject(graph, nam
-0001c450: 652c 206d 6574 612c 2064 6976 6973 696f  e, meta, divisio
-0001c460: 6e73 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d29  ns=[None, None])
-0001c470: 0a0a 2020 2020 6465 6620 5f64 6573 6372  ..    def _descr
-0001c480: 6962 655f 6e6f 6e6e 756d 6572 6963 5f31  ibe_nonnumeric_1
-0001c490: 6428 0a20 2020 2020 2020 2073 656c 662c  d(.        self,
-0001c4a0: 2064 6174 612c 2073 706c 6974 5f65 7665   data, split_eve
-0001c4b0: 7279 3d46 616c 7365 2c20 6461 7465 7469  ry=False, dateti
-0001c4c0: 6d65 5f69 735f 6e75 6d65 7269 633d 4661  me_is_numeric=Fa
-0001c4d0: 6c73 650a 2020 2020 293a 0a20 2020 2020  lse.    ):.     
-0001c4e0: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-0001c4f0: 6166 7261 6d65 2e6e 756d 6572 6963 2069  aframe.numeric i
-0001c500: 6d70 6f72 7420 746f 5f6e 756d 6572 6963  mport to_numeric
-0001c510: 0a0a 2020 2020 2020 2020 7663 6f75 6e74  ..        vcount
-0001c520: 7320 3d20 6461 7461 2e76 616c 7565 5f63  s = data.value_c
-0001c530: 6f75 6e74 7328 7370 6c69 745f 6576 6572  ounts(split_ever
-0001c540: 793d 7370 6c69 745f 6576 6572 7929 0a20  y=split_every). 
-0001c550: 2020 2020 2020 2063 6f75 6e74 5f6e 6f6e         count_non
-0001c560: 7a65 726f 203d 2076 636f 756e 7473 5b76  zero = vcounts[v
-0001c570: 636f 756e 7473 2021 3d20 305d 0a20 2020  counts != 0].   
-0001c580: 2020 2020 2063 6f75 6e74 5f75 6e69 7175       count_uniqu
-0001c590: 6520 3d20 636f 756e 745f 6e6f 6e7a 6572  e = count_nonzer
-0001c5a0: 6f2e 7369 7a65 0a0a 2020 2020 2020 2020  o.size..        
-0001c5b0: 7374 6174 7320 3d20 5b0a 2020 2020 2020  stats = [.      
-0001c5c0: 2020 2020 2020 2320 6e75 6e69 7175 650a        # nunique.
-0001c5d0: 2020 2020 2020 2020 2020 2020 636f 756e              coun
-0001c5e0: 745f 756e 6971 7565 2c0a 2020 2020 2020  t_unique,.      
-0001c5f0: 2020 2020 2020 2320 636f 756e 740a 2020        # count.  
-0001c600: 2020 2020 2020 2020 2020 6461 7461 2e63            data.c
-0001c610: 6f75 6e74 2873 706c 6974 5f65 7665 7279  ount(split_every
-0001c620: 3d73 706c 6974 5f65 7665 7279 292c 0a20  =split_every),. 
-0001c630: 2020 2020 2020 2020 2020 2023 206d 6f73             # mos
-0001c640: 7420 636f 6d6d 6f6e 2076 616c 7565 0a20  t common value. 
-0001c650: 2020 2020 2020 2020 2020 2076 636f 756e             vcoun
-0001c660: 7473 2e5f 6865 6164 2831 2c20 6e70 6172  ts._head(1, npar
-0001c670: 7469 7469 6f6e 733d 312c 2063 6f6d 7075  titions=1, compu
-0001c680: 7465 3d46 616c 7365 2c20 7361 6665 3d46  te=False, safe=F
-0001c690: 616c 7365 292c 0a20 2020 2020 2020 205d  alse),.        ]
-0001c6a0: 0a0a 2020 2020 2020 2020 6966 2069 735f  ..        if is_
-0001c6b0: 6461 7465 7469 6d65 3634 5f61 6e79 5f64  datetime64_any_d
-0001c6c0: 7479 7065 2864 6174 612e 5f6d 6574 6129  type(data._meta)
-0001c6d0: 2061 6e64 206e 6f74 2064 6174 6574 696d   and not datetim
-0001c6e0: 655f 6973 5f6e 756d 6572 6963 3a0a 2020  e_is_numeric:.  
-0001c6f0: 2020 2020 2020 2020 2020 6d69 6e5f 7473            min_ts
-0001c700: 203d 2074 6f5f 6e75 6d65 7269 6328 6461   = to_numeric(da
-0001c710: 7461 2e64 726f 706e 6128 2929 2e6d 696e  ta.dropna()).min
-0001c720: 2873 706c 6974 5f65 7665 7279 3d73 706c  (split_every=spl
-0001c730: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
-0001c740: 2020 2020 2020 6d61 785f 7473 203d 2074        max_ts = t
-0001c750: 6f5f 6e75 6d65 7269 6328 6461 7461 2e64  o_numeric(data.d
-0001c760: 726f 706e 6128 2929 2e6d 6178 2873 706c  ropna()).max(spl
-0001c770: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-0001c780: 7665 7279 290a 2020 2020 2020 2020 2020  very).          
-0001c790: 2020 7374 6174 732e 6578 7465 6e64 285b    stats.extend([
-0001c7a0: 6d69 6e5f 7473 2c20 6d61 785f 7473 5d29  min_ts, max_ts])
-0001c7b0: 0a0a 2020 2020 2020 2020 7374 6174 735f  ..        stats_
-0001c7c0: 6e61 6d65 7320 3d20 5b28 732e 5f6e 616d  names = [(s._nam
-0001c7d0: 652c 2030 2920 666f 7220 7320 696e 2073  e, 0) for s in s
-0001c7e0: 7461 7473 5d0a 2020 2020 2020 2020 636f  tats].        co
-0001c7f0: 6c6e 616d 6520 3d20 6461 7461 2e5f 6d65  lname = data._me
-0001c800: 7461 2e6e 616d 650a 0a20 2020 2020 2020  ta.name..       
-0001c810: 206e 616d 6520 3d20 2264 6573 6372 6962   name = "describ
-0001c820: 652d 6e6f 6e6e 756d 6572 6963 2d31 642d  e-nonnumeric-1d-
-0001c830: 2d22 202b 2074 6f6b 656e 697a 6528 6461  -" + tokenize(da
-0001c840: 7461 2c20 7370 6c69 745f 6576 6572 7929  ta, split_every)
-0001c850: 0a20 2020 2020 2020 206c 6179 6572 203d  .        layer =
-0001c860: 207b 0a20 2020 2020 2020 2020 2020 2028   {.            (
-0001c870: 6e61 6d65 2c20 3029 3a20 286d 6574 686f  name, 0): (metho
-0001c880: 6473 2e64 6573 6372 6962 655f 6e6f 6e6e  ds.describe_nonn
-0001c890: 756d 6572 6963 5f61 6767 7265 6761 7465  umeric_aggregate
-0001c8a0: 2c20 7374 6174 735f 6e61 6d65 732c 2063  , stats_names, c
-0001c8b0: 6f6c 6e61 6d65 290a 2020 2020 2020 2020  olname).        
-0001c8c0: 7d0a 2020 2020 2020 2020 6772 6170 6820  }.        graph 
-0001c8d0: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-0001c8e0: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-0001c8f0: 7328 6e61 6d65 2c20 6c61 7965 722c 2064  s(name, layer, d
-0001c900: 6570 656e 6465 6e63 6965 733d 7374 6174  ependencies=stat
-0001c910: 7329 0a0a 2020 2020 2020 2020 6966 206e  s)..        if n
-0001c920: 6f74 2050 414e 4441 535f 4754 5f32 3030  ot PANDAS_GT_200
-0001c930: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
-0001c940: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
-0001c950: 635f 6b77 6172 6720 3d20 7b22 6461 7465  c_kwarg = {"date
-0001c960: 7469 6d65 5f69 735f 6e75 6d65 7269 6322  time_is_numeric"
-0001c970: 3a20 6461 7465 7469 6d65 5f69 735f 6e75  : datetime_is_nu
-0001c980: 6d65 7269 637d 0a20 2020 2020 2020 2065  meric}.        e
-0001c990: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001c9a0: 2064 6174 6574 696d 655f 6973 5f6e 756d   datetime_is_num
-0001c9b0: 6572 6963 5f6b 7761 7267 203d 207b 7d0a  eric_kwarg = {}.
-0001c9c0: 2020 2020 2020 2020 6d65 7461 203d 2064          meta = d
-0001c9d0: 6174 612e 5f6d 6574 615f 6e6f 6e65 6d70  ata._meta_nonemp
-0001c9e0: 7479 2e64 6573 6372 6962 6528 2a2a 6461  ty.describe(**da
-0001c9f0: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
-0001ca00: 635f 6b77 6172 6729 0a20 2020 2020 2020  c_kwarg).       
-0001ca10: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
-0001ca20: 626a 6563 7428 6772 6170 682c 206e 616d  bject(graph, nam
-0001ca30: 652c 206d 6574 612c 2064 6976 6973 696f  e, meta, divisio
-0001ca40: 6e73 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d29  ns=[None, None])
-0001ca50: 0a0a 2020 2020 6465 6620 5f63 756d 5f61  ..    def _cum_a
-0001ca60: 6767 280a 2020 2020 2020 2020 7365 6c66  gg(.        self
-0001ca70: 2c20 6f70 5f6e 616d 652c 2063 6875 6e6b  , op_name, chunk
-0001ca80: 2c20 6167 6772 6567 6174 652c 2061 7869  , aggregate, axi
-0001ca90: 732c 2073 6b69 706e 613d 5472 7565 2c20  s, skipna=True, 
-0001caa0: 6368 756e 6b5f 6b77 6172 6773 3d4e 6f6e  chunk_kwargs=Non
-0001cab0: 652c 206f 7574 3d4e 6f6e 650a 2020 2020  e, out=None.    
-0001cac0: 293a 0a20 2020 2020 2020 2022 2222 5772  ):.        """Wr
-0001cad0: 6170 7065 7220 666f 7220 6375 6d75 6c61  apper for cumula
-0001cae0: 7469 7665 206f 7065 7261 7469 6f6e 2222  tive operation""
-0001caf0: 220a 0a20 2020 2020 2020 2061 7869 7320  "..        axis 
-0001cb00: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
-0001cb10: 5f61 7869 7328 6178 6973 290a 0a20 2020  _axis(axis)..   
-0001cb20: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
-0001cb30: 313a 0a20 2020 2020 2020 2020 2020 206e  1:.            n
-0001cb40: 616d 6520 3d20 6622 7b73 656c 662e 5f74  ame = f"{self._t
-0001cb50: 6f6b 656e 5f70 7265 6669 787d 7b6f 705f  oken_prefix}{op_
-0001cb60: 6e61 6d65 7d28 6178 6973 3d31 2922 0a20  name}(axis=1)". 
-0001cb70: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-0001cb80: 7420 3d20 7365 6c66 2e6d 6170 5f70 6172  t = self.map_par
-0001cb90: 7469 7469 6f6e 7328 6368 756e 6b2c 2074  titions(chunk, t
-0001cba0: 6f6b 656e 3d6e 616d 652c 202a 2a63 6875  oken=name, **chu
-0001cbb0: 6e6b 5f6b 7761 7267 7329 0a20 2020 2020  nk_kwargs).     
-0001cbc0: 2020 2020 2020 2072 6574 7572 6e20 6861         return ha
-0001cbd0: 6e64 6c65 5f6f 7574 286f 7574 2c20 7265  ndle_out(out, re
-0001cbe0: 7375 6c74 290a 2020 2020 2020 2020 656c  sult).        el
-0001cbf0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001cc00: 2320 6375 6d75 6c61 7465 2065 6163 6820  # cumulate each 
-0001cc10: 7061 7274 6974 696f 6e73 0a20 2020 2020  partitions.     
-0001cc20: 2020 2020 2020 206e 616d 6531 203d 2066         name1 = f
-0001cc30: 227b 7365 6c66 2e5f 746f 6b65 6e5f 7072  "{self._token_pr
-0001cc40: 6566 6978 7d7b 6f70 5f6e 616d 657d 2d6d  efix}{op_name}-m
-0001cc50: 6170 220a 2020 2020 2020 2020 2020 2020  ap".            
-0001cc60: 6375 6d70 6172 7420 3d20 6d61 705f 7061  cumpart = map_pa
-0001cc70: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-0001cc80: 2020 2020 2020 2020 2020 6368 756e 6b2c            chunk,
-0001cc90: 2073 656c 662c 2074 6f6b 656e 3d6e 616d   self, token=nam
-0001cca0: 6531 2c20 6d65 7461 3d73 656c 662c 202a  e1, meta=self, *
-0001ccb0: 2a63 6875 6e6b 5f6b 7761 7267 730a 2020  *chunk_kwargs.  
-0001ccc0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0001ccd0: 2020 2020 2020 2020 206e 616d 6532 203d           name2 =
-0001cce0: 2066 227b 7365 6c66 2e5f 746f 6b65 6e5f   f"{self._token_
-0001ccf0: 7072 6566 6978 7d7b 6f70 5f6e 616d 657d  prefix}{op_name}
-0001cd00: 2d74 616b 652d 6c61 7374 220a 2020 2020  -take-last".    
-0001cd10: 2020 2020 2020 2020 6375 6d6c 6173 7420          cumlast 
-0001cd20: 3d20 6d61 705f 7061 7274 6974 696f 6e73  = map_partitions
-0001cd30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001cd40: 2020 5f74 616b 655f 6c61 7374 2c0a 2020    _take_last,.  
-0001cd50: 2020 2020 2020 2020 2020 2020 2020 6375                cu
-0001cd60: 6d70 6172 742c 0a20 2020 2020 2020 2020  mpart,.         
-0001cd70: 2020 2020 2020 2073 6b69 706e 612c 0a20         skipna,. 
-0001cd80: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0001cd90: 6574 613d 6d65 7461 5f73 6572 6965 735f  eta=meta_series_
-0001cda0: 636f 6e73 7472 7563 746f 7228 7365 6c66  constructor(self
-0001cdb0: 2928 5b5d 2c20 6474 7970 653d 2266 6c6f  )([], dtype="flo
-0001cdc0: 6174 2229 2c0a 2020 2020 2020 2020 2020  at"),.          
-0001cdd0: 2020 2020 2020 746f 6b65 6e3d 6e61 6d65        token=name
-0001cde0: 322c 0a20 2020 2020 2020 2020 2020 2029  2,.            )
-0001cdf0: 0a0a 2020 2020 2020 2020 2020 2020 7375  ..            su
-0001ce00: 6666 6978 203d 2074 6f6b 656e 697a 6528  ffix = tokenize(
-0001ce10: 7365 6c66 290a 2020 2020 2020 2020 2020  self).          
-0001ce20: 2020 6e61 6d65 203d 2066 227b 7365 6c66    name = f"{self
-0001ce30: 2e5f 746f 6b65 6e5f 7072 6566 6978 7d7b  ._token_prefix}{
-0001ce40: 6f70 5f6e 616d 657d 2d7b 7375 6666 6978  op_name}-{suffix
-0001ce50: 7d22 0a20 2020 2020 2020 2020 2020 2063  }".            c
-0001ce60: 6e61 6d65 203d 2066 227b 7365 6c66 2e5f  name = f"{self._
-0001ce70: 746f 6b65 6e5f 7072 6566 6978 7d7b 6f70  token_prefix}{op
-0001ce80: 5f6e 616d 657d 2d63 756d 2d6c 6173 742d  _name}-cum-last-
-0001ce90: 7b73 7566 6669 787d 220a 0a20 2020 2020  {suffix}"..     
-0001cea0: 2020 2020 2020 2023 2061 6767 7265 6761         # aggrega
-0001ceb0: 7465 2063 756d 756c 6174 6564 2070 6172  te cumulated par
-0001cec0: 7469 7369 6f6e 7320 616e 6420 6974 7320  tisions and its 
-0001ced0: 7072 6576 696f 7573 206c 6173 7420 656c  previous last el
-0001cee0: 656d 656e 740a 2020 2020 2020 2020 2020  ement.          
-0001cef0: 2020 6c61 7965 7220 3d20 7b7d 0a20 2020    layer = {}.   
-0001cf00: 2020 2020 2020 2020 206c 6179 6572 5b28           layer[(
-0001cf10: 6e61 6d65 2c20 3029 5d20 3d20 2863 756d  name, 0)] = (cum
-0001cf20: 7061 7274 2e5f 6e61 6d65 2c20 3029 0a0a  part._name, 0)..
-0001cf30: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001cf40: 6920 696e 2072 616e 6765 2831 2c20 7365  i in range(1, se
-0001cf50: 6c66 2e6e 7061 7274 6974 696f 6e73 293a  lf.npartitions):
-0001cf60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001cf70: 2023 2073 746f 7265 2065 6163 6820 6375   # store each cu
-0001cf80: 6d75 6c61 7469 7665 2073 7465 7020 746f  mulative step to
-0001cf90: 2067 7261 7068 2074 6f20 7265 6475 6365   graph to reduce
-0001cfa0: 2063 6f6d 7075 7461 7469 6f6e 0a20 2020   computation.   
-0001cfb0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001cfc0: 6920 3d3d 2031 3a0a 2020 2020 2020 2020  i == 1:.        
-0001cfd0: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
-0001cfe0: 725b 2863 6e61 6d65 2c20 6929 5d20 3d20  r[(cname, i)] = 
-0001cff0: 2863 756d 6c61 7374 2e5f 6e61 6d65 2c20  (cumlast._name, 
-0001d000: 6920 2d20 3129 0a20 2020 2020 2020 2020  i - 1).         
-0001d010: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d030: 2023 2061 6767 7265 6761 7465 2077 6974   # aggregate wit
-0001d040: 6820 7072 6576 696f 7573 2063 756d 756c  h previous cumul
-0001d050: 6174 696f 6e20 7265 7375 6c74 730a 2020  ation results.  
-0001d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d070: 2020 6c61 7965 725b 2863 6e61 6d65 2c20    layer[(cname, 
-0001d080: 6929 5d20 3d20 280a 2020 2020 2020 2020  i)] = (.        
-0001d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d0a0: 6d65 7468 6f64 732e 5f63 756d 5f61 6767  methods._cum_agg
-0001d0b0: 7265 6761 7465 5f61 7070 6c79 2c0a 2020  regate_apply,.  
+0001b0d0: 7564 6520 3d20 5b6e 702e 7469 6d65 6465  ude = [np.timede
+0001b0e0: 6c74 6136 342c 2062 6f6f 6c5d 0a20 2020  lta64, bool].   
+0001b0f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001b100: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
+0001b110: 7269 633a 0a20 2020 2020 2020 2020 2020  ric:.           
+0001b120: 2020 2020 2020 2020 205f 696e 636c 7564           _includ
+0001b130: 652e 6170 7065 6e64 286e 702e 6461 7465  e.append(np.date
+0001b140: 7469 6d65 3634 290a 2020 2020 2020 2020  time64).        
+0001b150: 2020 2020 2020 2020 626f 6f6c 735f 616e          bools_an
+0001b160: 645f 7469 6d65 7320 3d20 7365 6c66 2e5f  d_times = self._
+0001b170: 6d65 7461 2e73 656c 6563 745f 6474 7970  meta.select_dtyp
+0001b180: 6573 2869 6e63 6c75 6465 3d5f 696e 636c  es(include=_incl
+0001b190: 7564 6529 0a20 2020 2020 2020 2020 2020  ude).           
+0001b1a0: 2020 2020 2069 6620 6c65 6e28 626f 6f6c       if len(bool
+0001b1b0: 735f 616e 645f 7469 6d65 732e 636f 6c75  s_and_times.colu
+0001b1c0: 6d6e 7329 203d 3d20 303a 0a20 2020 2020  mns) == 0:.     
+0001b1d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001b1e0: 6574 7572 6e20 7365 6c66 2e5f 6465 7363  eturn self._desc
+0001b1f0: 7269 6265 5f6e 756d 6572 6963 280a 2020  ribe_numeric(.  
+0001b200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b210: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0001b220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b230: 2020 2020 7370 6c69 745f 6576 6572 792c      split_every,
+0001b240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b250: 2020 2020 2020 2020 2070 6572 6365 6e74           percent
+0001b260: 696c 6573 2c0a 2020 2020 2020 2020 2020  iles,.          
+0001b270: 2020 2020 2020 2020 2020 2020 2020 7065                pe
+0001b280: 7263 656e 7469 6c65 735f 6d65 7468 6f64  rcentiles_method
+0001b290: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001b2a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001b2b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001b2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b2d0: 2020 6368 6f73 656e 5f63 6f6c 756d 6e73    chosen_columns
+0001b2e0: 203d 2064 6174 612e 636f 6c75 6d6e 730a   = data.columns.
+0001b2f0: 2020 2020 2020 2020 656c 6966 2069 6e63          elif inc
+0001b300: 6c75 6465 203d 3d20 2261 6c6c 223a 0a20  lude == "all":. 
+0001b310: 2020 2020 2020 2020 2020 2069 6620 6578             if ex
+0001b320: 636c 7564 6520 6973 206e 6f74 204e 6f6e  clude is not Non
+0001b330: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001b340: 2020 206d 7367 203d 2022 6578 636c 7564     msg = "exclud
+0001b350: 6520 6d75 7374 2062 6520 4e6f 6e65 2077  e must be None w
+0001b360: 6865 6e20 696e 636c 7564 6520 6973 2027  hen include is '
+0001b370: 616c 6c27 220a 2020 2020 2020 2020 2020  all'".          
+0001b380: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0001b390: 6545 7272 6f72 286d 7367 290a 2020 2020  eError(msg).    
+0001b3a0: 2020 2020 2020 2020 6368 6f73 656e 5f63          chosen_c
+0001b3b0: 6f6c 756d 6e73 203d 2073 656c 662e 5f6d  olumns = self._m
+0001b3c0: 6574 612e 636f 6c75 6d6e 730a 2020 2020  eta.columns.    
+0001b3d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001b3e0: 2020 2020 2020 6368 6f73 656e 5f63 6f6c        chosen_col
+0001b3f0: 756d 6e73 203d 2073 656c 662e 5f6d 6574  umns = self._met
+0001b400: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
+0001b410: 696e 636c 7564 653d 696e 636c 7564 652c  include=include,
+0001b420: 2065 7863 6c75 6465 3d65 7863 6c75 6465   exclude=exclude
+0001b430: 290a 0a20 2020 2020 2020 2073 7461 7473  )..        stats
+0001b440: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+0001b450: 2073 656c 662e 5f64 6573 6372 6962 655f   self._describe_
+0001b460: 3164 280a 2020 2020 2020 2020 2020 2020  1d(.            
+0001b470: 2020 2020 7365 6c66 5b63 6f6c 5f69 6478      self[col_idx
+0001b480: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0001b490: 2020 2073 706c 6974 5f65 7665 7279 2c0a     split_every,.
+0001b4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b4b0: 7065 7263 656e 7469 6c65 732c 0a20 2020  percentiles,.   
+0001b4c0: 2020 2020 2020 2020 2020 2020 2070 6572               per
+0001b4d0: 6365 6e74 696c 6573 5f6d 6574 686f 642c  centiles_method,
+0001b4e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b4f0: 2064 6174 6574 696d 655f 6973 5f6e 756d   datetime_is_num
+0001b500: 6572 6963 2c0a 2020 2020 2020 2020 2020  eric,.          
+0001b510: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0001b520: 666f 7220 636f 6c5f 6964 7820 696e 2063  for col_idx in c
+0001b530: 686f 7365 6e5f 636f 6c75 6d6e 730a 2020  hosen_columns.  
+0001b540: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+0001b550: 7374 6174 735f 6e61 6d65 7320 3d20 5b28  stats_names = [(
+0001b560: 732e 5f6e 616d 652c 2030 2920 666f 7220  s._name, 0) for 
+0001b570: 7320 696e 2073 7461 7473 5d0a 0a20 2020  s in stats]..   
+0001b580: 2020 2020 206e 616d 6520 3d20 2264 6573       name = "des
+0001b590: 6372 6962 652d 2d22 202b 2074 6f6b 656e  cribe--" + token
+0001b5a0: 697a 6528 7365 6c66 2c20 7370 6c69 745f  ize(self, split_
+0001b5b0: 6576 6572 7929 0a20 2020 2020 2020 206c  every).        l
+0001b5c0: 6179 6572 203d 207b 286e 616d 652c 2030  ayer = {(name, 0
+0001b5d0: 293a 2028 6d65 7468 6f64 732e 6465 7363  ): (methods.desc
+0001b5e0: 7269 6265 5f61 6767 7265 6761 7465 2c20  ribe_aggregate, 
+0001b5f0: 7374 6174 735f 6e61 6d65 7329 7d0a 2020  stats_names)}.  
+0001b600: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
+0001b610: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+0001b620: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
+0001b630: 6d65 2c20 6c61 7965 722c 2064 6570 656e  me, layer, depen
+0001b640: 6465 6e63 6965 733d 7374 6174 7329 0a20  dencies=stats). 
+0001b650: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
+0001b660: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
+0001b670: 792e 6465 7363 7269 6265 280a 2020 2020  y.describe(.    
+0001b680: 2020 2020 2020 2020 696e 636c 7564 653d          include=
+0001b690: 696e 636c 7564 652c 2065 7863 6c75 6465  include, exclude
+0001b6a0: 3d65 7863 6c75 6465 2c20 2a2a 6461 7465  =exclude, **date
+0001b6b0: 7469 6d65 5f69 735f 6e75 6d65 7269 635f  time_is_numeric_
+0001b6c0: 6b77 6172 670a 2020 2020 2020 2020 290a  kwarg.        ).
+0001b6d0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0001b6e0: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
+0001b6f0: 7068 2c20 6e61 6d65 2c20 6d65 7461 2c20  ph, name, meta, 
+0001b700: 6469 7669 7369 6f6e 733d 5b4e 6f6e 652c  divisions=[None,
+0001b710: 204e 6f6e 655d 290a 0a20 2020 2064 6566   None])..    def
+0001b720: 205f 6465 7363 7269 6265 5f31 6428 0a20   _describe_1d(. 
+0001b730: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001b740: 2020 2020 2064 6174 612c 0a20 2020 2020       data,.     
+0001b750: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
+0001b760: 616c 7365 2c0a 2020 2020 2020 2020 7065  alse,.        pe
+0001b770: 7263 656e 7469 6c65 733d 4e6f 6e65 2c0a  rcentiles=None,.
+0001b780: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
+0001b790: 6c65 735f 6d65 7468 6f64 3d22 6465 6661  les_method="defa
+0001b7a0: 756c 7422 2c0a 2020 2020 2020 2020 6461  ult",.        da
+0001b7b0: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
+0001b7c0: 633d 4661 6c73 652c 0a20 2020 2029 3a0a  c=False,.    ):.
+0001b7d0: 2020 2020 2020 2020 6966 2069 735f 626f          if is_bo
+0001b7e0: 6f6c 5f64 7479 7065 2864 6174 612e 5f6d  ol_dtype(data._m
+0001b7f0: 6574 6129 3a0a 2020 2020 2020 2020 2020  eta):.          
+0001b800: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+0001b810: 6573 6372 6962 655f 6e6f 6e6e 756d 6572  escribe_nonnumer
+0001b820: 6963 5f31 6428 0a20 2020 2020 2020 2020  ic_1d(.         
+0001b830: 2020 2020 2020 2064 6174 612c 2073 706c         data, spl
+0001b840: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+0001b850: 7665 7279 2c20 6461 7465 7469 6d65 5f69  very, datetime_i
+0001b860: 735f 6e75 6d65 7269 633d 6461 7465 7469  s_numeric=dateti
+0001b870: 6d65 5f69 735f 6e75 6d65 7269 630a 2020  me_is_numeric.  
+0001b880: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001b890: 2020 2020 656c 6966 2069 735f 6e75 6d65      elif is_nume
+0001b8a0: 7269 635f 6474 7970 6528 6461 7461 2e5f  ric_dtype(data._
+0001b8b0: 6d65 7461 293a 0a20 2020 2020 2020 2020  meta):.         
+0001b8c0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0001b8d0: 6465 7363 7269 6265 5f6e 756d 6572 6963  describe_numeric
+0001b8e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001b8f0: 2020 6461 7461 2c0a 2020 2020 2020 2020    data,.        
+0001b900: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+0001b910: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
+0001b920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b930: 2070 6572 6365 6e74 696c 6573 3d70 6572   percentiles=per
+0001b940: 6365 6e74 696c 6573 2c0a 2020 2020 2020  centiles,.      
+0001b950: 2020 2020 2020 2020 2020 7065 7263 656e            percen
+0001b960: 7469 6c65 735f 6d65 7468 6f64 3d70 6572  tiles_method=per
+0001b970: 6365 6e74 696c 6573 5f6d 6574 686f 642c  centiles_method,
+0001b980: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001b990: 2020 2020 2020 2065 6c69 6620 6973 5f74         elif is_t
+0001b9a0: 696d 6564 656c 7461 3634 5f64 7479 7065  imedelta64_dtype
+0001b9b0: 2864 6174 612e 5f6d 6574 6129 3a0a 2020  (data._meta):.  
+0001b9c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001b9d0: 2073 656c 662e 5f64 6573 6372 6962 655f   self._describe_
+0001b9e0: 6e75 6d65 7269 6328 0a20 2020 2020 2020  numeric(.       
+0001b9f0: 2020 2020 2020 2020 2064 6174 612e 6472           data.dr
+0001ba00: 6f70 6e61 2829 2c0a 2020 2020 2020 2020  opna(),.        
+0001ba10: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+0001ba20: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
+0001ba30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ba40: 2070 6572 6365 6e74 696c 6573 3d70 6572   percentiles=per
+0001ba50: 6365 6e74 696c 6573 2c0a 2020 2020 2020  centiles,.      
+0001ba60: 2020 2020 2020 2020 2020 7065 7263 656e            percen
+0001ba70: 7469 6c65 735f 6d65 7468 6f64 3d70 6572  tiles_method=per
+0001ba80: 6365 6e74 696c 6573 5f6d 6574 686f 642c  centiles_method,
+0001ba90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001baa0: 2069 735f 7469 6d65 6465 6c74 615f 636f   is_timedelta_co
+0001bab0: 6c75 6d6e 3d54 7275 652c 0a20 2020 2020  lumn=True,.     
+0001bac0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001bad0: 2065 6c69 6620 6973 5f64 6174 6574 696d   elif is_datetim
+0001bae0: 6536 345f 616e 795f 6474 7970 6528 6461  e64_any_dtype(da
+0001baf0: 7461 2e5f 6d65 7461 2920 616e 6420 6461  ta._meta) and da
+0001bb00: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
+0001bb10: 633a 0a20 2020 2020 2020 2020 2020 2072  c:.            r
+0001bb20: 6574 7572 6e20 7365 6c66 2e5f 6465 7363  eturn self._desc
+0001bb30: 7269 6265 5f6e 756d 6572 6963 280a 2020  ribe_numeric(.  
+0001bb40: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0001bb50: 7461 2e64 726f 706e 6128 292c 0a20 2020  ta.dropna(),.   
+0001bb60: 2020 2020 2020 2020 2020 2020 2073 706c               spl
+0001bb70: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+0001bb80: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
+0001bb90: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
+0001bba0: 733d 7065 7263 656e 7469 6c65 732c 0a20  s=percentiles,. 
+0001bbb0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001bbc0: 6572 6365 6e74 696c 6573 5f6d 6574 686f  ercentiles_metho
+0001bbd0: 643d 7065 7263 656e 7469 6c65 735f 6d65  d=percentiles_me
+0001bbe0: 7468 6f64 2c0a 2020 2020 2020 2020 2020  thod,.          
+0001bbf0: 2020 2020 2020 6973 5f64 6174 6574 696d        is_datetim
+0001bc00: 655f 636f 6c75 6d6e 3d54 7275 652c 0a20  e_column=True,. 
+0001bc10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001bc20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001bc30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001bc40: 6c66 2e5f 6465 7363 7269 6265 5f6e 6f6e  lf._describe_non
+0001bc50: 6e75 6d65 7269 635f 3164 280a 2020 2020  numeric_1d(.    
+0001bc60: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0001bc70: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
+0001bc80: 6c69 745f 6576 6572 792c 2064 6174 6574  lit_every, datet
+0001bc90: 696d 655f 6973 5f6e 756d 6572 6963 3d64  ime_is_numeric=d
+0001bca0: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
+0001bcb0: 6963 0a20 2020 2020 2020 2020 2020 2029  ic.            )
+0001bcc0: 0a0a 2020 2020 6465 6620 5f64 6573 6372  ..    def _descr
+0001bcd0: 6962 655f 6e75 6d65 7269 6328 0a20 2020  ibe_numeric(.   
+0001bce0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0001bcf0: 2020 2064 6174 612c 0a20 2020 2020 2020     data,.       
+0001bd00: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+0001bd10: 7365 2c0a 2020 2020 2020 2020 7065 7263  se,.        perc
+0001bd20: 656e 7469 6c65 733d 4e6f 6e65 2c0a 2020  entiles=None,.  
+0001bd30: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
+0001bd40: 735f 6d65 7468 6f64 3d22 6465 6661 756c  s_method="defaul
+0001bd50: 7422 2c0a 2020 2020 2020 2020 6973 5f74  t",.        is_t
+0001bd60: 696d 6564 656c 7461 5f63 6f6c 756d 6e3d  imedelta_column=
+0001bd70: 4661 6c73 652c 0a20 2020 2020 2020 2069  False,.        i
+0001bd80: 735f 6461 7465 7469 6d65 5f63 6f6c 756d  s_datetime_colum
+0001bd90: 6e3d 4661 6c73 652c 0a20 2020 2029 3a0a  n=False,.    ):.
+0001bda0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
+0001bdb0: 6b2e 6461 7461 6672 616d 652e 6e75 6d65  k.dataframe.nume
+0001bdc0: 7269 6320 696d 706f 7274 2074 6f5f 6e75  ric import to_nu
+0001bdd0: 6d65 7269 630a 0a20 2020 2020 2020 2069  meric..        i
+0001bde0: 6620 6973 5f74 696d 6564 656c 7461 5f63  f is_timedelta_c
+0001bdf0: 6f6c 756d 6e20 6f72 2069 735f 6461 7465  olumn or is_date
+0001be00: 7469 6d65 5f63 6f6c 756d 6e3a 0a20 2020  time_column:.   
+0001be10: 2020 2020 2020 2020 206e 756d 203d 2074           num = t
+0001be20: 6f5f 6e75 6d65 7269 6328 6461 7461 290a  o_numeric(data).
+0001be30: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001be40: 2020 2020 2020 2020 2020 6e75 6d20 3d20            num = 
+0001be50: 6461 7461 2e5f 6765 745f 6e75 6d65 7269  data._get_numeri
+0001be60: 635f 6461 7461 2829 0a0a 2020 2020 2020  c_data()..      
+0001be70: 2020 6966 2064 6174 612e 6e64 696d 203d    if data.ndim =
+0001be80: 3d20 3220 616e 6420 6c65 6e28 6e75 6d2e  = 2 and len(num.
+0001be90: 636f 6c75 6d6e 7329 203d 3d20 303a 0a20  columns) == 0:. 
+0001bea0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0001beb0: 2056 616c 7565 4572 726f 7228 2244 6174   ValueError("Dat
+0001bec0: 6146 7261 6d65 2063 6f6e 7461 696e 7320  aFrame contains 
+0001bed0: 6f6e 6c79 206e 6f6e 2d6e 756d 6572 6963  only non-numeric
+0001bee0: 2064 6174 612e 2229 0a20 2020 2020 2020   data.").       
+0001bef0: 2065 6c69 6620 6461 7461 2e6e 6469 6d20   elif data.ndim 
+0001bf00: 3d3d 2031 2061 6e64 2064 6174 612e 6474  == 1 and data.dt
+0001bf10: 7970 6520 3d3d 2022 6f62 6a65 6374 223a  ype == "object":
+0001bf20: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0001bf30: 7365 2056 616c 7565 4572 726f 7228 2243  se ValueError("C
+0001bf40: 616e 6e6f 7420 636f 6d70 7574 6520 6060  annot compute ``
+0001bf50: 6465 7363 7269 6265 6060 206f 6e20 6f62  describe`` on ob
+0001bf60: 6a65 6374 2064 7479 7065 2e22 290a 2020  ject dtype.").  
+0001bf70: 2020 2020 2020 6966 2070 6572 6365 6e74        if percent
+0001bf80: 696c 6573 2069 7320 4e6f 6e65 3a0a 2020  iles is None:.  
+0001bf90: 2020 2020 2020 2020 2020 7065 7263 656e            percen
+0001bfa0: 7469 6c65 7320 3d20 5b30 2e32 352c 2030  tiles = [0.25, 0
+0001bfb0: 2e35 2c20 302e 3735 5d0a 2020 2020 2020  .5, 0.75].      
+0001bfc0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001bfd0: 2020 2020 2320 616c 7761 7973 2069 6e63      # always inc
+0001bfe0: 6c75 6465 2074 6865 2074 6865 2035 3025  lude the the 50%
+0001bff0: 746c 6520 746f 2063 616c 6375 6c61 7465  tle to calculate
+0001c000: 2074 6865 206d 6564 6961 6e0a 2020 2020   the median.    
+0001c010: 2020 2020 2020 2020 2320 756e 6971 7565          # unique
+0001c020: 2072 656d 6f76 6573 2064 7570 6c69 6361   removes duplica
+0001c030: 7465 7320 616e 6420 736f 7274 7320 7175  tes and sorts qu
+0001c040: 616e 7469 6c65 730a 2020 2020 2020 2020  antiles.        
+0001c050: 2020 2020 7065 7263 656e 7469 6c65 7320      percentiles 
+0001c060: 3d20 6e70 2e61 7272 6179 2870 6572 6365  = np.array(perce
+0001c070: 6e74 696c 6573 290a 2020 2020 2020 2020  ntiles).        
+0001c080: 2020 2020 7065 7263 656e 7469 6c65 7320      percentiles 
+0001c090: 3d20 6e70 2e61 7070 656e 6428 7065 7263  = np.append(perc
+0001c0a0: 656e 7469 6c65 732c 2030 2e35 290a 2020  entiles, 0.5).  
+0001c0b0: 2020 2020 2020 2020 2020 7065 7263 656e            percen
+0001c0c0: 7469 6c65 7320 3d20 6e70 2e75 6e69 7175  tiles = np.uniqu
+0001c0d0: 6528 7065 7263 656e 7469 6c65 7329 0a20  e(percentiles). 
+0001c0e0: 2020 2020 2020 2020 2020 2070 6572 6365             perce
+0001c0f0: 6e74 696c 6573 203d 206c 6973 7428 7065  ntiles = list(pe
+0001c100: 7263 656e 7469 6c65 7329 0a20 2020 2020  rcentiles).     
+0001c110: 2020 2073 7461 7473 203d 205b 0a20 2020     stats = [.   
+0001c120: 2020 2020 2020 2020 206e 756d 2e63 6f75           num.cou
+0001c130: 6e74 2873 706c 6974 5f65 7665 7279 3d73  nt(split_every=s
+0001c140: 706c 6974 5f65 7665 7279 292c 0a20 2020  plit_every),.   
+0001c150: 2020 2020 2020 2020 206e 756d 2e6d 6561           num.mea
+0001c160: 6e28 7370 6c69 745f 6576 6572 793d 7370  n(split_every=sp
+0001c170: 6c69 745f 6576 6572 7929 2c0a 2020 2020  lit_every),.    
+0001c180: 2020 2020 2020 2020 6e75 6d2e 7374 6428          num.std(
+0001c190: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+0001c1a0: 745f 6576 6572 7929 2c0a 2020 2020 2020  t_every),.      
+0001c1b0: 2020 2020 2020 6e75 6d2e 6d69 6e28 7370        num.min(sp
+0001c1c0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+0001c1d0: 6576 6572 7929 2c0a 2020 2020 2020 2020  every),.        
+0001c1e0: 2020 2020 6e75 6d2e 7175 616e 7469 6c65      num.quantile
+0001c1f0: 2870 6572 6365 6e74 696c 6573 2c20 6d65  (percentiles, me
+0001c200: 7468 6f64 3d70 6572 6365 6e74 696c 6573  thod=percentiles
+0001c210: 5f6d 6574 686f 6429 2c0a 2020 2020 2020  _method),.      
+0001c220: 2020 2020 2020 6e75 6d2e 6d61 7828 7370        num.max(sp
+0001c230: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+0001c240: 6576 6572 7929 2c0a 2020 2020 2020 2020  every),.        
+0001c250: 5d0a 2020 2020 2020 2020 7374 6174 735f  ].        stats_
+0001c260: 6e61 6d65 7320 3d20 5b28 732e 5f6e 616d  names = [(s._nam
+0001c270: 652c 2030 2920 666f 7220 7320 696e 2073  e, 0) for s in s
+0001c280: 7461 7473 5d0a 0a20 2020 2020 2020 2063  tats]..        c
+0001c290: 6f6c 6e61 6d65 203d 2064 6174 612e 5f6d  olname = data._m
+0001c2a0: 6574 612e 6e61 6d65 2069 6620 6973 5f73  eta.name if is_s
+0001c2b0: 6572 6965 735f 6c69 6b65 2864 6174 612e  eries_like(data.
+0001c2c0: 5f6d 6574 6129 2065 6c73 6520 4e6f 6e65  _meta) else None
+0001c2d0: 0a0a 2020 2020 2020 2020 6e61 6d65 203d  ..        name =
+0001c2e0: 2022 6465 7363 7269 6265 2d6e 756d 6572   "describe-numer
+0001c2f0: 6963 2d2d 2220 2b20 746f 6b65 6e69 7a65  ic--" + tokenize
+0001c300: 286e 756d 2c20 7370 6c69 745f 6576 6572  (num, split_ever
+0001c310: 7929 0a20 2020 2020 2020 206c 6179 6572  y).        layer
+0001c320: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+0001c330: 2028 6e61 6d65 2c20 3029 3a20 280a 2020   (name, 0): (.  
+0001c340: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0001c350: 7468 6f64 732e 6465 7363 7269 6265 5f6e  thods.describe_n
+0001c360: 756d 6572 6963 5f61 6767 7265 6761 7465  umeric_aggregate
+0001c370: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c380: 2020 7374 6174 735f 6e61 6d65 732c 0a20    stats_names,. 
+0001c390: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0001c3a0: 6f6c 6e61 6d65 2c0a 2020 2020 2020 2020  olname,.        
+0001c3b0: 2020 2020 2020 2020 6973 5f74 696d 6564          is_timed
+0001c3c0: 656c 7461 5f63 6f6c 756d 6e2c 0a20 2020  elta_column,.   
+0001c3d0: 2020 2020 2020 2020 2020 2020 2069 735f               is_
+0001c3e0: 6461 7465 7469 6d65 5f63 6f6c 756d 6e2c  datetime_column,
+0001c3f0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001c400: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0001c410: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+0001c420: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+0001c430: 6c65 6374 696f 6e73 286e 616d 652c 206c  lections(name, l
+0001c440: 6179 6572 2c20 6465 7065 6e64 656e 6369  ayer, dependenci
+0001c450: 6573 3d73 7461 7473 290a 2020 2020 2020  es=stats).      
+0001c460: 2020 6d65 7461 203d 206e 756d 2e5f 6d65    meta = num._me
+0001c470: 7461 5f6e 6f6e 656d 7074 792e 6465 7363  ta_nonempty.desc
+0001c480: 7269 6265 2829 0a20 2020 2020 2020 2072  ribe().        r
+0001c490: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
+0001c4a0: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
+0001c4b0: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
+0001c4c0: 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d29 0a0a  =[None, None])..
+0001c4d0: 2020 2020 6465 6620 5f64 6573 6372 6962      def _describ
+0001c4e0: 655f 6e6f 6e6e 756d 6572 6963 5f31 6428  e_nonnumeric_1d(
+0001c4f0: 0a20 2020 2020 2020 2073 656c 662c 2064  .        self, d
+0001c500: 6174 612c 2073 706c 6974 5f65 7665 7279  ata, split_every
+0001c510: 3d46 616c 7365 2c20 6461 7465 7469 6d65  =False, datetime
+0001c520: 5f69 735f 6e75 6d65 7269 633d 4661 6c73  _is_numeric=Fals
+0001c530: 650a 2020 2020 293a 0a20 2020 2020 2020  e.    ):.       
+0001c540: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+0001c550: 7261 6d65 2e6e 756d 6572 6963 2069 6d70  rame.numeric imp
+0001c560: 6f72 7420 746f 5f6e 756d 6572 6963 0a0a  ort to_numeric..
+0001c570: 2020 2020 2020 2020 7663 6f75 6e74 7320          vcounts 
+0001c580: 3d20 6461 7461 2e76 616c 7565 5f63 6f75  = data.value_cou
+0001c590: 6e74 7328 7370 6c69 745f 6576 6572 793d  nts(split_every=
+0001c5a0: 7370 6c69 745f 6576 6572 7929 0a20 2020  split_every).   
+0001c5b0: 2020 2020 2063 6f75 6e74 5f6e 6f6e 7a65       count_nonze
+0001c5c0: 726f 203d 2076 636f 756e 7473 5b76 636f  ro = vcounts[vco
+0001c5d0: 756e 7473 2021 3d20 305d 0a20 2020 2020  unts != 0].     
+0001c5e0: 2020 2063 6f75 6e74 5f75 6e69 7175 6520     count_unique 
+0001c5f0: 3d20 636f 756e 745f 6e6f 6e7a 6572 6f2e  = count_nonzero.
+0001c600: 7369 7a65 0a0a 2020 2020 2020 2020 7374  size..        st
+0001c610: 6174 7320 3d20 5b0a 2020 2020 2020 2020  ats = [.        
+0001c620: 2020 2020 2320 6e75 6e69 7175 650a 2020      # nunique.  
+0001c630: 2020 2020 2020 2020 2020 636f 756e 745f            count_
+0001c640: 756e 6971 7565 2c0a 2020 2020 2020 2020  unique,.        
+0001c650: 2020 2020 2320 636f 756e 740a 2020 2020      # count.    
+0001c660: 2020 2020 2020 2020 6461 7461 2e63 6f75          data.cou
+0001c670: 6e74 2873 706c 6974 5f65 7665 7279 3d73  nt(split_every=s
+0001c680: 706c 6974 5f65 7665 7279 292c 0a20 2020  plit_every),.   
+0001c690: 2020 2020 2020 2020 2023 206d 6f73 7420           # most 
+0001c6a0: 636f 6d6d 6f6e 2076 616c 7565 0a20 2020  common value.   
+0001c6b0: 2020 2020 2020 2020 2076 636f 756e 7473           vcounts
+0001c6c0: 2e5f 6865 6164 2831 2c20 6e70 6172 7469  ._head(1, nparti
+0001c6d0: 7469 6f6e 733d 312c 2063 6f6d 7075 7465  tions=1, compute
+0001c6e0: 3d46 616c 7365 2c20 7361 6665 3d46 616c  =False, safe=Fal
+0001c6f0: 7365 292c 0a20 2020 2020 2020 205d 0a0a  se),.        ]..
+0001c700: 2020 2020 2020 2020 6966 2069 735f 6461          if is_da
+0001c710: 7465 7469 6d65 3634 5f61 6e79 5f64 7479  tetime64_any_dty
+0001c720: 7065 2864 6174 612e 5f6d 6574 6129 2061  pe(data._meta) a
+0001c730: 6e64 206e 6f74 2064 6174 6574 696d 655f  nd not datetime_
+0001c740: 6973 5f6e 756d 6572 6963 3a0a 2020 2020  is_numeric:.    
+0001c750: 2020 2020 2020 2020 6d69 6e5f 7473 203d          min_ts =
+0001c760: 2074 6f5f 6e75 6d65 7269 6328 6461 7461   to_numeric(data
+0001c770: 2e64 726f 706e 6128 2929 2e6d 696e 2873  .dropna()).min(s
+0001c780: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+0001c790: 5f65 7665 7279 290a 2020 2020 2020 2020  _every).        
+0001c7a0: 2020 2020 6d61 785f 7473 203d 2074 6f5f      max_ts = to_
+0001c7b0: 6e75 6d65 7269 6328 6461 7461 2e64 726f  numeric(data.dro
+0001c7c0: 706e 6128 2929 2e6d 6178 2873 706c 6974  pna()).max(split
+0001c7d0: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+0001c7e0: 7279 290a 2020 2020 2020 2020 2020 2020  ry).            
+0001c7f0: 7374 6174 732e 6578 7465 6e64 285b 6d69  stats.extend([mi
+0001c800: 6e5f 7473 2c20 6d61 785f 7473 5d29 0a0a  n_ts, max_ts])..
+0001c810: 2020 2020 2020 2020 7374 6174 735f 6e61          stats_na
+0001c820: 6d65 7320 3d20 5b28 732e 5f6e 616d 652c  mes = [(s._name,
+0001c830: 2030 2920 666f 7220 7320 696e 2073 7461   0) for s in sta
+0001c840: 7473 5d0a 2020 2020 2020 2020 636f 6c6e  ts].        coln
+0001c850: 616d 6520 3d20 6461 7461 2e5f 6d65 7461  ame = data._meta
+0001c860: 2e6e 616d 650a 0a20 2020 2020 2020 206e  .name..        n
+0001c870: 616d 6520 3d20 2264 6573 6372 6962 652d  ame = "describe-
+0001c880: 6e6f 6e6e 756d 6572 6963 2d31 642d 2d22  nonnumeric-1d--"
+0001c890: 202b 2074 6f6b 656e 697a 6528 6461 7461   + tokenize(data
+0001c8a0: 2c20 7370 6c69 745f 6576 6572 7929 0a20  , split_every). 
+0001c8b0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
+0001c8c0: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
+0001c8d0: 6d65 2c20 3029 3a20 286d 6574 686f 6473  me, 0): (methods
+0001c8e0: 2e64 6573 6372 6962 655f 6e6f 6e6e 756d  .describe_nonnum
+0001c8f0: 6572 6963 5f61 6767 7265 6761 7465 2c20  eric_aggregate, 
+0001c900: 7374 6174 735f 6e61 6d65 732c 2063 6f6c  stats_names, col
+0001c910: 6e61 6d65 290a 2020 2020 2020 2020 7d0a  name).        }.
+0001c920: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
+0001c930: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
+0001c940: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
+0001c950: 6e61 6d65 2c20 6c61 7965 722c 2064 6570  name, layer, dep
+0001c960: 656e 6465 6e63 6965 733d 7374 6174 7329  endencies=stats)
+0001c970: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0001c980: 2050 414e 4441 535f 4754 5f32 3030 3a0a   PANDAS_GT_200:.
+0001c990: 2020 2020 2020 2020 2020 2020 6461 7465              date
+0001c9a0: 7469 6d65 5f69 735f 6e75 6d65 7269 635f  time_is_numeric_
+0001c9b0: 6b77 6172 6720 3d20 7b22 6461 7465 7469  kwarg = {"dateti
+0001c9c0: 6d65 5f69 735f 6e75 6d65 7269 6322 3a20  me_is_numeric": 
+0001c9d0: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
+0001c9e0: 7269 637d 0a20 2020 2020 2020 2065 6c73  ric}.        els
+0001c9f0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+0001ca00: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
+0001ca10: 6963 5f6b 7761 7267 203d 207b 7d0a 2020  ic_kwarg = {}.  
+0001ca20: 2020 2020 2020 6d65 7461 203d 2064 6174        meta = dat
+0001ca30: 612e 5f6d 6574 615f 6e6f 6e65 6d70 7479  a._meta_nonempty
+0001ca40: 2e64 6573 6372 6962 6528 2a2a 6461 7465  .describe(**date
+0001ca50: 7469 6d65 5f69 735f 6e75 6d65 7269 635f  time_is_numeric_
+0001ca60: 6b77 6172 6729 0a20 2020 2020 2020 2072  kwarg).        r
+0001ca70: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
+0001ca80: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
+0001ca90: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
+0001caa0: 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d29 0a0a  =[None, None])..
+0001cab0: 2020 2020 6465 6620 5f63 756d 5f61 6767      def _cum_agg
+0001cac0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+0001cad0: 6f70 5f6e 616d 652c 2063 6875 6e6b 2c20  op_name, chunk, 
+0001cae0: 6167 6772 6567 6174 652c 2061 7869 732c  aggregate, axis,
+0001caf0: 2073 6b69 706e 613d 5472 7565 2c20 6368   skipna=True, ch
+0001cb00: 756e 6b5f 6b77 6172 6773 3d4e 6f6e 652c  unk_kwargs=None,
+0001cb10: 206f 7574 3d4e 6f6e 650a 2020 2020 293a   out=None.    ):
+0001cb20: 0a20 2020 2020 2020 2022 2222 5772 6170  .        """Wrap
+0001cb30: 7065 7220 666f 7220 6375 6d75 6c61 7469  per for cumulati
+0001cb40: 7665 206f 7065 7261 7469 6f6e 2222 220a  ve operation""".
+0001cb50: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
+0001cb60: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
+0001cb70: 7869 7328 6178 6973 290a 0a20 2020 2020  xis(axis)..     
+0001cb80: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
+0001cb90: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+0001cba0: 6520 3d20 6622 7b73 656c 662e 5f74 6f6b  e = f"{self._tok
+0001cbb0: 656e 5f70 7265 6669 787d 7b6f 705f 6e61  en_prefix}{op_na
+0001cbc0: 6d65 7d28 6178 6973 3d31 2922 0a20 2020  me}(axis=1)".   
+0001cbd0: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+0001cbe0: 3d20 7365 6c66 2e6d 6170 5f70 6172 7469  = self.map_parti
+0001cbf0: 7469 6f6e 7328 6368 756e 6b2c 2074 6f6b  tions(chunk, tok
+0001cc00: 656e 3d6e 616d 652c 202a 2a63 6875 6e6b  en=name, **chunk
+0001cc10: 5f6b 7761 7267 7329 0a20 2020 2020 2020  _kwargs).       
+0001cc20: 2020 2020 2072 6574 7572 6e20 6861 6e64       return hand
+0001cc30: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
+0001cc40: 6c74 290a 2020 2020 2020 2020 656c 7365  lt).        else
+0001cc50: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0001cc60: 6375 6d75 6c61 7465 2065 6163 6820 7061  cumulate each pa
+0001cc70: 7274 6974 696f 6e73 0a20 2020 2020 2020  rtitions.       
+0001cc80: 2020 2020 206e 616d 6531 203d 2066 227b       name1 = f"{
+0001cc90: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
+0001cca0: 6978 7d7b 6f70 5f6e 616d 657d 2d6d 6170  ix}{op_name}-map
+0001ccb0: 220a 2020 2020 2020 2020 2020 2020 6375  ".            cu
+0001ccc0: 6d70 6172 7420 3d20 6d61 705f 7061 7274  mpart = map_part
+0001ccd0: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+0001cce0: 2020 2020 2020 2020 6368 756e 6b2c 2073          chunk, s
+0001ccf0: 656c 662c 2074 6f6b 656e 3d6e 616d 6531  elf, token=name1
+0001cd00: 2c20 6d65 7461 3d73 656c 662c 202a 2a63  , meta=self, **c
+0001cd10: 6875 6e6b 5f6b 7761 7267 730a 2020 2020  hunk_kwargs.    
+0001cd20: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0001cd30: 2020 2020 2020 206e 616d 6532 203d 2066         name2 = f
+0001cd40: 227b 7365 6c66 2e5f 746f 6b65 6e5f 7072  "{self._token_pr
+0001cd50: 6566 6978 7d7b 6f70 5f6e 616d 657d 2d74  efix}{op_name}-t
+0001cd60: 616b 652d 6c61 7374 220a 2020 2020 2020  ake-last".      
+0001cd70: 2020 2020 2020 6375 6d6c 6173 7420 3d20        cumlast = 
+0001cd80: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+0001cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cda0: 5f74 616b 655f 6c61 7374 2c0a 2020 2020  _take_last,.    
+0001cdb0: 2020 2020 2020 2020 2020 2020 6375 6d70              cump
+0001cdc0: 6172 742c 0a20 2020 2020 2020 2020 2020  art,.           
+0001cdd0: 2020 2020 2073 6b69 706e 612c 0a20 2020       skipna,.   
+0001cde0: 2020 2020 2020 2020 2020 2020 206d 6574               met
+0001cdf0: 613d 6d65 7461 5f73 6572 6965 735f 636f  a=meta_series_co
+0001ce00: 6e73 7472 7563 746f 7228 7365 6c66 2928  nstructor(self)(
+0001ce10: 5b5d 2c20 6474 7970 653d 2266 6c6f 6174  [], dtype="float
+0001ce20: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+0001ce30: 2020 2020 746f 6b65 6e3d 6e61 6d65 322c      token=name2,
+0001ce40: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0001ce50: 2020 2020 2020 2020 2020 2020 7375 6666              suff
+0001ce60: 6978 203d 2074 6f6b 656e 697a 6528 7365  ix = tokenize(se
+0001ce70: 6c66 290a 2020 2020 2020 2020 2020 2020  lf).            
+0001ce80: 6e61 6d65 203d 2066 227b 7365 6c66 2e5f  name = f"{self._
+0001ce90: 746f 6b65 6e5f 7072 6566 6978 7d7b 6f70  token_prefix}{op
+0001cea0: 5f6e 616d 657d 2d7b 7375 6666 6978 7d22  _name}-{suffix}"
+0001ceb0: 0a20 2020 2020 2020 2020 2020 2063 6e61  .            cna
+0001cec0: 6d65 203d 2066 227b 7365 6c66 2e5f 746f  me = f"{self._to
+0001ced0: 6b65 6e5f 7072 6566 6978 7d7b 6f70 5f6e  ken_prefix}{op_n
+0001cee0: 616d 657d 2d63 756d 2d6c 6173 742d 7b73  ame}-cum-last-{s
+0001cef0: 7566 6669 787d 220a 0a20 2020 2020 2020  uffix}"..       
+0001cf00: 2020 2020 2023 2061 6767 7265 6761 7465       # aggregate
+0001cf10: 2063 756d 756c 6174 6564 2070 6172 7469   cumulated parti
+0001cf20: 7369 6f6e 7320 616e 6420 6974 7320 7072  sions and its pr
+0001cf30: 6576 696f 7573 206c 6173 7420 656c 656d  evious last elem
+0001cf40: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
+0001cf50: 6c61 7965 7220 3d20 7b7d 0a20 2020 2020  layer = {}.     
+0001cf60: 2020 2020 2020 206c 6179 6572 5b28 6e61         layer[(na
+0001cf70: 6d65 2c20 3029 5d20 3d20 2863 756d 7061  me, 0)] = (cumpa
+0001cf80: 7274 2e5f 6e61 6d65 2c20 3029 0a0a 2020  rt._name, 0)..  
+0001cf90: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
+0001cfa0: 696e 2072 616e 6765 2831 2c20 7365 6c66  in range(1, self
+0001cfb0: 2e6e 7061 7274 6974 696f 6e73 293a 0a20  .npartitions):. 
+0001cfc0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0001cfd0: 2073 746f 7265 2065 6163 6820 6375 6d75   store each cumu
+0001cfe0: 6c61 7469 7665 2073 7465 7020 746f 2067  lative step to g
+0001cff0: 7261 7068 2074 6f20 7265 6475 6365 2063  raph to reduce c
+0001d000: 6f6d 7075 7461 7469 6f6e 0a20 2020 2020  omputation.     
+0001d010: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
+0001d020: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+0001d030: 2020 2020 2020 2020 2020 6c61 7965 725b            layer[
+0001d040: 2863 6e61 6d65 2c20 6929 5d20 3d20 2863  (cname, i)] = (c
+0001d050: 756d 6c61 7374 2e5f 6e61 6d65 2c20 6920  umlast._name, i 
+0001d060: 2d20 3129 0a20 2020 2020 2020 2020 2020  - 1).           
+0001d070: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001d080: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0001d090: 2061 6767 7265 6761 7465 2077 6974 6820   aggregate with 
+0001d0a0: 7072 6576 696f 7573 2063 756d 756c 6174  previous cumulat
+0001d0b0: 696f 6e20 7265 7375 6c74 730a 2020 2020  ion results.    
 0001d0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d0d0: 2020 2020 2020 6167 6772 6567 6174 652c        aggregate,
-0001d0e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d0f0: 2020 2020 2020 2020 2028 636e 616d 652c           (cname,
-0001d100: 2069 202d 2031 292c 0a20 2020 2020 2020   i - 1),.       
-0001d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d120: 2028 6375 6d6c 6173 742e 5f6e 616d 652c   (cumlast._name,
-0001d130: 2069 202d 2031 292c 0a20 2020 2020 2020   i - 1),.       
-0001d140: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0001d150: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0001d160: 6179 6572 5b28 6e61 6d65 2c20 6929 5d20  ayer[(name, i)] 
-0001d170: 3d20 2861 6767 7265 6761 7465 2c20 2863  = (aggregate, (c
-0001d180: 756d 7061 7274 2e5f 6e61 6d65 2c20 6929  umpart._name, i)
-0001d190: 2c20 2863 6e61 6d65 2c20 6929 290a 2020  , (cname, i)).  
-0001d1a0: 2020 2020 2020 2020 2020 6772 6170 6820            graph 
-0001d1b0: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-0001d1c0: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-0001d1d0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-0001d1e0: 2020 206e 616d 652c 206c 6179 6572 2c20     name, layer, 
-0001d1f0: 6465 7065 6e64 656e 6369 6573 3d5b 6375  dependencies=[cu
-0001d200: 6d70 6172 742c 2063 756d 6c61 7374 5d0a  mpart, cumlast].
-0001d210: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001d220: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-0001d230: 203d 206e 6577 5f64 645f 6f62 6a65 6374   = new_dd_object
-0001d240: 2867 7261 7068 2c20 6e61 6d65 2c20 6368  (graph, name, ch
-0001d250: 756e 6b28 7365 6c66 2e5f 6d65 7461 292c  unk(self._meta),
-0001d260: 2073 656c 662e 6469 7669 7369 6f6e 7329   self.divisions)
-0001d270: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001d280: 7572 6e20 6861 6e64 6c65 5f6f 7574 286f  urn handle_out(o
-0001d290: 7574 2c20 7265 7375 6c74 290a 0a20 2020  ut, result)..   
-0001d2a0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0001d2b0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0001d2c0: 2064 6566 2063 756d 7375 6d28 7365 6c66   def cumsum(self
-0001d2d0: 2c20 6178 6973 3d4e 6f6e 652c 2073 6b69  , axis=None, ski
-0001d2e0: 706e 613d 5472 7565 2c20 6474 7970 653d  pna=True, dtype=
-0001d2f0: 4e6f 6e65 2c20 6f75 743d 4e6f 6e65 293a  None, out=None):
-0001d300: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001d310: 7365 6c66 2e5f 6375 6d5f 6167 6728 0a20  self._cum_agg(. 
-0001d320: 2020 2020 2020 2020 2020 2022 6375 6d73             "cums
-0001d330: 756d 222c 0a20 2020 2020 2020 2020 2020  um",.           
-0001d340: 2063 6875 6e6b 3d4d 2e63 756d 7375 6d2c   chunk=M.cumsum,
-0001d350: 0a20 2020 2020 2020 2020 2020 2061 6767  .            agg
-0001d360: 7265 6761 7465 3d6d 6574 686f 6473 2e63  regate=methods.c
-0001d370: 756d 7375 6d5f 6167 6772 6567 6174 652c  umsum_aggregate,
-0001d380: 0a20 2020 2020 2020 2020 2020 2061 7869  .            axi
-0001d390: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
-0001d3a0: 2020 2020 736b 6970 6e61 3d73 6b69 706e      skipna=skipn
-0001d3b0: 612c 0a20 2020 2020 2020 2020 2020 2063  a,.            c
-0001d3c0: 6875 6e6b 5f6b 7761 7267 733d 6469 6374  hunk_kwargs=dict
-0001d3d0: 2861 7869 733d 6178 6973 2c20 736b 6970  (axis=axis, skip
-0001d3e0: 6e61 3d73 6b69 706e 6129 2c0a 2020 2020  na=skipna),.    
-0001d3f0: 2020 2020 2020 2020 6f75 743d 6f75 742c          out=out,
-0001d400: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0001d410: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-0001d420: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-0001d430: 6465 6620 6375 6d70 726f 6428 7365 6c66  def cumprod(self
-0001d440: 2c20 6178 6973 3d4e 6f6e 652c 2073 6b69  , axis=None, ski
-0001d450: 706e 613d 5472 7565 2c20 6474 7970 653d  pna=True, dtype=
-0001d460: 4e6f 6e65 2c20 6f75 743d 4e6f 6e65 293a  None, out=None):
-0001d470: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001d480: 7365 6c66 2e5f 6375 6d5f 6167 6728 0a20  self._cum_agg(. 
-0001d490: 2020 2020 2020 2020 2020 2022 6375 6d70             "cump
-0001d4a0: 726f 6422 2c0a 2020 2020 2020 2020 2020  rod",.          
-0001d4b0: 2020 6368 756e 6b3d 4d2e 6375 6d70 726f    chunk=M.cumpro
-0001d4c0: 642c 0a20 2020 2020 2020 2020 2020 2061  d,.            a
-0001d4d0: 6767 7265 6761 7465 3d6d 6574 686f 6473  ggregate=methods
-0001d4e0: 2e63 756d 7072 6f64 5f61 6767 7265 6761  .cumprod_aggrega
-0001d4f0: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
-0001d500: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
-0001d510: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
-0001d520: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
-0001d530: 2020 6368 756e 6b5f 6b77 6172 6773 3d64    chunk_kwargs=d
-0001d540: 6963 7428 6178 6973 3d61 7869 732c 2073  ict(axis=axis, s
-0001d550: 6b69 706e 613d 736b 6970 6e61 292c 0a20  kipna=skipna),. 
-0001d560: 2020 2020 2020 2020 2020 206f 7574 3d6f             out=o
-0001d570: 7574 2c0a 2020 2020 2020 2020 290a 0a20  ut,.        ).. 
-0001d580: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0001d590: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0001d5a0: 2020 2064 6566 2063 756d 6d61 7828 7365     def cummax(se
-0001d5b0: 6c66 2c20 6178 6973 3d4e 6f6e 652c 2073  lf, axis=None, s
-0001d5c0: 6b69 706e 613d 5472 7565 2c20 6f75 743d  kipna=True, out=
-0001d5d0: 4e6f 6e65 293a 0a20 2020 2020 2020 2072  None):.        r
-0001d5e0: 6574 7572 6e20 7365 6c66 2e5f 6375 6d5f  eturn self._cum_
-0001d5f0: 6167 6728 0a20 2020 2020 2020 2020 2020  agg(.           
-0001d600: 2022 6375 6d6d 6178 222c 0a20 2020 2020   "cummax",.     
-0001d610: 2020 2020 2020 2063 6875 6e6b 3d4d 2e63         chunk=M.c
-0001d620: 756d 6d61 782c 0a20 2020 2020 2020 2020  ummax,.         
-0001d630: 2020 2061 6767 7265 6761 7465 3d6d 6574     aggregate=met
-0001d640: 686f 6473 2e63 756d 6d61 785f 6167 6772  hods.cummax_aggr
-0001d650: 6567 6174 652c 0a20 2020 2020 2020 2020  egate,.         
-0001d660: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
-0001d670: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
-0001d680: 3d73 6b69 706e 612c 0a20 2020 2020 2020  =skipna,.       
-0001d690: 2020 2020 2063 6875 6e6b 5f6b 7761 7267       chunk_kwarg
-0001d6a0: 733d 6469 6374 2861 7869 733d 6178 6973  s=dict(axis=axis
-0001d6b0: 2c20 736b 6970 6e61 3d73 6b69 706e 6129  , skipna=skipna)
-0001d6c0: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
-0001d6d0: 743d 6f75 742c 0a20 2020 2020 2020 2029  t=out,.        )
-0001d6e0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0001d6f0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0001d700: 290a 2020 2020 6465 6620 6375 6d6d 696e  ).    def cummin
-0001d710: 2873 656c 662c 2061 7869 733d 4e6f 6e65  (self, axis=None
-0001d720: 2c20 736b 6970 6e61 3d54 7275 652c 206f  , skipna=True, o
-0001d730: 7574 3d4e 6f6e 6529 3a0a 2020 2020 2020  ut=None):.      
-0001d740: 2020 7265 7475 726e 2073 656c 662e 5f63    return self._c
-0001d750: 756d 5f61 6767 280a 2020 2020 2020 2020  um_agg(.        
-0001d760: 2020 2020 2263 756d 6d69 6e22 2c0a 2020      "cummin",.  
-0001d770: 2020 2020 2020 2020 2020 6368 756e 6b3d            chunk=
-0001d780: 4d2e 6375 6d6d 696e 2c0a 2020 2020 2020  M.cummin,.      
-0001d790: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
-0001d7a0: 6d65 7468 6f64 732e 6375 6d6d 696e 5f61  methods.cummin_a
-0001d7b0: 6767 7265 6761 7465 2c0a 2020 2020 2020  ggregate,.      
-0001d7c0: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
-0001d7d0: 0a20 2020 2020 2020 2020 2020 2073 6b69  .            ski
-0001d7e0: 706e 613d 736b 6970 6e61 2c0a 2020 2020  pna=skipna,.    
-0001d7f0: 2020 2020 2020 2020 6368 756e 6b5f 6b77          chunk_kw
-0001d800: 6172 6773 3d64 6963 7428 6178 6973 3d61  args=dict(axis=a
-0001d810: 7869 732c 2073 6b69 706e 613d 736b 6970  xis, skipna=skip
-0001d820: 6e61 292c 0a20 2020 2020 2020 2020 2020  na),.           
-0001d830: 206f 7574 3d6f 7574 2c0a 2020 2020 2020   out=out,.      
-0001d840: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
-0001d850: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-0001d860: 616d 6529 0a20 2020 2064 6566 2077 6865  ame).    def whe
-0001d870: 7265 2873 656c 662c 2063 6f6e 642c 206f  re(self, cond, o
-0001d880: 7468 6572 3d6e 702e 6e61 6e29 3a0a 2020  ther=np.nan):.  
-0001d890: 2020 2020 2020 2320 636f 6e64 2061 6e64        # cond and
-0001d8a0: 206f 7468 6572 206d 6179 2062 6520 6461   other may be da
-0001d8b0: 736b 2069 6e73 7461 6e63 652c 0a20 2020  sk instance,.   
-0001d8c0: 2020 2020 2023 2070 6173 7369 6e67 206d       # passing m
-0001d8d0: 6170 5f70 6172 7469 7469 6f6e 7320 7669  ap_partitions vi
-0001d8e0: 6120 6b65 7977 6f72 6420 7769 6c6c 206e  a keyword will n
-0001d8f0: 6f74 2062 6520 616c 6967 6e65 640a 2020  ot be aligned.  
-0001d900: 2020 2020 2020 7265 7475 726e 206d 6170        return map
-0001d910: 5f70 6172 7469 7469 6f6e 7328 4d2e 7768  _partitions(M.wh
-0001d920: 6572 652c 2073 656c 662c 2063 6f6e 642c  ere, self, cond,
-0001d930: 206f 7468 6572 2c20 656e 666f 7263 655f   other, enforce_
-0001d940: 6d65 7461 6461 7461 3d46 616c 7365 290a  metadata=False).
-0001d950: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0001d960: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0001d970: 0a20 2020 2064 6566 206d 6173 6b28 7365  .    def mask(se
-0001d980: 6c66 2c20 636f 6e64 2c20 6f74 6865 723d  lf, cond, other=
-0001d990: 6e70 2e6e 616e 293a 0a20 2020 2020 2020  np.nan):.       
-0001d9a0: 2072 6574 7572 6e20 6d61 705f 7061 7274   return map_part
-0001d9b0: 6974 696f 6e73 284d 2e6d 6173 6b2c 2073  itions(M.mask, s
-0001d9c0: 656c 662c 2063 6f6e 642c 206f 7468 6572  elf, cond, other
-0001d9d0: 2c20 656e 666f 7263 655f 6d65 7461 6461  , enforce_metada
-0001d9e0: 7461 3d46 616c 7365 290a 0a20 2020 2040  ta=False)..    @
-0001d9f0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0001da00: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0001da10: 6566 206e 6f74 6e75 6c6c 2873 656c 6629  ef notnull(self)
-0001da20: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0001da30: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-0001da40: 696f 6e73 284d 2e6e 6f74 6e75 6c6c 2c20  ions(M.notnull, 
-0001da50: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-0001da60: 3d46 616c 7365 290a 0a20 2020 2040 6465  =False)..    @de
-0001da70: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0001da80: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0001da90: 2069 736e 756c 6c28 7365 6c66 293a 0a20   isnull(self):. 
-0001daa0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001dab0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-0001dac0: 7328 4d2e 6973 6e75 6c6c 2c20 656e 666f  s(M.isnull, enfo
-0001dad0: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
-0001dae0: 7365 290a 0a20 2020 2040 6465 7269 7665  se)..    @derive
-0001daf0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-0001db00: 616d 6529 0a20 2020 2064 6566 2069 736e  ame).    def isn
-0001db10: 6128 7365 6c66 293a 0a20 2020 2020 2020  a(self):.       
-0001db20: 2069 6620 6861 7361 7474 7228 7064 2c20   if hasattr(pd, 
-0001db30: 2269 736e 6122 293a 0a20 2020 2020 2020  "isna"):.       
-0001db40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001db50: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-0001db60: 4d2e 6973 6e61 2c20 656e 666f 7263 655f  M.isna, enforce_
-0001db70: 6d65 7461 6461 7461 3d46 616c 7365 290a  metadata=False).
-0001db80: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001db90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001dba0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-0001dbb0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0001dbc0: 2020 2020 2022 4e65 6564 206d 6f72 6520       "Need more 
-0001dbd0: 7265 6365 6e74 2076 6572 7369 6f6e 206f  recent version o
-0001dbe0: 6620 5061 6e64 6173 2022 0a20 2020 2020  f Pandas ".     
-0001dbf0: 2020 2020 2020 2020 2020 2022 746f 2073             "to s
-0001dc00: 7570 706f 7274 2069 736e 612e 2022 0a20  upport isna. ". 
-0001dc10: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001dc20: 506c 6561 7365 2075 7365 2069 736e 756c  Please use isnul
-0001dc30: 6c20 696e 7374 6561 642e 220a 2020 2020  l instead.".    
-0001dc40: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-0001dc50: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0001dc60: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0001dc70: 6566 2069 7369 6e28 7365 6c66 2c20 7661  ef isin(self, va
-0001dc80: 6c75 6573 293a 0a20 2020 2020 2020 2069  lues):.        i
-0001dc90: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
-0001dca0: 696b 6528 7365 6c66 2e5f 6d65 7461 293a  ike(self._meta):
-0001dcb0: 0a20 2020 2020 2020 2020 2020 2023 2044  .            # D
-0001dcc0: 6174 6146 7261 6d65 2e69 7369 6e20 646f  ataFrame.isin do
-0001dcd0: 6573 2077 6569 7264 2061 6c69 676e 6d65  es weird alignme
-0001dce0: 6e74 2073 7475 6666 0a20 2020 2020 2020  nt stuff.       
-0001dcf0: 2020 2020 2062 6164 5f74 7970 6573 203d       bad_types =
-0001dd00: 2028 5f46 7261 6d65 2c20 7064 2e53 6572   (_Frame, pd.Ser
-0001dd10: 6965 732c 2070 642e 4461 7461 4672 616d  ies, pd.DataFram
-0001dd20: 6529 0a20 2020 2020 2020 2065 6c73 653a  e).        else:
-0001dd30: 0a20 2020 2020 2020 2020 2020 2062 6164  .            bad
-0001dd40: 5f74 7970 6573 203d 2028 5f46 7261 6d65  _types = (_Frame
-0001dd50: 2c29 0a20 2020 2020 2020 2069 6620 6973  ,).        if is
-0001dd60: 696e 7374 616e 6365 2876 616c 7565 732c  instance(values,
-0001dd70: 2062 6164 5f74 7970 6573 293a 0a20 2020   bad_types):.   
-0001dd80: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0001dd90: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0001dda0: 6f72 2822 5061 7373 696e 6720 6120 2572  or("Passing a %r
-0001ddb0: 2074 6f20 6069 7369 6e60 2220 2520 7479   to `isin`" % ty
-0001ddc0: 7065 6e61 6d65 2874 7970 6528 7661 6c75  pename(type(valu
-0001ddd0: 6573 2929 290a 2020 2020 2020 2020 6d65  es))).        me
-0001dde0: 7461 203d 2073 656c 662e 5f6d 6574 615f  ta = self._meta_
-0001ddf0: 6e6f 6e65 6d70 7479 2e69 7369 6e28 7661  nonempty.isin(va
-0001de00: 6c75 6573 290a 2020 2020 2020 2020 2320  lues).        # 
-0001de10: 5765 2077 7261 7020 7661 6c75 6573 2069  We wrap values i
-0001de20: 6e20 6120 6465 6c61 7965 6420 666f 7220  n a delayed for 
-0001de30: 7477 6f20 7265 6173 6f6e 733a 0a20 2020  two reasons:.   
-0001de40: 2020 2020 2023 202d 2061 766f 6964 2073       # - avoid s
-0001de50: 6572 6961 6c69 7a69 6e67 2064 6174 6120  erializing data 
-0001de60: 696e 2065 7665 7279 2074 6173 6b0a 2020  in every task.  
-0001de70: 2020 2020 2020 2320 2d20 6176 6f69 6420        # - avoid 
-0001de80: 636f 7374 206f 6620 7472 6176 6572 7361  cost of traversa
-0001de90: 6c20 6f66 206c 6172 6765 206c 6973 7420  l of large list 
-0001dea0: 696e 206f 7074 696d 697a 6174 696f 6e73  in optimizations
-0001deb0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0001dec0: 7374 616e 6365 2876 616c 7565 732c 206c  stance(values, l
-0001ded0: 6973 7429 3a0a 2020 2020 2020 2020 2020  ist):.          
-0001dee0: 2020 2320 4d6f 7469 7661 7465 6420 6279    # Motivated by
-0001def0: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
-0001df00: 636f 6d2f 6461 736b 2f64 6173 6b2f 6973  com/dask/dask/is
-0001df10: 7375 6573 2f39 3431 312e 2020 5468 6973  sues/9411.  This
-0001df20: 2061 7070 6561 7273 2074 6f20 6265 0a20   appears to be. 
-0001df30: 2020 2020 2020 2020 2020 2023 2063 6175             # cau
-0001df40: 7365 6420 6279 2068 7474 7073 3a2f 2f67  sed by https://g
-0001df50: 6974 6875 622e 636f 6d2f 6461 736b 2f64  ithub.com/dask/d
-0001df60: 6973 7472 6962 7574 6564 2f69 7373 7565  istributed/issue
-0001df70: 732f 3633 3638 2c20 616e 6420 6675 7274  s/6368, and furt
-0001df80: 6865 720a 2020 2020 2020 2020 2020 2020  her.            
-0001df90: 2320 6578 6163 6572 6261 7465 6420 6279  # exacerbated by
-0001dfa0: 2074 6865 2066 6163 7420 7468 6174 2074   the fact that t
-0001dfb0: 6865 206c 6973 7420 636f 6e74 6169 6e73  he list contains
-0001dfc0: 2064 7570 6c69 6361 7465 732e 2020 5468   duplicates.  Th
-0001dfd0: 6973 2069 7320 6120 7061 7463 6820 756e  is is a patch un
-0001dfe0: 7469 6c0a 2020 2020 2020 2020 2020 2020  til.            
-0001dff0: 2320 7765 2063 616e 2063 7265 6174 6520  # we can create 
-0001e000: 6120 6265 7474 6572 2066 6978 2066 6f72  a better fix for
-0001e010: 2053 6572 6961 6c69 7a61 7469 6f6e 2e0a   Serialization..
-0001e020: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-0001e030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e040: 2076 616c 7565 7320 3d20 6c69 7374 2873   values = list(s
-0001e050: 6574 2876 616c 7565 7329 290a 2020 2020  et(values)).    
-0001e060: 2020 2020 2020 2020 6578 6365 7074 2054          except T
-0001e070: 7970 6545 7272 6f72 3a0a 2020 2020 2020  ypeError:.      
-0001e080: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
-0001e090: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-0001e0a0: 7420 616e 7928 6973 5f64 6173 6b5f 636f  t any(is_dask_co
-0001e0b0: 6c6c 6563 7469 6f6e 2876 2920 666f 7220  llection(v) for 
-0001e0c0: 7620 696e 2076 616c 7565 7329 3a0a 2020  v in values):.  
-0001e0d0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-0001e0e0: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-0001e0f0: 2020 2020 2020 2076 616c 7565 7320 3d20         values = 
-0001e100: 6e70 2e66 726f 6d69 7465 7228 7661 6c75  np.fromiter(valu
-0001e110: 6573 2c20 6474 7970 653d 6f62 6a65 6374  es, dtype=object
-0001e120: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001e130: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
-0001e140: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-0001e150: 2020 2020 2020 2020 2023 204e 756d 7079           # Numpy
-0001e160: 2031 2e32 3320 7375 7070 6f72 7473 2063   1.23 supports c
-0001e170: 7265 6174 696e 6720 6172 7261 7973 206f  reating arrays o
-0001e180: 6620 6974 6572 6162 6c65 732c 2077 6869  f iterables, whi
-0001e190: 6c65 206c 6f77 6572 0a20 2020 2020 2020  le lower.       
-0001e1a0: 2020 2020 2020 2020 2020 2020 2023 2076               # v
-0001e1b0: 6572 7369 6f6e 2031 2e32 312e 7820 616e  ersion 1.21.x an
-0001e1c0: 6420 312e 3232 2e78 2064 6f20 6e6f 740a  d 1.22.x do not.
-0001e1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e1e0: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
-0001e1f0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-0001e200: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-0001e210: 2020 2020 2020 2020 204d 2e69 7369 6e2c           M.isin,
-0001e220: 2064 656c 6179 6564 2876 616c 7565 7329   delayed(values)
-0001e230: 2c20 6d65 7461 3d6d 6574 612c 2065 6e66  , meta=meta, enf
-0001e240: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-0001e250: 6c73 650a 2020 2020 2020 2020 290a 0a20  lse.        ).. 
-0001e260: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0001e270: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0001e280: 2020 2064 6566 2061 7374 7970 6528 7365     def astype(se
-0001e290: 6c66 2c20 6474 7970 6529 3a0a 2020 2020  lf, dtype):.    
-0001e2a0: 2020 2020 2320 5858 583a 2050 616e 6461      # XXX: Panda
-0001e2b0: 7320 7769 6c6c 2073 6567 6661 756c 7420  s will segfault 
-0001e2c0: 666f 7220 656d 7074 7920 6461 7461 6672  for empty datafr
-0001e2d0: 616d 6573 2077 6865 6e20 7365 7474 696e  ames when settin
-0001e2e0: 670a 2020 2020 2020 2020 2320 6361 7465  g.        # cate
-0001e2f0: 676f 7269 6361 6c20 6474 7970 6573 2e20  gorical dtypes. 
-0001e300: 5468 6973 206f 7065 7261 7469 6f6e 2069  This operation i
-0001e310: 736e 2774 2061 6c6c 6f77 6564 2063 7572  sn't allowed cur
-0001e320: 7265 6e74 6c79 2061 6e79 7761 792e 2057  rently anyway. W
-0001e330: 650a 2020 2020 2020 2020 2320 6765 7420  e.        # get 
-0001e340: 7468 6520 6d65 7461 6461 7461 2077 6974  the metadata wit
-0001e350: 6820 6120 6e6f 6e2d 656d 7074 7920 6672  h a non-empty fr
-0001e360: 616d 6520 746f 2074 6872 6f77 2074 6865  ame to throw the
-0001e370: 2065 7272 6f72 2069 6e73 7465 6164 206f   error instead o
-0001e380: 660a 2020 2020 2020 2020 2320 7365 6766  f.        # segf
-0001e390: 6175 6c74 696e 672e 0a20 2020 2020 2020  aulting..       
-0001e3a0: 2069 6620 6973 5f64 6174 6166 7261 6d65   if is_dataframe
-0001e3b0: 5f6c 696b 6528 7365 6c66 2e5f 6d65 7461  _like(self._meta
-0001e3c0: 2920 616e 6420 6973 5f63 6174 6567 6f72  ) and is_categor
-0001e3d0: 6963 616c 5f64 7479 7065 2864 7479 7065  ical_dtype(dtype
-0001e3e0: 293a 0a20 2020 2020 2020 2020 2020 206d  ):.            m
-0001e3f0: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
-0001e400: 5f6e 6f6e 656d 7074 792e 6173 7479 7065  _nonempty.astype
-0001e410: 2864 7479 7065 290a 2020 2020 2020 2020  (dtype).        
-0001e420: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001e430: 2020 6d65 7461 203d 2073 656c 662e 5f6d    meta = self._m
-0001e440: 6574 612e 6173 7479 7065 2864 7479 7065  eta.astype(dtype
-0001e450: 290a 2020 2020 2020 2020 6966 2068 6173  ).        if has
-0001e460: 6174 7472 2864 7479 7065 2c20 2269 7465  attr(dtype, "ite
-0001e470: 6d73 2229 3a0a 2020 2020 2020 2020 2020  ms"):.          
-0001e480: 2020 7365 745f 756e 6b6e 6f77 6e20 3d20    set_unknown = 
-0001e490: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0001e4a0: 2020 6b0a 2020 2020 2020 2020 2020 2020    k.            
-0001e4b0: 2020 2020 666f 7220 6b2c 2076 2069 6e20      for k, v in 
-0001e4c0: 6474 7970 652e 6974 656d 7328 290a 2020  dtype.items().  
-0001e4d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001e4e0: 2069 735f 6361 7465 676f 7269 6361 6c5f   is_categorical_
-0001e4f0: 6474 7970 6528 7629 2061 6e64 2067 6574  dtype(v) and get
-0001e500: 6174 7472 2876 2c20 2263 6174 6567 6f72  attr(v, "categor
-0001e510: 6965 7322 2c20 4e6f 6e65 2920 6973 204e  ies", None) is N
-0001e520: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-0001e530: 5d0a 2020 2020 2020 2020 2020 2020 6d65  ].            me
-0001e540: 7461 203d 2063 6c65 6172 5f6b 6e6f 776e  ta = clear_known
-0001e550: 5f63 6174 6567 6f72 6965 7328 6d65 7461  _categories(meta
-0001e560: 2c20 636f 6c73 3d73 6574 5f75 6e6b 6e6f  , cols=set_unkno
-0001e570: 776e 290a 2020 2020 2020 2020 656c 6966  wn).        elif
-0001e580: 2069 735f 6361 7465 676f 7269 6361 6c5f   is_categorical_
-0001e590: 6474 7970 6528 6474 7970 6529 2061 6e64  dtype(dtype) and
-0001e5a0: 2067 6574 6174 7472 2864 7479 7065 2c20   getattr(dtype, 
-0001e5b0: 2263 6174 6567 6f72 6965 7322 2c20 4e6f  "categories", No
-0001e5c0: 6e65 2920 6973 204e 6f6e 653a 0a20 2020  ne) is None:.   
-0001e5d0: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-0001e5e0: 636c 6561 725f 6b6e 6f77 6e5f 6361 7465  clear_known_cate
-0001e5f0: 676f 7269 6573 286d 6574 6129 0a20 2020  gories(meta).   
-0001e600: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001e610: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-0001e620: 0a20 2020 2020 2020 2020 2020 204d 2e61  .            M.a
-0001e630: 7374 7970 652c 2064 7479 7065 3d64 7479  stype, dtype=dty
-0001e640: 7065 2c20 6d65 7461 3d6d 6574 612c 2065  pe, meta=meta, e
-0001e650: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
-0001e660: 4661 6c73 650a 2020 2020 2020 2020 290a  False.        ).
-0001e670: 0a20 2020 2069 6620 6e6f 7420 5041 4e44  .    if not PAND
-0001e680: 4153 5f47 545f 3230 303a 0a0a 2020 2020  AS_GT_200:..    
-0001e690: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0001e6a0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-0001e6b0: 2020 2020 2064 6566 2061 7070 656e 6428       def append(
-0001e6c0: 7365 6c66 2c20 6f74 6865 722c 2069 6e74  self, other, int
-0001e6d0: 6572 6c65 6176 655f 7061 7274 6974 696f  erleave_partitio
-0001e6e0: 6e73 3d46 616c 7365 293a 0a20 2020 2020  ns=False):.     
-0001e6f0: 2020 2020 2020 2069 6620 5041 4e44 4153         if PANDAS
-0001e700: 5f47 545f 3134 303a 0a20 2020 2020 2020  _GT_140:.       
-0001e710: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
-0001e720: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
-0001e730: 2020 2020 2020 2020 2020 2020 2254 6865              "The
-0001e740: 2066 7261 6d65 2e61 7070 656e 6420 6d65   frame.append me
-0001e750: 7468 6f64 2069 7320 6465 7072 6563 6174  thod is deprecat
-0001e760: 6564 2061 6e64 2077 696c 6c20 6265 2072  ed and will be r
-0001e770: 656d 6f76 6564 2066 726f 6d22 0a20 2020  emoved from".   
-0001e780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e790: 2022 6461 736b 2069 6e20 6120 6675 7475   "dask in a futu
-0001e7a0: 7265 2076 6572 7369 6f6e 2e20 5573 6520  re version. Use 
-0001e7b0: 6461 736b 2e64 6174 6166 7261 6d65 2e63  dask.dataframe.c
-0001e7c0: 6f6e 6361 7420 696e 7374 6561 642e 222c  oncat instead.",
-0001e7d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e7e0: 2020 2020 2046 7574 7572 6557 6172 6e69       FutureWarni
-0001e7f0: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
-0001e800: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0001e810: 2020 2320 6265 6361 7573 6520 4461 7461    # because Data
-0001e820: 4672 616d 652e 6170 7065 6e64 2077 696c  Frame.append wil
-0001e830: 6c20 6f76 6572 7269 6465 2074 6865 206d  l override the m
-0001e840: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
-0001e850: 2020 2023 2077 7261 7020 6279 2070 642e     # wrap by pd.
-0001e860: 5365 7269 6573 2e61 7070 656e 6420 646f  Series.append do
-0001e870: 6373 7472 696e 670a 2020 2020 2020 2020  cstring.        
-0001e880: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-0001e890: 7461 6672 616d 652e 6d75 6c74 6920 696d  taframe.multi im
-0001e8a0: 706f 7274 2063 6f6e 6361 740a 0a20 2020  port concat..   
-0001e8b0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-0001e8c0: 7374 616e 6365 286f 7468 6572 2c20 286c  stance(other, (l
-0001e8d0: 6973 742c 2064 6963 7429 293a 0a20 2020  ist, dict)):.   
-0001e8e0: 2020 2020 2020 2020 2020 2020 206d 7367               msg
-0001e8f0: 203d 2022 6170 7065 6e64 2064 6f65 736e   = "append doesn
-0001e900: 2774 2073 7570 706f 7274 206c 6973 7420  't support list 
-0001e910: 6f72 2064 6963 7420 696e 7075 7422 0a20  or dict input". 
-0001e920: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001e930: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-0001e940: 7465 6445 7272 6f72 286d 7367 290a 0a20  tedError(msg).. 
-0001e950: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001e960: 6e20 636f 6e63 6174 280a 2020 2020 2020  n concat(.      
-0001e970: 2020 2020 2020 2020 2020 5b73 656c 662c            [self,
-0001e980: 206f 7468 6572 5d2c 206a 6f69 6e3d 226f   other], join="o
-0001e990: 7574 6572 222c 2069 6e74 6572 6c65 6176  uter", interleav
-0001e9a0: 655f 7061 7274 6974 696f 6e73 3d69 6e74  e_partitions=int
-0001e9b0: 6572 6c65 6176 655f 7061 7274 6974 696f  erleave_partitio
-0001e9c0: 6e73 0a20 2020 2020 2020 2020 2020 2029  ns.            )
-0001e9d0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0001e9e0: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-0001e9f0: 2020 2064 6566 2064 6f74 2873 656c 662c     def dot(self,
-0001ea00: 206f 7468 6572 2c20 6d65 7461 3d6e 6f5f   other, meta=no_
-0001ea10: 6465 6661 756c 7429 3a0a 2020 2020 2020  default):.      
-0001ea20: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-0001ea30: 6e63 6528 6f74 6865 722c 205f 4672 616d  nce(other, _Fram
-0001ea40: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-0001ea50: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-0001ea60: 2254 6865 2073 6563 6f6e 6420 6f70 6572  "The second oper
-0001ea70: 616e 6420 6d75 7374 2062 6520 6120 6461  and must be a da
-0001ea80: 736b 2061 7272 6179 206f 7220 6461 736b  sk array or dask
-0001ea90: 2064 6174 6166 7261 6d65 2229 0a0a 2020   dataframe")..  
-0001eaa0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0001eab0: 6e63 6528 6f74 6865 722c 2044 6174 6146  nce(other, DataF
-0001eac0: 7261 6d65 293a 0a20 2020 2020 2020 2020  rame):.         
-0001ead0: 2020 2073 203d 2073 656c 662e 6d61 705f     s = self.map_
-0001eae0: 7061 7274 6974 696f 6e73 284d 2e64 6f74  partitions(M.dot
-0001eaf0: 2c20 6f74 6865 722c 2074 6f6b 656e 3d22  , other, token="
-0001eb00: 646f 7422 2c20 6d65 7461 3d6d 6574 6129  dot", meta=meta)
-0001eb10: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001eb20: 7572 6e20 732e 6772 6f75 7062 7928 6279  urn s.groupby(by
-0001eb30: 3d73 2e69 6e64 6578 292e 6170 706c 7928  =s.index).apply(
-0001eb40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001eb50: 206c 616d 6264 6120 783a 2078 2e73 756d   lambda x: x.sum
-0001eb60: 2873 6b69 706e 613d 4661 6c73 6529 2c20  (skipna=False), 
-0001eb70: 6d65 7461 3d73 2e5f 6d65 7461 5f6e 6f6e  meta=s._meta_non
-0001eb80: 656d 7074 790a 2020 2020 2020 2020 2020  empty.          
-0001eb90: 2020 290a 0a20 2020 2020 2020 2064 6566    )..        def
-0001eba0: 205f 646f 745f 7365 7269 6573 282a 6172   _dot_series(*ar
-0001ebb0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-0001ebc0: 2020 2020 2020 2020 2020 2023 202e 7375             # .su
-0001ebd0: 6d28 2920 6973 2069 6e76 6f6b 6564 206f  m() is invoked o
-0001ebe0: 6e20 6561 6368 2070 6172 7469 7469 6f6e  n each partition
-0001ebf0: 2062 6566 6f72 6520 6265 696e 6720 6170   before being ap
-0001ec00: 706c 6965 6420 746f 2061 6c6c 0a20 2020  plied to all.   
-0001ec10: 2020 2020 2020 2020 2023 2070 6172 7469           # parti
-0001ec20: 7469 6f6e 732e 2054 6865 2072 6574 7572  tions. The retur
-0001ec30: 6e20 7479 7065 2069 7320 6578 7065 6374  n type is expect
-0001ec40: 6564 2074 6f20 6265 2061 2073 6572 6965  ed to be a serie
-0001ec50: 732c 206e 6f74 2061 206e 756d 7079 206f  s, not a numpy o
-0001ec60: 626a 6563 740a 2020 2020 2020 2020 2020  bject.          
-0001ec70: 2020 7265 7475 726e 206d 6574 615f 7365    return meta_se
-0001ec80: 7269 6573 5f63 6f6e 7374 7275 6374 6f72  ries_constructor
-0001ec90: 2873 656c 6629 284d 2e64 6f74 282a 6172  (self)(M.dot(*ar
-0001eca0: 6773 2c20 2a2a 6b77 6172 6773 2929 0a0a  gs, **kwargs))..
-0001ecb0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001ecc0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-0001ecd0: 6e73 285f 646f 745f 7365 7269 6573 2c20  ns(_dot_series, 
-0001ece0: 6f74 6865 722c 2074 6f6b 656e 3d22 646f  other, token="do
-0001ecf0: 7422 2c20 6d65 7461 3d6d 6574 6129 2e73  t", meta=meta).s
-0001ed00: 756d 280a 2020 2020 2020 2020 2020 2020  um(.            
-0001ed10: 736b 6970 6e61 3d46 616c 7365 0a20 2020  skipna=False.   
-0001ed20: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
-0001ed30: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-0001ed40: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-0001ed50: 616c 6967 6e28 7365 6c66 2c20 6f74 6865  align(self, othe
-0001ed60: 722c 206a 6f69 6e3d 226f 7574 6572 222c  r, join="outer",
-0001ed70: 2061 7869 733d 4e6f 6e65 2c20 6669 6c6c   axis=None, fill
-0001ed80: 5f76 616c 7565 3d4e 6f6e 6529 3a0a 2020  _value=None):.  
-0001ed90: 2020 2020 2020 6d65 7461 312c 206d 6574        meta1, met
-0001eda0: 6132 203d 205f 656d 756c 6174 6528 0a20  a2 = _emulate(. 
-0001edb0: 2020 2020 2020 2020 2020 204d 2e61 6c69             M.ali
-0001edc0: 676e 2c20 7365 6c66 2c20 6f74 6865 722c  gn, self, other,
-0001edd0: 206a 6f69 6e2c 2061 7869 733d 6178 6973   join, axis=axis
-0001ede0: 2c20 6669 6c6c 5f76 616c 7565 3d66 696c  , fill_value=fil
-0001edf0: 6c5f 7661 6c75 650a 2020 2020 2020 2020  l_value.        
-0001ee00: 290a 2020 2020 2020 2020 616c 6967 6e65  ).        aligne
-0001ee10: 6420 3d20 7365 6c66 2e6d 6170 5f70 6172  d = self.map_par
-0001ee20: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
-0001ee30: 2020 2020 204d 2e61 6c69 676e 2c0a 2020       M.align,.  
-0001ee40: 2020 2020 2020 2020 2020 6f74 6865 722c            other,
-0001ee50: 0a20 2020 2020 2020 2020 2020 206a 6f69  .            joi
-0001ee60: 6e3d 6a6f 696e 2c0a 2020 2020 2020 2020  n=join,.        
-0001ee70: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
-0001ee80: 2020 2020 2020 2020 2020 2066 696c 6c5f             fill_
-0001ee90: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
-0001eea0: 2c0a 2020 2020 2020 2020 2020 2020 656e  ,.            en
-0001eeb0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
-0001eec0: 616c 7365 2c0a 2020 2020 2020 2020 290a  alse,.        ).
-0001eed0: 0a20 2020 2020 2020 2074 6f6b 656e 203d  .        token =
-0001eee0: 2074 6f6b 656e 697a 6528 7365 6c66 2c20   tokenize(self, 
-0001eef0: 6f74 6865 722c 206a 6f69 6e2c 2061 7869  other, join, axi
-0001ef00: 732c 2066 696c 6c5f 7661 6c75 6529 0a0a  s, fill_value)..
-0001ef10: 2020 2020 2020 2020 6e61 6d65 3120 3d20          name1 = 
-0001ef20: 2261 6c69 676e 312d 2220 2b20 746f 6b65  "align1-" + toke
-0001ef30: 6e0a 2020 2020 2020 2020 6473 6b31 203d  n.        dsk1 =
-0001ef40: 207b 0a20 2020 2020 2020 2020 2020 2028   {.            (
-0001ef50: 6e61 6d65 312c 2069 293a 2028 6765 7469  name1, i): (geti
-0001ef60: 7465 6d2c 206b 6579 2c20 3029 0a20 2020  tem, key, 0).   
-0001ef70: 2020 2020 2020 2020 2066 6f72 2069 2c20           for i, 
-0001ef80: 6b65 7920 696e 2065 6e75 6d65 7261 7465  key in enumerate
-0001ef90: 2861 6c69 676e 6564 2e5f 5f64 6173 6b5f  (aligned.__dask_
-0001efa0: 6b65 7973 5f5f 2829 290a 2020 2020 2020  keys__()).      
-0001efb0: 2020 7d0a 2020 2020 2020 2020 6473 6b31    }.        dsk1
-0001efc0: 2e75 7064 6174 6528 616c 6967 6e65 642e  .update(aligned.
-0001efd0: 6461 736b 290a 2020 2020 2020 2020 7265  dask).        re
-0001efe0: 7375 6c74 3120 3d20 6e65 775f 6464 5f6f  sult1 = new_dd_o
-0001eff0: 626a 6563 7428 6473 6b31 2c20 6e61 6d65  bject(dsk1, name
-0001f000: 312c 206d 6574 6131 2c20 616c 6967 6e65  1, meta1, aligne
-0001f010: 642e 6469 7669 7369 6f6e 7329 0a0a 2020  d.divisions)..  
-0001f020: 2020 2020 2020 6e61 6d65 3220 3d20 2261        name2 = "a
-0001f030: 6c69 676e 322d 2220 2b20 746f 6b65 6e0a  lign2-" + token.
-0001f040: 2020 2020 2020 2020 6473 6b32 203d 207b          dsk2 = {
-0001f050: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
-0001f060: 6d65 322c 2069 293a 2028 6765 7469 7465  me2, i): (getite
-0001f070: 6d2c 206b 6579 2c20 3129 0a20 2020 2020  m, key, 1).     
-0001f080: 2020 2020 2020 2066 6f72 2069 2c20 6b65         for i, ke
-0001f090: 7920 696e 2065 6e75 6d65 7261 7465 2861  y in enumerate(a
-0001f0a0: 6c69 676e 6564 2e5f 5f64 6173 6b5f 6b65  ligned.__dask_ke
-0001f0b0: 7973 5f5f 2829 290a 2020 2020 2020 2020  ys__()).        
-0001f0c0: 7d0a 2020 2020 2020 2020 6473 6b32 2e75  }.        dsk2.u
-0001f0d0: 7064 6174 6528 616c 6967 6e65 642e 6461  pdate(aligned.da
-0001f0e0: 736b 290a 2020 2020 2020 2020 7265 7375  sk).        resu
-0001f0f0: 6c74 3220 3d20 6e65 775f 6464 5f6f 626a  lt2 = new_dd_obj
-0001f100: 6563 7428 6473 6b32 2c20 6e61 6d65 322c  ect(dsk2, name2,
-0001f110: 206d 6574 6132 2c20 616c 6967 6e65 642e   meta2, aligned.
-0001f120: 6469 7669 7369 6f6e 7329 0a0a 2020 2020  divisions)..    
-0001f130: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-0001f140: 7431 2c20 7265 7375 6c74 320a 0a20 2020  t1, result2..   
-0001f150: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0001f160: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0001f170: 2064 6566 2063 6f6d 6269 6e65 2873 656c   def combine(sel
-0001f180: 662c 206f 7468 6572 2c20 6675 6e63 2c20  f, other, func, 
-0001f190: 6669 6c6c 5f76 616c 7565 3d4e 6f6e 652c  fill_value=None,
-0001f1a0: 206f 7665 7277 7269 7465 3d54 7275 6529   overwrite=True)
-0001f1b0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0001f1c0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-0001f1d0: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
-0001f1e0: 2020 4d2e 636f 6d62 696e 652c 206f 7468    M.combine, oth
-0001f1f0: 6572 2c20 6675 6e63 2c20 6669 6c6c 5f76  er, func, fill_v
-0001f200: 616c 7565 3d66 696c 6c5f 7661 6c75 652c  alue=fill_value,
-0001f210: 206f 7665 7277 7269 7465 3d6f 7665 7277   overwrite=overw
-0001f220: 7269 7465 0a20 2020 2020 2020 2029 0a0a  rite.        )..
-0001f230: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0001f240: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-0001f250: 2020 2020 6465 6620 636f 6d62 696e 655f      def combine_
-0001f260: 6669 7273 7428 7365 6c66 2c20 6f74 6865  first(self, othe
-0001f270: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
-0001f280: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-0001f290: 6974 696f 6e73 284d 2e63 6f6d 6269 6e65  itions(M.combine
-0001f2a0: 5f66 6972 7374 2c20 6f74 6865 7229 0a0a  _first, other)..
-0001f2b0: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-0001f2c0: 0a20 2020 2064 6566 205f 6269 6e64 5f6f  .    def _bind_o
-0001f2d0: 7065 7261 746f 725f 6d65 7468 6f64 2863  perator_method(c
-0001f2e0: 6c73 2c20 6e61 6d65 2c20 6f70 2c20 6f72  ls, name, op, or
-0001f2f0: 6967 696e 616c 3d70 642e 4461 7461 4672  iginal=pd.DataFr
-0001f300: 616d 6529 3a0a 2020 2020 2020 2020 2222  ame):.        ""
-0001f310: 2262 696e 6420 6f70 6572 6174 6f72 206d  "bind operator m
-0001f320: 6574 686f 6420 6c69 6b65 2044 6174 6146  ethod like DataF
-0001f330: 7261 6d65 2e61 6464 2074 6f20 7468 6973  rame.add to this
-0001f340: 2063 6c61 7373 2222 220a 2020 2020 2020   class""".      
-0001f350: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-0001f360: 6d65 6e74 6564 4572 726f 720a 0a20 2020  mentedError..   
-0001f370: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0001f380: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0001f390: 2064 6566 2072 6573 616d 706c 6528 7365   def resample(se
-0001f3a0: 6c66 2c20 7275 6c65 2c20 636c 6f73 6564  lf, rule, closed
-0001f3b0: 3d4e 6f6e 652c 206c 6162 656c 3d4e 6f6e  =None, label=Non
-0001f3c0: 6529 3a0a 2020 2020 2020 2020 6672 6f6d  e):.        from
-0001f3d0: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
-0001f3e0: 7473 6572 6965 732e 7265 7361 6d70 6c65  tseries.resample
-0001f3f0: 2069 6d70 6f72 7420 5265 7361 6d70 6c65   import Resample
-0001f400: 720a 0a20 2020 2020 2020 2072 6574 7572  r..        retur
-0001f410: 6e20 5265 7361 6d70 6c65 7228 7365 6c66  n Resampler(self
-0001f420: 2c20 7275 6c65 2c20 636c 6f73 6564 3d63  , rule, closed=c
-0001f430: 6c6f 7365 642c 206c 6162 656c 3d6c 6162  losed, label=lab
-0001f440: 656c 290a 0a20 2020 2040 6465 7269 7665  el)..    @derive
-0001f450: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-0001f460: 616d 6529 0a20 2020 2064 6566 2066 6972  ame).    def fir
-0001f470: 7374 2873 656c 662c 206f 6666 7365 7429  st(self, offset)
-0001f480: 3a0a 2020 2020 2020 2020 2320 4c65 7420  :.        # Let 
-0001f490: 7061 6e64 6173 2065 7272 6f72 206f 6e20  pandas error on 
-0001f4a0: 6261 6420 6172 6773 0a20 2020 2020 2020  bad args.       
-0001f4b0: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
-0001f4c0: 6d70 7479 2e66 6972 7374 286f 6666 7365  mpty.first(offse
-0001f4d0: 7429 0a0a 2020 2020 2020 2020 6966 206e  t)..        if n
-0001f4e0: 6f74 2073 656c 662e 6b6e 6f77 6e5f 6469  ot self.known_di
-0001f4f0: 7669 7369 6f6e 733a 0a20 2020 2020 2020  visions:.       
-0001f500: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0001f510: 4572 726f 7228 2260 6669 7273 7460 2069  Error("`first` i
-0001f520: 7320 6e6f 7420 696d 706c 656d 656e 7465  s not implemente
-0001f530: 6420 666f 7220 756e 6b6e 6f77 6e20 6469  d for unknown di
-0001f540: 7669 7369 6f6e 7322 290a 0a20 2020 2020  visions")..     
-0001f550: 2020 206f 6666 7365 7420 3d20 7064 2e74     offset = pd.t
-0001f560: 7365 7269 6573 2e66 7265 7175 656e 6369  series.frequenci
-0001f570: 6573 2e74 6f5f 6f66 6673 6574 286f 6666  es.to_offset(off
-0001f580: 7365 7429 0a20 2020 2020 2020 2064 6174  set).        dat
-0001f590: 6520 3d20 7365 6c66 2e64 6976 6973 696f  e = self.divisio
-0001f5a0: 6e73 5b30 5d20 2b20 6f66 6673 6574 0a20  ns[0] + offset. 
-0001f5b0: 2020 2020 2020 2065 6e64 203d 2073 656c         end = sel
-0001f5c0: 662e 6c6f 632e 5f67 6574 5f70 6172 7469  f.loc._get_parti
-0001f5d0: 7469 6f6e 7328 6461 7465 290a 0a20 2020  tions(date)..   
-0001f5e0: 2020 2020 2069 735f 616e 6368 6f72 6564       is_anchored
-0001f5f0: 203d 206f 6666 7365 742e 6973 5f61 6e63   = offset.is_anc
-0001f600: 686f 7265 6428 290a 0a20 2020 2020 2020  hored()..       
-0001f610: 2069 6e63 6c75 6465 5f72 6967 6874 203d   include_right =
-0001f620: 2069 735f 616e 6368 6f72 6564 206f 7220   is_anchored or 
-0001f630: 6e6f 7420 6861 7361 7474 7228 6f66 6673  not hasattr(offs
-0001f640: 6574 2c20 2264 656c 7461 2229 0a0a 2020  et, "delta")..  
-0001f650: 2020 2020 2020 6966 2065 6e64 203d 3d20        if end == 
-0001f660: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
-0001f670: 202d 2031 3a0a 2020 2020 2020 2020 2020   - 1:.          
-0001f680: 2020 6469 7673 203d 2073 656c 662e 6469    divs = self.di
-0001f690: 7669 7369 6f6e 730a 2020 2020 2020 2020  visions.        
-0001f6a0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001f6b0: 2020 6469 7673 203d 2073 656c 662e 6469    divs = self.di
-0001f6c0: 7669 7369 6f6e 735b 3a20 656e 6420 2b20  visions[: end + 
-0001f6d0: 315d 202b 2028 6461 7465 2c29 0a0a 2020  1] + (date,)..  
-0001f6e0: 2020 2020 2020 6e61 6d65 203d 2022 6669        name = "fi
-0001f6f0: 7273 742d 2220 2b20 746f 6b65 6e69 7a65  rst-" + tokenize
-0001f700: 2873 656c 662c 206f 6666 7365 7429 0a20  (self, offset). 
-0001f710: 2020 2020 2020 2064 736b 203d 207b 286e         dsk = {(n
-0001f720: 616d 652c 2069 293a 2028 7365 6c66 2e5f  ame, i): (self._
-0001f730: 6e61 6d65 2c20 6929 2066 6f72 2069 2069  name, i) for i i
-0001f740: 6e20 7261 6e67 6528 656e 6429 7d0a 2020  n range(end)}.  
-0001f750: 2020 2020 2020 6473 6b5b 286e 616d 652c        dsk[(name,
-0001f760: 2065 6e64 295d 203d 2028 0a20 2020 2020   end)] = (.     
-0001f770: 2020 2020 2020 206d 6574 686f 6473 2e62         methods.b
-0001f780: 6f75 6e64 6172 795f 736c 6963 652c 0a20  oundary_slice,. 
-0001f790: 2020 2020 2020 2020 2020 2028 7365 6c66             (self
-0001f7a0: 2e5f 6e61 6d65 2c20 656e 6429 2c0a 2020  ._name, end),.  
-0001f7b0: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
-0001f7c0: 2020 2020 2020 2020 2020 2020 6461 7465              date
-0001f7d0: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
-0001f7e0: 636c 7564 655f 7269 6768 742c 0a20 2020  clude_right,.   
-0001f7f0: 2020 2020 2020 2020 2054 7275 652c 0a20           True,. 
-0001f800: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001f810: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-0001f820: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-0001f830: 6c65 6374 696f 6e73 286e 616d 652c 2064  lections(name, d
-0001f840: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
-0001f850: 3d5b 7365 6c66 5d29 0a20 2020 2020 2020  =[self]).       
-0001f860: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
-0001f870: 626a 6563 7428 6772 6170 682c 206e 616d  bject(graph, nam
-0001f880: 652c 2073 656c 662c 2064 6976 7329 0a0a  e, self, divs)..
-0001f890: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0001f8a0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-0001f8b0: 2020 2020 6465 6620 6c61 7374 2873 656c      def last(sel
-0001f8c0: 662c 206f 6666 7365 7429 3a0a 2020 2020  f, offset):.    
-0001f8d0: 2020 2020 2320 4c65 7420 7061 6e64 6173      # Let pandas
-0001f8e0: 2065 7272 6f72 206f 6e20 6261 6420 6172   error on bad ar
-0001f8f0: 6773 0a20 2020 2020 2020 2073 656c 662e  gs.        self.
-0001f900: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e66  _meta_nonempty.f
-0001f910: 6972 7374 286f 6666 7365 7429 0a0a 2020  irst(offset)..  
-0001f920: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-0001f930: 662e 6b6e 6f77 6e5f 6469 7669 7369 6f6e  f.known_division
-0001f940: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-0001f950: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0001f960: 2260 6c61 7374 6020 6973 206e 6f74 2069  "`last` is not i
-0001f970: 6d70 6c65 6d65 6e74 6564 2066 6f72 2075  mplemented for u
-0001f980: 6e6b 6e6f 776e 2064 6976 6973 696f 6e73  nknown divisions
-0001f990: 2229 0a0a 2020 2020 2020 2020 6f66 6673  ")..        offs
-0001f9a0: 6574 203d 2070 642e 7473 6572 6965 732e  et = pd.tseries.
-0001f9b0: 6672 6571 7565 6e63 6965 732e 746f 5f6f  frequencies.to_o
-0001f9c0: 6666 7365 7428 6f66 6673 6574 290a 2020  ffset(offset).  
-0001f9d0: 2020 2020 2020 6461 7465 203d 2073 656c        date = sel
-0001f9e0: 662e 6469 7669 7369 6f6e 735b 2d31 5d20  f.divisions[-1] 
-0001f9f0: 2d20 6f66 6673 6574 0a20 2020 2020 2020  - offset.       
-0001fa00: 2073 7461 7274 203d 2073 656c 662e 6c6f   start = self.lo
-0001fa10: 632e 5f67 6574 5f70 6172 7469 7469 6f6e  c._get_partition
-0001fa20: 7328 6461 7465 290a 0a20 2020 2020 2020  s(date)..       
-0001fa30: 2069 6620 7374 6172 7420 3d3d 2030 3a0a   if start == 0:.
-0001fa40: 2020 2020 2020 2020 2020 2020 6469 7673              divs
-0001fa50: 203d 2073 656c 662e 6469 7669 7369 6f6e   = self.division
-0001fa60: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
-0001fa70: 2020 2020 2020 2020 2020 2020 6469 7673              divs
-0001fa80: 203d 2028 6461 7465 2c29 202b 2073 656c   = (date,) + sel
-0001fa90: 662e 6469 7669 7369 6f6e 735b 7374 6172  f.divisions[star
-0001faa0: 7420 2b20 3120 3a5d 0a0a 2020 2020 2020  t + 1 :]..      
-0001fab0: 2020 6e61 6d65 203d 2022 6c61 7374 2d22    name = "last-"
-0001fac0: 202b 2074 6f6b 656e 697a 6528 7365 6c66   + tokenize(self
-0001fad0: 2c20 6f66 6673 6574 290a 2020 2020 2020  , offset).      
-0001fae0: 2020 6473 6b20 3d20 7b0a 2020 2020 2020    dsk = {.      
-0001faf0: 2020 2020 2020 286e 616d 652c 2069 202b        (name, i +
-0001fb00: 2031 293a 2028 7365 6c66 2e5f 6e61 6d65   1): (self._name
-0001fb10: 2c20 6a20 2b20 3129 0a20 2020 2020 2020  , j + 1).       
-0001fb20: 2020 2020 2066 6f72 2069 2c20 6a20 696e       for i, j in
-0001fb30: 2065 6e75 6d65 7261 7465 2872 616e 6765   enumerate(range
-0001fb40: 2873 7461 7274 2c20 7365 6c66 2e6e 7061  (start, self.npa
-0001fb50: 7274 6974 696f 6e73 2929 0a20 2020 2020  rtitions)).     
-0001fb60: 2020 207d 0a20 2020 2020 2020 2064 736b     }.        dsk
-0001fb70: 5b28 6e61 6d65 2c20 3029 5d20 3d20 280a  [(name, 0)] = (.
-0001fb80: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-0001fb90: 6f64 732e 626f 756e 6461 7279 5f73 6c69  ods.boundary_sli
-0001fba0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
-0001fbb0: 2873 656c 662e 5f6e 616d 652c 2073 7461  (self._name, sta
-0001fbc0: 7274 292c 0a20 2020 2020 2020 2020 2020  rt),.           
-0001fbd0: 2064 6174 652c 0a20 2020 2020 2020 2020   date,.         
-0001fbe0: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
-0001fbf0: 2020 2020 2054 7275 652c 0a20 2020 2020       True,.     
-0001fc00: 2020 2020 2020 2046 616c 7365 2c0a 2020         False,.  
-0001fc10: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001fc20: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
-0001fc30: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
-0001fc40: 6563 7469 6f6e 7328 6e61 6d65 2c20 6473  ections(name, ds
-0001fc50: 6b2c 2064 6570 656e 6465 6e63 6965 733d  k, dependencies=
-0001fc60: 5b73 656c 665d 290a 2020 2020 2020 2020  [self]).        
-0001fc70: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
-0001fc80: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
-0001fc90: 2c20 7365 6c66 2c20 6469 7673 290a 0a20  , self, divs).. 
-0001fca0: 2020 2064 6566 206e 756e 6971 7565 5f61     def nunique_a
-0001fcb0: 7070 726f 7828 7365 6c66 2c20 7370 6c69  pprox(self, spli
-0001fcc0: 745f 6576 6572 793d 4e6f 6e65 293a 0a20  t_every=None):. 
-0001fcd0: 2020 2020 2020 2022 2222 4170 7072 6f78         """Approx
-0001fce0: 696d 6174 6520 6e75 6d62 6572 206f 6620  imate number of 
-0001fcf0: 756e 6971 7565 2072 6f77 732e 0a0a 2020  unique rows...  
-0001fd00: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
-0001fd10: 6420 7573 6573 2074 6865 2048 7970 6572  d uses the Hyper
-0001fd20: 4c6f 674c 6f67 2061 6c67 6f72 6974 686d  LogLog algorithm
-0001fd30: 2066 6f72 2063 6172 6469 6e61 6c69 7479   for cardinality
-0001fd40: 0a20 2020 2020 2020 2065 7374 696d 6174  .        estimat
-0001fd50: 696f 6e20 746f 2063 6f6d 7075 7465 2074  ion to compute t
-0001fd60: 6865 2061 7070 726f 7869 6d61 7465 206e  he approximate n
-0001fd70: 756d 6265 7220 6f66 2075 6e69 7175 6520  umber of unique 
-0001fd80: 726f 7773 2e0a 2020 2020 2020 2020 5468  rows..        Th
-0001fd90: 6520 6170 7072 6f78 696d 6174 6520 6572  e approximate er
-0001fda0: 726f 7220 6973 2030 2e34 3036 252e 0a0a  ror is 0.406%...
-0001fdb0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0001fdc0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0001fdd0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7370  -----.        sp
-0001fde0: 6c69 745f 6576 6572 7920 3a20 696e 742c  lit_every : int,
-0001fdf0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0001fe00: 2020 2020 2020 4772 6f75 7020 7061 7274        Group part
-0001fe10: 6974 696f 6e73 2069 6e74 6f20 6772 6f75  itions into grou
-0001fe20: 7073 206f 6620 7468 6973 2073 697a 6520  ps of this size 
-0001fe30: 7768 696c 6520 7065 7266 6f72 6d69 6e67  while performing
-0001fe40: 2061 0a20 2020 2020 2020 2020 2020 2074   a.            t
-0001fe50: 7265 652d 7265 6475 6374 696f 6e2e 2049  ree-reduction. I
-0001fe60: 6620 7365 7420 746f 2046 616c 7365 2c20  f set to False, 
-0001fe70: 6e6f 2074 7265 652d 7265 6475 6374 696f  no tree-reductio
-0001fe80: 6e20 7769 6c6c 2062 6520 7573 6564 2e0a  n will be used..
-0001fe90: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
-0001fea0: 756c 7420 6973 2038 2e0a 0a20 2020 2020  ult is 8...     
-0001feb0: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-0001fec0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-0001fed0: 2020 2061 2066 6c6f 6174 2072 6570 7265     a float repre
-0001fee0: 7365 6e74 696e 6720 7468 6520 6170 7072  senting the appr
-0001fef0: 6f78 696d 6174 6520 6e75 6d62 6572 206f  oximate number o
-0001ff00: 6620 656c 656d 656e 7473 0a20 2020 2020  f elements.     
-0001ff10: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-0001ff20: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-0001ff30: 6d65 2069 6d70 6f72 7420 6879 7065 726c  me import hyperl
-0001ff40: 6f67 6c6f 6720 2023 2068 6572 6520 746f  oglog  # here to
-0001ff50: 2061 766f 6964 2063 6972 6375 6c61 7220   avoid circular 
-0001ff60: 696d 706f 7274 2069 7373 7565 730a 0a20  import issues.. 
-0001ff70: 2020 2020 2020 2072 6574 7572 6e20 6163         return ac
-0001ff80: 6128 0a20 2020 2020 2020 2020 2020 205b  a(.            [
-0001ff90: 7365 6c66 5d2c 0a20 2020 2020 2020 2020  self],.         
-0001ffa0: 2020 2063 6875 6e6b 3d68 7970 6572 6c6f     chunk=hyperlo
-0001ffb0: 676c 6f67 2e63 6f6d 7075 7465 5f68 6c6c  glog.compute_hll
-0001ffc0: 5f61 7272 6179 2c0a 2020 2020 2020 2020  _array,.        
-0001ffd0: 2020 2020 636f 6d62 696e 653d 6879 7065      combine=hype
-0001ffe0: 726c 6f67 6c6f 672e 7265 6475 6365 5f73  rloglog.reduce_s
-0001fff0: 7461 7465 2c0a 2020 2020 2020 2020 2020  tate,.          
-00020000: 2020 6167 6772 6567 6174 653d 6879 7065    aggregate=hype
-00020010: 726c 6f67 6c6f 672e 6573 7469 6d61 7465  rloglog.estimate
-00020020: 5f63 6f75 6e74 2c0a 2020 2020 2020 2020  _count,.        
-00020030: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
-00020040: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
-00020050: 2020 2020 2020 2020 2062 3d31 362c 0a20           b=16,. 
-00020060: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
-00020070: 666c 6f61 742c 0a20 2020 2020 2020 2029  float,.        )
-00020080: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00020090: 2020 2020 6465 6620 7661 6c75 6573 2873      def values(s
-000200a0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000200b0: 2252 6574 7572 6e20 6120 6461 736b 2e61  "Return a dask.a
-000200c0: 7272 6179 206f 6620 7468 6520 7661 6c75  rray of the valu
-000200d0: 6573 206f 6620 7468 6973 2064 6174 6166  es of this dataf
-000200e0: 7261 6d65 0a0a 2020 2020 2020 2020 5761  rame..        Wa
-000200f0: 726e 696e 673a 2054 6869 7320 6372 6561  rning: This crea
-00020100: 7465 7320 6120 6461 736b 2e61 7272 6179  tes a dask.array
-00020110: 2077 6974 686f 7574 2070 7265 6369 7365   without precise
-00020120: 2073 6861 7065 2069 6e66 6f72 6d61 7469   shape informati
-00020130: 6f6e 2e0a 2020 2020 2020 2020 4f70 6572  on..        Oper
-00020140: 6174 696f 6e73 2074 6861 7420 6465 7065  ations that depe
-00020150: 6e64 206f 6e20 7368 6170 6520 696e 666f  nd on shape info
-00020160: 726d 6174 696f 6e2c 206c 696b 6520 736c  rmation, like sl
-00020170: 6963 696e 6720 6f72 2072 6573 6861 7069  icing or reshapi
-00020180: 6e67 2c0a 2020 2020 2020 2020 7769 6c6c  ng,.        will
-00020190: 206e 6f74 2077 6f72 6b2e 0a20 2020 2020   not work..     
-000201a0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-000201b0: 6620 6973 5f65 7874 656e 7369 6f6e 5f61  f is_extension_a
-000201c0: 7272 6179 5f64 7479 7065 2873 656c 662e  rray_dtype(self.
-000201d0: 5f6d 6574 612e 7661 6c75 6573 293a 0a20  _meta.values):. 
-000201e0: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
-000201f0: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
-00020200: 2020 2020 2020 2020 2020 2244 6173 6b20            "Dask 
-00020210: 6375 7272 656e 746c 7920 6861 7320 6c69  currently has li
-00020220: 6d69 7465 6420 7375 7070 6f72 7420 666f  mited support fo
-00020230: 7220 636f 6e76 6572 7469 6e67 2070 616e  r converting pan
-00020240: 6461 7320 6578 7465 6e73 696f 6e20 6474  das extension dt
-00020250: 7970 6573 2022 0a20 2020 2020 2020 2020  ypes ".         
-00020260: 2020 2020 2020 2066 2274 6f20 6172 7261         f"to arra
-00020270: 7973 2e20 436f 6e76 6572 7469 6e67 207b  ys. Converting {
-00020280: 7365 6c66 2e5f 6d65 7461 2e76 616c 7565  self._meta.value
-00020290: 732e 6474 7970 657d 2074 6f20 6f62 6a65  s.dtype} to obje
-000202a0: 6374 2064 7479 7065 2e22 2c0a 2020 2020  ct dtype.",.    
-000202b0: 2020 2020 2020 2020 2020 2020 5573 6572              User
-000202c0: 5761 726e 696e 672c 0a20 2020 2020 2020  Warning,.       
-000202d0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-000202e0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-000202f0: 6172 7469 7469 6f6e 7328 6d65 7468 6f64  artitions(method
-00020300: 732e 7661 6c75 6573 290a 0a20 2020 2064  s.values)..    d
-00020310: 6566 205f 7661 6c69 6461 7465 5f63 6875  ef _validate_chu
-00020320: 6e6b 7328 7365 6c66 2c20 6172 722c 206c  nks(self, arr, l
-00020330: 656e 6774 6873 293a 0a20 2020 2020 2020  engths):.       
-00020340: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
-00020350: 2e63 6f72 6520 696d 706f 7274 206e 6f72  .core import nor
-00020360: 6d61 6c69 7a65 5f63 6875 6e6b 730a 0a20  malize_chunks.. 
-00020370: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00020380: 616e 6365 286c 656e 6774 6873 2c20 5365  ance(lengths, Se
-00020390: 7175 656e 6365 293a 0a20 2020 2020 2020  quence):.       
-000203a0: 2020 2020 206c 656e 6774 6873 203d 2074       lengths = t
-000203b0: 7570 6c65 286c 656e 6774 6873 290a 0a20  uple(lengths).. 
-000203c0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-000203d0: 6e28 6c65 6e67 7468 7329 2021 3d20 7365  n(lengths) != se
-000203e0: 6c66 2e6e 7061 7274 6974 696f 6e73 3a0a  lf.npartitions:.
-000203f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020400: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00020410: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00020420: 2020 2020 2020 2254 6865 206e 756d 6265        "The numbe
-00020430: 7220 6f66 2069 7465 6d73 2069 6e20 276c  r of items in 'l
-00020440: 656e 6774 6873 2720 646f 6573 206e 6f74  engths' does not
-00020450: 206d 6174 6368 2074 6865 206e 756d 6265   match the numbe
-00020460: 7220 6f66 2022 0a20 2020 2020 2020 2020  r of ".         
-00020470: 2020 2020 2020 2020 2020 2066 2270 6172             f"par
-00020480: 7469 7469 6f6e 732e 207b 6c65 6e28 6c65  titions. {len(le
-00020490: 6e67 7468 7329 7d20 213d 207b 7365 6c66  ngths)} != {self
-000204a0: 2e6e 7061 7274 6974 696f 6e73 7d22 0a20  .npartitions}". 
-000204b0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000204c0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000204d0: 2073 656c 662e 6e64 696d 203d 3d20 313a   self.ndim == 1:
-000204e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000204f0: 2063 6875 6e6b 7320 3d20 6e6f 726d 616c   chunks = normal
-00020500: 697a 655f 6368 756e 6b73 2828 6c65 6e67  ize_chunks((leng
-00020510: 7468 732c 2929 0a20 2020 2020 2020 2020  ths,)).         
-00020520: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00020530: 2020 2020 2020 2020 2063 6875 6e6b 7320           chunks 
-00020540: 3d20 6e6f 726d 616c 697a 655f 6368 756e  = normalize_chun
-00020550: 6b73 2828 6c65 6e67 7468 732c 2028 6c65  ks((lengths, (le
-00020560: 6e28 7365 6c66 2e63 6f6c 756d 6e73 292c  n(self.columns),
-00020570: 2929 290a 0a20 2020 2020 2020 2020 2020  )))..           
-00020580: 2072 6574 7572 6e20 6368 756e 6b73 0a20   return chunks. 
-00020590: 2020 2020 2020 2065 6c69 6620 6c65 6e67         elif leng
-000205a0: 7468 7320 6973 206e 6f74 204e 6f6e 653a  ths is not None:
-000205b0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000205c0: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
-000205d0: 556e 6578 7065 6374 6564 2076 616c 7565  Unexpected value
-000205e0: 2066 6f72 2027 6c65 6e67 7468 7327 3a20   for 'lengths': 
-000205f0: 277b 6c65 6e67 7468 737d 2722 290a 0a20  '{lengths}'").. 
-00020600: 2020 2020 2020 2072 6574 7572 6e20 6172         return ar
-00020610: 722e 5f63 6875 6e6b 730a 0a20 2020 2064  r._chunks..    d
-00020620: 6566 205f 6973 5f69 6e64 6578 5f6c 6576  ef _is_index_lev
-00020630: 656c 5f72 6566 6572 656e 6365 2873 656c  el_reference(sel
-00020640: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
-00020650: 2022 2222 0a20 2020 2020 2020 2054 6573   """.        Tes
-00020660: 7420 7768 6574 6865 7220 6120 6b65 7920  t whether a key 
-00020670: 6973 2061 6e20 696e 6465 7820 6c65 7665  is an index leve
-00020680: 6c20 7265 6665 7265 6e63 650a 0a20 2020  l reference..   
-00020690: 2020 2020 2054 6f20 6265 2063 6f6e 7369       To be consi
-000206a0: 6465 7265 6420 616e 2069 6e64 6578 206c  dered an index l
-000206b0: 6576 656c 2072 6566 6572 656e 6365 2c20  evel reference, 
-000206c0: 606b 6579 6020 6d75 7374 206d 6174 6368  `key` must match
-000206d0: 2074 6865 2069 6e64 6578 206e 616d 650a   the index name.
-000206e0: 2020 2020 2020 2020 616e 6420 6d75 7374          and must
-000206f0: 204e 4f54 206d 6174 6368 2074 6865 206e   NOT match the n
-00020700: 616d 6520 6f66 2061 6e79 2063 6f6c 756d  ame of any colum
-00020710: 6e20 2869 6620 6120 6461 7461 6672 616d  n (if a datafram
-00020720: 6529 2e0a 2020 2020 2020 2020 2222 220a  e)..        """.
-00020730: 2020 2020 2020 2020 7265 7475 726e 2028          return (
-00020740: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00020750: 662e 696e 6465 782e 6e61 6d65 2069 7320  f.index.name is 
-00020760: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
-00020770: 2020 2020 2061 6e64 206e 6f74 2069 735f       and not is_
-00020780: 6461 736b 5f63 6f6c 6c65 6374 696f 6e28  dask_collection(
-00020790: 6b65 7929 0a20 2020 2020 2020 2020 2020  key).           
-000207a0: 2061 6e64 2028 6e70 2e69 7373 6361 6c61   and (np.isscala
-000207b0: 7228 6b65 7929 206f 7220 6973 696e 7374  r(key) or isinst
-000207c0: 616e 6365 286b 6579 2c20 7475 706c 6529  ance(key, tuple)
-000207d0: 290a 2020 2020 2020 2020 2020 2020 616e  ).            an
-000207e0: 6420 6b65 7920 3d3d 2073 656c 662e 696e  d key == self.in
-000207f0: 6465 782e 6e61 6d65 0a20 2020 2020 2020  dex.name.       
-00020800: 2020 2020 2061 6e64 206b 6579 206e 6f74       and key not
-00020810: 2069 6e20 6765 7461 7474 7228 7365 6c66   in getattr(self
-00020820: 2c20 2263 6f6c 756d 6e73 222c 2028 2929  , "columns", ())
-00020830: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00020840: 6465 6620 5f63 6f6e 7461 696e 735f 696e  def _contains_in
-00020850: 6465 785f 6e61 6d65 2873 656c 662c 2063  dex_name(self, c
-00020860: 6f6c 756d 6e73 5f6f 725f 696e 6465 7829  olumns_or_index)
-00020870: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00020880: 2020 2020 2020 5465 7374 2077 6865 7468        Test wheth
-00020890: 6572 2074 6865 2069 6e70 7574 2063 6f6e  er the input con
-000208a0: 7461 696e 7320 6120 7265 6665 7265 6e63  tains a referenc
-000208b0: 6520 746f 2074 6865 2069 6e64 6578 206f  e to the index o
-000208c0: 6620 7468 6520 4461 7461 4672 616d 652f  f the DataFrame/
-000208d0: 5365 7269 6573 0a20 2020 2020 2020 2022  Series.        "
-000208e0: 2222 0a20 2020 2020 2020 2069 6620 6973  "".        if is
-000208f0: 696e 7374 616e 6365 2863 6f6c 756d 6e73  instance(columns
-00020900: 5f6f 725f 696e 6465 782c 206c 6973 7429  _or_index, list)
-00020910: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00020920: 7475 726e 2061 6e79 2873 656c 662e 5f69  turn any(self._i
-00020930: 735f 696e 6465 785f 6c65 7665 6c5f 7265  s_index_level_re
-00020940: 6665 7265 6e63 6528 6e29 2066 6f72 206e  ference(n) for n
-00020950: 2069 6e20 636f 6c75 6d6e 735f 6f72 5f69   in columns_or_i
-00020960: 6e64 6578 290a 2020 2020 2020 2020 656c  ndex).        el
-00020970: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00020980: 7265 7475 726e 2073 656c 662e 5f69 735f  return self._is_
-00020990: 696e 6465 785f 6c65 7665 6c5f 7265 6665  index_level_refe
-000209a0: 7265 6e63 6528 636f 6c75 6d6e 735f 6f72  rence(columns_or
-000209b0: 5f69 6e64 6578 290a 0a0a 6465 6620 5f72  _index)...def _r
-000209c0: 6169 7365 5f69 665f 6f62 6a65 6374 5f73  aise_if_object_s
-000209d0: 6572 6965 7328 782c 2066 756e 636e 616d  eries(x, funcnam
-000209e0: 6529 3a0a 2020 2020 2222 220a 2020 2020  e):.    """.    
-000209f0: 5574 696c 6974 7920 6675 6e63 7469 6f6e  Utility function
-00020a00: 2074 6f20 7261 6973 6520 616e 2065 7272   to raise an err
-00020a10: 6f72 2069 6620 616e 206f 626a 6563 7420  or if an object 
-00020a20: 636f 6c75 6d6e 2064 6f65 7320 6e6f 7420  column does not 
-00020a30: 7375 7070 6f72 740a 2020 2020 6120 6365  support.    a ce
-00020a40: 7274 6169 6e20 6f70 6572 6174 696f 6e20  rtain operation 
-00020a50: 6c69 6b65 2060 6d65 616e 602e 0a20 2020  like `mean`..   
-00020a60: 2022 2222 0a20 2020 2069 6620 6973 696e   """.    if isin
-00020a70: 7374 616e 6365 2878 2c20 5365 7269 6573  stance(x, Series
-00020a80: 2920 616e 6420 6861 7361 7474 7228 782c  ) and hasattr(x,
-00020a90: 2022 6474 7970 6522 293a 0a20 2020 2020   "dtype"):.     
-00020aa0: 2020 2069 6620 782e 6474 7970 6520 3d3d     if x.dtype ==
-00020ab0: 206f 626a 6563 743a 0a20 2020 2020 2020   object:.       
-00020ac0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00020ad0: 4572 726f 7228 2260 2573 6020 6e6f 7420  Error("`%s` not 
-00020ae0: 7375 7070 6f72 7465 6420 7769 7468 206f  supported with o
-00020af0: 626a 6563 7420 7365 7269 6573 2220 2520  bject series" % 
-00020b00: 6675 6e63 6e61 6d65 290a 2020 2020 2020  funcname).      
-00020b10: 2020 656c 6966 2070 642e 6170 692e 7479    elif pd.api.ty
-00020b20: 7065 732e 6973 5f64 7479 7065 5f65 7175  pes.is_dtype_equ
-00020b30: 616c 2878 2e64 7479 7065 2c20 2273 7472  al(x.dtype, "str
-00020b40: 696e 6722 293a 0a20 2020 2020 2020 2020  ing"):.         
-00020b50: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00020b60: 726f 7228 2260 2573 6020 6e6f 7420 7375  ror("`%s` not su
-00020b70: 7070 6f72 7465 6420 7769 7468 2073 7472  pported with str
-00020b80: 696e 6720 7365 7269 6573 2220 2520 6675  ing series" % fu
-00020b90: 6e63 6e61 6d65 290a 0a0a 636c 6173 7320  ncname)...class 
-00020ba0: 5365 7269 6573 285f 4672 616d 6529 3a0a  Series(_Frame):.
-00020bb0: 2020 2020 2222 2250 6172 616c 6c65 6c20      """Parallel 
-00020bc0: 5061 6e64 6173 2053 6572 6965 730a 0a20  Pandas Series.. 
-00020bd0: 2020 2044 6f20 6e6f 7420 7573 6520 7468     Do not use th
-00020be0: 6973 2063 6c61 7373 2064 6972 6563 746c  is class directl
-00020bf0: 792e 2020 496e 7374 6561 6420 7573 6520  y.  Instead use 
-00020c00: 6675 6e63 7469 6f6e 7320 6c69 6b65 0a20  functions like. 
-00020c10: 2020 2060 6064 642e 7265 6164 5f63 7376     ``dd.read_csv
-00020c20: 6060 2c20 6060 6464 2e72 6561 645f 7061  ``, ``dd.read_pa
-00020c30: 7271 7565 7460 602c 206f 7220 6060 6464  rquet``, or ``dd
-00020c40: 2e66 726f 6d5f 7061 6e64 6173 6060 2e0a  .from_pandas``..
-00020c50: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-00020c60: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a      ----------..
-00020c70: 2020 2020 6473 6b3a 2064 6963 740a 2020      dsk: dict.  
-00020c80: 2020 2020 2020 5468 6520 6461 736b 2067        The dask g
-00020c90: 7261 7068 2074 6f20 636f 6d70 7574 6520  raph to compute 
-00020ca0: 7468 6973 2053 6572 6965 730a 2020 2020  this Series.    
-00020cb0: 5f6e 616d 653a 2073 7472 0a20 2020 2020  _name: str.     
-00020cc0: 2020 2054 6865 206b 6579 2070 7265 6669     The key prefi
-00020cd0: 7820 7468 6174 2073 7065 6369 6669 6573  x that specifies
-00020ce0: 2077 6869 6368 206b 6579 7320 696e 2074   which keys in t
-00020cf0: 6865 2064 6173 6b20 636f 6d70 7269 7365  he dask comprise
-00020d00: 2074 6869 730a 2020 2020 2020 2020 7061   this.        pa
-00020d10: 7274 6963 756c 6172 2053 6572 6965 730a  rticular Series.
-00020d20: 2020 2020 6d65 7461 3a20 7061 6e64 6173      meta: pandas
-00020d30: 2e53 6572 6965 730a 2020 2020 2020 2020  .Series.        
-00020d40: 416e 2065 6d70 7479 2060 6070 616e 6461  An empty ``panda
-00020d50: 732e 5365 7269 6573 6060 2077 6974 6820  s.Series`` with 
-00020d60: 6e61 6d65 732c 2064 7479 7065 732c 2061  names, dtypes, a
-00020d70: 6e64 2069 6e64 6578 206d 6174 6368 696e  nd index matchin
-00020d80: 6720 7468 650a 2020 2020 2020 2020 6578  g the.        ex
-00020d90: 7065 6374 6564 206f 7574 7075 742e 0a20  pected output.. 
-00020da0: 2020 2064 6976 6973 696f 6e73 3a20 7475     divisions: tu
-00020db0: 706c 6520 6f66 2069 6e64 6578 2076 616c  ple of index val
-00020dc0: 7565 730a 2020 2020 2020 2020 5661 6c75  ues.        Valu
-00020dd0: 6573 2061 6c6f 6e67 2077 6869 6368 2077  es along which w
-00020de0: 6520 7061 7274 6974 696f 6e20 6f75 7220  e partition our 
-00020df0: 626c 6f63 6b73 206f 6e20 7468 6520 696e  blocks on the in
-00020e00: 6465 780a 0a20 2020 2053 6565 2041 6c73  dex..    See Als
-00020e10: 6f0a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  o.    --------. 
-00020e20: 2020 2064 6173 6b2e 6461 7461 6672 616d     dask.datafram
-00020e30: 652e 4461 7461 4672 616d 650a 2020 2020  e.DataFrame.    
-00020e40: 2222 220a 0a20 2020 205f 7061 7274 6974  """..    _partit
-00020e50: 696f 6e5f 7479 7065 203d 2070 642e 5365  ion_type = pd.Se
-00020e60: 7269 6573 0a20 2020 205f 6973 5f70 6172  ries.    _is_par
-00020e70: 7469 7469 6f6e 5f74 7970 6520 3d20 7374  tition_type = st
-00020e80: 6174 6963 6d65 7468 6f64 2869 735f 7365  aticmethod(is_se
-00020e90: 7269 6573 5f6c 696b 6529 0a20 2020 205f  ries_like).    _
-00020ea0: 746f 6b65 6e5f 7072 6566 6978 203d 2022  token_prefix = "
-00020eb0: 7365 7269 6573 2d22 0a20 2020 205f 6163  series-".    _ac
-00020ec0: 6365 7373 6f72 733a 2043 6c61 7373 5661  cessors: ClassVa
-00020ed0: 725b 7365 745b 7374 725d 5d20 3d20 7365  r[set[str]] = se
-00020ee0: 7428 290a 0a20 2020 2064 6566 205f 5f61  t()..    def __a
-00020ef0: 7272 6179 5f77 7261 705f 5f28 7365 6c66  rray_wrap__(self
-00020f00: 2c20 6172 7261 792c 2063 6f6e 7465 7874  , array, context
-00020f10: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00020f20: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
-00020f30: 6e74 6578 742c 2074 7570 6c65 2920 616e  ntext, tuple) an
-00020f40: 6420 6c65 6e28 636f 6e74 6578 7429 203e  d len(context) >
-00020f50: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-00020f60: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
-00020f70: 6e74 6578 745b 315d 5b30 5d2c 206e 702e  ntext[1][0], np.
-00020f80: 6e64 6172 7261 7929 2061 6e64 2063 6f6e  ndarray) and con
-00020f90: 7465 7874 5b31 5d5b 305d 2e73 6861 7065  text[1][0].shape
-00020fa0: 203d 3d20 2829 3a0a 2020 2020 2020 2020   == ():.        
-00020fb0: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
-00020fc0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00020fd0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00020fe0: 2020 2020 2020 2069 6e64 6578 203d 2063         index = c
-00020ff0: 6f6e 7465 7874 5b31 5d5b 305d 2e69 6e64  ontext[1][0].ind
-00021000: 6578 0a20 2020 2020 2020 2065 6c73 653a  ex.        else:
-00021010: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-00021020: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00021030: 2020 696d 706f 7274 2069 6e73 7065 6374    import inspect
-00021040: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00021050: 2020 6d65 7468 6f64 5f6e 616d 6520 3d20    method_name = 
-00021060: 6622 607b 696e 7370 6563 742e 7374 6163  f"`{inspect.stac
-00021070: 6b28 295b 335d 5b33 5d7d 6022 0a20 2020  k()[3][3]}`".   
-00021080: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-00021090: 496e 6465 7845 7272 6f72 3a0a 2020 2020  IndexError:.    
-000210a0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-000210b0: 6f64 5f6e 616d 6520 3d20 2254 6869 7320  od_name = "This 
-000210c0: 6d65 7468 6f64 220a 2020 2020 2020 2020  method".        
-000210d0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-000210e0: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
-000210f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00021100: 227b 6d65 7468 6f64 5f6e 616d 657d 2069  "{method_name} i
-00021110: 7320 6e6f 7420 696d 706c 656d 656e 7465  s not implemente
-00021120: 6420 666f 7220 6064 6173 6b2e 6461 7461  d for `dask.data
-00021130: 6672 616d 652e 5365 7269 6573 602e 220a  frame.Series`.".
-00021140: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00021150: 2020 2020 2020 2072 6574 7572 6e20 6d65         return me
-00021160: 7461 5f73 6572 6965 735f 636f 6e73 7472  ta_series_constr
-00021170: 7563 746f 7228 7365 6c66 2928 6172 7261  uctor(self)(arra
-00021180: 792c 2069 6e64 6578 3d69 6e64 6578 2c20  y, index=index, 
-00021190: 6e61 6d65 3d73 656c 662e 6e61 6d65 290a  name=self.name).
-000211a0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-000211b0: 2020 2064 6566 2061 7865 7328 7365 6c66     def axes(self
-000211c0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-000211d0: 6e20 5b73 656c 662e 696e 6465 785d 0a0a  n [self.index]..
-000211e0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-000211f0: 2020 6465 6620 6e61 6d65 2873 656c 6629    def name(self)
-00021200: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00021210: 2073 656c 662e 5f6d 6574 612e 6e61 6d65   self._meta.name
-00021220: 0a0a 2020 2020 406e 616d 652e 7365 7474  ..    @name.sett
-00021230: 6572 0a20 2020 2064 6566 206e 616d 6528  er.    def name(
-00021240: 7365 6c66 2c20 6e61 6d65 293a 0a20 2020  self, name):.   
-00021250: 2020 2020 2073 656c 662e 5f6d 6574 612e       self._meta.
-00021260: 6e61 6d65 203d 206e 616d 650a 2020 2020  name = name.    
-00021270: 2020 2020 7265 6e61 6d65 6420 3d20 5f72      renamed = _r
-00021280: 656e 616d 655f 6461 736b 2873 656c 662c  ename_dask(self,
-00021290: 206e 616d 6529 0a20 2020 2020 2020 2023   name).        #
-000212a0: 2075 7064 6174 6520 6d79 7365 6c66 0a20   update myself. 
-000212b0: 2020 2020 2020 2073 656c 662e 6461 736b         self.dask
-000212c0: 203d 2072 656e 616d 6564 2e64 6173 6b0a   = renamed.dask.
-000212d0: 2020 2020 2020 2020 7365 6c66 2e5f 6e61          self._na
-000212e0: 6d65 203d 2072 656e 616d 6564 2e5f 6e61  me = renamed._na
-000212f0: 6d65 0a0a 2020 2020 4070 726f 7065 7274  me..    @propert
-00021300: 790a 2020 2020 6465 6620 6e64 696d 2873  y.    def ndim(s
-00021310: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00021320: 2252 6574 7572 6e20 6469 6d65 6e73 696f  "Return dimensio
-00021330: 6e61 6c69 7479 2222 220a 2020 2020 2020  nality""".      
-00021340: 2020 7265 7475 726e 2031 0a0a 2020 2020    return 1..    
-00021350: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00021360: 6620 7368 6170 6528 7365 6c66 293a 0a20  f shape(self):. 
-00021370: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00021380: 2020 2052 6574 7572 6e20 6120 7475 706c     Return a tupl
-00021390: 6520 7265 7072 6573 656e 7469 6e67 2074  e representing t
-000213a0: 6865 2064 696d 656e 7369 6f6e 616c 6974  he dimensionalit
-000213b0: 7920 6f66 2061 2053 6572 6965 732e 0a0a  y of a Series...
-000213c0: 2020 2020 2020 2020 5468 6520 7369 6e67          The sing
-000213d0: 6c65 2065 6c65 6d65 6e74 206f 6620 7468  le element of th
-000213e0: 6520 7475 706c 6520 6973 2061 2044 656c  e tuple is a Del
-000213f0: 6179 6564 2072 6573 756c 742e 0a0a 2020  ayed result...  
-00021400: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
-00021410: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00021420: 2020 2020 2020 2020 3e3e 3e20 7365 7269          >>> seri
-00021430: 6573 2e73 6861 7065 2020 2320 646f 6374  es.shape  # doct
-00021440: 6573 743a 202b 534b 4950 0a20 2020 2020  est: +SKIP.     
-00021450: 2020 2028 6464 2e53 6361 6c61 723c 7369     (dd.Scalar<si
-00021460: 7a65 2d61 672e 2e2e 2c20 6474 7970 653d  ze-ag..., dtype=
-00021470: 696e 7436 343e 2c29 0a20 2020 2020 2020  int64>,).       
-00021480: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-00021490: 7572 6e20 2873 656c 662e 7369 7a65 2c29  urn (self.size,)
-000214a0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-000214b0: 2020 2020 6465 6620 6474 7970 6528 7365      def dtype(se
-000214c0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000214d0: 5265 7475 726e 2064 6174 6120 7479 7065  Return data type
-000214e0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-000214f0: 726e 2073 656c 662e 5f6d 6574 612e 6474  rn self._meta.dt
-00021500: 7970 650a 0a20 2020 2064 7420 3d20 4361  ype..    dt = Ca
-00021510: 6368 6564 4163 6365 7373 6f72 2822 6474  chedAccessor("dt
-00021520: 222c 2044 6174 6574 696d 6541 6363 6573  ", DatetimeAcces
-00021530: 736f 7229 0a0a 2020 2020 6361 7420 3d20  sor)..    cat = 
-00021540: 4361 6368 6564 4163 6365 7373 6f72 2822  CachedAccessor("
-00021550: 6361 7422 2c20 4361 7465 676f 7269 6361  cat", Categorica
-00021560: 6c41 6363 6573 736f 7229 0a0a 2020 2020  lAccessor)..    
-00021570: 7374 7220 3d20 4361 6368 6564 4163 6365  str = CachedAcce
-00021580: 7373 6f72 2822 7374 7222 2c20 5374 7269  ssor("str", Stri
-00021590: 6e67 4163 6365 7373 6f72 290a 0a20 2020  ngAccessor)..   
-000215a0: 2064 6566 205f 5f64 6972 5f5f 2873 656c   def __dir__(sel
-000215b0: 6629 3a0a 2020 2020 2020 2020 6f20 3d20  f):.        o = 
-000215c0: 7365 7428 6469 7228 7479 7065 2873 656c  set(dir(type(sel
-000215d0: 6629 2929 0a20 2020 2020 2020 206f 2e75  f))).        o.u
-000215e0: 7064 6174 6528 7365 6c66 2e5f 5f64 6963  pdate(self.__dic
-000215f0: 745f 5f29 0a20 2020 2020 2020 2023 2052  t__).        # R
-00021600: 656d 6f76 6520 7468 6520 6063 6174 6020  emove the `cat` 
-00021610: 616e 6420 6073 7472 6020 6163 6365 7373  and `str` access
-00021620: 6f72 7320 6966 206e 6f74 2061 7661 696c  ors if not avail
-00021630: 6162 6c65 2e20 5765 2063 616e 2774 0a20  able. We can't. 
-00021640: 2020 2020 2020 2023 2064 6563 6964 6520         # decide 
-00021650: 7468 6973 2073 7461 7469 6361 6c6c 7920  this statically 
-00021660: 666f 7220 7468 6520 6064 7460 2061 6363  for the `dt` acc
-00021670: 6573 736f 722c 2061 7320 6974 2077 6f72  essor, as it wor
-00021680: 6b73 206f 6e0a 2020 2020 2020 2020 2320  ks on.        # 
-00021690: 6461 7465 7469 6d65 2d6c 696b 6520 7468  datetime-like th
-000216a0: 696e 6773 2061 7320 7765 6c6c 2e0a 2020  ings as well..  
-000216b0: 2020 2020 2020 666f 7220 6163 6365 7373        for access
-000216c0: 6f72 2069 6e20 5b22 6361 7422 2c20 2273  or in ["cat", "s
-000216d0: 7472 225d 3a0a 2020 2020 2020 2020 2020  tr"]:.          
-000216e0: 2020 6966 206e 6f74 2068 6173 6174 7472    if not hasattr
-000216f0: 2873 656c 662e 5f6d 6574 612c 2061 6363  (self._meta, acc
-00021700: 6573 736f 7229 3a0a 2020 2020 2020 2020  essor):.        
-00021710: 2020 2020 2020 2020 6f2e 7265 6d6f 7665          o.remove
-00021720: 2861 6363 6573 736f 7229 0a20 2020 2020  (accessor).     
-00021730: 2020 2072 6574 7572 6e20 6c69 7374 286f     return list(o
-00021740: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-00021750: 0a20 2020 2064 6566 206e 6279 7465 7328  .    def nbytes(
-00021760: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00021770: 2222 4e75 6d62 6572 206f 6620 6279 7465  ""Number of byte
-00021780: 7322 2222 0a20 2020 2020 2020 2072 6574  s""".        ret
-00021790: 7572 6e20 7365 6c66 2e72 6564 7563 7469  urn self.reducti
-000217a0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-000217b0: 6d65 7468 6f64 732e 6e62 7974 6573 2c20  methods.nbytes, 
-000217c0: 6e70 2e73 756d 2c20 746f 6b65 6e3d 226e  np.sum, token="n
-000217d0: 6279 7465 7322 2c20 6d65 7461 3d69 6e74  bytes", meta=int
-000217e0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
-000217f0: 6c73 650a 2020 2020 2020 2020 290a 0a20  lse.        ).. 
-00021800: 2020 2064 6566 205f 7265 7072 5f64 6174     def _repr_dat
-00021810: 6128 7365 6c66 293a 0a20 2020 2020 2020  a(self):.       
-00021820: 2072 6574 7572 6e20 5f72 6570 725f 6461   return _repr_da
-00021830: 7461 5f73 6572 6965 7328 7365 6c66 2e5f  ta_series(self._
-00021840: 6d65 7461 2c20 7365 6c66 2e5f 7265 7072  meta, self._repr
-00021850: 5f64 6976 6973 696f 6e73 290a 0a20 2020  _divisions)..   
-00021860: 2064 6566 205f 5f72 6570 725f 5f28 7365   def __repr__(se
-00021870: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00021880: 6861 7665 2074 6f20 6f76 6572 7772 6974  have to overwrit
-00021890: 6520 666f 6f74 6572 2222 220a 2020 2020  e footer""".    
-000218a0: 2020 2020 6966 2073 656c 662e 6e61 6d65      if self.name
-000218b0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-000218c0: 2020 2020 2020 2020 2020 666f 6f74 6572            footer
-000218d0: 203d 2066 224e 616d 653a 207b 7365 6c66   = f"Name: {self
-000218e0: 2e6e 616d 657d 2c20 6474 7970 653a 207b  .name}, dtype: {
-000218f0: 7365 6c66 2e64 7479 7065 7d22 0a20 2020  self.dtype}".   
-00021900: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00021910: 2020 2020 2020 2066 6f6f 7465 7220 3d20         footer = 
-00021920: 6622 6474 7970 653a 207b 7365 6c66 2e64  f"dtype: {self.d
-00021930: 7479 7065 7d22 0a0a 2020 2020 2020 2020  type}"..        
-00021940: 7265 7475 726e 2022 2222 4461 736b 207b  return """Dask {
-00021950: 6b6c 6173 737d 2053 7472 7563 7475 7265  klass} Structure
-00021960: 3a0a 7b64 6174 617d 0a7b 666f 6f74 6572  :.{data}.{footer
-00021970: 7d0a 4461 736b 204e 616d 653a 207b 6e61  }.Dask Name: {na
-00021980: 6d65 7d2c 207b 6c61 7965 7273 7d22 2222  me}, {layers}"""
-00021990: 2e66 6f72 6d61 7428 0a20 2020 2020 2020  .format(.       
-000219a0: 2020 2020 206b 6c61 7373 3d73 656c 662e       klass=self.
-000219b0: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-000219c0: 5f5f 2c0a 2020 2020 2020 2020 2020 2020  __,.            
-000219d0: 6461 7461 3d73 656c 662e 746f 5f73 7472  data=self.to_str
-000219e0: 696e 6728 292c 0a20 2020 2020 2020 2020  ing(),.         
-000219f0: 2020 2066 6f6f 7465 723d 666f 6f74 6572     footer=footer
-00021a00: 2c0a 2020 2020 2020 2020 2020 2020 6e61  ,.            na
-00021a10: 6d65 3d6b 6579 5f73 706c 6974 2873 656c  me=key_split(sel
-00021a20: 662e 5f6e 616d 6529 2c0a 2020 2020 2020  f._name),.      
-00021a30: 2020 2020 2020 6c61 7965 7273 3d6d 6179        layers=may
-00021a40: 6265 5f70 6c75 7261 6c69 7a65 286c 656e  be_pluralize(len
-00021a50: 2873 656c 662e 6461 736b 2e6c 6179 6572  (self.dask.layer
-00021a60: 7329 2c20 2267 7261 7068 206c 6179 6572  s), "graph layer
-00021a70: 2229 2c0a 2020 2020 2020 2020 290a 0a20  "),.        ).. 
-00021a80: 2020 2064 6566 2072 656e 616d 6528 7365     def rename(se
-00021a90: 6c66 2c20 696e 6465 783d 4e6f 6e65 2c20  lf, index=None, 
-00021aa0: 696e 706c 6163 653d 4661 6c73 652c 2073  inplace=False, s
-00021ab0: 6f72 7465 645f 696e 6465 783d 4661 6c73  orted_index=Fals
-00021ac0: 6529 3a0a 2020 2020 2020 2020 2222 2241  e):.        """A
-00021ad0: 6c74 6572 2053 6572 6965 7320 696e 6465  lter Series inde
-00021ae0: 7820 6c61 6265 6c73 206f 7220 6e61 6d65  x labels or name
-00021af0: 0a0a 2020 2020 2020 2020 4675 6e63 7469  ..        Functi
-00021b00: 6f6e 202f 2064 6963 7420 7661 6c75 6573  on / dict values
-00021b10: 206d 7573 7420 6265 2075 6e69 7175 6520   must be unique 
-00021b20: 2831 2d74 6f2d 3129 2e20 4c61 6265 6c73  (1-to-1). Labels
-00021b30: 206e 6f74 2063 6f6e 7461 696e 6564 2069   not contained i
-00021b40: 6e0a 2020 2020 2020 2020 6120 6469 6374  n.        a dict
-00021b50: 202f 2053 6572 6965 7320 7769 6c6c 2062   / Series will b
-00021b60: 6520 6c65 6674 2061 732d 6973 2e20 4578  e left as-is. Ex
-00021b70: 7472 6120 6c61 6265 6c73 206c 6973 7465  tra labels liste
-00021b80: 6420 646f 6e27 7420 7468 726f 7720 616e  d don't throw an
-00021b90: 0a20 2020 2020 2020 2065 7272 6f72 2e0a  .        error..
-00021ba0: 0a20 2020 2020 2020 2041 6c74 6572 6e61  .        Alterna
-00021bb0: 7469 7665 6c79 2c20 6368 616e 6765 2060  tively, change `
-00021bc0: 6053 6572 6965 732e 6e61 6d65 6060 2077  `Series.name`` w
-00021bd0: 6974 6820 6120 7363 616c 6172 2076 616c  ith a scalar val
-00021be0: 7565 2e0a 0a20 2020 2020 2020 2050 6172  ue...        Par
-00021bf0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-00021c00: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00021c10: 2020 2069 6e64 6578 203a 2073 6361 6c61     index : scala
-00021c20: 722c 2068 6173 6861 626c 6520 7365 7175  r, hashable sequ
-00021c30: 656e 6365 2c20 6469 6374 2d6c 696b 6520  ence, dict-like 
-00021c40: 6f72 2063 616c 6c61 626c 652c 206f 7074  or callable, opt
-00021c50: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00021c60: 2020 4966 2064 6963 742d 6c69 6b65 206f    If dict-like o
-00021c70: 7220 6361 6c6c 6162 6c65 2c20 7468 6520  r callable, the 
-00021c80: 7472 616e 7366 6f72 6d61 7469 6f6e 2069  transformation i
-00021c90: 7320 6170 706c 6965 6420 746f 2074 6865  s applied to the
-00021ca0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00021cb0: 6578 2e20 5363 616c 6172 206f 7220 6861  ex. Scalar or ha
-00021cc0: 7368 6162 6c65 2073 6571 7565 6e63 652d  shable sequence-
-00021cd0: 6c69 6b65 2077 696c 6c20 616c 7465 7220  like will alter 
-00021ce0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00021cf0: 6060 5365 7269 6573 2e6e 616d 6560 6020  ``Series.name`` 
-00021d00: 6174 7472 6962 7574 652e 0a20 2020 2020  attribute..     
-00021d10: 2020 2069 6e70 6c61 6365 203a 2062 6f6f     inplace : boo
-00021d20: 6c65 616e 2c20 6465 6661 756c 7420 4661  lean, default Fa
-00021d30: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00021d40: 5768 6574 6865 7220 746f 2072 6574 7572  Whether to retur
-00021d50: 6e20 6120 6e65 7720 5365 7269 6573 206f  n a new Series o
-00021d60: 7220 6d6f 6469 6679 2074 6869 7320 6f6e  r modify this on
-00021d70: 6520 696e 706c 6163 652e 0a20 2020 2020  e inplace..     
-00021d80: 2020 2073 6f72 7465 645f 696e 6465 7820     sorted_index 
-00021d90: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
-00021da0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00021db0: 2020 4966 2074 7275 652c 2074 6865 206f    If true, the o
-00021dc0: 7574 7075 7420 6060 5365 7269 6573 6060  utput ``Series``
-00021dd0: 2077 696c 6c20 6861 7665 206b 6e6f 776e   will have known
-00021de0: 2064 6976 6973 696f 6e73 2069 6e66 6572   divisions infer
-00021df0: 7265 640a 2020 2020 2020 2020 2020 2020  red.            
-00021e00: 6672 6f6d 2074 6865 2069 6e70 7574 2073  from the input s
-00021e10: 6572 6965 7320 616e 6420 7468 6520 7472  eries and the tr
-00021e20: 616e 7366 6f72 6d61 7469 6f6e 2e20 4967  ansformation. Ig
-00021e30: 6e6f 7265 6420 666f 720a 2020 2020 2020  nored for.      
-00021e40: 2020 2020 2020 6e6f 6e2d 6361 6c6c 6162        non-callab
-00021e50: 6c65 2f64 6963 742d 6c69 6b65 2060 6069  le/dict-like ``i
-00021e60: 6e64 6578 6060 206f 7220 7768 656e 2074  ndex`` or when t
-00021e70: 6865 2069 6e70 7574 2073 6572 6965 7320  he input series 
-00021e80: 6861 730a 2020 2020 2020 2020 2020 2020  has.            
-00021e90: 756e 6b6e 6f77 6e20 6469 7669 7369 6f6e  unknown division
-00021ea0: 732e 204e 6f74 6520 7468 6174 2074 6869  s. Note that thi
-00021eb0: 7320 6d61 7920 6f6e 6c79 2062 6520 7365  s may only be se
-00021ec0: 7420 746f 2060 6054 7275 6560 6020 6966  t to ``True`` if
-00021ed0: 0a20 2020 2020 2020 2020 2020 2079 6f75  .            you
-00021ee0: 206b 6e6f 7720 7468 6174 2074 6865 2074   know that the t
-00021ef0: 7261 6e73 666f 726d 6564 2069 6e64 6578  ransformed index
-00021f00: 2069 7320 6d6f 6e6f 746f 6e69 6361 6c6c   is monotonicall
-00021f10: 7920 696e 6372 6561 7369 6e67 2e20 4461  y increasing. Da
-00021f20: 736b 0a20 2020 2020 2020 2020 2020 2077  sk.            w
-00021f30: 696c 6c20 6368 6563 6b20 7468 6174 2074  ill check that t
-00021f40: 7261 6e73 666f 726d 6564 2064 6976 6973  ransformed divis
-00021f50: 696f 6e73 2061 7265 206d 6f6e 6f74 6f6e  ions are monoton
-00021f60: 6963 2c20 6275 7420 6361 6e6e 6f74 0a20  ic, but cannot. 
-00021f70: 2020 2020 2020 2020 2020 2063 6865 636b             check
-00021f80: 2061 6c6c 2074 6865 2076 616c 7565 7320   all the values 
-00021f90: 6265 7477 6565 6e20 6469 7669 7369 6f6e  between division
-00021fa0: 732c 2073 6f20 696e 636f 7272 6563 746c  s, so incorrectl
-00021fb0: 7920 7365 7474 696e 6720 7468 6973 0a20  y setting this. 
-00021fc0: 2020 2020 2020 2020 2020 2063 616e 2072             can r
-00021fd0: 6573 756c 7420 696e 2062 7567 732e 0a0a  esult in bugs...
-00021fe0: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-00021ff0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-00022000: 2020 2020 2020 2020 7265 6e61 6d65 6420          renamed 
-00022010: 3a20 5365 7269 6573 0a0a 2020 2020 2020  : Series..      
-00022020: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
-00022030: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00022040: 2020 2020 7061 6e64 6173 2e53 6572 6965      pandas.Serie
-00022050: 732e 7265 6e61 6d65 0a20 2020 2020 2020  s.rename.       
-00022060: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-00022070: 6d20 7061 6e64 6173 2e61 7069 2e74 7970  m pandas.api.typ
-00022080: 6573 2069 6d70 6f72 7420 6973 5f64 6963  es import is_dic
-00022090: 745f 6c69 6b65 2c20 6973 5f6c 6973 745f  t_like, is_list_
-000220a0: 6c69 6b65 2c20 6973 5f73 6361 6c61 720a  like, is_scalar.
-000220b0: 0a20 2020 2020 2020 2069 6d70 6f72 7420  .        import 
-000220c0: 6461 736b 2e64 6174 6166 7261 6d65 2061  dask.dataframe a
-000220d0: 7320 6464 0a0a 2020 2020 2020 2020 6966  s dd..        if
-000220e0: 2069 735f 7363 616c 6172 2869 6e64 6578   is_scalar(index
-000220f0: 2920 6f72 2028 0a20 2020 2020 2020 2020  ) or (.         
-00022100: 2020 2069 735f 6c69 7374 5f6c 696b 6528     is_list_like(
-00022110: 696e 6465 7829 0a20 2020 2020 2020 2020  index).         
-00022120: 2020 2061 6e64 206e 6f74 2069 735f 6469     and not is_di
-00022130: 6374 5f6c 696b 6528 696e 6465 7829 0a20  ct_like(index). 
-00022140: 2020 2020 2020 2020 2020 2061 6e64 206e             and n
-00022150: 6f74 2069 7369 6e73 7461 6e63 6528 696e  ot isinstance(in
-00022160: 6465 782c 2064 642e 5365 7269 6573 290a  dex, dd.Series).
-00022170: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-00022180: 2020 2020 2020 2069 6620 696e 706c 6163         if inplac
-00022190: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000221a0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-000221b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000221c0: 2020 2020 2020 2227 696e 706c 6163 6527        "'inplace'
-000221d0: 2061 7267 756d 656e 7420 666f 7220 6461   argument for da
-000221e0: 736b 2073 6572 6965 7320 7769 6c6c 2062  sk series will b
-000221f0: 6520 7265 6d6f 7665 6420 696e 2066 7574  e removed in fut
-00022200: 7572 6520 7665 7273 696f 6e73 222c 0a20  ure versions",. 
-00022210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022220: 2020 2050 656e 6469 6e67 4465 7072 6563     PendingDeprec
-00022230: 6174 696f 6e57 6172 6e69 6e67 2c0a 2020  ationWarning,.  
-00022240: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00022250: 2020 2020 2020 2020 2020 2020 7265 7320              res 
-00022260: 3d20 7365 6c66 2069 6620 696e 706c 6163  = self if inplac
-00022270: 6520 656c 7365 2073 656c 662e 636f 7079  e else self.copy
-00022280: 2829 0a20 2020 2020 2020 2020 2020 2072  ().            r
-00022290: 6573 2e6e 616d 6520 3d20 696e 6465 780a  es.name = index.
-000222a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000222b0: 2020 2020 2020 2020 2020 7265 7320 3d20            res = 
-000222c0: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-000222d0: 6f6e 7328 4d2e 7265 6e61 6d65 2c20 696e  ons(M.rename, in
-000222e0: 6465 782c 2065 6e66 6f72 6365 5f6d 6574  dex, enforce_met
-000222f0: 6164 6174 613d 4661 6c73 6529 0a20 2020  adata=False).   
-00022300: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00022310: 2e6b 6e6f 776e 5f64 6976 6973 696f 6e73  .known_divisions
-00022320: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00022330: 2020 6966 2073 6f72 7465 645f 696e 6465    if sorted_inde
-00022340: 7820 616e 6420 2863 616c 6c61 626c 6528  x and (callable(
-00022350: 696e 6465 7829 206f 7220 6973 5f64 6963  index) or is_dic
-00022360: 745f 6c69 6b65 2869 6e64 6578 2929 3a0a  t_like(index)):.
-00022370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022380: 2020 2020 6f6c 6420 3d20 7064 2e53 6572      old = pd.Ser
-00022390: 6965 7328 7261 6e67 6528 7365 6c66 2e6e  ies(range(self.n
-000223a0: 7061 7274 6974 696f 6e73 202b 2031 292c  partitions + 1),
-000223b0: 2069 6e64 6578 3d73 656c 662e 6469 7669   index=self.divi
-000223c0: 7369 6f6e 7329 0a20 2020 2020 2020 2020  sions).         
-000223d0: 2020 2020 2020 2020 2020 206e 6577 203d             new =
-000223e0: 206f 6c64 2e72 656e 616d 6528 696e 6465   old.rename(inde
-000223f0: 7829 2e69 6e64 6578 0a20 2020 2020 2020  x).index.       
-00022400: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00022410: 6e6f 7420 6e65 772e 6973 5f6d 6f6e 6f74  not new.is_monot
-00022420: 6f6e 6963 5f69 6e63 7265 6173 696e 673a  onic_increasing:
-00022430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022440: 2020 2020 2020 2020 206d 7367 203d 2028           msg = (
-00022450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022460: 2020 2020 2020 2020 2020 2020 2022 736f               "so
-00022470: 7274 6564 5f69 6e64 6578 3d54 7275 652c  rted_index=True,
-00022480: 2062 7574 2074 6865 2074 7261 6e73 666f   but the transfo
-00022490: 726d 6564 2069 6e64 6578 2022 0a20 2020  rmed index ".   
-000224a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000224b0: 2020 2020 2020 2020 2022 6973 6e27 7420           "isn't 
-000224c0: 6d6f 6e6f 746f 6e69 635f 696e 6372 6561  monotonic_increa
-000224d0: 7369 6e67 220a 2020 2020 2020 2020 2020  sing".          
-000224e0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000224f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022500: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00022510: 6c75 6545 7272 6f72 286d 7367 290a 2020  lueError(msg).  
-00022520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022530: 2020 7265 732e 5f64 6976 6973 696f 6e73    res._divisions
-00022540: 203d 2074 7570 6c65 286d 6574 686f 6473   = tuple(methods
-00022550: 2e74 6f6c 6973 7428 6e65 7729 290a 2020  .tolist(new)).  
-00022560: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00022570: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00022580: 2020 2020 2020 2020 7265 7320 3d20 7265          res = re
-00022590: 732e 636c 6561 725f 6469 7669 7369 6f6e  s.clear_division
-000225a0: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
-000225b0: 6966 2069 6e70 6c61 6365 3a0a 2020 2020  if inplace:.    
-000225c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000225d0: 2e64 6173 6b20 3d20 7265 732e 6461 736b  .dask = res.dask
-000225e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000225f0: 2073 656c 662e 5f6e 616d 6520 3d20 7265   self._name = re
-00022600: 732e 5f6e 616d 650a 2020 2020 2020 2020  s._name.        
-00022610: 2020 2020 2020 2020 7365 6c66 2e5f 6469          self._di
-00022620: 7669 7369 6f6e 7320 3d20 7265 732e 6469  visions = res.di
-00022630: 7669 7369 6f6e 730a 2020 2020 2020 2020  visions.        
-00022640: 2020 2020 2020 2020 7365 6c66 2e5f 6d65          self._me
-00022650: 7461 203d 2072 6573 2e5f 6d65 7461 0a20  ta = res._meta. 
-00022660: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00022670: 6573 203d 2073 656c 660a 2020 2020 2020  es = self.      
-00022680: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
-00022690: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-000226a0: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-000226b0: 6566 2072 6f75 6e64 2873 656c 662c 2064  ef round(self, d
-000226c0: 6563 696d 616c 733d 3029 3a0a 2020 2020  ecimals=0):.    
-000226d0: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
-000226e0: 6973 6528 4d2e 726f 756e 642c 2073 656c  ise(M.round, sel
-000226f0: 662c 2064 6563 696d 616c 7329 0a0a 2020  f, decimals)..  
-00022700: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00022710: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00022720: 2020 6465 6620 746f 5f74 696d 6573 7461    def to_timesta
-00022730: 6d70 2873 656c 662c 2066 7265 713d 4e6f  mp(self, freq=No
-00022740: 6e65 2c20 686f 773d 2273 7461 7274 222c  ne, how="start",
-00022750: 2061 7869 733d 3029 3a0a 2020 2020 2020   axis=0):.      
-00022760: 2020 6466 203d 2065 6c65 6d77 6973 6528    df = elemwise(
-00022770: 4d2e 746f 5f74 696d 6573 7461 6d70 2c20  M.to_timestamp, 
-00022780: 7365 6c66 2c20 6672 6571 2c20 686f 772c  self, freq, how,
-00022790: 2061 7869 7329 0a20 2020 2020 2020 2064   axis).        d
-000227a0: 662e 6469 7669 7369 6f6e 7320 3d20 7475  f.divisions = tu
-000227b0: 706c 6528 7064 2e49 6e64 6578 2873 656c  ple(pd.Index(sel
-000227c0: 662e 6469 7669 7369 6f6e 7329 2e74 6f5f  f.divisions).to_
-000227d0: 7469 6d65 7374 616d 7028 2929 0a20 2020  timestamp()).   
-000227e0: 2020 2020 2072 6574 7572 6e20 6466 0a0a       return df..
-000227f0: 2020 2020 6465 6620 7175 616e 7469 6c65      def quantile
-00022800: 2873 656c 662c 2071 3d30 2e35 2c20 6d65  (self, q=0.5, me
-00022810: 7468 6f64 3d22 6465 6661 756c 7422 293a  thod="default"):
-00022820: 0a20 2020 2020 2020 2022 2222 4170 7072  .        """Appr
-00022830: 6f78 696d 6174 6520 7175 616e 7469 6c65  oximate quantile
-00022840: 7320 6f66 2053 6572 6965 730a 0a20 2020  s of Series..   
-00022850: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00022860: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00022870: 2d2d 0a20 2020 2020 2020 2071 203a 206c  --.        q : l
-00022880: 6973 742f 6172 7261 7920 6f66 2066 6c6f  ist/array of flo
-00022890: 6174 732c 2064 6566 6175 6c74 2030 2e35  ats, default 0.5
-000228a0: 2028 3530 2529 0a20 2020 2020 2020 2020   (50%).         
-000228b0: 2020 2049 7465 7261 626c 6520 6f66 206e     Iterable of n
-000228c0: 756d 6265 7273 2072 616e 6769 6e67 2066  umbers ranging f
-000228d0: 726f 6d20 3020 746f 2031 2066 6f72 2074  rom 0 to 1 for t
-000228e0: 6865 2064 6573 6972 6564 2071 7561 6e74  he desired quant
-000228f0: 696c 6573 0a20 2020 2020 2020 206d 6574  iles.        met
-00022900: 686f 6420 3a20 7b27 6465 6661 756c 7427  hod : {'default'
-00022910: 2c20 2774 6469 6765 7374 272c 2027 6461  , 'tdigest', 'da
-00022920: 736b 277d 2c20 6f70 7469 6f6e 616c 0a20  sk'}, optional. 
-00022930: 2020 2020 2020 2020 2020 2057 6861 7420             What 
-00022940: 6d65 7468 6f64 2074 6f20 7573 652e 2042  method to use. B
-00022950: 7920 6465 6661 756c 7420 7769 6c6c 2075  y default will u
-00022960: 7365 2064 6173 6b27 7320 696e 7465 726e  se dask's intern
-00022970: 616c 2063 7573 746f 6d0a 2020 2020 2020  al custom.      
-00022980: 2020 2020 2020 616c 676f 7269 7468 6d20        algorithm 
-00022990: 2860 6027 6461 736b 2760 6029 2e20 2049  (``'dask'``).  I
-000229a0: 6620 7365 7420 746f 2060 6027 7464 6967  f set to ``'tdig
-000229b0: 6573 7427 6060 2077 696c 6c20 7573 6520  est'`` will use 
-000229c0: 7464 6967 6573 740a 2020 2020 2020 2020  tdigest.        
-000229d0: 2020 2020 666f 7220 666c 6f61 7473 2061      for floats a
-000229e0: 6e64 2069 6e74 7320 616e 6420 6661 6c6c  nd ints and fall
-000229f0: 6261 636b 2074 6f20 7468 6520 6060 2764  back to the ``'d
-00022a00: 6173 6b27 6060 206f 7468 6572 7769 7365  ask'`` otherwise
-00022a10: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00022a20: 2020 2020 2020 7265 7475 726e 2071 7561        return qua
-00022a30: 6e74 696c 6528 7365 6c66 2c20 712c 206d  ntile(self, q, m
-00022a40: 6574 686f 643d 6d65 7468 6f64 290a 0a20  ethod=method).. 
-00022a50: 2020 2064 6566 206d 6564 6961 6e5f 6170     def median_ap
-00022a60: 7072 6f78 696d 6174 6528 7365 6c66 2c20  proximate(self, 
-00022a70: 6d65 7468 6f64 3d22 6465 6661 756c 7422  method="default"
-00022a80: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-00022a90: 7475 726e 2074 6865 2061 7070 726f 7869  turn the approxi
-00022aa0: 6d61 7465 206d 6564 6961 6e20 6f66 2074  mate median of t
-00022ab0: 6865 2076 616c 7565 7320 6f76 6572 2074  he values over t
-00022ac0: 6865 2072 6571 7565 7374 6564 2061 7869  he requested axi
-00022ad0: 732e 0a0a 2020 2020 2020 2020 5061 7261  s...        Para
-00022ae0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-00022af0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00022b00: 2020 6d65 7468 6f64 203a 207b 2764 6566    method : {'def
-00022b10: 6175 6c74 272c 2027 7464 6967 6573 7427  ault', 'tdigest'
-00022b20: 2c20 2764 6173 6b27 7d2c 206f 7074 696f  , 'dask'}, optio
-00022b30: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00022b40: 5768 6174 206d 6574 686f 6420 746f 2075  What method to u
-00022b50: 7365 2e20 4279 2064 6566 6175 6c74 2077  se. By default w
-00022b60: 696c 6c20 7573 6520 4461 736b 2773 2069  ill use Dask's i
-00022b70: 6e74 6572 6e61 6c20 6375 7374 6f6d 0a20  nternal custom. 
-00022b80: 2020 2020 2020 2020 2020 2061 6c67 6f72             algor
-00022b90: 6974 686d 2028 6060 2264 6173 6b22 6060  ithm (``"dask"``
-00022ba0: 292e 2020 4966 2073 6574 2074 6f20 6060  ).  If set to ``
-00022bb0: 2274 6469 6765 7374 2260 6020 7769 6c6c  "tdigest"`` will
-00022bc0: 2075 7365 2074 6469 6765 7374 0a20 2020   use tdigest.   
-00022bd0: 2020 2020 2020 2020 2066 6f72 2066 6c6f           for flo
-00022be0: 6174 7320 616e 6420 696e 7473 2061 6e64  ats and ints and
-00022bf0: 2066 616c 6c62 6163 6b20 746f 2074 6865   fallback to the
-00022c00: 2060 6022 6461 736b 2260 6020 6f74 6865   ``"dask"`` othe
-00022c10: 7277 6973 652e 0a20 2020 2020 2020 2022  rwise..        "
-00022c20: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00022c30: 6e20 7365 6c66 2e71 7561 6e74 696c 6528  n self.quantile(
-00022c40: 713d 302e 352c 206d 6574 686f 643d 6d65  q=0.5, method=me
-00022c50: 7468 6f64 290a 0a20 2020 2040 6465 7269  thod)..    @deri
-00022c60: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
-00022c70: 6573 290a 2020 2020 6465 6620 6d65 6469  es).    def medi
-00022c80: 616e 2873 656c 662c 206d 6574 686f 643d  an(self, method=
-00022c90: 2264 6566 6175 6c74 2229 3a0a 2020 2020  "default"):.    
-00022ca0: 2020 2020 6966 2073 656c 662e 6e70 6172      if self.npar
-00022cb0: 7469 7469 6f6e 7320 3d3d 2031 3a0a 2020  titions == 1:.  
-00022cc0: 2020 2020 2020 2020 2020 2320 4361 6e20            # Can 
-00022cd0: 7072 6f76 6964 6520 616e 2065 7861 6374  provide an exact
-00022ce0: 206d 6564 6961 6e20 696e 2074 6865 7365   median in these
-00022cf0: 2063 6173 6573 0a20 2020 2020 2020 2020   cases.         
-00022d00: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00022d10: 6564 6961 6e5f 6170 7072 6f78 696d 6174  edian_approximat
-00022d20: 6528 6d65 7468 6f64 3d6d 6574 686f 6429  e(method=method)
-00022d30: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
-00022d40: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-00022d50: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00022d60: 2244 6173 6b20 646f 6573 6e27 7420 696d  "Dask doesn't im
-00022d70: 706c 656d 656e 7420 616e 2065 7861 6374  plement an exact
-00022d80: 206d 6564 6961 6e20 696e 2061 6c6c 2063   median in all c
-00022d90: 6173 6573 2061 7320 7468 6973 2069 7320  ases as this is 
-00022da0: 6861 7264 2074 6f20 646f 2069 6e20 7061  hard to do in pa
-00022db0: 7261 6c6c 656c 2e20 220a 2020 2020 2020  rallel. ".      
-00022dc0: 2020 2020 2020 2253 6565 2074 6865 2060        "See the `
-00022dd0: 6d65 6469 616e 5f61 7070 726f 7869 6d61  median_approxima
-00022de0: 7465 6020 6d65 7468 6f64 2069 6e73 7465  te` method inste
-00022df0: 6164 2c20 7768 6963 6820 7573 6573 2061  ad, which uses a
-00022e00: 6e20 6170 7072 6f78 696d 6174 6520 616c  n approximate al
-00022e10: 676f 7269 7468 6d2e 220a 2020 2020 2020  gorithm.".      
-00022e20: 2020 290a 0a20 2020 2064 6566 205f 7265    )..    def _re
-00022e30: 7061 7274 6974 696f 6e5f 7175 616e 7469  partition_quanti
-00022e40: 6c65 7328 7365 6c66 2c20 6e70 6172 7469  les(self, nparti
-00022e50: 7469 6f6e 732c 2075 7073 616d 706c 653d  tions, upsample=
-00022e60: 312e 3029 3a0a 2020 2020 2020 2020 2222  1.0):.        ""
-00022e70: 2241 7070 726f 7869 6d61 7465 2071 7561  "Approximate qua
-00022e80: 6e74 696c 6573 206f 6620 5365 7269 6573  ntiles of Series
-00022e90: 2075 7365 6420 666f 7220 7265 7061 7274   used for repart
-00022ea0: 6974 696f 6e69 6e67 2222 220a 2020 2020  itioning""".    
-00022eb0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-00022ec0: 7461 6672 616d 652e 7061 7274 6974 696f  taframe.partitio
-00022ed0: 6e71 7561 6e74 696c 6573 2069 6d70 6f72  nquantiles impor
-00022ee0: 7420 7061 7274 6974 696f 6e5f 7175 616e  t partition_quan
-00022ef0: 7469 6c65 730a 0a20 2020 2020 2020 2072  tiles..        r
-00022f00: 6574 7572 6e20 7061 7274 6974 696f 6e5f  eturn partition_
-00022f10: 7175 616e 7469 6c65 7328 7365 6c66 2c20  quantiles(self, 
-00022f20: 6e70 6172 7469 7469 6f6e 732c 2075 7073  npartitions, ups
-00022f30: 616d 706c 653d 7570 7361 6d70 6c65 290a  ample=upsample).
-00022f40: 0a20 2020 2064 6566 205f 5f67 6574 6974  .    def __getit
-00022f50: 656d 5f5f 2873 656c 662c 206b 6579 293a  em__(self, key):
-00022f60: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00022f70: 7374 616e 6365 286b 6579 2c20 5365 7269  stance(key, Seri
-00022f80: 6573 2920 616e 6420 7365 6c66 2e64 6976  es) and self.div
-00022f90: 6973 696f 6e73 203d 3d20 6b65 792e 6469  isions == key.di
-00022fa0: 7669 7369 6f6e 733a 0a20 2020 2020 2020  visions:.       
-00022fb0: 2020 2020 206e 616d 6520 3d20 2269 6e64       name = "ind
-00022fc0: 6578 2d25 7322 2025 2074 6f6b 656e 697a  ex-%s" % tokeniz
-00022fd0: 6528 7365 6c66 2c20 6b65 7929 0a20 2020  e(self, key).   
-00022fe0: 2020 2020 2020 2020 2064 736b 203d 2070           dsk = p
-00022ff0: 6172 7469 7469 6f6e 7769 7365 5f67 7261  artitionwise_gra
-00023000: 7068 286f 7065 7261 746f 722e 6765 7469  ph(operator.geti
-00023010: 7465 6d2c 206e 616d 652c 2073 656c 662c  tem, name, self,
-00023020: 206b 6579 290a 2020 2020 2020 2020 2020   key).          
-00023030: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-00023040: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-00023050: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
-00023060: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
-00023070: 733d 5b73 656c 662c 206b 6579 5d29 0a20  s=[self, key]). 
-00023080: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00023090: 6e20 5365 7269 6573 2867 7261 7068 2c20  n Series(graph, 
-000230a0: 6e61 6d65 2c20 7365 6c66 2e5f 6d65 7461  name, self._meta
-000230b0: 2c20 7365 6c66 2e64 6976 6973 696f 6e73  , self.divisions
-000230c0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000230d0: 2073 656c 662e 6c6f 635b 6b65 795d 0a0a   self.loc[key]..
-000230e0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-000230f0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-00023100: 2020 2020 6465 6620 5f67 6574 5f6e 756d      def _get_num
-00023110: 6572 6963 5f64 6174 6128 7365 6c66 2c20  eric_data(self, 
-00023120: 686f 773d 2261 6e79 222c 2073 7562 7365  how="any", subse
-00023130: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
-00023140: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
-00023150: 2020 6966 206e 6f74 2050 414e 4441 535f    if not PANDAS_
-00023160: 4754 5f32 3030 3a0a 0a20 2020 2020 2020  GT_200:..       
-00023170: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00023180: 642e 5365 7269 6573 290a 2020 2020 2020  d.Series).      
-00023190: 2020 6465 6620 6974 6572 6974 656d 7328    def iteritems(
-000231a0: 7365 6c66 293a 0a20 2020 2020 2020 2020  self):.         
-000231b0: 2020 2069 6620 5041 4e44 4153 5f47 545f     if PANDAS_GT_
-000231c0: 3135 303a 0a20 2020 2020 2020 2020 2020  150:.           
-000231d0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-000231e0: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
-000231f0: 2020 2020 2020 2020 2269 7465 7269 7465          "iterite
-00023200: 6d73 2069 7320 6465 7072 6563 6174 6564  ms is deprecated
-00023210: 2061 6e64 2077 696c 6c20 6265 2072 656d   and will be rem
-00023220: 6f76 6564 2069 6e20 6120 6675 7475 7265  oved in a future
-00023230: 2076 6572 7369 6f6e 2e20 220a 2020 2020   version. ".    
-00023240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023250: 2255 7365 202e 6974 656d 7320 696e 7374  "Use .items inst
-00023260: 6561 642e 222c 0a20 2020 2020 2020 2020  ead.",.         
-00023270: 2020 2020 2020 2020 2020 2046 7574 7572             Futur
-00023280: 6557 6172 6e69 6e67 2c0a 2020 2020 2020  eWarning,.      
-00023290: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000232a0: 2020 2020 2020 2020 2320 5765 2075 7365          # We use
-000232b0: 2074 6865 2060 5f60 2067 656e 6572 6174   the `_` generat
-000232c0: 6f72 2062 656c 6f77 2074 6f20 656e 7375  or below to ensu
-000232d0: 7265 2074 6865 2064 6570 7265 6361 7469  re the deprecati
-000232e0: 6f6e 2077 6172 6e69 6e67 2061 626f 7665  on warning above
-000232f0: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
-00023300: 7320 7261 6973 6564 2077 6865 6e20 602e  s raised when `.
-00023310: 6974 6572 6974 656d 7328 2960 2069 7320  iteritems()` is 
-00023320: 6361 6c6c 6564 2c20 6e6f 7420 7768 656e  called, not when
-00023330: 2074 6865 2066 6972 7374 2060 6e65 7874   the first `next
-00023340: 283c 6765 6e65 7261 746f 723e 2960 0a20  (<generator>)`. 
-00023350: 2020 2020 2020 2020 2020 2023 2069 7465             # ite
-00023360: 7261 7469 6f6e 2068 6170 7065 6e73 0a0a  ration happens..
-00023370: 2020 2020 2020 2020 2020 2020 6465 6620              def 
-00023380: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00023390: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-000233a0: 6e20 7261 6e67 6528 7365 6c66 2e6e 7061  n range(self.npa
-000233b0: 7274 6974 696f 6e73 293a 0a20 2020 2020  rtitions):.     
-000233c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000233d0: 203d 2073 656c 662e 6765 745f 7061 7274   = self.get_part
-000233e0: 6974 696f 6e28 6929 2e63 6f6d 7075 7465  ition(i).compute
-000233f0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-00023400: 2020 2020 2020 2079 6965 6c64 2066 726f         yield fro
-00023410: 6d20 732e 6974 656d 7328 290a 0a20 2020  m s.items()..   
-00023420: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00023430: 5f28 7365 6c66 290a 0a20 2020 2040 6465  _(self)..    @de
-00023440: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00023450: 7269 6573 290a 2020 2020 6465 6620 5f5f  ries).    def __
-00023460: 6974 6572 5f5f 2873 656c 6629 3a0a 2020  iter__(self):.  
-00023470: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00023480: 616e 6765 2873 656c 662e 6e70 6172 7469  ange(self.nparti
-00023490: 7469 6f6e 7329 3a0a 2020 2020 2020 2020  tions):.        
-000234a0: 2020 2020 7320 3d20 7365 6c66 2e67 6574      s = self.get
-000234b0: 5f70 6172 7469 7469 6f6e 2869 292e 636f  _partition(i).co
-000234c0: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
-000234d0: 2020 2020 7969 656c 6420 6672 6f6d 2073      yield from s
-000234e0: 0a0a 2020 2020 405f 6465 7072 6563 6174  ..    @_deprecat
-000234f0: 6564 280a 2020 2020 2020 2020 6d65 7373  ed(.        mess
-00023500: 6167 653d 280a 2020 2020 2020 2020 2020  age=(.          
-00023510: 2020 2255 7369 6e67 2074 6865 2060 6069    "Using the ``i
-00023520: 6e60 6020 6f70 6572 6174 6f72 2074 6f20  n`` operator to 
-00023530: 7465 7374 2066 6f72 206d 656d 6265 7273  test for members
-00023540: 6869 7020 696e 2053 6572 6965 7320 6973  hip in Series is
-00023550: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
-00023560: 6465 7072 6563 6174 6564 2e20 546f 2074  deprecated. To t
-00023570: 6573 7420 666f 7220 6d65 6d62 6572 7368  est for membersh
-00023580: 6970 2069 6e20 7468 6520 696e 6465 7820  ip in the index 
-00023590: 7573 6520 220a 2020 2020 2020 2020 2020  use ".          
-000235a0: 2020 2260 6028 732e 696e 6465 7820 3d3d    "``(s.index ==
-000235b0: 206b 6579 292e 616e 7928 2960 602e 2053   key).any()``. S
-000235c0: 696d 696c 6172 6c79 2074 6f20 7465 7374  imilarly to test
-000235d0: 2066 6f72 206d 656d 6265 7273 6869 7020   for membership 
-000235e0: 696e 2022 0a20 2020 2020 2020 2020 2020  in ".           
-000235f0: 2022 7468 6520 7661 6c75 6573 2075 7365   "the values use
-00023600: 2060 6028 7320 3d3d 206b 6579 292e 616e   ``(s == key).an
-00023610: 7928 2960 6022 0a20 2020 2020 2020 2029  y()``".        )
-00023620: 0a20 2020 2029 0a20 2020 2064 6566 205f  .    ).    def _
-00023630: 5f63 6f6e 7461 696e 735f 5f28 7365 6c66  _contains__(self
-00023640: 2c20 6b65 7929 3a0a 2020 2020 2020 2020  , key):.        
-00023650: 7265 7475 726e 2028 7365 6c66 203d 3d20  return (self == 
-00023660: 6b65 7929 2e61 6e79 2829 2e63 6f6d 7075  key).any().compu
-00023670: 7465 2829 0a0a 2020 2020 4063 6c61 7373  te()..    @class
-00023680: 6d65 7468 6f64 0a20 2020 2064 6566 205f  method.    def _
-00023690: 7661 6c69 6461 7465 5f61 7869 7328 636c  validate_axis(cl
-000236a0: 732c 2061 7869 733d 302c 206e 6f6e 655f  s, axis=0, none_
-000236b0: 6973 5f7a 6572 6f3a 2062 6f6f 6c20 3d20  is_zero: bool = 
-000236c0: 5472 7565 2920 2d3e 204e 6f6e 6520 7c20  True) -> None | 
-000236d0: 4c69 7465 7261 6c5b 302c 2031 5d3a 0a20  Literal[0, 1]:. 
-000236e0: 2020 2020 2020 2069 6620 6178 6973 206e         if axis n
-000236f0: 6f74 2069 6e20 2830 2c20 2269 6e64 6578  ot in (0, "index
-00023700: 222c 204e 6f6e 6529 3a0a 2020 2020 2020  ", None):.      
-00023710: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00023720: 6545 7272 6f72 2866 224e 6f20 6178 6973  eError(f"No axis
-00023730: 206e 616d 6564 207b 6178 6973 7d22 290a   named {axis}").
-00023740: 2020 2020 2020 2020 2320 636f 6e76 6572          # conver
-00023750: 7420 746f 206e 756d 6572 6963 2061 7869  t to numeric axi
-00023760: 730a 2020 2020 2020 2020 6e75 6d65 7269  s.        numeri
-00023770: 635f 6178 6973 3a20 6469 6374 5b73 7472  c_axis: dict[str
-00023780: 207c 204e 6f6e 652c 204c 6974 6572 616c   | None, Literal
-00023790: 5b30 2c20 315d 5d20 3d20 7b22 696e 6465  [0, 1]] = {"inde
-000237a0: 7822 3a20 307d 0a20 2020 2020 2020 2069  x": 0}.        i
-000237b0: 6620 6e6f 6e65 5f69 735f 7a65 726f 3a0a  f none_is_zero:.
-000237c0: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
-000237d0: 7269 635f 6178 6973 5b4e 6f6e 655d 203d  ric_axis[None] =
-000237e0: 2030 0a20 2020 2020 2020 2072 6574 7572   0.        retur
-000237f0: 6e20 6e75 6d65 7269 635f 6178 6973 2e67  n numeric_axis.g
-00023800: 6574 2861 7869 732c 2061 7869 7329 0a0a  et(axis, axis)..
-00023810: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00023820: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-00023830: 2064 6566 2067 726f 7570 6279 280a 2020   def groupby(.  
-00023840: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00023850: 2020 2020 6279 3d4e 6f6e 652c 0a20 2020      by=None,.   
-00023860: 2020 2020 2067 726f 7570 5f6b 6579 733d       group_keys=
-00023870: 4752 4f55 505f 4b45 5953 5f44 4546 4155  GROUP_KEYS_DEFAU
-00023880: 4c54 2c0a 2020 2020 2020 2020 736f 7274  LT,.        sort
-00023890: 3d4e 6f6e 652c 0a20 2020 2020 2020 206f  =None,.        o
-000238a0: 6273 6572 7665 643d 4e6f 6e65 2c0a 2020  bserved=None,.  
-000238b0: 2020 2020 2020 6472 6f70 6e61 3d4e 6f6e        dropna=Non
-000238c0: 652c 0a20 2020 2020 2020 202a 2a6b 7761  e,.        **kwa
-000238d0: 7267 732c 0a20 2020 2029 3a0a 2020 2020  rgs,.    ):.    
-000238e0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-000238f0: 7461 6672 616d 652e 6772 6f75 7062 7920  taframe.groupby 
-00023900: 696d 706f 7274 2053 6572 6965 7347 726f  import SeriesGro
-00023910: 7570 4279 0a0a 2020 2020 2020 2020 7265  upBy..        re
-00023920: 7475 726e 2053 6572 6965 7347 726f 7570  turn SeriesGroup
-00023930: 4279 280a 2020 2020 2020 2020 2020 2020  By(.            
-00023940: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
-00023950: 2020 6279 3d62 792c 0a20 2020 2020 2020    by=by,.       
-00023960: 2020 2020 2067 726f 7570 5f6b 6579 733d       group_keys=
-00023970: 6772 6f75 705f 6b65 7973 2c0a 2020 2020  group_keys,.    
-00023980: 2020 2020 2020 2020 736f 7274 3d73 6f72          sort=sor
-00023990: 742c 0a20 2020 2020 2020 2020 2020 206f  t,.            o
-000239a0: 6273 6572 7665 643d 6f62 7365 7276 6564  bserved=observed
-000239b0: 2c0a 2020 2020 2020 2020 2020 2020 6472  ,.            dr
-000239c0: 6f70 6e61 3d64 726f 706e 612c 0a20 2020  opna=dropna,.   
-000239d0: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
-000239e0: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
-000239f0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00023a00: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-00023a10: 6566 2063 6f75 6e74 2873 656c 662c 2073  ef count(self, s
-00023a20: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-00023a30: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00023a40: 6e20 7375 7065 7228 292e 636f 756e 7428  n super().count(
-00023a50: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00023a60: 745f 6576 6572 7929 0a0a 2020 2020 4064  t_every)..    @d
-00023a70: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
-00023a80: 6572 6965 7329 0a20 2020 2064 6566 206d  eries).    def m
-00023a90: 6f64 6528 7365 6c66 2c20 6472 6f70 6e61  ode(self, dropna
-00023aa0: 3d54 7275 652c 2073 706c 6974 5f65 7665  =True, split_eve
-00023ab0: 7279 3d46 616c 7365 293a 0a20 2020 2020  ry=False):.     
-00023ac0: 2020 2072 6574 7572 6e20 7375 7065 7228     return super(
-00023ad0: 292e 6d6f 6465 2864 726f 706e 613d 6472  ).mode(dropna=dr
-00023ae0: 6f70 6e61 2c20 7370 6c69 745f 6576 6572  opna, split_ever
-00023af0: 793d 7370 6c69 745f 6576 6572 7929 0a0a  y=split_every)..
-00023b00: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00023b10: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-00023b20: 2064 6566 2065 7870 6c6f 6465 2873 656c   def explode(sel
-00023b30: 6629 3a0a 2020 2020 2020 2020 6d65 7461  f):.        meta
-00023b40: 203d 2073 656c 662e 5f6d 6574 612e 6578   = self._meta.ex
-00023b50: 706c 6f64 6528 290a 2020 2020 2020 2020  plode().        
-00023b60: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-00023b70: 7061 7274 6974 696f 6e73 284d 2e65 7870  partitions(M.exp
-00023b80: 6c6f 6465 2c20 6d65 7461 3d6d 6574 612c  lode, meta=meta,
-00023b90: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-00023ba0: 613d 4661 6c73 6529 0a0a 2020 2020 6465  a=False)..    de
-00023bb0: 6620 756e 6971 7565 2873 656c 662c 2073  f unique(self, s
-00023bc0: 706c 6974 5f65 7665 7279 3d4e 6f6e 652c  plit_every=None,
-00023bd0: 2073 706c 6974 5f6f 7574 3d31 293a 0a20   split_out=1):. 
-00023be0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00023bf0: 2020 2052 6574 7572 6e20 5365 7269 6573     Return Series
-00023c00: 206f 6620 756e 6971 7565 2076 616c 7565   of unique value
-00023c10: 7320 696e 2074 6865 206f 626a 6563 742e  s in the object.
-00023c20: 2049 6e63 6c75 6465 7320 4e41 2076 616c   Includes NA val
-00023c30: 7565 732e 0a0a 2020 2020 2020 2020 5265  ues...        Re
-00023c40: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-00023c50: 2d2d 2d2d 2d0a 2020 2020 2020 2020 756e  -----.        un
-00023c60: 6971 7565 7320 3a20 5365 7269 6573 0a20  iques : Series. 
-00023c70: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00023c80: 2020 2072 6574 7572 6e20 6163 6128 0a20     return aca(. 
-00023c90: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-00023ca0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-00023cb0: 6e6b 3d6d 6574 686f 6473 2e75 6e69 7175  nk=methods.uniqu
-00023cc0: 652c 0a20 2020 2020 2020 2020 2020 2061  e,.            a
-00023cd0: 6767 7265 6761 7465 3d6d 6574 686f 6473  ggregate=methods
-00023ce0: 2e75 6e69 7175 652c 0a20 2020 2020 2020  .unique,.       
-00023cf0: 2020 2020 206d 6574 613d 7365 6c66 2e5f       meta=self._
-00023d00: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-00023d10: 2020 746f 6b65 6e3d 2275 6e69 7175 6522    token="unique"
-00023d20: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
-00023d30: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-00023d40: 6576 6572 792c 0a20 2020 2020 2020 2020  every,.         
-00023d50: 2020 2073 6572 6965 735f 6e61 6d65 3d73     series_name=s
-00023d60: 656c 662e 6e61 6d65 2c0a 2020 2020 2020  elf.name,.      
-00023d70: 2020 2020 2020 7370 6c69 745f 6f75 743d        split_out=
-00023d80: 7370 6c69 745f 6f75 742c 0a20 2020 2020  split_out,.     
-00023d90: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
-00023da0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-00023db0: 7329 0a20 2020 2064 6566 206e 756e 6971  s).    def nuniq
-00023dc0: 7565 2873 656c 662c 2073 706c 6974 5f65  ue(self, split_e
-00023dd0: 7665 7279 3d4e 6f6e 652c 2064 726f 706e  very=None, dropn
-00023de0: 613d 5472 7565 293a 0a20 2020 2020 2020  a=True):.       
-00023df0: 2075 6e69 7173 203d 2073 656c 662e 6472   uniqs = self.dr
-00023e00: 6f70 5f64 7570 6c69 6361 7465 7328 7370  op_duplicates(sp
-00023e10: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-00023e20: 6576 6572 7929 0a20 2020 2020 2020 2069  every).        i
-00023e30: 6620 6472 6f70 6e61 3a0a 2020 2020 2020  f dropna:.      
-00023e40: 2020 2020 2020 2320 636f 756e 7420 6d69        # count mi
-00023e50: 6d69 6373 2070 616e 6461 7320 6265 6861  mics pandas beha
-00023e60: 7669 6f72 2061 6e64 2065 7863 6c75 6465  vior and exclude
-00023e70: 7320 4e41 2076 616c 7565 730a 2020 2020  s NA values.    
-00023e80: 2020 2020 2020 2020 7265 7475 726e 2075          return u
-00023e90: 6e69 7173 2e63 6f75 6e74 2829 0a20 2020  niqs.count().   
-00023ea0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00023eb0: 2020 2020 2020 2072 6574 7572 6e20 756e         return un
-00023ec0: 6971 732e 7369 7a65 0a0a 2020 2020 4064  iqs.size..    @d
-00023ed0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
-00023ee0: 6572 6965 7329 0a20 2020 2064 6566 2076  eries).    def v
-00023ef0: 616c 7565 5f63 6f75 6e74 7328 0a20 2020  alue_counts(.   
-00023f00: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00023f10: 2020 2073 6f72 743d 4e6f 6e65 2c0a 2020     sort=None,.  
-00023f20: 2020 2020 2020 6173 6365 6e64 696e 673d        ascending=
-00023f30: 4661 6c73 652c 0a20 2020 2020 2020 2064  False,.        d
-00023f40: 726f 706e 613d 4e6f 6e65 2c0a 2020 2020  ropna=None,.    
-00023f50: 2020 2020 6e6f 726d 616c 697a 653d 4661      normalize=Fa
-00023f60: 6c73 652c 0a20 2020 2020 2020 2073 706c  lse,.        spl
-00023f70: 6974 5f65 7665 7279 3d4e 6f6e 652c 0a20  it_every=None,. 
-00023f80: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
-00023f90: 3d31 2c0a 2020 2020 293a 0a20 2020 2020  =1,.    ):.     
-00023fa0: 2020 2022 2222 0a20 2020 2020 2020 204e     """.        N
-00023fb0: 6f74 653a 2064 726f 706e 6120 6973 206f  ote: dropna is o
-00023fc0: 6e6c 7920 7375 7070 6f72 7465 6420 696e  nly supported in
-00023fd0: 2070 616e 6461 7320 3e3d 2031 2e31 2e30   pandas >= 1.1.0
-00023fe0: 2c20 696e 2077 6869 6368 2063 6173 6520  , in which case 
-00023ff0: 6974 2064 6566 6175 6c74 7320 746f 0a20  it defaults to. 
-00024000: 2020 2020 2020 2054 7275 652e 0a20 2020         True..   
-00024010: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00024020: 206b 7761 7267 7320 3d20 7b22 736f 7274   kwargs = {"sort
-00024030: 223a 2073 6f72 742c 2022 6173 6365 6e64  ": sort, "ascend
-00024040: 696e 6722 3a20 6173 6365 6e64 696e 677d  ing": ascending}
-00024050: 0a20 2020 2020 2020 2069 6620 6472 6f70  .        if drop
-00024060: 6e61 2069 7320 6e6f 7420 4e6f 6e65 3a0a  na is not None:.
-00024070: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
-00024080: 6773 5b22 6472 6f70 6e61 225d 203d 2064  gs["dropna"] = d
-00024090: 726f 706e 610a 2020 2020 2020 2020 6167  ropna.        ag
-000240a0: 6772 6567 6174 655f 6b77 6172 6773 203d  gregate_kwargs =
-000240b0: 207b 226e 6f72 6d61 6c69 7a65 223a 206e   {"normalize": n
-000240c0: 6f72 6d61 6c69 7a65 7d0a 2020 2020 2020  ormalize}.      
-000240d0: 2020 6966 2073 706c 6974 5f6f 7574 203e    if split_out >
-000240e0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-000240f0: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
-00024100: 5b22 746f 7461 6c5f 6c65 6e67 7468 225d  ["total_length"]
-00024110: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00024120: 2020 2020 206c 656e 2873 656c 6629 2069       len(self) i
-00024130: 6620 6472 6f70 6e61 2069 7320 4661 6c73  f dropna is Fals
-00024140: 6520 656c 7365 206c 656e 2873 656c 662e  e else len(self.
-00024150: 6472 6f70 6e61 2829 290a 2020 2020 2020  dropna()).      
-00024160: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00024170: 2072 6574 7572 6e20 6163 6128 0a20 2020   return aca(.   
-00024180: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-00024190: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
-000241a0: 3d4d 2e76 616c 7565 5f63 6f75 6e74 732c  =M.value_counts,
-000241b0: 0a20 2020 2020 2020 2020 2020 2061 6767  .            agg
-000241c0: 7265 6761 7465 3d6d 6574 686f 6473 2e76  regate=methods.v
-000241d0: 616c 7565 5f63 6f75 6e74 735f 6167 6772  alue_counts_aggr
-000241e0: 6567 6174 652c 0a20 2020 2020 2020 2020  egate,.         
-000241f0: 2020 2063 6f6d 6269 6e65 3d6d 6574 686f     combine=metho
-00024200: 6473 2e76 616c 7565 5f63 6f75 6e74 735f  ds.value_counts_
-00024210: 636f 6d62 696e 652c 0a20 2020 2020 2020  combine,.       
-00024220: 2020 2020 206d 6574 613d 7365 6c66 2e5f       meta=self._
-00024230: 6d65 7461 2e76 616c 7565 5f63 6f75 6e74  meta.value_count
-00024240: 7328 6e6f 726d 616c 697a 653d 6e6f 726d  s(normalize=norm
-00024250: 616c 697a 6529 2c0a 2020 2020 2020 2020  alize),.        
-00024260: 2020 2020 746f 6b65 6e3d 2276 616c 7565      token="value
-00024270: 2d63 6f75 6e74 7322 2c0a 2020 2020 2020  -counts",.      
-00024280: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-00024290: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
-000242a0: 2020 2020 2020 2020 2020 2073 706c 6974             split
-000242b0: 5f6f 7574 3d73 706c 6974 5f6f 7574 2c0a  _out=split_out,.
-000242c0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-000242d0: 745f 6f75 745f 7365 7475 703d 7370 6c69  t_out_setup=spli
-000242e0: 745f 6f75 745f 6f6e 5f69 6e64 6578 2c0a  t_out_on_index,.
-000242f0: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
-00024300: 6567 6174 655f 6b77 6172 6773 3d61 6767  egate_kwargs=agg
-00024310: 7265 6761 7465 5f6b 7761 7267 732c 0a20  regate_kwargs,. 
-00024320: 2020 2020 2020 2020 2020 202a 2a6b 7761             **kwa
-00024330: 7267 732c 0a20 2020 2020 2020 2029 0a0a  rgs,.        )..
-00024340: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00024350: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-00024360: 2064 6566 206e 6c61 7267 6573 7428 7365   def nlargest(se
-00024370: 6c66 2c20 6e3d 352c 2073 706c 6974 5f65  lf, n=5, split_e
-00024380: 7665 7279 3d4e 6f6e 6529 3a0a 2020 2020  very=None):.    
-00024390: 2020 2020 7265 7475 726e 2061 6361 280a      return aca(.
-000243a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000243b0: 2c0a 2020 2020 2020 2020 2020 2020 6368  ,.            ch
-000243c0: 756e 6b3d 4d2e 6e6c 6172 6765 7374 2c0a  unk=M.nlargest,.
-000243d0: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
-000243e0: 6567 6174 653d 4d2e 6e6c 6172 6765 7374  egate=M.nlargest
-000243f0: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
-00024400: 7461 3d73 656c 662e 5f6d 6574 612c 0a20  ta=self._meta,. 
-00024410: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
-00024420: 3d22 7365 7269 6573 2d6e 6c61 7267 6573  ="series-nlarges
-00024430: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-00024440: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00024450: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
-00024460: 2020 2020 206e 3d6e 2c0a 2020 2020 2020       n=n,.      
-00024470: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
-00024480: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
-00024490: 290a 2020 2020 6465 6620 6e73 6d61 6c6c  ).    def nsmall
-000244a0: 6573 7428 7365 6c66 2c20 6e3d 352c 2073  est(self, n=5, s
-000244b0: 706c 6974 5f65 7665 7279 3d4e 6f6e 6529  plit_every=None)
-000244c0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000244d0: 2061 6361 280a 2020 2020 2020 2020 2020   aca(.          
-000244e0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000244f0: 2020 2020 6368 756e 6b3d 4d2e 6e73 6d61      chunk=M.nsma
-00024500: 6c6c 6573 742c 0a20 2020 2020 2020 2020  llest,.         
-00024510: 2020 2061 6767 7265 6761 7465 3d4d 2e6e     aggregate=M.n
-00024520: 736d 616c 6c65 7374 2c0a 2020 2020 2020  smallest,.      
-00024530: 2020 2020 2020 6d65 7461 3d73 656c 662e        meta=self.
-00024540: 5f6d 6574 612c 0a20 2020 2020 2020 2020  _meta,.         
-00024550: 2020 2074 6f6b 656e 3d22 7365 7269 6573     token="series
-00024560: 2d6e 736d 616c 6c65 7374 222c 0a20 2020  -nsmallest",.   
-00024570: 2020 2020 2020 2020 2073 706c 6974 5f65           split_e
-00024580: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-00024590: 2c0a 2020 2020 2020 2020 2020 2020 6e3d  ,.            n=
-000245a0: 6e2c 0a20 2020 2020 2020 2029 0a0a 2020  n,.        )..  
-000245b0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-000245c0: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-000245d0: 6566 2069 7369 6e28 7365 6c66 2c20 7661  ef isin(self, va
-000245e0: 6c75 6573 293a 0a20 2020 2020 2020 2023  lues):.        #
-000245f0: 2041 6464 6564 206a 7573 7420 746f 2067   Added just to g
-00024600: 6574 2074 6865 2064 6966 6665 7265 6e74  et the different
-00024610: 2064 6f63 7374 7269 6e67 2066 6f72 2053   docstring for S
-00024620: 6572 6965 730a 2020 2020 2020 2020 7265  eries.        re
-00024630: 7475 726e 2073 7570 6572 2829 2e69 7369  turn super().isi
-00024640: 6e28 7661 6c75 6573 290a 0a20 2020 2040  n(values)..    @
-00024650: 696e 7365 7274 5f6d 6574 615f 7061 7261  insert_meta_para
-00024660: 6d5f 6465 7363 7269 7074 696f 6e28 7061  m_description(pa
-00024670: 643d 3132 290a 2020 2020 4064 6572 6976  d=12).    @deriv
-00024680: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-00024690: 7329 0a20 2020 2064 6566 206d 6170 2873  s).    def map(s
-000246a0: 656c 662c 2061 7267 2c20 6e61 5f61 6374  elf, arg, na_act
-000246b0: 696f 6e3d 4e6f 6e65 2c20 6d65 7461 3d6e  ion=None, meta=n
-000246c0: 6f5f 6465 6661 756c 7429 3a0a 2020 2020  o_default):.    
-000246d0: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
-000246e0: 5f6c 696b 6528 6172 6729 2061 6e64 2069  _like(arg) and i
-000246f0: 735f 6461 736b 5f63 6f6c 6c65 6374 696f  s_dask_collectio
-00024700: 6e28 6172 6729 3a0a 2020 2020 2020 2020  n(arg):.        
-00024710: 2020 2020 7265 7475 726e 2073 6572 6965      return serie
-00024720: 735f 6d61 7028 7365 6c66 2c20 6172 6729  s_map(self, arg)
-00024730: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00024740: 280a 2020 2020 2020 2020 2020 2020 6973  (.            is
-00024750: 696e 7374 616e 6365 2861 7267 2c20 6469  instance(arg, di
-00024760: 6374 290a 2020 2020 2020 2020 2020 2020  ct).            
-00024770: 6f72 2063 616c 6c61 626c 6528 6172 6729  or callable(arg)
-00024780: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-00024790: 6973 5f73 6572 6965 735f 6c69 6b65 2861  is_series_like(a
-000247a0: 7267 290a 2020 2020 2020 2020 2020 2020  rg).            
-000247b0: 616e 6420 6e6f 7420 6973 5f64 6173 6b5f  and not is_dask_
-000247c0: 636f 6c6c 6563 7469 6f6e 2861 7267 290a  collection(arg).
-000247d0: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-000247e0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-000247f0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00024800: 2020 2020 2020 2020 6622 6172 6720 6d75          f"arg mu
-00024810: 7374 2062 6520 7061 6e64 6173 2e53 6572  st be pandas.Ser
-00024820: 6965 732c 2064 6963 7420 6f72 2063 616c  ies, dict or cal
-00024830: 6c61 626c 652e 2047 6f74 207b 7479 7065  lable. Got {type
-00024840: 2861 7267 297d 220a 2020 2020 2020 2020  (arg)}".        
-00024850: 2020 2020 290a 2020 2020 2020 2020 6e61      ).        na
-00024860: 6d65 203d 2022 6d61 702d 2220 2b20 746f  me = "map-" + to
-00024870: 6b65 6e69 7a65 2873 656c 662c 2061 7267  kenize(self, arg
-00024880: 2c20 6e61 5f61 6374 696f 6e29 0a20 2020  , na_action).   
-00024890: 2020 2020 2064 736b 203d 207b 0a20 2020       dsk = {.   
-000248a0: 2020 2020 2020 2020 2028 6e61 6d65 2c20           (name, 
-000248b0: 6929 3a20 284d 2e6d 6170 2c20 6b2c 2061  i): (M.map, k, a
-000248c0: 7267 2c20 6e61 5f61 6374 696f 6e29 0a20  rg, na_action). 
-000248d0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-000248e0: 2c20 6b20 696e 2065 6e75 6d65 7261 7465  , k in enumerate
-000248f0: 2873 656c 662e 5f5f 6461 736b 5f6b 6579  (self.__dask_key
-00024900: 735f 5f28 2929 0a20 2020 2020 2020 207d  s__()).        }
-00024910: 0a20 2020 2020 2020 2067 7261 7068 203d  .        graph =
-00024920: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-00024930: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-00024940: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
-00024950: 6e64 656e 6369 6573 3d5b 7365 6c66 5d29  ndencies=[self])
-00024960: 0a20 2020 2020 2020 2069 6620 6d65 7461  .        if meta
-00024970: 2069 7320 6e6f 5f64 6566 6175 6c74 3a0a   is no_default:.
-00024980: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00024990: 203d 205f 656d 756c 6174 6528 4d2e 6d61   = _emulate(M.ma
-000249a0: 702c 2073 656c 662c 2061 7267 2c20 6e61  p, self, arg, na
-000249b0: 5f61 6374 696f 6e3d 6e61 5f61 6374 696f  _action=na_actio
-000249c0: 6e2c 2075 6466 3d54 7275 6529 0a20 2020  n, udf=True).   
-000249d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000249e0: 2020 2020 2020 206d 6574 6120 3d20 6d61         meta = ma
-000249f0: 6b65 5f6d 6574 6128 0a20 2020 2020 2020  ke_meta(.       
-00024a00: 2020 2020 2020 2020 206d 6574 612c 0a20           meta,. 
-00024a10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00024a20: 6e64 6578 3d67 6574 6174 7472 286d 616b  ndex=getattr(mak
-00024a30: 655f 6d65 7461 2873 656c 6629 2c20 2269  e_meta(self), "i
-00024a40: 6e64 6578 222c 204e 6f6e 6529 2c0a 2020  ndex", None),.  
-00024a50: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00024a60: 7265 6e74 5f6d 6574 613d 7365 6c66 2e5f  rent_meta=self._
-00024a70: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-00024a80: 2020 290a 0a20 2020 2020 2020 2072 6574    )..        ret
-00024a90: 7572 6e20 7479 7065 2873 656c 6629 2867  urn type(self)(g
-00024aa0: 7261 7068 2c20 6e61 6d65 2c20 6d65 7461  raph, name, meta
-00024ab0: 2c20 7365 6c66 2e64 6976 6973 696f 6e73  , self.divisions
-00024ac0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00024ad0: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
-00024ae0: 2020 2020 6465 6620 6472 6f70 6e61 2873      def dropna(s
-00024af0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00024b00: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
-00024b10: 7274 6974 696f 6e73 284d 2e64 726f 706e  rtitions(M.dropn
-00024b20: 612c 2065 6e66 6f72 6365 5f6d 6574 6164  a, enforce_metad
-00024b30: 6174 613d 4661 6c73 6529 0a0a 2020 2020  ata=False)..    
-00024b40: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00024b50: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
-00024b60: 2062 6574 7765 656e 2873 656c 662c 206c   between(self, l
-00024b70: 6566 742c 2072 6967 6874 2c20 696e 636c  eft, right, incl
-00024b80: 7573 6976 653d 2262 6f74 6822 293a 0a20  usive="both"):. 
-00024b90: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00024ba0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00024bb0: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
-00024bc0: 2e62 6574 7765 656e 2c20 6c65 6674 3d6c  .between, left=l
-00024bd0: 6566 742c 2072 6967 6874 3d72 6967 6874  eft, right=right
-00024be0: 2c20 696e 636c 7573 6976 653d 696e 636c  , inclusive=incl
-00024bf0: 7573 6976 650a 2020 2020 2020 2020 290a  usive.        ).
-00024c00: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00024c10: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-00024c20: 2020 6465 6620 636c 6970 2873 656c 662c    def clip(self,
-00024c30: 206c 6f77 6572 3d4e 6f6e 652c 2075 7070   lower=None, upp
-00024c40: 6572 3d4e 6f6e 652c 206f 7574 3d4e 6f6e  er=None, out=Non
-00024c50: 6529 3a0a 2020 2020 2020 2020 6966 206f  e):.        if o
-00024c60: 7574 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ut is not None:.
-00024c70: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00024c80: 6520 5661 6c75 6545 7272 6f72 2822 276f  e ValueError("'o
-00024c90: 7574 2720 6d75 7374 2062 6520 4e6f 6e65  ut' must be None
-00024ca0: 2229 0a20 2020 2020 2020 2023 206e 702e  ").        # np.
-00024cb0: 636c 6970 206d 6179 2070 6173 7320 6f75  clip may pass ou
-00024cc0: 740a 2020 2020 2020 2020 7265 7475 726e  t.        return
-00024cd0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-00024ce0: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
-00024cf0: 2020 4d2e 636c 6970 2c20 6c6f 7765 723d    M.clip, lower=
-00024d00: 6c6f 7765 722c 2075 7070 6572 3d75 7070  lower, upper=upp
-00024d10: 6572 2c20 656e 666f 7263 655f 6d65 7461  er, enforce_meta
-00024d20: 6461 7461 3d46 616c 7365 0a20 2020 2020  data=False.     
-00024d30: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
-00024d40: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-00024d50: 7329 0a20 2020 2064 6566 2063 6c69 705f  s).    def clip_
-00024d60: 6c6f 7765 7228 7365 6c66 2c20 7468 7265  lower(self, thre
-00024d70: 7368 6f6c 6429 3a0a 2020 2020 2020 2020  shold):.        
-00024d80: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-00024d90: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-00024da0: 2020 2020 2020 2020 4d2e 636c 6970 5f6c          M.clip_l
-00024db0: 6f77 6572 2c20 7468 7265 7368 6f6c 643d  ower, threshold=
-00024dc0: 7468 7265 7368 6f6c 642c 2065 6e66 6f72  threshold, enfor
-00024dd0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-00024de0: 650a 2020 2020 2020 2020 290a 0a20 2020  e.        )..   
-00024df0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00024e00: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
-00024e10: 6620 636c 6970 5f75 7070 6572 2873 656c  f clip_upper(sel
-00024e20: 662c 2074 6872 6573 686f 6c64 293a 0a20  f, threshold):. 
-00024e30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00024e40: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00024e50: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
-00024e60: 2e63 6c69 705f 7570 7065 722c 2074 6872  .clip_upper, thr
-00024e70: 6573 686f 6c64 3d74 6872 6573 686f 6c64  eshold=threshold
-00024e80: 2c20 656e 666f 7263 655f 6d65 7461 6461  , enforce_metada
-00024e90: 7461 3d46 616c 7365 0a20 2020 2020 2020  ta=False.       
-00024ea0: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
-00024eb0: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00024ec0: 0a20 2020 2064 6566 2061 6c69 676e 2873  .    def align(s
-00024ed0: 656c 662c 206f 7468 6572 2c20 6a6f 696e  elf, other, join
-00024ee0: 3d22 6f75 7465 7222 2c20 6178 6973 3d4e  ="outer", axis=N
-00024ef0: 6f6e 652c 2066 696c 6c5f 7661 6c75 653d  one, fill_value=
-00024f00: 4e6f 6e65 293a 0a20 2020 2020 2020 2072  None):.        r
-00024f10: 6574 7572 6e20 7375 7065 7228 292e 616c  eturn super().al
-00024f20: 6967 6e28 6f74 6865 722c 206a 6f69 6e3d  ign(other, join=
-00024f30: 6a6f 696e 2c20 6178 6973 3d61 7869 732c  join, axis=axis,
-00024f40: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
-00024f50: 5f76 616c 7565 290a 0a20 2020 2040 6465  _value)..    @de
-00024f60: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00024f70: 7269 6573 290a 2020 2020 6465 6620 636f  ries).    def co
-00024f80: 6d62 696e 6528 7365 6c66 2c20 6f74 6865  mbine(self, othe
-00024f90: 722c 2066 756e 632c 2066 696c 6c5f 7661  r, func, fill_va
-00024fa0: 6c75 653d 4e6f 6e65 293a 0a20 2020 2020  lue=None):.     
-00024fb0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00024fc0: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
-00024fd0: 636f 6d62 696e 652c 206f 7468 6572 2c20  combine, other, 
-00024fe0: 6675 6e63 2c20 6669 6c6c 5f76 616c 7565  func, fill_value
-00024ff0: 3d66 696c 6c5f 7661 6c75 6529 0a0a 2020  =fill_value)..  
-00025000: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00025010: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-00025020: 6566 2073 7175 6565 7a65 2873 656c 6629  ef squeeze(self)
-00025030: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00025040: 2073 656c 660a 0a20 2020 2040 6465 7269   self..    @deri
-00025050: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
-00025060: 6573 290a 2020 2020 6465 6620 636f 6d62  es).    def comb
-00025070: 696e 655f 6669 7273 7428 7365 6c66 2c20  ine_first(self, 
-00025080: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-00025090: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-000250a0: 7061 7274 6974 696f 6e73 284d 2e63 6f6d  partitions(M.com
-000250b0: 6269 6e65 5f66 6972 7374 2c20 6f74 6865  bine_first, othe
-000250c0: 7229 0a0a 2020 2020 6465 6620 746f 5f62  r)..    def to_b
-000250d0: 6167 2873 656c 662c 2069 6e64 6578 3d46  ag(self, index=F
-000250e0: 616c 7365 2c20 666f 726d 6174 3d22 7475  alse, format="tu
-000250f0: 706c 6522 293a 0a20 2020 2020 2020 2022  ple"):.        "
-00025100: 2222 4372 6561 7465 2061 2044 6173 6b20  ""Create a Dask 
-00025110: 4261 6720 6672 6f6d 2061 2053 6572 6965  Bag from a Serie
-00025120: 7322 2222 0a20 2020 2020 2020 2066 726f  s""".        fro
-00025130: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
-00025140: 2e69 6f20 696d 706f 7274 2074 6f5f 6261  .io import to_ba
-00025150: 670a 0a20 2020 2020 2020 2072 6574 7572  g..        retur
-00025160: 6e20 746f 5f62 6167 2873 656c 662c 2069  n to_bag(self, i
-00025170: 6e64 6578 2c20 666f 726d 6174 3d66 6f72  ndex, format=for
-00025180: 6d61 7429 0a0a 2020 2020 4064 6572 6976  mat)..    @deriv
-00025190: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-000251a0: 7329 0a20 2020 2064 6566 2074 6f5f 6672  s).    def to_fr
-000251b0: 616d 6528 7365 6c66 2c20 6e61 6d65 3d4e  ame(self, name=N
-000251c0: 6f6e 6529 3a0a 2020 2020 2020 2020 6172  one):.        ar
-000251d0: 6773 203d 205b 5d20 6966 206e 616d 6520  gs = [] if name 
-000251e0: 6973 204e 6f6e 6520 656c 7365 205b 6e61  is None else [na
-000251f0: 6d65 5d0a 2020 2020 2020 2020 7265 7475  me].        retu
-00025200: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-00025210: 6974 696f 6e73 284d 2e74 6f5f 6672 616d  itions(M.to_fram
-00025220: 652c 202a 6172 6773 2c20 6d65 7461 3d73  e, *args, meta=s
-00025230: 656c 662e 5f6d 6574 612e 746f 5f66 7261  elf._meta.to_fra
-00025240: 6d65 282a 6172 6773 2929 0a0a 2020 2020  me(*args))..    
-00025250: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00025260: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
-00025270: 2074 6f5f 7374 7269 6e67 2873 656c 662c   to_string(self,
-00025280: 206d 6178 5f72 6f77 733d 3529 3a0a 2020   max_rows=5):.  
-00025290: 2020 2020 2020 2320 6f70 7469 6f6e 5f63        # option_c
-000252a0: 6f6e 7465 7874 2064 6f65 736e 2774 2061  ontext doesn't a
-000252b0: 6666 6563 740a 2020 2020 2020 2020 7265  ffect.        re
-000252c0: 7475 726e 2073 656c 662e 5f72 6570 725f  turn self._repr_
-000252d0: 6461 7461 2829 2e74 6f5f 7374 7269 6e67  data().to_string
-000252e0: 286d 6178 5f72 6f77 733d 6d61 785f 726f  (max_rows=max_ro
-000252f0: 7773 290a 0a20 2020 2040 636c 6173 736d  ws)..    @classm
-00025300: 6574 686f 640a 2020 2020 6465 6620 5f62  ethod.    def _b
-00025310: 696e 645f 6f70 6572 6174 6f72 5f6d 6574  ind_operator_met
-00025320: 686f 6428 636c 732c 206e 616d 652c 206f  hod(cls, name, o
-00025330: 702c 206f 7269 6769 6e61 6c3d 7064 2e53  p, original=pd.S
-00025340: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
-00025350: 2222 2262 696e 6420 6f70 6572 6174 6f72  """bind operator
-00025360: 206d 6574 686f 6420 6c69 6b65 2053 6572   method like Ser
-00025370: 6965 732e 6164 6420 746f 2074 6869 7320  ies.add to this 
-00025380: 636c 6173 7322 2222 0a0a 2020 2020 2020  class"""..      
-00025390: 2020 6465 6620 6d65 7468 2873 656c 662c    def meth(self,
-000253a0: 206f 7468 6572 2c20 6c65 7665 6c3d 4e6f   other, level=No
-000253b0: 6e65 2c20 6669 6c6c 5f76 616c 7565 3d4e  ne, fill_value=N
-000253c0: 6f6e 652c 2061 7869 733d 3029 3a0a 2020  one, axis=0):.  
-000253d0: 2020 2020 2020 2020 2020 6966 206c 6576            if lev
-000253e0: 656c 2069 7320 6e6f 7420 4e6f 6e65 3a0a  el is not None:.
-000253f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025400: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00025410: 6e74 6564 4572 726f 7228 226c 6576 656c  ntedError("level
-00025420: 206d 7573 7420 6265 204e 6f6e 6522 290a   must be None").
-00025430: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00025440: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
-00025450: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
-00025460: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-00025470: 5f65 6d75 6c61 7465 286f 702c 2073 656c  _emulate(op, sel
-00025480: 662c 206f 7468 6572 2c20 6178 6973 3d61  f, other, axis=a
-00025490: 7869 732c 2066 696c 6c5f 7661 6c75 653d  xis, fill_value=
-000254a0: 6669 6c6c 5f76 616c 7565 290a 2020 2020  fill_value).    
-000254b0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-000254c0: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-000254d0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-000254e0: 702c 2073 656c 662c 206f 7468 6572 2c20  p, self, other, 
-000254f0: 6d65 7461 3d6d 6574 612c 2061 7869 733d  meta=meta, axis=
-00025500: 6178 6973 2c20 6669 6c6c 5f76 616c 7565  axis, fill_value
-00025510: 3d66 696c 6c5f 7661 6c75 650a 2020 2020  =fill_value.    
-00025520: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00025530: 2020 206d 6574 682e 5f5f 6e61 6d65 5f5f     meth.__name__
-00025540: 203d 206e 616d 650a 2020 2020 2020 2020   = name.        
-00025550: 7365 7461 7474 7228 636c 732c 206e 616d  setattr(cls, nam
-00025560: 652c 2064 6572 6976 6564 5f66 726f 6d28  e, derived_from(
-00025570: 6f72 6967 696e 616c 2928 6d65 7468 2929  original)(meth))
-00025580: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
-00025590: 6f64 0a20 2020 2064 6566 205f 6269 6e64  od.    def _bind
-000255a0: 5f63 6f6d 7061 7269 736f 6e5f 6d65 7468  _comparison_meth
-000255b0: 6f64 2863 6c73 2c20 6e61 6d65 2c20 636f  od(cls, name, co
-000255c0: 6d70 6172 6973 6f6e 2c20 6f72 6967 696e  mparison, origin
-000255d0: 616c 3d70 642e 5365 7269 6573 293a 0a20  al=pd.Series):. 
-000255e0: 2020 2020 2020 2022 2222 6269 6e64 2063         """bind c
-000255f0: 6f6d 7061 7269 736f 6e20 6d65 7468 6f64  omparison method
-00025600: 206c 696b 6520 5365 7269 6573 2e65 7120   like Series.eq 
-00025610: 746f 2074 6869 7320 636c 6173 7322 2222  to this class"""
-00025620: 0a0a 2020 2020 2020 2020 6465 6620 6d65  ..        def me
-00025630: 7468 2873 656c 662c 206f 7468 6572 2c20  th(self, other, 
-00025640: 6c65 7665 6c3d 4e6f 6e65 2c20 6669 6c6c  level=None, fill
-00025650: 5f76 616c 7565 3d4e 6f6e 652c 2061 7869  _value=None, axi
-00025660: 733d 3029 3a0a 2020 2020 2020 2020 2020  s=0):.          
-00025670: 2020 6966 206c 6576 656c 2069 7320 6e6f    if level is no
-00025680: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00025690: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-000256a0: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-000256b0: 7228 226c 6576 656c 206d 7573 7420 6265  r("level must be
-000256c0: 204e 6f6e 6522 290a 2020 2020 2020 2020   None").        
-000256d0: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
-000256e0: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
-000256f0: 7869 7329 0a20 2020 2020 2020 2020 2020  xis).           
-00025700: 2069 6620 6669 6c6c 5f76 616c 7565 2069   if fill_value i
-00025710: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00025720: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-00025730: 6c65 6d77 6973 6528 636f 6d70 6172 6973  lemwise(comparis
-00025740: 6f6e 2c20 7365 6c66 2c20 6f74 6865 722c  on, self, other,
-00025750: 2061 7869 733d 6178 6973 290a 2020 2020   axis=axis).    
-00025760: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00025770: 2020 2020 2020 2020 2020 2020 2020 6f70                op
-00025780: 203d 2070 6172 7469 616c 2863 6f6d 7061   = partial(compa
-00025790: 7269 736f 6e2c 2066 696c 6c5f 7661 6c75  rison, fill_valu
-000257a0: 653d 6669 6c6c 5f76 616c 7565 290a 2020  e=fill_value).  
-000257b0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000257c0: 7475 726e 2065 6c65 6d77 6973 6528 6f70  turn elemwise(op
-000257d0: 2c20 7365 6c66 2c20 6f74 6865 722c 2061  , self, other, a
-000257e0: 7869 733d 6178 6973 290a 0a20 2020 2020  xis=axis)..     
-000257f0: 2020 206d 6574 682e 5f5f 6e61 6d65 5f5f     meth.__name__
-00025800: 203d 206e 616d 650a 2020 2020 2020 2020   = name.        
-00025810: 7365 7461 7474 7228 636c 732c 206e 616d  setattr(cls, nam
-00025820: 652c 2064 6572 6976 6564 5f66 726f 6d28  e, derived_from(
-00025830: 6f72 6967 696e 616c 2928 6d65 7468 2929  original)(meth))
-00025840: 0a0a 2020 2020 4069 6e73 6572 745f 6d65  ..    @insert_me
-00025850: 7461 5f70 6172 616d 5f64 6573 6372 6970  ta_param_descrip
-00025860: 7469 6f6e 2870 6164 3d31 3229 0a20 2020  tion(pad=12).   
-00025870: 2064 6566 2061 7070 6c79 2873 656c 662c   def apply(self,
-00025880: 2066 756e 632c 2063 6f6e 7665 7274 5f64   func, convert_d
-00025890: 7479 7065 3d6e 6f5f 6465 6661 756c 742c  type=no_default,
-000258a0: 206d 6574 613d 6e6f 5f64 6566 6175 6c74   meta=no_default
-000258b0: 2c20 6172 6773 3d28 292c 202a 2a6b 7764  , args=(), **kwd
-000258c0: 7329 3a0a 2020 2020 2020 2020 2222 2250  s):.        """P
-000258d0: 6172 616c 6c65 6c20 7665 7273 696f 6e20  arallel version 
-000258e0: 6f66 2070 616e 6461 732e 5365 7269 6573  of pandas.Series
-000258f0: 2e61 7070 6c79 0a0a 2020 2020 2020 2020  .apply..        
-00025900: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00025910: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00025920: 2020 2020 2020 6675 6e63 203a 2066 756e        func : fun
-00025930: 6374 696f 6e0a 2020 2020 2020 2020 2020  ction.          
-00025940: 2020 4675 6e63 7469 6f6e 2074 6f20 6170    Function to ap
-00025950: 706c 790a 2020 2020 2020 2020 636f 6e76  ply.        conv
-00025960: 6572 745f 6474 7970 6520 3a20 626f 6f6c  ert_dtype : bool
-00025970: 6561 6e2c 2064 6566 6175 6c74 2054 7275  ean, default Tru
-00025980: 650a 2020 2020 2020 2020 2020 2020 5472  e.            Tr
-00025990: 7920 746f 2066 696e 6420 6265 7474 6572  y to find better
-000259a0: 2064 7479 7065 2066 6f72 2065 6c65 6d65   dtype for eleme
-000259b0: 6e74 7769 7365 2066 756e 6374 696f 6e20  ntwise function 
-000259c0: 7265 7375 6c74 732e 0a20 2020 2020 2020  results..       
-000259d0: 2020 2020 2049 6620 4661 6c73 652c 206c       If False, l
-000259e0: 6561 7665 2061 7320 6474 7970 653d 6f62  eave as dtype=ob
-000259f0: 6a65 6374 2e0a 2020 2020 2020 2020 244d  ject..        $M
-00025a00: 4554 410a 2020 2020 2020 2020 6172 6773  ETA.        args
-00025a10: 203a 2074 7570 6c65 0a20 2020 2020 2020   : tuple.       
-00025a20: 2020 2020 2050 6f73 6974 696f 6e61 6c20       Positional 
-00025a30: 6172 6775 6d65 6e74 7320 746f 2070 6173  arguments to pas
-00025a40: 7320 746f 2066 756e 6374 696f 6e20 696e  s to function in
-00025a50: 2061 6464 6974 696f 6e20 746f 2074 6865   addition to the
-00025a60: 2076 616c 7565 2e0a 0a20 2020 2020 2020   value...       
-00025a70: 2041 6464 6974 696f 6e61 6c20 6b65 7977   Additional keyw
-00025a80: 6f72 6420 6172 6775 6d65 6e74 7320 7769  ord arguments wi
-00025a90: 6c6c 2062 6520 7061 7373 6564 2061 7320  ll be passed as 
-00025aa0: 6b65 7977 6f72 6473 2074 6f20 7468 6520  keywords to the 
-00025ab0: 6675 6e63 7469 6f6e 2e0a 0a20 2020 2020  function...     
-00025ac0: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-00025ad0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00025ae0: 2020 2061 7070 6c69 6564 203a 2053 6572     applied : Ser
-00025af0: 6965 7320 6f72 2044 6174 6146 7261 6d65  ies or DataFrame
-00025b00: 2069 6620 6675 6e63 2072 6574 7572 6e73   if func returns
-00025b10: 2061 2053 6572 6965 732e 0a0a 2020 2020   a Series...    
-00025b20: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-00025b30: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-00025b40: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-00025b50: 2064 6173 6b2e 6461 7461 6672 616d 6520   dask.dataframe 
-00025b60: 6173 2064 640a 2020 2020 2020 2020 3e3e  as dd.        >>
-00025b70: 3e20 7320 3d20 7064 2e53 6572 6965 7328  > s = pd.Series(
-00025b80: 7261 6e67 6528 3529 2c20 6e61 6d65 3d27  range(5), name='
-00025b90: 7827 290a 2020 2020 2020 2020 3e3e 3e20  x').        >>> 
-00025ba0: 6473 203d 2064 642e 6672 6f6d 5f70 616e  ds = dd.from_pan
-00025bb0: 6461 7328 732c 206e 7061 7274 6974 696f  das(s, npartitio
-00025bc0: 6e73 3d32 290a 0a20 2020 2020 2020 2041  ns=2)..        A
-00025bd0: 7070 6c79 2061 2066 756e 6374 696f 6e20  pply a function 
-00025be0: 656c 656d 656e 7477 6973 6520 6163 726f  elementwise acro
-00025bf0: 7373 2074 6865 2053 6572 6965 732c 2070  ss the Series, p
-00025c00: 6173 7369 6e67 2069 6e20 6578 7472 610a  assing in extra.
-00025c10: 2020 2020 2020 2020 6172 6775 6d65 6e74          argument
-00025c20: 7320 696e 2060 6061 7267 7360 6020 616e  s in ``args`` an
-00025c30: 6420 6060 6b77 6172 6773 6060 3a0a 0a20  d ``kwargs``:.. 
-00025c40: 2020 2020 2020 203e 3e3e 2064 6566 206d         >>> def m
-00025c50: 7961 6464 2878 2c20 612c 2062 3d31 293a  yadd(x, a, b=1):
-00025c60: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00025c70: 2072 6574 7572 6e20 7820 2b20 6120 2b20   return x + a + 
-00025c80: 620a 2020 2020 2020 2020 3e3e 3e20 7265  b.        >>> re
-00025c90: 7320 3d20 6473 2e61 7070 6c79 286d 7961  s = ds.apply(mya
-00025ca0: 6464 2c20 6172 6773 3d28 322c 292c 2062  dd, args=(2,), b
-00025cb0: 3d31 2e35 2920 2023 2064 6f63 7465 7374  =1.5)  # doctest
-00025cc0: 3a20 2b53 4b49 500a 0a20 2020 2020 2020  : +SKIP..       
-00025cd0: 2042 7920 6465 6661 756c 742c 2064 6173   By default, das
-00025ce0: 6b20 7472 6965 7320 746f 2069 6e66 6572  k tries to infer
-00025cf0: 2074 6865 206f 7574 7075 7420 6d65 7461   the output meta
-00025d00: 6461 7461 2062 7920 7275 6e6e 696e 6720  data by running 
-00025d10: 796f 7572 0a20 2020 2020 2020 2070 726f  your.        pro
-00025d20: 7669 6465 6420 6675 6e63 7469 6f6e 206f  vided function o
-00025d30: 6e20 736f 6d65 2066 616b 6520 6461 7461  n some fake data
-00025d40: 2e20 5468 6973 2077 6f72 6b73 2077 656c  . This works wel
-00025d50: 6c20 696e 206d 616e 7920 6361 7365 732c  l in many cases,
-00025d60: 2062 7574 0a20 2020 2020 2020 2063 616e   but.        can
-00025d70: 2073 6f6d 6574 696d 6573 2062 6520 6578   sometimes be ex
-00025d80: 7065 6e73 6976 652c 206f 7220 6576 656e  pensive, or even
-00025d90: 2066 6169 6c2e 2054 6f20 6176 6f69 6420   fail. To avoid 
-00025da0: 7468 6973 2c20 796f 7520 6361 6e0a 2020  this, you can.  
-00025db0: 2020 2020 2020 6d61 6e75 616c 6c79 2073        manually s
-00025dc0: 7065 6369 6679 2074 6865 206f 7574 7075  pecify the outpu
-00025dd0: 7420 6d65 7461 6461 7461 2077 6974 6820  t metadata with 
-00025de0: 7468 6520 6060 6d65 7461 6060 206b 6579  the ``meta`` key
-00025df0: 776f 7264 2e20 5468 6973 0a20 2020 2020  word. This.     
-00025e00: 2020 2063 616e 2062 6520 7370 6563 6966     can be specif
-00025e10: 6965 6420 696e 206d 616e 7920 666f 726d  ied in many form
-00025e20: 732c 2066 6f72 206d 6f72 6520 696e 666f  s, for more info
-00025e30: 726d 6174 696f 6e20 7365 650a 2020 2020  rmation see.    
-00025e40: 2020 2020 6060 6461 736b 2e64 6174 6166      ``dask.dataf
-00025e50: 7261 6d65 2e75 7469 6c73 2e6d 616b 655f  rame.utils.make_
-00025e60: 6d65 7461 6060 2e0a 0a20 2020 2020 2020  meta``...       
-00025e70: 2048 6572 6520 7765 2073 7065 6369 6679   Here we specify
-00025e80: 2074 6865 206f 7574 7075 7420 6973 2061   the output is a
-00025e90: 2053 6572 6965 7320 7769 7468 206e 616d   Series with nam
-00025ea0: 6520 6060 2778 2760 602c 2061 6e64 2064  e ``'x'``, and d
-00025eb0: 7479 7065 0a20 2020 2020 2020 2060 6066  type.        ``f
-00025ec0: 6c6f 6174 3634 6060 3a0a 0a20 2020 2020  loat64``:..     
-00025ed0: 2020 203e 3e3e 2072 6573 203d 2064 732e     >>> res = ds.
-00025ee0: 6170 706c 7928 6d79 6164 642c 2061 7267  apply(myadd, arg
-00025ef0: 733d 2832 2c29 2c20 623d 312e 352c 206d  s=(2,), b=1.5, m
-00025f00: 6574 613d 2827 7827 2c20 2766 3827 2929  eta=('x', 'f8'))
-00025f10: 0a0a 2020 2020 2020 2020 496e 2074 6865  ..        In the
-00025f20: 2063 6173 6520 7768 6572 6520 7468 6520   case where the 
-00025f30: 6d65 7461 6461 7461 2064 6f65 736e 2774  metadata doesn't
-00025f40: 2063 6861 6e67 652c 2079 6f75 2063 616e   change, you can
-00025f50: 2061 6c73 6f20 7061 7373 2069 6e0a 2020   also pass in.  
-00025f60: 2020 2020 2020 7468 6520 6f62 6a65 6374        the object
-00025f70: 2069 7473 656c 6620 6469 7265 6374 6c79   itself directly
-00025f80: 3a0a 0a20 2020 2020 2020 203e 3e3e 2072  :..        >>> r
-00025f90: 6573 203d 2064 732e 6170 706c 7928 6c61  es = ds.apply(la
-00025fa0: 6d62 6461 2078 3a20 7820 2b20 312c 206d  mbda x: x + 1, m
-00025fb0: 6574 613d 6473 290a 0a20 2020 2020 2020  eta=ds)..       
-00025fc0: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-00025fd0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00025fe0: 2020 2064 6173 6b2e 5365 7269 6573 2e6d     dask.Series.m
-00025ff0: 6170 5f70 6172 7469 7469 6f6e 730a 2020  ap_partitions.  
-00026000: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00026010: 2020 6966 2063 6f6e 7665 7274 5f64 7479    if convert_dty
-00026020: 7065 2069 7320 6e6f 7420 6e6f 5f64 6566  pe is not no_def
-00026030: 6175 6c74 3a0a 2020 2020 2020 2020 2020  ault:.          
-00026040: 2020 6b77 6473 5b22 636f 6e76 6572 745f    kwds["convert_
-00026050: 6474 7970 6522 5d20 3d20 636f 6e76 6572  dtype"] = conver
-00026060: 745f 6474 7970 650a 0a20 2020 2020 2020  t_dtype..       
-00026070: 2023 206c 6574 2070 616e 6461 7320 7472   # let pandas tr
-00026080: 6967 6765 7220 616e 7920 7761 726e 696e  igger any warnin
-00026090: 6773 2c20 7375 6368 2061 7320 636f 6e76  gs, such as conv
-000260a0: 6572 745f 6474 7970 6520 7761 726e 696e  ert_dtype warnin
-000260b0: 670a 2020 2020 2020 2020 7365 6c66 2e5f  g.        self._
-000260c0: 6d65 7461 5f6e 6f6e 656d 7074 792e 6170  meta_nonempty.ap
-000260d0: 706c 7928 6675 6e63 2c20 6172 6773 3d61  ply(func, args=a
-000260e0: 7267 732c 202a 2a6b 7764 7329 0a0a 2020  rgs, **kwds)..  
-000260f0: 2020 2020 2020 6966 206d 6574 6120 6973        if meta is
-00026100: 206e 6f5f 6465 6661 756c 743a 0a20 2020   no_default:.   
-00026110: 2020 2020 2020 2020 2077 6974 6820 6368           with ch
-00026120: 6563 6b5f 636f 6e76 6572 745f 6474 7970  eck_convert_dtyp
-00026130: 655f 6465 7072 6563 6174 696f 6e28 293a  e_deprecation():
-00026140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026150: 206d 6574 6120 3d20 5f65 6d75 6c61 7465   meta = _emulate
-00026160: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00026170: 2020 2020 2020 4d2e 6170 706c 792c 2073        M.apply, s
-00026180: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
-00026190: 7479 2c20 6675 6e63 2c20 6172 6773 3d61  ty, func, args=a
-000261a0: 7267 732c 2075 6466 3d54 7275 652c 202a  rgs, udf=True, *
-000261b0: 2a6b 7764 730a 2020 2020 2020 2020 2020  *kwds.          
-000261c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000261d0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-000261e0: 6e28 6d65 7461 5f77 6172 6e69 6e67 286d  n(meta_warning(m
-000261f0: 6574 6129 290a 0a20 2020 2020 2020 2072  eta))..        r
-00026200: 6574 7572 6e20 6d61 705f 7061 7274 6974  eturn map_partit
-00026210: 696f 6e73 286d 6574 686f 6473 2e61 7070  ions(methods.app
-00026220: 6c79 2c20 7365 6c66 2c20 6675 6e63 2c20  ly, self, func, 
-00026230: 6172 6773 3d61 7267 732c 206d 6574 613d  args=args, meta=
-00026240: 6d65 7461 2c20 2a2a 6b77 6473 290a 0a20  meta, **kwds).. 
-00026250: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00026260: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
-00026270: 6465 6620 636f 7628 7365 6c66 2c20 6f74  def cov(self, ot
-00026280: 6865 722c 206d 696e 5f70 6572 696f 6473  her, min_periods
-00026290: 3d4e 6f6e 652c 2073 706c 6974 5f65 7665  =None, split_eve
-000262a0: 7279 3d46 616c 7365 293a 0a20 2020 2020  ry=False):.     
-000262b0: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-000262c0: 6166 7261 6d65 2e6d 756c 7469 2069 6d70  aframe.multi imp
-000262d0: 6f72 7420 636f 6e63 6174 0a0a 2020 2020  ort concat..    
-000262e0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-000262f0: 7461 6e63 6528 6f74 6865 722c 2053 6572  tance(other, Ser
-00026300: 6965 7329 3a0a 2020 2020 2020 2020 2020  ies):.          
-00026310: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00026320: 7228 226f 7468 6572 206d 7573 7420 6265  r("other must be
-00026330: 2061 2064 6173 6b2e 6461 7461 6672 616d   a dask.datafram
-00026340: 652e 5365 7269 6573 2229 0a20 2020 2020  e.Series").     
-00026350: 2020 2064 6620 3d20 636f 6e63 6174 285b     df = concat([
-00026360: 7365 6c66 2c20 6f74 6865 725d 2c20 6178  self, other], ax
-00026370: 6973 3d31 290a 2020 2020 2020 2020 7265  is=1).        re
-00026380: 7475 726e 205f 636f 765f 636f 7272 280a  turn _cov_corr(.
-00026390: 2020 2020 2020 2020 2020 2020 6466 2c20              df, 
-000263a0: 6d69 6e5f 7065 7269 6f64 732c 2073 6361  min_periods, sca
-000263b0: 6c61 723d 5472 7565 2c20 6e75 6d65 7269  lar=True, numeri
-000263c0: 635f 6f6e 6c79 3d46 616c 7365 2c20 7370  c_only=False, sp
-000263d0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-000263e0: 6576 6572 790a 2020 2020 2020 2020 290a  every.        ).
-000263f0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00026400: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-00026410: 2020 6465 6620 636f 7272 2873 656c 662c    def corr(self,
-00026420: 206f 7468 6572 2c20 6d65 7468 6f64 3d22   other, method="
-00026430: 7065 6172 736f 6e22 2c20 6d69 6e5f 7065  pearson", min_pe
-00026440: 7269 6f64 733d 4e6f 6e65 2c20 7370 6c69  riods=None, spli
-00026450: 745f 6576 6572 793d 4661 6c73 6529 3a0a  t_every=False):.
-00026460: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00026470: 6b2e 6461 7461 6672 616d 652e 6d75 6c74  k.dataframe.mult
-00026480: 6920 696d 706f 7274 2063 6f6e 6361 740a  i import concat.
-00026490: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-000264a0: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
-000264b0: 2c20 5365 7269 6573 293a 0a20 2020 2020  , Series):.     
-000264c0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-000264d0: 6545 7272 6f72 2822 6f74 6865 7220 6d75  eError("other mu
-000264e0: 7374 2062 6520 6120 6461 736b 2e64 6174  st be a dask.dat
-000264f0: 6166 7261 6d65 2e53 6572 6965 7322 290a  aframe.Series").
-00026500: 2020 2020 2020 2020 6966 206d 6574 686f          if metho
-00026510: 6420 213d 2022 7065 6172 736f 6e22 3a0a  d != "pearson":.
-00026520: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00026530: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-00026540: 4572 726f 7228 224f 6e6c 7920 5065 6172  Error("Only Pear
-00026550: 736f 6e20 636f 7272 656c 6174 696f 6e20  son correlation 
-00026560: 6861 7320 6265 656e 2069 6d70 6c65 6d65  has been impleme
-00026570: 6e74 6564 2229 0a20 2020 2020 2020 2064  nted").        d
-00026580: 6620 3d20 636f 6e63 6174 285b 7365 6c66  f = concat([self
-00026590: 2c20 6f74 6865 725d 2c20 6178 6973 3d31  , other], axis=1
-000265a0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000265b0: 205f 636f 765f 636f 7272 280a 2020 2020   _cov_corr(.    
-000265c0: 2020 2020 2020 2020 6466 2c0a 2020 2020          df,.    
-000265d0: 2020 2020 2020 2020 6d69 6e5f 7065 7269          min_peri
-000265e0: 6f64 732c 0a20 2020 2020 2020 2020 2020  ods,.           
-000265f0: 2063 6f72 723d 5472 7565 2c0a 2020 2020   corr=True,.    
-00026600: 2020 2020 2020 2020 7363 616c 6172 3d54          scalar=T
-00026610: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-00026620: 206e 756d 6572 6963 5f6f 6e6c 793d 4661   numeric_only=Fa
-00026630: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00026640: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-00026650: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
-00026660: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
-00026670: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
-00026680: 290a 2020 2020 6465 6620 6175 746f 636f  ).    def autoco
-00026690: 7272 2873 656c 662c 206c 6167 3d31 2c20  rr(self, lag=1, 
-000266a0: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
-000266b0: 6529 3a0a 2020 2020 2020 2020 6966 206e  e):.        if n
-000266c0: 6f74 2069 7369 6e73 7461 6e63 6528 6c61  ot isinstance(la
-000266d0: 672c 2049 6e74 6567 7261 6c29 3a0a 2020  g, Integral):.  
-000266e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000266f0: 5479 7065 4572 726f 7228 226c 6167 206d  TypeError("lag m
-00026700: 7573 7420 6265 2061 6e20 696e 7465 6765  ust be an intege
-00026710: 7222 290a 2020 2020 2020 2020 7265 7475  r").        retu
-00026720: 726e 2073 656c 662e 636f 7272 2873 656c  rn self.corr(sel
-00026730: 6620 6966 206c 6167 203d 3d20 3020 656c  f if lag == 0 el
-00026740: 7365 2073 656c 662e 7368 6966 7428 6c61  se self.shift(la
-00026750: 6729 2c20 7370 6c69 745f 6576 6572 793d  g), split_every=
-00026760: 7370 6c69 745f 6576 6572 7929 0a0a 2020  split_every)..  
-00026770: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00026780: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-00026790: 6566 206d 656d 6f72 795f 7573 6167 6528  ef memory_usage(
-000267a0: 7365 6c66 2c20 696e 6465 783d 5472 7565  self, index=True
-000267b0: 2c20 6465 6570 3d46 616c 7365 293a 0a20  , deep=False):. 
-000267c0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000267d0: 6c66 2e72 6564 7563 7469 6f6e 280a 2020  lf.reduction(.  
-000267e0: 2020 2020 2020 2020 2020 4d2e 6d65 6d6f            M.memo
-000267f0: 7279 5f75 7361 6765 2c0a 2020 2020 2020  ry_usage,.      
-00026800: 2020 2020 2020 4d2e 7375 6d2c 0a20 2020        M.sum,.   
-00026810: 2020 2020 2020 2020 2063 6875 6e6b 5f6b           chunk_k
-00026820: 7761 7267 733d 7b22 696e 6465 7822 3a20  wargs={"index": 
-00026830: 696e 6465 782c 2022 6465 6570 223a 2064  index, "deep": d
-00026840: 6565 707d 2c0a 2020 2020 2020 2020 2020  eep},.          
-00026850: 2020 7370 6c69 745f 6576 6572 793d 4661    split_every=Fa
-00026860: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00026870: 2074 6f6b 656e 3d73 656c 662e 5f74 6f6b   token=self._tok
-00026880: 656e 5f70 7265 6669 7820 2b20 226d 656d  en_prefix + "mem
-00026890: 6f72 792d 7573 6167 6522 2c0a 2020 2020  ory-usage",.    
-000268a0: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
-000268b0: 5f64 6976 6d6f 645f 5f28 7365 6c66 2c20  _divmod__(self, 
-000268c0: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-000268d0: 7265 7331 203d 2073 656c 6620 2f2f 206f  res1 = self // o
-000268e0: 7468 6572 0a20 2020 2020 2020 2072 6573  ther.        res
-000268f0: 3220 3d20 7365 6c66 2025 206f 7468 6572  2 = self % other
-00026900: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00026910: 7265 7331 2c20 7265 7332 0a0a 2020 2020  res1, res2..    
-00026920: 6465 6620 5f5f 7264 6976 6d6f 645f 5f28  def __rdivmod__(
-00026930: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
-00026940: 2020 2020 2020 7265 7331 203d 206f 7468        res1 = oth
-00026950: 6572 202f 2f20 7365 6c66 0a20 2020 2020  er // self.     
-00026960: 2020 2072 6573 3220 3d20 6f74 6865 7220     res2 = other 
-00026970: 2520 7365 6c66 0a20 2020 2020 2020 2072  % self.        r
-00026980: 6574 7572 6e20 7265 7331 2c20 7265 7332  eturn res1, res2
-00026990: 0a0a 2020 2020 6966 206e 6f74 2050 414e  ..    if not PAN
-000269a0: 4441 535f 4754 5f32 3030 3a0a 0a20 2020  DAS_GT_200:..   
-000269b0: 2020 2020 2040 7072 6f70 6572 7479 0a20       @property. 
-000269c0: 2020 2020 2020 2040 6465 7269 7665 645f         @derived_
-000269d0: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
-000269e0: 2020 2020 2020 2020 6465 6620 6973 5f6d          def is_m
-000269f0: 6f6e 6f74 6f6e 6963 2873 656c 6629 3a0a  onotonic(self):.
-00026a00: 2020 2020 2020 2020 2020 2020 6966 2050              if P
-00026a10: 414e 4441 535f 4754 5f31 3530 3a0a 2020  ANDAS_GT_150:.  
-00026a20: 2020 2020 2020 2020 2020 2020 2020 7761                wa
-00026a30: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
-00026a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026a50: 2022 6973 5f6d 6f6e 6f74 6f6e 6963 2069   "is_monotonic i
-00026a60: 7320 6465 7072 6563 6174 6564 2061 6e64  s deprecated and
-00026a70: 2077 696c 6c20 6265 2072 656d 6f76 6564   will be removed
-00026a80: 2069 6e20 6120 6675 7475 7265 2076 6572   in a future ver
-00026a90: 7369 6f6e 2e20 220a 2020 2020 2020 2020  sion. ".        
-00026aa0: 2020 2020 2020 2020 2020 2020 2255 7365              "Use
-00026ab0: 2069 735f 6d6f 6e6f 746f 6e69 635f 696e   is_monotonic_in
-00026ac0: 6372 6561 7369 6e67 2069 6e73 7465 6164  creasing instead
-00026ad0: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-00026ae0: 2020 2020 2020 2020 4675 7475 7265 5761          FutureWa
-00026af0: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
-00026b00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00026b10: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00026b20: 2e69 735f 6d6f 6e6f 746f 6e69 635f 696e  .is_monotonic_in
-00026b30: 6372 6561 7369 6e67 0a0a 2020 2020 4070  creasing..    @p
-00026b40: 726f 7065 7274 790a 2020 2020 4064 6572  roperty.    @der
-00026b50: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
-00026b60: 6965 7329 0a20 2020 2064 6566 2069 735f  ies).    def is_
-00026b70: 6d6f 6e6f 746f 6e69 635f 696e 6372 6561  monotonic_increa
-00026b80: 7369 6e67 2873 656c 6629 3a0a 2020 2020  sing(self):.    
-00026b90: 2020 2020 7265 7475 726e 2061 6361 280a      return aca(.
-00026ba0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00026bb0: 2c0a 2020 2020 2020 2020 2020 2020 6368  ,.            ch
-00026bc0: 756e 6b3d 6d65 7468 6f64 732e 6d6f 6e6f  unk=methods.mono
-00026bd0: 746f 6e69 635f 696e 6372 6561 7369 6e67  tonic_increasing
-00026be0: 5f63 6875 6e6b 2c0a 2020 2020 2020 2020  _chunk,.        
-00026bf0: 2020 2020 636f 6d62 696e 653d 6d65 7468      combine=meth
-00026c00: 6f64 732e 6d6f 6e6f 746f 6e69 635f 696e  ods.monotonic_in
-00026c10: 6372 6561 7369 6e67 5f63 6f6d 6269 6e65  creasing_combine
-00026c20: 2c0a 2020 2020 2020 2020 2020 2020 6167  ,.            ag
-00026c30: 6772 6567 6174 653d 6d65 7468 6f64 732e  gregate=methods.
-00026c40: 6d6f 6e6f 746f 6e69 635f 696e 6372 6561  monotonic_increa
-00026c50: 7369 6e67 5f61 6767 7265 6761 7465 2c0a  sing_aggregate,.
-00026c60: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00026c70: 3d62 6f6f 6c2c 0a20 2020 2020 2020 2020  =bool,.         
-00026c80: 2020 2074 6f6b 656e 3d22 6d6f 6e6f 746f     token="monoto
-00026c90: 6e69 635f 696e 6372 6561 7369 6e67 222c  nic_increasing",
-00026ca0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00026cb0: 4070 726f 7065 7274 790a 2020 2020 4064  @property.    @d
-00026cc0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
-00026cd0: 6572 6965 7329 0a20 2020 2064 6566 2069  eries).    def i
-00026ce0: 735f 6d6f 6e6f 746f 6e69 635f 6465 6372  s_monotonic_decr
-00026cf0: 6561 7369 6e67 2873 656c 6629 3a0a 2020  easing(self):.  
-00026d00: 2020 2020 2020 7265 7475 726e 2061 6361        return aca
-00026d10: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-00026d20: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
-00026d30: 6368 756e 6b3d 6d65 7468 6f64 732e 6d6f  chunk=methods.mo
-00026d40: 6e6f 746f 6e69 635f 6465 6372 6561 7369  notonic_decreasi
-00026d50: 6e67 5f63 6875 6e6b 2c0a 2020 2020 2020  ng_chunk,.      
-00026d60: 2020 2020 2020 636f 6d62 696e 653d 6d65        combine=me
-00026d70: 7468 6f64 732e 6d6f 6e6f 746f 6e69 635f  thods.monotonic_
-00026d80: 6465 6372 6561 7369 6e67 5f63 6f6d 6269  decreasing_combi
-00026d90: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00026da0: 6167 6772 6567 6174 653d 6d65 7468 6f64  aggregate=method
-00026db0: 732e 6d6f 6e6f 746f 6e69 635f 6465 6372  s.monotonic_decr
-00026dc0: 6561 7369 6e67 5f61 6767 7265 6761 7465  easing_aggregate
-00026dd0: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
-00026de0: 7461 3d62 6f6f 6c2c 0a20 2020 2020 2020  ta=bool,.       
-00026df0: 2020 2020 2074 6f6b 656e 3d22 6d6f 6e6f       token="mono
-00026e00: 746f 6e69 635f 6465 6372 6561 7369 6e67  tonic_decreasing
-00026e10: 222c 0a20 2020 2020 2020 2029 0a0a 2020  ",.        )..  
-00026e20: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00026e30: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-00026e40: 6566 2076 6965 7728 7365 6c66 2c20 6474  ef view(self, dt
-00026e50: 7970 6529 3a0a 2020 2020 2020 2020 6d65  ype):.        me
-00026e60: 7461 203d 2073 656c 662e 5f6d 6574 612e  ta = self._meta.
-00026e70: 7669 6577 2864 7479 7065 290a 2020 2020  view(dtype).    
-00026e80: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00026e90: 6d61 705f 7061 7274 6974 696f 6e73 284d  map_partitions(M
-00026ea0: 2e76 6965 772c 2064 7479 7065 2c20 6d65  .view, dtype, me
-00026eb0: 7461 3d6d 6574 6129 0a0a 0a63 6c61 7373  ta=meta)...class
-00026ec0: 2049 6e64 6578 2853 6572 6965 7329 3a0a   Index(Series):.
-00026ed0: 2020 2020 5f70 6172 7469 7469 6f6e 5f74      _partition_t
-00026ee0: 7970 6520 3d20 7064 2e49 6e64 6578 0a20  ype = pd.Index. 
-00026ef0: 2020 205f 6973 5f70 6172 7469 7469 6f6e     _is_partition
-00026f00: 5f74 7970 6520 3d20 7374 6174 6963 6d65  _type = staticme
-00026f10: 7468 6f64 2869 735f 696e 6465 785f 6c69  thod(is_index_li
-00026f20: 6b65 290a 2020 2020 5f74 6f6b 656e 5f70  ke).    _token_p
-00026f30: 7265 6669 7820 3d20 2269 6e64 6578 2d22  refix = "index-"
-00026f40: 0a20 2020 205f 6163 6365 7373 6f72 733a  .    _accessors:
-00026f50: 2043 6c61 7373 5661 725b 7365 745b 7374   ClassVar[set[st
-00026f60: 725d 5d20 3d20 7365 7428 290a 0a20 2020  r]] = set()..   
-00026f70: 205f 6474 5f61 7474 7269 6275 7465 7320   _dt_attributes 
-00026f80: 3d20 7b0a 2020 2020 2020 2020 226e 616e  = {.        "nan
-00026f90: 6f73 6563 6f6e 6422 2c0a 2020 2020 2020  osecond",.      
-00026fa0: 2020 226d 6963 726f 7365 636f 6e64 222c    "microsecond",
-00026fb0: 0a20 2020 2020 2020 2022 6d69 6c6c 6973  .        "millis
-00026fc0: 6563 6f6e 6422 2c0a 2020 2020 2020 2020  econd",.        
-00026fd0: 2264 6179 6f66 7965 6172 222c 0a20 2020  "dayofyear",.   
-00026fe0: 2020 2020 2022 6d69 6e75 7465 222c 0a20       "minute",. 
-00026ff0: 2020 2020 2020 2022 686f 7572 222c 0a20         "hour",. 
-00027000: 2020 2020 2020 2022 6461 7922 2c0a 2020         "day",.  
-00027010: 2020 2020 2020 2264 6179 6f66 7765 656b        "dayofweek
-00027020: 222c 0a20 2020 2020 2020 2022 7365 636f  ",.        "seco
-00027030: 6e64 222c 0a20 2020 2020 2020 2022 7765  nd",.        "we
-00027040: 656b 222c 0a20 2020 2020 2020 2022 7765  ek",.        "we
-00027050: 656b 6461 7922 2c0a 2020 2020 2020 2020  ekday",.        
-00027060: 2277 6565 6b6f 6679 6561 7222 2c0a 2020  "weekofyear",.  
-00027070: 2020 2020 2020 226d 6f6e 7468 222c 0a20        "month",. 
-00027080: 2020 2020 2020 2022 7175 6172 7465 7222         "quarter"
-00027090: 2c0a 2020 2020 2020 2020 2279 6561 7222  ,.        "year"
-000270a0: 2c0a 2020 2020 7d0a 0a20 2020 205f 6361  ,.    }..    _ca
-000270b0: 745f 6174 7472 6962 7574 6573 203d 207b  t_attributes = {
-000270c0: 0a20 2020 2020 2020 2022 6b6e 6f77 6e22  .        "known"
-000270d0: 2c0a 2020 2020 2020 2020 2261 735f 6b6e  ,.        "as_kn
-000270e0: 6f77 6e22 2c0a 2020 2020 2020 2020 2261  own",.        "a
-000270f0: 735f 756e 6b6e 6f77 6e22 2c0a 2020 2020  s_unknown",.    
-00027100: 2020 2020 2261 6464 5f63 6174 6567 6f72      "add_categor
-00027110: 6965 7322 2c0a 2020 2020 2020 2020 2263  ies",.        "c
-00027120: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
-00027130: 2020 2020 2272 656d 6f76 655f 6361 7465      "remove_cate
-00027140: 676f 7269 6573 222c 0a20 2020 2020 2020  gories",.       
-00027150: 2022 7265 6f72 6465 725f 6361 7465 676f   "reorder_catego
-00027160: 7269 6573 222c 0a20 2020 2020 2020 2022  ries",.        "
-00027170: 6173 5f6f 7264 6572 6564 222c 0a20 2020  as_ordered",.   
-00027180: 2020 2020 2022 636f 6465 7322 2c0a 2020       "codes",.  
-00027190: 2020 2020 2020 2272 656d 6f76 655f 756e        "remove_un
-000271a0: 7573 6564 5f63 6174 6567 6f72 6965 7322  used_categories"
-000271b0: 2c0a 2020 2020 2020 2020 2273 6574 5f63  ,.        "set_c
-000271c0: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
-000271d0: 2020 2020 2261 735f 756e 6f72 6465 7265      "as_unordere
-000271e0: 6422 2c0a 2020 2020 2020 2020 226f 7264  d",.        "ord
-000271f0: 6572 6564 222c 0a20 2020 2020 2020 2022  ered",.        "
-00027200: 7265 6e61 6d65 5f63 6174 6567 6f72 6965  rename_categorie
-00027210: 7322 2c0a 2020 2020 7d0a 0a20 2020 205f  s",.    }..    _
-00027220: 6d6f 6e6f 746f 6e69 635f 6174 7472 6962  monotonic_attrib
-00027230: 7574 6573 203d 207b 0a20 2020 2020 2020  utes = {.       
-00027240: 2022 6973 5f6d 6f6e 6f74 6f6e 6963 222c   "is_monotonic",
-00027250: 0a20 2020 2020 2020 2022 6973 5f6d 6f6e  .        "is_mon
-00027260: 6f74 6f6e 6963 5f69 6e63 7265 6173 696e  otonic_increasin
-00027270: 6722 2c0a 2020 2020 2020 2020 2269 735f  g",.        "is_
-00027280: 6d6f 6e6f 746f 6e69 635f 6465 6372 6561  monotonic_decrea
-00027290: 7369 6e67 222c 0a20 2020 207d 0a0a 2020  sing",.    }..  
-000272a0: 2020 6465 6620 5f5f 6765 7461 7474 725f    def __getattr_
-000272b0: 5f28 7365 6c66 2c20 6b65 7929 3a0a 2020  _(self, key):.  
-000272c0: 2020 2020 2020 6966 2069 735f 6361 7465        if is_cate
-000272d0: 676f 7269 6361 6c5f 6474 7970 6528 7365  gorical_dtype(se
-000272e0: 6c66 2e5f 6d65 7461 2e64 7479 7065 2920  lf._meta.dtype) 
-000272f0: 616e 6420 6b65 7920 696e 2073 656c 662e  and key in self.
-00027300: 5f63 6174 5f61 7474 7269 6275 7465 733a  _cat_attributes:
-00027310: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00027320: 7572 6e20 6765 7461 7474 7228 7365 6c66  urn getattr(self
-00027330: 2e63 6174 2c20 6b65 7929 0a20 2020 2020  .cat, key).     
-00027340: 2020 2065 6c69 6620 6b65 7920 696e 2073     elif key in s
-00027350: 656c 662e 5f64 745f 6174 7472 6962 7574  elf._dt_attribut
-00027360: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00027370: 7265 7475 726e 2067 6574 6174 7472 2873  return getattr(s
-00027380: 656c 662e 6474 2c20 6b65 7929 0a20 2020  elf.dt, key).   
-00027390: 2020 2020 2065 6c69 6620 6b65 7920 696e       elif key in
-000273a0: 2073 656c 662e 5f6d 6f6e 6f74 6f6e 6963   self._monotonic
-000273b0: 5f61 7474 7269 6275 7465 733a 0a20 2020  _attributes:.   
-000273c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000273d0: 6765 7461 7474 7228 7365 6c66 2c20 6b65  getattr(self, ke
-000273e0: 7929 0a20 2020 2020 2020 2072 6169 7365  y).        raise
-000273f0: 2041 7474 7269 6275 7465 4572 726f 7228   AttributeError(
-00027400: 2227 496e 6465 7827 206f 626a 6563 7420  "'Index' object 
-00027410: 6861 7320 6e6f 2061 7474 7269 6275 7465  has no attribute
-00027420: 2025 7222 2025 206b 6579 290a 0a20 2020   %r" % key)..   
-00027430: 2064 6566 205f 5f64 6972 5f5f 2873 656c   def __dir__(sel
-00027440: 6629 3a0a 2020 2020 2020 2020 6f75 7420  f):.        out 
-00027450: 3d20 7375 7065 7228 292e 5f5f 6469 725f  = super().__dir_
-00027460: 5f28 290a 2020 2020 2020 2020 6f75 742e  _().        out.
-00027470: 6578 7465 6e64 2873 656c 662e 5f64 745f  extend(self._dt_
-00027480: 6174 7472 6962 7574 6573 290a 2020 2020  attributes).    
-00027490: 2020 2020 6966 2069 735f 6361 7465 676f      if is_catego
-000274a0: 7269 6361 6c5f 6474 7970 6528 7365 6c66  rical_dtype(self
-000274b0: 2e64 7479 7065 293a 0a20 2020 2020 2020  .dtype):.       
-000274c0: 2020 2020 206f 7574 2e65 7874 656e 6428       out.extend(
-000274d0: 7365 6c66 2e5f 6361 745f 6174 7472 6962  self._cat_attrib
-000274e0: 7574 6573 290a 2020 2020 2020 2020 7265  utes).        re
-000274f0: 7475 726e 206f 7574 0a0a 2020 2020 2320  turn out..    # 
-00027500: 5479 7069 6e67 3a20 6874 7470 733a 2f2f  Typing: https://
-00027510: 6769 7468 7562 2e63 6f6d 2f70 7974 686f  github.com/pytho
-00027520: 6e2f 6d79 7079 2f69 7373 7565 732f 3431  n/mypy/issues/41
-00027530: 3235 0a20 2020 2040 7072 6f70 6572 7479  25.    @property
-00027540: 2020 2320 7479 7065 3a20 6967 6e6f 7265    # type: ignore
-00027550: 0a20 2020 2064 6566 2069 6e64 6578 2873  .    def index(s
-00027560: 656c 6629 3a0a 2020 2020 2020 2020 7261  elf):.        ra
-00027570: 6973 6520 4174 7472 6962 7574 6545 7272  ise AttributeErr
-00027580: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00027590: 6622 7b73 656c 662e 5f5f 636c 6173 735f  f"{self.__class_
-000275a0: 5f2e 5f5f 6e61 6d65 5f5f 2172 7d20 6f62  _.__name__!r} ob
-000275b0: 6a65 6374 2068 6173 206e 6f20 6174 7472  ject has no attr
-000275c0: 6962 7574 6520 2769 6e64 6578 2722 0a20  ibute 'index'". 
-000275d0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-000275e0: 6620 5f5f 6172 7261 795f 7772 6170 5f5f  f __array_wrap__
-000275f0: 2873 656c 662c 2061 7272 6179 2c20 636f  (self, array, co
-00027600: 6e74 6578 743d 4e6f 6e65 293a 0a20 2020  ntext=None):.   
-00027610: 2020 2020 2072 6574 7572 6e20 7064 2e49       return pd.I
-00027620: 6e64 6578 2861 7272 6179 2c20 6e61 6d65  ndex(array, name
-00027630: 3d73 656c 662e 6e61 6d65 290a 0a20 2020  =self.name)..   
-00027640: 2064 6566 2068 6561 6428 7365 6c66 2c20   def head(self, 
-00027650: 6e3d 352c 2063 6f6d 7075 7465 3d54 7275  n=5, compute=Tru
-00027660: 6529 3a0a 2020 2020 2020 2020 2222 2246  e):.        """F
-00027670: 6972 7374 206e 2069 7465 6d73 206f 6620  irst n items of 
-00027680: 7468 6520 496e 6465 782e 0a0a 2020 2020  the Index...    
-00027690: 2020 2020 4361 7665 6174 2c20 7468 6973      Caveat, this
-000276a0: 206f 6e6c 7920 6368 6563 6b73 2074 6865   only checks the
-000276b0: 2066 6972 7374 2070 6172 7469 7469 6f6e   first partition
-000276c0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000276d0: 2020 2020 2020 6e61 6d65 203d 2022 6865        name = "he
-000276e0: 6164 2d25 642d 2573 2220 2520 286e 2c20  ad-%d-%s" % (n, 
-000276f0: 7365 6c66 2e5f 6e61 6d65 290a 2020 2020  self._name).    
-00027700: 2020 2020 6473 6b20 3d20 7b28 6e61 6d65      dsk = {(name
-00027710: 2c20 3029 3a20 286f 7065 7261 746f 722e  , 0): (operator.
-00027720: 6765 7469 7465 6d2c 2028 7365 6c66 2e5f  getitem, (self._
-00027730: 6e61 6d65 2c20 3029 2c20 736c 6963 6528  name, 0), slice(
-00027740: 302c 206e 2929 7d0a 2020 2020 2020 2020  0, n))}.        
-00027750: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
-00027760: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
-00027770: 6563 7469 6f6e 7328 6e61 6d65 2c20 6473  ections(name, ds
-00027780: 6b2c 2064 6570 656e 6465 6e63 6965 733d  k, dependencies=
-00027790: 5b73 656c 665d 290a 0a20 2020 2020 2020  [self])..       
-000277a0: 2072 6573 756c 7420 3d20 6e65 775f 6464   result = new_dd
-000277b0: 5f6f 626a 6563 7428 6772 6170 682c 206e  _object(graph, n
-000277c0: 616d 652c 2073 656c 662e 5f6d 6574 612c  ame, self._meta,
-000277d0: 2073 656c 662e 6469 7669 7369 6f6e 735b   self.divisions[
-000277e0: 3a32 5d29 0a0a 2020 2020 2020 2020 6966  :2])..        if
-000277f0: 2063 6f6d 7075 7465 3a0a 2020 2020 2020   compute:.      
-00027800: 2020 2020 2020 7265 7375 6c74 203d 2072        result = r
-00027810: 6573 756c 742e 636f 6d70 7574 6528 290a  esult.compute().
-00027820: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00027830: 6573 756c 740a 0a20 2020 2040 6465 7269  esult..    @deri
-00027840: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
-00027850: 7829 0a20 2020 2064 6566 206d 6178 2873  x).    def max(s
-00027860: 656c 662c 2073 706c 6974 5f65 7665 7279  elf, split_every
-00027870: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
-00027880: 2072 6574 7572 6e20 7365 6c66 2e72 6564   return self.red
-00027890: 7563 7469 6f6e 280a 2020 2020 2020 2020  uction(.        
-000278a0: 2020 2020 4d2e 6d61 782c 0a20 2020 2020      M.max,.     
-000278b0: 2020 2020 2020 206d 6574 613d 7365 6c66         meta=self
-000278c0: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-000278d0: 6d61 7828 292c 0a20 2020 2020 2020 2020  max(),.         
-000278e0: 2020 2074 6f6b 656e 3d73 656c 662e 5f74     token=self._t
-000278f0: 6f6b 656e 5f70 7265 6669 7820 2b20 226d  oken_prefix + "m
-00027900: 6178 222c 0a20 2020 2020 2020 2020 2020  ax",.           
-00027910: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-00027920: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
-00027930: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
-00027940: 645f 6672 6f6d 2870 642e 496e 6465 7829  d_from(pd.Index)
-00027950: 0a20 2020 2064 6566 206d 696e 2873 656c  .    def min(sel
-00027960: 662c 2073 706c 6974 5f65 7665 7279 3d46  f, split_every=F
-00027970: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
-00027980: 6574 7572 6e20 7365 6c66 2e72 6564 7563  eturn self.reduc
-00027990: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-000279a0: 2020 4d2e 6d69 6e2c 0a20 2020 2020 2020    M.min,.       
-000279b0: 2020 2020 206d 6574 613d 7365 6c66 2e5f       meta=self._
-000279c0: 6d65 7461 5f6e 6f6e 656d 7074 792e 6d69  meta_nonempty.mi
-000279d0: 6e28 292c 0a20 2020 2020 2020 2020 2020  n(),.           
-000279e0: 2074 6f6b 656e 3d73 656c 662e 5f74 6f6b   token=self._tok
-000279f0: 656e 5f70 7265 6669 7820 2b20 226d 696e  en_prefix + "min
-00027a00: 222c 0a20 2020 2020 2020 2020 2020 2073  ",.            s
-00027a10: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-00027a20: 5f65 7665 7279 2c0a 2020 2020 2020 2020  _every,.        
-00027a30: 290a 0a20 2020 2064 6566 2063 6f75 6e74  )..    def count
-00027a40: 2873 656c 662c 2073 706c 6974 5f65 7665  (self, split_eve
-00027a50: 7279 3d46 616c 7365 293a 0a20 2020 2020  ry=False):.     
-00027a60: 2020 2072 6574 7572 6e20 7365 6c66 2e72     return self.r
-00027a70: 6564 7563 7469 6f6e 280a 2020 2020 2020  eduction(.      
-00027a80: 2020 2020 2020 6d65 7468 6f64 732e 696e        methods.in
-00027a90: 6465 785f 636f 756e 742c 0a20 2020 2020  dex_count,.     
-00027aa0: 2020 2020 2020 206e 702e 7375 6d2c 0a20         np.sum,. 
-00027ab0: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
-00027ac0: 3d22 696e 6465 782d 636f 756e 7422 2c0a  ="index-count",.
-00027ad0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00027ae0: 3d69 6e74 2c0a 2020 2020 2020 2020 2020  =int,.          
-00027af0: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
-00027b00: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
-00027b10: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
-00027b20: 6564 5f66 726f 6d28 7064 2e49 6e64 6578  ed_from(pd.Index
-00027b30: 290a 2020 2020 6465 6620 7368 6966 7428  ).    def shift(
-00027b40: 7365 6c66 2c20 7065 7269 6f64 733d 312c  self, periods=1,
-00027b50: 2066 7265 713d 4e6f 6e65 293a 0a20 2020   freq=None):.   
-00027b60: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00027b70: 6365 2873 656c 662e 5f6d 6574 612c 2070  ce(self._meta, p
-00027b80: 642e 5065 7269 6f64 496e 6465 7829 3a0a  d.PeriodIndex):.
-00027b90: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-00027ba0: 7265 7120 6973 206e 6f74 204e 6f6e 653a  req is not None:
-00027bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027bc0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00027bd0: 7228 2250 6572 696f 6449 6e64 6578 2064  r("PeriodIndex d
-00027be0: 6f65 736e 2774 2061 6363 6570 7420 6066  oesn't accept `f
-00027bf0: 7265 7160 2061 7267 756d 656e 7422 290a  req` argument").
-00027c00: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00027c10: 203d 2073 656c 662e 5f6d 6574 615f 6e6f   = self._meta_no
-00027c20: 6e65 6d70 7479 2e73 6869 6674 2870 6572  nempty.shift(per
-00027c30: 696f 6473 290a 2020 2020 2020 2020 2020  iods).          
-00027c40: 2020 6f75 7420 3d20 7365 6c66 2e6d 6170    out = self.map
-00027c50: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-00027c60: 2020 2020 2020 2020 2020 2020 204d 2e73               M.s
-00027c70: 6869 6674 2c20 7065 7269 6f64 732c 206d  hift, periods, m
-00027c80: 6574 613d 6d65 7461 2c20 746f 6b65 6e3d  eta=meta, token=
-00027c90: 2273 6869 6674 222c 2074 7261 6e73 666f  "shift", transfo
-00027ca0: 726d 5f64 6976 6973 696f 6e73 3d46 616c  rm_divisions=Fal
-00027cb0: 7365 0a20 2020 2020 2020 2020 2020 2029  se.            )
-00027cc0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00027cd0: 2020 2020 2020 2020 2020 2023 2050 616e             # Pan
-00027ce0: 6461 7320 7769 6c6c 2072 6169 7365 2066  das will raise f
-00027cf0: 6f72 206f 7468 6572 2069 6e64 6578 2074  or other index t
-00027d00: 7970 6573 2074 6861 7420 646f 6e27 7420  ypes that don't 
-00027d10: 696d 706c 656d 656e 7420 7368 6966 740a  implement shift.
-00027d20: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00027d30: 203d 2073 656c 662e 5f6d 6574 615f 6e6f   = self._meta_no
-00027d40: 6e65 6d70 7479 2e73 6869 6674 2870 6572  nempty.shift(per
-00027d50: 696f 6473 2c20 6672 6571 3d66 7265 7129  iods, freq=freq)
-00027d60: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-00027d70: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
-00027d80: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-00027d90: 2020 2020 2020 2020 4d2e 7368 6966 742c          M.shift,
-00027da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027db0: 2070 6572 696f 6473 2c0a 2020 2020 2020   periods,.      
-00027dc0: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
-00027dd0: 2273 6869 6674 222c 0a20 2020 2020 2020  "shift",.       
-00027de0: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
-00027df0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-00027e00: 2020 2020 6672 6571 3d66 7265 712c 0a20      freq=freq,. 
-00027e10: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00027e20: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
-00027e30: 6e73 3d46 616c 7365 2c0a 2020 2020 2020  ns=False,.      
-00027e40: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00027e50: 6966 2066 7265 7120 6973 204e 6f6e 653a  if freq is None:
-00027e60: 0a20 2020 2020 2020 2020 2020 2066 7265  .            fre
-00027e70: 7120 3d20 6d65 7461 2e66 7265 710a 2020  q = meta.freq.  
-00027e80: 2020 2020 2020 7265 7475 726e 206d 6179        return may
-00027e90: 6265 5f73 6869 6674 5f64 6976 6973 696f  be_shift_divisio
-00027ea0: 6e73 286f 7574 2c20 7065 7269 6f64 732c  ns(out, periods,
-00027eb0: 2066 7265 713d 6672 6571 290a 0a20 2020   freq=freq)..   
-00027ec0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00027ed0: 642e 496e 6465 7829 0a20 2020 2064 6566  d.Index).    def
-00027ee0: 2074 6f5f 7365 7269 6573 2873 656c 6629   to_series(self)
-00027ef0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00027f00: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-00027f10: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
-00027f20: 2020 4d2e 746f 5f73 6572 6965 732c 0a20    M.to_series,. 
-00027f30: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
-00027f40: 7365 6c66 2e5f 6d65 7461 2e74 6f5f 7365  self._meta.to_se
-00027f50: 7269 6573 2829 2c0a 2020 2020 2020 2020  ries(),.        
-00027f60: 2020 2020 7472 616e 7366 6f72 6d5f 6469      transform_di
-00027f70: 7669 7369 6f6e 733d 4661 6c73 652c 0a20  visions=False,. 
-00027f80: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-00027f90: 6572 6976 6564 5f66 726f 6d28 7064 2e49  erived_from(pd.I
-00027fa0: 6e64 6578 2c20 7561 5f61 7267 733d 5b22  ndex, ua_args=["
-00027fb0: 696e 6465 7822 5d29 0a20 2020 2064 6566  index"]).    def
-00027fc0: 2074 6f5f 6672 616d 6528 7365 6c66 2c20   to_frame(self, 
-00027fd0: 696e 6465 783d 5472 7565 2c20 6e61 6d65  index=True, name
-00027fe0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00027ff0: 6966 206e 6f74 2069 6e64 6578 3a0a 2020  if not index:.  
-00028000: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00028010: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00028020: 726f 7228 290a 2020 2020 2020 2020 6172  ror().        ar
-00028030: 6773 203d 205b 696e 6465 785d 2069 6620  gs = [index] if 
-00028040: 6e61 6d65 2069 7320 4e6f 6e65 2065 6c73  name is None els
-00028050: 6520 5b69 6e64 6578 2c20 6e61 6d65 5d0a  e [index, name].
-00028060: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00028070: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-00028080: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-00028090: 204d 2e74 6f5f 6672 616d 652c 0a20 2020   M.to_frame,.   
-000280a0: 2020 2020 2020 2020 202a 6172 6773 2c0a           *args,.
-000280b0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-000280c0: 3d73 656c 662e 5f6d 6574 612e 746f 5f66  =self._meta.to_f
-000280d0: 7261 6d65 282a 6172 6773 292c 0a20 2020  rame(*args),.   
-000280e0: 2020 2020 2020 2020 2074 7261 6e73 666f           transfo
-000280f0: 726d 5f64 6976 6973 696f 6e73 3d46 616c  rm_divisions=Fal
-00028100: 7365 2c0a 2020 2020 2020 2020 290a 0a20  se,.        ).. 
-00028110: 2020 2040 696e 7365 7274 5f6d 6574 615f     @insert_meta_
-00028120: 7061 7261 6d5f 6465 7363 7269 7074 696f  param_descriptio
-00028130: 6e28 7061 643d 3132 290a 2020 2020 4064  n(pad=12).    @d
-00028140: 6572 6976 6564 5f66 726f 6d28 7064 2e49  erived_from(pd.I
-00028150: 6e64 6578 290a 2020 2020 6465 6620 6d61  ndex).    def ma
-00028160: 7028 7365 6c66 2c20 6172 672c 206e 615f  p(self, arg, na_
-00028170: 6163 7469 6f6e 3d4e 6f6e 652c 206d 6574  action=None, met
-00028180: 613d 6e6f 5f64 6566 6175 6c74 2c20 6973  a=no_default, is
-00028190: 5f6d 6f6e 6f74 6f6e 6963 3d46 616c 7365  _monotonic=False
-000281a0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-000281b0: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
-000281c0: 2074 6869 7320 6d65 7468 6f64 2063 6c65   this method cle
-000281d0: 6172 7320 616e 7920 6b6e 6f77 6e20 6469  ars any known di
-000281e0: 7669 7369 6f6e 732e 0a0a 2020 2020 2020  visions...      
-000281f0: 2020 4966 2079 6f75 7220 6d61 7070 696e    If your mappin
-00028200: 6720 6675 6e63 7469 6f6e 2069 7320 6d6f  g function is mo
-00028210: 6e6f 746f 6e69 6361 6c6c 7920 696e 6372  notonically incr
-00028220: 6561 7369 6e67 2074 6865 6e20 7573 6520  easing then use 
-00028230: 6069 735f 6d6f 6e6f 746f 6e69 6360 0a20  `is_monotonic`. 
-00028240: 2020 2020 2020 2074 6f20 6170 706c 7920         to apply 
-00028250: 7468 6520 6d61 7069 6e67 2066 756e 6374  the maping funct
-00028260: 696f 6e20 746f 2074 6865 206f 6c64 2064  ion to the old d
-00028270: 6976 6973 696f 6e73 2061 6e64 2061 7373  ivisions and ass
-00028280: 6967 6e20 7468 6520 6e65 770a 2020 2020  ign the new.    
-00028290: 2020 2020 6469 7669 7369 6f6e 7320 746f      divisions to
-000282a0: 2074 6865 206f 7574 7075 742e 0a0a 2020   the output...  
-000282b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000282c0: 2020 6170 706c 6965 6420 3d20 7375 7065    applied = supe
-000282d0: 7228 292e 6d61 7028 6172 672c 206e 615f  r().map(arg, na_
-000282e0: 6163 7469 6f6e 3d6e 615f 6163 7469 6f6e  action=na_action
-000282f0: 2c20 6d65 7461 3d6d 6574 6129 0a20 2020  , meta=meta).   
-00028300: 2020 2020 2069 6620 6973 5f6d 6f6e 6f74       if is_monot
-00028310: 6f6e 6963 2061 6e64 2073 656c 662e 6b6e  onic and self.kn
-00028320: 6f77 6e5f 6469 7669 7369 6f6e 733a 0a20  own_divisions:. 
-00028330: 2020 2020 2020 2020 2020 2061 7070 6c69             appli
-00028340: 6564 2e64 6976 6973 696f 6e73 203d 2074  ed.divisions = t
-00028350: 7570 6c65 280a 2020 2020 2020 2020 2020  uple(.          
-00028360: 2020 2020 2020 7064 2e53 6572 6965 7328        pd.Series(
-00028370: 7365 6c66 2e64 6976 6973 696f 6e73 292e  self.divisions).
-00028380: 6d61 7028 6172 672c 206e 615f 6163 7469  map(arg, na_acti
-00028390: 6f6e 3d6e 615f 6163 7469 6f6e 290a 2020  on=na_action).  
-000283a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000283b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000283c0: 2020 2020 2020 6170 706c 6965 6420 3d20        applied = 
-000283d0: 6170 706c 6965 642e 636c 6561 725f 6469  applied.clear_di
-000283e0: 7669 7369 6f6e 7328 290a 2020 2020 2020  visions().      
-000283f0: 2020 7265 7475 726e 2061 7070 6c69 6564    return applied
-00028400: 0a0a 2020 2020 6966 206e 6f74 2050 414e  ..    if not PAN
-00028410: 4441 535f 4754 5f32 3030 3a0a 0a20 2020  DAS_GT_200:..   
-00028420: 2020 2020 2040 7072 6f70 6572 7479 0a20       @property. 
-00028430: 2020 2020 2020 2040 6465 7269 7665 645f         @derived_
-00028440: 6672 6f6d 2870 642e 496e 6465 7829 0a20  from(pd.Index). 
-00028450: 2020 2020 2020 2064 6566 2069 735f 6d6f         def is_mo
-00028460: 6e6f 746f 6e69 6328 7365 6c66 293a 0a20  notonic(self):. 
-00028470: 2020 2020 2020 2020 2020 2069 6620 5041             if PA
-00028480: 4e44 4153 5f47 545f 3135 303a 0a20 2020  NDAS_GT_150:.   
-00028490: 2020 2020 2020 2020 2020 2020 2077 6172               war
-000284a0: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-000284b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000284c0: 2269 735f 6d6f 6e6f 746f 6e69 6320 6973  "is_monotonic is
-000284d0: 2064 6570 7265 6361 7465 6420 616e 6420   deprecated and 
-000284e0: 7769 6c6c 2062 6520 7265 6d6f 7665 6420  will be removed 
-000284f0: 696e 2061 2066 7574 7572 6520 7665 7273  in a future vers
-00028500: 696f 6e2e 2022 0a20 2020 2020 2020 2020  ion. ".         
-00028510: 2020 2020 2020 2020 2020 2022 5573 6520             "Use 
-00028520: 6973 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63  is_monotonic_inc
-00028530: 7265 6173 696e 6720 696e 7374 6561 642e  reasing instead.
-00028540: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00028550: 2020 2020 2020 2046 7574 7572 6557 6172         FutureWar
-00028560: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
-00028570: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00028580: 2020 2020 7265 7475 726e 2073 7570 6572      return super
-00028590: 2829 2e69 735f 6d6f 6e6f 746f 6e69 635f  ().is_monotonic_
-000285a0: 696e 6372 6561 7369 6e67 0a0a 2020 2020  increasing..    
-000285b0: 4070 726f 7065 7274 790a 2020 2020 4064  @property.    @d
-000285c0: 6572 6976 6564 5f66 726f 6d28 7064 2e49  erived_from(pd.I
-000285d0: 6e64 6578 290a 2020 2020 6465 6620 6973  ndex).    def is
-000285e0: 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63 7265  _monotonic_incre
-000285f0: 6173 696e 6728 7365 6c66 293a 0a20 2020  asing(self):.   
-00028600: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-00028610: 7228 292e 6973 5f6d 6f6e 6f74 6f6e 6963  r().is_monotonic
-00028620: 5f69 6e63 7265 6173 696e 670a 0a20 2020  _increasing..   
-00028630: 2040 7072 6f70 6572 7479 0a20 2020 2040   @property.    @
-00028640: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00028650: 496e 6465 7829 0a20 2020 2064 6566 2069  Index).    def i
-00028660: 735f 6d6f 6e6f 746f 6e69 635f 6465 6372  s_monotonic_decr
-00028670: 6561 7369 6e67 2873 656c 6629 3a0a 2020  easing(self):.  
-00028680: 2020 2020 2020 7265 7475 726e 2073 7570        return sup
-00028690: 6572 2829 2e69 735f 6d6f 6e6f 746f 6e69  er().is_monotoni
-000286a0: 635f 6465 6372 6561 7369 6e67 0a0a 2020  c_decreasing..  
-000286b0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-000286c0: 7064 2e49 6e64 6578 290a 2020 2020 6465  pd.Index).    de
-000286d0: 6620 6d65 6d6f 7279 5f75 7361 6765 2873  f memory_usage(s
-000286e0: 656c 662c 2064 6565 703d 4661 6c73 6529  elf, deep=False)
-000286f0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00028700: 2073 656c 662e 7265 6475 6374 696f 6e28   self.reduction(
-00028710: 0a20 2020 2020 2020 2020 2020 204d 2e6d  .            M.m
-00028720: 656d 6f72 795f 7573 6167 652c 0a20 2020  emory_usage,.   
-00028730: 2020 2020 2020 2020 204d 2e73 756d 2c0a           M.sum,.
-00028740: 2020 2020 2020 2020 2020 2020 6368 756e              chun
-00028750: 6b5f 6b77 6172 6773 3d7b 2264 6565 7022  k_kwargs={"deep"
-00028760: 3a20 6465 6570 7d2c 0a20 2020 2020 2020  : deep},.       
-00028770: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-00028780: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00028790: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
-000287a0: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
-000287b0: 6d65 6d6f 7279 2d75 7361 6765 222c 0a20  memory-usage",. 
-000287c0: 2020 2020 2020 2029 0a0a 0a63 6c61 7373         )...class
-000287d0: 2044 6174 6146 7261 6d65 285f 4672 616d   DataFrame(_Fram
-000287e0: 6529 3a0a 2020 2020 2222 220a 2020 2020  e):.    """.    
-000287f0: 5061 7261 6c6c 656c 2050 616e 6461 7320  Parallel Pandas 
-00028800: 4461 7461 4672 616d 650a 0a20 2020 2044  DataFrame..    D
-00028810: 6f20 6e6f 7420 7573 6520 7468 6973 2063  o not use this c
-00028820: 6c61 7373 2064 6972 6563 746c 792e 2020  lass directly.  
-00028830: 496e 7374 6561 6420 7573 6520 6675 6e63  Instead use func
-00028840: 7469 6f6e 7320 6c69 6b65 0a20 2020 2060  tions like.    `
-00028850: 6064 642e 7265 6164 5f63 7376 6060 2c20  `dd.read_csv``, 
-00028860: 6060 6464 2e72 6561 645f 7061 7271 7565  ``dd.read_parque
-00028870: 7460 602c 206f 7220 6060 6464 2e66 726f  t``, or ``dd.fro
-00028880: 6d5f 7061 6e64 6173 6060 2e0a 0a20 2020  m_pandas``...   
-00028890: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-000288a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064  ----------.    d
-000288b0: 736b 3a20 6469 6374 0a20 2020 2020 2020  sk: dict.       
-000288c0: 2054 6865 2064 6173 6b20 6772 6170 6820   The dask graph 
-000288d0: 746f 2063 6f6d 7075 7465 2074 6869 7320  to compute this 
-000288e0: 4461 7461 4672 616d 650a 2020 2020 6e61  DataFrame.    na
-000288f0: 6d65 3a20 7374 720a 2020 2020 2020 2020  me: str.        
-00028900: 5468 6520 6b65 7920 7072 6566 6978 2074  The key prefix t
-00028910: 6861 7420 7370 6563 6966 6965 7320 7768  hat specifies wh
-00028920: 6963 6820 6b65 7973 2069 6e20 7468 6520  ich keys in the 
-00028930: 6461 736b 2063 6f6d 7072 6973 6520 7468  dask comprise th
-00028940: 6973 0a20 2020 2020 2020 2070 6172 7469  is.        parti
-00028950: 6375 6c61 7220 4461 7461 4672 616d 650a  cular DataFrame.
-00028960: 2020 2020 6d65 7461 3a20 7061 6e64 6173      meta: pandas
-00028970: 2e44 6174 6146 7261 6d65 0a20 2020 2020  .DataFrame.     
-00028980: 2020 2041 6e20 656d 7074 7920 6060 7061     An empty ``pa
-00028990: 6e64 6173 2e44 6174 6146 7261 6d65 6060  ndas.DataFrame``
-000289a0: 2077 6974 6820 6e61 6d65 732c 2064 7479   with names, dty
-000289b0: 7065 732c 2061 6e64 2069 6e64 6578 206d  pes, and index m
-000289c0: 6174 6368 696e 670a 2020 2020 2020 2020  atching.        
-000289d0: 7468 6520 6578 7065 6374 6564 206f 7574  the expected out
-000289e0: 7075 742e 0a20 2020 2064 6976 6973 696f  put..    divisio
-000289f0: 6e73 3a20 7475 706c 6520 6f66 2069 6e64  ns: tuple of ind
-00028a00: 6578 2076 616c 7565 730a 2020 2020 2020  ex values.      
-00028a10: 2020 5661 6c75 6573 2061 6c6f 6e67 2077    Values along w
-00028a20: 6869 6368 2077 6520 7061 7274 6974 696f  hich we partitio
-00028a30: 6e20 6f75 7220 626c 6f63 6b73 206f 6e20  n our blocks on 
-00028a40: 7468 6520 696e 6465 780a 2020 2020 2222  the index.    ""
-00028a50: 220a 0a20 2020 205f 7061 7274 6974 696f  "..    _partitio
-00028a60: 6e5f 7479 7065 203d 2070 642e 4461 7461  n_type = pd.Data
-00028a70: 4672 616d 650a 2020 2020 5f69 735f 7061  Frame.    _is_pa
-00028a80: 7274 6974 696f 6e5f 7479 7065 203d 2073  rtition_type = s
-00028a90: 7461 7469 636d 6574 686f 6428 6973 5f64  taticmethod(is_d
-00028aa0: 6174 6166 7261 6d65 5f6c 696b 6529 0a20  ataframe_like). 
-00028ab0: 2020 205f 746f 6b65 6e5f 7072 6566 6978     _token_prefix
-00028ac0: 203d 2022 6461 7461 6672 616d 652d 220a   = "dataframe-".
-00028ad0: 2020 2020 5f61 6363 6573 736f 7273 3a20      _accessors: 
-00028ae0: 436c 6173 7356 6172 5b73 6574 5b73 7472  ClassVar[set[str
-00028af0: 5d5d 203d 2073 6574 2829 0a0a 2020 2020  ]] = set()..    
-00028b00: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-00028b10: 662c 2064 736b 2c20 6e61 6d65 2c20 6d65  f, dsk, name, me
-00028b20: 7461 2c20 6469 7669 7369 6f6e 7329 3a0a  ta, divisions):.
-00028b30: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-00028b40: 5f5f 696e 6974 5f5f 2864 736b 2c20 6e61  __init__(dsk, na
-00028b50: 6d65 2c20 6d65 7461 2c20 6469 7669 7369  me, meta, divisi
-00028b60: 6f6e 7329 0a20 2020 2020 2020 2069 6620  ons).        if 
-00028b70: 7365 6c66 2e64 6173 6b2e 6c61 7965 7273  self.dask.layers
-00028b80: 5b6e 616d 655d 2e63 6f6c 6c65 6374 696f  [name].collectio
-00028b90: 6e5f 616e 6e6f 7461 7469 6f6e 7320 6973  n_annotations is
-00028ba0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00028bb0: 2020 2073 656c 662e 6461 736b 2e6c 6179     self.dask.lay
-00028bc0: 6572 735b 6e61 6d65 5d2e 636f 6c6c 6563  ers[name].collec
-00028bd0: 7469 6f6e 5f61 6e6e 6f74 6174 696f 6e73  tion_annotations
-00028be0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00028bf0: 2020 2020 2022 6e70 6172 7469 7469 6f6e       "npartition
-00028c00: 7322 3a20 7365 6c66 2e6e 7061 7274 6974  s": self.npartit
-00028c10: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-00028c20: 2020 2020 2020 2263 6f6c 756d 6e73 223a        "columns":
-00028c30: 205b 636f 6c20 666f 7220 636f 6c20 696e   [col for col in
-00028c40: 2073 656c 662e 636f 6c75 6d6e 735d 2c0a   self.columns],.
-00028c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028c60: 2274 7970 6522 3a20 7479 7065 6e61 6d65  "type": typename
-00028c70: 2874 7970 6528 7365 6c66 2929 2c0a 2020  (type(self)),.  
-00028c80: 2020 2020 2020 2020 2020 2020 2020 2264                "d
-00028c90: 6174 6166 7261 6d65 5f74 7970 6522 3a20  ataframe_type": 
-00028ca0: 7479 7065 6e61 6d65 2874 7970 6528 7365  typename(type(se
-00028cb0: 6c66 2e5f 6d65 7461 2929 2c0a 2020 2020  lf._meta)),.    
-00028cc0: 2020 2020 2020 2020 2020 2020 2273 6572              "ser
-00028cd0: 6965 735f 6474 7970 6573 223a 207b 0a20  ies_dtypes": {. 
-00028ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028cf0: 2020 2063 6f6c 3a20 7365 6c66 2e5f 6d65     col: self._me
-00028d00: 7461 5b63 6f6c 5d2e 6474 7970 650a 2020  ta[col].dtype.  
-00028d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d20: 2020 6966 2068 6173 6174 7472 2873 656c    if hasattr(sel
-00028d30: 662e 5f6d 6574 615b 636f 6c5d 2c20 2264  f._meta[col], "d
-00028d40: 7479 7065 2229 0a20 2020 2020 2020 2020  type").         
-00028d50: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
-00028d60: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00028d70: 2020 2020 2020 2020 2066 6f72 2063 6f6c           for col
-00028d80: 2069 6e20 7365 6c66 2e5f 6d65 7461 2e63   in self._meta.c
-00028d90: 6f6c 756d 6e73 0a20 2020 2020 2020 2020  olumns.         
-00028da0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00028db0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00028dc0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00028dd0: 2020 7365 6c66 2e64 6173 6b2e 6c61 7965    self.dask.laye
-00028de0: 7273 5b6e 616d 655d 2e63 6f6c 6c65 6374  rs[name].collect
-00028df0: 696f 6e5f 616e 6e6f 7461 7469 6f6e 732e  ion_annotations.
-00028e00: 7570 6461 7465 280a 2020 2020 2020 2020  update(.        
-00028e10: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00028e20: 2020 2020 2020 2020 2020 2020 2020 226e                "n
-00028e30: 7061 7274 6974 696f 6e73 223a 2073 656c  partitions": sel
-00028e40: 662e 6e70 6172 7469 7469 6f6e 732c 0a20  f.npartitions,. 
-00028e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028e60: 2020 2022 636f 6c75 6d6e 7322 3a20 5b63     "columns": [c
-00028e70: 6f6c 2066 6f72 2063 6f6c 2069 6e20 7365  ol for col in se
-00028e80: 6c66 2e63 6f6c 756d 6e73 5d2c 0a20 2020  lf.columns],.   
-00028e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ea0: 2022 7479 7065 223a 2074 7970 656e 616d   "type": typenam
-00028eb0: 6528 7479 7065 2873 656c 6629 292c 0a20  e(type(self)),. 
-00028ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ed0: 2020 2022 6461 7461 6672 616d 655f 7479     "dataframe_ty
-00028ee0: 7065 223a 2074 7970 656e 616d 6528 7479  pe": typename(ty
-00028ef0: 7065 2873 656c 662e 5f6d 6574 6129 292c  pe(self._meta)),
-00028f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028f10: 2020 2020 2022 7365 7269 6573 5f64 7479       "series_dty
-00028f20: 7065 7322 3a20 7b0a 2020 2020 2020 2020  pes": {.        
-00028f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f40: 636f 6c3a 2073 656c 662e 5f6d 6574 615b  col: self._meta[
-00028f50: 636f 6c5d 2e64 7479 7065 0a20 2020 2020  col].dtype.     
-00028f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f70: 2020 2069 6620 6861 7361 7474 7228 7365     if hasattr(se
-00028f80: 6c66 2e5f 6d65 7461 5b63 6f6c 5d2c 2022  lf._meta[col], "
-00028f90: 6474 7970 6522 290a 2020 2020 2020 2020  dtype").        
-00028fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028fb0: 656c 7365 204e 6f6e 650a 2020 2020 2020  else None.      
-00028fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028fd0: 2020 666f 7220 636f 6c20 696e 2073 656c    for col in sel
-00028fe0: 662e 5f6d 6574 612e 636f 6c75 6d6e 730a  f._meta.columns.
-00028ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029000: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-00029010: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00029020: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00029030: 5f5f 6172 7261 795f 7772 6170 5f5f 2873  __array_wrap__(s
-00029040: 656c 662c 2061 7272 6179 2c20 636f 6e74  elf, array, cont
-00029050: 6578 743d 4e6f 6e65 293a 0a20 2020 2020  ext=None):.     
-00029060: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00029070: 2863 6f6e 7465 7874 2c20 7475 706c 6529  (context, tuple)
-00029080: 2061 6e64 206c 656e 2863 6f6e 7465 7874   and len(context
-00029090: 2920 3e20 303a 0a20 2020 2020 2020 2020  ) > 0:.         
-000290a0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-000290b0: 2863 6f6e 7465 7874 5b31 5d5b 305d 2c20  (context[1][0], 
-000290c0: 6e70 2e6e 6461 7272 6179 2920 616e 6420  np.ndarray) and 
-000290d0: 636f 6e74 6578 745b 315d 5b30 5d2e 7368  context[1][0].sh
-000290e0: 6170 6520 3d3d 2028 293a 0a20 2020 2020  ape == ():.     
-000290f0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-00029100: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00029110: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00029120: 2020 2020 2020 2020 2020 696e 6465 7820            index 
-00029130: 3d20 636f 6e74 6578 745b 315d 5b30 5d2e  = context[1][0].
-00029140: 696e 6465 780a 2020 2020 2020 2020 656c  index.        el
-00029150: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00029160: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00029170: 2020 2020 2069 6d70 6f72 7420 696e 7370       import insp
-00029180: 6563 740a 0a20 2020 2020 2020 2020 2020  ect..           
-00029190: 2020 2020 206d 6574 686f 645f 6e61 6d65       method_name
-000291a0: 203d 2066 2260 7b69 6e73 7065 6374 2e73   = f"`{inspect.s
-000291b0: 7461 636b 2829 5b33 5d5b 335d 7d60 220a  tack()[3][3]}`".
-000291c0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-000291d0: 7074 2049 6e64 6578 4572 726f 723a 0a20  pt IndexError:. 
-000291e0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000291f0: 6574 686f 645f 6e61 6d65 203d 2022 5468  ethod_name = "Th
-00029200: 6973 206d 6574 686f 6422 0a0a 2020 2020  is method"..    
-00029210: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-00029220: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-00029230: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00029240: 2020 2066 227b 6d65 7468 6f64 5f6e 616d     f"{method_nam
-00029250: 657d 2069 7320 6e6f 7420 696d 706c 656d  e} is not implem
-00029260: 656e 7465 6420 666f 7220 6064 6173 6b2e  ented for `dask.
-00029270: 6461 7461 6672 616d 652e 4461 7461 4672  dataframe.DataFr
-00029280: 616d 6560 2e22 0a20 2020 2020 2020 2020  ame`.".         
-00029290: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-000292a0: 7475 726e 206d 6574 615f 6672 616d 655f  turn meta_frame_
-000292b0: 636f 6e73 7472 7563 746f 7228 7365 6c66  constructor(self
-000292c0: 2928 6172 7261 792c 2069 6e64 6578 3d69  )(array, index=i
-000292d0: 6e64 6578 2c20 636f 6c75 6d6e 733d 7365  ndex, columns=se
-000292e0: 6c66 2e63 6f6c 756d 6e73 290a 0a20 2020  lf.columns)..   
-000292f0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00029300: 6566 2061 7865 7328 7365 6c66 293a 0a20  ef axes(self):. 
-00029310: 2020 2020 2020 2072 6574 7572 6e20 5b73         return [s
-00029320: 656c 662e 696e 6465 782c 2073 656c 662e  elf.index, self.
-00029330: 636f 6c75 6d6e 735d 0a0a 2020 2020 4070  columns]..    @p
-00029340: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00029350: 636f 6c75 6d6e 7328 7365 6c66 293a 0a20  columns(self):. 
-00029360: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00029370: 6c66 2e5f 6d65 7461 2e63 6f6c 756d 6e73  lf._meta.columns
-00029380: 0a0a 2020 2020 4063 6f6c 756d 6e73 2e73  ..    @columns.s
-00029390: 6574 7465 720a 2020 2020 6465 6620 636f  etter.    def co
-000293a0: 6c75 6d6e 7328 7365 6c66 2c20 636f 6c75  lumns(self, colu
-000293b0: 6d6e 7329 3a0a 2020 2020 2020 2020 7265  mns):.        re
-000293c0: 6e61 6d65 6420 3d20 5f72 656e 616d 655f  named = _rename_
-000293d0: 6461 736b 2873 656c 662c 2063 6f6c 756d  dask(self, colum
-000293e0: 6e73 290a 2020 2020 2020 2020 7365 6c66  ns).        self
-000293f0: 2e5f 6d65 7461 203d 2072 656e 616d 6564  ._meta = renamed
-00029400: 2e5f 6d65 7461 0a20 2020 2020 2020 2073  ._meta.        s
-00029410: 656c 662e 5f6e 616d 6520 3d20 7265 6e61  elf._name = rena
-00029420: 6d65 642e 5f6e 616d 650a 2020 2020 2020  med._name.      
-00029430: 2020 7365 6c66 2e64 6173 6b20 3d20 7265    self.dask = re
-00029440: 6e61 6d65 642e 6461 736b 0a0a 2020 2020  named.dask..    
-00029450: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00029460: 6620 696c 6f63 2873 656c 6629 3a0a 2020  f iloc(self):.  
-00029470: 2020 2020 2020 2222 2250 7572 656c 7920        """Purely 
-00029480: 696e 7465 6765 722d 6c6f 6361 7469 6f6e  integer-location
-00029490: 2062 6173 6564 2069 6e64 6578 696e 6720   based indexing 
-000294a0: 666f 7220 7365 6c65 6374 696f 6e20 6279  for selection by
-000294b0: 2070 6f73 6974 696f 6e2e 0a0a 2020 2020   position...    
-000294c0: 2020 2020 4f6e 6c79 2069 6e64 6578 696e      Only indexin
-000294d0: 6720 7468 6520 636f 6c75 6d6e 2070 6f73  g the column pos
-000294e0: 6974 696f 6e73 2069 7320 7375 7070 6f72  itions is suppor
-000294f0: 7465 642e 2054 7279 696e 6720 746f 2073  ted. Trying to s
-00029500: 656c 6563 740a 2020 2020 2020 2020 726f  elect.        ro
-00029510: 7720 706f 7369 7469 6f6e 7320 7769 6c6c  w positions will
-00029520: 2072 6169 7365 2061 2056 616c 7565 4572   raise a ValueEr
-00029530: 726f 722e 0a0a 2020 2020 2020 2020 5365  ror...        Se
-00029540: 6520 3a72 6566 3a60 6461 7461 6672 616d  e :ref:`datafram
-00029550: 652e 696e 6465 7869 6e67 6020 666f 7220  e.indexing` for 
-00029560: 6d6f 7265 2e0a 0a20 2020 2020 2020 2045  more...        E
-00029570: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-00029580: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00029590: 203e 3e3e 2064 662e 696c 6f63 5b3a 2c20   >>> df.iloc[:, 
-000295a0: 5b32 2c20 302c 2031 5d5d 2020 2320 646f  [2, 0, 1]]  # do
-000295b0: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
-000295c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000295d0: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
-000295e0: 7261 6d65 2e69 6e64 6578 696e 6720 696d  rame.indexing im
-000295f0: 706f 7274 205f 694c 6f63 496e 6465 7865  port _iLocIndexe
-00029600: 720a 0a20 2020 2020 2020 2023 2046 6f72  r..        # For
-00029610: 2064 6174 6166 7261 6d65 7320 7769 7468   dataframes with
-00029620: 2075 6e69 7175 6520 636f 6c75 6d6e 206e   unique column n
-00029630: 616d 6573 2c20 7468 6973 2077 696c 6c20  ames, this will 
-00029640: 6265 2074 7261 6e73 666f 726d 6564 2069  be transformed i
-00029650: 6e74 6f20 6120 5f5f 6765 7469 7465 6d5f  nto a __getitem_
-00029660: 5f20 6361 6c6c 0a20 2020 2020 2020 2072  _ call.        r
-00029670: 6574 7572 6e20 5f69 4c6f 6349 6e64 6578  eturn _iLocIndex
-00029680: 6572 2873 656c 6629 0a0a 2020 2020 6465  er(self)..    de
-00029690: 6620 5f5f 6c65 6e5f 5f28 7365 6c66 293a  f __len__(self):
-000296a0: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
-000296b0: 2020 2020 2020 2020 2020 7320 3d20 7365            s = se
-000296c0: 6c66 2e69 6c6f 635b 3a2c 2030 5d0a 2020  lf.iloc[:, 0].  
-000296d0: 2020 2020 2020 6578 6365 7074 2049 6e64        except Ind
-000296e0: 6578 4572 726f 723a 0a20 2020 2020 2020  exError:.       
-000296f0: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-00029700: 7228 292e 5f5f 6c65 6e5f 5f28 290a 2020  r().__len__().  
-00029710: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00029720: 2020 2020 2020 2020 7265 7475 726e 206c          return l
-00029730: 656e 2873 290a 0a20 2020 2064 6566 205f  en(s)..    def _
-00029740: 5f63 6f6e 7461 696e 735f 5f28 7365 6c66  _contains__(self
-00029750: 2c20 6b65 7929 3a0a 2020 2020 2020 2020  , key):.        
-00029760: 7265 7475 726e 206b 6579 2069 6e20 7365  return key in se
-00029770: 6c66 2e5f 6d65 7461 0a0a 2020 2020 4070  lf._meta..    @p
-00029780: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00029790: 656d 7074 7928 7365 6c66 293a 0a20 2020  empty(self):.   
-000297a0: 2020 2020 2023 205f 5f67 6574 6174 7472       # __getattr
-000297b0: 5f5f 2077 696c 6c20 6265 2063 616c 6c65  __ will be calle
-000297c0: 6420 6166 7465 7220 7765 2072 6169 7365  d after we raise
-000297d0: 2074 6869 732c 2073 6f20 7765 276c 6c20   this, so we'll 
-000297e0: 7261 6973 6520 6974 2061 6761 696e 2066  raise it again f
-000297f0: 726f 6d20 7468 6572 650a 2020 2020 2020  rom there.      
-00029800: 2020 7261 6973 6520 4174 7472 6962 7574    raise Attribut
-00029810: 654e 6f74 496d 706c 656d 656e 7465 6445  eNotImplementedE
-00029820: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00029830: 2020 2243 6865 636b 696e 6720 7768 6574    "Checking whet
-00029840: 6865 7220 6120 4461 736b 2044 6174 6146  her a Dask DataF
-00029850: 7261 6d65 2068 6173 2061 6e79 2072 6f77  rame has any row
-00029860: 7320 6d61 7920 6265 2065 7870 656e 7369  s may be expensi
-00029870: 7665 2e20 220a 2020 2020 2020 2020 2020  ve. ".          
-00029880: 2020 2248 6f77 6576 6572 2c20 6368 6563    "However, chec
-00029890: 6b69 6e67 2074 6865 206e 756d 6265 7220  king the number 
-000298a0: 6f66 2063 6f6c 756d 6e73 2069 7320 6661  of columns is fa
-000298b0: 7374 2e20 220a 2020 2020 2020 2020 2020  st. ".          
-000298c0: 2020 2244 6570 656e 6469 6e67 206f 6e20    "Depending on 
-000298d0: 7768 6963 6820 6f66 2074 6865 7365 2072  which of these r
-000298e0: 6573 756c 7473 2079 6f75 206e 6565 642c  esults you need,
-000298f0: 2075 7365 2065 6974 6865 7220 220a 2020   use either ".  
-00029900: 2020 2020 2020 2020 2020 2260 6c65 6e28            "`len(
-00029910: 6466 2e69 6e64 6578 2920 3d3d 2030 6020  df.index) == 0` 
-00029920: 6f72 2060 6c65 6e28 6466 2e63 6f6c 756d  or `len(df.colum
-00029930: 6e73 2920 3d3d 2030 6022 0a20 2020 2020  ns) == 0`".     
-00029940: 2020 2029 0a0a 2020 2020 6465 6620 5f5f     )..    def __
-00029950: 6765 7469 7465 6d5f 5f28 7365 6c66 2c20  getitem__(self, 
-00029960: 6b65 7929 3a0a 2020 2020 2020 2020 6e61  key):.        na
-00029970: 6d65 203d 2022 6765 7469 7465 6d2d 2573  me = "getitem-%s
-00029980: 2220 2520 746f 6b65 6e69 7a65 2873 656c  " % tokenize(sel
-00029990: 662c 206b 6579 290a 2020 2020 2020 2020  f, key).        
-000299a0: 6966 206e 702e 6973 7363 616c 6172 286b  if np.isscalar(k
-000299b0: 6579 2920 6f72 2069 7369 6e73 7461 6e63  ey) or isinstanc
-000299c0: 6528 6b65 792c 2028 7475 706c 652c 2073  e(key, (tuple, s
-000299d0: 7472 2929 3a0a 2020 2020 2020 2020 2020  tr)):.          
-000299e0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000299f0: 7365 6c66 2e5f 6d65 7461 2e69 6e64 6578  self._meta.index
-00029a00: 2c20 2870 642e 4461 7465 7469 6d65 496e  , (pd.DatetimeIn
-00029a10: 6465 782c 2070 642e 5065 7269 6f64 496e  dex, pd.PeriodIn
-00029a20: 6465 7829 293a 0a20 2020 2020 2020 2020  dex)):.         
-00029a30: 2020 2020 2020 2069 6620 6b65 7920 6e6f         if key no
-00029a40: 7420 696e 2073 656c 662e 5f6d 6574 612e  t in self._meta.
-00029a50: 636f 6c75 6d6e 733a 0a20 2020 2020 2020  columns:.       
-00029a60: 2020 2020 2020 2020 2020 2020 2077 6172               war
-00029a70: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-00029a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029a90: 2020 2020 2249 6e64 6578 696e 6720 6120      "Indexing a 
-00029aa0: 4461 7461 4672 616d 6520 7769 7468 2061  DataFrame with a
-00029ab0: 2064 6174 6574 696d 656c 696b 6520 696e   datetimelike in
-00029ac0: 6465 7820 7573 696e 6720 6120 7369 6e67  dex using a sing
-00029ad0: 6c65 2022 0a20 2020 2020 2020 2020 2020  le ".           
-00029ae0: 2020 2020 2020 2020 2020 2020 2022 7374               "st
-00029af0: 7269 6e67 2074 6f20 736c 6963 6520 7468  ring to slice th
-00029b00: 6520 726f 7773 2c20 6c69 6b65 2060 6672  e rows, like `fr
-00029b10: 616d 655b 7374 7269 6e67 5d60 2c20 6973  ame[string]`, is
-00029b20: 2064 6570 7265 6361 7465 6420 220a 2020   deprecated ".  
-00029b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029b40: 2020 2020 2020 2261 6e64 2077 696c 6c20        "and will 
-00029b50: 6265 2072 656d 6f76 6564 2069 6e20 6120  be removed in a 
-00029b60: 6675 7475 7265 2076 6572 7369 6f6e 2e20  future version. 
-00029b70: 5573 6520 6066 7261 6d65 2e6c 6f63 5b73  Use `frame.loc[s
-00029b80: 7472 696e 675d 6020 220a 2020 2020 2020  tring]` ".      
-00029b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ba0: 2020 2269 6e73 7465 6164 2e22 2c0a 2020    "instead.",.  
-00029bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029bc0: 2020 2020 2020 4675 7475 7265 5761 726e        FutureWarn
-00029bd0: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
-00029be0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00029bf0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00029c00: 6574 7572 6e20 7365 6c66 2e6c 6f63 5b6b  eturn self.loc[k
-00029c10: 6579 5d0a 0a20 2020 2020 2020 2020 2020  ey]..           
-00029c20: 2023 2065 7272 6f72 2069 7320 7261 6973   # error is rais
-00029c30: 6564 2066 726f 6d20 7061 6e64 6173 0a20  ed from pandas. 
-00029c40: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
-00029c50: 3d20 7365 6c66 2e5f 6d65 7461 5b5f 6578  = self._meta[_ex
-00029c60: 7472 6163 745f 6d65 7461 286b 6579 295d  tract_meta(key)]
-00029c70: 0a20 2020 2020 2020 2020 2020 2064 736b  .            dsk
-00029c80: 203d 2070 6172 7469 7469 6f6e 7769 7365   = partitionwise
-00029c90: 5f67 7261 7068 286f 7065 7261 746f 722e  _graph(operator.
-00029ca0: 6765 7469 7465 6d2c 206e 616d 652c 2073  getitem, name, s
-00029cb0: 656c 662c 206b 6579 290a 2020 2020 2020  elf, key).      
-00029cc0: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
-00029cd0: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-00029ce0: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
-00029cf0: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
-00029d00: 6e63 6965 733d 5b73 656c 665d 290a 2020  ncies=[self]).  
-00029d10: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00029d20: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
-00029d30: 7261 7068 2c20 6e61 6d65 2c20 6d65 7461  raph, name, meta
-00029d40: 2c20 7365 6c66 2e64 6976 6973 696f 6e73  , self.divisions
-00029d50: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-00029d60: 7369 6e73 7461 6e63 6528 6b65 792c 2073  sinstance(key, s
-00029d70: 6c69 6365 293a 0a20 2020 2020 2020 2020  lice):.         
-00029d80: 2020 2066 726f 6d20 7061 6e64 6173 2e61     from pandas.a
-00029d90: 7069 2e74 7970 6573 2069 6d70 6f72 7420  pi.types import 
-00029da0: 6973 5f66 6c6f 6174 5f64 7479 7065 0a0a  is_float_dtype..
-00029db0: 2020 2020 2020 2020 2020 2020 6973 5f69              is_i
-00029dc0: 6e74 6567 6572 5f73 6c69 6365 203d 2061  nteger_slice = a
-00029dd0: 6e79 280a 2020 2020 2020 2020 2020 2020  ny(.            
-00029de0: 2020 2020 6973 696e 7374 616e 6365 2869      isinstance(i
-00029df0: 2c20 496e 7465 6772 616c 2920 666f 7220  , Integral) for 
-00029e00: 6920 696e 2028 6b65 792e 7374 6172 742c  i in (key.start,
-00029e10: 206b 6579 2e73 7465 702c 206b 6579 2e73   key.step, key.s
-00029e20: 746f 7029 0a20 2020 2020 2020 2020 2020  top).           
-00029e30: 2029 0a20 2020 2020 2020 2020 2020 2023   ).            #
-00029e40: 2053 6c69 6369 6e67 2077 6974 6820 696e   Slicing with in
-00029e50: 7465 6765 7220 6c61 6265 6c73 2069 7320  teger labels is 
-00029e60: 616c 7761 7973 2069 6c6f 6320 6261 7365  always iloc base
-00029e70: 6420 6578 6365 7074 2066 6f72 2061 0a20  d except for a. 
-00029e80: 2020 2020 2020 2020 2020 2023 2066 6c6f             # flo
-00029e90: 6174 2069 6e64 6578 6572 2066 6f72 2073  at indexer for s
-00029ea0: 6f6d 6520 7265 6173 6f6e 0a20 2020 2020  ome reason.     
-00029eb0: 2020 2020 2020 2069 6620 6973 5f69 6e74         if is_int
-00029ec0: 6567 6572 5f73 6c69 6365 2061 6e64 206e  eger_slice and n
-00029ed0: 6f74 2069 735f 666c 6f61 745f 6474 7970  ot is_float_dtyp
-00029ee0: 6528 7365 6c66 2e69 6e64 6578 2e64 7479  e(self.index.dty
-00029ef0: 7065 293a 0a20 2020 2020 2020 2020 2020  pe):.           
-00029f00: 2020 2020 2023 204e 4f54 453a 2074 6869       # NOTE: thi
-00029f10: 7320 616c 7761 7973 2066 6169 6c73 2063  s always fails c
-00029f20: 7572 7265 6e74 6c79 2c20 6173 2069 6c6f  urrently, as ilo
-00029f30: 6320 6973 206d 6f73 746c 790a 2020 2020  c is mostly.    
-00029f40: 2020 2020 2020 2020 2020 2020 2320 756e              # un
-00029f50: 7375 7070 6f72 7465 642c 2062 7574 2077  supported, but w
-00029f60: 6520 6361 6c6c 2069 7420 616e 7977 6179  e call it anyway
-00029f70: 2068 6572 6520 666f 7220 6675 7475 7265   here for future
-00029f80: 2d70 726f 6f66 696e 670a 2020 2020 2020  -proofing.      
-00029f90: 2020 2020 2020 2020 2020 2320 616e 6420            # and 
-00029fa0: 6572 726f 722d 6174 7472 6962 7574 696f  error-attributio
-00029fb0: 6e20 7075 7270 6f73 6573 0a20 2020 2020  n purposes.     
-00029fc0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00029fd0: 6e20 7365 6c66 2e69 6c6f 635b 6b65 795d  n self.iloc[key]
-00029fe0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00029ff0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0002a000: 2020 2072 6574 7572 6e20 7365 6c66 2e6c     return self.l
-0002a010: 6f63 5b6b 6579 5d0a 0a20 2020 2020 2020  oc[key]..       
-0002a020: 2069 6620 6973 696e 7374 616e 6365 286b   if isinstance(k
-0002a030: 6579 2c20 286e 702e 6e64 6172 7261 792c  ey, (np.ndarray,
-0002a040: 206c 6973 7429 2920 6f72 2028 0a20 2020   list)) or (.   
-0002a050: 2020 2020 2020 2020 206e 6f74 2069 735f           not is_
-0002a060: 6461 736b 5f63 6f6c 6c65 6374 696f 6e28  dask_collection(
-0002a070: 6b65 7929 2061 6e64 2028 6973 5f73 6572  key) and (is_ser
-0002a080: 6965 735f 6c69 6b65 286b 6579 2920 6f72  ies_like(key) or
-0002a090: 2069 735f 696e 6465 785f 6c69 6b65 286b   is_index_like(k
-0002a0a0: 6579 2929 0a20 2020 2020 2020 2029 3a0a  ey)).        ):.
-0002a0b0: 2020 2020 2020 2020 2020 2020 2320 6572              # er
-0002a0c0: 726f 7220 6973 2072 6169 7365 6420 6672  ror is raised fr
-0002a0d0: 6f6d 2070 616e 6461 730a 2020 2020 2020  om pandas.      
-0002a0e0: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
-0002a0f0: 662e 5f6d 6574 615b 5f65 7874 7261 6374  f._meta[_extract
-0002a100: 5f6d 6574 6128 6b65 7929 5d0a 0a20 2020  _meta(key)]..   
-0002a110: 2020 2020 2020 2020 2064 736b 203d 2070           dsk = p
-0002a120: 6172 7469 7469 6f6e 7769 7365 5f67 7261  artitionwise_gra
-0002a130: 7068 286f 7065 7261 746f 722e 6765 7469  ph(operator.geti
-0002a140: 7465 6d2c 206e 616d 652c 2073 656c 662c  tem, name, self,
-0002a150: 206b 6579 290a 2020 2020 2020 2020 2020   key).          
-0002a160: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-0002a170: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-0002a180: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
-0002a190: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
-0002a1a0: 733d 5b73 656c 665d 290a 2020 2020 2020  s=[self]).      
-0002a1b0: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0002a1c0: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
-0002a1d0: 2c20 6e61 6d65 2c20 6d65 7461 2c20 7365  , name, meta, se
-0002a1e0: 6c66 2e64 6976 6973 696f 6e73 290a 2020  lf.divisions).  
-0002a1f0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0002a200: 6e63 6528 6b65 792c 2053 6572 6965 7329  nce(key, Series)
-0002a210: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0002a220: 646f 206e 6f74 2070 6572 666f 726d 2064  do not perform d
-0002a230: 756d 6d79 2063 616c 6375 6c61 7469 6f6e  ummy calculation
-0002a240: 2c20 6173 2063 6f6c 756d 6e73 2077 696c  , as columns wil
-0002a250: 6c20 6e6f 7420 6265 2063 6861 6e67 6564  l not be changed
-0002a260: 2e0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0002a270: 2073 656c 662e 6469 7669 7369 6f6e 7320   self.divisions 
-0002a280: 213d 206b 6579 2e64 6976 6973 696f 6e73  != key.divisions
-0002a290: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002a2a0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
-0002a2b0: 6672 616d 652e 6d75 6c74 6920 696d 706f  frame.multi impo
-0002a2c0: 7274 205f 6d61 7962 655f 616c 6967 6e5f  rt _maybe_align_
-0002a2d0: 7061 7274 6974 696f 6e73 0a0a 2020 2020  partitions..    
-0002a2e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002a2f0: 2c20 6b65 7920 3d20 5f6d 6179 6265 5f61  , key = _maybe_a
-0002a300: 6c69 676e 5f70 6172 7469 7469 6f6e 7328  lign_partitions(
-0002a310: 5b73 656c 662c 206b 6579 5d29 0a20 2020  [self, key]).   
-0002a320: 2020 2020 2020 2020 2064 736b 203d 2070           dsk = p
-0002a330: 6172 7469 7469 6f6e 7769 7365 5f67 7261  artitionwise_gra
-0002a340: 7068 286f 7065 7261 746f 722e 6765 7469  ph(operator.geti
-0002a350: 7465 6d2c 206e 616d 652c 2073 656c 662c  tem, name, self,
-0002a360: 206b 6579 290a 2020 2020 2020 2020 2020   key).          
-0002a370: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-0002a380: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-0002a390: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
-0002a3a0: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
-0002a3b0: 733d 5b73 656c 662c 206b 6579 5d29 0a20  s=[self, key]). 
-0002a3c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002a3d0: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
-0002a3e0: 6772 6170 682c 206e 616d 652c 2073 656c  graph, name, sel
-0002a3f0: 662c 2073 656c 662e 6469 7669 7369 6f6e  f, self.division
-0002a400: 7329 0a20 2020 2020 2020 2069 6620 6973  s).        if is
-0002a410: 696e 7374 616e 6365 286b 6579 2c20 4461  instance(key, Da
-0002a420: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
-0002a430: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0002a440: 662e 7768 6572 6528 6b65 792c 206e 702e  f.where(key, np.
-0002a450: 6e61 6e29 0a0a 2020 2020 2020 2020 7261  nan)..        ra
-0002a460: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-0002a470: 6564 4572 726f 7228 6b65 7929 0a0a 2020  edError(key)..  
-0002a480: 2020 6465 6620 5f5f 7365 7469 7465 6d5f    def __setitem_
-0002a490: 5f28 7365 6c66 2c20 6b65 792c 2076 616c  _(self, key, val
-0002a4a0: 7565 293a 0a20 2020 2020 2020 2069 6620  ue):.        if 
-0002a4b0: 6973 696e 7374 616e 6365 286b 6579 2c20  isinstance(key, 
-0002a4c0: 2874 7570 6c65 2c20 6c69 7374 2929 2061  (tuple, list)) a
-0002a4d0: 6e64 2069 7369 6e73 7461 6e63 6528 7661  nd isinstance(va
-0002a4e0: 6c75 652c 2044 6174 6146 7261 6d65 293a  lue, DataFrame):
-0002a4f0: 0a20 2020 2020 2020 2020 2020 2064 6620  .            df 
-0002a500: 3d20 7365 6c66 2e61 7373 6967 6e28 2a2a  = self.assign(**
-0002a510: 7b6b 3a20 7661 6c75 655b 635d 2066 6f72  {k: value[c] for
-0002a520: 206b 2c20 6320 696e 207a 6970 286b 6579   k, c in zip(key
-0002a530: 2c20 7661 6c75 652e 636f 6c75 6d6e 7329  , value.columns)
-0002a540: 7d29 0a0a 2020 2020 2020 2020 656c 6966  })..        elif
-0002a550: 2069 7369 6e73 7461 6e63 6528 6b65 792c   isinstance(key,
-0002a560: 2070 642e 496e 6465 7829 2061 6e64 206e   pd.Index) and n
-0002a570: 6f74 2069 7369 6e73 7461 6e63 6528 7661  ot isinstance(va
-0002a580: 6c75 652c 2044 6174 6146 7261 6d65 293a  lue, DataFrame):
-0002a590: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
-0002a5a0: 203d 206c 6973 7428 6b65 7929 0a20 2020   = list(key).   
-0002a5b0: 2020 2020 2020 2020 2064 6620 3d20 7365           df = se
-0002a5c0: 6c66 2e61 7373 6967 6e28 2a2a 7b6b 3a20  lf.assign(**{k: 
-0002a5d0: 7661 6c75 6520 666f 7220 6b20 696e 206b  value for k in k
-0002a5e0: 6579 7d29 0a20 2020 2020 2020 2065 6c69  ey}).        eli
-0002a5f0: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-0002a600: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-0002a610: 6528 6b65 7929 0a20 2020 2020 2020 2020  e(key).         
-0002a620: 2020 206f 7220 6973 5f73 6572 6965 735f     or is_series_
-0002a630: 6c69 6b65 286b 6579 290a 2020 2020 2020  like(key).      
-0002a640: 2020 2020 2020 6f72 2069 7369 6e73 7461        or isinsta
-0002a650: 6e63 6528 6b65 792c 2028 4461 7461 4672  nce(key, (DataFr
-0002a660: 616d 652c 2053 6572 6965 7329 290a 2020  ame, Series)).  
-0002a670: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-0002a680: 2020 2020 2064 6620 3d20 7365 6c66 2e77       df = self.w
-0002a690: 6865 7265 287e 6b65 792c 2076 616c 7565  here(~key, value
-0002a6a0: 290a 2020 2020 2020 2020 656c 6966 206e  ).        elif n
-0002a6b0: 6f74 2069 7369 6e73 7461 6e63 6528 6b65  ot isinstance(ke
-0002a6c0: 792c 2073 7472 293a 0a20 2020 2020 2020  y, str):.       
-0002a6d0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-0002a6e0: 706c 656d 656e 7465 6445 7272 6f72 2866  plementedError(f
-0002a6f0: 2249 7465 6d20 6173 7369 676e 6d65 6e74  "Item assignment
-0002a700: 2077 6974 6820 7b74 7970 6528 6b65 7929   with {type(key)
-0002a710: 7d20 6e6f 7420 7375 7070 6f72 7465 6422  } not supported"
-0002a720: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0002a730: 2020 2020 2020 2020 2020 2020 6466 203d              df =
-0002a740: 2073 656c 662e 6173 7369 676e 282a 2a7b   self.assign(**{
-0002a750: 6b65 793a 2076 616c 7565 7d29 0a0a 2020  key: value})..  
-0002a760: 2020 2020 2020 7365 6c66 2e64 6173 6b20        self.dask 
-0002a770: 3d20 6466 2e64 6173 6b0a 2020 2020 2020  = df.dask.      
-0002a780: 2020 7365 6c66 2e5f 6e61 6d65 203d 2064    self._name = d
-0002a790: 662e 5f6e 616d 650a 2020 2020 2020 2020  f._name.        
-0002a7a0: 7365 6c66 2e5f 6d65 7461 203d 2064 662e  self._meta = df.
-0002a7b0: 5f6d 6574 610a 2020 2020 2020 2020 7365  _meta.        se
-0002a7c0: 6c66 2e5f 6469 7669 7369 6f6e 7320 3d20  lf._divisions = 
-0002a7d0: 6466 2e64 6976 6973 696f 6e73 0a0a 2020  df.divisions..  
-0002a7e0: 2020 6465 6620 5f5f 6465 6c69 7465 6d5f    def __delitem_
-0002a7f0: 5f28 7365 6c66 2c20 6b65 7929 3a0a 2020  _(self, key):.  
-0002a800: 2020 2020 2020 7265 7375 6c74 203d 2073        result = s
-0002a810: 656c 662e 6472 6f70 285b 6b65 795d 2c20  elf.drop([key], 
-0002a820: 6178 6973 3d31 290a 2020 2020 2020 2020  axis=1).        
-0002a830: 7365 6c66 2e64 6173 6b20 3d20 7265 7375  self.dask = resu
-0002a840: 6c74 2e64 6173 6b0a 2020 2020 2020 2020  lt.dask.        
-0002a850: 7365 6c66 2e5f 6e61 6d65 203d 2072 6573  self._name = res
-0002a860: 756c 742e 5f6e 616d 650a 2020 2020 2020  ult._name.      
-0002a870: 2020 7365 6c66 2e5f 6d65 7461 203d 2072    self._meta = r
-0002a880: 6573 756c 742e 5f6d 6574 610a 0a20 2020  esult._meta..   
-0002a890: 2064 6566 205f 5f73 6574 6174 7472 5f5f   def __setattr__
-0002a8a0: 2873 656c 662c 206b 6579 2c20 7661 6c75  (self, key, valu
-0002a8b0: 6529 3a0a 2020 2020 2020 2020 7472 793a  e):.        try:
-0002a8c0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-0002a8d0: 756d 6e73 203d 206f 626a 6563 742e 5f5f  umns = object.__
-0002a8e0: 6765 7461 7474 7269 6275 7465 5f5f 2873  getattribute__(s
-0002a8f0: 656c 662c 2022 5f6d 6574 6122 292e 636f  elf, "_meta").co
-0002a900: 6c75 6d6e 730a 2020 2020 2020 2020 6578  lumns.        ex
-0002a910: 6365 7074 2041 7474 7269 6275 7465 4572  cept AttributeEr
-0002a920: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-0002a930: 2063 6f6c 756d 6e73 203d 2028 290a 0a20   columns = ().. 
-0002a940: 2020 2020 2020 2023 2065 7863 6c75 6465         # exclude
-0002a950: 2070 726f 7465 6374 6564 2061 7474 7269   protected attri
-0002a960: 6275 7465 7320 6672 6f6d 2073 6574 6974  butes from setit
-0002a970: 656d 0a20 2020 2020 2020 2069 6620 6b65  em.        if ke
-0002a980: 7920 696e 2063 6f6c 756d 6e73 2061 6e64  y in columns and
-0002a990: 206b 6579 206e 6f74 2069 6e20 5b22 6469   key not in ["di
-0002a9a0: 7669 7369 6f6e 7322 2c20 2264 6173 6b22  visions", "dask"
-0002a9b0: 2c20 225f 6e61 6d65 222c 2022 5f6d 6574  , "_name", "_met
-0002a9c0: 6122 5d3a 0a20 2020 2020 2020 2020 2020  a"]:.           
-0002a9d0: 2073 656c 665b 6b65 795d 203d 2076 616c   self[key] = val
-0002a9e0: 7565 0a20 2020 2020 2020 2065 6c73 653a  ue.        else:
-0002a9f0: 0a20 2020 2020 2020 2020 2020 206f 626a  .            obj
-0002aa00: 6563 742e 5f5f 7365 7461 7474 725f 5f28  ect.__setattr__(
-0002aa10: 7365 6c66 2c20 6b65 792c 2076 616c 7565  self, key, value
-0002aa20: 290a 0a20 2020 2064 6566 205f 5f67 6574  )..    def __get
-0002aa30: 6174 7472 5f5f 2873 656c 662c 206b 6579  attr__(self, key
-0002aa40: 293a 0a20 2020 2020 2020 2069 6620 6b65  ):.        if ke
-0002aa50: 7920 696e 2073 656c 662e 636f 6c75 6d6e  y in self.column
-0002aa60: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-0002aa70: 6574 7572 6e20 7365 6c66 5b6b 6579 5d0a  eturn self[key].
-0002aa80: 2020 2020 2020 2020 656c 6966 206b 6579          elif key
-0002aa90: 203d 3d20 2265 6d70 7479 223a 0a20 2020   == "empty":.   
-0002aaa0: 2020 2020 2020 2020 2023 2073 656c 662e           # self.
-0002aab0: 656d 7074 7920 7261 6973 6573 2041 7474  empty raises Att
-0002aac0: 7269 6275 7465 4e6f 7449 6d70 6c65 6d65  ributeNotImpleme
-0002aad0: 6e74 6564 4572 726f 722c 2077 6869 6368  ntedError, which
-0002aae0: 2069 6e63 6c75 6465 730a 2020 2020 2020   includes.      
-0002aaf0: 2020 2020 2020 2320 4174 7472 6962 7574        # Attribut
-0002ab00: 6545 7272 6f72 2c20 7768 6963 6820 6d65  eError, which me
-0002ab10: 616e 7320 7765 2065 6e64 2075 7020 6865  ans we end up he
-0002ab20: 7265 2069 6e20 7365 6c66 2e5f 5f67 6574  re in self.__get
-0002ab30: 6174 7472 5f5f 2c0a 2020 2020 2020 2020  attr__,.        
-0002ab40: 2020 2020 2320 6265 6361 7573 6520 4461      # because Da
-0002ab50: 7461 4672 616d 652e 5f5f 6765 7461 7474  taFrame.__getatt
-0002ab60: 7269 6275 7465 5f5f 2064 6f65 736e 2774  ribute__ doesn't
-0002ab70: 2074 6869 6e6b 2074 6865 2061 7474 7269   think the attri
-0002ab80: 6275 7465 2065 7869 7374 730a 2020 2020  bute exists.    
-0002ab90: 2020 2020 2020 2020 2320 616e 6420 7573          # and us
-0002aba0: 6573 205f 5f67 6574 6174 7472 5f5f 2061  es __getattr__ a
-0002abb0: 7320 7468 6520 6661 6c6c 6261 636b 2e20  s the fallback. 
-0002abc0: 536f 2c20 6765 7420 6073 656c 662e 656d  So, get `self.em
-0002abd0: 7074 7960 206d 6f72 650a 2020 2020 2020  pty` more.      
-0002abe0: 2020 2020 2020 2320 666f 7263 6566 756c        # forceful
-0002abf0: 6c79 2076 6961 206f 626a 6563 742e 5f5f  ly via object.__
-0002ac00: 6765 7461 7474 7269 6275 7465 5f5f 2074  getattribute__ t
-0002ac10: 6f20 7261 6973 6520 696e 666f 726d 6174  o raise informat
-0002ac20: 6976 6520 6572 726f 722e 0a20 2020 2020  ive error..     
-0002ac30: 2020 2020 2020 206f 626a 6563 742e 5f5f         object.__
-0002ac40: 6765 7461 7474 7269 6275 7465 5f5f 2873  getattribute__(s
-0002ac50: 656c 662c 206b 6579 290a 2020 2020 2020  elf, key).      
-0002ac60: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0002ac70: 2020 2020 7261 6973 6520 4174 7472 6962      raise Attrib
-0002ac80: 7574 6545 7272 6f72 2822 2744 6174 6146  uteError("'DataF
-0002ac90: 7261 6d65 2720 6f62 6a65 6374 2068 6173  rame' object has
-0002aca0: 206e 6f20 6174 7472 6962 7574 6520 2572   no attribute %r
-0002acb0: 2220 2520 6b65 7929 0a0a 2020 2020 6465  " % key)..    de
-0002acc0: 6620 5f5f 6469 725f 5f28 7365 6c66 293a  f __dir__(self):
-0002acd0: 0a20 2020 2020 2020 206f 203d 2073 6574  .        o = set
-0002ace0: 2864 6972 2874 7970 6528 7365 6c66 2929  (dir(type(self))
-0002acf0: 290a 2020 2020 2020 2020 6f2e 7570 6461  ).        o.upda
-0002ad00: 7465 2873 656c 662e 5f5f 6469 6374 5f5f  te(self.__dict__
-0002ad10: 290a 2020 2020 2020 2020 6f2e 7570 6461  ).        o.upda
-0002ad20: 7465 2863 2066 6f72 2063 2069 6e20 7365  te(c for c in se
-0002ad30: 6c66 2e63 6f6c 756d 6e73 2069 6620 2869  lf.columns if (i
-0002ad40: 7369 6e73 7461 6e63 6528 632c 2073 7472  sinstance(c, str
-0002ad50: 2920 616e 6420 632e 6973 6964 656e 7469  ) and c.isidenti
-0002ad60: 6669 6572 2829 2929 0a20 2020 2020 2020  fier())).       
-0002ad70: 2072 6574 7572 6e20 6c69 7374 286f 290a   return list(o).
-0002ad80: 0a20 2020 2064 6566 205f 5f69 7465 725f  .    def __iter_
-0002ad90: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-0002ada0: 2072 6574 7572 6e20 6974 6572 2873 656c   return iter(sel
-0002adb0: 662e 5f6d 6574 6129 0a0a 2020 2020 6465  f._meta)..    de
-0002adc0: 6620 5f69 7079 7468 6f6e 5f6b 6579 5f63  f _ipython_key_c
-0002add0: 6f6d 706c 6574 696f 6e73 5f28 7365 6c66  ompletions_(self
-0002ade0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0002adf0: 6e20 6d65 7468 6f64 732e 746f 6c69 7374  n methods.tolist
-0002ae00: 2873 656c 662e 636f 6c75 6d6e 7329 0a0a  (self.columns)..
-0002ae10: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0002ae20: 2020 6465 6620 6e64 696d 2873 656c 6629    def ndim(self)
-0002ae30: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-0002ae40: 7572 6e20 6469 6d65 6e73 696f 6e61 6c69  urn dimensionali
-0002ae50: 7479 2222 220a 2020 2020 2020 2020 7265  ty""".        re
-0002ae60: 7475 726e 2032 0a0a 2020 2020 4070 726f  turn 2..    @pro
-0002ae70: 7065 7274 790a 2020 2020 6465 6620 7368  perty.    def sh
-0002ae80: 6170 6528 7365 6c66 293a 0a20 2020 2020  ape(self):.     
-0002ae90: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-0002aea0: 6574 7572 6e20 6120 7475 706c 6520 7265  eturn a tuple re
-0002aeb0: 7072 6573 656e 7469 6e67 2074 6865 2064  presenting the d
-0002aec0: 696d 656e 7369 6f6e 616c 6974 7920 6f66  imensionality of
-0002aed0: 2074 6865 2044 6174 6146 7261 6d65 2e0a   the DataFrame..
-0002aee0: 0a20 2020 2020 2020 2054 6865 206e 756d  .        The num
-0002aef0: 6265 7220 6f66 2072 6f77 7320 6973 2061  ber of rows is a
-0002af00: 2044 656c 6179 6564 2072 6573 756c 742e   Delayed result.
-0002af10: 2054 6865 206e 756d 6265 7220 6f66 2063   The number of c
-0002af20: 6f6c 756d 6e73 0a20 2020 2020 2020 2069  olumns.        i
-0002af30: 7320 6120 636f 6e63 7265 7465 2069 6e74  s a concrete int
-0002af40: 6567 6572 2e0a 0a20 2020 2020 2020 2045  eger...        E
-0002af50: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-0002af60: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0002af70: 203e 3e3e 2064 662e 7369 7a65 2020 2320   >>> df.size  # 
-0002af80: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0002af90: 2020 2020 2020 2028 4465 6c61 7965 6428         (Delayed(
-0002afa0: 2769 6e74 2d30 3766 3036 3037 352d 3565  'int-07f06075-5e
-0002afb0: 6363 2d34 6437 372d 3831 3765 2d36 3363  cc-4d77-817e-63c
-0002afc0: 3639 6139 3138 3861 3827 292c 2032 290a  69a9188a8'), 2).
-0002afd0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002afe0: 2020 2020 636f 6c5f 7369 7a65 203d 206c      col_size = l
-0002aff0: 656e 2873 656c 662e 636f 6c75 6d6e 7329  en(self.columns)
-0002b000: 0a20 2020 2020 2020 2069 6620 636f 6c5f  .        if col_
-0002b010: 7369 7a65 203d 3d20 303a 0a20 2020 2020  size == 0:.     
-0002b020: 2020 2020 2020 2072 6574 7572 6e20 2873         return (s
-0002b030: 656c 662e 696e 6465 782e 7368 6170 655b  elf.index.shape[
-0002b040: 305d 2c20 3029 0a20 2020 2020 2020 2072  0], 0).        r
-0002b050: 6f77 5f73 697a 6520 3d20 6465 6c61 7965  ow_size = delaye
-0002b060: 6428 696e 7429 2873 656c 662e 7369 7a65  d(int)(self.size
-0002b070: 202f 2063 6f6c 5f73 697a 6529 0a20 2020   / col_size).   
-0002b080: 2020 2020 2072 6574 7572 6e20 2872 6f77       return (row
-0002b090: 5f73 697a 652c 2063 6f6c 5f73 697a 6529  _size, col_size)
-0002b0a0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0002b0b0: 2020 2020 6465 6620 6474 7970 6573 2873      def dtypes(s
-0002b0c0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0002b0d0: 2252 6574 7572 6e20 6461 7461 2074 7970  "Return data typ
-0002b0e0: 6573 2222 220a 2020 2020 2020 2020 7265  es""".        re
-0002b0f0: 7475 726e 2073 656c 662e 5f6d 6574 612e  turn self._meta.
-0002b100: 6474 7970 6573 0a0a 2020 2020 4064 6572  dtypes..    @der
-0002b110: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-0002b120: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-0002b130: 6765 745f 6474 7970 655f 636f 756e 7473  get_dtype_counts
-0002b140: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0002b150: 7265 7475 726e 2073 656c 662e 5f6d 6574  return self._met
-0002b160: 612e 6765 745f 6474 7970 655f 636f 756e  a.get_dtype_coun
-0002b170: 7473 2829 0a0a 2020 2020 4064 6572 6976  ts()..    @deriv
-0002b180: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-0002b190: 7261 6d65 290a 2020 2020 6465 6620 6765  rame).    def ge
-0002b1a0: 745f 6674 7970 655f 636f 756e 7473 2873  t_ftype_counts(s
-0002b1b0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-0002b1c0: 7475 726e 2073 656c 662e 5f6d 6574 612e  turn self._meta.
-0002b1d0: 6765 745f 6674 7970 655f 636f 756e 7473  get_ftype_counts
-0002b1e0: 2829 0a0a 2020 2020 4064 6572 6976 6564  ()..    @derived
-0002b1f0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0002b200: 6d65 290a 2020 2020 6465 6620 7365 6c65  me).    def sele
-0002b210: 6374 5f64 7479 7065 7328 7365 6c66 2c20  ct_dtypes(self, 
-0002b220: 696e 636c 7564 653d 4e6f 6e65 2c20 6578  include=None, ex
-0002b230: 636c 7564 653d 4e6f 6e65 293a 0a20 2020  clude=None):.   
-0002b240: 2020 2020 2063 7320 3d20 7365 6c66 2e5f       cs = self._
-0002b250: 6d65 7461 2e73 656c 6563 745f 6474 7970  meta.select_dtyp
-0002b260: 6573 2869 6e63 6c75 6465 3d69 6e63 6c75  es(include=inclu
-0002b270: 6465 2c20 6578 636c 7564 653d 6578 636c  de, exclude=excl
-0002b280: 7564 6529 2e63 6f6c 756d 6e73 0a20 2020  ude).columns.   
-0002b290: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0002b2a0: 5b6c 6973 7428 6373 295d 0a0a 2020 2020  [list(cs)]..    
-0002b2b0: 6465 6620 736f 7274 5f76 616c 7565 7328  def sort_values(
-0002b2c0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0002b2d0: 2020 2020 2020 2062 793a 2073 7472 207c         by: str |
-0002b2e0: 206c 6973 745b 7374 725d 2c0a 2020 2020   list[str],.    
-0002b2f0: 2020 2020 6e70 6172 7469 7469 6f6e 733a      npartitions:
-0002b300: 2069 6e74 207c 204c 6974 6572 616c 5b22   int | Literal["
-0002b310: 6175 746f 225d 207c 204e 6f6e 6520 3d20  auto"] | None = 
-0002b320: 4e6f 6e65 2c0a 2020 2020 2020 2020 6173  None,.        as
-0002b330: 6365 6e64 696e 673a 2062 6f6f 6c20 3d20  cending: bool = 
-0002b340: 5472 7565 2c0a 2020 2020 2020 2020 6e61  True,.        na
-0002b350: 5f70 6f73 6974 696f 6e3a 204c 6974 6572  _position: Liter
-0002b360: 616c 5b22 6669 7273 7422 5d20 7c20 4c69  al["first"] | Li
-0002b370: 7465 7261 6c5b 226c 6173 7422 5d20 3d20  teral["last"] = 
-0002b380: 226c 6173 7422 2c0a 2020 2020 2020 2020  "last",.        
-0002b390: 736f 7274 5f66 756e 6374 696f 6e3a 2043  sort_function: C
-0002b3a0: 616c 6c61 626c 655b 5b70 642e 4461 7461  allable[[pd.Data
-0002b3b0: 4672 616d 655d 2c20 7064 2e44 6174 6146  Frame], pd.DataF
-0002b3c0: 7261 6d65 5d20 7c20 4e6f 6e65 203d 204e  rame] | None = N
-0002b3d0: 6f6e 652c 0a20 2020 2020 2020 2073 6f72  one,.        sor
-0002b3e0: 745f 6675 6e63 7469 6f6e 5f6b 7761 7267  t_function_kwarg
-0002b3f0: 733a 204d 6170 7069 6e67 5b73 7472 2c20  s: Mapping[str, 
-0002b400: 416e 795d 207c 204e 6f6e 6520 3d20 4e6f  Any] | None = No
-0002b410: 6e65 2c0a 2020 2020 2020 2020 2a2a 6b77  ne,.        **kw
-0002b420: 6172 6773 2c0a 2020 2020 2920 2d3e 2044  args,.    ) -> D
-0002b430: 6174 6146 7261 6d65 3a0a 2020 2020 2020  ataFrame:.      
-0002b440: 2020 2222 2253 6f72 7420 7468 6520 6461    """Sort the da
-0002b450: 7461 7365 7420 6279 2061 2073 696e 676c  taset by a singl
-0002b460: 6520 636f 6c75 6d6e 2e0a 0a20 2020 2020  e column...     
-0002b470: 2020 2053 6f72 7469 6e67 2061 2070 6172     Sorting a par
-0002b480: 616c 6c65 6c20 6461 7461 7365 7420 7265  allel dataset re
-0002b490: 7175 6972 6573 2065 7870 656e 7369 7665  quires expensive
-0002b4a0: 2073 6875 6666 6c65 7320 616e 6420 6973   shuffles and is
-0002b4b0: 2067 656e 6572 616c 6c79 0a20 2020 2020   generally.     
-0002b4c0: 2020 206e 6f74 2072 6563 6f6d 6d65 6e64     not recommend
-0002b4d0: 6564 2e20 5365 6520 6060 7365 745f 696e  ed. See ``set_in
-0002b4e0: 6465 7860 6020 666f 7220 696d 706c 656d  dex`` for implem
-0002b4f0: 656e 7461 7469 6f6e 2064 6574 6169 6c73  entation details
-0002b500: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0002b510: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-0002b520: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0002b530: 2062 793a 2073 7472 206f 7220 6c69 7374   by: str or list
-0002b540: 5b73 7472 5d0a 2020 2020 2020 2020 2020  [str].          
-0002b550: 2020 436f 6c75 6d6e 2873 2920 746f 2073    Column(s) to s
-0002b560: 6f72 7420 6279 2e0a 2020 2020 2020 2020  ort by..        
-0002b570: 6e70 6172 7469 7469 6f6e 733a 2069 6e74  npartitions: int
-0002b580: 2c20 4e6f 6e65 2c20 6f72 2027 6175 746f  , None, or 'auto
-0002b590: 270a 2020 2020 2020 2020 2020 2020 5468  '.            Th
-0002b5a0: 6520 6964 6561 6c20 6e75 6d62 6572 206f  e ideal number o
-0002b5b0: 6620 6f75 7470 7574 2070 6172 7469 7469  f output partiti
-0002b5c0: 6f6e 732e 2049 6620 4e6f 6e65 2c20 7573  ons. If None, us
-0002b5d0: 6520 7468 6520 7361 6d65 2061 730a 2020  e the same as.  
-0002b5e0: 2020 2020 2020 2020 2020 7468 6520 696e            the in
-0002b5f0: 7075 742e 2049 6620 2761 7574 6f27 2074  put. If 'auto' t
-0002b600: 6865 6e20 6465 6369 6465 2062 7920 6d65  hen decide by me
-0002b610: 6d6f 7279 2075 7365 2e0a 2020 2020 2020  mory use..      
-0002b620: 2020 6173 6365 6e64 696e 673a 2062 6f6f    ascending: boo
-0002b630: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-0002b640: 2020 2020 2020 2020 536f 7274 2061 7363          Sort asc
-0002b650: 656e 6469 6e67 2076 732e 2064 6573 6365  ending vs. desce
-0002b660: 6e64 696e 672e 0a20 2020 2020 2020 2020  nding..         
-0002b670: 2020 2044 6566 6175 6c74 7320 746f 2054     Defaults to T
-0002b680: 7275 652e 0a20 2020 2020 2020 206e 615f  rue..        na_
-0002b690: 706f 7369 7469 6f6e 3a20 7b27 6c61 7374  position: {'last
-0002b6a0: 272c 2027 6669 7273 7427 7d2c 206f 7074  ', 'first'}, opt
-0002b6b0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0002b6c0: 2020 5075 7473 204e 614e 7320 6174 2074    Puts NaNs at t
-0002b6d0: 6865 2062 6567 696e 6e69 6e67 2069 6620  he beginning if 
-0002b6e0: 2766 6972 7374 272c 2070 7574 7320 4e61  'first', puts Na
-0002b6f0: 4e20 6174 2074 6865 2065 6e64 2069 6620  N at the end if 
-0002b700: 276c 6173 7427 2e0a 2020 2020 2020 2020  'last'..        
-0002b710: 2020 2020 4465 6661 756c 7473 2074 6f20      Defaults to 
-0002b720: 276c 6173 7427 2e0a 2020 2020 2020 2020  'last'..        
-0002b730: 736f 7274 5f66 756e 6374 696f 6e3a 2066  sort_function: f
-0002b740: 756e 6374 696f 6e2c 206f 7074 696f 6e61  unction, optiona
-0002b750: 6c0a 2020 2020 2020 2020 2020 2020 536f  l.            So
-0002b760: 7274 696e 6720 6675 6e63 7469 6f6e 2074  rting function t
-0002b770: 6f20 7573 6520 7768 656e 2073 6f72 7469  o use when sorti
-0002b780: 6e67 2075 6e64 6572 6c79 696e 6720 7061  ng underlying pa
-0002b790: 7274 6974 696f 6e73 2e0a 2020 2020 2020  rtitions..      
-0002b7a0: 2020 2020 2020 4966 204e 6f6e 652c 2064        If None, d
-0002b7b0: 6566 6175 6c74 7320 746f 2060 604d 2e73  efaults to ``M.s
-0002b7c0: 6f72 745f 7661 6c75 6573 6060 2028 7468  ort_values`` (th
-0002b7d0: 6520 7061 7274 6974 696f 6e20 6c69 6272  e partition libr
-0002b7e0: 6172 7927 730a 2020 2020 2020 2020 2020  ary's.          
-0002b7f0: 2020 696d 706c 656d 656e 7461 7469 6f6e    implementation
-0002b800: 206f 6620 6060 736f 7274 5f76 616c 7565   of ``sort_value
-0002b810: 7360 6029 2e0a 2020 2020 2020 2020 736f  s``)..        so
-0002b820: 7274 5f66 756e 6374 696f 6e5f 6b77 6172  rt_function_kwar
-0002b830: 6773 3a20 6469 6374 2c20 6f70 7469 6f6e  gs: dict, option
-0002b840: 616c 0a20 2020 2020 2020 2020 2020 2041  al.            A
-0002b850: 6464 6974 696f 6e61 6c20 6b65 7977 6f72  dditional keywor
-0002b860: 6420 6172 6775 6d65 6e74 7320 746f 2070  d arguments to p
-0002b870: 6173 7320 746f 2074 6865 2070 6172 7469  ass to the parti
-0002b880: 7469 6f6e 2073 6f72 7469 6e67 2066 756e  tion sorting fun
-0002b890: 6374 696f 6e2e 0a20 2020 2020 2020 2020  ction..         
-0002b8a0: 2020 2042 7920 6465 6661 756c 742c 2060     By default, `
-0002b8b0: 6062 7960 602c 2060 6061 7363 656e 6469  `by``, ``ascendi
-0002b8c0: 6e67 6060 2c20 616e 6420 6060 6e61 5f70  ng``, and ``na_p
-0002b8d0: 6f73 6974 696f 6e60 6020 6172 6520 7072  osition`` are pr
-0002b8e0: 6f76 6964 6564 2e0a 0a20 2020 2020 2020  ovided...       
-0002b8f0: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
-0002b900: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-0002b910: 2020 203e 3e3e 2064 6632 203d 2064 662e     >>> df2 = df.
-0002b920: 736f 7274 5f76 616c 7565 7328 2778 2729  sort_values('x')
-0002b930: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0002b940: 4950 0a20 2020 2020 2020 2022 2222 0a20  IP.        """. 
-0002b950: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-0002b960: 2e64 6174 6166 7261 6d65 2e73 6875 6666  .dataframe.shuff
-0002b970: 6c65 2069 6d70 6f72 7420 736f 7274 5f76  le import sort_v
-0002b980: 616c 7565 730a 0a20 2020 2020 2020 2072  alues..        r
-0002b990: 6574 7572 6e20 736f 7274 5f76 616c 7565  eturn sort_value
-0002b9a0: 7328 0a20 2020 2020 2020 2020 2020 2073  s(.            s
-0002b9b0: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-0002b9c0: 2062 792c 0a20 2020 2020 2020 2020 2020   by,.           
-0002b9d0: 2061 7363 656e 6469 6e67 3d61 7363 656e   ascending=ascen
-0002b9e0: 6469 6e67 2c0a 2020 2020 2020 2020 2020  ding,.          
-0002b9f0: 2020 6e70 6172 7469 7469 6f6e 733d 6e70    npartitions=np
-0002ba00: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
-0002ba10: 2020 2020 2020 206e 615f 706f 7369 7469         na_positi
-0002ba20: 6f6e 3d6e 615f 706f 7369 7469 6f6e 2c0a  on=na_position,.
-0002ba30: 2020 2020 2020 2020 2020 2020 736f 7274              sort
-0002ba40: 5f66 756e 6374 696f 6e3d 736f 7274 5f66  _function=sort_f
-0002ba50: 756e 6374 696f 6e2c 0a20 2020 2020 2020  unction,.       
-0002ba60: 2020 2020 2073 6f72 745f 6675 6e63 7469       sort_functi
-0002ba70: 6f6e 5f6b 7761 7267 733d 736f 7274 5f66  on_kwargs=sort_f
-0002ba80: 756e 6374 696f 6e5f 6b77 6172 6773 2c0a  unction_kwargs,.
-0002ba90: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
-0002baa0: 6172 6773 2c0a 2020 2020 2020 2020 290a  args,.        ).
-0002bab0: 0a20 2020 2064 6566 2073 6574 5f69 6e64  .    def set_ind
-0002bac0: 6578 280a 2020 2020 2020 2020 7365 6c66  ex(.        self
-0002bad0: 2c0a 2020 2020 2020 2020 6f74 6865 723a  ,.        other:
-0002bae0: 2073 7472 207c 2053 6572 6965 732c 0a20   str | Series,. 
-0002baf0: 2020 2020 2020 2064 726f 703a 2062 6f6f         drop: boo
-0002bb00: 6c20 3d20 5472 7565 2c0a 2020 2020 2020  l = True,.      
-0002bb10: 2020 736f 7274 6564 3a20 626f 6f6c 203d    sorted: bool =
-0002bb20: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-0002bb30: 6e70 6172 7469 7469 6f6e 733a 2069 6e74  npartitions: int
-0002bb40: 207c 204c 6974 6572 616c 5b22 6175 746f   | Literal["auto
-0002bb50: 225d 207c 204e 6f6e 6520 3d20 4e6f 6e65  "] | None = None
-0002bb60: 2c0a 2020 2020 2020 2020 6469 7669 7369  ,.        divisi
-0002bb70: 6f6e 733a 2053 6571 7565 6e63 6520 7c20  ons: Sequence | 
-0002bb80: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
-0002bb90: 2020 2020 2069 6e70 6c61 6365 3a20 626f       inplace: bo
-0002bba0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-0002bbb0: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
-0002bbc0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-0002bbd0: 5365 7420 7468 6520 4461 7461 4672 616d  Set the DataFram
-0002bbe0: 6520 696e 6465 7820 2872 6f77 206c 6162  e index (row lab
-0002bbf0: 656c 7329 2075 7369 6e67 2061 6e20 6578  els) using an ex
-0002bc00: 6973 7469 6e67 2063 6f6c 756d 6e2e 0a0a  isting column...
-0002bc10: 2020 2020 2020 2020 5468 6973 2072 6561          This rea
-0002bc20: 6c69 676e 7320 7468 6520 6461 7461 7365  ligns the datase
-0002bc30: 7420 746f 2062 6520 736f 7274 6564 2062  t to be sorted b
-0002bc40: 7920 6120 6e65 7720 636f 6c75 6d6e 2e20  y a new column. 
-0002bc50: 5468 6973 2063 616e 2068 6176 6520 610a  This can have a.
-0002bc60: 2020 2020 2020 2020 7369 676e 6966 6963          signific
-0002bc70: 616e 7420 696d 7061 6374 206f 6e20 7065  ant impact on pe
-0002bc80: 7266 6f72 6d61 6e63 652c 2062 6563 6175  rformance, becau
-0002bc90: 7365 206a 6f69 6e73 2c20 6772 6f75 7062  se joins, groupb
-0002bca0: 7973 2c20 6c6f 6f6b 7570 732c 2065 7463  ys, lookups, etc
-0002bcb0: 2e0a 2020 2020 2020 2020 6172 6520 616c  ..        are al
-0002bcc0: 6c20 6d75 6368 2066 6173 7465 7220 6f6e  l much faster on
-0002bcd0: 2074 6861 7420 636f 6c75 6d6e 2e20 486f   that column. Ho
-0002bce0: 7765 7665 722c 2074 6869 7320 7065 7266  wever, this perf
-0002bcf0: 6f72 6d61 6e63 6520 696e 6372 6561 7365  ormance increase
-0002bd00: 0a20 2020 2020 2020 2063 6f6d 6573 2077  .        comes w
-0002bd10: 6974 6820 6120 636f 7374 2c20 736f 7274  ith a cost, sort
-0002bd20: 696e 6720 6120 7061 7261 6c6c 656c 2064  ing a parallel d
-0002bd30: 6174 6173 6574 2072 6571 7569 7265 7320  ataset requires 
-0002bd40: 6578 7065 6e73 6976 6520 7368 7566 666c  expensive shuffl
-0002bd50: 6573 2e0a 2020 2020 2020 2020 4f66 7465  es..        Ofte
-0002bd60: 6e20 7765 2060 6073 6574 5f69 6e64 6578  n we ``set_index
-0002bd70: 6060 206f 6e63 6520 6469 7265 6374 6c79  `` once directly
-0002bd80: 2061 6674 6572 2064 6174 6120 696e 6765   after data inge
-0002bd90: 7374 2061 6e64 2066 696c 7465 7269 6e67  st and filtering
-0002bda0: 2061 6e64 0a20 2020 2020 2020 2074 6865   and.        the
-0002bdb0: 6e20 7065 7266 6f72 6d20 6d61 6e79 2063  n perform many c
-0002bdc0: 6865 6170 2063 6f6d 7075 7461 7469 6f6e  heap computation
-0002bdd0: 7320 6f66 6620 6f66 2074 6865 2073 6f72  s off of the sor
-0002bde0: 7465 6420 6461 7461 7365 742e 0a0a 2020  ted dataset...  
-0002bdf0: 2020 2020 2020 5468 6973 2066 756e 6374        This funct
-0002be00: 696f 6e20 6f70 6572 6174 6573 2065 7861  ion operates exa
-0002be10: 6374 6c79 206c 696b 6520 6060 7061 6e64  ctly like ``pand
-0002be20: 6173 2e73 6574 5f69 6e64 6578 6060 2065  as.set_index`` e
-0002be30: 7863 6570 7420 7769 7468 0a20 2020 2020  xcept with.     
-0002be40: 2020 2064 6966 6665 7265 6e74 2070 6572     different per
-0002be50: 666f 726d 616e 6365 2063 6f73 7473 2028  formance costs (
-0002be60: 6461 736b 2064 6174 6166 7261 6d65 2060  dask dataframe `
-0002be70: 6073 6574 5f69 6e64 6578 6060 2069 7320  `set_index`` is 
-0002be80: 6d75 6368 206d 6f72 6520 6578 7065 6e73  much more expens
-0002be90: 6976 6529 2e0a 2020 2020 2020 2020 556e  ive)..        Un
-0002bea0: 6465 7220 6e6f 726d 616c 206f 7065 7261  der normal opera
-0002beb0: 7469 6f6e 2074 6869 7320 6675 6e63 7469  tion this functi
-0002bec0: 6f6e 2064 6f65 7320 616e 2069 6e69 7469  on does an initi
-0002bed0: 616c 2070 6173 7320 6f76 6572 2074 6865  al pass over the
-0002bee0: 2069 6e64 6578 2063 6f6c 756d 6e0a 2020   index column.  
-0002bef0: 2020 2020 2020 746f 2063 6f6d 7075 7465        to compute
-0002bf00: 2061 7070 726f 7869 6d61 7465 2071 7561   approximate qua
-0002bf10: 6e74 696c 6573 2074 6f20 7365 7276 6520  ntiles to serve 
-0002bf20: 6173 2066 7574 7572 6520 6469 7669 7369  as future divisi
-0002bf30: 6f6e 732e 2049 7420 7468 656e 2070 6173  ons. It then pas
-0002bf40: 7365 730a 2020 2020 2020 2020 6f76 6572  ses.        over
-0002bf50: 2074 6865 2064 6174 6120 6120 7365 636f   the data a seco
-0002bf60: 6e64 2074 696d 652c 2073 706c 6974 7469  nd time, splitti
-0002bf70: 6e67 2075 7020 6561 6368 2069 6e70 7574  ng up each input
-0002bf80: 2070 6172 7469 7469 6f6e 2069 6e74 6f20   partition into 
-0002bf90: 7365 7665 7261 6c0a 2020 2020 2020 2020  several.        
-0002bfa0: 7069 6563 6573 2061 6e64 2073 6861 7269  pieces and shari
-0002bfb0: 6e67 2074 686f 7365 2070 6965 6365 7320  ng those pieces 
-0002bfc0: 746f 2061 6c6c 206f 6620 7468 6520 6f75  to all of the ou
-0002bfd0: 7470 7574 2070 6172 7469 7469 6f6e 7320  tput partitions 
-0002bfe0: 6e6f 7720 696e 0a20 2020 2020 2020 2073  now in.        s
-0002bff0: 6f72 7465 6420 6f72 6465 722e 0a0a 2020  orted order...  
-0002c000: 2020 2020 2020 496e 2073 6f6d 6520 6361        In some ca
-0002c010: 7365 7320 7765 2063 616e 2061 6c6c 6576  ses we can allev
-0002c020: 6961 7465 2074 686f 7365 2063 6f73 7473  iate those costs
-0002c030: 2c20 666f 7220 6578 616d 706c 6520 6966  , for example if
-0002c040: 2079 6f75 7220 6461 7461 7365 7420 6973   your dataset is
-0002c050: 0a20 2020 2020 2020 2073 6f72 7465 6420  .        sorted 
-0002c060: 616c 7265 6164 7920 7468 656e 2077 6520  already then we 
-0002c070: 6361 6e20 6176 6f69 6420 6d61 6b69 6e67  can avoid making
-0002c080: 206d 616e 7920 736d 616c 6c20 7069 6563   many small piec
-0002c090: 6573 206f 7220 6966 2079 6f75 206b 6e6f  es or if you kno
-0002c0a0: 770a 2020 2020 2020 2020 676f 6f64 2076  w.        good v
-0002c0b0: 616c 7565 7320 746f 2073 706c 6974 2074  alues to split t
-0002c0c0: 6865 206e 6577 2069 6e64 6578 2063 6f6c  he new index col
-0002c0d0: 756d 6e20 7468 656e 2077 6520 6361 6e20  umn then we can 
-0002c0e0: 6176 6f69 6420 7468 6520 696e 6974 6961  avoid the initia
-0002c0f0: 6c0a 2020 2020 2020 2020 7061 7373 206f  l.        pass o
-0002c100: 7665 7220 7468 6520 6461 7461 2e20 466f  ver the data. Fo
-0002c110: 7220 6578 616d 706c 6520 6966 2079 6f75  r example if you
-0002c120: 7220 6e65 7720 696e 6465 7820 6973 2061  r new index is a
-0002c130: 2064 6174 6574 696d 6520 696e 6465 7820   datetime index 
-0002c140: 616e 640a 2020 2020 2020 2020 796f 7572  and.        your
-0002c150: 2064 6174 6120 6973 2061 6c72 6561 6479   data is already
-0002c160: 2073 6f72 7465 6420 6279 2064 6179 2074   sorted by day t
-0002c170: 6865 6e20 7468 6973 2065 6e74 6972 6520  hen this entire 
-0002c180: 6f70 6572 6174 696f 6e20 6361 6e20 6265  operation can be
-0002c190: 2064 6f6e 650a 2020 2020 2020 2020 666f   done.        fo
-0002c1a0: 7220 6672 6565 2e20 596f 7520 6361 6e20  r free. You can 
-0002c1b0: 636f 6e74 726f 6c20 7468 6573 6520 6f70  control these op
-0002c1c0: 7469 6f6e 7320 7769 7468 2074 6865 2066  tions with the f
-0002c1d0: 6f6c 6c6f 7769 6e67 2070 6172 616d 6574  ollowing paramet
-0002c1e0: 6572 732e 0a0a 2020 2020 2020 2020 5061  ers...        Pa
-0002c1f0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-0002c200: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0002c210: 2020 2020 6f74 6865 723a 2073 7472 696e      other: strin
-0002c220: 6720 6f72 2044 6173 6b20 5365 7269 6573  g or Dask Series
-0002c230: 0a20 2020 2020 2020 2020 2020 2043 6f6c  .            Col
-0002c240: 756d 6e20 746f 2075 7365 2061 7320 696e  umn to use as in
-0002c250: 6465 782e 0a20 2020 2020 2020 2064 726f  dex..        dro
-0002c260: 703a 2062 6f6f 6c65 616e 2c20 6465 6661  p: boolean, defa
-0002c270: 756c 7420 5472 7565 0a20 2020 2020 2020  ult True.       
-0002c280: 2020 2020 2044 656c 6574 6520 636f 6c75       Delete colu
-0002c290: 6d6e 2074 6f20 6265 2075 7365 6420 6173  mn to be used as
-0002c2a0: 2074 6865 206e 6577 2069 6e64 6578 2e0a   the new index..
-0002c2b0: 2020 2020 2020 2020 736f 7274 6564 3a20          sorted: 
-0002c2c0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
-0002c2d0: 2020 2020 2020 2020 2020 2049 6620 7468             If th
-0002c2e0: 6520 696e 6465 7820 636f 6c75 6d6e 2069  e index column i
-0002c2f0: 7320 616c 7265 6164 7920 736f 7274 6564  s already sorted
-0002c300: 2069 6e20 696e 6372 6561 7369 6e67 206f   in increasing o
-0002c310: 7264 6572 2e0a 2020 2020 2020 2020 2020  rder..          
-0002c320: 2020 4465 6661 756c 7473 2074 6f20 4661    Defaults to Fa
-0002c330: 6c73 650a 2020 2020 2020 2020 6e70 6172  lse.        npar
-0002c340: 7469 7469 6f6e 733a 2069 6e74 2c20 4e6f  titions: int, No
-0002c350: 6e65 2c20 6f72 2027 6175 746f 270a 2020  ne, or 'auto'.  
-0002c360: 2020 2020 2020 2020 2020 5468 6520 6964            The id
-0002c370: 6561 6c20 6e75 6d62 6572 206f 6620 6f75  eal number of ou
-0002c380: 7470 7574 2070 6172 7469 7469 6f6e 732e  tput partitions.
-0002c390: 2049 6620 4e6f 6e65 2c20 7573 6520 7468   If None, use th
-0002c3a0: 6520 7361 6d65 2061 730a 2020 2020 2020  e same as.      
-0002c3b0: 2020 2020 2020 7468 6520 696e 7075 742e        the input.
-0002c3c0: 2049 6620 2761 7574 6f27 2074 6865 6e20   If 'auto' then 
-0002c3d0: 6465 6369 6465 2062 7920 6d65 6d6f 7279  decide by memory
-0002c3e0: 2075 7365 2e0a 2020 2020 2020 2020 2020   use..          
-0002c3f0: 2020 4f6e 6c79 2075 7365 6420 7768 656e    Only used when
-0002c400: 2060 6064 6976 6973 696f 6e73 6060 2069   ``divisions`` i
-0002c410: 7320 6e6f 7420 6769 7665 6e2e 2049 6620  s not given. If 
-0002c420: 6060 6469 7669 7369 6f6e 7360 6020 6973  ``divisions`` is
-0002c430: 2067 6976 656e 2c0a 2020 2020 2020 2020   given,.        
-0002c440: 2020 2020 7468 6520 6e75 6d62 6572 206f      the number o
-0002c450: 6620 6f75 7470 7574 2070 6172 7469 7469  f output partiti
-0002c460: 6f6e 7320 7769 6c6c 2062 6520 6060 6c65  ons will be ``le
-0002c470: 6e28 6469 7669 7369 6f6e 7329 202d 2031  n(divisions) - 1
-0002c480: 6060 2e0a 2020 2020 2020 2020 6469 7669  ``..        divi
-0002c490: 7369 6f6e 733a 206c 6973 742c 206f 7074  sions: list, opt
-0002c4a0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0002c4b0: 2020 5468 6520 2264 6976 6964 696e 6720    The "dividing 
-0002c4c0: 6c69 6e65 7322 2075 7365 6420 746f 2073  lines" used to s
-0002c4d0: 706c 6974 2074 6865 206e 6577 2069 6e64  plit the new ind
-0002c4e0: 6578 2069 6e74 6f20 7061 7274 6974 696f  ex into partitio
-0002c4f0: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
-0002c500: 466f 7220 6060 6469 7669 7369 6f6e 733d  For ``divisions=
-0002c510: 5b30 2c20 3130 2c20 3530 2c20 3130 305d  [0, 10, 50, 100]
-0002c520: 6060 2c20 7468 6572 6520 776f 756c 6420  ``, there would 
-0002c530: 6265 2074 6872 6565 206f 7574 7075 7420  be three output 
-0002c540: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
-0002c550: 2020 2020 2020 2020 7768 6572 6520 7468          where th
-0002c560: 6520 6e65 7720 696e 6465 7820 636f 6e74  e new index cont
-0002c570: 6169 6e65 6420 5b30 2c20 3130 292c 205b  ained [0, 10), [
-0002c580: 3130 2c20 3530 292c 2061 6e64 205b 3530  10, 50), and [50
-0002c590: 2c20 3130 3029 2c20 7265 7370 6563 7469  , 100), respecti
-0002c5a0: 7665 6c79 2e0a 2020 2020 2020 2020 2020  vely..          
-0002c5b0: 2020 5365 6520 6874 7470 733a 2f2f 646f    See https://do
-0002c5c0: 6373 2e64 6173 6b2e 6f72 672f 656e 2f6c  cs.dask.org/en/l
-0002c5d0: 6174 6573 742f 6461 7461 6672 616d 652d  atest/dataframe-
-0002c5e0: 6465 7369 676e 2e68 746d 6c23 7061 7274  design.html#part
-0002c5f0: 6974 696f 6e73 2e0a 2020 2020 2020 2020  itions..        
-0002c600: 2020 2020 4966 206e 6f74 2067 6976 656e      If not given
-0002c610: 2028 6465 6661 756c 7429 2c20 676f 6f64   (default), good
-0002c620: 2064 6976 6973 696f 6e73 2061 7265 2063   divisions are c
-0002c630: 616c 6375 6c61 7465 6420 6279 2069 6d6d  alculated by imm
-0002c640: 6564 6961 7465 6c79 2063 6f6d 7075 7469  ediately computi
-0002c650: 6e67 0a20 2020 2020 2020 2020 2020 2074  ng.            t
-0002c660: 6865 2064 6174 6120 616e 6420 6c6f 6f6b  he data and look
-0002c670: 696e 6720 6174 2074 6865 2064 6973 7472  ing at the distr
-0002c680: 6962 7574 696f 6e20 6f66 2069 7473 2076  ibution of its v
-0002c690: 616c 7565 732e 2046 6f72 206c 6172 6765  alues. For large
-0002c6a0: 2064 6174 6173 6574 732c 0a20 2020 2020   datasets,.     
-0002c6b0: 2020 2020 2020 2074 6869 7320 6361 6e20         this can 
-0002c6c0: 6265 2065 7870 656e 7369 7665 2e0a 2020  be expensive..  
-0002c6d0: 2020 2020 2020 2020 2020 4e6f 7465 2074            Note t
-0002c6e0: 6861 7420 6966 2060 6073 6f72 7465 643d  hat if ``sorted=
-0002c6f0: 5472 7565 6060 2c20 7370 6563 6966 6965  True``, specifie
-0002c700: 6420 6469 7669 7369 6f6e 7320 6172 6520  d divisions are 
-0002c710: 6173 7375 6d65 6420 746f 206d 6174 6368  assumed to match
-0002c720: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-0002c730: 2065 7869 7374 696e 6720 7061 7274 6974   existing partit
-0002c740: 696f 6e73 2069 6e20 7468 6520 6461 7461  ions in the data
-0002c750: 3b20 6966 2074 6869 7320 6973 2075 6e74  ; if this is unt
-0002c760: 7275 6520 796f 7520 7368 6f75 6c64 0a20  rue you should. 
-0002c770: 2020 2020 2020 2020 2020 206c 6561 7665             leave
-0002c780: 2064 6976 6973 696f 6e73 2065 6d70 7479   divisions empty
-0002c790: 2061 6e64 2063 616c 6c20 6060 7265 7061   and call ``repa
-0002c7a0: 7274 6974 696f 6e60 6020 6166 7465 7220  rtition`` after 
-0002c7b0: 6060 7365 745f 696e 6465 7860 602e 0a20  ``set_index``.. 
-0002c7c0: 2020 2020 2020 2069 6e70 6c61 6365 3a20         inplace: 
-0002c7d0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
-0002c7e0: 2020 2020 2020 2020 2020 204d 6f64 6966             Modif
-0002c7f0: 7969 6e67 2074 6865 2044 6174 6146 7261  ying the DataFra
-0002c800: 6d65 2069 6e20 706c 6163 6520 6973 206e  me in place is n
-0002c810: 6f74 2073 7570 706f 7274 6564 2062 7920  ot supported by 
-0002c820: 4461 736b 2e0a 2020 2020 2020 2020 2020  Dask..          
-0002c830: 2020 4465 6661 756c 7473 2074 6f20 4661    Defaults to Fa
-0002c840: 6c73 652e 0a20 2020 2020 2020 2073 6875  lse..        shu
-0002c850: 6666 6c65 3a20 7374 7269 6e67 2c20 2764  ffle: string, 'd
-0002c860: 6973 6b27 206f 7220 2774 6173 6b73 272c  isk' or 'tasks',
-0002c870: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0002c880: 2020 2020 2020 4569 7468 6572 2060 6027        Either ``'
-0002c890: 6469 736b 2760 6020 666f 7220 7369 6e67  disk'`` for sing
-0002c8a0: 6c65 2d6e 6f64 6520 6f70 6572 6174 696f  le-node operatio
-0002c8b0: 6e20 6f72 2060 6027 7461 736b 7327 6060  n or ``'tasks'``
-0002c8c0: 2066 6f72 0a20 2020 2020 2020 2020 2020   for.           
-0002c8d0: 2064 6973 7472 6962 7574 6564 206f 7065   distributed ope
-0002c8e0: 7261 7469 6f6e 2e20 2057 696c 6c20 6265  ration.  Will be
-0002c8f0: 2069 6e66 6572 7265 6420 6279 2079 6f75   inferred by you
-0002c900: 7220 6375 7272 656e 7420 7363 6865 6475  r current schedu
-0002c910: 6c65 722e 0a20 2020 2020 2020 2063 6f6d  ler..        com
-0002c920: 7075 7465 3a20 626f 6f6c 2c20 6465 6661  pute: bool, defa
-0002c930: 756c 7420 4661 6c73 650a 2020 2020 2020  ult False.      
-0002c940: 2020 2020 2020 5768 6574 6865 7220 6f72        Whether or
-0002c950: 206e 6f74 2074 6f20 7472 6967 6765 7220   not to trigger 
-0002c960: 616e 2069 6d6d 6564 6961 7465 2063 6f6d  an immediate com
-0002c970: 7075 7461 7469 6f6e 2e20 4465 6661 756c  putation. Defaul
-0002c980: 7473 2074 6f20 4661 6c73 652e 0a20 2020  ts to False..   
-0002c990: 2020 2020 2020 2020 204e 6f74 652c 2074           Note, t
-0002c9a0: 6861 7420 6576 656e 2069 6620 796f 7520  hat even if you 
-0002c9b0: 7365 7420 6060 636f 6d70 7574 653d 4661  set ``compute=Fa
-0002c9c0: 6c73 6560 602c 2061 6e20 696d 6d65 6469  lse``, an immedi
-0002c9d0: 6174 6520 636f 6d70 7574 6174 696f 6e0a  ate computation.
-0002c9e0: 2020 2020 2020 2020 2020 2020 7769 6c6c              will
-0002c9f0: 2073 7469 6c6c 2062 6520 7472 6967 6765   still be trigge
-0002ca00: 7265 6420 6966 2060 6064 6976 6973 696f  red if ``divisio
-0002ca10: 6e73 6060 2069 7320 6060 4e6f 6e65 6060  ns`` is ``None``
-0002ca20: 2e0a 2020 2020 2020 2020 7061 7274 6974  ..        partit
-0002ca30: 696f 6e5f 7369 7a65 3a20 696e 742c 206f  ion_size: int, o
-0002ca40: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-0002ca50: 2020 2020 4465 7369 7265 6420 7369 7a65      Desired size
-0002ca60: 206f 6620 6561 6368 2070 6172 7469 7469   of each partiti
-0002ca70: 6f6e 7320 696e 2062 7974 6573 2e0a 2020  ons in bytes..  
-0002ca80: 2020 2020 2020 2020 2020 4f6e 6c79 2075            Only u
-0002ca90: 7365 6420 7768 656e 2060 606e 7061 7274  sed when ``npart
-0002caa0: 6974 696f 6e73 3d27 6175 746f 2760 600a  itions='auto'``.
-0002cab0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-0002cac0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0002cad0: 2d2d 0a20 2020 2020 2020 203e 3e3e 2069  --.        >>> i
-0002cae0: 6d70 6f72 7420 6461 736b 0a20 2020 2020  mport dask.     
-0002caf0: 2020 203e 3e3e 2064 6466 203d 2064 6173     >>> ddf = das
-0002cb00: 6b2e 6461 7461 7365 7473 2e74 696d 6573  k.datasets.times
-0002cb10: 6572 6965 7328 7374 6172 743d 2232 3032  eries(start="202
-0002cb20: 312d 3031 2d30 3122 2c20 656e 643d 2232  1-01-01", end="2
-0002cb30: 3032 312d 3031 2d30 3722 2c20 6672 6571  021-01-07", freq
-0002cb40: 3d22 3148 2229 2e72 6573 6574 5f69 6e64  ="1H").reset_ind
-0002cb50: 6578 2829 0a20 2020 2020 2020 203e 3e3e  ex().        >>>
-0002cb60: 2064 6466 3220 3d20 6464 662e 7365 745f   ddf2 = ddf.set_
-0002cb70: 696e 6465 7828 2278 2229 0a20 2020 2020  index("x").     
-0002cb80: 2020 203e 3e3e 2064 6466 3220 3d20 6464     >>> ddf2 = dd
-0002cb90: 662e 7365 745f 696e 6465 7828 6464 662e  f.set_index(ddf.
-0002cba0: 7829 0a20 2020 2020 2020 203e 3e3e 2064  x).        >>> d
-0002cbb0: 6466 3220 3d20 6464 662e 7365 745f 696e  df2 = ddf.set_in
-0002cbc0: 6465 7828 6464 662e 7469 6d65 7374 616d  dex(ddf.timestam
-0002cbd0: 702c 2073 6f72 7465 643d 5472 7565 290a  p, sorted=True).
-0002cbe0: 0a20 2020 2020 2020 2041 2063 6f6d 6d6f  .        A commo
-0002cbf0: 6e20 6361 7365 2069 7320 7768 656e 2077  n case is when w
-0002cc00: 6520 6861 7665 2061 2064 6174 6574 696d  e have a datetim
-0002cc10: 6520 636f 6c75 6d6e 2074 6861 7420 7765  e column that we
-0002cc20: 206b 6e6f 7720 746f 2062 650a 2020 2020   know to be.    
-0002cc30: 2020 2020 736f 7274 6564 2061 6e64 2069      sorted and i
-0002cc40: 7320 636c 6561 6e6c 7920 6469 7669 6465  s cleanly divide
-0002cc50: 6420 6279 2064 6179 2e20 2057 6520 6361  d by day.  We ca
-0002cc60: 6e20 7365 7420 7468 6973 2069 6e64 6578  n set this index
-0002cc70: 2066 6f72 2066 7265 650a 2020 2020 2020   for free.      
-0002cc80: 2020 6279 2073 7065 6369 6679 696e 6720    by specifying 
-0002cc90: 626f 7468 2074 6861 7420 7468 6520 636f  both that the co
-0002cca0: 6c75 6d6e 2069 7320 7072 652d 736f 7274  lumn is pre-sort
-0002ccb0: 6564 2061 6e64 2074 6865 2070 6172 7469  ed and the parti
-0002ccc0: 6375 6c61 720a 2020 2020 2020 2020 6469  cular.        di
-0002ccd0: 7669 7369 6f6e 7320 616c 6f6e 6720 7768  visions along wh
-0002cce0: 6963 6820 6973 2069 7320 7365 7061 7261  ich is is separa
-0002ccf0: 7465 640a 0a20 2020 2020 2020 203e 3e3e  ted..        >>>
-0002cd00: 2069 6d70 6f72 7420 7061 6e64 6173 2061   import pandas a
-0002cd10: 7320 7064 0a20 2020 2020 2020 203e 3e3e  s pd.        >>>
-0002cd20: 2064 6976 6973 696f 6e73 203d 2070 642e   divisions = pd.
-0002cd30: 6461 7465 5f72 616e 6765 2873 7461 7274  date_range(start
-0002cd40: 3d22 3230 3231 2d30 312d 3031 222c 2065  ="2021-01-01", e
-0002cd50: 6e64 3d22 3230 3231 2d30 312d 3037 222c  nd="2021-01-07",
-0002cd60: 2066 7265 713d 2731 4427 290a 2020 2020   freq='1D').    
-0002cd70: 2020 2020 3e3e 3e20 6469 7669 7369 6f6e      >>> division
-0002cd80: 730a 2020 2020 2020 2020 4461 7465 7469  s.        Dateti
-0002cd90: 6d65 496e 6465 7828 5b27 3230 3231 2d30  meIndex(['2021-0
-0002cda0: 312d 3031 272c 2027 3230 3231 2d30 312d  1-01', '2021-01-
-0002cdb0: 3032 272c 2027 3230 3231 2d30 312d 3033  02', '2021-01-03
-0002cdc0: 272c 2027 3230 3231 2d30 312d 3034 272c  ', '2021-01-04',
-0002cdd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002cde0: 2020 2020 2020 2020 2732 3032 312d 3031          '2021-01
-0002cdf0: 2d30 3527 2c20 2732 3032 312d 3031 2d30  -05', '2021-01-0
-0002ce00: 3627 2c20 2732 3032 312d 3031 2d30 3727  6', '2021-01-07'
-0002ce10: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0002ce20: 2020 2020 2020 2020 2064 7479 7065 3d27           dtype='
-0002ce30: 6461 7465 7469 6d65 3634 5b6e 735d 272c  datetime64[ns]',
-0002ce40: 2066 7265 713d 2744 2729 0a0a 2020 2020   freq='D')..    
-0002ce50: 2020 2020 4e6f 7465 2074 6861 7420 6060      Note that ``
-0002ce60: 6c65 6e28 6469 7669 736f 6e73 2960 6020  len(divisons)`` 
-0002ce70: 6973 2065 7175 616c 2074 6f20 6060 6e70  is equal to ``np
-0002ce80: 6172 7469 7469 6f6e 7320 2b20 3160 602e  artitions + 1``.
-0002ce90: 2054 6869 7320 6973 2062 6563 6175 7365   This is because
-0002cea0: 2060 6064 6976 6973 696f 6e73 6060 0a20   ``divisions``. 
-0002ceb0: 2020 2020 2020 2072 6570 7265 7365 6e74         represent
-0002cec0: 7320 7468 6520 7570 7065 7220 616e 6420  s the upper and 
-0002ced0: 6c6f 7765 7220 626f 756e 6473 206f 6620  lower bounds of 
-0002cee0: 6561 6368 2070 6172 7469 7469 6f6e 2e20  each partition. 
-0002cef0: 5468 6520 6669 7273 7420 6974 656d 2069  The first item i
-0002cf00: 7320 7468 650a 2020 2020 2020 2020 6c6f  s the.        lo
-0002cf10: 7765 7220 626f 756e 6420 6f66 2074 6865  wer bound of the
-0002cf20: 2066 6972 7374 2070 6172 7469 7469 6f6e   first partition
-0002cf30: 2c20 7468 6520 7365 636f 6e64 2069 7465  , the second ite
-0002cf40: 6d20 6973 2074 6865 206c 6f77 6572 2062  m is the lower b
-0002cf50: 6f75 6e64 206f 6620 7468 650a 2020 2020  ound of the.    
-0002cf60: 2020 2020 7365 636f 6e64 2070 6172 7469      second parti
-0002cf70: 7469 6f6e 2061 6e64 2074 6865 2075 7070  tion and the upp
-0002cf80: 6572 2062 6f75 6e64 206f 6620 7468 6520  er bound of the 
-0002cf90: 6669 7273 7420 7061 7274 6974 696f 6e2c  first partition,
-0002cfa0: 2061 6e64 2073 6f20 6f6e 2e0a 2020 2020   and so on..    
-0002cfb0: 2020 2020 5468 6520 7365 636f 6e64 2d74      The second-t
-0002cfc0: 6f2d 6c61 7374 2069 7465 6d20 6973 2074  o-last item is t
-0002cfd0: 6865 206c 6f77 6572 2062 6f75 6e64 206f  he lower bound o
-0002cfe0: 6620 7468 6520 6c61 7374 2070 6172 7469  f the last parti
-0002cff0: 7469 6f6e 2c20 616e 6420 7468 6520 6c61  tion, and the la
-0002d000: 7374 0a20 2020 2020 2020 2028 6578 7472  st.        (extr
-0002d010: 6129 2069 7465 6d20 6973 2074 6865 2075  a) item is the u
-0002d020: 7070 6572 2062 6f75 6e64 206f 6620 7468  pper bound of th
-0002d030: 6520 6c61 7374 2070 6172 7469 7469 6f6e  e last partition
-0002d040: 2e0a 0a20 2020 2020 2020 203e 3e3e 2064  ...        >>> d
-0002d050: 6466 3220 3d20 6464 662e 7365 745f 696e  df2 = ddf.set_in
-0002d060: 6465 7828 2274 696d 6573 7461 6d70 222c  dex("timestamp",
-0002d070: 2073 6f72 7465 643d 5472 7565 2c20 6469   sorted=True, di
-0002d080: 7669 7369 6f6e 733d 6469 7669 7369 6f6e  visions=division
-0002d090: 732e 746f 6c69 7374 2829 290a 0a20 2020  s.tolist())..   
-0002d0a0: 2020 2020 2049 6620 796f 7527 6c6c 2062       If you'll b
-0002d0b0: 6520 7275 6e6e 696e 6720 6073 6574 5f69  e running `set_i
-0002d0c0: 6e64 6578 6020 6f6e 2074 6865 2073 616d  ndex` on the sam
-0002d0d0: 6520 286f 7220 7369 6d69 6c61 7229 2064  e (or similar) d
-0002d0e0: 6174 6173 6574 7320 7265 7065 6174 6564  atasets repeated
-0002d0f0: 6c79 2c0a 2020 2020 2020 2020 796f 7520  ly,.        you 
-0002d100: 636f 756c 6420 7361 7665 2074 696d 6520  could save time 
-0002d110: 6279 206c 6574 7469 6e67 2044 6173 6b20  by letting Dask 
-0002d120: 6361 6c63 756c 6174 6520 676f 6f64 2064  calculate good d
-0002d130: 6976 6973 696f 6e73 206f 6e63 652c 2074  ivisions once, t
-0002d140: 6865 6e20 636f 7079 2d70 6173 7469 6e67  hen copy-pasting
-0002d150: 0a20 2020 2020 2020 2074 6865 6d20 746f  .        them to
-0002d160: 2072 6575 7365 2e20 5468 6973 2069 7320   reuse. This is 
-0002d170: 6573 7065 6369 616c 6c79 2068 656c 7066  especially helpf
-0002d180: 756c 2072 756e 6e69 6e67 2069 6e20 6120  ul running in a 
-0002d190: 4a75 7079 7465 7220 6e6f 7465 626f 6f6b  Jupyter notebook
-0002d1a0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-0002d1b0: 6466 3220 3d20 6464 662e 7365 745f 696e  df2 = ddf.set_in
-0002d1c0: 6465 7828 226e 616d 6522 2920 2023 2073  dex("name")  # s
-0002d1d0: 6c6f 772c 2063 616c 6375 6c61 7465 7320  low, calculates 
-0002d1e0: 6461 7461 2064 6973 7472 6962 7574 696f  data distributio
-0002d1f0: 6e0a 2020 2020 2020 2020 3e3e 3e20 6464  n.        >>> dd
-0002d200: 6632 2e64 6976 6973 696f 6e73 2020 2320  f2.divisions  # 
-0002d210: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0002d220: 2020 2020 2020 205b 2241 6c69 6365 222c         ["Alice",
-0002d230: 2022 4c61 7572 6122 2c20 2255 7273 756c   "Laura", "Ursul
-0002d240: 6122 2c20 225a 656c 6461 225d 0a20 2020  a", "Zelda"].   
-0002d250: 2020 2020 203e 3e3e 2023 205e 204e 6f77       >>> # ^ Now
-0002d260: 2063 6f70 792d 7061 7374 6520 7468 6973   copy-paste this
-0002d270: 2061 6e64 2065 6469 7420 7468 6520 6c69   and edit the li
-0002d280: 6e65 2061 626f 7665 2074 6f3a 0a20 2020  ne above to:.   
-0002d290: 2020 2020 203e 3e3e 2023 2064 6466 3220       >>> # ddf2 
-0002d2a0: 3d20 6464 662e 7365 745f 696e 6465 7828  = ddf.set_index(
-0002d2b0: 226e 616d 6522 2c20 6469 7669 7369 6f6e  "name", division
-0002d2c0: 733d 5b22 416c 6963 6522 2c20 224c 6175  s=["Alice", "Lau
-0002d2d0: 7261 222c 2022 5572 7375 6c61 222c 2022  ra", "Ursula", "
-0002d2e0: 5a65 6c64 6122 5d29 0a20 2020 2020 2020  Zelda"]).       
-0002d2f0: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
-0002d300: 2069 6e70 6c61 6365 3a0a 2020 2020 2020   inplace:.      
-0002d310: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-0002d320: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-0002d330: 2254 6865 2069 6e70 6c61 6365 3d20 6b65  "The inplace= ke
-0002d340: 7977 6f72 6420 6973 206e 6f74 2073 7570  yword is not sup
-0002d350: 706f 7274 6564 2229 0a20 2020 2020 2020  ported").       
-0002d360: 2070 7265 5f73 6f72 7465 6420 3d20 736f   pre_sorted = so
-0002d370: 7274 6564 0a20 2020 2020 2020 2064 656c  rted.        del
-0002d380: 2073 6f72 7465 640a 0a20 2020 2020 2020   sorted..       
-0002d390: 2023 2043 6865 636b 206f 7468 6572 2063   # Check other c
-0002d3a0: 616e 2062 6520 7472 616e 736c 6174 6564  an be translated
-0002d3b0: 2074 6f20 636f 6c75 6d6e 206e 616d 6520   to column name 
-0002d3c0: 6f72 2063 6f6c 756d 6e20 6f62 6a65 6374  or column object
-0002d3d0: 2c20 706f 7373 6962 6c79 2066 6c61 7474  , possibly flatt
-0002d3e0: 656e 696e 6720 6974 0a20 2020 2020 2020  ening it.       
-0002d3f0: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0002d400: 6365 286f 7468 6572 2c20 7374 7229 3a0a  ce(other, str):.
-0002d410: 2020 2020 2020 2020 2020 2020 2320 4974              # It
-0002d420: 206d 6179 2072 6566 6572 2074 6f20 7365   may refer to se
-0002d430: 7665 7261 6c20 636f 6c75 6d6e 730a 2020  veral columns.  
-0002d440: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-0002d450: 6e73 7461 6e63 6528 6f74 6865 722c 2053  nstance(other, S
-0002d460: 6571 7565 6e63 6529 3a20 2023 2074 7970  equence):  # typ
-0002d470: 653a 2069 676e 6f72 655b 756e 7265 6163  e: ignore[unreac
-0002d480: 6861 626c 655d 0a20 2020 2020 2020 2020  hable].         
-0002d490: 2020 2020 2020 2023 2041 6363 6570 7420         # Accept 
-0002d4a0: 5b22 6122 5d2c 2062 7574 206e 6f74 205b  ["a"], but not [
-0002d4b0: 5b22 6122 5d5d 0a20 2020 2020 2020 2020  ["a"]].         
-0002d4c0: 2020 2020 2020 2069 6620 6c65 6e28 6f74         if len(ot
-0002d4d0: 6865 7229 203d 3d20 3120 616e 6420 2820  her) == 1 and ( 
-0002d4e0: 2023 2074 7970 653a 2069 676e 6f72 655b   # type: ignore[
-0002d4f0: 756e 7265 6163 6861 626c 655d 0a20 2020  unreachable].   
-0002d500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d510: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
-0002d520: 725b 305d 2c20 7374 7229 206f 7220 6e6f  r[0], str) or no
-0002d530: 7420 6973 696e 7374 616e 6365 286f 7468  t isinstance(oth
-0002d540: 6572 5b30 5d2c 2053 6571 7565 6e63 6529  er[0], Sequence)
-0002d550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d560: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-0002d570: 2020 2020 2020 2020 6f74 6865 7220 3d20          other = 
-0002d580: 6f74 6865 725b 305d 0a20 2020 2020 2020  other[0].       
-0002d590: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0002d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d5b0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-0002d5c0: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-0002d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d5e0: 2020 2020 2020 2244 6173 6b20 6461 7461        "Dask data
-0002d5f0: 6672 616d 6520 646f 6573 206e 6f74 2079  frame does not y
-0002d600: 6574 2073 7570 706f 7274 206d 756c 7469  et support multi
-0002d610: 2d69 6e64 6578 6573 2e5c 6e22 0a20 2020  -indexes.\n".   
-0002d620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d630: 2020 2020 2066 2259 6f75 2074 7269 6564       f"You tried
-0002d640: 2074 6f20 696e 6465 7820 7769 7468 2074   to index with t
-0002d650: 6869 7320 696e 6465 783a 207b 6f74 6865  his index: {othe
-0002d660: 727d 5c6e 220a 2020 2020 2020 2020 2020  r}\n".          
-0002d670: 2020 2020 2020 2020 2020 2020 2020 2249                "I
-0002d680: 6e64 6578 6573 206d 7573 7420 6265 2073  ndexes must be s
-0002d690: 696e 676c 6520 636f 6c75 6d6e 7320 6f6e  ingle columns on
-0002d6a0: 6c79 2e22 0a20 2020 2020 2020 2020 2020  ly.".           
-0002d6b0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0002d6c0: 2020 2020 2020 2020 2320 4f72 2062 6520          # Or be 
-0002d6d0: 6120 6672 616d 6520 6469 7265 6374 6c79  a frame directly
-0002d6e0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0002d6f0: 6620 6973 696e 7374 616e 6365 286f 7468  f isinstance(oth
-0002d700: 6572 2c20 4461 7461 4672 616d 6529 3a20  er, DataFrame): 
-0002d710: 2023 2074 7970 653a 2069 676e 6f72 655b   # type: ignore[
-0002d720: 756e 7265 6163 6861 626c 655d 0a20 2020  unreachable].   
-0002d730: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0002d740: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-0002d750: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
-0002d760: 2020 2020 2020 2020 2020 2020 2244 6173              "Das
-0002d770: 6b20 6461 7461 6672 616d 6520 646f 6573  k dataframe does
-0002d780: 206e 6f74 2079 6574 2073 7570 706f 7274   not yet support
-0002d790: 206d 756c 7469 2d69 6e64 6578 6573 2e5c   multi-indexes.\
-0002d7a0: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
-0002d7b0: 2020 2020 2020 2066 2259 6f75 2074 7269         f"You tri
-0002d7c0: 6564 2074 6f20 696e 6465 7820 7769 7468  ed to index with
-0002d7d0: 2061 2066 7261 6d65 2077 6974 6820 7468   a frame with th
-0002d7e0: 6573 6520 636f 6c75 6d6e 733a 207b 6c69  ese columns: {li
-0002d7f0: 7374 286f 7468 6572 2e63 6f6c 756d 6e73  st(other.columns
-0002d800: 297d 5c6e 220a 2020 2020 2020 2020 2020  )}\n".          
-0002d810: 2020 2020 2020 2020 2020 2249 6e64 6578            "Index
-0002d820: 6573 206d 7573 7420 6265 2073 696e 676c  es must be singl
-0002d830: 6520 636f 6c75 6d6e 7320 6f6e 6c79 2e22  e columns only."
-0002d840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d850: 2029 0a0a 2020 2020 2020 2020 2320 4966   )..        # If
-0002d860: 2061 6c72 6561 6479 2061 2073 6572 6965   already a serie
-0002d870: 730a 2020 2020 2020 2020 6966 2069 7369  s.        if isi
-0002d880: 6e73 7461 6e63 6528 6f74 6865 722c 2053  nstance(other, S
-0002d890: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
-0002d8a0: 2020 2020 2320 4966 2069 7427 7320 616c      # If it's al
-0002d8b0: 7265 6164 7920 7468 6520 696e 6465 782c  ready the index,
-0002d8c0: 2074 6865 7265 2773 206e 6f74 6869 6e67   there's nothing
-0002d8d0: 2074 6f20 646f 0a20 2020 2020 2020 2020   to do.         
-0002d8e0: 2020 2069 6620 6f74 6865 722e 5f6e 616d     if other._nam
-0002d8f0: 6520 3d3d 2073 656c 662e 696e 6465 782e  e == self.index.
-0002d900: 5f6e 616d 653a 0a20 2020 2020 2020 2020  _name:.         
-0002d910: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-0002d920: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
-0002d930: 2020 2020 2020 2020 2020 224e 6577 2069            "New i
-0002d940: 6e64 6578 2068 6173 2073 616d 6520 6e61  ndex has same na
-0002d950: 6d65 2061 7320 6578 6973 7469 6e67 2c20  me as existing, 
-0002d960: 7468 6973 2069 7320 6120 6e6f 2d6f 702e  this is a no-op.
-0002d970: 222c 2055 7365 7257 6172 6e69 6e67 0a20  ", UserWarning. 
-0002d980: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0002d990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d9a0: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
-0002d9b0: 2020 2020 2020 2320 4966 2074 6865 206e        # If the n
-0002d9c0: 616d 6520 6f66 2061 2063 6f6c 756d 6e2f  ame of a column/
-0002d9d0: 696e 6465 780a 2020 2020 2020 2020 656c  index.        el
-0002d9e0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0002d9f0: 2320 5769 7468 2074 6865 2073 616d 6520  # With the same 
-0002da00: 6e61 6d65 2061 7320 7468 6520 696e 6465  name as the inde
-0002da10: 782c 2074 6865 7265 2773 206e 6f74 6869  x, there's nothi
-0002da20: 6e67 2074 6f20 646f 2065 6974 6865 720a  ng to do either.
-0002da30: 2020 2020 2020 2020 2020 2020 6966 206f              if o
-0002da40: 7468 6572 203d 3d20 7365 6c66 2e69 6e64  ther == self.ind
-0002da50: 6578 2e6e 616d 653a 0a20 2020 2020 2020  ex.name:.       
-0002da60: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
-0002da70: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
-0002da80: 2020 2020 2020 2020 2020 2020 224e 6577              "New
-0002da90: 2069 6e64 6578 2068 6173 2073 616d 6520   index has same 
-0002daa0: 6e61 6d65 2061 7320 6578 6973 7469 6e67  name as existing
-0002dab0: 2c20 7468 6973 2069 7320 6120 6e6f 2d6f  , this is a no-o
-0002dac0: 702e 222c 2055 7365 7257 6172 6e69 6e67  p.", UserWarning
-0002dad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002dae0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-0002daf0: 2020 2072 6574 7572 6e20 7365 6c66 0a0a     return self..
-0002db00: 2020 2020 2020 2020 2020 2020 2320 4966              # If
-0002db10: 2061 206d 6973 7369 6e67 2063 6f6c 756d   a missing colum
-0002db20: 6e2c 204b 6579 4572 726f 720a 2020 2020  n, KeyError.    
-0002db30: 2020 2020 2020 2020 6966 206f 7468 6572          if other
-0002db40: 206e 6f74 2069 6e20 7365 6c66 2e63 6f6c   not in self.col
-0002db50: 756d 6e73 3a0a 2020 2020 2020 2020 2020  umns:.          
-0002db60: 2020 2020 2020 7261 6973 6520 4b65 7945        raise KeyE
-0002db70: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0002db80: 2020 2020 2020 2020 2020 6622 4461 7461            f"Data
-0002db90: 2068 6173 206e 6f20 636f 6c75 6d6e 2027   has no column '
-0002dba0: 7b6f 7468 6572 7d27 3a20 7573 6520 616e  {other}': use an
-0002dbb0: 7920 636f 6c75 6d6e 206f 6620 7b6c 6973  y column of {lis
-0002dbc0: 7428 7365 6c66 2e63 6f6c 756d 6e73 297d  t(self.columns)}
-0002dbd0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0002dbe0: 2020 290a 0a20 2020 2020 2020 2023 2043    )..        # C
-0002dbf0: 6865 636b 2064 6976 6973 696f 6e73 0a20  heck divisions. 
-0002dc00: 2020 2020 2020 2069 6620 6469 7669 7369         if divisi
-0002dc10: 6f6e 7320 6973 206e 6f74 204e 6f6e 653a  ons is not None:
-0002dc20: 0a20 2020 2020 2020 2020 2020 2063 6865  .            che
-0002dc30: 636b 5f64 6976 6973 696f 6e73 2864 6976  ck_divisions(div
-0002dc40: 6973 696f 6e73 290a 2020 2020 2020 2020  isions).        
-0002dc50: 656c 6966 2028 0a20 2020 2020 2020 2020  elif (.         
-0002dc60: 2020 2069 7369 6e73 7461 6e63 6528 6f74     isinstance(ot
-0002dc70: 6865 722c 2049 6e64 6578 290a 2020 2020  her, Index).    
-0002dc80: 2020 2020 2020 2020 616e 6420 6f74 6865          and othe
-0002dc90: 722e 6b6e 6f77 6e5f 6469 7669 7369 6f6e  r.known_division
-0002dca0: 730a 2020 2020 2020 2020 2020 2020 616e  s.            an
-0002dcb0: 6420 6f74 6865 722e 6e70 6172 7469 7469  d other.npartiti
-0002dcc0: 6f6e 7320 3d3d 2073 656c 662e 6e70 6172  ons == self.npar
-0002dcd0: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
-0002dce0: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-0002dcf0: 2049 6620 7468 6520 696e 6465 7820 6861   If the index ha
-0002dd00: 7320 7468 6520 7361 6d65 206e 756d 6265  s the same numbe
-0002dd10: 7220 6f66 2070 6172 7469 7469 6f6e 7320  r of partitions 
-0002dd20: 616e 6420 6b6e 6f77 6e0a 2020 2020 2020  and known.      
-0002dd30: 2020 2020 2020 2320 6469 7669 7369 6f6e        # division
-0002dd40: 732c 2074 6865 6e20 7765 2063 616e 2074  s, then we can t
-0002dd50: 7265 6174 2069 7420 6173 2070 7265 2d73  reat it as pre-s
-0002dd60: 6f72 7465 6420 7769 7468 206b 6e6f 776e  orted with known
-0002dd70: 0a20 2020 2020 2020 2020 2020 2023 2064  .            # d
-0002dd80: 6976 6973 696f 6e73 0a20 2020 2020 2020  ivisions.       
-0002dd90: 2020 2020 2070 7265 5f73 6f72 7465 6420       pre_sorted 
-0002dda0: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-0002ddb0: 2020 2064 6976 6973 696f 6e73 203d 206f     divisions = o
-0002ddc0: 7468 6572 2e64 6976 6973 696f 6e73 0a0a  ther.divisions..
-0002ddd0: 2020 2020 2020 2020 2320 4966 2069 6e64          # If ind
-0002dde0: 6578 2069 7320 616c 7265 6164 7920 736f  ex is already so
-0002ddf0: 7274 6564 2c20 7461 6b65 2061 6476 616e  rted, take advan
-0002de00: 7461 6765 206f 6620 7468 6174 2077 6974  tage of that wit
-0002de10: 6820 7365 745f 736f 7274 6564 5f69 6e64  h set_sorted_ind
-0002de20: 6578 0a20 2020 2020 2020 2069 6620 7072  ex.        if pr
-0002de30: 655f 736f 7274 6564 3a0a 2020 2020 2020  e_sorted:.      
-0002de40: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-0002de50: 6461 7461 6672 616d 652e 7368 7566 666c  dataframe.shuffl
-0002de60: 6520 696d 706f 7274 2073 6574 5f73 6f72  e import set_sor
-0002de70: 7465 645f 696e 6465 780a 0a20 2020 2020  ted_index..     
-0002de80: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0002de90: 745f 736f 7274 6564 5f69 6e64 6578 280a  t_sorted_index(.
-0002dea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002deb0: 7365 6c66 2c20 6f74 6865 722c 2064 726f  self, other, dro
-0002dec0: 703d 6472 6f70 2c20 6469 7669 7369 6f6e  p=drop, division
-0002ded0: 733d 6469 7669 7369 6f6e 732c 202a 2a6b  s=divisions, **k
-0002dee0: 7761 7267 730a 2020 2020 2020 2020 2020  wargs.          
-0002def0: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
-0002df00: 3a0a 2020 2020 2020 2020 2020 2020 6672  :.            fr
-0002df10: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
-0002df20: 652e 7368 7566 666c 6520 696d 706f 7274  e.shuffle import
-0002df30: 2073 6574 5f69 6e64 6578 0a0a 2020 2020   set_index..    
-0002df40: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002df50: 6574 5f69 6e64 6578 280a 2020 2020 2020  et_index(.      
-0002df60: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-0002df70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002df80: 6f74 6865 722c 0a20 2020 2020 2020 2020  other,.         
-0002df90: 2020 2020 2020 2064 726f 703d 6472 6f70         drop=drop
-0002dfa0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002dfb0: 2020 6e70 6172 7469 7469 6f6e 733d 6e70    npartitions=np
-0002dfc0: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
-0002dfd0: 2020 2020 2020 2020 2020 2064 6976 6973             divis
-0002dfe0: 696f 6e73 3d64 6976 6973 696f 6e73 2c0a  ions=divisions,.
-0002dff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e000: 2a2a 6b77 6172 6773 2c0a 2020 2020 2020  **kwargs,.      
-0002e010: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
-0002e020: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0002e030: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0002e040: 2070 6f70 2873 656c 662c 2069 7465 6d29   pop(self, item)
-0002e050: 3a0a 2020 2020 2020 2020 6f75 7420 3d20  :.        out = 
-0002e060: 7365 6c66 5b69 7465 6d5d 0a20 2020 2020  self[item].     
-0002e070: 2020 2064 656c 2073 656c 665b 6974 656d     del self[item
-0002e080: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
-0002e090: 206f 7574 0a0a 2020 2020 4064 6572 6976   out..    @deriv
-0002e0a0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-0002e0b0: 7261 6d65 290a 2020 2020 6465 6620 6e6c  rame).    def nl
-0002e0c0: 6172 6765 7374 2873 656c 662c 206e 3d35  argest(self, n=5
-0002e0d0: 2c20 636f 6c75 6d6e 733d 4e6f 6e65 2c20  , columns=None, 
-0002e0e0: 7370 6c69 745f 6576 6572 793d 4e6f 6e65  split_every=None
-0002e0f0: 293a 0a20 2020 2020 2020 2074 6f6b 656e  ):.        token
-0002e100: 203d 2022 6461 7461 6672 616d 652d 6e6c   = "dataframe-nl
-0002e110: 6172 6765 7374 220a 2020 2020 2020 2020  argest".        
-0002e120: 7265 7475 726e 2061 6361 280a 2020 2020  return aca(.    
-0002e130: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0002e140: 2020 2020 2020 2020 2020 6368 756e 6b3d            chunk=
-0002e150: 4d2e 6e6c 6172 6765 7374 2c0a 2020 2020  M.nlargest,.    
-0002e160: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-0002e170: 653d 4d2e 6e6c 6172 6765 7374 2c0a 2020  e=M.nlargest,.  
-0002e180: 2020 2020 2020 2020 2020 6d65 7461 3d73            meta=s
-0002e190: 656c 662e 5f6d 6574 612c 0a20 2020 2020  elf._meta,.     
-0002e1a0: 2020 2020 2020 2074 6f6b 656e 3d74 6f6b         token=tok
-0002e1b0: 656e 2c0a 2020 2020 2020 2020 2020 2020  en,.            
-0002e1c0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-0002e1d0: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
-0002e1e0: 2020 2020 206e 3d6e 2c0a 2020 2020 2020       n=n,.      
-0002e1f0: 2020 2020 2020 636f 6c75 6d6e 733d 636f        columns=co
-0002e200: 6c75 6d6e 732c 0a20 2020 2020 2020 2029  lumns,.        )
-0002e210: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0002e220: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0002e230: 290a 2020 2020 6465 6620 6e73 6d61 6c6c  ).    def nsmall
-0002e240: 6573 7428 7365 6c66 2c20 6e3d 352c 2063  est(self, n=5, c
-0002e250: 6f6c 756d 6e73 3d4e 6f6e 652c 2073 706c  olumns=None, spl
-0002e260: 6974 5f65 7665 7279 3d4e 6f6e 6529 3a0a  it_every=None):.
-0002e270: 2020 2020 2020 2020 746f 6b65 6e20 3d20          token = 
-0002e280: 2264 6174 6166 7261 6d65 2d6e 736d 616c  "dataframe-nsmal
-0002e290: 6c65 7374 220a 2020 2020 2020 2020 7265  lest".        re
-0002e2a0: 7475 726e 2061 6361 280a 2020 2020 2020  turn aca(.      
-0002e2b0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0002e2c0: 2020 2020 2020 2020 6368 756e 6b3d 4d2e          chunk=M.
-0002e2d0: 6e73 6d61 6c6c 6573 742c 0a20 2020 2020  nsmallest,.     
-0002e2e0: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
-0002e2f0: 3d4d 2e6e 736d 616c 6c65 7374 2c0a 2020  =M.nsmallest,.  
-0002e300: 2020 2020 2020 2020 2020 6d65 7461 3d73            meta=s
-0002e310: 656c 662e 5f6d 6574 612c 0a20 2020 2020  elf._meta,.     
-0002e320: 2020 2020 2020 2074 6f6b 656e 3d74 6f6b         token=tok
-0002e330: 656e 2c0a 2020 2020 2020 2020 2020 2020  en,.            
-0002e340: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-0002e350: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
-0002e360: 2020 2020 206e 3d6e 2c0a 2020 2020 2020       n=n,.      
-0002e370: 2020 2020 2020 636f 6c75 6d6e 733d 636f        columns=co
-0002e380: 6c75 6d6e 732c 0a20 2020 2020 2020 2029  lumns,.        )
-0002e390: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0002e3a0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0002e3b0: 290a 2020 2020 6465 6620 6772 6f75 7062  ).    def groupb
-0002e3c0: 7928 0a20 2020 2020 2020 2073 656c 662c  y(.        self,
-0002e3d0: 0a20 2020 2020 2020 2062 793d 4e6f 6e65  .        by=None
-0002e3e0: 2c0a 2020 2020 2020 2020 6772 6f75 705f  ,.        group_
-0002e3f0: 6b65 7973 3d47 524f 5550 5f4b 4559 535f  keys=GROUP_KEYS_
-0002e400: 4445 4641 554c 542c 0a20 2020 2020 2020  DEFAULT,.       
-0002e410: 2073 6f72 743d 4e6f 6e65 2c0a 2020 2020   sort=None,.    
-0002e420: 2020 2020 6f62 7365 7276 6564 3d4e 6f6e      observed=Non
-0002e430: 652c 0a20 2020 2020 2020 2064 726f 706e  e,.        dropn
-0002e440: 613d 4e6f 6e65 2c0a 2020 2020 2020 2020  a=None,.        
-0002e450: 2a2a 6b77 6172 6773 2c0a 2020 2020 293a  **kwargs,.    ):
-0002e460: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-0002e470: 736b 2e64 6174 6166 7261 6d65 2e67 726f  sk.dataframe.gro
-0002e480: 7570 6279 2069 6d70 6f72 7420 4461 7461  upby import Data
-0002e490: 4672 616d 6547 726f 7570 4279 0a0a 2020  FrameGroupBy..  
-0002e4a0: 2020 2020 2020 7265 7475 726e 2044 6174        return Dat
-0002e4b0: 6146 7261 6d65 4772 6f75 7042 7928 0a20  aFrameGroupBy(. 
-0002e4c0: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-0002e4d0: 0a20 2020 2020 2020 2020 2020 2062 793d  .            by=
-0002e4e0: 6279 2c0a 2020 2020 2020 2020 2020 2020  by,.            
-0002e4f0: 6772 6f75 705f 6b65 7973 3d67 726f 7570  group_keys=group
-0002e500: 5f6b 6579 732c 0a20 2020 2020 2020 2020  _keys,.         
-0002e510: 2020 2073 6f72 743d 736f 7274 2c0a 2020     sort=sort,.  
-0002e520: 2020 2020 2020 2020 2020 6f62 7365 7276            observ
-0002e530: 6564 3d6f 6273 6572 7665 642c 0a20 2020  ed=observed,.   
-0002e540: 2020 2020 2020 2020 2064 726f 706e 613d           dropna=
-0002e550: 6472 6f70 6e61 2c0a 2020 2020 2020 2020  dropna,.        
-0002e560: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
-0002e570: 2020 2020 2020 290a 0a20 2020 2040 7772        )..    @wr
-0002e580: 6170 7328 6361 7465 676f 7269 7a65 290a  aps(categorize).
-0002e590: 2020 2020 6465 6620 6361 7465 676f 7269      def categori
-0002e5a0: 7a65 2873 656c 662c 2063 6f6c 756d 6e73  ze(self, columns
-0002e5b0: 3d4e 6f6e 652c 2069 6e64 6578 3d4e 6f6e  =None, index=Non
-0002e5c0: 652c 2073 706c 6974 5f65 7665 7279 3d4e  e, split_every=N
-0002e5d0: 6f6e 652c 202a 2a6b 7761 7267 7329 3a0a  one, **kwargs):.
-0002e5e0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-0002e5f0: 6174 6567 6f72 697a 6528 0a20 2020 2020  ategorize(.     
-0002e600: 2020 2020 2020 2073 656c 662c 2063 6f6c         self, col
-0002e610: 756d 6e73 3d63 6f6c 756d 6e73 2c20 696e  umns=columns, in
-0002e620: 6465 783d 696e 6465 782c 2073 706c 6974  dex=index, split
-0002e630: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-0002e640: 7279 2c20 2a2a 6b77 6172 6773 0a20 2020  ry, **kwargs.   
-0002e650: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
-0002e660: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-0002e670: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-0002e680: 6173 7369 676e 2873 656c 662c 202a 2a6b  assign(self, **k
-0002e690: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-0002e6a0: 6461 7461 203d 2073 656c 662e 636f 7079  data = self.copy
-0002e6b0: 2829 0a20 2020 2020 2020 2066 6f72 206b  ().        for k
-0002e6c0: 2c20 7620 696e 206b 7761 7267 732e 6974  , v in kwargs.it
-0002e6d0: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
-0002e6e0: 2020 2069 6620 6e6f 7420 280a 2020 2020     if not (.    
-0002e6f0: 2020 2020 2020 2020 2020 2020 6973 696e              isin
-0002e700: 7374 616e 6365 2876 2c20 5363 616c 6172  stance(v, Scalar
-0002e710: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002e720: 2020 6f72 2069 735f 7365 7269 6573 5f6c    or is_series_l
-0002e730: 696b 6528 7629 0a20 2020 2020 2020 2020  ike(v).         
-0002e740: 2020 2020 2020 206f 7220 6361 6c6c 6162         or callab
-0002e750: 6c65 2876 290a 2020 2020 2020 2020 2020  le(v).          
-0002e760: 2020 2020 2020 6f72 2070 642e 6170 692e        or pd.api.
-0002e770: 7479 7065 732e 6973 5f73 6361 6c61 7228  types.is_scalar(
-0002e780: 7629 0a20 2020 2020 2020 2020 2020 2020  v).             
-0002e790: 2020 206f 7220 6973 5f69 6e64 6578 5f6c     or is_index_l
-0002e7a0: 696b 6528 7629 0a20 2020 2020 2020 2020  ike(v).         
-0002e7b0: 2020 2020 2020 206f 7220 6973 696e 7374         or isinst
-0002e7c0: 616e 6365 2876 2c20 4172 7261 7929 0a20  ance(v, Array). 
-0002e7d0: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
-0002e7e0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0002e7f0: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
-0002e800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e810: 2020 2066 2243 6f6c 756d 6e20 6173 7369     f"Column assi
-0002e820: 676e 6d65 6e74 2064 6f65 736e 2774 2073  gnment doesn't s
-0002e830: 7570 706f 7274 2074 7970 6520 7b74 7970  upport type {typ
-0002e840: 656e 616d 6528 7479 7065 2876 2929 7d22  ename(type(v))}"
-0002e850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e860: 2029 0a20 2020 2020 2020 2020 2020 2069   ).            i
-0002e870: 6620 6361 6c6c 6162 6c65 2876 293a 0a20  f callable(v):. 
-0002e880: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-0002e890: 7761 7267 735b 6b5d 203d 2076 2864 6174  wargs[k] = v(dat
-0002e8a0: 6129 0a20 2020 2020 2020 2020 2020 2069  a).            i
-0002e8b0: 6620 6973 696e 7374 616e 6365 2876 2c20  f isinstance(v, 
-0002e8c0: 4172 7261 7929 3a0a 2020 2020 2020 2020  Array):.        
-0002e8d0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-0002e8e0: 6b2e 6461 7461 6672 616d 652e 696f 2069  k.dataframe.io i
-0002e8f0: 6d70 6f72 7420 6672 6f6d 5f64 6173 6b5f  mport from_dask_
-0002e900: 6172 7261 790a 0a20 2020 2020 2020 2020  array..         
-0002e910: 2020 2020 2020 2069 6620 6c65 6e28 762e         if len(v.
-0002e920: 7368 6170 6529 203e 2031 3a0a 2020 2020  shape) > 1:.    
-0002e930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e940: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0002e950: 2822 4172 7261 7920 6173 7369 676e 6d65  ("Array assignme
-0002e960: 6e74 206f 6e6c 7920 7375 7070 6f72 7473  nt only supports
-0002e970: 2031 2d44 2061 7272 6179 7322 290a 2020   1-D arrays").  
-0002e980: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002e990: 2076 2e6e 7061 7274 6974 696f 6e73 2021   v.npartitions !
-0002e9a0: 3d20 6461 7461 2e6e 7061 7274 6974 696f  = data.npartitio
-0002e9b0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-0002e9c0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002e9d0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-0002e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e9f0: 2020 224e 756d 6265 7220 6f66 2070 6172    "Number of par
-0002ea00: 7469 7469 6f6e 7320 646f 206e 6f74 206d  titions do not m
-0002ea10: 6174 6368 2022 0a20 2020 2020 2020 2020  atch ".         
-0002ea20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0002ea30: 2228 7b76 2e6e 7061 7274 6974 696f 6e73  "({v.npartitions
-0002ea40: 7d20 213d 207b 6461 7461 2e6e 7061 7274  } != {data.npart
-0002ea50: 6974 696f 6e73 7d29 220a 2020 2020 2020  itions})".      
-0002ea60: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0002ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea80: 6b77 6172 6773 5b6b 5d20 3d20 6672 6f6d  kwargs[k] = from
-0002ea90: 5f64 6173 6b5f 6172 7261 7928 762c 2069  _dask_array(v, i
-0002eaa0: 6e64 6578 3d64 6174 612e 696e 6465 782c  ndex=data.index,
-0002eab0: 206d 6574 613d 6461 7461 2e5f 6d65 7461   meta=data._meta
-0002eac0: 290a 0a20 2020 2020 2020 2020 2020 2070  )..            p
-0002ead0: 6169 7273 203d 205b 6b2c 206b 7761 7267  airs = [k, kwarg
-0002eae0: 735b 6b5d 5d0a 0a20 2020 2020 2020 2020  s[k]]..         
-0002eaf0: 2020 2023 2046 6967 7572 6520 6f75 7420     # Figure out 
-0002eb00: 636f 6c75 6d6e 7320 6f66 2074 6865 206f  columns of the o
-0002eb10: 7574 7075 740a 2020 2020 2020 2020 2020  utput.          
-0002eb20: 2020 6466 3220 3d20 6461 7461 2e5f 6d65    df2 = data._me
-0002eb30: 7461 5f6e 6f6e 656d 7074 792e 6173 7369  ta_nonempty.assi
-0002eb40: 676e 280a 2020 2020 2020 2020 2020 2020  gn(.            
-0002eb50: 2020 2020 2a2a 5f65 7874 7261 6374 5f6d      **_extract_m
-0002eb60: 6574 6128 7b6b 3a20 6b77 6172 6773 5b6b  eta({k: kwargs[k
-0002eb70: 5d7d 2c20 6e6f 6e65 6d70 7479 3d54 7275  ]}, nonempty=Tru
-0002eb80: 6529 0a20 2020 2020 2020 2020 2020 2029  e).            )
-0002eb90: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-0002eba0: 6120 3d20 656c 656d 7769 7365 286d 6574  a = elemwise(met
-0002ebb0: 686f 6473 2e61 7373 6967 6e2c 2064 6174  hods.assign, dat
-0002ebc0: 612c 202a 7061 6972 732c 206d 6574 613d  a, *pairs, meta=
-0002ebd0: 6466 3229 0a0a 2020 2020 2020 2020 7265  df2)..        re
-0002ebe0: 7475 726e 2064 6174 610a 0a20 2020 2040  turn data..    @
-0002ebf0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0002ec00: 4461 7461 4672 616d 652c 2075 615f 6172  DataFrame, ua_ar
-0002ec10: 6773 3d5b 2269 6e64 6578 225d 290a 2020  gs=["index"]).  
-0002ec20: 2020 6465 6620 7265 6e61 6d65 2873 656c    def rename(sel
-0002ec30: 662c 2069 6e64 6578 3d4e 6f6e 652c 2063  f, index=None, c
-0002ec40: 6f6c 756d 6e73 3d4e 6f6e 6529 3a0a 2020  olumns=None):.  
-0002ec50: 2020 2020 2020 6966 2069 6e64 6578 2069        if index i
-0002ec60: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0002ec70: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002ec80: 6c75 6545 7272 6f72 2822 4361 6e6e 6f74  lueError("Cannot
-0002ec90: 2072 656e 616d 6520 696e 6465 782e 2229   rename index.")
-0002eca0: 0a0a 2020 2020 2020 2020 2320 2a61 7267  ..        # *arg
-0002ecb0: 7320 6865 7265 2069 7320 696e 6465 782c  s here is index,
-0002ecc0: 2063 6f6c 756d 6e73 2062 7574 2063 6f6c   columns but col
-0002ecd0: 756d 6e73 2061 7267 2069 7320 616c 7265  umns arg is alre
-0002ece0: 6164 7920 7573 6564 0a20 2020 2020 2020  ady used.       
-0002ecf0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-0002ed00: 5f70 6172 7469 7469 6f6e 7328 4d2e 7265  _partitions(M.re
-0002ed10: 6e61 6d65 2c20 4e6f 6e65 2c20 636f 6c75  name, None, colu
-0002ed20: 6d6e 733d 636f 6c75 6d6e 7329 0a0a 2020  mns=columns)..  
-0002ed30: 2020 6465 6620 7175 6572 7928 7365 6c66    def query(self
-0002ed40: 2c20 6578 7072 2c20 2a2a 6b77 6172 6773  , expr, **kwargs
-0002ed50: 293a 0a20 2020 2020 2020 2022 2222 4669  ):.        """Fi
-0002ed60: 6c74 6572 2064 6174 6166 7261 6d65 2077  lter dataframe w
-0002ed70: 6974 6820 636f 6d70 6c65 7820 6578 7072  ith complex expr
-0002ed80: 6573 7369 6f6e 0a0a 2020 2020 2020 2020  ession..        
-0002ed90: 426c 6f63 6b65 6420 7665 7273 696f 6e20  Blocked version 
-0002eda0: 6f66 2070 642e 4461 7461 4672 616d 652e  of pd.DataFrame.
-0002edb0: 7175 6572 790a 0a20 2020 2020 2020 2050  query..        P
-0002edc0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-0002edd0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0002ede0: 2020 2020 2065 7870 723a 2073 7472 0a20       expr: str. 
-0002edf0: 2020 2020 2020 2020 2020 2054 6865 2071             The q
-0002ee00: 7565 7279 2073 7472 696e 6720 746f 2065  uery string to e
-0002ee10: 7661 6c75 6174 652e 0a20 2020 2020 2020  valuate..       
-0002ee20: 2020 2020 2059 6f75 2063 616e 2072 6566       You can ref
-0002ee30: 6572 2074 6f20 636f 6c75 6d6e 206e 616d  er to column nam
-0002ee40: 6573 2074 6861 7420 6172 6520 6e6f 7420  es that are not 
-0002ee50: 7661 6c69 6420 5079 7468 6f6e 2076 6172  valid Python var
-0002ee60: 6961 626c 6520 6e61 6d65 730a 2020 2020  iable names.    
-0002ee70: 2020 2020 2020 2020 6279 2073 7572 726f          by surro
-0002ee80: 756e 6469 6e67 2074 6865 6d20 696e 2062  unding them in b
-0002ee90: 6163 6b74 6963 6b73 2e0a 2020 2020 2020  ackticks..      
-0002eea0: 2020 2020 2020 4461 736b 2064 6f65 7320        Dask does 
-0002eeb0: 6e6f 7420 6675 6c6c 7920 7375 7070 6f72  not fully suppor
-0002eec0: 7420 7265 6665 7272 696e 6720 746f 2076  t referring to v
-0002eed0: 6172 6961 626c 6573 2075 7369 6e67 2074  ariables using t
-0002eee0: 6865 2027 4027 2063 6861 7261 6374 6572  he '@' character
-0002eef0: 2c0a 2020 2020 2020 2020 2020 2020 7573  ,.            us
-0002ef00: 6520 662d 7374 7269 6e67 7320 6f72 2074  e f-strings or t
-0002ef10: 6865 2060 606c 6f63 616c 5f64 6963 7460  he ``local_dict`
-0002ef20: 6020 6b65 7977 6f72 6420 6172 6775 6d65  ` keyword argume
-0002ef30: 6e74 2069 6e73 7465 6164 2e0a 0a20 2020  nt instead...   
-0002ef40: 2020 2020 204e 6f74 6573 0a20 2020 2020       Notes.     
-0002ef50: 2020 202d 2d2d 2d2d 0a20 2020 2020 2020     -----.       
-0002ef60: 2054 6869 7320 6973 206c 696b 6520 7468   This is like th
-0002ef70: 6520 7365 7175 656e 7469 616c 2076 6572  e sequential ver
-0002ef80: 7369 6f6e 2065 7863 6570 7420 7468 6174  sion except that
-0002ef90: 2074 6869 7320 7769 6c6c 2061 6c73 6f20   this will also 
-0002efa0: 6861 7070 656e 0a20 2020 2020 2020 2069  happen.        i
-0002efb0: 6e20 6d61 6e79 2074 6872 6561 6473 2e20  n many threads. 
-0002efc0: 2054 6869 7320 6d61 7920 636f 6e66 6c69   This may confli
-0002efd0: 6374 2077 6974 6820 6060 6e75 6d65 7870  ct with ``numexp
-0002efe0: 7260 6020 7768 6963 6820 7769 6c6c 2075  r`` which will u
-0002eff0: 7365 0a20 2020 2020 2020 206d 756c 7469  se.        multi
-0002f000: 706c 6520 7468 7265 6164 7320 6974 7365  ple threads itse
-0002f010: 6c66 2e20 2057 6520 7265 636f 6d6d 656e  lf.  We recommen
-0002f020: 6420 7468 6174 2079 6f75 2073 6574 2060  d that you set `
-0002f030: 606e 756d 6578 7072 6060 2074 6f20 7573  `numexpr`` to us
-0002f040: 6520 610a 2020 2020 2020 2020 7369 6e67  e a.        sing
-0002f050: 6c65 2074 6872 6561 643a 0a0a 2020 2020  le thread:..    
-0002f060: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
-0002f070: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
-0002f080: 2020 2020 2020 2020 696d 706f 7274 206e          import n
-0002f090: 756d 6578 7072 0a20 2020 2020 2020 2020  umexpr.         
-0002f0a0: 2020 206e 756d 6578 7072 2e73 6574 5f6e     numexpr.set_n
-0002f0b0: 756d 5f74 6872 6561 6473 2831 290a 0a20  um_threads(1).. 
-0002f0c0: 2020 2020 2020 2053 6565 2061 6c73 6f0a         See also.
-0002f0d0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002f0e0: 0a20 2020 2020 2020 2070 616e 6461 732e  .        pandas.
-0002f0f0: 4461 7461 4672 616d 652e 7175 6572 790a  DataFrame.query.
-0002f100: 2020 2020 2020 2020 7061 6e64 6173 2e65          pandas.e
-0002f110: 7661 6c0a 0a20 2020 2020 2020 2045 7861  val..        Exa
-0002f120: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
-0002f130: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
-0002f140: 3e3e 2069 6d70 6f72 7420 7061 6e64 6173  >> import pandas
-0002f150: 2061 7320 7064 0a20 2020 2020 2020 203e   as pd.        >
-0002f160: 3e3e 2069 6d70 6f72 7420 6461 736b 2e64  >> import dask.d
-0002f170: 6174 6166 7261 6d65 2061 7320 6464 0a20  ataframe as dd. 
-0002f180: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0002f190: 7064 2e44 6174 6146 7261 6d65 287b 2778  pd.DataFrame({'x
-0002f1a0: 273a 205b 312c 2032 2c20 312c 2032 5d2c  ': [1, 2, 1, 2],
-0002f1b0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0002f1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f1d0: 2779 273a 205b 312c 2032 2c20 332c 2034  'y': [1, 2, 3, 4
-0002f1e0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-0002f1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f200: 2020 277a 207a 273a 205b 342c 2033 2c20    'z z': [4, 3, 
-0002f210: 322c 2031 5d7d 290a 2020 2020 2020 2020  2, 1]}).        
-0002f220: 3e3e 3e20 6464 6620 3d20 6464 2e66 726f  >>> ddf = dd.fro
-0002f230: 6d5f 7061 6e64 6173 2864 662c 206e 7061  m_pandas(df, npa
-0002f240: 7274 6974 696f 6e73 3d32 290a 0a20 2020  rtitions=2)..   
-0002f250: 2020 2020 2052 6566 6572 2074 6f20 636f       Refer to co
-0002f260: 6c75 6d6e 206e 616d 6573 2064 6972 6563  lumn names direc
-0002f270: 746c 793a 0a0a 2020 2020 2020 2020 3e3e  tly:..        >>
-0002f280: 3e20 6464 662e 7175 6572 7928 2779 203e  > ddf.query('y >
-0002f290: 2078 2729 2e63 6f6d 7075 7465 2829 0a20   x').compute(). 
-0002f2a0: 2020 2020 2020 2020 2020 7820 2079 2020            x  y  
-0002f2b0: 7a20 7a0a 2020 2020 2020 2020 3220 2031  z z.        2  1
-0002f2c0: 2020 3320 2020 2032 0a20 2020 2020 2020    3    2.       
-0002f2d0: 2033 2020 3220 2034 2020 2020 310a 0a20   3  2  4    1.. 
-0002f2e0: 2020 2020 2020 2052 6566 6572 2074 6f20         Refer to 
-0002f2f0: 636f 6c75 6d6e 206e 616d 6520 7573 696e  column name usin
-0002f300: 6720 6261 636b 7469 636b 733a 0a0a 2020  g backticks:..  
-0002f310: 2020 2020 2020 3e3e 3e20 6464 662e 7175        >>> ddf.qu
-0002f320: 6572 7928 2760 7a20 7a60 203e 2078 2729  ery('`z z` > x')
-0002f330: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
-0002f340: 2020 2020 2020 7820 2079 2020 7a20 7a0a        x  y  z z.
-0002f350: 2020 2020 2020 2020 3020 2031 2020 3120          0  1  1 
-0002f360: 2020 2034 0a20 2020 2020 2020 2031 2020     4.        1  
-0002f370: 3220 2032 2020 2020 330a 2020 2020 2020  2  2    3.      
-0002f380: 2020 3220 2031 2020 3320 2020 2032 0a0a    2  1  3    2..
-0002f390: 2020 2020 2020 2020 5265 6665 7220 746f          Refer to
-0002f3a0: 2076 6172 6961 626c 6520 6e61 6d65 2075   variable name u
-0002f3b0: 7369 6e67 2066 2d73 7472 696e 6773 3a0a  sing f-strings:.
-0002f3c0: 0a20 2020 2020 2020 203e 3e3e 2076 616c  .        >>> val
-0002f3d0: 7565 203d 2031 0a20 2020 2020 2020 203e  ue = 1.        >
-0002f3e0: 3e3e 2064 6466 2e71 7565 7279 2866 2778  >> ddf.query(f'x
-0002f3f0: 203d 3d20 7b76 616c 7565 7d27 292e 636f   == {value}').co
-0002f400: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
-0002f410: 2020 2078 2020 7920 207a 207a 0a20 2020     x  y  z z.   
-0002f420: 2020 2020 2030 2020 3120 2031 2020 2020       0  1  1    
-0002f430: 340a 2020 2020 2020 2020 3220 2031 2020  4.        2  1  
-0002f440: 3320 2020 2032 0a0a 2020 2020 2020 2020  3    2..        
-0002f450: 5265 6665 7220 746f 2076 6172 6961 626c  Refer to variabl
-0002f460: 6520 6e61 6d65 2075 7369 6e67 2060 606c  e name using ``l
-0002f470: 6f63 616c 5f64 6963 7460 603a 0a0a 2020  ocal_dict``:..  
-0002f480: 2020 2020 2020 3e3e 3e20 6464 662e 7175        >>> ddf.qu
-0002f490: 6572 7928 2778 203d 3d20 4076 616c 7565  ery('x == @value
-0002f4a0: 272c 206c 6f63 616c 5f64 6963 743d 7b22  ', local_dict={"
-0002f4b0: 7661 6c75 6522 3a20 7661 6c75 657d 292e  value": value}).
-0002f4c0: 636f 6d70 7574 6528 290a 2020 2020 2020  compute().      
-0002f4d0: 2020 2020 2078 2020 7920 207a 207a 0a20       x  y  z z. 
-0002f4e0: 2020 2020 2020 2030 2020 3120 2031 2020         0  1  1  
-0002f4f0: 2020 340a 2020 2020 2020 2020 3220 2031    4.        2  1
-0002f500: 2020 3320 2020 2032 0a20 2020 2020 2020    3    2.       
-0002f510: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-0002f520: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
-0002f530: 7469 7469 6f6e 7328 4d2e 7175 6572 792c  titions(M.query,
-0002f540: 2065 7870 722c 202a 2a6b 7761 7267 7329   expr, **kwargs)
-0002f550: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0002f560: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0002f570: 290a 2020 2020 6465 6620 6576 616c 2873  ).    def eval(s
-0002f580: 656c 662c 2065 7870 722c 2069 6e70 6c61  elf, expr, inpla
-0002f590: 6365 3d4e 6f6e 652c 202a 2a6b 7761 7267  ce=None, **kwarg
-0002f5a0: 7329 3a0a 2020 2020 2020 2020 6966 2069  s):.        if i
-0002f5b0: 6e70 6c61 6365 2069 7320 4e6f 6e65 3a0a  nplace is None:.
-0002f5c0: 2020 2020 2020 2020 2020 2020 696e 706c              inpl
-0002f5d0: 6163 6520 3d20 4661 6c73 650a 2020 2020  ace = False.    
-0002f5e0: 2020 2020 6966 2022 3d22 2069 6e20 6578      if "=" in ex
-0002f5f0: 7072 2061 6e64 2069 6e70 6c61 6365 2069  pr and inplace i
-0002f600: 6e20 2854 7275 652c 204e 6f6e 6529 3a0a  n (True, None):.
-0002f610: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0002f620: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-0002f630: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0002f640: 2020 2020 2020 2022 496e 706c 6163 6520         "Inplace 
-0002f650: 6576 616c 206e 6f74 2073 7570 706f 7274  eval not support
-0002f660: 6564 2e20 506c 6561 7365 2075 7365 2069  ed. Please use i
-0002f670: 6e70 6c61 6365 3d46 616c 7365 220a 2020  nplace=False".  
-0002f680: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0002f690: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
-0002f6a0: 5f6d 6574 612e 6576 616c 2865 7870 722c  _meta.eval(expr,
-0002f6b0: 2069 6e70 6c61 6365 3d69 6e70 6c61 6365   inplace=inplace
-0002f6c0: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
-0002f6d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0002f6e0: 6d61 705f 7061 7274 6974 696f 6e73 284d  map_partitions(M
-0002f6f0: 2e65 7661 6c2c 2065 7870 722c 206d 6574  .eval, expr, met
-0002f700: 613d 6d65 7461 2c20 696e 706c 6163 653d  a=meta, inplace=
-0002f710: 696e 706c 6163 652c 202a 2a6b 7761 7267  inplace, **kwarg
-0002f720: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
-0002f730: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0002f740: 6d65 290a 2020 2020 6465 6620 6472 6f70  me).    def drop
-0002f750: 6e61 2873 656c 662c 2068 6f77 3d6e 6f5f  na(self, how=no_
-0002f760: 6465 6661 756c 742c 2073 7562 7365 743d  default, subset=
-0002f770: 4e6f 6e65 2c20 7468 7265 7368 3d6e 6f5f  None, thresh=no_
-0002f780: 6465 6661 756c 7429 3a0a 2020 2020 2020  default):.      
-0002f790: 2020 2320 5468 6573 6520 6b65 7977 6f72    # These keywor
-0002f7a0: 6473 2061 7265 2069 6e63 6f6d 7061 7469  ds are incompati
-0002f7b0: 626c 6520 7769 7468 2065 6163 6820 6f74  ble with each ot
-0002f7c0: 6865 722e 0a20 2020 2020 2020 2023 2044  her..        # D
-0002f7d0: 6f6e 2774 2061 6c6c 6f77 2074 6865 6d20  on't allow them 
-0002f7e0: 626f 7468 2074 6f20 6265 2073 6574 2e0a  both to be set..
-0002f7f0: 2020 2020 2020 2020 6966 2068 6f77 2069          if how i
-0002f800: 7320 6e6f 7420 6e6f 5f64 6566 6175 6c74  s not no_default
-0002f810: 2061 6e64 2074 6872 6573 6820 6973 206e   and thresh is n
-0002f820: 6f74 206e 6f5f 6465 6661 756c 743a 0a20  ot no_default:. 
-0002f830: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0002f840: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
-0002f850: 2020 2020 2020 2020 2020 2020 2259 6f75              "You
-0002f860: 2063 616e 6e6f 7420 7365 7420 626f 7468   cannot set both
-0002f870: 2074 6865 2068 6f77 2061 6e64 2074 6872   the how and thr
-0002f880: 6573 6820 6172 6775 6d65 6e74 7320 6174  esh arguments at
-0002f890: 2074 6865 2073 616d 6520 7469 6d65 2e22   the same time."
-0002f8a0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0002f8b0: 2020 2020 2020 2020 2320 4f6e 6c79 2073          # Only s
-0002f8c0: 7065 6369 6679 2060 686f 7760 206f 7220  pecify `how` or 
-0002f8d0: 6074 6872 6573 6860 206b 6579 776f 7264  `thresh` keyword
-0002f8e0: 2069 6620 7370 6563 6966 6965 6420 6279   if specified by
-0002f8f0: 2074 6865 2075 7365 720a 2020 2020 2020   the user.      
-0002f900: 2020 2320 736f 2077 6520 7574 696c 697a    # so we utiliz
-0002f910: 6520 6f74 6865 7220 6064 726f 706e 6160  e other `dropna`
-0002f920: 206b 6579 776f 7264 2064 6566 6175 6c74   keyword default
-0002f930: 7320 6170 7072 6f70 7269 6174 656c 790a  s appropriately.
-0002f940: 2020 2020 2020 2020 6b77 6172 6773 203d          kwargs =
-0002f950: 207b 2273 7562 7365 7422 3a20 7375 6273   {"subset": subs
-0002f960: 6574 7d0a 2020 2020 2020 2020 6966 2068  et}.        if h
-0002f970: 6f77 2069 7320 6e6f 7420 6e6f 5f64 6566  ow is not no_def
-0002f980: 6175 6c74 3a0a 2020 2020 2020 2020 2020  ault:.          
-0002f990: 2020 6b77 6172 6773 5b22 686f 7722 5d20    kwargs["how"] 
-0002f9a0: 3d20 686f 770a 2020 2020 2020 2020 656c  = how.        el
-0002f9b0: 6966 2074 6872 6573 6820 6973 206e 6f74  if thresh is not
-0002f9c0: 206e 6f5f 6465 6661 756c 743a 0a20 2020   no_default:.   
-0002f9d0: 2020 2020 2020 2020 206b 7761 7267 735b           kwargs[
-0002f9e0: 2274 6872 6573 6822 5d20 3d20 7468 7265  "thresh"] = thre
-0002f9f0: 7368 0a0a 2020 2020 2020 2020 7265 7475  sh..        retu
-0002fa00: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-0002fa10: 6974 696f 6e73 284d 2e64 726f 706e 612c  itions(M.dropna,
-0002fa20: 202a 2a6b 7761 7267 732c 2065 6e66 6f72   **kwargs, enfor
-0002fa30: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-0002fa40: 6529 0a0a 2020 2020 4064 6572 6976 6564  e)..    @derived
-0002fa50: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0002fa60: 6d65 290a 2020 2020 6465 6620 636c 6970  me).    def clip
-0002fa70: 2873 656c 662c 206c 6f77 6572 3d4e 6f6e  (self, lower=Non
-0002fa80: 652c 2075 7070 6572 3d4e 6f6e 652c 206f  e, upper=None, o
-0002fa90: 7574 3d4e 6f6e 6529 3a0a 2020 2020 2020  ut=None):.      
-0002faa0: 2020 6966 206f 7574 2069 7320 6e6f 7420    if out is not 
-0002fab0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0002fac0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0002fad0: 6f72 2822 276f 7574 2720 6d75 7374 2062  or("'out' must b
-0002fae0: 6520 4e6f 6e65 2229 0a20 2020 2020 2020  e None").       
-0002faf0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-0002fb00: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-0002fb10: 2020 2020 2020 2020 204d 2e63 6c69 702c           M.clip,
-0002fb20: 206c 6f77 6572 3d6c 6f77 6572 2c20 7570   lower=lower, up
-0002fb30: 7065 723d 7570 7065 722c 2065 6e66 6f72  per=upper, enfor
-0002fb40: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-0002fb50: 650a 2020 2020 2020 2020 290a 0a20 2020  e.        )..   
-0002fb60: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0002fb70: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0002fb80: 2064 6566 2063 6c69 705f 6c6f 7765 7228   def clip_lower(
-0002fb90: 7365 6c66 2c20 7468 7265 7368 6f6c 6429  self, threshold)
-0002fba0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0002fbb0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-0002fbc0: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
-0002fbd0: 2020 4d2e 636c 6970 5f6c 6f77 6572 2c20    M.clip_lower, 
-0002fbe0: 7468 7265 7368 6f6c 643d 7468 7265 7368  threshold=thresh
-0002fbf0: 6f6c 642c 2065 6e66 6f72 6365 5f6d 6574  old, enforce_met
-0002fc00: 6164 6174 613d 4661 6c73 650a 2020 2020  adata=False.    
-0002fc10: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
-0002fc20: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0002fc30: 4672 616d 6529 0a20 2020 2064 6566 2063  Frame).    def c
-0002fc40: 6c69 705f 7570 7065 7228 7365 6c66 2c20  lip_upper(self, 
-0002fc50: 7468 7265 7368 6f6c 6429 3a0a 2020 2020  threshold):.    
-0002fc60: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0002fc70: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
-0002fc80: 2020 2020 2020 2020 2020 2020 4d2e 636c              M.cl
-0002fc90: 6970 5f75 7070 6572 2c20 7468 7265 7368  ip_upper, thresh
-0002fca0: 6f6c 643d 7468 7265 7368 6f6c 642c 2065  old=threshold, e
-0002fcb0: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
-0002fcc0: 4661 6c73 650a 2020 2020 2020 2020 290a  False.        ).
-0002fcd0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0002fce0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0002fcf0: 0a20 2020 2064 6566 2073 7175 6565 7a65  .    def squeeze
-0002fd00: 2873 656c 662c 2061 7869 733d 4e6f 6e65  (self, axis=None
-0002fd10: 293a 0a20 2020 2020 2020 2069 6620 6178  ):.        if ax
-0002fd20: 6973 2069 6e20 5b4e 6f6e 652c 2031 5d3a  is in [None, 1]:
-0002fd30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0002fd40: 6c65 6e28 7365 6c66 2e63 6f6c 756d 6e73  len(self.columns
-0002fd50: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
-0002fd60: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002fd70: 656c 665b 7365 6c66 2e63 6f6c 756d 6e73  elf[self.columns
-0002fd80: 5b30 5d5d 0a20 2020 2020 2020 2020 2020  [0]].           
-0002fd90: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0002fda0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0002fdb0: 6c66 0a0a 2020 2020 2020 2020 656c 6966  lf..        elif
-0002fdc0: 2061 7869 7320 3d3d 2030 3a0a 2020 2020   axis == 0:.    
-0002fdd0: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-0002fde0: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-0002fdf0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0002fe00: 2020 2066 227b 7479 7065 2873 656c 6629     f"{type(self)
-0002fe10: 7d20 646f 6573 206e 6f74 2073 7570 706f  } does not suppo
-0002fe20: 7274 2073 7175 6565 7a65 2061 6c6f 6e67  rt squeeze along
-0002fe30: 2061 7869 7320 3022 0a20 2020 2020 2020   axis 0".       
-0002fe40: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0002fe50: 656c 6966 2061 7869 7320 6e6f 7420 696e  elif axis not in
-0002fe60: 205b 302c 2031 2c20 4e6f 6e65 5d3a 0a20   [0, 1, None]:. 
-0002fe70: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0002fe80: 2056 616c 7565 4572 726f 7228 6622 4e6f   ValueError(f"No
-0002fe90: 2061 7869 7320 7b61 7869 737d 2066 6f72   axis {axis} for
-0002fea0: 206f 626a 6563 7420 7479 7065 207b 7479   object type {ty
-0002feb0: 7065 2873 656c 6629 7d22 290a 0a20 2020  pe(self)}")..   
-0002fec0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0002fed0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0002fee0: 2064 6566 2074 6f5f 7469 6d65 7374 616d   def to_timestam
-0002fef0: 7028 7365 6c66 2c20 6672 6571 3d4e 6f6e  p(self, freq=Non
-0002ff00: 652c 2068 6f77 3d22 7374 6172 7422 2c20  e, how="start", 
-0002ff10: 6178 6973 3d30 293a 0a20 2020 2020 2020  axis=0):.       
-0002ff20: 2064 6620 3d20 656c 656d 7769 7365 284d   df = elemwise(M
-0002ff30: 2e74 6f5f 7469 6d65 7374 616d 702c 2073  .to_timestamp, s
-0002ff40: 656c 662c 2066 7265 712c 2068 6f77 2c20  elf, freq, how, 
-0002ff50: 6178 6973 290a 2020 2020 2020 2020 6466  axis).        df
-0002ff60: 2e64 6976 6973 696f 6e73 203d 2074 7570  .divisions = tup
-0002ff70: 6c65 2870 642e 496e 6465 7828 7365 6c66  le(pd.Index(self
-0002ff80: 2e64 6976 6973 696f 6e73 292e 746f 5f74  .divisions).to_t
-0002ff90: 696d 6573 7461 6d70 2829 290a 2020 2020  imestamp()).    
-0002ffa0: 2020 2020 7265 7475 726e 2064 660a 0a20      return df.. 
-0002ffb0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0002ffc0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0002ffd0: 2020 2064 6566 2065 7870 6c6f 6465 2873     def explode(s
-0002ffe0: 656c 662c 2063 6f6c 756d 6e29 3a0a 2020  elf, column):.  
-0002fff0: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
-00030000: 662e 5f6d 6574 612e 6578 706c 6f64 6528  f._meta.explode(
-00030010: 636f 6c75 6d6e 290a 2020 2020 2020 2020  column).        
-00030020: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-00030030: 7061 7274 6974 696f 6e73 284d 2e65 7870  partitions(M.exp
-00030040: 6c6f 6465 2c20 636f 6c75 6d6e 2c20 6d65  lode, column, me
-00030050: 7461 3d6d 6574 612c 2065 6e66 6f72 6365  ta=meta, enforce
-00030060: 5f6d 6574 6164 6174 613d 4661 6c73 6529  _metadata=False)
-00030070: 0a0a 2020 2020 6465 6620 746f 5f62 6167  ..    def to_bag
-00030080: 2873 656c 662c 2069 6e64 6578 3d46 616c  (self, index=Fal
-00030090: 7365 2c20 666f 726d 6174 3d22 7475 706c  se, format="tupl
-000300a0: 6522 293a 0a20 2020 2020 2020 2022 2222  e"):.        """
-000300b0: 436f 6e76 6572 7420 746f 2061 2064 6173  Convert to a das
-000300c0: 6b20 4261 6720 6f66 2074 7570 6c65 7320  k Bag of tuples 
-000300d0: 6f66 2065 6163 6820 726f 772e 0a0a 2020  of each row...  
-000300e0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-000300f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00030100: 2d2d 2d0a 2020 2020 2020 2020 696e 6465  ---.        inde
-00030110: 7820 3a20 626f 6f6c 2c20 6f70 7469 6f6e  x : bool, option
-00030120: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
-00030130: 6620 5472 7565 2c20 7468 6520 696e 6465  f True, the inde
-00030140: 7820 6973 2069 6e63 6c75 6465 6420 6173  x is included as
-00030150: 2074 6865 2066 6972 7374 2065 6c65 6d65   the first eleme
-00030160: 6e74 206f 6620 6561 6368 2074 7570 6c65  nt of each tuple
-00030170: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
-00030180: 6661 756c 7420 6973 2046 616c 7365 2e0a  fault is False..
-00030190: 2020 2020 2020 2020 666f 726d 6174 203a          format :
-000301a0: 207b 2274 7570 6c65 222c 2022 6469 6374   {"tuple", "dict
-000301b0: 222c 2022 6672 616d 6522 7d2c 206f 7074  ", "frame"}, opt
-000301c0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-000301d0: 2020 5768 6574 6865 7220 746f 2072 6574    Whether to ret
-000301e0: 7572 6e20 6120 6261 6720 6f66 2074 7570  urn a bag of tup
-000301f0: 6c65 732c 2064 6963 7469 6f6e 6172 6965  les, dictionarie
-00030200: 732c 206f 720a 2020 2020 2020 2020 2020  s, or.          
-00030210: 2020 6461 7461 6672 616d 652d 6c69 6b65    dataframe-like
-00030220: 206f 626a 6563 7473 2e20 4465 6661 756c   objects. Defaul
-00030230: 7420 6973 2022 7475 706c 6522 2e20 4966  t is "tuple". If
-00030240: 2022 6672 616d 6522 2c0a 2020 2020 2020   "frame",.      
-00030250: 2020 2020 2020 7468 6520 6f72 6967 696e        the origin
-00030260: 616c 2070 6172 7469 7469 6f6e 7320 6f66  al partitions of
-00030270: 2060 6064 6660 6020 7769 6c6c 206e 6f74   ``df`` will not
-00030280: 2062 6520 7472 616e 7366 6f72 6d65 640a   be transformed.
-00030290: 2020 2020 2020 2020 2020 2020 696e 2061              in a
-000302a0: 6e79 2077 6179 2e0a 2020 2020 2020 2020  ny way..        
-000302b0: 2222 220a 2020 2020 2020 2020 6672 6f6d  """.        from
-000302c0: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
-000302d0: 696f 2069 6d70 6f72 7420 746f 5f62 6167  io import to_bag
-000302e0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000302f0: 2074 6f5f 6261 6728 7365 6c66 2c20 696e   to_bag(self, in
-00030300: 6465 782c 2066 6f72 6d61 7429 0a0a 2020  dex, format)..  
-00030310: 2020 6465 6620 746f 5f70 6172 7175 6574    def to_parquet
-00030320: 2873 656c 662c 2070 6174 682c 202a 6172  (self, path, *ar
-00030330: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-00030340: 2020 2020 2020 2022 2222 5365 6520 6464         """See dd
-00030350: 2e74 6f5f 7061 7271 7565 7420 646f 6373  .to_parquet docs
-00030360: 7472 696e 6720 666f 7220 6d6f 7265 2069  tring for more i
-00030370: 6e66 6f72 6d61 7469 6f6e 2222 220a 2020  nformation""".  
-00030380: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-00030390: 6461 7461 6672 616d 652e 696f 2069 6d70  dataframe.io imp
-000303a0: 6f72 7420 746f 5f70 6172 7175 6574 0a0a  ort to_parquet..
-000303b0: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-000303c0: 6f5f 7061 7271 7565 7428 7365 6c66 2c20  o_parquet(self, 
-000303d0: 7061 7468 2c20 2a61 7267 732c 202a 2a6b  path, *args, **k
-000303e0: 7761 7267 7329 0a0a 2020 2020 6465 6620  wargs)..    def 
-000303f0: 746f 5f6f 7263 2873 656c 662c 2070 6174  to_orc(self, pat
-00030400: 682c 202a 6172 6773 2c20 2a2a 6b77 6172  h, *args, **kwar
-00030410: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-00030420: 5365 6520 6464 2e74 6f5f 6f72 6320 646f  See dd.to_orc do
-00030430: 6373 7472 696e 6720 666f 7220 6d6f 7265  cstring for more
-00030440: 2069 6e66 6f72 6d61 7469 6f6e 2222 220a   information""".
-00030450: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00030460: 6b2e 6461 7461 6672 616d 652e 696f 2069  k.dataframe.io i
-00030470: 6d70 6f72 7420 746f 5f6f 7263 0a0a 2020  mport to_orc..  
-00030480: 2020 2020 2020 7265 7475 726e 2074 6f5f        return to_
-00030490: 6f72 6328 7365 6c66 2c20 7061 7468 2c20  orc(self, path, 
-000304a0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-000304b0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-000304c0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-000304d0: 290a 2020 2020 6465 6620 746f 5f73 7472  ).    def to_str
-000304e0: 696e 6728 7365 6c66 2c20 6d61 785f 726f  ing(self, max_ro
-000304f0: 7773 3d35 293a 0a20 2020 2020 2020 2023  ws=5):.        #
-00030500: 206f 7074 696f 6e5f 636f 6e74 6578 7420   option_context 
-00030510: 646f 6573 6e27 7420 6166 6665 6374 0a20  doesn't affect. 
-00030520: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00030530: 6c66 2e5f 7265 7072 5f64 6174 6128 292e  lf._repr_data().
-00030540: 746f 5f73 7472 696e 6728 6d61 785f 726f  to_string(max_ro
-00030550: 7773 3d6d 6178 5f72 6f77 732c 2073 686f  ws=max_rows, sho
-00030560: 775f 6469 6d65 6e73 696f 6e73 3d46 616c  w_dimensions=Fal
-00030570: 7365 290a 0a20 2020 2064 6566 205f 6765  se)..    def _ge
-00030580: 745f 6e75 6d65 7269 635f 6461 7461 2873  t_numeric_data(s
-00030590: 656c 662c 2068 6f77 3d22 616e 7922 2c20  elf, how="any", 
-000305a0: 7375 6273 6574 3d4e 6f6e 6529 3a0a 2020  subset=None):.  
-000305b0: 2020 2020 2020 2320 6361 6c63 756c 6174        # calculat
-000305c0: 6520 636f 6c75 6d6e 7320 746f 2061 766f  e columns to avo
-000305d0: 6964 2075 6e6e 6563 6573 7361 7279 2063  id unnecessary c
-000305e0: 616c 6375 6c61 7469 6f6e 0a20 2020 2020  alculation.     
-000305f0: 2020 206e 756d 6572 6963 7320 3d20 7365     numerics = se
-00030600: 6c66 2e5f 6d65 7461 2e5f 6765 745f 6e75  lf._meta._get_nu
-00030610: 6d65 7269 635f 6461 7461 2829 0a0a 2020  meric_data()..  
-00030620: 2020 2020 2020 6966 206c 656e 286e 756d        if len(num
-00030630: 6572 6963 732e 636f 6c75 6d6e 7329 203c  erics.columns) <
-00030640: 206c 656e 2873 656c 662e 636f 6c75 6d6e   len(self.column
-00030650: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00030660: 6e61 6d65 203d 2073 656c 662e 5f74 6f6b  name = self._tok
-00030670: 656e 5f70 7265 6669 7820 2b20 222d 6765  en_prefix + "-ge
-00030680: 745f 6e75 6d65 7269 635f 6461 7461 220a  t_numeric_data".
-00030690: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000306a0: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-000306b0: 6974 696f 6e73 284d 2e5f 6765 745f 6e75  itions(M._get_nu
-000306c0: 6d65 7269 635f 6461 7461 2c20 6d65 7461  meric_data, meta
-000306d0: 3d6e 756d 6572 6963 732c 2074 6f6b 656e  =numerics, token
-000306e0: 3d6e 616d 6529 0a20 2020 2020 2020 2065  =name).        e
-000306f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00030700: 2023 2075 7365 206d 7973 656c 6620 6966   # use myself if
-00030710: 2061 6c6c 206e 756d 6572 6963 730a 2020   all numerics.  
-00030720: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00030730: 2073 656c 660a 0a20 2020 2040 636c 6173   self..    @clas
-00030740: 736d 6574 686f 640a 2020 2020 6465 6620  smethod.    def 
-00030750: 5f76 616c 6964 6174 655f 6178 6973 2863  _validate_axis(c
-00030760: 6c73 2c20 6178 6973 3d30 2c20 6e6f 6e65  ls, axis=0, none
-00030770: 5f69 735f 7a65 726f 3a20 626f 6f6c 203d  _is_zero: bool =
-00030780: 2054 7275 6529 202d 3e20 4e6f 6e65 207c   True) -> None |
-00030790: 204c 6974 6572 616c 5b30 2c20 315d 3a0a   Literal[0, 1]:.
-000307a0: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-000307b0: 6e6f 7420 696e 2028 302c 2031 2c20 2269  not in (0, 1, "i
-000307c0: 6e64 6578 222c 2022 636f 6c75 6d6e 7322  ndex", "columns"
-000307d0: 2c20 4e6f 6e65 293a 0a20 2020 2020 2020  , None):.       
-000307e0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000307f0: 4572 726f 7228 6622 4e6f 2061 7869 7320  Error(f"No axis 
-00030800: 6e61 6d65 6420 7b61 7869 737d 2229 0a20  named {axis}"). 
-00030810: 2020 2020 2020 2023 2063 6f6e 7665 7274         # convert
-00030820: 2074 6f20 6e75 6d65 7269 6320 6178 6973   to numeric axis
-00030830: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
-00030840: 5f61 7869 733a 2064 6963 745b 7374 7220  _axis: dict[str 
-00030850: 7c20 4e6f 6e65 2c20 4c69 7465 7261 6c5b  | None, Literal[
-00030860: 302c 2031 5d5d 203d 207b 2269 6e64 6578  0, 1]] = {"index
-00030870: 223a 2030 2c20 2263 6f6c 756d 6e73 223a  ": 0, "columns":
-00030880: 2031 7d0a 2020 2020 2020 2020 6966 206e   1}.        if n
-00030890: 6f6e 655f 6973 5f7a 6572 6f3a 0a20 2020  one_is_zero:.   
-000308a0: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
-000308b0: 5f61 7869 735b 4e6f 6e65 5d20 3d20 300a  _axis[None] = 0.
-000308c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000308d0: 6e75 6d65 7269 635f 6178 6973 2e67 6574  numeric_axis.get
-000308e0: 2861 7869 732c 2061 7869 7329 0a0a 2020  (axis, axis)..  
-000308f0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00030900: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00030910: 2020 6465 6620 6472 6f70 2873 656c 662c    def drop(self,
-00030920: 206c 6162 656c 733d 4e6f 6e65 2c20 6178   labels=None, ax
-00030930: 6973 3d30 2c20 636f 6c75 6d6e 733d 4e6f  is=0, columns=No
-00030940: 6e65 2c20 6572 726f 7273 3d22 7261 6973  ne, errors="rais
-00030950: 6522 293a 0a20 2020 2020 2020 2061 7869  e"):.        axi
-00030960: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
-00030970: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
-00030980: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
-00030990: 2030 2061 6e64 2063 6f6c 756d 6e73 2069   0 and columns i
-000309a0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-000309b0: 2020 2020 2020 2020 2320 436f 6c75 6d6e          # Column
-000309c0: 7320 6d75 7374 2062 6520 7370 6563 6966  s must be specif
-000309d0: 6965 6420 6966 2061 7869 733d 3d30 0a20  ied if axis==0. 
-000309e0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000309f0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
-00030a00: 7469 6f6e 7328 6472 6f70 5f62 795f 7368  tions(drop_by_sh
-00030a10: 616c 6c6f 775f 636f 7079 2c20 636f 6c75  allow_copy, colu
-00030a20: 6d6e 732c 2065 7272 6f72 733d 6572 726f  mns, errors=erro
-00030a30: 7273 290a 2020 2020 2020 2020 656c 6966  rs).        elif
-00030a40: 2061 7869 7320 3d3d 2031 3a0a 2020 2020   axis == 1:.    
-00030a50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00030a60: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-00030a70: 6e73 2864 726f 705f 6279 5f73 6861 6c6c  ns(drop_by_shall
-00030a80: 6f77 5f63 6f70 792c 206c 6162 656c 732c  ow_copy, labels,
-00030a90: 2065 7272 6f72 733d 6572 726f 7273 290a   errors=errors).
-00030aa0: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-00030ab0: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-00030ac0: 7228 0a20 2020 2020 2020 2020 2020 2022  r(.            "
-00030ad0: 4472 6f70 2063 7572 7265 6e74 6c79 206f  Drop currently o
-00030ae0: 6e6c 7920 776f 726b 7320 666f 7220 6178  nly works for ax
-00030af0: 6973 3d31 206f 7220 7768 656e 2063 6f6c  is=1 or when col
-00030b00: 756d 6e73 2069 7320 6e6f 7420 4e6f 6e65  umns is not None
-00030b10: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
-00030b20: 2064 6566 206d 6572 6765 280a 2020 2020   def merge(.    
-00030b30: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00030b40: 2020 7269 6768 742c 0a20 2020 2020 2020    right,.       
-00030b50: 2068 6f77 3d22 696e 6e65 7222 2c0a 2020   how="inner",.  
-00030b60: 2020 2020 2020 6f6e 3d4e 6f6e 652c 0a20        on=None,. 
-00030b70: 2020 2020 2020 206c 6566 745f 6f6e 3d4e         left_on=N
-00030b80: 6f6e 652c 0a20 2020 2020 2020 2072 6967  one,.        rig
-00030b90: 6874 5f6f 6e3d 4e6f 6e65 2c0a 2020 2020  ht_on=None,.    
-00030ba0: 2020 2020 6c65 6674 5f69 6e64 6578 3d46      left_index=F
-00030bb0: 616c 7365 2c0a 2020 2020 2020 2020 7269  alse,.        ri
-00030bc0: 6768 745f 696e 6465 783d 4661 6c73 652c  ght_index=False,
-00030bd0: 0a20 2020 2020 2020 2073 7566 6669 7865  .        suffixe
-00030be0: 733d 2822 5f78 222c 2022 5f79 2229 2c0a  s=("_x", "_y"),.
-00030bf0: 2020 2020 2020 2020 696e 6469 6361 746f          indicato
-00030c00: 723d 4661 6c73 652c 0a20 2020 2020 2020  r=False,.       
-00030c10: 206e 7061 7274 6974 696f 6e73 3d4e 6f6e   npartitions=Non
-00030c20: 652c 0a20 2020 2020 2020 2073 6875 6666  e,.        shuff
-00030c30: 6c65 3d4e 6f6e 652c 0a20 2020 2020 2020  le=None,.       
-00030c40: 2062 726f 6164 6361 7374 3d4e 6f6e 652c   broadcast=None,
-00030c50: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00030c60: 2222 224d 6572 6765 2074 6865 2044 6174  """Merge the Dat
-00030c70: 6146 7261 6d65 2077 6974 6820 616e 6f74  aFrame with anot
-00030c80: 6865 7220 4461 7461 4672 616d 650a 0a20  her DataFrame.. 
-00030c90: 2020 2020 2020 2054 6869 7320 7769 6c6c         This will
-00030ca0: 206d 6572 6765 2074 6865 2074 776f 2064   merge the two d
-00030cb0: 6174 6173 6574 732c 2065 6974 6865 7220  atasets, either 
-00030cc0: 6f6e 2074 6865 2069 6e64 6963 6573 2c20  on the indices, 
-00030cd0: 6120 6365 7274 6169 6e20 636f 6c75 6d6e  a certain column
-00030ce0: 0a20 2020 2020 2020 2069 6e20 6561 6368  .        in each
-00030cf0: 2064 6174 6173 6574 206f 7220 7468 6520   dataset or the 
-00030d00: 696e 6465 7820 696e 206f 6e65 2064 6174  index in one dat
-00030d10: 6173 6574 2061 6e64 2074 6865 2063 6f6c  aset and the col
-00030d20: 756d 6e20 696e 2061 6e6f 7468 6572 2e0a  umn in another..
-00030d30: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00030d40: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00030d50: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2072  ------.        r
-00030d60: 6967 6874 3a20 6461 736b 2e64 6174 6166  ight: dask.dataf
-00030d70: 7261 6d65 2e44 6174 6146 7261 6d65 0a20  rame.DataFrame. 
-00030d80: 2020 2020 2020 2068 6f77 203a 207b 276c         how : {'l
-00030d90: 6566 7427 2c20 2772 6967 6874 272c 2027  eft', 'right', '
-00030da0: 6f75 7465 7227 2c20 2769 6e6e 6572 277d  outer', 'inner'}
-00030db0: 2c20 6465 6661 756c 743a 2027 696e 6e65  , default: 'inne
-00030dc0: 7227 0a20 2020 2020 2020 2020 2020 2048  r'.            H
-00030dd0: 6f77 2074 6f20 6861 6e64 6c65 2074 6865  ow to handle the
-00030de0: 206f 7065 7261 7469 6f6e 206f 6620 7468   operation of th
-00030df0: 6520 7477 6f20 6f62 6a65 6374 733a 0a0a  e two objects:..
-00030e00: 2020 2020 2020 2020 2020 2020 2d20 6c65              - le
-00030e10: 6674 3a20 7573 6520 6361 6c6c 696e 6720  ft: use calling 
-00030e20: 6672 616d 6527 7320 696e 6465 7820 286f  frame's index (o
-00030e30: 7220 636f 6c75 6d6e 2069 6620 6f6e 2069  r column if on i
-00030e40: 7320 7370 6563 6966 6965 6429 0a20 2020  s specified).   
-00030e50: 2020 2020 2020 2020 202d 2072 6967 6874           - right
-00030e60: 3a20 7573 6520 6f74 6865 7220 6672 616d  : use other fram
-00030e70: 6527 7320 696e 6465 780a 2020 2020 2020  e's index.      
-00030e80: 2020 2020 2020 2d20 6f75 7465 723a 2066        - outer: f
-00030e90: 6f72 6d20 756e 696f 6e20 6f66 2063 616c  orm union of cal
-00030ea0: 6c69 6e67 2066 7261 6d65 2773 2069 6e64  ling frame's ind
-00030eb0: 6578 2028 6f72 2063 6f6c 756d 6e20 6966  ex (or column if
-00030ec0: 206f 6e20 6973 0a20 2020 2020 2020 2020   on is.         
-00030ed0: 2020 2020 2073 7065 6369 6669 6564 2920       specified) 
-00030ee0: 7769 7468 206f 7468 6572 2066 7261 6d65  with other frame
-00030ef0: 2773 2069 6e64 6578 2c20 616e 6420 736f  's index, and so
-00030f00: 7274 2069 740a 2020 2020 2020 2020 2020  rt it.          
-00030f10: 2020 2020 6c65 7869 636f 6772 6170 6869      lexicographi
-00030f20: 6361 6c6c 790a 2020 2020 2020 2020 2020  cally.          
-00030f30: 2020 2d20 696e 6e65 723a 2066 6f72 6d20    - inner: form 
-00030f40: 696e 7465 7273 6563 7469 6f6e 206f 6620  intersection of 
-00030f50: 6361 6c6c 696e 6720 6672 616d 6527 7320  calling frame's 
-00030f60: 696e 6465 7820 286f 7220 636f 6c75 6d6e  index (or column
-00030f70: 2069 660a 2020 2020 2020 2020 2020 2020   if.            
-00030f80: 2020 6f6e 2069 7320 7370 6563 6966 6965    on is specifie
-00030f90: 6429 2077 6974 6820 6f74 6865 7220 6672  d) with other fr
-00030fa0: 616d 6527 7320 696e 6465 782c 2070 7265  ame's index, pre
-00030fb0: 7365 7276 696e 6720 7468 6520 6f72 6465  serving the orde
-00030fc0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-00030fd0: 6f66 2074 6865 2063 616c 6c69 6e67 2773  of the calling's
-00030fe0: 206f 6e65 0a0a 2020 2020 2020 2020 6f6e   one..        on
-00030ff0: 203a 206c 6162 656c 206f 7220 6c69 7374   : label or list
-00031000: 0a20 2020 2020 2020 2020 2020 2043 6f6c  .            Col
-00031010: 756d 6e20 6f72 2069 6e64 6578 206c 6576  umn or index lev
-00031020: 656c 206e 616d 6573 2074 6f20 6a6f 696e  el names to join
-00031030: 206f 6e2e 2054 6865 7365 206d 7573 7420   on. These must 
-00031040: 6265 2066 6f75 6e64 2069 6e20 626f 7468  be found in both
-00031050: 0a20 2020 2020 2020 2020 2020 2044 6174  .            Dat
-00031060: 6146 7261 6d65 732e 2049 6620 6f6e 2069  aFrames. If on i
-00031070: 7320 4e6f 6e65 2061 6e64 206e 6f74 206d  s None and not m
-00031080: 6572 6769 6e67 206f 6e20 696e 6465 7865  erging on indexe
-00031090: 7320 7468 656e 2074 6869 730a 2020 2020  s then this.    
-000310a0: 2020 2020 2020 2020 6465 6661 756c 7473          defaults
-000310b0: 2074 6f20 7468 6520 696e 7465 7273 6563   to the intersec
-000310c0: 7469 6f6e 206f 6620 7468 6520 636f 6c75  tion of the colu
-000310d0: 6d6e 7320 696e 2062 6f74 6820 4461 7461  mns in both Data
-000310e0: 4672 616d 6573 2e0a 2020 2020 2020 2020  Frames..        
-000310f0: 6c65 6674 5f6f 6e20 3a20 6c61 6265 6c20  left_on : label 
-00031100: 6f72 206c 6973 742c 206f 7220 6172 7261  or list, or arra
-00031110: 792d 6c69 6b65 0a20 2020 2020 2020 2020  y-like.         
-00031120: 2020 2043 6f6c 756d 6e20 746f 206a 6f69     Column to joi
-00031130: 6e20 6f6e 2069 6e20 7468 6520 6c65 6674  n on in the left
-00031140: 2044 6174 6146 7261 6d65 2e20 4f74 6865   DataFrame. Othe
-00031150: 7220 7468 616e 2069 6e20 7061 6e64 6173  r than in pandas
-00031160: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-00031170: 6179 7320 616e 6420 6c69 7374 7320 6172  ays and lists ar
-00031180: 6520 6f6e 6c79 2073 7570 706f 7274 2069  e only support i
-00031190: 6620 7468 6569 7220 6c65 6e67 7468 2069  f their length i
-000311a0: 7320 312e 0a20 2020 2020 2020 2072 6967  s 1..        rig
-000311b0: 6874 5f6f 6e20 3a20 6c61 6265 6c20 6f72  ht_on : label or
-000311c0: 206c 6973 742c 206f 7220 6172 7261 792d   list, or array-
-000311d0: 6c69 6b65 0a20 2020 2020 2020 2020 2020  like.           
-000311e0: 2043 6f6c 756d 6e20 746f 206a 6f69 6e20   Column to join 
-000311f0: 6f6e 2069 6e20 7468 6520 7269 6768 7420  on in the right 
-00031200: 4461 7461 4672 616d 652e 204f 7468 6572  DataFrame. Other
-00031210: 2074 6861 6e20 696e 2070 616e 6461 730a   than in pandas.
-00031220: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-00031230: 7973 2061 6e64 206c 6973 7473 2061 7265  ys and lists are
-00031240: 206f 6e6c 7920 7375 7070 6f72 7420 6966   only support if
-00031250: 2074 6865 6972 206c 656e 6774 6820 6973   their length is
-00031260: 2031 2e0a 2020 2020 2020 2020 6c65 6674   1..        left
-00031270: 5f69 6e64 6578 203a 2062 6f6f 6c65 616e  _index : boolean
-00031280: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
-00031290: 2020 2020 2020 2020 2020 2020 5573 6520              Use 
-000312a0: 7468 6520 696e 6465 7820 6672 6f6d 2074  the index from t
-000312b0: 6865 206c 6566 7420 4461 7461 4672 616d  he left DataFram
-000312c0: 6520 6173 2074 6865 206a 6f69 6e20 6b65  e as the join ke
-000312d0: 792e 0a20 2020 2020 2020 2072 6967 6874  y..        right
-000312e0: 5f69 6e64 6578 203a 2062 6f6f 6c65 616e  _index : boolean
-000312f0: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
-00031300: 2020 2020 2020 2020 2020 2020 5573 6520              Use 
-00031310: 7468 6520 696e 6465 7820 6672 6f6d 2074  the index from t
-00031320: 6865 2072 6967 6874 2044 6174 6146 7261  he right DataFra
-00031330: 6d65 2061 7320 7468 6520 6a6f 696e 206b  me as the join k
-00031340: 6579 2e0a 2020 2020 2020 2020 7375 6666  ey..        suff
-00031350: 6978 6573 203a 2032 2d6c 656e 6774 6820  ixes : 2-length 
-00031360: 7365 7175 656e 6365 2028 7475 706c 652c  sequence (tuple,
-00031370: 206c 6973 742c 202e 2e2e 290a 2020 2020   list, ...).    
-00031380: 2020 2020 2020 2020 5375 6666 6978 2074          Suffix t
-00031390: 6f20 6170 706c 7920 746f 206f 7665 726c  o apply to overl
-000313a0: 6170 7069 6e67 2063 6f6c 756d 6e20 6e61  apping column na
-000313b0: 6d65 7320 696e 2074 6865 206c 6566 7420  mes in the left 
-000313c0: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-000313d0: 7269 6768 7420 7369 6465 2c20 7265 7370  right side, resp
-000313e0: 6563 7469 7665 6c79 0a20 2020 2020 2020  ectively.       
-000313f0: 2069 6e64 6963 6174 6f72 203a 2062 6f6f   indicator : boo
-00031400: 6c65 616e 206f 7220 7374 7269 6e67 2c20  lean or string, 
-00031410: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
-00031420: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
-00031430: 652c 2061 6464 7320 6120 636f 6c75 6d6e  e, adds a column
-00031440: 2074 6f20 6f75 7470 7574 2044 6174 6146   to output DataF
-00031450: 7261 6d65 2063 616c 6c65 6420 225f 6d65  rame called "_me
-00031460: 7267 6522 2077 6974 680a 2020 2020 2020  rge" with.      
-00031470: 2020 2020 2020 696e 666f 726d 6174 696f        informatio
-00031480: 6e20 6f6e 2074 6865 2073 6f75 7263 6520  n on the source 
-00031490: 6f66 2065 6163 6820 726f 772e 2049 6620  of each row. If 
-000314a0: 7374 7269 6e67 2c20 636f 6c75 6d6e 2077  string, column w
-000314b0: 6974 680a 2020 2020 2020 2020 2020 2020  ith.            
-000314c0: 696e 666f 726d 6174 696f 6e20 6f6e 2073  information on s
-000314d0: 6f75 7263 6520 6f66 2065 6163 6820 726f  ource of each ro
-000314e0: 7720 7769 6c6c 2062 6520 6164 6465 6420  w will be added 
-000314f0: 746f 206f 7574 7075 7420 4461 7461 4672  to output DataFr
-00031500: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00031510: 2061 6e64 2063 6f6c 756d 6e20 7769 6c6c   and column will
-00031520: 2062 6520 6e61 6d65 6420 7661 6c75 6520   be named value 
-00031530: 6f66 2073 7472 696e 672e 2049 6e66 6f72  of string. Infor
-00031540: 6d61 7469 6f6e 2063 6f6c 756d 6e20 6973  mation column is
-00031550: 0a20 2020 2020 2020 2020 2020 2043 6174  .            Cat
-00031560: 6567 6f72 6963 616c 2d74 7970 6520 616e  egorical-type an
-00031570: 6420 7461 6b65 7320 6f6e 2061 2076 616c  d takes on a val
-00031580: 7565 206f 6620 226c 6566 745f 6f6e 6c79  ue of "left_only
-00031590: 2220 666f 7220 6f62 7365 7276 6174 696f  " for observatio
-000315a0: 6e73 0a20 2020 2020 2020 2020 2020 2077  ns.            w
-000315b0: 686f 7365 206d 6572 6765 206b 6579 206f  hose merge key o
-000315c0: 6e6c 7920 6170 7065 6172 7320 696e 2060  nly appears in `
-000315d0: 6c65 6674 6020 4461 7461 4672 616d 652c  left` DataFrame,
-000315e0: 2022 7269 6768 745f 6f6e 6c79 2220 666f   "right_only" fo
-000315f0: 720a 2020 2020 2020 2020 2020 2020 6f62  r.            ob
-00031600: 7365 7276 6174 696f 6e73 2077 686f 7365  servations whose
-00031610: 206d 6572 6765 206b 6579 206f 6e6c 7920   merge key only 
-00031620: 6170 7065 6172 7320 696e 2060 7269 6768  appears in `righ
-00031630: 7460 2044 6174 6146 7261 6d65 2c0a 2020  t` DataFrame,.  
-00031640: 2020 2020 2020 2020 2020 616e 6420 2262            and "b
-00031650: 6f74 6822 2069 6620 7468 6520 6f62 7365  oth" if the obse
-00031660: 7276 6174 696f 6ee2 8099 7320 6d65 7267  rvation...s merg
-00031670: 6520 6b65 7920 6973 2066 6f75 6e64 2069  e key is found i
-00031680: 6e20 626f 7468 2e0a 2020 2020 2020 2020  n both..        
-00031690: 6e70 6172 7469 7469 6f6e 733a 2069 6e74  npartitions: int
-000316a0: 206f 7220 4e6f 6e65 2c20 6f70 7469 6f6e   or None, option
-000316b0: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
-000316c0: 6865 2069 6465 616c 206e 756d 6265 7220  he ideal number 
-000316d0: 6f66 206f 7574 7075 7420 7061 7274 6974  of output partit
-000316e0: 696f 6e73 2e20 5468 6973 2069 7320 6f6e  ions. This is on
-000316f0: 6c79 2075 7469 6c69 7365 6420 7768 656e  ly utilised when
-00031700: 0a20 2020 2020 2020 2020 2020 2070 6572  .            per
-00031710: 666f 726d 696e 6720 6120 6861 7368 5f6a  forming a hash_j
-00031720: 6f69 6e20 286d 6572 6769 6e67 206f 6e20  oin (merging on 
-00031730: 636f 6c75 6d6e 7320 6f6e 6c79 292e 2049  columns only). I
-00031740: 6620 6060 4e6f 6e65 6060 2074 6865 6e0a  f ``None`` then.
-00031750: 2020 2020 2020 2020 2020 2020 6060 6e70              ``np
-00031760: 6172 7469 7469 6f6e 7320 3d20 6d61 7828  artitions = max(
-00031770: 6c68 732e 6e70 6172 7469 7469 6f6e 732c  lhs.npartitions,
-00031780: 2072 6873 2e6e 7061 7274 6974 696f 6e73   rhs.npartitions
-00031790: 2960 602e 0a20 2020 2020 2020 2020 2020  )``..           
-000317a0: 2044 6566 6175 6c74 2069 7320 6060 4e6f   Default is ``No
-000317b0: 6e65 6060 2e0a 2020 2020 2020 2020 7368  ne``..        sh
-000317c0: 7566 666c 653a 207b 2764 6973 6b27 2c20  uffle: {'disk', 
-000317d0: 2774 6173 6b73 277d 2c20 6f70 7469 6f6e  'tasks'}, option
-000317e0: 616c 0a20 2020 2020 2020 2020 2020 2045  al.            E
-000317f0: 6974 6865 7220 6060 2764 6973 6b27 6060  ither ``'disk'``
-00031800: 2066 6f72 2073 696e 676c 652d 6e6f 6465   for single-node
-00031810: 206f 7065 7261 7469 6f6e 206f 7220 6060   operation or ``
-00031820: 2774 6173 6b73 2760 6020 666f 720a 2020  'tasks'`` for.  
-00031830: 2020 2020 2020 2020 2020 6469 7374 7269            distri
-00031840: 6275 7465 6420 6f70 6572 6174 696f 6e2e  buted operation.
-00031850: 2020 5769 6c6c 2062 6520 696e 6665 7272    Will be inferr
-00031860: 6564 2062 7920 796f 7572 2063 7572 7265  ed by your curre
-00031870: 6e74 2073 6368 6564 756c 6572 2e0a 2020  nt scheduler..  
-00031880: 2020 2020 2020 6272 6f61 6463 6173 743a        broadcast:
-00031890: 2062 6f6f 6c65 616e 206f 7220 666c 6f61   boolean or floa
-000318a0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-000318b0: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
-000318c0: 746f 2075 7365 2061 2062 726f 6164 6361  to use a broadca
-000318d0: 7374 2d62 6173 6564 206a 6f69 6e20 696e  st-based join in
-000318e0: 206c 6965 7520 6f66 2061 2073 6875 6666   lieu of a shuff
-000318f0: 6c65 2d62 6173 6564 0a20 2020 2020 2020  le-based.       
-00031900: 2020 2020 206a 6f69 6e20 666f 7220 7375       join for su
-00031910: 7070 6f72 7465 6420 6361 7365 732e 2020  pported cases.  
-00031920: 4279 2064 6566 6175 6c74 2c20 6120 7369  By default, a si
-00031930: 6d70 6c65 2068 6575 7269 7374 6963 2077  mple heuristic w
-00031940: 696c 6c20 6265 0a20 2020 2020 2020 2020  ill be.         
-00031950: 2020 2075 7365 6420 746f 2073 656c 6563     used to selec
-00031960: 7420 7468 6520 756e 6465 726c 7969 6e67  t the underlying
-00031970: 2061 6c67 6f72 6974 686d 2e20 4966 2061   algorithm. If a
-00031980: 2066 6c6f 6174 696e 672d 706f 696e 7420   floating-point 
-00031990: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-000319a0: 2020 6973 2073 7065 6369 6669 6564 2c20    is specified, 
-000319b0: 7468 6174 206e 756d 6265 7220 7769 6c6c  that number will
-000319c0: 2062 6520 7573 6564 2061 7320 7468 6520   be used as the 
-000319d0: 6060 6272 6f61 6463 6173 745f 6269 6173  ``broadcast_bias
-000319e0: 6060 0a20 2020 2020 2020 2020 2020 2077  ``.            w
-000319f0: 6974 6869 6e20 7468 6520 7369 6d70 6c65  ithin the simple
-00031a00: 2068 6575 7269 7374 6963 2028 6120 6c61   heuristic (a la
-00031a10: 7267 6520 6e75 6d62 6572 206d 616b 6573  rge number makes
-00031a20: 2044 6173 6b20 6d6f 7265 206c 696b 656c   Dask more likel
-00031a30: 790a 2020 2020 2020 2020 2020 2020 746f  y.            to
-00031a40: 2063 686f 6f73 6520 7468 6520 6060 6272   choose the ``br
-00031a50: 6f61 6361 7374 5f6a 6f69 6e60 6020 636f  oacast_join`` co
-00031a60: 6465 2070 6174 6829 2e20 5365 6520 6060  de path). See ``
-00031a70: 6272 6f61 6463 6173 745f 6a6f 696e 6060  broadcast_join``
-00031a80: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00031a90: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-00031aa0: 6e2e 0a0a 2020 2020 2020 2020 4e6f 7465  n...        Note
-00031ab0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d0a  s.        -----.
-00031ac0: 0a20 2020 2020 2020 2054 6865 7265 2061  .        There a
-00031ad0: 7265 2074 6872 6565 2077 6179 7320 746f  re three ways to
-00031ae0: 206a 6f69 6e20 6461 7461 6672 616d 6573   join dataframes
-00031af0: 3a0a 0a20 2020 2020 2020 2031 2e20 4a6f  :..        1. Jo
-00031b00: 696e 696e 6720 6f6e 2069 6e64 6963 6573  ining on indices
-00031b10: 2e20 496e 2074 6869 7320 6361 7365 2074  . In this case t
-00031b20: 6865 2064 6976 6973 696f 6e73 2061 7265  he divisions are
-00031b30: 0a20 2020 2020 2020 2020 2020 616c 6967  .           alig
-00031b40: 6e65 6420 7573 696e 6720 7468 6520 6675  ned using the fu
-00031b50: 6e63 7469 6f6e 2060 6064 6173 6b2e 6461  nction ``dask.da
-00031b60: 7461 6672 616d 652e 6d75 6c74 692e 616c  taframe.multi.al
-00031b70: 6967 6e5f 7061 7274 6974 696f 6e73 6060  ign_partitions``
-00031b80: 2e0a 2020 2020 2020 2020 2020 2041 6674  ..           Aft
-00031b90: 6572 7761 7264 732c 2065 6163 6820 7061  erwards, each pa
-00031ba0: 7274 6974 696f 6e20 6973 206d 6572 6765  rtition is merge
-00031bb0: 6420 7769 7468 2074 6865 2070 616e 6461  d with the panda
-00031bc0: 7320 6d65 7267 6520 6675 6e63 7469 6f6e  s merge function
-00031bd0: 2e0a 0a20 2020 2020 2020 2032 2e20 4a6f  ...        2. Jo
-00031be0: 696e 696e 6720 6f6e 6520 6f6e 2069 6e64  ining one on ind
-00031bf0: 6578 2061 6e64 206f 6e65 206f 6e20 636f  ex and one on co
-00031c00: 6c75 6d6e 2e20 496e 2074 6869 7320 6361  lumn. In this ca
-00031c10: 7365 2074 6865 2064 6976 6973 696f 6e73  se the divisions
-00031c20: 206f 660a 2020 2020 2020 2020 2020 2064   of.           d
-00031c30: 6174 6166 7261 6d65 206d 6572 6765 6420  ataframe merged 
-00031c40: 6279 2069 6e64 6578 2028 3a6d 6174 683a  by index (:math:
-00031c50: 6064 5f69 6029 2061 7265 2075 7365 6420  `d_i`) are used 
-00031c60: 746f 2064 6976 6964 6520 7468 6520 636f  to divide the co
-00031c70: 6c75 6d6e 0a20 2020 2020 2020 2020 2020  lumn.           
-00031c80: 6d65 7267 6564 2064 6174 6166 7261 6d65  merged dataframe
-00031c90: 2028 3a6d 6174 683a 6064 5f63 6029 206f   (:math:`d_c`) o
-00031ca0: 6e65 2075 7369 6e67 0a20 2020 2020 2020  ne using.       
-00031cb0: 2020 2020 6060 6461 736b 2e64 6174 6166      ``dask.dataf
-00031cc0: 7261 6d65 2e6d 756c 7469 2e72 6561 7272  rame.multi.rearr
-00031cd0: 616e 6765 5f62 795f 6469 7669 7369 6f6e  ange_by_division
-00031ce0: 7360 602e 2049 6e20 7468 6973 2063 6173  s``. In this cas
-00031cf0: 6520 7468 650a 2020 2020 2020 2020 2020  e the.          
-00031d00: 206d 6572 6765 6420 6461 7461 6672 616d   merged datafram
-00031d10: 6520 283a 6d61 7468 3a60 645f 6d60 2920  e (:math:`d_m`) 
-00031d20: 6861 7320 7468 6520 6578 6163 7420 7361  has the exact sa
-00031d30: 6d65 2064 6976 6973 696f 6e73 0a20 2020  me divisions.   
-00031d40: 2020 2020 2020 2020 6173 2028 3a6d 6174          as (:mat
-00031d50: 683a 6064 5f69 6029 2e20 5468 6973 2063  h:`d_i`). This c
-00031d60: 616e 206c 6561 6420 746f 2069 7373 7565  an lead to issue
-00031d70: 7320 6966 2079 6f75 206d 6572 6765 206d  s if you merge m
-00031d80: 756c 7469 706c 6520 726f 7773 2066 726f  ultiple rows fro
-00031d90: 6d0a 2020 2020 2020 2020 2020 2028 3a6d  m.           (:m
-00031da0: 6174 683a 6064 5f63 6029 2074 6f20 6f6e  ath:`d_c`) to on
-00031db0: 6520 726f 7720 696e 2028 3a6d 6174 683a  e row in (:math:
-00031dc0: 6064 5f69 6029 2e0a 0a20 2020 2020 2020  `d_i`)...       
-00031dd0: 2033 2e20 4a6f 696e 696e 6720 626f 7468   3. Joining both
-00031de0: 206f 6e20 636f 6c75 6d6e 732e 2049 6e20   on columns. In 
-00031df0: 7468 6973 2063 6173 6520 6120 6861 7368  this case a hash
-00031e00: 206a 6f69 6e20 6973 2070 6572 666f 726d   join is perform
-00031e10: 6564 2075 7369 6e67 0a20 2020 2020 2020  ed using.       
-00031e20: 2020 2020 6060 6461 736b 2e64 6174 6166      ``dask.dataf
-00031e30: 7261 6d65 2e6d 756c 7469 2e68 6173 685f  rame.multi.hash_
-00031e40: 6a6f 696e 6060 2e0a 0a20 2020 2020 2020  join``...       
-00031e50: 2049 6e20 736f 6d65 2063 6173 6573 2c20   In some cases, 
-00031e60: 796f 7520 6d61 7920 7365 6520 6120 6060  you may see a ``
-00031e70: 4d65 6d6f 7279 4572 726f 7260 6020 6966  MemoryError`` if
-00031e80: 2074 6865 2060 606d 6572 6765 6060 206f   the ``merge`` o
-00031e90: 7065 7261 7469 6f6e 2072 6571 7569 7265  peration require
-00031ea0: 730a 2020 2020 2020 2020 616e 2069 6e74  s.        an int
-00031eb0: 6572 6e61 6c20 6060 7368 7566 666c 6560  ernal ``shuffle`
-00031ec0: 602c 2062 6563 6175 7365 2073 6875 6666  `, because shuff
-00031ed0: 6c69 6e67 2070 6c61 6365 7320 616c 6c20  ling places all 
-00031ee0: 726f 7773 2074 6861 7420 6861 7665 2074  rows that have t
-00031ef0: 6865 2073 616d 650a 2020 2020 2020 2020  he same.        
-00031f00: 696e 6465 7820 696e 2074 6865 2073 616d  index in the sam
-00031f10: 6520 7061 7274 6974 696f 6e2e 2054 6f20  e partition. To 
-00031f20: 6176 6f69 6420 7468 6973 2065 7272 6f72  avoid this error
-00031f30: 2c20 6d61 6b65 2073 7572 6520 616c 6c20  , make sure all 
-00031f40: 726f 7773 2077 6974 6820 7468 650a 2020  rows with the.  
-00031f50: 2020 2020 2020 7361 6d65 2060 606f 6e60        same ``on`
-00031f60: 602d 636f 6c75 6d6e 2076 616c 7565 2063  `-column value c
-00031f70: 616e 2066 6974 206f 6e20 6120 7369 6e67  an fit on a sing
-00031f80: 6c65 2070 6172 7469 7469 6f6e 2e0a 2020  le partition..  
-00031f90: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00031fa0: 2020 2069 6620 6e6f 7420 6973 5f64 6174     if not is_dat
-00031fb0: 6166 7261 6d65 5f6c 696b 6528 7269 6768  aframe_like(righ
-00031fc0: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-00031fd0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00031fe0: 2822 7269 6768 7420 6d75 7374 2062 6520  ("right must be 
-00031ff0: 4461 7461 4672 616d 6522 290a 0a20 2020  DataFrame")..   
-00032000: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-00032010: 6174 6166 7261 6d65 2e6d 756c 7469 2069  ataframe.multi i
-00032020: 6d70 6f72 7420 6d65 7267 650a 0a20 2020  mport merge..   
-00032030: 2020 2020 2072 6574 7572 6e20 6d65 7267       return merg
-00032040: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
-00032050: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-00032060: 2072 6967 6874 2c0a 2020 2020 2020 2020   right,.        
-00032070: 2020 2020 686f 773d 686f 772c 0a20 2020      how=how,.   
-00032080: 2020 2020 2020 2020 206f 6e3d 6f6e 2c0a           on=on,.
-00032090: 2020 2020 2020 2020 2020 2020 6c65 6674              left
-000320a0: 5f6f 6e3d 6c65 6674 5f6f 6e2c 0a20 2020  _on=left_on,.   
-000320b0: 2020 2020 2020 2020 2072 6967 6874 5f6f           right_o
-000320c0: 6e3d 7269 6768 745f 6f6e 2c0a 2020 2020  n=right_on,.    
-000320d0: 2020 2020 2020 2020 6c65 6674 5f69 6e64          left_ind
-000320e0: 6578 3d6c 6566 745f 696e 6465 782c 0a20  ex=left_index,. 
-000320f0: 2020 2020 2020 2020 2020 2072 6967 6874             right
-00032100: 5f69 6e64 6578 3d72 6967 6874 5f69 6e64  _index=right_ind
-00032110: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
-00032120: 7375 6666 6978 6573 3d73 7566 6669 7865  suffixes=suffixe
-00032130: 732c 0a20 2020 2020 2020 2020 2020 206e  s,.            n
-00032140: 7061 7274 6974 696f 6e73 3d6e 7061 7274  partitions=npart
-00032150: 6974 696f 6e73 2c0a 2020 2020 2020 2020  itions,.        
-00032160: 2020 2020 696e 6469 6361 746f 723d 696e      indicator=in
-00032170: 6469 6361 746f 722c 0a20 2020 2020 2020  dicator,.       
-00032180: 2020 2020 2073 6875 6666 6c65 3d73 6875       shuffle=shu
-00032190: 6666 6c65 2c0a 2020 2020 2020 2020 2020  ffle,.          
-000321a0: 2020 6272 6f61 6463 6173 743d 6272 6f61    broadcast=broa
-000321b0: 6463 6173 742c 0a20 2020 2020 2020 2029  dcast,.        )
-000321c0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-000321d0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-000321e0: 290a 2020 2020 6465 6620 6a6f 696e 280a  ).    def join(.
-000321f0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00032200: 2020 2020 2020 6f74 6865 722c 0a20 2020        other,.   
-00032210: 2020 2020 206f 6e3d 4e6f 6e65 2c0a 2020       on=None,.  
-00032220: 2020 2020 2020 686f 773d 226c 6566 7422        how="left"
-00032230: 2c0a 2020 2020 2020 2020 6c73 7566 6669  ,.        lsuffi
-00032240: 783d 2222 2c0a 2020 2020 2020 2020 7273  x="",.        rs
-00032250: 7566 6669 783d 2222 2c0a 2020 2020 2020  uffix="",.      
-00032260: 2020 6e70 6172 7469 7469 6f6e 733d 4e6f    npartitions=No
-00032270: 6e65 2c0a 2020 2020 2020 2020 7368 7566  ne,.        shuf
-00032280: 666c 653d 4e6f 6e65 2c0a 2020 2020 293a  fle=None,.    ):
-00032290: 0a20 2020 2020 2020 2069 6620 6973 5f73  .        if is_s
-000322a0: 6572 6965 735f 6c69 6b65 286f 7468 6572  eries_like(other
-000322b0: 2920 616e 6420 6861 7361 7474 7228 6f74  ) and hasattr(ot
-000322c0: 6865 722c 2022 6e61 6d65 2229 3a0a 2020  her, "name"):.  
-000322d0: 2020 2020 2020 2020 2020 6f74 6865 7220            other 
-000322e0: 3d20 6f74 6865 722e 746f 5f66 7261 6d65  = other.to_frame
-000322f0: 2829 0a0a 2020 2020 2020 2020 6966 206e  ()..        if n
-00032300: 6f74 2069 735f 6461 7461 6672 616d 655f  ot is_dataframe_
-00032310: 6c69 6b65 286f 7468 6572 293a 0a20 2020  like(other):.   
-00032320: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00032330: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
-00032340: 2c20 6c69 7374 2920 6f72 206e 6f74 2061  , list) or not a
-00032350: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-00032360: 2020 2020 5b69 735f 6461 7461 6672 616d      [is_datafram
-00032370: 655f 6c69 6b65 286f 2920 666f 7220 6f20  e_like(o) for o 
-00032380: 696e 206f 7468 6572 5d0a 2020 2020 2020  in other].      
-00032390: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-000323a0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-000323b0: 616c 7565 4572 726f 7228 226f 7468 6572  alueError("other
-000323c0: 206d 7573 7420 6265 2044 6174 6146 7261   must be DataFra
-000323d0: 6d65 206f 7220 6c69 7374 206f 6620 4461  me or list of Da
-000323e0: 7461 4672 616d 6573 2229 0a20 2020 2020  taFrames").     
-000323f0: 2020 2020 2020 2069 6620 686f 7720 6e6f         if how no
-00032400: 7420 696e 205b 226f 7574 6572 222c 2022  t in ["outer", "
-00032410: 6c65 6674 225d 3a0a 2020 2020 2020 2020  left"]:.        
-00032420: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00032430: 6c75 6545 7272 6f72 2822 6d65 7267 655f  lueError("merge_
-00032440: 6d75 6c74 6920 6f6e 6c79 2073 7570 706f  multi only suppo
-00032450: 7274 7320 6c65 6674 206f 7220 6f75 7465  rts left or oute
-00032460: 7220 6a6f 696e 7322 290a 0a20 2020 2020  r joins")..     
-00032470: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-00032480: 2e64 6174 6166 7261 6d65 2e6d 756c 7469  .dataframe.multi
-00032490: 2069 6d70 6f72 7420 5f72 6563 7572 7369   import _recursi
-000324a0: 7665 5f70 6169 7277 6973 655f 6f75 7465  ve_pairwise_oute
-000324b0: 725f 6a6f 696e 0a0a 2020 2020 2020 2020  r_join..        
-000324c0: 2020 2020 2320 4966 2069 7473 2061 6e20      # If its an 
-000324d0: 6f75 7465 7220 6a6f 696e 2077 6520 6361  outer join we ca
-000324e0: 6e20 7573 6520 7468 6520 6675 6c6c 2072  n use the full r
-000324f0: 6563 7572 7369 7665 2070 6169 7277 6973  ecursive pairwis
-00032500: 6520 6a6f 696e 2e0a 2020 2020 2020 2020  e join..        
-00032510: 2020 2020 6966 2068 6f77 203d 3d20 226f      if how == "o
-00032520: 7574 6572 223a 0a20 2020 2020 2020 2020  uter":.         
-00032530: 2020 2020 2020 2066 756c 6c20 3d20 5b73         full = [s
-00032540: 656c 665d 202b 206f 7468 6572 0a0a 2020  elf] + other..  
-00032550: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00032560: 7475 726e 205f 7265 6375 7273 6976 655f  turn _recursive_
-00032570: 7061 6972 7769 7365 5f6f 7574 6572 5f6a  pairwise_outer_j
-00032580: 6f69 6e28 0a20 2020 2020 2020 2020 2020  oin(.           
-00032590: 2020 2020 2020 2020 2066 756c 6c2c 0a20           full,. 
-000325a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000325b0: 2020 206f 6e3d 6f6e 2c0a 2020 2020 2020     on=on,.      
-000325c0: 2020 2020 2020 2020 2020 2020 2020 6c73                ls
-000325d0: 7566 6669 783d 6c73 7566 6669 782c 0a20  uffix=lsuffix,. 
-000325e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000325f0: 2020 2072 7375 6666 6978 3d72 7375 6666     rsuffix=rsuff
-00032600: 6978 2c0a 2020 2020 2020 2020 2020 2020  ix,.            
-00032610: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
-00032620: 6f6e 733d 6e70 6172 7469 7469 6f6e 732c  ons=npartitions,
-00032630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032640: 2020 2020 2073 6875 6666 6c65 3d73 6875       shuffle=shu
-00032650: 6666 6c65 2c0a 2020 2020 2020 2020 2020  ffle,.          
-00032660: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00032670: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00032680: 2020 2020 2020 2020 2020 2320 446f 2072            # Do r
-00032690: 6563 7572 7369 7665 2070 6169 7277 6973  ecursive pairwis
-000326a0: 6520 6a6f 696e 206f 6e20 6576 6572 7974  e join on everyt
-000326b0: 6869 6e67 205f 6578 6365 7074 5f20 7468  hing _except_ th
-000326c0: 6520 6c61 7374 206a 6f69 6e0a 2020 2020  e last join.    
-000326d0: 2020 2020 2020 2020 2020 2020 2320 7768              # wh
-000326e0: 6572 6520 7765 206e 6565 6420 746f 2064  ere we need to d
-000326f0: 6f20 6120 6c65 6674 206a 6f69 6e2e 0a20  o a left join.. 
-00032700: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00032710: 7468 6572 203d 205f 7265 6375 7273 6976  ther = _recursiv
-00032720: 655f 7061 6972 7769 7365 5f6f 7574 6572  e_pairwise_outer
-00032730: 5f6a 6f69 6e28 0a20 2020 2020 2020 2020  _join(.         
-00032740: 2020 2020 2020 2020 2020 206f 7468 6572             other
-00032750: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00032760: 2020 2020 2020 6f6e 3d6f 6e2c 0a20 2020        on=on,.   
-00032770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032780: 206c 7375 6666 6978 3d6c 7375 6666 6978   lsuffix=lsuffix
-00032790: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000327a0: 2020 2020 2020 7273 7566 6669 783d 7273        rsuffix=rs
-000327b0: 7566 6669 782c 0a20 2020 2020 2020 2020  uffix,.         
-000327c0: 2020 2020 2020 2020 2020 206e 7061 7274             npart
-000327d0: 6974 696f 6e73 3d6e 7061 7274 6974 696f  itions=npartitio
-000327e0: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-000327f0: 2020 2020 2020 2020 7368 7566 666c 653d          shuffle=
-00032800: 7368 7566 666c 652c 0a20 2020 2020 2020  shuffle,.       
-00032810: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00032820: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-00032830: 7461 6672 616d 652e 6d75 6c74 6920 696d  taframe.multi im
-00032840: 706f 7274 206d 6572 6765 0a0a 2020 2020  port merge..    
-00032850: 2020 2020 7265 7475 726e 206d 6572 6765      return merge
-00032860: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-00032870: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
-00032880: 6f74 6865 722c 0a20 2020 2020 2020 2020  other,.         
-00032890: 2020 2068 6f77 3d68 6f77 2c0a 2020 2020     how=how,.    
-000328a0: 2020 2020 2020 2020 6c65 6674 5f69 6e64          left_ind
-000328b0: 6578 3d6f 6e20 6973 204e 6f6e 652c 0a20  ex=on is None,. 
-000328c0: 2020 2020 2020 2020 2020 2072 6967 6874             right
-000328d0: 5f69 6e64 6578 3d54 7275 652c 0a20 2020  _index=True,.   
-000328e0: 2020 2020 2020 2020 206c 6566 745f 6f6e           left_on
-000328f0: 3d6f 6e2c 0a20 2020 2020 2020 2020 2020  =on,.           
-00032900: 2073 7566 6669 7865 733d 286c 7375 6666   suffixes=(lsuff
-00032910: 6978 2c20 7273 7566 6669 7829 2c0a 2020  ix, rsuffix),.  
-00032920: 2020 2020 2020 2020 2020 6e70 6172 7469            nparti
-00032930: 7469 6f6e 733d 6e70 6172 7469 7469 6f6e  tions=npartition
-00032940: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
-00032950: 6875 6666 6c65 3d73 6875 6666 6c65 2c0a  huffle=shuffle,.
-00032960: 2020 2020 2020 2020 290a 0a20 2020 2069          )..    i
-00032970: 6620 6e6f 7420 5041 4e44 4153 5f47 545f  f not PANDAS_GT_
-00032980: 3230 303a 0a0a 2020 2020 2020 2020 4064  200:..        @d
-00032990: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-000329a0: 6174 6146 7261 6d65 290a 2020 2020 2020  ataFrame).      
-000329b0: 2020 6465 6620 6170 7065 6e64 2873 656c    def append(sel
-000329c0: 662c 206f 7468 6572 2c20 696e 7465 726c  f, other, interl
-000329d0: 6561 7665 5f70 6172 7469 7469 6f6e 733d  eave_partitions=
-000329e0: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
-000329f0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00032a00: 6528 6f74 6865 722c 2053 6572 6965 7329  e(other, Series)
-00032a10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00032a20: 2020 6d73 6720 3d20 280a 2020 2020 2020    msg = (.      
-00032a30: 2020 2020 2020 2020 2020 2020 2020 2255                "U
-00032a40: 6e61 626c 6520 746f 2061 7070 656e 6469  nable to appendi
-00032a50: 6e67 2064 642e 5365 7269 6573 2074 6f20  ng dd.Series to 
-00032a60: 6464 2e44 6174 6146 7261 6d65 2e22 0a20  dd.DataFrame.". 
-00032a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032a80: 2020 2022 5573 6520 7064 2e53 6572 6965     "Use pd.Serie
-00032a90: 7320 746f 2061 7070 656e 6420 6173 2072  s to append as r
-00032aa0: 6f77 2e22 0a20 2020 2020 2020 2020 2020  ow.".           
-00032ab0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00032ac0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00032ad0: 7565 4572 726f 7228 6d73 6729 0a20 2020  ueError(msg).   
-00032ae0: 2020 2020 2020 2020 2065 6c69 6620 6973           elif is
-00032af0: 5f73 6572 6965 735f 6c69 6b65 286f 7468  _series_like(oth
-00032b00: 6572 293a 0a20 2020 2020 2020 2020 2020  er):.           
-00032b10: 2020 2020 206f 7468 6572 203d 206f 7468       other = oth
-00032b20: 6572 2e74 6f5f 6672 616d 6528 292e 540a  er.to_frame().T.
-00032b30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00032b40: 726e 2073 7570 6572 2829 2e61 7070 656e  rn super().appen
-00032b50: 6428 6f74 6865 722c 2069 6e74 6572 6c65  d(other, interle
-00032b60: 6176 655f 7061 7274 6974 696f 6e73 3d69  ave_partitions=i
-00032b70: 6e74 6572 6c65 6176 655f 7061 7274 6974  nterleave_partit
-00032b80: 696f 6e73 290a 0a20 2020 2040 6465 7269  ions)..    @deri
-00032b90: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-00032ba0: 4672 616d 6529 0a20 2020 2064 6566 2069  Frame).    def i
-00032bb0: 7465 7272 6f77 7328 7365 6c66 293a 0a20  terrows(self):. 
-00032bc0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00032bd0: 7261 6e67 6528 7365 6c66 2e6e 7061 7274  range(self.npart
-00032be0: 6974 696f 6e73 293a 0a20 2020 2020 2020  itions):.       
-00032bf0: 2020 2020 2064 6620 3d20 7365 6c66 2e67       df = self.g
-00032c00: 6574 5f70 6172 7469 7469 6f6e 2869 292e  et_partition(i).
-00032c10: 636f 6d70 7574 6528 290a 2020 2020 2020  compute().      
-00032c20: 2020 2020 2020 7969 656c 6420 6672 6f6d        yield from
-00032c30: 2064 662e 6974 6572 726f 7773 2829 0a0a   df.iterrows()..
-00032c40: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00032c50: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-00032c60: 2020 2020 6465 6620 6974 6572 7475 706c      def itertupl
-00032c70: 6573 2873 656c 662c 2069 6e64 6578 3d54  es(self, index=T
-00032c80: 7275 652c 206e 616d 653d 2250 616e 6461  rue, name="Panda
-00032c90: 7322 293a 0a20 2020 2020 2020 2066 6f72  s"):.        for
-00032ca0: 2069 2069 6e20 7261 6e67 6528 7365 6c66   i in range(self
-00032cb0: 2e6e 7061 7274 6974 696f 6e73 293a 0a20  .npartitions):. 
-00032cc0: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
-00032cd0: 7365 6c66 2e67 6574 5f70 6172 7469 7469  self.get_partiti
-00032ce0: 6f6e 2869 292e 636f 6d70 7574 6528 290a  on(i).compute().
-00032cf0: 2020 2020 2020 2020 2020 2020 7969 656c              yiel
-00032d00: 6420 6672 6f6d 2064 662e 6974 6572 7475  d from df.itertu
-00032d10: 706c 6573 2869 6e64 6578 3d69 6e64 6578  ples(index=index
-00032d20: 2c20 6e61 6d65 3d6e 616d 6529 0a0a 2020  , name=name)..  
-00032d30: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00032d40: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00032d50: 2020 6465 6620 6974 656d 7328 7365 6c66    def items(self
-00032d60: 293a 0a20 2020 2020 2020 2066 6f72 2063  ):.        for c
-00032d70: 6f6c 5f69 6478 2c20 6c61 6265 6c20 696e  ol_idx, label in
-00032d80: 2065 6e75 6d65 7261 7465 2873 656c 662e   enumerate(self.
-00032d90: 636f 6c75 6d6e 7329 3a0a 2020 2020 2020  columns):.      
-00032da0: 2020 2020 2020 7969 656c 6420 6c61 6265        yield labe
-00032db0: 6c2c 2073 656c 662e 696c 6f63 5b3a 2c20  l, self.iloc[:, 
-00032dc0: 636f 6c5f 6964 785d 0a0a 2020 2020 4063  col_idx]..    @c
-00032dd0: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
-00032de0: 6566 205f 6269 6e64 5f6f 7065 7261 746f  ef _bind_operato
-00032df0: 725f 6d65 7468 6f64 2863 6c73 2c20 6e61  r_method(cls, na
-00032e00: 6d65 2c20 6f70 2c20 6f72 6967 696e 616c  me, op, original
-00032e10: 3d70 642e 4461 7461 4672 616d 6529 3a0a  =pd.DataFrame):.
-00032e20: 2020 2020 2020 2020 2222 2262 696e 6420          """bind 
-00032e30: 6f70 6572 6174 6f72 206d 6574 686f 6420  operator method 
-00032e40: 6c69 6b65 2044 6174 6146 7261 6d65 2e61  like DataFrame.a
-00032e50: 6464 2074 6f20 7468 6973 2063 6c61 7373  dd to this class
-00032e60: 2222 220a 0a20 2020 2020 2020 2023 206e  """..        # n
-00032e70: 616d 6520 6d75 7374 2062 6520 6578 706c  ame must be expl
-00032e80: 6963 6974 6c79 2070 6173 7365 6420 666f  icitly passed fo
-00032e90: 7220 6469 7620 6d65 7468 6f64 2077 686f  r div method who
-00032ea0: 7365 206e 616d 6520 6973 2074 7275 6564  se name is trued
-00032eb0: 6976 0a0a 2020 2020 2020 2020 6465 6620  iv..        def 
-00032ec0: 6d65 7468 2873 656c 662c 206f 7468 6572  meth(self, other
-00032ed0: 2c20 6178 6973 3d22 636f 6c75 6d6e 7322  , axis="columns"
-00032ee0: 2c20 6c65 7665 6c3d 4e6f 6e65 2c20 6669  , level=None, fi
-00032ef0: 6c6c 5f76 616c 7565 3d4e 6f6e 6529 3a0a  ll_value=None):.
-00032f00: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00032f10: 6576 656c 2069 7320 6e6f 7420 4e6f 6e65  evel is not None
-00032f20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00032f30: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-00032f40: 6d65 6e74 6564 4572 726f 7228 226c 6576  mentedError("lev
-00032f50: 656c 206d 7573 7420 6265 204e 6f6e 6522  el must be None"
-00032f60: 290a 0a20 2020 2020 2020 2020 2020 2061  )..            a
-00032f70: 7869 7320 3d20 7365 6c66 2e5f 7661 6c69  xis = self._vali
-00032f80: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
-00032f90: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00032fa0: 6178 6973 2069 6e20 2831 2c20 2263 6f6c  axis in (1, "col
-00032fb0: 756d 6e73 2229 3a0a 2020 2020 2020 2020  umns"):.        
-00032fc0: 2020 2020 2020 2020 2320 5768 656e 2061          # When a
-00032fd0: 7869 733d 3120 616e 6420 6f74 6865 7220  xis=1 and other 
-00032fe0: 6973 2061 2073 6572 6965 732c 2060 6f74  is a series, `ot
-00032ff0: 6865 7260 2069 7320 7472 616e 7370 6f73  her` is transpos
-00033000: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
-00033010: 2020 2023 2061 6e64 2074 6865 206f 7065     # and the ope
-00033020: 7261 746f 7220 6973 2061 7070 6c69 6564  rator is applied
-00033030: 2062 726f 6164 6361 7374 2061 6372 6f73   broadcast acros
-00033040: 7320 726f 7773 2e20 5468 6973 0a20 2020  s rows. This.   
-00033050: 2020 2020 2020 2020 2020 2020 2023 2069               # i
-00033060: 736e 2774 2073 7570 706f 7274 6564 2077  sn't supported w
-00033070: 6974 6820 6464 2e53 6572 6965 732e 0a20  ith dd.Series.. 
-00033080: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00033090: 6620 6973 696e 7374 616e 6365 286f 7468  f isinstance(oth
-000330a0: 6572 2c20 5365 7269 6573 293a 0a20 2020  er, Series):.   
-000330b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000330c0: 206d 7367 203d 2066 2255 6e61 626c 6520   msg = f"Unable 
-000330d0: 746f 207b 6e61 6d65 7d20 6464 2e53 6572  to {name} dd.Ser
-000330e0: 6965 7320 7769 7468 2061 7869 733d 3122  ies with axis=1"
-000330f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033100: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00033110: 4572 726f 7228 6d73 6729 0a20 2020 2020  Error(msg).     
-00033120: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00033130: 6973 5f73 6572 6965 735f 6c69 6b65 286f  is_series_like(o
-00033140: 7468 6572 293a 0a20 2020 2020 2020 2020  ther):.         
-00033150: 2020 2020 2020 2020 2020 2023 2053 7065             # Spe
-00033160: 6369 616c 2063 6173 6520 666f 7220 7064  cial case for pd
-00033170: 2e53 6572 6965 7320 746f 2061 766f 6964  .Series to avoid
-00033180: 2075 6e77 616e 7465 6420 7061 7274 6974   unwanted partit
-00033190: 696f 6e69 6e67 0a20 2020 2020 2020 2020  ioning.         
-000331a0: 2020 2020 2020 2020 2020 2023 206f 6620             # of 
-000331b0: 6f74 6865 722e 2057 6520 7061 7373 2069  other. We pass i
-000331c0: 7420 696e 2061 7320 6120 6b77 6172 6720  t in as a kwarg 
-000331d0: 746f 2070 7265 7665 6e74 2074 6869 732e  to prevent this.
-000331e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000331f0: 2020 2020 206d 6574 6120 3d20 5f65 6d75       meta = _emu
-00033200: 6c61 7465 280a 2020 2020 2020 2020 2020  late(.          
-00033210: 2020 2020 2020 2020 2020 2020 2020 6f70                op
-00033220: 2c20 7365 6c66 2c20 6f74 6865 723d 6f74  , self, other=ot
-00033230: 6865 722c 2061 7869 733d 6178 6973 2c20  her, axis=axis, 
-00033240: 6669 6c6c 5f76 616c 7565 3d66 696c 6c5f  fill_value=fill_
-00033250: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-00033260: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001d0d0: 6c61 7965 725b 2863 6e61 6d65 2c20 6929  layer[(cname, i)
+0001d0e0: 5d20 3d20 280a 2020 2020 2020 2020 2020  ] = (.          
+0001d0f0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0001d100: 7468 6f64 732e 5f63 756d 5f61 6767 7265  thods._cum_aggre
+0001d110: 6761 7465 5f61 7070 6c79 2c0a 2020 2020  gate_apply,.    
+0001d120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d130: 2020 2020 6167 6772 6567 6174 652c 0a20      aggregate,. 
+0001d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d150: 2020 2020 2020 2028 636e 616d 652c 2069         (cname, i
+0001d160: 202d 2031 292c 0a20 2020 2020 2020 2020   - 1),.         
+0001d170: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0001d180: 6375 6d6c 6173 742e 5f6e 616d 652c 2069  cumlast._name, i
+0001d190: 202d 2031 292c 0a20 2020 2020 2020 2020   - 1),.         
+0001d1a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001d1b0: 2020 2020 2020 2020 2020 2020 206c 6179               lay
+0001d1c0: 6572 5b28 6e61 6d65 2c20 6929 5d20 3d20  er[(name, i)] = 
+0001d1d0: 2861 6767 7265 6761 7465 2c20 2863 756d  (aggregate, (cum
+0001d1e0: 7061 7274 2e5f 6e61 6d65 2c20 6929 2c20  part._name, i), 
+0001d1f0: 2863 6e61 6d65 2c20 6929 290a 2020 2020  (cname, i)).    
+0001d200: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
+0001d210: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
+0001d220: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
+0001d230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d240: 206e 616d 652c 206c 6179 6572 2c20 6465   name, layer, de
+0001d250: 7065 6e64 656e 6369 6573 3d5b 6375 6d70  pendencies=[cump
+0001d260: 6172 742c 2063 756d 6c61 7374 5d0a 2020  art, cumlast].  
+0001d270: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001d280: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+0001d290: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
+0001d2a0: 7261 7068 2c20 6e61 6d65 2c20 6368 756e  raph, name, chun
+0001d2b0: 6b28 7365 6c66 2e5f 6d65 7461 292c 2073  k(self._meta), s
+0001d2c0: 656c 662e 6469 7669 7369 6f6e 7329 0a20  elf.divisions). 
+0001d2d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001d2e0: 6e20 6861 6e64 6c65 5f6f 7574 286f 7574  n handle_out(out
+0001d2f0: 2c20 7265 7375 6c74 290a 0a20 2020 2040  , result)..    @
+0001d300: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0001d310: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0001d320: 6566 2063 756d 7375 6d28 7365 6c66 2c20  ef cumsum(self, 
+0001d330: 6178 6973 3d4e 6f6e 652c 2073 6b69 706e  axis=None, skipn
+0001d340: 613d 5472 7565 2c20 6474 7970 653d 4e6f  a=True, dtype=No
+0001d350: 6e65 2c20 6f75 743d 4e6f 6e65 293a 0a20  ne, out=None):. 
+0001d360: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001d370: 6c66 2e5f 6375 6d5f 6167 6728 0a20 2020  lf._cum_agg(.   
+0001d380: 2020 2020 2020 2020 2022 6375 6d73 756d           "cumsum
+0001d390: 222c 0a20 2020 2020 2020 2020 2020 2063  ",.            c
+0001d3a0: 6875 6e6b 3d4d 2e63 756d 7375 6d2c 0a20  hunk=M.cumsum,. 
+0001d3b0: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
+0001d3c0: 6761 7465 3d6d 6574 686f 6473 2e63 756d  gate=methods.cum
+0001d3d0: 7375 6d5f 6167 6772 6567 6174 652c 0a20  sum_aggregate,. 
+0001d3e0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+0001d3f0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+0001d400: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
+0001d410: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
+0001d420: 6e6b 5f6b 7761 7267 733d 6469 6374 2861  nk_kwargs=dict(a
+0001d430: 7869 733d 6178 6973 2c20 736b 6970 6e61  xis=axis, skipna
+0001d440: 3d73 6b69 706e 6129 2c0a 2020 2020 2020  =skipna),.      
+0001d450: 2020 2020 2020 6f75 743d 6f75 742c 0a20        out=out,. 
+0001d460: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+0001d470: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0001d480: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0001d490: 6620 6375 6d70 726f 6428 7365 6c66 2c20  f cumprod(self, 
+0001d4a0: 6178 6973 3d4e 6f6e 652c 2073 6b69 706e  axis=None, skipn
+0001d4b0: 613d 5472 7565 2c20 6474 7970 653d 4e6f  a=True, dtype=No
+0001d4c0: 6e65 2c20 6f75 743d 4e6f 6e65 293a 0a20  ne, out=None):. 
+0001d4d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001d4e0: 6c66 2e5f 6375 6d5f 6167 6728 0a20 2020  lf._cum_agg(.   
+0001d4f0: 2020 2020 2020 2020 2022 6375 6d70 726f           "cumpro
+0001d500: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+0001d510: 6368 756e 6b3d 4d2e 6375 6d70 726f 642c  chunk=M.cumprod,
+0001d520: 0a20 2020 2020 2020 2020 2020 2061 6767  .            agg
+0001d530: 7265 6761 7465 3d6d 6574 686f 6473 2e63  regate=methods.c
+0001d540: 756d 7072 6f64 5f61 6767 7265 6761 7465  umprod_aggregate
+0001d550: 2c0a 2020 2020 2020 2020 2020 2020 6178  ,.            ax
+0001d560: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+0001d570: 2020 2020 2073 6b69 706e 613d 736b 6970       skipna=skip
+0001d580: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
+0001d590: 6368 756e 6b5f 6b77 6172 6773 3d64 6963  chunk_kwargs=dic
+0001d5a0: 7428 6178 6973 3d61 7869 732c 2073 6b69  t(axis=axis, ski
+0001d5b0: 706e 613d 736b 6970 6e61 292c 0a20 2020  pna=skipna),.   
+0001d5c0: 2020 2020 2020 2020 206f 7574 3d6f 7574           out=out
+0001d5d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0001d5e0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+0001d5f0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+0001d600: 2064 6566 2063 756d 6d61 7828 7365 6c66   def cummax(self
+0001d610: 2c20 6178 6973 3d4e 6f6e 652c 2073 6b69  , axis=None, ski
+0001d620: 706e 613d 5472 7565 2c20 6f75 743d 4e6f  pna=True, out=No
+0001d630: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
+0001d640: 7572 6e20 7365 6c66 2e5f 6375 6d5f 6167  urn self._cum_ag
+0001d650: 6728 0a20 2020 2020 2020 2020 2020 2022  g(.            "
+0001d660: 6375 6d6d 6178 222c 0a20 2020 2020 2020  cummax",.       
+0001d670: 2020 2020 2063 6875 6e6b 3d4d 2e63 756d       chunk=M.cum
+0001d680: 6d61 782c 0a20 2020 2020 2020 2020 2020  max,.           
+0001d690: 2061 6767 7265 6761 7465 3d6d 6574 686f   aggregate=metho
+0001d6a0: 6473 2e63 756d 6d61 785f 6167 6772 6567  ds.cummax_aggreg
+0001d6b0: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+0001d6c0: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
+0001d6d0: 2020 2020 2020 2020 736b 6970 6e61 3d73          skipna=s
+0001d6e0: 6b69 706e 612c 0a20 2020 2020 2020 2020  kipna,.         
+0001d6f0: 2020 2063 6875 6e6b 5f6b 7761 7267 733d     chunk_kwargs=
+0001d700: 6469 6374 2861 7869 733d 6178 6973 2c20  dict(axis=axis, 
+0001d710: 736b 6970 6e61 3d73 6b69 706e 6129 2c0a  skipna=skipna),.
+0001d720: 2020 2020 2020 2020 2020 2020 6f75 743d              out=
+0001d730: 6f75 742c 0a20 2020 2020 2020 2029 0a0a  out,.        )..
+0001d740: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+0001d750: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+0001d760: 2020 2020 6465 6620 6375 6d6d 696e 2873      def cummin(s
+0001d770: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
+0001d780: 736b 6970 6e61 3d54 7275 652c 206f 7574  skipna=True, out
+0001d790: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+0001d7a0: 7265 7475 726e 2073 656c 662e 5f63 756d  return self._cum
+0001d7b0: 5f61 6767 280a 2020 2020 2020 2020 2020  _agg(.          
+0001d7c0: 2020 2263 756d 6d69 6e22 2c0a 2020 2020    "cummin",.    
+0001d7d0: 2020 2020 2020 2020 6368 756e 6b3d 4d2e          chunk=M.
+0001d7e0: 6375 6d6d 696e 2c0a 2020 2020 2020 2020  cummin,.        
+0001d7f0: 2020 2020 6167 6772 6567 6174 653d 6d65      aggregate=me
+0001d800: 7468 6f64 732e 6375 6d6d 696e 5f61 6767  thods.cummin_agg
+0001d810: 7265 6761 7465 2c0a 2020 2020 2020 2020  regate,.        
+0001d820: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
+0001d830: 2020 2020 2020 2020 2020 2073 6b69 706e             skipn
+0001d840: 613d 736b 6970 6e61 2c0a 2020 2020 2020  a=skipna,.      
+0001d850: 2020 2020 2020 6368 756e 6b5f 6b77 6172        chunk_kwar
+0001d860: 6773 3d64 6963 7428 6178 6973 3d61 7869  gs=dict(axis=axi
+0001d870: 732c 2073 6b69 706e 613d 736b 6970 6e61  s, skipna=skipna
+0001d880: 292c 0a20 2020 2020 2020 2020 2020 206f  ),.            o
+0001d890: 7574 3d6f 7574 2c0a 2020 2020 2020 2020  ut=out,.        
+0001d8a0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0001d8b0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0001d8c0: 6529 0a20 2020 2064 6566 2077 6865 7265  e).    def where
+0001d8d0: 2873 656c 662c 2063 6f6e 642c 206f 7468  (self, cond, oth
+0001d8e0: 6572 3d6e 702e 6e61 6e29 3a0a 2020 2020  er=np.nan):.    
+0001d8f0: 2020 2020 2320 636f 6e64 2061 6e64 206f      # cond and o
+0001d900: 7468 6572 206d 6179 2062 6520 6461 736b  ther may be dask
+0001d910: 2069 6e73 7461 6e63 652c 0a20 2020 2020   instance,.     
+0001d920: 2020 2023 2070 6173 7369 6e67 206d 6170     # passing map
+0001d930: 5f70 6172 7469 7469 6f6e 7320 7669 6120  _partitions via 
+0001d940: 6b65 7977 6f72 6420 7769 6c6c 206e 6f74  keyword will not
+0001d950: 2062 6520 616c 6967 6e65 640a 2020 2020   be aligned.    
+0001d960: 2020 2020 7265 7475 726e 206d 6170 5f70      return map_p
+0001d970: 6172 7469 7469 6f6e 7328 4d2e 7768 6572  artitions(M.wher
+0001d980: 652c 2073 656c 662c 2063 6f6e 642c 206f  e, self, cond, o
+0001d990: 7468 6572 2c20 656e 666f 7263 655f 6d65  ther, enforce_me
+0001d9a0: 7461 6461 7461 3d46 616c 7365 290a 0a20  tadata=False).. 
+0001d9b0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0001d9c0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0001d9d0: 2020 2064 6566 206d 6173 6b28 7365 6c66     def mask(self
+0001d9e0: 2c20 636f 6e64 2c20 6f74 6865 723d 6e70  , cond, other=np
+0001d9f0: 2e6e 616e 293a 0a20 2020 2020 2020 2072  .nan):.        r
+0001da00: 6574 7572 6e20 6d61 705f 7061 7274 6974  eturn map_partit
+0001da10: 696f 6e73 284d 2e6d 6173 6b2c 2073 656c  ions(M.mask, sel
+0001da20: 662c 2063 6f6e 642c 206f 7468 6572 2c20  f, cond, other, 
+0001da30: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+0001da40: 3d46 616c 7365 290a 0a20 2020 2040 6465  =False)..    @de
+0001da50: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0001da60: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0001da70: 206e 6f74 6e75 6c6c 2873 656c 6629 3a0a   notnull(self):.
+0001da80: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001da90: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+0001daa0: 6e73 284d 2e6e 6f74 6e75 6c6c 2c20 656e  ns(M.notnull, en
+0001dab0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+0001dac0: 616c 7365 290a 0a20 2020 2040 6465 7269  alse)..    @deri
+0001dad0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0001dae0: 4672 616d 6529 0a20 2020 2064 6566 2069  Frame).    def i
+0001daf0: 736e 756c 6c28 7365 6c66 293a 0a20 2020  snull(self):.   
+0001db00: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001db10: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+0001db20: 4d2e 6973 6e75 6c6c 2c20 656e 666f 7263  M.isnull, enforc
+0001db30: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+0001db40: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0001db50: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0001db60: 6529 0a20 2020 2064 6566 2069 736e 6128  e).    def isna(
+0001db70: 7365 6c66 293a 0a20 2020 2020 2020 2069  self):.        i
+0001db80: 6620 6861 7361 7474 7228 7064 2c20 2269  f hasattr(pd, "i
+0001db90: 736e 6122 293a 0a20 2020 2020 2020 2020  sna"):.         
+0001dba0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+0001dbb0: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
+0001dbc0: 6973 6e61 2c20 656e 666f 7263 655f 6d65  isna, enforce_me
+0001dbd0: 7461 6461 7461 3d46 616c 7365 290a 2020  tadata=False).  
+0001dbe0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001dbf0: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+0001dc00: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+0001dc10: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0001dc20: 2020 2022 4e65 6564 206d 6f72 6520 7265     "Need more re
+0001dc30: 6365 6e74 2076 6572 7369 6f6e 206f 6620  cent version of 
+0001dc40: 5061 6e64 6173 2022 0a20 2020 2020 2020  Pandas ".       
+0001dc50: 2020 2020 2020 2020 2022 746f 2073 7570           "to sup
+0001dc60: 706f 7274 2069 736e 612e 2022 0a20 2020  port isna. ".   
+0001dc70: 2020 2020 2020 2020 2020 2020 2022 506c               "Pl
+0001dc80: 6561 7365 2075 7365 2069 736e 756c 6c20  ease use isnull 
+0001dc90: 696e 7374 6561 642e 220a 2020 2020 2020  instead.".      
+0001dca0: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
+0001dcb0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0001dcc0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0001dcd0: 2069 7369 6e28 7365 6c66 2c20 7661 6c75   isin(self, valu
+0001dce0: 6573 293a 0a20 2020 2020 2020 2069 6620  es):.        if 
+0001dcf0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+0001dd00: 6528 7365 6c66 2e5f 6d65 7461 293a 0a20  e(self._meta):. 
+0001dd10: 2020 2020 2020 2020 2020 2023 2044 6174             # Dat
+0001dd20: 6146 7261 6d65 2e69 7369 6e20 646f 6573  aFrame.isin does
+0001dd30: 2077 6569 7264 2061 6c69 676e 6d65 6e74   weird alignment
+0001dd40: 2073 7475 6666 0a20 2020 2020 2020 2020   stuff.         
+0001dd50: 2020 2062 6164 5f74 7970 6573 203d 2028     bad_types = (
+0001dd60: 5f46 7261 6d65 2c20 7064 2e53 6572 6965  _Frame, pd.Serie
+0001dd70: 732c 2070 642e 4461 7461 4672 616d 6529  s, pd.DataFrame)
+0001dd80: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0001dd90: 2020 2020 2020 2020 2020 2062 6164 5f74             bad_t
+0001dda0: 7970 6573 203d 2028 5f46 7261 6d65 2c29  ypes = (_Frame,)
+0001ddb0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0001ddc0: 7374 616e 6365 2876 616c 7565 732c 2062  stance(values, b
+0001ddd0: 6164 5f74 7970 6573 293a 0a20 2020 2020  ad_types):.     
+0001dde0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+0001ddf0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+0001de00: 2822 5061 7373 696e 6720 6120 2572 2074  ("Passing a %r t
+0001de10: 6f20 6069 7369 6e60 2220 2520 7479 7065  o `isin`" % type
+0001de20: 6e61 6d65 2874 7970 6528 7661 6c75 6573  name(type(values
+0001de30: 2929 290a 2020 2020 2020 2020 6d65 7461  ))).        meta
+0001de40: 203d 2073 656c 662e 5f6d 6574 615f 6e6f   = self._meta_no
+0001de50: 6e65 6d70 7479 2e69 7369 6e28 7661 6c75  nempty.isin(valu
+0001de60: 6573 290a 2020 2020 2020 2020 2320 5765  es).        # We
+0001de70: 2077 7261 7020 7661 6c75 6573 2069 6e20   wrap values in 
+0001de80: 6120 6465 6c61 7965 6420 666f 7220 7477  a delayed for tw
+0001de90: 6f20 7265 6173 6f6e 733a 0a20 2020 2020  o reasons:.     
+0001dea0: 2020 2023 202d 2061 766f 6964 2073 6572     # - avoid ser
+0001deb0: 6961 6c69 7a69 6e67 2064 6174 6120 696e  ializing data in
+0001dec0: 2065 7665 7279 2074 6173 6b0a 2020 2020   every task.    
+0001ded0: 2020 2020 2320 2d20 6176 6f69 6420 636f      # - avoid co
+0001dee0: 7374 206f 6620 7472 6176 6572 7361 6c20  st of traversal 
+0001def0: 6f66 206c 6172 6765 206c 6973 7420 696e  of large list in
+0001df00: 206f 7074 696d 697a 6174 696f 6e73 0a20   optimizations. 
+0001df10: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0001df20: 616e 6365 2876 616c 7565 732c 206c 6973  ance(values, lis
+0001df30: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0001df40: 2320 4d6f 7469 7661 7465 6420 6279 2068  # Motivated by h
+0001df50: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+0001df60: 6d2f 6461 736b 2f64 6173 6b2f 6973 7375  m/dask/dask/issu
+0001df70: 6573 2f39 3431 312e 2020 5468 6973 2061  es/9411.  This a
+0001df80: 7070 6561 7273 2074 6f20 6265 0a20 2020  ppears to be.   
+0001df90: 2020 2020 2020 2020 2023 2063 6175 7365           # cause
+0001dfa0: 6420 6279 2068 7474 7073 3a2f 2f67 6974  d by https://git
+0001dfb0: 6875 622e 636f 6d2f 6461 736b 2f64 6973  hub.com/dask/dis
+0001dfc0: 7472 6962 7574 6564 2f69 7373 7565 732f  tributed/issues/
+0001dfd0: 3633 3638 2c20 616e 6420 6675 7274 6865  6368, and furthe
+0001dfe0: 720a 2020 2020 2020 2020 2020 2020 2320  r.            # 
+0001dff0: 6578 6163 6572 6261 7465 6420 6279 2074  exacerbated by t
+0001e000: 6865 2066 6163 7420 7468 6174 2074 6865  he fact that the
+0001e010: 206c 6973 7420 636f 6e74 6169 6e73 2064   list contains d
+0001e020: 7570 6c69 6361 7465 732e 2020 5468 6973  uplicates.  This
+0001e030: 2069 7320 6120 7061 7463 6820 756e 7469   is a patch unti
+0001e040: 6c0a 2020 2020 2020 2020 2020 2020 2320  l.            # 
+0001e050: 7765 2063 616e 2063 7265 6174 6520 6120  we can create a 
+0001e060: 6265 7474 6572 2066 6978 2066 6f72 2053  better fix for S
+0001e070: 6572 6961 6c69 7a61 7469 6f6e 2e0a 2020  erialization..  
+0001e080: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
+0001e090: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0001e0a0: 616c 7565 7320 3d20 6c69 7374 2873 6574  alues = list(set
+0001e0b0: 2876 616c 7565 7329 290a 2020 2020 2020  (values)).      
+0001e0c0: 2020 2020 2020 6578 6365 7074 2054 7970        except Typ
+0001e0d0: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
+0001e0e0: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
+0001e0f0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0001e100: 616e 7928 6973 5f64 6173 6b5f 636f 6c6c  any(is_dask_coll
+0001e110: 6563 7469 6f6e 2876 2920 666f 7220 7620  ection(v) for v 
+0001e120: 696e 2076 616c 7565 7329 3a0a 2020 2020  in values):.    
+0001e130: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+0001e140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e150: 2020 2020 2076 616c 7565 7320 3d20 6e70       values = np
+0001e160: 2e66 726f 6d69 7465 7228 7661 6c75 6573  .fromiter(values
+0001e170: 2c20 6474 7970 653d 6f62 6a65 6374 290a  , dtype=object).
+0001e180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e190: 6578 6365 7074 2056 616c 7565 4572 726f  except ValueErro
+0001e1a0: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+0001e1b0: 2020 2020 2020 2023 204e 756d 7079 2031         # Numpy 1
+0001e1c0: 2e32 3320 7375 7070 6f72 7473 2063 7265  .23 supports cre
+0001e1d0: 6174 696e 6720 6172 7261 7973 206f 6620  ating arrays of 
+0001e1e0: 6974 6572 6162 6c65 732c 2077 6869 6c65  iterables, while
+0001e1f0: 206c 6f77 6572 0a20 2020 2020 2020 2020   lower.         
+0001e200: 2020 2020 2020 2020 2020 2023 2076 6572             # ver
+0001e210: 7369 6f6e 2031 2e32 312e 7820 616e 6420  sion 1.21.x and 
+0001e220: 312e 3232 2e78 2064 6f20 6e6f 740a 2020  1.22.x do not.  
+0001e230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e240: 2020 7061 7373 0a20 2020 2020 2020 2072    pass.        r
+0001e250: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+0001e260: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0001e270: 2020 2020 2020 204d 2e69 7369 6e2c 2064         M.isin, d
+0001e280: 656c 6179 6564 2876 616c 7565 7329 2c20  elayed(values), 
+0001e290: 6d65 7461 3d6d 6574 612c 2065 6e66 6f72  meta=meta, enfor
+0001e2a0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+0001e2b0: 650a 2020 2020 2020 2020 290a 0a20 2020  e.        )..   
+0001e2c0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+0001e2d0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+0001e2e0: 2064 6566 2061 7374 7970 6528 7365 6c66   def astype(self
+0001e2f0: 2c20 6474 7970 6529 3a0a 2020 2020 2020  , dtype):.      
+0001e300: 2020 2320 5858 583a 2050 616e 6461 7320    # XXX: Pandas 
+0001e310: 7769 6c6c 2073 6567 6661 756c 7420 666f  will segfault fo
+0001e320: 7220 656d 7074 7920 6461 7461 6672 616d  r empty datafram
+0001e330: 6573 2077 6865 6e20 7365 7474 696e 670a  es when setting.
+0001e340: 2020 2020 2020 2020 2320 6361 7465 676f          # catego
+0001e350: 7269 6361 6c20 6474 7970 6573 2e20 5468  rical dtypes. Th
+0001e360: 6973 206f 7065 7261 7469 6f6e 2069 736e  is operation isn
+0001e370: 2774 2061 6c6c 6f77 6564 2063 7572 7265  't allowed curre
+0001e380: 6e74 6c79 2061 6e79 7761 792e 2057 650a  ntly anyway. We.
+0001e390: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+0001e3a0: 6520 6d65 7461 6461 7461 2077 6974 6820  e metadata with 
+0001e3b0: 6120 6e6f 6e2d 656d 7074 7920 6672 616d  a non-empty fram
+0001e3c0: 6520 746f 2074 6872 6f77 2074 6865 2065  e to throw the e
+0001e3d0: 7272 6f72 2069 6e73 7465 6164 206f 660a  rror instead of.
+0001e3e0: 2020 2020 2020 2020 2320 7365 6766 6175          # segfau
+0001e3f0: 6c74 696e 672e 0a20 2020 2020 2020 2069  lting..        i
+0001e400: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+0001e410: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+0001e420: 6528 7365 6c66 2e5f 6d65 7461 290a 2020  e(self._meta).  
+0001e430: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
+0001e440: 7420 6861 7361 7474 7228 6474 7970 652c  t hasattr(dtype,
+0001e450: 2022 6974 656d 7322 290a 2020 2020 2020   "items").      
+0001e460: 2020 2020 2020 616e 6420 6973 696e 7374        and isinst
+0001e470: 616e 6365 2870 642e 6170 692e 7479 7065  ance(pd.api.type
+0001e480: 732e 7061 6e64 6173 5f64 7479 7065 2864  s.pandas_dtype(d
+0001e490: 7479 7065 292c 2070 642e 4361 7465 676f  type), pd.Catego
+0001e4a0: 7269 6361 6c44 7479 7065 290a 2020 2020  ricalDtype).    
+0001e4b0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+0001e4c0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+0001e4d0: 6d65 7461 5f6e 6f6e 656d 7074 792e 6173  meta_nonempty.as
+0001e4e0: 7479 7065 2864 7479 7065 290a 2020 2020  type(dtype).    
+0001e4f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001e500: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
+0001e510: 662e 5f6d 6574 612e 6173 7479 7065 2864  f._meta.astype(d
+0001e520: 7479 7065 290a 2020 2020 2020 2020 6966  type).        if
+0001e530: 2068 6173 6174 7472 2864 7479 7065 2c20   hasattr(dtype, 
+0001e540: 2269 7465 6d73 2229 3a0a 2020 2020 2020  "items"):.      
+0001e550: 2020 2020 2020 7365 745f 756e 6b6e 6f77        set_unknow
+0001e560: 6e20 3d20 5b0a 2020 2020 2020 2020 2020  n = [.          
+0001e570: 2020 2020 2020 6b0a 2020 2020 2020 2020        k.        
+0001e580: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
+0001e590: 2069 6e20 6474 7970 652e 6974 656d 7328   in dtype.items(
+0001e5a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001e5b0: 2020 6966 2028 6973 696e 7374 616e 6365    if (isinstance
+0001e5c0: 2870 642e 6170 692e 7479 7065 732e 7061  (pd.api.types.pa
+0001e5d0: 6e64 6173 5f64 7479 7065 2876 292c 2070  ndas_dtype(v), p
+0001e5e0: 642e 4361 7465 676f 7269 6361 6c44 7479  d.CategoricalDty
+0001e5f0: 7065 2929 0a20 2020 2020 2020 2020 2020  pe)).           
+0001e600: 2020 2020 2061 6e64 2067 6574 6174 7472       and getattr
+0001e610: 2876 2c20 2263 6174 6567 6f72 6965 7322  (v, "categories"
+0001e620: 2c20 4e6f 6e65 2920 6973 204e 6f6e 650a  , None) is None.
+0001e630: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+0001e640: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
+0001e650: 2063 6c65 6172 5f6b 6e6f 776e 5f63 6174   clear_known_cat
+0001e660: 6567 6f72 6965 7328 6d65 7461 2c20 636f  egories(meta, co
+0001e670: 6c73 3d73 6574 5f75 6e6b 6e6f 776e 290a  ls=set_unknown).
+0001e680: 2020 2020 2020 2020 656c 6966 2028 0a20          elif (. 
+0001e690: 2020 2020 2020 2020 2020 2069 7369 6e73             isins
+0001e6a0: 7461 6e63 6528 7064 2e61 7069 2e74 7970  tance(pd.api.typ
+0001e6b0: 6573 2e70 616e 6461 735f 6474 7970 6528  es.pandas_dtype(
+0001e6c0: 6474 7970 6529 2c20 7064 2e43 6174 6567  dtype), pd.Categ
+0001e6d0: 6f72 6963 616c 4474 7970 6529 0a20 2020  oricalDtype).   
+0001e6e0: 2020 2020 2029 2061 6e64 2067 6574 6174       ) and getat
+0001e6f0: 7472 2864 7479 7065 2c20 2263 6174 6567  tr(dtype, "categ
+0001e700: 6f72 6965 7322 2c20 4e6f 6e65 2920 6973  ories", None) is
+0001e710: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0001e720: 2020 206d 6574 6120 3d20 636c 6561 725f     meta = clear_
+0001e730: 6b6e 6f77 6e5f 6361 7465 676f 7269 6573  known_categories
+0001e740: 286d 6574 6129 0a20 2020 2020 2020 2072  (meta).        r
+0001e750: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+0001e760: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0001e770: 2020 2020 2020 204d 2e61 7374 7970 652c         M.astype,
+0001e780: 2064 7479 7065 3d64 7479 7065 2c20 6d65   dtype=dtype, me
+0001e790: 7461 3d6d 6574 612c 2065 6e66 6f72 6365  ta=meta, enforce
+0001e7a0: 5f6d 6574 6164 6174 613d 4661 6c73 650a  _metadata=False.
+0001e7b0: 2020 2020 2020 2020 290a 0a20 2020 2069          )..    i
+0001e7c0: 6620 6e6f 7420 5041 4e44 4153 5f47 545f  f not PANDAS_GT_
+0001e7d0: 3230 303a 0a0a 2020 2020 2020 2020 4064  200:..        @d
+0001e7e0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+0001e7f0: 6572 6965 7329 0a20 2020 2020 2020 2064  eries).        d
+0001e800: 6566 2061 7070 656e 6428 7365 6c66 2c20  ef append(self, 
+0001e810: 6f74 6865 722c 2069 6e74 6572 6c65 6176  other, interleav
+0001e820: 655f 7061 7274 6974 696f 6e73 3d46 616c  e_partitions=Fal
+0001e830: 7365 293a 0a20 2020 2020 2020 2020 2020  se):.           
+0001e840: 2069 6620 5041 4e44 4153 5f47 545f 3134   if PANDAS_GT_14
+0001e850: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0001e860: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+0001e870: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001e880: 2020 2020 2020 2254 6865 2066 7261 6d65        "The frame
+0001e890: 2e61 7070 656e 6420 6d65 7468 6f64 2069  .append method i
+0001e8a0: 7320 6465 7072 6563 6174 6564 2061 6e64  s deprecated and
+0001e8b0: 2077 696c 6c20 6265 2072 656d 6f76 6564   will be removed
+0001e8c0: 2066 726f 6d22 0a20 2020 2020 2020 2020   from".         
+0001e8d0: 2020 2020 2020 2020 2020 2022 6461 736b             "dask
+0001e8e0: 2069 6e20 6120 6675 7475 7265 2076 6572   in a future ver
+0001e8f0: 7369 6f6e 2e20 5573 6520 6461 736b 2e64  sion. Use dask.d
+0001e900: 6174 6166 7261 6d65 2e63 6f6e 6361 7420  ataframe.concat 
+0001e910: 696e 7374 6561 642e 222c 0a20 2020 2020  instead.",.     
+0001e920: 2020 2020 2020 2020 2020 2020 2020 2046                 F
+0001e930: 7574 7572 6557 6172 6e69 6e67 2c0a 2020  utureWarning,.  
+0001e940: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0001e950: 2020 2020 2020 2020 2020 2020 2320 6265              # be
+0001e960: 6361 7573 6520 4461 7461 4672 616d 652e  cause DataFrame.
+0001e970: 6170 7065 6e64 2077 696c 6c20 6f76 6572  append will over
+0001e980: 7269 6465 2074 6865 206d 6574 686f 642c  ride the method,
+0001e990: 0a20 2020 2020 2020 2020 2020 2023 2077  .            # w
+0001e9a0: 7261 7020 6279 2070 642e 5365 7269 6573  rap by pd.Series
+0001e9b0: 2e61 7070 656e 6420 646f 6373 7472 696e  .append docstrin
+0001e9c0: 670a 2020 2020 2020 2020 2020 2020 6672  g.            fr
+0001e9d0: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+0001e9e0: 652e 6d75 6c74 6920 696d 706f 7274 2063  e.multi import c
+0001e9f0: 6f6e 6361 740a 0a20 2020 2020 2020 2020  oncat..         
+0001ea00: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0001ea10: 286f 7468 6572 2c20 286c 6973 742c 2064  (other, (list, d
+0001ea20: 6963 7429 293a 0a20 2020 2020 2020 2020  ict)):.         
+0001ea30: 2020 2020 2020 206d 7367 203d 2022 6170         msg = "ap
+0001ea40: 7065 6e64 2064 6f65 736e 2774 2073 7570  pend doesn't sup
+0001ea50: 706f 7274 206c 6973 7420 6f72 2064 6963  port list or dic
+0001ea60: 7420 696e 7075 7422 0a20 2020 2020 2020  t input".       
+0001ea70: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+0001ea80: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0001ea90: 6f72 286d 7367 290a 0a20 2020 2020 2020  or(msg)..       
+0001eaa0: 2020 2020 2072 6574 7572 6e20 636f 6e63       return conc
+0001eab0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+0001eac0: 2020 2020 5b73 656c 662c 206f 7468 6572      [self, other
+0001ead0: 5d2c 206a 6f69 6e3d 226f 7574 6572 222c  ], join="outer",
+0001eae0: 2069 6e74 6572 6c65 6176 655f 7061 7274   interleave_part
+0001eaf0: 6974 696f 6e73 3d69 6e74 6572 6c65 6176  itions=interleav
+0001eb00: 655f 7061 7274 6974 696f 6e73 0a20 2020  e_partitions.   
+0001eb10: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0001eb20: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0001eb30: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+0001eb40: 2064 6f74 2873 656c 662c 206f 7468 6572   dot(self, other
+0001eb50: 2c20 6d65 7461 3d6e 6f5f 6465 6661 756c  , meta=no_defaul
+0001eb60: 7429 3a0a 2020 2020 2020 2020 6966 206e  t):.        if n
+0001eb70: 6f74 2069 7369 6e73 7461 6e63 6528 6f74  ot isinstance(ot
+0001eb80: 6865 722c 205f 4672 616d 6529 3a0a 2020  her, _Frame):.  
+0001eb90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001eba0: 5479 7065 4572 726f 7228 2254 6865 2073  TypeError("The s
+0001ebb0: 6563 6f6e 6420 6f70 6572 616e 6420 6d75  econd operand mu
+0001ebc0: 7374 2062 6520 6120 6461 736b 2061 7272  st be a dask arr
+0001ebd0: 6179 206f 7220 6461 736b 2064 6174 6166  ay or dask dataf
+0001ebe0: 7261 6d65 2229 0a0a 2020 2020 2020 2020  rame")..        
+0001ebf0: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
+0001ec00: 6865 722c 2044 6174 6146 7261 6d65 293a  her, DataFrame):
+0001ec10: 0a20 2020 2020 2020 2020 2020 2073 203d  .            s =
+0001ec20: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+0001ec30: 696f 6e73 284d 2e64 6f74 2c20 6f74 6865  ions(M.dot, othe
+0001ec40: 722c 2074 6f6b 656e 3d22 646f 7422 2c20  r, token="dot", 
+0001ec50: 6d65 7461 3d6d 6574 6129 0a20 2020 2020  meta=meta).     
+0001ec60: 2020 2020 2020 2072 6574 7572 6e20 732e         return s.
+0001ec70: 6772 6f75 7062 7928 6279 3d73 2e69 6e64  groupby(by=s.ind
+0001ec80: 6578 292e 6170 706c 7928 0a20 2020 2020  ex).apply(.     
+0001ec90: 2020 2020 2020 2020 2020 206c 616d 6264             lambd
+0001eca0: 6120 783a 2078 2e73 756d 2873 6b69 706e  a x: x.sum(skipn
+0001ecb0: 613d 4661 6c73 6529 2c20 6d65 7461 3d73  a=False), meta=s
+0001ecc0: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 790a  ._meta_nonempty.
+0001ecd0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0001ece0: 2020 2020 2020 2064 6566 205f 646f 745f         def _dot_
+0001ecf0: 7365 7269 6573 282a 6172 6773 2c20 2a2a  series(*args, **
+0001ed00: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+0001ed10: 2020 2020 2023 202e 7375 6d28 2920 6973       # .sum() is
+0001ed20: 2069 6e76 6f6b 6564 206f 6e20 6561 6368   invoked on each
+0001ed30: 2070 6172 7469 7469 6f6e 2062 6566 6f72   partition befor
+0001ed40: 6520 6265 696e 6720 6170 706c 6965 6420  e being applied 
+0001ed50: 746f 2061 6c6c 0a20 2020 2020 2020 2020  to all.         
+0001ed60: 2020 2023 2070 6172 7469 7469 6f6e 732e     # partitions.
+0001ed70: 2054 6865 2072 6574 7572 6e20 7479 7065   The return type
+0001ed80: 2069 7320 6578 7065 6374 6564 2074 6f20   is expected to 
+0001ed90: 6265 2061 2073 6572 6965 732c 206e 6f74  be a series, not
+0001eda0: 2061 206e 756d 7079 206f 626a 6563 740a   a numpy object.
+0001edb0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001edc0: 726e 206d 6574 615f 7365 7269 6573 5f63  rn meta_series_c
+0001edd0: 6f6e 7374 7275 6374 6f72 2873 656c 6629  onstructor(self)
+0001ede0: 284d 2e64 6f74 282a 6172 6773 2c20 2a2a  (M.dot(*args, **
+0001edf0: 6b77 6172 6773 2929 0a0a 2020 2020 2020  kwargs))..      
+0001ee00: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
+0001ee10: 705f 7061 7274 6974 696f 6e73 285f 646f  p_partitions(_do
+0001ee20: 745f 7365 7269 6573 2c20 6f74 6865 722c  t_series, other,
+0001ee30: 2074 6f6b 656e 3d22 646f 7422 2c20 6d65   token="dot", me
+0001ee40: 7461 3d6d 6574 6129 2e73 756d 280a 2020  ta=meta).sum(.  
+0001ee50: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
+0001ee60: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
+0001ee70: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+0001ee80: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+0001ee90: 290a 2020 2020 6465 6620 616c 6967 6e28  ).    def align(
+0001eea0: 7365 6c66 2c20 6f74 6865 722c 206a 6f69  self, other, joi
+0001eeb0: 6e3d 226f 7574 6572 222c 2061 7869 733d  n="outer", axis=
+0001eec0: 4e6f 6e65 2c20 6669 6c6c 5f76 616c 7565  None, fill_value
+0001eed0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+0001eee0: 6d65 7461 312c 206d 6574 6132 203d 205f  meta1, meta2 = _
+0001eef0: 656d 756c 6174 6528 0a20 2020 2020 2020  emulate(.       
+0001ef00: 2020 2020 204d 2e61 6c69 676e 2c20 7365       M.align, se
+0001ef10: 6c66 2c20 6f74 6865 722c 206a 6f69 6e2c  lf, other, join,
+0001ef20: 2061 7869 733d 6178 6973 2c20 6669 6c6c   axis=axis, fill
+0001ef30: 5f76 616c 7565 3d66 696c 6c5f 7661 6c75  _value=fill_valu
+0001ef40: 650a 2020 2020 2020 2020 290a 2020 2020  e.        ).    
+0001ef50: 2020 2020 616c 6967 6e65 6420 3d20 7365      aligned = se
+0001ef60: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+0001ef70: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
+0001ef80: 2e61 6c69 676e 2c0a 2020 2020 2020 2020  .align,.        
+0001ef90: 2020 2020 6f74 6865 722c 0a20 2020 2020      other,.     
+0001efa0: 2020 2020 2020 206a 6f69 6e3d 6a6f 696e         join=join
+0001efb0: 2c0a 2020 2020 2020 2020 2020 2020 6178  ,.            ax
+0001efc0: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+0001efd0: 2020 2020 2066 696c 6c5f 7661 6c75 653d       fill_value=
+0001efe0: 6669 6c6c 5f76 616c 7565 2c0a 2020 2020  fill_value,.    
+0001eff0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
+0001f000: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
+0001f010: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0001f020: 2020 2074 6f6b 656e 203d 2074 6f6b 656e     token = token
+0001f030: 697a 6528 7365 6c66 2c20 6f74 6865 722c  ize(self, other,
+0001f040: 206a 6f69 6e2c 2061 7869 732c 2066 696c   join, axis, fil
+0001f050: 6c5f 7661 6c75 6529 0a0a 2020 2020 2020  l_value)..      
+0001f060: 2020 6e61 6d65 3120 3d20 2261 6c69 676e    name1 = "align
+0001f070: 312d 2220 2b20 746f 6b65 6e0a 2020 2020  1-" + token.    
+0001f080: 2020 2020 6473 6b31 203d 207b 0a20 2020      dsk1 = {.   
+0001f090: 2020 2020 2020 2020 2028 6e61 6d65 312c           (name1,
+0001f0a0: 2069 293a 2028 6765 7469 7465 6d2c 206b   i): (getitem, k
+0001f0b0: 6579 2c20 3029 0a20 2020 2020 2020 2020  ey, 0).         
+0001f0c0: 2020 2066 6f72 2069 2c20 6b65 7920 696e     for i, key in
+0001f0d0: 2065 6e75 6d65 7261 7465 2861 6c69 676e   enumerate(align
+0001f0e0: 6564 2e5f 5f64 6173 6b5f 6b65 7973 5f5f  ed.__dask_keys__
+0001f0f0: 2829 290a 2020 2020 2020 2020 7d0a 2020  ()).        }.  
+0001f100: 2020 2020 2020 6473 6b31 2e75 7064 6174        dsk1.updat
+0001f110: 6528 616c 6967 6e65 642e 6461 736b 290a  e(aligned.dask).
+0001f120: 2020 2020 2020 2020 7265 7375 6c74 3120          result1 
+0001f130: 3d20 6e65 775f 6464 5f6f 626a 6563 7428  = new_dd_object(
+0001f140: 6473 6b31 2c20 6e61 6d65 312c 206d 6574  dsk1, name1, met
+0001f150: 6131 2c20 616c 6967 6e65 642e 6469 7669  a1, aligned.divi
+0001f160: 7369 6f6e 7329 0a0a 2020 2020 2020 2020  sions)..        
+0001f170: 6e61 6d65 3220 3d20 2261 6c69 676e 322d  name2 = "align2-
+0001f180: 2220 2b20 746f 6b65 6e0a 2020 2020 2020  " + token.      
+0001f190: 2020 6473 6b32 203d 207b 0a20 2020 2020    dsk2 = {.     
+0001f1a0: 2020 2020 2020 2028 6e61 6d65 322c 2069         (name2, i
+0001f1b0: 293a 2028 6765 7469 7465 6d2c 206b 6579  ): (getitem, key
+0001f1c0: 2c20 3129 0a20 2020 2020 2020 2020 2020  , 1).           
+0001f1d0: 2066 6f72 2069 2c20 6b65 7920 696e 2065   for i, key in e
+0001f1e0: 6e75 6d65 7261 7465 2861 6c69 676e 6564  numerate(aligned
+0001f1f0: 2e5f 5f64 6173 6b5f 6b65 7973 5f5f 2829  .__dask_keys__()
+0001f200: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
+0001f210: 2020 2020 6473 6b32 2e75 7064 6174 6528      dsk2.update(
+0001f220: 616c 6967 6e65 642e 6461 736b 290a 2020  aligned.dask).  
+0001f230: 2020 2020 2020 7265 7375 6c74 3220 3d20        result2 = 
+0001f240: 6e65 775f 6464 5f6f 626a 6563 7428 6473  new_dd_object(ds
+0001f250: 6b32 2c20 6e61 6d65 322c 206d 6574 6132  k2, name2, meta2
+0001f260: 2c20 616c 6967 6e65 642e 6469 7669 7369  , aligned.divisi
+0001f270: 6f6e 7329 0a0a 2020 2020 2020 2020 7265  ons)..        re
+0001f280: 7475 726e 2072 6573 756c 7431 2c20 7265  turn result1, re
+0001f290: 7375 6c74 320a 0a20 2020 2040 6465 7269  sult2..    @deri
+0001f2a0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0001f2b0: 4672 616d 6529 0a20 2020 2064 6566 2063  Frame).    def c
+0001f2c0: 6f6d 6269 6e65 2873 656c 662c 206f 7468  ombine(self, oth
+0001f2d0: 6572 2c20 6675 6e63 2c20 6669 6c6c 5f76  er, func, fill_v
+0001f2e0: 616c 7565 3d4e 6f6e 652c 206f 7665 7277  alue=None, overw
+0001f2f0: 7269 7465 3d54 7275 6529 3a0a 2020 2020  rite=True):.    
+0001f300: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001f310: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+0001f320: 2020 2020 2020 2020 2020 2020 4d2e 636f              M.co
+0001f330: 6d62 696e 652c 206f 7468 6572 2c20 6675  mbine, other, fu
+0001f340: 6e63 2c20 6669 6c6c 5f76 616c 7565 3d66  nc, fill_value=f
+0001f350: 696c 6c5f 7661 6c75 652c 206f 7665 7277  ill_value, overw
+0001f360: 7269 7465 3d6f 7665 7277 7269 7465 0a20  rite=overwrite. 
+0001f370: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+0001f380: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0001f390: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0001f3a0: 6620 636f 6d62 696e 655f 6669 7273 7428  f combine_first(
+0001f3b0: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
+0001f3c0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001f3d0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+0001f3e0: 284d 2e63 6f6d 6269 6e65 5f66 6972 7374  (M.combine_first
+0001f3f0: 2c20 6f74 6865 7229 0a0a 2020 2020 4063  , other)..    @c
+0001f400: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
+0001f410: 6566 205f 6269 6e64 5f6f 7065 7261 746f  ef _bind_operato
+0001f420: 725f 6d65 7468 6f64 2863 6c73 2c20 6e61  r_method(cls, na
+0001f430: 6d65 2c20 6f70 2c20 6f72 6967 696e 616c  me, op, original
+0001f440: 3d70 642e 4461 7461 4672 616d 6529 3a0a  =pd.DataFrame):.
+0001f450: 2020 2020 2020 2020 2222 2262 696e 6420          """bind 
+0001f460: 6f70 6572 6174 6f72 206d 6574 686f 6420  operator method 
+0001f470: 6c69 6b65 2044 6174 6146 7261 6d65 2e61  like DataFrame.a
+0001f480: 6464 2074 6f20 7468 6973 2063 6c61 7373  dd to this class
+0001f490: 2222 220a 2020 2020 2020 2020 7261 6973  """.        rais
+0001f4a0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+0001f4b0: 4572 726f 720a 0a20 2020 2040 6465 7269  Error..    @deri
+0001f4c0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0001f4d0: 4672 616d 6529 0a20 2020 2064 6566 2072  Frame).    def r
+0001f4e0: 6573 616d 706c 6528 7365 6c66 2c20 7275  esample(self, ru
+0001f4f0: 6c65 2c20 636c 6f73 6564 3d4e 6f6e 652c  le, closed=None,
+0001f500: 206c 6162 656c 3d4e 6f6e 6529 3a0a 2020   label=None):.  
+0001f510: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+0001f520: 6461 7461 6672 616d 652e 7473 6572 6965  dataframe.tserie
+0001f530: 732e 7265 7361 6d70 6c65 2069 6d70 6f72  s.resample impor
+0001f540: 7420 5265 7361 6d70 6c65 720a 0a20 2020  t Resampler..   
+0001f550: 2020 2020 2072 6574 7572 6e20 5265 7361       return Resa
+0001f560: 6d70 6c65 7228 7365 6c66 2c20 7275 6c65  mpler(self, rule
+0001f570: 2c20 636c 6f73 6564 3d63 6c6f 7365 642c  , closed=closed,
+0001f580: 206c 6162 656c 3d6c 6162 656c 290a 0a20   label=label).. 
+0001f590: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0001f5a0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0001f5b0: 2020 2064 6566 2066 6972 7374 2873 656c     def first(sel
+0001f5c0: 662c 206f 6666 7365 7429 3a0a 2020 2020  f, offset):.    
+0001f5d0: 2020 2020 2320 4c65 7420 7061 6e64 6173      # Let pandas
+0001f5e0: 2065 7272 6f72 206f 6e20 6261 6420 6172   error on bad ar
+0001f5f0: 6773 0a20 2020 2020 2020 2073 656c 662e  gs.        self.
+0001f600: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e66  _meta_nonempty.f
+0001f610: 6972 7374 286f 6666 7365 7429 0a0a 2020  irst(offset)..  
+0001f620: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+0001f630: 662e 6b6e 6f77 6e5f 6469 7669 7369 6f6e  f.known_division
+0001f640: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+0001f650: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0001f660: 2260 6669 7273 7460 2069 7320 6e6f 7420  "`first` is not 
+0001f670: 696d 706c 656d 656e 7465 6420 666f 7220  implemented for 
+0001f680: 756e 6b6e 6f77 6e20 6469 7669 7369 6f6e  unknown division
+0001f690: 7322 290a 0a20 2020 2020 2020 206f 6666  s")..        off
+0001f6a0: 7365 7420 3d20 7064 2e74 7365 7269 6573  set = pd.tseries
+0001f6b0: 2e66 7265 7175 656e 6369 6573 2e74 6f5f  .frequencies.to_
+0001f6c0: 6f66 6673 6574 286f 6666 7365 7429 0a20  offset(offset). 
+0001f6d0: 2020 2020 2020 2064 6174 6520 3d20 7365         date = se
+0001f6e0: 6c66 2e64 6976 6973 696f 6e73 5b30 5d20  lf.divisions[0] 
+0001f6f0: 2b20 6f66 6673 6574 0a20 2020 2020 2020  + offset.       
+0001f700: 2065 6e64 203d 2073 656c 662e 6c6f 632e   end = self.loc.
+0001f710: 5f67 6574 5f70 6172 7469 7469 6f6e 7328  _get_partitions(
+0001f720: 6461 7465 290a 0a20 2020 2020 2020 2069  date)..        i
+0001f730: 735f 616e 6368 6f72 6564 203d 206f 6666  s_anchored = off
+0001f740: 7365 742e 6973 5f61 6e63 686f 7265 6428  set.is_anchored(
+0001f750: 290a 0a20 2020 2020 2020 2069 6e63 6c75  )..        inclu
+0001f760: 6465 5f72 6967 6874 203d 2069 735f 616e  de_right = is_an
+0001f770: 6368 6f72 6564 206f 7220 6e6f 7420 6861  chored or not ha
+0001f780: 7361 7474 7228 6f66 6673 6574 2c20 2264  sattr(offset, "d
+0001f790: 656c 7461 2229 0a0a 2020 2020 2020 2020  elta")..        
+0001f7a0: 6966 2065 6e64 203d 3d20 7365 6c66 2e6e  if end == self.n
+0001f7b0: 7061 7274 6974 696f 6e73 202d 2031 3a0a  partitions - 1:.
+0001f7c0: 2020 2020 2020 2020 2020 2020 6469 7673              divs
+0001f7d0: 203d 2073 656c 662e 6469 7669 7369 6f6e   = self.division
+0001f7e0: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
+0001f7f0: 2020 2020 2020 2020 2020 2020 6469 7673              divs
+0001f800: 203d 2073 656c 662e 6469 7669 7369 6f6e   = self.division
+0001f810: 735b 3a20 656e 6420 2b20 315d 202b 2028  s[: end + 1] + (
+0001f820: 6461 7465 2c29 0a0a 2020 2020 2020 2020  date,)..        
+0001f830: 6e61 6d65 203d 2022 6669 7273 742d 2220  name = "first-" 
+0001f840: 2b20 746f 6b65 6e69 7a65 2873 656c 662c  + tokenize(self,
+0001f850: 206f 6666 7365 7429 0a20 2020 2020 2020   offset).       
+0001f860: 2064 736b 203d 207b 286e 616d 652c 2069   dsk = {(name, i
+0001f870: 293a 2028 7365 6c66 2e5f 6e61 6d65 2c20  ): (self._name, 
+0001f880: 6929 2066 6f72 2069 2069 6e20 7261 6e67  i) for i in rang
+0001f890: 6528 656e 6429 7d0a 2020 2020 2020 2020  e(end)}.        
+0001f8a0: 6473 6b5b 286e 616d 652c 2065 6e64 295d  dsk[(name, end)]
+0001f8b0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+0001f8c0: 206d 6574 686f 6473 2e62 6f75 6e64 6172   methods.boundar
+0001f8d0: 795f 736c 6963 652c 0a20 2020 2020 2020  y_slice,.       
+0001f8e0: 2020 2020 2028 7365 6c66 2e5f 6e61 6d65       (self._name
+0001f8f0: 2c20 656e 6429 2c0a 2020 2020 2020 2020  , end),.        
+0001f900: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
+0001f910: 2020 2020 2020 6461 7465 2c0a 2020 2020        date,.    
+0001f920: 2020 2020 2020 2020 696e 636c 7564 655f          include_
+0001f930: 7269 6768 742c 0a20 2020 2020 2020 2020  right,.         
+0001f940: 2020 2054 7275 652c 0a20 2020 2020 2020     True,.       
+0001f950: 2029 0a20 2020 2020 2020 2067 7261 7068   ).        graph
+0001f960: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+0001f970: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+0001f980: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
+0001f990: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
+0001f9a0: 5d29 0a20 2020 2020 2020 2072 6574 7572  ]).        retur
+0001f9b0: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
+0001f9c0: 6772 6170 682c 206e 616d 652c 2073 656c  graph, name, sel
+0001f9d0: 662c 2064 6976 7329 0a0a 2020 2020 4064  f, divs)..    @d
+0001f9e0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0001f9f0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0001fa00: 6620 6c61 7374 2873 656c 662c 206f 6666  f last(self, off
+0001fa10: 7365 7429 3a0a 2020 2020 2020 2020 2320  set):.        # 
+0001fa20: 4c65 7420 7061 6e64 6173 2065 7272 6f72  Let pandas error
+0001fa30: 206f 6e20 6261 6420 6172 6773 0a20 2020   on bad args.   
+0001fa40: 2020 2020 2073 656c 662e 5f6d 6574 615f       self._meta_
+0001fa50: 6e6f 6e65 6d70 7479 2e66 6972 7374 286f  nonempty.first(o
+0001fa60: 6666 7365 7429 0a0a 2020 2020 2020 2020  ffset)..        
+0001fa70: 6966 206e 6f74 2073 656c 662e 6b6e 6f77  if not self.know
+0001fa80: 6e5f 6469 7669 7369 6f6e 733a 0a20 2020  n_divisions:.   
+0001fa90: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0001faa0: 616c 7565 4572 726f 7228 2260 6c61 7374  alueError("`last
+0001fab0: 6020 6973 206e 6f74 2069 6d70 6c65 6d65  ` is not impleme
+0001fac0: 6e74 6564 2066 6f72 2075 6e6b 6e6f 776e  nted for unknown
+0001fad0: 2064 6976 6973 696f 6e73 2229 0a0a 2020   divisions")..  
+0001fae0: 2020 2020 2020 6f66 6673 6574 203d 2070        offset = p
+0001faf0: 642e 7473 6572 6965 732e 6672 6571 7565  d.tseries.freque
+0001fb00: 6e63 6965 732e 746f 5f6f 6666 7365 7428  ncies.to_offset(
+0001fb10: 6f66 6673 6574 290a 2020 2020 2020 2020  offset).        
+0001fb20: 6461 7465 203d 2073 656c 662e 6469 7669  date = self.divi
+0001fb30: 7369 6f6e 735b 2d31 5d20 2d20 6f66 6673  sions[-1] - offs
+0001fb40: 6574 0a20 2020 2020 2020 2073 7461 7274  et.        start
+0001fb50: 203d 2073 656c 662e 6c6f 632e 5f67 6574   = self.loc._get
+0001fb60: 5f70 6172 7469 7469 6f6e 7328 6461 7465  _partitions(date
+0001fb70: 290a 0a20 2020 2020 2020 2069 6620 7374  )..        if st
+0001fb80: 6172 7420 3d3d 2030 3a0a 2020 2020 2020  art == 0:.      
+0001fb90: 2020 2020 2020 6469 7673 203d 2073 656c        divs = sel
+0001fba0: 662e 6469 7669 7369 6f6e 730a 2020 2020  f.divisions.    
+0001fbb0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001fbc0: 2020 2020 2020 6469 7673 203d 2028 6461        divs = (da
+0001fbd0: 7465 2c29 202b 2073 656c 662e 6469 7669  te,) + self.divi
+0001fbe0: 7369 6f6e 735b 7374 6172 7420 2b20 3120  sions[start + 1 
+0001fbf0: 3a5d 0a0a 2020 2020 2020 2020 6e61 6d65  :]..        name
+0001fc00: 203d 2022 6c61 7374 2d22 202b 2074 6f6b   = "last-" + tok
+0001fc10: 656e 697a 6528 7365 6c66 2c20 6f66 6673  enize(self, offs
+0001fc20: 6574 290a 2020 2020 2020 2020 6473 6b20  et).        dsk 
+0001fc30: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0001fc40: 286e 616d 652c 2069 202b 2031 293a 2028  (name, i + 1): (
+0001fc50: 7365 6c66 2e5f 6e61 6d65 2c20 6a20 2b20  self._name, j + 
+0001fc60: 3129 0a20 2020 2020 2020 2020 2020 2066  1).            f
+0001fc70: 6f72 2069 2c20 6a20 696e 2065 6e75 6d65  or i, j in enume
+0001fc80: 7261 7465 2872 616e 6765 2873 7461 7274  rate(range(start
+0001fc90: 2c20 7365 6c66 2e6e 7061 7274 6974 696f  , self.npartitio
+0001fca0: 6e73 2929 0a20 2020 2020 2020 207d 0a20  ns)).        }. 
+0001fcb0: 2020 2020 2020 2064 736b 5b28 6e61 6d65         dsk[(name
+0001fcc0: 2c20 3029 5d20 3d20 280a 2020 2020 2020  , 0)] = (.      
+0001fcd0: 2020 2020 2020 6d65 7468 6f64 732e 626f        methods.bo
+0001fce0: 756e 6461 7279 5f73 6c69 6365 2c0a 2020  undary_slice,.  
+0001fcf0: 2020 2020 2020 2020 2020 2873 656c 662e            (self.
+0001fd00: 5f6e 616d 652c 2073 7461 7274 292c 0a20  _name, start),. 
+0001fd10: 2020 2020 2020 2020 2020 2064 6174 652c             date,
+0001fd20: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
+0001fd30: 652c 0a20 2020 2020 2020 2020 2020 2054  e,.            T
+0001fd40: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+0001fd50: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+0001fd60: 290a 2020 2020 2020 2020 6772 6170 6820  ).        graph 
+0001fd70: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
+0001fd80: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
+0001fd90: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
+0001fda0: 656e 6465 6e63 6965 733d 5b73 656c 665d  endencies=[self]
+0001fdb0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0001fdc0: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
+0001fdd0: 7261 7068 2c20 6e61 6d65 2c20 7365 6c66  raph, name, self
+0001fde0: 2c20 6469 7673 290a 0a20 2020 2064 6566  , divs)..    def
+0001fdf0: 206e 756e 6971 7565 5f61 7070 726f 7828   nunique_approx(
+0001fe00: 7365 6c66 2c20 7370 6c69 745f 6576 6572  self, split_ever
+0001fe10: 793d 4e6f 6e65 293a 0a20 2020 2020 2020  y=None):.       
+0001fe20: 2022 2222 4170 7072 6f78 696d 6174 6520   """Approximate 
+0001fe30: 6e75 6d62 6572 206f 6620 756e 6971 7565  number of unique
+0001fe40: 2072 6f77 732e 0a0a 2020 2020 2020 2020   rows...        
+0001fe50: 5468 6973 206d 6574 686f 6420 7573 6573  This method uses
+0001fe60: 2074 6865 2048 7970 6572 4c6f 674c 6f67   the HyperLogLog
+0001fe70: 2061 6c67 6f72 6974 686d 2066 6f72 2063   algorithm for c
+0001fe80: 6172 6469 6e61 6c69 7479 0a20 2020 2020  ardinality.     
+0001fe90: 2020 2065 7374 696d 6174 696f 6e20 746f     estimation to
+0001fea0: 2063 6f6d 7075 7465 2074 6865 2061 7070   compute the app
+0001feb0: 726f 7869 6d61 7465 206e 756d 6265 7220  roximate number 
+0001fec0: 6f66 2075 6e69 7175 6520 726f 7773 2e0a  of unique rows..
+0001fed0: 2020 2020 2020 2020 5468 6520 6170 7072          The appr
+0001fee0: 6f78 696d 6174 6520 6572 726f 7220 6973  oximate error is
+0001fef0: 2030 2e34 3036 252e 0a0a 2020 2020 2020   0.406%...      
+0001ff00: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0001ff10: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+0001ff20: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+0001ff30: 6572 7920 3a20 696e 742c 206f 7074 696f  ery : int, optio
+0001ff40: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0001ff50: 4772 6f75 7020 7061 7274 6974 696f 6e73  Group partitions
+0001ff60: 2069 6e74 6f20 6772 6f75 7073 206f 6620   into groups of 
+0001ff70: 7468 6973 2073 697a 6520 7768 696c 6520  this size while 
+0001ff80: 7065 7266 6f72 6d69 6e67 2061 0a20 2020  performing a.   
+0001ff90: 2020 2020 2020 2020 2074 7265 652d 7265           tree-re
+0001ffa0: 6475 6374 696f 6e2e 2049 6620 7365 7420  duction. If set 
+0001ffb0: 746f 2046 616c 7365 2c20 6e6f 2074 7265  to False, no tre
+0001ffc0: 652d 7265 6475 6374 696f 6e20 7769 6c6c  e-reduction will
+0001ffd0: 2062 6520 7573 6564 2e0a 2020 2020 2020   be used..      
+0001ffe0: 2020 2020 2020 4465 6661 756c 7420 6973        Default is
+0001fff0: 2038 2e0a 0a20 2020 2020 2020 2052 6574   8...        Ret
+00020000: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+00020010: 2d2d 2d2d 0a20 2020 2020 2020 2061 2066  ----.        a f
+00020020: 6c6f 6174 2072 6570 7265 7365 6e74 696e  loat representin
+00020030: 6720 7468 6520 6170 7072 6f78 696d 6174  g the approximat
+00020040: 6520 6e75 6d62 6572 206f 6620 656c 656d  e number of elem
+00020050: 656e 7473 0a20 2020 2020 2020 2022 2222  ents.        """
+00020060: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+00020070: 736b 2e64 6174 6166 7261 6d65 2069 6d70  sk.dataframe imp
+00020080: 6f72 7420 6879 7065 726c 6f67 6c6f 6720  ort hyperloglog 
+00020090: 2023 2068 6572 6520 746f 2061 766f 6964   # here to avoid
+000200a0: 2063 6972 6375 6c61 7220 696d 706f 7274   circular import
+000200b0: 2069 7373 7565 730a 0a20 2020 2020 2020   issues..       
+000200c0: 2072 6574 7572 6e20 6163 6128 0a20 2020   return aca(.   
+000200d0: 2020 2020 2020 2020 205b 7365 6c66 5d2c           [self],
+000200e0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
+000200f0: 6e6b 3d68 7970 6572 6c6f 676c 6f67 2e63  nk=hyperloglog.c
+00020100: 6f6d 7075 7465 5f68 6c6c 5f61 7272 6179  ompute_hll_array
+00020110: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+00020120: 6d62 696e 653d 6879 7065 726c 6f67 6c6f  mbine=hyperloglo
+00020130: 672e 7265 6475 6365 5f73 7461 7465 2c0a  g.reduce_state,.
+00020140: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
+00020150: 6567 6174 653d 6879 7065 726c 6f67 6c6f  egate=hyperloglo
+00020160: 672e 6573 7469 6d61 7465 5f63 6f75 6e74  g.estimate_count
+00020170: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+00020180: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+00020190: 6576 6572 792c 0a20 2020 2020 2020 2020  every,.         
+000201a0: 2020 2062 3d31 362c 0a20 2020 2020 2020     b=16,.       
+000201b0: 2020 2020 206d 6574 613d 666c 6f61 742c       meta=float,
+000201c0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000201d0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+000201e0: 6620 7661 6c75 6573 2873 656c 6629 3a0a  f values(self):.
+000201f0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00020200: 6e20 6120 6461 736b 2e61 7272 6179 206f  n a dask.array o
+00020210: 6620 7468 6520 7661 6c75 6573 206f 6620  f the values of 
+00020220: 7468 6973 2064 6174 6166 7261 6d65 0a0a  this dataframe..
+00020230: 2020 2020 2020 2020 5761 726e 696e 673a          Warning:
+00020240: 2054 6869 7320 6372 6561 7465 7320 6120   This creates a 
+00020250: 6461 736b 2e61 7272 6179 2077 6974 686f  dask.array witho
+00020260: 7574 2070 7265 6369 7365 2073 6861 7065  ut precise shape
+00020270: 2069 6e66 6f72 6d61 7469 6f6e 2e0a 2020   information..  
+00020280: 2020 2020 2020 4f70 6572 6174 696f 6e73        Operations
+00020290: 2074 6861 7420 6465 7065 6e64 206f 6e20   that depend on 
+000202a0: 7368 6170 6520 696e 666f 726d 6174 696f  shape informatio
+000202b0: 6e2c 206c 696b 6520 736c 6963 696e 6720  n, like slicing 
+000202c0: 6f72 2072 6573 6861 7069 6e67 2c0a 2020  or reshaping,.  
+000202d0: 2020 2020 2020 7769 6c6c 206e 6f74 2077        will not w
+000202e0: 6f72 6b2e 0a20 2020 2020 2020 2022 2222  ork..        """
+000202f0: 0a20 2020 2020 2020 2069 6620 6973 5f65  .        if is_e
+00020300: 7874 656e 7369 6f6e 5f61 7272 6179 5f64  xtension_array_d
+00020310: 7479 7065 2873 656c 662e 5f6d 6574 612e  type(self._meta.
+00020320: 7661 6c75 6573 293a 0a20 2020 2020 2020  values):.       
+00020330: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00020340: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+00020350: 2020 2020 2244 6173 6b20 6375 7272 656e      "Dask curren
+00020360: 746c 7920 6861 7320 6c69 6d69 7465 6420  tly has limited 
+00020370: 7375 7070 6f72 7420 666f 7220 636f 6e76  support for conv
+00020380: 6572 7469 6e67 2070 616e 6461 7320 6578  erting pandas ex
+00020390: 7465 6e73 696f 6e20 6474 7970 6573 2022  tension dtypes "
+000203a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000203b0: 2066 2274 6f20 6172 7261 7973 2e20 436f   f"to arrays. Co
+000203c0: 6e76 6572 7469 6e67 207b 7365 6c66 2e5f  nverting {self._
+000203d0: 6d65 7461 2e76 616c 7565 732e 6474 7970  meta.values.dtyp
+000203e0: 657d 2074 6f20 6f62 6a65 6374 2064 7479  e} to object dty
+000203f0: 7065 2e22 2c0a 2020 2020 2020 2020 2020  pe.",.          
+00020400: 2020 2020 2020 5573 6572 5761 726e 696e        UserWarnin
+00020410: 672c 0a20 2020 2020 2020 2020 2020 2029  g,.            )
+00020420: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00020430: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
+00020440: 6f6e 7328 6d65 7468 6f64 732e 7661 6c75  ons(methods.valu
+00020450: 6573 290a 0a20 2020 2064 6566 205f 7661  es)..    def _va
+00020460: 6c69 6461 7465 5f63 6875 6e6b 7328 7365  lidate_chunks(se
+00020470: 6c66 2c20 6172 722c 206c 656e 6774 6873  lf, arr, lengths
+00020480: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
+00020490: 6461 736b 2e61 7272 6179 2e63 6f72 6520  dask.array.core 
+000204a0: 696d 706f 7274 206e 6f72 6d61 6c69 7a65  import normalize
+000204b0: 5f63 6875 6e6b 730a 0a20 2020 2020 2020  _chunks..       
+000204c0: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
+000204d0: 656e 6774 6873 2c20 5365 7175 656e 6365  engths, Sequence
+000204e0: 293a 0a20 2020 2020 2020 2020 2020 206c  ):.            l
+000204f0: 656e 6774 6873 203d 2074 7570 6c65 286c  engths = tuple(l
+00020500: 656e 6774 6873 290a 0a20 2020 2020 2020  engths)..       
+00020510: 2020 2020 2069 6620 6c65 6e28 6c65 6e67       if len(leng
+00020520: 7468 7329 2021 3d20 7365 6c66 2e6e 7061  ths) != self.npa
+00020530: 7274 6974 696f 6e73 3a0a 2020 2020 2020  rtitions:.      
+00020540: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00020550: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00020560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020570: 2254 6865 206e 756d 6265 7220 6f66 2069  "The number of i
+00020580: 7465 6d73 2069 6e20 276c 656e 6774 6873  tems in 'lengths
+00020590: 2720 646f 6573 206e 6f74 206d 6174 6368  ' does not match
+000205a0: 2074 6865 206e 756d 6265 7220 6f66 2022   the number of "
+000205b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000205c0: 2020 2020 2066 2270 6172 7469 7469 6f6e       f"partition
+000205d0: 732e 207b 6c65 6e28 6c65 6e67 7468 7329  s. {len(lengths)
+000205e0: 7d20 213d 207b 7365 6c66 2e6e 7061 7274  } != {self.npart
+000205f0: 6974 696f 6e73 7d22 0a20 2020 2020 2020  itions}".       
+00020600: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00020610: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00020620: 6e64 696d 203d 3d20 313a 0a20 2020 2020  ndim == 1:.     
+00020630: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+00020640: 7320 3d20 6e6f 726d 616c 697a 655f 6368  s = normalize_ch
+00020650: 756e 6b73 2828 6c65 6e67 7468 732c 2929  unks((lengths,))
+00020660: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00020670: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00020680: 2020 2063 6875 6e6b 7320 3d20 6e6f 726d     chunks = norm
+00020690: 616c 697a 655f 6368 756e 6b73 2828 6c65  alize_chunks((le
+000206a0: 6e67 7468 732c 2028 6c65 6e28 7365 6c66  ngths, (len(self
+000206b0: 2e63 6f6c 756d 6e73 292c 2929 290a 0a20  .columns),))).. 
+000206c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000206d0: 6e20 6368 756e 6b73 0a20 2020 2020 2020  n chunks.       
+000206e0: 2065 6c69 6620 6c65 6e67 7468 7320 6973   elif lengths is
+000206f0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00020700: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00020710: 7565 4572 726f 7228 6622 556e 6578 7065  ueError(f"Unexpe
+00020720: 6374 6564 2076 616c 7565 2066 6f72 2027  cted value for '
+00020730: 6c65 6e67 7468 7327 3a20 277b 6c65 6e67  lengths': '{leng
+00020740: 7468 737d 2722 290a 0a20 2020 2020 2020  ths}'")..       
+00020750: 2072 6574 7572 6e20 6172 722e 5f63 6875   return arr._chu
+00020760: 6e6b 730a 0a20 2020 2064 6566 205f 6973  nks..    def _is
+00020770: 5f69 6e64 6578 5f6c 6576 656c 5f72 6566  _index_level_ref
+00020780: 6572 656e 6365 2873 656c 662c 206b 6579  erence(self, key
+00020790: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+000207a0: 2020 2020 2020 2054 6573 7420 7768 6574         Test whet
+000207b0: 6865 7220 6120 6b65 7920 6973 2061 6e20  her a key is an 
+000207c0: 696e 6465 7820 6c65 7665 6c20 7265 6665  index level refe
+000207d0: 7265 6e63 650a 0a20 2020 2020 2020 2054  rence..        T
+000207e0: 6f20 6265 2063 6f6e 7369 6465 7265 6420  o be considered 
+000207f0: 616e 2069 6e64 6578 206c 6576 656c 2072  an index level r
+00020800: 6566 6572 656e 6365 2c20 606b 6579 6020  eference, `key` 
+00020810: 6d75 7374 206d 6174 6368 2074 6865 2069  must match the i
+00020820: 6e64 6578 206e 616d 650a 2020 2020 2020  ndex name.      
+00020830: 2020 616e 6420 6d75 7374 204e 4f54 206d    and must NOT m
+00020840: 6174 6368 2074 6865 206e 616d 6520 6f66  atch the name of
+00020850: 2061 6e79 2063 6f6c 756d 6e20 2869 6620   any column (if 
+00020860: 6120 6461 7461 6672 616d 6529 2e0a 2020  a dataframe)..  
+00020870: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00020880: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
+00020890: 2020 2020 2020 2073 656c 662e 696e 6465         self.inde
+000208a0: 782e 6e61 6d65 2069 7320 6e6f 7420 4e6f  x.name is not No
+000208b0: 6e65 0a20 2020 2020 2020 2020 2020 2061  ne.            a
+000208c0: 6e64 206e 6f74 2069 735f 6461 736b 5f63  nd not is_dask_c
+000208d0: 6f6c 6c65 6374 696f 6e28 6b65 7929 0a20  ollection(key). 
+000208e0: 2020 2020 2020 2020 2020 2061 6e64 2028             and (
+000208f0: 6e70 2e69 7373 6361 6c61 7228 6b65 7929  np.isscalar(key)
+00020900: 206f 7220 6973 696e 7374 616e 6365 286b   or isinstance(k
+00020910: 6579 2c20 7475 706c 6529 290a 2020 2020  ey, tuple)).    
+00020920: 2020 2020 2020 2020 616e 6420 6b65 7920          and key 
+00020930: 3d3d 2073 656c 662e 696e 6465 782e 6e61  == self.index.na
+00020940: 6d65 0a20 2020 2020 2020 2020 2020 2061  me.            a
+00020950: 6e64 206b 6579 206e 6f74 2069 6e20 6765  nd key not in ge
+00020960: 7461 7474 7228 7365 6c66 2c20 2263 6f6c  tattr(self, "col
+00020970: 756d 6e73 222c 2028 2929 0a20 2020 2020  umns", ()).     
+00020980: 2020 2029 0a0a 2020 2020 6465 6620 5f63     )..    def _c
+00020990: 6f6e 7461 696e 735f 696e 6465 785f 6e61  ontains_index_na
+000209a0: 6d65 2873 656c 662c 2063 6f6c 756d 6e73  me(self, columns
+000209b0: 5f6f 725f 696e 6465 7829 3a0a 2020 2020  _or_index):.    
+000209c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000209d0: 5465 7374 2077 6865 7468 6572 2074 6865  Test whether the
+000209e0: 2069 6e70 7574 2063 6f6e 7461 696e 7320   input contains 
+000209f0: 6120 7265 6665 7265 6e63 6520 746f 2074  a reference to t
+00020a00: 6865 2069 6e64 6578 206f 6620 7468 6520  he index of the 
+00020a10: 4461 7461 4672 616d 652f 5365 7269 6573  DataFrame/Series
+00020a20: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00020a30: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00020a40: 6365 2863 6f6c 756d 6e73 5f6f 725f 696e  ce(columns_or_in
+00020a50: 6465 782c 206c 6973 7429 3a0a 2020 2020  dex, list):.    
+00020a60: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00020a70: 6e79 2873 656c 662e 5f69 735f 696e 6465  ny(self._is_inde
+00020a80: 785f 6c65 7665 6c5f 7265 6665 7265 6e63  x_level_referenc
+00020a90: 6528 6e29 2066 6f72 206e 2069 6e20 636f  e(n) for n in co
+00020aa0: 6c75 6d6e 735f 6f72 5f69 6e64 6578 290a  lumns_or_index).
+00020ab0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00020ac0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00020ad0: 2073 656c 662e 5f69 735f 696e 6465 785f   self._is_index_
+00020ae0: 6c65 7665 6c5f 7265 6665 7265 6e63 6528  level_reference(
+00020af0: 636f 6c75 6d6e 735f 6f72 5f69 6e64 6578  columns_or_index
+00020b00: 290a 0a0a 6465 6620 5f72 6169 7365 5f69  )...def _raise_i
+00020b10: 665f 6f62 6a65 6374 5f73 6572 6965 7328  f_object_series(
+00020b20: 782c 2066 756e 636e 616d 6529 3a0a 2020  x, funcname):.  
+00020b30: 2020 2222 220a 2020 2020 5574 696c 6974    """.    Utilit
+00020b40: 7920 6675 6e63 7469 6f6e 2074 6f20 7261  y function to ra
+00020b50: 6973 6520 616e 2065 7272 6f72 2069 6620  ise an error if 
+00020b60: 616e 206f 626a 6563 7420 636f 6c75 6d6e  an object column
+00020b70: 2064 6f65 7320 6e6f 7420 7375 7070 6f72   does not suppor
+00020b80: 740a 2020 2020 6120 6365 7274 6169 6e20  t.    a certain 
+00020b90: 6f70 6572 6174 696f 6e20 6c69 6b65 2060  operation like `
+00020ba0: 6d65 616e 602e 0a20 2020 2022 2222 0a20  mean`..    """. 
+00020bb0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00020bc0: 2878 2c20 5365 7269 6573 2920 616e 6420  (x, Series) and 
+00020bd0: 6861 7361 7474 7228 782c 2022 6474 7970  hasattr(x, "dtyp
+00020be0: 6522 293a 0a20 2020 2020 2020 2069 6620  e"):.        if 
+00020bf0: 782e 6474 7970 6520 3d3d 206f 626a 6563  x.dtype == objec
+00020c00: 743a 0a20 2020 2020 2020 2020 2020 2072  t:.            r
+00020c10: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00020c20: 2260 2573 6020 6e6f 7420 7375 7070 6f72  "`%s` not suppor
+00020c30: 7465 6420 7769 7468 206f 626a 6563 7420  ted with object 
+00020c40: 7365 7269 6573 2220 2520 6675 6e63 6e61  series" % funcna
+00020c50: 6d65 290a 2020 2020 2020 2020 656c 6966  me).        elif
+00020c60: 2070 642e 6170 692e 7479 7065 732e 6973   pd.api.types.is
+00020c70: 5f64 7479 7065 5f65 7175 616c 2878 2e64  _dtype_equal(x.d
+00020c80: 7479 7065 2c20 2273 7472 696e 6722 293a  type, "string"):
+00020c90: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00020ca0: 7365 2056 616c 7565 4572 726f 7228 2260  se ValueError("`
+00020cb0: 2573 6020 6e6f 7420 7375 7070 6f72 7465  %s` not supporte
+00020cc0: 6420 7769 7468 2073 7472 696e 6720 7365  d with string se
+00020cd0: 7269 6573 2220 2520 6675 6e63 6e61 6d65  ries" % funcname
+00020ce0: 290a 0a0a 636c 6173 7320 5365 7269 6573  )...class Series
+00020cf0: 285f 4672 616d 6529 3a0a 2020 2020 2222  (_Frame):.    ""
+00020d00: 2250 6172 616c 6c65 6c20 5061 6e64 6173  "Parallel Pandas
+00020d10: 2053 6572 6965 730a 0a20 2020 2044 6f20   Series..    Do 
+00020d20: 6e6f 7420 7573 6520 7468 6973 2063 6c61  not use this cla
+00020d30: 7373 2064 6972 6563 746c 792e 2020 496e  ss directly.  In
+00020d40: 7374 6561 6420 7573 6520 6675 6e63 7469  stead use functi
+00020d50: 6f6e 7320 6c69 6b65 0a20 2020 2060 6064  ons like.    ``d
+00020d60: 642e 7265 6164 5f63 7376 6060 2c20 6060  d.read_csv``, ``
+00020d70: 6464 2e72 6561 645f 7061 7271 7565 7460  dd.read_parquet`
+00020d80: 602c 206f 7220 6060 6464 2e66 726f 6d5f  `, or ``dd.from_
+00020d90: 7061 6e64 6173 6060 2e0a 0a20 2020 2050  pandas``...    P
+00020da0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+00020db0: 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020 6473  --------..    ds
+00020dc0: 6b3a 2064 6963 740a 2020 2020 2020 2020  k: dict.        
+00020dd0: 5468 6520 6461 736b 2067 7261 7068 2074  The dask graph t
+00020de0: 6f20 636f 6d70 7574 6520 7468 6973 2053  o compute this S
+00020df0: 6572 6965 730a 2020 2020 5f6e 616d 653a  eries.    _name:
+00020e00: 2073 7472 0a20 2020 2020 2020 2054 6865   str.        The
+00020e10: 206b 6579 2070 7265 6669 7820 7468 6174   key prefix that
+00020e20: 2073 7065 6369 6669 6573 2077 6869 6368   specifies which
+00020e30: 206b 6579 7320 696e 2074 6865 2064 6173   keys in the das
+00020e40: 6b20 636f 6d70 7269 7365 2074 6869 730a  k comprise this.
+00020e50: 2020 2020 2020 2020 7061 7274 6963 756c          particul
+00020e60: 6172 2053 6572 6965 730a 2020 2020 6d65  ar Series.    me
+00020e70: 7461 3a20 7061 6e64 6173 2e53 6572 6965  ta: pandas.Serie
+00020e80: 730a 2020 2020 2020 2020 416e 2065 6d70  s.        An emp
+00020e90: 7479 2060 6070 616e 6461 732e 5365 7269  ty ``pandas.Seri
+00020ea0: 6573 6060 2077 6974 6820 6e61 6d65 732c  es`` with names,
+00020eb0: 2064 7479 7065 732c 2061 6e64 2069 6e64   dtypes, and ind
+00020ec0: 6578 206d 6174 6368 696e 6720 7468 650a  ex matching the.
+00020ed0: 2020 2020 2020 2020 6578 7065 6374 6564          expected
+00020ee0: 206f 7574 7075 742e 0a20 2020 2064 6976   output..    div
+00020ef0: 6973 696f 6e73 3a20 7475 706c 6520 6f66  isions: tuple of
+00020f00: 2069 6e64 6578 2076 616c 7565 730a 2020   index values.  
+00020f10: 2020 2020 2020 5661 6c75 6573 2061 6c6f        Values alo
+00020f20: 6e67 2077 6869 6368 2077 6520 7061 7274  ng which we part
+00020f30: 6974 696f 6e20 6f75 7220 626c 6f63 6b73  ition our blocks
+00020f40: 206f 6e20 7468 6520 696e 6465 780a 0a20   on the index.. 
+00020f50: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+00020f60: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064 6173  --------.    das
+00020f70: 6b2e 6461 7461 6672 616d 652e 4461 7461  k.dataframe.Data
+00020f80: 4672 616d 650a 2020 2020 2222 220a 0a20  Frame.    """.. 
+00020f90: 2020 205f 7061 7274 6974 696f 6e5f 7479     _partition_ty
+00020fa0: 7065 203d 2070 642e 5365 7269 6573 0a20  pe = pd.Series. 
+00020fb0: 2020 205f 6973 5f70 6172 7469 7469 6f6e     _is_partition
+00020fc0: 5f74 7970 6520 3d20 7374 6174 6963 6d65  _type = staticme
+00020fd0: 7468 6f64 2869 735f 7365 7269 6573 5f6c  thod(is_series_l
+00020fe0: 696b 6529 0a20 2020 205f 746f 6b65 6e5f  ike).    _token_
+00020ff0: 7072 6566 6978 203d 2022 7365 7269 6573  prefix = "series
+00021000: 2d22 0a20 2020 205f 6163 6365 7373 6f72  -".    _accessor
+00021010: 733a 2043 6c61 7373 5661 725b 7365 745b  s: ClassVar[set[
+00021020: 7374 725d 5d20 3d20 7365 7428 290a 0a20  str]] = set().. 
+00021030: 2020 2064 6566 205f 5f61 7272 6179 5f77     def __array_w
+00021040: 7261 705f 5f28 7365 6c66 2c20 6172 7261  rap__(self, arra
+00021050: 792c 2063 6f6e 7465 7874 3d4e 6f6e 6529  y, context=None)
+00021060: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
+00021070: 6e73 7461 6e63 6528 636f 6e74 6578 742c  nstance(context,
+00021080: 2074 7570 6c65 2920 616e 6420 6c65 6e28   tuple) and len(
+00021090: 636f 6e74 6578 7429 203e 2030 3a0a 2020  context) > 0:.  
+000210a0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+000210b0: 6e73 7461 6e63 6528 636f 6e74 6578 745b  nstance(context[
+000210c0: 315d 5b30 5d2c 206e 702e 6e64 6172 7261  1][0], np.ndarra
+000210d0: 7929 2061 6e64 2063 6f6e 7465 7874 5b31  y) and context[1
+000210e0: 5d5b 305d 2e73 6861 7065 203d 3d20 2829  ][0].shape == ()
+000210f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00021100: 2020 696e 6465 7820 3d20 4e6f 6e65 0a20    index = None. 
+00021110: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00021120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021130: 2069 6e64 6578 203d 2063 6f6e 7465 7874   index = context
+00021140: 5b31 5d5b 305d 2e69 6e64 6578 0a20 2020  [1][0].index.   
+00021150: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00021160: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00021170: 2020 2020 2020 2020 2020 2020 696d 706f              impo
+00021180: 7274 2069 6e73 7065 6374 0a0a 2020 2020  rt inspect..    
+00021190: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
+000211a0: 6f64 5f6e 616d 6520 3d20 6622 607b 696e  od_name = f"`{in
+000211b0: 7370 6563 742e 7374 6163 6b28 295b 335d  spect.stack()[3]
+000211c0: 5b33 5d7d 6022 0a20 2020 2020 2020 2020  [3]}`".         
+000211d0: 2020 2065 7863 6570 7420 496e 6465 7845     except IndexE
+000211e0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+000211f0: 2020 2020 2020 6d65 7468 6f64 5f6e 616d        method_nam
+00021200: 6520 3d20 2254 6869 7320 6d65 7468 6f64  e = "This method
+00021210: 220a 2020 2020 2020 2020 2020 2020 7261  ".            ra
+00021220: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+00021230: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
+00021240: 2020 2020 2020 2020 2066 227b 6d65 7468           f"{meth
+00021250: 6f64 5f6e 616d 657d 2069 7320 6e6f 7420  od_name} is not 
+00021260: 696d 706c 656d 656e 7465 6420 666f 7220  implemented for 
+00021270: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
+00021280: 5365 7269 6573 602e 220a 2020 2020 2020  Series`.".      
+00021290: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000212a0: 2072 6574 7572 6e20 6d65 7461 5f73 6572   return meta_ser
+000212b0: 6965 735f 636f 6e73 7472 7563 746f 7228  ies_constructor(
+000212c0: 7365 6c66 2928 6172 7261 792c 2069 6e64  self)(array, ind
+000212d0: 6578 3d69 6e64 6578 2c20 6e61 6d65 3d73  ex=index, name=s
+000212e0: 656c 662e 6e61 6d65 290a 0a20 2020 2040  elf.name)..    @
+000212f0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00021300: 2061 7865 7328 7365 6c66 293a 0a20 2020   axes(self):.   
+00021310: 2020 2020 2072 6574 7572 6e20 5b73 656c       return [sel
+00021320: 662e 696e 6465 785d 0a0a 2020 2020 4070  f.index]..    @p
+00021330: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00021340: 6e61 6d65 2873 656c 6629 3a0a 2020 2020  name(self):.    
+00021350: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00021360: 5f6d 6574 612e 6e61 6d65 0a0a 2020 2020  _meta.name..    
+00021370: 406e 616d 652e 7365 7474 6572 0a20 2020  @name.setter.   
+00021380: 2064 6566 206e 616d 6528 7365 6c66 2c20   def name(self, 
+00021390: 6e61 6d65 293a 0a20 2020 2020 2020 2073  name):.        s
+000213a0: 656c 662e 5f6d 6574 612e 6e61 6d65 203d  elf._meta.name =
+000213b0: 206e 616d 650a 2020 2020 2020 2020 7265   name.        re
+000213c0: 6e61 6d65 6420 3d20 5f72 656e 616d 655f  named = _rename_
+000213d0: 6461 736b 2873 656c 662c 206e 616d 6529  dask(self, name)
+000213e0: 0a20 2020 2020 2020 2023 2075 7064 6174  .        # updat
+000213f0: 6520 6d79 7365 6c66 0a20 2020 2020 2020  e myself.       
+00021400: 2073 656c 662e 6461 736b 203d 2072 656e   self.dask = ren
+00021410: 616d 6564 2e64 6173 6b0a 2020 2020 2020  amed.dask.      
+00021420: 2020 7365 6c66 2e5f 6e61 6d65 203d 2072    self._name = r
+00021430: 656e 616d 6564 2e5f 6e61 6d65 0a0a 2020  enamed._name..  
+00021440: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00021450: 6465 6620 6e64 696d 2873 656c 6629 3a0a  def ndim(self):.
+00021460: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00021470: 6e20 6469 6d65 6e73 696f 6e61 6c69 7479  n dimensionality
+00021480: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+00021490: 726e 2031 0a0a 2020 2020 4070 726f 7065  rn 1..    @prope
+000214a0: 7274 790a 2020 2020 6465 6620 7368 6170  rty.    def shap
+000214b0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+000214c0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+000214d0: 7572 6e20 6120 7475 706c 6520 7265 7072  urn a tuple repr
+000214e0: 6573 656e 7469 6e67 2074 6865 2064 696d  esenting the dim
+000214f0: 656e 7369 6f6e 616c 6974 7920 6f66 2061  ensionality of a
+00021500: 2053 6572 6965 732e 0a0a 2020 2020 2020   Series...      
+00021510: 2020 5468 6520 7369 6e67 6c65 2065 6c65    The single ele
+00021520: 6d65 6e74 206f 6620 7468 6520 7475 706c  ment of the tupl
+00021530: 6520 6973 2061 2044 656c 6179 6564 2072  e is a Delayed r
+00021540: 6573 756c 742e 0a0a 2020 2020 2020 2020  esult...        
+00021550: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+00021560: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00021570: 2020 3e3e 3e20 7365 7269 6573 2e73 6861    >>> series.sha
+00021580: 7065 2020 2320 646f 6374 6573 743a 202b  pe  # doctest: +
+00021590: 534b 4950 0a20 2020 2020 2020 2028 6464  SKIP.        (dd
+000215a0: 2e53 6361 6c61 723c 7369 7a65 2d61 672e  .Scalar<size-ag.
+000215b0: 2e2e 2c20 6474 7970 653d 696e 7436 343e  .., dtype=int64>
+000215c0: 2c29 0a20 2020 2020 2020 2022 2222 0a20  ,).        """. 
+000215d0: 2020 2020 2020 2072 6574 7572 6e20 2873         return (s
+000215e0: 656c 662e 7369 7a65 2c29 0a0a 2020 2020  elf.size,)..    
+000215f0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00021600: 6620 6474 7970 6528 7365 6c66 293a 0a20  f dtype(self):. 
+00021610: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+00021620: 2064 6174 6120 7479 7065 2222 220a 2020   data type""".  
+00021630: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00021640: 662e 5f6d 6574 612e 6474 7970 650a 0a20  f._meta.dtype.. 
+00021650: 2020 2064 7420 3d20 4361 6368 6564 4163     dt = CachedAc
+00021660: 6365 7373 6f72 2822 6474 222c 2044 6174  cessor("dt", Dat
+00021670: 6574 696d 6541 6363 6573 736f 7229 0a0a  etimeAccessor)..
+00021680: 2020 2020 6361 7420 3d20 4361 6368 6564      cat = Cached
+00021690: 4163 6365 7373 6f72 2822 6361 7422 2c20  Accessor("cat", 
+000216a0: 4361 7465 676f 7269 6361 6c41 6363 6573  CategoricalAcces
+000216b0: 736f 7229 0a0a 2020 2020 7374 7220 3d20  sor)..    str = 
+000216c0: 4361 6368 6564 4163 6365 7373 6f72 2822  CachedAccessor("
+000216d0: 7374 7222 2c20 5374 7269 6e67 4163 6365  str", StringAcce
+000216e0: 7373 6f72 290a 0a20 2020 2064 6566 205f  ssor)..    def _
+000216f0: 5f64 6972 5f5f 2873 656c 6629 3a0a 2020  _dir__(self):.  
+00021700: 2020 2020 2020 6f20 3d20 7365 7428 6469        o = set(di
+00021710: 7228 7479 7065 2873 656c 6629 2929 0a20  r(type(self))). 
+00021720: 2020 2020 2020 206f 2e75 7064 6174 6528         o.update(
+00021730: 7365 6c66 2e5f 5f64 6963 745f 5f29 0a20  self.__dict__). 
+00021740: 2020 2020 2020 2023 2052 656d 6f76 6520         # Remove 
+00021750: 7468 6520 6063 6174 6020 616e 6420 6073  the `cat` and `s
+00021760: 7472 6020 6163 6365 7373 6f72 7320 6966  tr` accessors if
+00021770: 206e 6f74 2061 7661 696c 6162 6c65 2e20   not available. 
+00021780: 5765 2063 616e 2774 0a20 2020 2020 2020  We can't.       
+00021790: 2023 2064 6563 6964 6520 7468 6973 2073   # decide this s
+000217a0: 7461 7469 6361 6c6c 7920 666f 7220 7468  tatically for th
+000217b0: 6520 6064 7460 2061 6363 6573 736f 722c  e `dt` accessor,
+000217c0: 2061 7320 6974 2077 6f72 6b73 206f 6e0a   as it works on.
+000217d0: 2020 2020 2020 2020 2320 6461 7465 7469          # dateti
+000217e0: 6d65 2d6c 696b 6520 7468 696e 6773 2061  me-like things a
+000217f0: 7320 7765 6c6c 2e0a 2020 2020 2020 2020  s well..        
+00021800: 666f 7220 6163 6365 7373 6f72 2069 6e20  for accessor in 
+00021810: 5b22 6361 7422 2c20 2273 7472 225d 3a0a  ["cat", "str"]:.
+00021820: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00021830: 6f74 2068 6173 6174 7472 2873 656c 662e  ot hasattr(self.
+00021840: 5f6d 6574 612c 2061 6363 6573 736f 7229  _meta, accessor)
+00021850: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00021860: 2020 6f2e 7265 6d6f 7665 2861 6363 6573    o.remove(acces
+00021870: 736f 7229 0a20 2020 2020 2020 2072 6574  sor).        ret
+00021880: 7572 6e20 6c69 7374 286f 290a 0a20 2020  urn list(o)..   
+00021890: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000218a0: 6566 206e 6279 7465 7328 7365 6c66 293a  ef nbytes(self):
+000218b0: 0a20 2020 2020 2020 2022 2222 4e75 6d62  .        """Numb
+000218c0: 6572 206f 6620 6279 7465 7322 2222 0a20  er of bytes""". 
+000218d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000218e0: 6c66 2e72 6564 7563 7469 6f6e 280a 2020  lf.reduction(.  
+000218f0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00021900: 732e 6e62 7974 6573 2c20 6e70 2e73 756d  s.nbytes, np.sum
+00021910: 2c20 746f 6b65 6e3d 226e 6279 7465 7322  , token="nbytes"
+00021920: 2c20 6d65 7461 3d69 6e74 2c20 7370 6c69  , meta=int, spli
+00021930: 745f 6576 6572 793d 4661 6c73 650a 2020  t_every=False.  
+00021940: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+00021950: 205f 7265 7072 5f64 6174 6128 7365 6c66   _repr_data(self
+00021960: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00021970: 6e20 5f72 6570 725f 6461 7461 5f73 6572  n _repr_data_ser
+00021980: 6965 7328 7365 6c66 2e5f 6d65 7461 2c20  ies(self._meta, 
+00021990: 7365 6c66 2e5f 7265 7072 5f64 6976 6973  self._repr_divis
+000219a0: 696f 6e73 290a 0a20 2020 2064 6566 205f  ions)..    def _
+000219b0: 5f72 6570 725f 5f28 7365 6c66 293a 0a20  _repr__(self):. 
+000219c0: 2020 2020 2020 2022 2222 6861 7665 2074         """have t
+000219d0: 6f20 6f76 6572 7772 6974 6520 666f 6f74  o overwrite foot
+000219e0: 6572 2222 220a 2020 2020 2020 2020 6966  er""".        if
+000219f0: 2073 656c 662e 6e61 6d65 2069 7320 6e6f   self.name is no
+00021a00: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00021a10: 2020 2020 666f 6f74 6572 203d 2066 224e      footer = f"N
+00021a20: 616d 653a 207b 7365 6c66 2e6e 616d 657d  ame: {self.name}
+00021a30: 2c20 6474 7970 653a 207b 7365 6c66 2e64  , dtype: {self.d
+00021a40: 7479 7065 7d22 0a20 2020 2020 2020 2065  type}".        e
+00021a50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00021a60: 2066 6f6f 7465 7220 3d20 6622 6474 7970   footer = f"dtyp
+00021a70: 653a 207b 7365 6c66 2e64 7479 7065 7d22  e: {self.dtype}"
+00021a80: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00021a90: 2022 2222 4461 736b 207b 6b6c 6173 737d   """Dask {klass}
+00021aa0: 2053 7472 7563 7475 7265 3a0a 7b64 6174   Structure:.{dat
+00021ab0: 617d 0a7b 666f 6f74 6572 7d0a 4461 736b  a}.{footer}.Dask
+00021ac0: 204e 616d 653a 207b 6e61 6d65 7d2c 207b   Name: {name}, {
+00021ad0: 6c61 7965 7273 7d22 2222 2e66 6f72 6d61  layers}""".forma
+00021ae0: 7428 0a20 2020 2020 2020 2020 2020 206b  t(.            k
+00021af0: 6c61 7373 3d73 656c 662e 5f5f 636c 6173  lass=self.__clas
+00021b00: 735f 5f2e 5f5f 6e61 6d65 5f5f 2c0a 2020  s__.__name__,.  
+00021b10: 2020 2020 2020 2020 2020 6461 7461 3d73            data=s
+00021b20: 656c 662e 746f 5f73 7472 696e 6728 292c  elf.to_string(),
+00021b30: 0a20 2020 2020 2020 2020 2020 2066 6f6f  .            foo
+00021b40: 7465 723d 666f 6f74 6572 2c0a 2020 2020  ter=footer,.    
+00021b50: 2020 2020 2020 2020 6e61 6d65 3d6b 6579          name=key
+00021b60: 5f73 706c 6974 2873 656c 662e 5f6e 616d  _split(self._nam
+00021b70: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+00021b80: 6c61 7965 7273 3d6d 6179 6265 5f70 6c75  layers=maybe_plu
+00021b90: 7261 6c69 7a65 286c 656e 2873 656c 662e  ralize(len(self.
+00021ba0: 6461 736b 2e6c 6179 6572 7329 2c20 2267  dask.layers), "g
+00021bb0: 7261 7068 206c 6179 6572 2229 2c0a 2020  raph layer"),.  
+00021bc0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+00021bd0: 2072 656e 616d 6528 7365 6c66 2c20 696e   rename(self, in
+00021be0: 6465 783d 4e6f 6e65 2c20 696e 706c 6163  dex=None, inplac
+00021bf0: 653d 4661 6c73 652c 2073 6f72 7465 645f  e=False, sorted_
+00021c00: 696e 6465 783d 4661 6c73 6529 3a0a 2020  index=False):.  
+00021c10: 2020 2020 2020 2222 2241 6c74 6572 2053        """Alter S
+00021c20: 6572 6965 7320 696e 6465 7820 6c61 6265  eries index labe
+00021c30: 6c73 206f 7220 6e61 6d65 0a0a 2020 2020  ls or name..    
+00021c40: 2020 2020 4675 6e63 7469 6f6e 202f 2064      Function / d
+00021c50: 6963 7420 7661 6c75 6573 206d 7573 7420  ict values must 
+00021c60: 6265 2075 6e69 7175 6520 2831 2d74 6f2d  be unique (1-to-
+00021c70: 3129 2e20 4c61 6265 6c73 206e 6f74 2063  1). Labels not c
+00021c80: 6f6e 7461 696e 6564 2069 6e0a 2020 2020  ontained in.    
+00021c90: 2020 2020 6120 6469 6374 202f 2053 6572      a dict / Ser
+00021ca0: 6965 7320 7769 6c6c 2062 6520 6c65 6674  ies will be left
+00021cb0: 2061 732d 6973 2e20 4578 7472 6120 6c61   as-is. Extra la
+00021cc0: 6265 6c73 206c 6973 7465 6420 646f 6e27  bels listed don'
+00021cd0: 7420 7468 726f 7720 616e 0a20 2020 2020  t throw an.     
+00021ce0: 2020 2065 7272 6f72 2e0a 0a20 2020 2020     error...     
+00021cf0: 2020 2041 6c74 6572 6e61 7469 7665 6c79     Alternatively
+00021d00: 2c20 6368 616e 6765 2060 6053 6572 6965  , change ``Serie
+00021d10: 732e 6e61 6d65 6060 2077 6974 6820 6120  s.name`` with a 
+00021d20: 7363 616c 6172 2076 616c 7565 2e0a 0a20  scalar value... 
+00021d30: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00021d40: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00021d50: 2d2d 2d2d 0a20 2020 2020 2020 2069 6e64  ----.        ind
+00021d60: 6578 203a 2073 6361 6c61 722c 2068 6173  ex : scalar, has
+00021d70: 6861 626c 6520 7365 7175 656e 6365 2c20  hable sequence, 
+00021d80: 6469 6374 2d6c 696b 6520 6f72 2063 616c  dict-like or cal
+00021d90: 6c61 626c 652c 206f 7074 696f 6e61 6c0a  lable, optional.
+00021da0: 2020 2020 2020 2020 2020 2020 4966 2064              If d
+00021db0: 6963 742d 6c69 6b65 206f 7220 6361 6c6c  ict-like or call
+00021dc0: 6162 6c65 2c20 7468 6520 7472 616e 7366  able, the transf
+00021dd0: 6f72 6d61 7469 6f6e 2069 7320 6170 706c  ormation is appl
+00021de0: 6965 6420 746f 2074 6865 0a20 2020 2020  ied to the.     
+00021df0: 2020 2020 2020 2069 6e64 6578 2e20 5363         index. Sc
+00021e00: 616c 6172 206f 7220 6861 7368 6162 6c65  alar or hashable
+00021e10: 2073 6571 7565 6e63 652d 6c69 6b65 2077   sequence-like w
+00021e20: 696c 6c20 616c 7465 7220 7468 650a 2020  ill alter the.  
+00021e30: 2020 2020 2020 2020 2020 6060 5365 7269            ``Seri
+00021e40: 6573 2e6e 616d 6560 6020 6174 7472 6962  es.name`` attrib
+00021e50: 7574 652e 0a20 2020 2020 2020 2069 6e70  ute..        inp
+00021e60: 6c61 6365 203a 2062 6f6f 6c65 616e 2c20  lace : boolean, 
+00021e70: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
+00021e80: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
+00021e90: 7220 746f 2072 6574 7572 6e20 6120 6e65  r to return a ne
+00021ea0: 7720 5365 7269 6573 206f 7220 6d6f 6469  w Series or modi
+00021eb0: 6679 2074 6869 7320 6f6e 6520 696e 706c  fy this one inpl
+00021ec0: 6163 652e 0a20 2020 2020 2020 2073 6f72  ace..        sor
+00021ed0: 7465 645f 696e 6465 7820 3a20 626f 6f6c  ted_index : bool
+00021ee0: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
+00021ef0: 2020 2020 2020 2020 2020 2020 4966 2074              If t
+00021f00: 7275 652c 2074 6865 206f 7574 7075 7420  rue, the output 
+00021f10: 6060 5365 7269 6573 6060 2077 696c 6c20  ``Series`` will 
+00021f20: 6861 7665 206b 6e6f 776e 2064 6976 6973  have known divis
+00021f30: 696f 6e73 2069 6e66 6572 7265 640a 2020  ions inferred.  
+00021f40: 2020 2020 2020 2020 2020 6672 6f6d 2074            from t
+00021f50: 6865 2069 6e70 7574 2073 6572 6965 7320  he input series 
+00021f60: 616e 6420 7468 6520 7472 616e 7366 6f72  and the transfor
+00021f70: 6d61 7469 6f6e 2e20 4967 6e6f 7265 6420  mation. Ignored 
+00021f80: 666f 720a 2020 2020 2020 2020 2020 2020  for.            
+00021f90: 6e6f 6e2d 6361 6c6c 6162 6c65 2f64 6963  non-callable/dic
+00021fa0: 742d 6c69 6b65 2060 6069 6e64 6578 6060  t-like ``index``
+00021fb0: 206f 7220 7768 656e 2074 6865 2069 6e70   or when the inp
+00021fc0: 7574 2073 6572 6965 7320 6861 730a 2020  ut series has.  
+00021fd0: 2020 2020 2020 2020 2020 756e 6b6e 6f77            unknow
+00021fe0: 6e20 6469 7669 7369 6f6e 732e 204e 6f74  n divisions. Not
+00021ff0: 6520 7468 6174 2074 6869 7320 6d61 7920  e that this may 
+00022000: 6f6e 6c79 2062 6520 7365 7420 746f 2060  only be set to `
+00022010: 6054 7275 6560 6020 6966 0a20 2020 2020  `True`` if.     
+00022020: 2020 2020 2020 2079 6f75 206b 6e6f 7720         you know 
+00022030: 7468 6174 2074 6865 2074 7261 6e73 666f  that the transfo
+00022040: 726d 6564 2069 6e64 6578 2069 7320 6d6f  rmed index is mo
+00022050: 6e6f 746f 6e69 6361 6c6c 7920 696e 6372  notonically incr
+00022060: 6561 7369 6e67 2e20 4461 736b 0a20 2020  easing. Dask.   
+00022070: 2020 2020 2020 2020 2077 696c 6c20 6368           will ch
+00022080: 6563 6b20 7468 6174 2074 7261 6e73 666f  eck that transfo
+00022090: 726d 6564 2064 6976 6973 696f 6e73 2061  rmed divisions a
+000220a0: 7265 206d 6f6e 6f74 6f6e 6963 2c20 6275  re monotonic, bu
+000220b0: 7420 6361 6e6e 6f74 0a20 2020 2020 2020  t cannot.       
+000220c0: 2020 2020 2063 6865 636b 2061 6c6c 2074       check all t
+000220d0: 6865 2076 616c 7565 7320 6265 7477 6565  he values betwee
+000220e0: 6e20 6469 7669 7369 6f6e 732c 2073 6f20  n divisions, so 
+000220f0: 696e 636f 7272 6563 746c 7920 7365 7474  incorrectly sett
+00022100: 696e 6720 7468 6973 0a20 2020 2020 2020  ing this.       
+00022110: 2020 2020 2063 616e 2072 6573 756c 7420       can result 
+00022120: 696e 2062 7567 732e 0a0a 2020 2020 2020  in bugs...      
+00022130: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+00022140: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+00022150: 2020 7265 6e61 6d65 6420 3a20 5365 7269    renamed : Seri
+00022160: 6573 0a0a 2020 2020 2020 2020 5365 6520  es..        See 
+00022170: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+00022180: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7061  -----.        pa
+00022190: 6e64 6173 2e53 6572 6965 732e 7265 6e61  ndas.Series.rena
+000221a0: 6d65 0a20 2020 2020 2020 2022 2222 0a20  me.        """. 
+000221b0: 2020 2020 2020 2066 726f 6d20 7061 6e64         from pand
+000221c0: 6173 2e61 7069 2e74 7970 6573 2069 6d70  as.api.types imp
+000221d0: 6f72 7420 6973 5f64 6963 745f 6c69 6b65  ort is_dict_like
+000221e0: 2c20 6973 5f6c 6973 745f 6c69 6b65 2c20  , is_list_like, 
+000221f0: 6973 5f73 6361 6c61 720a 0a20 2020 2020  is_scalar..     
+00022200: 2020 2069 6d70 6f72 7420 6461 736b 2e64     import dask.d
+00022210: 6174 6166 7261 6d65 2061 7320 6464 0a0a  ataframe as dd..
+00022220: 2020 2020 2020 2020 6966 2069 735f 7363          if is_sc
+00022230: 616c 6172 2869 6e64 6578 2920 6f72 2028  alar(index) or (
+00022240: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
+00022250: 6c69 7374 5f6c 696b 6528 696e 6465 7829  list_like(index)
+00022260: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00022270: 206e 6f74 2069 735f 6469 6374 5f6c 696b   not is_dict_lik
+00022280: 6528 696e 6465 7829 0a20 2020 2020 2020  e(index).       
+00022290: 2020 2020 2061 6e64 206e 6f74 2069 7369       and not isi
+000222a0: 6e73 7461 6e63 6528 696e 6465 782c 2064  nstance(index, d
+000222b0: 642e 5365 7269 6573 290a 2020 2020 2020  d.Series).      
+000222c0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+000222d0: 2069 6620 696e 706c 6163 653a 0a20 2020   if inplace:.   
+000222e0: 2020 2020 2020 2020 2020 2020 2077 6172               war
+000222f0: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
+00022300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022310: 2227 696e 706c 6163 6527 2061 7267 756d  "'inplace' argum
+00022320: 656e 7420 666f 7220 6461 736b 2073 6572  ent for dask ser
+00022330: 6965 7320 7769 6c6c 2062 6520 7265 6d6f  ies will be remo
+00022340: 7665 6420 696e 2066 7574 7572 6520 7665  ved in future ve
+00022350: 7273 696f 6e73 222c 0a20 2020 2020 2020  rsions",.       
+00022360: 2020 2020 2020 2020 2020 2020 2050 656e               Pen
+00022370: 6469 6e67 4465 7072 6563 6174 696f 6e57  dingDeprecationW
+00022380: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
+00022390: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000223a0: 2020 2020 2020 7265 7320 3d20 7365 6c66        res = self
+000223b0: 2069 6620 696e 706c 6163 6520 656c 7365   if inplace else
+000223c0: 2073 656c 662e 636f 7079 2829 0a20 2020   self.copy().   
+000223d0: 2020 2020 2020 2020 2072 6573 2e6e 616d           res.nam
+000223e0: 6520 3d20 696e 6465 780a 2020 2020 2020  e = index.      
+000223f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00022400: 2020 2020 7265 7320 3d20 7365 6c66 2e6d      res = self.m
+00022410: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
+00022420: 7265 6e61 6d65 2c20 696e 6465 782c 2065  rename, index, e
+00022430: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+00022440: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
+00022450: 2020 2069 6620 7365 6c66 2e6b 6e6f 776e     if self.known
+00022460: 5f64 6976 6973 696f 6e73 3a0a 2020 2020  _divisions:.    
+00022470: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00022480: 6f72 7465 645f 696e 6465 7820 616e 6420  orted_index and 
+00022490: 2863 616c 6c61 626c 6528 696e 6465 7829  (callable(index)
+000224a0: 206f 7220 6973 5f64 6963 745f 6c69 6b65   or is_dict_like
+000224b0: 2869 6e64 6578 2929 3a0a 2020 2020 2020  (index)):.      
+000224c0: 2020 2020 2020 2020 2020 2020 2020 6f6c                ol
+000224d0: 6420 3d20 7064 2e53 6572 6965 7328 7261  d = pd.Series(ra
+000224e0: 6e67 6528 7365 6c66 2e6e 7061 7274 6974  nge(self.npartit
+000224f0: 696f 6e73 202b 2031 292c 2069 6e64 6578  ions + 1), index
+00022500: 3d73 656c 662e 6469 7669 7369 6f6e 7329  =self.divisions)
+00022510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022520: 2020 2020 206e 6577 203d 206f 6c64 2e72       new = old.r
+00022530: 656e 616d 6528 696e 6465 7829 2e69 6e64  ename(index).ind
+00022540: 6578 0a20 2020 2020 2020 2020 2020 2020  ex.             
+00022550: 2020 2020 2020 2069 6620 6e6f 7420 6e65         if not ne
+00022560: 772e 6973 5f6d 6f6e 6f74 6f6e 6963 5f69  w.is_monotonic_i
+00022570: 6e63 7265 6173 696e 673a 0a20 2020 2020  ncreasing:.     
+00022580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022590: 2020 206d 7367 203d 2028 0a20 2020 2020     msg = (.     
+000225a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000225b0: 2020 2020 2020 2022 736f 7274 6564 5f69         "sorted_i
+000225c0: 6e64 6578 3d54 7275 652c 2062 7574 2074  ndex=True, but t
+000225d0: 6865 2074 7261 6e73 666f 726d 6564 2069  he transformed i
+000225e0: 6e64 6578 2022 0a20 2020 2020 2020 2020  ndex ".         
+000225f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022600: 2020 2022 6973 6e27 7420 6d6f 6e6f 746f     "isn't monoto
+00022610: 6e69 635f 696e 6372 6561 7369 6e67 220a  nic_increasing".
+00022620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022630: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00022640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022650: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00022660: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
+00022670: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00022680: 5f64 6976 6973 696f 6e73 203d 2074 7570  _divisions = tup
+00022690: 6c65 286d 6574 686f 6473 2e74 6f6c 6973  le(methods.tolis
+000226a0: 7428 6e65 7729 290a 2020 2020 2020 2020  t(new)).        
+000226b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000226c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000226d0: 2020 7265 7320 3d20 7265 732e 636c 6561    res = res.clea
+000226e0: 725f 6469 7669 7369 6f6e 7328 290a 2020  r_divisions().  
+000226f0: 2020 2020 2020 2020 2020 6966 2069 6e70            if inp
+00022700: 6c61 6365 3a0a 2020 2020 2020 2020 2020  lace:.          
+00022710: 2020 2020 2020 7365 6c66 2e64 6173 6b20        self.dask 
+00022720: 3d20 7265 732e 6461 736b 0a20 2020 2020  = res.dask.     
+00022730: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00022740: 5f6e 616d 6520 3d20 7265 732e 5f6e 616d  _name = res._nam
+00022750: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00022760: 2020 7365 6c66 2e5f 6469 7669 7369 6f6e    self._division
+00022770: 7320 3d20 7265 732e 6469 7669 7369 6f6e  s = res.division
+00022780: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00022790: 2020 7365 6c66 2e5f 6d65 7461 203d 2072    self._meta = r
+000227a0: 6573 2e5f 6d65 7461 0a20 2020 2020 2020  es._meta.       
+000227b0: 2020 2020 2020 2020 2072 6573 203d 2073           res = s
+000227c0: 656c 660a 2020 2020 2020 2020 7265 7475  elf.        retu
+000227d0: 726e 2072 6573 0a0a 2020 2020 4064 6572  rn res..    @der
+000227e0: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+000227f0: 6965 7329 0a20 2020 2064 6566 2072 6f75  ies).    def rou
+00022800: 6e64 2873 656c 662c 2064 6563 696d 616c  nd(self, decimal
+00022810: 733d 3029 3a0a 2020 2020 2020 2020 7265  s=0):.        re
+00022820: 7475 726e 2065 6c65 6d77 6973 6528 4d2e  turn elemwise(M.
+00022830: 726f 756e 642c 2073 656c 662c 2064 6563  round, self, dec
+00022840: 696d 616c 7329 0a0a 2020 2020 4064 6572  imals)..    @der
+00022850: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00022860: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00022870: 746f 5f74 696d 6573 7461 6d70 2873 656c  to_timestamp(sel
+00022880: 662c 2066 7265 713d 4e6f 6e65 2c20 686f  f, freq=None, ho
+00022890: 773d 2273 7461 7274 222c 2061 7869 733d  w="start", axis=
+000228a0: 3029 3a0a 2020 2020 2020 2020 6466 203d  0):.        df =
+000228b0: 2065 6c65 6d77 6973 6528 4d2e 746f 5f74   elemwise(M.to_t
+000228c0: 696d 6573 7461 6d70 2c20 7365 6c66 2c20  imestamp, self, 
+000228d0: 6672 6571 2c20 686f 772c 2061 7869 7329  freq, how, axis)
+000228e0: 0a20 2020 2020 2020 2064 662e 6469 7669  .        df.divi
+000228f0: 7369 6f6e 7320 3d20 7475 706c 6528 7064  sions = tuple(pd
+00022900: 2e49 6e64 6578 2873 656c 662e 6469 7669  .Index(self.divi
+00022910: 7369 6f6e 7329 2e74 6f5f 7469 6d65 7374  sions).to_timest
+00022920: 616d 7028 2929 0a20 2020 2020 2020 2072  amp()).        r
+00022930: 6574 7572 6e20 6466 0a0a 2020 2020 6465  eturn df..    de
+00022940: 6620 7175 616e 7469 6c65 2873 656c 662c  f quantile(self,
+00022950: 2071 3d30 2e35 2c20 6d65 7468 6f64 3d22   q=0.5, method="
+00022960: 6465 6661 756c 7422 293a 0a20 2020 2020  default"):.     
+00022970: 2020 2022 2222 4170 7072 6f78 696d 6174     """Approximat
+00022980: 6520 7175 616e 7469 6c65 7320 6f66 2053  e quantiles of S
+00022990: 6572 6965 730a 0a20 2020 2020 2020 2050  eries..        P
+000229a0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+000229b0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+000229c0: 2020 2020 2071 203a 206c 6973 742f 6172       q : list/ar
+000229d0: 7261 7920 6f66 2066 6c6f 6174 732c 2064  ray of floats, d
+000229e0: 6566 6175 6c74 2030 2e35 2028 3530 2529  efault 0.5 (50%)
+000229f0: 0a20 2020 2020 2020 2020 2020 2049 7465  .            Ite
+00022a00: 7261 626c 6520 6f66 206e 756d 6265 7273  rable of numbers
+00022a10: 2072 616e 6769 6e67 2066 726f 6d20 3020   ranging from 0 
+00022a20: 746f 2031 2066 6f72 2074 6865 2064 6573  to 1 for the des
+00022a30: 6972 6564 2071 7561 6e74 696c 6573 0a20  ired quantiles. 
+00022a40: 2020 2020 2020 206d 6574 686f 6420 3a20         method : 
+00022a50: 7b27 6465 6661 756c 7427 2c20 2774 6469  {'default', 'tdi
+00022a60: 6765 7374 272c 2027 6461 736b 277d 2c20  gest', 'dask'}, 
+00022a70: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00022a80: 2020 2020 2057 6861 7420 6d65 7468 6f64       What method
+00022a90: 2074 6f20 7573 652e 2042 7920 6465 6661   to use. By defa
+00022aa0: 756c 7420 7769 6c6c 2075 7365 2064 6173  ult will use das
+00022ab0: 6b27 7320 696e 7465 726e 616c 2063 7573  k's internal cus
+00022ac0: 746f 6d0a 2020 2020 2020 2020 2020 2020  tom.            
+00022ad0: 616c 676f 7269 7468 6d20 2860 6027 6461  algorithm (``'da
+00022ae0: 736b 2760 6029 2e20 2049 6620 7365 7420  sk'``).  If set 
+00022af0: 746f 2060 6027 7464 6967 6573 7427 6060  to ``'tdigest'``
+00022b00: 2077 696c 6c20 7573 6520 7464 6967 6573   will use tdiges
+00022b10: 740a 2020 2020 2020 2020 2020 2020 666f  t.            fo
+00022b20: 7220 666c 6f61 7473 2061 6e64 2069 6e74  r floats and int
+00022b30: 7320 616e 6420 6661 6c6c 6261 636b 2074  s and fallback t
+00022b40: 6f20 7468 6520 6060 2764 6173 6b27 6060  o the ``'dask'``
+00022b50: 206f 7468 6572 7769 7365 2e0a 2020 2020   otherwise..    
+00022b60: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00022b70: 7265 7475 726e 2071 7561 6e74 696c 6528  return quantile(
+00022b80: 7365 6c66 2c20 712c 206d 6574 686f 643d  self, q, method=
+00022b90: 6d65 7468 6f64 290a 0a20 2020 2064 6566  method)..    def
+00022ba0: 206d 6564 6961 6e5f 6170 7072 6f78 696d   median_approxim
+00022bb0: 6174 6528 7365 6c66 2c20 6d65 7468 6f64  ate(self, method
+00022bc0: 3d22 6465 6661 756c 7422 293a 0a20 2020  ="default"):.   
+00022bd0: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
+00022be0: 6865 2061 7070 726f 7869 6d61 7465 206d  he approximate m
+00022bf0: 6564 6961 6e20 6f66 2074 6865 2076 616c  edian of the val
+00022c00: 7565 7320 6f76 6572 2074 6865 2072 6571  ues over the req
+00022c10: 7565 7374 6564 2061 7869 732e 0a0a 2020  uested axis...  
+00022c20: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00022c30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00022c40: 2d2d 2d0a 2020 2020 2020 2020 6d65 7468  ---.        meth
+00022c50: 6f64 203a 207b 2764 6566 6175 6c74 272c  od : {'default',
+00022c60: 2027 7464 6967 6573 7427 2c20 2764 6173   'tdigest', 'das
+00022c70: 6b27 7d2c 206f 7074 696f 6e61 6c0a 2020  k'}, optional.  
+00022c80: 2020 2020 2020 2020 2020 5768 6174 206d            What m
+00022c90: 6574 686f 6420 746f 2075 7365 2e20 4279  ethod to use. By
+00022ca0: 2064 6566 6175 6c74 2077 696c 6c20 7573   default will us
+00022cb0: 6520 4461 736b 2773 2069 6e74 6572 6e61  e Dask's interna
+00022cc0: 6c20 6375 7374 6f6d 0a20 2020 2020 2020  l custom.       
+00022cd0: 2020 2020 2061 6c67 6f72 6974 686d 2028       algorithm (
+00022ce0: 6060 2264 6173 6b22 6060 292e 2020 4966  ``"dask"``).  If
+00022cf0: 2073 6574 2074 6f20 6060 2274 6469 6765   set to ``"tdige
+00022d00: 7374 2260 6020 7769 6c6c 2075 7365 2074  st"`` will use t
+00022d10: 6469 6765 7374 0a20 2020 2020 2020 2020  digest.         
+00022d20: 2020 2066 6f72 2066 6c6f 6174 7320 616e     for floats an
+00022d30: 6420 696e 7473 2061 6e64 2066 616c 6c62  d ints and fallb
+00022d40: 6163 6b20 746f 2074 6865 2060 6022 6461  ack to the ``"da
+00022d50: 736b 2260 6020 6f74 6865 7277 6973 652e  sk"`` otherwise.
+00022d60: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00022d70: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00022d80: 2e71 7561 6e74 696c 6528 713d 302e 352c  .quantile(q=0.5,
+00022d90: 206d 6574 686f 643d 6d65 7468 6f64 290a   method=method).
+00022da0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00022db0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
+00022dc0: 2020 6465 6620 6d65 6469 616e 2873 656c    def median(sel
+00022dd0: 662c 206d 6574 686f 643d 2264 6566 6175  f, method="defau
+00022de0: 6c74 2229 3a0a 2020 2020 2020 2020 6966  lt"):.        if
+00022df0: 2073 656c 662e 6e70 6172 7469 7469 6f6e   self.npartition
+00022e00: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
+00022e10: 2020 2020 2320 4361 6e20 7072 6f76 6964      # Can provid
+00022e20: 6520 616e 2065 7861 6374 206d 6564 6961  e an exact media
+00022e30: 6e20 696e 2074 6865 7365 2063 6173 6573  n in these cases
+00022e40: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00022e50: 7572 6e20 7365 6c66 2e6d 6564 6961 6e5f  urn self.median_
+00022e60: 6170 7072 6f78 696d 6174 6528 6d65 7468  approximate(meth
+00022e70: 6f64 3d6d 6574 686f 6429 0a20 2020 2020  od=method).     
+00022e80: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00022e90: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+00022ea0: 2020 2020 2020 2020 2020 2244 6173 6b20            "Dask 
+00022eb0: 646f 6573 6e27 7420 696d 706c 656d 656e  doesn't implemen
+00022ec0: 7420 616e 2065 7861 6374 206d 6564 6961  t an exact media
+00022ed0: 6e20 696e 2061 6c6c 2063 6173 6573 2061  n in all cases a
+00022ee0: 7320 7468 6973 2069 7320 6861 7264 2074  s this is hard t
+00022ef0: 6f20 646f 2069 6e20 7061 7261 6c6c 656c  o do in parallel
+00022f00: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
+00022f10: 2253 6565 2074 6865 2060 6d65 6469 616e  "See the `median
+00022f20: 5f61 7070 726f 7869 6d61 7465 6020 6d65  _approximate` me
+00022f30: 7468 6f64 2069 6e73 7465 6164 2c20 7768  thod instead, wh
+00022f40: 6963 6820 7573 6573 2061 6e20 6170 7072  ich uses an appr
+00022f50: 6f78 696d 6174 6520 616c 676f 7269 7468  oximate algorith
+00022f60: 6d2e 220a 2020 2020 2020 2020 290a 0a20  m.".        ).. 
+00022f70: 2020 2064 6566 205f 7265 7061 7274 6974     def _repartit
+00022f80: 696f 6e5f 7175 616e 7469 6c65 7328 7365  ion_quantiles(se
+00022f90: 6c66 2c20 6e70 6172 7469 7469 6f6e 732c  lf, npartitions,
+00022fa0: 2075 7073 616d 706c 653d 312e 3029 3a0a   upsample=1.0):.
+00022fb0: 2020 2020 2020 2020 2222 2241 7070 726f          """Appro
+00022fc0: 7869 6d61 7465 2071 7561 6e74 696c 6573  ximate quantiles
+00022fd0: 206f 6620 5365 7269 6573 2075 7365 6420   of Series used 
+00022fe0: 666f 7220 7265 7061 7274 6974 696f 6e69  for repartitioni
+00022ff0: 6e67 2222 220a 2020 2020 2020 2020 6672  ng""".        fr
+00023000: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+00023010: 652e 7061 7274 6974 696f 6e71 7561 6e74  e.partitionquant
+00023020: 696c 6573 2069 6d70 6f72 7420 7061 7274  iles import part
+00023030: 6974 696f 6e5f 7175 616e 7469 6c65 730a  ition_quantiles.
+00023040: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00023050: 7061 7274 6974 696f 6e5f 7175 616e 7469  partition_quanti
+00023060: 6c65 7328 7365 6c66 2c20 6e70 6172 7469  les(self, nparti
+00023070: 7469 6f6e 732c 2075 7073 616d 706c 653d  tions, upsample=
+00023080: 7570 7361 6d70 6c65 290a 0a20 2020 2064  upsample)..    d
+00023090: 6566 205f 5f67 6574 6974 656d 5f5f 2873  ef __getitem__(s
+000230a0: 656c 662c 206b 6579 293a 0a20 2020 2020  elf, key):.     
+000230b0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+000230c0: 286b 6579 2c20 5365 7269 6573 2920 616e  (key, Series) an
+000230d0: 6420 7365 6c66 2e64 6976 6973 696f 6e73  d self.divisions
+000230e0: 203d 3d20 6b65 792e 6469 7669 7369 6f6e   == key.division
+000230f0: 733a 0a20 2020 2020 2020 2020 2020 206e  s:.            n
+00023100: 616d 6520 3d20 2269 6e64 6578 2d25 7322  ame = "index-%s"
+00023110: 2025 2074 6f6b 656e 697a 6528 7365 6c66   % tokenize(self
+00023120: 2c20 6b65 7929 0a20 2020 2020 2020 2020  , key).         
+00023130: 2020 2064 736b 203d 2070 6172 7469 7469     dsk = partiti
+00023140: 6f6e 7769 7365 5f67 7261 7068 286f 7065  onwise_graph(ope
+00023150: 7261 746f 722e 6765 7469 7465 6d2c 206e  rator.getitem, n
+00023160: 616d 652c 2073 656c 662c 206b 6579 290a  ame, self, key).
+00023170: 2020 2020 2020 2020 2020 2020 6772 6170              grap
+00023180: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
+00023190: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
+000231a0: 6f6e 7328 6e61 6d65 2c20 6473 6b2c 2064  ons(name, dsk, d
+000231b0: 6570 656e 6465 6e63 6965 733d 5b73 656c  ependencies=[sel
+000231c0: 662c 206b 6579 5d29 0a20 2020 2020 2020  f, key]).       
+000231d0: 2020 2020 2072 6574 7572 6e20 5365 7269       return Seri
+000231e0: 6573 2867 7261 7068 2c20 6e61 6d65 2c20  es(graph, name, 
+000231f0: 7365 6c66 2e5f 6d65 7461 2c20 7365 6c66  self._meta, self
+00023200: 2e64 6976 6973 696f 6e73 290a 2020 2020  .divisions).    
+00023210: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00023220: 6c6f 635b 6b65 795d 0a0a 2020 2020 4064  loc[key]..    @d
+00023230: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00023240: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+00023250: 6620 5f67 6574 5f6e 756d 6572 6963 5f64  f _get_numeric_d
+00023260: 6174 6128 7365 6c66 2c20 686f 773d 2261  ata(self, how="a
+00023270: 6e79 222c 2073 7562 7365 743d 4e6f 6e65  ny", subset=None
+00023280: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00023290: 6e20 7365 6c66 0a0a 2020 2020 6966 206e  n self..    if n
+000232a0: 6f74 2050 414e 4441 535f 4754 5f32 3030  ot PANDAS_GT_200
+000232b0: 3a0a 0a20 2020 2020 2020 2040 6465 7269  :..        @deri
+000232c0: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
+000232d0: 6573 290a 2020 2020 2020 2020 6465 6620  es).        def 
+000232e0: 6974 6572 6974 656d 7328 7365 6c66 293a  iteritems(self):
+000232f0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00023300: 5041 4e44 4153 5f47 545f 3135 303a 0a20  PANDAS_GT_150:. 
+00023310: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00023320: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
+00023330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023340: 2020 2269 7465 7269 7465 6d73 2069 7320    "iteritems is 
+00023350: 6465 7072 6563 6174 6564 2061 6e64 2077  deprecated and w
+00023360: 696c 6c20 6265 2072 656d 6f76 6564 2069  ill be removed i
+00023370: 6e20 6120 6675 7475 7265 2076 6572 7369  n a future versi
+00023380: 6f6e 2e20 220a 2020 2020 2020 2020 2020  on. ".          
+00023390: 2020 2020 2020 2020 2020 2255 7365 202e            "Use .
+000233a0: 6974 656d 7320 696e 7374 6561 642e 222c  items instead.",
+000233b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000233c0: 2020 2020 2046 7574 7572 6557 6172 6e69       FutureWarni
+000233d0: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
+000233e0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000233f0: 2020 2320 5765 2075 7365 2074 6865 2060    # We use the `
+00023400: 5f60 2067 656e 6572 6174 6f72 2062 656c  _` generator bel
+00023410: 6f77 2074 6f20 656e 7375 7265 2074 6865  ow to ensure the
+00023420: 2064 6570 7265 6361 7469 6f6e 2077 6172   deprecation war
+00023430: 6e69 6e67 2061 626f 7665 0a20 2020 2020  ning above.     
+00023440: 2020 2020 2020 2023 2069 7320 7261 6973         # is rais
+00023450: 6564 2077 6865 6e20 602e 6974 6572 6974  ed when `.iterit
+00023460: 656d 7328 2960 2069 7320 6361 6c6c 6564  ems()` is called
+00023470: 2c20 6e6f 7420 7768 656e 2074 6865 2066  , not when the f
+00023480: 6972 7374 2060 6e65 7874 283c 6765 6e65  irst `next(<gene
+00023490: 7261 746f 723e 2960 0a20 2020 2020 2020  rator>)`.       
+000234a0: 2020 2020 2023 2069 7465 7261 7469 6f6e       # iteration
+000234b0: 2068 6170 7065 6e73 0a0a 2020 2020 2020   happens..      
+000234c0: 2020 2020 2020 6465 6620 5f28 7365 6c66        def _(self
+000234d0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000234e0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+000234f0: 6528 7365 6c66 2e6e 7061 7274 6974 696f  e(self.npartitio
+00023500: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
+00023510: 2020 2020 2020 2020 2073 203d 2073 656c           s = sel
+00023520: 662e 6765 745f 7061 7274 6974 696f 6e28  f.get_partition(
+00023530: 6929 2e63 6f6d 7075 7465 2829 0a20 2020  i).compute().   
+00023540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023550: 2079 6965 6c64 2066 726f 6d20 732e 6974   yield from s.it
+00023560: 656d 7328 290a 0a20 2020 2020 2020 2020  ems()..         
+00023570: 2020 2072 6574 7572 6e20 5f28 7365 6c66     return _(self
+00023580: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00023590: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
+000235a0: 2020 2020 6465 6620 5f5f 6974 6572 5f5f      def __iter__
+000235b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000235c0: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
+000235d0: 656c 662e 6e70 6172 7469 7469 6f6e 7329  elf.npartitions)
+000235e0: 3a0a 2020 2020 2020 2020 2020 2020 7320  :.            s 
+000235f0: 3d20 7365 6c66 2e67 6574 5f70 6172 7469  = self.get_parti
+00023600: 7469 6f6e 2869 292e 636f 6d70 7574 6528  tion(i).compute(
+00023610: 290a 2020 2020 2020 2020 2020 2020 7969  ).            yi
+00023620: 656c 6420 6672 6f6d 2073 0a0a 2020 2020  eld from s..    
+00023630: 405f 6465 7072 6563 6174 6564 280a 2020  @_deprecated(.  
+00023640: 2020 2020 2020 6d65 7373 6167 653d 280a        message=(.
+00023650: 2020 2020 2020 2020 2020 2020 2255 7369              "Usi
+00023660: 6e67 2074 6865 2060 6069 6e60 6020 6f70  ng the ``in`` op
+00023670: 6572 6174 6f72 2074 6f20 7465 7374 2066  erator to test f
+00023680: 6f72 206d 656d 6265 7273 6869 7020 696e  or membership in
+00023690: 2053 6572 6965 7320 6973 2022 0a20 2020   Series is ".   
+000236a0: 2020 2020 2020 2020 2022 6465 7072 6563           "deprec
+000236b0: 6174 6564 2e20 546f 2074 6573 7420 666f  ated. To test fo
+000236c0: 7220 6d65 6d62 6572 7368 6970 2069 6e20  r membership in 
+000236d0: 7468 6520 696e 6465 7820 7573 6520 220a  the index use ".
+000236e0: 2020 2020 2020 2020 2020 2020 2260 6028              "``(
+000236f0: 732e 696e 6465 7820 3d3d 206b 6579 292e  s.index == key).
+00023700: 616e 7928 2960 602e 2053 696d 696c 6172  any()``. Similar
+00023710: 6c79 2074 6f20 7465 7374 2066 6f72 206d  ly to test for m
+00023720: 656d 6265 7273 6869 7020 696e 2022 0a20  embership in ". 
+00023730: 2020 2020 2020 2020 2020 2022 7468 6520             "the 
+00023740: 7661 6c75 6573 2075 7365 2060 6028 7320  values use ``(s 
+00023750: 3d3d 206b 6579 292e 616e 7928 2960 6022  == key).any()``"
+00023760: 0a20 2020 2020 2020 2029 0a20 2020 2029  .        ).    )
+00023770: 0a20 2020 2064 6566 205f 5f63 6f6e 7461  .    def __conta
+00023780: 696e 735f 5f28 7365 6c66 2c20 6b65 7929  ins__(self, key)
+00023790: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000237a0: 2028 7365 6c66 203d 3d20 6b65 7929 2e61   (self == key).a
+000237b0: 6e79 2829 2e63 6f6d 7075 7465 2829 0a0a  ny().compute()..
+000237c0: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
+000237d0: 0a20 2020 2064 6566 205f 7661 6c69 6461  .    def _valida
+000237e0: 7465 5f61 7869 7328 636c 732c 2061 7869  te_axis(cls, axi
+000237f0: 733d 302c 206e 6f6e 655f 6973 5f7a 6572  s=0, none_is_zer
+00023800: 6f3a 2062 6f6f 6c20 3d20 5472 7565 2920  o: bool = True) 
+00023810: 2d3e 204e 6f6e 6520 7c20 4c69 7465 7261  -> None | Litera
+00023820: 6c5b 302c 2031 5d3a 0a20 2020 2020 2020  l[0, 1]:.       
+00023830: 2069 6620 6178 6973 206e 6f74 2069 6e20   if axis not in 
+00023840: 2830 2c20 2269 6e64 6578 222c 204e 6f6e  (0, "index", Non
+00023850: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00023860: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00023870: 2866 224e 6f20 6178 6973 206e 616d 6564  (f"No axis named
+00023880: 207b 6178 6973 7d22 290a 2020 2020 2020   {axis}").      
+00023890: 2020 2320 636f 6e76 6572 7420 746f 206e    # convert to n
+000238a0: 756d 6572 6963 2061 7869 730a 2020 2020  umeric axis.    
+000238b0: 2020 2020 6e75 6d65 7269 635f 6178 6973      numeric_axis
+000238c0: 3a20 6469 6374 5b73 7472 207c 204e 6f6e  : dict[str | Non
+000238d0: 652c 204c 6974 6572 616c 5b30 2c20 315d  e, Literal[0, 1]
+000238e0: 5d20 3d20 7b22 696e 6465 7822 3a20 307d  ] = {"index": 0}
+000238f0: 0a20 2020 2020 2020 2069 6620 6e6f 6e65  .        if none
+00023900: 5f69 735f 7a65 726f 3a0a 2020 2020 2020  _is_zero:.      
+00023910: 2020 2020 2020 6e75 6d65 7269 635f 6178        numeric_ax
+00023920: 6973 5b4e 6f6e 655d 203d 2030 0a20 2020  is[None] = 0.   
+00023930: 2020 2020 2072 6574 7572 6e20 6e75 6d65       return nume
+00023940: 7269 635f 6178 6973 2e67 6574 2861 7869  ric_axis.get(axi
+00023950: 732c 2061 7869 7329 0a0a 2020 2020 4064  s, axis)..    @d
+00023960: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+00023970: 6572 6965 7329 0a20 2020 2064 6566 2067  eries).    def g
+00023980: 726f 7570 6279 280a 2020 2020 2020 2020  roupby(.        
+00023990: 7365 6c66 2c0a 2020 2020 2020 2020 6279  self,.        by
+000239a0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2067  =None,.        g
+000239b0: 726f 7570 5f6b 6579 733d 4752 4f55 505f  roup_keys=GROUP_
+000239c0: 4b45 5953 5f44 4546 4155 4c54 2c0a 2020  KEYS_DEFAULT,.  
+000239d0: 2020 2020 2020 736f 7274 3d4e 6f6e 652c        sort=None,
+000239e0: 0a20 2020 2020 2020 206f 6273 6572 7665  .        observe
+000239f0: 643d 4e6f 6e65 2c0a 2020 2020 2020 2020  d=None,.        
+00023a00: 6472 6f70 6e61 3d4e 6f6e 652c 0a20 2020  dropna=None,.   
+00023a10: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
+00023a20: 2020 2029 3a0a 2020 2020 2020 2020 6672     ):.        fr
+00023a30: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+00023a40: 652e 6772 6f75 7062 7920 696d 706f 7274  e.groupby import
+00023a50: 2053 6572 6965 7347 726f 7570 4279 0a0a   SeriesGroupBy..
+00023a60: 2020 2020 2020 2020 7265 7475 726e 2053          return S
+00023a70: 6572 6965 7347 726f 7570 4279 280a 2020  eriesGroupBy(.  
+00023a80: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
+00023a90: 2020 2020 2020 2020 2020 2020 6279 3d62              by=b
+00023aa0: 792c 0a20 2020 2020 2020 2020 2020 2067  y,.            g
+00023ab0: 726f 7570 5f6b 6579 733d 6772 6f75 705f  roup_keys=group_
+00023ac0: 6b65 7973 2c0a 2020 2020 2020 2020 2020  keys,.          
+00023ad0: 2020 736f 7274 3d73 6f72 742c 0a20 2020    sort=sort,.   
+00023ae0: 2020 2020 2020 2020 206f 6273 6572 7665           observe
+00023af0: 643d 6f62 7365 7276 6564 2c0a 2020 2020  d=observed,.    
+00023b00: 2020 2020 2020 2020 6472 6f70 6e61 3d64          dropna=d
+00023b10: 726f 706e 612c 0a20 2020 2020 2020 2020  ropna,.         
+00023b20: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
+00023b30: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+00023b40: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+00023b50: 6965 7329 0a20 2020 2064 6566 2063 6f75  ies).    def cou
+00023b60: 6e74 2873 656c 662c 2073 706c 6974 5f65  nt(self, split_e
+00023b70: 7665 7279 3d46 616c 7365 293a 0a20 2020  very=False):.   
+00023b80: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
+00023b90: 7228 292e 636f 756e 7428 7370 6c69 745f  r().count(split_
+00023ba0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00023bb0: 7929 0a0a 2020 2020 4064 6572 6976 6564  y)..    @derived
+00023bc0: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
+00023bd0: 0a20 2020 2064 6566 206d 6f64 6528 7365  .    def mode(se
+00023be0: 6c66 2c20 6472 6f70 6e61 3d54 7275 652c  lf, dropna=True,
+00023bf0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+00023c00: 7365 293a 0a20 2020 2020 2020 2072 6574  se):.        ret
+00023c10: 7572 6e20 7375 7065 7228 292e 6d6f 6465  urn super().mode
+00023c20: 2864 726f 706e 613d 6472 6f70 6e61 2c20  (dropna=dropna, 
+00023c30: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+00023c40: 745f 6576 6572 7929 0a0a 2020 2020 4064  t_every)..    @d
+00023c50: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+00023c60: 6572 6965 7329 0a20 2020 2064 6566 2065  eries).    def e
+00023c70: 7870 6c6f 6465 2873 656c 6629 3a0a 2020  xplode(self):.  
+00023c80: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
+00023c90: 662e 5f6d 6574 612e 6578 706c 6f64 6528  f._meta.explode(
+00023ca0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00023cb0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+00023cc0: 696f 6e73 284d 2e65 7870 6c6f 6465 2c20  ions(M.explode, 
+00023cd0: 6d65 7461 3d6d 6574 612c 2065 6e66 6f72  meta=meta, enfor
+00023ce0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+00023cf0: 6529 0a0a 2020 2020 6465 6620 756e 6971  e)..    def uniq
+00023d00: 7565 2873 656c 662c 2073 706c 6974 5f65  ue(self, split_e
+00023d10: 7665 7279 3d4e 6f6e 652c 2073 706c 6974  very=None, split
+00023d20: 5f6f 7574 3d31 293a 0a20 2020 2020 2020  _out=1):.       
+00023d30: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+00023d40: 7572 6e20 5365 7269 6573 206f 6620 756e  urn Series of un
+00023d50: 6971 7565 2076 616c 7565 7320 696e 2074  ique values in t
+00023d60: 6865 206f 626a 6563 742e 2049 6e63 6c75  he object. Inclu
+00023d70: 6465 7320 4e41 2076 616c 7565 732e 0a0a  des NA values...
+00023d80: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+00023d90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+00023da0: 2020 2020 2020 2020 756e 6971 7565 7320          uniques 
+00023db0: 3a20 5365 7269 6573 0a20 2020 2020 2020  : Series.       
+00023dc0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+00023dd0: 7572 6e20 6163 6128 0a20 2020 2020 2020  urn aca(.       
+00023de0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00023df0: 2020 2020 2020 2063 6875 6e6b 3d6d 6574         chunk=met
+00023e00: 686f 6473 2e75 6e69 7175 652c 0a20 2020  hods.unique,.   
+00023e10: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
+00023e20: 7465 3d6d 6574 686f 6473 2e75 6e69 7175  te=methods.uniqu
+00023e30: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
+00023e40: 6574 613d 7365 6c66 2e5f 6d65 7461 2c0a  eta=self._meta,.
+00023e50: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
+00023e60: 6e3d 2275 6e69 7175 6522 2c0a 2020 2020  n="unique",.    
+00023e70: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+00023e80: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
+00023e90: 0a20 2020 2020 2020 2020 2020 2073 6572  .            ser
+00023ea0: 6965 735f 6e61 6d65 3d73 656c 662e 6e61  ies_name=self.na
+00023eb0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+00023ec0: 7370 6c69 745f 6f75 743d 7370 6c69 745f  split_out=split_
+00023ed0: 6f75 742c 0a20 2020 2020 2020 2029 0a0a  out,.        )..
+00023ee0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00023ef0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+00023f00: 2064 6566 206e 756e 6971 7565 2873 656c   def nunique(sel
+00023f10: 662c 2073 706c 6974 5f65 7665 7279 3d4e  f, split_every=N
+00023f20: 6f6e 652c 2064 726f 706e 613d 5472 7565  one, dropna=True
+00023f30: 293a 0a20 2020 2020 2020 2075 6e69 7173  ):.        uniqs
+00023f40: 203d 2073 656c 662e 6472 6f70 5f64 7570   = self.drop_dup
+00023f50: 6c69 6361 7465 7328 7370 6c69 745f 6576  licates(split_ev
+00023f60: 6572 793d 7370 6c69 745f 6576 6572 7929  ery=split_every)
+00023f70: 0a20 2020 2020 2020 2069 6620 6472 6f70  .        if drop
+00023f80: 6e61 3a0a 2020 2020 2020 2020 2020 2020  na:.            
+00023f90: 2320 636f 756e 7420 6d69 6d69 6373 2070  # count mimics p
+00023fa0: 616e 6461 7320 6265 6861 7669 6f72 2061  andas behavior a
+00023fb0: 6e64 2065 7863 6c75 6465 7320 4e41 2076  nd excludes NA v
+00023fc0: 616c 7565 730a 2020 2020 2020 2020 2020  alues.          
+00023fd0: 2020 7265 7475 726e 2075 6e69 7173 2e63    return uniqs.c
+00023fe0: 6f75 6e74 2829 0a20 2020 2020 2020 2065  ount().        e
+00023ff0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00024000: 2072 6574 7572 6e20 756e 6971 732e 7369   return uniqs.si
+00024010: 7a65 0a0a 2020 2020 4064 6572 6976 6564  ze..    @derived
+00024020: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
+00024030: 0a20 2020 2064 6566 2076 616c 7565 5f63  .    def value_c
+00024040: 6f75 6e74 7328 0a20 2020 2020 2020 2073  ounts(.        s
+00024050: 656c 662c 0a20 2020 2020 2020 2073 6f72  elf,.        sor
+00024060: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
+00024070: 6173 6365 6e64 696e 673d 4661 6c73 652c  ascending=False,
+00024080: 0a20 2020 2020 2020 2064 726f 706e 613d  .        dropna=
+00024090: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e6f  None,.        no
+000240a0: 726d 616c 697a 653d 4661 6c73 652c 0a20  rmalize=False,. 
+000240b0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+000240c0: 7279 3d4e 6f6e 652c 0a20 2020 2020 2020  ry=None,.       
+000240d0: 2073 706c 6974 5f6f 7574 3d31 2c0a 2020   split_out=1,.  
+000240e0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+000240f0: 0a20 2020 2020 2020 204e 6f74 653a 2064  .        Note: d
+00024100: 726f 706e 6120 6973 206f 6e6c 7920 7375  ropna is only su
+00024110: 7070 6f72 7465 6420 696e 2070 616e 6461  pported in panda
+00024120: 7320 3e3d 2031 2e31 2e30 2c20 696e 2077  s >= 1.1.0, in w
+00024130: 6869 6368 2063 6173 6520 6974 2064 6566  hich case it def
+00024140: 6175 6c74 7320 746f 0a20 2020 2020 2020  aults to.       
+00024150: 2054 7275 652e 0a20 2020 2020 2020 2022   True..        "
+00024160: 2222 0a20 2020 2020 2020 206b 7761 7267  "".        kwarg
+00024170: 7320 3d20 7b22 736f 7274 223a 2073 6f72  s = {"sort": sor
+00024180: 742c 2022 6173 6365 6e64 696e 6722 3a20  t, "ascending": 
+00024190: 6173 6365 6e64 696e 677d 0a20 2020 2020  ascending}.     
+000241a0: 2020 2069 6620 6472 6f70 6e61 2069 7320     if dropna is 
+000241b0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+000241c0: 2020 2020 2020 6b77 6172 6773 5b22 6472        kwargs["dr
+000241d0: 6f70 6e61 225d 203d 2064 726f 706e 610a  opna"] = dropna.
+000241e0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+000241f0: 655f 6b77 6172 6773 203d 207b 226e 6f72  e_kwargs = {"nor
+00024200: 6d61 6c69 7a65 223a 206e 6f72 6d61 6c69  malize": normali
+00024210: 7a65 7d0a 2020 2020 2020 2020 6966 2073  ze}.        if s
+00024220: 706c 6974 5f6f 7574 203e 2031 3a0a 2020  plit_out > 1:.  
+00024230: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
+00024240: 6174 655f 6b77 6172 6773 5b22 746f 7461  ate_kwargs["tota
+00024250: 6c5f 6c65 6e67 7468 225d 203d 2028 0a20  l_length"] = (. 
+00024260: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00024270: 656e 2873 656c 6629 2069 6620 6472 6f70  en(self) if drop
+00024280: 6e61 2069 7320 4661 6c73 6520 656c 7365  na is False else
+00024290: 206c 656e 2873 656c 662e 6472 6f70 6e61   len(self.dropna
+000242a0: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
+000242b0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+000242c0: 6e20 6163 6128 0a20 2020 2020 2020 2020  n aca(.         
+000242d0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000242e0: 2020 2020 2063 6875 6e6b 3d4d 2e76 616c       chunk=M.val
+000242f0: 7565 5f63 6f75 6e74 732c 0a20 2020 2020  ue_counts,.     
+00024300: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
+00024310: 3d6d 6574 686f 6473 2e76 616c 7565 5f63  =methods.value_c
+00024320: 6f75 6e74 735f 6167 6772 6567 6174 652c  ounts_aggregate,
+00024330: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
+00024340: 6269 6e65 3d6d 6574 686f 6473 2e76 616c  bine=methods.val
+00024350: 7565 5f63 6f75 6e74 735f 636f 6d62 696e  ue_counts_combin
+00024360: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
+00024370: 6574 613d 7365 6c66 2e5f 6d65 7461 2e76  eta=self._meta.v
+00024380: 616c 7565 5f63 6f75 6e74 7328 6e6f 726d  alue_counts(norm
+00024390: 616c 697a 653d 6e6f 726d 616c 697a 6529  alize=normalize)
+000243a0: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
+000243b0: 6b65 6e3d 2276 616c 7565 2d63 6f75 6e74  ken="value-count
+000243c0: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+000243d0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+000243e0: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
+000243f0: 2020 2020 2073 706c 6974 5f6f 7574 3d73       split_out=s
+00024400: 706c 6974 5f6f 7574 2c0a 2020 2020 2020  plit_out,.      
+00024410: 2020 2020 2020 7370 6c69 745f 6f75 745f        split_out_
+00024420: 7365 7475 703d 7370 6c69 745f 6f75 745f  setup=split_out_
+00024430: 6f6e 5f69 6e64 6578 2c0a 2020 2020 2020  on_index,.      
+00024440: 2020 2020 2020 6167 6772 6567 6174 655f        aggregate_
+00024450: 6b77 6172 6773 3d61 6767 7265 6761 7465  kwargs=aggregate
+00024460: 5f6b 7761 7267 732c 0a20 2020 2020 2020  _kwargs,.       
+00024470: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
+00024480: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+00024490: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+000244a0: 6572 6965 7329 0a20 2020 2064 6566 206e  eries).    def n
+000244b0: 6c61 7267 6573 7428 7365 6c66 2c20 6e3d  largest(self, n=
+000244c0: 352c 2073 706c 6974 5f65 7665 7279 3d4e  5, split_every=N
+000244d0: 6f6e 6529 3a0a 2020 2020 2020 2020 7265  one):.        re
+000244e0: 7475 726e 2061 6361 280a 2020 2020 2020  turn aca(.      
+000244f0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00024500: 2020 2020 2020 2020 6368 756e 6b3d 4d2e          chunk=M.
+00024510: 6e6c 6172 6765 7374 2c0a 2020 2020 2020  nlargest,.      
+00024520: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
+00024530: 4d2e 6e6c 6172 6765 7374 2c0a 2020 2020  M.nlargest,.    
+00024540: 2020 2020 2020 2020 6d65 7461 3d73 656c          meta=sel
+00024550: 662e 5f6d 6574 612c 0a20 2020 2020 2020  f._meta,.       
+00024560: 2020 2020 2074 6f6b 656e 3d22 7365 7269       token="seri
+00024570: 6573 2d6e 6c61 7267 6573 7422 2c0a 2020  es-nlargest",.  
+00024580: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
+00024590: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+000245a0: 792c 0a20 2020 2020 2020 2020 2020 206e  y,.            n
+000245b0: 3d6e 2c0a 2020 2020 2020 2020 290a 0a20  =n,.        ).. 
+000245c0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+000245d0: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
+000245e0: 6465 6620 6e73 6d61 6c6c 6573 7428 7365  def nsmallest(se
+000245f0: 6c66 2c20 6e3d 352c 2073 706c 6974 5f65  lf, n=5, split_e
+00024600: 7665 7279 3d4e 6f6e 6529 3a0a 2020 2020  very=None):.    
+00024610: 2020 2020 7265 7475 726e 2061 6361 280a      return aca(.
+00024620: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00024630: 2c0a 2020 2020 2020 2020 2020 2020 6368  ,.            ch
+00024640: 756e 6b3d 4d2e 6e73 6d61 6c6c 6573 742c  unk=M.nsmallest,
+00024650: 0a20 2020 2020 2020 2020 2020 2061 6767  .            agg
+00024660: 7265 6761 7465 3d4d 2e6e 736d 616c 6c65  regate=M.nsmalle
+00024670: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+00024680: 6d65 7461 3d73 656c 662e 5f6d 6574 612c  meta=self._meta,
+00024690: 0a20 2020 2020 2020 2020 2020 2074 6f6b  .            tok
+000246a0: 656e 3d22 7365 7269 6573 2d6e 736d 616c  en="series-nsmal
+000246b0: 6c65 7374 222c 0a20 2020 2020 2020 2020  lest",.         
+000246c0: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
+000246d0: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
+000246e0: 2020 2020 2020 2020 6e3d 6e2c 0a20 2020          n=n,.   
+000246f0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+00024700: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+00024710: 6965 7329 0a20 2020 2064 6566 2069 7369  ies).    def isi
+00024720: 6e28 7365 6c66 2c20 7661 6c75 6573 293a  n(self, values):
+00024730: 0a20 2020 2020 2020 2023 2041 6464 6564  .        # Added
+00024740: 206a 7573 7420 746f 2067 6574 2074 6865   just to get the
+00024750: 2064 6966 6665 7265 6e74 2064 6f63 7374   different docst
+00024760: 7269 6e67 2066 6f72 2053 6572 6965 730a  ring for Series.
+00024770: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00024780: 7570 6572 2829 2e69 7369 6e28 7661 6c75  uper().isin(valu
+00024790: 6573 290a 0a20 2020 2040 696e 7365 7274  es)..    @insert
+000247a0: 5f6d 6574 615f 7061 7261 6d5f 6465 7363  _meta_param_desc
+000247b0: 7269 7074 696f 6e28 7061 643d 3132 290a  ription(pad=12).
+000247c0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+000247d0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+000247e0: 2064 6566 206d 6170 2873 656c 662c 2061   def map(self, a
+000247f0: 7267 2c20 6e61 5f61 6374 696f 6e3d 4e6f  rg, na_action=No
+00024800: 6e65 2c20 6d65 7461 3d6e 6f5f 6465 6661  ne, meta=no_defa
+00024810: 756c 7429 3a0a 2020 2020 2020 2020 6966  ult):.        if
+00024820: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
+00024830: 6172 6729 2061 6e64 2069 735f 6461 736b  arg) and is_dask
+00024840: 5f63 6f6c 6c65 6374 696f 6e28 6172 6729  _collection(arg)
+00024850: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00024860: 7475 726e 2073 6572 6965 735f 6d61 7028  turn series_map(
+00024870: 7365 6c66 2c20 6172 6729 0a20 2020 2020  self, arg).     
+00024880: 2020 2069 6620 6e6f 7420 280a 2020 2020     if not (.    
+00024890: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
+000248a0: 6365 2861 7267 2c20 6469 6374 290a 2020  ce(arg, dict).  
+000248b0: 2020 2020 2020 2020 2020 6f72 2063 616c            or cal
+000248c0: 6c61 626c 6528 6172 6729 0a20 2020 2020  lable(arg).     
+000248d0: 2020 2020 2020 206f 7220 6973 5f73 6572         or is_ser
+000248e0: 6965 735f 6c69 6b65 2861 7267 290a 2020  ies_like(arg).  
+000248f0: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
+00024900: 7420 6973 5f64 6173 6b5f 636f 6c6c 6563  t is_dask_collec
+00024910: 7469 6f6e 2861 7267 290a 2020 2020 2020  tion(arg).      
+00024920: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+00024930: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00024940: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00024950: 2020 6622 6172 6720 6d75 7374 2062 6520    f"arg must be 
+00024960: 7061 6e64 6173 2e53 6572 6965 732c 2064  pandas.Series, d
+00024970: 6963 7420 6f72 2063 616c 6c61 626c 652e  ict or callable.
+00024980: 2047 6f74 207b 7479 7065 2861 7267 297d   Got {type(arg)}
+00024990: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+000249a0: 2020 2020 2020 2020 6e61 6d65 203d 2022          name = "
+000249b0: 6d61 702d 2220 2b20 746f 6b65 6e69 7a65  map-" + tokenize
+000249c0: 2873 656c 662c 2061 7267 2c20 6e61 5f61  (self, arg, na_a
+000249d0: 6374 696f 6e29 0a20 2020 2020 2020 2064  ction).        d
+000249e0: 736b 203d 207b 0a20 2020 2020 2020 2020  sk = {.         
+000249f0: 2020 2028 6e61 6d65 2c20 6929 3a20 284d     (name, i): (M
+00024a00: 2e6d 6170 2c20 6b2c 2061 7267 2c20 6e61  .map, k, arg, na
+00024a10: 5f61 6374 696f 6e29 0a20 2020 2020 2020  _action).       
+00024a20: 2020 2020 2066 6f72 2069 2c20 6b20 696e       for i, k in
+00024a30: 2065 6e75 6d65 7261 7465 2873 656c 662e   enumerate(self.
+00024a40: 5f5f 6461 736b 5f6b 6579 735f 5f28 2929  __dask_keys__())
+00024a50: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00024a60: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+00024a70: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+00024a80: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
+00024a90: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+00024aa0: 6573 3d5b 7365 6c66 5d29 0a20 2020 2020  es=[self]).     
+00024ab0: 2020 2069 6620 6d65 7461 2069 7320 6e6f     if meta is no
+00024ac0: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
+00024ad0: 2020 2020 2020 6d65 7461 203d 205f 656d        meta = _em
+00024ae0: 756c 6174 6528 4d2e 6d61 702c 2073 656c  ulate(M.map, sel
+00024af0: 662c 2061 7267 2c20 6e61 5f61 6374 696f  f, arg, na_actio
+00024b00: 6e3d 6e61 5f61 6374 696f 6e2c 2075 6466  n=na_action, udf
+00024b10: 3d54 7275 6529 0a20 2020 2020 2020 2065  =True).        e
+00024b20: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00024b30: 206d 6574 6120 3d20 6d61 6b65 5f6d 6574   meta = make_met
+00024b40: 6128 0a20 2020 2020 2020 2020 2020 2020  a(.             
+00024b50: 2020 206d 6574 612c 0a20 2020 2020 2020     meta,.       
+00024b60: 2020 2020 2020 2020 2069 6e64 6578 3d67           index=g
+00024b70: 6574 6174 7472 286d 616b 655f 6d65 7461  etattr(make_meta
+00024b80: 2873 656c 6629 2c20 2269 6e64 6578 222c  (self), "index",
+00024b90: 204e 6f6e 6529 2c0a 2020 2020 2020 2020   None),.        
+00024ba0: 2020 2020 2020 2020 7061 7265 6e74 5f6d          parent_m
+00024bb0: 6574 613d 7365 6c66 2e5f 6d65 7461 2c0a  eta=self._meta,.
+00024bc0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00024bd0: 2020 2020 2020 2072 6574 7572 6e20 7479         return ty
+00024be0: 7065 2873 656c 6629 2867 7261 7068 2c20  pe(self)(graph, 
+00024bf0: 6e61 6d65 2c20 6d65 7461 2c20 7365 6c66  name, meta, self
+00024c00: 2e64 6976 6973 696f 6e73 290a 0a20 2020  .divisions)..   
+00024c10: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00024c20: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
+00024c30: 6620 6472 6f70 6e61 2873 656c 6629 3a0a  f dropna(self):.
+00024c40: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00024c50: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+00024c60: 6e73 284d 2e64 726f 706e 612c 2065 6e66  ns(M.dropna, enf
+00024c70: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
+00024c80: 6c73 6529 0a0a 2020 2020 4064 6572 6976  lse)..    @deriv
+00024c90: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
+00024ca0: 7329 0a20 2020 2064 6566 2062 6574 7765  s).    def betwe
+00024cb0: 656e 2873 656c 662c 206c 6566 742c 2072  en(self, left, r
+00024cc0: 6967 6874 2c20 696e 636c 7573 6976 653d  ight, inclusive=
+00024cd0: 2262 6f74 6822 293a 0a20 2020 2020 2020  "both"):.       
+00024ce0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+00024cf0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+00024d00: 2020 2020 2020 2020 204d 2e62 6574 7765           M.betwe
+00024d10: 656e 2c20 6c65 6674 3d6c 6566 742c 2072  en, left=left, r
+00024d20: 6967 6874 3d72 6967 6874 2c20 696e 636c  ight=right, incl
+00024d30: 7573 6976 653d 696e 636c 7573 6976 650a  usive=inclusive.
+00024d40: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+00024d50: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00024d60: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
+00024d70: 636c 6970 2873 656c 662c 206c 6f77 6572  clip(self, lower
+00024d80: 3d4e 6f6e 652c 2075 7070 6572 3d4e 6f6e  =None, upper=Non
+00024d90: 652c 206f 7574 3d4e 6f6e 6529 3a0a 2020  e, out=None):.  
+00024da0: 2020 2020 2020 6966 206f 7574 2069 7320        if out is 
+00024db0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00024dc0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00024dd0: 6545 7272 6f72 2822 276f 7574 2720 6d75  eError("'out' mu
+00024de0: 7374 2062 6520 4e6f 6e65 2229 0a20 2020  st be None").   
+00024df0: 2020 2020 2023 206e 702e 636c 6970 206d       # np.clip m
+00024e00: 6179 2070 6173 7320 6f75 740a 2020 2020  ay pass out.    
+00024e10: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00024e20: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+00024e30: 2020 2020 2020 2020 2020 2020 4d2e 636c              M.cl
+00024e40: 6970 2c20 6c6f 7765 723d 6c6f 7765 722c  ip, lower=lower,
+00024e50: 2075 7070 6572 3d75 7070 6572 2c20 656e   upper=upper, en
+00024e60: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+00024e70: 616c 7365 0a20 2020 2020 2020 2029 0a0a  alse.        )..
+00024e80: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00024e90: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+00024ea0: 2064 6566 2063 6c69 705f 6c6f 7765 7228   def clip_lower(
+00024eb0: 7365 6c66 2c20 7468 7265 7368 6f6c 6429  self, threshold)
+00024ec0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00024ed0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+00024ee0: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
+00024ef0: 2020 4d2e 636c 6970 5f6c 6f77 6572 2c20    M.clip_lower, 
+00024f00: 7468 7265 7368 6f6c 643d 7468 7265 7368  threshold=thresh
+00024f10: 6f6c 642c 2065 6e66 6f72 6365 5f6d 6574  old, enforce_met
+00024f20: 6164 6174 613d 4661 6c73 650a 2020 2020  adata=False.    
+00024f30: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
+00024f40: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
+00024f50: 6573 290a 2020 2020 6465 6620 636c 6970  es).    def clip
+00024f60: 5f75 7070 6572 2873 656c 662c 2074 6872  _upper(self, thr
+00024f70: 6573 686f 6c64 293a 0a20 2020 2020 2020  eshold):.       
+00024f80: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+00024f90: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+00024fa0: 2020 2020 2020 2020 204d 2e63 6c69 705f           M.clip_
+00024fb0: 7570 7065 722c 2074 6872 6573 686f 6c64  upper, threshold
+00024fc0: 3d74 6872 6573 686f 6c64 2c20 656e 666f  =threshold, enfo
+00024fd0: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
+00024fe0: 7365 0a20 2020 2020 2020 2029 0a0a 2020  se.        )..  
+00024ff0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00025000: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
+00025010: 6566 2061 6c69 676e 2873 656c 662c 206f  ef align(self, o
+00025020: 7468 6572 2c20 6a6f 696e 3d22 6f75 7465  ther, join="oute
+00025030: 7222 2c20 6178 6973 3d4e 6f6e 652c 2066  r", axis=None, f
+00025040: 696c 6c5f 7661 6c75 653d 4e6f 6e65 293a  ill_value=None):
+00025050: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00025060: 7375 7065 7228 292e 616c 6967 6e28 6f74  super().align(ot
+00025070: 6865 722c 206a 6f69 6e3d 6a6f 696e 2c20  her, join=join, 
+00025080: 6178 6973 3d61 7869 732c 2066 696c 6c5f  axis=axis, fill_
+00025090: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
+000250a0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+000250b0: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
+000250c0: 2020 2020 6465 6620 636f 6d62 696e 6528      def combine(
+000250d0: 7365 6c66 2c20 6f74 6865 722c 2066 756e  self, other, fun
+000250e0: 632c 2066 696c 6c5f 7661 6c75 653d 4e6f  c, fill_value=No
+000250f0: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
+00025100: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
+00025110: 7469 7469 6f6e 7328 4d2e 636f 6d62 696e  titions(M.combin
+00025120: 652c 206f 7468 6572 2c20 6675 6e63 2c20  e, other, func, 
+00025130: 6669 6c6c 5f76 616c 7565 3d66 696c 6c5f  fill_value=fill_
+00025140: 7661 6c75 6529 0a0a 2020 2020 4064 6572  value)..    @der
+00025150: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+00025160: 6965 7329 0a20 2020 2064 6566 2073 7175  ies).    def squ
+00025170: 6565 7a65 2873 656c 6629 3a0a 2020 2020  eeze(self):.    
+00025180: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+00025190: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+000251a0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
+000251b0: 2020 6465 6620 636f 6d62 696e 655f 6669    def combine_fi
+000251c0: 7273 7428 7365 6c66 2c20 6f74 6865 7229  rst(self, other)
+000251d0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000251e0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+000251f0: 696f 6e73 284d 2e63 6f6d 6269 6e65 5f66  ions(M.combine_f
+00025200: 6972 7374 2c20 6f74 6865 7229 0a0a 2020  irst, other)..  
+00025210: 2020 6465 6620 746f 5f62 6167 2873 656c    def to_bag(sel
+00025220: 662c 2069 6e64 6578 3d46 616c 7365 2c20  f, index=False, 
+00025230: 666f 726d 6174 3d22 7475 706c 6522 293a  format="tuple"):
+00025240: 0a20 2020 2020 2020 2022 2222 4372 6561  .        """Crea
+00025250: 7465 2061 2044 6173 6b20 4261 6720 6672  te a Dask Bag fr
+00025260: 6f6d 2061 2053 6572 6965 7322 2222 0a20  om a Series""". 
+00025270: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00025280: 2e64 6174 6166 7261 6d65 2e69 6f20 696d  .dataframe.io im
+00025290: 706f 7274 2074 6f5f 6261 670a 0a20 2020  port to_bag..   
+000252a0: 2020 2020 2072 6574 7572 6e20 746f 5f62       return to_b
+000252b0: 6167 2873 656c 662c 2069 6e64 6578 2c20  ag(self, index, 
+000252c0: 666f 726d 6174 3d66 6f72 6d61 7429 0a0a  format=format)..
+000252d0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+000252e0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+000252f0: 2064 6566 2074 6f5f 6672 616d 6528 7365   def to_frame(se
+00025300: 6c66 2c20 6e61 6d65 3d4e 6f6e 6529 3a0a  lf, name=None):.
+00025310: 2020 2020 2020 2020 6172 6773 203d 205b          args = [
+00025320: 5d20 6966 206e 616d 6520 6973 204e 6f6e  ] if name is Non
+00025330: 6520 656c 7365 205b 6e61 6d65 5d0a 2020  e else [name].  
+00025340: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00025350: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+00025360: 284d 2e74 6f5f 6672 616d 652c 202a 6172  (M.to_frame, *ar
+00025370: 6773 2c20 6d65 7461 3d73 656c 662e 5f6d  gs, meta=self._m
+00025380: 6574 612e 746f 5f66 7261 6d65 282a 6172  eta.to_frame(*ar
+00025390: 6773 2929 0a0a 2020 2020 4064 6572 6976  gs))..    @deriv
+000253a0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
+000253b0: 7329 0a20 2020 2064 6566 2074 6f5f 7374  s).    def to_st
+000253c0: 7269 6e67 2873 656c 662c 206d 6178 5f72  ring(self, max_r
+000253d0: 6f77 733d 3529 3a0a 2020 2020 2020 2020  ows=5):.        
+000253e0: 2320 6f70 7469 6f6e 5f63 6f6e 7465 7874  # option_context
+000253f0: 2064 6f65 736e 2774 2061 6666 6563 740a   doesn't affect.
+00025400: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00025410: 656c 662e 5f72 6570 725f 6461 7461 2829  elf._repr_data()
+00025420: 2e74 6f5f 7374 7269 6e67 286d 6178 5f72  .to_string(max_r
+00025430: 6f77 733d 6d61 785f 726f 7773 290a 0a20  ows=max_rows).. 
+00025440: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
+00025450: 2020 2020 6465 6620 5f62 696e 645f 6f70      def _bind_op
+00025460: 6572 6174 6f72 5f6d 6574 686f 6428 636c  erator_method(cl
+00025470: 732c 206e 616d 652c 206f 702c 206f 7269  s, name, op, ori
+00025480: 6769 6e61 6c3d 7064 2e53 6572 6965 7329  ginal=pd.Series)
+00025490: 3a0a 2020 2020 2020 2020 2222 2262 696e  :.        """bin
+000254a0: 6420 6f70 6572 6174 6f72 206d 6574 686f  d operator metho
+000254b0: 6420 6c69 6b65 2053 6572 6965 732e 6164  d like Series.ad
+000254c0: 6420 746f 2074 6869 7320 636c 6173 7322  d to this class"
+000254d0: 2222 0a0a 2020 2020 2020 2020 6465 6620  ""..        def 
+000254e0: 6d65 7468 2873 656c 662c 206f 7468 6572  meth(self, other
+000254f0: 2c20 6c65 7665 6c3d 4e6f 6e65 2c20 6669  , level=None, fi
+00025500: 6c6c 5f76 616c 7565 3d4e 6f6e 652c 2061  ll_value=None, a
+00025510: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
+00025520: 2020 2020 6966 206c 6576 656c 2069 7320      if level is 
+00025530: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00025540: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00025550: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+00025560: 726f 7228 226c 6576 656c 206d 7573 7420  ror("level must 
+00025570: 6265 204e 6f6e 6522 290a 2020 2020 2020  be None").      
+00025580: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
+00025590: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
+000255a0: 2861 7869 7329 0a20 2020 2020 2020 2020  (axis).         
+000255b0: 2020 206d 6574 6120 3d20 5f65 6d75 6c61     meta = _emula
+000255c0: 7465 286f 702c 2073 656c 662c 206f 7468  te(op, self, oth
+000255d0: 6572 2c20 6178 6973 3d61 7869 732c 2066  er, axis=axis, f
+000255e0: 696c 6c5f 7661 6c75 653d 6669 6c6c 5f76  ill_value=fill_v
+000255f0: 616c 7565 290a 2020 2020 2020 2020 2020  alue).          
+00025600: 2020 7265 7475 726e 206d 6170 5f70 6172    return map_par
+00025610: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
+00025620: 2020 2020 2020 2020 206f 702c 2073 656c           op, sel
+00025630: 662c 206f 7468 6572 2c20 6d65 7461 3d6d  f, other, meta=m
+00025640: 6574 612c 2061 7869 733d 6178 6973 2c20  eta, axis=axis, 
+00025650: 6669 6c6c 5f76 616c 7565 3d66 696c 6c5f  fill_value=fill_
+00025660: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
+00025670: 2020 290a 0a20 2020 2020 2020 206d 6574    )..        met
+00025680: 682e 5f5f 6e61 6d65 5f5f 203d 206e 616d  h.__name__ = nam
+00025690: 650a 2020 2020 2020 2020 7365 7461 7474  e.        setatt
+000256a0: 7228 636c 732c 206e 616d 652c 2064 6572  r(cls, name, der
+000256b0: 6976 6564 5f66 726f 6d28 6f72 6967 696e  ived_from(origin
+000256c0: 616c 2928 6d65 7468 2929 0a0a 2020 2020  al)(meth))..    
+000256d0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
+000256e0: 2064 6566 205f 6269 6e64 5f63 6f6d 7061   def _bind_compa
+000256f0: 7269 736f 6e5f 6d65 7468 6f64 2863 6c73  rison_method(cls
+00025700: 2c20 6e61 6d65 2c20 636f 6d70 6172 6973  , name, comparis
+00025710: 6f6e 2c20 6f72 6967 696e 616c 3d70 642e  on, original=pd.
+00025720: 5365 7269 6573 293a 0a20 2020 2020 2020  Series):.       
+00025730: 2022 2222 6269 6e64 2063 6f6d 7061 7269   """bind compari
+00025740: 736f 6e20 6d65 7468 6f64 206c 696b 6520  son method like 
+00025750: 5365 7269 6573 2e65 7120 746f 2074 6869  Series.eq to thi
+00025760: 7320 636c 6173 7322 2222 0a0a 2020 2020  s class"""..    
+00025770: 2020 2020 6465 6620 6d65 7468 2873 656c      def meth(sel
+00025780: 662c 206f 7468 6572 2c20 6c65 7665 6c3d  f, other, level=
+00025790: 4e6f 6e65 2c20 6669 6c6c 5f76 616c 7565  None, fill_value
+000257a0: 3d4e 6f6e 652c 2061 7869 733d 3029 3a0a  =None, axis=0):.
+000257b0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+000257c0: 6576 656c 2069 7320 6e6f 7420 4e6f 6e65  evel is not None
+000257d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000257e0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+000257f0: 6d65 6e74 6564 4572 726f 7228 226c 6576  mentedError("lev
+00025800: 656c 206d 7573 7420 6265 204e 6f6e 6522  el must be None"
+00025810: 290a 2020 2020 2020 2020 2020 2020 6178  ).            ax
+00025820: 6973 203d 2073 656c 662e 5f76 616c 6964  is = self._valid
+00025830: 6174 655f 6178 6973 2861 7869 7329 0a20  ate_axis(axis). 
+00025840: 2020 2020 2020 2020 2020 2069 6620 6669             if fi
+00025850: 6c6c 5f76 616c 7565 2069 7320 4e6f 6e65  ll_value is None
+00025860: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00025870: 2020 7265 7475 726e 2065 6c65 6d77 6973    return elemwis
+00025880: 6528 636f 6d70 6172 6973 6f6e 2c20 7365  e(comparison, se
+00025890: 6c66 2c20 6f74 6865 722c 2061 7869 733d  lf, other, axis=
+000258a0: 6178 6973 290a 2020 2020 2020 2020 2020  axis).          
+000258b0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000258c0: 2020 2020 2020 2020 6f70 203d 2070 6172          op = par
+000258d0: 7469 616c 2863 6f6d 7061 7269 736f 6e2c  tial(comparison,
+000258e0: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
+000258f0: 5f76 616c 7565 290a 2020 2020 2020 2020  _value).        
+00025900: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+00025910: 6c65 6d77 6973 6528 6f70 2c20 7365 6c66  lemwise(op, self
+00025920: 2c20 6f74 6865 722c 2061 7869 733d 6178  , other, axis=ax
+00025930: 6973 290a 0a20 2020 2020 2020 206d 6574  is)..        met
+00025940: 682e 5f5f 6e61 6d65 5f5f 203d 206e 616d  h.__name__ = nam
+00025950: 650a 2020 2020 2020 2020 7365 7461 7474  e.        setatt
+00025960: 7228 636c 732c 206e 616d 652c 2064 6572  r(cls, name, der
+00025970: 6976 6564 5f66 726f 6d28 6f72 6967 696e  ived_from(origin
+00025980: 616c 2928 6d65 7468 2929 0a0a 2020 2020  al)(meth))..    
+00025990: 4069 6e73 6572 745f 6d65 7461 5f70 6172  @insert_meta_par
+000259a0: 616d 5f64 6573 6372 6970 7469 6f6e 2870  am_description(p
+000259b0: 6164 3d31 3229 0a20 2020 2064 6566 2061  ad=12).    def a
+000259c0: 7070 6c79 2873 656c 662c 2066 756e 632c  pply(self, func,
+000259d0: 2063 6f6e 7665 7274 5f64 7479 7065 3d6e   convert_dtype=n
+000259e0: 6f5f 6465 6661 756c 742c 206d 6574 613d  o_default, meta=
+000259f0: 6e6f 5f64 6566 6175 6c74 2c20 6172 6773  no_default, args
+00025a00: 3d28 292c 202a 2a6b 7764 7329 3a0a 2020  =(), **kwds):.  
+00025a10: 2020 2020 2020 2222 2250 6172 616c 6c65        """Paralle
+00025a20: 6c20 7665 7273 696f 6e20 6f66 2070 616e  l version of pan
+00025a30: 6461 732e 5365 7269 6573 2e61 7070 6c79  das.Series.apply
+00025a40: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00025a50: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00025a60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00025a70: 6675 6e63 203a 2066 756e 6374 696f 6e0a  func : function.
+00025a80: 2020 2020 2020 2020 2020 2020 4675 6e63              Func
+00025a90: 7469 6f6e 2074 6f20 6170 706c 790a 2020  tion to apply.  
+00025aa0: 2020 2020 2020 636f 6e76 6572 745f 6474        convert_dt
+00025ab0: 7970 6520 3a20 626f 6f6c 6561 6e2c 2064  ype : boolean, d
+00025ac0: 6566 6175 6c74 2054 7275 650a 2020 2020  efault True.    
+00025ad0: 2020 2020 2020 2020 5472 7920 746f 2066          Try to f
+00025ae0: 696e 6420 6265 7474 6572 2064 7479 7065  ind better dtype
+00025af0: 2066 6f72 2065 6c65 6d65 6e74 7769 7365   for elementwise
+00025b00: 2066 756e 6374 696f 6e20 7265 7375 6c74   function result
+00025b10: 732e 0a20 2020 2020 2020 2020 2020 2049  s..            I
+00025b20: 6620 4661 6c73 652c 206c 6561 7665 2061  f False, leave a
+00025b30: 7320 6474 7970 653d 6f62 6a65 6374 2e0a  s dtype=object..
+00025b40: 2020 2020 2020 2020 244d 4554 410a 2020          $META.  
+00025b50: 2020 2020 2020 6172 6773 203a 2074 7570        args : tup
+00025b60: 6c65 0a20 2020 2020 2020 2020 2020 2050  le.            P
+00025b70: 6f73 6974 696f 6e61 6c20 6172 6775 6d65  ositional argume
+00025b80: 6e74 7320 746f 2070 6173 7320 746f 2066  nts to pass to f
+00025b90: 756e 6374 696f 6e20 696e 2061 6464 6974  unction in addit
+00025ba0: 696f 6e20 746f 2074 6865 2076 616c 7565  ion to the value
+00025bb0: 2e0a 0a20 2020 2020 2020 2041 6464 6974  ...        Addit
+00025bc0: 696f 6e61 6c20 6b65 7977 6f72 6420 6172  ional keyword ar
+00025bd0: 6775 6d65 6e74 7320 7769 6c6c 2062 6520  guments will be 
+00025be0: 7061 7373 6564 2061 7320 6b65 7977 6f72  passed as keywor
+00025bf0: 6473 2074 6f20 7468 6520 6675 6e63 7469  ds to the functi
+00025c00: 6f6e 2e0a 0a20 2020 2020 2020 2052 6574  on...        Ret
+00025c10: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+00025c20: 2d2d 2d2d 0a20 2020 2020 2020 2061 7070  ----.        app
+00025c30: 6c69 6564 203a 2053 6572 6965 7320 6f72  lied : Series or
+00025c40: 2044 6174 6146 7261 6d65 2069 6620 6675   DataFrame if fu
+00025c50: 6e63 2072 6574 7572 6e73 2061 2053 6572  nc returns a Ser
+00025c60: 6965 732e 0a0a 2020 2020 2020 2020 4578  ies...        Ex
+00025c70: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
+00025c80: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00025c90: 3e3e 3e20 696d 706f 7274 2064 6173 6b2e  >>> import dask.
+00025ca0: 6461 7461 6672 616d 6520 6173 2064 640a  dataframe as dd.
+00025cb0: 2020 2020 2020 2020 3e3e 3e20 7320 3d20          >>> s = 
+00025cc0: 7064 2e53 6572 6965 7328 7261 6e67 6528  pd.Series(range(
+00025cd0: 3529 2c20 6e61 6d65 3d27 7827 290a 2020  5), name='x').  
+00025ce0: 2020 2020 2020 3e3e 3e20 6473 203d 2064        >>> ds = d
+00025cf0: 642e 6672 6f6d 5f70 616e 6461 7328 732c  d.from_pandas(s,
+00025d00: 206e 7061 7274 6974 696f 6e73 3d32 290a   npartitions=2).
+00025d10: 0a20 2020 2020 2020 2041 7070 6c79 2061  .        Apply a
+00025d20: 2066 756e 6374 696f 6e20 656c 656d 656e   function elemen
+00025d30: 7477 6973 6520 6163 726f 7373 2074 6865  twise across the
+00025d40: 2053 6572 6965 732c 2070 6173 7369 6e67   Series, passing
+00025d50: 2069 6e20 6578 7472 610a 2020 2020 2020   in extra.      
+00025d60: 2020 6172 6775 6d65 6e74 7320 696e 2060    arguments in `
+00025d70: 6061 7267 7360 6020 616e 6420 6060 6b77  `args`` and ``kw
+00025d80: 6172 6773 6060 3a0a 0a20 2020 2020 2020  args``:..       
+00025d90: 203e 3e3e 2064 6566 206d 7961 6464 2878   >>> def myadd(x
+00025da0: 2c20 612c 2062 3d31 293a 0a20 2020 2020  , a, b=1):.     
+00025db0: 2020 202e 2e2e 2020 2020 2072 6574 7572     ...     retur
+00025dc0: 6e20 7820 2b20 6120 2b20 620a 2020 2020  n x + a + b.    
+00025dd0: 2020 2020 3e3e 3e20 7265 7320 3d20 6473      >>> res = ds
+00025de0: 2e61 7070 6c79 286d 7961 6464 2c20 6172  .apply(myadd, ar
+00025df0: 6773 3d28 322c 292c 2062 3d31 2e35 2920  gs=(2,), b=1.5) 
+00025e00: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+00025e10: 500a 0a20 2020 2020 2020 2042 7920 6465  P..        By de
+00025e20: 6661 756c 742c 2064 6173 6b20 7472 6965  fault, dask trie
+00025e30: 7320 746f 2069 6e66 6572 2074 6865 206f  s to infer the o
+00025e40: 7574 7075 7420 6d65 7461 6461 7461 2062  utput metadata b
+00025e50: 7920 7275 6e6e 696e 6720 796f 7572 0a20  y running your. 
+00025e60: 2020 2020 2020 2070 726f 7669 6465 6420         provided 
+00025e70: 6675 6e63 7469 6f6e 206f 6e20 736f 6d65  function on some
+00025e80: 2066 616b 6520 6461 7461 2e20 5468 6973   fake data. This
+00025e90: 2077 6f72 6b73 2077 656c 6c20 696e 206d   works well in m
+00025ea0: 616e 7920 6361 7365 732c 2062 7574 0a20  any cases, but. 
+00025eb0: 2020 2020 2020 2063 616e 2073 6f6d 6574         can somet
+00025ec0: 696d 6573 2062 6520 6578 7065 6e73 6976  imes be expensiv
+00025ed0: 652c 206f 7220 6576 656e 2066 6169 6c2e  e, or even fail.
+00025ee0: 2054 6f20 6176 6f69 6420 7468 6973 2c20   To avoid this, 
+00025ef0: 796f 7520 6361 6e0a 2020 2020 2020 2020  you can.        
+00025f00: 6d61 6e75 616c 6c79 2073 7065 6369 6679  manually specify
+00025f10: 2074 6865 206f 7574 7075 7420 6d65 7461   the output meta
+00025f20: 6461 7461 2077 6974 6820 7468 6520 6060  data with the ``
+00025f30: 6d65 7461 6060 206b 6579 776f 7264 2e20  meta`` keyword. 
+00025f40: 5468 6973 0a20 2020 2020 2020 2063 616e  This.        can
+00025f50: 2062 6520 7370 6563 6966 6965 6420 696e   be specified in
+00025f60: 206d 616e 7920 666f 726d 732c 2066 6f72   many forms, for
+00025f70: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
+00025f80: 6e20 7365 650a 2020 2020 2020 2020 6060  n see.        ``
+00025f90: 6461 736b 2e64 6174 6166 7261 6d65 2e75  dask.dataframe.u
+00025fa0: 7469 6c73 2e6d 616b 655f 6d65 7461 6060  tils.make_meta``
+00025fb0: 2e0a 0a20 2020 2020 2020 2048 6572 6520  ...        Here 
+00025fc0: 7765 2073 7065 6369 6679 2074 6865 206f  we specify the o
+00025fd0: 7574 7075 7420 6973 2061 2053 6572 6965  utput is a Serie
+00025fe0: 7320 7769 7468 206e 616d 6520 6060 2778  s with name ``'x
+00025ff0: 2760 602c 2061 6e64 2064 7479 7065 0a20  '``, and dtype. 
+00026000: 2020 2020 2020 2060 6066 6c6f 6174 3634         ``float64
+00026010: 6060 3a0a 0a20 2020 2020 2020 203e 3e3e  ``:..        >>>
+00026020: 2072 6573 203d 2064 732e 6170 706c 7928   res = ds.apply(
+00026030: 6d79 6164 642c 2061 7267 733d 2832 2c29  myadd, args=(2,)
+00026040: 2c20 623d 312e 352c 206d 6574 613d 2827  , b=1.5, meta=('
+00026050: 7827 2c20 2766 3827 2929 0a0a 2020 2020  x', 'f8'))..    
+00026060: 2020 2020 496e 2074 6865 2063 6173 6520      In the case 
+00026070: 7768 6572 6520 7468 6520 6d65 7461 6461  where the metada
+00026080: 7461 2064 6f65 736e 2774 2063 6861 6e67  ta doesn't chang
+00026090: 652c 2079 6f75 2063 616e 2061 6c73 6f20  e, you can also 
+000260a0: 7061 7373 2069 6e0a 2020 2020 2020 2020  pass in.        
+000260b0: 7468 6520 6f62 6a65 6374 2069 7473 656c  the object itsel
+000260c0: 6620 6469 7265 6374 6c79 3a0a 0a20 2020  f directly:..   
+000260d0: 2020 2020 203e 3e3e 2072 6573 203d 2064       >>> res = d
+000260e0: 732e 6170 706c 7928 6c61 6d62 6461 2078  s.apply(lambda x
+000260f0: 3a20 7820 2b20 312c 206d 6574 613d 6473  : x + 1, meta=ds
+00026100: 290a 0a20 2020 2020 2020 2053 6565 2041  )..        See A
+00026110: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+00026120: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
+00026130: 6b2e 5365 7269 6573 2e6d 6170 5f70 6172  k.Series.map_par
+00026140: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
+00026150: 2222 220a 2020 2020 2020 2020 6966 2063  """.        if c
+00026160: 6f6e 7665 7274 5f64 7479 7065 2069 7320  onvert_dtype is 
+00026170: 6e6f 7420 6e6f 5f64 6566 6175 6c74 3a0a  not no_default:.
+00026180: 2020 2020 2020 2020 2020 2020 6b77 6473              kwds
+00026190: 5b22 636f 6e76 6572 745f 6474 7970 6522  ["convert_dtype"
+000261a0: 5d20 3d20 636f 6e76 6572 745f 6474 7970  ] = convert_dtyp
+000261b0: 650a 0a20 2020 2020 2020 2023 206c 6574  e..        # let
+000261c0: 2070 616e 6461 7320 7472 6967 6765 7220   pandas trigger 
+000261d0: 616e 7920 7761 726e 696e 6773 2c20 7375  any warnings, su
+000261e0: 6368 2061 7320 636f 6e76 6572 745f 6474  ch as convert_dt
+000261f0: 7970 6520 7761 726e 696e 670a 2020 2020  ype warning.    
+00026200: 2020 2020 7365 6c66 2e5f 6d65 7461 2e61      self._meta.a
+00026210: 7070 6c79 2866 756e 632c 2061 7267 733d  pply(func, args=
+00026220: 6172 6773 2c20 2a2a 6b77 6473 290a 0a20  args, **kwds).. 
+00026230: 2020 2020 2020 2069 6620 6d65 7461 2069         if meta i
+00026240: 7320 6e6f 5f64 6566 6175 6c74 3a0a 2020  s no_default:.  
+00026250: 2020 2020 2020 2020 2020 7769 7468 2063            with c
+00026260: 6865 636b 5f63 6f6e 7665 7274 5f64 7479  heck_convert_dty
+00026270: 7065 5f64 6570 7265 6361 7469 6f6e 2829  pe_deprecation()
+00026280: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00026290: 2020 6d65 7461 203d 205f 656d 756c 6174    meta = _emulat
+000262a0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+000262b0: 2020 2020 2020 204d 2e61 7070 6c79 2c20         M.apply, 
+000262c0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
+000262d0: 7074 792c 2066 756e 632c 2061 7267 733d  pty, func, args=
+000262e0: 6172 6773 2c20 7564 663d 5472 7565 2c20  args, udf=True, 
+000262f0: 2a2a 6b77 6473 0a20 2020 2020 2020 2020  **kwds.         
+00026300: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00026310: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00026320: 726e 286d 6574 615f 7761 726e 696e 6728  rn(meta_warning(
+00026330: 6d65 7461 2929 0a0a 2020 2020 2020 2020  meta))..        
+00026340: 7265 7475 726e 206d 6170 5f70 6172 7469  return map_parti
+00026350: 7469 6f6e 7328 6d65 7468 6f64 732e 6170  tions(methods.ap
+00026360: 706c 792c 2073 656c 662c 2066 756e 632c  ply, self, func,
+00026370: 2061 7267 733d 6172 6773 2c20 6d65 7461   args=args, meta
+00026380: 3d6d 6574 612c 202a 2a6b 7764 7329 0a0a  =meta, **kwds)..
+00026390: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+000263a0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+000263b0: 2064 6566 2063 6f76 2873 656c 662c 206f   def cov(self, o
+000263c0: 7468 6572 2c20 6d69 6e5f 7065 7269 6f64  ther, min_period
+000263d0: 733d 4e6f 6e65 2c20 7370 6c69 745f 6576  s=None, split_ev
+000263e0: 6572 793d 4661 6c73 6529 3a0a 2020 2020  ery=False):.    
+000263f0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+00026400: 7461 6672 616d 652e 6d75 6c74 6920 696d  taframe.multi im
+00026410: 706f 7274 2063 6f6e 6361 740a 0a20 2020  port concat..   
+00026420: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00026430: 7374 616e 6365 286f 7468 6572 2c20 5365  stance(other, Se
+00026440: 7269 6573 293a 0a20 2020 2020 2020 2020  ries):.         
+00026450: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00026460: 6f72 2822 6f74 6865 7220 6d75 7374 2062  or("other must b
+00026470: 6520 6120 6461 736b 2e64 6174 6166 7261  e a dask.datafra
+00026480: 6d65 2e53 6572 6965 7322 290a 2020 2020  me.Series").    
+00026490: 2020 2020 6466 203d 2063 6f6e 6361 7428      df = concat(
+000264a0: 5b73 656c 662c 206f 7468 6572 5d2c 2061  [self, other], a
+000264b0: 7869 733d 3129 0a20 2020 2020 2020 2072  xis=1).        r
+000264c0: 6574 7572 6e20 5f63 6f76 5f63 6f72 7228  eturn _cov_corr(
+000264d0: 0a20 2020 2020 2020 2020 2020 2064 662c  .            df,
+000264e0: 206d 696e 5f70 6572 696f 6473 2c20 7363   min_periods, sc
+000264f0: 616c 6172 3d54 7275 652c 206e 756d 6572  alar=True, numer
+00026500: 6963 5f6f 6e6c 793d 4661 6c73 652c 2073  ic_only=False, s
+00026510: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+00026520: 5f65 7665 7279 0a20 2020 2020 2020 2029  _every.        )
+00026530: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00026540: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00026550: 2020 2064 6566 2063 6f72 7228 7365 6c66     def corr(self
+00026560: 2c20 6f74 6865 722c 206d 6574 686f 643d  , other, method=
+00026570: 2270 6561 7273 6f6e 222c 206d 696e 5f70  "pearson", min_p
+00026580: 6572 696f 6473 3d4e 6f6e 652c 2073 706c  eriods=None, spl
+00026590: 6974 5f65 7665 7279 3d46 616c 7365 293a  it_every=False):
+000265a0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+000265b0: 736b 2e64 6174 6166 7261 6d65 2e6d 756c  sk.dataframe.mul
+000265c0: 7469 2069 6d70 6f72 7420 636f 6e63 6174  ti import concat
+000265d0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+000265e0: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
+000265f0: 722c 2053 6572 6965 7329 3a0a 2020 2020  r, Series):.    
+00026600: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00026610: 7065 4572 726f 7228 226f 7468 6572 206d  peError("other m
+00026620: 7573 7420 6265 2061 2064 6173 6b2e 6461  ust be a dask.da
+00026630: 7461 6672 616d 652e 5365 7269 6573 2229  taframe.Series")
+00026640: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
+00026650: 6f64 2021 3d20 2270 6561 7273 6f6e 223a  od != "pearson":
+00026660: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00026670: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00026680: 6445 7272 6f72 2822 4f6e 6c79 2050 6561  dError("Only Pea
+00026690: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
+000266a0: 2068 6173 2062 6565 6e20 696d 706c 656d   has been implem
+000266b0: 656e 7465 6422 290a 2020 2020 2020 2020  ented").        
+000266c0: 6466 203d 2063 6f6e 6361 7428 5b73 656c  df = concat([sel
+000266d0: 662c 206f 7468 6572 5d2c 2061 7869 733d  f, other], axis=
+000266e0: 3129 0a20 2020 2020 2020 2072 6574 7572  1).        retur
+000266f0: 6e20 5f63 6f76 5f63 6f72 7228 0a20 2020  n _cov_corr(.   
+00026700: 2020 2020 2020 2020 2064 662c 0a20 2020           df,.   
+00026710: 2020 2020 2020 2020 206d 696e 5f70 6572           min_per
+00026720: 696f 6473 2c0a 2020 2020 2020 2020 2020  iods,.          
+00026730: 2020 636f 7272 3d54 7275 652c 0a20 2020    corr=True,.   
+00026740: 2020 2020 2020 2020 2073 6361 6c61 723d           scalar=
+00026750: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+00026760: 2020 6e75 6d65 7269 635f 6f6e 6c79 3d46    numeric_only=F
+00026770: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00026780: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
+00026790: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
+000267a0: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
+000267b0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
+000267c0: 7329 0a20 2020 2064 6566 2061 7574 6f63  s).    def autoc
+000267d0: 6f72 7228 7365 6c66 2c20 6c61 673d 312c  orr(self, lag=1,
+000267e0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+000267f0: 7365 293a 0a20 2020 2020 2020 2069 6620  se):.        if 
+00026800: 6e6f 7420 6973 696e 7374 616e 6365 286c  not isinstance(l
+00026810: 6167 2c20 496e 7465 6772 616c 293a 0a20  ag, Integral):. 
+00026820: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00026830: 2054 7970 6545 7272 6f72 2822 6c61 6720   TypeError("lag 
+00026840: 6d75 7374 2062 6520 616e 2069 6e74 6567  must be an integ
+00026850: 6572 2229 0a20 2020 2020 2020 2072 6574  er").        ret
+00026860: 7572 6e20 7365 6c66 2e63 6f72 7228 7365  urn self.corr(se
+00026870: 6c66 2069 6620 6c61 6720 3d3d 2030 2065  lf if lag == 0 e
+00026880: 6c73 6520 7365 6c66 2e73 6869 6674 286c  lse self.shift(l
+00026890: 6167 292c 2073 706c 6974 5f65 7665 7279  ag), split_every
+000268a0: 3d73 706c 6974 5f65 7665 7279 290a 0a20  =split_every).. 
+000268b0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+000268c0: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
+000268d0: 6465 6620 6d65 6d6f 7279 5f75 7361 6765  def memory_usage
+000268e0: 2873 656c 662c 2069 6e64 6578 3d54 7275  (self, index=Tru
+000268f0: 652c 2064 6565 703d 4661 6c73 6529 3a0a  e, deep=False):.
+00026900: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00026910: 656c 662e 7265 6475 6374 696f 6e28 0a20  elf.reduction(. 
+00026920: 2020 2020 2020 2020 2020 204d 2e6d 656d             M.mem
+00026930: 6f72 795f 7573 6167 652c 0a20 2020 2020  ory_usage,.     
+00026940: 2020 2020 2020 204d 2e73 756d 2c0a 2020         M.sum,.  
+00026950: 2020 2020 2020 2020 2020 6368 756e 6b5f            chunk_
+00026960: 6b77 6172 6773 3d7b 2269 6e64 6578 223a  kwargs={"index":
+00026970: 2069 6e64 6578 2c20 2264 6565 7022 3a20   index, "deep": 
+00026980: 6465 6570 7d2c 0a20 2020 2020 2020 2020  deep},.         
+00026990: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
+000269a0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+000269b0: 2020 746f 6b65 6e3d 7365 6c66 2e5f 746f    token=self._to
+000269c0: 6b65 6e5f 7072 6566 6978 202b 2022 6d65  ken_prefix + "me
+000269d0: 6d6f 7279 2d75 7361 6765 222c 0a20 2020  mory-usage",.   
+000269e0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+000269f0: 5f5f 6469 766d 6f64 5f5f 2873 656c 662c  __divmod__(self,
+00026a00: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
+00026a10: 2072 6573 3120 3d20 7365 6c66 202f 2f20   res1 = self // 
+00026a20: 6f74 6865 720a 2020 2020 2020 2020 7265  other.        re
+00026a30: 7332 203d 2073 656c 6620 2520 6f74 6865  s2 = self % othe
+00026a40: 720a 2020 2020 2020 2020 7265 7475 726e  r.        return
+00026a50: 2072 6573 312c 2072 6573 320a 0a20 2020   res1, res2..   
+00026a60: 2064 6566 205f 5f72 6469 766d 6f64 5f5f   def __rdivmod__
+00026a70: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
+00026a80: 2020 2020 2020 2072 6573 3120 3d20 6f74         res1 = ot
+00026a90: 6865 7220 2f2f 2073 656c 660a 2020 2020  her // self.    
+00026aa0: 2020 2020 7265 7332 203d 206f 7468 6572      res2 = other
+00026ab0: 2025 2073 656c 660a 2020 2020 2020 2020   % self.        
+00026ac0: 7265 7475 726e 2072 6573 312c 2072 6573  return res1, res
+00026ad0: 320a 0a20 2020 2069 6620 6e6f 7420 5041  2..    if not PA
+00026ae0: 4e44 4153 5f47 545f 3230 303a 0a0a 2020  NDAS_GT_200:..  
+00026af0: 2020 2020 2020 4070 726f 7065 7274 790a        @property.
+00026b00: 2020 2020 2020 2020 4064 6572 6976 6564          @derived
+00026b10: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
+00026b20: 0a20 2020 2020 2020 2064 6566 2069 735f  .        def is_
+00026b30: 6d6f 6e6f 746f 6e69 6328 7365 6c66 293a  monotonic(self):
+00026b40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00026b50: 5041 4e44 4153 5f47 545f 3135 303a 0a20  PANDAS_GT_150:. 
+00026b60: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00026b70: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
+00026b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026b90: 2020 2269 735f 6d6f 6e6f 746f 6e69 6320    "is_monotonic 
+00026ba0: 6973 2064 6570 7265 6361 7465 6420 616e  is deprecated an
+00026bb0: 6420 7769 6c6c 2062 6520 7265 6d6f 7665  d will be remove
+00026bc0: 6420 696e 2061 2066 7574 7572 6520 7665  d in a future ve
+00026bd0: 7273 696f 6e2e 2022 0a20 2020 2020 2020  rsion. ".       
+00026be0: 2020 2020 2020 2020 2020 2020 2022 5573               "Us
+00026bf0: 6520 6973 5f6d 6f6e 6f74 6f6e 6963 5f69  e is_monotonic_i
+00026c00: 6e63 7265 6173 696e 6720 696e 7374 6561  ncreasing instea
+00026c10: 642e 222c 0a20 2020 2020 2020 2020 2020  d.",.           
+00026c20: 2020 2020 2020 2020 2046 7574 7572 6557           FutureW
+00026c30: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
+00026c40: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00026c50: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00026c60: 662e 6973 5f6d 6f6e 6f74 6f6e 6963 5f69  f.is_monotonic_i
+00026c70: 6e63 7265 6173 696e 670a 0a20 2020 2040  ncreasing..    @
+00026c80: 7072 6f70 6572 7479 0a20 2020 2040 6465  property.    @de
+00026c90: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
+00026ca0: 7269 6573 290a 2020 2020 6465 6620 6973  ries).    def is
+00026cb0: 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63 7265  _monotonic_incre
+00026cc0: 6173 696e 6728 7365 6c66 293a 0a20 2020  asing(self):.   
+00026cd0: 2020 2020 2072 6574 7572 6e20 6163 6128       return aca(
+00026ce0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00026cf0: 662c 0a20 2020 2020 2020 2020 2020 2063  f,.            c
+00026d00: 6875 6e6b 3d6d 6574 686f 6473 2e6d 6f6e  hunk=methods.mon
+00026d10: 6f74 6f6e 6963 5f69 6e63 7265 6173 696e  otonic_increasin
+00026d20: 675f 6368 756e 6b2c 0a20 2020 2020 2020  g_chunk,.       
+00026d30: 2020 2020 2063 6f6d 6269 6e65 3d6d 6574       combine=met
+00026d40: 686f 6473 2e6d 6f6e 6f74 6f6e 6963 5f69  hods.monotonic_i
+00026d50: 6e63 7265 6173 696e 675f 636f 6d62 696e  ncreasing_combin
+00026d60: 652c 0a20 2020 2020 2020 2020 2020 2061  e,.            a
+00026d70: 6767 7265 6761 7465 3d6d 6574 686f 6473  ggregate=methods
+00026d80: 2e6d 6f6e 6f74 6f6e 6963 5f69 6e63 7265  .monotonic_incre
+00026d90: 6173 696e 675f 6167 6772 6567 6174 652c  asing_aggregate,
+00026da0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+00026db0: 613d 626f 6f6c 2c0a 2020 2020 2020 2020  a=bool,.        
+00026dc0: 2020 2020 746f 6b65 6e3d 226d 6f6e 6f74      token="monot
+00026dd0: 6f6e 6963 5f69 6e63 7265 6173 696e 6722  onic_increasing"
+00026de0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00026df0: 2040 7072 6f70 6572 7479 0a20 2020 2040   @property.    @
+00026e00: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00026e10: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
+00026e20: 6973 5f6d 6f6e 6f74 6f6e 6963 5f64 6563  is_monotonic_dec
+00026e30: 7265 6173 696e 6728 7365 6c66 293a 0a20  reasing(self):. 
+00026e40: 2020 2020 2020 2072 6574 7572 6e20 6163         return ac
+00026e50: 6128 0a20 2020 2020 2020 2020 2020 2073  a(.            s
+00026e60: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+00026e70: 2063 6875 6e6b 3d6d 6574 686f 6473 2e6d   chunk=methods.m
+00026e80: 6f6e 6f74 6f6e 6963 5f64 6563 7265 6173  onotonic_decreas
+00026e90: 696e 675f 6368 756e 6b2c 0a20 2020 2020  ing_chunk,.     
+00026ea0: 2020 2020 2020 2063 6f6d 6269 6e65 3d6d         combine=m
+00026eb0: 6574 686f 6473 2e6d 6f6e 6f74 6f6e 6963  ethods.monotonic
+00026ec0: 5f64 6563 7265 6173 696e 675f 636f 6d62  _decreasing_comb
+00026ed0: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
+00026ee0: 2061 6767 7265 6761 7465 3d6d 6574 686f   aggregate=metho
+00026ef0: 6473 2e6d 6f6e 6f74 6f6e 6963 5f64 6563  ds.monotonic_dec
+00026f00: 7265 6173 696e 675f 6167 6772 6567 6174  reasing_aggregat
+00026f10: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
+00026f20: 6574 613d 626f 6f6c 2c0a 2020 2020 2020  eta=bool,.      
+00026f30: 2020 2020 2020 746f 6b65 6e3d 226d 6f6e        token="mon
+00026f40: 6f74 6f6e 6963 5f64 6563 7265 6173 696e  otonic_decreasin
+00026f50: 6722 2c0a 2020 2020 2020 2020 290a 0a20  g",.        ).. 
+00026f60: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00026f70: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
+00026f80: 6465 6620 7669 6577 2873 656c 662c 2064  def view(self, d
+00026f90: 7479 7065 293a 0a20 2020 2020 2020 206d  type):.        m
+00026fa0: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
+00026fb0: 2e76 6965 7728 6474 7970 6529 0a20 2020  .view(dtype).   
+00026fc0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00026fd0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+00026fe0: 4d2e 7669 6577 2c20 6474 7970 652c 206d  M.view, dtype, m
+00026ff0: 6574 613d 6d65 7461 290a 0a0a 636c 6173  eta=meta)...clas
+00027000: 7320 496e 6465 7828 5365 7269 6573 293a  s Index(Series):
+00027010: 0a20 2020 205f 7061 7274 6974 696f 6e5f  .    _partition_
+00027020: 7479 7065 203d 2070 642e 496e 6465 780a  type = pd.Index.
+00027030: 2020 2020 5f69 735f 7061 7274 6974 696f      _is_partitio
+00027040: 6e5f 7479 7065 203d 2073 7461 7469 636d  n_type = staticm
+00027050: 6574 686f 6428 6973 5f69 6e64 6578 5f6c  ethod(is_index_l
+00027060: 696b 6529 0a20 2020 205f 746f 6b65 6e5f  ike).    _token_
+00027070: 7072 6566 6978 203d 2022 696e 6465 782d  prefix = "index-
+00027080: 220a 2020 2020 5f61 6363 6573 736f 7273  ".    _accessors
+00027090: 3a20 436c 6173 7356 6172 5b73 6574 5b73  : ClassVar[set[s
+000270a0: 7472 5d5d 203d 2073 6574 2829 0a0a 2020  tr]] = set()..  
+000270b0: 2020 5f64 745f 6174 7472 6962 7574 6573    _dt_attributes
+000270c0: 203d 207b 0a20 2020 2020 2020 2022 6e61   = {.        "na
+000270d0: 6e6f 7365 636f 6e64 222c 0a20 2020 2020  nosecond",.     
+000270e0: 2020 2022 6d69 6372 6f73 6563 6f6e 6422     "microsecond"
+000270f0: 2c0a 2020 2020 2020 2020 226d 696c 6c69  ,.        "milli
+00027100: 7365 636f 6e64 222c 0a20 2020 2020 2020  second",.       
+00027110: 2022 6461 796f 6679 6561 7222 2c0a 2020   "dayofyear",.  
+00027120: 2020 2020 2020 226d 696e 7574 6522 2c0a        "minute",.
+00027130: 2020 2020 2020 2020 2268 6f75 7222 2c0a          "hour",.
+00027140: 2020 2020 2020 2020 2264 6179 222c 0a20          "day",. 
+00027150: 2020 2020 2020 2022 6461 796f 6677 6565         "dayofwee
+00027160: 6b22 2c0a 2020 2020 2020 2020 2273 6563  k",.        "sec
+00027170: 6f6e 6422 2c0a 2020 2020 2020 2020 2277  ond",.        "w
+00027180: 6565 6b22 2c0a 2020 2020 2020 2020 2277  eek",.        "w
+00027190: 6565 6b64 6179 222c 0a20 2020 2020 2020  eekday",.       
+000271a0: 2022 7765 656b 6f66 7965 6172 222c 0a20   "weekofyear",. 
+000271b0: 2020 2020 2020 2022 6d6f 6e74 6822 2c0a         "month",.
+000271c0: 2020 2020 2020 2020 2271 7561 7274 6572          "quarter
+000271d0: 222c 0a20 2020 2020 2020 2022 7965 6172  ",.        "year
+000271e0: 222c 0a20 2020 207d 0a0a 2020 2020 5f63  ",.    }..    _c
+000271f0: 6174 5f61 7474 7269 6275 7465 7320 3d20  at_attributes = 
+00027200: 7b0a 2020 2020 2020 2020 226b 6e6f 776e  {.        "known
+00027210: 222c 0a20 2020 2020 2020 2022 6173 5f6b  ",.        "as_k
+00027220: 6e6f 776e 222c 0a20 2020 2020 2020 2022  nown",.        "
+00027230: 6173 5f75 6e6b 6e6f 776e 222c 0a20 2020  as_unknown",.   
+00027240: 2020 2020 2022 6164 645f 6361 7465 676f       "add_catego
+00027250: 7269 6573 222c 0a20 2020 2020 2020 2022  ries",.        "
+00027260: 6361 7465 676f 7269 6573 222c 0a20 2020  categories",.   
+00027270: 2020 2020 2022 7265 6d6f 7665 5f63 6174       "remove_cat
+00027280: 6567 6f72 6965 7322 2c0a 2020 2020 2020  egories",.      
+00027290: 2020 2272 656f 7264 6572 5f63 6174 6567    "reorder_categ
+000272a0: 6f72 6965 7322 2c0a 2020 2020 2020 2020  ories",.        
+000272b0: 2261 735f 6f72 6465 7265 6422 2c0a 2020  "as_ordered",.  
+000272c0: 2020 2020 2020 2263 6f64 6573 222c 0a20        "codes",. 
+000272d0: 2020 2020 2020 2022 7265 6d6f 7665 5f75         "remove_u
+000272e0: 6e75 7365 645f 6361 7465 676f 7269 6573  nused_categories
+000272f0: 222c 0a20 2020 2020 2020 2022 7365 745f  ",.        "set_
+00027300: 6361 7465 676f 7269 6573 222c 0a20 2020  categories",.   
+00027310: 2020 2020 2022 6173 5f75 6e6f 7264 6572       "as_unorder
+00027320: 6564 222c 0a20 2020 2020 2020 2022 6f72  ed",.        "or
+00027330: 6465 7265 6422 2c0a 2020 2020 2020 2020  dered",.        
+00027340: 2272 656e 616d 655f 6361 7465 676f 7269  "rename_categori
+00027350: 6573 222c 0a20 2020 207d 0a0a 2020 2020  es",.    }..    
+00027360: 5f6d 6f6e 6f74 6f6e 6963 5f61 7474 7269  _monotonic_attri
+00027370: 6275 7465 7320 3d20 7b0a 2020 2020 2020  butes = {.      
+00027380: 2020 2269 735f 6d6f 6e6f 746f 6e69 6322    "is_monotonic"
+00027390: 2c0a 2020 2020 2020 2020 2269 735f 6d6f  ,.        "is_mo
+000273a0: 6e6f 746f 6e69 635f 696e 6372 6561 7369  notonic_increasi
+000273b0: 6e67 222c 0a20 2020 2020 2020 2022 6973  ng",.        "is
+000273c0: 5f6d 6f6e 6f74 6f6e 6963 5f64 6563 7265  _monotonic_decre
+000273d0: 6173 696e 6722 2c0a 2020 2020 7d0a 0a20  asing",.    }.. 
+000273e0: 2020 2064 6566 205f 5f67 6574 6174 7472     def __getattr
+000273f0: 5f5f 2873 656c 662c 206b 6579 293a 0a20  __(self, key):. 
+00027400: 2020 2020 2020 2069 6620 280a 2020 2020         if (.    
+00027410: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
+00027420: 6365 2873 656c 662e 5f6d 6574 612e 6474  ce(self._meta.dt
+00027430: 7970 652c 2070 642e 4361 7465 676f 7269  ype, pd.Categori
+00027440: 6361 6c44 7479 7065 290a 2020 2020 2020  calDtype).      
+00027450: 2020 2020 2020 616e 6420 6b65 7920 696e        and key in
+00027460: 2073 656c 662e 5f63 6174 5f61 7474 7269   self._cat_attri
+00027470: 6275 7465 730a 2020 2020 2020 2020 293a  butes.        ):
+00027480: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00027490: 7572 6e20 6765 7461 7474 7228 7365 6c66  urn getattr(self
+000274a0: 2e63 6174 2c20 6b65 7929 0a20 2020 2020  .cat, key).     
+000274b0: 2020 2065 6c69 6620 6b65 7920 696e 2073     elif key in s
+000274c0: 656c 662e 5f64 745f 6174 7472 6962 7574  elf._dt_attribut
+000274d0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+000274e0: 7265 7475 726e 2067 6574 6174 7472 2873  return getattr(s
+000274f0: 656c 662e 6474 2c20 6b65 7929 0a20 2020  elf.dt, key).   
+00027500: 2020 2020 2065 6c69 6620 6b65 7920 696e       elif key in
+00027510: 2073 656c 662e 5f6d 6f6e 6f74 6f6e 6963   self._monotonic
+00027520: 5f61 7474 7269 6275 7465 733a 0a20 2020  _attributes:.   
+00027530: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00027540: 6765 7461 7474 7228 7365 6c66 2c20 6b65  getattr(self, ke
+00027550: 7929 0a20 2020 2020 2020 2072 6169 7365  y).        raise
+00027560: 2041 7474 7269 6275 7465 4572 726f 7228   AttributeError(
+00027570: 2227 496e 6465 7827 206f 626a 6563 7420  "'Index' object 
+00027580: 6861 7320 6e6f 2061 7474 7269 6275 7465  has no attribute
+00027590: 2025 7222 2025 206b 6579 290a 0a20 2020   %r" % key)..   
+000275a0: 2064 6566 205f 5f64 6972 5f5f 2873 656c   def __dir__(sel
+000275b0: 6629 3a0a 2020 2020 2020 2020 6f75 7420  f):.        out 
+000275c0: 3d20 7375 7065 7228 292e 5f5f 6469 725f  = super().__dir_
+000275d0: 5f28 290a 2020 2020 2020 2020 6f75 742e  _().        out.
+000275e0: 6578 7465 6e64 2873 656c 662e 5f64 745f  extend(self._dt_
+000275f0: 6174 7472 6962 7574 6573 290a 2020 2020  attributes).    
+00027600: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00027610: 6528 7365 6c66 2e64 7479 7065 2c20 7064  e(self.dtype, pd
+00027620: 2e43 6174 6567 6f72 6963 616c 4474 7970  .CategoricalDtyp
+00027630: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00027640: 6f75 742e 6578 7465 6e64 2873 656c 662e  out.extend(self.
+00027650: 5f63 6174 5f61 7474 7269 6275 7465 7329  _cat_attributes)
+00027660: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00027670: 6f75 740a 0a20 2020 2023 2054 7970 696e  out..    # Typin
+00027680: 673a 2068 7474 7073 3a2f 2f67 6974 6875  g: https://githu
+00027690: 622e 636f 6d2f 7079 7468 6f6e 2f6d 7970  b.com/python/myp
+000276a0: 792f 6973 7375 6573 2f34 3132 350a 2020  y/issues/4125.  
+000276b0: 2020 4070 726f 7065 7274 7920 2023 2074    @property  # t
+000276c0: 7970 653a 2069 676e 6f72 650a 2020 2020  ype: ignore.    
+000276d0: 6465 6620 696e 6465 7828 7365 6c66 293a  def index(self):
+000276e0: 0a20 2020 2020 2020 2072 6169 7365 2041  .        raise A
+000276f0: 7474 7269 6275 7465 4572 726f 7228 0a20  ttributeError(. 
+00027700: 2020 2020 2020 2020 2020 2066 227b 7365             f"{se
+00027710: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
+00027720: 616d 655f 5f21 727d 206f 626a 6563 7420  ame__!r} object 
+00027730: 6861 7320 6e6f 2061 7474 7269 6275 7465  has no attribute
+00027740: 2027 696e 6465 7827 220a 2020 2020 2020   'index'".      
+00027750: 2020 290a 0a20 2020 2064 6566 205f 5f61    )..    def __a
+00027760: 7272 6179 5f77 7261 705f 5f28 7365 6c66  rray_wrap__(self
+00027770: 2c20 6172 7261 792c 2063 6f6e 7465 7874  , array, context
+00027780: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00027790: 7265 7475 726e 2070 642e 496e 6465 7828  return pd.Index(
+000277a0: 6172 7261 792c 206e 616d 653d 7365 6c66  array, name=self
+000277b0: 2e6e 616d 6529 0a0a 2020 2020 6465 6620  .name)..    def 
+000277c0: 6865 6164 2873 656c 662c 206e 3d35 2c20  head(self, n=5, 
+000277d0: 636f 6d70 7574 653d 5472 7565 293a 0a20  compute=True):. 
+000277e0: 2020 2020 2020 2022 2222 4669 7273 7420         """First 
+000277f0: 6e20 6974 656d 7320 6f66 2074 6865 2049  n items of the I
+00027800: 6e64 6578 2e0a 0a20 2020 2020 2020 2043  ndex...        C
+00027810: 6176 6561 742c 2074 6869 7320 6f6e 6c79  aveat, this only
+00027820: 2063 6865 636b 7320 7468 6520 6669 7273   checks the firs
+00027830: 7420 7061 7274 6974 696f 6e2e 0a20 2020  t partition..   
+00027840: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00027850: 206e 616d 6520 3d20 2268 6561 642d 2564   name = "head-%d
+00027860: 2d25 7322 2025 2028 6e2c 2073 656c 662e  -%s" % (n, self.
+00027870: 5f6e 616d 6529 0a20 2020 2020 2020 2064  _name).        d
+00027880: 736b 203d 207b 286e 616d 652c 2030 293a  sk = {(name, 0):
+00027890: 2028 6f70 6572 6174 6f72 2e67 6574 6974   (operator.getit
+000278a0: 656d 2c20 2873 656c 662e 5f6e 616d 652c  em, (self._name,
+000278b0: 2030 292c 2073 6c69 6365 2830 2c20 6e29   0), slice(0, n)
+000278c0: 297d 0a20 2020 2020 2020 2067 7261 7068  )}.        graph
+000278d0: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+000278e0: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+000278f0: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
+00027900: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
+00027910: 5d29 0a0a 2020 2020 2020 2020 7265 7375  ])..        resu
+00027920: 6c74 203d 206e 6577 5f64 645f 6f62 6a65  lt = new_dd_obje
+00027930: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
+00027940: 7365 6c66 2e5f 6d65 7461 2c20 7365 6c66  self._meta, self
+00027950: 2e64 6976 6973 696f 6e73 5b3a 325d 290a  .divisions[:2]).
+00027960: 0a20 2020 2020 2020 2069 6620 636f 6d70  .        if comp
+00027970: 7574 653a 0a20 2020 2020 2020 2020 2020  ute:.           
+00027980: 2072 6573 756c 7420 3d20 7265 7375 6c74   result = result
+00027990: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+000279a0: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+000279b0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+000279c0: 726f 6d28 7064 2e49 6e64 6578 290a 2020  rom(pd.Index).  
+000279d0: 2020 6465 6620 6d61 7828 7365 6c66 2c20    def max(self, 
+000279e0: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+000279f0: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
+00027a00: 726e 2073 656c 662e 7265 6475 6374 696f  rn self.reductio
+00027a10: 6e28 0a20 2020 2020 2020 2020 2020 204d  n(.            M
+00027a20: 2e6d 6178 2c0a 2020 2020 2020 2020 2020  .max,.          
+00027a30: 2020 6d65 7461 3d73 656c 662e 5f6d 6574    meta=self._met
+00027a40: 615f 6e6f 6e65 6d70 7479 2e6d 6178 2829  a_nonempty.max()
+00027a50: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
+00027a60: 6b65 6e3d 7365 6c66 2e5f 746f 6b65 6e5f  ken=self._token_
+00027a70: 7072 6566 6978 202b 2022 6d61 7822 2c0a  prefix + "max",.
+00027a80: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+00027a90: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00027aa0: 6572 792c 0a20 2020 2020 2020 2029 0a0a  ery,.        )..
+00027ab0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00027ac0: 6d28 7064 2e49 6e64 6578 290a 2020 2020  m(pd.Index).    
+00027ad0: 6465 6620 6d69 6e28 7365 6c66 2c20 7370  def min(self, sp
+00027ae0: 6c69 745f 6576 6572 793d 4661 6c73 6529  lit_every=False)
+00027af0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00027b00: 2073 656c 662e 7265 6475 6374 696f 6e28   self.reduction(
+00027b10: 0a20 2020 2020 2020 2020 2020 204d 2e6d  .            M.m
+00027b20: 696e 2c0a 2020 2020 2020 2020 2020 2020  in,.            
+00027b30: 6d65 7461 3d73 656c 662e 5f6d 6574 615f  meta=self._meta_
+00027b40: 6e6f 6e65 6d70 7479 2e6d 696e 2829 2c0a  nonempty.min(),.
+00027b50: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
+00027b60: 6e3d 7365 6c66 2e5f 746f 6b65 6e5f 7072  n=self._token_pr
+00027b70: 6566 6978 202b 2022 6d69 6e22 2c0a 2020  efix + "min",.  
+00027b80: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
+00027b90: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00027ba0: 792c 0a20 2020 2020 2020 2029 0a0a 2020  y,.        )..  
+00027bb0: 2020 6465 6620 636f 756e 7428 7365 6c66    def count(self
+00027bc0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+00027bd0: 6c73 6529 3a0a 2020 2020 2020 2020 7265  lse):.        re
+00027be0: 7475 726e 2073 656c 662e 7265 6475 6374  turn self.reduct
+00027bf0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+00027c00: 206d 6574 686f 6473 2e69 6e64 6578 5f63   methods.index_c
+00027c10: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
+00027c20: 2020 6e70 2e73 756d 2c0a 2020 2020 2020    np.sum,.      
+00027c30: 2020 2020 2020 746f 6b65 6e3d 2269 6e64        token="ind
+00027c40: 6578 2d63 6f75 6e74 222c 0a20 2020 2020  ex-count",.     
+00027c50: 2020 2020 2020 206d 6574 613d 696e 742c         meta=int,
+00027c60: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+00027c70: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+00027c80: 7665 7279 2c0a 2020 2020 2020 2020 290a  very,.        ).
+00027c90: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00027ca0: 6f6d 2870 642e 496e 6465 7829 0a20 2020  om(pd.Index).   
+00027cb0: 2064 6566 2073 6869 6674 2873 656c 662c   def shift(self,
+00027cc0: 2070 6572 696f 6473 3d31 2c20 6672 6571   periods=1, freq
+00027cd0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00027ce0: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
+00027cf0: 6c66 2e5f 6d65 7461 2c20 7064 2e50 6572  lf._meta, pd.Per
+00027d00: 696f 6449 6e64 6578 293a 0a20 2020 2020  iodIndex):.     
+00027d10: 2020 2020 2020 2069 6620 6672 6571 2069         if freq i
+00027d20: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00027d30: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00027d40: 6520 5661 6c75 6545 7272 6f72 2822 5065  e ValueError("Pe
+00027d50: 7269 6f64 496e 6465 7820 646f 6573 6e27  riodIndex doesn'
+00027d60: 7420 6163 6365 7074 2060 6672 6571 6020  t accept `freq` 
+00027d70: 6172 6775 6d65 6e74 2229 0a20 2020 2020  argument").     
+00027d80: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
+00027d90: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
+00027da0: 792e 7368 6966 7428 7065 7269 6f64 7329  y.shift(periods)
+00027db0: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
+00027dc0: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
+00027dd0: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+00027de0: 2020 2020 2020 2020 4d2e 7368 6966 742c          M.shift,
+00027df0: 2070 6572 696f 6473 2c20 6d65 7461 3d6d   periods, meta=m
+00027e00: 6574 612c 2074 6f6b 656e 3d22 7368 6966  eta, token="shif
+00027e10: 7422 2c20 7472 616e 7366 6f72 6d5f 6469  t", transform_di
+00027e20: 7669 7369 6f6e 733d 4661 6c73 650a 2020  visions=False.  
+00027e30: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00027e40: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00027e50: 2020 2020 2020 2320 5061 6e64 6173 2077        # Pandas w
+00027e60: 696c 6c20 7261 6973 6520 666f 7220 6f74  ill raise for ot
+00027e70: 6865 7220 696e 6465 7820 7479 7065 7320  her index types 
+00027e80: 7468 6174 2064 6f6e 2774 2069 6d70 6c65  that don't imple
+00027e90: 6d65 6e74 2073 6869 6674 0a20 2020 2020  ment shift.     
+00027ea0: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
+00027eb0: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
+00027ec0: 792e 7368 6966 7428 7065 7269 6f64 732c  y.shift(periods,
+00027ed0: 2066 7265 713d 6672 6571 290a 2020 2020   freq=freq).    
+00027ee0: 2020 2020 2020 2020 6f75 7420 3d20 7365          out = se
+00027ef0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00027f00: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00027f10: 2020 204d 2e73 6869 6674 2c0a 2020 2020     M.shift,.    
+00027f20: 2020 2020 2020 2020 2020 2020 7065 7269              peri
+00027f30: 6f64 732c 0a20 2020 2020 2020 2020 2020  ods,.           
+00027f40: 2020 2020 2074 6f6b 656e 3d22 7368 6966       token="shif
+00027f50: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+00027f60: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
+00027f70: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00027f80: 7265 713d 6672 6571 2c0a 2020 2020 2020  req=freq,.      
+00027f90: 2020 2020 2020 2020 2020 7472 616e 7366            transf
+00027fa0: 6f72 6d5f 6469 7669 7369 6f6e 733d 4661  orm_divisions=Fa
+00027fb0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00027fc0: 2029 0a20 2020 2020 2020 2069 6620 6672   ).        if fr
+00027fd0: 6571 2069 7320 4e6f 6e65 3a0a 2020 2020  eq is None:.    
+00027fe0: 2020 2020 2020 2020 6672 6571 203d 206d          freq = m
+00027ff0: 6574 612e 6672 6571 0a20 2020 2020 2020  eta.freq.       
+00028000: 2072 6574 7572 6e20 6d61 7962 655f 7368   return maybe_sh
+00028010: 6966 745f 6469 7669 7369 6f6e 7328 6f75  ift_divisions(ou
+00028020: 742c 2070 6572 696f 6473 2c20 6672 6571  t, periods, freq
+00028030: 3d66 7265 7129 0a0a 2020 2020 4064 6572  =freq)..    @der
+00028040: 6976 6564 5f66 726f 6d28 7064 2e49 6e64  ived_from(pd.Ind
+00028050: 6578 290a 2020 2020 6465 6620 746f 5f73  ex).    def to_s
+00028060: 6572 6965 7328 7365 6c66 293a 0a20 2020  eries(self):.   
+00028070: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00028080: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+00028090: 0a20 2020 2020 2020 2020 2020 204d 2e74  .            M.t
+000280a0: 6f5f 7365 7269 6573 2c0a 2020 2020 2020  o_series,.      
+000280b0: 2020 2020 2020 6d65 7461 3d73 656c 662e        meta=self.
+000280c0: 5f6d 6574 612e 746f 5f73 6572 6965 7328  _meta.to_series(
+000280d0: 292c 0a20 2020 2020 2020 2020 2020 2074  ),.            t
+000280e0: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
+000280f0: 6e73 3d46 616c 7365 2c0a 2020 2020 2020  ns=False,.      
+00028100: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
+00028110: 645f 6672 6f6d 2870 642e 496e 6465 782c  d_from(pd.Index,
+00028120: 2075 615f 6172 6773 3d5b 2269 6e64 6578   ua_args=["index
+00028130: 225d 290a 2020 2020 6465 6620 746f 5f66  "]).    def to_f
+00028140: 7261 6d65 2873 656c 662c 2069 6e64 6578  rame(self, index
+00028150: 3d54 7275 652c 206e 616d 653d 4e6f 6e65  =True, name=None
+00028160: 293a 0a20 2020 2020 2020 2069 6620 6e6f  ):.        if no
+00028170: 7420 696e 6465 783a 0a20 2020 2020 2020  t index:.       
+00028180: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00028190: 706c 656d 656e 7465 6445 7272 6f72 2829  plementedError()
+000281a0: 0a20 2020 2020 2020 2061 7267 7320 3d20  .        args = 
+000281b0: 5b69 6e64 6578 5d20 6966 206e 616d 6520  [index] if name 
+000281c0: 6973 204e 6f6e 6520 656c 7365 205b 696e  is None else [in
+000281d0: 6465 782c 206e 616d 655d 0a0a 2020 2020  dex, name]..    
+000281e0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000281f0: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+00028200: 2020 2020 2020 2020 2020 2020 4d2e 746f              M.to
+00028210: 5f66 7261 6d65 2c0a 2020 2020 2020 2020  _frame,.        
+00028220: 2020 2020 2a61 7267 732c 0a20 2020 2020      *args,.     
+00028230: 2020 2020 2020 206d 6574 613d 7365 6c66         meta=self
+00028240: 2e5f 6d65 7461 2e74 6f5f 6672 616d 6528  ._meta.to_frame(
+00028250: 2a61 7267 7329 2c0a 2020 2020 2020 2020  *args),.        
+00028260: 2020 2020 7472 616e 7366 6f72 6d5f 6469      transform_di
+00028270: 7669 7369 6f6e 733d 4661 6c73 652c 0a20  visions=False,. 
+00028280: 2020 2020 2020 2029 0a0a 2020 2020 4069         )..    @i
+00028290: 6e73 6572 745f 6d65 7461 5f70 6172 616d  nsert_meta_param
+000282a0: 5f64 6573 6372 6970 7469 6f6e 2870 6164  _description(pad
+000282b0: 3d31 3229 0a20 2020 2040 6465 7269 7665  =12).    @derive
+000282c0: 645f 6672 6f6d 2870 642e 496e 6465 7829  d_from(pd.Index)
+000282d0: 0a20 2020 2064 6566 206d 6170 2873 656c  .    def map(sel
+000282e0: 662c 2061 7267 2c20 6e61 5f61 6374 696f  f, arg, na_actio
+000282f0: 6e3d 4e6f 6e65 2c20 6d65 7461 3d6e 6f5f  n=None, meta=no_
+00028300: 6465 6661 756c 742c 2069 735f 6d6f 6e6f  default, is_mono
+00028310: 746f 6e69 633d 4661 6c73 6529 3a0a 2020  tonic=False):.  
+00028320: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00028330: 2020 4e6f 7465 2074 6861 7420 7468 6973    Note that this
+00028340: 206d 6574 686f 6420 636c 6561 7273 2061   method clears a
+00028350: 6e79 206b 6e6f 776e 2064 6976 6973 696f  ny known divisio
+00028360: 6e73 2e0a 0a20 2020 2020 2020 2049 6620  ns...        If 
+00028370: 796f 7572 206d 6170 7069 6e67 2066 756e  your mapping fun
+00028380: 6374 696f 6e20 6973 206d 6f6e 6f74 6f6e  ction is monoton
+00028390: 6963 616c 6c79 2069 6e63 7265 6173 696e  ically increasin
+000283a0: 6720 7468 656e 2075 7365 2060 6973 5f6d  g then use `is_m
+000283b0: 6f6e 6f74 6f6e 6963 600a 2020 2020 2020  onotonic`.      
+000283c0: 2020 746f 2061 7070 6c79 2074 6865 206d    to apply the m
+000283d0: 6170 696e 6720 6675 6e63 7469 6f6e 2074  aping function t
+000283e0: 6f20 7468 6520 6f6c 6420 6469 7669 7369  o the old divisi
+000283f0: 6f6e 7320 616e 6420 6173 7369 676e 2074  ons and assign t
+00028400: 6865 206e 6577 0a20 2020 2020 2020 2064  he new.        d
+00028410: 6976 6973 696f 6e73 2074 6f20 7468 6520  ivisions to the 
+00028420: 6f75 7470 7574 2e0a 0a20 2020 2020 2020  output...       
+00028430: 2022 2222 0a20 2020 2020 2020 2061 7070   """.        app
+00028440: 6c69 6564 203d 2073 7570 6572 2829 2e6d  lied = super().m
+00028450: 6170 2861 7267 2c20 6e61 5f61 6374 696f  ap(arg, na_actio
+00028460: 6e3d 6e61 5f61 6374 696f 6e2c 206d 6574  n=na_action, met
+00028470: 613d 6d65 7461 290a 2020 2020 2020 2020  a=meta).        
+00028480: 6966 2069 735f 6d6f 6e6f 746f 6e69 6320  if is_monotonic 
+00028490: 616e 6420 7365 6c66 2e6b 6e6f 776e 5f64  and self.known_d
+000284a0: 6976 6973 696f 6e73 3a0a 2020 2020 2020  ivisions:.      
+000284b0: 2020 2020 2020 6170 706c 6965 642e 6469        applied.di
+000284c0: 7669 7369 6f6e 7320 3d20 7475 706c 6528  visions = tuple(
+000284d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000284e0: 2070 642e 5365 7269 6573 2873 656c 662e   pd.Series(self.
+000284f0: 6469 7669 7369 6f6e 7329 2e6d 6170 2861  divisions).map(a
+00028500: 7267 2c20 6e61 5f61 6374 696f 6e3d 6e61  rg, na_action=na
+00028510: 5f61 6374 696f 6e29 0a20 2020 2020 2020  _action).       
+00028520: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00028530: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00028540: 2061 7070 6c69 6564 203d 2061 7070 6c69   applied = appli
+00028550: 6564 2e63 6c65 6172 5f64 6976 6973 696f  ed.clear_divisio
+00028560: 6e73 2829 0a20 2020 2020 2020 2072 6574  ns().        ret
+00028570: 7572 6e20 6170 706c 6965 640a 0a20 2020  urn applied..   
+00028580: 2069 6620 6e6f 7420 5041 4e44 4153 5f47   if not PANDAS_G
+00028590: 545f 3230 303a 0a0a 2020 2020 2020 2020  T_200:..        
+000285a0: 4070 726f 7065 7274 790a 2020 2020 2020  @property.      
+000285b0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+000285c0: 7064 2e49 6e64 6578 290a 2020 2020 2020  pd.Index).      
+000285d0: 2020 6465 6620 6973 5f6d 6f6e 6f74 6f6e    def is_monoton
+000285e0: 6963 2873 656c 6629 3a0a 2020 2020 2020  ic(self):.      
+000285f0: 2020 2020 2020 6966 2050 414e 4441 535f        if PANDAS_
+00028600: 4754 5f31 3530 3a0a 2020 2020 2020 2020  GT_150:.        
+00028610: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00028620: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
+00028630: 2020 2020 2020 2020 2020 2022 6973 5f6d             "is_m
+00028640: 6f6e 6f74 6f6e 6963 2069 7320 6465 7072  onotonic is depr
+00028650: 6563 6174 6564 2061 6e64 2077 696c 6c20  ecated and will 
+00028660: 6265 2072 656d 6f76 6564 2069 6e20 6120  be removed in a 
+00028670: 6675 7475 7265 2076 6572 7369 6f6e 2e20  future version. 
+00028680: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00028690: 2020 2020 2020 2255 7365 2069 735f 6d6f        "Use is_mo
+000286a0: 6e6f 746f 6e69 635f 696e 6372 6561 7369  notonic_increasi
+000286b0: 6e67 2069 6e73 7465 6164 2e22 2c0a 2020  ng instead.",.  
+000286c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000286d0: 2020 4675 7475 7265 5761 726e 696e 672c    FutureWarning,
+000286e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000286f0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+00028700: 6574 7572 6e20 7375 7065 7228 292e 6973  eturn super().is
+00028710: 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63 7265  _monotonic_incre
+00028720: 6173 696e 670a 0a20 2020 2040 7072 6f70  asing..    @prop
+00028730: 6572 7479 0a20 2020 2040 6465 7269 7665  erty.    @derive
+00028740: 645f 6672 6f6d 2870 642e 496e 6465 7829  d_from(pd.Index)
+00028750: 0a20 2020 2064 6566 2069 735f 6d6f 6e6f  .    def is_mono
+00028760: 746f 6e69 635f 696e 6372 6561 7369 6e67  tonic_increasing
+00028770: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00028780: 7265 7475 726e 2073 7570 6572 2829 2e69  return super().i
+00028790: 735f 6d6f 6e6f 746f 6e69 635f 696e 6372  s_monotonic_incr
+000287a0: 6561 7369 6e67 0a0a 2020 2020 4070 726f  easing..    @pro
+000287b0: 7065 7274 790a 2020 2020 4064 6572 6976  perty.    @deriv
+000287c0: 6564 5f66 726f 6d28 7064 2e49 6e64 6578  ed_from(pd.Index
+000287d0: 290a 2020 2020 6465 6620 6973 5f6d 6f6e  ).    def is_mon
+000287e0: 6f74 6f6e 6963 5f64 6563 7265 6173 696e  otonic_decreasin
+000287f0: 6728 7365 6c66 293a 0a20 2020 2020 2020  g(self):.       
+00028800: 2072 6574 7572 6e20 7375 7065 7228 292e   return super().
+00028810: 6973 5f6d 6f6e 6f74 6f6e 6963 5f64 6563  is_monotonic_dec
+00028820: 7265 6173 696e 670a 0a20 2020 2040 6465  reasing..    @de
+00028830: 7269 7665 645f 6672 6f6d 2870 642e 496e  rived_from(pd.In
+00028840: 6465 7829 0a20 2020 2064 6566 206d 656d  dex).    def mem
+00028850: 6f72 795f 7573 6167 6528 7365 6c66 2c20  ory_usage(self, 
+00028860: 6465 6570 3d46 616c 7365 293a 0a20 2020  deep=False):.   
+00028870: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00028880: 2e72 6564 7563 7469 6f6e 280a 2020 2020  .reduction(.    
+00028890: 2020 2020 2020 2020 4d2e 6d65 6d6f 7279          M.memory
+000288a0: 5f75 7361 6765 2c0a 2020 2020 2020 2020  _usage,.        
+000288b0: 2020 2020 4d2e 7375 6d2c 0a20 2020 2020      M.sum,.     
+000288c0: 2020 2020 2020 2063 6875 6e6b 5f6b 7761         chunk_kwa
+000288d0: 7267 733d 7b22 6465 6570 223a 2064 6565  rgs={"deep": dee
+000288e0: 707d 2c0a 2020 2020 2020 2020 2020 2020  p},.            
+000288f0: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+00028900: 652c 0a20 2020 2020 2020 2020 2020 2074  e,.            t
+00028910: 6f6b 656e 3d73 656c 662e 5f74 6f6b 656e  oken=self._token
+00028920: 5f70 7265 6669 7820 2b20 226d 656d 6f72  _prefix + "memor
+00028930: 792d 7573 6167 6522 2c0a 2020 2020 2020  y-usage",.      
+00028940: 2020 290a 0a0a 636c 6173 7320 4461 7461    )...class Data
+00028950: 4672 616d 6528 5f46 7261 6d65 293a 0a20  Frame(_Frame):. 
+00028960: 2020 2022 2222 0a20 2020 2050 6172 616c     """.    Paral
+00028970: 6c65 6c20 5061 6e64 6173 2044 6174 6146  lel Pandas DataF
+00028980: 7261 6d65 0a0a 2020 2020 446f 206e 6f74  rame..    Do not
+00028990: 2075 7365 2074 6869 7320 636c 6173 7320   use this class 
+000289a0: 6469 7265 6374 6c79 2e20 2049 6e73 7465  directly.  Inste
+000289b0: 6164 2075 7365 2066 756e 6374 696f 6e73  ad use functions
+000289c0: 206c 696b 650a 2020 2020 6060 6464 2e72   like.    ``dd.r
+000289d0: 6561 645f 6373 7660 602c 2060 6064 642e  ead_csv``, ``dd.
+000289e0: 7265 6164 5f70 6172 7175 6574 6060 2c20  read_parquet``, 
+000289f0: 6f72 2060 6064 642e 6672 6f6d 5f70 616e  or ``dd.from_pan
+00028a00: 6461 7360 602e 0a0a 2020 2020 5061 7261  das``...    Para
+00028a10: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+00028a20: 2d2d 2d2d 2d0a 2020 2020 6473 6b3a 2064  -----.    dsk: d
+00028a30: 6963 740a 2020 2020 2020 2020 5468 6520  ict.        The 
+00028a40: 6461 736b 2067 7261 7068 2074 6f20 636f  dask graph to co
+00028a50: 6d70 7574 6520 7468 6973 2044 6174 6146  mpute this DataF
+00028a60: 7261 6d65 0a20 2020 206e 616d 653a 2073  rame.    name: s
+00028a70: 7472 0a20 2020 2020 2020 2054 6865 206b  tr.        The k
+00028a80: 6579 2070 7265 6669 7820 7468 6174 2073  ey prefix that s
+00028a90: 7065 6369 6669 6573 2077 6869 6368 206b  pecifies which k
+00028aa0: 6579 7320 696e 2074 6865 2064 6173 6b20  eys in the dask 
+00028ab0: 636f 6d70 7269 7365 2074 6869 730a 2020  comprise this.  
+00028ac0: 2020 2020 2020 7061 7274 6963 756c 6172        particular
+00028ad0: 2044 6174 6146 7261 6d65 0a20 2020 206d   DataFrame.    m
+00028ae0: 6574 613a 2070 616e 6461 732e 4461 7461  eta: pandas.Data
+00028af0: 4672 616d 650a 2020 2020 2020 2020 416e  Frame.        An
+00028b00: 2065 6d70 7479 2060 6070 616e 6461 732e   empty ``pandas.
+00028b10: 4461 7461 4672 616d 6560 6020 7769 7468  DataFrame`` with
+00028b20: 206e 616d 6573 2c20 6474 7970 6573 2c20   names, dtypes, 
+00028b30: 616e 6420 696e 6465 7820 6d61 7463 6869  and index matchi
+00028b40: 6e67 0a20 2020 2020 2020 2074 6865 2065  ng.        the e
+00028b50: 7870 6563 7465 6420 6f75 7470 7574 2e0a  xpected output..
+00028b60: 2020 2020 6469 7669 7369 6f6e 733a 2074      divisions: t
+00028b70: 7570 6c65 206f 6620 696e 6465 7820 7661  uple of index va
+00028b80: 6c75 6573 0a20 2020 2020 2020 2056 616c  lues.        Val
+00028b90: 7565 7320 616c 6f6e 6720 7768 6963 6820  ues along which 
+00028ba0: 7765 2070 6172 7469 7469 6f6e 206f 7572  we partition our
+00028bb0: 2062 6c6f 636b 7320 6f6e 2074 6865 2069   blocks on the i
+00028bc0: 6e64 6578 0a20 2020 2022 2222 0a0a 2020  ndex.    """..  
+00028bd0: 2020 5f70 6172 7469 7469 6f6e 5f74 7970    _partition_typ
+00028be0: 6520 3d20 7064 2e44 6174 6146 7261 6d65  e = pd.DataFrame
+00028bf0: 0a20 2020 205f 6973 5f70 6172 7469 7469  .    _is_partiti
+00028c00: 6f6e 5f74 7970 6520 3d20 7374 6174 6963  on_type = static
+00028c10: 6d65 7468 6f64 2869 735f 6461 7461 6672  method(is_datafr
+00028c20: 616d 655f 6c69 6b65 290a 2020 2020 5f74  ame_like).    _t
+00028c30: 6f6b 656e 5f70 7265 6669 7820 3d20 2264  oken_prefix = "d
+00028c40: 6174 6166 7261 6d65 2d22 0a20 2020 205f  ataframe-".    _
+00028c50: 6163 6365 7373 6f72 733a 2043 6c61 7373  accessors: Class
+00028c60: 5661 725b 7365 745b 7374 725d 5d20 3d20  Var[set[str]] = 
+00028c70: 7365 7428 290a 0a20 2020 2064 6566 205f  set()..    def _
+00028c80: 5f69 6e69 745f 5f28 7365 6c66 2c20 6473  _init__(self, ds
+00028c90: 6b2c 206e 616d 652c 206d 6574 612c 2064  k, name, meta, d
+00028ca0: 6976 6973 696f 6e73 293a 0a20 2020 2020  ivisions):.     
+00028cb0: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
+00028cc0: 745f 5f28 6473 6b2c 206e 616d 652c 206d  t__(dsk, name, m
+00028cd0: 6574 612c 2064 6976 6973 696f 6e73 290a  eta, divisions).
+00028ce0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00028cf0: 6461 736b 2e6c 6179 6572 735b 6e61 6d65  dask.layers[name
+00028d00: 5d2e 636f 6c6c 6563 7469 6f6e 5f61 6e6e  ].collection_ann
+00028d10: 6f74 6174 696f 6e73 2069 7320 4e6f 6e65  otations is None
+00028d20: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00028d30: 6c66 2e64 6173 6b2e 6c61 7965 7273 5b6e  lf.dask.layers[n
+00028d40: 616d 655d 2e63 6f6c 6c65 6374 696f 6e5f  ame].collection_
+00028d50: 616e 6e6f 7461 7469 6f6e 7320 3d20 7b0a  annotations = {.
+00028d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028d70: 226e 7061 7274 6974 696f 6e73 223a 2073  "npartitions": s
+00028d80: 656c 662e 6e70 6172 7469 7469 6f6e 732c  elf.npartitions,
+00028d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028da0: 2022 636f 6c75 6d6e 7322 3a20 5b63 6f6c   "columns": [col
+00028db0: 2066 6f72 2063 6f6c 2069 6e20 7365 6c66   for col in self
+00028dc0: 2e63 6f6c 756d 6e73 5d2c 0a20 2020 2020  .columns],.     
+00028dd0: 2020 2020 2020 2020 2020 2022 7479 7065             "type
+00028de0: 223a 2074 7970 656e 616d 6528 7479 7065  ": typename(type
+00028df0: 2873 656c 6629 292c 0a20 2020 2020 2020  (self)),.       
+00028e00: 2020 2020 2020 2020 2022 6461 7461 6672           "datafr
+00028e10: 616d 655f 7479 7065 223a 2074 7970 656e  ame_type": typen
+00028e20: 616d 6528 7479 7065 2873 656c 662e 5f6d  ame(type(self._m
+00028e30: 6574 6129 292c 0a20 2020 2020 2020 2020  eta)),.         
+00028e40: 2020 2020 2020 2022 7365 7269 6573 5f64         "series_d
+00028e50: 7479 7065 7322 3a20 7b0a 2020 2020 2020  types": {.      
+00028e60: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00028e70: 6c3a 2073 656c 662e 5f6d 6574 615b 636f  l: self._meta[co
+00028e80: 6c5d 2e64 7479 7065 0a20 2020 2020 2020  l].dtype.       
+00028e90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00028ea0: 6861 7361 7474 7228 7365 6c66 2e5f 6d65  hasattr(self._me
+00028eb0: 7461 5b63 6f6c 5d2c 2022 6474 7970 6522  ta[col], "dtype"
+00028ec0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00028ed0: 2020 2020 2020 656c 7365 204e 6f6e 650a        else None.
+00028ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ef0: 2020 2020 666f 7220 636f 6c20 696e 2073      for col in s
+00028f00: 656c 662e 5f6d 6574 612e 636f 6c75 6d6e  elf._meta.column
+00028f10: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00028f20: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
+00028f30: 207d 0a20 2020 2020 2020 2065 6c73 653a   }.        else:
+00028f40: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00028f50: 662e 6461 736b 2e6c 6179 6572 735b 6e61  f.dask.layers[na
+00028f60: 6d65 5d2e 636f 6c6c 6563 7469 6f6e 5f61  me].collection_a
+00028f70: 6e6e 6f74 6174 696f 6e73 2e75 7064 6174  nnotations.updat
+00028f80: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00028f90: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00028fa0: 2020 2020 2020 2020 2022 6e70 6172 7469           "nparti
+00028fb0: 7469 6f6e 7322 3a20 7365 6c66 2e6e 7061  tions": self.npa
+00028fc0: 7274 6974 696f 6e73 2c0a 2020 2020 2020  rtitions,.      
+00028fd0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00028fe0: 6f6c 756d 6e73 223a 205b 636f 6c20 666f  olumns": [col fo
+00028ff0: 7220 636f 6c20 696e 2073 656c 662e 636f  r col in self.co
+00029000: 6c75 6d6e 735d 2c0a 2020 2020 2020 2020  lumns],.        
+00029010: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
+00029020: 6522 3a20 7479 7065 6e61 6d65 2874 7970  e": typename(typ
+00029030: 6528 7365 6c66 2929 2c0a 2020 2020 2020  e(self)),.      
+00029040: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+00029050: 6174 6166 7261 6d65 5f74 7970 6522 3a20  ataframe_type": 
+00029060: 7479 7065 6e61 6d65 2874 7970 6528 7365  typename(type(se
+00029070: 6c66 2e5f 6d65 7461 2929 2c0a 2020 2020  lf._meta)),.    
+00029080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029090: 2273 6572 6965 735f 6474 7970 6573 223a  "series_dtypes":
+000290a0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+000290b0: 2020 2020 2020 2020 2020 2063 6f6c 3a20             col: 
+000290c0: 7365 6c66 2e5f 6d65 7461 5b63 6f6c 5d2e  self._meta[col].
+000290d0: 6474 7970 650a 2020 2020 2020 2020 2020  dtype.          
+000290e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000290f0: 2068 6173 6174 7472 2873 656c 662e 5f6d   hasattr(self._m
+00029100: 6574 615b 636f 6c5d 2c20 2264 7479 7065  eta[col], "dtype
+00029110: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00029120: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+00029130: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+00029140: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00029150: 2063 6f6c 2069 6e20 7365 6c66 2e5f 6d65   col in self._me
+00029160: 7461 2e63 6f6c 756d 6e73 0a20 2020 2020  ta.columns.     
+00029170: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00029180: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00029190: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+000291a0: 290a 0a20 2020 2064 6566 205f 5f61 7272  )..    def __arr
+000291b0: 6179 5f77 7261 705f 5f28 7365 6c66 2c20  ay_wrap__(self, 
+000291c0: 6172 7261 792c 2063 6f6e 7465 7874 3d4e  array, context=N
+000291d0: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
+000291e0: 2069 7369 6e73 7461 6e63 6528 636f 6e74   isinstance(cont
+000291f0: 6578 742c 2074 7570 6c65 2920 616e 6420  ext, tuple) and 
+00029200: 6c65 6e28 636f 6e74 6578 7429 203e 2030  len(context) > 0
+00029210: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00029220: 2069 7369 6e73 7461 6e63 6528 636f 6e74   isinstance(cont
+00029230: 6578 745b 315d 5b30 5d2c 206e 702e 6e64  ext[1][0], np.nd
+00029240: 6172 7261 7929 2061 6e64 2063 6f6e 7465  array) and conte
+00029250: 7874 5b31 5d5b 305d 2e73 6861 7065 203d  xt[1][0].shape =
+00029260: 3d20 2829 3a0a 2020 2020 2020 2020 2020  = ():.          
+00029270: 2020 2020 2020 696e 6465 7820 3d20 4e6f        index = No
+00029280: 6e65 0a20 2020 2020 2020 2020 2020 2065  ne.            e
+00029290: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000292a0: 2020 2020 2069 6e64 6578 203d 2063 6f6e       index = con
+000292b0: 7465 7874 5b31 5d5b 305d 2e69 6e64 6578  text[1][0].index
+000292c0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000292d0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+000292e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000292f0: 696d 706f 7274 2069 6e73 7065 6374 0a0a  import inspect..
+00029300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029310: 6d65 7468 6f64 5f6e 616d 6520 3d20 6622  method_name = f"
+00029320: 607b 696e 7370 6563 742e 7374 6163 6b28  `{inspect.stack(
+00029330: 295b 335d 5b33 5d7d 6022 0a20 2020 2020  )[3][3]}`".     
+00029340: 2020 2020 2020 2065 7863 6570 7420 496e         except In
+00029350: 6465 7845 7272 6f72 3a0a 2020 2020 2020  dexError:.      
+00029360: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00029370: 5f6e 616d 6520 3d20 2254 6869 7320 6d65  _name = "This me
+00029380: 7468 6f64 220a 0a20 2020 2020 2020 2020  thod"..         
+00029390: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+000293a0: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+000293b0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+000293c0: 7b6d 6574 686f 645f 6e61 6d65 7d20 6973  {method_name} is
+000293d0: 206e 6f74 2069 6d70 6c65 6d65 6e74 6564   not implemented
+000293e0: 2066 6f72 2060 6461 736b 2e64 6174 6166   for `dask.dataf
+000293f0: 7261 6d65 2e44 6174 6146 7261 6d65 602e  rame.DataFrame`.
+00029400: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+00029410: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00029420: 6d65 7461 5f66 7261 6d65 5f63 6f6e 7374  meta_frame_const
+00029430: 7275 6374 6f72 2873 656c 6629 2861 7272  ructor(self)(arr
+00029440: 6179 2c20 696e 6465 783d 696e 6465 782c  ay, index=index,
+00029450: 2063 6f6c 756d 6e73 3d73 656c 662e 636f   columns=self.co
+00029460: 6c75 6d6e 7329 0a0a 2020 2020 4070 726f  lumns)..    @pro
+00029470: 7065 7274 790a 2020 2020 6465 6620 6178  perty.    def ax
+00029480: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
+00029490: 2020 7265 7475 726e 205b 7365 6c66 2e69    return [self.i
+000294a0: 6e64 6578 2c20 7365 6c66 2e63 6f6c 756d  ndex, self.colum
+000294b0: 6e73 5d0a 0a20 2020 2040 7072 6f70 6572  ns]..    @proper
+000294c0: 7479 0a20 2020 2064 6566 2063 6f6c 756d  ty.    def colum
+000294d0: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
+000294e0: 2020 7265 7475 726e 2073 656c 662e 5f6d    return self._m
+000294f0: 6574 612e 636f 6c75 6d6e 730a 0a20 2020  eta.columns..   
+00029500: 2040 636f 6c75 6d6e 732e 7365 7474 6572   @columns.setter
+00029510: 0a20 2020 2064 6566 2063 6f6c 756d 6e73  .    def columns
+00029520: 2873 656c 662c 2063 6f6c 756d 6e73 293a  (self, columns):
+00029530: 0a20 2020 2020 2020 2072 656e 616d 6564  .        renamed
+00029540: 203d 205f 7265 6e61 6d65 5f64 6173 6b28   = _rename_dask(
+00029550: 7365 6c66 2c20 636f 6c75 6d6e 7329 0a20  self, columns). 
+00029560: 2020 2020 2020 2073 656c 662e 5f6d 6574         self._met
+00029570: 6120 3d20 7265 6e61 6d65 642e 5f6d 6574  a = renamed._met
+00029580: 610a 2020 2020 2020 2020 7365 6c66 2e5f  a.        self._
+00029590: 6e61 6d65 203d 2072 656e 616d 6564 2e5f  name = renamed._
+000295a0: 6e61 6d65 0a20 2020 2020 2020 2073 656c  name.        sel
+000295b0: 662e 6461 736b 203d 2072 656e 616d 6564  f.dask = renamed
+000295c0: 2e64 6173 6b0a 0a20 2020 2040 7072 6f70  .dask..    @prop
+000295d0: 6572 7479 0a20 2020 2064 6566 2069 6c6f  erty.    def ilo
+000295e0: 6328 7365 6c66 293a 0a20 2020 2020 2020  c(self):.       
+000295f0: 2022 2222 5075 7265 6c79 2069 6e74 6567   """Purely integ
+00029600: 6572 2d6c 6f63 6174 696f 6e20 6261 7365  er-location base
+00029610: 6420 696e 6465 7869 6e67 2066 6f72 2073  d indexing for s
+00029620: 656c 6563 7469 6f6e 2062 7920 706f 7369  election by posi
+00029630: 7469 6f6e 2e0a 0a20 2020 2020 2020 204f  tion...        O
+00029640: 6e6c 7920 696e 6465 7869 6e67 2074 6865  nly indexing the
+00029650: 2063 6f6c 756d 6e20 706f 7369 7469 6f6e   column position
+00029660: 7320 6973 2073 7570 706f 7274 6564 2e20  s is supported. 
+00029670: 5472 7969 6e67 2074 6f20 7365 6c65 6374  Trying to select
+00029680: 0a20 2020 2020 2020 2072 6f77 2070 6f73  .        row pos
+00029690: 6974 696f 6e73 2077 696c 6c20 7261 6973  itions will rais
+000296a0: 6520 6120 5661 6c75 6545 7272 6f72 2e0a  e a ValueError..
+000296b0: 0a20 2020 2020 2020 2053 6565 203a 7265  .        See :re
+000296c0: 663a 6064 6174 6166 7261 6d65 2e69 6e64  f:`dataframe.ind
+000296d0: 6578 696e 6760 2066 6f72 206d 6f72 652e  exing` for more.
+000296e0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+000296f0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+00029700: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
+00029710: 6466 2e69 6c6f 635b 3a2c 205b 322c 2030  df.iloc[:, [2, 0
+00029720: 2c20 315d 5d20 2023 2064 6f63 7465 7374  , 1]]  # doctest
+00029730: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
+00029740: 2222 220a 2020 2020 2020 2020 6672 6f6d  """.        from
+00029750: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+00029760: 696e 6465 7869 6e67 2069 6d70 6f72 7420  indexing import 
+00029770: 5f69 4c6f 6349 6e64 6578 6572 0a0a 2020  _iLocIndexer..  
+00029780: 2020 2020 2020 2320 466f 7220 6461 7461        # For data
+00029790: 6672 616d 6573 2077 6974 6820 756e 6971  frames with uniq
+000297a0: 7565 2063 6f6c 756d 6e20 6e61 6d65 732c  ue column names,
+000297b0: 2074 6869 7320 7769 6c6c 2062 6520 7472   this will be tr
+000297c0: 616e 7366 6f72 6d65 6420 696e 746f 2061  ansformed into a
+000297d0: 205f 5f67 6574 6974 656d 5f5f 2063 616c   __getitem__ cal
+000297e0: 6c0a 2020 2020 2020 2020 7265 7475 726e  l.        return
+000297f0: 205f 694c 6f63 496e 6465 7865 7228 7365   _iLocIndexer(se
+00029800: 6c66 290a 0a20 2020 2064 6566 205f 5f6c  lf)..    def __l
+00029810: 656e 5f5f 2873 656c 6629 3a0a 2020 2020  en__(self):.    
+00029820: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00029830: 2020 2020 2073 203d 2073 656c 662e 696c       s = self.il
+00029840: 6f63 5b3a 2c20 305d 0a20 2020 2020 2020  oc[:, 0].       
+00029850: 2065 7863 6570 7420 496e 6465 7845 7272   except IndexErr
+00029860: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00029870: 7265 7475 726e 2073 7570 6572 2829 2e5f  return super()._
+00029880: 5f6c 656e 5f5f 2829 0a20 2020 2020 2020  _len__().       
+00029890: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000298a0: 2020 2072 6574 7572 6e20 6c65 6e28 7329     return len(s)
+000298b0: 0a0a 2020 2020 6465 6620 5f5f 636f 6e74  ..    def __cont
+000298c0: 6169 6e73 5f5f 2873 656c 662c 206b 6579  ains__(self, key
+000298d0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000298e0: 6e20 6b65 7920 696e 2073 656c 662e 5f6d  n key in self._m
+000298f0: 6574 610a 0a20 2020 2040 7072 6f70 6572  eta..    @proper
+00029900: 7479 0a20 2020 2064 6566 2065 6d70 7479  ty.    def empty
+00029910: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00029920: 2320 5f5f 6765 7461 7474 725f 5f20 7769  # __getattr__ wi
+00029930: 6c6c 2062 6520 6361 6c6c 6564 2061 6674  ll be called aft
+00029940: 6572 2077 6520 7261 6973 6520 7468 6973  er we raise this
+00029950: 2c20 736f 2077 6527 6c6c 2072 6169 7365  , so we'll raise
+00029960: 2069 7420 6167 6169 6e20 6672 6f6d 2074   it again from t
+00029970: 6865 7265 0a20 2020 2020 2020 2072 6169  here.        rai
+00029980: 7365 2041 7474 7269 6275 7465 4e6f 7449  se AttributeNotI
+00029990: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+000299a0: 0a20 2020 2020 2020 2020 2020 2022 4368  .            "Ch
+000299b0: 6563 6b69 6e67 2077 6865 7468 6572 2061  ecking whether a
+000299c0: 2044 6173 6b20 4461 7461 4672 616d 6520   Dask DataFrame 
+000299d0: 6861 7320 616e 7920 726f 7773 206d 6179  has any rows may
+000299e0: 2062 6520 6578 7065 6e73 6976 652e 2022   be expensive. "
+000299f0: 0a20 2020 2020 2020 2020 2020 2022 486f  .            "Ho
+00029a00: 7765 7665 722c 2063 6865 636b 696e 6720  wever, checking 
+00029a10: 7468 6520 6e75 6d62 6572 206f 6620 636f  the number of co
+00029a20: 6c75 6d6e 7320 6973 2066 6173 742e 2022  lumns is fast. "
+00029a30: 0a20 2020 2020 2020 2020 2020 2022 4465  .            "De
+00029a40: 7065 6e64 696e 6720 6f6e 2077 6869 6368  pending on which
+00029a50: 206f 6620 7468 6573 6520 7265 7375 6c74   of these result
+00029a60: 7320 796f 7520 6e65 6564 2c20 7573 6520  s you need, use 
+00029a70: 6569 7468 6572 2022 0a20 2020 2020 2020  either ".       
+00029a80: 2020 2020 2022 606c 656e 2864 662e 696e       "`len(df.in
+00029a90: 6465 7829 203d 3d20 3060 206f 7220 606c  dex) == 0` or `l
+00029aa0: 656e 2864 662e 636f 6c75 6d6e 7329 203d  en(df.columns) =
+00029ab0: 3d20 3060 220a 2020 2020 2020 2020 290a  = 0`".        ).
+00029ac0: 0a20 2020 2064 6566 205f 5f67 6574 6974  .    def __getit
+00029ad0: 656d 5f5f 2873 656c 662c 206b 6579 293a  em__(self, key):
+00029ae0: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
+00029af0: 2267 6574 6974 656d 2d25 7322 2025 2074  "getitem-%s" % t
+00029b00: 6f6b 656e 697a 6528 7365 6c66 2c20 6b65  okenize(self, ke
+00029b10: 7929 0a20 2020 2020 2020 2069 6620 6e70  y).        if np
+00029b20: 2e69 7373 6361 6c61 7228 6b65 7929 206f  .isscalar(key) o
+00029b30: 7220 6973 696e 7374 616e 6365 286b 6579  r isinstance(key
+00029b40: 2c20 2874 7570 6c65 2c20 7374 7229 293a  , (tuple, str)):
+00029b50: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00029b60: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
+00029b70: 5f6d 6574 612e 696e 6465 782c 2028 7064  _meta.index, (pd
+00029b80: 2e44 6174 6574 696d 6549 6e64 6578 2c20  .DatetimeIndex, 
+00029b90: 7064 2e50 6572 696f 6449 6e64 6578 2929  pd.PeriodIndex))
+00029ba0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00029bb0: 2020 6966 206b 6579 206e 6f74 2069 6e20    if key not in 
+00029bc0: 7365 6c66 2e5f 6d65 7461 2e63 6f6c 756d  self._meta.colum
+00029bd0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+00029be0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00029bf0: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
+00029c00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00029c10: 496e 6465 7869 6e67 2061 2044 6174 6146  Indexing a DataF
+00029c20: 7261 6d65 2077 6974 6820 6120 6461 7465  rame with a date
+00029c30: 7469 6d65 6c69 6b65 2069 6e64 6578 2075  timelike index u
+00029c40: 7369 6e67 2061 2073 696e 676c 6520 220a  sing a single ".
+00029c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029c60: 2020 2020 2020 2020 2273 7472 696e 6720          "string 
+00029c70: 746f 2073 6c69 6365 2074 6865 2072 6f77  to slice the row
+00029c80: 732c 206c 696b 6520 6066 7261 6d65 5b73  s, like `frame[s
+00029c90: 7472 696e 675d 602c 2069 7320 6465 7072  tring]`, is depr
+00029ca0: 6563 6174 6564 2022 0a20 2020 2020 2020  ecated ".       
+00029cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029cc0: 2022 616e 6420 7769 6c6c 2062 6520 7265   "and will be re
+00029cd0: 6d6f 7665 6420 696e 2061 2066 7574 7572  moved in a futur
+00029ce0: 6520 7665 7273 696f 6e2e 2055 7365 2060  e version. Use `
+00029cf0: 6672 616d 652e 6c6f 635b 7374 7269 6e67  frame.loc[string
+00029d00: 5d60 2022 0a20 2020 2020 2020 2020 2020  ]` ".           
+00029d10: 2020 2020 2020 2020 2020 2020 2022 696e               "in
+00029d20: 7374 6561 642e 222c 0a20 2020 2020 2020  stead.",.       
+00029d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029d40: 2046 7574 7572 6557 6172 6e69 6e67 2c0a   FutureWarning,.
+00029d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029d60: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00029d70: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00029d80: 2073 656c 662e 6c6f 635b 6b65 795d 0a0a   self.loc[key]..
+00029d90: 2020 2020 2020 2020 2020 2020 2320 6572              # er
+00029da0: 726f 7220 6973 2072 6169 7365 6420 6672  ror is raised fr
+00029db0: 6f6d 2070 616e 6461 730a 2020 2020 2020  om pandas.      
+00029dc0: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
+00029dd0: 662e 5f6d 6574 615b 5f65 7874 7261 6374  f._meta[_extract
+00029de0: 5f6d 6574 6128 6b65 7929 5d0a 2020 2020  _meta(key)].    
+00029df0: 2020 2020 2020 2020 6473 6b20 3d20 7061          dsk = pa
+00029e00: 7274 6974 696f 6e77 6973 655f 6772 6170  rtitionwise_grap
+00029e10: 6828 6f70 6572 6174 6f72 2e67 6574 6974  h(operator.getit
+00029e20: 656d 2c20 6e61 6d65 2c20 7365 6c66 2c20  em, name, self, 
+00029e30: 6b65 7929 0a20 2020 2020 2020 2020 2020  key).           
+00029e40: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+00029e50: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+00029e60: 6c65 6374 696f 6e73 286e 616d 652c 2064  lections(name, d
+00029e70: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
+00029e80: 3d5b 7365 6c66 5d29 0a20 2020 2020 2020  =[self]).       
+00029e90: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00029ea0: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
+00029eb0: 206e 616d 652c 206d 6574 612c 2073 656c   name, meta, sel
+00029ec0: 662e 6469 7669 7369 6f6e 7329 0a20 2020  f.divisions).   
+00029ed0: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
+00029ee0: 616e 6365 286b 6579 2c20 736c 6963 6529  ance(key, slice)
+00029ef0: 3a0a 2020 2020 2020 2020 2020 2020 6672  :.            fr
+00029f00: 6f6d 2070 616e 6461 732e 6170 692e 7479  om pandas.api.ty
+00029f10: 7065 7320 696d 706f 7274 2069 735f 666c  pes import is_fl
+00029f20: 6f61 745f 6474 7970 650a 0a20 2020 2020  oat_dtype..     
+00029f30: 2020 2020 2020 2069 735f 696e 7465 6765         is_intege
+00029f40: 725f 736c 6963 6520 3d20 616e 7928 0a20  r_slice = any(. 
+00029f50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00029f60: 7369 6e73 7461 6e63 6528 692c 2049 6e74  sinstance(i, Int
+00029f70: 6567 7261 6c29 2066 6f72 2069 2069 6e20  egral) for i in 
+00029f80: 286b 6579 2e73 7461 7274 2c20 6b65 792e  (key.start, key.
+00029f90: 7374 6570 2c20 6b65 792e 7374 6f70 290a  step, key.stop).
+00029fa0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00029fb0: 2020 2020 2020 2020 2020 2320 536c 6963            # Slic
+00029fc0: 696e 6720 7769 7468 2069 6e74 6567 6572  ing with integer
+00029fd0: 206c 6162 656c 7320 6973 2061 6c77 6179   labels is alway
+00029fe0: 7320 696c 6f63 2062 6173 6564 2065 7863  s iloc based exc
+00029ff0: 6570 7420 666f 7220 610a 2020 2020 2020  ept for a.      
+0002a000: 2020 2020 2020 2320 666c 6f61 7420 696e        # float in
+0002a010: 6465 7865 7220 666f 7220 736f 6d65 2072  dexer for some r
+0002a020: 6561 736f 6e0a 2020 2020 2020 2020 2020  eason.          
+0002a030: 2020 6966 2069 735f 696e 7465 6765 725f    if is_integer_
+0002a040: 736c 6963 6520 616e 6420 6e6f 7420 6973  slice and not is
+0002a050: 5f66 6c6f 6174 5f64 7479 7065 2873 656c  _float_dtype(sel
+0002a060: 662e 696e 6465 782e 6474 7970 6529 3a0a  f.index.dtype):.
+0002a070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a080: 2320 4e4f 5445 3a20 7468 6973 2061 6c77  # NOTE: this alw
+0002a090: 6179 7320 6661 696c 7320 6375 7272 656e  ays fails curren
+0002a0a0: 746c 792c 2061 7320 696c 6f63 2069 7320  tly, as iloc is 
+0002a0b0: 6d6f 7374 6c79 0a20 2020 2020 2020 2020  mostly.         
+0002a0c0: 2020 2020 2020 2023 2075 6e73 7570 706f         # unsuppo
+0002a0d0: 7274 6564 2c20 6275 7420 7765 2063 616c  rted, but we cal
+0002a0e0: 6c20 6974 2061 6e79 7761 7920 6865 7265  l it anyway here
+0002a0f0: 2066 6f72 2066 7574 7572 652d 7072 6f6f   for future-proo
+0002a100: 6669 6e67 0a20 2020 2020 2020 2020 2020  fing.           
+0002a110: 2020 2020 2023 2061 6e64 2065 7272 6f72       # and error
+0002a120: 2d61 7474 7269 6275 7469 6f6e 2070 7572  -attribution pur
+0002a130: 706f 7365 730a 2020 2020 2020 2020 2020  poses.          
+0002a140: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0002a150: 662e 696c 6f63 5b6b 6579 5d0a 2020 2020  f.iloc[key].    
+0002a160: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002a170: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0002a180: 7475 726e 2073 656c 662e 6c6f 635b 6b65  turn self.loc[ke
+0002a190: 795d 0a0a 2020 2020 2020 2020 6966 2069  y]..        if i
+0002a1a0: 7369 6e73 7461 6e63 6528 6b65 792c 2028  sinstance(key, (
+0002a1b0: 6e70 2e6e 6461 7272 6179 2c20 6c69 7374  np.ndarray, list
+0002a1c0: 2929 206f 7220 280a 2020 2020 2020 2020  )) or (.        
+0002a1d0: 2020 2020 6e6f 7420 6973 5f64 6173 6b5f      not is_dask_
+0002a1e0: 636f 6c6c 6563 7469 6f6e 286b 6579 2920  collection(key) 
+0002a1f0: 616e 6420 2869 735f 7365 7269 6573 5f6c  and (is_series_l
+0002a200: 696b 6528 6b65 7929 206f 7220 6973 5f69  ike(key) or is_i
+0002a210: 6e64 6578 5f6c 696b 6528 6b65 7929 290a  ndex_like(key)).
+0002a220: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+0002a230: 2020 2020 2020 2023 2065 7272 6f72 2069         # error i
+0002a240: 7320 7261 6973 6564 2066 726f 6d20 7061  s raised from pa
+0002a250: 6e64 6173 0a20 2020 2020 2020 2020 2020  ndas.           
+0002a260: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+0002a270: 7461 5b5f 6578 7472 6163 745f 6d65 7461  ta[_extract_meta
+0002a280: 286b 6579 295d 0a0a 2020 2020 2020 2020  (key)]..        
+0002a290: 2020 2020 6473 6b20 3d20 7061 7274 6974      dsk = partit
+0002a2a0: 696f 6e77 6973 655f 6772 6170 6828 6f70  ionwise_graph(op
+0002a2b0: 6572 6174 6f72 2e67 6574 6974 656d 2c20  erator.getitem, 
+0002a2c0: 6e61 6d65 2c20 7365 6c66 2c20 6b65 7929  name, self, key)
+0002a2d0: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
+0002a2e0: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+0002a2f0: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+0002a300: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
+0002a310: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
+0002a320: 6c66 5d29 0a20 2020 2020 2020 2020 2020  lf]).           
+0002a330: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
+0002a340: 626a 6563 7428 6772 6170 682c 206e 616d  bject(graph, nam
+0002a350: 652c 206d 6574 612c 2073 656c 662e 6469  e, meta, self.di
+0002a360: 7669 7369 6f6e 7329 0a20 2020 2020 2020  visions).       
+0002a370: 2069 6620 6973 696e 7374 616e 6365 286b   if isinstance(k
+0002a380: 6579 2c20 5365 7269 6573 293a 0a20 2020  ey, Series):.   
+0002a390: 2020 2020 2020 2020 2023 2064 6f20 6e6f           # do no
+0002a3a0: 7420 7065 7266 6f72 6d20 6475 6d6d 7920  t perform dummy 
+0002a3b0: 6361 6c63 756c 6174 696f 6e2c 2061 7320  calculation, as 
+0002a3c0: 636f 6c75 6d6e 7320 7769 6c6c 206e 6f74  columns will not
+0002a3d0: 2062 6520 6368 616e 6765 642e 0a20 2020   be changed..   
+0002a3e0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0002a3f0: 2e64 6976 6973 696f 6e73 2021 3d20 6b65  .divisions != ke
+0002a400: 792e 6469 7669 7369 6f6e 733a 0a20 2020  y.divisions:.   
+0002a410: 2020 2020 2020 2020 2020 2020 2066 726f               fro
+0002a420: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
+0002a430: 2e6d 756c 7469 2069 6d70 6f72 7420 5f6d  .multi import _m
+0002a440: 6179 6265 5f61 6c69 676e 5f70 6172 7469  aybe_align_parti
+0002a450: 7469 6f6e 730a 0a20 2020 2020 2020 2020  tions..         
+0002a460: 2020 2020 2020 2073 656c 662c 206b 6579         self, key
+0002a470: 203d 205f 6d61 7962 655f 616c 6967 6e5f   = _maybe_align_
+0002a480: 7061 7274 6974 696f 6e73 285b 7365 6c66  partitions([self
+0002a490: 2c20 6b65 795d 290a 2020 2020 2020 2020  , key]).        
+0002a4a0: 2020 2020 6473 6b20 3d20 7061 7274 6974      dsk = partit
+0002a4b0: 696f 6e77 6973 655f 6772 6170 6828 6f70  ionwise_graph(op
+0002a4c0: 6572 6174 6f72 2e67 6574 6974 656d 2c20  erator.getitem, 
+0002a4d0: 6e61 6d65 2c20 7365 6c66 2c20 6b65 7929  name, self, key)
+0002a4e0: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
+0002a4f0: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+0002a500: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+0002a510: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
+0002a520: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
+0002a530: 6c66 2c20 6b65 795d 290a 2020 2020 2020  lf, key]).      
+0002a540: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+0002a550: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
+0002a560: 2c20 6e61 6d65 2c20 7365 6c66 2c20 7365  , name, self, se
+0002a570: 6c66 2e64 6976 6973 696f 6e73 290a 2020  lf.divisions).  
+0002a580: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0002a590: 6e63 6528 6b65 792c 2044 6174 6146 7261  nce(key, DataFra
+0002a5a0: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
+0002a5b0: 2072 6574 7572 6e20 7365 6c66 2e77 6865   return self.whe
+0002a5c0: 7265 286b 6579 2c20 6e70 2e6e 616e 290a  re(key, np.nan).
+0002a5d0: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
+0002a5e0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0002a5f0: 6f72 286b 6579 290a 0a20 2020 2064 6566  or(key)..    def
+0002a600: 205f 5f73 6574 6974 656d 5f5f 2873 656c   __setitem__(sel
+0002a610: 662c 206b 6579 2c20 7661 6c75 6529 3a0a  f, key, value):.
+0002a620: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0002a630: 7461 6e63 6528 6b65 792c 2028 7475 706c  tance(key, (tupl
+0002a640: 652c 206c 6973 7429 2920 616e 6420 6973  e, list)) and is
+0002a650: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
+0002a660: 4461 7461 4672 616d 6529 3a0a 2020 2020  DataFrame):.    
+0002a670: 2020 2020 2020 2020 6466 203d 2073 656c          df = sel
+0002a680: 662e 6173 7369 676e 282a 2a7b 6b3a 2076  f.assign(**{k: v
+0002a690: 616c 7565 5b63 5d20 666f 7220 6b2c 2063  alue[c] for k, c
+0002a6a0: 2069 6e20 7a69 7028 6b65 792c 2076 616c   in zip(key, val
+0002a6b0: 7565 2e63 6f6c 756d 6e73 297d 290a 0a20  ue.columns)}).. 
+0002a6c0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+0002a6d0: 7374 616e 6365 286b 6579 2c20 7064 2e49  stance(key, pd.I
+0002a6e0: 6e64 6578 2920 616e 6420 6e6f 7420 6973  ndex) and not is
+0002a6f0: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
+0002a700: 4461 7461 4672 616d 6529 3a0a 2020 2020  DataFrame):.    
+0002a710: 2020 2020 2020 2020 6b65 7920 3d20 6c69          key = li
+0002a720: 7374 286b 6579 290a 2020 2020 2020 2020  st(key).        
+0002a730: 2020 2020 6466 203d 2073 656c 662e 6173      df = self.as
+0002a740: 7369 676e 282a 2a7b 6b3a 2076 616c 7565  sign(**{k: value
+0002a750: 2066 6f72 206b 2069 6e20 6b65 797d 290a   for k in key}).
+0002a760: 2020 2020 2020 2020 656c 6966 2028 0a20          elif (. 
+0002a770: 2020 2020 2020 2020 2020 2069 735f 6461             is_da
+0002a780: 7461 6672 616d 655f 6c69 6b65 286b 6579  taframe_like(key
+0002a790: 290a 2020 2020 2020 2020 2020 2020 6f72  ).            or
+0002a7a0: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
+0002a7b0: 6b65 7929 0a20 2020 2020 2020 2020 2020  key).           
+0002a7c0: 206f 7220 6973 696e 7374 616e 6365 286b   or isinstance(k
+0002a7d0: 6579 2c20 2844 6174 6146 7261 6d65 2c20  ey, (DataFrame, 
+0002a7e0: 5365 7269 6573 2929 0a20 2020 2020 2020  Series)).       
+0002a7f0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0002a800: 6466 203d 2073 656c 662e 7768 6572 6528  df = self.where(
+0002a810: 7e6b 6579 2c20 7661 6c75 6529 0a20 2020  ~key, value).   
+0002a820: 2020 2020 2065 6c69 6620 6e6f 7420 6973       elif not is
+0002a830: 696e 7374 616e 6365 286b 6579 2c20 7374  instance(key, st
+0002a840: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+0002a850: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+0002a860: 6e74 6564 4572 726f 7228 6622 4974 656d  ntedError(f"Item
+0002a870: 2061 7373 6967 6e6d 656e 7420 7769 7468   assignment with
+0002a880: 207b 7479 7065 286b 6579 297d 206e 6f74   {type(key)} not
+0002a890: 2073 7570 706f 7274 6564 2229 0a20 2020   supported").   
+0002a8a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0002a8b0: 2020 2020 2020 2064 6620 3d20 7365 6c66         df = self
+0002a8c0: 2e61 7373 6967 6e28 2a2a 7b6b 6579 3a20  .assign(**{key: 
+0002a8d0: 7661 6c75 657d 290a 0a20 2020 2020 2020  value})..       
+0002a8e0: 2073 656c 662e 6461 736b 203d 2064 662e   self.dask = df.
+0002a8f0: 6461 736b 0a20 2020 2020 2020 2073 656c  dask.        sel
+0002a900: 662e 5f6e 616d 6520 3d20 6466 2e5f 6e61  f._name = df._na
+0002a910: 6d65 0a20 2020 2020 2020 2073 656c 662e  me.        self.
+0002a920: 5f6d 6574 6120 3d20 6466 2e5f 6d65 7461  _meta = df._meta
+0002a930: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
+0002a940: 6976 6973 696f 6e73 203d 2064 662e 6469  ivisions = df.di
+0002a950: 7669 7369 6f6e 730a 0a20 2020 2064 6566  visions..    def
+0002a960: 205f 5f64 656c 6974 656d 5f5f 2873 656c   __delitem__(sel
+0002a970: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
+0002a980: 2072 6573 756c 7420 3d20 7365 6c66 2e64   result = self.d
+0002a990: 726f 7028 5b6b 6579 5d2c 2061 7869 733d  rop([key], axis=
+0002a9a0: 3129 0a20 2020 2020 2020 2073 656c 662e  1).        self.
+0002a9b0: 6461 736b 203d 2072 6573 756c 742e 6461  dask = result.da
+0002a9c0: 736b 0a20 2020 2020 2020 2073 656c 662e  sk.        self.
+0002a9d0: 5f6e 616d 6520 3d20 7265 7375 6c74 2e5f  _name = result._
+0002a9e0: 6e61 6d65 0a20 2020 2020 2020 2073 656c  name.        sel
+0002a9f0: 662e 5f6d 6574 6120 3d20 7265 7375 6c74  f._meta = result
+0002aa00: 2e5f 6d65 7461 0a0a 2020 2020 6465 6620  ._meta..    def 
+0002aa10: 5f5f 7365 7461 7474 725f 5f28 7365 6c66  __setattr__(self
+0002aa20: 2c20 6b65 792c 2076 616c 7565 293a 0a20  , key, value):. 
+0002aa30: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0002aa40: 2020 2020 2020 2020 636f 6c75 6d6e 7320          columns 
+0002aa50: 3d20 6f62 6a65 6374 2e5f 5f67 6574 6174  = object.__getat
+0002aa60: 7472 6962 7574 655f 5f28 7365 6c66 2c20  tribute__(self, 
+0002aa70: 225f 6d65 7461 2229 2e63 6f6c 756d 6e73  "_meta").columns
+0002aa80: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+0002aa90: 4174 7472 6962 7574 6545 7272 6f72 3a0a  AttributeError:.
+0002aaa0: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+0002aab0: 6d6e 7320 3d20 2829 0a0a 2020 2020 2020  mns = ()..      
+0002aac0: 2020 2320 6578 636c 7564 6520 7072 6f74    # exclude prot
+0002aad0: 6563 7465 6420 6174 7472 6962 7574 6573  ected attributes
+0002aae0: 2066 726f 6d20 7365 7469 7465 6d0a 2020   from setitem.  
+0002aaf0: 2020 2020 2020 6966 206b 6579 2069 6e20        if key in 
+0002ab00: 636f 6c75 6d6e 7320 616e 6420 6b65 7920  columns and key 
+0002ab10: 6e6f 7420 696e 205b 2264 6976 6973 696f  not in ["divisio
+0002ab20: 6e73 222c 2022 6461 736b 222c 2022 5f6e  ns", "dask", "_n
+0002ab30: 616d 6522 2c20 225f 6d65 7461 225d 3a0a  ame", "_meta"]:.
+0002ab40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002ab50: 5b6b 6579 5d20 3d20 7661 6c75 650a 2020  [key] = value.  
+0002ab60: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0002ab70: 2020 2020 2020 2020 6f62 6a65 6374 2e5f          object._
+0002ab80: 5f73 6574 6174 7472 5f5f 2873 656c 662c  _setattr__(self,
+0002ab90: 206b 6579 2c20 7661 6c75 6529 0a0a 2020   key, value)..  
+0002aba0: 2020 6465 6620 5f5f 6765 7461 7474 725f    def __getattr_
+0002abb0: 5f28 7365 6c66 2c20 6b65 7929 3a0a 2020  _(self, key):.  
+0002abc0: 2020 2020 2020 6966 206b 6579 2069 6e20        if key in 
+0002abd0: 7365 6c66 2e63 6f6c 756d 6e73 3a0a 2020  self.columns:.  
+0002abe0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0002abf0: 2073 656c 665b 6b65 795d 0a20 2020 2020   self[key].     
+0002ac00: 2020 2065 6c69 6620 6b65 7920 3d3d 2022     elif key == "
+0002ac10: 656d 7074 7922 3a0a 2020 2020 2020 2020  empty":.        
+0002ac20: 2020 2020 2320 7365 6c66 2e65 6d70 7479      # self.empty
+0002ac30: 2072 6169 7365 7320 4174 7472 6962 7574   raises Attribut
+0002ac40: 654e 6f74 496d 706c 656d 656e 7465 6445  eNotImplementedE
+0002ac50: 7272 6f72 2c20 7768 6963 6820 696e 636c  rror, which incl
+0002ac60: 7564 6573 0a20 2020 2020 2020 2020 2020  udes.           
+0002ac70: 2023 2041 7474 7269 6275 7465 4572 726f   # AttributeErro
+0002ac80: 722c 2077 6869 6368 206d 6561 6e73 2077  r, which means w
+0002ac90: 6520 656e 6420 7570 2068 6572 6520 696e  e end up here in
+0002aca0: 2073 656c 662e 5f5f 6765 7461 7474 725f   self.__getattr_
+0002acb0: 5f2c 0a20 2020 2020 2020 2020 2020 2023  _,.            #
+0002acc0: 2062 6563 6175 7365 2044 6174 6146 7261   because DataFra
+0002acd0: 6d65 2e5f 5f67 6574 6174 7472 6962 7574  me.__getattribut
+0002ace0: 655f 5f20 646f 6573 6e27 7420 7468 696e  e__ doesn't thin
+0002acf0: 6b20 7468 6520 6174 7472 6962 7574 6520  k the attribute 
+0002ad00: 6578 6973 7473 0a20 2020 2020 2020 2020  exists.         
+0002ad10: 2020 2023 2061 6e64 2075 7365 7320 5f5f     # and uses __
+0002ad20: 6765 7461 7474 725f 5f20 6173 2074 6865  getattr__ as the
+0002ad30: 2066 616c 6c62 6163 6b2e 2053 6f2c 2067   fallback. So, g
+0002ad40: 6574 2060 7365 6c66 2e65 6d70 7479 6020  et `self.empty` 
+0002ad50: 6d6f 7265 0a20 2020 2020 2020 2020 2020  more.           
+0002ad60: 2023 2066 6f72 6365 6675 6c6c 7920 7669   # forcefully vi
+0002ad70: 6120 6f62 6a65 6374 2e5f 5f67 6574 6174  a object.__getat
+0002ad80: 7472 6962 7574 655f 5f20 746f 2072 6169  tribute__ to rai
+0002ad90: 7365 2069 6e66 6f72 6d61 7469 7665 2065  se informative e
+0002ada0: 7272 6f72 2e0a 2020 2020 2020 2020 2020  rror..          
+0002adb0: 2020 6f62 6a65 6374 2e5f 5f67 6574 6174    object.__getat
+0002adc0: 7472 6962 7574 655f 5f28 7365 6c66 2c20  tribute__(self, 
+0002add0: 6b65 7929 0a20 2020 2020 2020 2065 6c73  key).        els
+0002ade0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0002adf0: 6169 7365 2041 7474 7269 6275 7465 4572  aise AttributeEr
+0002ae00: 726f 7228 2227 4461 7461 4672 616d 6527  ror("'DataFrame'
+0002ae10: 206f 626a 6563 7420 6861 7320 6e6f 2061   object has no a
+0002ae20: 7474 7269 6275 7465 2025 7222 2025 206b  ttribute %r" % k
+0002ae30: 6579 290a 0a20 2020 2064 6566 205f 5f64  ey)..    def __d
+0002ae40: 6972 5f5f 2873 656c 6629 3a0a 2020 2020  ir__(self):.    
+0002ae50: 2020 2020 6f20 3d20 7365 7428 6469 7228      o = set(dir(
+0002ae60: 7479 7065 2873 656c 6629 2929 0a20 2020  type(self))).   
+0002ae70: 2020 2020 206f 2e75 7064 6174 6528 7365       o.update(se
+0002ae80: 6c66 2e5f 5f64 6963 745f 5f29 0a20 2020  lf.__dict__).   
+0002ae90: 2020 2020 206f 2e75 7064 6174 6528 6320       o.update(c 
+0002aea0: 666f 7220 6320 696e 2073 656c 662e 636f  for c in self.co
+0002aeb0: 6c75 6d6e 7320 6966 2028 6973 696e 7374  lumns if (isinst
+0002aec0: 616e 6365 2863 2c20 7374 7229 2061 6e64  ance(c, str) and
+0002aed0: 2063 2e69 7369 6465 6e74 6966 6965 7228   c.isidentifier(
+0002aee0: 2929 290a 2020 2020 2020 2020 7265 7475  ))).        retu
+0002aef0: 726e 206c 6973 7428 6f29 0a0a 2020 2020  rn list(o)..    
+0002af00: 6465 6620 5f5f 6974 6572 5f5f 2873 656c  def __iter__(sel
+0002af10: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+0002af20: 726e 2069 7465 7228 7365 6c66 2e5f 6d65  rn iter(self._me
+0002af30: 7461 290a 0a20 2020 2064 6566 205f 6970  ta)..    def _ip
+0002af40: 7974 686f 6e5f 6b65 795f 636f 6d70 6c65  ython_key_comple
+0002af50: 7469 6f6e 735f 2873 656c 6629 3a0a 2020  tions_(self):.  
+0002af60: 2020 2020 2020 7265 7475 726e 206d 6574        return met
+0002af70: 686f 6473 2e74 6f6c 6973 7428 7365 6c66  hods.tolist(self
+0002af80: 2e63 6f6c 756d 6e73 290a 0a20 2020 2040  .columns)..    @
+0002af90: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0002afa0: 206e 6469 6d28 7365 6c66 293a 0a20 2020   ndim(self):.   
+0002afb0: 2020 2020 2022 2222 5265 7475 726e 2064       """Return d
+0002afc0: 696d 656e 7369 6f6e 616c 6974 7922 2222  imensionality"""
+0002afd0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002afe0: 320a 0a20 2020 2040 7072 6f70 6572 7479  2..    @property
+0002aff0: 0a20 2020 2064 6566 2073 6861 7065 2873  .    def shape(s
+0002b000: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+0002b010: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
+0002b020: 2061 2074 7570 6c65 2072 6570 7265 7365   a tuple represe
+0002b030: 6e74 696e 6720 7468 6520 6469 6d65 6e73  nting the dimens
+0002b040: 696f 6e61 6c69 7479 206f 6620 7468 6520  ionality of the 
+0002b050: 4461 7461 4672 616d 652e 0a0a 2020 2020  DataFrame...    
+0002b060: 2020 2020 5468 6520 6e75 6d62 6572 206f      The number o
+0002b070: 6620 726f 7773 2069 7320 6120 4465 6c61  f rows is a Dela
+0002b080: 7965 6420 7265 7375 6c74 2e20 5468 6520  yed result. The 
+0002b090: 6e75 6d62 6572 206f 6620 636f 6c75 6d6e  number of column
+0002b0a0: 730a 2020 2020 2020 2020 6973 2061 2063  s.        is a c
+0002b0b0: 6f6e 6372 6574 6520 696e 7465 6765 722e  oncrete integer.
+0002b0c0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+0002b0d0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+0002b0e0: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
+0002b0f0: 6466 2e73 697a 6520 2023 2064 6f63 7465  df.size  # docte
+0002b100: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
+0002b110: 2020 2844 656c 6179 6564 2827 696e 742d    (Delayed('int-
+0002b120: 3037 6630 3630 3735 2d35 6563 632d 3464  07f06075-5ecc-4d
+0002b130: 3737 2d38 3137 652d 3633 6336 3961 3931  77-817e-63c69a91
+0002b140: 3838 6138 2729 2c20 3229 0a20 2020 2020  88a8'), 2).     
+0002b150: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+0002b160: 6f6c 5f73 697a 6520 3d20 6c65 6e28 7365  ol_size = len(se
+0002b170: 6c66 2e63 6f6c 756d 6e73 290a 2020 2020  lf.columns).    
+0002b180: 2020 2020 6966 2063 6f6c 5f73 697a 6520      if col_size 
+0002b190: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+0002b1a0: 2020 7265 7475 726e 2028 7365 6c66 2e69    return (self.i
+0002b1b0: 6e64 6578 2e73 6861 7065 5b30 5d2c 2030  ndex.shape[0], 0
+0002b1c0: 290a 2020 2020 2020 2020 726f 775f 7369  ).        row_si
+0002b1d0: 7a65 203d 2064 656c 6179 6564 2869 6e74  ze = delayed(int
+0002b1e0: 2928 7365 6c66 2e73 697a 6520 2f20 636f  )(self.size / co
+0002b1f0: 6c5f 7369 7a65 290a 2020 2020 2020 2020  l_size).        
+0002b200: 7265 7475 726e 2028 726f 775f 7369 7a65  return (row_size
+0002b210: 2c20 636f 6c5f 7369 7a65 290a 0a20 2020  , col_size)..   
+0002b220: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0002b230: 6566 2064 7479 7065 7328 7365 6c66 293a  ef dtypes(self):
+0002b240: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+0002b250: 726e 2064 6174 6120 7479 7065 7322 2222  rn data types"""
+0002b260: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002b270: 7365 6c66 2e5f 6d65 7461 2e64 7479 7065  self._meta.dtype
+0002b280: 730a 0a20 2020 2040 6465 7269 7665 645f  s..    @derived_
+0002b290: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0002b2a0: 6529 0a20 2020 2064 6566 2067 6574 5f64  e).    def get_d
+0002b2b0: 7479 7065 5f63 6f75 6e74 7328 7365 6c66  type_counts(self
+0002b2c0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0002b2d0: 6e20 7365 6c66 2e5f 6d65 7461 2e67 6574  n self._meta.get
+0002b2e0: 5f64 7479 7065 5f63 6f75 6e74 7328 290a  _dtype_counts().
+0002b2f0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+0002b300: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+0002b310: 0a20 2020 2064 6566 2067 6574 5f66 7479  .    def get_fty
+0002b320: 7065 5f63 6f75 6e74 7328 7365 6c66 293a  pe_counts(self):
+0002b330: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002b340: 7365 6c66 2e5f 6d65 7461 2e67 6574 5f66  self._meta.get_f
+0002b350: 7479 7065 5f63 6f75 6e74 7328 290a 0a20  type_counts().. 
+0002b360: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0002b370: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0002b380: 2020 2064 6566 2073 656c 6563 745f 6474     def select_dt
+0002b390: 7970 6573 2873 656c 662c 2069 6e63 6c75  ypes(self, inclu
+0002b3a0: 6465 3d4e 6f6e 652c 2065 7863 6c75 6465  de=None, exclude
+0002b3b0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+0002b3c0: 6373 203d 2073 656c 662e 5f6d 6574 612e  cs = self._meta.
+0002b3d0: 7365 6c65 6374 5f64 7479 7065 7328 696e  select_dtypes(in
+0002b3e0: 636c 7564 653d 696e 636c 7564 652c 2065  clude=include, e
+0002b3f0: 7863 6c75 6465 3d65 7863 6c75 6465 292e  xclude=exclude).
+0002b400: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
+0002b410: 7265 7475 726e 2073 656c 665b 6c69 7374  return self[list
+0002b420: 2863 7329 5d0a 0a20 2020 2064 6566 2073  (cs)]..    def s
+0002b430: 6f72 745f 7661 6c75 6573 280a 2020 2020  ort_values(.    
+0002b440: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0002b450: 2020 6279 3a20 7374 7220 7c20 6c69 7374    by: str | list
+0002b460: 5b73 7472 5d2c 0a20 2020 2020 2020 206e  [str],.        n
+0002b470: 7061 7274 6974 696f 6e73 3a20 696e 7420  partitions: int 
+0002b480: 7c20 4c69 7465 7261 6c5b 2261 7574 6f22  | Literal["auto"
+0002b490: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
+0002b4a0: 0a20 2020 2020 2020 2061 7363 656e 6469  .        ascendi
+0002b4b0: 6e67 3a20 626f 6f6c 203d 2054 7275 652c  ng: bool = True,
+0002b4c0: 0a20 2020 2020 2020 206e 615f 706f 7369  .        na_posi
+0002b4d0: 7469 6f6e 3a20 4c69 7465 7261 6c5b 2266  tion: Literal["f
+0002b4e0: 6972 7374 225d 207c 204c 6974 6572 616c  irst"] | Literal
+0002b4f0: 5b22 6c61 7374 225d 203d 2022 6c61 7374  ["last"] = "last
+0002b500: 222c 0a20 2020 2020 2020 2073 6f72 745f  ",.        sort_
+0002b510: 6675 6e63 7469 6f6e 3a20 4361 6c6c 6162  function: Callab
+0002b520: 6c65 5b5b 7064 2e44 6174 6146 7261 6d65  le[[pd.DataFrame
+0002b530: 5d2c 2070 642e 4461 7461 4672 616d 655d  ], pd.DataFrame]
+0002b540: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
+0002b550: 2020 2020 2020 2020 736f 7274 5f66 756e          sort_fun
+0002b560: 6374 696f 6e5f 6b77 6172 6773 3a20 4d61  ction_kwargs: Ma
+0002b570: 7070 696e 675b 7374 722c 2041 6e79 5d20  pping[str, Any] 
+0002b580: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+0002b590: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+0002b5a0: 0a20 2020 2029 202d 3e20 4461 7461 4672  .    ) -> DataFr
+0002b5b0: 616d 653a 0a20 2020 2020 2020 2022 2222  ame:.        """
+0002b5c0: 536f 7274 2074 6865 2064 6174 6173 6574  Sort the dataset
+0002b5d0: 2062 7920 6120 7369 6e67 6c65 2063 6f6c   by a single col
+0002b5e0: 756d 6e2e 0a0a 2020 2020 2020 2020 536f  umn...        So
+0002b5f0: 7274 696e 6720 6120 7061 7261 6c6c 656c  rting a parallel
+0002b600: 2064 6174 6173 6574 2072 6571 7569 7265   dataset require
+0002b610: 7320 6578 7065 6e73 6976 6520 7368 7566  s expensive shuf
+0002b620: 666c 6573 2061 6e64 2069 7320 6765 6e65  fles and is gene
+0002b630: 7261 6c6c 790a 2020 2020 2020 2020 6e6f  rally.        no
+0002b640: 7420 7265 636f 6d6d 656e 6465 642e 2053  t recommended. S
+0002b650: 6565 2060 6073 6574 5f69 6e64 6578 6060  ee ``set_index``
+0002b660: 2066 6f72 2069 6d70 6c65 6d65 6e74 6174   for implementat
+0002b670: 696f 6e20 6465 7461 696c 732e 0a0a 2020  ion details...  
+0002b680: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0002b690: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002b6a0: 2d2d 2d0a 2020 2020 2020 2020 6279 3a20  ---.        by: 
+0002b6b0: 7374 7220 6f72 206c 6973 745b 7374 725d  str or list[str]
+0002b6c0: 0a20 2020 2020 2020 2020 2020 2043 6f6c  .            Col
+0002b6d0: 756d 6e28 7329 2074 6f20 736f 7274 2062  umn(s) to sort b
+0002b6e0: 792e 0a20 2020 2020 2020 206e 7061 7274  y..        npart
+0002b6f0: 6974 696f 6e73 3a20 696e 742c 204e 6f6e  itions: int, Non
+0002b700: 652c 206f 7220 2761 7574 6f27 0a20 2020  e, or 'auto'.   
+0002b710: 2020 2020 2020 2020 2054 6865 2069 6465           The ide
+0002b720: 616c 206e 756d 6265 7220 6f66 206f 7574  al number of out
+0002b730: 7075 7420 7061 7274 6974 696f 6e73 2e20  put partitions. 
+0002b740: 4966 204e 6f6e 652c 2075 7365 2074 6865  If None, use the
+0002b750: 2073 616d 6520 6173 0a20 2020 2020 2020   same as.       
+0002b760: 2020 2020 2074 6865 2069 6e70 7574 2e20       the input. 
+0002b770: 4966 2027 6175 746f 2720 7468 656e 2064  If 'auto' then d
+0002b780: 6563 6964 6520 6279 206d 656d 6f72 7920  ecide by memory 
+0002b790: 7573 652e 0a20 2020 2020 2020 2061 7363  use..        asc
+0002b7a0: 656e 6469 6e67 3a20 626f 6f6c 2c20 6f70  ending: bool, op
+0002b7b0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+0002b7c0: 2020 2053 6f72 7420 6173 6365 6e64 696e     Sort ascendin
+0002b7d0: 6720 7673 2e20 6465 7363 656e 6469 6e67  g vs. descending
+0002b7e0: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
+0002b7f0: 6661 756c 7473 2074 6f20 5472 7565 2e0a  faults to True..
+0002b800: 2020 2020 2020 2020 6e61 5f70 6f73 6974          na_posit
+0002b810: 696f 6e3a 207b 276c 6173 7427 2c20 2766  ion: {'last', 'f
+0002b820: 6972 7374 277d 2c20 6f70 7469 6f6e 616c  irst'}, optional
+0002b830: 0a20 2020 2020 2020 2020 2020 2050 7574  .            Put
+0002b840: 7320 4e61 4e73 2061 7420 7468 6520 6265  s NaNs at the be
+0002b850: 6769 6e6e 696e 6720 6966 2027 6669 7273  ginning if 'firs
+0002b860: 7427 2c20 7075 7473 204e 614e 2061 7420  t', puts NaN at 
+0002b870: 7468 6520 656e 6420 6966 2027 6c61 7374  the end if 'last
+0002b880: 272e 0a20 2020 2020 2020 2020 2020 2044  '..            D
+0002b890: 6566 6175 6c74 7320 746f 2027 6c61 7374  efaults to 'last
+0002b8a0: 272e 0a20 2020 2020 2020 2073 6f72 745f  '..        sort_
+0002b8b0: 6675 6e63 7469 6f6e 3a20 6675 6e63 7469  function: functi
+0002b8c0: 6f6e 2c20 6f70 7469 6f6e 616c 0a20 2020  on, optional.   
+0002b8d0: 2020 2020 2020 2020 2053 6f72 7469 6e67           Sorting
+0002b8e0: 2066 756e 6374 696f 6e20 746f 2075 7365   function to use
+0002b8f0: 2077 6865 6e20 736f 7274 696e 6720 756e   when sorting un
+0002b900: 6465 726c 7969 6e67 2070 6172 7469 7469  derlying partiti
+0002b910: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
+0002b920: 2049 6620 4e6f 6e65 2c20 6465 6661 756c   If None, defaul
+0002b930: 7473 2074 6f20 6060 4d2e 736f 7274 5f76  ts to ``M.sort_v
+0002b940: 616c 7565 7360 6020 2874 6865 2070 6172  alues`` (the par
+0002b950: 7469 7469 6f6e 206c 6962 7261 7279 2773  tition library's
+0002b960: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
+0002b970: 6c65 6d65 6e74 6174 696f 6e20 6f66 2060  lementation of `
+0002b980: 6073 6f72 745f 7661 6c75 6573 6060 292e  `sort_values``).
+0002b990: 0a20 2020 2020 2020 2073 6f72 745f 6675  .        sort_fu
+0002b9a0: 6e63 7469 6f6e 5f6b 7761 7267 733a 2064  nction_kwargs: d
+0002b9b0: 6963 742c 206f 7074 696f 6e61 6c0a 2020  ict, optional.  
+0002b9c0: 2020 2020 2020 2020 2020 4164 6469 7469            Additi
+0002b9d0: 6f6e 616c 206b 6579 776f 7264 2061 7267  onal keyword arg
+0002b9e0: 756d 656e 7473 2074 6f20 7061 7373 2074  uments to pass t
+0002b9f0: 6f20 7468 6520 7061 7274 6974 696f 6e20  o the partition 
+0002ba00: 736f 7274 696e 6720 6675 6e63 7469 6f6e  sorting function
+0002ba10: 2e0a 2020 2020 2020 2020 2020 2020 4279  ..            By
+0002ba20: 2064 6566 6175 6c74 2c20 6060 6279 6060   default, ``by``
+0002ba30: 2c20 6060 6173 6365 6e64 696e 6760 602c  , ``ascending``,
+0002ba40: 2061 6e64 2060 606e 615f 706f 7369 7469   and ``na_positi
+0002ba50: 6f6e 6060 2061 7265 2070 726f 7669 6465  on`` are provide
+0002ba60: 642e 0a0a 2020 2020 2020 2020 4578 616d  d...        Exam
+0002ba70: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
+0002ba80: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
+0002ba90: 3e20 6466 3220 3d20 6466 2e73 6f72 745f  > df2 = df.sort_
+0002baa0: 7661 6c75 6573 2827 7827 2920 2023 2064  values('x')  # d
+0002bab0: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
+0002bac0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0002bad0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+0002bae0: 6672 616d 652e 7368 7566 666c 6520 696d  frame.shuffle im
+0002baf0: 706f 7274 2073 6f72 745f 7661 6c75 6573  port sort_values
+0002bb00: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0002bb10: 2073 6f72 745f 7661 6c75 6573 280a 2020   sort_values(.  
+0002bb20: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
+0002bb30: 2020 2020 2020 2020 2020 2020 6279 2c0a              by,.
+0002bb40: 2020 2020 2020 2020 2020 2020 6173 6365              asce
+0002bb50: 6e64 696e 673d 6173 6365 6e64 696e 672c  nding=ascending,
+0002bb60: 0a20 2020 2020 2020 2020 2020 206e 7061  .            npa
+0002bb70: 7274 6974 696f 6e73 3d6e 7061 7274 6974  rtitions=npartit
+0002bb80: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
+0002bb90: 2020 6e61 5f70 6f73 6974 696f 6e3d 6e61    na_position=na
+0002bba0: 5f70 6f73 6974 696f 6e2c 0a20 2020 2020  _position,.     
+0002bbb0: 2020 2020 2020 2073 6f72 745f 6675 6e63         sort_func
+0002bbc0: 7469 6f6e 3d73 6f72 745f 6675 6e63 7469  tion=sort_functi
+0002bbd0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0002bbe0: 736f 7274 5f66 756e 6374 696f 6e5f 6b77  sort_function_kw
+0002bbf0: 6172 6773 3d73 6f72 745f 6675 6e63 7469  args=sort_functi
+0002bc00: 6f6e 5f6b 7761 7267 732c 0a20 2020 2020  on_kwargs,.     
+0002bc10: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+0002bc20: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0002bc30: 6465 6620 7365 745f 696e 6465 7828 0a20  def set_index(. 
+0002bc40: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0002bc50: 2020 2020 206f 7468 6572 3a20 7374 7220       other: str 
+0002bc60: 7c20 5365 7269 6573 2c0a 2020 2020 2020  | Series,.      
+0002bc70: 2020 6472 6f70 3a20 626f 6f6c 203d 2054    drop: bool = T
+0002bc80: 7275 652c 0a20 2020 2020 2020 2073 6f72  rue,.        sor
+0002bc90: 7465 643a 2062 6f6f 6c20 3d20 4661 6c73  ted: bool = Fals
+0002bca0: 652c 0a20 2020 2020 2020 206e 7061 7274  e,.        npart
+0002bcb0: 6974 696f 6e73 3a20 696e 7420 7c20 4c69  itions: int | Li
+0002bcc0: 7465 7261 6c5b 2261 7574 6f22 5d20 7c20  teral["auto"] | 
+0002bcd0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+0002bce0: 2020 2020 2064 6976 6973 696f 6e73 3a20       divisions: 
+0002bcf0: 5365 7175 656e 6365 207c 204e 6f6e 6520  Sequence | None 
+0002bd00: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0002bd10: 696e 706c 6163 653a 2062 6f6f 6c20 3d20  inplace: bool = 
+0002bd20: 4661 6c73 652c 0a20 2020 2020 2020 202a  False,.        *
+0002bd30: 2a6b 7761 7267 732c 0a20 2020 2029 3a0a  *kwargs,.    ):.
+0002bd40: 2020 2020 2020 2020 2222 2253 6574 2074          """Set t
+0002bd50: 6865 2044 6174 6146 7261 6d65 2069 6e64  he DataFrame ind
+0002bd60: 6578 2028 726f 7720 6c61 6265 6c73 2920  ex (row labels) 
+0002bd70: 7573 696e 6720 616e 2065 7869 7374 696e  using an existin
+0002bd80: 6720 636f 6c75 6d6e 2e0a 0a20 2020 2020  g column...     
+0002bd90: 2020 2054 6869 7320 7265 616c 6967 6e73     This realigns
+0002bda0: 2074 6865 2064 6174 6173 6574 2074 6f20   the dataset to 
+0002bdb0: 6265 2073 6f72 7465 6420 6279 2061 206e  be sorted by a n
+0002bdc0: 6577 2063 6f6c 756d 6e2e 2054 6869 7320  ew column. This 
+0002bdd0: 6361 6e20 6861 7665 2061 0a20 2020 2020  can have a.     
+0002bde0: 2020 2073 6967 6e69 6669 6361 6e74 2069     significant i
+0002bdf0: 6d70 6163 7420 6f6e 2070 6572 666f 726d  mpact on perform
+0002be00: 616e 6365 2c20 6265 6361 7573 6520 6a6f  ance, because jo
+0002be10: 696e 732c 2067 726f 7570 6279 732c 206c  ins, groupbys, l
+0002be20: 6f6f 6b75 7073 2c20 6574 632e 0a20 2020  ookups, etc..   
+0002be30: 2020 2020 2061 7265 2061 6c6c 206d 7563       are all muc
+0002be40: 6820 6661 7374 6572 206f 6e20 7468 6174  h faster on that
+0002be50: 2063 6f6c 756d 6e2e 2048 6f77 6576 6572   column. However
+0002be60: 2c20 7468 6973 2070 6572 666f 726d 616e  , this performan
+0002be70: 6365 2069 6e63 7265 6173 650a 2020 2020  ce increase.    
+0002be80: 2020 2020 636f 6d65 7320 7769 7468 2061      comes with a
+0002be90: 2063 6f73 742c 2073 6f72 7469 6e67 2061   cost, sorting a
+0002bea0: 2070 6172 616c 6c65 6c20 6461 7461 7365   parallel datase
+0002beb0: 7420 7265 7175 6972 6573 2065 7870 656e  t requires expen
+0002bec0: 7369 7665 2073 6875 6666 6c65 732e 0a20  sive shuffles.. 
+0002bed0: 2020 2020 2020 204f 6674 656e 2077 6520         Often we 
+0002bee0: 6060 7365 745f 696e 6465 7860 6020 6f6e  ``set_index`` on
+0002bef0: 6365 2064 6972 6563 746c 7920 6166 7465  ce directly afte
+0002bf00: 7220 6461 7461 2069 6e67 6573 7420 616e  r data ingest an
+0002bf10: 6420 6669 6c74 6572 696e 6720 616e 640a  d filtering and.
+0002bf20: 2020 2020 2020 2020 7468 656e 2070 6572          then per
+0002bf30: 666f 726d 206d 616e 7920 6368 6561 7020  form many cheap 
+0002bf40: 636f 6d70 7574 6174 696f 6e73 206f 6666  computations off
+0002bf50: 206f 6620 7468 6520 736f 7274 6564 2064   of the sorted d
+0002bf60: 6174 6173 6574 2e0a 0a20 2020 2020 2020  ataset...       
+0002bf70: 2054 6869 7320 6675 6e63 7469 6f6e 206f   This function o
+0002bf80: 7065 7261 7465 7320 6578 6163 746c 7920  perates exactly 
+0002bf90: 6c69 6b65 2060 6070 616e 6461 732e 7365  like ``pandas.se
+0002bfa0: 745f 696e 6465 7860 6020 6578 6365 7074  t_index`` except
+0002bfb0: 2077 6974 680a 2020 2020 2020 2020 6469   with.        di
+0002bfc0: 6666 6572 656e 7420 7065 7266 6f72 6d61  fferent performa
+0002bfd0: 6e63 6520 636f 7374 7320 2864 6173 6b20  nce costs (dask 
+0002bfe0: 6461 7461 6672 616d 6520 6060 7365 745f  dataframe ``set_
+0002bff0: 696e 6465 7860 6020 6973 206d 7563 6820  index`` is much 
+0002c000: 6d6f 7265 2065 7870 656e 7369 7665 292e  more expensive).
+0002c010: 0a20 2020 2020 2020 2055 6e64 6572 206e  .        Under n
+0002c020: 6f72 6d61 6c20 6f70 6572 6174 696f 6e20  ormal operation 
+0002c030: 7468 6973 2066 756e 6374 696f 6e20 646f  this function do
+0002c040: 6573 2061 6e20 696e 6974 6961 6c20 7061  es an initial pa
+0002c050: 7373 206f 7665 7220 7468 6520 696e 6465  ss over the inde
+0002c060: 7820 636f 6c75 6d6e 0a20 2020 2020 2020  x column.       
+0002c070: 2074 6f20 636f 6d70 7574 6520 6170 7072   to compute appr
+0002c080: 6f78 696d 6174 6520 7175 616e 7469 6c65  oximate quantile
+0002c090: 7320 746f 2073 6572 7665 2061 7320 6675  s to serve as fu
+0002c0a0: 7475 7265 2064 6976 6973 696f 6e73 2e20  ture divisions. 
+0002c0b0: 4974 2074 6865 6e20 7061 7373 6573 0a20  It then passes. 
+0002c0c0: 2020 2020 2020 206f 7665 7220 7468 6520         over the 
+0002c0d0: 6461 7461 2061 2073 6563 6f6e 6420 7469  data a second ti
+0002c0e0: 6d65 2c20 7370 6c69 7474 696e 6720 7570  me, splitting up
+0002c0f0: 2065 6163 6820 696e 7075 7420 7061 7274   each input part
+0002c100: 6974 696f 6e20 696e 746f 2073 6576 6572  ition into sever
+0002c110: 616c 0a20 2020 2020 2020 2070 6965 6365  al.        piece
+0002c120: 7320 616e 6420 7368 6172 696e 6720 7468  s and sharing th
+0002c130: 6f73 6520 7069 6563 6573 2074 6f20 616c  ose pieces to al
+0002c140: 6c20 6f66 2074 6865 206f 7574 7075 7420  l of the output 
+0002c150: 7061 7274 6974 696f 6e73 206e 6f77 2069  partitions now i
+0002c160: 6e0a 2020 2020 2020 2020 736f 7274 6564  n.        sorted
+0002c170: 206f 7264 6572 2e0a 0a20 2020 2020 2020   order...       
+0002c180: 2049 6e20 736f 6d65 2063 6173 6573 2077   In some cases w
+0002c190: 6520 6361 6e20 616c 6c65 7669 6174 6520  e can alleviate 
+0002c1a0: 7468 6f73 6520 636f 7374 732c 2066 6f72  those costs, for
+0002c1b0: 2065 7861 6d70 6c65 2069 6620 796f 7572   example if your
+0002c1c0: 2064 6174 6173 6574 2069 730a 2020 2020   dataset is.    
+0002c1d0: 2020 2020 736f 7274 6564 2061 6c72 6561      sorted alrea
+0002c1e0: 6479 2074 6865 6e20 7765 2063 616e 2061  dy then we can a
+0002c1f0: 766f 6964 206d 616b 696e 6720 6d61 6e79  void making many
+0002c200: 2073 6d61 6c6c 2070 6965 6365 7320 6f72   small pieces or
+0002c210: 2069 6620 796f 7520 6b6e 6f77 0a20 2020   if you know.   
+0002c220: 2020 2020 2067 6f6f 6420 7661 6c75 6573       good values
+0002c230: 2074 6f20 7370 6c69 7420 7468 6520 6e65   to split the ne
+0002c240: 7720 696e 6465 7820 636f 6c75 6d6e 2074  w index column t
+0002c250: 6865 6e20 7765 2063 616e 2061 766f 6964  hen we can avoid
+0002c260: 2074 6865 2069 6e69 7469 616c 0a20 2020   the initial.   
+0002c270: 2020 2020 2070 6173 7320 6f76 6572 2074       pass over t
+0002c280: 6865 2064 6174 612e 2046 6f72 2065 7861  he data. For exa
+0002c290: 6d70 6c65 2069 6620 796f 7572 206e 6577  mple if your new
+0002c2a0: 2069 6e64 6578 2069 7320 6120 6461 7465   index is a date
+0002c2b0: 7469 6d65 2069 6e64 6578 2061 6e64 0a20  time index and. 
+0002c2c0: 2020 2020 2020 2079 6f75 7220 6461 7461         your data
+0002c2d0: 2069 7320 616c 7265 6164 7920 736f 7274   is already sort
+0002c2e0: 6564 2062 7920 6461 7920 7468 656e 2074  ed by day then t
+0002c2f0: 6869 7320 656e 7469 7265 206f 7065 7261  his entire opera
+0002c300: 7469 6f6e 2063 616e 2062 6520 646f 6e65  tion can be done
+0002c310: 0a20 2020 2020 2020 2066 6f72 2066 7265  .        for fre
+0002c320: 652e 2059 6f75 2063 616e 2063 6f6e 7472  e. You can contr
+0002c330: 6f6c 2074 6865 7365 206f 7074 696f 6e73  ol these options
+0002c340: 2077 6974 6820 7468 6520 666f 6c6c 6f77   with the follow
+0002c350: 696e 6720 7061 7261 6d65 7465 7273 2e0a  ing parameters..
+0002c360: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0002c370: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0002c380: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206f  ------.        o
+0002c390: 7468 6572 3a20 7374 7269 6e67 206f 7220  ther: string or 
+0002c3a0: 4461 736b 2053 6572 6965 730a 2020 2020  Dask Series.    
+0002c3b0: 2020 2020 2020 2020 436f 6c75 6d6e 2074          Column t
+0002c3c0: 6f20 7573 6520 6173 2069 6e64 6578 2e0a  o use as index..
+0002c3d0: 2020 2020 2020 2020 6472 6f70 3a20 626f          drop: bo
+0002c3e0: 6f6c 6561 6e2c 2064 6566 6175 6c74 2054  olean, default T
+0002c3f0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+0002c400: 4465 6c65 7465 2063 6f6c 756d 6e20 746f  Delete column to
+0002c410: 2062 6520 7573 6564 2061 7320 7468 6520   be used as the 
+0002c420: 6e65 7720 696e 6465 782e 0a20 2020 2020  new index..     
+0002c430: 2020 2073 6f72 7465 643a 2062 6f6f 6c2c     sorted: bool,
+0002c440: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0002c450: 2020 2020 2020 4966 2074 6865 2069 6e64        If the ind
+0002c460: 6578 2063 6f6c 756d 6e20 6973 2061 6c72  ex column is alr
+0002c470: 6561 6479 2073 6f72 7465 6420 696e 2069  eady sorted in i
+0002c480: 6e63 7265 6173 696e 6720 6f72 6465 722e  ncreasing order.
+0002c490: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
+0002c4a0: 6175 6c74 7320 746f 2046 616c 7365 0a20  aults to False. 
+0002c4b0: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
+0002c4c0: 6e73 3a20 696e 742c 204e 6f6e 652c 206f  ns: int, None, o
+0002c4d0: 7220 2761 7574 6f27 0a20 2020 2020 2020  r 'auto'.       
+0002c4e0: 2020 2020 2054 6865 2069 6465 616c 206e       The ideal n
+0002c4f0: 756d 6265 7220 6f66 206f 7574 7075 7420  umber of output 
+0002c500: 7061 7274 6974 696f 6e73 2e20 4966 204e  partitions. If N
+0002c510: 6f6e 652c 2075 7365 2074 6865 2073 616d  one, use the sam
+0002c520: 6520 6173 0a20 2020 2020 2020 2020 2020  e as.           
+0002c530: 2074 6865 2069 6e70 7574 2e20 4966 2027   the input. If '
+0002c540: 6175 746f 2720 7468 656e 2064 6563 6964  auto' then decid
+0002c550: 6520 6279 206d 656d 6f72 7920 7573 652e  e by memory use.
+0002c560: 0a20 2020 2020 2020 2020 2020 204f 6e6c  .            Onl
+0002c570: 7920 7573 6564 2077 6865 6e20 6060 6469  y used when ``di
+0002c580: 7669 7369 6f6e 7360 6020 6973 206e 6f74  visions`` is not
+0002c590: 2067 6976 656e 2e20 4966 2060 6064 6976   given. If ``div
+0002c5a0: 6973 696f 6e73 6060 2069 7320 6769 7665  isions`` is give
+0002c5b0: 6e2c 0a20 2020 2020 2020 2020 2020 2074  n,.            t
+0002c5c0: 6865 206e 756d 6265 7220 6f66 206f 7574  he number of out
+0002c5d0: 7075 7420 7061 7274 6974 696f 6e73 2077  put partitions w
+0002c5e0: 696c 6c20 6265 2060 606c 656e 2864 6976  ill be ``len(div
+0002c5f0: 6973 696f 6e73 2920 2d20 3160 602e 0a20  isions) - 1``.. 
+0002c600: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+0002c610: 3a20 6c69 7374 2c20 6f70 7469 6f6e 616c  : list, optional
+0002c620: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+0002c630: 2022 6469 7669 6469 6e67 206c 696e 6573   "dividing lines
+0002c640: 2220 7573 6564 2074 6f20 7370 6c69 7420  " used to split 
+0002c650: 7468 6520 6e65 7720 696e 6465 7820 696e  the new index in
+0002c660: 746f 2070 6172 7469 7469 6f6e 732e 0a20  to partitions.. 
+0002c670: 2020 2020 2020 2020 2020 2046 6f72 2060             For `
+0002c680: 6064 6976 6973 696f 6e73 3d5b 302c 2031  `divisions=[0, 1
+0002c690: 302c 2035 302c 2031 3030 5d60 602c 2074  0, 50, 100]``, t
+0002c6a0: 6865 7265 2077 6f75 6c64 2062 6520 7468  here would be th
+0002c6b0: 7265 6520 6f75 7470 7574 2070 6172 7469  ree output parti
+0002c6c0: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+0002c6d0: 2020 2077 6865 7265 2074 6865 206e 6577     where the new
+0002c6e0: 2069 6e64 6578 2063 6f6e 7461 696e 6564   index contained
+0002c6f0: 205b 302c 2031 3029 2c20 5b31 302c 2035   [0, 10), [10, 5
+0002c700: 3029 2c20 616e 6420 5b35 302c 2031 3030  0), and [50, 100
+0002c710: 292c 2072 6573 7065 6374 6976 656c 792e  ), respectively.
+0002c720: 0a20 2020 2020 2020 2020 2020 2053 6565  .            See
+0002c730: 2068 7474 7073 3a2f 2f64 6f63 732e 6461   https://docs.da
+0002c740: 736b 2e6f 7267 2f65 6e2f 6c61 7465 7374  sk.org/en/latest
+0002c750: 2f64 6174 6166 7261 6d65 2d64 6573 6967  /dataframe-desig
+0002c760: 6e2e 6874 6d6c 2370 6172 7469 7469 6f6e  n.html#partition
+0002c770: 732e 0a20 2020 2020 2020 2020 2020 2049  s..            I
+0002c780: 6620 6e6f 7420 6769 7665 6e20 2864 6566  f not given (def
+0002c790: 6175 6c74 292c 2067 6f6f 6420 6469 7669  ault), good divi
+0002c7a0: 7369 6f6e 7320 6172 6520 6361 6c63 756c  sions are calcul
+0002c7b0: 6174 6564 2062 7920 696d 6d65 6469 6174  ated by immediat
+0002c7c0: 656c 7920 636f 6d70 7574 696e 670a 2020  ely computing.  
+0002c7d0: 2020 2020 2020 2020 2020 7468 6520 6461            the da
+0002c7e0: 7461 2061 6e64 206c 6f6f 6b69 6e67 2061  ta and looking a
+0002c7f0: 7420 7468 6520 6469 7374 7269 6275 7469  t the distributi
+0002c800: 6f6e 206f 6620 6974 7320 7661 6c75 6573  on of its values
+0002c810: 2e20 466f 7220 6c61 7267 6520 6461 7461  . For large data
+0002c820: 7365 7473 2c0a 2020 2020 2020 2020 2020  sets,.          
+0002c830: 2020 7468 6973 2063 616e 2062 6520 6578    this can be ex
+0002c840: 7065 6e73 6976 652e 0a20 2020 2020 2020  pensive..       
+0002c850: 2020 2020 204e 6f74 6520 7468 6174 2069       Note that i
+0002c860: 6620 6060 736f 7274 6564 3d54 7275 6560  f ``sorted=True`
+0002c870: 602c 2073 7065 6369 6669 6564 2064 6976  `, specified div
+0002c880: 6973 696f 6e73 2061 7265 2061 7373 756d  isions are assum
+0002c890: 6564 2074 6f20 6d61 7463 680a 2020 2020  ed to match.    
+0002c8a0: 2020 2020 2020 2020 7468 6520 6578 6973          the exis
+0002c8b0: 7469 6e67 2070 6172 7469 7469 6f6e 7320  ting partitions 
+0002c8c0: 696e 2074 6865 2064 6174 613b 2069 6620  in the data; if 
+0002c8d0: 7468 6973 2069 7320 756e 7472 7565 2079  this is untrue y
+0002c8e0: 6f75 2073 686f 756c 640a 2020 2020 2020  ou should.      
+0002c8f0: 2020 2020 2020 6c65 6176 6520 6469 7669        leave divi
+0002c900: 7369 6f6e 7320 656d 7074 7920 616e 6420  sions empty and 
+0002c910: 6361 6c6c 2060 6072 6570 6172 7469 7469  call ``repartiti
+0002c920: 6f6e 6060 2061 6674 6572 2060 6073 6574  on`` after ``set
+0002c930: 5f69 6e64 6578 6060 2e0a 2020 2020 2020  _index``..      
+0002c940: 2020 696e 706c 6163 653a 2062 6f6f 6c2c    inplace: bool,
+0002c950: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0002c960: 2020 2020 2020 4d6f 6469 6679 696e 6720        Modifying 
+0002c970: 7468 6520 4461 7461 4672 616d 6520 696e  the DataFrame in
+0002c980: 2070 6c61 6365 2069 7320 6e6f 7420 7375   place is not su
+0002c990: 7070 6f72 7465 6420 6279 2044 6173 6b2e  pported by Dask.
+0002c9a0: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
+0002c9b0: 6175 6c74 7320 746f 2046 616c 7365 2e0a  aults to False..
+0002c9c0: 2020 2020 2020 2020 7368 7566 666c 653a          shuffle:
+0002c9d0: 2073 7472 696e 672c 2027 6469 736b 2720   string, 'disk' 
+0002c9e0: 6f72 2027 7461 736b 7327 2c20 6f70 7469  or 'tasks', opti
+0002c9f0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+0002ca00: 2045 6974 6865 7220 6060 2764 6973 6b27   Either ``'disk'
+0002ca10: 6060 2066 6f72 2073 696e 676c 652d 6e6f  `` for single-no
+0002ca20: 6465 206f 7065 7261 7469 6f6e 206f 7220  de operation or 
+0002ca30: 6060 2774 6173 6b73 2760 6020 666f 720a  ``'tasks'`` for.
+0002ca40: 2020 2020 2020 2020 2020 2020 6469 7374              dist
+0002ca50: 7269 6275 7465 6420 6f70 6572 6174 696f  ributed operatio
+0002ca60: 6e2e 2020 5769 6c6c 2062 6520 696e 6665  n.  Will be infe
+0002ca70: 7272 6564 2062 7920 796f 7572 2063 7572  rred by your cur
+0002ca80: 7265 6e74 2073 6368 6564 756c 6572 2e0a  rent scheduler..
+0002ca90: 2020 2020 2020 2020 636f 6d70 7574 653a          compute:
+0002caa0: 2062 6f6f 6c2c 2064 6566 6175 6c74 2046   bool, default F
+0002cab0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+0002cac0: 2057 6865 7468 6572 206f 7220 6e6f 7420   Whether or not 
+0002cad0: 746f 2074 7269 6767 6572 2061 6e20 696d  to trigger an im
+0002cae0: 6d65 6469 6174 6520 636f 6d70 7574 6174  mediate computat
+0002caf0: 696f 6e2e 2044 6566 6175 6c74 7320 746f  ion. Defaults to
+0002cb00: 2046 616c 7365 2e0a 2020 2020 2020 2020   False..        
+0002cb10: 2020 2020 4e6f 7465 2c20 7468 6174 2065      Note, that e
+0002cb20: 7665 6e20 6966 2079 6f75 2073 6574 2060  ven if you set `
+0002cb30: 6063 6f6d 7075 7465 3d46 616c 7365 6060  `compute=False``
+0002cb40: 2c20 616e 2069 6d6d 6564 6961 7465 2063  , an immediate c
+0002cb50: 6f6d 7075 7461 7469 6f6e 0a20 2020 2020  omputation.     
+0002cb60: 2020 2020 2020 2077 696c 6c20 7374 696c         will stil
+0002cb70: 6c20 6265 2074 7269 6767 6572 6564 2069  l be triggered i
+0002cb80: 6620 6060 6469 7669 7369 6f6e 7360 6020  f ``divisions`` 
+0002cb90: 6973 2060 604e 6f6e 6560 602e 0a20 2020  is ``None``..   
+0002cba0: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
+0002cbb0: 697a 653a 2069 6e74 2c20 6f70 7469 6f6e  ize: int, option
+0002cbc0: 616c 0a20 2020 2020 2020 2020 2020 2044  al.            D
+0002cbd0: 6573 6972 6564 2073 697a 6520 6f66 2065  esired size of e
+0002cbe0: 6163 6820 7061 7274 6974 696f 6e73 2069  ach partitions i
+0002cbf0: 6e20 6279 7465 732e 0a20 2020 2020 2020  n bytes..       
+0002cc00: 2020 2020 204f 6e6c 7920 7573 6564 2077       Only used w
+0002cc10: 6865 6e20 6060 6e70 6172 7469 7469 6f6e  hen ``npartition
+0002cc20: 733d 2761 7574 6f27 6060 0a0a 2020 2020  s='auto'``..    
+0002cc30: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+0002cc40: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+0002cc50: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+0002cc60: 2064 6173 6b0a 2020 2020 2020 2020 3e3e   dask.        >>
+0002cc70: 3e20 6464 6620 3d20 6461 736b 2e64 6174  > ddf = dask.dat
+0002cc80: 6173 6574 732e 7469 6d65 7365 7269 6573  asets.timeseries
+0002cc90: 2873 7461 7274 3d22 3230 3231 2d30 312d  (start="2021-01-
+0002cca0: 3031 222c 2065 6e64 3d22 3230 3231 2d30  01", end="2021-0
+0002ccb0: 312d 3037 222c 2066 7265 713d 2231 4822  1-07", freq="1H"
+0002ccc0: 292e 7265 7365 745f 696e 6465 7828 290a  ).reset_index().
+0002ccd0: 2020 2020 2020 2020 3e3e 3e20 6464 6632          >>> ddf2
+0002cce0: 203d 2064 6466 2e73 6574 5f69 6e64 6578   = ddf.set_index
+0002ccf0: 2822 7822 290a 2020 2020 2020 2020 3e3e  ("x").        >>
+0002cd00: 3e20 6464 6632 203d 2064 6466 2e73 6574  > ddf2 = ddf.set
+0002cd10: 5f69 6e64 6578 2864 6466 2e78 290a 2020  _index(ddf.x).  
+0002cd20: 2020 2020 2020 3e3e 3e20 6464 6632 203d        >>> ddf2 =
+0002cd30: 2064 6466 2e73 6574 5f69 6e64 6578 2864   ddf.set_index(d
+0002cd40: 6466 2e74 696d 6573 7461 6d70 2c20 736f  df.timestamp, so
+0002cd50: 7274 6564 3d54 7275 6529 0a0a 2020 2020  rted=True)..    
+0002cd60: 2020 2020 4120 636f 6d6d 6f6e 2063 6173      A common cas
+0002cd70: 6520 6973 2077 6865 6e20 7765 2068 6176  e is when we hav
+0002cd80: 6520 6120 6461 7465 7469 6d65 2063 6f6c  e a datetime col
+0002cd90: 756d 6e20 7468 6174 2077 6520 6b6e 6f77  umn that we know
+0002cda0: 2074 6f20 6265 0a20 2020 2020 2020 2073   to be.        s
+0002cdb0: 6f72 7465 6420 616e 6420 6973 2063 6c65  orted and is cle
+0002cdc0: 616e 6c79 2064 6976 6964 6564 2062 7920  anly divided by 
+0002cdd0: 6461 792e 2020 5765 2063 616e 2073 6574  day.  We can set
+0002cde0: 2074 6869 7320 696e 6465 7820 666f 7220   this index for 
+0002cdf0: 6672 6565 0a20 2020 2020 2020 2062 7920  free.        by 
+0002ce00: 7370 6563 6966 7969 6e67 2062 6f74 6820  specifying both 
+0002ce10: 7468 6174 2074 6865 2063 6f6c 756d 6e20  that the column 
+0002ce20: 6973 2070 7265 2d73 6f72 7465 6420 616e  is pre-sorted an
+0002ce30: 6420 7468 6520 7061 7274 6963 756c 6172  d the particular
+0002ce40: 0a20 2020 2020 2020 2064 6976 6973 696f  .        divisio
+0002ce50: 6e73 2061 6c6f 6e67 2077 6869 6368 2069  ns along which i
+0002ce60: 7320 6973 2073 6570 6172 6174 6564 0a0a  s is separated..
+0002ce70: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+0002ce80: 7274 2070 616e 6461 7320 6173 2070 640a  rt pandas as pd.
+0002ce90: 2020 2020 2020 2020 3e3e 3e20 6469 7669          >>> divi
+0002cea0: 7369 6f6e 7320 3d20 7064 2e64 6174 655f  sions = pd.date_
+0002ceb0: 7261 6e67 6528 7374 6172 743d 2232 3032  range(start="202
+0002cec0: 312d 3031 2d30 3122 2c20 656e 643d 2232  1-01-01", end="2
+0002ced0: 3032 312d 3031 2d30 3722 2c20 6672 6571  021-01-07", freq
+0002cee0: 3d27 3144 2729 0a20 2020 2020 2020 203e  ='1D').        >
+0002cef0: 3e3e 2064 6976 6973 696f 6e73 0a20 2020  >> divisions.   
+0002cf00: 2020 2020 2044 6174 6574 696d 6549 6e64       DatetimeInd
+0002cf10: 6578 285b 2732 3032 312d 3031 2d30 3127  ex(['2021-01-01'
+0002cf20: 2c20 2732 3032 312d 3031 2d30 3227 2c20  , '2021-01-02', 
+0002cf30: 2732 3032 312d 3031 2d30 3327 2c20 2732  '2021-01-03', '2
+0002cf40: 3032 312d 3031 2d30 3427 2c0a 2020 2020  021-01-04',.    
+0002cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cf60: 2020 2027 3230 3231 2d30 312d 3035 272c     '2021-01-05',
+0002cf70: 2027 3230 3231 2d30 312d 3036 272c 2027   '2021-01-06', '
+0002cf80: 3230 3231 2d30 312d 3037 275d 2c0a 2020  2021-01-07'],.  
+0002cf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cfa0: 2020 2020 6474 7970 653d 2764 6174 6574      dtype='datet
+0002cfb0: 696d 6536 345b 6e73 5d27 2c20 6672 6571  ime64[ns]', freq
+0002cfc0: 3d27 4427 290a 0a20 2020 2020 2020 204e  ='D')..        N
+0002cfd0: 6f74 6520 7468 6174 2060 606c 656e 2864  ote that ``len(d
+0002cfe0: 6976 6973 6f6e 7329 6060 2069 7320 6571  ivisons)`` is eq
+0002cff0: 7561 6c20 746f 2060 606e 7061 7274 6974  ual to ``npartit
+0002d000: 696f 6e73 202b 2031 6060 2e20 5468 6973  ions + 1``. This
+0002d010: 2069 7320 6265 6361 7573 6520 6060 6469   is because ``di
+0002d020: 7669 7369 6f6e 7360 600a 2020 2020 2020  visions``.      
+0002d030: 2020 7265 7072 6573 656e 7473 2074 6865    represents the
+0002d040: 2075 7070 6572 2061 6e64 206c 6f77 6572   upper and lower
+0002d050: 2062 6f75 6e64 7320 6f66 2065 6163 6820   bounds of each 
+0002d060: 7061 7274 6974 696f 6e2e 2054 6865 2066  partition. The f
+0002d070: 6972 7374 2069 7465 6d20 6973 2074 6865  irst item is the
+0002d080: 0a20 2020 2020 2020 206c 6f77 6572 2062  .        lower b
+0002d090: 6f75 6e64 206f 6620 7468 6520 6669 7273  ound of the firs
+0002d0a0: 7420 7061 7274 6974 696f 6e2c 2074 6865  t partition, the
+0002d0b0: 2073 6563 6f6e 6420 6974 656d 2069 7320   second item is 
+0002d0c0: 7468 6520 6c6f 7765 7220 626f 756e 6420  the lower bound 
+0002d0d0: 6f66 2074 6865 0a20 2020 2020 2020 2073  of the.        s
+0002d0e0: 6563 6f6e 6420 7061 7274 6974 696f 6e20  econd partition 
+0002d0f0: 616e 6420 7468 6520 7570 7065 7220 626f  and the upper bo
+0002d100: 756e 6420 6f66 2074 6865 2066 6972 7374  und of the first
+0002d110: 2070 6172 7469 7469 6f6e 2c20 616e 6420   partition, and 
+0002d120: 736f 206f 6e2e 0a20 2020 2020 2020 2054  so on..        T
+0002d130: 6865 2073 6563 6f6e 642d 746f 2d6c 6173  he second-to-las
+0002d140: 7420 6974 656d 2069 7320 7468 6520 6c6f  t item is the lo
+0002d150: 7765 7220 626f 756e 6420 6f66 2074 6865  wer bound of the
+0002d160: 206c 6173 7420 7061 7274 6974 696f 6e2c   last partition,
+0002d170: 2061 6e64 2074 6865 206c 6173 740a 2020   and the last.  
+0002d180: 2020 2020 2020 2865 7874 7261 2920 6974        (extra) it
+0002d190: 656d 2069 7320 7468 6520 7570 7065 7220  em is the upper 
+0002d1a0: 626f 756e 6420 6f66 2074 6865 206c 6173  bound of the las
+0002d1b0: 7420 7061 7274 6974 696f 6e2e 0a0a 2020  t partition...  
+0002d1c0: 2020 2020 2020 3e3e 3e20 6464 6632 203d        >>> ddf2 =
+0002d1d0: 2064 6466 2e73 6574 5f69 6e64 6578 2822   ddf.set_index("
+0002d1e0: 7469 6d65 7374 616d 7022 2c20 736f 7274  timestamp", sort
+0002d1f0: 6564 3d54 7275 652c 2064 6976 6973 696f  ed=True, divisio
+0002d200: 6e73 3d64 6976 6973 696f 6e73 2e74 6f6c  ns=divisions.tol
+0002d210: 6973 7428 2929 0a0a 2020 2020 2020 2020  ist())..        
+0002d220: 4966 2079 6f75 276c 6c20 6265 2072 756e  If you'll be run
+0002d230: 6e69 6e67 2060 7365 745f 696e 6465 7860  ning `set_index`
+0002d240: 206f 6e20 7468 6520 7361 6d65 2028 6f72   on the same (or
+0002d250: 2073 696d 696c 6172 2920 6461 7461 7365   similar) datase
+0002d260: 7473 2072 6570 6561 7465 646c 792c 0a20  ts repeatedly,. 
+0002d270: 2020 2020 2020 2079 6f75 2063 6f75 6c64         you could
+0002d280: 2073 6176 6520 7469 6d65 2062 7920 6c65   save time by le
+0002d290: 7474 696e 6720 4461 736b 2063 616c 6375  tting Dask calcu
+0002d2a0: 6c61 7465 2067 6f6f 6420 6469 7669 7369  late good divisi
+0002d2b0: 6f6e 7320 6f6e 6365 2c20 7468 656e 2063  ons once, then c
+0002d2c0: 6f70 792d 7061 7374 696e 670a 2020 2020  opy-pasting.    
+0002d2d0: 2020 2020 7468 656d 2074 6f20 7265 7573      them to reus
+0002d2e0: 652e 2054 6869 7320 6973 2065 7370 6563  e. This is espec
+0002d2f0: 6961 6c6c 7920 6865 6c70 6675 6c20 7275  ially helpful ru
+0002d300: 6e6e 696e 6720 696e 2061 204a 7570 7974  nning in a Jupyt
+0002d310: 6572 206e 6f74 6562 6f6f 6b3a 0a0a 2020  er notebook:..  
+0002d320: 2020 2020 2020 3e3e 3e20 6464 6632 203d        >>> ddf2 =
+0002d330: 2064 6466 2e73 6574 5f69 6e64 6578 2822   ddf.set_index("
+0002d340: 6e61 6d65 2229 2020 2320 736c 6f77 2c20  name")  # slow, 
+0002d350: 6361 6c63 756c 6174 6573 2064 6174 6120  calculates data 
+0002d360: 6469 7374 7269 6275 7469 6f6e 0a20 2020  distribution.   
+0002d370: 2020 2020 203e 3e3e 2064 6466 322e 6469       >>> ddf2.di
+0002d380: 7669 7369 6f6e 7320 2023 2064 6f63 7465  visions  # docte
+0002d390: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
+0002d3a0: 2020 5b22 416c 6963 6522 2c20 224c 6175    ["Alice", "Lau
+0002d3b0: 7261 222c 2022 5572 7375 6c61 222c 2022  ra", "Ursula", "
+0002d3c0: 5a65 6c64 6122 5d0a 2020 2020 2020 2020  Zelda"].        
+0002d3d0: 3e3e 3e20 2320 5e20 4e6f 7720 636f 7079  >>> # ^ Now copy
+0002d3e0: 2d70 6173 7465 2074 6869 7320 616e 6420  -paste this and 
+0002d3f0: 6564 6974 2074 6865 206c 696e 6520 6162  edit the line ab
+0002d400: 6f76 6520 746f 3a0a 2020 2020 2020 2020  ove to:.        
+0002d410: 3e3e 3e20 2320 6464 6632 203d 2064 6466  >>> # ddf2 = ddf
+0002d420: 2e73 6574 5f69 6e64 6578 2822 6e61 6d65  .set_index("name
+0002d430: 222c 2064 6976 6973 696f 6e73 3d5b 2241  ", divisions=["A
+0002d440: 6c69 6365 222c 2022 4c61 7572 6122 2c20  lice", "Laura", 
+0002d450: 2255 7273 756c 6122 2c20 225a 656c 6461  "Ursula", "Zelda
+0002d460: 225d 290a 2020 2020 2020 2020 2222 220a  "]).        """.
+0002d470: 0a20 2020 2020 2020 2069 6620 696e 706c  .        if inpl
+0002d480: 6163 653a 0a20 2020 2020 2020 2020 2020  ace:.           
+0002d490: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+0002d4a0: 656e 7465 6445 7272 6f72 2822 5468 6520  entedError("The 
+0002d4b0: 696e 706c 6163 653d 206b 6579 776f 7264  inplace= keyword
+0002d4c0: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
+0002d4d0: 6422 290a 2020 2020 2020 2020 7072 655f  d").        pre_
+0002d4e0: 736f 7274 6564 203d 2073 6f72 7465 640a  sorted = sorted.
+0002d4f0: 2020 2020 2020 2020 6465 6c20 736f 7274          del sort
+0002d500: 6564 0a0a 2020 2020 2020 2020 2320 4368  ed..        # Ch
+0002d510: 6563 6b20 6f74 6865 7220 6361 6e20 6265  eck other can be
+0002d520: 2074 7261 6e73 6c61 7465 6420 746f 2063   translated to c
+0002d530: 6f6c 756d 6e20 6e61 6d65 206f 7220 636f  olumn name or co
+0002d540: 6c75 6d6e 206f 626a 6563 742c 2070 6f73  lumn object, pos
+0002d550: 7369 626c 7920 666c 6174 7465 6e69 6e67  sibly flattening
+0002d560: 2069 740a 2020 2020 2020 2020 6966 206e   it.        if n
+0002d570: 6f74 2069 7369 6e73 7461 6e63 6528 6f74  ot isinstance(ot
+0002d580: 6865 722c 2073 7472 293a 0a20 2020 2020  her, str):.     
+0002d590: 2020 2020 2020 2023 2049 7420 6d61 7920         # It may 
+0002d5a0: 7265 6665 7220 746f 2073 6576 6572 616c  refer to several
+0002d5b0: 2063 6f6c 756d 6e73 0a20 2020 2020 2020   columns.       
+0002d5c0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0002d5d0: 6365 286f 7468 6572 2c20 5365 7175 656e  ce(other, Sequen
+0002d5e0: 6365 293a 2020 2320 7479 7065 3a20 6967  ce):  # type: ig
+0002d5f0: 6e6f 7265 5b75 6e72 6561 6368 6162 6c65  nore[unreachable
+0002d600: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0002d610: 2020 2320 4163 6365 7074 205b 2261 225d    # Accept ["a"]
+0002d620: 2c20 6275 7420 6e6f 7420 5b5b 2261 225d  , but not [["a"]
+0002d630: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0002d640: 2020 6966 206c 656e 286f 7468 6572 2920    if len(other) 
+0002d650: 3d3d 2031 2061 6e64 2028 2020 2320 7479  == 1 and (  # ty
+0002d660: 7065 3a20 6967 6e6f 7265 5b75 6e72 6561  pe: ignore[unrea
+0002d670: 6368 6162 6c65 5d0a 2020 2020 2020 2020  chable].        
+0002d680: 2020 2020 2020 2020 2020 2020 6973 696e              isin
+0002d690: 7374 616e 6365 286f 7468 6572 5b30 5d2c  stance(other[0],
+0002d6a0: 2073 7472 2920 6f72 206e 6f74 2069 7369   str) or not isi
+0002d6b0: 6e73 7461 6e63 6528 6f74 6865 725b 305d  nstance(other[0]
+0002d6c0: 2c20 5365 7175 656e 6365 290a 2020 2020  , Sequence).    
+0002d6d0: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
+0002d6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d6f0: 2020 206f 7468 6572 203d 206f 7468 6572     other = other
+0002d700: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+0002d710: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002d720: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0002d730: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+0002d740: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
+0002d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d760: 2022 4461 736b 2064 6174 6166 7261 6d65   "Dask dataframe
+0002d770: 2064 6f65 7320 6e6f 7420 7965 7420 7375   does not yet su
+0002d780: 7070 6f72 7420 6d75 6c74 692d 696e 6465  pport multi-inde
+0002d790: 7865 732e 5c6e 220a 2020 2020 2020 2020  xes.\n".        
+0002d7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d7b0: 6622 596f 7520 7472 6965 6420 746f 2069  f"You tried to i
+0002d7c0: 6e64 6578 2077 6974 6820 7468 6973 2069  ndex with this i
+0002d7d0: 6e64 6578 3a20 7b6f 7468 6572 7d5c 6e22  ndex: {other}\n"
+0002d7e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d7f0: 2020 2020 2020 2020 2022 496e 6465 7865           "Indexe
+0002d800: 7320 6d75 7374 2062 6520 7369 6e67 6c65  s must be single
+0002d810: 2063 6f6c 756d 6e73 206f 6e6c 792e 220a   columns only.".
+0002d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d830: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+0002d840: 2020 2023 204f 7220 6265 2061 2066 7261     # Or be a fra
+0002d850: 6d65 2064 6972 6563 746c 790a 2020 2020  me directly.    
+0002d860: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+0002d870: 6e73 7461 6e63 6528 6f74 6865 722c 2044  nstance(other, D
+0002d880: 6174 6146 7261 6d65 293a 2020 2320 7479  ataFrame):  # ty
+0002d890: 7065 3a20 6967 6e6f 7265 5b75 6e72 6561  pe: ignore[unrea
+0002d8a0: 6368 6162 6c65 5d0a 2020 2020 2020 2020  chable].        
+0002d8b0: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+0002d8c0: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+0002d8d0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0002d8e0: 2020 2020 2020 2022 4461 736b 2064 6174         "Dask dat
+0002d8f0: 6166 7261 6d65 2064 6f65 7320 6e6f 7420  aframe does not 
+0002d900: 7965 7420 7375 7070 6f72 7420 6d75 6c74  yet support mult
+0002d910: 692d 696e 6465 7865 732e 5c6e 220a 2020  i-indexes.\n".  
+0002d920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d930: 2020 6622 596f 7520 7472 6965 6420 746f    f"You tried to
+0002d940: 2069 6e64 6578 2077 6974 6820 6120 6672   index with a fr
+0002d950: 616d 6520 7769 7468 2074 6865 7365 2063  ame with these c
+0002d960: 6f6c 756d 6e73 3a20 7b6c 6973 7428 6f74  olumns: {list(ot
+0002d970: 6865 722e 636f 6c75 6d6e 7329 7d5c 6e22  her.columns)}\n"
+0002d980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d990: 2020 2020 2022 496e 6465 7865 7320 6d75       "Indexes mu
+0002d9a0: 7374 2062 6520 7369 6e67 6c65 2063 6f6c  st be single col
+0002d9b0: 756d 6e73 206f 6e6c 792e 220a 2020 2020  umns only.".    
+0002d9c0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0002d9d0: 2020 2020 2020 2023 2049 6620 616c 7265         # If alre
+0002d9e0: 6164 7920 6120 7365 7269 6573 0a20 2020  ady a series.   
+0002d9f0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0002da00: 6365 286f 7468 6572 2c20 5365 7269 6573  ce(other, Series
+0002da10: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
+0002da20: 2049 6620 6974 2773 2061 6c72 6561 6479   If it's already
+0002da30: 2074 6865 2069 6e64 6578 2c20 7468 6572   the index, ther
+0002da40: 6527 7320 6e6f 7468 696e 6720 746f 2064  e's nothing to d
+0002da50: 6f0a 2020 2020 2020 2020 2020 2020 6966  o.            if
+0002da60: 206f 7468 6572 2e5f 6e61 6d65 203d 3d20   other._name == 
+0002da70: 7365 6c66 2e69 6e64 6578 2e5f 6e61 6d65  self.index._name
+0002da80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002da90: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+0002daa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002dab0: 2020 2020 2022 4e65 7720 696e 6465 7820       "New index 
+0002dac0: 6861 7320 7361 6d65 206e 616d 6520 6173  has same name as
+0002dad0: 2065 7869 7374 696e 672c 2074 6869 7320   existing, this 
+0002dae0: 6973 2061 206e 6f2d 6f70 2e22 2c20 5573  is a no-op.", Us
+0002daf0: 6572 5761 726e 696e 670a 2020 2020 2020  erWarning.      
+0002db00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0002db10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002db20: 726e 2073 656c 660a 0a20 2020 2020 2020  rn self..       
+0002db30: 2023 2049 6620 7468 6520 6e61 6d65 206f   # If the name o
+0002db40: 6620 6120 636f 6c75 6d6e 2f69 6e64 6578  f a column/index
+0002db50: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0002db60: 2020 2020 2020 2020 2020 2023 2057 6974             # Wit
+0002db70: 6820 7468 6520 7361 6d65 206e 616d 6520  h the same name 
+0002db80: 6173 2074 6865 2069 6e64 6578 2c20 7468  as the index, th
+0002db90: 6572 6527 7320 6e6f 7468 696e 6720 746f  ere's nothing to
+0002dba0: 2064 6f20 6569 7468 6572 0a20 2020 2020   do either.     
+0002dbb0: 2020 2020 2020 2069 6620 6f74 6865 7220         if other 
+0002dbc0: 3d3d 2073 656c 662e 696e 6465 782e 6e61  == self.index.na
+0002dbd0: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
+0002dbe0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+0002dbf0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+0002dc00: 2020 2020 2020 2022 4e65 7720 696e 6465         "New inde
+0002dc10: 7820 6861 7320 7361 6d65 206e 616d 6520  x has same name 
+0002dc20: 6173 2065 7869 7374 696e 672c 2074 6869  as existing, thi
+0002dc30: 7320 6973 2061 206e 6f2d 6f70 2e22 2c20  s is a no-op.", 
+0002dc40: 5573 6572 5761 726e 696e 670a 2020 2020  UserWarning.    
+0002dc50: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0002dc60: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0002dc70: 7475 726e 2073 656c 660a 0a20 2020 2020  turn self..     
+0002dc80: 2020 2020 2020 2023 2049 6620 6120 6d69         # If a mi
+0002dc90: 7373 696e 6720 636f 6c75 6d6e 2c20 4b65  ssing column, Ke
+0002dca0: 7945 7272 6f72 0a20 2020 2020 2020 2020  yError.         
+0002dcb0: 2020 2069 6620 6f74 6865 7220 6e6f 7420     if other not 
+0002dcc0: 696e 2073 656c 662e 636f 6c75 6d6e 733a  in self.columns:
+0002dcd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002dce0: 2072 6169 7365 204b 6579 4572 726f 7228   raise KeyError(
+0002dcf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002dd00: 2020 2020 2066 2244 6174 6120 6861 7320       f"Data has 
+0002dd10: 6e6f 2063 6f6c 756d 6e20 277b 6f74 6865  no column '{othe
+0002dd20: 727d 273a 2075 7365 2061 6e79 2063 6f6c  r}': use any col
+0002dd30: 756d 6e20 6f66 207b 6c69 7374 2873 656c  umn of {list(sel
+0002dd40: 662e 636f 6c75 6d6e 7329 7d22 0a20 2020  f.columns)}".   
+0002dd50: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0002dd60: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
+0002dd70: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
+0002dd80: 2020 6966 2064 6976 6973 696f 6e73 2069    if divisions i
+0002dd90: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0002dda0: 2020 2020 2020 2020 6368 6563 6b5f 6469          check_di
+0002ddb0: 7669 7369 6f6e 7328 6469 7669 7369 6f6e  visions(division
+0002ddc0: 7329 0a20 2020 2020 2020 2065 6c69 6620  s).        elif 
+0002ddd0: 280a 2020 2020 2020 2020 2020 2020 6973  (.            is
+0002dde0: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
+0002ddf0: 496e 6465 7829 0a20 2020 2020 2020 2020  Index).         
+0002de00: 2020 2061 6e64 206f 7468 6572 2e6b 6e6f     and other.kno
+0002de10: 776e 5f64 6976 6973 696f 6e73 0a20 2020  wn_divisions.   
+0002de20: 2020 2020 2020 2020 2061 6e64 206f 7468           and oth
+0002de30: 6572 2e6e 7061 7274 6974 696f 6e73 203d  er.npartitions =
+0002de40: 3d20 7365 6c66 2e6e 7061 7274 6974 696f  = self.npartitio
+0002de50: 6e73 0a20 2020 2020 2020 2029 3a0a 2020  ns.        ):.  
+0002de60: 2020 2020 2020 2020 2020 2320 4966 2074            # If t
+0002de70: 6865 2069 6e64 6578 2068 6173 2074 6865  he index has the
+0002de80: 2073 616d 6520 6e75 6d62 6572 206f 6620   same number of 
+0002de90: 7061 7274 6974 696f 6e73 2061 6e64 206b  partitions and k
+0002dea0: 6e6f 776e 0a20 2020 2020 2020 2020 2020  nown.           
+0002deb0: 2023 2064 6976 6973 696f 6e73 2c20 7468   # divisions, th
+0002dec0: 656e 2077 6520 6361 6e20 7472 6561 7420  en we can treat 
+0002ded0: 6974 2061 7320 7072 652d 736f 7274 6564  it as pre-sorted
+0002dee0: 2077 6974 6820 6b6e 6f77 6e0a 2020 2020   with known.    
+0002def0: 2020 2020 2020 2020 2320 6469 7669 7369          # divisi
+0002df00: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
+0002df10: 7072 655f 736f 7274 6564 203d 2054 7275  pre_sorted = Tru
+0002df20: 650a 2020 2020 2020 2020 2020 2020 6469  e.            di
+0002df30: 7669 7369 6f6e 7320 3d20 6f74 6865 722e  visions = other.
+0002df40: 6469 7669 7369 6f6e 730a 0a20 2020 2020  divisions..     
+0002df50: 2020 2023 2049 6620 696e 6465 7820 6973     # If index is
+0002df60: 2061 6c72 6561 6479 2073 6f72 7465 642c   already sorted,
+0002df70: 2074 616b 6520 6164 7661 6e74 6167 6520   take advantage 
+0002df80: 6f66 2074 6861 7420 7769 7468 2073 6574  of that with set
+0002df90: 5f73 6f72 7465 645f 696e 6465 780a 2020  _sorted_index.  
+0002dfa0: 2020 2020 2020 6966 2070 7265 5f73 6f72        if pre_sor
+0002dfb0: 7465 643a 0a20 2020 2020 2020 2020 2020  ted:.           
+0002dfc0: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+0002dfd0: 7261 6d65 2e73 6875 6666 6c65 2069 6d70  rame.shuffle imp
+0002dfe0: 6f72 7420 7365 745f 736f 7274 6564 5f69  ort set_sorted_i
+0002dff0: 6e64 6578 0a0a 2020 2020 2020 2020 2020  ndex..          
+0002e000: 2020 7265 7475 726e 2073 6574 5f73 6f72    return set_sor
+0002e010: 7465 645f 696e 6465 7828 0a20 2020 2020  ted_index(.     
+0002e020: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+0002e030: 206f 7468 6572 2c20 6472 6f70 3d64 726f   other, drop=dro
+0002e040: 702c 2064 6976 6973 696f 6e73 3d64 6976  p, divisions=div
+0002e050: 6973 696f 6e73 2c20 2a2a 6b77 6172 6773  isions, **kwargs
+0002e060: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0002e070: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0002e080: 2020 2020 2020 2020 2066 726f 6d20 6461           from da
+0002e090: 736b 2e64 6174 6166 7261 6d65 2e73 6875  sk.dataframe.shu
+0002e0a0: 6666 6c65 2069 6d70 6f72 7420 7365 745f  ffle import set_
+0002e0b0: 696e 6465 780a 0a20 2020 2020 2020 2020  index..         
+0002e0c0: 2020 2072 6574 7572 6e20 7365 745f 696e     return set_in
+0002e0d0: 6465 7828 0a20 2020 2020 2020 2020 2020  dex(.           
+0002e0e0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0002e0f0: 2020 2020 2020 2020 2020 206f 7468 6572             other
+0002e100: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002e110: 2020 6472 6f70 3d64 726f 702c 0a20 2020    drop=drop,.   
+0002e120: 2020 2020 2020 2020 2020 2020 206e 7061               npa
+0002e130: 7274 6974 696f 6e73 3d6e 7061 7274 6974  rtitions=npartit
+0002e140: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
+0002e150: 2020 2020 2020 6469 7669 7369 6f6e 733d        divisions=
+0002e160: 6469 7669 7369 6f6e 732c 0a20 2020 2020  divisions,.     
+0002e170: 2020 2020 2020 2020 2020 202a 2a6b 7761             **kwa
+0002e180: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+0002e190: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
+0002e1a0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+0002e1b0: 6d65 290a 2020 2020 6465 6620 706f 7028  me).    def pop(
+0002e1c0: 7365 6c66 2c20 6974 656d 293a 0a20 2020  self, item):.   
+0002e1d0: 2020 2020 206f 7574 203d 2073 656c 665b       out = self[
+0002e1e0: 6974 656d 5d0a 2020 2020 2020 2020 6465  item].        de
+0002e1f0: 6c20 7365 6c66 5b69 7465 6d5d 0a20 2020  l self[item].   
+0002e200: 2020 2020 2072 6574 7572 6e20 6f75 740a       return out.
+0002e210: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+0002e220: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+0002e230: 0a20 2020 2064 6566 206e 6c61 7267 6573  .    def nlarges
+0002e240: 7428 7365 6c66 2c20 6e3d 352c 2063 6f6c  t(self, n=5, col
+0002e250: 756d 6e73 3d4e 6f6e 652c 2073 706c 6974  umns=None, split
+0002e260: 5f65 7665 7279 3d4e 6f6e 6529 3a0a 2020  _every=None):.  
+0002e270: 2020 2020 2020 746f 6b65 6e20 3d20 2264        token = "d
+0002e280: 6174 6166 7261 6d65 2d6e 6c61 7267 6573  ataframe-nlarges
+0002e290: 7422 0a20 2020 2020 2020 2072 6574 7572  t".        retur
+0002e2a0: 6e20 6163 6128 0a20 2020 2020 2020 2020  n aca(.         
+0002e2b0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0002e2c0: 2020 2020 2063 6875 6e6b 3d4d 2e6e 6c61       chunk=M.nla
+0002e2d0: 7267 6573 742c 0a20 2020 2020 2020 2020  rgest,.         
+0002e2e0: 2020 2061 6767 7265 6761 7465 3d4d 2e6e     aggregate=M.n
+0002e2f0: 6c61 7267 6573 742c 0a20 2020 2020 2020  largest,.       
+0002e300: 2020 2020 206d 6574 613d 7365 6c66 2e5f       meta=self._
+0002e310: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
+0002e320: 2020 746f 6b65 6e3d 746f 6b65 6e2c 0a20    token=token,. 
+0002e330: 2020 2020 2020 2020 2020 2073 706c 6974             split
+0002e340: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+0002e350: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
+0002e360: 6e3d 6e2c 0a20 2020 2020 2020 2020 2020  n=n,.           
+0002e370: 2063 6f6c 756d 6e73 3d63 6f6c 756d 6e73   columns=columns
+0002e380: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0002e390: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+0002e3a0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+0002e3b0: 2064 6566 206e 736d 616c 6c65 7374 2873   def nsmallest(s
+0002e3c0: 656c 662c 206e 3d35 2c20 636f 6c75 6d6e  elf, n=5, column
+0002e3d0: 733d 4e6f 6e65 2c20 7370 6c69 745f 6576  s=None, split_ev
+0002e3e0: 6572 793d 4e6f 6e65 293a 0a20 2020 2020  ery=None):.     
+0002e3f0: 2020 2074 6f6b 656e 203d 2022 6461 7461     token = "data
+0002e400: 6672 616d 652d 6e73 6d61 6c6c 6573 7422  frame-nsmallest"
+0002e410: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002e420: 6163 6128 0a20 2020 2020 2020 2020 2020  aca(.           
+0002e430: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
+0002e440: 2020 2063 6875 6e6b 3d4d 2e6e 736d 616c     chunk=M.nsmal
+0002e450: 6c65 7374 2c0a 2020 2020 2020 2020 2020  lest,.          
+0002e460: 2020 6167 6772 6567 6174 653d 4d2e 6e73    aggregate=M.ns
+0002e470: 6d61 6c6c 6573 742c 0a20 2020 2020 2020  mallest,.       
+0002e480: 2020 2020 206d 6574 613d 7365 6c66 2e5f       meta=self._
+0002e490: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
+0002e4a0: 2020 746f 6b65 6e3d 746f 6b65 6e2c 0a20    token=token,. 
+0002e4b0: 2020 2020 2020 2020 2020 2073 706c 6974             split
+0002e4c0: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+0002e4d0: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
+0002e4e0: 6e3d 6e2c 0a20 2020 2020 2020 2020 2020  n=n,.           
+0002e4f0: 2063 6f6c 756d 6e73 3d63 6f6c 756d 6e73   columns=columns
+0002e500: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0002e510: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+0002e520: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+0002e530: 2064 6566 2067 726f 7570 6279 280a 2020   def groupby(.  
+0002e540: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0002e550: 2020 2020 6279 3d4e 6f6e 652c 0a20 2020      by=None,.   
+0002e560: 2020 2020 2067 726f 7570 5f6b 6579 733d       group_keys=
+0002e570: 4752 4f55 505f 4b45 5953 5f44 4546 4155  GROUP_KEYS_DEFAU
+0002e580: 4c54 2c0a 2020 2020 2020 2020 736f 7274  LT,.        sort
+0002e590: 3d4e 6f6e 652c 0a20 2020 2020 2020 206f  =None,.        o
+0002e5a0: 6273 6572 7665 643d 4e6f 6e65 2c0a 2020  bserved=None,.  
+0002e5b0: 2020 2020 2020 6472 6f70 6e61 3d4e 6f6e        dropna=Non
+0002e5c0: 652c 0a20 2020 2020 2020 202a 2a6b 7761  e,.        **kwa
+0002e5d0: 7267 732c 0a20 2020 2029 3a0a 2020 2020  rgs,.    ):.    
+0002e5e0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+0002e5f0: 7461 6672 616d 652e 6772 6f75 7062 7920  taframe.groupby 
+0002e600: 696d 706f 7274 2044 6174 6146 7261 6d65  import DataFrame
+0002e610: 4772 6f75 7042 790a 0a20 2020 2020 2020  GroupBy..       
+0002e620: 2072 6574 7572 6e20 4461 7461 4672 616d   return DataFram
+0002e630: 6547 726f 7570 4279 280a 2020 2020 2020  eGroupBy(.      
+0002e640: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0002e650: 2020 2020 2020 2020 6279 3d62 792c 0a20          by=by,. 
+0002e660: 2020 2020 2020 2020 2020 2067 726f 7570             group
+0002e670: 5f6b 6579 733d 6772 6f75 705f 6b65 7973  _keys=group_keys
+0002e680: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
+0002e690: 7274 3d73 6f72 742c 0a20 2020 2020 2020  rt=sort,.       
+0002e6a0: 2020 2020 206f 6273 6572 7665 643d 6f62       observed=ob
+0002e6b0: 7365 7276 6564 2c0a 2020 2020 2020 2020  served,.        
+0002e6c0: 2020 2020 6472 6f70 6e61 3d64 726f 706e      dropna=dropn
+0002e6d0: 612c 0a20 2020 2020 2020 2020 2020 202a  a,.            *
+0002e6e0: 2a6b 7761 7267 732c 0a20 2020 2020 2020  *kwargs,.       
+0002e6f0: 2029 0a0a 2020 2020 4077 7261 7073 2863   )..    @wraps(c
+0002e700: 6174 6567 6f72 697a 6529 0a20 2020 2064  ategorize).    d
+0002e710: 6566 2063 6174 6567 6f72 697a 6528 7365  ef categorize(se
+0002e720: 6c66 2c20 636f 6c75 6d6e 733d 4e6f 6e65  lf, columns=None
+0002e730: 2c20 696e 6465 783d 4e6f 6e65 2c20 7370  , index=None, sp
+0002e740: 6c69 745f 6576 6572 793d 4e6f 6e65 2c20  lit_every=None, 
+0002e750: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+0002e760: 2020 2072 6574 7572 6e20 6361 7465 676f     return catego
+0002e770: 7269 7a65 280a 2020 2020 2020 2020 2020  rize(.          
+0002e780: 2020 7365 6c66 2c20 636f 6c75 6d6e 733d    self, columns=
+0002e790: 636f 6c75 6d6e 732c 2069 6e64 6578 3d69  columns, index=i
+0002e7a0: 6e64 6578 2c20 7370 6c69 745f 6576 6572  ndex, split_ever
+0002e7b0: 793d 7370 6c69 745f 6576 6572 792c 202a  y=split_every, *
+0002e7c0: 2a6b 7761 7267 730a 2020 2020 2020 2020  *kwargs.        
+0002e7d0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0002e7e0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0002e7f0: 6529 0a20 2020 2064 6566 2061 7373 6967  e).    def assig
+0002e800: 6e28 7365 6c66 2c20 2a2a 6b77 6172 6773  n(self, **kwargs
+0002e810: 293a 0a20 2020 2020 2020 2064 6174 6120  ):.        data 
+0002e820: 3d20 7365 6c66 2e63 6f70 7928 290a 2020  = self.copy().  
+0002e830: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
+0002e840: 6e20 6b77 6172 6773 2e69 7465 6d73 2829  n kwargs.items()
+0002e850: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0002e860: 206e 6f74 2028 0a20 2020 2020 2020 2020   not (.         
+0002e870: 2020 2020 2020 2069 7369 6e73 7461 6e63         isinstanc
+0002e880: 6528 762c 2053 6361 6c61 7229 0a20 2020  e(v, Scalar).   
+0002e890: 2020 2020 2020 2020 2020 2020 206f 7220               or 
+0002e8a0: 6973 5f73 6572 6965 735f 6c69 6b65 2876  is_series_like(v
+0002e8b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002e8c0: 2020 6f72 2063 616c 6c61 626c 6528 7629    or callable(v)
+0002e8d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e8e0: 206f 7220 7064 2e61 7069 2e74 7970 6573   or pd.api.types
+0002e8f0: 2e69 735f 7363 616c 6172 2876 290a 2020  .is_scalar(v).  
+0002e900: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+0002e910: 2069 735f 696e 6465 785f 6c69 6b65 2876   is_index_like(v
+0002e920: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002e930: 2020 6f72 2069 7369 6e73 7461 6e63 6528    or isinstance(
+0002e940: 762c 2041 7272 6179 290a 2020 2020 2020  v, Array).      
+0002e950: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+0002e960: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0002e970: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
+0002e980: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0002e990: 436f 6c75 6d6e 2061 7373 6967 6e6d 656e  Column assignmen
+0002e9a0: 7420 646f 6573 6e27 7420 7375 7070 6f72  t doesn't suppor
+0002e9b0: 7420 7479 7065 207b 7479 7065 6e61 6d65  t type {typename
+0002e9c0: 2874 7970 6528 7629 297d 220a 2020 2020  (type(v))}".    
+0002e9d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0002e9e0: 2020 2020 2020 2020 2020 6966 2063 616c            if cal
+0002e9f0: 6c61 626c 6528 7629 3a0a 2020 2020 2020  lable(v):.      
+0002ea00: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
+0002ea10: 5b6b 5d20 3d20 7628 6461 7461 290a 2020  [k] = v(data).  
+0002ea20: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+0002ea30: 6e73 7461 6e63 6528 762c 2041 7272 6179  nstance(v, Array
+0002ea40: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0002ea50: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
+0002ea60: 6166 7261 6d65 2e69 6f20 696d 706f 7274  aframe.io import
+0002ea70: 2066 726f 6d5f 6461 736b 5f61 7272 6179   from_dask_array
+0002ea80: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002ea90: 2020 6966 206c 656e 2876 2e73 6861 7065    if len(v.shape
+0002eaa0: 2920 3e20 313a 0a20 2020 2020 2020 2020  ) > 1:.         
+0002eab0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002eac0: 2056 616c 7565 4572 726f 7228 2241 7272   ValueError("Arr
+0002ead0: 6179 2061 7373 6967 6e6d 656e 7420 6f6e  ay assignment on
+0002eae0: 6c79 2073 7570 706f 7274 7320 312d 4420  ly supports 1-D 
+0002eaf0: 6172 7261 7973 2229 0a20 2020 2020 2020  arrays").       
+0002eb00: 2020 2020 2020 2020 2069 6620 762e 6e70           if v.np
+0002eb10: 6172 7469 7469 6f6e 7320 213d 2064 6174  artitions != dat
+0002eb20: 612e 6e70 6172 7469 7469 6f6e 733a 0a20  a.npartitions:. 
+0002eb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eb40: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0002eb50: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0002eb60: 2020 2020 2020 2020 2020 2020 2022 4e75               "Nu
+0002eb70: 6d62 6572 206f 6620 7061 7274 6974 696f  mber of partitio
+0002eb80: 6e73 2064 6f20 6e6f 7420 6d61 7463 6820  ns do not match 
+0002eb90: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0002eba0: 2020 2020 2020 2020 2020 6622 287b 762e            f"({v.
+0002ebb0: 6e70 6172 7469 7469 6f6e 737d 2021 3d20  npartitions} != 
+0002ebc0: 7b64 6174 612e 6e70 6172 7469 7469 6f6e  {data.npartition
+0002ebd0: 737d 2922 0a20 2020 2020 2020 2020 2020  s})".           
+0002ebe0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0002ebf0: 2020 2020 2020 2020 2020 206b 7761 7267             kwarg
+0002ec00: 735b 6b5d 203d 2066 726f 6d5f 6461 736b  s[k] = from_dask
+0002ec10: 5f61 7272 6179 2876 2c20 696e 6465 783d  _array(v, index=
+0002ec20: 6461 7461 2e69 6e64 6578 2c20 6d65 7461  data.index, meta
+0002ec30: 3d64 6174 612e 5f6d 6574 6129 0a0a 2020  =data._meta)..  
+0002ec40: 2020 2020 2020 2020 2020 7061 6972 7320            pairs 
+0002ec50: 3d20 5b6b 2c20 6b77 6172 6773 5b6b 5d5d  = [k, kwargs[k]]
+0002ec60: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0002ec70: 4669 6775 7265 206f 7574 2063 6f6c 756d  Figure out colum
+0002ec80: 6e73 206f 6620 7468 6520 6f75 7470 7574  ns of the output
+0002ec90: 0a20 2020 2020 2020 2020 2020 2064 6632  .            df2
+0002eca0: 203d 2064 6174 612e 5f6d 6574 615f 6e6f   = data._meta_no
+0002ecb0: 6e65 6d70 7479 2e61 7373 6967 6e28 0a20  nempty.assign(. 
+0002ecc0: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+0002ecd0: 2a5f 6578 7472 6163 745f 6d65 7461 287b  *_extract_meta({
+0002ece0: 6b3a 206b 7761 7267 735b 6b5d 7d2c 206e  k: kwargs[k]}, n
+0002ecf0: 6f6e 656d 7074 793d 5472 7565 290a 2020  onempty=True).  
+0002ed00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0002ed10: 2020 2020 2020 2020 6461 7461 203d 2065          data = e
+0002ed20: 6c65 6d77 6973 6528 6d65 7468 6f64 732e  lemwise(methods.
+0002ed30: 6173 7369 676e 2c20 6461 7461 2c20 2a70  assign, data, *p
+0002ed40: 6169 7273 2c20 6d65 7461 3d64 6632 290a  airs, meta=df2).
+0002ed50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002ed60: 6461 7461 0a0a 2020 2020 4064 6572 6976  data..    @deriv
+0002ed70: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+0002ed80: 7261 6d65 2c20 7561 5f61 7267 733d 5b22  rame, ua_args=["
+0002ed90: 696e 6465 7822 5d29 0a20 2020 2064 6566  index"]).    def
+0002eda0: 2072 656e 616d 6528 7365 6c66 2c20 696e   rename(self, in
+0002edb0: 6465 783d 4e6f 6e65 2c20 636f 6c75 6d6e  dex=None, column
+0002edc0: 733d 4e6f 6e65 293a 0a20 2020 2020 2020  s=None):.       
+0002edd0: 2069 6620 696e 6465 7820 6973 206e 6f74   if index is not
+0002ede0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0002edf0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0002ee00: 726f 7228 2243 616e 6e6f 7420 7265 6e61  ror("Cannot rena
+0002ee10: 6d65 2069 6e64 6578 2e22 290a 0a20 2020  me index.")..   
+0002ee20: 2020 2020 2023 202a 6172 6773 2068 6572       # *args her
+0002ee30: 6520 6973 2069 6e64 6578 2c20 636f 6c75  e is index, colu
+0002ee40: 6d6e 7320 6275 7420 636f 6c75 6d6e 7320  mns but columns 
+0002ee50: 6172 6720 6973 2061 6c72 6561 6479 2075  arg is already u
+0002ee60: 7365 640a 2020 2020 2020 2020 7265 7475  sed.        retu
+0002ee70: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+0002ee80: 6974 696f 6e73 284d 2e72 656e 616d 652c  itions(M.rename,
+0002ee90: 204e 6f6e 652c 2063 6f6c 756d 6e73 3d63   None, columns=c
+0002eea0: 6f6c 756d 6e73 290a 0a20 2020 2064 6566  olumns)..    def
+0002eeb0: 2071 7565 7279 2873 656c 662c 2065 7870   query(self, exp
+0002eec0: 722c 202a 2a6b 7761 7267 7329 3a0a 2020  r, **kwargs):.  
+0002eed0: 2020 2020 2020 2222 2246 696c 7465 7220        """Filter 
+0002eee0: 6461 7461 6672 616d 6520 7769 7468 2063  dataframe with c
+0002eef0: 6f6d 706c 6578 2065 7870 7265 7373 696f  omplex expressio
+0002ef00: 6e0a 0a20 2020 2020 2020 2042 6c6f 636b  n..        Block
+0002ef10: 6564 2076 6572 7369 6f6e 206f 6620 7064  ed version of pd
+0002ef20: 2e44 6174 6146 7261 6d65 2e71 7565 7279  .DataFrame.query
+0002ef30: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0002ef40: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+0002ef50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002ef60: 6578 7072 3a20 7374 720a 2020 2020 2020  expr: str.      
+0002ef70: 2020 2020 2020 5468 6520 7175 6572 7920        The query 
+0002ef80: 7374 7269 6e67 2074 6f20 6576 616c 7561  string to evalua
+0002ef90: 7465 2e0a 2020 2020 2020 2020 2020 2020  te..            
+0002efa0: 596f 7520 6361 6e20 7265 6665 7220 746f  You can refer to
+0002efb0: 2063 6f6c 756d 6e20 6e61 6d65 7320 7468   column names th
+0002efc0: 6174 2061 7265 206e 6f74 2076 616c 6964  at are not valid
+0002efd0: 2050 7974 686f 6e20 7661 7269 6162 6c65   Python variable
+0002efe0: 206e 616d 6573 0a20 2020 2020 2020 2020   names.         
+0002eff0: 2020 2062 7920 7375 7272 6f75 6e64 696e     by surroundin
+0002f000: 6720 7468 656d 2069 6e20 6261 636b 7469  g them in backti
+0002f010: 636b 732e 0a20 2020 2020 2020 2020 2020  cks..           
+0002f020: 2044 6173 6b20 646f 6573 206e 6f74 2066   Dask does not f
+0002f030: 756c 6c79 2073 7570 706f 7274 2072 6566  ully support ref
+0002f040: 6572 7269 6e67 2074 6f20 7661 7269 6162  erring to variab
+0002f050: 6c65 7320 7573 696e 6720 7468 6520 2740  les using the '@
+0002f060: 2720 6368 6172 6163 7465 722c 0a20 2020  ' character,.   
+0002f070: 2020 2020 2020 2020 2075 7365 2066 2d73           use f-s
+0002f080: 7472 696e 6773 206f 7220 7468 6520 6060  trings or the ``
+0002f090: 6c6f 6361 6c5f 6469 6374 6060 206b 6579  local_dict`` key
+0002f0a0: 776f 7264 2061 7267 756d 656e 7420 696e  word argument in
+0002f0b0: 7374 6561 642e 0a0a 2020 2020 2020 2020  stead...        
+0002f0c0: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
+0002f0d0: 2d2d 2d0a 2020 2020 2020 2020 5468 6973  ---.        This
+0002f0e0: 2069 7320 6c69 6b65 2074 6865 2073 6571   is like the seq
+0002f0f0: 7565 6e74 6961 6c20 7665 7273 696f 6e20  uential version 
+0002f100: 6578 6365 7074 2074 6861 7420 7468 6973  except that this
+0002f110: 2077 696c 6c20 616c 736f 2068 6170 7065   will also happe
+0002f120: 6e0a 2020 2020 2020 2020 696e 206d 616e  n.        in man
+0002f130: 7920 7468 7265 6164 732e 2020 5468 6973  y threads.  This
+0002f140: 206d 6179 2063 6f6e 666c 6963 7420 7769   may conflict wi
+0002f150: 7468 2060 606e 756d 6578 7072 6060 2077  th ``numexpr`` w
+0002f160: 6869 6368 2077 696c 6c20 7573 650a 2020  hich will use.  
+0002f170: 2020 2020 2020 6d75 6c74 6970 6c65 2074        multiple t
+0002f180: 6872 6561 6473 2069 7473 656c 662e 2020  hreads itself.  
+0002f190: 5765 2072 6563 6f6d 6d65 6e64 2074 6861  We recommend tha
+0002f1a0: 7420 796f 7520 7365 7420 6060 6e75 6d65  t you set ``nume
+0002f1b0: 7870 7260 6020 746f 2075 7365 2061 0a20  xpr`` to use a. 
+0002f1c0: 2020 2020 2020 2073 696e 676c 6520 7468         single th
+0002f1d0: 7265 6164 3a0a 0a20 2020 2020 2020 202e  read:..        .
+0002f1e0: 2e20 636f 6465 2d62 6c6f 636b 3a3a 2070  . code-block:: p
+0002f1f0: 7974 686f 6e0a 0a20 2020 2020 2020 2020  ython..         
+0002f200: 2020 2069 6d70 6f72 7420 6e75 6d65 7870     import numexp
+0002f210: 720a 2020 2020 2020 2020 2020 2020 6e75  r.            nu
+0002f220: 6d65 7870 722e 7365 745f 6e75 6d5f 7468  mexpr.set_num_th
+0002f230: 7265 6164 7328 3129 0a0a 2020 2020 2020  reads(1)..      
+0002f240: 2020 5365 6520 616c 736f 0a20 2020 2020    See also.     
+0002f250: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+0002f260: 2020 2020 7061 6e64 6173 2e44 6174 6146      pandas.DataF
+0002f270: 7261 6d65 2e71 7565 7279 0a20 2020 2020  rame.query.     
+0002f280: 2020 2070 616e 6461 732e 6576 616c 0a0a     pandas.eval..
+0002f290: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+0002f2a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002f2b0: 2d0a 2020 2020 2020 2020 3e3e 3e20 696d  -.        >>> im
+0002f2c0: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
+0002f2d0: 640a 2020 2020 2020 2020 3e3e 3e20 696d  d.        >>> im
+0002f2e0: 706f 7274 2064 6173 6b2e 6461 7461 6672  port dask.datafr
+0002f2f0: 616d 6520 6173 2064 640a 2020 2020 2020  ame as dd.      
+0002f300: 2020 3e3e 3e20 6466 203d 2070 642e 4461    >>> df = pd.Da
+0002f310: 7461 4672 616d 6528 7b27 7827 3a20 5b31  taFrame({'x': [1
+0002f320: 2c20 322c 2031 2c20 325d 2c0a 2020 2020  , 2, 1, 2],.    
+0002f330: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+0002f340: 2020 2020 2020 2020 2020 2027 7927 3a20             'y': 
+0002f350: 5b31 2c20 322c 2033 2c20 345d 2c0a 2020  [1, 2, 3, 4],.  
+0002f360: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+0002f370: 2020 2020 2020 2020 2020 2020 2027 7a20               'z 
+0002f380: 7a27 3a20 5b34 2c20 332c 2032 2c20 315d  z': [4, 3, 2, 1]
+0002f390: 7d29 0a20 2020 2020 2020 203e 3e3e 2064  }).        >>> d
+0002f3a0: 6466 203d 2064 642e 6672 6f6d 5f70 616e  df = dd.from_pan
+0002f3b0: 6461 7328 6466 2c20 6e70 6172 7469 7469  das(df, npartiti
+0002f3c0: 6f6e 733d 3229 0a0a 2020 2020 2020 2020  ons=2)..        
+0002f3d0: 5265 6665 7220 746f 2063 6f6c 756d 6e20  Refer to column 
+0002f3e0: 6e61 6d65 7320 6469 7265 6374 6c79 3a0a  names directly:.
+0002f3f0: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
+0002f400: 2e71 7565 7279 2827 7920 3e20 7827 292e  .query('y > x').
+0002f410: 636f 6d70 7574 6528 290a 2020 2020 2020  compute().      
+0002f420: 2020 2020 2078 2020 7920 207a 207a 0a20       x  y  z z. 
+0002f430: 2020 2020 2020 2032 2020 3120 2033 2020         2  1  3  
+0002f440: 2020 320a 2020 2020 2020 2020 3320 2032    2.        3  2
+0002f450: 2020 3420 2020 2031 0a0a 2020 2020 2020    4    1..      
+0002f460: 2020 5265 6665 7220 746f 2063 6f6c 756d    Refer to colum
+0002f470: 6e20 6e61 6d65 2075 7369 6e67 2062 6163  n name using bac
+0002f480: 6b74 6963 6b73 3a0a 0a20 2020 2020 2020  kticks:..       
+0002f490: 203e 3e3e 2064 6466 2e71 7565 7279 2827   >>> ddf.query('
+0002f4a0: 607a 207a 6020 3e20 7827 292e 636f 6d70  `z z` > x').comp
+0002f4b0: 7574 6528 290a 2020 2020 2020 2020 2020  ute().          
+0002f4c0: 2078 2020 7920 207a 207a 0a20 2020 2020   x  y  z z.     
+0002f4d0: 2020 2030 2020 3120 2031 2020 2020 340a     0  1  1    4.
+0002f4e0: 2020 2020 2020 2020 3120 2032 2020 3220          1  2  2 
+0002f4f0: 2020 2033 0a20 2020 2020 2020 2032 2020     3.        2  
+0002f500: 3120 2033 2020 2020 320a 0a20 2020 2020  1  3    2..     
+0002f510: 2020 2052 6566 6572 2074 6f20 7661 7269     Refer to vari
+0002f520: 6162 6c65 206e 616d 6520 7573 696e 6720  able name using 
+0002f530: 662d 7374 7269 6e67 733a 0a0a 2020 2020  f-strings:..    
+0002f540: 2020 2020 3e3e 3e20 7661 6c75 6520 3d20      >>> value = 
+0002f550: 310a 2020 2020 2020 2020 3e3e 3e20 6464  1.        >>> dd
+0002f560: 662e 7175 6572 7928 6627 7820 3d3d 207b  f.query(f'x == {
+0002f570: 7661 6c75 657d 2729 2e63 6f6d 7075 7465  value}').compute
+0002f580: 2829 0a20 2020 2020 2020 2020 2020 7820  ().           x 
+0002f590: 2079 2020 7a20 7a0a 2020 2020 2020 2020   y  z z.        
+0002f5a0: 3020 2031 2020 3120 2020 2034 0a20 2020  0  1  1    4.   
+0002f5b0: 2020 2020 2032 2020 3120 2033 2020 2020       2  1  3    
+0002f5c0: 320a 0a20 2020 2020 2020 2052 6566 6572  2..        Refer
+0002f5d0: 2074 6f20 7661 7269 6162 6c65 206e 616d   to variable nam
+0002f5e0: 6520 7573 696e 6720 6060 6c6f 6361 6c5f  e using ``local_
+0002f5f0: 6469 6374 6060 3a0a 0a20 2020 2020 2020  dict``:..       
+0002f600: 203e 3e3e 2064 6466 2e71 7565 7279 2827   >>> ddf.query('
+0002f610: 7820 3d3d 2040 7661 6c75 6527 2c20 6c6f  x == @value', lo
+0002f620: 6361 6c5f 6469 6374 3d7b 2276 616c 7565  cal_dict={"value
+0002f630: 223a 2076 616c 7565 7d29 2e63 6f6d 7075  ": value}).compu
+0002f640: 7465 2829 0a20 2020 2020 2020 2020 2020  te().           
+0002f650: 7820 2079 2020 7a20 7a0a 2020 2020 2020  x  y  z z.      
+0002f660: 2020 3020 2031 2020 3120 2020 2034 0a20    0  1  1    4. 
+0002f670: 2020 2020 2020 2032 2020 3120 2033 2020         2  1  3  
+0002f680: 2020 320a 2020 2020 2020 2020 2222 220a    2.        """.
+0002f690: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0002f6a0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+0002f6b0: 6e73 284d 2e71 7565 7279 2c20 6578 7072  ns(M.query, expr
+0002f6c0: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
+0002f6d0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+0002f6e0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+0002f6f0: 2064 6566 2065 7661 6c28 7365 6c66 2c20   def eval(self, 
+0002f700: 6578 7072 2c20 696e 706c 6163 653d 4e6f  expr, inplace=No
+0002f710: 6e65 2c20 2a2a 6b77 6172 6773 293a 0a20  ne, **kwargs):. 
+0002f720: 2020 2020 2020 2069 6620 696e 706c 6163         if inplac
+0002f730: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
+0002f740: 2020 2020 2020 2069 6e70 6c61 6365 203d         inplace =
+0002f750: 2046 616c 7365 0a20 2020 2020 2020 2069   False.        i
+0002f760: 6620 223d 2220 696e 2065 7870 7220 616e  f "=" in expr an
+0002f770: 6420 696e 706c 6163 6520 696e 2028 5472  d inplace in (Tr
+0002f780: 7565 2c20 4e6f 6e65 293a 0a20 2020 2020  ue, None):.     
+0002f790: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+0002f7a0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+0002f7b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002f7c0: 2020 2249 6e70 6c61 6365 2065 7661 6c20    "Inplace eval 
+0002f7d0: 6e6f 7420 7375 7070 6f72 7465 642e 2050  not supported. P
+0002f7e0: 6c65 6173 6520 7573 6520 696e 706c 6163  lease use inplac
+0002f7f0: 653d 4661 6c73 6522 0a20 2020 2020 2020  e=False".       
+0002f800: 2020 2020 2029 0a20 2020 2020 2020 206d       ).        m
+0002f810: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
+0002f820: 2e65 7661 6c28 6578 7072 2c20 696e 706c  .eval(expr, inpl
+0002f830: 6163 653d 696e 706c 6163 652c 202a 2a6b  ace=inplace, **k
+0002f840: 7761 7267 7329 0a20 2020 2020 2020 2072  wargs).        r
+0002f850: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+0002f860: 6172 7469 7469 6f6e 7328 4d2e 6576 616c  artitions(M.eval
+0002f870: 2c20 6578 7072 2c20 6d65 7461 3d6d 6574  , expr, meta=met
+0002f880: 612c 2069 6e70 6c61 6365 3d69 6e70 6c61  a, inplace=inpla
+0002f890: 6365 2c20 2a2a 6b77 6172 6773 290a 0a20  ce, **kwargs).. 
+0002f8a0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0002f8b0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0002f8c0: 2020 2064 6566 2064 726f 706e 6128 7365     def dropna(se
+0002f8d0: 6c66 2c20 686f 773d 6e6f 5f64 6566 6175  lf, how=no_defau
+0002f8e0: 6c74 2c20 7375 6273 6574 3d4e 6f6e 652c  lt, subset=None,
+0002f8f0: 2074 6872 6573 683d 6e6f 5f64 6566 6175   thresh=no_defau
+0002f900: 6c74 293a 0a20 2020 2020 2020 2023 2054  lt):.        # T
+0002f910: 6865 7365 206b 6579 776f 7264 7320 6172  hese keywords ar
+0002f920: 6520 696e 636f 6d70 6174 6962 6c65 2077  e incompatible w
+0002f930: 6974 6820 6561 6368 206f 7468 6572 2e0a  ith each other..
+0002f940: 2020 2020 2020 2020 2320 446f 6e27 7420          # Don't 
+0002f950: 616c 6c6f 7720 7468 656d 2062 6f74 6820  allow them both 
+0002f960: 746f 2062 6520 7365 742e 0a20 2020 2020  to be set..     
+0002f970: 2020 2069 6620 686f 7720 6973 206e 6f74     if how is not
+0002f980: 206e 6f5f 6465 6661 756c 7420 616e 6420   no_default and 
+0002f990: 7468 7265 7368 2069 7320 6e6f 7420 6e6f  thresh is not no
+0002f9a0: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
+0002f9b0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+0002f9c0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0002f9d0: 2020 2020 2020 2022 596f 7520 6361 6e6e         "You cann
+0002f9e0: 6f74 2073 6574 2062 6f74 6820 7468 6520  ot set both the 
+0002f9f0: 686f 7720 616e 6420 7468 7265 7368 2061  how and thresh a
+0002fa00: 7267 756d 656e 7473 2061 7420 7468 6520  rguments at the 
+0002fa10: 7361 6d65 2074 696d 652e 220a 2020 2020  same time.".    
+0002fa20: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0002fa30: 2020 2023 204f 6e6c 7920 7370 6563 6966     # Only specif
+0002fa40: 7920 6068 6f77 6020 6f72 2060 7468 7265  y `how` or `thre
+0002fa50: 7368 6020 6b65 7977 6f72 6420 6966 2073  sh` keyword if s
+0002fa60: 7065 6369 6669 6564 2062 7920 7468 6520  pecified by the 
+0002fa70: 7573 6572 0a20 2020 2020 2020 2023 2073  user.        # s
+0002fa80: 6f20 7765 2075 7469 6c69 7a65 206f 7468  o we utilize oth
+0002fa90: 6572 2060 6472 6f70 6e61 6020 6b65 7977  er `dropna` keyw
+0002faa0: 6f72 6420 6465 6661 756c 7473 2061 7070  ord defaults app
+0002fab0: 726f 7072 6961 7465 6c79 0a20 2020 2020  ropriately.     
+0002fac0: 2020 206b 7761 7267 7320 3d20 7b22 7375     kwargs = {"su
+0002fad0: 6273 6574 223a 2073 7562 7365 747d 0a20  bset": subset}. 
+0002fae0: 2020 2020 2020 2069 6620 686f 7720 6973         if how is
+0002faf0: 206e 6f74 206e 6f5f 6465 6661 756c 743a   not no_default:
+0002fb00: 0a20 2020 2020 2020 2020 2020 206b 7761  .            kwa
+0002fb10: 7267 735b 2268 6f77 225d 203d 2068 6f77  rgs["how"] = how
+0002fb20: 0a20 2020 2020 2020 2065 6c69 6620 7468  .        elif th
+0002fb30: 7265 7368 2069 7320 6e6f 7420 6e6f 5f64  resh is not no_d
+0002fb40: 6566 6175 6c74 3a0a 2020 2020 2020 2020  efault:.        
+0002fb50: 2020 2020 6b77 6172 6773 5b22 7468 7265      kwargs["thre
+0002fb60: 7368 225d 203d 2074 6872 6573 680a 0a20  sh"] = thresh.. 
+0002fb70: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0002fb80: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+0002fb90: 7328 4d2e 6472 6f70 6e61 2c20 2a2a 6b77  s(M.dropna, **kw
+0002fba0: 6172 6773 2c20 656e 666f 7263 655f 6d65  args, enforce_me
+0002fbb0: 7461 6461 7461 3d46 616c 7365 290a 0a20  tadata=False).. 
+0002fbc0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0002fbd0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0002fbe0: 2020 2064 6566 2063 6c69 7028 7365 6c66     def clip(self
+0002fbf0: 2c20 6c6f 7765 723d 4e6f 6e65 2c20 7570  , lower=None, up
+0002fc00: 7065 723d 4e6f 6e65 2c20 6f75 743d 4e6f  per=None, out=No
+0002fc10: 6e65 293a 0a20 2020 2020 2020 2069 6620  ne):.        if 
+0002fc20: 6f75 7420 6973 206e 6f74 204e 6f6e 653a  out is not None:
+0002fc30: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0002fc40: 7365 2056 616c 7565 4572 726f 7228 2227  se ValueError("'
+0002fc50: 6f75 7427 206d 7573 7420 6265 204e 6f6e  out' must be Non
+0002fc60: 6522 290a 2020 2020 2020 2020 7265 7475  e").        retu
+0002fc70: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+0002fc80: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+0002fc90: 2020 2020 4d2e 636c 6970 2c20 6c6f 7765      M.clip, lowe
+0002fca0: 723d 6c6f 7765 722c 2075 7070 6572 3d75  r=lower, upper=u
+0002fcb0: 7070 6572 2c20 656e 666f 7263 655f 6d65  pper, enforce_me
+0002fcc0: 7461 6461 7461 3d46 616c 7365 0a20 2020  tadata=False.   
+0002fcd0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+0002fce0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+0002fcf0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+0002fd00: 636c 6970 5f6c 6f77 6572 2873 656c 662c  clip_lower(self,
+0002fd10: 2074 6872 6573 686f 6c64 293a 0a20 2020   threshold):.   
+0002fd20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0002fd30: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+0002fd40: 0a20 2020 2020 2020 2020 2020 204d 2e63  .            M.c
+0002fd50: 6c69 705f 6c6f 7765 722c 2074 6872 6573  lip_lower, thres
+0002fd60: 686f 6c64 3d74 6872 6573 686f 6c64 2c20  hold=threshold, 
+0002fd70: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+0002fd80: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
+0002fd90: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+0002fda0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+0002fdb0: 290a 2020 2020 6465 6620 636c 6970 5f75  ).    def clip_u
+0002fdc0: 7070 6572 2873 656c 662c 2074 6872 6573  pper(self, thres
+0002fdd0: 686f 6c64 293a 0a20 2020 2020 2020 2072  hold):.        r
+0002fde0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+0002fdf0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0002fe00: 2020 2020 2020 204d 2e63 6c69 705f 7570         M.clip_up
+0002fe10: 7065 722c 2074 6872 6573 686f 6c64 3d74  per, threshold=t
+0002fe20: 6872 6573 686f 6c64 2c20 656e 666f 7263  hreshold, enforc
+0002fe30: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+0002fe40: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0002fe50: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0002fe60: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+0002fe70: 6465 6620 7371 7565 657a 6528 7365 6c66  def squeeze(self
+0002fe80: 2c20 6178 6973 3d4e 6f6e 6529 3a0a 2020  , axis=None):.  
+0002fe90: 2020 2020 2020 6966 2061 7869 7320 696e        if axis in
+0002fea0: 205b 4e6f 6e65 2c20 315d 3a0a 2020 2020   [None, 1]:.    
+0002feb0: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+0002fec0: 656c 662e 636f 6c75 6d6e 7329 203d 3d20  elf.columns) == 
+0002fed0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+0002fee0: 2020 2072 6574 7572 6e20 7365 6c66 5b73     return self[s
+0002fef0: 656c 662e 636f 6c75 6d6e 735b 305d 5d0a  elf.columns[0]].
+0002ff00: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0002ff10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002ff20: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
+0002ff30: 2020 2020 2020 2065 6c69 6620 6178 6973         elif axis
+0002ff40: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+0002ff50: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+0002ff60: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+0002ff70: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0002ff80: 7b74 7970 6528 7365 6c66 297d 2064 6f65  {type(self)} doe
+0002ff90: 7320 6e6f 7420 7375 7070 6f72 7420 7371  s not support sq
+0002ffa0: 7565 657a 6520 616c 6f6e 6720 6178 6973  ueeze along axis
+0002ffb0: 2030 220a 2020 2020 2020 2020 2020 2020   0".            
+0002ffc0: 290a 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
+0002ffd0: 6178 6973 206e 6f74 2069 6e20 5b30 2c20  axis not in [0, 
+0002ffe0: 312c 204e 6f6e 655d 3a0a 2020 2020 2020  1, None]:.      
+0002fff0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00030000: 6545 7272 6f72 2866 224e 6f20 6178 6973  eError(f"No axis
+00030010: 207b 6178 6973 7d20 666f 7220 6f62 6a65   {axis} for obje
+00030020: 6374 2074 7970 6520 7b74 7970 6528 7365  ct type {type(se
+00030030: 6c66 297d 2229 0a0a 2020 2020 4064 6572  lf)}")..    @der
+00030040: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00030050: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00030060: 746f 5f74 696d 6573 7461 6d70 2873 656c  to_timestamp(sel
+00030070: 662c 2066 7265 713d 4e6f 6e65 2c20 686f  f, freq=None, ho
+00030080: 773d 2273 7461 7274 222c 2061 7869 733d  w="start", axis=
+00030090: 3029 3a0a 2020 2020 2020 2020 6466 203d  0):.        df =
+000300a0: 2065 6c65 6d77 6973 6528 4d2e 746f 5f74   elemwise(M.to_t
+000300b0: 696d 6573 7461 6d70 2c20 7365 6c66 2c20  imestamp, self, 
+000300c0: 6672 6571 2c20 686f 772c 2061 7869 7329  freq, how, axis)
+000300d0: 0a20 2020 2020 2020 2064 662e 6469 7669  .        df.divi
+000300e0: 7369 6f6e 7320 3d20 7475 706c 6528 7064  sions = tuple(pd
+000300f0: 2e49 6e64 6578 2873 656c 662e 6469 7669  .Index(self.divi
+00030100: 7369 6f6e 7329 2e74 6f5f 7469 6d65 7374  sions).to_timest
+00030110: 616d 7028 2929 0a20 2020 2020 2020 2072  amp()).        r
+00030120: 6574 7572 6e20 6466 0a0a 2020 2020 4064  eturn df..    @d
+00030130: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00030140: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+00030150: 6620 6578 706c 6f64 6528 7365 6c66 2c20  f explode(self, 
+00030160: 636f 6c75 6d6e 293a 0a20 2020 2020 2020  column):.       
+00030170: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+00030180: 7461 2e65 7870 6c6f 6465 2863 6f6c 756d  ta.explode(colum
+00030190: 6e29 0a20 2020 2020 2020 2072 6574 7572  n).        retur
+000301a0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+000301b0: 7469 6f6e 7328 4d2e 6578 706c 6f64 652c  tions(M.explode,
+000301c0: 2063 6f6c 756d 6e2c 206d 6574 613d 6d65   column, meta=me
+000301d0: 7461 2c20 656e 666f 7263 655f 6d65 7461  ta, enforce_meta
+000301e0: 6461 7461 3d46 616c 7365 290a 0a20 2020  data=False)..   
+000301f0: 2064 6566 2074 6f5f 6261 6728 7365 6c66   def to_bag(self
+00030200: 2c20 696e 6465 783d 4661 6c73 652c 2066  , index=False, f
+00030210: 6f72 6d61 743d 2274 7570 6c65 2229 3a0a  ormat="tuple"):.
+00030220: 2020 2020 2020 2020 2222 2243 6f6e 7665          """Conve
+00030230: 7274 2074 6f20 6120 6461 736b 2042 6167  rt to a dask Bag
+00030240: 206f 6620 7475 706c 6573 206f 6620 6561   of tuples of ea
+00030250: 6368 2072 6f77 2e0a 0a20 2020 2020 2020  ch row...       
+00030260: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00030270: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00030280: 2020 2020 2020 2069 6e64 6578 203a 2062         index : b
+00030290: 6f6f 6c2c 206f 7074 696f 6e61 6c0a 2020  ool, optional.  
+000302a0: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
+000302b0: 652c 2074 6865 2069 6e64 6578 2069 7320  e, the index is 
+000302c0: 696e 636c 7564 6564 2061 7320 7468 6520  included as the 
+000302d0: 6669 7273 7420 656c 656d 656e 7420 6f66  first element of
+000302e0: 2065 6163 6820 7475 706c 652e 0a20 2020   each tuple..   
+000302f0: 2020 2020 2020 2020 2044 6566 6175 6c74           Default
+00030300: 2069 7320 4661 6c73 652e 0a20 2020 2020   is False..     
+00030310: 2020 2066 6f72 6d61 7420 3a20 7b22 7475     format : {"tu
+00030320: 706c 6522 2c20 2264 6963 7422 2c20 2266  ple", "dict", "f
+00030330: 7261 6d65 227d 2c20 6f70 7469 6f6e 616c  rame"}, optional
+00030340: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
+00030350: 7468 6572 2074 6f20 7265 7475 726e 2061  ther to return a
+00030360: 2062 6167 206f 6620 7475 706c 6573 2c20   bag of tuples, 
+00030370: 6469 6374 696f 6e61 7269 6573 2c20 6f72  dictionaries, or
+00030380: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+00030390: 6166 7261 6d65 2d6c 696b 6520 6f62 6a65  aframe-like obje
+000303a0: 6374 732e 2044 6566 6175 6c74 2069 7320  cts. Default is 
+000303b0: 2274 7570 6c65 222e 2049 6620 2266 7261  "tuple". If "fra
+000303c0: 6d65 222c 0a20 2020 2020 2020 2020 2020  me",.           
+000303d0: 2074 6865 206f 7269 6769 6e61 6c20 7061   the original pa
+000303e0: 7274 6974 696f 6e73 206f 6620 6060 6466  rtitions of ``df
+000303f0: 6060 2077 696c 6c20 6e6f 7420 6265 2074  `` will not be t
+00030400: 7261 6e73 666f 726d 6564 0a20 2020 2020  ransformed.     
+00030410: 2020 2020 2020 2069 6e20 616e 7920 7761         in any wa
+00030420: 792e 0a20 2020 2020 2020 2022 2222 0a20  y..        """. 
+00030430: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00030440: 2e64 6174 6166 7261 6d65 2e69 6f20 696d  .dataframe.io im
+00030450: 706f 7274 2074 6f5f 6261 670a 0a20 2020  port to_bag..   
+00030460: 2020 2020 2072 6574 7572 6e20 746f 5f62       return to_b
+00030470: 6167 2873 656c 662c 2069 6e64 6578 2c20  ag(self, index, 
+00030480: 666f 726d 6174 290a 0a20 2020 2064 6566  format)..    def
+00030490: 2074 6f5f 7061 7271 7565 7428 7365 6c66   to_parquet(self
+000304a0: 2c20 7061 7468 2c20 2a61 7267 732c 202a  , path, *args, *
+000304b0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+000304c0: 2020 2222 2253 6565 2064 642e 746f 5f70    """See dd.to_p
+000304d0: 6172 7175 6574 2064 6f63 7374 7269 6e67  arquet docstring
+000304e0: 2066 6f72 206d 6f72 6520 696e 666f 726d   for more inform
+000304f0: 6174 696f 6e22 2222 0a20 2020 2020 2020  ation""".       
+00030500: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+00030510: 7261 6d65 2e69 6f20 696d 706f 7274 2074  rame.io import t
+00030520: 6f5f 7061 7271 7565 740a 0a20 2020 2020  o_parquet..     
+00030530: 2020 2072 6574 7572 6e20 746f 5f70 6172     return to_par
+00030540: 7175 6574 2873 656c 662c 2070 6174 682c  quet(self, path,
+00030550: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+00030560: 290a 0a20 2020 2064 6566 2074 6f5f 6f72  )..    def to_or
+00030570: 6328 7365 6c66 2c20 7061 7468 2c20 2a61  c(self, path, *a
+00030580: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+00030590: 2020 2020 2020 2020 2222 2253 6565 2064          """See d
+000305a0: 642e 746f 5f6f 7263 2064 6f63 7374 7269  d.to_orc docstri
+000305b0: 6e67 2066 6f72 206d 6f72 6520 696e 666f  ng for more info
+000305c0: 726d 6174 696f 6e22 2222 0a20 2020 2020  rmation""".     
+000305d0: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
+000305e0: 6166 7261 6d65 2e69 6f20 696d 706f 7274  aframe.io import
+000305f0: 2074 6f5f 6f72 630a 0a20 2020 2020 2020   to_orc..       
+00030600: 2072 6574 7572 6e20 746f 5f6f 7263 2873   return to_orc(s
+00030610: 656c 662c 2070 6174 682c 202a 6172 6773  elf, path, *args
+00030620: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
+00030630: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00030640: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00030650: 2064 6566 2074 6f5f 7374 7269 6e67 2873   def to_string(s
+00030660: 656c 662c 206d 6178 5f72 6f77 733d 3529  elf, max_rows=5)
+00030670: 3a0a 2020 2020 2020 2020 2320 6f70 7469  :.        # opti
+00030680: 6f6e 5f63 6f6e 7465 7874 2064 6f65 736e  on_context doesn
+00030690: 2774 2061 6666 6563 740a 2020 2020 2020  't affect.      
+000306a0: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
+000306b0: 6570 725f 6461 7461 2829 2e74 6f5f 7374  epr_data().to_st
+000306c0: 7269 6e67 286d 6178 5f72 6f77 733d 6d61  ring(max_rows=ma
+000306d0: 785f 726f 7773 2c20 7368 6f77 5f64 696d  x_rows, show_dim
+000306e0: 656e 7369 6f6e 733d 4661 6c73 6529 0a0a  ensions=False)..
+000306f0: 2020 2020 6465 6620 5f67 6574 5f6e 756d      def _get_num
+00030700: 6572 6963 5f64 6174 6128 7365 6c66 2c20  eric_data(self, 
+00030710: 686f 773d 2261 6e79 222c 2073 7562 7365  how="any", subse
+00030720: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
+00030730: 2023 2063 616c 6375 6c61 7465 2063 6f6c   # calculate col
+00030740: 756d 6e73 2074 6f20 6176 6f69 6420 756e  umns to avoid un
+00030750: 6e65 6365 7373 6172 7920 6361 6c63 756c  necessary calcul
+00030760: 6174 696f 6e0a 2020 2020 2020 2020 6e75  ation.        nu
+00030770: 6d65 7269 6373 203d 2073 656c 662e 5f6d  merics = self._m
+00030780: 6574 612e 5f67 6574 5f6e 756d 6572 6963  eta._get_numeric
+00030790: 5f64 6174 6128 290a 0a20 2020 2020 2020  _data()..       
+000307a0: 2069 6620 6c65 6e28 6e75 6d65 7269 6373   if len(numerics
+000307b0: 2e63 6f6c 756d 6e73 2920 3c20 6c65 6e28  .columns) < len(
+000307c0: 7365 6c66 2e63 6f6c 756d 6e73 293a 0a20  self.columns):. 
+000307d0: 2020 2020 2020 2020 2020 206e 616d 6520             name 
+000307e0: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
+000307f0: 6566 6978 202b 2022 2d67 6574 5f6e 756d  efix + "-get_num
+00030800: 6572 6963 5f64 6174 6122 0a20 2020 2020  eric_data".     
+00030810: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00030820: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00030830: 7328 4d2e 5f67 6574 5f6e 756d 6572 6963  s(M._get_numeric
+00030840: 5f64 6174 612c 206d 6574 613d 6e75 6d65  _data, meta=nume
+00030850: 7269 6373 2c20 746f 6b65 6e3d 6e61 6d65  rics, token=name
+00030860: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00030870: 2020 2020 2020 2020 2020 2020 2320 7573              # us
+00030880: 6520 6d79 7365 6c66 2069 6620 616c 6c20  e myself if all 
+00030890: 6e75 6d65 7269 6373 0a20 2020 2020 2020  numerics.       
+000308a0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000308b0: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+000308c0: 6f64 0a20 2020 2064 6566 205f 7661 6c69  od.    def _vali
+000308d0: 6461 7465 5f61 7869 7328 636c 732c 2061  date_axis(cls, a
+000308e0: 7869 733d 302c 206e 6f6e 655f 6973 5f7a  xis=0, none_is_z
+000308f0: 6572 6f3a 2062 6f6f 6c20 3d20 5472 7565  ero: bool = True
+00030900: 2920 2d3e 204e 6f6e 6520 7c20 4c69 7465  ) -> None | Lite
+00030910: 7261 6c5b 302c 2031 5d3a 0a20 2020 2020  ral[0, 1]:.     
+00030920: 2020 2069 6620 6178 6973 206e 6f74 2069     if axis not i
+00030930: 6e20 2830 2c20 312c 2022 696e 6465 7822  n (0, 1, "index"
+00030940: 2c20 2263 6f6c 756d 6e73 222c 204e 6f6e  , "columns", Non
+00030950: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00030960: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00030970: 2866 224e 6f20 6178 6973 206e 616d 6564  (f"No axis named
+00030980: 207b 6178 6973 7d22 290a 2020 2020 2020   {axis}").      
+00030990: 2020 2320 636f 6e76 6572 7420 746f 206e    # convert to n
+000309a0: 756d 6572 6963 2061 7869 730a 2020 2020  umeric axis.    
+000309b0: 2020 2020 6e75 6d65 7269 635f 6178 6973      numeric_axis
+000309c0: 3a20 6469 6374 5b73 7472 207c 204e 6f6e  : dict[str | Non
+000309d0: 652c 204c 6974 6572 616c 5b30 2c20 315d  e, Literal[0, 1]
+000309e0: 5d20 3d20 7b22 696e 6465 7822 3a20 302c  ] = {"index": 0,
+000309f0: 2022 636f 6c75 6d6e 7322 3a20 317d 0a20   "columns": 1}. 
+00030a00: 2020 2020 2020 2069 6620 6e6f 6e65 5f69         if none_i
+00030a10: 735f 7a65 726f 3a0a 2020 2020 2020 2020  s_zero:.        
+00030a20: 2020 2020 6e75 6d65 7269 635f 6178 6973      numeric_axis
+00030a30: 5b4e 6f6e 655d 203d 2030 0a0a 2020 2020  [None] = 0..    
+00030a40: 2020 2020 7265 7475 726e 206e 756d 6572      return numer
+00030a50: 6963 5f61 7869 732e 6765 7428 6178 6973  ic_axis.get(axis
+00030a60: 2c20 6178 6973 290a 0a20 2020 2040 6465  , axis)..    @de
+00030a70: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00030a80: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+00030a90: 2064 726f 7028 7365 6c66 2c20 6c61 6265   drop(self, labe
+00030aa0: 6c73 3d4e 6f6e 652c 2061 7869 733d 302c  ls=None, axis=0,
+00030ab0: 2063 6f6c 756d 6e73 3d4e 6f6e 652c 2065   columns=None, e
+00030ac0: 7272 6f72 733d 2272 6169 7365 2229 3a0a  rrors="raise"):.
+00030ad0: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+00030ae0: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+00030af0: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+00030b00: 2069 6620 6178 6973 203d 3d20 3020 616e   if axis == 0 an
+00030b10: 6420 636f 6c75 6d6e 7320 6973 206e 6f74  d columns is not
+00030b20: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00030b30: 2020 2023 2043 6f6c 756d 6e73 206d 7573     # Columns mus
+00030b40: 7420 6265 2073 7065 6369 6669 6564 2069  t be specified i
+00030b50: 6620 6178 6973 3d3d 300a 2020 2020 2020  f axis==0.      
+00030b60: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00030b70: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+00030b80: 2864 726f 705f 6279 5f73 6861 6c6c 6f77  (drop_by_shallow
+00030b90: 5f63 6f70 792c 2063 6f6c 756d 6e73 2c20  _copy, columns, 
+00030ba0: 6572 726f 7273 3d65 7272 6f72 7329 0a20  errors=errors). 
+00030bb0: 2020 2020 2020 2065 6c69 6620 6178 6973         elif axis
+00030bc0: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00030bd0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+00030be0: 6170 5f70 6172 7469 7469 6f6e 7328 6472  ap_partitions(dr
+00030bf0: 6f70 5f62 795f 7368 616c 6c6f 775f 636f  op_by_shallow_co
+00030c00: 7079 2c20 6c61 6265 6c73 2c20 6572 726f  py, labels, erro
+00030c10: 7273 3d65 7272 6f72 7329 0a20 2020 2020  rs=errors).     
+00030c20: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00030c30: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+00030c40: 2020 2020 2020 2020 2020 2244 726f 7020            "Drop 
+00030c50: 6375 7272 656e 746c 7920 6f6e 6c79 2077  currently only w
+00030c60: 6f72 6b73 2066 6f72 2061 7869 733d 3120  orks for axis=1 
+00030c70: 6f72 2077 6865 6e20 636f 6c75 6d6e 7320  or when columns 
+00030c80: 6973 206e 6f74 204e 6f6e 6522 0a20 2020  is not None".   
+00030c90: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00030ca0: 6d65 7267 6528 0a20 2020 2020 2020 2073  merge(.        s
+00030cb0: 656c 662c 0a20 2020 2020 2020 2072 6967  elf,.        rig
+00030cc0: 6874 2c0a 2020 2020 2020 2020 686f 773d  ht,.        how=
+00030cd0: 2269 6e6e 6572 222c 0a20 2020 2020 2020  "inner",.       
+00030ce0: 206f 6e3d 4e6f 6e65 2c0a 2020 2020 2020   on=None,.      
+00030cf0: 2020 6c65 6674 5f6f 6e3d 4e6f 6e65 2c0a    left_on=None,.
+00030d00: 2020 2020 2020 2020 7269 6768 745f 6f6e          right_on
+00030d10: 3d4e 6f6e 652c 0a20 2020 2020 2020 206c  =None,.        l
+00030d20: 6566 745f 696e 6465 783d 4661 6c73 652c  eft_index=False,
+00030d30: 0a20 2020 2020 2020 2072 6967 6874 5f69  .        right_i
+00030d40: 6e64 6578 3d46 616c 7365 2c0a 2020 2020  ndex=False,.    
+00030d50: 2020 2020 7375 6666 6978 6573 3d28 225f      suffixes=("_
+00030d60: 7822 2c20 225f 7922 292c 0a20 2020 2020  x", "_y"),.     
+00030d70: 2020 2069 6e64 6963 6174 6f72 3d46 616c     indicator=Fal
+00030d80: 7365 2c0a 2020 2020 2020 2020 6e70 6172  se,.        npar
+00030d90: 7469 7469 6f6e 733d 4e6f 6e65 2c0a 2020  titions=None,.  
+00030da0: 2020 2020 2020 7368 7566 666c 653d 4e6f        shuffle=No
+00030db0: 6e65 2c0a 2020 2020 2020 2020 6272 6f61  ne,.        broa
+00030dc0: 6463 6173 743d 4e6f 6e65 2c0a 2020 2020  dcast=None,.    
+00030dd0: 293a 0a20 2020 2020 2020 2022 2222 4d65  ):.        """Me
+00030de0: 7267 6520 7468 6520 4461 7461 4672 616d  rge the DataFram
+00030df0: 6520 7769 7468 2061 6e6f 7468 6572 2044  e with another D
+00030e00: 6174 6146 7261 6d65 0a0a 2020 2020 2020  ataFrame..      
+00030e10: 2020 5468 6973 2077 696c 6c20 6d65 7267    This will merg
+00030e20: 6520 7468 6520 7477 6f20 6461 7461 7365  e the two datase
+00030e30: 7473 2c20 6569 7468 6572 206f 6e20 7468  ts, either on th
+00030e40: 6520 696e 6469 6365 732c 2061 2063 6572  e indices, a cer
+00030e50: 7461 696e 2063 6f6c 756d 6e0a 2020 2020  tain column.    
+00030e60: 2020 2020 696e 2065 6163 6820 6461 7461      in each data
+00030e70: 7365 7420 6f72 2074 6865 2069 6e64 6578  set or the index
+00030e80: 2069 6e20 6f6e 6520 6461 7461 7365 7420   in one dataset 
+00030e90: 616e 6420 7468 6520 636f 6c75 6d6e 2069  and the column i
+00030ea0: 6e20 616e 6f74 6865 722e 0a0a 2020 2020  n another...    
+00030eb0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00030ec0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00030ed0: 2d0a 2020 2020 2020 2020 7269 6768 743a  -.        right:
+00030ee0: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+00030ef0: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
+00030f00: 2020 686f 7720 3a20 7b27 6c65 6674 272c    how : {'left',
+00030f10: 2027 7269 6768 7427 2c20 276f 7574 6572   'right', 'outer
+00030f20: 272c 2027 696e 6e65 7227 7d2c 2064 6566  ', 'inner'}, def
+00030f30: 6175 6c74 3a20 2769 6e6e 6572 270a 2020  ault: 'inner'.  
+00030f40: 2020 2020 2020 2020 2020 486f 7720 746f            How to
+00030f50: 2068 616e 646c 6520 7468 6520 6f70 6572   handle the oper
+00030f60: 6174 696f 6e20 6f66 2074 6865 2074 776f  ation of the two
+00030f70: 206f 626a 6563 7473 3a0a 0a20 2020 2020   objects:..     
+00030f80: 2020 2020 2020 202d 206c 6566 743a 2075         - left: u
+00030f90: 7365 2063 616c 6c69 6e67 2066 7261 6d65  se calling frame
+00030fa0: 2773 2069 6e64 6578 2028 6f72 2063 6f6c  's index (or col
+00030fb0: 756d 6e20 6966 206f 6e20 6973 2073 7065  umn if on is spe
+00030fc0: 6369 6669 6564 290a 2020 2020 2020 2020  cified).        
+00030fd0: 2020 2020 2d20 7269 6768 743a 2075 7365      - right: use
+00030fe0: 206f 7468 6572 2066 7261 6d65 2773 2069   other frame's i
+00030ff0: 6e64 6578 0a20 2020 2020 2020 2020 2020  ndex.           
+00031000: 202d 206f 7574 6572 3a20 666f 726d 2075   - outer: form u
+00031010: 6e69 6f6e 206f 6620 6361 6c6c 696e 6720  nion of calling 
+00031020: 6672 616d 6527 7320 696e 6465 7820 286f  frame's index (o
+00031030: 7220 636f 6c75 6d6e 2069 6620 6f6e 2069  r column if on i
+00031040: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00031050: 7370 6563 6966 6965 6429 2077 6974 6820  specified) with 
+00031060: 6f74 6865 7220 6672 616d 6527 7320 696e  other frame's in
+00031070: 6465 782c 2061 6e64 2073 6f72 7420 6974  dex, and sort it
+00031080: 0a20 2020 2020 2020 2020 2020 2020 206c  .              l
+00031090: 6578 6963 6f67 7261 7068 6963 616c 6c79  exicographically
+000310a0: 0a20 2020 2020 2020 2020 2020 202d 2069  .            - i
+000310b0: 6e6e 6572 3a20 666f 726d 2069 6e74 6572  nner: form inter
+000310c0: 7365 6374 696f 6e20 6f66 2063 616c 6c69  section of calli
+000310d0: 6e67 2066 7261 6d65 2773 2069 6e64 6578  ng frame's index
+000310e0: 2028 6f72 2063 6f6c 756d 6e20 6966 0a20   (or column if. 
+000310f0: 2020 2020 2020 2020 2020 2020 206f 6e20               on 
+00031100: 6973 2073 7065 6369 6669 6564 2920 7769  is specified) wi
+00031110: 7468 206f 7468 6572 2066 7261 6d65 2773  th other frame's
+00031120: 2069 6e64 6578 2c20 7072 6573 6572 7669   index, preservi
+00031130: 6e67 2074 6865 206f 7264 6572 0a20 2020  ng the order.   
+00031140: 2020 2020 2020 2020 2020 206f 6620 7468             of th
+00031150: 6520 6361 6c6c 696e 6727 7320 6f6e 650a  e calling's one.
+00031160: 0a20 2020 2020 2020 206f 6e20 3a20 6c61  .        on : la
+00031170: 6265 6c20 6f72 206c 6973 740a 2020 2020  bel or list.    
+00031180: 2020 2020 2020 2020 436f 6c75 6d6e 206f          Column o
+00031190: 7220 696e 6465 7820 6c65 7665 6c20 6e61  r index level na
+000311a0: 6d65 7320 746f 206a 6f69 6e20 6f6e 2e20  mes to join on. 
+000311b0: 5468 6573 6520 6d75 7374 2062 6520 666f  These must be fo
+000311c0: 756e 6420 696e 2062 6f74 680a 2020 2020  und in both.    
+000311d0: 2020 2020 2020 2020 4461 7461 4672 616d          DataFram
+000311e0: 6573 2e20 4966 206f 6e20 6973 204e 6f6e  es. If on is Non
+000311f0: 6520 616e 6420 6e6f 7420 6d65 7267 696e  e and not mergin
+00031200: 6720 6f6e 2069 6e64 6578 6573 2074 6865  g on indexes the
+00031210: 6e20 7468 6973 0a20 2020 2020 2020 2020  n this.         
+00031220: 2020 2064 6566 6175 6c74 7320 746f 2074     defaults to t
+00031230: 6865 2069 6e74 6572 7365 6374 696f 6e20  he intersection 
+00031240: 6f66 2074 6865 2063 6f6c 756d 6e73 2069  of the columns i
+00031250: 6e20 626f 7468 2044 6174 6146 7261 6d65  n both DataFrame
+00031260: 732e 0a20 2020 2020 2020 206c 6566 745f  s..        left_
+00031270: 6f6e 203a 206c 6162 656c 206f 7220 6c69  on : label or li
+00031280: 7374 2c20 6f72 2061 7272 6179 2d6c 696b  st, or array-lik
+00031290: 650a 2020 2020 2020 2020 2020 2020 436f  e.            Co
+000312a0: 6c75 6d6e 2074 6f20 6a6f 696e 206f 6e20  lumn to join on 
+000312b0: 696e 2074 6865 206c 6566 7420 4461 7461  in the left Data
+000312c0: 4672 616d 652e 204f 7468 6572 2074 6861  Frame. Other tha
+000312d0: 6e20 696e 2070 616e 6461 730a 2020 2020  n in pandas.    
+000312e0: 2020 2020 2020 2020 6172 7261 7973 2061          arrays a
+000312f0: 6e64 206c 6973 7473 2061 7265 206f 6e6c  nd lists are onl
+00031300: 7920 7375 7070 6f72 7420 6966 2074 6865  y support if the
+00031310: 6972 206c 656e 6774 6820 6973 2031 2e0a  ir length is 1..
+00031320: 2020 2020 2020 2020 7269 6768 745f 6f6e          right_on
+00031330: 203a 206c 6162 656c 206f 7220 6c69 7374   : label or list
+00031340: 2c20 6f72 2061 7272 6179 2d6c 696b 650a  , or array-like.
+00031350: 2020 2020 2020 2020 2020 2020 436f 6c75              Colu
+00031360: 6d6e 2074 6f20 6a6f 696e 206f 6e20 696e  mn to join on in
+00031370: 2074 6865 2072 6967 6874 2044 6174 6146   the right DataF
+00031380: 7261 6d65 2e20 4f74 6865 7220 7468 616e  rame. Other than
+00031390: 2069 6e20 7061 6e64 6173 0a20 2020 2020   in pandas.     
+000313a0: 2020 2020 2020 2061 7272 6179 7320 616e         arrays an
+000313b0: 6420 6c69 7374 7320 6172 6520 6f6e 6c79  d lists are only
+000313c0: 2073 7570 706f 7274 2069 6620 7468 6569   support if thei
+000313d0: 7220 6c65 6e67 7468 2069 7320 312e 0a20  r length is 1.. 
+000313e0: 2020 2020 2020 206c 6566 745f 696e 6465         left_inde
+000313f0: 7820 3a20 626f 6f6c 6561 6e2c 2064 6566  x : boolean, def
+00031400: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
+00031410: 2020 2020 2020 2055 7365 2074 6865 2069         Use the i
+00031420: 6e64 6578 2066 726f 6d20 7468 6520 6c65  ndex from the le
+00031430: 6674 2044 6174 6146 7261 6d65 2061 7320  ft DataFrame as 
+00031440: 7468 6520 6a6f 696e 206b 6579 2e0a 2020  the join key..  
+00031450: 2020 2020 2020 7269 6768 745f 696e 6465        right_inde
+00031460: 7820 3a20 626f 6f6c 6561 6e2c 2064 6566  x : boolean, def
+00031470: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
+00031480: 2020 2020 2020 2055 7365 2074 6865 2069         Use the i
+00031490: 6e64 6578 2066 726f 6d20 7468 6520 7269  ndex from the ri
+000314a0: 6768 7420 4461 7461 4672 616d 6520 6173  ght DataFrame as
+000314b0: 2074 6865 206a 6f69 6e20 6b65 792e 0a20   the join key.. 
+000314c0: 2020 2020 2020 2073 7566 6669 7865 7320         suffixes 
+000314d0: 3a20 322d 6c65 6e67 7468 2073 6571 7565  : 2-length seque
+000314e0: 6e63 6520 2874 7570 6c65 2c20 6c69 7374  nce (tuple, list
+000314f0: 2c20 2e2e 2e29 0a20 2020 2020 2020 2020  , ...).         
+00031500: 2020 2053 7566 6669 7820 746f 2061 7070     Suffix to app
+00031510: 6c79 2074 6f20 6f76 6572 6c61 7070 696e  ly to overlappin
+00031520: 6720 636f 6c75 6d6e 206e 616d 6573 2069  g column names i
+00031530: 6e20 7468 6520 6c65 6674 2061 6e64 0a20  n the left and. 
+00031540: 2020 2020 2020 2020 2020 2072 6967 6874             right
+00031550: 2073 6964 652c 2072 6573 7065 6374 6976   side, respectiv
+00031560: 656c 790a 2020 2020 2020 2020 696e 6469  ely.        indi
+00031570: 6361 746f 7220 3a20 626f 6f6c 6561 6e20  cator : boolean 
+00031580: 6f72 2073 7472 696e 672c 2064 6566 6175  or string, defau
+00031590: 6c74 2046 616c 7365 0a20 2020 2020 2020  lt False.       
+000315a0: 2020 2020 2049 6620 5472 7565 2c20 6164       If True, ad
+000315b0: 6473 2061 2063 6f6c 756d 6e20 746f 206f  ds a column to o
+000315c0: 7574 7075 7420 4461 7461 4672 616d 6520  utput DataFrame 
+000315d0: 6361 6c6c 6564 2022 5f6d 6572 6765 2220  called "_merge" 
+000315e0: 7769 7468 0a20 2020 2020 2020 2020 2020  with.           
+000315f0: 2069 6e66 6f72 6d61 7469 6f6e 206f 6e20   information on 
+00031600: 7468 6520 736f 7572 6365 206f 6620 6561  the source of ea
+00031610: 6368 2072 6f77 2e20 4966 2073 7472 696e  ch row. If strin
+00031620: 672c 2063 6f6c 756d 6e20 7769 7468 0a20  g, column with. 
+00031630: 2020 2020 2020 2020 2020 2069 6e66 6f72             infor
+00031640: 6d61 7469 6f6e 206f 6e20 736f 7572 6365  mation on source
+00031650: 206f 6620 6561 6368 2072 6f77 2077 696c   of each row wil
+00031660: 6c20 6265 2061 6464 6564 2074 6f20 6f75  l be added to ou
+00031670: 7470 7574 2044 6174 6146 7261 6d65 2c0a  tput DataFrame,.
+00031680: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00031690: 636f 6c75 6d6e 2077 696c 6c20 6265 206e  column will be n
+000316a0: 616d 6564 2076 616c 7565 206f 6620 7374  amed value of st
+000316b0: 7269 6e67 2e20 496e 666f 726d 6174 696f  ring. Informatio
+000316c0: 6e20 636f 6c75 6d6e 2069 730a 2020 2020  n column is.    
+000316d0: 2020 2020 2020 2020 4361 7465 676f 7269          Categori
+000316e0: 6361 6c2d 7479 7065 2061 6e64 2074 616b  cal-type and tak
+000316f0: 6573 206f 6e20 6120 7661 6c75 6520 6f66  es on a value of
+00031700: 2022 6c65 6674 5f6f 6e6c 7922 2066 6f72   "left_only" for
+00031710: 206f 6273 6572 7661 7469 6f6e 730a 2020   observations.  
+00031720: 2020 2020 2020 2020 2020 7768 6f73 6520            whose 
+00031730: 6d65 7267 6520 6b65 7920 6f6e 6c79 2061  merge key only a
+00031740: 7070 6561 7273 2069 6e20 606c 6566 7460  ppears in `left`
+00031750: 2044 6174 6146 7261 6d65 2c20 2272 6967   DataFrame, "rig
+00031760: 6874 5f6f 6e6c 7922 2066 6f72 0a20 2020  ht_only" for.   
+00031770: 2020 2020 2020 2020 206f 6273 6572 7661           observa
+00031780: 7469 6f6e 7320 7768 6f73 6520 6d65 7267  tions whose merg
+00031790: 6520 6b65 7920 6f6e 6c79 2061 7070 6561  e key only appea
+000317a0: 7273 2069 6e20 6072 6967 6874 6020 4461  rs in `right` Da
+000317b0: 7461 4672 616d 652c 0a20 2020 2020 2020  taFrame,.       
+000317c0: 2020 2020 2061 6e64 2022 626f 7468 2220       and "both" 
+000317d0: 6966 2074 6865 206f 6273 6572 7661 7469  if the observati
+000317e0: 6f6e e280 9973 206d 6572 6765 206b 6579  on...s merge key
+000317f0: 2069 7320 666f 756e 6420 696e 2062 6f74   is found in bot
+00031800: 682e 0a20 2020 2020 2020 206e 7061 7274  h..        npart
+00031810: 6974 696f 6e73 3a20 696e 7420 6f72 204e  itions: int or N
+00031820: 6f6e 652c 206f 7074 696f 6e61 6c0a 2020  one, optional.  
+00031830: 2020 2020 2020 2020 2020 5468 6520 6964            The id
+00031840: 6561 6c20 6e75 6d62 6572 206f 6620 6f75  eal number of ou
+00031850: 7470 7574 2070 6172 7469 7469 6f6e 732e  tput partitions.
+00031860: 2054 6869 7320 6973 206f 6e6c 7920 7574   This is only ut
+00031870: 696c 6973 6564 2077 6865 6e0a 2020 2020  ilised when.    
+00031880: 2020 2020 2020 2020 7065 7266 6f72 6d69          performi
+00031890: 6e67 2061 2068 6173 685f 6a6f 696e 2028  ng a hash_join (
+000318a0: 6d65 7267 696e 6720 6f6e 2063 6f6c 756d  merging on colum
+000318b0: 6e73 206f 6e6c 7929 2e20 4966 2060 604e  ns only). If ``N
+000318c0: 6f6e 6560 6020 7468 656e 0a20 2020 2020  one`` then.     
+000318d0: 2020 2020 2020 2060 606e 7061 7274 6974         ``npartit
+000318e0: 696f 6e73 203d 206d 6178 286c 6873 2e6e  ions = max(lhs.n
+000318f0: 7061 7274 6974 696f 6e73 2c20 7268 732e  partitions, rhs.
+00031900: 6e70 6172 7469 7469 6f6e 7329 6060 2e0a  npartitions)``..
+00031910: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
+00031920: 756c 7420 6973 2060 604e 6f6e 6560 602e  ult is ``None``.
+00031930: 0a20 2020 2020 2020 2073 6875 6666 6c65  .        shuffle
+00031940: 3a20 7b27 6469 736b 272c 2027 7461 736b  : {'disk', 'task
+00031950: 7327 7d2c 206f 7074 696f 6e61 6c0a 2020  s'}, optional.  
+00031960: 2020 2020 2020 2020 2020 4569 7468 6572            Either
+00031970: 2060 6027 6469 736b 2760 6020 666f 7220   ``'disk'`` for 
+00031980: 7369 6e67 6c65 2d6e 6f64 6520 6f70 6572  single-node oper
+00031990: 6174 696f 6e20 6f72 2060 6027 7461 736b  ation or ``'task
+000319a0: 7327 6060 2066 6f72 0a20 2020 2020 2020  s'`` for.       
+000319b0: 2020 2020 2064 6973 7472 6962 7574 6564       distributed
+000319c0: 206f 7065 7261 7469 6f6e 2e20 2057 696c   operation.  Wil
+000319d0: 6c20 6265 2069 6e66 6572 7265 6420 6279  l be inferred by
+000319e0: 2079 6f75 7220 6375 7272 656e 7420 7363   your current sc
+000319f0: 6865 6475 6c65 722e 0a20 2020 2020 2020  heduler..       
+00031a00: 2062 726f 6164 6361 7374 3a20 626f 6f6c   broadcast: bool
+00031a10: 6561 6e20 6f72 2066 6c6f 6174 2c20 6f70  ean or float, op
+00031a20: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00031a30: 2020 2057 6865 7468 6572 2074 6f20 7573     Whether to us
+00031a40: 6520 6120 6272 6f61 6463 6173 742d 6261  e a broadcast-ba
+00031a50: 7365 6420 6a6f 696e 2069 6e20 6c69 6575  sed join in lieu
+00031a60: 206f 6620 6120 7368 7566 666c 652d 6261   of a shuffle-ba
+00031a70: 7365 640a 2020 2020 2020 2020 2020 2020  sed.            
+00031a80: 6a6f 696e 2066 6f72 2073 7570 706f 7274  join for support
+00031a90: 6564 2063 6173 6573 2e20 2042 7920 6465  ed cases.  By de
+00031aa0: 6661 756c 742c 2061 2073 696d 706c 6520  fault, a simple 
+00031ab0: 6865 7572 6973 7469 6320 7769 6c6c 2062  heuristic will b
+00031ac0: 650a 2020 2020 2020 2020 2020 2020 7573  e.            us
+00031ad0: 6564 2074 6f20 7365 6c65 6374 2074 6865  ed to select the
+00031ae0: 2075 6e64 6572 6c79 696e 6720 616c 676f   underlying algo
+00031af0: 7269 7468 6d2e 2049 6620 6120 666c 6f61  rithm. If a floa
+00031b00: 7469 6e67 2d70 6f69 6e74 2076 616c 7565  ting-point value
+00031b10: 0a20 2020 2020 2020 2020 2020 2069 7320  .            is 
+00031b20: 7370 6563 6966 6965 642c 2074 6861 7420  specified, that 
+00031b30: 6e75 6d62 6572 2077 696c 6c20 6265 2075  number will be u
+00031b40: 7365 6420 6173 2074 6865 2060 6062 726f  sed as the ``bro
+00031b50: 6164 6361 7374 5f62 6961 7360 600a 2020  adcast_bias``.  
+00031b60: 2020 2020 2020 2020 2020 7769 7468 696e            within
+00031b70: 2074 6865 2073 696d 706c 6520 6865 7572   the simple heur
+00031b80: 6973 7469 6320 2861 206c 6172 6765 206e  istic (a large n
+00031b90: 756d 6265 7220 6d61 6b65 7320 4461 736b  umber makes Dask
+00031ba0: 206d 6f72 6520 6c69 6b65 6c79 0a20 2020   more likely.   
+00031bb0: 2020 2020 2020 2020 2074 6f20 6368 6f6f           to choo
+00031bc0: 7365 2074 6865 2060 6062 726f 6163 6173  se the ``broacas
+00031bd0: 745f 6a6f 696e 6060 2063 6f64 6520 7061  t_join`` code pa
+00031be0: 7468 292e 2053 6565 2060 6062 726f 6164  th). See ``broad
+00031bf0: 6361 7374 5f6a 6f69 6e60 600a 2020 2020  cast_join``.    
+00031c00: 2020 2020 2020 2020 666f 7220 6d6f 7265          for more
+00031c10: 2069 6e66 6f72 6d61 7469 6f6e 2e0a 0a20   information... 
+00031c20: 2020 2020 2020 204e 6f74 6573 0a20 2020         Notes.   
+00031c30: 2020 2020 202d 2d2d 2d2d 0a0a 2020 2020       -----..    
+00031c40: 2020 2020 5468 6572 6520 6172 6520 7468      There are th
+00031c50: 7265 6520 7761 7973 2074 6f20 6a6f 696e  ree ways to join
+00031c60: 2064 6174 6166 7261 6d65 733a 0a0a 2020   dataframes:..  
+00031c70: 2020 2020 2020 312e 204a 6f69 6e69 6e67        1. Joining
+00031c80: 206f 6e20 696e 6469 6365 732e 2049 6e20   on indices. In 
+00031c90: 7468 6973 2063 6173 6520 7468 6520 6469  this case the di
+00031ca0: 7669 7369 6f6e 7320 6172 650a 2020 2020  visions are.    
+00031cb0: 2020 2020 2020 2061 6c69 676e 6564 2075         aligned u
+00031cc0: 7369 6e67 2074 6865 2066 756e 6374 696f  sing the functio
+00031cd0: 6e20 6060 6461 736b 2e64 6174 6166 7261  n ``dask.datafra
+00031ce0: 6d65 2e6d 756c 7469 2e61 6c69 676e 5f70  me.multi.align_p
+00031cf0: 6172 7469 7469 6f6e 7360 602e 0a20 2020  artitions``..   
+00031d00: 2020 2020 2020 2020 4166 7465 7277 6172          Afterwar
+00031d10: 6473 2c20 6561 6368 2070 6172 7469 7469  ds, each partiti
+00031d20: 6f6e 2069 7320 6d65 7267 6564 2077 6974  on is merged wit
+00031d30: 6820 7468 6520 7061 6e64 6173 206d 6572  h the pandas mer
+00031d40: 6765 2066 756e 6374 696f 6e2e 0a0a 2020  ge function...  
+00031d50: 2020 2020 2020 322e 204a 6f69 6e69 6e67        2. Joining
+00031d60: 206f 6e65 206f 6e20 696e 6465 7820 616e   one on index an
+00031d70: 6420 6f6e 6520 6f6e 2063 6f6c 756d 6e2e  d one on column.
+00031d80: 2049 6e20 7468 6973 2063 6173 6520 7468   In this case th
+00031d90: 6520 6469 7669 7369 6f6e 7320 6f66 0a20  e divisions of. 
+00031da0: 2020 2020 2020 2020 2020 6461 7461 6672            datafr
+00031db0: 616d 6520 6d65 7267 6564 2062 7920 696e  ame merged by in
+00031dc0: 6465 7820 283a 6d61 7468 3a60 645f 6960  dex (:math:`d_i`
+00031dd0: 2920 6172 6520 7573 6564 2074 6f20 6469  ) are used to di
+00031de0: 7669 6465 2074 6865 2063 6f6c 756d 6e0a  vide the column.
+00031df0: 2020 2020 2020 2020 2020 206d 6572 6765             merge
+00031e00: 6420 6461 7461 6672 616d 6520 283a 6d61  d dataframe (:ma
+00031e10: 7468 3a60 645f 6360 2920 6f6e 6520 7573  th:`d_c`) one us
+00031e20: 696e 670a 2020 2020 2020 2020 2020 2060  ing.           `
+00031e30: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
+00031e40: 6d75 6c74 692e 7265 6172 7261 6e67 655f  multi.rearrange_
+00031e50: 6279 5f64 6976 6973 696f 6e73 6060 2e20  by_divisions``. 
+00031e60: 496e 2074 6869 7320 6361 7365 2074 6865  In this case the
+00031e70: 0a20 2020 2020 2020 2020 2020 6d65 7267  .           merg
+00031e80: 6564 2064 6174 6166 7261 6d65 2028 3a6d  ed dataframe (:m
+00031e90: 6174 683a 6064 5f6d 6029 2068 6173 2074  ath:`d_m`) has t
+00031ea0: 6865 2065 7861 6374 2073 616d 6520 6469  he exact same di
+00031eb0: 7669 7369 6f6e 730a 2020 2020 2020 2020  visions.        
+00031ec0: 2020 2061 7320 283a 6d61 7468 3a60 645f     as (:math:`d_
+00031ed0: 6960 292e 2054 6869 7320 6361 6e20 6c65  i`). This can le
+00031ee0: 6164 2074 6f20 6973 7375 6573 2069 6620  ad to issues if 
+00031ef0: 796f 7520 6d65 7267 6520 6d75 6c74 6970  you merge multip
+00031f00: 6c65 2072 6f77 7320 6672 6f6d 0a20 2020  le rows from.   
+00031f10: 2020 2020 2020 2020 283a 6d61 7468 3a60          (:math:`
+00031f20: 645f 6360 2920 746f 206f 6e65 2072 6f77  d_c`) to one row
+00031f30: 2069 6e20 283a 6d61 7468 3a60 645f 6960   in (:math:`d_i`
+00031f40: 292e 0a0a 2020 2020 2020 2020 332e 204a  )...        3. J
+00031f50: 6f69 6e69 6e67 2062 6f74 6820 6f6e 2063  oining both on c
+00031f60: 6f6c 756d 6e73 2e20 496e 2074 6869 7320  olumns. In this 
+00031f70: 6361 7365 2061 2068 6173 6820 6a6f 696e  case a hash join
+00031f80: 2069 7320 7065 7266 6f72 6d65 6420 7573   is performed us
+00031f90: 696e 670a 2020 2020 2020 2020 2020 2060  ing.           `
+00031fa0: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
+00031fb0: 6d75 6c74 692e 6861 7368 5f6a 6f69 6e60  multi.hash_join`
+00031fc0: 602e 0a0a 2020 2020 2020 2020 496e 2073  `...        In s
+00031fd0: 6f6d 6520 6361 7365 732c 2079 6f75 206d  ome cases, you m
+00031fe0: 6179 2073 6565 2061 2060 604d 656d 6f72  ay see a ``Memor
+00031ff0: 7945 7272 6f72 6060 2069 6620 7468 6520  yError`` if the 
+00032000: 6060 6d65 7267 6560 6020 6f70 6572 6174  ``merge`` operat
+00032010: 696f 6e20 7265 7175 6972 6573 0a20 2020  ion requires.   
+00032020: 2020 2020 2061 6e20 696e 7465 726e 616c       an internal
+00032030: 2060 6073 6875 6666 6c65 6060 2c20 6265   ``shuffle``, be
+00032040: 6361 7573 6520 7368 7566 666c 696e 6720  cause shuffling 
+00032050: 706c 6163 6573 2061 6c6c 2072 6f77 7320  places all rows 
+00032060: 7468 6174 2068 6176 6520 7468 6520 7361  that have the sa
+00032070: 6d65 0a20 2020 2020 2020 2069 6e64 6578  me.        index
+00032080: 2069 6e20 7468 6520 7361 6d65 2070 6172   in the same par
+00032090: 7469 7469 6f6e 2e20 546f 2061 766f 6964  tition. To avoid
+000320a0: 2074 6869 7320 6572 726f 722c 206d 616b   this error, mak
+000320b0: 6520 7375 7265 2061 6c6c 2072 6f77 7320  e sure all rows 
+000320c0: 7769 7468 2074 6865 0a20 2020 2020 2020  with the.       
+000320d0: 2073 616d 6520 6060 6f6e 6060 2d63 6f6c   same ``on``-col
+000320e0: 756d 6e20 7661 6c75 6520 6361 6e20 6669  umn value can fi
+000320f0: 7420 6f6e 2061 2073 696e 676c 6520 7061  t on a single pa
+00032100: 7274 6974 696f 6e2e 0a20 2020 2020 2020  rtition..       
+00032110: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
+00032120: 206e 6f74 2069 735f 6461 7461 6672 616d   not is_datafram
+00032130: 655f 6c69 6b65 2872 6967 6874 293a 0a20  e_like(right):. 
+00032140: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00032150: 2056 616c 7565 4572 726f 7228 2272 6967   ValueError("rig
+00032160: 6874 206d 7573 7420 6265 2044 6174 6146  ht must be DataF
+00032170: 7261 6d65 2229 0a0a 2020 2020 2020 2020  rame")..        
+00032180: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
+00032190: 616d 652e 6d75 6c74 6920 696d 706f 7274  ame.multi import
+000321a0: 206d 6572 6765 0a0a 2020 2020 2020 2020   merge..        
+000321b0: 7265 7475 726e 206d 6572 6765 280a 2020  return merge(.  
+000321c0: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
+000321d0: 2020 2020 2020 2020 2020 2020 7269 6768              righ
+000321e0: 742c 0a20 2020 2020 2020 2020 2020 2068  t,.            h
+000321f0: 6f77 3d68 6f77 2c0a 2020 2020 2020 2020  ow=how,.        
+00032200: 2020 2020 6f6e 3d6f 6e2c 0a20 2020 2020      on=on,.     
+00032210: 2020 2020 2020 206c 6566 745f 6f6e 3d6c         left_on=l
+00032220: 6566 745f 6f6e 2c0a 2020 2020 2020 2020  eft_on,.        
+00032230: 2020 2020 7269 6768 745f 6f6e 3d72 6967      right_on=rig
+00032240: 6874 5f6f 6e2c 0a20 2020 2020 2020 2020  ht_on,.         
+00032250: 2020 206c 6566 745f 696e 6465 783d 6c65     left_index=le
+00032260: 6674 5f69 6e64 6578 2c0a 2020 2020 2020  ft_index,.      
+00032270: 2020 2020 2020 7269 6768 745f 696e 6465        right_inde
+00032280: 783d 7269 6768 745f 696e 6465 782c 0a20  x=right_index,. 
+00032290: 2020 2020 2020 2020 2020 2073 7566 6669             suffi
+000322a0: 7865 733d 7375 6666 6978 6573 2c0a 2020  xes=suffixes,.  
+000322b0: 2020 2020 2020 2020 2020 6e70 6172 7469            nparti
+000322c0: 7469 6f6e 733d 6e70 6172 7469 7469 6f6e  tions=npartition
+000322d0: 732c 0a20 2020 2020 2020 2020 2020 2069  s,.            i
+000322e0: 6e64 6963 6174 6f72 3d69 6e64 6963 6174  ndicator=indicat
+000322f0: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
+00032300: 7368 7566 666c 653d 7368 7566 666c 652c  shuffle=shuffle,
+00032310: 0a20 2020 2020 2020 2020 2020 2062 726f  .            bro
+00032320: 6164 6361 7374 3d62 726f 6164 6361 7374  adcast=broadcast
+00032330: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00032340: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00032350: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00032360: 2064 6566 206a 6f69 6e28 0a20 2020 2020   def join(.     
+00032370: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00032380: 206f 7468 6572 2c0a 2020 2020 2020 2020   other,.        
+00032390: 6f6e 3d4e 6f6e 652c 0a20 2020 2020 2020  on=None,.       
+000323a0: 2068 6f77 3d22 6c65 6674 222c 0a20 2020   how="left",.   
+000323b0: 2020 2020 206c 7375 6666 6978 3d22 222c       lsuffix="",
+000323c0: 0a20 2020 2020 2020 2072 7375 6666 6978  .        rsuffix
+000323d0: 3d22 222c 0a20 2020 2020 2020 206e 7061  ="",.        npa
+000323e0: 7274 6974 696f 6e73 3d4e 6f6e 652c 0a20  rtitions=None,. 
+000323f0: 2020 2020 2020 2073 6875 6666 6c65 3d4e         shuffle=N
+00032400: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
+00032410: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
+00032420: 5f6c 696b 6528 6f74 6865 7229 2061 6e64  _like(other) and
+00032430: 2068 6173 6174 7472 286f 7468 6572 2c20   hasattr(other, 
+00032440: 226e 616d 6522 293a 0a20 2020 2020 2020  "name"):.       
+00032450: 2020 2020 206f 7468 6572 203d 206f 7468       other = oth
+00032460: 6572 2e74 6f5f 6672 616d 6528 290a 0a20  er.to_frame().. 
+00032470: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00032480: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
+00032490: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
+000324a0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+000324b0: 7461 6e63 6528 6f74 6865 722c 206c 6973  tance(other, lis
+000324c0: 7429 206f 7220 6e6f 7420 616c 6c28 0a20  t) or not all(. 
+000324d0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+000324e0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+000324f0: 6528 6f29 2066 6f72 206f 2069 6e20 6f74  e(o) for o in ot
+00032500: 6865 725d 0a20 2020 2020 2020 2020 2020  her].           
+00032510: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+00032520: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00032530: 7272 6f72 2822 6f74 6865 7220 6d75 7374  rror("other must
+00032540: 2062 6520 4461 7461 4672 616d 6520 6f72   be DataFrame or
+00032550: 206c 6973 7420 6f66 2044 6174 6146 7261   list of DataFra
+00032560: 6d65 7322 290a 2020 2020 2020 2020 2020  mes").          
+00032570: 2020 6966 2068 6f77 206e 6f74 2069 6e20    if how not in 
+00032580: 5b22 6f75 7465 7222 2c20 226c 6566 7422  ["outer", "left"
+00032590: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+000325a0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000325b0: 726f 7228 226d 6572 6765 5f6d 756c 7469  ror("merge_multi
+000325c0: 206f 6e6c 7920 7375 7070 6f72 7473 206c   only supports l
+000325d0: 6566 7420 6f72 206f 7574 6572 206a 6f69  eft or outer joi
+000325e0: 6e73 2229 0a0a 2020 2020 2020 2020 2020  ns")..          
+000325f0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+00032600: 6672 616d 652e 6d75 6c74 6920 696d 706f  frame.multi impo
+00032610: 7274 205f 7265 6375 7273 6976 655f 7061  rt _recursive_pa
+00032620: 6972 7769 7365 5f6f 7574 6572 5f6a 6f69  irwise_outer_joi
+00032630: 6e0a 0a20 2020 2020 2020 2020 2020 2023  n..            #
+00032640: 2049 6620 6974 7320 616e 206f 7574 6572   If its an outer
+00032650: 206a 6f69 6e20 7765 2063 616e 2075 7365   join we can use
+00032660: 2074 6865 2066 756c 6c20 7265 6375 7273   the full recurs
+00032670: 6976 6520 7061 6972 7769 7365 206a 6f69  ive pairwise joi
+00032680: 6e2e 0a20 2020 2020 2020 2020 2020 2069  n..            i
+00032690: 6620 686f 7720 3d3d 2022 6f75 7465 7222  f how == "outer"
+000326a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000326b0: 2020 6675 6c6c 203d 205b 7365 6c66 5d20    full = [self] 
+000326c0: 2b20 6f74 6865 720a 0a20 2020 2020 2020  + other..       
+000326d0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000326e0: 5f72 6563 7572 7369 7665 5f70 6169 7277  _recursive_pairw
+000326f0: 6973 655f 6f75 7465 725f 6a6f 696e 280a  ise_outer_join(.
+00032700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032710: 2020 2020 6675 6c6c 2c0a 2020 2020 2020      full,.      
+00032720: 2020 2020 2020 2020 2020 2020 2020 6f6e                on
+00032730: 3d6f 6e2c 0a20 2020 2020 2020 2020 2020  =on,.           
+00032740: 2020 2020 2020 2020 206c 7375 6666 6978           lsuffix
+00032750: 3d6c 7375 6666 6978 2c0a 2020 2020 2020  =lsuffix,.      
+00032760: 2020 2020 2020 2020 2020 2020 2020 7273                rs
+00032770: 7566 6669 783d 7273 7566 6669 782c 0a20  uffix=rsuffix,. 
+00032780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032790: 2020 206e 7061 7274 6974 696f 6e73 3d6e     npartitions=n
+000327a0: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
+000327b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000327c0: 7368 7566 666c 653d 7368 7566 666c 652c  shuffle=shuffle,
+000327d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000327e0: 2029 0a20 2020 2020 2020 2020 2020 2065   ).            e
+000327f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00032800: 2020 2020 2023 2044 6f20 7265 6375 7273       # Do recurs
+00032810: 6976 6520 7061 6972 7769 7365 206a 6f69  ive pairwise joi
+00032820: 6e20 6f6e 2065 7665 7279 7468 696e 6720  n on everything 
+00032830: 5f65 7863 6570 745f 2074 6865 206c 6173  _except_ the las
+00032840: 7420 6a6f 696e 0a20 2020 2020 2020 2020  t join.         
+00032850: 2020 2020 2020 2023 2077 6865 7265 2077         # where w
+00032860: 6520 6e65 6564 2074 6f20 646f 2061 206c  e need to do a l
+00032870: 6566 7420 6a6f 696e 2e0a 2020 2020 2020  eft join..      
+00032880: 2020 2020 2020 2020 2020 6f74 6865 7220            other 
+00032890: 3d20 5f72 6563 7572 7369 7665 5f70 6169  = _recursive_pai
+000328a0: 7277 6973 655f 6f75 7465 725f 6a6f 696e  rwise_outer_join
+000328b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000328c0: 2020 2020 2020 6f74 6865 722c 0a20 2020        other,.   
+000328d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000328e0: 206f 6e3d 6f6e 2c0a 2020 2020 2020 2020   on=on,.        
+000328f0: 2020 2020 2020 2020 2020 2020 6c73 7566              lsuf
+00032900: 6669 783d 6c73 7566 6669 782c 0a20 2020  fix=lsuffix,.   
+00032910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032920: 2072 7375 6666 6978 3d72 7375 6666 6978   rsuffix=rsuffix
+00032930: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00032940: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
+00032950: 733d 6e70 6172 7469 7469 6f6e 732c 0a20  s=npartitions,. 
+00032960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032970: 2020 2073 6875 6666 6c65 3d73 6875 6666     shuffle=shuff
+00032980: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
+00032990: 2020 2020 290a 0a20 2020 2020 2020 2066      )..        f
+000329a0: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+000329b0: 6d65 2e6d 756c 7469 2069 6d70 6f72 7420  me.multi import 
+000329c0: 6d65 7267 650a 0a20 2020 2020 2020 2072  merge..        r
+000329d0: 6574 7572 6e20 6d65 7267 6528 0a20 2020  eturn merge(.   
+000329e0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
+000329f0: 2020 2020 2020 2020 2020 206f 7468 6572             other
+00032a00: 2c0a 2020 2020 2020 2020 2020 2020 686f  ,.            ho
+00032a10: 773d 686f 772c 0a20 2020 2020 2020 2020  w=how,.         
+00032a20: 2020 206c 6566 745f 696e 6465 783d 6f6e     left_index=on
+00032a30: 2069 7320 4e6f 6e65 2c0a 2020 2020 2020   is None,.      
+00032a40: 2020 2020 2020 7269 6768 745f 696e 6465        right_inde
+00032a50: 783d 5472 7565 2c0a 2020 2020 2020 2020  x=True,.        
+00032a60: 2020 2020 6c65 6674 5f6f 6e3d 6f6e 2c0a      left_on=on,.
+00032a70: 2020 2020 2020 2020 2020 2020 7375 6666              suff
+00032a80: 6978 6573 3d28 6c73 7566 6669 782c 2072  ixes=(lsuffix, r
+00032a90: 7375 6666 6978 292c 0a20 2020 2020 2020  suffix),.       
+00032aa0: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
+00032ab0: 3d6e 7061 7274 6974 696f 6e73 2c0a 2020  =npartitions,.  
+00032ac0: 2020 2020 2020 2020 2020 7368 7566 666c            shuffl
+00032ad0: 653d 7368 7566 666c 652c 0a20 2020 2020  e=shuffle,.     
+00032ae0: 2020 2029 0a0a 2020 2020 6966 206e 6f74     )..    if not
+00032af0: 2050 414e 4441 535f 4754 5f32 3030 3a0a   PANDAS_GT_200:.
+00032b00: 0a20 2020 2020 2020 2040 6465 7269 7665  .        @derive
+00032b10: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00032b20: 616d 6529 0a20 2020 2020 2020 2064 6566  ame).        def
+00032b30: 2061 7070 656e 6428 7365 6c66 2c20 6f74   append(self, ot
+00032b40: 6865 722c 2069 6e74 6572 6c65 6176 655f  her, interleave_
+00032b50: 7061 7274 6974 696f 6e73 3d46 616c 7365  partitions=False
+00032b60: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00032b70: 6620 6973 696e 7374 616e 6365 286f 7468  f isinstance(oth
+00032b80: 6572 2c20 5365 7269 6573 293a 0a20 2020  er, Series):.   
+00032b90: 2020 2020 2020 2020 2020 2020 206d 7367               msg
+00032ba0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00032bb0: 2020 2020 2020 2020 2022 556e 6162 6c65           "Unable
+00032bc0: 2074 6f20 6170 7065 6e64 696e 6720 6464   to appending dd
+00032bd0: 2e53 6572 6965 7320 746f 2064 642e 4461  .Series to dd.Da
+00032be0: 7461 4672 616d 652e 220a 2020 2020 2020  taFrame.".      
+00032bf0: 2020 2020 2020 2020 2020 2020 2020 2255                "U
+00032c00: 7365 2070 642e 5365 7269 6573 2074 6f20  se pd.Series to 
+00032c10: 6170 7065 6e64 2061 7320 726f 772e 220a  append as row.".
+00032c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032c30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00032c40: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00032c50: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
+00032c60: 2020 2020 656c 6966 2069 735f 7365 7269      elif is_seri
+00032c70: 6573 5f6c 696b 6528 6f74 6865 7229 3a0a  es_like(other):.
+00032c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032c90: 6f74 6865 7220 3d20 6f74 6865 722e 746f  other = other.to
+00032ca0: 5f66 7261 6d65 2829 2e54 0a20 2020 2020  _frame().T.     
+00032cb0: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
+00032cc0: 7065 7228 292e 6170 7065 6e64 286f 7468  per().append(oth
+00032cd0: 6572 2c20 696e 7465 726c 6561 7665 5f70  er, interleave_p
+00032ce0: 6172 7469 7469 6f6e 733d 696e 7465 726c  artitions=interl
+00032cf0: 6561 7665 5f70 6172 7469 7469 6f6e 7329  eave_partitions)
+00032d00: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00032d10: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+00032d20: 290a 2020 2020 6465 6620 6974 6572 726f  ).    def iterro
+00032d30: 7773 2873 656c 6629 3a0a 2020 2020 2020  ws(self):.      
+00032d40: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00032d50: 2873 656c 662e 6e70 6172 7469 7469 6f6e  (self.npartition
+00032d60: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00032d70: 6466 203d 2073 656c 662e 6765 745f 7061  df = self.get_pa
+00032d80: 7274 6974 696f 6e28 6929 2e63 6f6d 7075  rtition(i).compu
+00032d90: 7465 2829 0a20 2020 2020 2020 2020 2020  te().           
+00032da0: 2079 6965 6c64 2066 726f 6d20 6466 2e69   yield from df.i
+00032db0: 7465 7272 6f77 7328 290a 0a20 2020 2040  terrows()..    @
+00032dc0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00032dd0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+00032de0: 6566 2069 7465 7274 7570 6c65 7328 7365  ef itertuples(se
+00032df0: 6c66 2c20 696e 6465 783d 5472 7565 2c20  lf, index=True, 
+00032e00: 6e61 6d65 3d22 5061 6e64 6173 2229 3a0a  name="Pandas"):.
+00032e10: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00032e20: 2072 616e 6765 2873 656c 662e 6e70 6172   range(self.npar
+00032e30: 7469 7469 6f6e 7329 3a0a 2020 2020 2020  titions):.      
+00032e40: 2020 2020 2020 6466 203d 2073 656c 662e        df = self.
+00032e50: 6765 745f 7061 7274 6974 696f 6e28 6929  get_partition(i)
+00032e60: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+00032e70: 2020 2020 2020 2079 6965 6c64 2066 726f         yield fro
+00032e80: 6d20 6466 2e69 7465 7274 7570 6c65 7328  m df.itertuples(
+00032e90: 696e 6465 783d 696e 6465 782c 206e 616d  index=index, nam
+00032ea0: 653d 6e61 6d65 290a 0a20 2020 2040 6465  e=name)..    @de
+00032eb0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00032ec0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+00032ed0: 2069 7465 6d73 2873 656c 6629 3a0a 2020   items(self):.  
+00032ee0: 2020 2020 2020 666f 7220 636f 6c5f 6964        for col_id
+00032ef0: 782c 206c 6162 656c 2069 6e20 656e 756d  x, label in enum
+00032f00: 6572 6174 6528 7365 6c66 2e63 6f6c 756d  erate(self.colum
+00032f10: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
+00032f20: 2079 6965 6c64 206c 6162 656c 2c20 7365   yield label, se
+00032f30: 6c66 2e69 6c6f 635b 3a2c 2063 6f6c 5f69  lf.iloc[:, col_i
+00032f40: 6478 5d0a 0a20 2020 2040 636c 6173 736d  dx]..    @classm
+00032f50: 6574 686f 640a 2020 2020 6465 6620 5f62  ethod.    def _b
+00032f60: 696e 645f 6f70 6572 6174 6f72 5f6d 6574  ind_operator_met
+00032f70: 686f 6428 636c 732c 206e 616d 652c 206f  hod(cls, name, o
+00032f80: 702c 206f 7269 6769 6e61 6c3d 7064 2e44  p, original=pd.D
+00032f90: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
+00032fa0: 2020 2022 2222 6269 6e64 206f 7065 7261     """bind opera
+00032fb0: 746f 7220 6d65 7468 6f64 206c 696b 6520  tor method like 
+00032fc0: 4461 7461 4672 616d 652e 6164 6420 746f  DataFrame.add to
+00032fd0: 2074 6869 7320 636c 6173 7322 2222 0a0a   this class"""..
+00032fe0: 2020 2020 2020 2020 2320 6e61 6d65 206d          # name m
+00032ff0: 7573 7420 6265 2065 7870 6c69 6369 746c  ust be explicitl
+00033000: 7920 7061 7373 6564 2066 6f72 2064 6976  y passed for div
+00033010: 206d 6574 686f 6420 7768 6f73 6520 6e61   method whose na
+00033020: 6d65 2069 7320 7472 7565 6469 760a 0a20  me is truediv.. 
+00033030: 2020 2020 2020 2064 6566 206d 6574 6828         def meth(
+00033040: 7365 6c66 2c20 6f74 6865 722c 2061 7869  self, other, axi
+00033050: 733d 2263 6f6c 756d 6e73 222c 206c 6576  s="columns", lev
+00033060: 656c 3d4e 6f6e 652c 2066 696c 6c5f 7661  el=None, fill_va
+00033070: 6c75 653d 4e6f 6e65 293a 0a20 2020 2020  lue=None):.     
+00033080: 2020 2020 2020 2069 6620 6c65 7665 6c20         if level 
+00033090: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000330a0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000330b0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+000330c0: 6445 7272 6f72 2822 6c65 7665 6c20 6d75  dError("level mu
+000330d0: 7374 2062 6520 4e6f 6e65 2229 0a0a 2020  st be None")..  
+000330e0: 2020 2020 2020 2020 2020 6178 6973 203d            axis =
+000330f0: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
+00033100: 6178 6973 2861 7869 7329 0a0a 2020 2020  axis(axis)..    
+00033110: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
+00033120: 696e 2028 312c 2022 636f 6c75 6d6e 7322  in (1, "columns"
+00033130: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00033140: 2020 2023 2057 6865 6e20 6178 6973 3d31     # When axis=1
+00033150: 2061 6e64 206f 7468 6572 2069 7320 6120   and other is a 
+00033160: 7365 7269 6573 2c20 606f 7468 6572 6020  series, `other` 
+00033170: 6973 2074 7261 6e73 706f 7365 640a 2020  is transposed.  
+00033180: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00033190: 616e 6420 7468 6520 6f70 6572 6174 6f72  and the operator
+000331a0: 2069 7320 6170 706c 6965 6420 6272 6f61   is applied broa
+000331b0: 6463 6173 7420 6163 726f 7373 2072 6f77  dcast across row
+000331c0: 732e 2054 6869 730a 2020 2020 2020 2020  s. This.        
+000331d0: 2020 2020 2020 2020 2320 6973 6e27 7420          # isn't 
+000331e0: 7375 7070 6f72 7465 6420 7769 7468 2064  supported with d
+000331f0: 642e 5365 7269 6573 2e0a 2020 2020 2020  d.Series..      
+00033200: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00033210: 6e73 7461 6e63 6528 6f74 6865 722c 2053  nstance(other, S
+00033220: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
+00033230: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
+00033240: 3d20 6622 556e 6162 6c65 2074 6f20 7b6e  = f"Unable to {n
+00033250: 616d 657d 2064 642e 5365 7269 6573 2077  ame} dd.Series w
+00033260: 6974 6820 6178 6973 3d31 220a 2020 2020  ith axis=1".    
 00033270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033280: 7265 7475 726e 206d 6170 5f70 6172 7469  return map_parti
-00033290: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
-000332a0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-000332b0: 702c 0a20 2020 2020 2020 2020 2020 2020  p,.             
-000332c0: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-000332d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000332e0: 2020 2020 2020 2020 206f 7468 6572 3d6f           other=o
-000332f0: 7468 6572 2c0a 2020 2020 2020 2020 2020  ther,.          
-00033300: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-00033310: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
-00033320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033330: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
-00033340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033350: 2020 2020 6669 6c6c 5f76 616c 7565 3d66      fill_value=f
-00033360: 696c 6c5f 7661 6c75 652c 0a20 2020 2020  ill_value,.     
-00033370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033380: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
-00033390: 6174 613d 4661 6c73 652c 0a20 2020 2020  ata=False,.     
-000333a0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000333b0: 0a0a 2020 2020 2020 2020 2020 2020 6d65  ..            me
-000333c0: 7461 203d 205f 656d 756c 6174 6528 6f70  ta = _emulate(op
-000333d0: 2c20 7365 6c66 2c20 6f74 6865 722c 2061  , self, other, a
-000333e0: 7869 733d 6178 6973 2c20 6669 6c6c 5f76  xis=axis, fill_v
-000333f0: 616c 7565 3d66 696c 6c5f 7661 6c75 6529  alue=fill_value)
-00033400: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00033410: 7572 6e20 6d61 705f 7061 7274 6974 696f  urn map_partitio
-00033420: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-00033430: 2020 2020 6f70 2c0a 2020 2020 2020 2020      op,.        
-00033440: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00033450: 2020 2020 2020 2020 2020 2020 2020 6f74                ot
-00033460: 6865 722c 0a20 2020 2020 2020 2020 2020  her,.           
-00033470: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
-00033480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033490: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
-000334a0: 2020 2020 2020 2020 2020 2066 696c 6c5f             fill_
-000334b0: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
-000334c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000334d0: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
-000334e0: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
-000334f0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00033500: 206d 6574 682e 5f5f 6e61 6d65 5f5f 203d   meth.__name__ =
-00033510: 206e 616d 650a 2020 2020 2020 2020 7365   name.        se
-00033520: 7461 7474 7228 636c 732c 206e 616d 652c  tattr(cls, name,
-00033530: 2064 6572 6976 6564 5f66 726f 6d28 6f72   derived_from(or
-00033540: 6967 696e 616c 2928 6d65 7468 2929 0a0a  iginal)(meth))..
-00033550: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-00033560: 0a20 2020 2064 6566 205f 6269 6e64 5f63  .    def _bind_c
-00033570: 6f6d 7061 7269 736f 6e5f 6d65 7468 6f64  omparison_method
-00033580: 2863 6c73 2c20 6e61 6d65 2c20 636f 6d70  (cls, name, comp
-00033590: 6172 6973 6f6e 2c20 6f72 6967 696e 616c  arison, original
-000335a0: 3d70 642e 4461 7461 4672 616d 6529 3a0a  =pd.DataFrame):.
-000335b0: 2020 2020 2020 2020 2222 2262 696e 6420          """bind 
-000335c0: 636f 6d70 6172 6973 6f6e 206d 6574 686f  comparison metho
-000335d0: 6420 6c69 6b65 2044 6174 6146 7261 6d65  d like DataFrame
-000335e0: 2e65 7120 746f 2074 6869 7320 636c 6173  .eq to this clas
-000335f0: 7322 2222 0a0a 2020 2020 2020 2020 6465  s"""..        de
-00033600: 6620 6d65 7468 2873 656c 662c 206f 7468  f meth(self, oth
-00033610: 6572 2c20 6178 6973 3d22 636f 6c75 6d6e  er, axis="column
-00033620: 7322 2c20 6c65 7665 6c3d 4e6f 6e65 293a  s", level=None):
-00033630: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00033640: 6c65 7665 6c20 6973 206e 6f74 204e 6f6e  level is not Non
-00033650: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00033660: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00033670: 656d 656e 7465 6445 7272 6f72 2822 6c65  ementedError("le
-00033680: 7665 6c20 6d75 7374 2062 6520 4e6f 6e65  vel must be None
-00033690: 2229 0a20 2020 2020 2020 2020 2020 2061  ").            a
-000336a0: 7869 7320 3d20 7365 6c66 2e5f 7661 6c69  xis = self._vali
-000336b0: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
-000336c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000336d0: 726e 2065 6c65 6d77 6973 6528 636f 6d70  rn elemwise(comp
-000336e0: 6172 6973 6f6e 2c20 7365 6c66 2c20 6f74  arison, self, ot
-000336f0: 6865 722c 2061 7869 733d 6178 6973 290a  her, axis=axis).
-00033700: 0a20 2020 2020 2020 206d 6574 682e 5f5f  .        meth.__
-00033710: 6e61 6d65 5f5f 203d 206e 616d 650a 2020  name__ = name.  
-00033720: 2020 2020 2020 7365 7461 7474 7228 636c        setattr(cl
-00033730: 732c 206e 616d 652c 2064 6572 6976 6564  s, name, derived
-00033740: 5f66 726f 6d28 6f72 6967 696e 616c 2928  _from(original)(
-00033750: 6d65 7468 2929 0a0a 2020 2020 4069 6e73  meth))..    @ins
-00033760: 6572 745f 6d65 7461 5f70 6172 616d 5f64  ert_meta_param_d
-00033770: 6573 6372 6970 7469 6f6e 2870 6164 3d31  escription(pad=1
-00033780: 3229 0a20 2020 2064 6566 2061 7070 6c79  2).    def apply
-00033790: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-000337a0: 2020 2020 2020 2020 6675 6e63 2c0a 2020          func,.  
-000337b0: 2020 2020 2020 6178 6973 3d30 2c0a 2020        axis=0,.  
-000337c0: 2020 2020 2020 6272 6f61 6463 6173 743d        broadcast=
-000337d0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7261  None,.        ra
-000337e0: 773d 4661 6c73 652c 0a20 2020 2020 2020  w=False,.       
-000337f0: 2072 6564 7563 653d 4e6f 6e65 2c0a 2020   reduce=None,.  
-00033800: 2020 2020 2020 6172 6773 3d28 292c 0a20        args=(),. 
-00033810: 2020 2020 2020 206d 6574 613d 6e6f 5f64         meta=no_d
-00033820: 6566 6175 6c74 2c0a 2020 2020 2020 2020  efault,.        
-00033830: 7265 7375 6c74 5f74 7970 653d 4e6f 6e65  result_type=None
-00033840: 2c0a 2020 2020 2020 2020 2a2a 6b77 6473  ,.        **kwds
-00033850: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00033860: 2022 2222 5061 7261 6c6c 656c 2076 6572   """Parallel ver
-00033870: 7369 6f6e 206f 6620 7061 6e64 6173 2e44  sion of pandas.D
-00033880: 6174 6146 7261 6d65 2e61 7070 6c79 0a0a  ataFrame.apply..
-00033890: 2020 2020 2020 2020 5468 6973 206d 696d          This mim
-000338a0: 6963 7320 7468 6520 7061 6e64 6173 2076  ics the pandas v
-000338b0: 6572 7369 6f6e 2065 7863 6570 7420 666f  ersion except fo
-000338c0: 7220 7468 6520 666f 6c6c 6f77 696e 673a  r the following:
-000338d0: 0a0a 2020 2020 2020 2020 312e 2020 4f6e  ..        1.  On
-000338e0: 6c79 2060 6061 7869 733d 3160 6020 6973  ly ``axis=1`` is
-000338f0: 2073 7570 706f 7274 6564 2028 616e 6420   supported (and 
-00033900: 6d75 7374 2062 6520 7370 6563 6966 6965  must be specifie
-00033910: 6420 6578 706c 6963 6974 6c79 292e 0a20  d explicitly).. 
-00033920: 2020 2020 2020 2032 2e20 2054 6865 2075         2.  The u
-00033930: 7365 7220 7368 6f75 6c64 2070 726f 7669  ser should provi
-00033940: 6465 206f 7574 7075 7420 6d65 7461 6461  de output metada
-00033950: 7461 2076 6961 2074 6865 2060 6d65 7461  ta via the `meta
-00033960: 6020 6b65 7977 6f72 642e 0a0a 2020 2020  ` keyword...    
-00033970: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00033980: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00033990: 2d0a 2020 2020 2020 2020 6675 6e63 203a  -.        func :
-000339a0: 2066 756e 6374 696f 6e0a 2020 2020 2020   function.      
-000339b0: 2020 2020 2020 4675 6e63 7469 6f6e 2074        Function t
-000339c0: 6f20 6170 706c 7920 746f 2065 6163 6820  o apply to each 
-000339d0: 636f 6c75 6d6e 2f72 6f77 0a20 2020 2020  column/row.     
-000339e0: 2020 2061 7869 7320 3a20 7b30 206f 7220     axis : {0 or 
-000339f0: 2769 6e64 6578 272c 2031 206f 7220 2763  'index', 1 or 'c
-00033a00: 6f6c 756d 6e73 277d 2c20 6465 6661 756c  olumns'}, defaul
-00033a10: 7420 300a 2020 2020 2020 2020 2020 2020  t 0.            
-00033a20: 2d20 3020 6f72 2027 696e 6465 7827 3a20  - 0 or 'index': 
-00033a30: 6170 706c 7920 6675 6e63 7469 6f6e 2074  apply function t
-00033a40: 6f20 6561 6368 2063 6f6c 756d 6e20 284e  o each column (N
-00033a50: 4f54 2053 5550 504f 5254 4544 290a 2020  OT SUPPORTED).  
-00033a60: 2020 2020 2020 2020 2020 2d20 3120 6f72            - 1 or
-00033a70: 2027 636f 6c75 6d6e 7327 3a20 6170 706c   'columns': appl
-00033a80: 7920 6675 6e63 7469 6f6e 2074 6f20 6561  y function to ea
-00033a90: 6368 2072 6f77 0a20 2020 2020 2020 2024  ch row.        $
-00033aa0: 4d45 5441 0a20 2020 2020 2020 2061 7267  META.        arg
-00033ab0: 7320 3a20 7475 706c 650a 2020 2020 2020  s : tuple.      
-00033ac0: 2020 2020 2020 506f 7369 7469 6f6e 616c        Positional
-00033ad0: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
-00033ae0: 7373 2074 6f20 6675 6e63 7469 6f6e 2069  ss to function i
-00033af0: 6e20 6164 6469 7469 6f6e 2074 6f20 7468  n addition to th
-00033b00: 6520 6172 7261 792f 7365 7269 6573 0a0a  e array/series..
-00033b10: 2020 2020 2020 2020 4164 6469 7469 6f6e          Addition
-00033b20: 616c 206b 6579 776f 7264 2061 7267 756d  al keyword argum
-00033b30: 656e 7473 2077 696c 6c20 6265 2070 6173  ents will be pas
-00033b40: 7365 6420 6173 206b 6579 776f 7264 7320  sed as keywords 
-00033b50: 746f 2074 6865 2066 756e 6374 696f 6e0a  to the function.
-00033b60: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00033b70: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00033b80: 0a20 2020 2020 2020 2061 7070 6c69 6564  .        applied
-00033b90: 203a 2053 6572 6965 7320 6f72 2044 6174   : Series or Dat
-00033ba0: 6146 7261 6d65 0a0a 2020 2020 2020 2020  aFrame..        
-00033bb0: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-00033bc0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00033bd0: 2020 3e3e 3e20 696d 706f 7274 2070 616e    >>> import pan
-00033be0: 6461 7320 6173 2070 640a 2020 2020 2020  das as pd.      
-00033bf0: 2020 3e3e 3e20 696d 706f 7274 2064 6173    >>> import das
-00033c00: 6b2e 6461 7461 6672 616d 6520 6173 2064  k.dataframe as d
-00033c10: 640a 2020 2020 2020 2020 3e3e 3e20 6466  d.        >>> df
-00033c20: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-00033c30: 7b27 7827 3a20 5b31 2c20 322c 2033 2c20  {'x': [1, 2, 3, 
-00033c40: 342c 2035 5d2c 0a20 2020 2020 2020 202e  4, 5],.        .
-00033c50: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
-00033c60: 2020 2020 2020 2779 273a 205b 312e 2c20        'y': [1., 
-00033c70: 322e 2c20 332e 2c20 342e 2c20 352e 5d7d  2., 3., 4., 5.]}
-00033c80: 290a 2020 2020 2020 2020 3e3e 3e20 6464  ).        >>> dd
-00033c90: 6620 3d20 6464 2e66 726f 6d5f 7061 6e64  f = dd.from_pand
-00033ca0: 6173 2864 662c 206e 7061 7274 6974 696f  as(df, npartitio
-00033cb0: 6e73 3d32 290a 0a20 2020 2020 2020 2041  ns=2)..        A
-00033cc0: 7070 6c79 2061 2066 756e 6374 696f 6e20  pply a function 
-00033cd0: 746f 2072 6f77 2d77 6973 6520 7061 7373  to row-wise pass
-00033ce0: 696e 6720 696e 2065 7874 7261 2061 7267  ing in extra arg
-00033cf0: 756d 656e 7473 2069 6e20 6060 6172 6773  uments in ``args
-00033d00: 6060 2061 6e64 0a20 2020 2020 2020 2060  `` and.        `
-00033d10: 606b 7761 7267 7360 603a 0a0a 2020 2020  `kwargs``:..    
-00033d20: 2020 2020 3e3e 3e20 6465 6620 6d79 6164      >>> def myad
-00033d30: 6428 726f 772c 2061 2c20 623d 3129 3a0a  d(row, a, b=1):.
-00033d40: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00033d50: 7265 7475 726e 2072 6f77 2e73 756d 2829  return row.sum()
-00033d60: 202b 2061 202b 2062 0a20 2020 2020 2020   + a + b.       
-00033d70: 203e 3e3e 2072 6573 203d 2064 6466 2e61   >>> res = ddf.a
-00033d80: 7070 6c79 286d 7961 6464 2c20 6178 6973  pply(myadd, axis
-00033d90: 3d31 2c20 6172 6773 3d28 322c 292c 2062  =1, args=(2,), b
-00033da0: 3d31 2e35 2920 2023 2064 6f63 7465 7374  =1.5)  # doctest
-00033db0: 3a20 2b53 4b49 500a 0a20 2020 2020 2020  : +SKIP..       
-00033dc0: 2042 7920 6465 6661 756c 742c 2064 6173   By default, das
-00033dd0: 6b20 7472 6965 7320 746f 2069 6e66 6572  k tries to infer
-00033de0: 2074 6865 206f 7574 7075 7420 6d65 7461   the output meta
-00033df0: 6461 7461 2062 7920 7275 6e6e 696e 6720  data by running 
-00033e00: 796f 7572 0a20 2020 2020 2020 2070 726f  your.        pro
-00033e10: 7669 6465 6420 6675 6e63 7469 6f6e 206f  vided function o
-00033e20: 6e20 736f 6d65 2066 616b 6520 6461 7461  n some fake data
-00033e30: 2e20 5468 6973 2077 6f72 6b73 2077 656c  . This works wel
-00033e40: 6c20 696e 206d 616e 7920 6361 7365 732c  l in many cases,
-00033e50: 2062 7574 0a20 2020 2020 2020 2063 616e   but.        can
-00033e60: 2073 6f6d 6574 696d 6573 2062 6520 6578   sometimes be ex
-00033e70: 7065 6e73 6976 652c 206f 7220 6576 656e  pensive, or even
-00033e80: 2066 6169 6c2e 2054 6f20 6176 6f69 6420   fail. To avoid 
-00033e90: 7468 6973 2c20 796f 7520 6361 6e0a 2020  this, you can.  
-00033ea0: 2020 2020 2020 6d61 6e75 616c 6c79 2073        manually s
-00033eb0: 7065 6369 6679 2074 6865 206f 7574 7075  pecify the outpu
-00033ec0: 7420 6d65 7461 6461 7461 2077 6974 6820  t metadata with 
-00033ed0: 7468 6520 6060 6d65 7461 6060 206b 6579  the ``meta`` key
-00033ee0: 776f 7264 2e20 5468 6973 0a20 2020 2020  word. This.     
-00033ef0: 2020 2063 616e 2062 6520 7370 6563 6966     can be specif
-00033f00: 6965 6420 696e 206d 616e 7920 666f 726d  ied in many form
-00033f10: 732c 2066 6f72 206d 6f72 6520 696e 666f  s, for more info
-00033f20: 726d 6174 696f 6e20 7365 650a 2020 2020  rmation see.    
-00033f30: 2020 2020 6060 6461 736b 2e64 6174 6166      ``dask.dataf
-00033f40: 7261 6d65 2e75 7469 6c73 2e6d 616b 655f  rame.utils.make_
-00033f50: 6d65 7461 6060 2e0a 0a20 2020 2020 2020  meta``...       
-00033f60: 2048 6572 6520 7765 2073 7065 6369 6679   Here we specify
-00033f70: 2074 6865 206f 7574 7075 7420 6973 2061   the output is a
-00033f80: 2053 6572 6965 7320 7769 7468 206e 616d   Series with nam
-00033f90: 6520 6060 2778 2760 602c 2061 6e64 2064  e ``'x'``, and d
-00033fa0: 7479 7065 0a20 2020 2020 2020 2060 6066  type.        ``f
-00033fb0: 6c6f 6174 3634 6060 3a0a 0a20 2020 2020  loat64``:..     
-00033fc0: 2020 203e 3e3e 2072 6573 203d 2064 6466     >>> res = ddf
-00033fd0: 2e61 7070 6c79 286d 7961 6464 2c20 6178  .apply(myadd, ax
-00033fe0: 6973 3d31 2c20 6172 6773 3d28 322c 292c  is=1, args=(2,),
-00033ff0: 2062 3d31 2e35 2c20 6d65 7461 3d28 2778   b=1.5, meta=('x
-00034000: 272c 2027 6638 2729 290a 0a20 2020 2020  ', 'f8'))..     
-00034010: 2020 2049 6e20 7468 6520 6361 7365 2077     In the case w
-00034020: 6865 7265 2074 6865 206d 6574 6164 6174  here the metadat
-00034030: 6120 646f 6573 6e27 7420 6368 616e 6765  a doesn't change
-00034040: 2c20 796f 7520 6361 6e20 616c 736f 2070  , you can also p
-00034050: 6173 7320 696e 0a20 2020 2020 2020 2074  ass in.        t
-00034060: 6865 206f 626a 6563 7420 6974 7365 6c66  he object itself
-00034070: 2064 6972 6563 746c 793a 0a0a 2020 2020   directly:..    
-00034080: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
-00034090: 662e 6170 706c 7928 6c61 6d62 6461 2072  f.apply(lambda r
-000340a0: 6f77 3a20 726f 7720 2b20 312c 2061 7869  ow: row + 1, axi
-000340b0: 733d 312c 206d 6574 613d 6464 6629 0a0a  s=1, meta=ddf)..
-000340c0: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-000340d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000340e0: 2d0a 2020 2020 2020 2020 6461 736b 2e44  -.        dask.D
-000340f0: 6174 6146 7261 6d65 2e6d 6170 5f70 6172  ataFrame.map_par
-00034100: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
-00034110: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-00034120: 6272 6f61 6463 6173 7420 6973 206e 6f74  broadcast is not
-00034130: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00034140: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-00034150: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00034160: 2020 2254 6865 2060 6272 6f61 6463 6173    "The `broadcas
-00034170: 7460 2061 7267 756d 656e 7420 6973 206e  t` argument is n
-00034180: 6f20 6c6f 6e67 6572 2075 7365 642f 7375  o longer used/su
-00034190: 7070 6f72 7465 642e 2022 0a20 2020 2020  pported. ".     
-000341a0: 2020 2020 2020 2020 2020 2022 4974 2077             "It w
-000341b0: 696c 6c20 6265 2064 726f 7070 6564 2069  ill be dropped i
-000341c0: 6e20 6120 6675 7475 7265 2072 656c 6561  n a future relea
-000341d0: 7365 2e22 2c0a 2020 2020 2020 2020 2020  se.",.          
-000341e0: 2020 2020 2020 6361 7465 676f 7279 3d46        category=F
-000341f0: 7574 7572 6557 6172 6e69 6e67 2c0a 2020  utureWarning,.  
-00034200: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00034210: 2020 2020 2061 7869 7320 3d20 7365 6c66       axis = self
-00034220: 2e5f 7661 6c69 6461 7465 5f61 7869 7328  ._validate_axis(
-00034230: 6178 6973 290a 2020 2020 2020 2020 7061  axis).        pa
-00034240: 6e64 6173 5f6b 7761 7267 7320 3d20 7b22  ndas_kwargs = {"
-00034250: 6178 6973 223a 2061 7869 732c 2022 7261  axis": axis, "ra
-00034260: 7722 3a20 7261 772c 2022 7265 7375 6c74  w": raw, "result
-00034270: 5f74 7970 6522 3a20 7265 7375 6c74 5f74  _type": result_t
-00034280: 7970 657d 0a0a 2020 2020 2020 2020 6b77  ype}..        kw
-00034290: 6473 2e75 7064 6174 6528 7061 6e64 6173  ds.update(pandas
-000342a0: 5f6b 7761 7267 7329 0a0a 2020 2020 2020  _kwargs)..      
-000342b0: 2020 6966 2061 7869 7320 3d3d 2030 3a0a    if axis == 0:.
-000342c0: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
-000342d0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-000342e0: 2020 2020 2264 642e 4461 7461 4672 616d      "dd.DataFram
-000342f0: 652e 6170 706c 7920 6f6e 6c79 2073 7570  e.apply only sup
-00034300: 706f 7274 7320 6178 6973 3d31 5c6e 220a  ports axis=1\n".
-00034310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034320: 2220 2054 7279 3a20 6466 2e61 7070 6c79  "  Try: df.apply
-00034330: 2866 756e 632c 2061 7869 733d 3129 220a  (func, axis=1)".
-00034340: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00034350: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00034360: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00034370: 726f 7228 6d73 6729 0a0a 2020 2020 2020  ror(msg)..      
-00034380: 2020 6966 206d 6574 6120 6973 206e 6f5f    if meta is no_
-00034390: 6465 6661 756c 743a 0a20 2020 2020 2020  default:.       
-000343a0: 2020 2020 206d 6574 6120 3d20 5f65 6d75       meta = _emu
-000343b0: 6c61 7465 280a 2020 2020 2020 2020 2020  late(.          
-000343c0: 2020 2020 2020 4d2e 6170 706c 792c 2073        M.apply, s
-000343d0: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
-000343e0: 7479 2c20 6675 6e63 2c20 6172 6773 3d61  ty, func, args=a
-000343f0: 7267 732c 2075 6466 3d54 7275 652c 202a  rgs, udf=True, *
-00034400: 2a6b 7764 730a 2020 2020 2020 2020 2020  *kwds.          
-00034410: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00034420: 7761 726e 696e 6773 2e77 6172 6e28 6d65  warnings.warn(me
-00034430: 7461 5f77 6172 6e69 6e67 286d 6574 6129  ta_warning(meta)
-00034440: 290a 2020 2020 2020 2020 6b77 6473 2e75  ).        kwds.u
-00034450: 7064 6174 6528 7b22 7061 7265 6e74 5f6d  pdate({"parent_m
-00034460: 6574 6122 3a20 7365 6c66 2e5f 6d65 7461  eta": self._meta
-00034470: 7d29 0a20 2020 2020 2020 2072 6574 7572  }).        retur
-00034480: 6e20 6d61 705f 7061 7274 6974 696f 6e73  n map_partitions
-00034490: 284d 2e61 7070 6c79 2c20 7365 6c66 2c20  (M.apply, self, 
-000344a0: 6675 6e63 2c20 6172 6773 3d61 7267 732c  func, args=args,
-000344b0: 206d 6574 613d 6d65 7461 2c20 2a2a 6b77   meta=meta, **kw
-000344c0: 6473 290a 0a20 2020 2040 6465 7269 7665  ds)..    @derive
-000344d0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-000344e0: 616d 6529 0a20 2020 2064 6566 2061 7070  ame).    def app
-000344f0: 6c79 6d61 7028 7365 6c66 2c20 6675 6e63  lymap(self, func
-00034500: 2c20 6d65 7461 3d22 5f5f 6e6f 5f64 6566  , meta="__no_def
-00034510: 6175 6c74 5f5f 2229 3a0a 2020 2020 2020  ault__"):.      
-00034520: 2020 7265 7475 726e 2065 6c65 6d77 6973    return elemwis
-00034530: 6528 4d2e 6170 706c 796d 6170 2c20 7365  e(M.applymap, se
-00034540: 6c66 2c20 6675 6e63 2c20 6d65 7461 3d6d  lf, func, meta=m
-00034550: 6574 6129 0a0a 2020 2020 4064 6572 6976  eta)..    @deriv
-00034560: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-00034570: 7261 6d65 290a 2020 2020 6465 6620 726f  rame).    def ro
-00034580: 756e 6428 7365 6c66 2c20 6465 6369 6d61  und(self, decima
-00034590: 6c73 3d30 293a 0a20 2020 2020 2020 2072  ls=0):.        r
-000345a0: 6574 7572 6e20 656c 656d 7769 7365 284d  eturn elemwise(M
-000345b0: 2e72 6f75 6e64 2c20 7365 6c66 2c20 6465  .round, self, de
-000345c0: 6369 6d61 6c73 290a 0a20 2020 2040 6465  cimals)..    @de
-000345d0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-000345e0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-000345f0: 206e 756e 6971 7565 2873 656c 662c 2073   nunique(self, s
-00034600: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-00034610: 2c20 6472 6f70 6e61 3d54 7275 652c 2061  , dropna=True, a
-00034620: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
-00034630: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
-00034640: 2020 2020 2020 2020 2020 2320 7370 6c69            # spli
-00034650: 745f 6576 6572 7920 6e6f 7420 7573 6564  t_every not used
-00034660: 2066 6f72 2061 7869 733d 310a 2020 2020   for axis=1.    
-00034670: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
-00034680: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
-00034690: 7479 2e6e 756e 6971 7565 2861 7869 733d  ty.nunique(axis=
-000346a0: 6178 6973 290a 2020 2020 2020 2020 2020  axis).          
-000346b0: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-000346c0: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-000346d0: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
-000346e0: 6e75 6e69 7175 652c 0a20 2020 2020 2020  nunique,.       
-000346f0: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
-00034700: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-00034710: 2020 2020 746f 6b65 6e3d 2273 6572 6965      token="serie
-00034720: 732d 6e75 6e69 7175 6522 2c0a 2020 2020  s-nunique",.    
-00034730: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00034740: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
-00034750: 2020 2020 2020 2064 726f 706e 613d 6472         dropna=dr
-00034760: 6f70 6e61 2c0a 2020 2020 2020 2020 2020  opna,.          
-00034770: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
-00034780: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
-00034790: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000347a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000347b0: 2020 2020 2020 6e75 6e69 7175 655f 6c69        nunique_li
-000347c0: 7374 203d 205b 0a20 2020 2020 2020 2020  st = [.         
-000347d0: 2020 2020 2020 2073 656c 665b 636f 6c5d         self[col]
-000347e0: 2e6e 756e 6971 7565 2873 706c 6974 5f65  .nunique(split_e
-000347f0: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-00034800: 2c20 6472 6f70 6e61 3d64 726f 706e 6129  , dropna=dropna)
-00034810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034820: 2066 6f72 2063 6f6c 2069 6e20 7365 6c66   for col in self
-00034830: 2e63 6f6c 756d 6e73 0a20 2020 2020 2020  .columns.       
-00034840: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-00034850: 2020 206e 616d 6520 3d20 2273 6572 6965     name = "serie
-00034860: 732d 2220 2b20 746f 6b65 6e69 7a65 282a  s-" + tokenize(*
-00034870: 6e75 6e69 7175 655f 6c69 7374 290a 2020  nunique_list).  
-00034880: 2020 2020 2020 2020 2020 6473 6b20 3d20            dsk = 
-00034890: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-000348a0: 2020 286e 616d 652c 2030 293a 2028 0a20    (name, 0): (. 
-000348b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000348c0: 2020 2061 7070 6c79 2c0a 2020 2020 2020     apply,.      
-000348d0: 2020 2020 2020 2020 2020 2020 2020 7064                pd
-000348e0: 2e53 6572 6965 732c 0a20 2020 2020 2020  .Series,.       
-000348f0: 2020 2020 2020 2020 2020 2020 205b 5b28               [[(
-00034900: 732e 5f6e 616d 652c 2030 2920 666f 7220  s._name, 0) for 
-00034910: 7320 696e 206e 756e 6971 7565 5f6c 6973  s in nunique_lis
-00034920: 745d 5d2c 0a20 2020 2020 2020 2020 2020  t]],.           
-00034930: 2020 2020 2020 2020 207b 2269 6e64 6578           {"index
-00034940: 223a 2073 656c 662e 636f 6c75 6d6e 737d  ": self.columns}
-00034950: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00034960: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00034970: 7d0a 2020 2020 2020 2020 2020 2020 6772  }.            gr
-00034980: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
-00034990: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
-000349a0: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
-000349b0: 2020 2020 2020 206e 616d 652c 2064 736b         name, dsk
-000349c0: 2c20 6465 7065 6e64 656e 6369 6573 3d6e  , dependencies=n
-000349d0: 756e 6971 7565 5f6c 6973 740a 2020 2020  unique_list.    
-000349e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000349f0: 2020 2020 2020 7265 7475 726e 2053 6572        return Ser
-00034a00: 6965 7328 6772 6170 682c 206e 616d 652c  ies(graph, name,
-00034a10: 2073 656c 662e 5f6d 6574 612e 6e75 6e69   self._meta.nuni
-00034a20: 7175 6528 292c 2028 4e6f 6e65 2c20 4e6f  que(), (None, No
-00034a30: 6e65 2929 0a0a 2020 2020 4064 6572 6976  ne))..    @deriv
-00034a40: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-00034a50: 7261 6d65 290a 2020 2020 6465 6620 6d6f  rame).    def mo
-00034a60: 6465 2873 656c 662c 2064 726f 706e 613d  de(self, dropna=
-00034a70: 5472 7565 2c20 7370 6c69 745f 6576 6572  True, split_ever
-00034a80: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
-00034a90: 2020 6d6f 6465 5f73 6572 6965 735f 6c69    mode_series_li
-00034aa0: 7374 203d 205b 5d0a 2020 2020 2020 2020  st = [].        
-00034ab0: 666f 7220 636f 6c5f 696e 6465 7820 696e  for col_index in
-00034ac0: 2072 616e 6765 286c 656e 2873 656c 662e   range(len(self.
-00034ad0: 636f 6c75 6d6e 7329 293a 0a20 2020 2020  columns)):.     
-00034ae0: 2020 2020 2020 2063 6f6c 5f73 6572 6965         col_serie
-00034af0: 7320 3d20 7365 6c66 2e69 6c6f 635b 3a2c  s = self.iloc[:,
-00034b00: 2063 6f6c 5f69 6e64 6578 5d0a 2020 2020   col_index].    
-00034b10: 2020 2020 2020 2020 6d6f 6465 5f73 6572          mode_ser
-00034b20: 6965 7320 3d20 5365 7269 6573 2e6d 6f64  ies = Series.mod
-00034b30: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-00034b40: 2020 2063 6f6c 5f73 6572 6965 732c 2064     col_series, d
-00034b50: 726f 706e 613d 6472 6f70 6e61 2c20 7370  ropna=dropna, sp
-00034b60: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-00034b70: 6576 6572 790a 2020 2020 2020 2020 2020  every.          
-00034b80: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00034b90: 6d6f 6465 5f73 6572 6965 735f 6c69 7374  mode_series_list
-00034ba0: 2e61 7070 656e 6428 6d6f 6465 5f73 6572  .append(mode_ser
-00034bb0: 6965 7329 0a0a 2020 2020 2020 2020 6e61  ies)..        na
-00034bc0: 6d65 203d 2022 636f 6e63 6174 2d22 202b  me = "concat-" +
-00034bd0: 2074 6f6b 656e 697a 6528 2a6d 6f64 655f   tokenize(*mode_
-00034be0: 7365 7269 6573 5f6c 6973 7429 0a0a 2020  series_list)..  
-00034bf0: 2020 2020 2020 6473 6b20 3d20 7b0a 2020        dsk = {.  
-00034c00: 2020 2020 2020 2020 2020 286e 616d 652c            (name,
-00034c10: 2030 293a 2028 0a20 2020 2020 2020 2020   0): (.         
-00034c20: 2020 2020 2020 2061 7070 6c79 2c0a 2020         apply,.  
-00034c30: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-00034c40: 7468 6f64 732e 636f 6e63 6174 2c0a 2020  thods.concat,.  
-00034c50: 2020 2020 2020 2020 2020 2020 2020 5b5b                [[
-00034c60: 2864 662e 5f6e 616d 652c 2030 2920 666f  (df._name, 0) fo
-00034c70: 7220 6466 2069 6e20 6d6f 6465 5f73 6572  r df in mode_ser
-00034c80: 6965 735f 6c69 7374 5d5d 2c0a 2020 2020  ies_list]],.    
-00034c90: 2020 2020 2020 2020 2020 2020 7b22 6178              {"ax
-00034ca0: 6973 223a 2031 7d2c 0a20 2020 2020 2020  is": 1},.       
-00034cb0: 2020 2020 2029 0a20 2020 2020 2020 207d       ).        }
-00034cc0: 0a0a 2020 2020 2020 2020 6d65 7461 203d  ..        meta =
-00034cd0: 206d 6574 686f 6473 2e63 6f6e 6361 7428   methods.concat(
-00034ce0: 5b64 662e 5f6d 6574 6120 666f 7220 6466  [df._meta for df
-00034cf0: 2069 6e20 6d6f 6465 5f73 6572 6965 735f   in mode_series_
-00034d00: 6c69 7374 5d2c 2061 7869 733d 3129 0a20  list], axis=1). 
-00034d10: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
-00034d20: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-00034d30: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 280a  om_collections(.
-00034d40: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00034d50: 2c20 6473 6b2c 2064 6570 656e 6465 6e63  , dsk, dependenc
-00034d60: 6965 733d 6d6f 6465 5f73 6572 6965 735f  ies=mode_series_
-00034d70: 6c69 7374 0a20 2020 2020 2020 2029 0a20  list.        ). 
-00034d80: 2020 2020 2020 2064 6466 203d 206e 6577         ddf = new
-00034d90: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
-00034da0: 2c20 6e61 6d65 2c20 6d65 7461 2c20 6469  , name, meta, di
-00034db0: 7669 7369 6f6e 733d 284e 6f6e 652c 204e  visions=(None, N
-00034dc0: 6f6e 6529 290a 0a20 2020 2020 2020 2072  one))..        r
-00034dd0: 6574 7572 6e20 6464 660a 0a20 2020 2040  eturn ddf..    @
-00034de0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00034df0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00034e00: 6566 2063 6f76 2873 656c 662c 206d 696e  ef cov(self, min
-00034e10: 5f70 6572 696f 6473 3d4e 6f6e 652c 206e  _periods=None, n
-00034e20: 756d 6572 6963 5f6f 6e6c 793d 6e6f 5f64  umeric_only=no_d
-00034e30: 6566 6175 6c74 2c20 7370 6c69 745f 6576  efault, split_ev
-00034e40: 6572 793d 4661 6c73 6529 3a0a 2020 2020  ery=False):.    
-00034e50: 2020 2020 7265 7475 726e 205f 636f 765f      return _cov_
-00034e60: 636f 7272 280a 2020 2020 2020 2020 2020  corr(.          
-00034e70: 2020 7365 6c66 2c20 6d69 6e5f 7065 7269    self, min_peri
-00034e80: 6f64 732c 206e 756d 6572 6963 5f6f 6e6c  ods, numeric_onl
-00034e90: 793d 6e75 6d65 7269 635f 6f6e 6c79 2c20  y=numeric_only, 
-00034ea0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00034eb0: 745f 6576 6572 790a 2020 2020 2020 2020  t_every.        
-00034ec0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00034ed0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00034ee0: 6529 0a20 2020 2064 6566 2063 6f72 7228  e).    def corr(
-00034ef0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00034f00: 2020 2020 2020 206d 6574 686f 643d 2270         method="p
-00034f10: 6561 7273 6f6e 222c 0a20 2020 2020 2020  earson",.       
-00034f20: 206d 696e 5f70 6572 696f 6473 3d4e 6f6e   min_periods=Non
-00034f30: 652c 0a20 2020 2020 2020 206e 756d 6572  e,.        numer
-00034f40: 6963 5f6f 6e6c 793d 6e6f 5f64 6566 6175  ic_only=no_defau
-00034f50: 6c74 2c0a 2020 2020 2020 2020 7370 6c69  lt,.        spli
-00034f60: 745f 6576 6572 793d 4661 6c73 652c 0a20  t_every=False,. 
-00034f70: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
-00034f80: 206d 6574 686f 6420 213d 2022 7065 6172   method != "pear
-00034f90: 736f 6e22 3a0a 2020 2020 2020 2020 2020  son":.          
-00034fa0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-00034fb0: 6d65 6e74 6564 4572 726f 7228 224f 6e6c  mentedError("Onl
-00034fc0: 7920 5065 6172 736f 6e20 636f 7272 656c  y Pearson correl
-00034fd0: 6174 696f 6e20 6861 7320 6265 656e 2069  ation has been i
-00034fe0: 6d70 6c65 6d65 6e74 6564 2229 0a0a 2020  mplemented")..  
-00034ff0: 2020 2020 2020 7265 7475 726e 205f 636f        return _co
-00035000: 765f 636f 7272 280a 2020 2020 2020 2020  v_corr(.        
-00035010: 2020 2020 7365 6c66 2c20 6d69 6e5f 7065      self, min_pe
-00035020: 7269 6f64 732c 2054 7275 652c 206e 756d  riods, True, num
-00035030: 6572 6963 5f6f 6e6c 793d 6e75 6d65 7269  eric_only=numeri
-00035040: 635f 6f6e 6c79 2c20 7370 6c69 745f 6576  c_only, split_ev
-00035050: 6572 793d 7370 6c69 745f 6576 6572 790a  ery=split_every.
-00035060: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00035070: 6566 2069 6e66 6f28 7365 6c66 2c20 6275  ef info(self, bu
-00035080: 663d 4e6f 6e65 2c20 7665 7262 6f73 653d  f=None, verbose=
-00035090: 4661 6c73 652c 206d 656d 6f72 795f 7573  False, memory_us
-000350a0: 6167 653d 4661 6c73 6529 3a0a 2020 2020  age=False):.    
-000350b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000350c0: 436f 6e63 6973 6520 7375 6d6d 6172 7920  Concise summary 
-000350d0: 6f66 2061 2044 6173 6b20 4461 7461 4672  of a Dask DataFr
-000350e0: 616d 652e 0a20 2020 2020 2020 2022 2222  ame..        """
-000350f0: 0a0a 2020 2020 2020 2020 6966 2062 7566  ..        if buf
-00035100: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00035110: 2020 2020 2020 696d 706f 7274 2073 7973        import sys
-00035120: 0a0a 2020 2020 2020 2020 2020 2020 6275  ..            bu
-00035130: 6620 3d20 7379 732e 7374 646f 7574 0a0a  f = sys.stdout..
-00035140: 2020 2020 2020 2020 6c69 6e65 7320 3d20          lines = 
-00035150: 5b73 7472 2874 7970 6528 7365 6c66 2929  [str(type(self))
-00035160: 5d0a 0a20 2020 2020 2020 2069 6620 6c65  ]..        if le
-00035170: 6e28 7365 6c66 2e63 6f6c 756d 6e73 2920  n(self.columns) 
-00035180: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00035190: 2020 6c69 6e65 732e 6170 7065 6e64 2866    lines.append(f
-000351a0: 227b 7479 7065 2873 656c 662e 696e 6465  "{type(self.inde
-000351b0: 782e 5f6d 6574 6129 2e5f 5f6e 616d 655f  x._meta).__name_
-000351c0: 5f7d 3a20 3020 656e 7472 6965 7322 290a  _}: 0 entries").
-000351d0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-000351e0: 732e 6170 7065 6e64 2866 2245 6d70 7479  s.append(f"Empty
-000351f0: 207b 7479 7065 2873 656c 6629 2e5f 5f6e   {type(self).__n
-00035200: 616d 655f 5f7d 2229 0a20 2020 2020 2020  ame__}").       
-00035210: 2020 2020 2069 6620 5041 4e44 4153 5f47       if PANDAS_G
-00035220: 545f 3135 303a 0a20 2020 2020 2020 2020  T_150:.         
-00035230: 2020 2020 2020 2023 2070 616e 6461 7320         # pandas 
-00035240: 6461 7461 6672 616d 6520 7374 6172 7465  dataframe starte
-00035250: 6420 6164 6469 6e67 2061 206e 6577 6c69  d adding a newli
-00035260: 6e65 2077 6865 6e20 696e 666f 2069 7320  ne when info is 
-00035270: 6361 6c6c 6564 2e0a 2020 2020 2020 2020  called..        
-00035280: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
-00035290: 7065 6e64 2822 2229 0a20 2020 2020 2020  pend("").       
-000352a0: 2020 2020 2070 7574 5f6c 696e 6573 2862       put_lines(b
-000352b0: 7566 2c20 6c69 6e65 7329 0a20 2020 2020  uf, lines).     
-000352c0: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-000352d0: 2020 2020 2020 2023 2047 726f 7570 2061         # Group a
-000352e0: 6e64 2065 7865 6375 7465 2074 6865 2072  nd execute the r
-000352f0: 6571 7569 7265 6420 636f 6d70 7574 6174  equired computat
-00035300: 696f 6e73 0a20 2020 2020 2020 2063 6f6d  ions.        com
-00035310: 7075 7461 7469 6f6e 7320 3d20 7b7d 0a20  putations = {}. 
-00035320: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
-00035330: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
-00035340: 656d 6f72 795f 7573 6167 6520 3d20 5472  emory_usage = Tr
-00035350: 7565 0a20 2020 2020 2020 2020 2020 2063  ue.            c
-00035360: 6f6d 7075 7461 7469 6f6e 732e 7570 6461  omputations.upda
-00035370: 7465 287b 2269 6e64 6578 223a 2073 656c  te({"index": sel
-00035380: 662e 696e 6465 782c 2022 636f 756e 7422  f.index, "count"
-00035390: 3a20 7365 6c66 2e63 6f75 6e74 2829 7d29  : self.count()})
-000353a0: 0a20 2020 2020 2020 2069 6620 6d65 6d6f  .        if memo
-000353b0: 7279 5f75 7361 6765 3a0a 2020 2020 2020  ry_usage:.      
-000353c0: 2020 2020 2020 636f 6d70 7574 6174 696f        computatio
-000353d0: 6e73 2e75 7064 6174 6528 0a20 2020 2020  ns.update(.     
-000353e0: 2020 2020 2020 2020 2020 207b 226d 656d             {"mem
-000353f0: 6f72 795f 7573 6167 6522 3a20 7365 6c66  ory_usage": self
-00035400: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-00035410: 4d2e 6d65 6d6f 7279 5f75 7361 6765 2c20  M.memory_usage, 
-00035420: 696e 6465 783d 5472 7565 297d 0a20 2020  index=True)}.   
-00035430: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00035440: 2020 2063 6f6d 7075 7461 7469 6f6e 7320     computations 
-00035450: 3d20 6469 6374 280a 2020 2020 2020 2020  = dict(.        
-00035460: 2020 2020 7a69 7028 636f 6d70 7574 6174      zip(computat
-00035470: 696f 6e73 2e6b 6579 7328 292c 2064 612e  ions.keys(), da.
-00035480: 636f 6d70 7574 6528 2a63 6f6d 7075 7461  compute(*computa
-00035490: 7469 6f6e 732e 7661 6c75 6573 2829 2929  tions.values()))
-000354a0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000354b0: 2020 2020 6966 2076 6572 626f 7365 3a0a      if verbose:.
-000354c0: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-000354d0: 7274 2074 6578 7477 7261 700a 0a20 2020  rt textwrap..   
-000354e0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
-000354f0: 2063 6f6d 7075 7461 7469 6f6e 735b 2269   computations["i
-00035500: 6e64 6578 225d 0a20 2020 2020 2020 2020  ndex"].         
-00035510: 2020 2063 6f75 6e74 7320 3d20 636f 6d70     counts = comp
-00035520: 7574 6174 696f 6e73 5b22 636f 756e 7422  utations["count"
-00035530: 5d0a 2020 2020 2020 2020 2020 2020 6c69  ].            li
-00035540: 6e65 732e 6170 7065 6e64 2869 6e64 6578  nes.append(index
-00035550: 5f73 756d 6d61 7279 2869 6e64 6578 2929  _summary(index))
-00035560: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
-00035570: 6573 2e61 7070 656e 6428 6622 4461 7461  es.append(f"Data
-00035580: 2063 6f6c 756d 6e73 2028 746f 7461 6c20   columns (total 
-00035590: 7b6c 656e 2873 656c 662e 636f 6c75 6d6e  {len(self.column
-000355a0: 7329 7d20 636f 6c75 6d6e 7329 3a22 290a  s)} columns):").
-000355b0: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
-000355c0: 6d20 7061 6e64 6173 2e69 6f2e 666f 726d  m pandas.io.form
-000355d0: 6174 732e 7072 696e 7469 6e67 2069 6d70  ats.printing imp
-000355e0: 6f72 7420 7070 7269 6e74 5f74 6869 6e67  ort pprint_thing
-000355f0: 0a0a 2020 2020 2020 2020 2020 2020 7370  ..            sp
-00035600: 6163 6520 3d20 6d61 7828 6c65 6e28 7070  ace = max(len(pp
-00035610: 7269 6e74 5f74 6869 6e67 286b 2929 2066  rint_thing(k)) f
-00035620: 6f72 206b 2069 6e20 7365 6c66 2e63 6f6c  or k in self.col
-00035630: 756d 6e73 2920 2b20 310a 2020 2020 2020  umns) + 1.      
-00035640: 2020 2020 2020 636f 6c75 6d6e 5f77 6964        column_wid
-00035650: 7468 203d 206d 6178 2873 7061 6365 2c20  th = max(space, 
-00035660: 3729 0a0a 2020 2020 2020 2020 2020 2020  7)..            
-00035670: 6865 6164 6572 203d 2028 0a20 2020 2020  header = (.     
-00035680: 2020 2020 2020 2020 2020 2074 6578 7477             textw
-00035690: 7261 702e 6465 6465 6e74 280a 2020 2020  rap.dedent(.    
-000356a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000356b0: 2222 225c 0a20 2020 2020 2020 2020 2020  """\.           
-000356c0: 2020 2320 2020 7b7b 636f 6c75 6d6e 3a3c    #   {{column:<
-000356d0: 7b63 6f6c 756d 6e5f 7769 6474 687d 7d7d  {column_width}}}
-000356e0: 204e 6f6e 2d4e 756c 6c20 436f 756e 7420   Non-Null Count 
-000356f0: 2044 7479 7065 0a20 2020 2020 2020 2020   Dtype.         
-00035700: 2020 202d 2d2d 2020 7b7b 756e 6465 726c     ---  {{underl
-00035710: 3a3c 7b63 6f6c 756d 6e5f 7769 6474 687d  :<{column_width}
-00035720: 7d7d 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  }} -------------
-00035730: 2d20 202d 2d2d 2d2d 2222 220a 2020 2020  -  -----""".    
-00035740: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00035750: 2020 2020 2020 2020 2020 2020 2020 2e66                .f
-00035760: 6f72 6d61 7428 636f 6c75 6d6e 5f77 6964  ormat(column_wid
-00035770: 7468 3d63 6f6c 756d 6e5f 7769 6474 6829  th=column_width)
-00035780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035790: 202e 666f 726d 6174 2863 6f6c 756d 6e3d   .format(column=
-000357a0: 2243 6f6c 756d 6e22 2c20 756e 6465 726c  "Column", underl
-000357b0: 3d22 2d2d 2d2d 2d2d 2229 0a20 2020 2020  ="------").     
-000357c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000357d0: 2020 2020 2063 6f6c 756d 6e5f 7465 6d70       column_temp
-000357e0: 6c61 7465 203d 2074 6578 7477 7261 702e  late = textwrap.
-000357f0: 6465 6465 6e74 280a 2020 2020 2020 2020  dedent(.        
-00035800: 2020 2020 2020 2020 2222 225c 0a20 2020          """\.   
-00035810: 2020 2020 2020 2020 207b 7b69 3a5e 337d           {{i:^3}
-00035820: 7d20 207b 7b6e 616d 653a 3c7b 636f 6c75  }  {{name:<{colu
-00035830: 6d6e 5f77 6964 7468 7d7d 7d20 7b7b 636f  mn_width}}} {{co
-00035840: 756e 747d 7d20 6e6f 6e2d 6e75 6c6c 2020  unt}} non-null  
-00035850: 2020 2020 7b7b 6474 7970 657d 7d22 2222      {{dtype}}"""
-00035860: 2e66 6f72 6d61 7428 0a20 2020 2020 2020  .format(.       
-00035870: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-00035880: 756d 6e5f 7769 6474 683d 636f 6c75 6d6e  umn_width=column
-00035890: 5f77 6964 7468 0a20 2020 2020 2020 2020  _width.         
-000358a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000358b0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-000358c0: 2020 2063 6f6c 756d 6e5f 696e 666f 203d     column_info =
-000358d0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-000358e0: 2020 2063 6f6c 756d 6e5f 7465 6d70 6c61     column_templa
-000358f0: 7465 2e66 6f72 6d61 7428 0a20 2020 2020  te.format(.     
-00035900: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00035910: 3d70 7072 696e 745f 7468 696e 6728 6929  =pprint_thing(i)
-00035920: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00035930: 2020 2020 2020 6e61 6d65 3d70 7072 696e        name=pprin
-00035940: 745f 7468 696e 6728 6e61 6d65 292c 0a20  t_thing(name),. 
-00035950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035960: 2020 2063 6f75 6e74 3d70 7072 696e 745f     count=pprint_
-00035970: 7468 696e 6728 636f 756e 7429 2c0a 2020  thing(count),.  
-00035980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035990: 2020 6474 7970 653d 7070 7269 6e74 5f74    dtype=pprint_t
-000359a0: 6869 6e67 2864 7479 7065 292c 0a20 2020  hing(dtype),.   
-000359b0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-000359c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000359d0: 6f72 2069 2c20 286e 616d 652c 2063 6f75  or i, (name, cou
-000359e0: 6e74 2c20 6474 7970 6529 2069 6e20 656e  nt, dtype) in en
-000359f0: 756d 6572 6174 6528 0a20 2020 2020 2020  umerate(.       
-00035a00: 2020 2020 2020 2020 2020 2020 207a 6970               zip
-00035a10: 2873 656c 662e 636f 6c75 6d6e 732c 2063  (self.columns, c
-00035a20: 6f75 6e74 732c 2073 656c 662e 6474 7970  ounts, self.dtyp
-00035a30: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
-00035a40: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00035a50: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-00035a60: 6c69 6e65 732e 6578 7465 6e64 2868 6561  lines.extend(hea
-00035a70: 6465 722e 7370 6c69 7428 225c 6e22 2929  der.split("\n"))
-00035a80: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00035a90: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-00035aa0: 6e5f 696e 666f 203d 205b 696e 6465 785f  n_info = [index_
-00035ab0: 7375 6d6d 6172 7928 7365 6c66 2e63 6f6c  summary(self.col
-00035ac0: 756d 6e73 2c20 6e61 6d65 3d22 436f 6c75  umns, name="Colu
-00035ad0: 6d6e 7322 295d 0a0a 2020 2020 2020 2020  mns")]..        
-00035ae0: 6c69 6e65 732e 6578 7465 6e64 2863 6f6c  lines.extend(col
-00035af0: 756d 6e5f 696e 666f 290a 2020 2020 2020  umn_info).      
-00035b00: 2020 6474 7970 655f 636f 756e 7473 203d    dtype_counts =
-00035b10: 205b 0a20 2020 2020 2020 2020 2020 2022   [.            "
-00035b20: 2573 2825 6429 2220 2520 6b20 666f 7220  %s(%d)" % k for 
-00035b30: 6b20 696e 2073 6f72 7465 6428 7365 6c66  k in sorted(self
-00035b40: 2e64 7479 7065 732e 7661 6c75 655f 636f  .dtypes.value_co
-00035b50: 756e 7473 2829 2e69 7465 6d73 2829 2c20  unts().items(), 
-00035b60: 6b65 793d 7374 7229 0a20 2020 2020 2020  key=str).       
-00035b70: 205d 0a20 2020 2020 2020 206c 696e 6573   ].        lines
-00035b80: 2e61 7070 656e 6428 2264 7479 7065 733a  .append("dtypes:
-00035b90: 207b 7d22 2e66 6f72 6d61 7428 222c 2022   {}".format(", "
-00035ba0: 2e6a 6f69 6e28 6474 7970 655f 636f 756e  .join(dtype_coun
-00035bb0: 7473 2929 290a 0a20 2020 2020 2020 2069  ts)))..        i
-00035bc0: 6620 6d65 6d6f 7279 5f75 7361 6765 3a0a  f memory_usage:.
-00035bd0: 2020 2020 2020 2020 2020 2020 6d65 6d6f              memo
-00035be0: 7279 5f69 6e74 203d 2063 6f6d 7075 7461  ry_int = computa
-00035bf0: 7469 6f6e 735b 226d 656d 6f72 795f 7573  tions["memory_us
-00035c00: 6167 6522 5d2e 7375 6d28 290a 2020 2020  age"].sum().    
-00035c10: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
-00035c20: 7065 6e64 2866 226d 656d 6f72 7920 7573  pend(f"memory us
-00035c30: 6167 653a 207b 6d65 6d6f 7279 5f72 6570  age: {memory_rep
-00035c40: 7228 6d65 6d6f 7279 5f69 6e74 297d 5c6e  r(memory_int)}\n
-00035c50: 2229 0a0a 2020 2020 2020 2020 7075 745f  ")..        put_
-00035c60: 6c69 6e65 7328 6275 662c 206c 696e 6573  lines(buf, lines
-00035c70: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00035c80: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00035c90: 6529 0a20 2020 2064 6566 206d 656d 6f72  e).    def memor
-00035ca0: 795f 7573 6167 6528 7365 6c66 2c20 696e  y_usage(self, in
-00035cb0: 6465 783d 5472 7565 2c20 6465 6570 3d46  dex=True, deep=F
-00035cc0: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
-00035cd0: 6573 756c 7420 3d20 7365 6c66 2e6d 6170  esult = self.map
-00035ce0: 5f70 6172 7469 7469 6f6e 7328 4d2e 6d65  _partitions(M.me
-00035cf0: 6d6f 7279 5f75 7361 6765 2c20 696e 6465  mory_usage, inde
-00035d00: 783d 696e 6465 782c 2064 6565 703d 6465  x=index, deep=de
-00035d10: 6570 290a 2020 2020 2020 2020 7265 7375  ep).        resu
-00035d20: 6c74 203d 2072 6573 756c 742e 6772 6f75  lt = result.grou
-00035d30: 7062 7928 7265 7375 6c74 2e69 6e64 6578  pby(result.index
-00035d40: 292e 7375 6d28 290a 2020 2020 2020 2020  ).sum().        
-00035d50: 7265 7475 726e 2072 6573 756c 740a 0a20  return result.. 
-00035d60: 2020 2064 6566 2070 6976 6f74 5f74 6162     def pivot_tab
-00035d70: 6c65 2873 656c 662c 2069 6e64 6578 3d4e  le(self, index=N
-00035d80: 6f6e 652c 2063 6f6c 756d 6e73 3d4e 6f6e  one, columns=Non
-00035d90: 652c 2076 616c 7565 733d 4e6f 6e65 2c20  e, values=None, 
-00035da0: 6167 6766 756e 633d 226d 6561 6e22 293a  aggfunc="mean"):
-00035db0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00035dc0: 2020 2020 2043 7265 6174 6520 6120 7370       Create a sp
-00035dd0: 7265 6164 7368 6565 742d 7374 796c 6520  readsheet-style 
-00035de0: 7069 766f 7420 7461 626c 6520 6173 2061  pivot table as a
-00035df0: 2044 6174 6146 7261 6d65 2e20 5461 7267   DataFrame. Targ
-00035e00: 6574 2060 6063 6f6c 756d 6e73 6060 0a20  et ``columns``. 
-00035e10: 2020 2020 2020 206d 7573 7420 6861 7665         must have
-00035e20: 2063 6174 6567 6f72 7920 6474 7970 6520   category dtype 
-00035e30: 746f 2069 6e66 6572 2072 6573 756c 7427  to infer result'
-00035e40: 7320 6060 636f 6c75 6d6e 7360 602e 0a20  s ``columns``.. 
-00035e50: 2020 2020 2020 2060 6069 6e64 6578 6060         ``index``
-00035e60: 2c20 6060 636f 6c75 6d6e 7360 602c 2060  , ``columns``, `
-00035e70: 6076 616c 7565 7360 6020 616e 6420 6060  `values`` and ``
-00035e80: 6167 6766 756e 6360 6020 6d75 7374 2062  aggfunc`` must b
-00035e90: 6520 616c 6c20 7363 616c 6172 2e0a 0a20  e all scalar... 
-00035ea0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00035eb0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00035ec0: 2d2d 2d2d 0a20 2020 2020 2020 2076 616c  ----.        val
-00035ed0: 7565 7320 3a20 7363 616c 6172 0a20 2020  ues : scalar.   
-00035ee0: 2020 2020 2020 2020 2063 6f6c 756d 6e20           column 
-00035ef0: 746f 2061 6767 7265 6761 7465 0a20 2020  to aggregate.   
-00035f00: 2020 2020 2069 6e64 6578 203a 2073 6361       index : sca
-00035f10: 6c61 720a 2020 2020 2020 2020 2020 2020  lar.            
-00035f20: 636f 6c75 6d6e 2074 6f20 6265 2069 6e64  column to be ind
-00035f30: 6578 0a20 2020 2020 2020 2063 6f6c 756d  ex.        colum
-00035f40: 6e73 203a 2073 6361 6c61 720a 2020 2020  ns : scalar.    
-00035f50: 2020 2020 2020 2020 636f 6c75 6d6e 2074          column t
-00035f60: 6f20 6265 2063 6f6c 756d 6e73 0a20 2020  o be columns.   
-00035f70: 2020 2020 2061 6767 6675 6e63 203a 207b       aggfunc : {
-00035f80: 276d 6561 6e27 2c20 2773 756d 272c 2027  'mean', 'sum', '
-00035f90: 636f 756e 7427 7d2c 2064 6566 6175 6c74  count'}, default
-00035fa0: 2027 6d65 616e 270a 0a20 2020 2020 2020   'mean'..       
-00035fb0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-00035fc0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-00035fd0: 2074 6162 6c65 203a 2044 6174 6146 7261   table : DataFra
-00035fe0: 6d65 0a20 2020 2020 2020 2022 2222 0a20  me.        """. 
-00035ff0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-00036000: 2e64 6174 6166 7261 6d65 2e72 6573 6861  .dataframe.resha
-00036010: 7065 2069 6d70 6f72 7420 7069 766f 745f  pe import pivot_
-00036020: 7461 626c 650a 0a20 2020 2020 2020 2072  table..        r
-00036030: 6574 7572 6e20 7069 766f 745f 7461 626c  eturn pivot_tabl
-00036040: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
-00036050: 656c 662c 2069 6e64 6578 3d69 6e64 6578  elf, index=index
-00036060: 2c20 636f 6c75 6d6e 733d 636f 6c75 6d6e  , columns=column
-00036070: 732c 2076 616c 7565 733d 7661 6c75 6573  s, values=values
-00036080: 2c20 6167 6766 756e 633d 6167 6766 756e  , aggfunc=aggfun
-00036090: 630a 2020 2020 2020 2020 290a 0a20 2020  c.        )..   
-000360a0: 2064 6566 206d 656c 7428 0a20 2020 2020   def melt(.     
-000360b0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-000360c0: 2069 645f 7661 7273 3d4e 6f6e 652c 0a20   id_vars=None,. 
-000360d0: 2020 2020 2020 2076 616c 7565 5f76 6172         value_var
-000360e0: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
-000360f0: 7661 725f 6e61 6d65 3d4e 6f6e 652c 0a20  var_name=None,. 
-00036100: 2020 2020 2020 2076 616c 7565 5f6e 616d         value_nam
-00036110: 653d 2276 616c 7565 222c 0a20 2020 2020  e="value",.     
-00036120: 2020 2063 6f6c 5f6c 6576 656c 3d4e 6f6e     col_level=Non
-00036130: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00036140: 2020 2222 220a 2020 2020 2020 2020 556e    """.        Un
-00036150: 7069 766f 7473 2061 2044 6174 6146 7261  pivots a DataFra
-00036160: 6d65 2066 726f 6d20 7769 6465 2066 6f72  me from wide for
-00036170: 6d61 7420 746f 206c 6f6e 6720 666f 726d  mat to long form
-00036180: 6174 2c0a 2020 2020 2020 2020 6f70 7469  at,.        opti
-00036190: 6f6e 616c 6c79 206c 6561 7669 6e67 2069  onally leaving i
-000361a0: 6465 6e74 6966 6965 7220 7661 7269 6162  dentifier variab
-000361b0: 6c65 7320 7365 742e 0a0a 2020 2020 2020  les set...      
-000361c0: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
-000361d0: 6973 2075 7365 6675 6c20 746f 206d 6173  is useful to mas
-000361e0: 7361 6765 2061 2044 6174 6146 7261 6d65  sage a DataFrame
-000361f0: 2069 6e74 6f20 6120 666f 726d 6174 2077   into a format w
-00036200: 6865 7265 0a20 2020 2020 2020 206f 6e65  here.        one
-00036210: 206f 7220 6d6f 7265 2063 6f6c 756d 6e73   or more columns
-00036220: 2061 7265 2069 6465 6e74 6966 6965 7220   are identifier 
-00036230: 7661 7269 6162 6c65 7320 2860 6069 645f  variables (``id_
-00036240: 7661 7273 6060 292c 2077 6869 6c65 0a20  vars``), while. 
-00036250: 2020 2020 2020 2061 6c6c 206f 7468 6572         all other
-00036260: 2063 6f6c 756d 6e73 2c20 636f 6e73 6964   columns, consid
-00036270: 6572 6564 206d 6561 7375 7265 6420 7661  ered measured va
-00036280: 7269 6162 6c65 7320 2860 6076 616c 7565  riables (``value
-00036290: 5f76 6172 7360 6029 2c0a 2020 2020 2020  _vars``),.      
-000362a0: 2020 6172 6520 2275 6e70 6976 6f74 6564    are "unpivoted
-000362b0: 2220 746f 2074 6865 2072 6f77 2061 7869  " to the row axi
-000362c0: 732c 206c 6561 7669 6e67 206a 7573 7420  s, leaving just 
-000362d0: 7477 6f20 6e6f 6e2d 6964 656e 7469 6669  two non-identifi
-000362e0: 6572 0a20 2020 2020 2020 2063 6f6c 756d  er.        colum
-000362f0: 6e73 2c20 2776 6172 6961 626c 6527 2061  ns, 'variable' a
-00036300: 6e64 2027 7661 6c75 6527 2e0a 0a20 2020  nd 'value'...   
-00036310: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00036320: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00036330: 2d2d 0a20 2020 2020 2020 2066 7261 6d65  --.        frame
-00036340: 203a 2044 6174 6146 7261 6d65 0a20 2020   : DataFrame.   
-00036350: 2020 2020 2069 645f 7661 7273 203a 2074       id_vars : t
-00036360: 7570 6c65 2c20 6c69 7374 2c20 6f72 206e  uple, list, or n
-00036370: 6461 7272 6179 2c20 6f70 7469 6f6e 616c  darray, optional
-00036380: 0a20 2020 2020 2020 2020 2020 2043 6f6c  .            Col
-00036390: 756d 6e28 7329 2074 6f20 7573 6520 6173  umn(s) to use as
-000363a0: 2069 6465 6e74 6966 6965 7220 7661 7269   identifier vari
-000363b0: 6162 6c65 732e 0a20 2020 2020 2020 2076  ables..        v
-000363c0: 616c 7565 5f76 6172 7320 3a20 7475 706c  alue_vars : tupl
-000363d0: 652c 206c 6973 742c 206f 7220 6e64 6172  e, list, or ndar
-000363e0: 7261 792c 206f 7074 696f 6e61 6c0a 2020  ray, optional.  
-000363f0: 2020 2020 2020 2020 2020 436f 6c75 6d6e            Column
-00036400: 2873 2920 746f 2075 6e70 6976 6f74 2e20  (s) to unpivot. 
-00036410: 4966 206e 6f74 2073 7065 6369 6669 6564  If not specified
-00036420: 2c20 7573 6573 2061 6c6c 2063 6f6c 756d  , uses all colum
-00036430: 6e73 2074 6861 740a 2020 2020 2020 2020  ns that.        
-00036440: 2020 2020 6172 6520 6e6f 7420 7365 7420      are not set 
-00036450: 6173 2060 6964 5f76 6172 7360 2e0a 2020  as `id_vars`..  
-00036460: 2020 2020 2020 7661 725f 6e61 6d65 203a        var_name :
-00036470: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
-00036480: 2020 2020 4e61 6d65 2074 6f20 7573 6520      Name to use 
-00036490: 666f 7220 7468 6520 2776 6172 6961 626c  for the 'variabl
-000364a0: 6527 2063 6f6c 756d 6e2e 2049 6620 4e6f  e' column. If No
-000364b0: 6e65 2069 7420 7573 6573 0a20 2020 2020  ne it uses.     
-000364c0: 2020 2020 2020 2060 6066 7261 6d65 2e63         ``frame.c
-000364d0: 6f6c 756d 6e73 2e6e 616d 6560 6020 6f72  olumns.name`` or
-000364e0: 2027 7661 7269 6162 6c65 272e 0a20 2020   'variable'..   
-000364f0: 2020 2020 2076 616c 7565 5f6e 616d 6520       value_name 
-00036500: 3a20 7363 616c 6172 2c20 6465 6661 756c  : scalar, defaul
-00036510: 7420 2776 616c 7565 270a 2020 2020 2020  t 'value'.      
-00036520: 2020 2020 2020 4e61 6d65 2074 6f20 7573        Name to us
-00036530: 6520 666f 7220 7468 6520 2776 616c 7565  e for the 'value
-00036540: 2720 636f 6c75 6d6e 2e0a 2020 2020 2020  ' column..      
-00036550: 2020 636f 6c5f 6c65 7665 6c20 3a20 696e    col_level : in
-00036560: 7420 6f72 2073 7472 696e 672c 206f 7074  t or string, opt
-00036570: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00036580: 2020 4966 2063 6f6c 756d 6e73 2061 7265    If columns are
-00036590: 2061 204d 756c 7469 496e 6465 7820 7468   a MultiIndex th
-000365a0: 656e 2075 7365 2074 6869 7320 6c65 7665  en use this leve
-000365b0: 6c20 746f 206d 656c 742e 0a0a 2020 2020  l to melt...    
-000365c0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-000365d0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-000365e0: 2020 2020 4461 7461 4672 616d 650a 2020      DataFrame.  
-000365f0: 2020 2020 2020 2020 2020 556e 7069 766f            Unpivo
-00036600: 7465 6420 4461 7461 4672 616d 652e 0a0a  ted DataFrame...
-00036610: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-00036620: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00036630: 2d0a 2020 2020 2020 2020 7061 6e64 6173  -.        pandas
-00036640: 2e44 6174 6146 7261 6d65 2e6d 656c 740a  .DataFrame.melt.
-00036650: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00036660: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-00036670: 7461 6672 616d 652e 7265 7368 6170 6520  taframe.reshape 
-00036680: 696d 706f 7274 206d 656c 740a 0a20 2020  import melt..   
-00036690: 2020 2020 2072 6574 7572 6e20 6d65 6c74       return melt
-000366a0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-000366b0: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
-000366c0: 6964 5f76 6172 733d 6964 5f76 6172 732c  id_vars=id_vars,
-000366d0: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-000366e0: 7565 5f76 6172 733d 7661 6c75 655f 7661  ue_vars=value_va
-000366f0: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
-00036700: 7661 725f 6e61 6d65 3d76 6172 5f6e 616d  var_name=var_nam
-00036710: 652c 0a20 2020 2020 2020 2020 2020 2076  e,.            v
-00036720: 616c 7565 5f6e 616d 653d 7661 6c75 655f  alue_name=value_
-00036730: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00036740: 2020 636f 6c5f 6c65 7665 6c3d 636f 6c5f    col_level=col_
-00036750: 6c65 7665 6c2c 0a20 2020 2020 2020 2029  level,.        )
-00036760: 0a0a 2020 2020 6465 6620 746f 5f72 6563  ..    def to_rec
-00036770: 6f72 6473 2873 656c 662c 2069 6e64 6578  ords(self, index
-00036780: 3d46 616c 7365 2c20 6c65 6e67 7468 733d  =False, lengths=
-00036790: 4e6f 6e65 293a 0a20 2020 2020 2020 2066  None):.        f
-000367a0: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-000367b0: 6d65 2e69 6f20 696d 706f 7274 2074 6f5f  me.io import to_
-000367c0: 7265 636f 7264 730a 0a20 2020 2020 2020  records..       
-000367d0: 2069 6620 6c65 6e67 7468 7320 6973 2054   if lengths is T
-000367e0: 7275 653a 0a20 2020 2020 2020 2020 2020  rue:.           
-000367f0: 206c 656e 6774 6873 203d 2074 7570 6c65   lengths = tuple
-00036800: 2873 656c 662e 6d61 705f 7061 7274 6974  (self.map_partit
-00036810: 696f 6e73 286c 656e 292e 636f 6d70 7574  ions(len).comput
-00036820: 6528 2929 0a0a 2020 2020 2020 2020 7265  e())..        re
-00036830: 636f 7264 7320 3d20 746f 5f72 6563 6f72  cords = to_recor
-00036840: 6473 2873 656c 6629 0a0a 2020 2020 2020  ds(self)..      
-00036850: 2020 6368 756e 6b73 203d 2073 656c 662e    chunks = self.
-00036860: 5f76 616c 6964 6174 655f 6368 756e 6b73  _validate_chunks
-00036870: 2872 6563 6f72 6473 2c20 6c65 6e67 7468  (records, length
-00036880: 7329 0a20 2020 2020 2020 2072 6563 6f72  s).        recor
-00036890: 6473 2e5f 6368 756e 6b73 203d 2028 6368  ds._chunks = (ch
-000368a0: 756e 6b73 5b30 5d2c 290a 0a20 2020 2020  unks[0],)..     
-000368b0: 2020 2072 6574 7572 6e20 7265 636f 7264     return record
-000368c0: 730a 0a20 2020 2040 6465 7269 7665 645f  s..    @derived_
-000368d0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-000368e0: 6529 0a20 2020 2064 6566 2074 6f5f 6874  e).    def to_ht
-000368f0: 6d6c 2873 656c 662c 206d 6178 5f72 6f77  ml(self, max_row
-00036900: 733d 3529 3a0a 2020 2020 2020 2020 2320  s=5):.        # 
-00036910: 7064 2e53 6572 6965 7320 646f 6573 6e27  pd.Series doesn'
-00036920: 7420 6861 7665 2068 746d 6c20 7265 7072  t have html repr
-00036930: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-00036940: 7365 6c66 2e5f 7265 7072 5f64 6174 6128  self._repr_data(
-00036950: 292e 746f 5f68 746d 6c28 6d61 785f 726f  ).to_html(max_ro
-00036960: 7773 3d6d 6178 5f72 6f77 732c 2073 686f  ws=max_rows, sho
-00036970: 775f 6469 6d65 6e73 696f 6e73 3d46 616c  w_dimensions=Fal
-00036980: 7365 290a 2020 2020 2020 2020 7265 7475  se).        retu
-00036990: 726e 2067 6574 5f74 656d 706c 6174 6528  rn get_template(
-000369a0: 2264 6174 6166 7261 6d65 2e68 746d 6c2e  "dataframe.html.
-000369b0: 6a32 2229 2e72 656e 6465 7228 0a20 2020  j2").render(.   
-000369c0: 2020 2020 2020 2020 2064 6174 613d 6461           data=da
-000369d0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-000369e0: 6e61 6d65 3d73 656c 662e 5f6e 616d 652c  name=self._name,
-000369f0: 0a20 2020 2020 2020 2020 2020 206c 6179  .            lay
-00036a00: 6572 733d 6d61 7962 655f 706c 7572 616c  ers=maybe_plural
-00036a10: 697a 6528 6c65 6e28 7365 6c66 2e64 6173  ize(len(self.das
-00036a20: 6b2e 6c61 7965 7273 292c 2022 6772 6170  k.layers), "grap
-00036a30: 6820 6c61 7965 7222 292c 0a20 2020 2020  h layer"),.     
-00036a40: 2020 2029 0a0a 2020 2020 6465 6620 5f72     )..    def _r
-00036a50: 6570 725f 6461 7461 2873 656c 6629 3a0a  epr_data(self):.
-00036a60: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
-00036a70: 656c 662e 5f6d 6574 610a 2020 2020 2020  elf._meta.      
-00036a80: 2020 696e 6465 7820 3d20 7365 6c66 2e5f    index = self._
-00036a90: 7265 7072 5f64 6976 6973 696f 6e73 0a20  repr_divisions. 
-00036aa0: 2020 2020 2020 2063 6f6c 7320 3d20 6d65         cols = me
-00036ab0: 7461 2e63 6f6c 756d 6e73 0a20 2020 2020  ta.columns.     
-00036ac0: 2020 2069 6620 6c65 6e28 636f 6c73 2920     if len(cols) 
-00036ad0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00036ae0: 2020 7365 7269 6573 5f64 6620 3d20 7064    series_df = pd
-00036af0: 2e44 6174 6146 7261 6d65 285b 5b5d 5d20  .DataFrame([[]] 
-00036b00: 2a20 6c65 6e28 696e 6465 7829 2c20 636f  * len(index), co
-00036b10: 6c75 6d6e 733d 636f 6c73 2c20 696e 6465  lumns=cols, inde
-00036b20: 783d 696e 6465 7829 0a20 2020 2020 2020  x=index).       
-00036b30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00036b40: 2020 2073 6572 6965 735f 6466 203d 2070     series_df = p
-00036b50: 642e 636f 6e63 6174 280a 2020 2020 2020  d.concat(.      
-00036b60: 2020 2020 2020 2020 2020 5b5f 7265 7072            [_repr
-00036b70: 5f64 6174 615f 7365 7269 6573 2873 2c20  _data_series(s, 
-00036b80: 696e 6465 783d 696e 6465 7829 2066 6f72  index=index) for
-00036b90: 205f 2c20 7320 696e 206d 6574 612e 6974   _, s in meta.it
-00036ba0: 656d 7328 295d 2c20 6178 6973 3d31 0a20  ems()], axis=1. 
-00036bb0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00036bc0: 2020 2020 2072 6574 7572 6e20 7365 7269       return seri
-00036bd0: 6573 5f64 660a 0a20 2020 2064 6566 205f  es_df..    def _
-00036be0: 7265 7072 5f68 746d 6c5f 2873 656c 6629  repr_html_(self)
-00036bf0: 3a0a 2020 2020 2020 2020 6461 7461 203d  :.        data =
-00036c00: 2073 656c 662e 5f72 6570 725f 6461 7461   self._repr_data
-00036c10: 2829 2e74 6f5f 6874 6d6c 280a 2020 2020  ().to_html(.    
-00036c20: 2020 2020 2020 2020 6d61 785f 726f 7773          max_rows
-00036c30: 3d35 2c20 7368 6f77 5f64 696d 656e 7369  =5, show_dimensi
-00036c40: 6f6e 733d 4661 6c73 652c 206e 6f74 6562  ons=False, noteb
-00036c50: 6f6f 6b3d 5472 7565 0a20 2020 2020 2020  ook=True.       
-00036c60: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-00036c70: 6e20 6765 745f 7465 6d70 6c61 7465 2822  n get_template("
-00036c80: 6461 7461 6672 616d 652e 6874 6d6c 2e6a  dataframe.html.j
-00036c90: 3222 292e 7265 6e64 6572 280a 2020 2020  2").render(.    
-00036ca0: 2020 2020 2020 2020 6461 7461 3d64 6174          data=dat
-00036cb0: 612c 0a20 2020 2020 2020 2020 2020 206e  a,.            n
-00036cc0: 616d 653d 7365 6c66 2e5f 6e61 6d65 2c0a  ame=self._name,.
-00036cd0: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
-00036ce0: 7273 3d6d 6179 6265 5f70 6c75 7261 6c69  rs=maybe_plurali
-00036cf0: 7a65 286c 656e 2873 656c 662e 6461 736b  ze(len(self.dask
-00036d00: 2e6c 6179 6572 7329 2c20 2267 7261 7068  .layers), "graph
-00036d10: 206c 6179 6572 2229 2c0a 2020 2020 2020   layer"),.      
-00036d20: 2020 290a 0a20 2020 2064 6566 205f 7365    )..    def _se
-00036d30: 6c65 6374 5f63 6f6c 756d 6e73 5f6f 725f  lect_columns_or_
-00036d40: 696e 6465 7828 7365 6c66 2c20 636f 6c75  index(self, colu
-00036d50: 6d6e 735f 6f72 5f69 6e64 6578 293a 0a20  mns_or_index):. 
-00036d60: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00036d70: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00036d80: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00036d90: 0a20 2020 2020 2020 2063 6f6c 756d 6e73  .        columns
-00036da0: 5f6f 725f 696e 6465 780a 2020 2020 2020  _or_index.      
-00036db0: 2020 2020 2020 436f 6c75 6d6e 206f 7220        Column or 
-00036dc0: 696e 6465 7820 6e61 6d65 2c20 6f72 2061  index name, or a
-00036dd0: 206c 6973 7420 6f66 2074 6865 7365 0a0a   list of these..
-00036de0: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-00036df0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-00036e00: 2020 2020 2020 2020 6464 2e44 6174 6146          dd.DataF
-00036e10: 7261 6d65 0a20 2020 2020 2020 2020 2020  rame.           
-00036e20: 2044 6173 6b20 4461 7461 4672 616d 6520   Dask DataFrame 
-00036e30: 7769 7468 2063 6f6c 756d 6e73 2063 6f72  with columns cor
-00036e40: 7265 7370 6f6e 6469 6e67 2074 6f20 6561  responding to ea
-00036e50: 6368 2063 6f6c 756d 6e20 6f72 0a20 2020  ch column or.   
-00036e60: 2020 2020 2020 2020 2069 6e64 6578 206c           index l
-00036e70: 6576 656c 2069 6e20 636f 6c75 6d6e 735f  evel in columns_
-00036e80: 6f72 5f69 6e64 6578 2e20 2049 6620 696e  or_index.  If in
-00036e90: 636c 7564 6564 2c20 7468 6520 636f 6c75  cluded, the colu
-00036ea0: 6d6e 0a20 2020 2020 2020 2020 2020 2063  mn.            c
-00036eb0: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
-00036ec0: 7468 6520 696e 6465 7820 6c65 7665 6c20  the index level 
-00036ed0: 6973 206e 616d 6564 205f 696e 6465 780a  is named _index.
-00036ee0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00036ef0: 2020 2020 2023 2045 6e73 7572 6520 636f       # Ensure co
-00036f00: 6c75 6d6e 735f 6f72 5f69 6e64 6578 2069  lumns_or_index i
-00036f10: 7320 6120 6c69 7374 0a20 2020 2020 2020  s a list.       
-00036f20: 2063 6f6c 756d 6e73 5f6f 725f 696e 6465   columns_or_inde
-00036f30: 7820 3d20 280a 2020 2020 2020 2020 2020  x = (.          
-00036f40: 2020 636f 6c75 6d6e 735f 6f72 5f69 6e64    columns_or_ind
-00036f50: 6578 0a20 2020 2020 2020 2020 2020 2069  ex.            i
-00036f60: 6620 6973 696e 7374 616e 6365 2863 6f6c  f isinstance(col
-00036f70: 756d 6e73 5f6f 725f 696e 6465 782c 206c  umns_or_index, l
-00036f80: 6973 7429 0a20 2020 2020 2020 2020 2020  ist).           
-00036f90: 2065 6c73 6520 5b63 6f6c 756d 6e73 5f6f   else [columns_o
-00036fa0: 725f 696e 6465 785d 0a20 2020 2020 2020  r_index].       
-00036fb0: 2029 0a0a 2020 2020 2020 2020 636f 6c75   )..        colu
-00036fc0: 6d6e 5f6e 616d 6573 203d 205b 0a20 2020  mn_names = [.   
-00036fd0: 2020 2020 2020 2020 206e 2066 6f72 206e           n for n
-00036fe0: 2069 6e20 636f 6c75 6d6e 735f 6f72 5f69   in columns_or_i
-00036ff0: 6e64 6578 2069 6620 7365 6c66 2e5f 6973  ndex if self._is
-00037000: 5f63 6f6c 756d 6e5f 6c61 6265 6c5f 7265  _column_label_re
-00037010: 6665 7265 6e63 6528 6e29 0a20 2020 2020  ference(n).     
-00037020: 2020 205d 0a0a 2020 2020 2020 2020 7365     ]..        se
-00037030: 6c65 6374 6564 5f64 6620 3d20 7365 6c66  lected_df = self
-00037040: 5b63 6f6c 756d 6e5f 6e61 6d65 735d 0a20  [column_names]. 
-00037050: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-00037060: 636f 6e74 6169 6e73 5f69 6e64 6578 5f6e  contains_index_n
-00037070: 616d 6528 636f 6c75 6d6e 735f 6f72 5f69  ame(columns_or_i
-00037080: 6e64 6578 293a 0a20 2020 2020 2020 2020  ndex):.         
-00037090: 2020 2023 2049 6e64 6578 206e 616d 6520     # Index name 
-000370a0: 7761 7320 696e 636c 7564 6564 0a20 2020  was included.   
-000370b0: 2020 2020 2020 2020 2073 656c 6563 7465           selecte
-000370c0: 645f 6466 203d 2073 656c 6563 7465 645f  d_df = selected_
-000370d0: 6466 2e61 7373 6967 6e28 5f69 6e64 6578  df.assign(_index
-000370e0: 3d73 656c 662e 696e 6465 7829 0a0a 2020  =self.index)..  
-000370f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00037100: 6563 7465 645f 6466 0a0a 2020 2020 6465  ected_df..    de
-00037110: 6620 5f69 735f 636f 6c75 6d6e 5f6c 6162  f _is_column_lab
-00037120: 656c 5f72 6566 6572 656e 6365 2873 656c  el_reference(sel
-00037130: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
-00037140: 2022 2222 0a20 2020 2020 2020 2054 6573   """.        Tes
-00037150: 7420 7768 6574 6865 7220 6120 6b65 7920  t whether a key 
-00037160: 6973 2061 2063 6f6c 756d 6e20 6c61 6265  is a column labe
-00037170: 6c20 7265 6665 7265 6e63 650a 0a20 2020  l reference..   
-00037180: 2020 2020 2054 6f20 6265 2063 6f6e 7369       To be consi
-00037190: 6465 7265 6420 6120 636f 6c75 6d6e 206c  dered a column l
-000371a0: 6162 656c 2072 6566 6572 656e 6365 2c20  abel reference, 
-000371b0: 606b 6579 6020 6d75 7374 206d 6174 6368  `key` must match
-000371c0: 2074 6865 206e 616d 6520 6f66 2061 740a   the name of at.
-000371d0: 2020 2020 2020 2020 6c65 6173 7420 6f6e          least on
-000371e0: 6520 636f 6c75 6d6e 2e0a 2020 2020 2020  e column..      
-000371f0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-00037200: 7475 726e 2028 0a20 2020 2020 2020 2020  turn (.         
-00037210: 2020 206e 6f74 2069 735f 6461 736b 5f63     not is_dask_c
-00037220: 6f6c 6c65 6374 696f 6e28 6b65 7929 0a20  ollection(key). 
-00037230: 2020 2020 2020 2020 2020 2061 6e64 2028             and (
-00037240: 6e70 2e69 7373 6361 6c61 7228 6b65 7929  np.isscalar(key)
-00037250: 206f 7220 6973 696e 7374 616e 6365 286b   or isinstance(k
-00037260: 6579 2c20 7475 706c 6529 290a 2020 2020  ey, tuple)).    
-00037270: 2020 2020 2020 2020 616e 6420 6b65 7920          and key 
-00037280: 696e 2073 656c 662e 636f 6c75 6d6e 730a  in self.columns.
-00037290: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-000372a0: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
-000372b0: 6465 6620 6672 6f6d 5f64 6963 7428 0a20  def from_dict(. 
-000372c0: 2020 2020 2020 2063 6c73 2c20 6461 7461         cls, data
-000372d0: 2c20 2a2c 206e 7061 7274 6974 696f 6e73  , *, npartitions
-000372e0: 2c20 6f72 6965 6e74 3d22 636f 6c75 6d6e  , orient="column
-000372f0: 7322 2c20 6474 7970 653d 4e6f 6e65 2c20  s", dtype=None, 
-00037300: 636f 6c75 6d6e 733d 4e6f 6e65 0a20 2020  columns=None.   
-00037310: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
-00037320: 2020 2020 2020 2020 436f 6e73 7472 7563          Construc
-00037330: 7420 6120 4461 736b 2044 6174 6146 7261  t a Dask DataFra
-00037340: 6d65 2066 726f 6d20 6120 5079 7468 6f6e  me from a Python
-00037350: 2044 6963 7469 6f6e 6172 790a 0a20 2020   Dictionary..   
-00037360: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
-00037370: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-00037380: 2020 2020 2020 2064 6173 6b2e 6461 7461         dask.data
-00037390: 6672 616d 652e 6672 6f6d 5f64 6963 740a  frame.from_dict.
-000373a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000373b0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-000373c0: 7461 6672 616d 652e 696f 2069 6d70 6f72  taframe.io impor
-000373d0: 7420 6672 6f6d 5f64 6963 740a 0a20 2020  t from_dict..   
-000373e0: 2020 2020 2072 6574 7572 6e20 6672 6f6d       return from
-000373f0: 5f64 6963 7428 0a20 2020 2020 2020 2020  _dict(.         
-00037400: 2020 2064 6174 612c 0a20 2020 2020 2020     data,.       
-00037410: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
-00037420: 2c0a 2020 2020 2020 2020 2020 2020 6f72  ,.            or
-00037430: 6965 6e74 3d6f 7269 656e 742c 0a20 2020  ient=orient,.   
-00037440: 2020 2020 2020 2020 2064 7479 7065 3d64           dtype=d
-00037450: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00037460: 2020 636f 6c75 6d6e 733d 636f 6c75 6d6e    columns=column
-00037470: 732c 0a20 2020 2020 2020 2020 2020 2063  s,.            c
-00037480: 6f6e 7374 7275 6374 6f72 3d63 6c73 2e5f  onstructor=cls._
-00037490: 7061 7274 6974 696f 6e5f 7479 7065 2c0a  partition_type,.
-000374a0: 2020 2020 2020 2020 290a 0a0a 2320 6269          )...# bi
-000374b0: 6e64 206f 7065 7261 746f 7273 0a23 2054  nd operators.# T
-000374c0: 4f44 4f3a 2064 796e 616d 6963 616c 6c79  ODO: dynamically
-000374d0: 2062 6f75 6e64 206f 7065 7261 746f 7273   bound operators
-000374e0: 2061 7265 2064 6566 6561 7469 6e67 2074   are defeating t
-000374f0: 7970 6520 616e 6e6f 7461 7469 6f6e 730a  ype annotations.
-00037500: 666f 7220 6f70 2069 6e20 5b0a 2020 2020  for op in [.    
-00037510: 6f70 6572 6174 6f72 2e61 6273 2c0a 2020  operator.abs,.  
-00037520: 2020 6f70 6572 6174 6f72 2e61 6464 2c0a    operator.add,.
-00037530: 2020 2020 6f70 6572 6174 6f72 2e61 6e64      operator.and
-00037540: 5f2c 0a20 2020 206f 7065 7261 746f 722e  _,.    operator.
-00037550: 6571 2c0a 2020 2020 6f70 6572 6174 6f72  eq,.    operator
-00037560: 2e67 742c 0a20 2020 206f 7065 7261 746f  .gt,.    operato
-00037570: 722e 6765 2c0a 2020 2020 6f70 6572 6174  r.ge,.    operat
-00037580: 6f72 2e69 6e76 2c0a 2020 2020 6f70 6572  or.inv,.    oper
-00037590: 6174 6f72 2e6c 742c 0a20 2020 206f 7065  ator.lt,.    ope
-000375a0: 7261 746f 722e 6c65 2c0a 2020 2020 6f70  rator.le,.    op
-000375b0: 6572 6174 6f72 2e6d 6f64 2c0a 2020 2020  erator.mod,.    
-000375c0: 6f70 6572 6174 6f72 2e6d 756c 2c0a 2020  operator.mul,.  
-000375d0: 2020 6f70 6572 6174 6f72 2e6e 652c 0a20    operator.ne,. 
-000375e0: 2020 206f 7065 7261 746f 722e 6e65 672c     operator.neg,
-000375f0: 0a20 2020 206f 7065 7261 746f 722e 6f72  .    operator.or
-00037600: 5f2c 0a20 2020 206f 7065 7261 746f 722e  _,.    operator.
-00037610: 706f 772c 0a20 2020 206f 7065 7261 746f  pow,.    operato
-00037620: 722e 7375 622c 0a20 2020 206f 7065 7261  r.sub,.    opera
-00037630: 746f 722e 7472 7565 6469 762c 0a20 2020  tor.truediv,.   
-00037640: 206f 7065 7261 746f 722e 666c 6f6f 7264   operator.floord
-00037650: 6976 2c0a 2020 2020 6f70 6572 6174 6f72  iv,.    operator
-00037660: 2e78 6f72 2c0a 5d3a 0a20 2020 205f 4672  .xor,.]:.    _Fr
-00037670: 616d 652e 5f62 696e 645f 6f70 6572 6174  ame._bind_operat
-00037680: 6f72 286f 7029 0a20 2020 2053 6361 6c61  or(op).    Scala
-00037690: 722e 5f62 696e 645f 6f70 6572 6174 6f72  r._bind_operator
-000376a0: 286f 7029 0a0a 666f 7220 6e61 6d65 2069  (op)..for name i
-000376b0: 6e20 5b0a 2020 2020 2261 6464 222c 0a20  n [.    "add",. 
-000376c0: 2020 2022 7375 6222 2c0a 2020 2020 226d     "sub",.    "m
-000376d0: 756c 222c 0a20 2020 2022 6469 7622 2c0a  ul",.    "div",.
-000376e0: 2020 2020 2264 6976 6964 6522 2c0a 2020      "divide",.  
-000376f0: 2020 2274 7275 6564 6976 222c 0a20 2020    "truediv",.   
-00037700: 2022 666c 6f6f 7264 6976 222c 0a20 2020   "floordiv",.   
-00037710: 2022 6d6f 6422 2c0a 2020 2020 2270 6f77   "mod",.    "pow
-00037720: 222c 0a20 2020 2022 7261 6464 222c 0a20  ",.    "radd",. 
-00037730: 2020 2022 7273 7562 222c 0a20 2020 2022     "rsub",.    "
-00037740: 726d 756c 222c 0a20 2020 2022 7264 6976  rmul",.    "rdiv
-00037750: 222c 0a20 2020 2022 7274 7275 6564 6976  ",.    "rtruediv
-00037760: 222c 0a20 2020 2022 7266 6c6f 6f72 6469  ",.    "rfloordi
-00037770: 7622 2c0a 2020 2020 2272 6d6f 6422 2c0a  v",.    "rmod",.
-00037780: 2020 2020 2272 706f 7722 2c0a 5d3a 0a20      "rpow",.]:. 
-00037790: 2020 206d 6574 6820 3d20 6765 7461 7474     meth = getatt
-000377a0: 7228 7064 2e44 6174 6146 7261 6d65 2c20  r(pd.DataFrame, 
-000377b0: 6e61 6d65 290a 2020 2020 4461 7461 4672  name).    DataFr
-000377c0: 616d 652e 5f62 696e 645f 6f70 6572 6174  ame._bind_operat
-000377d0: 6f72 5f6d 6574 686f 6428 6e61 6d65 2c20  or_method(name, 
-000377e0: 6d65 7468 290a 0a20 2020 206d 6574 6820  meth)..    meth 
-000377f0: 3d20 6765 7461 7474 7228 7064 2e53 6572  = getattr(pd.Ser
-00037800: 6965 732c 206e 616d 6529 0a20 2020 2053  ies, name).    S
-00037810: 6572 6965 732e 5f62 696e 645f 6f70 6572  eries._bind_oper
-00037820: 6174 6f72 5f6d 6574 686f 6428 6e61 6d65  ator_method(name
-00037830: 2c20 6d65 7468 290a 0a66 6f72 206e 616d  , meth)..for nam
-00037840: 6520 696e 205b 226c 7422 2c20 2267 7422  e in ["lt", "gt"
-00037850: 2c20 226c 6522 2c20 2267 6522 2c20 226e  , "le", "ge", "n
-00037860: 6522 2c20 2265 7122 5d3a 0a20 2020 206d  e", "eq"]:.    m
-00037870: 6574 6820 3d20 6765 7461 7474 7228 7064  eth = getattr(pd
-00037880: 2e44 6174 6146 7261 6d65 2c20 6e61 6d65  .DataFrame, name
-00037890: 290a 2020 2020 4461 7461 4672 616d 652e  ).    DataFrame.
-000378a0: 5f62 696e 645f 636f 6d70 6172 6973 6f6e  _bind_comparison
-000378b0: 5f6d 6574 686f 6428 6e61 6d65 2c20 6d65  _method(name, me
-000378c0: 7468 290a 0a20 2020 206d 6574 6820 3d20  th)..    meth = 
-000378d0: 6765 7461 7474 7228 7064 2e53 6572 6965  getattr(pd.Serie
-000378e0: 732c 206e 616d 6529 0a20 2020 2053 6572  s, name).    Ser
-000378f0: 6965 732e 5f62 696e 645f 636f 6d70 6172  ies._bind_compar
-00037900: 6973 6f6e 5f6d 6574 686f 6428 6e61 6d65  ison_method(name
-00037910: 2c20 6d65 7468 290a 0a0a 6465 6620 6973  , meth)...def is
-00037920: 5f62 726f 6164 6361 7374 6162 6c65 2864  _broadcastable(d
-00037930: 6673 2c20 7329 3a0a 2020 2020 2222 220a  fs, s):.    """.
-00037940: 2020 2020 5468 6973 2053 6572 6965 7320      This Series 
-00037950: 6973 2062 726f 6164 6361 7374 6162 6c65  is broadcastable
-00037960: 2061 6761 696e 7374 2061 6e6f 7468 6572   against another
-00037970: 2064 6174 6166 7261 6d65 2069 6e20 7468   dataframe in th
-00037980: 6520 7365 7175 656e 6365 0a20 2020 2022  e sequence.    "
-00037990: 2222 0a0a 2020 2020 6465 6620 636f 6d70  ""..    def comp
-000379a0: 6172 6528 732c 2064 6629 3a0a 2020 2020  are(s, df):.    
-000379b0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-000379c0: 2020 2020 2072 6574 7572 6e20 732e 6469       return s.di
-000379d0: 7669 7369 6f6e 7320 3d3d 2028 6466 2e63  visions == (df.c
-000379e0: 6f6c 756d 6e73 2e6d 696e 2829 2c20 6466  olumns.min(), df
-000379f0: 2e63 6f6c 756d 6e73 2e6d 6178 2829 290a  .columns.max()).
-00037a00: 2020 2020 2020 2020 6578 6365 7074 2054          except T
-00037a10: 7970 6545 7272 6f72 3a0a 2020 2020 2020  ypeError:.      
-00037a20: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
-00037a30: 7365 0a0a 2020 2020 7265 7475 726e 2028  se..    return (
-00037a40: 0a20 2020 2020 2020 2069 7369 6e73 7461  .        isinsta
-00037a50: 6e63 6528 732c 2053 6572 6965 7329 0a20  nce(s, Series). 
-00037a60: 2020 2020 2020 2061 6e64 2073 2e6e 7061         and s.npa
-00037a70: 7274 6974 696f 6e73 203d 3d20 310a 2020  rtitions == 1.  
-00037a80: 2020 2020 2020 616e 6420 732e 6b6e 6f77        and s.know
-00037a90: 6e5f 6469 7669 7369 6f6e 730a 2020 2020  n_divisions.    
-00037aa0: 2020 2020 616e 6420 616e 7928 636f 6d70      and any(comp
-00037ab0: 6172 6528 732c 2064 6629 2066 6f72 2064  are(s, df) for d
-00037ac0: 6620 696e 2064 6673 2069 6620 6973 696e  f in dfs if isin
-00037ad0: 7374 616e 6365 2864 662c 2044 6174 6146  stance(df, DataF
-00037ae0: 7261 6d65 2929 0a20 2020 2029 0a0a 0a64  rame)).    )...d
-00037af0: 6566 2065 6c65 6d77 6973 6528 6f70 2c20  ef elemwise(op, 
-00037b00: 2a61 7267 732c 206d 6574 613d 6e6f 5f64  *args, meta=no_d
-00037b10: 6566 6175 6c74 2c20 6f75 743d 4e6f 6e65  efault, out=None
-00037b20: 2c20 7472 616e 7366 6f72 6d5f 6469 7669  , transform_divi
-00037b30: 7369 6f6e 733d 5472 7565 2c20 2a2a 6b77  sions=True, **kw
-00037b40: 6172 6773 293a 0a20 2020 2022 2222 456c  args):.    """El
-00037b50: 656d 656e 7477 6973 6520 6f70 6572 6174  ementwise operat
-00037b60: 696f 6e20 666f 7220 4461 736b 2064 6174  ion for Dask dat
-00037b70: 6166 7261 6d65 730a 0a20 2020 2050 6172  aframes..    Par
-00037b80: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-00037b90: 2d2d 2d2d 2d2d 0a20 2020 206f 703a 2063  ------.    op: c
-00037ba0: 616c 6c61 626c 650a 2020 2020 2020 2020  allable.        
-00037bb0: 4675 6e63 7469 6f6e 2074 6f20 6170 706c  Function to appl
-00037bc0: 7920 6163 726f 7373 2069 6e70 7574 2064  y across input d
-00037bd0: 6174 6166 7261 6d65 730a 2020 2020 2a61  ataframes.    *a
-00037be0: 7267 733a 2044 6174 6146 7261 6d65 732c  rgs: DataFrames,
-00037bf0: 2053 6572 6965 732c 2053 6361 6c61 7273   Series, Scalars
-00037c00: 2c20 4172 7261 7973 2c0a 2020 2020 2020  , Arrays,.      
-00037c10: 2020 5468 6520 6172 6775 6d65 6e74 7320    The arguments 
-00037c20: 6f66 2074 6865 206f 7065 7261 7469 6f6e  of the operation
-00037c30: 0a20 2020 206d 6574 613a 2070 642e 4461  .    meta: pd.Da
-00037c40: 7461 4672 616d 652c 2070 642e 5365 7269  taFrame, pd.Seri
-00037c50: 6573 2028 6f70 7469 6f6e 616c 290a 2020  es (optional).  
-00037c60: 2020 2020 2020 5661 6c69 6420 6d65 7461        Valid meta
-00037c70: 6461 7461 2066 6f72 2074 6865 206f 7065  data for the ope
-00037c80: 7261 7469 6f6e 2e20 2057 696c 6c20 6576  ration.  Will ev
-00037c90: 616c 7561 7465 206f 6e20 6120 736d 616c  aluate on a smal
-00037ca0: 6c20 7069 6563 6520 6f66 0a20 2020 2020  l piece of.     
-00037cb0: 2020 2064 6174 6120 6966 206e 6f74 2070     data if not p
-00037cc0: 726f 7669 6465 642e 0a20 2020 2074 7261  rovided..    tra
-00037cd0: 6e73 666f 726d 5f64 6976 6973 696f 6e73  nsform_divisions
-00037ce0: 3a20 626f 6f6c 6561 6e0a 2020 2020 2020  : boolean.      
-00037cf0: 2020 4966 2074 6865 2069 6e70 7574 2069    If the input i
-00037d00: 7320 6120 6060 6461 736b 2e64 6174 6166  s a ``dask.dataf
-00037d10: 7261 6d65 2e49 6e64 6578 6060 2077 6520  rame.Index`` we 
-00037d20: 6e6f 726d 616c 6c79 2077 696c 6c20 616c  normally will al
-00037d30: 736f 2061 7070 6c79 0a20 2020 2020 2020  so apply.       
-00037d40: 2074 6865 2066 756e 6374 696f 6e20 6f6e   the function on
-00037d50: 746f 2074 6865 2064 6976 6973 696f 6e73  to the divisions
-00037d60: 2061 6e64 2061 7070 6c79 2074 686f 7365   and apply those
-00037d70: 2074 7261 6e73 666f 726d 6564 2064 6976   transformed div
-00037d80: 6973 696f 6e73 0a20 2020 2020 2020 2074  isions.        t
-00037d90: 6f20 7468 6520 6f75 7470 7574 2e20 2059  o the output.  Y
-00037da0: 6f75 2063 616e 2070 6173 7320 6060 7472  ou can pass ``tr
-00037db0: 616e 7366 6f72 6d5f 6469 7669 7369 6f6e  ansform_division
-00037dc0: 733d 4661 6c73 6560 6020 746f 206f 7665  s=False`` to ove
-00037dd0: 7272 6964 650a 2020 2020 2020 2020 7468  rride.        th
-00037de0: 6973 2062 6568 6176 696f 720a 2020 2020  is behavior.    
-00037df0: 6f75 7420 3a20 6060 6461 736b 2e61 7272  out : ``dask.arr
-00037e00: 6179 6060 206f 7220 6060 4e6f 6e65 6060  ay`` or ``None``
-00037e10: 0a20 2020 2020 2020 2049 6620 6f75 7420  .        If out 
-00037e20: 6973 2061 2064 6173 6b2e 4461 7461 4672  is a dask.DataFr
-00037e30: 616d 652c 2064 6173 6b2e 5365 7269 6573  ame, dask.Series
-00037e40: 206f 7220 6461 736b 2e53 6361 6c61 7220   or dask.Scalar 
-00037e50: 7468 656e 0a20 2020 2020 2020 2074 6869  then.        thi
-00037e60: 7320 6f76 6572 7772 6974 6573 2074 6865  s overwrites the
-00037e70: 2063 6f6e 7465 6e74 7320 6f66 2069 7420   contents of it 
-00037e80: 7769 7468 2074 6865 2072 6573 756c 740a  with the result.
-00037e90: 2020 2020 2a2a 6b77 6172 6773 3a20 7363      **kwargs: sc
-00037ea0: 616c 6172 730a 0a20 2020 2045 7861 6d70  alars..    Examp
-00037eb0: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
-00037ec0: 0a20 2020 203e 3e3e 2065 6c65 6d77 6973  .    >>> elemwis
-00037ed0: 6528 6f70 6572 6174 6f72 2e61 6464 2c20  e(operator.add, 
-00037ee0: 6466 2e78 2c20 6466 2e79 2920 2023 2064  df.x, df.y)  # d
-00037ef0: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
-00037f00: 2020 2222 220a 2020 2020 5f6e 616d 6520    """.    _name 
-00037f10: 3d20 6675 6e63 6e61 6d65 286f 7029 202b  = funcname(op) +
-00037f20: 2022 2d22 202b 2074 6f6b 656e 697a 6528   "-" + tokenize(
-00037f30: 6f70 2c20 2a61 7267 732c 202a 2a6b 7761  op, *args, **kwa
-00037f40: 7267 7329 0a0a 2020 2020 6172 6773 203d  rgs)..    args =
-00037f50: 205f 6d61 7962 655f 6672 6f6d 5f70 616e   _maybe_from_pan
-00037f60: 6461 7328 6172 6773 290a 0a20 2020 2066  das(args)..    f
-00037f70: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-00037f80: 6d65 2e6d 756c 7469 2069 6d70 6f72 7420  me.multi import 
-00037f90: 5f6d 6179 6265 5f61 6c69 676e 5f70 6172  _maybe_align_par
-00037fa0: 7469 7469 6f6e 730a 0a20 2020 2061 7267  titions..    arg
-00037fb0: 7320 3d20 5f6d 6179 6265 5f61 6c69 676e  s = _maybe_align
-00037fc0: 5f70 6172 7469 7469 6f6e 7328 6172 6773  _partitions(args
-00037fd0: 290a 2020 2020 6461 736b 7320 3d20 5b61  ).    dasks = [a
-00037fe0: 7267 2066 6f72 2061 7267 2069 6e20 6172  rg for arg in ar
-00037ff0: 6773 2069 6620 6973 696e 7374 616e 6365  gs if isinstance
-00038000: 2861 7267 2c20 285f 4672 616d 652c 2053  (arg, (_Frame, S
-00038010: 6361 6c61 722c 2041 7272 6179 2929 5d0a  calar, Array))].
-00038020: 2020 2020 6466 7320 3d20 5b64 6620 666f      dfs = [df fo
-00038030: 7220 6466 2069 6e20 6461 736b 7320 6966  r df in dasks if
-00038040: 2069 7369 6e73 7461 6e63 6528 6466 2c20   isinstance(df, 
-00038050: 5f46 7261 6d65 295d 0a0a 2020 2020 2320  _Frame)]..    # 
-00038060: 436c 6561 6e20 7570 2064 6173 6b20 6172  Clean up dask ar
-00038070: 7261 7973 2069 6620 7072 6573 656e 740a  rays if present.
-00038080: 2020 2020 6465 7073 203d 2064 6173 6b73      deps = dasks
-00038090: 2e63 6f70 7928 290a 2020 2020 666f 7220  .copy().    for 
-000380a0: 692c 2061 2069 6e20 656e 756d 6572 6174  i, a in enumerat
-000380b0: 6528 6461 736b 7329 3a0a 2020 2020 2020  e(dasks):.      
-000380c0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-000380d0: 6e63 6528 612c 2041 7272 6179 293a 0a20  nce(a, Array):. 
-000380e0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
-000380f0: 6e75 650a 2020 2020 2020 2020 2320 456e  nue.        # En
-00038100: 7375 7265 2074 6861 7420 7468 6579 2068  sure that they h
-00038110: 6176 6520 7369 6d69 6c61 722d 6973 6820  ave similar-ish 
-00038120: 6368 756e 6b20 7374 7275 6374 7572 650a  chunk structure.
-00038130: 2020 2020 2020 2020 6966 206e 6f74 2061          if not a
-00038140: 6c6c 286e 6f74 2061 2e63 6875 6e6b 7320  ll(not a.chunks 
-00038150: 6f72 206c 656e 2861 2e63 6875 6e6b 735b  or len(a.chunks[
-00038160: 305d 2920 3d3d 2064 662e 6e70 6172 7469  0]) == df.nparti
-00038170: 7469 6f6e 7320 666f 7220 6466 2069 6e20  tions for df in 
-00038180: 6466 7329 3a0a 2020 2020 2020 2020 2020  dfs):.          
-00038190: 2020 6d73 6720 3d20 280a 2020 2020 2020    msg = (.      
-000381a0: 2020 2020 2020 2020 2020 2257 6865 6e20            "When 
-000381b0: 636f 6d62 696e 696e 6720 6461 736b 2061  combining dask a
-000381c0: 7272 6179 7320 7769 7468 2064 6174 6166  rrays with dataf
-000381d0: 7261 6d65 7320 7468 6579 206d 7573 7420  rames they must 
-000381e0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-000381f0: 2020 226d 6174 6368 2063 6875 6e6b 696e    "match chunkin
-00038200: 6720 6578 6163 746c 792e 2020 4f70 6572  g exactly.  Oper
-00038210: 6174 696f 6e3a 2025 7322 2025 2066 756e  ation: %s" % fun
-00038220: 636e 616d 6528 6f70 290a 2020 2020 2020  cname(op).      
-00038230: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00038240: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00038250: 7272 6f72 286d 7367 290a 2020 2020 2020  rror(msg).      
-00038260: 2020 2320 5265 6368 756e 6b20 746f 2068    # Rechunk to h
-00038270: 6176 6520 6120 7369 6e67 6c65 2063 6875  ave a single chu
-00038280: 6e6b 2061 6c6f 6e67 2061 6c6c 206f 7468  nk along all oth
-00038290: 6572 2061 7865 730a 2020 2020 2020 2020  er axes.        
-000382a0: 6966 2061 2e6e 6469 6d20 3e20 313a 0a20  if a.ndim > 1:. 
-000382b0: 2020 2020 2020 2020 2020 2061 203d 2061             a = a
-000382c0: 2e72 6563 6875 6e6b 287b 6920 2b20 313a  .rechunk({i + 1:
-000382d0: 2064 2066 6f72 2069 2c20 6420 696e 2065   d for i, d in e
-000382e0: 6e75 6d65 7261 7465 2861 2e73 6861 7065  numerate(a.shape
-000382f0: 5b31 3a5d 297d 290a 2020 2020 2020 2020  [1:])}).        
-00038300: 2020 2020 6461 736b 735b 695d 203d 2061      dasks[i] = a
-00038310: 0a0a 2020 2020 6469 7669 7369 6f6e 7320  ..    divisions 
-00038320: 3d20 6466 735b 305d 2e64 6976 6973 696f  = dfs[0].divisio
-00038330: 6e73 0a20 2020 2069 6620 7472 616e 7366  ns.    if transf
-00038340: 6f72 6d5f 6469 7669 7369 6f6e 7320 616e  orm_divisions an
-00038350: 6420 6973 696e 7374 616e 6365 2864 6673  d isinstance(dfs
-00038360: 5b30 5d2c 2049 6e64 6578 2920 616e 6420  [0], Index) and 
-00038370: 6c65 6e28 6466 7329 203d 3d20 313a 0a20  len(dfs) == 1:. 
-00038380: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00038390: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
-000383a0: 7320 3d20 6f70 280a 2020 2020 2020 2020  s = op(.        
-000383b0: 2020 2020 2020 2020 2a5b 7064 2e49 6e64          *[pd.Ind
-000383c0: 6578 2861 7267 2e64 6976 6973 696f 6e73  ex(arg.divisions
-000383d0: 2920 6966 2061 7267 2069 7320 6466 735b  ) if arg is dfs[
-000383e0: 305d 2065 6c73 6520 6172 6720 666f 7220  0] else arg for 
-000383f0: 6172 6720 696e 2061 7267 735d 2c0a 2020  arg in args],.  
-00038400: 2020 2020 2020 2020 2020 2020 2020 2a2a                **
-00038410: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-00038420: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00038430: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00038440: 6469 7669 7369 6f6e 732c 2070 642e 496e  divisions, pd.In
-00038450: 6465 7829 3a0a 2020 2020 2020 2020 2020  dex):.          
-00038460: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
-00038470: 3d20 6d65 7468 6f64 732e 746f 6c69 7374  = methods.tolist
-00038480: 2864 6976 6973 696f 6e73 290a 2020 2020  (divisions).    
-00038490: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-000384a0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-000384b0: 2020 7061 7373 0a20 2020 2020 2020 2065    pass.        e
-000384c0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000384d0: 2069 6620 6e6f 7420 7661 6c69 645f 6469   if not valid_di
-000384e0: 7669 7369 6f6e 7328 6469 7669 7369 6f6e  visions(division
-000384f0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00038500: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
-00038510: 5b4e 6f6e 655d 202a 2028 6466 735b 305d  [None] * (dfs[0]
-00038520: 2e6e 7061 7274 6974 696f 6e73 202b 2031  .npartitions + 1
-00038530: 290a 0a20 2020 205f 6973 5f62 726f 6164  )..    _is_broad
-00038540: 6361 7374 6162 6c65 203d 2070 6172 7469  castable = parti
-00038550: 616c 2869 735f 6272 6f61 6463 6173 7461  al(is_broadcasta
-00038560: 626c 652c 2064 6673 290a 2020 2020 6466  ble, dfs).    df
-00038570: 7320 3d20 6c69 7374 2872 656d 6f76 6528  s = list(remove(
-00038580: 5f69 735f 6272 6f61 6463 6173 7461 626c  _is_broadcastabl
-00038590: 652c 2064 6673 2929 0a0a 2020 2020 6f74  e, dfs))..    ot
-000385a0: 6865 7220 3d20 5b0a 2020 2020 2020 2020  her = [.        
-000385b0: 2869 2c20 6172 6729 0a20 2020 2020 2020  (i, arg).       
-000385c0: 2066 6f72 2069 2c20 6172 6720 696e 2065   for i, arg in e
-000385d0: 6e75 6d65 7261 7465 2861 7267 7329 0a20  numerate(args). 
-000385e0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-000385f0: 696e 7374 616e 6365 2861 7267 2c20 285f  instance(arg, (_
-00038600: 4672 616d 652c 2053 6361 6c61 722c 2041  Frame, Scalar, A
-00038610: 7272 6179 2929 0a20 2020 205d 0a0a 2020  rray)).    ]..  
-00038620: 2020 2320 6164 6a75 7374 2074 6865 206b    # adjust the k
-00038630: 6579 206c 656e 6774 6820 6f66 2053 6361  ey length of Sca
-00038640: 6c61 720a 2020 2020 6473 6b20 3d20 7061  lar.    dsk = pa
-00038650: 7274 6974 696f 6e77 6973 655f 6772 6170  rtitionwise_grap
-00038660: 6828 6f70 2c20 5f6e 616d 652c 202a 6172  h(op, _name, *ar
-00038670: 6773 2c20 2a2a 6b77 6172 6773 290a 0a20  gs, **kwargs).. 
-00038680: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-00038690: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-000386a0: 6f6c 6c65 6374 696f 6e73 285f 6e61 6d65  ollections(_name
-000386b0: 2c20 6473 6b2c 2064 6570 656e 6465 6e63  , dsk, dependenc
-000386c0: 6965 733d 6465 7073 290a 0a20 2020 2069  ies=deps)..    i
-000386d0: 6620 6d65 7461 2069 7320 6e6f 5f64 6566  f meta is no_def
-000386e0: 6175 6c74 3a0a 2020 2020 2020 2020 6966  ault:.        if
-000386f0: 206c 656e 2864 6673 2920 3e3d 2032 2061   len(dfs) >= 2 a
-00038700: 6e64 206e 6f74 2061 6c6c 2868 6173 6174  nd not all(hasat
-00038710: 7472 2864 2c20 226e 7061 7274 6974 696f  tr(d, "npartitio
-00038720: 6e73 2229 2066 6f72 2064 2069 6e20 6461  ns") for d in da
-00038730: 736b 7329 3a0a 2020 2020 2020 2020 2020  sks):.          
-00038740: 2020 2320 7368 6f75 6c64 206e 6f74 206f    # should not o
-00038750: 6363 7572 2069 6e20 6375 7272 656e 7420  ccur in current 
-00038760: 6675 6e63 730a 2020 2020 2020 2020 2020  funcs.          
-00038770: 2020 6d73 6720 3d20 2265 6c65 6d77 6973    msg = "elemwis
-00038780: 6520 7769 7468 2032 206f 7220 6d6f 7265  e with 2 or more
-00038790: 2044 6174 6146 7261 6d65 7320 616e 6420   DataFrames and 
-000387a0: 5363 616c 6172 2069 7320 6e6f 7420 7375  Scalar is not su
-000387b0: 7070 6f72 7465 6422 0a20 2020 2020 2020  pported".       
-000387c0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-000387d0: 706c 656d 656e 7465 6445 7272 6f72 286d  plementedError(m
-000387e0: 7367 290a 2020 2020 2020 2020 2320 466f  sg).        # Fo
-000387f0: 7220 6272 6f61 6463 6173 7461 626c 6520  r broadcastable 
-00038800: 7365 7269 6573 2c20 7573 6520 6e6f 2072  series, use no r
-00038810: 6f77 732e 0a20 2020 2020 2020 2070 6172  ows..        par
-00038820: 7473 203d 205b 0a20 2020 2020 2020 2020  ts = [.         
-00038830: 2020 2064 2e5f 6d65 7461 0a20 2020 2020     d._meta.     
-00038840: 2020 2020 2020 2069 6620 5f69 735f 6272         if _is_br
-00038850: 6f61 6463 6173 7461 626c 6528 6429 0a20  oadcastable(d). 
-00038860: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
-00038870: 6e70 2e65 6d70 7479 2828 292c 2064 7479  np.empty((), dty
-00038880: 7065 3d64 2e64 7479 7065 290a 2020 2020  pe=d.dtype).    
-00038890: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-000388a0: 7461 6e63 6528 642c 2041 7272 6179 290a  tance(d, Array).
-000388b0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000388c0: 2064 2e5f 6d65 7461 5f6e 6f6e 656d 7074   d._meta_nonempt
-000388d0: 790a 2020 2020 2020 2020 2020 2020 666f  y.            fo
-000388e0: 7220 6420 696e 2064 6173 6b73 0a20 2020  r d in dasks.   
-000388f0: 2020 2020 205d 0a20 2020 2020 2020 2077       ].        w
-00038900: 6974 6820 7261 6973 655f 6f6e 5f6d 6574  ith raise_on_met
-00038910: 615f 6572 726f 7228 6675 6e63 6e61 6d65  a_error(funcname
-00038920: 286f 7029 293a 0a20 2020 2020 2020 2020  (op)):.         
-00038930: 2020 206d 6574 6120 3d20 7061 7274 6961     meta = partia
-00038940: 6c5f 6279 5f6f 7264 6572 282a 7061 7274  l_by_order(*part
-00038950: 732c 2066 756e 6374 696f 6e3d 6f70 2c20  s, function=op, 
-00038960: 6f74 6865 723d 6f74 6865 7229 0a0a 2020  other=other)..  
-00038970: 2020 7265 7375 6c74 203d 206e 6577 5f64    result = new_d
-00038980: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
-00038990: 5f6e 616d 652c 206d 6574 612c 2064 6976  _name, meta, div
-000389a0: 6973 696f 6e73 290a 2020 2020 7265 7475  isions).    retu
-000389b0: 726e 2068 616e 646c 655f 6f75 7428 6f75  rn handle_out(ou
-000389c0: 742c 2072 6573 756c 7429 0a0a 0a64 6566  t, result)...def
-000389d0: 2068 616e 646c 655f 6f75 7428 6f75 742c   handle_out(out,
-000389e0: 2072 6573 756c 7429 3a0a 2020 2020 2222   result):.    ""
-000389f0: 2248 616e 646c 6520 6f75 7420 7061 7261  "Handle out para
-00038a00: 6d65 7465 7273 0a0a 2020 2020 4966 206f  meters..    If o
-00038a10: 7574 2069 7320 6120 6461 736b 2e44 6174  ut is a dask.Dat
-00038a20: 6146 7261 6d65 2c20 6461 736b 2e53 6572  aFrame, dask.Ser
-00038a30: 6965 7320 6f72 2064 6173 6b2e 5363 616c  ies or dask.Scal
-00038a40: 6172 2074 6865 6e0a 2020 2020 7468 6973  ar then.    this
-00038a50: 206f 7665 7277 7269 7465 7320 7468 6520   overwrites the 
-00038a60: 636f 6e74 656e 7473 206f 6620 6974 2077  contents of it w
-00038a70: 6974 6820 7468 6520 7265 7375 6c74 0a20  ith the result. 
-00038a80: 2020 2022 2222 0a20 2020 2069 6620 6973     """.    if is
-00038a90: 696e 7374 616e 6365 286f 7574 2c20 7475  instance(out, tu
-00038aa0: 706c 6529 3a0a 2020 2020 2020 2020 6966  ple):.        if
-00038ab0: 206c 656e 286f 7574 2920 3d3d 2031 3a0a   len(out) == 1:.
-00038ac0: 2020 2020 2020 2020 2020 2020 6f75 7420              out 
-00038ad0: 3d20 6f75 745b 305d 0a20 2020 2020 2020  = out[0].       
-00038ae0: 2065 6c69 6620 6c65 6e28 6f75 7429 203e   elif len(out) >
-00038af0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00038b00: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00038b10: 6e74 6564 4572 726f 7228 2254 6865 206f  ntedError("The o
-00038b20: 7574 2070 6172 616d 6574 6572 2069 7320  ut parameter is 
-00038b30: 6e6f 7420 6675 6c6c 7920 7375 7070 6f72  not fully suppor
-00038b40: 7465 6422 290a 2020 2020 2020 2020 656c  ted").        el
-00038b50: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00038b60: 6f75 7420 3d20 4e6f 6e65 0a0a 2020 2020  out = None..    
-00038b70: 2320 4e6f 7469 6365 2c20 7765 2075 7365  # Notice, we use
-00038b80: 202e 5f5f 636c 6173 735f 5f20 6173 206f   .__class__ as o
-00038b90: 7070 6f73 6564 2074 6f20 7479 7065 2829  pposed to type()
-00038ba0: 2069 6e20 6f72 6465 7220 746f 2073 7570   in order to sup
-00038bb0: 706f 7274 0a20 2020 2023 206f 626a 6563  port.    # objec
-00038bc0: 7420 7072 6f78 6965 7320 7365 6520 3c68  t proxies see <h
-00038bd0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-00038be0: 6d2f 6461 736b 2f64 6173 6b2f 7075 6c6c  m/dask/dask/pull
-00038bf0: 2f36 3938 313e 0a20 2020 2069 6620 6f75  /6981>.    if ou
-00038c00: 7420 6973 206e 6f74 204e 6f6e 6520 616e  t is not None an
-00038c10: 6420 6f75 742e 5f5f 636c 6173 735f 5f20  d out.__class__ 
-00038c20: 213d 2072 6573 756c 742e 5f5f 636c 6173  != result.__clas
-00038c30: 735f 5f3a 0a20 2020 2020 2020 2072 6169  s__:.        rai
-00038c40: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
-00038c50: 2020 2020 2020 2020 2020 224d 6973 6d61            "Misma
-00038c60: 7463 6865 6420 7479 7065 7320 6265 7477  tched types betw
-00038c70: 6565 6e20 7265 7375 6c74 2061 6e64 206f  een result and o
-00038c80: 7574 2070 6172 616d 6574 6572 2e20 220a  ut parameter. ".
-00038c90: 2020 2020 2020 2020 2020 2020 226f 7574              "out
-00038ca0: 3d25 732c 2072 6573 756c 743d 2573 2220  =%s, result=%s" 
-00038cb0: 2520 2873 7472 2874 7970 6528 6f75 7429  % (str(type(out)
-00038cc0: 292c 2073 7472 2874 7970 6528 7265 7375  ), str(type(resu
-00038cd0: 6c74 2929 290a 2020 2020 2020 2020 290a  lt))).        ).
-00038ce0: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
-00038cf0: 6365 286f 7574 2c20 4461 7461 4672 616d  ce(out, DataFram
-00038d00: 6529 3a0a 2020 2020 2020 2020 6966 206c  e):.        if l
-00038d10: 656e 286f 7574 2e63 6f6c 756d 6e73 2920  en(out.columns) 
-00038d20: 213d 206c 656e 2872 6573 756c 742e 636f  != len(result.co
-00038d30: 6c75 6d6e 7329 3a0a 2020 2020 2020 2020  lumns):.        
-00038d40: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00038d50: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00038d60: 2020 2020 2020 224d 6973 6d61 7463 6865        "Mismatche
-00038d70: 6420 636f 6c75 6d6e 7320 636f 756e 7420  d columns count 
-00038d80: 6265 7477 6565 6e20 7265 7375 6c74 2061  between result a
-00038d90: 6e64 206f 7574 2070 6172 616d 6574 6572  nd out parameter
-00038da0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-00038db0: 2020 2020 226f 7574 3d25 732c 2072 6573      "out=%s, res
-00038dc0: 756c 743d 2573 2220 2520 2873 7472 286c  ult=%s" % (str(l
-00038dd0: 656e 286f 7574 2e63 6f6c 756d 6e73 2929  en(out.columns))
-00038de0: 2c20 7374 7228 6c65 6e28 7265 7375 6c74  , str(len(result
-00038df0: 2e63 6f6c 756d 6e73 2929 290a 2020 2020  .columns))).    
-00038e00: 2020 2020 2020 2020 290a 0a20 2020 2069          )..    i
-00038e10: 6620 6973 696e 7374 616e 6365 286f 7574  f isinstance(out
-00038e20: 2c20 2853 6572 6965 732c 2044 6174 6146  , (Series, DataF
-00038e30: 7261 6d65 2c20 5363 616c 6172 2929 3a0a  rame, Scalar)):.
-00038e40: 2020 2020 2020 2020 6f75 742e 5f6d 6574          out._met
-00038e50: 6120 3d20 7265 7375 6c74 2e5f 6d65 7461  a = result._meta
-00038e60: 0a20 2020 2020 2020 206f 7574 2e5f 6e61  .        out._na
-00038e70: 6d65 203d 2072 6573 756c 742e 5f6e 616d  me = result._nam
-00038e80: 650a 2020 2020 2020 2020 6f75 742e 6461  e.        out.da
-00038e90: 736b 203d 2072 6573 756c 742e 6461 736b  sk = result.dask
-00038ea0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-00038eb0: 2069 7369 6e73 7461 6e63 6528 6f75 742c   isinstance(out,
-00038ec0: 2053 6361 6c61 7229 3a0a 2020 2020 2020   Scalar):.      
-00038ed0: 2020 2020 2020 6f75 742e 5f64 6976 6973        out._divis
-00038ee0: 696f 6e73 203d 2072 6573 756c 742e 6469  ions = result.di
-00038ef0: 7669 7369 6f6e 730a 2020 2020 656c 6966  visions.    elif
-00038f00: 206f 7574 2069 7320 6e6f 7420 4e6f 6e65   out is not None
-00038f10: 3a0a 2020 2020 2020 2020 6d73 6720 3d20  :.        msg = 
-00038f20: 280a 2020 2020 2020 2020 2020 2020 2254  (.            "T
-00038f30: 6865 206f 7574 2070 6172 616d 6574 6572  he out parameter
-00038f40: 2069 7320 6e6f 7420 6675 6c6c 7920 7375   is not fully su
-00038f50: 7070 6f72 7465 642e 220a 2020 2020 2020  pported.".      
-00038f60: 2020 2020 2020 2220 5265 6365 6976 6564        " Received
-00038f70: 2074 7970 6520 2573 2c20 6578 7065 6374   type %s, expect
-00038f80: 6564 2025 7320 220a 2020 2020 2020 2020  ed %s ".        
-00038f90: 2020 2020 2520 280a 2020 2020 2020 2020      % (.        
-00038fa0: 2020 2020 2020 2020 7479 7065 6e61 6d65          typename
-00038fb0: 2874 7970 6528 6f75 7429 292c 0a20 2020  (type(out)),.   
-00038fc0: 2020 2020 2020 2020 2020 2020 2074 7970               typ
-00038fd0: 656e 616d 6528 7479 7065 2872 6573 756c  ename(type(resul
-00038fe0: 7429 292c 0a20 2020 2020 2020 2020 2020  t)),.           
-00038ff0: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
-00039000: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-00039010: 706c 656d 656e 7465 6445 7272 6f72 286d  plementedError(m
-00039020: 7367 290a 2020 2020 656c 7365 3a0a 2020  sg).    else:.  
-00039030: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00039040: 756c 740a 0a0a 6465 6620 5f6d 6179 6265  ult...def _maybe
-00039050: 5f66 726f 6d5f 7061 6e64 6173 2864 6673  _from_pandas(dfs
-00039060: 293a 0a20 2020 2066 726f 6d20 6461 736b  ):.    from dask
-00039070: 2e64 6174 6166 7261 6d65 2e69 6f20 696d  .dataframe.io im
-00039080: 706f 7274 2066 726f 6d5f 7061 6e64 6173  port from_pandas
-00039090: 0a0a 2020 2020 6466 7320 3d20 5b0a 2020  ..    dfs = [.  
-000390a0: 2020 2020 2020 6672 6f6d 5f70 616e 6461        from_panda
-000390b0: 7328 6466 2c20 3129 0a20 2020 2020 2020  s(df, 1).       
-000390c0: 2069 6620 2869 735f 7365 7269 6573 5f6c   if (is_series_l
-000390d0: 696b 6528 6466 2920 6f72 2069 735f 6461  ike(df) or is_da
-000390e0: 7461 6672 616d 655f 6c69 6b65 2864 6629  taframe_like(df)
-000390f0: 2920 616e 6420 6e6f 7420 6973 5f64 6173  ) and not is_das
-00039100: 6b5f 636f 6c6c 6563 7469 6f6e 2864 6629  k_collection(df)
-00039110: 0a20 2020 2020 2020 2065 6c73 6520 6466  .        else df
-00039120: 0a20 2020 2020 2020 2066 6f72 2064 6620  .        for df 
-00039130: 696e 2064 6673 0a20 2020 205d 0a20 2020  in dfs.    ].   
-00039140: 2072 6574 7572 6e20 6466 730a 0a0a 6465   return dfs...de
-00039150: 6620 6861 7368 5f73 6861 7264 280a 2020  f hash_shard(.  
-00039160: 2020 6466 2c20 6e70 6172 7473 2c20 7370    df, nparts, sp
-00039170: 6c69 745f 6f75 745f 7365 7475 703d 4e6f  lit_out_setup=No
-00039180: 6e65 2c20 7370 6c69 745f 6f75 745f 7365  ne, split_out_se
-00039190: 7475 705f 6b77 6172 6773 3d4e 6f6e 652c  tup_kwargs=None,
-000391a0: 2069 676e 6f72 655f 696e 6465 783d 4661   ignore_index=Fa
-000391b0: 6c73 650a 293a 0a20 2020 2069 6620 7370  lse.):.    if sp
-000391c0: 6c69 745f 6f75 745f 7365 7475 703a 0a20  lit_out_setup:. 
-000391d0: 2020 2020 2020 2068 203d 2073 706c 6974         h = split
-000391e0: 5f6f 7574 5f73 6574 7570 2864 662c 202a  _out_setup(df, *
-000391f0: 2a28 7370 6c69 745f 6f75 745f 7365 7475  *(split_out_setu
-00039200: 705f 6b77 6172 6773 206f 7220 7b7d 2929  p_kwargs or {}))
-00039210: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-00039220: 2020 2068 203d 2064 660a 0a20 2020 2068     h = df..    h
-00039230: 203d 2068 6173 685f 6f62 6a65 6374 5f64   = hash_object_d
-00039240: 6973 7061 7463 6828 682c 2069 6e64 6578  ispatch(h, index
-00039250: 3d46 616c 7365 290a 2020 2020 7265 7475  =False).    retu
-00039260: 726e 2067 726f 7570 5f73 706c 6974 5f64  rn group_split_d
-00039270: 6973 7061 7463 6828 6466 2c20 6820 2520  ispatch(df, h % 
-00039280: 6e70 6172 7473 2c20 6e70 6172 7473 2c20  nparts, nparts, 
-00039290: 6967 6e6f 7265 5f69 6e64 6578 3d69 676e  ignore_index=ign
-000392a0: 6f72 655f 696e 6465 7829 0a0a 0a64 6566  ore_index)...def
-000392b0: 2073 706c 6974 5f65 7665 6e6c 7928 6466   split_evenly(df
-000392c0: 2c20 6b29 3a0a 2020 2020 2222 2253 706c  , k):.    """Spl
-000392d0: 6974 2064 6174 6166 7261 6d65 2069 6e74  it dataframe int
-000392e0: 6f20 6b20 726f 7567 686c 7920 6571 7561  o k roughly equa
-000392f0: 6c20 7061 7274 7322 2222 0a20 2020 2064  l parts""".    d
-00039300: 6976 6973 696f 6e73 203d 206e 702e 6c69  ivisions = np.li
-00039310: 6e73 7061 6365 2830 2c20 6c65 6e28 6466  nspace(0, len(df
-00039320: 292c 206b 202b 2031 292e 6173 7479 7065  ), k + 1).astype
-00039330: 2869 6e74 290a 2020 2020 7265 7475 726e  (int).    return
-00039340: 207b 693a 2064 662e 696c 6f63 5b64 6976   {i: df.iloc[div
-00039350: 6973 696f 6e73 5b69 5d20 3a20 6469 7669  isions[i] : divi
-00039360: 7369 6f6e 735b 6920 2b20 315d 5d20 666f  sions[i + 1]] fo
-00039370: 7220 6920 696e 2072 616e 6765 286b 297d  r i in range(k)}
-00039380: 0a0a 0a64 6566 2073 706c 6974 5f6f 7574  ...def split_out
-00039390: 5f6f 6e5f 696e 6465 7828 6466 293a 0a20  _on_index(df):. 
-000393a0: 2020 2068 203d 2064 662e 696e 6465 780a     h = df.index.
-000393b0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-000393c0: 6528 682c 2070 642e 4d75 6c74 6949 6e64  e(h, pd.MultiInd
-000393d0: 6578 293a 0a20 2020 2020 2020 2068 203d  ex):.        h =
-000393e0: 206d 6574 615f 6672 616d 655f 636f 6e73   meta_frame_cons
-000393f0: 7472 7563 746f 7228 6466 2928 5b5d 2c20  tructor(df)([], 
-00039400: 696e 6465 783d 6829 2e72 6573 6574 5f69  index=h).reset_i
-00039410: 6e64 6578 2829 0a20 2020 2072 6574 7572  ndex().    retur
-00039420: 6e20 680a 0a0a 6465 6620 7370 6c69 745f  n h...def split_
-00039430: 6f75 745f 6f6e 5f63 6f6c 7328 6466 2c20  out_on_cols(df, 
-00039440: 636f 6c73 3d4e 6f6e 6529 3a0a 2020 2020  cols=None):.    
-00039450: 7265 7475 726e 2064 665b 636f 6c73 5d0a  return df[cols].
-00039460: 0a0a 4069 6e73 6572 745f 6d65 7461 5f70  ..@insert_meta_p
-00039470: 6172 616d 5f64 6573 6372 6970 7469 6f6e  aram_description
-00039480: 0a64 6566 2061 7070 6c79 5f63 6f6e 6361  .def apply_conca
-00039490: 745f 6170 706c 7928 0a20 2020 2061 7267  t_apply(.    arg
-000394a0: 732c 0a20 2020 2063 6875 6e6b 3d4e 6f6e  s,.    chunk=Non
-000394b0: 652c 0a20 2020 2061 6767 7265 6761 7465  e,.    aggregate
-000394c0: 3d4e 6f6e 652c 0a20 2020 2063 6f6d 6269  =None,.    combi
-000394d0: 6e65 3d4e 6f6e 652c 0a20 2020 206d 6574  ne=None,.    met
-000394e0: 613d 6e6f 5f64 6566 6175 6c74 2c0a 2020  a=no_default,.  
-000394f0: 2020 746f 6b65 6e3d 4e6f 6e65 2c0a 2020    token=None,.  
-00039500: 2020 6368 756e 6b5f 6b77 6172 6773 3d4e    chunk_kwargs=N
-00039510: 6f6e 652c 0a20 2020 2061 6767 7265 6761  one,.    aggrega
-00039520: 7465 5f6b 7761 7267 733d 4e6f 6e65 2c0a  te_kwargs=None,.
-00039530: 2020 2020 636f 6d62 696e 655f 6b77 6172      combine_kwar
-00039540: 6773 3d4e 6f6e 652c 0a20 2020 2073 706c  gs=None,.    spl
-00039550: 6974 5f65 7665 7279 3d4e 6f6e 652c 0a20  it_every=None,. 
-00039560: 2020 2073 706c 6974 5f6f 7574 3d4e 6f6e     split_out=Non
-00039570: 652c 0a20 2020 2073 706c 6974 5f6f 7574  e,.    split_out
-00039580: 5f73 6574 7570 3d4e 6f6e 652c 0a20 2020  _setup=None,.   
-00039590: 2073 706c 6974 5f6f 7574 5f73 6574 7570   split_out_setup
-000395a0: 5f6b 7761 7267 733d 4e6f 6e65 2c0a 2020  _kwargs=None,.  
-000395b0: 2020 736f 7274 3d4e 6f6e 652c 0a20 2020    sort=None,.   
-000395c0: 2069 676e 6f72 655f 696e 6465 783d 4661   ignore_index=Fa
-000395d0: 6c73 652c 0a20 2020 202a 2a6b 7761 7267  lse,.    **kwarg
-000395e0: 732c 0a29 3a0a 2020 2020 2222 2241 7070  s,.):.    """App
-000395f0: 6c79 2061 2066 756e 6374 696f 6e20 746f  ly a function to
-00039600: 2062 6c6f 636b 732c 2074 6865 6e20 636f   blocks, then co
-00039610: 6e63 6174 2c20 7468 656e 2061 7070 6c79  ncat, then apply
-00039620: 2061 6761 696e 0a0a 2020 2020 5061 7261   again..    Para
-00039630: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-00039640: 2d2d 2d2d 2d0a 2020 2020 6172 6773 203a  -----.    args :
-00039650: 0a20 2020 2020 2020 2050 6f73 6974 696f  .        Positio
-00039660: 6e61 6c20 6172 6775 6d65 6e74 7320 666f  nal arguments fo
-00039670: 7220 7468 6520 6063 6875 6e6b 6020 6675  r the `chunk` fu
-00039680: 6e63 7469 6f6e 2e20 416c 6c20 6064 6173  nction. All `das
-00039690: 6b2e 6461 7461 6672 616d 6560 0a20 2020  k.dataframe`.   
-000396a0: 2020 2020 206f 626a 6563 7473 2073 686f       objects sho
-000396b0: 756c 6420 6265 2070 6172 7469 7469 6f6e  uld be partition
-000396c0: 6564 2061 6e64 2069 6e64 6578 6564 2065  ed and indexed e
-000396d0: 7175 6976 616c 656e 746c 792e 0a20 2020  quivalently..   
-000396e0: 2063 6875 6e6b 203a 2066 756e 6374 696f   chunk : functio
-000396f0: 6e20 5b62 6c6f 636b 2d70 6572 2d61 7267  n [block-per-arg
-00039700: 5d20 2d3e 2062 6c6f 636b 0a20 2020 2020  ] -> block.     
-00039710: 2020 2046 756e 6374 696f 6e20 746f 206f     Function to o
-00039720: 7065 7261 7465 206f 6e20 6561 6368 2062  perate on each b
-00039730: 6c6f 636b 206f 6620 6461 7461 0a20 2020  lock of data.   
-00039740: 2061 6767 7265 6761 7465 203a 2066 756e   aggregate : fun
-00039750: 6374 696f 6e20 636f 6e63 6174 656e 6174  ction concatenat
-00039760: 6564 2d62 6c6f 636b 202d 3e20 626c 6f63  ed-block -> bloc
-00039770: 6b0a 2020 2020 2020 2020 4675 6e63 7469  k.        Functi
-00039780: 6f6e 2074 6f20 6f70 6572 6174 6520 6f6e  on to operate on
-00039790: 2074 6865 2063 6f6e 6361 7465 6e61 7465   the concatenate
-000397a0: 6420 7265 7375 6c74 206f 6620 6368 756e  d result of chun
-000397b0: 6b0a 2020 2020 636f 6d62 696e 6520 3a20  k.    combine : 
-000397c0: 6675 6e63 7469 6f6e 2063 6f6e 6361 7465  function concate
-000397d0: 6e61 7465 642d 626c 6f63 6b20 2d3e 2062  nated-block -> b
-000397e0: 6c6f 636b 2c20 6f70 7469 6f6e 616c 0a20  lock, optional. 
-000397f0: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
-00039800: 746f 206f 7065 7261 7465 206f 6e20 696e  to operate on in
-00039810: 7465 726d 6564 6961 7465 2063 6f6e 6361  termediate conca
-00039820: 7465 6e61 7465 6420 7265 7375 6c74 7320  tenated results 
-00039830: 6f66 2063 6875 6e6b 0a20 2020 2020 2020  of chunk.       
-00039840: 2069 6e20 6120 7472 6565 2d72 6564 7563   in a tree-reduc
-00039850: 7469 6f6e 2e20 4966 206e 6f74 2070 726f  tion. If not pro
-00039860: 7669 6465 642c 2064 6566 6175 6c74 7320  vided, defaults 
-00039870: 746f 2061 6767 7265 6761 7465 2e0a 2020  to aggregate..  
-00039880: 2020 244d 4554 410a 2020 2020 746f 6b65    $META.    toke
-00039890: 6e20 3a20 7374 722c 206f 7074 696f 6e61  n : str, optiona
-000398a0: 6c0a 2020 2020 2020 2020 5468 6520 6e61  l.        The na
-000398b0: 6d65 2074 6f20 7573 6520 666f 7220 7468  me to use for th
-000398c0: 6520 6f75 7470 7574 206b 6579 732e 0a20  e output keys.. 
-000398d0: 2020 2063 6875 6e6b 5f6b 7761 7267 7320     chunk_kwargs 
-000398e0: 3a20 6469 6374 2c20 6f70 7469 6f6e 616c  : dict, optional
-000398f0: 0a20 2020 2020 2020 204b 6579 776f 7264  .        Keyword
-00039900: 7320 666f 7220 7468 6520 6368 756e 6b20  s for the chunk 
-00039910: 6675 6e63 7469 6f6e 206f 6e6c 792e 0a20  function only.. 
-00039920: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
-00039930: 7267 7320 3a20 6469 6374 2c20 6f70 7469  rgs : dict, opti
-00039940: 6f6e 616c 0a20 2020 2020 2020 204b 6579  onal.        Key
-00039950: 776f 7264 7320 666f 7220 7468 6520 6167  words for the ag
-00039960: 6772 6567 6174 6520 6675 6e63 7469 6f6e  gregate function
-00039970: 206f 6e6c 792e 0a20 2020 2063 6f6d 6269   only..    combi
-00039980: 6e65 5f6b 7761 7267 7320 3a20 6469 6374  ne_kwargs : dict
-00039990: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-000399a0: 2020 204b 6579 776f 7264 7320 666f 7220     Keywords for 
-000399b0: 7468 6520 636f 6d62 696e 6520 6675 6e63  the combine func
-000399c0: 7469 6f6e 206f 6e6c 792e 0a20 2020 2073  tion only..    s
-000399d0: 706c 6974 5f65 7665 7279 203a 2069 6e74  plit_every : int
-000399e0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-000399f0: 2020 2047 726f 7570 2070 6172 7469 7469     Group partiti
-00039a00: 6f6e 7320 696e 746f 2067 726f 7570 7320  ons into groups 
-00039a10: 6f66 2074 6869 7320 7369 7a65 2077 6869  of this size whi
-00039a20: 6c65 2070 6572 666f 726d 696e 6720 610a  le performing a.
-00039a30: 2020 2020 2020 2020 7472 6565 2d72 6564          tree-red
-00039a40: 7563 7469 6f6e 2e20 4966 2073 6574 2074  uction. If set t
-00039a50: 6f20 4661 6c73 652c 206e 6f20 7472 6565  o False, no tree
-00039a60: 2d72 6564 7563 7469 6f6e 2077 696c 6c20  -reduction will 
-00039a70: 6265 2075 7365 642c 0a20 2020 2020 2020  be used,.       
-00039a80: 2061 6e64 2061 6c6c 2069 6e74 6572 6d65   and all interme
-00039a90: 6469 6174 6573 2077 696c 6c20 6265 2063  diates will be c
-00039aa0: 6f6e 6361 7465 6e61 7465 6420 616e 6420  oncatenated and 
-00039ab0: 7061 7373 6564 2074 6f20 6060 6167 6772  passed to ``aggr
-00039ac0: 6567 6174 6560 602e 0a20 2020 2020 2020  egate``..       
-00039ad0: 2044 6566 6175 6c74 2069 7320 382e 0a20   Default is 8.. 
-00039ae0: 2020 2073 706c 6974 5f6f 7574 203a 2069     split_out : i
-00039af0: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
-00039b00: 2020 2020 204e 756d 6265 7220 6f66 206f       Number of o
-00039b10: 7574 7075 7420 7061 7274 6974 696f 6e73  utput partitions
-00039b20: 2e20 5370 6c69 7420 6f63 6375 7273 2061  . Split occurs a
-00039b30: 6674 6572 2066 6972 7374 2063 6875 6e6b  fter first chunk
-00039b40: 2072 6564 7563 7469 6f6e 2e0a 2020 2020   reduction..    
-00039b50: 7370 6c69 745f 6f75 745f 7365 7475 7020  split_out_setup 
-00039b60: 3a20 6361 6c6c 6162 6c65 2c20 6f70 7469  : callable, opti
-00039b70: 6f6e 616c 0a20 2020 2020 2020 2049 6620  onal.        If 
-00039b80: 7072 6f76 6964 6564 2c20 7468 6973 2066  provided, this f
-00039b90: 756e 6374 696f 6e20 6973 2063 616c 6c65  unction is calle
-00039ba0: 6420 6f6e 2065 6163 6820 6368 756e 6b20  d on each chunk 
-00039bb0: 6265 666f 7265 2070 6572 666f 726d 696e  before performin
-00039bc0: 670a 2020 2020 2020 2020 7468 6520 6861  g.        the ha
-00039bd0: 7368 2d73 706c 6974 2e20 4974 2073 686f  sh-split. It sho
-00039be0: 756c 6420 7265 7475 726e 2061 2070 616e  uld return a pan
-00039bf0: 6461 7320 6f62 6a65 6374 2c20 7768 6572  das object, wher
-00039c00: 6520 6561 6368 2072 6f77 0a20 2020 2020  e each row.     
-00039c10: 2020 2028 6578 636c 7564 696e 6720 7468     (excluding th
-00039c20: 6520 696e 6465 7829 2069 7320 6861 7368  e index) is hash
-00039c30: 6564 2e20 4966 206e 6f74 2070 726f 7669  ed. If not provi
-00039c40: 6465 642c 2074 6865 2063 6875 6e6b 2069  ded, the chunk i
-00039c50: 7320 6861 7368 6564 0a20 2020 2020 2020  s hashed.       
-00039c60: 2061 7320 6973 2e0a 2020 2020 7370 6c69   as is..    spli
-00039c70: 745f 6f75 745f 7365 7475 705f 6b77 6172  t_out_setup_kwar
-00039c80: 6773 203a 2064 6963 742c 206f 7074 696f  gs : dict, optio
-00039c90: 6e61 6c0a 2020 2020 2020 2020 4b65 7977  nal.        Keyw
-00039ca0: 6f72 6473 2066 6f72 2074 6865 2060 7370  ords for the `sp
-00039cb0: 6c69 745f 6f75 745f 7365 7475 7060 2066  lit_out_setup` f
-00039cc0: 756e 6374 696f 6e20 6f6e 6c79 2e0a 2020  unction only..  
-00039cd0: 2020 736f 7274 203a 2062 6f6f 6c2c 2064    sort : bool, d
-00039ce0: 6566 6175 6c74 204e 6f6e 650a 2020 2020  efault None.    
-00039cf0: 2020 2020 4966 2061 6c6c 6f77 6564 2c20      If allowed, 
-00039d00: 736f 7274 2074 6865 206b 6579 7320 6f66  sort the keys of
-00039d10: 2074 6865 206f 7574 7075 7420 6167 6772   the output aggr
-00039d20: 6567 6174 696f 6e2e 0a20 2020 2069 676e  egation..    ign
-00039d30: 6f72 655f 696e 6465 7820 3a20 626f 6f6c  ore_index : bool
-00039d40: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
-00039d50: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-00039d60: 2064 6f20 6e6f 7420 7072 6573 6572 7665   do not preserve
-00039d70: 2069 6e64 6578 2076 616c 7565 7320 7468   index values th
-00039d80: 726f 7567 686f 7574 2041 4341 206f 7065  roughout ACA ope
-00039d90: 7261 7469 6f6e 732e 0a20 2020 206b 7761  rations..    kwa
-00039da0: 7267 7320 3a0a 2020 2020 2020 2020 416c  rgs :.        Al
-00039db0: 6c20 7265 6d61 696e 696e 6720 6b65 7977  l remaining keyw
-00039dc0: 6f72 6473 2077 696c 6c20 6265 2070 6173  ords will be pas
-00039dd0: 7365 6420 746f 2060 6063 6875 6e6b 6060  sed to ``chunk``
-00039de0: 2c20 6060 6167 6772 6567 6174 6560 602c  , ``aggregate``,
-00039df0: 2061 6e64 0a20 2020 2020 2020 2060 6063   and.        ``c
-00039e00: 6f6d 6269 6e65 6060 2e0a 0a20 2020 2045  ombine``...    E
-00039e10: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
-00039e20: 2d2d 2d2d 0a20 2020 203e 3e3e 2064 6566  ----.    >>> def
-00039e30: 2063 6875 6e6b 2861 5f62 6c6f 636b 2c20   chunk(a_block, 
-00039e40: 625f 626c 6f63 6b29 3a0a 2020 2020 2e2e  b_block):.    ..
-00039e50: 2e20 2020 2020 7061 7373 0a0a 2020 2020  .     pass..    
-00039e60: 3e3e 3e20 6465 6620 6167 6728 6466 293a  >>> def agg(df):
-00039e70: 0a20 2020 202e 2e2e 2020 2020 2070 6173  .    ...     pas
-00039e80: 730a 0a20 2020 203e 3e3e 2061 7070 6c79  s..    >>> apply
-00039e90: 5f63 6f6e 6361 745f 6170 706c 7928 5b61  _concat_apply([a
-00039ea0: 2c20 625d 2c20 6368 756e 6b3d 6368 756e  , b], chunk=chun
-00039eb0: 6b2c 2061 6767 7265 6761 7465 3d61 6767  k, aggregate=agg
-00039ec0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-00039ed0: 4b49 500a 2020 2020 2222 220a 2020 2020  KIP.    """.    
-00039ee0: 6966 2073 706c 6974 5f6f 7574 2069 7320  if split_out is 
-00039ef0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7370  None:.        sp
-00039f00: 6c69 745f 6f75 7420 3d20 310a 2020 2020  lit_out = 1.    
-00039f10: 6966 2063 6875 6e6b 5f6b 7761 7267 7320  if chunk_kwargs 
-00039f20: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00039f30: 2063 6875 6e6b 5f6b 7761 7267 7320 3d20   chunk_kwargs = 
-00039f40: 6469 6374 2829 0a20 2020 2069 6620 6167  dict().    if ag
-00039f50: 6772 6567 6174 655f 6b77 6172 6773 2069  gregate_kwargs i
-00039f60: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00039f70: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
-00039f80: 203d 2064 6963 7428 290a 2020 2020 6368   = dict().    ch
-00039f90: 756e 6b5f 6b77 6172 6773 2e75 7064 6174  unk_kwargs.updat
-00039fa0: 6528 6b77 6172 6773 290a 2020 2020 6167  e(kwargs).    ag
-00039fb0: 6772 6567 6174 655f 6b77 6172 6773 2e75  gregate_kwargs.u
-00039fc0: 7064 6174 6528 6b77 6172 6773 290a 0a20  pdate(kwargs).. 
-00039fd0: 2020 2069 6620 636f 6d62 696e 6520 6973     if combine is
-00039fe0: 204e 6f6e 653a 0a20 2020 2020 2020 2069   None:.        i
-00039ff0: 6620 636f 6d62 696e 655f 6b77 6172 6773  f combine_kwargs
-0003a000: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0003a010: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-0003a020: 6063 6f6d 6269 6e65 5f6b 7761 7267 7360  `combine_kwargs`
-0003a030: 2070 726f 7669 6465 6420 7769 7468 206e   provided with n
-0003a040: 6f20 6063 6f6d 6269 6e65 6022 290a 2020  o `combine`").  
-0003a050: 2020 2020 2020 636f 6d62 696e 6520 3d20        combine = 
-0003a060: 6167 6772 6567 6174 650a 2020 2020 2020  aggregate.      
-0003a070: 2020 636f 6d62 696e 655f 6b77 6172 6773    combine_kwargs
-0003a080: 203d 2061 6767 7265 6761 7465 5f6b 7761   = aggregate_kwa
-0003a090: 7267 730a 2020 2020 656c 7365 3a0a 2020  rgs.    else:.  
-0003a0a0: 2020 2020 2020 6966 2063 6f6d 6269 6e65        if combine
-0003a0b0: 5f6b 7761 7267 7320 6973 204e 6f6e 653a  _kwargs is None:
-0003a0c0: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
-0003a0d0: 6269 6e65 5f6b 7761 7267 7320 3d20 6469  bine_kwargs = di
-0003a0e0: 6374 2829 0a20 2020 2020 2020 2063 6f6d  ct().        com
-0003a0f0: 6269 6e65 5f6b 7761 7267 732e 7570 6461  bine_kwargs.upda
-0003a100: 7465 286b 7761 7267 7329 0a0a 2020 2020  te(kwargs)..    
-0003a110: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-0003a120: 6528 6172 6773 2c20 2874 7570 6c65 2c20  e(args, (tuple, 
-0003a130: 6c69 7374 2929 3a0a 2020 2020 2020 2020  list)):.        
-0003a140: 6172 6773 203d 205b 6172 6773 5d0a 0a20  args = [args].. 
-0003a150: 2020 2064 6673 203d 205b 6172 6720 666f     dfs = [arg fo
-0003a160: 7220 6172 6720 696e 2061 7267 7320 6966  r arg in args if
-0003a170: 2069 7369 6e73 7461 6e63 6528 6172 672c   isinstance(arg,
-0003a180: 205f 4672 616d 6529 5d0a 0a20 2020 206e   _Frame)]..    n
-0003a190: 7061 7274 6974 696f 6e73 203d 207b 6172  partitions = {ar
-0003a1a0: 672e 6e70 6172 7469 7469 6f6e 7320 666f  g.npartitions fo
-0003a1b0: 7220 6172 6720 696e 2064 6673 7d0a 2020  r arg in dfs}.  
-0003a1c0: 2020 6966 206c 656e 286e 7061 7274 6974    if len(npartit
-0003a1d0: 696f 6e73 2920 3e20 313a 0a20 2020 2020  ions) > 1:.     
-0003a1e0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0003a1f0: 726f 7228 2241 6c6c 2061 7267 756d 656e  ror("All argumen
-0003a200: 7473 206d 7573 7420 6861 7665 2073 616d  ts must have sam
-0003a210: 6520 6e75 6d62 6572 206f 6620 7061 7274  e number of part
-0003a220: 6974 696f 6e73 2229 0a20 2020 206e 7061  itions").    npa
-0003a230: 7274 6974 696f 6e73 203d 206e 7061 7274  rtitions = npart
-0003a240: 6974 696f 6e73 2e70 6f70 2829 0a0a 2020  itions.pop()..  
-0003a250: 2020 6966 2073 706c 6974 5f65 7665 7279    if split_every
-0003a260: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0003a270: 2020 7370 6c69 745f 6576 6572 7920 3d20    split_every = 
-0003a280: 380a 2020 2020 656c 6966 2073 706c 6974  8.    elif split
-0003a290: 5f65 7665 7279 2069 7320 4661 6c73 653a  _every is False:
-0003a2a0: 0a20 2020 2020 2020 2073 706c 6974 5f65  .        split_e
-0003a2b0: 7665 7279 203d 206e 7061 7274 6974 696f  very = npartitio
-0003a2c0: 6e73 0a20 2020 2065 6c69 6620 7370 6c69  ns.    elif spli
-0003a2d0: 745f 6576 6572 7920 3c20 3220 6f72 206e  t_every < 2 or n
-0003a2e0: 6f74 2069 7369 6e73 7461 6e63 6528 7370  ot isinstance(sp
-0003a2f0: 6c69 745f 6576 6572 792c 2049 6e74 6567  lit_every, Integ
-0003a300: 7261 6c29 3a0a 2020 2020 2020 2020 7261  ral):.        ra
-0003a310: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-0003a320: 7370 6c69 745f 6576 6572 7920 6d75 7374  split_every must
-0003a330: 2062 6520 616e 2069 6e74 6567 6572 203e   be an integer >
-0003a340: 3d20 3222 290a 0a20 2020 2074 6f6b 656e  = 2")..    token
-0003a350: 5f6b 6579 203d 2074 6f6b 656e 697a 6528  _key = tokenize(
-0003a360: 0a20 2020 2020 2020 2074 6f6b 656e 206f  .        token o
-0003a370: 7220 2863 6875 6e6b 2c20 6167 6772 6567  r (chunk, aggreg
-0003a380: 6174 6529 2c0a 2020 2020 2020 2020 6d65  ate),.        me
-0003a390: 7461 2c0a 2020 2020 2020 2020 6172 6773  ta,.        args
-0003a3a0: 2c0a 2020 2020 2020 2020 6368 756e 6b5f  ,.        chunk_
-0003a3b0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-0003a3c0: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
-0003a3d0: 2c0a 2020 2020 2020 2020 636f 6d62 696e  ,.        combin
-0003a3e0: 655f 6b77 6172 6773 2c0a 2020 2020 2020  e_kwargs,.      
-0003a3f0: 2020 7370 6c69 745f 6576 6572 792c 0a20    split_every,. 
-0003a400: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
-0003a410: 2c0a 2020 2020 2020 2020 7370 6c69 745f  ,.        split_
-0003a420: 6f75 745f 7365 7475 702c 0a20 2020 2020  out_setup,.     
-0003a430: 2020 2073 706c 6974 5f6f 7574 5f73 6574     split_out_set
-0003a440: 7570 5f6b 7761 7267 732c 0a20 2020 2029  up_kwargs,.    )
-0003a450: 0a0a 2020 2020 2320 426c 6f63 6b77 6973  ..    # Blockwis
-0003a460: 6520 4368 756e 6b20 4c61 7965 720a 2020  e Chunk Layer.  
-0003a470: 2020 6368 756e 6b5f 6e61 6d65 203d 2066    chunk_name = f
-0003a480: 227b 746f 6b65 6e20 6f72 2066 756e 636e  "{token or funcn
-0003a490: 616d 6528 6368 756e 6b29 7d2d 6368 756e  ame(chunk)}-chun
-0003a4a0: 6b2d 7b74 6f6b 656e 5f6b 6579 7d22 0a20  k-{token_key}". 
-0003a4b0: 2020 2063 6875 6e6b 6564 203d 206d 6170     chunked = map
-0003a4c0: 5f62 6167 5f70 6172 7469 7469 6f6e 7328  _bag_partitions(
-0003a4d0: 0a20 2020 2020 2020 2063 6875 6e6b 2c0a  .        chunk,.
-0003a4e0: 2020 2020 2020 2020 2320 436f 6e76 6572          # Conver
-0003a4f0: 7420 5f46 7261 6d65 2063 6f6c 6c65 6374  t _Frame collect
-0003a500: 696f 6e73 2074 6f20 4261 670a 2020 2020  ions to Bag.    
-0003a510: 2020 2020 2a5b 0a20 2020 2020 2020 2020      *[.         
-0003a520: 2020 2061 7267 2e74 6f5f 6261 6728 666f     arg.to_bag(fo
-0003a530: 726d 6174 3d22 6672 616d 6522 2920 6966  rmat="frame") if
-0003a540: 2069 7369 6e73 7461 6e63 6528 6172 672c   isinstance(arg,
-0003a550: 205f 4672 616d 6529 2065 6c73 6520 6172   _Frame) else ar
-0003a560: 670a 2020 2020 2020 2020 2020 2020 666f  g.            fo
-0003a570: 7220 6172 6720 696e 2061 7267 730a 2020  r arg in args.  
-0003a580: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-0003a590: 2074 6f6b 656e 3d63 6875 6e6b 5f6e 616d   token=chunk_nam
-0003a5a0: 652c 0a20 2020 2020 2020 202a 2a63 6875  e,.        **chu
-0003a5b0: 6e6b 5f6b 7761 7267 732c 0a20 2020 2029  nk_kwargs,.    )
-0003a5c0: 0a0a 2020 2020 2320 4e4f 5445 3a20 6063  ..    # NOTE: `c
-0003a5d0: 6875 6e6b 6564 6020 6973 206e 6f77 2061  hunked` is now a
-0003a5e0: 2042 6167 2063 6f6c 6c65 6374 696f 6e2e   Bag collection.
-0003a5f0: 0a20 2020 2023 2057 6520 646f 6e27 7420  .    # We don't 
-0003a600: 7573 6520 6120 4461 7461 4672 616d 6520  use a DataFrame 
-0003a610: 636f 6c6c 6563 7469 6f6e 2c20 6265 6361  collection, beca
-0003a620: 7573 650a 2020 2020 2320 7468 6520 7061  use.    # the pa
-0003a630: 7274 6974 696f 6e73 206d 6179 206e 6f74  rtitions may not
-0003a640: 2063 6f6e 7461 696e 2064 6174 6166 7261   contain datafra
-0003a650: 6d65 2d6c 696b 650a 2020 2020 2320 6f62  me-like.    # ob
-0003a660: 6a65 6374 7320 616e 796d 6f72 652e 0a0a  jects anymore...
-0003a670: 2020 2020 2320 426c 6f63 6b77 6973 6520      # Blockwise 
-0003a680: 5370 6c69 7420 4c61 7965 720a 2020 2020  Split Layer.    
-0003a690: 6966 2073 706c 6974 5f6f 7574 2061 6e64  if split_out and
-0003a6a0: 2073 706c 6974 5f6f 7574 203e 2031 3a0a   split_out > 1:.
-0003a6b0: 2020 2020 2020 2020 6368 756e 6b65 6420          chunked 
-0003a6c0: 3d20 6368 756e 6b65 642e 6d61 705f 7061  = chunked.map_pa
-0003a6d0: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-0003a6e0: 2020 2020 2020 6861 7368 5f73 6861 7264        hash_shard
-0003a6f0: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
-0003a700: 6c69 745f 6f75 742c 0a20 2020 2020 2020  lit_out,.       
-0003a710: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
-0003a720: 6574 7570 2c0a 2020 2020 2020 2020 2020  etup,.          
-0003a730: 2020 7370 6c69 745f 6f75 745f 7365 7475    split_out_setu
-0003a740: 705f 6b77 6172 6773 2c0a 2020 2020 2020  p_kwargs,.      
-0003a750: 2020 2020 2020 6967 6e6f 7265 5f69 6e64        ignore_ind
-0003a760: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
-0003a770: 746f 6b65 6e3d 2273 706c 6974 2d25 7322  token="split-%s"
-0003a780: 2025 2074 6f6b 656e 5f6b 6579 2c0a 2020   % token_key,.  
-0003a790: 2020 2020 2020 290a 0a20 2020 2023 2048        )..    # H
-0003a7a0: 616e 646c 6520 736f 7274 2062 6568 6176  andle sort behav
-0003a7b0: 696f 720a 2020 2020 6966 2073 6f72 7420  ior.    if sort 
-0003a7c0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0003a7d0: 2020 2020 2069 6620 736f 7274 2061 6e64       if sort and
-0003a7e0: 2073 706c 6974 5f6f 7574 203e 2031 3a0a   split_out > 1:.
-0003a7f0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0003a800: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-0003a810: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0003a820: 2020 2020 2020 2022 4361 6e6e 6f74 2067         "Cannot g
-0003a830: 7561 7261 6e74 6565 2073 6f72 7465 6420  uarantee sorted 
-0003a840: 6b65 7973 2066 6f72 2060 7370 6c69 745f  keys for `split_
-0003a850: 6f75 743e 3160 2e22 0a20 2020 2020 2020  out>1`.".       
-0003a860: 2020 2020 2020 2020 2022 2054 7279 2075           " Try u
-0003a870: 7369 6e67 2073 706c 6974 5f6f 7574 3d31  sing split_out=1
-0003a880: 2c20 6f72 2067 726f 7570 696e 6720 7769  , or grouping wi
-0003a890: 7468 2073 6f72 743d 4661 6c73 652e 220a  th sort=False.".
-0003a8a0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0003a8b0: 2020 2020 2020 6167 6772 6567 6174 655f        aggregate_
-0003a8c0: 6b77 6172 6773 203d 2061 6767 7265 6761  kwargs = aggrega
-0003a8d0: 7465 5f6b 7761 7267 7320 6f72 207b 7d0a  te_kwargs or {}.
-0003a8e0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-0003a8f0: 655f 6b77 6172 6773 5b22 736f 7274 225d  e_kwargs["sort"]
-0003a900: 203d 2073 6f72 740a 0a20 2020 2023 2054   = sort..    # T
-0003a910: 7265 652d 5265 6475 6374 696f 6e20 4c61  ree-Reduction La
-0003a920: 7965 720a 2020 2020 6669 6e61 6c5f 6e61  yer.    final_na
-0003a930: 6d65 203d 2066 227b 746f 6b65 6e20 6f72  me = f"{token or
-0003a940: 2066 756e 636e 616d 6528 6167 6772 6567   funcname(aggreg
-0003a950: 6174 6529 7d2d 6167 672d 7b74 6f6b 656e  ate)}-agg-{token
-0003a960: 5f6b 6579 7d22 0a20 2020 206c 6179 6572  _key}".    layer
-0003a970: 203d 2044 6174 6146 7261 6d65 5472 6565   = DataFrameTree
-0003a980: 5265 6475 6374 696f 6e28 0a20 2020 2020  Reduction(.     
-0003a990: 2020 2066 696e 616c 5f6e 616d 652c 0a20     final_name,. 
-0003a9a0: 2020 2020 2020 2063 6875 6e6b 6564 2e6e         chunked.n
-0003a9b0: 616d 652c 0a20 2020 2020 2020 206e 7061  ame,.        npa
-0003a9c0: 7274 6974 696f 6e73 2c0a 2020 2020 2020  rtitions,.      
-0003a9d0: 2020 7061 7274 6961 6c28 5f63 6f6e 6361    partial(_conca
-0003a9e0: 742c 2069 676e 6f72 655f 696e 6465 783d  t, ignore_index=
-0003a9f0: 6967 6e6f 7265 5f69 6e64 6578 292c 0a20  ignore_index),. 
-0003aa00: 2020 2020 2020 2070 6172 7469 616c 2863         partial(c
-0003aa10: 6f6d 6269 6e65 2c20 2a2a 636f 6d62 696e  ombine, **combin
-0003aa20: 655f 6b77 6172 6773 2920 6966 2063 6f6d  e_kwargs) if com
-0003aa30: 6269 6e65 5f6b 7761 7267 7320 656c 7365  bine_kwargs else
-0003aa40: 2063 6f6d 6269 6e65 2c0a 2020 2020 2020   combine,.      
-0003aa50: 2020 6669 6e61 6c69 7a65 5f66 756e 633d    finalize_func=
-0003aa60: 7061 7274 6961 6c28 6167 6772 6567 6174  partial(aggregat
-0003aa70: 652c 202a 2a61 6767 7265 6761 7465 5f6b  e, **aggregate_k
-0003aa80: 7761 7267 7329 0a20 2020 2020 2020 2069  wargs).        i
-0003aa90: 6620 6167 6772 6567 6174 655f 6b77 6172  f aggregate_kwar
-0003aaa0: 6773 0a20 2020 2020 2020 2065 6c73 6520  gs.        else 
-0003aab0: 6167 6772 6567 6174 652c 0a20 2020 2020  aggregate,.     
-0003aac0: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
-0003aad0: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
-0003aae0: 2020 2020 7370 6c69 745f 6f75 743d 7370      split_out=sp
-0003aaf0: 6c69 745f 6f75 7420 6966 2028 7370 6c69  lit_out if (spli
-0003ab00: 745f 6f75 7420 616e 6420 7370 6c69 745f  t_out and split_
-0003ab10: 6f75 7420 3e20 3129 2065 6c73 6520 4e6f  out > 1) else No
-0003ab20: 6e65 2c0a 2020 2020 2020 2020 7472 6565  ne,.        tree
-0003ab30: 5f6e 6f64 655f 6e61 6d65 3d66 227b 746f  _node_name=f"{to
-0003ab40: 6b65 6e20 6f72 2066 756e 636e 616d 6528  ken or funcname(
-0003ab50: 636f 6d62 696e 6529 7d2d 636f 6d62 696e  combine)}-combin
-0003ab60: 652d 7b74 6f6b 656e 5f6b 6579 7d22 2c0a  e-{token_key}",.
-0003ab70: 2020 2020 290a 0a20 2020 2069 6620 6d65      )..    if me
-0003ab80: 7461 2069 7320 6e6f 5f64 6566 6175 6c74  ta is no_default
-0003ab90: 3a0a 2020 2020 2020 2020 6d65 7461 5f63  :.        meta_c
-0003aba0: 6875 6e6b 203d 205f 656d 756c 6174 6528  hunk = _emulate(
-0003abb0: 6368 756e 6b2c 202a 6172 6773 2c20 7564  chunk, *args, ud
-0003abc0: 663d 5472 7565 2c20 2a2a 6368 756e 6b5f  f=True, **chunk_
-0003abd0: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
-0003abe0: 6d65 7461 203d 205f 656d 756c 6174 6528  meta = _emulate(
-0003abf0: 0a20 2020 2020 2020 2020 2020 2061 6767  .            agg
-0003ac00: 7265 6761 7465 2c20 5f63 6f6e 6361 7428  regate, _concat(
-0003ac10: 5b6d 6574 615f 6368 756e 6b5d 2c20 6967  [meta_chunk], ig
-0003ac20: 6e6f 7265 5f69 6e64 6578 292c 2075 6466  nore_index), udf
-0003ac30: 3d54 7275 652c 202a 2a61 6767 7265 6761  =True, **aggrega
-0003ac40: 7465 5f6b 7761 7267 730a 2020 2020 2020  te_kwargs.      
-0003ac50: 2020 290a 2020 2020 6d65 7461 203d 206d    ).    meta = m
-0003ac60: 616b 655f 6d65 7461 280a 2020 2020 2020  ake_meta(.      
-0003ac70: 2020 6d65 7461 2c0a 2020 2020 2020 2020    meta,.        
-0003ac80: 696e 6465 783d 2867 6574 6174 7472 286d  index=(getattr(m
-0003ac90: 616b 655f 6d65 7461 2864 6673 5b30 5d29  ake_meta(dfs[0])
-0003aca0: 2c20 2269 6e64 6578 222c 204e 6f6e 6529  , "index", None)
-0003acb0: 2069 6620 6466 7320 656c 7365 204e 6f6e   if dfs else Non
-0003acc0: 6529 2c0a 2020 2020 2020 2020 7061 7265  e),.        pare
-0003acd0: 6e74 5f6d 6574 613d 6466 735b 305d 2e5f  nt_meta=dfs[0]._
-0003ace0: 6d65 7461 2c0a 2020 2020 290a 0a20 2020  meta,.    )..   
-0003acf0: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-0003ad00: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-0003ad10: 6c65 6374 696f 6e73 2866 696e 616c 5f6e  lections(final_n
-0003ad20: 616d 652c 206c 6179 6572 2c20 6465 7065  ame, layer, depe
-0003ad30: 6e64 656e 6369 6573 3d28 6368 756e 6b65  ndencies=(chunke
-0003ad40: 642c 2929 0a20 2020 2064 6976 6973 696f  d,)).    divisio
-0003ad50: 6e73 203d 205b 4e6f 6e65 5d20 2a20 2828  ns = [None] * ((
-0003ad60: 7370 6c69 745f 6f75 7420 6f72 2031 2920  split_out or 1) 
-0003ad70: 2b20 3129 0a20 2020 2072 6574 7572 6e20  + 1).    return 
-0003ad80: 6e65 775f 6464 5f6f 626a 6563 7428 6772  new_dd_object(gr
-0003ad90: 6170 682c 2066 696e 616c 5f6e 616d 652c  aph, final_name,
-0003ada0: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
-0003adb0: 2c20 7061 7265 6e74 5f6d 6574 613d 6466  , parent_meta=df
-0003adc0: 735b 305d 2e5f 6d65 7461 290a 0a0a 6163  s[0]._meta)...ac
-0003add0: 6120 3d20 6170 706c 795f 636f 6e63 6174  a = apply_concat
-0003ade0: 5f61 7070 6c79 0a0a 0a64 6566 205f 6578  _apply...def _ex
-0003adf0: 7472 6163 745f 6d65 7461 2878 2c20 6e6f  tract_meta(x, no
-0003ae00: 6e65 6d70 7479 3d46 616c 7365 293a 0a20  nempty=False):. 
-0003ae10: 2020 2022 2222 0a20 2020 2045 7874 7261     """.    Extra
-0003ae20: 6374 2069 6e74 6572 6e61 6c20 6361 6368  ct internal cach
-0003ae30: 6520 6461 7461 2028 6060 5f6d 6574 6160  e data (``_meta`
-0003ae40: 6029 2066 726f 6d20 6464 2e44 6174 6146  `) from dd.DataF
-0003ae50: 7261 6d65 202f 2064 642e 5365 7269 6573  rame / dd.Series
-0003ae60: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
-0003ae70: 6973 696e 7374 616e 6365 2878 2c20 2853  isinstance(x, (S
-0003ae80: 6361 6c61 722c 205f 4672 616d 6529 293a  calar, _Frame)):
-0003ae90: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0003aea0: 782e 5f6d 6574 615f 6e6f 6e65 6d70 7479  x._meta_nonempty
-0003aeb0: 2069 6620 6e6f 6e65 6d70 7479 2065 6c73   if nonempty els
-0003aec0: 6520 782e 5f6d 6574 610a 2020 2020 656c  e x._meta.    el
-0003aed0: 6966 2069 7369 6e73 7461 6e63 6528 782c  if isinstance(x,
-0003aee0: 206c 6973 7429 3a0a 2020 2020 2020 2020   list):.        
-0003aef0: 7265 7475 726e 205b 5f65 7874 7261 6374  return [_extract
-0003af00: 5f6d 6574 6128 5f78 2c20 6e6f 6e65 6d70  _meta(_x, nonemp
-0003af10: 7479 2920 666f 7220 5f78 2069 6e20 785d  ty) for _x in x]
-0003af20: 0a20 2020 2065 6c69 6620 6973 696e 7374  .    elif isinst
-0003af30: 616e 6365 2878 2c20 7475 706c 6529 3a0a  ance(x, tuple):.
-0003af40: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-0003af50: 7570 6c65 285f 6578 7472 6163 745f 6d65  uple(_extract_me
-0003af60: 7461 285f 782c 206e 6f6e 656d 7074 7929  ta(_x, nonempty)
-0003af70: 2066 6f72 205f 7820 696e 2078 290a 2020   for _x in x).  
-0003af80: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-0003af90: 6528 782c 2064 6963 7429 3a0a 2020 2020  e(x, dict):.    
-0003afa0: 2020 2020 7265 7320 3d20 7b7d 0a20 2020      res = {}.   
-0003afb0: 2020 2020 2066 6f72 206b 2069 6e20 783a       for k in x:
-0003afc0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-0003afd0: 5b6b 5d20 3d20 5f65 7874 7261 6374 5f6d  [k] = _extract_m
-0003afe0: 6574 6128 785b 6b5d 2c20 6e6f 6e65 6d70  eta(x[k], nonemp
-0003aff0: 7479 290a 2020 2020 2020 2020 7265 7475  ty).        retu
-0003b000: 726e 2072 6573 0a20 2020 2065 6c69 6620  rn res.    elif 
-0003b010: 6973 696e 7374 616e 6365 2878 2c20 4465  isinstance(x, De
-0003b020: 6c61 7965 6429 3a0a 2020 2020 2020 2020  layed):.        
-0003b030: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0003b040: 280a 2020 2020 2020 2020 2020 2020 2243  (.            "C
-0003b050: 616e 6e6f 7420 696e 6665 7220 6461 7461  annot infer data
-0003b060: 6672 616d 6520 6d65 7461 6461 7461 2077  frame metadata w
-0003b070: 6974 6820 6120 6064 6173 6b2e 6465 6c61  ith a `dask.dela
-0003b080: 7965 6460 2061 7267 756d 656e 7422 0a20  yed` argument". 
-0003b090: 2020 2020 2020 2029 0a20 2020 2065 6c73         ).    els
-0003b0a0: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
-0003b0b0: 6e20 780a 0a0a 6465 6620 5f65 6d75 6c61  n x...def _emula
-0003b0c0: 7465 2866 756e 632c 202a 6172 6773 2c20  te(func, *args, 
-0003b0d0: 7564 663d 4661 6c73 652c 202a 2a6b 7761  udf=False, **kwa
-0003b0e0: 7267 7329 3a0a 2020 2020 2222 220a 2020  rgs):.    """.  
-0003b0f0: 2020 4170 706c 7920 6120 6675 6e63 7469    Apply a functi
-0003b100: 6f6e 2075 7369 6e67 2061 7267 7320 2f20  on using args / 
-0003b110: 6b77 6172 6773 2e20 4966 2061 7267 756d  kwargs. If argum
-0003b120: 656e 7473 2063 6f6e 7461 696e 2064 642e  ents contain dd.
-0003b130: 4461 7461 4672 616d 6520 2f0a 2020 2020  DataFrame /.    
-0003b140: 6464 2e53 6572 6965 732c 2075 7369 6e67  dd.Series, using
-0003b150: 2069 6e74 6572 6e61 6c20 6361 6368 6520   internal cache 
-0003b160: 2860 605f 6d65 7461 6060 2920 666f 7220  (``_meta``) for 
-0003b170: 6361 6c63 756c 6174 696f 6e0a 2020 2020  calculation.    
-0003b180: 2222 220a 2020 2020 7769 7468 2072 6169  """.    with rai
-0003b190: 7365 5f6f 6e5f 6d65 7461 5f65 7272 6f72  se_on_meta_error
-0003b1a0: 2866 756e 636e 616d 6528 6675 6e63 292c  (funcname(func),
-0003b1b0: 2075 6466 3d75 6466 292c 2063 6865 636b   udf=udf), check
-0003b1c0: 5f6e 756d 6572 6963 5f6f 6e6c 795f 6465  _numeric_only_de
-0003b1d0: 7072 6563 6174 696f 6e28 293a 0a20 2020  precation():.   
-0003b1e0: 2020 2020 2072 6574 7572 6e20 6675 6e63       return func
-0003b1f0: 282a 5f65 7874 7261 6374 5f6d 6574 6128  (*_extract_meta(
-0003b200: 6172 6773 2c20 5472 7565 292c 202a 2a5f  args, True), **_
-0003b210: 6578 7472 6163 745f 6d65 7461 286b 7761  extract_meta(kwa
-0003b220: 7267 732c 2054 7275 6529 290a 0a0a 4069  rgs, True))...@i
-0003b230: 6e73 6572 745f 6d65 7461 5f70 6172 616d  nsert_meta_param
-0003b240: 5f64 6573 6372 6970 7469 6f6e 0a64 6566  _description.def
-0003b250: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
-0003b260: 0a20 2020 2066 756e 632c 0a20 2020 202a  .    func,.    *
-0003b270: 6172 6773 2c0a 2020 2020 6d65 7461 3d6e  args,.    meta=n
-0003b280: 6f5f 6465 6661 756c 742c 0a20 2020 2065  o_default,.    e
-0003b290: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
-0003b2a0: 5472 7565 2c0a 2020 2020 7472 616e 7366  True,.    transf
-0003b2b0: 6f72 6d5f 6469 7669 7369 6f6e 733d 5472  orm_divisions=Tr
-0003b2c0: 7565 2c0a 2020 2020 616c 6967 6e5f 6461  ue,.    align_da
-0003b2d0: 7461 6672 616d 6573 3d54 7275 652c 0a20  taframes=True,. 
-0003b2e0: 2020 202a 2a6b 7761 7267 732c 0a29 3a0a     **kwargs,.):.
-0003b2f0: 2020 2020 2222 2241 7070 6c79 2050 7974      """Apply Pyt
-0003b300: 686f 6e20 6675 6e63 7469 6f6e 206f 6e20  hon function on 
-0003b310: 6561 6368 2044 6174 6146 7261 6d65 2070  each DataFrame p
-0003b320: 6172 7469 7469 6f6e 2e0a 0a20 2020 2050  artition...    P
-0003b330: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-0003b340: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066 756e  --------.    fun
-0003b350: 6320 3a20 6675 6e63 7469 6f6e 0a20 2020  c : function.   
-0003b360: 2020 2020 2046 756e 6374 696f 6e20 6170       Function ap
-0003b370: 706c 6965 6420 746f 2065 6163 6820 7061  plied to each pa
-0003b380: 7274 6974 696f 6e2e 0a20 2020 2061 7267  rtition..    arg
-0003b390: 732c 206b 7761 7267 7320 3a0a 2020 2020  s, kwargs :.    
-0003b3a0: 2020 2020 4172 6775 6d65 6e74 7320 616e      Arguments an
-0003b3b0: 6420 6b65 7977 6f72 6473 2074 6f20 7061  d keywords to pa
-0003b3c0: 7373 2074 6f20 7468 6520 6675 6e63 7469  ss to the functi
-0003b3d0: 6f6e 2e20 2041 7420 6c65 6173 7420 6f6e  on.  At least on
-0003b3e0: 6520 6f66 2074 6865 0a20 2020 2020 2020  e of the.       
-0003b3f0: 2061 7267 7320 7368 6f75 6c64 2062 6520   args should be 
-0003b400: 6120 4461 736b 2e64 6174 6166 7261 6d65  a Dask.dataframe
-0003b410: 2e20 4172 6775 6d65 6e74 7320 616e 6420  . Arguments and 
-0003b420: 6b65 7977 6f72 6473 206d 6179 2063 6f6e  keywords may con
-0003b430: 7461 696e 0a20 2020 2020 2020 2060 6053  tain.        ``S
-0003b440: 6361 6c61 7260 602c 2060 6044 656c 6179  calar``, ``Delay
-0003b450: 6564 6060 206f 7220 7265 6775 6c61 7220  ed`` or regular 
-0003b460: 7079 7468 6f6e 206f 626a 6563 7473 2e20  python objects. 
-0003b470: 4461 7461 4672 616d 652d 6c69 6b65 2061  DataFrame-like a
-0003b480: 7267 730a 2020 2020 2020 2020 2862 6f74  rgs.        (bot
-0003b490: 6820 6461 736b 2061 6e64 2070 616e 6461  h dask and panda
-0003b4a0: 7329 2077 696c 6c20 6265 2072 6570 6172  s) will be repar
-0003b4b0: 7469 7469 6f6e 6564 2074 6f20 616c 6967  titioned to alig
-0003b4c0: 6e20 2869 6620 6e65 6365 7373 6172 7929  n (if necessary)
-0003b4d0: 0a20 2020 2020 2020 2062 6566 6f72 6520  .        before 
-0003b4e0: 6170 706c 7969 6e67 2074 6865 2066 756e  applying the fun
-0003b4f0: 6374 696f 6e20 2873 6565 2060 6061 6c69  ction (see ``ali
-0003b500: 676e 5f64 6174 6166 7261 6d65 7360 6020  gn_dataframes`` 
-0003b510: 746f 2063 6f6e 7472 6f6c 292e 0a20 2020  to control)..   
-0003b520: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-0003b530: 6120 3a20 626f 6f6c 2c20 6465 6661 756c  a : bool, defaul
-0003b540: 7420 5472 7565 0a20 2020 2020 2020 2057  t True.        W
-0003b550: 6865 7468 6572 2074 6f20 656e 666f 7263  hether to enforc
-0003b560: 6520 6174 2072 756e 7469 6d65 2074 6861  e at runtime tha
-0003b570: 7420 7468 6520 7374 7275 6374 7572 6520  t the structure 
-0003b580: 6f66 2074 6865 2044 6174 6146 7261 6d65  of the DataFrame
-0003b590: 0a20 2020 2020 2020 2070 726f 6475 6365  .        produce
-0003b5a0: 6420 6279 2060 6066 756e 6360 6020 6163  d by ``func`` ac
-0003b5b0: 7475 616c 6c79 206d 6174 6368 6573 2074  tually matches t
-0003b5c0: 6865 2073 7472 7563 7475 7265 206f 6620  he structure of 
-0003b5d0: 6060 6d65 7461 6060 2e0a 2020 2020 2020  ``meta``..      
-0003b5e0: 2020 5468 6973 2077 696c 6c20 7265 6e61    This will rena
-0003b5f0: 6d65 2061 6e64 2072 656f 7264 6572 2063  me and reorder c
-0003b600: 6f6c 756d 6e73 2066 6f72 2065 6163 6820  olumns for each 
-0003b610: 7061 7274 6974 696f 6e2c 0a20 2020 2020  partition,.     
-0003b620: 2020 2061 6e64 2077 696c 6c20 7261 6973     and will rais
-0003b630: 6520 616e 2065 7272 6f72 2069 6620 7468  e an error if th
-0003b640: 6973 2064 6f65 736e 2774 2077 6f72 6b2c  is doesn't work,
-0003b650: 0a20 2020 2020 2020 2062 7574 2069 7420  .        but it 
-0003b660: 776f 6e27 7420 7261 6973 6520 6966 2064  won't raise if d
-0003b670: 7479 7065 7320 646f 6e27 7420 6d61 7463  types don't matc
-0003b680: 682e 0a20 2020 2074 7261 6e73 666f 726d  h..    transform
-0003b690: 5f64 6976 6973 696f 6e73 203a 2062 6f6f  _divisions : boo
-0003b6a0: 6c2c 2064 6566 6175 6c74 2054 7275 650a  l, default True.
-0003b6b0: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
-0003b6c0: 746f 2061 7070 6c79 2074 6865 2066 756e  to apply the fun
-0003b6d0: 6374 696f 6e20 6f6e 746f 2074 6865 2064  ction onto the d
-0003b6e0: 6976 6973 696f 6e73 2061 6e64 2061 7070  ivisions and app
-0003b6f0: 6c79 2074 686f 7365 0a20 2020 2020 2020  ly those.       
-0003b700: 2074 7261 6e73 666f 726d 6564 2064 6976   transformed div
-0003b710: 6973 696f 6e73 2074 6f20 7468 6520 6f75  isions to the ou
-0003b720: 7470 7574 2e0a 2020 2020 616c 6967 6e5f  tput..    align_
-0003b730: 6461 7461 6672 616d 6573 203a 2062 6f6f  dataframes : boo
-0003b740: 6c2c 2064 6566 6175 6c74 2054 7275 650a  l, default True.
-0003b750: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
-0003b760: 746f 2072 6570 6172 7469 7469 6f6e 2044  to repartition D
-0003b770: 6174 6146 7261 6d65 2d20 6f72 2053 6572  ataFrame- or Ser
-0003b780: 6965 732d 6c69 6b65 2061 7267 730a 2020  ies-like args.  
-0003b790: 2020 2020 2020 2862 6f74 6820 6461 736b        (both dask
-0003b7a0: 2061 6e64 2070 616e 6461 7329 2073 6f20   and pandas) so 
-0003b7b0: 7468 6569 7220 6469 7669 7369 6f6e 7320  their divisions 
-0003b7c0: 616c 6967 6e20 6265 666f 7265 2061 7070  align before app
-0003b7d0: 6c79 696e 670a 2020 2020 2020 2020 7468  lying.        th
-0003b7e0: 6520 6675 6e63 7469 6f6e 2e20 5468 6973  e function. This
-0003b7f0: 2072 6571 7569 7265 7320 616c 6c20 696e   requires all in
-0003b800: 7075 7473 2074 6f20 6861 7665 206b 6e6f  puts to have kno
-0003b810: 776e 2064 6976 6973 696f 6e73 2e0a 2020  wn divisions..  
-0003b820: 2020 2020 2020 5369 6e67 6c65 2d70 6172        Single-par
-0003b830: 7469 7469 6f6e 2069 6e70 7574 7320 7769  tition inputs wi
-0003b840: 6c6c 2062 6520 7370 6c69 7420 696e 746f  ll be split into
-0003b850: 206d 756c 7469 706c 6520 7061 7274 6974   multiple partit
-0003b860: 696f 6e73 2e0a 0a20 2020 2020 2020 2049  ions...        I
-0003b870: 6620 4661 6c73 652c 2061 6c6c 2069 6e70  f False, all inp
-0003b880: 7574 7320 6d75 7374 2068 6176 6520 6569  uts must have ei
-0003b890: 7468 6572 2074 6865 2073 616d 6520 6e75  ther the same nu
-0003b8a0: 6d62 6572 206f 6620 7061 7274 6974 696f  mber of partitio
-0003b8b0: 6e73 0a20 2020 2020 2020 206f 7220 6120  ns.        or a 
-0003b8c0: 7369 6e67 6c65 2070 6172 7469 7469 6f6e  single partition
-0003b8d0: 2e20 5369 6e67 6c65 2d70 6172 7469 7469  . Single-partiti
-0003b8e0: 6f6e 2069 6e70 7574 7320 7769 6c6c 2062  on inputs will b
-0003b8f0: 6520 6272 6f61 6463 6173 7420 746f 0a20  e broadcast to. 
-0003b900: 2020 2020 2020 2065 7665 7279 2070 6172         every par
-0003b910: 7469 7469 6f6e 206f 6620 6d75 6c74 692d  tition of multi-
-0003b920: 7061 7274 6974 696f 6e20 696e 7075 7473  partition inputs
-0003b930: 2e0a 2020 2020 244d 4554 410a 2020 2020  ..    $META.    
-0003b940: 2222 220a 2020 2020 6e61 6d65 203d 206b  """.    name = k
-0003b950: 7761 7267 732e 706f 7028 2274 6f6b 656e  wargs.pop("token
-0003b960: 222c 204e 6f6e 6529 0a20 2020 2070 6172  ", None).    par
-0003b970: 656e 745f 6d65 7461 203d 206b 7761 7267  ent_meta = kwarg
-0003b980: 732e 706f 7028 2270 6172 656e 745f 6d65  s.pop("parent_me
-0003b990: 7461 222c 204e 6f6e 6529 0a0a 2020 2020  ta", None)..    
-0003b9a0: 6173 7365 7274 2063 616c 6c61 626c 6528  assert callable(
-0003b9b0: 6675 6e63 290a 2020 2020 6966 206e 616d  func).    if nam
-0003b9c0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-0003b9d0: 2020 2020 2020 2074 6f6b 656e 203d 2074         token = t
-0003b9e0: 6f6b 656e 697a 6528 6d65 7461 2c20 2a61  okenize(meta, *a
-0003b9f0: 7267 732c 202a 2a6b 7761 7267 7329 0a20  rgs, **kwargs). 
-0003ba00: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0003ba10: 206e 616d 6520 3d20 6675 6e63 6e61 6d65   name = funcname
-0003ba20: 2866 756e 6329 0a20 2020 2020 2020 2074  (func).        t
-0003ba30: 6f6b 656e 203d 2074 6f6b 656e 697a 6528  oken = tokenize(
-0003ba40: 6675 6e63 2c20 6d65 7461 2c20 2a61 7267  func, meta, *arg
-0003ba50: 732c 202a 2a6b 7761 7267 7329 0a20 2020  s, **kwargs).   
-0003ba60: 206e 616d 6520 3d20 6622 7b6e 616d 657d   name = f"{name}
-0003ba70: 2d7b 746f 6b65 6e7d 220a 0a20 2020 2066  -{token}"..    f
-0003ba80: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-0003ba90: 6d65 2e6d 756c 7469 2069 6d70 6f72 7420  me.multi import 
-0003baa0: 5f6d 6179 6265 5f61 6c69 676e 5f70 6172  _maybe_align_par
-0003bab0: 7469 7469 6f6e 730a 0a20 2020 2069 6620  titions..    if 
-0003bac0: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
-0003bad0: 3a0a 2020 2020 2020 2020 6172 6773 203d  :.        args =
-0003bae0: 205f 6d61 7962 655f 6672 6f6d 5f70 616e   _maybe_from_pan
-0003baf0: 6461 7328 6172 6773 290a 2020 2020 2020  das(args).      
-0003bb00: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-0003bb10: 2020 2061 7267 7320 3d20 5f6d 6179 6265     args = _maybe
-0003bb20: 5f61 6c69 676e 5f70 6172 7469 7469 6f6e  _align_partition
-0003bb30: 7328 6172 6773 290a 2020 2020 2020 2020  s(args).        
-0003bb40: 6578 6365 7074 2056 616c 7565 4572 726f  except ValueErro
-0003bb50: 7220 6173 2065 3a0a 2020 2020 2020 2020  r as e:.        
-0003bb60: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0003bb70: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0003bb80: 2020 2020 2020 6622 7b65 7d2e 2049 6620        f"{e}. If 
-0003bb90: 796f 7520 646f 6e27 7420 7761 6e74 2074  you don't want t
-0003bba0: 6865 2070 6172 7469 7469 6f6e 7320 746f  he partitions to
-0003bbb0: 2062 6520 616c 6967 6e65 642c 2061 6e64   be aligned, and
-0003bbc0: 2061 7265 2022 0a20 2020 2020 2020 2020   are ".         
-0003bbd0: 2020 2020 2020 2022 6361 6c6c 696e 6720         "calling 
-0003bbe0: 606d 6170 5f70 6172 7469 7469 6f6e 7360  `map_partitions`
-0003bbf0: 2064 6972 6563 746c 792c 2070 6173 7320   directly, pass 
-0003bc00: 6061 6c69 676e 5f64 6174 6166 7261 6d65  `align_dataframe
-0003bc10: 733d 4661 6c73 6560 2e22 0a20 2020 2020  s=False`.".     
-0003bc20: 2020 2020 2020 2029 2066 726f 6d20 650a         ) from e.
-0003bc30: 0a20 2020 2064 6673 203d 205b 6466 2066  .    dfs = [df f
-0003bc40: 6f72 2064 6620 696e 2061 7267 7320 6966  or df in args if
-0003bc50: 2069 7369 6e73 7461 6e63 6528 6466 2c20   isinstance(df, 
-0003bc60: 5f46 7261 6d65 295d 0a0a 2020 2020 6d65  _Frame)]..    me
-0003bc70: 7461 203d 205f 6765 745f 6d65 7461 5f6d  ta = _get_meta_m
-0003bc80: 6170 5f70 6172 7469 7469 6f6e 7328 6172  ap_partitions(ar
-0003bc90: 6773 2c20 6466 732c 2066 756e 632c 206b  gs, dfs, func, k
-0003bca0: 7761 7267 732c 206d 6574 612c 2070 6172  wargs, meta, par
-0003bcb0: 656e 745f 6d65 7461 290a 2020 2020 6966  ent_meta).    if
-0003bcc0: 2061 6c6c 2869 7369 6e73 7461 6e63 6528   all(isinstance(
-0003bcd0: 6172 672c 2053 6361 6c61 7229 2066 6f72  arg, Scalar) for
-0003bce0: 2061 7267 2069 6e20 6172 6773 293a 0a20   arg in args):. 
-0003bcf0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
-0003bd00: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
-0003bd10: 6d65 2c20 3029 3a20 280a 2020 2020 2020  me, 0): (.      
-0003bd20: 2020 2020 2020 2020 2020 6170 706c 792c            apply,
-0003bd30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003bd40: 2066 756e 632c 0a20 2020 2020 2020 2020   func,.         
-0003bd50: 2020 2020 2020 2028 7475 706c 652c 205b         (tuple, [
-0003bd60: 2861 7267 2e5f 6e61 6d65 2c20 3029 2066  (arg._name, 0) f
-0003bd70: 6f72 2061 7267 2069 6e20 6172 6773 5d29  or arg in args])
-0003bd80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003bd90: 2020 6b77 6172 6773 2c0a 2020 2020 2020    kwargs,.      
-0003bda0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0003bdb0: 7d0a 2020 2020 2020 2020 6772 6170 6820  }.        graph 
-0003bdc0: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-0003bdd0: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-0003bde0: 7328 6e61 6d65 2c20 6c61 7965 722c 2064  s(name, layer, d
-0003bdf0: 6570 656e 6465 6e63 6965 733d 6172 6773  ependencies=args
-0003be00: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0003be10: 2053 6361 6c61 7228 6772 6170 682c 206e   Scalar(graph, n
-0003be20: 616d 652c 206d 6574 6129 0a0a 2020 2020  ame, meta)..    
-0003be30: 6172 6773 3220 3d20 5b5d 0a20 2020 2064  args2 = [].    d
-0003be40: 6570 656e 6465 6e63 6965 7320 3d20 5b5d  ependencies = []
-0003be50: 0a20 2020 2066 6f72 2061 7267 2069 6e20  .    for arg in 
-0003be60: 6172 6773 3a0a 2020 2020 2020 2020 6966  args:.        if
-0003be70: 2069 7369 6e73 7461 6e63 6528 6172 672c   isinstance(arg,
-0003be80: 205f 4672 616d 6529 3a0a 2020 2020 2020   _Frame):.      
-0003be90: 2020 2020 2020 6172 6773 322e 6170 7065        args2.appe
-0003bea0: 6e64 2861 7267 290a 2020 2020 2020 2020  nd(arg).        
-0003beb0: 2020 2020 6465 7065 6e64 656e 6369 6573      dependencies
-0003bec0: 2e61 7070 656e 6428 6172 6729 0a20 2020  .append(arg).   
-0003bed0: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-0003bee0: 650a 2020 2020 2020 2020 6172 6720 3d20  e.        arg = 
-0003bef0: 6e6f 726d 616c 697a 655f 6172 6728 6172  normalize_arg(ar
-0003bf00: 6729 0a20 2020 2020 2020 2061 7267 322c  g).        arg2,
-0003bf10: 2063 6f6c 6c65 6374 696f 6e73 203d 2075   collections = u
-0003bf20: 6e70 6163 6b5f 636f 6c6c 6563 7469 6f6e  npack_collection
-0003bf30: 7328 6172 6729 0a20 2020 2020 2020 2069  s(arg).        i
-0003bf40: 6620 636f 6c6c 6563 7469 6f6e 733a 0a20  f collections:. 
-0003bf50: 2020 2020 2020 2020 2020 2061 7267 7332             args2
-0003bf60: 2e61 7070 656e 6428 6172 6732 290a 2020  .append(arg2).  
-0003bf70: 2020 2020 2020 2020 2020 6465 7065 6e64            depend
-0003bf80: 656e 6369 6573 2e65 7874 656e 6428 636f  encies.extend(co
-0003bf90: 6c6c 6563 7469 6f6e 7329 0a20 2020 2020  llections).     
-0003bfa0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0003bfb0: 2020 2020 2061 7267 7332 2e61 7070 656e       args2.appen
-0003bfc0: 6428 6172 6729 0a0a 2020 2020 6b77 6172  d(arg)..    kwar
-0003bfd0: 6773 3320 3d20 7b7d 0a20 2020 2073 696d  gs3 = {}.    sim
-0003bfe0: 706c 6520 3d20 5472 7565 0a20 2020 2066  ple = True.    f
-0003bff0: 6f72 206b 2c20 7620 696e 206b 7761 7267  or k, v in kwarg
-0003c000: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
-0003c010: 2020 2076 203d 206e 6f72 6d61 6c69 7a65     v = normalize
-0003c020: 5f61 7267 2876 290a 2020 2020 2020 2020  _arg(v).        
-0003c030: 762c 2063 6f6c 6c65 6374 696f 6e73 203d  v, collections =
-0003c040: 2075 6e70 6163 6b5f 636f 6c6c 6563 7469   unpack_collecti
-0003c050: 6f6e 7328 7629 0a20 2020 2020 2020 2064  ons(v).        d
-0003c060: 6570 656e 6465 6e63 6965 732e 6578 7465  ependencies.exte
-0003c070: 6e64 2863 6f6c 6c65 6374 696f 6e73 290a  nd(collections).
-0003c080: 2020 2020 2020 2020 6b77 6172 6773 335b          kwargs3[
-0003c090: 6b5d 203d 2076 0a20 2020 2020 2020 2069  k] = v.        i
-0003c0a0: 6620 636f 6c6c 6563 7469 6f6e 733a 0a20  f collections:. 
-0003c0b0: 2020 2020 2020 2020 2020 2073 696d 706c             simpl
-0003c0c0: 6520 3d20 4661 6c73 650a 0a20 2020 2064  e = False..    d
-0003c0d0: 6976 6973 696f 6e73 203d 205f 6765 745f  ivisions = _get_
-0003c0e0: 6469 7669 7369 6f6e 735f 6d61 705f 7061  divisions_map_pa
-0003c0f0: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-0003c100: 2020 616c 6967 6e5f 6461 7461 6672 616d    align_datafram
-0003c110: 6573 2c20 7472 616e 7366 6f72 6d5f 6469  es, transform_di
-0003c120: 7669 7369 6f6e 732c 2064 6673 2c20 6675  visions, dfs, fu
-0003c130: 6e63 2c20 6172 6773 2c20 6b77 6172 6773  nc, args, kwargs
-0003c140: 0a20 2020 2029 0a0a 2020 2020 6966 2068  .    )..    if h
-0003c150: 6173 5f6b 6579 776f 7264 2866 756e 632c  as_keyword(func,
-0003c160: 2022 7061 7274 6974 696f 6e5f 696e 666f   "partition_info
-0003c170: 2229 3a0a 2020 2020 2020 2020 7061 7274  "):.        part
-0003c180: 6974 696f 6e5f 696e 666f 203d 207b 0a20  ition_info = {. 
-0003c190: 2020 2020 2020 2020 2020 2028 692c 293a             (i,):
-0003c1a0: 207b 226e 756d 6265 7222 3a20 692c 2022   {"number": i, "
-0003c1b0: 6469 7669 7369 6f6e 223a 2064 6976 6973  division": divis
-0003c1c0: 696f 6e7d 0a20 2020 2020 2020 2020 2020  ion}.           
-0003c1d0: 2066 6f72 2069 2c20 6469 7669 7369 6f6e   for i, division
-0003c1e0: 2069 6e20 656e 756d 6572 6174 6528 6469   in enumerate(di
-0003c1f0: 7669 7369 6f6e 735b 3a2d 315d 290a 2020  visions[:-1]).  
-0003c200: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
-0003c210: 2061 7267 7332 2e69 6e73 6572 7428 302c   args2.insert(0,
-0003c220: 2042 6c6f 636b 7769 7365 4465 7044 6963   BlockwiseDepDic
-0003c230: 7428 7061 7274 6974 696f 6e5f 696e 666f  t(partition_info
-0003c240: 2929 0a20 2020 2020 2020 206f 7269 675f  )).        orig_
-0003c250: 6675 6e63 203d 2066 756e 630a 0a20 2020  func = func..   
-0003c260: 2020 2020 2064 6566 2066 756e 6328 7061       def func(pa
-0003c270: 7274 6974 696f 6e5f 696e 666f 2c20 2a61  rtition_info, *a
-0003c280: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-0003c290: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0003c2a0: 726e 206f 7269 675f 6675 6e63 282a 6172  rn orig_func(*ar
-0003c2b0: 6773 2c20 2a2a 6b77 6172 6773 2c20 7061  gs, **kwargs, pa
-0003c2c0: 7274 6974 696f 6e5f 696e 666f 3d70 6172  rtition_info=par
-0003c2d0: 7469 7469 6f6e 5f69 6e66 6f29 0a0a 2020  tition_info)..  
-0003c2e0: 2020 6966 2065 6e66 6f72 6365 5f6d 6574    if enforce_met
-0003c2f0: 6164 6174 613a 0a20 2020 2020 2020 2064  adata:.        d
-0003c300: 736b 203d 2070 6172 7469 7469 6f6e 7769  sk = partitionwi
-0003c310: 7365 5f67 7261 7068 280a 2020 2020 2020  se_graph(.      
-0003c320: 2020 2020 2020 6170 706c 795f 616e 645f        apply_and_
-0003c330: 656e 666f 7263 652c 0a20 2020 2020 2020  enforce,.       
-0003c340: 2020 2020 206e 616d 652c 0a20 2020 2020       name,.     
-0003c350: 2020 2020 2020 202a 6172 6773 322c 0a20         *args2,. 
-0003c360: 2020 2020 2020 2020 2020 2064 6570 656e             depen
-0003c370: 6465 6e63 6965 733d 6465 7065 6e64 656e  dencies=dependen
-0003c380: 6369 6573 2c0a 2020 2020 2020 2020 2020  cies,.          
-0003c390: 2020 5f66 756e 633d 6675 6e63 2c0a 2020    _func=func,.  
-0003c3a0: 2020 2020 2020 2020 2020 5f6d 6574 613d            _meta=
-0003c3b0: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-0003c3c0: 2020 2a2a 6b77 6172 6773 332c 0a20 2020    **kwargs3,.   
-0003c3d0: 2020 2020 2029 0a20 2020 2065 6c73 653a       ).    else:
-0003c3e0: 0a20 2020 2020 2020 206b 7761 7267 7334  .        kwargs4
-0003c3f0: 203d 206b 7761 7267 7320 6966 2073 696d   = kwargs if sim
-0003c400: 706c 6520 656c 7365 206b 7761 7267 7333  ple else kwargs3
-0003c410: 0a20 2020 2020 2020 2064 736b 203d 2070  .        dsk = p
-0003c420: 6172 7469 7469 6f6e 7769 7365 5f67 7261  artitionwise_gra
-0003c430: 7068 280a 2020 2020 2020 2020 2020 2020  ph(.            
-0003c440: 6675 6e63 2c20 6e61 6d65 2c20 2a61 7267  func, name, *arg
-0003c450: 7332 2c20 2a2a 6b77 6172 6773 342c 2064  s2, **kwargs4, d
-0003c460: 6570 656e 6465 6e63 6965 733d 6465 7065  ependencies=depe
-0003c470: 6e64 656e 6369 6573 0a20 2020 2020 2020  ndencies.       
-0003c480: 2029 0a0a 2020 2020 6772 6170 6820 3d20   )..    graph = 
-0003c490: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-0003c4a0: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-0003c4b0: 6e61 6d65 2c20 6473 6b2c 2064 6570 656e  name, dsk, depen
-0003c4c0: 6465 6e63 6965 733d 6465 7065 6e64 656e  dencies=dependen
-0003c4d0: 6369 6573 290a 2020 2020 7265 7475 726e  cies).    return
-0003c4e0: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
-0003c4f0: 7261 7068 2c20 6e61 6d65 2c20 6d65 7461  raph, name, meta
-0003c500: 2c20 6469 7669 7369 6f6e 7329 0a0a 0a64  , divisions)...d
-0003c510: 6566 205f 6765 745f 6469 7669 7369 6f6e  ef _get_division
-0003c520: 735f 6d61 705f 7061 7274 6974 696f 6e73  s_map_partitions
-0003c530: 280a 2020 2020 616c 6967 6e5f 6461 7461  (.    align_data
-0003c540: 6672 616d 6573 2c20 7472 616e 7366 6f72  frames, transfor
-0003c550: 6d5f 6469 7669 7369 6f6e 732c 2064 6673  m_divisions, dfs
-0003c560: 2c20 6675 6e63 2c20 6172 6773 2c20 6b77  , func, args, kw
-0003c570: 6172 6773 0a29 3a0a 2020 2020 2222 220a  args.):.    """.
-0003c580: 2020 2020 4865 6c70 6572 2074 6f20 6765      Helper to ge
-0003c590: 7420 6469 7669 7369 6f6e 7320 666f 7220  t divisions for 
-0003c5a0: 6d61 705f 7061 7274 6974 696f 6e73 2061  map_partitions a
-0003c5b0: 6e64 206d 6170 5f6f 7665 726c 6170 206f  nd map_overlap o
-0003c5c0: 7574 7075 742e 0a20 2020 2022 2222 0a20  utput..    """. 
-0003c5d0: 2020 2069 6620 616c 6967 6e5f 6461 7461     if align_data
-0003c5e0: 6672 616d 6573 3a0a 2020 2020 2020 2020  frames:.        
-0003c5f0: 6469 7669 7369 6f6e 7320 3d20 6466 735b  divisions = dfs[
-0003c600: 305d 2e64 6976 6973 696f 6e73 0a20 2020  0].divisions.   
-0003c610: 2065 6c73 653a 0a20 2020 2020 2020 2023   else:.        #
-0003c620: 2055 6e61 6c69 676e 6564 2c20 6466 7320   Unaligned, dfs 
-0003c630: 6973 2061 206d 6978 206f 6620 3120 7061  is a mix of 1 pa
-0003c640: 7274 6974 696f 6e20 616e 6420 312b 2070  rtition and 1+ p
-0003c650: 6172 7469 7469 6f6e 2064 6174 6166 7261  artition datafra
-0003c660: 6d65 732c 0a20 2020 2020 2020 2023 2075  mes,.        # u
-0003c670: 7365 206c 6f6e 6765 7374 2064 6976 6973  se longest divis
-0003c680: 696f 6e73 2066 6f75 6e64 0a20 2020 2020  ions found.     
-0003c690: 2020 2064 6976 6973 696f 6e73 203d 206d     divisions = m
-0003c6a0: 6178 2828 642e 6469 7669 7369 6f6e 7320  ax((d.divisions 
-0003c6b0: 666f 7220 6420 696e 2064 6673 292c 206b  for d in dfs), k
-0003c6c0: 6579 3d6c 656e 290a 2020 2020 6966 2074  ey=len).    if t
-0003c6d0: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
-0003c6e0: 6e73 2061 6e64 2069 7369 6e73 7461 6e63  ns and isinstanc
-0003c6f0: 6528 6466 735b 305d 2c20 496e 6465 7829  e(dfs[0], Index)
-0003c700: 2061 6e64 206c 656e 2864 6673 2920 3d3d   and len(dfs) ==
-0003c710: 2031 3a0a 2020 2020 2020 2020 7472 793a   1:.        try:
-0003c720: 0a20 2020 2020 2020 2020 2020 2064 6976  .            div
-0003c730: 6973 696f 6e73 203d 2066 756e 6328 0a20  isions = func(. 
-0003c740: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-0003c750: 5b70 642e 496e 6465 7828 612e 6469 7669  [pd.Index(a.divi
-0003c760: 7369 6f6e 7329 2069 6620 6120 6973 2064  sions) if a is d
-0003c770: 6673 5b30 5d20 656c 7365 2061 2066 6f72  fs[0] else a for
-0003c780: 2061 2069 6e20 6172 6773 5d2c 202a 2a6b   a in args], **k
-0003c790: 7761 7267 730a 2020 2020 2020 2020 2020  wargs.          
-0003c7a0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0003c7b0: 6966 2069 7369 6e73 7461 6e63 6528 6469  if isinstance(di
-0003c7c0: 7669 7369 6f6e 732c 2070 642e 496e 6465  visions, pd.Inde
-0003c7d0: 7829 3a0a 2020 2020 2020 2020 2020 2020  x):.            
-0003c7e0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
-0003c7f0: 6d65 7468 6f64 732e 746f 6c69 7374 2864  methods.tolist(d
-0003c800: 6976 6973 696f 6e73 290a 2020 2020 2020  ivisions).      
-0003c810: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-0003c820: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-0003c830: 7061 7373 0a20 2020 2020 2020 2065 6c73  pass.        els
-0003c840: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
-0003c850: 6620 6e6f 7420 7661 6c69 645f 6469 7669  f not valid_divi
-0003c860: 7369 6f6e 7328 6469 7669 7369 6f6e 7329  sions(divisions)
-0003c870: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003c880: 2020 6469 7669 7369 6f6e 7320 3d20 5b4e    divisions = [N
-0003c890: 6f6e 655d 202a 2028 6466 735b 305d 2e6e  one] * (dfs[0].n
-0003c8a0: 7061 7274 6974 696f 6e73 202b 2031 290a  partitions + 1).
-0003c8b0: 2020 2020 7265 7475 726e 2064 6976 6973      return divis
-0003c8c0: 696f 6e73 0a0a 0a64 6566 205f 6765 745f  ions...def _get_
-0003c8d0: 6d65 7461 5f6d 6170 5f70 6172 7469 7469  meta_map_partiti
-0003c8e0: 6f6e 7328 6172 6773 2c20 6466 732c 2066  ons(args, dfs, f
-0003c8f0: 756e 632c 206b 7761 7267 732c 206d 6574  unc, kwargs, met
-0003c900: 612c 2070 6172 656e 745f 6d65 7461 293a  a, parent_meta):
-0003c910: 0a20 2020 2022 2222 0a20 2020 2048 656c  .    """.    Hel
-0003c920: 7065 7220 746f 2067 656e 6572 6174 6520  per to generate 
-0003c930: 6d65 7461 6461 7461 2066 6f72 206d 6170  metadata for map
-0003c940: 5f70 6172 7469 7469 6f6e 7320 616e 6420  _partitions and 
-0003c950: 6d61 705f 6f76 6572 6c61 7020 6f75 7470  map_overlap outp
-0003c960: 7574 2e0a 2020 2020 2222 220a 2020 2020  ut..    """.    
-0003c970: 6d65 7461 5f69 6e64 6578 203d 2067 6574  meta_index = get
-0003c980: 6174 7472 286d 616b 655f 6d65 7461 2864  attr(make_meta(d
-0003c990: 6673 5b30 5d29 2c20 2269 6e64 6578 222c  fs[0]), "index",
-0003c9a0: 204e 6f6e 6529 2069 6620 6466 7320 656c   None) if dfs el
-0003c9b0: 7365 204e 6f6e 650a 2020 2020 6966 2070  se None.    if p
-0003c9c0: 6172 656e 745f 6d65 7461 2069 7320 4e6f  arent_meta is No
-0003c9d0: 6e65 2061 6e64 2064 6673 3a0a 2020 2020  ne and dfs:.    
-0003c9e0: 2020 2020 7061 7265 6e74 5f6d 6574 6120      parent_meta 
-0003c9f0: 3d20 6466 735b 305d 2e5f 6d65 7461 0a20  = dfs[0]._meta. 
-0003ca00: 2020 2069 6620 6d65 7461 2069 7320 6e6f     if meta is no
-0003ca10: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
-0003ca20: 2020 2320 5573 6520 6e6f 6e2d 6e6f 726d    # Use non-norm
-0003ca30: 616c 697a 6564 206b 7761 7267 7320 6865  alized kwargs he
-0003ca40: 7265 2c20 6173 2077 6520 7761 6e74 2074  re, as we want t
-0003ca50: 6865 2072 6561 6c20 7661 6c75 6573 2028  he real values (
-0003ca60: 6e6f 740a 2020 2020 2020 2020 2320 6465  not.        # de
-0003ca70: 6c61 7965 6420 7661 6c75 6573 290a 2020  layed values).  
-0003ca80: 2020 2020 2020 6d65 7461 203d 205f 656d        meta = _em
-0003ca90: 756c 6174 6528 6675 6e63 2c20 2a61 7267  ulate(func, *arg
-0003caa0: 732c 2075 6466 3d54 7275 652c 202a 2a6b  s, udf=True, **k
-0003cab0: 7761 7267 7329 0a20 2020 2020 2020 206d  wargs).        m
-0003cac0: 6574 615f 6973 5f65 6d75 6c61 7465 6420  eta_is_emulated 
-0003cad0: 3d20 5472 7565 0a20 2020 2065 6c73 653a  = True.    else:
-0003cae0: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
-0003caf0: 6d61 6b65 5f6d 6574 6128 6d65 7461 2c20  make_meta(meta, 
-0003cb00: 696e 6465 783d 6d65 7461 5f69 6e64 6578  index=meta_index
-0003cb10: 2c20 7061 7265 6e74 5f6d 6574 613d 7061  , parent_meta=pa
-0003cb20: 7265 6e74 5f6d 6574 6129 0a20 2020 2020  rent_meta).     
-0003cb30: 2020 206d 6574 615f 6973 5f65 6d75 6c61     meta_is_emula
-0003cb40: 7465 6420 3d20 4661 6c73 650a 0a20 2020  ted = False..   
-0003cb50: 2069 6620 6e6f 7420 2868 6173 5f70 6172   if not (has_par
-0003cb60: 616c 6c65 6c5f 7479 7065 286d 6574 6129  allel_type(meta)
-0003cb70: 206f 7220 6973 5f61 7272 6179 6c69 6b65   or is_arraylike
-0003cb80: 286d 6574 6129 2061 6e64 206d 6574 612e  (meta) and meta.
-0003cb90: 7368 6170 6529 2061 6e64 206e 6f74 2061  shape) and not a
-0003cba0: 6c6c 280a 2020 2020 2020 2020 6973 696e  ll(.        isin
-0003cbb0: 7374 616e 6365 2861 7267 2c20 5363 616c  stance(arg, Scal
-0003cbc0: 6172 2920 666f 7220 6172 6720 696e 2061  ar) for arg in a
-0003cbd0: 7267 730a 2020 2020 293a 0a20 2020 2020  rgs.    ):.     
-0003cbe0: 2020 2069 6620 6e6f 7420 6d65 7461 5f69     if not meta_i
-0003cbf0: 735f 656d 756c 6174 6564 3a0a 2020 2020  s_emulated:.    
-0003cc00: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-0003cc10: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-0003cc20: 2020 2020 2020 2022 4d65 7461 2069 7320         "Meta is 
-0003cc30: 6e6f 7420 7661 6c69 642c 2060 6d61 705f  not valid, `map_
-0003cc40: 7061 7274 6974 696f 6e73 6020 616e 6420  partitions` and 
-0003cc50: 606d 6170 5f6f 7665 726c 6170 6020 6578  `map_overlap` ex
-0003cc60: 7065 6374 7320 6f75 7470 7574 2074 6f20  pects output to 
-0003cc70: 6265 2061 2070 616e 6461 7320 6f62 6a65  be a pandas obje
-0003cc80: 6374 2e20 220a 2020 2020 2020 2020 2020  ct. ".          
-0003cc90: 2020 2020 2020 2254 7279 2070 6173 7369        "Try passi
-0003cca0: 6e67 2061 2070 616e 6461 7320 6f62 6a65  ng a pandas obje
-0003ccb0: 6374 2061 7320 6d65 7461 206f 7220 6120  ct as meta or a 
-0003ccc0: 6469 6374 206f 7220 7475 706c 6520 7265  dict or tuple re
-0003ccd0: 7072 6573 656e 7469 6e67 2074 6865 2022  presenting the "
-0003cce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ccf0: 2022 286e 616d 652c 2064 7479 7065 2920   "(name, dtype) 
-0003cd00: 6f66 2074 6865 2063 6f6c 756d 6e73 2e20  of the columns. 
-0003cd10: 496e 2074 6865 2066 7574 7572 6520 7468  In the future th
-0003cd20: 6520 6d65 7461 2079 6f75 2070 6173 7365  e meta you passe
-0003cd30: 6420 7769 6c6c 206e 6f74 2077 6f72 6b2e  d will not work.
-0003cd40: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0003cd50: 2020 2046 7574 7572 6557 6172 6e69 6e67     FutureWarning
-0003cd60: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0003cd70: 2020 2020 2020 2020 2320 4966 2060 6d65          # If `me
-0003cd80: 7461 6020 6973 206e 6f74 2061 2070 616e  ta` is not a pan
-0003cd90: 6461 7320 6f62 6a65 6374 2c20 7468 6520  das object, the 
-0003cda0: 636f 6e63 6174 656e 6174 6564 2072 6573  concatenated res
-0003cdb0: 756c 7473 2077 696c 6c20 6265 2061 0a20  ults will be a. 
-0003cdc0: 2020 2020 2020 2023 2064 6966 6665 7265         # differe
-0003cdd0: 6e74 2074 7970 650a 2020 2020 2020 2020  nt type.        
-0003cde0: 6d65 7461 203d 206d 616b 655f 6d65 7461  meta = make_meta
-0003cdf0: 285f 636f 6e63 6174 285b 6d65 7461 5d29  (_concat([meta])
-0003ce00: 2c20 696e 6465 783d 6d65 7461 5f69 6e64  , index=meta_ind
-0003ce10: 6578 290a 0a20 2020 2023 2045 6e73 7572  ex)..    # Ensur
-0003ce20: 6520 6d65 7461 2069 7320 656d 7074 7920  e meta is empty 
-0003ce30: 7365 7269 6573 0a20 2020 206d 6574 6120  series.    meta 
-0003ce40: 3d20 6d61 6b65 5f6d 6574 6128 6d65 7461  = make_meta(meta
-0003ce50: 2c20 7061 7265 6e74 5f6d 6574 613d 7061  , parent_meta=pa
-0003ce60: 7265 6e74 5f6d 6574 6129 0a0a 2020 2020  rent_meta)..    
-0003ce70: 7265 7475 726e 206d 6574 610a 0a0a 6465  return meta...de
-0003ce80: 6620 6170 706c 795f 616e 645f 656e 666f  f apply_and_enfo
-0003ce90: 7263 6528 2a61 7267 732c 202a 2a6b 7761  rce(*args, **kwa
-0003cea0: 7267 7329 3a0a 2020 2020 2222 2241 7070  rgs):.    """App
-0003ceb0: 6c79 2061 2066 756e 6374 696f 6e2c 2061  ly a function, a
-0003cec0: 6e64 2065 6e66 6f72 6365 2074 6865 206f  nd enforce the o
-0003ced0: 7574 7075 7420 746f 206d 6174 6368 206d  utput to match m
-0003cee0: 6574 610a 0a20 2020 2045 6e73 7572 6573  eta..    Ensures
-0003cef0: 2074 6865 206f 7574 7075 7420 6861 7320   the output has 
-0003cf00: 7468 6520 7361 6d65 2063 6f6c 756d 6e73  the same columns
-0003cf10: 2c20 6576 656e 2069 6620 656d 7074 792e  , even if empty.
-0003cf20: 2222 220a 2020 2020 6675 6e63 203d 206b  """.    func = k
-0003cf30: 7761 7267 732e 706f 7028 225f 6675 6e63  wargs.pop("_func
-0003cf40: 2229 0a20 2020 206d 6574 6120 3d20 6b77  ").    meta = kw
-0003cf50: 6172 6773 2e70 6f70 2822 5f6d 6574 6122  args.pop("_meta"
-0003cf60: 290a 2020 2020 6466 203d 2066 756e 6328  ).    df = func(
-0003cf70: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-0003cf80: 0a20 2020 2069 6620 6973 5f64 6174 6166  .    if is_dataf
-0003cf90: 7261 6d65 5f6c 696b 6528 6466 2920 6f72  rame_like(df) or
-0003cfa0: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
-0003cfb0: 6466 2920 6f72 2069 735f 696e 6465 785f  df) or is_index_
-0003cfc0: 6c69 6b65 2864 6629 3a0a 2020 2020 2020  like(df):.      
-0003cfd0: 2020 6966 206e 6f74 206c 656e 2864 6629    if not len(df)
-0003cfe0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0003cff0: 7475 726e 206d 6574 610a 2020 2020 2020  turn meta.      
-0003d000: 2020 6966 2069 735f 6461 7461 6672 616d    if is_datafram
-0003d010: 655f 6c69 6b65 2864 6629 3a0a 2020 2020  e_like(df):.    
-0003d020: 2020 2020 2020 2020 6368 6563 6b5f 6d61          check_ma
-0003d030: 7463 6869 6e67 5f63 6f6c 756d 6e73 286d  tching_columns(m
-0003d040: 6574 612c 2064 6629 0a20 2020 2020 2020  eta, df).       
-0003d050: 2020 2020 2063 203d 206d 6574 612e 636f       c = meta.co
-0003d060: 6c75 6d6e 730a 2020 2020 2020 2020 656c  lumns.        el
-0003d070: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0003d080: 6320 3d20 6d65 7461 2e6e 616d 650a 2020  c = meta.name.  
-0003d090: 2020 2020 2020 7265 7475 726e 205f 7265        return _re
-0003d0a0: 6e61 6d65 2863 2c20 6466 290a 2020 2020  name(c, df).    
-0003d0b0: 7265 7475 726e 2064 660a 0a0a 6465 6620  return df...def 
-0003d0c0: 5f72 656e 616d 6528 636f 6c75 6d6e 732c  _rename(columns,
-0003d0d0: 2064 6629 3a0a 2020 2020 2222 220a 2020   df):.    """.  
-0003d0e0: 2020 5265 6e61 6d65 2063 6f6c 756d 6e73    Rename columns
-0003d0f0: 206f 6620 7064 2e44 6174 6146 7261 6d65   of pd.DataFrame
-0003d100: 206f 7220 6e61 6d65 206f 6620 7064 2e53   or name of pd.S
-0003d110: 6572 6965 732e 0a20 2020 204e 6f74 2066  eries..    Not f
-0003d120: 6f72 2064 642e 4461 7461 4672 616d 6520  or dd.DataFrame 
-0003d130: 6f72 2064 642e 5365 7269 6573 2e0a 0a20  or dd.Series... 
-0003d140: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0003d150: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0003d160: 2063 6f6c 756d 6e73 203a 2074 7570 6c65   columns : tuple
-0003d170: 2c20 7374 7269 6e67 2c20 7064 2e44 6174  , string, pd.Dat
-0003d180: 6146 7261 6d65 206f 7220 7064 2e53 6572  aFrame or pd.Ser
-0003d190: 6965 730a 2020 2020 2020 2020 436f 6c75  ies.        Colu
-0003d1a0: 6d6e 206e 616d 6573 2c20 5365 7269 6573  mn names, Series
-0003d1b0: 206e 616d 6520 6f72 2070 616e 6461 7320   name or pandas 
-0003d1c0: 696e 7374 616e 6365 2077 6869 6368 2068  instance which h
-0003d1d0: 6173 2074 6865 0a20 2020 2020 2020 2074  as the.        t
-0003d1e0: 6172 6765 7420 636f 6c75 6d6e 206e 616d  arget column nam
-0003d1f0: 6573 202f 206e 616d 652e 0a20 2020 2064  es / name..    d
-0003d200: 6620 3a20 7064 2e44 6174 6146 7261 6d65  f : pd.DataFrame
-0003d210: 206f 7220 7064 2e53 6572 6965 730a 2020   or pd.Series.  
-0003d220: 2020 2020 2020 7461 7267 6574 2044 6174        target Dat
-0003d230: 6146 7261 6d65 202f 2053 6572 6965 7320  aFrame / Series 
-0003d240: 746f 2062 6520 7265 6e61 6d65 640a 2020  to be renamed.  
-0003d250: 2020 2222 220a 2020 2020 6173 7365 7274    """.    assert
-0003d260: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0003d270: 6466 2c20 5f46 7261 6d65 290a 0a20 2020  df, _Frame)..   
-0003d280: 2069 6620 636f 6c75 6d6e 7320 6973 206e   if columns is n
-0003d290: 6f5f 6465 6661 756c 743a 0a20 2020 2020  o_default:.     
-0003d2a0: 2020 2072 6574 7572 6e20 6466 0a0a 2020     return df..  
-0003d2b0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0003d2c0: 636f 6c75 6d6e 732c 2049 7465 7261 746f  columns, Iterato
-0003d2d0: 7229 3a0a 2020 2020 2020 2020 636f 6c75  r):.        colu
-0003d2e0: 6d6e 7320 3d20 6c69 7374 2863 6f6c 756d  mns = list(colum
-0003d2f0: 6e73 290a 0a20 2020 2069 6620 6973 5f64  ns)..    if is_d
-0003d300: 6174 6166 7261 6d65 5f6c 696b 6528 6466  ataframe_like(df
-0003d310: 293a 0a20 2020 2020 2020 2069 6620 6973  ):.        if is
-0003d320: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
-0003d330: 636f 6c75 6d6e 7329 3a0a 2020 2020 2020  columns):.      
-0003d340: 2020 2020 2020 636f 6c75 6d6e 7320 3d20        columns = 
-0003d350: 636f 6c75 6d6e 732e 636f 6c75 6d6e 730a  columns.columns.
-0003d360: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-0003d370: 7369 6e73 7461 6e63 6528 636f 6c75 6d6e  sinstance(column
-0003d380: 732c 2070 642e 496e 6465 7829 3a0a 2020  s, pd.Index):.  
-0003d390: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-0003d3a0: 7320 3d20 7064 2e49 6e64 6578 2863 6f6c  s = pd.Index(col
-0003d3b0: 756d 6e73 290a 2020 2020 2020 2020 6966  umns).        if
-0003d3c0: 2028 0a20 2020 2020 2020 2020 2020 206c   (.            l
-0003d3d0: 656e 2863 6f6c 756d 6e73 2920 3d3d 206c  en(columns) == l
-0003d3e0: 656e 2864 662e 636f 6c75 6d6e 7329 0a20  en(df.columns). 
-0003d3f0: 2020 2020 2020 2020 2020 2061 6e64 2074             and t
-0003d400: 7970 6528 636f 6c75 6d6e 7329 2069 7320  ype(columns) is 
-0003d410: 7479 7065 2864 662e 636f 6c75 6d6e 7329  type(df.columns)
-0003d420: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-0003d430: 2063 6f6c 756d 6e73 2e64 7479 7065 203d   columns.dtype =
-0003d440: 3d20 6466 2e63 6f6c 756d 6e73 2e64 7479  = df.columns.dty
-0003d450: 7065 0a20 2020 2020 2020 2020 2020 2061  pe.            a
-0003d460: 6e64 2063 6f6c 756d 6e73 2e65 7175 616c  nd columns.equal
-0003d470: 7328 6466 2e63 6f6c 756d 6e73 290a 2020  s(df.columns).  
-0003d480: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-0003d490: 2020 2020 2023 2069 6620 7461 7267 6574       # if target
-0003d4a0: 2069 7320 6964 656e 7469 6361 6c2c 2072   is identical, r
-0003d4b0: 656e 616d 6520 6973 206e 6f74 206e 6563  ename is not nec
-0003d4c0: 6573 7361 7279 0a20 2020 2020 2020 2020  essary.         
-0003d4d0: 2020 2072 6574 7572 6e20 6466 0a20 2020     return df.   
-0003d4e0: 2020 2020 2023 2064 6565 703d 4661 6c73       # deep=Fals
-0003d4f0: 6520 646f 6573 6e27 7420 646f 6573 6e27  e doesn't doesn'
-0003d500: 7420 636f 7079 2061 6e79 2064 6174 612f  t copy any data/
-0003d510: 696e 6469 6365 732c 2073 6f20 7468 6973  indices, so this
-0003d520: 2069 7320 6368 6561 700a 2020 2020 2020   is cheap.      
-0003d530: 2020 6466 203d 2064 662e 636f 7079 2864    df = df.copy(d
-0003d540: 6565 703d 4661 6c73 6529 0a20 2020 2020  eep=False).     
-0003d550: 2020 2064 662e 636f 6c75 6d6e 7320 3d20     df.columns = 
-0003d560: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
-0003d570: 7265 7475 726e 2064 660a 2020 2020 656c  return df.    el
-0003d580: 6966 2069 735f 7365 7269 6573 5f6c 696b  if is_series_lik
-0003d590: 6528 6466 2920 6f72 2069 735f 696e 6465  e(df) or is_inde
-0003d5a0: 785f 6c69 6b65 2864 6629 3a0a 2020 2020  x_like(df):.    
-0003d5b0: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
-0003d5c0: 5f6c 696b 6528 636f 6c75 6d6e 7329 206f  _like(columns) o
-0003d5d0: 7220 6973 5f69 6e64 6578 5f6c 696b 6528  r is_index_like(
-0003d5e0: 636f 6c75 6d6e 7329 3a0a 2020 2020 2020  columns):.      
-0003d5f0: 2020 2020 2020 636f 6c75 6d6e 7320 3d20        columns = 
-0003d600: 636f 6c75 6d6e 732e 6e61 6d65 0a20 2020  columns.name.   
-0003d610: 2020 2020 2069 6620 6466 2e6e 616d 6520       if df.name 
-0003d620: 3d3d 2063 6f6c 756d 6e73 3a0a 2020 2020  == columns:.    
-0003d630: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-0003d640: 660a 2020 2020 2020 2020 7265 7475 726e  f.        return
-0003d650: 2064 662e 7265 6e61 6d65 2863 6f6c 756d   df.rename(colum
-0003d660: 6e73 290a 2020 2020 2320 6d61 705f 7061  ns).    # map_pa
-0003d670: 7274 6974 696f 6e20 6d61 7920 7061 7373  rtition may pass
-0003d680: 206f 7468 6572 2074 7970 6573 0a20 2020   other types.   
-0003d690: 2072 6574 7572 6e20 6466 0a0a 0a64 6566   return df...def
-0003d6a0: 205f 7265 6e61 6d65 5f64 6173 6b28 6466   _rename_dask(df
-0003d6b0: 2c20 6e61 6d65 7329 3a0a 2020 2020 2222  , names):.    ""
-0003d6c0: 220a 2020 2020 4465 7374 7275 6374 6976  ".    Destructiv
-0003d6d0: 656c 7920 7265 6e61 6d65 2063 6f6c 756d  ely rename colum
-0003d6e0: 6e73 206f 6620 6464 2e44 6174 6146 7261  ns of dd.DataFra
-0003d6f0: 6d65 206f 7220 6e61 6d65 206f 6620 6464  me or name of dd
-0003d700: 2e53 6572 6965 732e 0a20 2020 204e 6f74  .Series..    Not
-0003d710: 2066 6f72 2070 642e 4461 7461 4672 616d   for pd.DataFram
-0003d720: 6520 6f72 2070 642e 5365 7269 6573 2e0a  e or pd.Series..
-0003d730: 0a20 2020 2049 6e74 6572 6e61 6c6c 7920  .    Internally 
-0003d740: 7573 6564 2074 6f20 6f76 6572 7772 6974  used to overwrit
-0003d750: 6520 6464 2e44 6174 6146 7261 6d65 2e63  e dd.DataFrame.c
-0003d760: 6f6c 756d 6e73 2061 6e64 2064 642e 5365  olumns and dd.Se
-0003d770: 7269 6573 2e6e 616d 650a 2020 2020 5765  ries.name.    We
-0003d780: 2063 616e 2774 2075 7365 206d 6170 5f70   can't use map_p
-0003d790: 6172 7469 7469 6f6e 2062 6563 6175 7365  artition because
-0003d7a0: 2069 7420 6170 706c 6965 7320 6675 6e63   it applies func
-0003d7b0: 7469 6f6e 2074 6865 6e20 7265 6e61 6d65  tion then rename
-0003d7c0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-0003d7d0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-0003d7e0: 2020 2020 6466 203a 2064 642e 4461 7461      df : dd.Data
-0003d7f0: 4672 616d 6520 6f72 2064 642e 5365 7269  Frame or dd.Seri
-0003d800: 6573 0a20 2020 2020 2020 2074 6172 6765  es.        targe
-0003d810: 7420 4461 7461 4672 616d 6520 2f20 5365  t DataFrame / Se
-0003d820: 7269 6573 2074 6f20 6265 2072 656e 616d  ries to be renam
-0003d830: 6564 0a20 2020 206e 616d 6573 203a 2074  ed.    names : t
-0003d840: 7570 6c65 2c20 7374 7269 6e67 0a20 2020  uple, string.   
-0003d850: 2020 2020 2043 6f6c 756d 6e20 6e61 6d65       Column name
-0003d860: 732f 5365 7269 6573 206e 616d 650a 2020  s/Series name.  
-0003d870: 2020 2222 220a 0a20 2020 2061 7373 6572    """..    asser
-0003d880: 7420 6973 696e 7374 616e 6365 2864 662c  t isinstance(df,
-0003d890: 205f 4672 616d 6529 0a20 2020 206d 6574   _Frame).    met
-0003d8a0: 6164 6174 6120 3d20 5f72 656e 616d 6528  adata = _rename(
-0003d8b0: 6e61 6d65 732c 2064 662e 5f6d 6574 6129  names, df._meta)
-0003d8c0: 0a20 2020 206e 616d 6520 3d20 6622 7265  .    name = f"re
-0003d8d0: 6e61 6d65 2d7b 746f 6b65 6e69 7a65 2864  name-{tokenize(d
-0003d8e0: 662c 206d 6574 6164 6174 6129 7d22 0a0a  f, metadata)}"..
-0003d8f0: 2020 2020 6473 6b20 3d20 7061 7274 6974      dsk = partit
-0003d900: 696f 6e77 6973 655f 6772 6170 6828 5f72  ionwise_graph(_r
-0003d910: 656e 616d 652c 206e 616d 652c 206d 6574  ename, name, met
-0003d920: 6164 6174 612c 2064 6629 0a20 2020 2067  adata, df).    g
-0003d930: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-0003d940: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-0003d950: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
-0003d960: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
-0003d970: 6466 5d29 0a20 2020 2072 6574 7572 6e20  df]).    return 
-0003d980: 6e65 775f 6464 5f6f 626a 6563 7428 6772  new_dd_object(gr
-0003d990: 6170 682c 206e 616d 652c 206d 6574 6164  aph, name, metad
-0003d9a0: 6174 612c 2064 662e 6469 7669 7369 6f6e  ata, df.division
-0003d9b0: 7329 0a0a 0a64 6566 2071 7561 6e74 696c  s)...def quantil
-0003d9c0: 6528 6466 2c20 712c 206d 6574 686f 643d  e(df, q, method=
-0003d9d0: 2264 6566 6175 6c74 2229 3a0a 2020 2020  "default"):.    
-0003d9e0: 2222 2241 7070 726f 7869 6d61 7465 2071  """Approximate q
-0003d9f0: 7561 6e74 696c 6573 206f 6620 5365 7269  uantiles of Seri
-0003da00: 6573 2e0a 0a20 2020 2050 6172 616d 6574  es...    Paramet
-0003da10: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-0003da20: 2d2d 0a20 2020 2071 203a 206c 6973 742f  --.    q : list/
-0003da30: 6172 7261 7920 6f66 2066 6c6f 6174 730a  array of floats.
-0003da40: 2020 2020 2020 2020 4974 6572 6162 6c65          Iterable
-0003da50: 206f 6620 6e75 6d62 6572 7320 7261 6e67   of numbers rang
-0003da60: 696e 6720 6672 6f6d 2030 2074 6f20 3130  ing from 0 to 10
-0003da70: 3020 666f 7220 7468 6520 6465 7369 7265  0 for the desire
-0003da80: 6420 7175 616e 7469 6c65 730a 2020 2020  d quantiles.    
-0003da90: 6d65 7468 6f64 203a 207b 2764 6566 6175  method : {'defau
-0003daa0: 6c74 272c 2027 7464 6967 6573 7427 2c20  lt', 'tdigest', 
-0003dab0: 2764 6173 6b27 7d2c 206f 7074 696f 6e61  'dask'}, optiona
-0003dac0: 6c0a 2020 2020 2020 2020 5768 6174 206d  l.        What m
-0003dad0: 6574 686f 6420 746f 2075 7365 2e20 4279  ethod to use. By
-0003dae0: 2064 6566 6175 6c74 2077 696c 6c20 7573   default will us
-0003daf0: 6520 6461 736b 2773 2069 6e74 6572 6e61  e dask's interna
-0003db00: 6c20 6375 7374 6f6d 0a20 2020 2020 2020  l custom.       
-0003db10: 2061 6c67 6f72 6974 686d 2028 6060 2764   algorithm (``'d
-0003db20: 6173 6b27 6060 292e 2020 4966 2073 6574  ask'``).  If set
-0003db30: 2074 6f20 6060 2774 6469 6765 7374 2760   to ``'tdigest'`
-0003db40: 6020 7769 6c6c 2075 7365 2074 6469 6765  ` will use tdige
-0003db50: 7374 2066 6f72 0a20 2020 2020 2020 2066  st for.        f
-0003db60: 6c6f 6174 7320 616e 6420 696e 7473 2061  loats and ints a
-0003db70: 6e64 2066 616c 6c62 6163 6b20 746f 2074  nd fallback to t
-0003db80: 6865 2060 6027 6461 736b 2760 6020 6f74  he ``'dask'`` ot
-0003db90: 6865 7277 6973 652e 0a20 2020 2022 2222  herwise..    """
-0003dba0: 0a20 2020 2023 2063 7572 7265 6e74 2069  .    # current i
-0003dbb0: 6d70 6c65 6d65 6e74 6174 696f 6e20 6e65  mplementation ne
-0003dbc0: 6564 7320 7120 746f 2062 6520 736f 7274  eds q to be sort
-0003dbd0: 6564 2073 6f0a 2020 2020 2320 736f 7274  ed so.    # sort
-0003dbe0: 2069 6620 6172 7261 792d 6c69 6b65 2c20   if array-like, 
-0003dbf0: 6f74 6865 7277 6973 6520 6c65 6176 6520  otherwise leave 
-0003dc00: 6974 2061 6c6f 6e65 0a20 2020 2071 5f6e  it alone.    q_n
-0003dc10: 6461 7272 6179 203d 206e 702e 6172 7261  darray = np.arra
-0003dc20: 7928 7129 0a20 2020 2069 6620 715f 6e64  y(q).    if q_nd
-0003dc30: 6172 7261 792e 6e64 696d 203e 2030 3a0a  array.ndim > 0:.
-0003dc40: 2020 2020 2020 2020 715f 6e64 6172 7261          q_ndarra
-0003dc50: 792e 736f 7274 286b 696e 643d 226d 6572  y.sort(kind="mer
-0003dc60: 6765 736f 7274 2229 0a20 2020 2020 2020  gesort").       
-0003dc70: 2071 203d 2071 5f6e 6461 7272 6179 0a0a   q = q_ndarray..
-0003dc80: 2020 2020 6173 7365 7274 2069 7369 6e73      assert isins
-0003dc90: 7461 6e63 6528 6466 2c20 5365 7269 6573  tance(df, Series
-0003dca0: 290a 0a20 2020 2061 6c6c 6f77 6564 5f6d  )..    allowed_m
-0003dcb0: 6574 686f 6473 203d 205b 2264 6566 6175  ethods = ["defau
-0003dcc0: 6c74 222c 2022 6461 736b 222c 2022 7464  lt", "dask", "td
-0003dcd0: 6967 6573 7422 5d0a 2020 2020 6966 206d  igest"].    if m
-0003dce0: 6574 686f 6420 6e6f 7420 696e 2061 6c6c  ethod not in all
-0003dcf0: 6f77 6564 5f6d 6574 686f 6473 3a0a 2020  owed_methods:.  
-0003dd00: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0003dd10: 6545 7272 6f72 2822 6d65 7468 6f64 2063  eError("method c
-0003dd20: 616e 206f 6e6c 7920 6265 2027 6465 6661  an only be 'defa
-0003dd30: 756c 7427 2c20 2764 6173 6b27 206f 7220  ult', 'dask' or 
-0003dd40: 2774 6469 6765 7374 2722 290a 0a20 2020  'tdigest'")..   
-0003dd50: 2069 6620 6d65 7468 6f64 203d 3d20 2264   if method == "d
-0003dd60: 6566 6175 6c74 223a 0a20 2020 2020 2020  efault":.       
-0003dd70: 2069 6e74 6572 6e61 6c5f 6d65 7468 6f64   internal_method
-0003dd80: 203d 2022 6461 736b 220a 2020 2020 656c   = "dask".    el
-0003dd90: 7365 3a0a 2020 2020 2020 2020 696e 7465  se:.        inte
-0003dda0: 726e 616c 5f6d 6574 686f 6420 3d20 6d65  rnal_method = me
-0003ddb0: 7468 6f64 0a0a 2020 2020 2320 6375 7272  thod..    # curr
-0003ddc0: 656e 746c 792c 206f 6e6c 7920 5365 7269  ently, only Seri
-0003ddd0: 6573 2068 6173 2071 7561 6e74 696c 6520  es has quantile 
-0003dde0: 6d65 7468 6f64 0a20 2020 2069 6620 6973  method.    if is
-0003ddf0: 696e 7374 616e 6365 2864 662c 2049 6e64  instance(df, Ind
-0003de00: 6578 293a 0a20 2020 2020 2020 2073 6572  ex):.        ser
-0003de10: 6965 735f 7479 7020 3d20 6466 2e5f 6d65  ies_typ = df._me
-0003de20: 7461 2e74 6f5f 7365 7269 6573 2829 2e5f  ta.to_series()._
-0003de30: 636f 6e73 7472 7563 746f 720a 2020 2020  constructor.    
-0003de40: 2020 2020 6d65 7461 203d 2064 662e 5f6d      meta = df._m
-0003de50: 6574 615f 6e6f 6e65 6d70 7479 2e74 6f5f  eta_nonempty.to_
-0003de60: 7365 7269 6573 2829 2e71 7561 6e74 696c  series().quantil
-0003de70: 6528 7129 0a20 2020 2065 6c73 653a 0a20  e(q).    else:. 
-0003de80: 2020 2020 2020 2069 6620 6973 5f73 6572         if is_ser
-0003de90: 6965 735f 6c69 6b65 2864 662e 5f6d 6574  ies_like(df._met
-0003dea0: 6129 3a0a 2020 2020 2020 2020 2020 2020  a):.            
-0003deb0: 7365 7269 6573 5f74 7970 203d 2064 662e  series_typ = df.
-0003dec0: 5f6d 6574 612e 5f63 6f6e 7374 7275 6374  _meta._construct
-0003ded0: 6f72 0a20 2020 2020 2020 2065 6c73 653a  or.        else:
-0003dee0: 0a20 2020 2020 2020 2020 2020 2073 6572  .            ser
-0003def0: 6965 735f 7479 7020 3d20 6466 2e5f 6d65  ies_typ = df._me
-0003df00: 7461 2e5f 636f 6e73 7472 7563 746f 725f  ta._constructor_
-0003df10: 736c 6963 6564 0a20 2020 2020 2020 206d  sliced.        m
-0003df20: 6574 6120 3d20 6466 2e5f 6d65 7461 5f6e  eta = df._meta_n
-0003df30: 6f6e 656d 7074 792e 7175 616e 7469 6c65  onempty.quantile
-0003df40: 2871 290a 0a20 2020 2069 6620 6973 5f73  (q)..    if is_s
-0003df50: 6572 6965 735f 6c69 6b65 286d 6574 6129  eries_like(meta)
-0003df60: 3a0a 2020 2020 2020 2020 2320 496e 6465  :.        # Inde
-0003df70: 782e 7175 616e 7469 6c65 286c 6973 742d  x.quantile(list-
-0003df80: 6c69 6b65 2920 6d75 7374 2062 6520 7064  like) must be pd
-0003df90: 2e53 6572 6965 732c 206e 6f74 2070 642e  .Series, not pd.
-0003dfa0: 496e 6465 780a 2020 2020 2020 2020 6466  Index.        df
-0003dfb0: 5f6e 616d 6520 3d20 6466 2e6e 616d 650a  _name = df.name.
-0003dfc0: 2020 2020 2020 2020 6669 6e61 6c69 7a65          finalize
-0003dfd0: 5f74 736b 203d 206c 616d 6264 6120 7473  _tsk = lambda ts
-0003dfe0: 6b3a 2028 7365 7269 6573 5f74 7970 2c20  k: (series_typ, 
-0003dff0: 7473 6b2c 2071 2c20 4e6f 6e65 2c20 6466  tsk, q, None, df
-0003e000: 5f6e 616d 6529 0a20 2020 2020 2020 2072  _name).        r
-0003e010: 6574 7572 6e5f 7479 7065 203d 2053 6572  eturn_type = Ser
-0003e020: 6965 730a 2020 2020 656c 7365 3a0a 2020  ies.    else:.  
-0003e030: 2020 2020 2020 6669 6e61 6c69 7a65 5f74        finalize_t
-0003e040: 736b 203d 206c 616d 6264 6120 7473 6b3a  sk = lambda tsk:
-0003e050: 2028 6765 7469 7465 6d2c 2074 736b 2c20   (getitem, tsk, 
-0003e060: 3029 0a20 2020 2020 2020 2072 6574 7572  0).        retur
-0003e070: 6e5f 7479 7065 203d 2053 6361 6c61 720a  n_type = Scalar.
-0003e080: 2020 2020 2020 2020 7120 3d20 5b71 5d0a          q = [q].
-0003e090: 0a20 2020 2023 2070 616e 6461 7320 7573  .    # pandas us
-0003e0a0: 6573 2071 7561 6e74 696c 6520 696e 205b  es quantile in [
-0003e0b0: 302c 2031 5d0a 2020 2020 2320 6e75 6d70  0, 1].    # nump
-0003e0c0: 7920 2f20 6576 6572 796f 6e65 2065 6c73  y / everyone els
-0003e0d0: 6520 7573 6573 205b 302c 2031 3030 5d0a  e uses [0, 100].
-0003e0e0: 2020 2020 7173 203d 206e 702e 6173 6172      qs = np.asar
-0003e0f0: 7261 7928 7129 202a 2031 3030 0a20 2020  ray(q) * 100.   
-0003e100: 2074 6f6b 656e 203d 2074 6f6b 656e 697a   token = tokeniz
-0003e110: 6528 6466 2c20 7173 290a 0a20 2020 2069  e(df, qs)..    i
-0003e120: 6620 6c65 6e28 7173 2920 3d3d 2030 3a0a  f len(qs) == 0:.
-0003e130: 2020 2020 2020 2020 6e61 6d65 203d 2022          name = "
-0003e140: 7175 616e 7469 6c65 732d 2220 2b20 746f  quantiles-" + to
-0003e150: 6b65 6e0a 2020 2020 2020 2020 656d 7074  ken.        empt
-0003e160: 795f 696e 6465 7820 3d20 7064 2e49 6e64  y_index = pd.Ind
-0003e170: 6578 285b 5d2c 2064 7479 7065 3d66 6c6f  ex([], dtype=flo
-0003e180: 6174 290a 0a20 2020 2020 2020 2072 6574  at)..        ret
-0003e190: 7572 6e20 5365 7269 6573 280a 2020 2020  urn Series(.    
-0003e1a0: 2020 2020 2020 2020 7b28 6e61 6d65 2c20          {(name, 
-0003e1b0: 3029 3a20 7365 7269 6573 5f74 7970 285b  0): series_typ([
-0003e1c0: 5d2c 206e 616d 653d 6466 2e6e 616d 652c  ], name=df.name,
-0003e1d0: 2069 6e64 6578 3d65 6d70 7479 5f69 6e64   index=empty_ind
-0003e1e0: 6578 2c20 6474 7970 653d 2266 6c6f 6174  ex, dtype="float
-0003e1f0: 2229 7d2c 0a20 2020 2020 2020 2020 2020  ")},.           
-0003e200: 206e 616d 652c 0a20 2020 2020 2020 2020   name,.         
-0003e210: 2020 2064 662e 5f6d 6574 612c 0a20 2020     df._meta,.   
-0003e220: 2020 2020 2020 2020 205b 4e6f 6e65 2c20           [None, 
-0003e230: 4e6f 6e65 5d2c 0a20 2020 2020 2020 2029  None],.        )
-0003e240: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-0003e250: 2020 206e 6577 5f64 6976 6973 696f 6e73     new_divisions
-0003e260: 203d 205b 6e70 2e6d 696e 2871 292c 206e   = [np.min(q), n
-0003e270: 702e 6d61 7828 7129 5d0a 0a20 2020 2064  p.max(q)]..    d
-0003e280: 6620 3d20 6466 2e64 726f 706e 6128 290a  f = df.dropna().
-0003e290: 0a20 2020 2069 6620 696e 7465 726e 616c  .    if internal
-0003e2a0: 5f6d 6574 686f 6420 3d3d 2022 7464 6967  _method == "tdig
-0003e2b0: 6573 7422 2061 6e64 2028 0a20 2020 2020  est" and (.     
-0003e2c0: 2020 206e 702e 6973 7375 6264 7479 7065     np.issubdtype
-0003e2d0: 2864 662e 6474 7970 652c 206e 702e 666c  (df.dtype, np.fl
-0003e2e0: 6f61 7469 6e67 2920 6f72 206e 702e 6973  oating) or np.is
-0003e2f0: 7375 6264 7479 7065 2864 662e 6474 7970  subdtype(df.dtyp
-0003e300: 652c 206e 702e 696e 7465 6765 7229 0a20  e, np.integer). 
-0003e310: 2020 2029 3a0a 2020 2020 2020 2020 6672     ):.        fr
-0003e320: 6f6d 2064 6173 6b2e 7574 696c 7320 696d  om dask.utils im
-0003e330: 706f 7274 2069 6d70 6f72 745f 7265 7175  port import_requ
-0003e340: 6972 6564 0a0a 2020 2020 2020 2020 696d  ired..        im
-0003e350: 706f 7274 5f72 6571 7569 7265 6428 0a20  port_required(. 
-0003e360: 2020 2020 2020 2020 2020 2022 6372 6963             "cric
-0003e370: 6b22 2c20 2263 7269 636b 2069 7320 6120  k", "crick is a 
-0003e380: 7265 7175 6972 6564 2064 6570 656e 6465  required depende
-0003e390: 6e63 7920 666f 7220 7573 696e 6720 7468  ncy for using th
-0003e3a0: 6520 742d 6469 6765 7374 206d 6574 686f  e t-digest metho
-0003e3b0: 642e 220a 2020 2020 2020 2020 290a 0a20  d.".        ).. 
-0003e3c0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-0003e3d0: 2e61 7272 6179 2e70 6572 6365 6e74 696c  .array.percentil
-0003e3e0: 6520 696d 706f 7274 205f 7065 7263 656e  e import _percen
-0003e3f0: 7469 6c65 735f 6672 6f6d 5f74 6469 6765  tiles_from_tdige
-0003e400: 7374 2c20 5f74 6469 6765 7374 5f63 6875  st, _tdigest_chu
-0003e410: 6e6b 0a0a 2020 2020 2020 2020 6e61 6d65  nk..        name
-0003e420: 203d 2022 7175 616e 7469 6c65 735f 7464   = "quantiles_td
-0003e430: 6967 6573 742d 312d 2220 2b20 746f 6b65  igest-1-" + toke
-0003e440: 6e0a 2020 2020 2020 2020 7661 6c5f 6473  n.        val_ds
-0003e450: 6b20 3d20 7b0a 2020 2020 2020 2020 2020  k = {.          
-0003e460: 2020 286e 616d 652c 2069 293a 2028 5f74    (name, i): (_t
-0003e470: 6469 6765 7374 5f63 6875 6e6b 2c20 2867  digest_chunk, (g
-0003e480: 6574 6174 7472 2c20 6b65 792c 2022 7661  etattr, key, "va
-0003e490: 6c75 6573 2229 290a 2020 2020 2020 2020  lues")).        
-0003e4a0: 2020 2020 666f 7220 692c 206b 6579 2069      for i, key i
-0003e4b0: 6e20 656e 756d 6572 6174 6528 6466 2e5f  n enumerate(df._
-0003e4c0: 5f64 6173 6b5f 6b65 7973 5f5f 2829 290a  _dask_keys__()).
-0003e4d0: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
-0003e4e0: 2020 206e 616d 6532 203d 2022 7175 616e     name2 = "quan
-0003e4f0: 7469 6c65 735f 7464 6967 6573 742d 322d  tiles_tdigest-2-
-0003e500: 2220 2b20 746f 6b65 6e0a 2020 2020 2020  " + token.      
-0003e510: 2020 6d65 7267 655f 6473 6b20 3d20 7b0a    merge_dsk = {.
-0003e520: 2020 2020 2020 2020 2020 2020 286e 616d              (nam
-0003e530: 6532 2c20 3029 3a20 6669 6e61 6c69 7a65  e2, 0): finalize
-0003e540: 5f74 736b 2828 5f70 6572 6365 6e74 696c  _tsk((_percentil
-0003e550: 6573 5f66 726f 6d5f 7464 6967 6573 742c  es_from_tdigest,
-0003e560: 2071 732c 2073 6f72 7465 6428 7661 6c5f   qs, sorted(val_
-0003e570: 6473 6b29 2929 0a20 2020 2020 2020 207d  dsk))).        }
-0003e580: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-0003e590: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
-0003e5a0: 6179 2e64 6973 7061 7463 6820 696d 706f  ay.dispatch impo
-0003e5b0: 7274 2070 6572 6365 6e74 696c 655f 6c6f  rt percentile_lo
-0003e5c0: 6f6b 7570 2061 7320 5f70 6572 6365 6e74  okup as _percent
-0003e5d0: 696c 650a 2020 2020 2020 2020 6672 6f6d  ile.        from
-0003e5e0: 2064 6173 6b2e 6172 7261 792e 7065 7263   dask.array.perc
-0003e5f0: 656e 7469 6c65 2069 6d70 6f72 7420 6d65  entile import me
-0003e600: 7267 655f 7065 7263 656e 7469 6c65 730a  rge_percentiles.
-0003e610: 0a20 2020 2020 2020 2023 2041 6464 2030  .        # Add 0
-0003e620: 2061 6e64 2031 3030 2064 7572 696e 6720   and 100 during 
-0003e630: 6361 6c63 756c 6174 696f 6e20 666f 7220  calculation for 
-0003e640: 6d6f 7265 2072 6f62 7573 7420 6265 6861  more robust beha
-0003e650: 7669 6f72 2028 686f 7065 6675 6c6c 7929  vior (hopefully)
-0003e660: 0a20 2020 2020 2020 2063 616c 635f 7173  .        calc_qs
-0003e670: 203d 206e 702e 7061 6428 7173 2c20 312c   = np.pad(qs, 1,
-0003e680: 206d 6f64 653d 2263 6f6e 7374 616e 7422   mode="constant"
-0003e690: 290a 2020 2020 2020 2020 6361 6c63 5f71  ).        calc_q
-0003e6a0: 735b 2d31 5d20 3d20 3130 300a 2020 2020  s[-1] = 100.    
-0003e6b0: 2020 2020 6e61 6d65 203d 2022 7175 616e      name = "quan
-0003e6c0: 7469 6c65 732d 312d 2220 2b20 746f 6b65  tiles-1-" + toke
-0003e6d0: 6e0a 2020 2020 2020 2020 7661 6c5f 6473  n.        val_ds
-0003e6e0: 6b20 3d20 7b0a 2020 2020 2020 2020 2020  k = {.          
-0003e6f0: 2020 286e 616d 652c 2069 293a 2028 5f70    (name, i): (_p
-0003e700: 6572 6365 6e74 696c 652c 206b 6579 2c20  ercentile, key, 
-0003e710: 6361 6c63 5f71 7329 0a20 2020 2020 2020  calc_qs).       
-0003e720: 2020 2020 2066 6f72 2069 2c20 6b65 7920       for i, key 
-0003e730: 696e 2065 6e75 6d65 7261 7465 2864 662e  in enumerate(df.
-0003e740: 5f5f 6461 736b 5f6b 6579 735f 5f28 2929  __dask_keys__())
-0003e750: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
-0003e760: 2020 2020 6e61 6d65 3220 3d20 2271 7561      name2 = "qua
-0003e770: 6e74 696c 6573 2d32 2d22 202b 2074 6f6b  ntiles-2-" + tok
-0003e780: 656e 0a20 2020 2020 2020 206d 6572 6765  en.        merge
-0003e790: 5f64 736b 203d 207b 0a20 2020 2020 2020  _dsk = {.       
-0003e7a0: 2020 2020 2028 6e61 6d65 322c 2030 293a       (name2, 0):
-0003e7b0: 2066 696e 616c 697a 655f 7473 6b28 0a20   finalize_tsk(. 
-0003e7c0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0003e7d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e7e0: 2020 2020 206d 6572 6765 5f70 6572 6365       merge_perce
-0003e7f0: 6e74 696c 6573 2c0a 2020 2020 2020 2020  ntiles,.        
-0003e800: 2020 2020 2020 2020 2020 2020 7173 2c0a              qs,.
-0003e810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e820: 2020 2020 5b63 616c 635f 7173 5d20 2a20      [calc_qs] * 
-0003e830: 6466 2e6e 7061 7274 6974 696f 6e73 2c0a  df.npartitions,.
-0003e840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e850: 2020 2020 736f 7274 6564 2876 616c 5f64      sorted(val_d
-0003e860: 736b 292c 0a20 2020 2020 2020 2020 2020  sk),.           
-0003e870: 2020 2020 2020 2020 2022 6c6f 7765 7222           "lower"
-0003e880: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003e890: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-0003e8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e8b0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-0003e8c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0003e8d0: 2020 2020 2029 0a20 2020 2020 2020 207d       ).        }
-0003e8e0: 0a20 2020 2064 736b 203d 206d 6572 6765  .    dsk = merge
-0003e8f0: 2876 616c 5f64 736b 2c20 6d65 7267 655f  (val_dsk, merge_
-0003e900: 6473 6b29 0a20 2020 2067 7261 7068 203d  dsk).    graph =
-0003e910: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-0003e920: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-0003e930: 286e 616d 6532 2c20 6473 6b2c 2064 6570  (name2, dsk, dep
-0003e940: 656e 6465 6e63 6965 733d 5b64 665d 290a  endencies=[df]).
-0003e950: 2020 2020 7265 7475 726e 2072 6574 7572      return retur
-0003e960: 6e5f 7479 7065 2867 7261 7068 2c20 6e61  n_type(graph, na
-0003e970: 6d65 322c 206d 6574 612c 206e 6577 5f64  me2, meta, new_d
-0003e980: 6976 6973 696f 6e73 290a 0a0a 6465 6620  ivisions)...def 
-0003e990: 5f63 6f76 5f63 6f72 7228 0a20 2020 2064  _cov_corr(.    d
-0003e9a0: 662c 0a20 2020 206d 696e 5f70 6572 696f  f,.    min_perio
-0003e9b0: 6473 3d4e 6f6e 652c 0a20 2020 2063 6f72  ds=None,.    cor
-0003e9c0: 723d 4661 6c73 652c 0a20 2020 2073 6361  r=False,.    sca
-0003e9d0: 6c61 723d 4661 6c73 652c 0a20 2020 206e  lar=False,.    n
-0003e9e0: 756d 6572 6963 5f6f 6e6c 793d 6e6f 5f64  umeric_only=no_d
-0003e9f0: 6566 6175 6c74 2c0a 2020 2020 7370 6c69  efault,.    spli
-0003ea00: 745f 6576 6572 793d 4661 6c73 652c 0a29  t_every=False,.)
-0003ea10: 3a0a 2020 2020 2222 2244 6174 6146 7261  :.    """DataFra
-0003ea20: 6d65 2063 6f76 6172 6961 6e63 6520 616e  me covariance an
-0003ea30: 6420 7065 6172 736f 6e20 636f 7272 656c  d pearson correl
-0003ea40: 6174 696f 6e2e 0a0a 2020 2020 436f 6d70  ation...    Comp
-0003ea50: 7574 6573 2070 6169 7277 6973 6520 636f  utes pairwise co
-0003ea60: 7661 7269 616e 6365 206f 7220 636f 7272  variance or corr
-0003ea70: 656c 6174 696f 6e20 6f66 2063 6f6c 756d  elation of colum
-0003ea80: 6e73 2c20 6578 636c 7564 696e 6720 4e41  ns, excluding NA
-0003ea90: 2f6e 756c 6c0a 2020 2020 7661 6c75 6573  /null.    values
-0003eaa0: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-0003eab0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-0003eac0: 0a20 2020 2064 6620 3a20 4461 7461 4672  .    df : DataFr
-0003ead0: 616d 650a 2020 2020 6d69 6e5f 7065 7269  ame.    min_peri
-0003eae0: 6f64 7320 3a20 696e 742c 206f 7074 696f  ods : int, optio
-0003eaf0: 6e61 6c0a 2020 2020 2020 2020 4d69 6e69  nal.        Mini
-0003eb00: 6d75 6d20 6e75 6d62 6572 206f 6620 6f62  mum number of ob
-0003eb10: 7365 7276 6174 696f 6e73 2072 6571 7569  servations requi
-0003eb20: 7265 6420 7065 7220 7061 6972 206f 6620  red per pair of 
-0003eb30: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
-0003eb40: 746f 2068 6176 6520 6120 7661 6c69 6420  to have a valid 
-0003eb50: 7265 7375 6c74 2e0a 2020 2020 636f 7272  result..    corr
-0003eb60: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
-0003eb70: 6c0a 2020 2020 2020 2020 4966 2054 7275  l.        If Tru
-0003eb80: 652c 2063 6f6d 7075 7465 2074 6865 2050  e, compute the P
-0003eb90: 6561 7273 6f6e 2063 6f72 7265 6c61 7469  earson correlati
-0003eba0: 6f6e 2e20 4966 2046 616c 7365 205b 6465  on. If False [de
-0003ebb0: 6661 756c 745d 2c20 636f 6d70 7574 650a  fault], compute.
-0003ebc0: 2020 2020 2020 2020 7468 6520 636f 7661          the cova
-0003ebd0: 7269 616e 6365 2e0a 2020 2020 7363 616c  riance..    scal
-0003ebe0: 6172 203a 2062 6f6f 6c2c 206f 7074 696f  ar : bool, optio
-0003ebf0: 6e61 6c0a 2020 2020 2020 2020 4966 2054  nal.        If T
-0003ec00: 7275 652c 2063 6f6d 7075 7465 2063 6f76  rue, compute cov
-0003ec10: 6172 6961 6e63 6520 6265 7477 6565 6e20  ariance between 
-0003ec20: 7477 6f20 7661 7269 6162 6c65 7320 6173  two variables as
-0003ec30: 2061 2073 6361 6c61 722e 204f 6e6c 790a   a scalar. Only.
-0003ec40: 2020 2020 2020 2020 7661 6c69 6420 6966          valid if
-0003ec50: 2060 6466 6020 6861 7320 3220 636f 6c75   `df` has 2 colu
-0003ec60: 6d6e 732e 2020 4966 2046 616c 7365 205b  mns.  If False [
-0003ec70: 6465 6661 756c 745d 2c20 636f 6d70 7574  default], comput
-0003ec80: 6520 7468 6520 656e 7469 7265 0a20 2020  e the entire.   
-0003ec90: 2020 2020 2063 6f76 6172 6961 6e63 652f       covariance/
-0003eca0: 636f 7272 656c 6174 696f 6e20 6d61 7472  correlation matr
-0003ecb0: 6978 2e0a 2020 2020 7370 6c69 745f 6576  ix..    split_ev
-0003ecc0: 6572 7920 3a20 696e 742c 206f 7074 696f  ery : int, optio
-0003ecd0: 6e61 6c0a 2020 2020 2020 2020 4772 6f75  nal.        Grou
-0003ece0: 7020 7061 7274 6974 696f 6e73 2069 6e74  p partitions int
-0003ecf0: 6f20 6772 6f75 7073 206f 6620 7468 6973  o groups of this
-0003ed00: 2073 697a 6520 7768 696c 6520 7065 7266   size while perf
-0003ed10: 6f72 6d69 6e67 2061 0a20 2020 2020 2020  orming a.       
-0003ed20: 2074 7265 652d 7265 6475 6374 696f 6e2e   tree-reduction.
-0003ed30: 2049 6620 7365 7420 746f 2046 616c 7365   If set to False
-0003ed40: 2c20 6e6f 2074 7265 652d 7265 6475 6374  , no tree-reduct
-0003ed50: 696f 6e20 7769 6c6c 2062 6520 7573 6564  ion will be used
-0003ed60: 2e0a 2020 2020 2020 2020 4465 6661 756c  ..        Defaul
-0003ed70: 7420 6973 2046 616c 7365 2e0a 2020 2020  t is False..    
-0003ed80: 2222 220a 2020 2020 6966 206d 696e 5f70  """.    if min_p
-0003ed90: 6572 696f 6473 2069 7320 4e6f 6e65 3a0a  eriods is None:.
-0003eda0: 2020 2020 2020 2020 6d69 6e5f 7065 7269          min_peri
-0003edb0: 6f64 7320 3d20 320a 2020 2020 656c 6966  ods = 2.    elif
-0003edc0: 206d 696e 5f70 6572 696f 6473 203c 2032   min_periods < 2
-0003edd0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-0003ede0: 5661 6c75 6545 7272 6f72 2822 6d69 6e5f  ValueError("min_
-0003edf0: 7065 7269 6f64 7320 6d75 7374 2062 6520  periods must be 
-0003ee00: 3e3d 2032 2229 0a0a 2020 2020 6966 2073  >= 2")..    if s
-0003ee10: 706c 6974 5f65 7665 7279 2069 7320 4661  plit_every is Fa
-0003ee20: 6c73 653a 0a20 2020 2020 2020 2073 706c  lse:.        spl
-0003ee30: 6974 5f65 7665 7279 203d 2064 662e 6e70  it_every = df.np
-0003ee40: 6172 7469 7469 6f6e 730a 2020 2020 656c  artitions.    el
-0003ee50: 6966 2073 706c 6974 5f65 7665 7279 203c  if split_every <
-0003ee60: 2032 206f 7220 6e6f 7420 6973 696e 7374   2 or not isinst
-0003ee70: 616e 6365 2873 706c 6974 5f65 7665 7279  ance(split_every
-0003ee80: 2c20 496e 7465 6772 616c 293a 0a20 2020  , Integral):.   
-0003ee90: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0003eea0: 4572 726f 7228 2273 706c 6974 5f65 7665  Error("split_eve
-0003eeb0: 7279 206d 7573 7420 6265 2061 6e20 696e  ry must be an in
-0003eec0: 7465 6765 7220 3e3d 2032 2229 0a0a 2020  teger >= 2")..  
-0003eed0: 2020 2320 4861 6e64 6c65 2073 656c 6563    # Handle selec
-0003eee0: 7469 6e67 206e 756d 6572 6963 2064 6174  ting numeric dat
-0003eef0: 6120 616e 6420 6173 736f 6369 6174 6564  a and associated
-0003ef00: 2064 6570 7265 6361 7469 6f6e 2077 6172   deprecation war
-0003ef10: 6e69 6e67 0a20 2020 206d 6179 6265 5f77  ning.    maybe_w
-0003ef20: 6172 6e20 3d20 4661 6c73 650a 2020 2020  arn = False.    
-0003ef30: 6966 206e 756d 6572 6963 5f6f 6e6c 7920  if numeric_only 
-0003ef40: 6973 206e 6f5f 6465 6661 756c 743a 0a20  is no_default:. 
-0003ef50: 2020 2020 2020 2069 6620 5041 4e44 4153         if PANDAS
-0003ef60: 5f47 545f 3230 303a 0a20 2020 2020 2020  _GT_200:.       
-0003ef70: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-0003ef80: 7920 3d20 4661 6c73 650a 2020 2020 2020  y = False.      
-0003ef90: 2020 656c 6966 2050 414e 4441 535f 4754    elif PANDAS_GT
-0003efa0: 5f31 3530 3a0a 2020 2020 2020 2020 2020  _150:.          
-0003efb0: 2020 6d61 7962 655f 7761 726e 203d 2054    maybe_warn = T
-0003efc0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-0003efd0: 6e75 6d65 7269 635f 6f6e 6c79 203d 2054  numeric_only = T
-0003efe0: 7275 650a 2020 2020 2020 2020 656c 7365  rue.        else
-0003eff0: 3a0a 2020 2020 2020 2020 2020 2020 6e75  :.            nu
-0003f000: 6d65 7269 635f 6f6e 6c79 203d 2054 7275  meric_only = Tru
-0003f010: 650a 0a20 2020 2061 6c6c 5f6e 756d 6572  e..    all_numer
-0003f020: 6963 203d 2064 662e 5f67 6574 5f6e 756d  ic = df._get_num
-0003f030: 6572 6963 5f64 6174 6128 292e 5f6e 616d  eric_data()._nam
-0003f040: 6520 3d3d 2064 662e 5f6e 616d 650a 2020  e == df._name.  
-0003f050: 2020 6966 206d 6179 6265 5f77 6172 6e20    if maybe_warn 
-0003f060: 616e 6420 6e6f 7420 616c 6c5f 6e75 6d65  and not all_nume
-0003f070: 7269 633a 0a20 2020 2020 2020 2077 6172  ric:.        war
-0003f080: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-0003f090: 2020 2020 2020 2020 2254 6865 2064 6566          "The def
-0003f0a0: 6175 6c74 2076 616c 7565 206f 6620 6e75  ault value of nu
-0003f0b0: 6d65 7269 635f 6f6e 6c79 2077 696c 6c20  meric_only will 
-0003f0c0: 6265 2060 4661 6c73 6560 2022 0a20 2020  be `False` ".   
-0003f0d0: 2020 2020 2020 2020 2022 696e 2061 2066           "in a f
-0003f0e0: 7574 7572 6520 7665 7273 696f 6e20 6f66  uture version of
-0003f0f0: 2044 6173 6b2e 222c 0a20 2020 2020 2020   Dask.",.       
-0003f100: 2020 2020 2046 7574 7572 6557 6172 6e69       FutureWarni
-0003f110: 6e67 2c0a 2020 2020 2020 2020 290a 0a20  ng,.        ).. 
-0003f120: 2020 2069 6620 6e75 6d65 7269 635f 6f6e     if numeric_on
-0003f130: 6c79 2061 6e64 206e 6f74 2061 6c6c 5f6e  ly and not all_n
-0003f140: 756d 6572 6963 3a0a 2020 2020 2020 2020  umeric:.        
-0003f150: 6466 203d 2064 662e 5f67 6574 5f6e 756d  df = df._get_num
-0003f160: 6572 6963 5f64 6174 6128 290a 0a20 2020  eric_data()..   
-0003f170: 2069 6620 7363 616c 6172 2061 6e64 206c   if scalar and l
-0003f180: 656e 2864 662e 636f 6c75 6d6e 7329 2021  en(df.columns) !
-0003f190: 3d20 323a 0a20 2020 2020 2020 2072 6169  = 2:.        rai
-0003f1a0: 7365 2056 616c 7565 4572 726f 7228 2273  se ValueError("s
-0003f1b0: 6361 6c61 7220 6f6e 6c79 2076 616c 6964  calar only valid
-0003f1c0: 2066 6f72 2032 2063 6f6c 756d 6e20 6461   for 2 column da
-0003f1d0: 7461 6672 616d 6522 290a 0a20 2020 2074  taframe")..    t
-0003f1e0: 6f6b 656e 203d 2074 6f6b 656e 697a 6528  oken = tokenize(
-0003f1f0: 6466 2c20 6d69 6e5f 7065 7269 6f64 732c  df, min_periods,
-0003f200: 2073 6361 6c61 722c 2073 706c 6974 5f65   scalar, split_e
-0003f210: 7665 7279 290a 0a20 2020 2066 756e 636e  very)..    funcn
-0003f220: 616d 6520 3d20 2263 6f72 7222 2069 6620  ame = "corr" if 
-0003f230: 636f 7272 2065 6c73 6520 2263 6f76 220a  corr else "cov".
-0003f240: 2020 2020 6120 3d20 6622 7b66 756e 636e      a = f"{funcn
-0003f250: 616d 657d 2d63 6875 6e6b 2d7b 6466 2e5f  ame}-chunk-{df._
-0003f260: 6e61 6d65 7d22 0a20 2020 2064 736b 203d  name}".    dsk =
-0003f270: 207b 0a20 2020 2020 2020 2028 612c 2069   {.        (a, i
-0003f280: 293a 2028 5f63 6f76 5f63 6f72 725f 6368  ): (_cov_corr_ch
-0003f290: 756e 6b2c 2066 2c20 636f 7272 2920 666f  unk, f, corr) fo
-0003f2a0: 7220 2869 2c20 6629 2069 6e20 656e 756d  r (i, f) in enum
-0003f2b0: 6572 6174 6528 6466 2e5f 5f64 6173 6b5f  erate(df.__dask_
-0003f2c0: 6b65 7973 5f5f 2829 290a 2020 2020 7d0a  keys__()).    }.
-0003f2d0: 0a20 2020 2070 7265 6669 7820 3d20 6622  .    prefix = f"
-0003f2e0: 7b66 756e 636e 616d 657d 2d63 6f6d 6269  {funcname}-combi
-0003f2f0: 6e65 2d7b 6466 2e5f 6e61 6d65 7d2d 220a  ne-{df._name}-".
-0003f300: 2020 2020 6b20 3d20 6466 2e6e 7061 7274      k = df.npart
-0003f310: 6974 696f 6e73 0a20 2020 2062 203d 2061  itions.    b = a
-0003f320: 0a20 2020 2064 6570 7468 203d 2030 0a20  .    depth = 0. 
-0003f330: 2020 2077 6869 6c65 206b 203e 2073 706c     while k > spl
-0003f340: 6974 5f65 7665 7279 3a0a 2020 2020 2020  it_every:.      
-0003f350: 2020 6220 3d20 7072 6566 6978 202b 2073    b = prefix + s
-0003f360: 7472 2864 6570 7468 290a 2020 2020 2020  tr(depth).      
-0003f370: 2020 666f 7220 7061 7274 5f69 2c20 696e    for part_i, in
-0003f380: 6473 2069 6e20 656e 756d 6572 6174 6528  ds in enumerate(
-0003f390: 7061 7274 6974 696f 6e5f 616c 6c28 7370  partition_all(sp
-0003f3a0: 6c69 745f 6576 6572 792c 2072 616e 6765  lit_every, range
-0003f3b0: 286b 2929 293a 0a20 2020 2020 2020 2020  (k))):.         
-0003f3c0: 2020 2064 736b 5b28 622c 2070 6172 745f     dsk[(b, part_
-0003f3d0: 6929 5d20 3d20 285f 636f 765f 636f 7272  i)] = (_cov_corr
-0003f3e0: 5f63 6f6d 6269 6e65 2c20 5b28 612c 2069  _combine, [(a, i
-0003f3f0: 2920 666f 7220 6920 696e 2069 6e64 735d  ) for i in inds]
-0003f400: 2c20 636f 7272 290a 2020 2020 2020 2020  , corr).        
-0003f410: 6b20 3d20 7061 7274 5f69 202b 2031 0a20  k = part_i + 1. 
-0003f420: 2020 2020 2020 2061 203d 2062 0a20 2020         a = b.   
-0003f430: 2020 2020 2064 6570 7468 202b 3d20 310a       depth += 1.
-0003f440: 0a20 2020 206e 616d 6520 3d20 6622 7b66  .    name = f"{f
-0003f450: 756e 636e 616d 657d 2d7b 746f 6b65 6e7d  uncname}-{token}
-0003f460: 220a 2020 2020 6473 6b5b 286e 616d 652c  ".    dsk[(name,
-0003f470: 2030 295d 203d 2028 0a20 2020 2020 2020   0)] = (.       
-0003f480: 205f 636f 765f 636f 7272 5f61 6767 2c0a   _cov_corr_agg,.
-0003f490: 2020 2020 2020 2020 5b28 612c 2069 2920          [(a, i) 
-0003f4a0: 666f 7220 6920 696e 2072 616e 6765 286b  for i in range(k
-0003f4b0: 295d 2c0a 2020 2020 2020 2020 6466 2e63  )],.        df.c
-0003f4c0: 6f6c 756d 6e73 2c0a 2020 2020 2020 2020  olumns,.        
-0003f4d0: 6d69 6e5f 7065 7269 6f64 732c 0a20 2020  min_periods,.   
-0003f4e0: 2020 2020 2063 6f72 722c 0a20 2020 2020       corr,.     
-0003f4f0: 2020 2073 6361 6c61 722c 0a20 2020 2020     scalar,.     
-0003f500: 2020 2064 662e 5f6d 6574 612c 0a20 2020     df._meta,.   
-0003f510: 2029 0a20 2020 2067 7261 7068 203d 2048   ).    graph = H
-0003f520: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-0003f530: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
-0003f540: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
-0003f550: 656e 6369 6573 3d5b 6466 5d29 0a20 2020  encies=[df]).   
-0003f560: 2069 6620 7363 616c 6172 3a0a 2020 2020   if scalar:.    
-0003f570: 2020 2020 7265 7475 726e 2053 6361 6c61      return Scala
-0003f580: 7228 6772 6170 682c 206e 616d 652c 2022  r(graph, name, "
-0003f590: 6638 2229 0a20 2020 206d 6574 6120 3d20  f8").    meta = 
-0003f5a0: 6d61 6b65 5f6d 6574 6128 0a20 2020 2020  make_meta(.     
-0003f5b0: 2020 205b 2863 2c20 2266 3822 2920 666f     [(c, "f8") fo
-0003f5c0: 7220 6320 696e 2064 662e 636f 6c75 6d6e  r c in df.column
-0003f5d0: 735d 2c0a 2020 2020 2020 2020 696e 6465  s],.        inde
-0003f5e0: 783d 6d65 7461 5f73 6572 6965 735f 636f  x=meta_series_co
-0003f5f0: 6e73 7472 7563 746f 7228 6466 2928 6466  nstructor(df)(df
-0003f600: 2e63 6f6c 756d 6e73 292c 0a20 2020 2020  .columns),.     
-0003f610: 2020 2070 6172 656e 745f 6d65 7461 3d64     parent_meta=d
-0003f620: 662e 5f6d 6574 612c 0a20 2020 2029 0a20  f._meta,.    ). 
-0003f630: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
-0003f640: 5f6f 626a 6563 7428 6772 6170 682c 206e  _object(graph, n
-0003f650: 616d 652c 206d 6574 612c 2028 6466 2e63  ame, meta, (df.c
-0003f660: 6f6c 756d 6e73 2e6d 696e 2829 2c20 6466  olumns.min(), df
-0003f670: 2e63 6f6c 756d 6e73 2e6d 6178 2829 2929  .columns.max()))
-0003f680: 0a0a 0a64 6566 205f 636f 765f 636f 7272  ...def _cov_corr
-0003f690: 5f63 6875 6e6b 2864 662c 2063 6f72 723d  _chunk(df, corr=
-0003f6a0: 4661 6c73 6529 3a0a 2020 2020 2222 2243  False):.    """C
-0003f6b0: 6875 6e6b 2070 6172 7420 6f66 2061 2063  hunk part of a c
-0003f6c0: 6f76 6172 6961 6e63 6520 6f72 2063 6f72  ovariance or cor
-0003f6d0: 7265 6c61 7469 6f6e 2063 6f6d 7075 7461  relation computa
-0003f6e0: 7469 6f6e 2222 220a 2020 2020 7368 6170  tion""".    shap
-0003f6f0: 6520 3d20 2864 662e 7368 6170 655b 315d  e = (df.shape[1]
-0003f700: 2c20 6466 2e73 6861 7065 5b31 5d29 0a20  , df.shape[1]). 
-0003f710: 2020 2064 6620 3d20 6466 2e61 7374 7970     df = df.astyp
-0003f720: 6528 2266 6c6f 6174 3634 222c 2063 6f70  e("float64", cop
-0003f730: 793d 4661 6c73 6529 0a20 2020 2073 756d  y=False).    sum
-0003f740: 7320 3d20 6e70 2e7a 6572 6f73 5f6c 696b  s = np.zeros_lik
-0003f750: 6528 6466 2e76 616c 7565 732c 2073 6861  e(df.values, sha
-0003f760: 7065 3d73 6861 7065 290a 2020 2020 636f  pe=shape).    co
-0003f770: 756e 7473 203d 206e 702e 7a65 726f 735f  unts = np.zeros_
-0003f780: 6c69 6b65 2864 662e 7661 6c75 6573 2c20  like(df.values, 
-0003f790: 7368 6170 653d 7368 6170 6529 0a20 2020  shape=shape).   
-0003f7a0: 2066 6f72 2069 6478 2069 6e20 7261 6e67   for idx in rang
-0003f7b0: 6528 6c65 6e28 6466 2e63 6f6c 756d 6e73  e(len(df.columns
-0003f7c0: 2929 3a0a 2020 2020 2020 2020 6d61 736b  )):.        mask
-0003f7d0: 203d 2064 662e 696c 6f63 5b3a 2c20 6964   = df.iloc[:, id
-0003f7e0: 785d 2e6e 6f74 6e75 6c6c 2829 0a20 2020  x].notnull().   
-0003f7f0: 2020 2020 2073 756d 735b 6964 785d 203d       sums[idx] =
-0003f800: 2064 665b 6d61 736b 5d2e 7375 6d28 292e   df[mask].sum().
-0003f810: 7661 6c75 6573 0a20 2020 2020 2020 2063  values.        c
-0003f820: 6f75 6e74 735b 6964 785d 203d 2064 665b  ounts[idx] = df[
-0003f830: 6d61 736b 5d2e 636f 756e 7428 292e 7661  mask].count().va
-0003f840: 6c75 6573 0a20 2020 2063 6f76 203d 2064  lues.    cov = d
-0003f850: 662e 636f 7628 292e 7661 6c75 6573 0a20  f.cov().values. 
-0003f860: 2020 2064 7479 7065 203d 205b 2822 7375     dtype = [("su
-0003f870: 6d22 2c20 7375 6d73 2e64 7479 7065 292c  m", sums.dtype),
-0003f880: 2028 2263 6f75 6e74 222c 2063 6f75 6e74   ("count", count
-0003f890: 732e 6474 7970 6529 2c20 2822 636f 7622  s.dtype), ("cov"
-0003f8a0: 2c20 636f 762e 6474 7970 6529 5d0a 2020  , cov.dtype)].  
-0003f8b0: 2020 6966 2063 6f72 723a 0a20 2020 2020    if corr:.     
-0003f8c0: 2020 2077 6974 6820 7761 726e 696e 6773     with warnings
-0003f8d0: 2e63 6174 6368 5f77 6172 6e69 6e67 7328  .catch_warnings(
-0003f8e0: 7265 636f 7264 3d54 7275 6529 3a0a 2020  record=True):.  
-0003f8f0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-0003f900: 6773 2e73 696d 706c 6566 696c 7465 7228  gs.simplefilter(
-0003f910: 2261 6c77 6179 7322 290a 2020 2020 2020  "always").      
-0003f920: 2020 2020 2020 6d75 203d 2028 7375 6d73        mu = (sums
-0003f930: 202f 2063 6f75 6e74 7329 2e54 0a20 2020   / counts).T.   
-0003f940: 2020 2020 206d 203d 206e 702e 7a65 726f       m = np.zero
-0003f950: 735f 6c69 6b65 2864 662e 7661 6c75 6573  s_like(df.values
-0003f960: 2c20 7368 6170 653d 7368 6170 6529 0a20  , shape=shape). 
-0003f970: 2020 2020 2020 206d 6173 6b20 3d20 6466         mask = df
-0003f980: 2e69 736e 756c 6c28 292e 7661 6c75 6573  .isnull().values
-0003f990: 0a20 2020 2020 2020 2066 6f72 2069 6478  .        for idx
-0003f9a0: 2069 6e20 7261 6e67 6528 6c65 6e28 6466   in range(len(df
-0003f9b0: 2e63 6f6c 756d 6e73 2929 3a0a 2020 2020  .columns)):.    
-0003f9c0: 2020 2020 2020 2020 2320 4176 6f69 6420          # Avoid 
-0003f9d0: 7573 696e 6720 7566 756e 632e 6f75 7465  using ufunc.oute
-0003f9e0: 7220 286e 6f74 2073 7570 706f 7274 6564  r (not supported
-0003f9f0: 2062 7920 6375 7079 290a 2020 2020 2020   by cupy).      
-0003fa00: 2020 2020 2020 6d75 5f64 6973 6372 6570        mu_discrep
-0003fa10: 616e 6379 203d 2028 0a20 2020 2020 2020  ancy = (.       
-0003fa20: 2020 2020 2020 2020 206e 702e 7375 6274           np.subt
-0003fa30: 7261 6374 2864 662e 696c 6f63 5b3a 2c20  ract(df.iloc[:, 
-0003fa40: 6964 785d 2e76 616c 7565 735b 3a2c 204e  idx].values[:, N
-0003fa50: 6f6e 655d 2c20 6d75 5b69 6478 5d5b 4e6f  one], mu[idx][No
-0003fa60: 6e65 2c20 3a5d 2920 2a2a 2032 0a20 2020  ne, :]) ** 2.   
-0003fa70: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0003fa80: 2020 2020 2020 206d 755f 6469 7363 7265         mu_discre
-0003fa90: 7061 6e63 795b 6d61 736b 5d20 3d20 6e70  pancy[mask] = np
-0003faa0: 2e6e 616e 0a20 2020 2020 2020 2020 2020  .nan.           
-0003fab0: 206d 5b69 6478 5d20 3d20 6e70 2e6e 616e   m[idx] = np.nan
-0003fac0: 7375 6d28 6d75 5f64 6973 6372 6570 616e  sum(mu_discrepan
-0003fad0: 6379 2c20 6178 6973 3d30 290a 2020 2020  cy, axis=0).    
-0003fae0: 2020 2020 6d20 3d20 6d2e 540a 2020 2020      m = m.T.    
-0003faf0: 2020 2020 6474 7970 652e 6170 7065 6e64      dtype.append
-0003fb00: 2828 226d 222c 206d 2e64 7479 7065 2929  (("m", m.dtype))
-0003fb10: 0a0a 2020 2020 6f75 7420 3d20 7b22 7375  ..    out = {"su
-0003fb20: 6d22 3a20 7375 6d73 2c20 2263 6f75 6e74  m": sums, "count
-0003fb30: 223a 2063 6f75 6e74 732c 2022 636f 7622  ": counts, "cov"
-0003fb40: 3a20 636f 7620 2a20 2863 6f75 6e74 7320  : cov * (counts 
-0003fb50: 2d20 3129 7d0a 2020 2020 6966 2063 6f72  - 1)}.    if cor
-0003fb60: 723a 0a20 2020 2020 2020 206f 7574 5b22  r:.        out["
-0003fb70: 6d22 5d20 3d20 6d0a 2020 2020 7265 7475  m"] = m.    retu
-0003fb80: 726e 206f 7574 0a0a 0a64 6566 205f 636f  rn out...def _co
-0003fb90: 765f 636f 7272 5f63 6f6d 6269 6e65 2864  v_corr_combine(d
-0003fba0: 6174 615f 696e 2c20 636f 7272 3d46 616c  ata_in, corr=Fal
-0003fbb0: 7365 293a 0a20 2020 2064 6174 6120 3d20  se):.    data = 
-0003fbc0: 7b22 7375 6d22 3a20 4e6f 6e65 2c20 2263  {"sum": None, "c
-0003fbd0: 6f75 6e74 223a 204e 6f6e 652c 2022 636f  ount": None, "co
-0003fbe0: 7622 3a20 4e6f 6e65 7d0a 2020 2020 6966  v": None}.    if
-0003fbf0: 2063 6f72 723a 0a20 2020 2020 2020 2064   corr:.        d
-0003fc00: 6174 615b 226d 225d 203d 204e 6f6e 650a  ata["m"] = None.
-0003fc10: 0a20 2020 2066 6f72 206b 2069 6e20 6461  .    for k in da
-0003fc20: 7461 2e6b 6579 7328 293a 0a20 2020 2020  ta.keys():.     
-0003fc30: 2020 2064 6174 615b 6b5d 203d 205b 645b     data[k] = [d[
-0003fc40: 6b5d 2066 6f72 2064 2069 6e20 6461 7461  k] for d in data
-0003fc50: 5f69 6e5d 0a20 2020 2020 2020 2064 6174  _in].        dat
-0003fc60: 615b 6b5d 203d 206e 702e 636f 6e63 6174  a[k] = np.concat
-0003fc70: 656e 6174 6528 6461 7461 5b6b 5d29 2e72  enate(data[k]).r
-0003fc80: 6573 6861 7065 2828 6c65 6e28 6461 7461  eshape((len(data
-0003fc90: 5b6b 5d29 2c29 202b 2064 6174 615b 6b5d  [k]),) + data[k]
-0003fca0: 5b30 5d2e 7368 6170 6529 0a0a 2020 2020  [0].shape)..    
-0003fcb0: 7375 6d73 203d 206e 702e 6e61 6e5f 746f  sums = np.nan_to
-0003fcc0: 5f6e 756d 2864 6174 615b 2273 756d 225d  _num(data["sum"]
-0003fcd0: 290a 2020 2020 636f 756e 7473 203d 2064  ).    counts = d
-0003fce0: 6174 615b 2263 6f75 6e74 225d 0a0a 2020  ata["count"]..  
-0003fcf0: 2020 6375 6d5f 7375 6d73 203d 206e 702e    cum_sums = np.
-0003fd00: 6375 6d73 756d 2873 756d 732c 2030 290a  cumsum(sums, 0).
-0003fd10: 2020 2020 6375 6d5f 636f 756e 7473 203d      cum_counts =
-0003fd20: 206e 702e 6375 6d73 756d 2863 6f75 6e74   np.cumsum(count
-0003fd30: 732c 2030 290a 0a20 2020 2073 3120 3d20  s, 0)..    s1 = 
-0003fd40: 6375 6d5f 7375 6d73 5b3a 2d31 5d0a 2020  cum_sums[:-1].  
-0003fd50: 2020 7332 203d 2073 756d 735b 313a 5d0a    s2 = sums[1:].
-0003fd60: 2020 2020 6e31 203d 2063 756d 5f63 6f75      n1 = cum_cou
-0003fd70: 6e74 735b 3a2d 315d 0a20 2020 206e 3220  nts[:-1].    n2 
-0003fd80: 3d20 636f 756e 7473 5b31 3a5d 0a20 2020  = counts[1:].   
-0003fd90: 2077 6974 6820 6e70 2e65 7272 7374 6174   with np.errstat
-0003fda0: 6528 696e 7661 6c69 643d 2269 676e 6f72  e(invalid="ignor
-0003fdb0: 6522 293a 0a20 2020 2020 2020 2064 203d  e"):.        d =
-0003fdc0: 2028 7332 202f 206e 3229 202d 2028 7331   (s2 / n2) - (s1
-0003fdd0: 202f 206e 3129 0a20 2020 2020 2020 2043   / n1).        C
-0003fde0: 203d 206e 702e 6e61 6e73 756d 280a 2020   = np.nansum(.  
-0003fdf0: 2020 2020 2020 2020 2020 286e 3120 2a20            (n1 * 
-0003fe00: 6e32 2920 2f20 286e 3120 2b20 6e32 2920  n2) / (n1 + n2) 
-0003fe10: 2a20 2864 202a 2064 2e74 7261 6e73 706f  * (d * d.transpo
-0003fe20: 7365 2828 302c 2032 2c20 3129 2929 2c20  se((0, 2, 1))), 
-0003fe30: 300a 2020 2020 2020 2020 2920 2b20 6e70  0.        ) + np
-0003fe40: 2e6e 616e 7375 6d28 6461 7461 5b22 636f  .nansum(data["co
-0003fe50: 7622 5d2c 2030 290a 0a20 2020 206f 7574  v"], 0)..    out
-0003fe60: 203d 207b 2273 756d 223a 2063 756d 5f73   = {"sum": cum_s
-0003fe70: 756d 735b 2d31 5d2c 2022 636f 756e 7422  ums[-1], "count"
-0003fe80: 3a20 6375 6d5f 636f 756e 7473 5b2d 315d  : cum_counts[-1]
-0003fe90: 2c20 2263 6f76 223a 2043 7d0a 0a20 2020  , "cov": C}..   
-0003fea0: 2069 6620 636f 7272 3a0a 2020 2020 2020   if corr:.      
-0003feb0: 2020 6e6f 6273 203d 206e 702e 7768 6572    nobs = np.wher
-0003fec0: 6528 6375 6d5f 636f 756e 7473 5b2d 315d  e(cum_counts[-1]
-0003fed0: 2c20 6375 6d5f 636f 756e 7473 5b2d 315d  , cum_counts[-1]
-0003fee0: 2c20 6e70 2e6e 616e 290a 2020 2020 2020  , np.nan).      
-0003fef0: 2020 6d75 203d 2063 756d 5f73 756d 735b    mu = cum_sums[
-0003ff00: 2d31 5d20 2f20 6e6f 6273 0a20 2020 2020  -1] / nobs.     
-0003ff10: 2020 2063 6f75 6e74 735f 6e61 203d 206e     counts_na = n
-0003ff20: 702e 7768 6572 6528 636f 756e 7473 2c20  p.where(counts, 
-0003ff30: 636f 756e 7473 2c20 6e70 2e6e 616e 290a  counts, np.nan).
-0003ff40: 2020 2020 2020 2020 6d20 3d20 6e70 2e6e          m = np.n
-0003ff50: 616e 7375 6d28 6461 7461 5b22 6d22 5d20  ansum(data["m"] 
-0003ff60: 2b20 636f 756e 7473 202a 2028 7375 6d73  + counts * (sums
-0003ff70: 202f 2063 6f75 6e74 735f 6e61 202d 206d   / counts_na - m
-0003ff80: 7529 202a 2a20 322c 2061 7869 733d 3029  u) ** 2, axis=0)
-0003ff90: 0a20 2020 2020 2020 206f 7574 5b22 6d22  .        out["m"
-0003ffa0: 5d20 3d20 6d0a 2020 2020 7265 7475 726e  ] = m.    return
-0003ffb0: 206f 7574 0a0a 0a64 6566 205f 636f 765f   out...def _cov_
-0003ffc0: 636f 7272 5f61 6767 2864 6174 612c 2063  corr_agg(data, c
-0003ffd0: 6f6c 732c 206d 696e 5f70 6572 696f 6473  ols, min_periods
-0003ffe0: 3d32 2c20 636f 7272 3d46 616c 7365 2c20  =2, corr=False, 
-0003fff0: 7363 616c 6172 3d46 616c 7365 2c20 6c69  scalar=False, li
-00040000: 6b65 5f64 663d 4e6f 6e65 293a 0a20 2020  ke_df=None):.   
-00040010: 206f 7574 203d 205f 636f 765f 636f 7272   out = _cov_corr
-00040020: 5f63 6f6d 6269 6e65 2864 6174 612c 2063  _combine(data, c
-00040030: 6f72 7229 0a20 2020 2063 6f75 6e74 7320  orr).    counts 
-00040040: 3d20 6f75 745b 2263 6f75 6e74 225d 0a20  = out["count"]. 
-00040050: 2020 2043 203d 206f 7574 5b22 636f 7622     C = out["cov"
-00040060: 5d0a 2020 2020 435b 636f 756e 7473 203c  ].    C[counts <
-00040070: 206d 696e 5f70 6572 696f 6473 5d20 3d20   min_periods] = 
-00040080: 6e70 2e6e 616e 0a20 2020 2069 6620 636f  np.nan.    if co
-00040090: 7272 3a0a 2020 2020 2020 2020 6d32 203d  rr:.        m2 =
-000400a0: 206f 7574 5b22 6d22 5d0a 2020 2020 2020   out["m"].      
-000400b0: 2020 6465 6e20 3d20 6e70 2e73 7172 7428    den = np.sqrt(
-000400c0: 6d32 202a 206d 322e 5429 0a20 2020 2065  m2 * m2.T).    e
-000400d0: 6c73 653a 0a20 2020 2020 2020 2064 656e  lse:.        den
-000400e0: 203d 206e 702e 7768 6572 6528 636f 756e   = np.where(coun
-000400f0: 7473 2c20 636f 756e 7473 2c20 6e70 2e6e  ts, counts, np.n
-00040100: 616e 2920 2d20 310a 2020 2020 7769 7468  an) - 1.    with
-00040110: 206e 702e 6572 7273 7461 7465 2869 6e76   np.errstate(inv
-00040120: 616c 6964 3d22 6967 6e6f 7265 222c 2064  alid="ignore", d
-00040130: 6976 6964 653d 2269 676e 6f72 6522 293a  ivide="ignore"):
-00040140: 0a20 2020 2020 2020 206d 6174 203d 2043  .        mat = C
-00040150: 202f 2064 656e 0a20 2020 2069 6620 7363   / den.    if sc
-00040160: 616c 6172 3a0a 2020 2020 2020 2020 7265  alar:.        re
-00040170: 7475 726e 2066 6c6f 6174 286d 6174 5b30  turn float(mat[0
-00040180: 2c20 315d 290a 2020 2020 7265 7475 726e  , 1]).    return
-00040190: 2028 7064 2e44 6174 6146 7261 6d65 2069   (pd.DataFrame i
-000401a0: 6620 6c69 6b65 5f64 6620 6973 204e 6f6e  f like_df is Non
-000401b0: 6520 656c 7365 206d 6574 615f 6672 616d  e else meta_fram
-000401c0: 655f 636f 6e73 7472 7563 746f 7228 6c69  e_constructor(li
-000401d0: 6b65 5f64 6629 2928 0a20 2020 2020 2020  ke_df))(.       
-000401e0: 206d 6174 2c20 636f 6c75 6d6e 733d 636f   mat, columns=co
-000401f0: 6c73 2c20 696e 6465 783d 636f 6c73 0a20  ls, index=cols. 
-00040200: 2020 2029 0a0a 0a64 6566 2070 645f 7370     )...def pd_sp
-00040210: 6c69 7428 6466 2c20 702c 2072 616e 646f  lit(df, p, rando
-00040220: 6d5f 7374 6174 653d 4e6f 6e65 2c20 7368  m_state=None, sh
-00040230: 7566 666c 653d 4661 6c73 6529 3a0a 2020  uffle=False):.  
-00040240: 2020 2222 2253 706c 6974 2044 6174 6146    """Split DataF
-00040250: 7261 6d65 2069 6e74 6f20 6d75 6c74 6970  rame into multip
-00040260: 6c65 2070 6965 6365 7320 7073 6575 646f  le pieces pseudo
-00040270: 7261 6e64 6f6d 6c79 0a0a 2020 2020 3e3e  randomly..    >>
-00040280: 3e20 6466 203d 2070 642e 4461 7461 4672  > df = pd.DataFr
-00040290: 616d 6528 7b27 6127 3a20 5b31 2c20 322c  ame({'a': [1, 2,
-000402a0: 2033 2c20 342c 2035 2c20 365d 2c0a 2020   3, 4, 5, 6],.  
-000402b0: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-000402c0: 2020 2020 2020 2020 2027 6227 3a20 5b32           'b': [2
-000402d0: 2c20 332c 2034 2c20 352c 2036 2c20 375d  , 3, 4, 5, 6, 7]
-000402e0: 7d29 0a0a 2020 2020 3e3e 3e20 612c 2062  })..    >>> a, b
-000402f0: 203d 2070 645f 7370 6c69 7428 0a20 2020   = pd_split(.   
-00040300: 202e 2e2e 2020 2020 2064 662c 205b 302e   ...     df, [0.
-00040310: 352c 2030 2e35 5d2c 2072 616e 646f 6d5f  5, 0.5], random_
-00040320: 7374 6174 653d 3132 332c 2073 6875 6666  state=123, shuff
-00040330: 6c65 3d54 7275 650a 2020 2020 2e2e 2e20  le=True.    ... 
-00040340: 2920 2023 2072 6f75 6768 6c79 2035 302f  )  # roughly 50/
-00040350: 3530 2073 706c 6974 0a20 2020 203e 3e3e  50 split.    >>>
-00040360: 2061 0a20 2020 2020 2020 6120 2062 0a20   a.       a  b. 
-00040370: 2020 2033 2020 3420 2035 0a20 2020 2030     3  4  5.    0
-00040380: 2020 3120 2032 0a20 2020 2035 2020 3620    1  2.    5  6 
-00040390: 2037 0a20 2020 203e 3e3e 2062 0a20 2020   7.    >>> b.   
-000403a0: 2020 2020 6120 2062 0a20 2020 2031 2020      a  b.    1  
-000403b0: 3220 2033 0a20 2020 2034 2020 3520 2036  2  3.    4  5  6
-000403c0: 0a20 2020 2032 2020 3320 2034 0a20 2020  .    2  3  4.   
-000403d0: 2022 2222 0a20 2020 2070 203d 206c 6973   """.    p = lis
-000403e0: 7428 7029 0a20 2020 2069 6620 7368 7566  t(p).    if shuf
-000403f0: 666c 653a 0a20 2020 2020 2020 2069 6620  fle:.        if 
-00040400: 6e6f 7420 6973 696e 7374 616e 6365 2872  not isinstance(r
-00040410: 616e 646f 6d5f 7374 6174 652c 206e 702e  andom_state, np.
-00040420: 7261 6e64 6f6d 2e52 616e 646f 6d53 7461  random.RandomSta
-00040430: 7465 293a 0a20 2020 2020 2020 2020 2020  te):.           
-00040440: 2072 616e 646f 6d5f 7374 6174 6520 3d20   random_state = 
-00040450: 6e70 2e72 616e 646f 6d2e 5261 6e64 6f6d  np.random.Random
-00040460: 5374 6174 6528 7261 6e64 6f6d 5f73 7461  State(random_sta
-00040470: 7465 290a 2020 2020 2020 2020 6466 203d  te).        df =
-00040480: 2064 662e 7361 6d70 6c65 2866 7261 633d   df.sample(frac=
-00040490: 312e 302c 2072 616e 646f 6d5f 7374 6174  1.0, random_stat
-000404a0: 653d 7261 6e64 6f6d 5f73 7461 7465 290a  e=random_state).
-000404b0: 2020 2020 696e 6465 7820 3d20 7073 6575      index = pseu
-000404c0: 646f 7261 6e64 6f6d 286c 656e 2864 6629  dorandom(len(df)
-000404d0: 2c20 702c 2072 616e 646f 6d5f 7374 6174  , p, random_stat
-000404e0: 6529 0a20 2020 2072 6574 7572 6e20 5b64  e).    return [d
-000404f0: 662e 696c 6f63 5b69 6e64 6578 203d 3d20  f.iloc[index == 
-00040500: 695d 2066 6f72 2069 2069 6e20 7261 6e67  i] for i in rang
-00040510: 6528 6c65 6e28 7029 295d 0a0a 0a64 6566  e(len(p))]...def
-00040520: 205f 7461 6b65 5f6c 6173 7428 612c 2073   _take_last(a, s
-00040530: 6b69 706e 613d 5472 7565 293a 0a20 2020  kipna=True):.   
-00040540: 2022 2222 0a20 2020 2074 616b 6520 6c61   """.    take la
-00040550: 7374 2072 6f77 2028 5365 7269 6573 2920  st row (Series) 
-00040560: 6f66 2044 6174 6146 7261 6d65 202f 206c  of DataFrame / l
-00040570: 6173 7420 7661 6c75 6520 6f66 2053 6572  ast value of Ser
-00040580: 6965 730a 2020 2020 636f 6e73 6964 6572  ies.    consider
-00040590: 696e 6720 4e61 4e2e 0a0a 2020 2020 5061  ing NaN...    Pa
-000405a0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-000405b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6120 3a20  -------.    a : 
-000405c0: 7064 2e44 6174 6146 7261 6d65 206f 7220  pd.DataFrame or 
-000405d0: 7064 2e53 6572 6965 730a 2020 2020 736b  pd.Series.    sk
-000405e0: 6970 6e61 203a 2062 6f6f 6c2c 2064 6566  ipna : bool, def
-000405f0: 6175 6c74 2054 7275 650a 2020 2020 2020  ault True.      
-00040600: 2020 5768 6574 6865 7220 746f 2065 7863    Whether to exc
-00040610: 6c75 6465 204e 614e 0a0a 2020 2020 2222  lude NaN..    ""
-00040620: 220a 0a20 2020 2064 6566 205f 6c61 7374  "..    def _last
-00040630: 5f76 616c 6964 2873 293a 0a20 2020 2020  _valid(s):.     
-00040640: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-00040650: 6528 312c 206d 696e 2831 302c 206c 656e  e(1, min(10, len
-00040660: 2873 2920 2b20 3129 293a 0a20 2020 2020  (s) + 1)):.     
-00040670: 2020 2020 2020 2076 616c 203d 2073 2e69         val = s.i
-00040680: 6c6f 635b 2d69 5d0a 2020 2020 2020 2020  loc[-i].        
-00040690: 2020 2020 6966 206e 6f74 2070 642e 6973      if not pd.is
-000406a0: 6e75 6c6c 2876 616c 293a 0a20 2020 2020  null(val):.     
-000406b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000406c0: 6e20 7661 6c0a 2020 2020 2020 2020 656c  n val.        el
-000406d0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000406e0: 6e6f 6e6e 756c 6c20 3d20 735b 732e 6e6f  nonnull = s[s.no
-000406f0: 746e 6128 295d 0a20 2020 2020 2020 2020  tna()].         
-00040700: 2020 2069 6620 6e6f 7420 6e6f 6e6e 756c     if not nonnul
-00040710: 6c2e 656d 7074 793a 0a20 2020 2020 2020  l.empty:.       
-00040720: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00040730: 6e6f 6e6e 756c 6c2e 696c 6f63 5b2d 315d  nonnull.iloc[-1]
-00040740: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00040750: 4e6f 6e65 0a0a 2020 2020 6966 2073 6b69  None..    if ski
-00040760: 706e 6120 6973 2046 616c 7365 3a0a 2020  pna is False:.  
-00040770: 2020 2020 2020 7265 7475 726e 2061 2e69        return a.i
-00040780: 6c6f 635b 2d31 5d0a 2020 2020 656c 7365  loc[-1].    else
-00040790: 3a0a 2020 2020 2020 2020 2320 7461 6b65  :.        # take
-000407a0: 206c 6173 7420 7661 6c69 6420 7661 6c75   last valid valu
-000407b0: 6520 6578 636c 7564 696e 6720 4e61 4e2c  e excluding NaN,
-000407c0: 204e 614e 206c 6f63 6174 696f 6e20 6d61   NaN location ma
-000407d0: 7920 6265 2064 6966 6665 7265 6e74 0a20  y be different. 
-000407e0: 2020 2020 2020 2023 2069 6e20 6561 6368         # in each
-000407f0: 2063 6f6c 756d 6e0a 2020 2020 2020 2020   column.        
-00040800: 6966 2069 735f 6461 7461 6672 616d 655f  if is_dataframe_
-00040810: 6c69 6b65 2861 293a 0a20 2020 2020 2020  like(a):.       
-00040820: 2020 2020 2023 2063 7265 6174 6520 5365       # create Se
-00040830: 7269 6573 2066 726f 6d20 6170 7072 6f70  ries from approp
-00040840: 7269 6174 6520 6261 636b 656e 6420 6461  riate backend da
-00040850: 7461 6672 616d 6520 6c69 6272 6172 790a  taframe library.
-00040860: 2020 2020 2020 2020 2020 2020 7365 7269              seri
-00040870: 6573 5f74 7970 203d 2074 7970 6528 612e  es_typ = type(a.
-00040880: 696c 6f63 5b30 3a31 2c20 305d 290a 2020  iloc[0:1, 0]).  
-00040890: 2020 2020 2020 2020 2020 6966 2061 2e65            if a.e
-000408a0: 6d70 7479 3a0a 2020 2020 2020 2020 2020  mpty:.          
-000408b0: 2020 2020 2020 7265 7475 726e 2073 6572        return ser
-000408c0: 6965 735f 7479 7028 5b5d 2c20 6474 7970  ies_typ([], dtyp
-000408d0: 653d 2266 6c6f 6174 2229 0a20 2020 2020  e="float").     
-000408e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000408f0: 7269 6573 5f74 7970 280a 2020 2020 2020  ries_typ(.      
-00040900: 2020 2020 2020 2020 2020 5b5f 6c61 7374            [_last
-00040910: 5f76 616c 6964 2861 2e69 6c6f 635b 3a2c  _valid(a.iloc[:,
-00040920: 2069 5d29 2066 6f72 2069 2069 6e20 7261   i]) for i in ra
-00040930: 6e67 6528 6c65 6e28 612e 636f 6c75 6d6e  nge(len(a.column
-00040940: 7329 295d 2c0a 2020 2020 2020 2020 2020  s))],.          
-00040950: 2020 2020 2020 696e 6465 783d 612e 636f        index=a.co
-00040960: 6c75 6d6e 732c 0a20 2020 2020 2020 2020  lumns,.         
-00040970: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
-00040980: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00040990: 6574 7572 6e20 5f6c 6173 745f 7661 6c69  eturn _last_vali
-000409a0: 6428 6129 0a0a 0a64 6566 2063 6865 636b  d(a)...def check
-000409b0: 5f64 6976 6973 696f 6e73 2864 6976 6973  _divisions(divis
-000409c0: 696f 6e73 293a 0a20 2020 2069 6620 6e6f  ions):.    if no
-000409d0: 7420 6973 696e 7374 616e 6365 2864 6976  t isinstance(div
-000409e0: 6973 696f 6e73 2c20 286c 6973 742c 2074  isions, (list, t
-000409f0: 7570 6c65 2929 3a0a 2020 2020 2020 2020  uple)):.        
-00040a00: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00040a10: 2822 4e65 7720 6469 7669 7369 6f6e 206d  ("New division m
-00040a20: 7573 7420 6265 206c 6973 7420 6f72 2074  ust be list or t
-00040a30: 7570 6c65 2229 0a20 2020 2064 6976 6973  uple").    divis
-00040a40: 696f 6e73 203d 206c 6973 7428 6469 7669  ions = list(divi
-00040a50: 7369 6f6e 7329 0a20 2020 2069 6620 6c65  sions).    if le
-00040a60: 6e28 6469 7669 7369 6f6e 7329 203d 3d20  n(divisions) == 
-00040a70: 303a 0a20 2020 2020 2020 2072 6169 7365  0:.        raise
-00040a80: 2056 616c 7565 4572 726f 7228 224e 6577   ValueError("New
-00040a90: 2064 6976 6973 696f 6e20 6d75 7374 206e   division must n
-00040aa0: 6f74 2062 6520 656d 7074 7922 290a 2020  ot be empty").  
-00040ab0: 2020 6966 2064 6976 6973 696f 6e73 2021    if divisions !
-00040ac0: 3d20 736f 7274 6564 2864 6976 6973 696f  = sorted(divisio
-00040ad0: 6e73 293a 0a20 2020 2020 2020 2072 6169  ns):.        rai
-00040ae0: 7365 2056 616c 7565 4572 726f 7228 224e  se ValueError("N
-00040af0: 6577 2064 6976 6973 696f 6e20 6d75 7374  ew division must
-00040b00: 2062 6520 736f 7274 6564 2229 0a20 2020   be sorted").   
-00040b10: 2069 6620 6c65 6e28 6469 7669 7369 6f6e   if len(division
-00040b20: 735b 3a2d 315d 2920 213d 206c 656e 286c  s[:-1]) != len(l
-00040b30: 6973 7428 756e 6971 7565 2864 6976 6973  ist(unique(divis
-00040b40: 696f 6e73 5b3a 2d31 5d29 2929 3a0a 2020  ions[:-1]))):.  
-00040b50: 2020 2020 2020 6d73 6720 3d20 224e 6577        msg = "New
-00040b60: 2064 6976 6973 696f 6e20 6d75 7374 2062   division must b
-00040b70: 6520 756e 6971 7565 2c20 6578 6365 7074  e unique, except
-00040b80: 2066 6f72 2074 6865 206c 6173 7420 656c   for the last el
-00040b90: 656d 656e 7422 0a20 2020 2020 2020 2072  ement".        r
-00040ba0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00040bb0: 6d73 6729 0a0a 0a64 6566 2072 6570 6172  msg)...def repar
-00040bc0: 7469 7469 6f6e 5f64 6976 6973 696f 6e73  tition_divisions
-00040bd0: 2861 2c20 622c 206e 616d 652c 206f 7574  (a, b, name, out
-00040be0: 312c 206f 7574 322c 2066 6f72 6365 3d46  1, out2, force=F
-00040bf0: 616c 7365 293a 0a20 2020 2022 2222 6461  alse):.    """da
-00040c00: 736b 2067 7261 7068 2074 6f20 7265 7061  sk graph to repa
-00040c10: 7274 6974 696f 6e20 6461 7461 6672 616d  rtition datafram
-00040c20: 6520 6279 206e 6577 2064 6976 6973 696f  e by new divisio
-00040c30: 6e73 0a0a 2020 2020 5061 7261 6d65 7465  ns..    Paramete
-00040c40: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00040c50: 2d0a 2020 2020 6120 3a20 7475 706c 650a  -.    a : tuple.
-00040c60: 2020 2020 2020 2020 6f6c 6420 6469 7669          old divi
-00040c70: 7369 6f6e 730a 2020 2020 6220 3a20 7475  sions.    b : tu
-00040c80: 706c 652c 206c 6973 746d 7970 790a 2020  ple, listmypy.  
-00040c90: 2020 6f75 7432 203a 2073 7472 0a20 2020    out2 : str.   
-00040ca0: 2020 2020 206e 616d 6520 6f66 206e 6577       name of new
-00040cb0: 2064 6174 6166 7261 6d65 0a20 2020 2066   dataframe.    f
-00040cc0: 6f72 6365 203a 2062 6f6f 6c2c 2064 6566  orce : bool, def
-00040cd0: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
-00040ce0: 2020 2041 6c6c 6f77 7320 7468 6520 6578     Allows the ex
-00040cf0: 7061 6e73 696f 6e20 6f66 2074 6865 2065  pansion of the e
-00040d00: 7869 7374 696e 6720 6469 7669 7369 6f6e  xisting division
-00040d10: 732e 0a20 2020 2020 2020 2049 6620 4661  s..        If Fa
-00040d20: 6c73 6520 7468 656e 2074 6865 206e 6577  lse then the new
-00040d30: 2064 6976 6973 696f 6e73 206c 6f77 6572   divisions lower
-00040d40: 2061 6e64 2075 7070 6572 2062 6f75 6e64   and upper bound
-00040d50: 7320 6d75 7374 2062 650a 2020 2020 2020  s must be.      
-00040d60: 2020 7468 6520 7361 6d65 2061 7320 7468    the same as th
-00040d70: 6520 6f6c 6420 6469 7669 7369 6f6e 732e  e old divisions.
-00040d80: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
-00040d90: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00040da0: 3e3e 3e20 6672 6f6d 2070 7072 696e 7420  >>> from pprint 
-00040db0: 696d 706f 7274 2070 7072 696e 740a 2020  import pprint.  
-00040dc0: 2020 3e3e 3e20 7070 7269 6e74 2872 6570    >>> pprint(rep
-00040dd0: 6172 7469 7469 6f6e 5f64 6976 6973 696f  artition_divisio
-00040de0: 6e73 285b 312c 2033 2c20 375d 2c20 5b31  ns([1, 3, 7], [1
-00040df0: 2c20 342c 2036 2c20 375d 2c20 2761 272c  , 4, 6, 7], 'a',
-00040e00: 2027 6227 2c20 2763 2729 2920 2023 2064   'b', 'c'))  # d
-00040e10: 6f63 7465 7374 3a20 2b45 4c4c 4950 5349  octest: +ELLIPSI
-00040e20: 530a 2020 2020 7b28 2762 272c 2030 293a  S.    {('b', 0):
-00040e30: 2028 3c66 756e 6374 696f 6e20 626f 756e   (<function boun
-00040e40: 6461 7279 5f73 6c69 6365 2061 7420 2e2e  dary_slice at ..
-00040e50: 2e3e 2c20 2827 6127 2c20 3029 2c20 312c  .>, ('a', 0), 1,
-00040e60: 2033 2c20 4661 6c73 6529 2c0a 2020 2020   3, False),.    
-00040e70: 2028 2762 272c 2031 293a 2028 3c66 756e   ('b', 1): (<fun
-00040e80: 6374 696f 6e20 626f 756e 6461 7279 5f73  ction boundary_s
-00040e90: 6c69 6365 2061 7420 2e2e 2e3e 2c20 2827  lice at ...>, ('
-00040ea0: 6127 2c20 3129 2c20 332c 2034 2c20 4661  a', 1), 3, 4, Fa
-00040eb0: 6c73 6529 2c0a 2020 2020 2028 2762 272c  lse),.     ('b',
-00040ec0: 2032 293a 2028 3c66 756e 6374 696f 6e20   2): (<function 
-00040ed0: 626f 756e 6461 7279 5f73 6c69 6365 2061  boundary_slice a
-00040ee0: 7420 2e2e 2e3e 2c20 2827 6127 2c20 3129  t ...>, ('a', 1)
-00040ef0: 2c20 342c 2036 2c20 4661 6c73 6529 2c0a  , 4, 6, False),.
-00040f00: 2020 2020 2028 2762 272c 2033 293a 2028       ('b', 3): (
-00040f10: 3c66 756e 6374 696f 6e20 626f 756e 6461  <function bounda
-00040f20: 7279 5f73 6c69 6365 2061 7420 2e2e 2e3e  ry_slice at ...>
-00040f30: 2c20 2827 6127 2c20 3129 2c20 362c 2037  , ('a', 1), 6, 7
-00040f40: 2c20 5472 7565 292c 0a20 2020 2020 2827  , True),.     ('
-00040f50: 6327 2c20 3029 3a20 283c 6675 6e63 7469  c', 0): (<functi
-00040f60: 6f6e 2063 6f6e 6361 7420 6174 202e 2e2e  on concat at ...
-00040f70: 3e2c 205b 2827 6227 2c20 3029 2c20 2827  >, [('b', 0), ('
-00040f80: 6227 2c20 3129 5d29 2c0a 2020 2020 2028  b', 1)]),.     (
-00040f90: 2763 272c 2031 293a 2028 2762 272c 2032  'c', 1): ('b', 2
-00040fa0: 292c 0a20 2020 2020 2827 6327 2c20 3229  ),.     ('c', 2)
-00040fb0: 3a20 2827 6227 2c20 3329 7d0a 2020 2020  : ('b', 3)}.    
-00040fc0: 2222 220a 2020 2020 6368 6563 6b5f 6469  """.    check_di
-00040fd0: 7669 7369 6f6e 7328 6229 0a0a 2020 2020  visions(b)..    
-00040fe0: 6966 206c 656e 2862 2920 3c20 323a 0a20  if len(b) < 2:. 
-00040ff0: 2020 2020 2020 2023 206d 696e 696d 756d         # minimum
-00041000: 2064 6976 6973 696f 6e20 6973 2032 2065   division is 2 e
-00041010: 6c65 6d65 6e74 732c 206c 696b 6520 5b30  lements, like [0
-00041020: 2c20 305d 0a20 2020 2020 2020 2072 6169  , 0].        rai
-00041030: 7365 2056 616c 7565 4572 726f 7228 224e  se ValueError("N
-00041040: 6577 2064 6976 6973 696f 6e20 6d75 7374  ew division must
-00041050: 2062 6520 6c6f 6e67 6572 2074 6861 6e20   be longer than 
-00041060: 3220 656c 656d 656e 7473 2229 0a0a 2020  2 elements")..  
-00041070: 2020 6966 2066 6f72 6365 3a0a 2020 2020    if force:.    
-00041080: 2020 2020 6966 2061 5b30 5d20 3c20 625b      if a[0] < b[
-00041090: 305d 3a0a 2020 2020 2020 2020 2020 2020  0]:.            
-000410a0: 6d73 6720 3d20 280a 2020 2020 2020 2020  msg = (.        
-000410b0: 2020 2020 2020 2020 226c 6566 7420 7369          "left si
-000410c0: 6465 206f 6620 7468 6520 6e65 7720 6469  de of the new di
-000410d0: 7669 7369 6f6e 206d 7573 7420 6265 2065  vision must be e
-000410e0: 7175 616c 206f 7220 736d 616c 6c65 7220  qual or smaller 
-000410f0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00041100: 2020 2274 6861 6e20 6f6c 6420 6469 7669    "than old divi
-00041110: 7369 6f6e 220a 2020 2020 2020 2020 2020  sion".          
-00041120: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00041130: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00041140: 286d 7367 290a 2020 2020 2020 2020 6966  (msg).        if
-00041150: 2061 5b2d 315d 203e 2062 5b2d 315d 3a0a   a[-1] > b[-1]:.
-00041160: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
-00041170: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00041180: 2020 2020 2272 6967 6874 2073 6964 6520      "right side 
-00041190: 6f66 2074 6865 206e 6577 2064 6976 6973  of the new divis
-000411a0: 696f 6e20 6d75 7374 2062 6520 6571 7561  ion must be equa
-000411b0: 6c20 6f72 206c 6172 6765 7220 220a 2020  l or larger ".  
-000411c0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
-000411d0: 6861 6e20 6f6c 6420 6469 7669 7369 6f6e  han old division
-000411e0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-000411f0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00041200: 6520 5661 6c75 6545 7272 6f72 286d 7367  e ValueError(msg
-00041210: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
-00041220: 2020 2020 6966 2061 5b30 5d20 213d 2062      if a[0] != b
-00041230: 5b30 5d3a 0a20 2020 2020 2020 2020 2020  [0]:.           
-00041240: 206d 7367 203d 2022 6c65 6674 2073 6964   msg = "left sid
-00041250: 6520 6f66 206f 6c64 2061 6e64 206e 6577  e of old and new
-00041260: 2064 6976 6973 696f 6e73 2061 7265 2064   divisions are d
-00041270: 6966 6665 7265 6e74 220a 2020 2020 2020  ifferent".      
-00041280: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00041290: 6545 7272 6f72 286d 7367 290a 2020 2020  eError(msg).    
-000412a0: 2020 2020 6966 2061 5b2d 315d 2021 3d20      if a[-1] != 
-000412b0: 625b 2d31 5d3a 0a20 2020 2020 2020 2020  b[-1]:.         
-000412c0: 2020 206d 7367 203d 2022 7269 6768 7420     msg = "right 
-000412d0: 7369 6465 206f 6620 6f6c 6420 616e 6420  side of old and 
-000412e0: 6e65 7720 6469 7669 7369 6f6e 7320 6172  new divisions ar
-000412f0: 6520 6469 6666 6572 656e 7422 0a20 2020  e different".   
-00041300: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00041310: 616c 7565 4572 726f 7228 6d73 6729 0a0a  alueError(msg)..
-00041320: 2020 2020 6465 6620 5f69 735f 7369 6e67      def _is_sing
-00041330: 6c65 5f6c 6173 745f 6469 7628 7829 3a0a  le_last_div(x):.
-00041340: 2020 2020 2020 2020 2222 2257 6865 7468          """Wheth
-00041350: 6572 206c 6173 7420 6469 7669 7369 6f6e  er last division
-00041360: 206f 6e6c 7920 636f 6e74 6169 6e73 2073   only contains s
-00041370: 696e 676c 6520 6c61 6265 6c22 2222 0a20  ingle label""". 
-00041380: 2020 2020 2020 2072 6574 7572 6e20 6c65         return le
-00041390: 6e28 7829 203e 3d20 3220 616e 6420 785b  n(x) >= 2 and x[
-000413a0: 2d31 5d20 3d3d 2078 5b2d 325d 0a0a 2020  -1] == x[-2]..  
-000413b0: 2020 6320 3d20 5b61 5b30 5d5d 0a20 2020    c = [a[0]].   
-000413c0: 2064 203d 2064 6963 7428 290a 2020 2020   d = dict().    
-000413d0: 6c6f 7720 3d20 615b 305d 0a0a 2020 2020  low = a[0]..    
-000413e0: 692c 206a 203d 2031 2c20 3120 2023 2069  i, j = 1, 1  # i
-000413f0: 6e64 6963 6573 2066 6f72 206f 6c64 2f6e  ndices for old/n
-00041400: 6577 2064 6976 6973 696f 6e73 0a20 2020  ew divisions.   
-00041410: 206b 203d 2030 2020 2320 696e 6465 7820   k = 0  # index 
-00041420: 666f 7220 7465 6d70 2064 6976 6973 696f  for temp divisio
-00041430: 6e73 0a0a 2020 2020 6c61 7374 5f65 6c65  ns..    last_ele
-00041440: 6d20 3d20 5f69 735f 7369 6e67 6c65 5f6c  m = _is_single_l
-00041450: 6173 745f 6469 7628 6129 0a0a 2020 2020  ast_div(a)..    
-00041460: 2320 7072 6f63 6573 7320 7468 726f 7567  # process throug
-00041470: 6820 6f6c 6420 6469 7669 7369 6f6e 0a20  h old division. 
-00041480: 2020 2023 206c 6566 7420 7061 7274 206f     # left part o
-00041490: 6620 6e65 7720 6469 7669 7369 6f6e 2063  f new division c
-000414a0: 616e 2062 6520 7072 6f63 6573 7365 6420  an be processed 
-000414b0: 696e 2074 6869 7320 6c6f 6f70 0a20 2020  in this loop.   
-000414c0: 2077 6869 6c65 2069 203c 206c 656e 2861   while i < len(a
-000414d0: 2920 616e 6420 6a20 3c20 6c65 6e28 6229  ) and j < len(b)
-000414e0: 3a0a 2020 2020 2020 2020 6966 2061 5b69  :.        if a[i
-000414f0: 5d20 3c20 625b 6a5d 3a0a 2020 2020 2020  ] < b[j]:.      
-00041500: 2020 2020 2020 2320 7475 706c 6520 6973        # tuple is
-00041510: 2073 6f6d 6574 6869 6e67 206c 696b 653a   something like:
-00041520: 0a20 2020 2020 2020 2020 2020 2023 2028  .            # (
-00041530: 6d65 7468 6f64 732e 626f 756e 6461 7279  methods.boundary
-00041540: 5f73 6c69 6365 2c20 2827 6672 6f6d 5f70  _slice, ('from_p
-00041550: 616e 6461 732d 2327 2c20 3029 2c20 332c  andas-#', 0), 3,
-00041560: 2034 2c20 4661 6c73 6529 290a 2020 2020   4, False)).    
-00041570: 2020 2020 2020 2020 645b 286f 7574 312c          d[(out1,
-00041580: 206b 295d 203d 2028 6d65 7468 6f64 732e   k)] = (methods.
-00041590: 626f 756e 6461 7279 5f73 6c69 6365 2c20  boundary_slice, 
-000415a0: 286e 616d 652c 2069 202d 2031 292c 206c  (name, i - 1), l
-000415b0: 6f77 2c20 615b 695d 2c20 4661 6c73 6529  ow, a[i], False)
-000415c0: 0a20 2020 2020 2020 2020 2020 206c 6f77  .            low
-000415d0: 203d 2061 5b69 5d0a 2020 2020 2020 2020   = a[i].        
-000415e0: 2020 2020 6920 2b3d 2031 0a20 2020 2020      i += 1.     
-000415f0: 2020 2065 6c69 6620 615b 695d 203e 2062     elif a[i] > b
-00041600: 5b6a 5d3a 0a20 2020 2020 2020 2020 2020  [j]:.           
-00041610: 2064 5b28 6f75 7431 2c20 6b29 5d20 3d20   d[(out1, k)] = 
-00041620: 286d 6574 686f 6473 2e62 6f75 6e64 6172  (methods.boundar
-00041630: 795f 736c 6963 652c 2028 6e61 6d65 2c20  y_slice, (name, 
-00041640: 6920 2d20 3129 2c20 6c6f 772c 2062 5b6a  i - 1), low, b[j
-00041650: 5d2c 2046 616c 7365 290a 2020 2020 2020  ], False).      
-00041660: 2020 2020 2020 6c6f 7720 3d20 625b 6a5d        low = b[j]
-00041670: 0a20 2020 2020 2020 2020 2020 206a 202b  .            j +
-00041680: 3d20 310a 2020 2020 2020 2020 656c 7365  = 1.        else
-00041690: 3a0a 2020 2020 2020 2020 2020 2020 645b  :.            d[
-000416a0: 286f 7574 312c 206b 295d 203d 2028 6d65  (out1, k)] = (me
-000416b0: 7468 6f64 732e 626f 756e 6461 7279 5f73  thods.boundary_s
-000416c0: 6c69 6365 2c20 286e 616d 652c 2069 202d  lice, (name, i -
-000416d0: 2031 292c 206c 6f77 2c20 625b 6a5d 2c20   1), low, b[j], 
-000416e0: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
-000416f0: 2020 206c 6f77 203d 2062 5b6a 5d0a 2020     low = b[j].  
-00041700: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00041710: 2861 2920 3d3d 2069 202b 2031 206f 7220  (a) == i + 1 or 
-00041720: 615b 695d 203c 2061 5b69 202b 2031 5d3a  a[i] < a[i + 1]:
-00041730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00041740: 206a 202b 3d20 310a 2020 2020 2020 2020   j += 1.        
-00041750: 2020 2020 6920 2b3d 2031 0a20 2020 2020      i += 1.     
-00041760: 2020 2063 2e61 7070 656e 6428 6c6f 7729     c.append(low)
-00041770: 0a20 2020 2020 2020 206b 202b 3d20 310a  .        k += 1.
-00041780: 0a20 2020 2023 2072 6967 6874 2070 6172  .    # right par
-00041790: 7420 6f66 206e 6577 2064 6976 6973 696f  t of new divisio
-000417a0: 6e20 6361 6e20 7265 6d61 696e 0a20 2020  n can remain.   
-000417b0: 2069 6620 615b 2d31 5d20 3c20 625b 2d31   if a[-1] < b[-1
-000417c0: 5d20 6f72 2062 5b2d 315d 203d 3d20 625b  ] or b[-1] == b[
-000417d0: 2d32 5d3a 0a20 2020 2020 2020 2066 6f72  -2]:.        for
-000417e0: 205f 6a20 696e 2072 616e 6765 286a 2c20   _j in range(j, 
-000417f0: 6c65 6e28 6229 293a 0a20 2020 2020 2020  len(b)):.       
-00041800: 2020 2020 2023 2061 6c77 6179 7320 7573       # always us
-00041810: 6520 7269 6768 742d 6d6f 7374 206f 6620  e right-most of 
-00041820: 6f6c 6420 6469 7669 7369 6f6e 0a20 2020  old division.   
-00041830: 2020 2020 2020 2020 2023 2062 6563 6175           # becau
-00041840: 7365 2069 7420 6d61 7920 636f 6e74 6169  se it may contai
-00041850: 6e20 6c61 7374 2065 6c65 6d65 6e74 0a20  n last element. 
-00041860: 2020 2020 2020 2020 2020 206d 203d 206c             m = l
-00041870: 656e 2861 2920 2d20 320a 2020 2020 2020  en(a) - 2.      
-00041880: 2020 2020 2020 645b 286f 7574 312c 206b        d[(out1, k
-00041890: 295d 203d 2028 6d65 7468 6f64 732e 626f  )] = (methods.bo
-000418a0: 756e 6461 7279 5f73 6c69 6365 2c20 286e  undary_slice, (n
-000418b0: 616d 652c 206d 292c 206c 6f77 2c20 625b  ame, m), low, b[
-000418c0: 5f6a 5d2c 2046 616c 7365 290a 2020 2020  _j], False).    
-000418d0: 2020 2020 2020 2020 6c6f 7720 3d20 625b          low = b[
-000418e0: 5f6a 5d0a 2020 2020 2020 2020 2020 2020  _j].            
-000418f0: 632e 6170 7065 6e64 286c 6f77 290a 2020  c.append(low).  
-00041900: 2020 2020 2020 2020 2020 6b20 2b3d 2031            k += 1
-00041910: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-00041920: 2020 2023 2065 7665 6e20 6966 206e 6577     # even if new
-00041930: 2064 6976 6973 696f 6e20 6973 2070 726f   division is pro
-00041940: 6365 7373 6564 2074 6872 6f75 6768 2c0a  cessed through,.
-00041950: 2020 2020 2020 2020 2320 7269 6768 742d          # right-
-00041960: 6d6f 7374 2065 6c65 6d65 6e74 206f 6620  most element of 
-00041970: 6f6c 6420 6469 7669 7369 6f6e 2063 616e  old division can
-00041980: 2072 656d 6169 6e0a 2020 2020 2020 2020   remain.        
-00041990: 6966 206c 6173 745f 656c 656d 2061 6e64  if last_elem and
-000419a0: 2069 203c 206c 656e 2861 293a 0a20 2020   i < len(a):.   
-000419b0: 2020 2020 2020 2020 2064 5b28 6f75 7431           d[(out1
-000419c0: 2c20 6b29 5d20 3d20 286d 6574 686f 6473  , k)] = (methods
-000419d0: 2e62 6f75 6e64 6172 795f 736c 6963 652c  .boundary_slice,
-000419e0: 2028 6e61 6d65 2c20 6920 2d20 3129 2c20   (name, i - 1), 
-000419f0: 615b 695d 2c20 615b 695d 2c20 4661 6c73  a[i], a[i], Fals
-00041a00: 6529 0a20 2020 2020 2020 2020 2020 206b  e).            k
-00041a10: 202b 3d20 310a 2020 2020 2020 2020 632e   += 1.        c.
-00041a20: 6170 7065 6e64 2861 5b2d 315d 290a 0a20  append(a[-1]).. 
-00041a30: 2020 2023 2072 6570 6c61 6365 206c 6173     # replace las
-00041a40: 7420 656c 656d 656e 7420 6f66 2074 7570  t element of tup
-00041a50: 6c65 2077 6974 6820 5472 7565 0a20 2020  le with True.   
-00041a60: 2064 5b28 6f75 7431 2c20 6b20 2d20 3129   d[(out1, k - 1)
-00041a70: 5d20 3d20 645b 286f 7574 312c 206b 202d  ] = d[(out1, k -
-00041a80: 2031 295d 5b3a 2d31 5d20 2b20 2854 7275   1)][:-1] + (Tru
-00041a90: 652c 290a 0a20 2020 2069 2c20 6a20 3d20  e,)..    i, j = 
-00041aa0: 302c 2031 0a0a 2020 2020 6c61 7374 5f65  0, 1..    last_e
-00041ab0: 6c65 6d20 3d20 5f69 735f 7369 6e67 6c65  lem = _is_single
-00041ac0: 5f6c 6173 745f 6469 7628 6329 0a0a 2020  _last_div(c)..  
-00041ad0: 2020 7768 696c 6520 6a20 3c20 6c65 6e28    while j < len(
-00041ae0: 6229 3a0a 2020 2020 2020 2020 746d 7020  b):.        tmp 
-00041af0: 3d20 5b5d 0a20 2020 2020 2020 2077 6869  = [].        whi
-00041b00: 6c65 2063 5b69 5d20 3c20 625b 6a5d 3a0a  le c[i] < b[j]:.
-00041b10: 2020 2020 2020 2020 2020 2020 746d 702e              tmp.
-00041b20: 6170 7065 6e64 2828 6f75 7431 2c20 6929  append((out1, i)
-00041b30: 290a 2020 2020 2020 2020 2020 2020 6920  ).            i 
-00041b40: 2b3d 2031 0a20 2020 2020 2020 2077 6869  += 1.        whi
-00041b50: 6c65 2028 0a20 2020 2020 2020 2020 2020  le (.           
-00041b60: 206c 6173 745f 656c 656d 0a20 2020 2020   last_elem.     
-00041b70: 2020 2020 2020 2061 6e64 2063 5b69 5d20         and c[i] 
-00041b80: 3d3d 2062 5b2d 315d 0a20 2020 2020 2020  == b[-1].       
-00041b90: 2020 2020 2061 6e64 2028 625b 2d31 5d20       and (b[-1] 
-00041ba0: 213d 2062 5b2d 325d 206f 7220 6a20 3d3d  != b[-2] or j ==
-00041bb0: 206c 656e 2862 2920 2d20 3129 0a20 2020   len(b) - 1).   
-00041bc0: 2020 2020 2020 2020 2061 6e64 2069 203c           and i <
-00041bd0: 206b 0a20 2020 2020 2020 2029 3a0a 2020   k.        ):.  
-00041be0: 2020 2020 2020 2020 2020 2320 6170 7065            # appe
-00041bf0: 6e64 2069 6620 6c61 7374 2073 706c 6974  nd if last split
-00041c00: 2069 7320 6e6f 7420 696e 636c 7564 6564   is not included
-00041c10: 0a20 2020 2020 2020 2020 2020 2074 6d70  .            tmp
-00041c20: 2e61 7070 656e 6428 286f 7574 312c 2069  .append((out1, i
-00041c30: 2929 0a20 2020 2020 2020 2020 2020 2069  )).            i
-00041c40: 202b 3d20 310a 2020 2020 2020 2020 6966   += 1.        if
-00041c50: 206c 656e 2874 6d70 2920 3d3d 2030 3a0a   len(tmp) == 0:.
-00041c60: 2020 2020 2020 2020 2020 2020 2320 6475              # du
-00041c70: 6d6d 7920 736c 6963 6520 746f 2072 6574  mmy slice to ret
-00041c80: 7572 6e20 656d 7074 7920 4461 7461 4672  urn empty DataFr
-00041c90: 616d 6520 6f72 2053 6572 6965 732c 0a20  ame or Series,. 
-00041ca0: 2020 2020 2020 2020 2020 2023 2077 6869             # whi
-00041cb0: 6368 2072 6574 6169 6e20 6f72 6967 696e  ch retain origin
-00041cc0: 616c 2064 6174 6120 6174 7472 6962 7574  al data attribut
-00041cd0: 6573 2028 636f 6c75 6d6e 7320 2f20 6e61  es (columns / na
-00041ce0: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
-00041cf0: 645b 286f 7574 322c 206a 202d 2031 295d  d[(out2, j - 1)]
-00041d00: 203d 2028 6d65 7468 6f64 732e 626f 756e   = (methods.boun
-00041d10: 6461 7279 5f73 6c69 6365 2c20 286e 616d  dary_slice, (nam
-00041d20: 652c 2030 292c 2061 5b30 5d2c 2061 5b30  e, 0), a[0], a[0
-00041d30: 5d2c 2046 616c 7365 290a 2020 2020 2020  ], False).      
-00041d40: 2020 656c 6966 206c 656e 2874 6d70 2920    elif len(tmp) 
-00041d50: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-00041d60: 2020 645b 286f 7574 322c 206a 202d 2031    d[(out2, j - 1
-00041d70: 295d 203d 2074 6d70 5b30 5d0a 2020 2020  )] = tmp[0].    
-00041d80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00041d90: 2020 2020 2020 6966 206e 6f74 2074 6d70        if not tmp
-00041da0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00041db0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00041dc0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00041dd0: 2020 2020 2020 2020 2263 6865 636b 2066          "check f
-00041de0: 6f72 2064 7570 6c69 6361 7465 2070 6172  or duplicate par
-00041df0: 7469 7469 6f6e 735c 6e6f 6c64 3a5c 6e25  titions\nold:\n%
-00041e00: 735c 6e5c 6e22 0a20 2020 2020 2020 2020  s\n\n".         
-00041e10: 2020 2020 2020 2020 2020 2022 6e65 773a             "new:
-00041e20: 5c6e 2573 5c6e 5c6e 636f 6d62 696e 6564  \n%s\n\ncombined
-00041e30: 3a5c 6e25 7322 2025 2028 7066 6f72 6d61  :\n%s" % (pforma
-00041e40: 7428 6129 2c20 7066 6f72 6d61 7428 6229  t(a), pformat(b)
-00041e50: 2c20 7066 6f72 6d61 7428 6329 290a 2020  , pformat(c)).  
-00041e60: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00041e70: 2020 2020 2020 2020 2020 2020 645b 286f              d[(o
-00041e80: 7574 322c 206a 202d 2031 295d 203d 2028  ut2, j - 1)] = (
-00041e90: 6d65 7468 6f64 732e 636f 6e63 6174 2c20  methods.concat, 
-00041ea0: 746d 7029 0a20 2020 2020 2020 206a 202b  tmp).        j +
-00041eb0: 3d20 310a 2020 2020 7265 7475 726e 2064  = 1.    return d
-00041ec0: 0a0a 0a64 6566 2072 6570 6172 7469 7469  ...def repartiti
-00041ed0: 6f6e 5f66 7265 7128 6466 2c20 6672 6571  on_freq(df, freq
-00041ee0: 3d4e 6f6e 6529 3a0a 2020 2020 2222 2252  =None):.    """R
-00041ef0: 6570 6172 7469 7469 6f6e 2061 2074 696d  epartition a tim
-00041f00: 6573 6572 6965 7320 6461 7461 6672 616d  eseries datafram
-00041f10: 6520 6279 2061 206e 6577 2066 7265 7175  e by a new frequ
-00041f20: 656e 6379 2222 220a 2020 2020 6966 206e  ency""".    if n
-00041f30: 6f74 2069 7369 6e73 7461 6e63 6528 6466  ot isinstance(df
-00041f40: 2e64 6976 6973 696f 6e73 5b30 5d2c 2070  .divisions[0], p
-00041f50: 642e 5469 6d65 7374 616d 7029 3a0a 2020  d.Timestamp):.  
-00041f60: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00041f70: 4572 726f 7228 2243 616e 206f 6e6c 7920  Error("Can only 
-00041f80: 7265 7061 7274 6974 696f 6e20 6f6e 2066  repartition on f
-00041f90: 7265 7175 656e 6379 2066 6f72 2074 696d  requency for tim
-00041fa0: 6573 6572 6965 7322 290a 0a20 2020 2066  eseries")..    f
-00041fb0: 7265 7120 3d20 5f6d 6170 5f66 7265 715f  req = _map_freq_
-00041fc0: 746f 5f70 6572 696f 645f 7374 6172 7428  to_period_start(
-00041fd0: 6672 6571 290a 0a20 2020 2074 7279 3a0a  freq)..    try:.
-00041fe0: 2020 2020 2020 2020 7374 6172 7420 3d20          start = 
-00041ff0: 6466 2e64 6976 6973 696f 6e73 5b30 5d2e  df.divisions[0].
-00042000: 6365 696c 2866 7265 7129 0a20 2020 2065  ceil(freq).    e
-00042010: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
-00042020: 3a0a 2020 2020 2020 2020 7374 6172 7420  :.        start 
-00042030: 3d20 6466 2e64 6976 6973 696f 6e73 5b30  = df.divisions[0
-00042040: 5d0a 2020 2020 6469 7669 7369 6f6e 7320  ].    divisions 
-00042050: 3d20 6d65 7468 6f64 732e 746f 6c69 7374  = methods.tolist
-00042060: 280a 2020 2020 2020 2020 7064 2e64 6174  (.        pd.dat
-00042070: 655f 7261 6e67 6528 7374 6172 743d 7374  e_range(start=st
-00042080: 6172 742c 2065 6e64 3d64 662e 6469 7669  art, end=df.divi
-00042090: 7369 6f6e 735b 2d31 5d2c 2066 7265 713d  sions[-1], freq=
-000420a0: 6672 6571 290a 2020 2020 290a 2020 2020  freq).    ).    
-000420b0: 6966 206e 6f74 206c 656e 2864 6976 6973  if not len(divis
-000420c0: 696f 6e73 293a 0a20 2020 2020 2020 2064  ions):.        d
-000420d0: 6976 6973 696f 6e73 203d 205b 6466 2e64  ivisions = [df.d
-000420e0: 6976 6973 696f 6e73 5b30 5d2c 2064 662e  ivisions[0], df.
-000420f0: 6469 7669 7369 6f6e 735b 2d31 5d5d 0a20  divisions[-1]]. 
-00042100: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00042110: 2064 6976 6973 696f 6e73 2e61 7070 656e   divisions.appen
-00042120: 6428 6466 2e64 6976 6973 696f 6e73 5b2d  d(df.divisions[-
-00042130: 315d 290a 2020 2020 2020 2020 6966 2064  1]).        if d
-00042140: 6976 6973 696f 6e73 5b30 5d20 213d 2064  ivisions[0] != d
-00042150: 662e 6469 7669 7369 6f6e 735b 305d 3a0a  f.divisions[0]:.
-00042160: 2020 2020 2020 2020 2020 2020 6469 7669              divi
-00042170: 7369 6f6e 7320 3d20 5b64 662e 6469 7669  sions = [df.divi
-00042180: 7369 6f6e 735b 305d 5d20 2b20 6469 7669  sions[0]] + divi
-00042190: 7369 6f6e 730a 0a20 2020 2072 6574 7572  sions..    retur
-000421a0: 6e20 6466 2e72 6570 6172 7469 7469 6f6e  n df.repartition
-000421b0: 2864 6976 6973 696f 6e73 3d64 6976 6973  (divisions=divis
-000421c0: 696f 6e73 290a 0a0a 6465 6620 5f6d 6170  ions)...def _map
-000421d0: 5f66 7265 715f 746f 5f70 6572 696f 645f  _freq_to_period_
-000421e0: 7374 6172 7428 6672 6571 293a 0a20 2020  start(freq):.   
-000421f0: 2022 2222 456e 7375 7265 2074 6861 7420   """Ensure that 
-00042200: 7468 6520 6672 6571 7565 6e63 7920 7065  the frequency pe
-00042210: 7274 6169 6e73 2074 6f20 7468 6520 2a2a  rtains to the **
-00042220: 7374 6172 742a 2a20 6f66 2061 2070 6572  start** of a per
-00042230: 696f 642e 0a0a 2020 2020 4966 2065 2e67  iod...    If e.g
-00042240: 2e20 6066 7265 713d 274d 2760 2c20 7468  . `freq='M'`, th
-00042250: 656e 2074 6865 2064 6976 6973 696f 6e73  en the divisions
-00042260: 2061 7265 3a0a 2020 2020 2020 2020 2d20   are:.        - 
-00042270: 3230 3231 2d33 312d 3120 3030 3a30 303a  2021-31-1 00:00:
-00042280: 3030 2028 7374 6172 7420 6f66 2046 6562  00 (start of Feb
-00042290: 7275 6172 7920 7061 7274 6974 696f 6e29  ruary partition)
-000422a0: 0a20 2020 2020 2020 202d 2032 3032 312d  .        - 2021-
-000422b0: 322d 3238 2030 303a 3030 3a30 3020 2873  2-28 00:00:00 (s
-000422c0: 7461 7274 206f 6620 4d61 7263 6820 7061  tart of March pa
-000422d0: 7274 6974 696f 6e29 0a20 2020 2020 2020  rtition).       
-000422e0: 202d 202e 2e2e 0a0a 2020 2020 6275 7420   - .....    but 
-000422f0: 7468 6973 202a 2a73 686f 756c 642a 2a20  this **should** 
-00042300: 6265 3a0a 2020 2020 2020 2020 2d20 3230  be:.        - 20
-00042310: 3231 2d32 2d31 2030 303a 3030 3a30 3020  21-2-1 00:00:00 
-00042320: 2873 7461 7274 206f 6620 4665 6272 7561  (start of Februa
-00042330: 7279 2070 6172 7469 7469 6f6e 290a 2020  ry partition).  
-00042340: 2020 2020 2020 2d20 3230 3231 2d33 2d31        - 2021-3-1
-00042350: 2030 303a 3030 3a30 3020 2873 7461 7274   00:00:00 (start
-00042360: 206f 6620 4d61 7263 6820 7061 7274 6974   of March partit
-00042370: 696f 6e29 0a20 2020 2020 2020 202d 202e  ion).        - .
-00042380: 2e2e 0a0a 2020 2020 5468 6572 6566 6f72  ....    Therefor
-00042390: 652c 2077 6520 6d61 7020 6066 7265 713d  e, we map `freq=
-000423a0: 274d 2760 2074 6f20 6066 7265 713d 274d  'M'` to `freq='M
-000423b0: 5327 6020 2873 616d 6520 666f 7220 7175  S'` (same for qu
-000423c0: 6172 7465 7220 616e 6420 7965 6172 292e  arter and year).
-000423d0: 0a20 2020 2022 2222 0a0a 2020 2020 6966  .    """..    if
-000423e0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-000423f0: 6672 6571 2c20 7374 7229 3a0a 2020 2020  freq, str):.    
-00042400: 2020 2020 7265 7475 726e 2066 7265 710a      return freq.
-00042410: 0a20 2020 206f 6666 7365 7420 3d20 7064  .    offset = pd
-00042420: 2e74 7365 7269 6573 2e66 7265 7175 656e  .tseries.frequen
-00042430: 6369 6573 2e74 6f5f 6f66 6673 6574 2866  cies.to_offset(f
-00042440: 7265 7129 0a20 2020 206f 6666 7365 745f  req).    offset_
-00042450: 7479 7065 5f6e 616d 6520 3d20 7479 7065  type_name = type
-00042460: 286f 6666 7365 7429 2e5f 5f6e 616d 655f  (offset).__name_
-00042470: 5f0a 0a20 2020 2069 6620 6e6f 7420 6f66  _..    if not of
-00042480: 6673 6574 5f74 7970 655f 6e61 6d65 2e65  fset_type_name.e
-00042490: 6e64 7377 6974 6828 2245 6e64 2229 3a0a  ndswith("End"):.
-000424a0: 2020 2020 2020 2020 7265 7475 726e 2066          return f
-000424b0: 7265 710a 0a20 2020 206e 6577 5f6f 6666  req..    new_off
-000424c0: 7365 7420 3d20 6f66 6673 6574 5f74 7970  set = offset_typ
-000424d0: 655f 6e61 6d65 5b3a 202d 6c65 6e28 2245  e_name[: -len("E
-000424e0: 6e64 2229 5d20 2b20 2242 6567 696e 220a  nd")] + "Begin".
-000424f0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00042500: 206e 6577 5f6f 6666 7365 745f 7479 7065   new_offset_type
-00042510: 203d 2067 6574 6174 7472 2870 642e 7473   = getattr(pd.ts
-00042520: 6572 6965 732e 6f66 6673 6574 732c 206e  eries.offsets, n
-00042530: 6577 5f6f 6666 7365 7429 0a20 2020 2020  ew_offset).     
-00042540: 2020 2069 6620 222d 2220 696e 2066 7265     if "-" in fre
-00042550: 713a 0a20 2020 2020 2020 2020 2020 205f  q:.            _
-00042560: 2c20 616e 6368 6f72 203d 2066 7265 712e  , anchor = freq.
-00042570: 7370 6c69 7428 222d 2229 0a20 2020 2020  split("-").     
-00042580: 2020 2020 2020 2061 6e63 686f 7220 3d20         anchor = 
-00042590: 222d 2220 2b20 616e 6368 6f72 0a20 2020  "-" + anchor.   
-000425a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000425b0: 2020 2020 2020 2061 6e63 686f 7220 3d20         anchor = 
-000425c0: 2222 0a20 2020 2020 2020 206e 203d 2073  "".        n = s
-000425d0: 7472 286f 6666 7365 742e 6e29 2069 6620  tr(offset.n) if 
-000425e0: 6f66 6673 6574 2e6e 2021 3d20 3120 656c  offset.n != 1 el
-000425f0: 7365 2022 220a 2020 2020 2020 2020 7265  se "".        re
-00042600: 7475 726e 2066 227b 6e7d 7b6e 6577 5f6f  turn f"{n}{new_o
-00042610: 6666 7365 745f 7479 7065 2e5f 7072 6566  ffset_type._pref
-00042620: 6978 7d7b 616e 6368 6f72 7d22 0a20 2020  ix}{anchor}".   
-00042630: 2065 7863 6570 7420 4174 7472 6962 7574   except Attribut
-00042640: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
-00042650: 7265 7475 726e 2066 7265 710a 0a0a 6465  return freq...de
-00042660: 6620 7265 7061 7274 6974 696f 6e5f 7369  f repartition_si
-00042670: 7a65 2864 662c 2073 697a 6529 3a0a 2020  ze(df, size):.  
-00042680: 2020 2222 220a 2020 2020 5265 7061 7274    """.    Repart
-00042690: 6974 696f 6e20 6461 7461 6672 616d 6520  ition dataframe 
-000426a0: 736f 2074 6861 7420 6e65 7720 7061 7274  so that new part
-000426b0: 6974 696f 6e73 2068 6176 6520 6170 7072  itions have appr
-000426c0: 6f78 696d 6174 656c 7920 6073 697a 6560  oximately `size`
-000426d0: 206d 656d 6f72 7920 7573 6167 6520 6561   memory usage ea
-000426e0: 6368 0a20 2020 2022 2222 0a20 2020 2069  ch.    """.    i
-000426f0: 6620 6973 696e 7374 616e 6365 2873 697a  f isinstance(siz
-00042700: 652c 2073 7472 293a 0a20 2020 2020 2020  e, str):.       
-00042710: 2073 697a 6520 3d20 7061 7273 655f 6279   size = parse_by
-00042720: 7465 7328 7369 7a65 290a 2020 2020 7369  tes(size).    si
-00042730: 7a65 203d 2069 6e74 2873 697a 6529 0a0a  ze = int(size)..
-00042740: 2020 2020 6d65 6d5f 7573 6167 6573 203d      mem_usages =
-00042750: 2064 662e 6d61 705f 7061 7274 6974 696f   df.map_partitio
-00042760: 6e73 2874 6f74 616c 5f6d 656d 5f75 7361  ns(total_mem_usa
-00042770: 6765 2c20 6465 6570 3d54 7275 6529 2e63  ge, deep=True).c
-00042780: 6f6d 7075 7465 2829 0a0a 2020 2020 2320  ompute()..    # 
-00042790: 312e 2073 706c 6974 2065 6163 6820 7061  1. split each pa
-000427a0: 7274 6974 696f 6e20 7468 6174 2069 7320  rtition that is 
-000427b0: 6c61 7267 6572 2074 6861 6e20 7061 7274  larger than part
-000427c0: 6974 696f 6e5f 7369 7a65 0a20 2020 206e  ition_size.    n
-000427d0: 7370 6c69 7473 203d 2031 202b 206d 656d  splits = 1 + mem
-000427e0: 5f75 7361 6765 7320 2f2f 2073 697a 650a  _usages // size.
-000427f0: 2020 2020 6966 206e 702e 616e 7928 6e73      if np.any(ns
-00042800: 706c 6974 7320 3e20 3129 3a0a 2020 2020  plits > 1):.    
-00042810: 2020 2020 7370 6c69 745f 6e61 6d65 203d      split_name =
-00042820: 2066 2272 6570 6172 7469 7469 6f6e 2d73   f"repartition-s
-00042830: 706c 6974 2d7b 7369 7a65 7d2d 7b74 6f6b  plit-{size}-{tok
-00042840: 656e 697a 6528 6466 297d 220a 2020 2020  enize(df)}".    
-00042850: 2020 2020 6466 203d 205f 7370 6c69 745f      df = _split_
-00042860: 7061 7274 6974 696f 6e73 2864 662c 206e  partitions(df, n
-00042870: 7370 6c69 7473 2c20 7370 6c69 745f 6e61  splits, split_na
-00042880: 6d65 290a 2020 2020 2020 2020 2320 7570  me).        # up
-00042890: 6461 7465 206d 656d 5f75 7361 6765 7320  date mem_usages 
-000428a0: 746f 2061 6363 6f75 6e74 2066 6f72 2074  to account for t
-000428b0: 6865 2073 706c 6974 2070 6172 7469 7469  he split partiti
-000428c0: 6f6e 730a 2020 2020 2020 2020 7370 6c69  ons.        spli
-000428d0: 745f 6d65 6d5f 7573 6167 6573 203d 205b  t_mem_usages = [
-000428e0: 5d0a 2020 2020 2020 2020 666f 7220 6e2c  ].        for n,
-000428f0: 2075 7361 6765 2069 6e20 7a69 7028 6e73   usage in zip(ns
-00042900: 706c 6974 732c 206d 656d 5f75 7361 6765  plits, mem_usage
-00042910: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00042920: 7370 6c69 745f 6d65 6d5f 7573 6167 6573  split_mem_usages
-00042930: 2e65 7874 656e 6428 5b75 7361 6765 202f  .extend([usage /
-00042940: 206e 5d20 2a20 6e29 0a20 2020 2020 2020   n] * n).       
-00042950: 206d 656d 5f75 7361 6765 7320 3d20 7064   mem_usages = pd
-00042960: 2e53 6572 6965 7328 7370 6c69 745f 6d65  .Series(split_me
-00042970: 6d5f 7573 6167 6573 290a 0a20 2020 2023  m_usages)..    #
-00042980: 2032 2e20 6e6f 7720 7468 6174 2061 6c6c   2. now that all
-00042990: 2070 6172 7469 7469 6f6e 7320 6172 6520   partitions are 
-000429a0: 6c65 7373 2074 6861 6e20 7369 7a65 2c20  less than size, 
-000429b0: 636f 6e63 6174 2074 6865 6d20 7570 2074  concat them up t
-000429c0: 6f20 7369 7a65 0a20 2020 2061 7373 6572  o size.    asser
-000429d0: 7420 6e70 2e61 6c6c 286d 656d 5f75 7361  t np.all(mem_usa
-000429e0: 6765 7320 3c3d 2073 697a 6529 0a20 2020  ges <= size).   
-000429f0: 206e 6577 5f6e 7061 7274 6974 696f 6e73   new_npartitions
-00042a00: 203d 206c 6973 7428 6d61 7028 6c65 6e2c   = list(map(len,
-00042a10: 2069 7465 725f 6368 756e 6b73 286d 656d   iter_chunks(mem
-00042a20: 5f75 7361 6765 732c 2073 697a 6529 2929  _usages, size)))
-00042a30: 0a20 2020 206e 6577 5f70 6172 7469 7469  .    new_partiti
-00042a40: 6f6e 735f 626f 756e 6461 7269 6573 203d  ons_boundaries =
-00042a50: 206e 702e 6375 6d73 756d 286e 6577 5f6e   np.cumsum(new_n
-00042a60: 7061 7274 6974 696f 6e73 290a 2020 2020  partitions).    
-00042a70: 6e65 775f 6e61 6d65 203d 2066 2272 6570  new_name = f"rep
-00042a80: 6172 7469 7469 6f6e 2d7b 7369 7a65 7d2d  artition-{size}-
-00042a90: 7b74 6f6b 656e 697a 6528 6466 297d 220a  {tokenize(df)}".
-00042aa0: 2020 2020 7265 7475 726e 205f 7265 7061      return _repa
-00042ab0: 7274 6974 696f 6e5f 6672 6f6d 5f62 6f75  rtition_from_bou
-00042ac0: 6e64 6172 6965 7328 6466 2c20 6e65 775f  ndaries(df, new_
-00042ad0: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
-00042ae0: 6172 6965 732c 206e 6577 5f6e 616d 6529  aries, new_name)
-00042af0: 0a0a 0a64 6566 2074 6f74 616c 5f6d 656d  ...def total_mem
-00042b00: 5f75 7361 6765 2864 662c 2069 6e64 6578  _usage(df, index
-00042b10: 3d54 7275 652c 2064 6565 703d 4661 6c73  =True, deep=Fals
-00042b20: 6529 3a0a 2020 2020 6d65 6d5f 7573 6167  e):.    mem_usag
-00042b30: 6520 3d20 6466 2e6d 656d 6f72 795f 7573  e = df.memory_us
-00042b40: 6167 6528 696e 6465 783d 696e 6465 782c  age(index=index,
-00042b50: 2064 6565 703d 6465 6570 290a 2020 2020   deep=deep).    
-00042b60: 6966 2069 735f 7365 7269 6573 5f6c 696b  if is_series_lik
-00042b70: 6528 6d65 6d5f 7573 6167 6529 3a0a 2020  e(mem_usage):.  
-00042b80: 2020 2020 2020 6d65 6d5f 7573 6167 6520        mem_usage 
-00042b90: 3d20 6d65 6d5f 7573 6167 652e 7375 6d28  = mem_usage.sum(
-00042ba0: 290a 2020 2020 7265 7475 726e 206d 656d  ).    return mem
-00042bb0: 5f75 7361 6765 0a0a 0a64 6566 2072 6570  _usage...def rep
-00042bc0: 6172 7469 7469 6f6e 5f6e 7061 7274 6974  artition_npartit
-00042bd0: 696f 6e73 2864 662c 206e 7061 7274 6974  ions(df, npartit
-00042be0: 696f 6e73 293a 0a20 2020 2022 2222 5265  ions):.    """Re
-00042bf0: 7061 7274 6974 696f 6e20 6461 7461 6672  partition datafr
-00042c00: 616d 6520 746f 2061 2073 6d61 6c6c 6572  ame to a smaller
-00042c10: 206e 756d 6265 7220 6f66 2070 6172 7469   number of parti
-00042c20: 7469 6f6e 7322 2222 0a20 2020 206e 6577  tions""".    new
-00042c30: 5f6e 616d 6520 3d20 2272 6570 6172 7469  _name = "reparti
-00042c40: 7469 6f6e 2d25 642d 2573 2220 2520 286e  tion-%d-%s" % (n
-00042c50: 7061 7274 6974 696f 6e73 2c20 746f 6b65  partitions, toke
-00042c60: 6e69 7a65 2864 6629 290a 2020 2020 6966  nize(df)).    if
-00042c70: 2064 662e 6e70 6172 7469 7469 6f6e 7320   df.npartitions 
-00042c80: 3d3d 206e 7061 7274 6974 696f 6e73 3a0a  == npartitions:.
-00042c90: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-00042ca0: 660a 2020 2020 656c 6966 2064 662e 6e70  f.    elif df.np
-00042cb0: 6172 7469 7469 6f6e 7320 3e20 6e70 6172  artitions > npar
-00042cc0: 7469 7469 6f6e 733a 0a20 2020 2020 2020  titions:.       
-00042cd0: 206e 7061 7274 6974 696f 6e73 5f72 6174   npartitions_rat
-00042ce0: 696f 203d 2064 662e 6e70 6172 7469 7469  io = df.npartiti
-00042cf0: 6f6e 7320 2f20 6e70 6172 7469 7469 6f6e  ons / npartition
-00042d00: 730a 2020 2020 2020 2020 6e65 775f 7061  s.        new_pa
-00042d10: 7274 6974 696f 6e73 5f62 6f75 6e64 6172  rtitions_boundar
-00042d20: 6965 7320 3d20 5b0a 2020 2020 2020 2020  ies = [.        
-00042d30: 2020 2020 696e 7428 6e65 775f 7061 7274      int(new_part
-00042d40: 6974 696f 6e5f 696e 6465 7820 2a20 6e70  ition_index * np
-00042d50: 6172 7469 7469 6f6e 735f 7261 7469 6f29  artitions_ratio)
-00042d60: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00042d70: 206e 6577 5f70 6172 7469 7469 6f6e 5f69   new_partition_i
-00042d80: 6e64 6578 2069 6e20 7261 6e67 6528 6e70  ndex in range(np
-00042d90: 6172 7469 7469 6f6e 7320 2b20 3129 0a20  artitions + 1). 
-00042da0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00042db0: 2072 6574 7572 6e20 5f72 6570 6172 7469   return _reparti
-00042dc0: 7469 6f6e 5f66 726f 6d5f 626f 756e 6461  tion_from_bounda
-00042dd0: 7269 6573 2864 662c 206e 6577 5f70 6172  ries(df, new_par
-00042de0: 7469 7469 6f6e 735f 626f 756e 6461 7269  titions_boundari
-00042df0: 6573 2c20 6e65 775f 6e61 6d65 290a 2020  es, new_name).  
-00042e00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00042e10: 2320 4472 6f70 2064 7570 6c63 6174 6573  # Drop duplcates
-00042e20: 2069 6e20 6361 7365 206c 6173 7420 7061   in case last pa
-00042e30: 7274 6974 696f 6e20 6861 7320 7361 6d65  rtition has same
-00042e40: 0a20 2020 2020 2020 2023 2076 616c 7565  .        # value
-00042e50: 2066 6f72 206d 696e 2061 6e64 206d 6178   for min and max
-00042e60: 2064 6976 6973 696f 6e0a 2020 2020 2020   division.      
-00042e70: 2020 6f72 6967 696e 616c 5f64 6976 6973    original_divis
-00042e80: 696f 6e73 203d 2064 6976 6973 696f 6e73  ions = divisions
-00042e90: 203d 2070 642e 5365 7269 6573 2864 662e   = pd.Series(df.
-00042ea0: 6469 7669 7369 6f6e 7329 2e64 726f 705f  divisions).drop_
-00042eb0: 6475 706c 6963 6174 6573 2829 0a20 2020  duplicates().   
-00042ec0: 2020 2020 2069 6620 6466 2e6b 6e6f 776e       if df.known
-00042ed0: 5f64 6976 6973 696f 6e73 2061 6e64 2028  _divisions and (
-00042ee0: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
-00042ef0: 6461 7465 7469 6d65 3634 5f61 6e79 5f64  datetime64_any_d
-00042f00: 7479 7065 2864 6976 6973 696f 6e73 2e64  type(divisions.d
-00042f10: 7479 7065 290a 2020 2020 2020 2020 2020  type).          
-00042f20: 2020 6f72 2069 735f 6e75 6d65 7269 635f    or is_numeric_
-00042f30: 6474 7970 6528 6469 7669 7369 6f6e 732e  dtype(divisions.
-00042f40: 6474 7970 6529 0a20 2020 2020 2020 2029  dtype).        )
-00042f50: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00042f60: 2069 735f 6461 7465 7469 6d65 3634 5f61   is_datetime64_a
-00042f70: 6e79 5f64 7479 7065 2864 6976 6973 696f  ny_dtype(divisio
-00042f80: 6e73 2e64 7479 7065 293a 0a20 2020 2020  ns.dtype):.     
-00042f90: 2020 2020 2020 2020 2020 2064 6976 6973             divis
-00042fa0: 696f 6e73 203d 2064 6976 6973 696f 6e73  ions = divisions
-00042fb0: 2e76 616c 7565 732e 6173 7479 7065 2822  .values.astype("
-00042fc0: 666c 6f61 7436 3422 290a 0a20 2020 2020  float64")..     
-00042fd0: 2020 2020 2020 2069 6620 6973 5f73 6572         if is_ser
-00042fe0: 6965 735f 6c69 6b65 2864 6976 6973 696f  ies_like(divisio
-00042ff0: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
-00043000: 2020 2020 2064 6976 6973 696f 6e73 203d       divisions =
-00043010: 2064 6976 6973 696f 6e73 2e76 616c 7565   divisions.value
-00043020: 730a 0a20 2020 2020 2020 2020 2020 206e  s..            n
-00043030: 203d 206c 656e 2864 6976 6973 696f 6e73   = len(divisions
-00043040: 290a 2020 2020 2020 2020 2020 2020 6469  ).            di
-00043050: 7669 7369 6f6e 7320 3d20 6e70 2e69 6e74  visions = np.int
-00043060: 6572 7028 0a20 2020 2020 2020 2020 2020  erp(.           
-00043070: 2020 2020 2078 3d6e 702e 6c69 6e73 7061       x=np.linspa
-00043080: 6365 2830 2c20 6e2c 206e 7061 7274 6974  ce(0, n, npartit
-00043090: 696f 6e73 202b 2031 292c 0a20 2020 2020  ions + 1),.     
-000430a0: 2020 2020 2020 2020 2020 2078 703d 6e70             xp=np
-000430b0: 2e6c 696e 7370 6163 6528 302c 206e 2c20  .linspace(0, n, 
-000430c0: 6e29 2c0a 2020 2020 2020 2020 2020 2020  n),.            
-000430d0: 2020 2020 6670 3d64 6976 6973 696f 6e73      fp=divisions
-000430e0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-000430f0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00043100: 735f 6461 7465 7469 6d65 3634 5f61 6e79  s_datetime64_any
-00043110: 5f64 7479 7065 286f 7269 6769 6e61 6c5f  _dtype(original_
-00043120: 6469 7669 7369 6f6e 732e 6474 7970 6529  divisions.dtype)
-00043130: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00043140: 2020 6469 7669 7369 6f6e 7320 3d20 6d65    divisions = me
-00043150: 7468 6f64 732e 746f 6c69 7374 280a 2020  thods.tolist(.  
-00043160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043170: 2020 7064 2e53 6572 6965 7328 6469 7669    pd.Series(divi
-00043180: 7369 6f6e 7329 2e61 7374 7970 6528 6f72  sions).astype(or
-00043190: 6967 696e 616c 5f64 6976 6973 696f 6e73  iginal_divisions
-000431a0: 2e64 7479 7065 290a 2020 2020 2020 2020  .dtype).        
-000431b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000431c0: 2020 2020 2020 656c 6966 206e 702e 6973        elif np.is
-000431d0: 7375 6264 7479 7065 286f 7269 6769 6e61  subdtype(origina
-000431e0: 6c5f 6469 7669 7369 6f6e 732e 6474 7970  l_divisions.dtyp
-000431f0: 652c 206e 702e 696e 7465 6765 7229 3a0a  e, np.integer):.
-00043200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043210: 6469 7669 7369 6f6e 7320 3d20 6469 7669  divisions = divi
-00043220: 7369 6f6e 732e 6173 7479 7065 286f 7269  sions.astype(ori
-00043230: 6769 6e61 6c5f 6469 7669 7369 6f6e 732e  ginal_divisions.
-00043240: 6474 7970 6529 0a0a 2020 2020 2020 2020  dtype)..        
-00043250: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00043260: 6528 6469 7669 7369 6f6e 732c 206e 702e  e(divisions, np.
-00043270: 6e64 6172 7261 7929 3a0a 2020 2020 2020  ndarray):.      
-00043280: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
-00043290: 6f6e 7320 3d20 6469 7669 7369 6f6e 732e  ons = divisions.
-000432a0: 746f 6c69 7374 2829 0a0a 2020 2020 2020  tolist()..      
-000432b0: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
-000432c0: 3d20 6c69 7374 2864 6976 6973 696f 6e73  = list(divisions
-000432d0: 290a 2020 2020 2020 2020 2020 2020 6469  ).            di
-000432e0: 7669 7369 6f6e 735b 305d 203d 2064 662e  visions[0] = df.
-000432f0: 6469 7669 7369 6f6e 735b 305d 0a20 2020  divisions[0].   
-00043300: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
-00043310: 6e73 5b2d 315d 203d 2064 662e 6469 7669  ns[-1] = df.divi
-00043320: 7369 6f6e 735b 2d31 5d0a 0a20 2020 2020  sions[-1]..     
-00043330: 2020 2020 2020 2023 2045 6e73 7572 6520         # Ensure 
-00043340: 7468 6520 636f 6d70 7574 6564 2064 6976  the computed div
-00043350: 6973 696f 6e73 2061 7265 2075 6e69 7175  isions are uniqu
-00043360: 650a 2020 2020 2020 2020 2020 2020 6469  e.            di
-00043370: 7669 7369 6f6e 7320 3d20 6c69 7374 2875  visions = list(u
-00043380: 6e69 7175 6528 6469 7669 7369 6f6e 735b  nique(divisions[
-00043390: 3a2d 315d 2929 202b 205b 6469 7669 7369  :-1])) + [divisi
-000433a0: 6f6e 735b 2d31 5d5d 0a20 2020 2020 2020  ons[-1]].       
-000433b0: 2020 2020 2072 6574 7572 6e20 6466 2e72       return df.r
-000433c0: 6570 6172 7469 7469 6f6e 2864 6976 6973  epartition(divis
-000433d0: 696f 6e73 3d64 6976 6973 696f 6e73 290a  ions=divisions).
-000433e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000433f0: 2020 2020 2020 2020 2020 6469 762c 206d            div, m
-00043400: 6f64 203d 2064 6976 6d6f 6428 6e70 6172  od = divmod(npar
-00043410: 7469 7469 6f6e 732c 2064 662e 6e70 6172  titions, df.npar
-00043420: 7469 7469 6f6e 7329 0a20 2020 2020 2020  titions).       
-00043430: 2020 2020 206e 7370 6c69 7473 203d 205b       nsplits = [
-00043440: 6469 765d 202a 2064 662e 6e70 6172 7469  div] * df.nparti
-00043450: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
-00043460: 2020 6e73 706c 6974 735b 2d31 5d20 2b3d    nsplits[-1] +=
-00043470: 206d 6f64 0a20 2020 2020 2020 2020 2020   mod.           
-00043480: 2072 6574 7572 6e20 5f73 706c 6974 5f70   return _split_p
-00043490: 6172 7469 7469 6f6e 7328 6466 2c20 6e73  artitions(df, ns
-000434a0: 706c 6974 732c 206e 6577 5f6e 616d 6529  plits, new_name)
-000434b0: 0a0a 0a64 6566 205f 7265 7061 7274 6974  ...def _repartit
-000434c0: 696f 6e5f 6672 6f6d 5f62 6f75 6e64 6172  ion_from_boundar
-000434d0: 6965 7328 6466 2c20 6e65 775f 7061 7274  ies(df, new_part
-000434e0: 6974 696f 6e73 5f62 6f75 6e64 6172 6965  itions_boundarie
-000434f0: 732c 206e 6577 5f6e 616d 6529 3a0a 2020  s, new_name):.  
-00043500: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-00043510: 6e63 6528 6e65 775f 7061 7274 6974 696f  nce(new_partitio
-00043520: 6e73 5f62 6f75 6e64 6172 6965 732c 206c  ns_boundaries, l
-00043530: 6973 7429 3a0a 2020 2020 2020 2020 6e65  ist):.        ne
-00043540: 775f 7061 7274 6974 696f 6e73 5f62 6f75  w_partitions_bou
-00043550: 6e64 6172 6965 7320 3d20 6c69 7374 286e  ndaries = list(n
-00043560: 6577 5f70 6172 7469 7469 6f6e 735f 626f  ew_partitions_bo
-00043570: 756e 6461 7269 6573 290a 2020 2020 6966  undaries).    if
-00043580: 206e 6577 5f70 6172 7469 7469 6f6e 735f   new_partitions_
-00043590: 626f 756e 6461 7269 6573 5b30 5d20 3e20  boundaries[0] > 
-000435a0: 303a 0a20 2020 2020 2020 206e 6577 5f70  0:.        new_p
-000435b0: 6172 7469 7469 6f6e 735f 626f 756e 6461  artitions_bounda
-000435c0: 7269 6573 2e69 6e73 6572 7428 302c 2030  ries.insert(0, 0
-000435d0: 290a 2020 2020 6966 206e 6577 5f70 6172  ).    if new_par
-000435e0: 7469 7469 6f6e 735f 626f 756e 6461 7269  titions_boundari
-000435f0: 6573 5b2d 315d 203c 2064 662e 6e70 6172  es[-1] < df.npar
-00043600: 7469 7469 6f6e 733a 0a20 2020 2020 2020  titions:.       
-00043610: 206e 6577 5f70 6172 7469 7469 6f6e 735f   new_partitions_
-00043620: 626f 756e 6461 7269 6573 2e61 7070 656e  boundaries.appen
-00043630: 6428 6466 2e6e 7061 7274 6974 696f 6e73  d(df.npartitions
-00043640: 290a 2020 2020 6473 6b20 3d20 7b7d 0a20  ).    dsk = {}. 
-00043650: 2020 2066 6f72 2069 2c20 2873 7461 7274     for i, (start
-00043660: 2c20 656e 6429 2069 6e20 656e 756d 6572  , end) in enumer
-00043670: 6174 6528 0a20 2020 2020 2020 207a 6970  ate(.        zip
-00043680: 286e 6577 5f70 6172 7469 7469 6f6e 735f  (new_partitions_
-00043690: 626f 756e 6461 7269 6573 2c20 6e65 775f  boundaries, new_
-000436a0: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
-000436b0: 6172 6965 735b 313a 5d29 0a20 2020 2029  aries[1:]).    )
-000436c0: 3a0a 2020 2020 2020 2020 6473 6b5b 6e65  :.        dsk[ne
-000436d0: 775f 6e61 6d65 2c20 695d 203d 2028 6d65  w_name, i] = (me
-000436e0: 7468 6f64 732e 636f 6e63 6174 2c20 5b28  thods.concat, [(
-000436f0: 6466 2e5f 6e61 6d65 2c20 6a29 2066 6f72  df._name, j) for
-00043700: 206a 2069 6e20 7261 6e67 6528 7374 6172   j in range(star
-00043710: 742c 2065 6e64 295d 290a 2020 2020 6469  t, end)]).    di
-00043720: 7669 7369 6f6e 7320 3d20 5b64 662e 6469  visions = [df.di
-00043730: 7669 7369 6f6e 735b 695d 2066 6f72 2069  visions[i] for i
-00043740: 2069 6e20 6e65 775f 7061 7274 6974 696f   in new_partitio
-00043750: 6e73 5f62 6f75 6e64 6172 6965 735d 0a20  ns_boundaries]. 
-00043760: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-00043770: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-00043780: 6f6c 6c65 6374 696f 6e73 286e 6577 5f6e  ollections(new_n
-00043790: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
-000437a0: 656e 6369 6573 3d5b 6466 5d29 0a20 2020  encies=[df]).   
-000437b0: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
-000437c0: 626a 6563 7428 6772 6170 682c 206e 6577  bject(graph, new
-000437d0: 5f6e 616d 652c 2064 662e 5f6d 6574 612c  _name, df._meta,
-000437e0: 2064 6976 6973 696f 6e73 290a 0a0a 6465   divisions)...de
-000437f0: 6620 5f73 706c 6974 5f70 6172 7469 7469  f _split_partiti
-00043800: 6f6e 7328 6466 2c20 6e73 706c 6974 732c  ons(df, nsplits,
-00043810: 206e 6577 5f6e 616d 6529 3a0a 2020 2020   new_name):.    
-00043820: 2222 2253 706c 6974 2061 2044 6173 6b20  """Split a Dask 
-00043830: 6461 7461 6672 616d 6520 696e 746f 206e  dataframe into n
-00043840: 6577 2070 6172 7469 7469 6f6e 730a 0a20  ew partitions.. 
-00043850: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00043860: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00043870: 2064 663a 2044 6174 6146 7261 6d65 206f   df: DataFrame o
-00043880: 7220 5365 7269 6573 0a20 2020 206e 7370  r Series.    nsp
-00043890: 6c69 7473 3a20 4c69 7374 5b69 6e74 5d0a  lits: List[int].
-000438a0: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
-000438b0: 6620 7461 7267 6574 2064 6174 6166 7261  f target datafra
-000438c0: 6d65 7320 666f 7220 6561 6368 2070 6172  mes for each par
-000438d0: 7469 7469 6f6e 0a20 2020 2020 2020 2054  tition.        T
-000438e0: 6865 206c 656e 6774 6820 6f66 206e 7370  he length of nsp
-000438f0: 6c69 7473 2073 686f 756c 6420 6265 2074  lits should be t
-00043900: 6865 2073 616d 6520 6173 2064 662e 6e70  he same as df.np
-00043910: 6172 7469 7469 6f6e 730a 2020 2020 6e65  artitions.    ne
-00043920: 775f 6e61 6d65 3a20 7374 720a 0a20 2020  w_name: str..   
-00043930: 2053 6565 2041 6c73 6f0a 2020 2020 2d2d   See Also.    --
-00043940: 2d2d 2d2d 2d2d 0a20 2020 2072 6570 6172  ------.    repar
-00043950: 7469 7469 6f6e 5f6e 7061 7274 6974 696f  tition_npartitio
-00043960: 6e73 0a20 2020 2072 6570 6172 7469 7469  ns.    repartiti
-00043970: 6f6e 5f73 697a 650a 2020 2020 2222 220a  on_size.    """.
-00043980: 2020 2020 6966 206c 656e 286e 7370 6c69      if len(nspli
-00043990: 7473 2920 213d 2064 662e 6e70 6172 7469  ts) != df.nparti
-000439a0: 7469 6f6e 733a 0a20 2020 2020 2020 2072  tions:.        r
-000439b0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-000439c0: 6622 6e73 706c 6974 7320 7368 6f75 6c64  f"nsplits should
-000439d0: 2068 6176 6520 6c65 6e3d 7b64 662e 6e70   have len={df.np
-000439e0: 6172 7469 7469 6f6e 737d 2229 0a0a 2020  artitions}")..  
-000439f0: 2020 6473 6b20 3d20 7b7d 0a20 2020 2073    dsk = {}.    s
-00043a00: 706c 6974 5f6e 616d 6520 3d20 6622 7370  plit_name = f"sp
-00043a10: 6c69 742d 7b74 6f6b 656e 697a 6528 6466  lit-{tokenize(df
-00043a20: 2c20 6e73 706c 6974 7329 7d22 0a20 2020  , nsplits)}".   
-00043a30: 206a 203d 2030 0a20 2020 2066 6f72 2069   j = 0.    for i
-00043a40: 2c20 6b20 696e 2065 6e75 6d65 7261 7465  , k in enumerate
-00043a50: 286e 7370 6c69 7473 293a 0a20 2020 2020  (nsplits):.     
-00043a60: 2020 2069 6620 6b20 3d3d 2031 3a0a 2020     if k == 1:.  
-00043a70: 2020 2020 2020 2020 2020 6473 6b5b 6e65            dsk[ne
-00043a80: 775f 6e61 6d65 2c20 6a5d 203d 2028 6466  w_name, j] = (df
-00043a90: 2e5f 6e61 6d65 2c20 6929 0a20 2020 2020  ._name, i).     
-00043aa0: 2020 2020 2020 206a 202b 3d20 310a 2020         j += 1.  
-00043ab0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00043ac0: 2020 2020 2020 2020 6473 6b5b 7370 6c69          dsk[spli
-00043ad0: 745f 6e61 6d65 2c20 695d 203d 2028 7370  t_name, i] = (sp
-00043ae0: 6c69 745f 6576 656e 6c79 2c20 2864 662e  lit_evenly, (df.
-00043af0: 5f6e 616d 652c 2069 292c 206b 290a 2020  _name, i), k).  
-00043b00: 2020 2020 2020 2020 2020 666f 7220 6a6a            for jj
-00043b10: 2069 6e20 7261 6e67 6528 6b29 3a0a 2020   in range(k):.  
-00043b20: 2020 2020 2020 2020 2020 2020 2020 6473                ds
-00043b30: 6b5b 6e65 775f 6e61 6d65 2c20 6a5d 203d  k[new_name, j] =
-00043b40: 2028 6765 7469 7465 6d2c 2028 7370 6c69   (getitem, (spli
-00043b50: 745f 6e61 6d65 2c20 6929 2c20 6a6a 290a  t_name, i), jj).
-00043b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043b70: 6a20 2b3d 2031 0a0a 2020 2020 6469 7669  j += 1..    divi
-00043b80: 7369 6f6e 7320 3d20 5b4e 6f6e 655d 202a  sions = [None] *
-00043b90: 2028 3120 2b20 7375 6d28 6e73 706c 6974   (1 + sum(nsplit
-00043ba0: 7329 290a 2020 2020 6772 6170 6820 3d20  s)).    graph = 
-00043bb0: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-00043bc0: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-00043bd0: 6e65 775f 6e61 6d65 2c20 6473 6b2c 2064  new_name, dsk, d
-00043be0: 6570 656e 6465 6e63 6965 733d 5b64 665d  ependencies=[df]
-00043bf0: 290a 2020 2020 7265 7475 726e 206e 6577  ).    return new
-00043c00: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
-00043c10: 2c20 6e65 775f 6e61 6d65 2c20 6466 2e5f  , new_name, df._
-00043c20: 6d65 7461 2c20 6469 7669 7369 6f6e 7329  meta, divisions)
-00043c30: 0a0a 0a64 6566 2072 6570 6172 7469 7469  ...def repartiti
-00043c40: 6f6e 2864 662c 2064 6976 6973 696f 6e73  on(df, divisions
-00043c50: 3d4e 6f6e 652c 2066 6f72 6365 3d46 616c  =None, force=Fal
-00043c60: 7365 293a 0a20 2020 2022 2222 5265 7061  se):.    """Repa
-00043c70: 7274 6974 696f 6e20 6461 7461 6672 616d  rtition datafram
-00043c80: 6520 616c 6f6e 6720 6e65 7720 6469 7669  e along new divi
-00043c90: 7369 6f6e 730a 0a20 2020 2044 6173 6b2e  sions..    Dask.
-00043ca0: 4461 7461 4672 616d 6520 6f62 6a65 6374  DataFrame object
-00043cb0: 7320 6172 6520 7061 7274 6974 696f 6e65  s are partitione
-00043cc0: 6420 616c 6f6e 6720 7468 6569 7220 696e  d along their in
-00043cd0: 6465 782e 2020 4f66 7465 6e20 7768 656e  dex.  Often when
-00043ce0: 0a20 2020 206d 756c 7469 706c 6520 6461  .    multiple da
-00043cf0: 7461 6672 616d 6573 2069 6e74 6572 6163  taframes interac
-00043d00: 7420 7765 206e 6565 6420 746f 2061 6c69  t we need to ali
-00043d10: 676e 2074 6865 7365 2070 6172 7469 7469  gn these partiti
-00043d20: 6f6e 696e 6773 2e20 2054 6865 0a20 2020  onings.  The.   
-00043d30: 2060 6072 6570 6172 7469 7469 6f6e 6060   ``repartition``
-00043d40: 2066 756e 6374 696f 6e20 636f 6e73 7472   function constr
-00043d50: 7563 7473 2061 206e 6577 2044 6174 6146  ucts a new DataF
-00043d60: 7261 6d65 206f 626a 6563 7420 686f 6c64  rame object hold
-00043d70: 696e 6720 7468 6520 7361 6d65 0a20 2020  ing the same.   
-00043d80: 2064 6174 6120 6275 7420 7061 7274 6974   data but partit
-00043d90: 696f 6e65 6420 6f6e 2064 6966 6665 7265  ioned on differe
-00043da0: 6e74 2076 616c 7565 732e 2020 4974 2064  nt values.  It d
-00043db0: 6f65 7320 7468 6973 2062 7920 7065 7266  oes this by perf
-00043dc0: 6f72 6d69 6e67 2061 0a20 2020 2073 6571  orming a.    seq
-00043dd0: 7565 6e63 6520 6f66 2060 606c 6f63 6060  uence of ``loc``
-00043de0: 2061 6e64 2060 6063 6f6e 6361 7460 6020   and ``concat`` 
-00043df0: 6361 6c6c 7320 746f 2073 706c 6974 2061  calls to split a
-00043e00: 6e64 206d 6572 6765 2074 6865 2070 7265  nd merge the pre
-00043e10: 7669 6f75 730a 2020 2020 6765 6e65 7261  vious.    genera
-00043e20: 7469 6f6e 206f 6620 7061 7274 6974 696f  tion of partitio
-00043e30: 6e73 2e0a 0a20 2020 2050 6172 616d 6574  ns...    Paramet
-00043e40: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-00043e50: 2d2d 0a0a 2020 2020 6469 7669 7369 6f6e  --..    division
-00043e60: 7320 3a20 6c69 7374 0a20 2020 2020 2020  s : list.       
-00043e70: 204c 6973 7420 6f66 2070 6172 7469 7469   List of partiti
-00043e80: 6f6e 7320 746f 2062 6520 7573 6564 0a20  ons to be used. 
-00043e90: 2020 2066 6f72 6365 203a 2062 6f6f 6c2c     force : bool,
-00043ea0: 2064 6566 6175 6c74 2046 616c 7365 0a20   default False. 
-00043eb0: 2020 2020 2020 2041 6c6c 6f77 7320 7468         Allows th
-00043ec0: 6520 6578 7061 6e73 696f 6e20 6f66 2074  e expansion of t
-00043ed0: 6865 2065 7869 7374 696e 6720 6469 7669  he existing divi
-00043ee0: 7369 6f6e 732e 0a20 2020 2020 2020 2049  sions..        I
-00043ef0: 6620 4661 6c73 6520 7468 656e 2074 6865  f False then the
-00043f00: 206e 6577 2064 6976 6973 696f 6e73 206c   new divisions l
-00043f10: 6f77 6572 2061 6e64 2075 7070 6572 2062  ower and upper b
-00043f20: 6f75 6e64 7320 6d75 7374 2062 650a 2020  ounds must be.  
-00043f30: 2020 2020 2020 7468 6520 7361 6d65 2061        the same a
-00043f40: 7320 7468 6520 6f6c 6420 6469 7669 7369  s the old divisi
-00043f50: 6f6e 732e 0a0a 2020 2020 4578 616d 706c  ons...    Exampl
-00043f60: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
-00043f70: 0a20 2020 203e 3e3e 2064 6620 3d20 6466  .    >>> df = df
-00043f80: 2e72 6570 6172 7469 7469 6f6e 285b 302c  .repartition([0,
-00043f90: 2035 2c20 3130 2c20 3230 5d29 2020 2320   5, 10, 20])  # 
-00043fa0: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
-00043fb0: 2020 2020 416c 736f 2077 6f72 6b73 206f      Also works o
-00043fc0: 6e20 5061 6e64 6173 206f 626a 6563 7473  n Pandas objects
-00043fd0: 0a0a 2020 2020 3e3e 3e20 6464 6620 3d20  ..    >>> ddf = 
-00043fe0: 6464 2e72 6570 6172 7469 7469 6f6e 2864  dd.repartition(d
-00043ff0: 662c 205b 302c 2035 2c20 3130 2c20 3230  f, [0, 5, 10, 20
-00044000: 5d29 2020 2320 646f 6374 6573 743a 202b  ])  # doctest: +
-00044010: 534b 4950 0a20 2020 2022 2222 0a0a 2020  SKIP.    """..  
-00044020: 2020 2320 6e6f 2d6f 7020 6661 7374 7061    # no-op fastpa
-00044030: 7468 2066 6f72 2077 6865 6e20 7765 2061  th for when we a
-00044040: 6c72 6561 6479 2068 6176 6520 6d61 7463  lready have matc
-00044050: 6869 6e67 2064 6976 6973 696f 6e73 0a20  hing divisions. 
-00044060: 2020 2069 6620 6973 5f64 6173 6b5f 636f     if is_dask_co
-00044070: 6c6c 6563 7469 6f6e 2864 6629 2061 6e64  llection(df) and
-00044080: 2064 662e 6469 7669 7369 6f6e 7320 3d3d   df.divisions ==
-00044090: 2064 6976 6973 696f 6e73 3a0a 2020 2020   divisions:.    
-000440a0: 2020 2020 7265 7475 726e 2064 660a 0a20      return df.. 
-000440b0: 2020 2074 6f6b 656e 203d 2074 6f6b 656e     token = token
-000440c0: 697a 6528 6466 2c20 6469 7669 7369 6f6e  ize(df, division
-000440d0: 7329 0a20 2020 2069 6620 6973 696e 7374  s).    if isinst
-000440e0: 616e 6365 2864 662c 205f 4672 616d 6529  ance(df, _Frame)
-000440f0: 3a0a 2020 2020 2020 2020 746d 7020 3d20  :.        tmp = 
-00044100: 2272 6570 6172 7469 7469 6f6e 2d73 706c  "repartition-spl
-00044110: 6974 2d22 202b 2074 6f6b 656e 0a20 2020  it-" + token.   
-00044120: 2020 2020 206f 7574 203d 2022 7265 7061       out = "repa
-00044130: 7274 6974 696f 6e2d 6d65 7267 652d 2220  rtition-merge-" 
-00044140: 2b20 746f 6b65 6e0a 2020 2020 2020 2020  + token.        
-00044150: 6473 6b20 3d20 7265 7061 7274 6974 696f  dsk = repartitio
-00044160: 6e5f 6469 7669 7369 6f6e 7328 0a20 2020  n_divisions(.   
-00044170: 2020 2020 2020 2020 2064 662e 6469 7669           df.divi
-00044180: 7369 6f6e 732c 2064 6976 6973 696f 6e73  sions, divisions
-00044190: 2c20 6466 2e5f 6e61 6d65 2c20 746d 702c  , df._name, tmp,
-000441a0: 206f 7574 2c20 666f 7263 653d 666f 7263   out, force=forc
-000441b0: 650a 2020 2020 2020 2020 290a 2020 2020  e.        ).    
-000441c0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
-000441d0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
-000441e0: 636f 6c6c 6563 7469 6f6e 7328 6f75 742c  collections(out,
-000441f0: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-00044200: 6573 3d5b 6466 5d29 0a20 2020 2020 2020  es=[df]).       
-00044210: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
-00044220: 626a 6563 7428 6772 6170 682c 206f 7574  bject(graph, out
-00044230: 2c20 6466 2e5f 6d65 7461 2c20 6469 7669  , df._meta, divi
-00044240: 7369 6f6e 7329 0a20 2020 2065 6c69 6620  sions).    elif 
-00044250: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-00044260: 6528 6466 2920 6f72 2069 735f 7365 7269  e(df) or is_seri
-00044270: 6573 5f6c 696b 6528 6466 293a 0a20 2020  es_like(df):.   
-00044280: 2020 2020 206e 616d 6520 3d20 2272 6570       name = "rep
-00044290: 6172 7469 7469 6f6e 2d64 6174 6166 7261  artition-datafra
-000442a0: 6d65 2d22 202b 2074 6f6b 656e 0a20 2020  me-" + token.   
-000442b0: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-000442c0: 6174 6166 7261 6d65 2e75 7469 6c73 2069  ataframe.utils i
-000442d0: 6d70 6f72 7420 7368 6172 645f 6466 5f6f  mport shard_df_o
-000442e0: 6e5f 696e 6465 780a 0a20 2020 2020 2020  n_index..       
-000442f0: 2064 6673 203d 2073 6861 7264 5f64 665f   dfs = shard_df_
-00044300: 6f6e 5f69 6e64 6578 2864 662c 2064 6976  on_index(df, div
-00044310: 6973 696f 6e73 5b31 3a2d 315d 290a 2020  isions[1:-1]).  
-00044320: 2020 2020 2020 6473 6b20 3d20 7b28 6e61        dsk = {(na
-00044330: 6d65 2c20 6929 3a20 6466 2066 6f72 2069  me, i): df for i
-00044340: 2c20 6466 2069 6e20 656e 756d 6572 6174  , df in enumerat
-00044350: 6528 6466 7329 7d0a 2020 2020 2020 2020  e(dfs)}.        
-00044360: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
-00044370: 6a65 6374 2864 736b 2c20 6e61 6d65 2c20  ject(dsk, name, 
-00044380: 6466 2c20 6469 7669 7369 6f6e 7329 0a20  df, divisions). 
-00044390: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000443a0: 726f 7228 2244 6174 6120 6d75 7374 2062  ror("Data must b
-000443b0: 6520 4461 7461 4672 616d 6520 6f72 2053  e DataFrame or S
-000443c0: 6572 6965 7322 290a 0a0a 6465 6620 5f72  eries")...def _r
-000443d0: 6564 7563 7469 6f6e 5f63 6875 6e6b 2878  eduction_chunk(x
-000443e0: 2c20 6163 615f 6368 756e 6b3d 4e6f 6e65  , aca_chunk=None
-000443f0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00044400: 206f 203d 2061 6361 5f63 6875 6e6b 2878   o = aca_chunk(x
-00044410: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
-00044420: 2320 5265 7475 726e 2061 2064 6174 6166  # Return a dataf
-00044430: 7261 6d65 2073 6f20 7468 6174 2074 6865  rame so that the
-00044440: 2063 6f6e 6361 7465 6e61 7465 6420 7665   concatenated ve
-00044450: 7273 696f 6e20 6973 2061 6c73 6f20 6120  rsion is also a 
-00044460: 6461 7461 6672 616d 650a 2020 2020 7265  dataframe.    re
-00044470: 7475 726e 206f 2e74 6f5f 6672 616d 6528  turn o.to_frame(
-00044480: 292e 5420 6966 2069 735f 7365 7269 6573  ).T if is_series
-00044490: 5f6c 696b 6528 6f29 2065 6c73 6520 6f0a  _like(o) else o.
-000444a0: 0a0a 6465 6620 5f72 6564 7563 7469 6f6e  ..def _reduction
-000444b0: 5f63 6f6d 6269 6e65 2878 2c20 6163 615f  _combine(x, aca_
-000444c0: 636f 6d62 696e 653d 4e6f 6e65 2c20 2a2a  combine=None, **
-000444d0: 6b77 6172 6773 293a 0a20 2020 2069 6620  kwargs):.    if 
-000444e0: 6973 696e 7374 616e 6365 2878 2c20 6c69  isinstance(x, li
-000444f0: 7374 293a 0a20 2020 2020 2020 2078 203d  st):.        x =
-00044500: 2070 642e 5365 7269 6573 2878 290a 2020   pd.Series(x).  
-00044510: 2020 6f20 3d20 6163 615f 636f 6d62 696e    o = aca_combin
-00044520: 6528 782c 202a 2a6b 7761 7267 7329 0a20  e(x, **kwargs). 
-00044530: 2020 2023 2052 6574 7572 6e20 6120 6461     # Return a da
-00044540: 7461 6672 616d 6520 736f 2074 6861 7420  taframe so that 
-00044550: 7468 6520 636f 6e63 6174 656e 6174 6564  the concatenated
-00044560: 2076 6572 7369 6f6e 2069 7320 616c 736f   version is also
-00044570: 2061 2064 6174 6166 7261 6d65 0a20 2020   a dataframe.   
-00044580: 2072 6574 7572 6e20 6f2e 746f 5f66 7261   return o.to_fra
-00044590: 6d65 2829 2e54 2069 6620 6973 5f73 6572  me().T if is_ser
-000445a0: 6965 735f 6c69 6b65 286f 2920 656c 7365  ies_like(o) else
-000445b0: 206f 0a0a 0a64 6566 205f 7265 6475 6374   o...def _reduct
-000445c0: 696f 6e5f 6167 6772 6567 6174 6528 782c  ion_aggregate(x,
-000445d0: 2061 6361 5f61 6767 7265 6761 7465 3d4e   aca_aggregate=N
-000445e0: 6f6e 652c 202a 2a6b 7761 7267 7329 3a0a  one, **kwargs):.
-000445f0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00044600: 6528 782c 206c 6973 7429 3a0a 2020 2020  e(x, list):.    
-00044610: 2020 2020 7820 3d20 7064 2e53 6572 6965      x = pd.Serie
-00044620: 7328 7829 0a20 2020 2072 6574 7572 6e20  s(x).    return 
-00044630: 6163 615f 6167 6772 6567 6174 6528 782c  aca_aggregate(x,
-00044640: 202a 2a6b 7761 7267 7329 0a0a 0a64 6566   **kwargs)...def
-00044650: 2069 6478 6d61 786d 696e 5f63 6875 6e6b   idxmaxmin_chunk
-00044660: 2878 2c20 666e 3d4e 6f6e 652c 2073 6b69  (x, fn=None, ski
-00044670: 706e 613d 5472 7565 293a 0a20 2020 206d  pna=True):.    m
-00044680: 696e 6d61 7820 3d20 226d 6178 2220 6966  inmax = "max" if
-00044690: 2066 6e20 3d3d 2022 6964 786d 6178 2220   fn == "idxmax" 
-000446a0: 656c 7365 2022 6d69 6e22 0a20 2020 2069  else "min".    i
-000446b0: 6620 6c65 6e28 7829 203e 2030 3a0a 2020  f len(x) > 0:.  
-000446c0: 2020 2020 2020 6964 7820 3d20 6765 7461        idx = geta
-000446d0: 7474 7228 782c 2066 6e29 2873 6b69 706e  ttr(x, fn)(skipn
-000446e0: 613d 736b 6970 6e61 290a 2020 2020 2020  a=skipna).      
-000446f0: 2020 7661 6c75 6520 3d20 6765 7461 7474    value = getatt
-00044700: 7228 782c 206d 696e 6d61 7829 2873 6b69  r(x, minmax)(ski
-00044710: 706e 613d 736b 6970 6e61 290a 2020 2020  pna=skipna).    
-00044720: 656c 7365 3a0a 2020 2020 2020 2020 6964  else:.        id
-00044730: 7820 3d20 7661 6c75 6520 3d20 6d65 7461  x = value = meta
-00044740: 5f73 6572 6965 735f 636f 6e73 7472 7563  _series_construc
-00044750: 746f 7228 7829 285b 5d2c 2064 7479 7065  tor(x)([], dtype
-00044760: 3d22 6938 2229 0a20 2020 2069 6620 6973  ="i8").    if is
-00044770: 5f73 6572 6965 735f 6c69 6b65 2869 6478  _series_like(idx
-00044780: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00044790: 6e20 6d65 7461 5f66 7261 6d65 5f63 6f6e  n meta_frame_con
-000447a0: 7374 7275 6374 6f72 2878 2928 7b22 6964  structor(x)({"id
-000447b0: 7822 3a20 6964 782c 2022 7661 6c75 6522  x": idx, "value"
-000447c0: 3a20 7661 6c75 657d 290a 2020 2020 7265  : value}).    re
-000447d0: 7475 726e 206d 6574 615f 6672 616d 655f  turn meta_frame_
-000447e0: 636f 6e73 7472 7563 746f 7228 7829 287b  constructor(x)({
-000447f0: 2269 6478 223a 205b 6964 785d 2c20 2276  "idx": [idx], "v
-00044800: 616c 7565 223a 205b 7661 6c75 655d 7d29  alue": [value]})
-00044810: 0a0a 0a64 6566 2069 6478 6d61 786d 696e  ...def idxmaxmin
-00044820: 5f72 6f77 2878 2c20 666e 3d4e 6f6e 652c  _row(x, fn=None,
-00044830: 2073 6b69 706e 613d 5472 7565 293a 0a20   skipna=True):. 
-00044840: 2020 206d 696e 6d61 7820 3d20 226d 6178     minmax = "max
-00044850: 2220 6966 2066 6e20 3d3d 2022 6964 786d  " if fn == "idxm
-00044860: 6178 2220 656c 7365 2022 6d69 6e22 0a20  ax" else "min". 
-00044870: 2020 2069 6620 6c65 6e28 7829 203e 2030     if len(x) > 0
-00044880: 3a0a 2020 2020 2020 2020 7820 3d20 782e  :.        x = x.
-00044890: 7365 745f 696e 6465 7828 2269 6478 2229  set_index("idx")
-000448a0: 0a20 2020 2020 2020 2069 6478 203d 205b  .        idx = [
-000448b0: 6765 7461 7474 7228 782e 7661 6c75 652c  getattr(x.value,
-000448c0: 2066 6e29 2873 6b69 706e 613d 736b 6970   fn)(skipna=skip
-000448d0: 6e61 295d 0a20 2020 2020 2020 2076 616c  na)].        val
-000448e0: 7565 203d 205b 6765 7461 7474 7228 782e  ue = [getattr(x.
-000448f0: 7661 6c75 652c 206d 696e 6d61 7829 2873  value, minmax)(s
-00044900: 6b69 706e 613d 736b 6970 6e61 295d 0a20  kipna=skipna)]. 
-00044910: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00044920: 2069 6478 203d 2076 616c 7565 203d 206d   idx = value = m
-00044930: 6574 615f 7365 7269 6573 5f63 6f6e 7374  eta_series_const
-00044940: 7275 6374 6f72 2878 2928 5b5d 2c20 6474  ructor(x)([], dt
-00044950: 7970 653d 2269 3822 290a 2020 2020 7265  ype="i8").    re
-00044960: 7475 726e 206d 6574 615f 6672 616d 655f  turn meta_frame_
-00044970: 636f 6e73 7472 7563 746f 7228 7829 287b  constructor(x)({
-00044980: 2269 6478 223a 2069 6478 2c20 2276 616c  "idx": idx, "val
-00044990: 7565 223a 2076 616c 7565 7d29 0a0a 0a64  ue": value})...d
-000449a0: 6566 2069 6478 6d61 786d 696e 5f63 6f6d  ef idxmaxmin_com
-000449b0: 6269 6e65 2878 2c20 666e 3d4e 6f6e 652c  bine(x, fn=None,
-000449c0: 2073 6b69 706e 613d 5472 7565 293a 0a20   skipna=True):. 
-000449d0: 2020 2069 6620 6c65 6e28 7829 203c 3d20     if len(x) <= 
-000449e0: 313a 0a20 2020 2020 2020 2072 6574 7572  1:.        retur
-000449f0: 6e20 780a 2020 2020 7265 7475 726e 2028  n x.    return (
-00044a00: 0a20 2020 2020 2020 2078 2e67 726f 7570  .        x.group
-00044a10: 6279 286c 6576 656c 3d30 290a 2020 2020  by(level=0).    
-00044a20: 2020 2020 2e61 7070 6c79 2869 6478 6d61      .apply(idxma
-00044a30: 786d 696e 5f72 6f77 2c20 666e 3d66 6e2c  xmin_row, fn=fn,
-00044a40: 2073 6b69 706e 613d 736b 6970 6e61 290a   skipna=skipna).
-00044a50: 2020 2020 2020 2020 2e72 6573 6574 5f69          .reset_i
-00044a60: 6e64 6578 286c 6576 656c 3d31 2c20 6472  ndex(level=1, dr
-00044a70: 6f70 3d54 7275 6529 0a20 2020 2029 0a0a  op=True).    )..
-00044a80: 0a64 6566 2069 6478 6d61 786d 696e 5f61  .def idxmaxmin_a
-00044a90: 6767 2878 2c20 666e 3d4e 6f6e 652c 2073  gg(x, fn=None, s
-00044aa0: 6b69 706e 613d 5472 7565 2c20 7363 616c  kipna=True, scal
-00044ab0: 6172 3d46 616c 7365 293a 0a20 2020 2072  ar=False):.    r
-00044ac0: 6573 203d 2069 6478 6d61 786d 696e 5f63  es = idxmaxmin_c
-00044ad0: 6f6d 6269 6e65 2878 2c20 666e 2c20 736b  ombine(x, fn, sk
-00044ae0: 6970 6e61 3d73 6b69 706e 6129 5b22 6964  ipna=skipna)["id
-00044af0: 7822 5d0a 2020 2020 6966 206c 656e 2872  x"].    if len(r
-00044b00: 6573 2920 3d3d 2030 3a0a 2020 2020 2020  es) == 0:.      
-00044b10: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00044b20: 6f72 2822 6174 7465 6d70 7420 746f 2067  or("attempt to g
-00044b30: 6574 2061 7267 6d61 7820 6f66 2061 6e20  et argmax of an 
-00044b40: 656d 7074 7920 7365 7175 656e 6365 2229  empty sequence")
-00044b50: 0a20 2020 2069 6620 7363 616c 6172 3a0a  .    if scalar:.
-00044b60: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00044b70: 6573 5b30 5d0a 2020 2020 7265 732e 6e61  es[0].    res.na
-00044b80: 6d65 203d 204e 6f6e 650a 2020 2020 7265  me = None.    re
-00044b90: 7475 726e 2072 6573 0a0a 0a64 6566 205f  turn res...def _
-00044ba0: 6d6f 6465 5f61 6767 7265 6761 7465 2864  mode_aggregate(d
-00044bb0: 662c 2064 726f 706e 6129 3a0a 2020 2020  f, dropna):.    
-00044bc0: 7661 6c75 655f 636f 756e 745f 7365 7269  value_count_seri
-00044bd0: 6573 203d 2064 662e 7375 6d28 290a 2020  es = df.sum().  
-00044be0: 2020 6d61 785f 7661 6c20 3d20 7661 6c75    max_val = valu
-00044bf0: 655f 636f 756e 745f 7365 7269 6573 2e6d  e_count_series.m
-00044c00: 6178 2873 6b69 706e 613d 6472 6f70 6e61  ax(skipna=dropna
-00044c10: 290a 2020 2020 6d6f 6465 5f73 6572 6965  ).    mode_serie
-00044c20: 7320 3d20 280a 2020 2020 2020 2020 7661  s = (.        va
-00044c30: 6c75 655f 636f 756e 745f 7365 7269 6573  lue_count_series
-00044c40: 5b76 616c 7565 5f63 6f75 6e74 5f73 6572  [value_count_ser
-00044c50: 6965 7320 3d3d 206d 6178 5f76 616c 5d0a  ies == max_val].
-00044c60: 2020 2020 2020 2020 2e69 6e64 6578 2e74          .index.t
-00044c70: 6f5f 7365 7269 6573 2829 0a20 2020 2020  o_series().     
-00044c80: 2020 202e 736f 7274 5f76 616c 7565 7328     .sort_values(
-00044c90: 290a 2020 2020 2020 2020 2e72 6573 6574  ).        .reset
-00044ca0: 5f69 6e64 6578 2864 726f 703d 5472 7565  _index(drop=True
-00044cb0: 290a 2020 2020 290a 2020 2020 7265 7475  ).    ).    retu
-00044cc0: 726e 206d 6f64 655f 7365 7269 6573 0a0a  rn mode_series..
-00044cd0: 0a64 6566 205f 636f 756e 745f 6167 6772  .def _count_aggr
-00044ce0: 6567 6174 6528 7829 3a0a 2020 2020 7265  egate(x):.    re
-00044cf0: 7475 726e 2078 2e73 756d 2829 2e61 7374  turn x.sum().ast
-00044d00: 7970 6528 2269 6e74 3634 2229 0a0a 0a64  ype("int64")...d
-00044d10: 6566 2073 6166 655f 6865 6164 2864 662c  ef safe_head(df,
-00044d20: 206e 293a 0a20 2020 2072 203d 204d 2e68   n):.    r = M.h
-00044d30: 6561 6428 6466 2c20 6e29 0a20 2020 2069  ead(df, n).    i
-00044d40: 6620 6c65 6e28 7229 2021 3d20 6e3a 0a20  f len(r) != n:. 
-00044d50: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-00044d60: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
-00044d70: 2020 6622 496e 7375 6666 6963 6965 6e74    f"Insufficient
-00044d80: 2065 6c65 6d65 6e74 7320 666f 7220 6068   elements for `h
-00044d90: 6561 6460 2e20 7b6e 7d20 656c 656d 656e  ead`. {n} elemen
-00044da0: 7473 2072 6571 7565 7374 6564 2c20 6f6e  ts requested, on
-00044db0: 6c79 207b 6c65 6e28 7229 7d20 220a 2020  ly {len(r)} ".  
-00044dc0: 2020 2020 2020 2020 2020 2265 6c65 6d65            "eleme
-00044dd0: 6e74 7320 6176 6169 6c61 626c 652e 2054  nts available. T
-00044de0: 7279 2070 6173 7369 6e67 206c 6172 6765  ry passing large
-00044df0: 7220 606e 7061 7274 6974 696f 6e73 6020  r `npartitions` 
-00044e00: 746f 2060 6865 6164 602e 220a 2020 2020  to `head`.".    
-00044e10: 2020 2020 290a 2020 2020 7265 7475 726e      ).    return
-00044e20: 2072 0a0a 0a64 6566 206d 6179 6265 5f73   r...def maybe_s
-00044e30: 6869 6674 5f64 6976 6973 696f 6e73 2864  hift_divisions(d
-00044e40: 662c 2070 6572 696f 6473 2c20 6672 6571  f, periods, freq
-00044e50: 293a 0a20 2020 2022 2222 4d61 7962 6520  ):.    """Maybe 
-00044e60: 7368 6966 7420 6469 7669 7369 6f6e 7320  shift divisions 
-00044e70: 6279 2070 6572 696f 6473 206f 6620 7369  by periods of si
-00044e80: 7a65 2066 7265 710a 0a20 2020 2055 7365  ze freq..    Use
-00044e90: 6420 746f 2073 6869 6674 2074 6865 2064  d to shift the d
-00044ea0: 6976 6973 696f 6e73 2066 6f72 2074 6865  ivisions for the
-00044eb0: 2060 7368 6966 7460 206d 6574 686f 642e   `shift` method.
-00044ec0: 2049 6620 6672 6571 2069 736e 2774 2061   If freq isn't a
-00044ed0: 2066 6978 6564 0a20 2020 2073 697a 6520   fixed.    size 
-00044ee0: 286e 6f74 2061 6e63 686f 7265 6420 6f72  (not anchored or
-00044ef0: 2072 656c 6174 6976 6529 2c20 7468 656e   relative), then
-00044f00: 2074 6865 2064 6976 6973 696f 6e73 2061   the divisions a
-00044f10: 7265 2073 6869 6674 6564 0a20 2020 2061  re shifted.    a
-00044f20: 7070 726f 7072 6961 7465 6c79 2e20 4f74  ppropriately. Ot
-00044f30: 6865 7277 6973 6520 7468 6520 6469 7669  herwise the divi
-00044f40: 7369 6f6e 7320 6172 6520 636c 6561 7265  sions are cleare
-00044f50: 642e 0a0a 2020 2020 5061 7261 6d65 7465  d...    Paramete
-00044f60: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00044f70: 2d0a 2020 2020 6466 203a 2064 642e 4461  -.    df : dd.Da
-00044f80: 7461 4672 616d 652c 2064 642e 5365 7269  taFrame, dd.Seri
-00044f90: 6573 2c20 6f72 2064 642e 496e 6465 780a  es, or dd.Index.
-00044fa0: 2020 2020 7065 7269 6f64 7320 3a20 696e      periods : in
-00044fb0: 740a 2020 2020 2020 2020 5468 6520 6e75  t.        The nu
-00044fc0: 6d62 6572 206f 6620 7065 7269 6f64 7320  mber of periods 
-00044fd0: 746f 2073 6869 6674 2e0a 2020 2020 6672  to shift..    fr
-00044fe0: 6571 203a 2044 6174 654f 6666 7365 742c  eq : DateOffset,
-00044ff0: 2074 696d 6564 656c 7461 2c20 6f72 2074   timedelta, or t
-00045000: 696d 6520 7275 6c65 2073 7472 696e 670a  ime rule string.
-00045010: 2020 2020 2020 2020 5468 6520 6672 6571          The freq
-00045020: 7565 6e63 7920 746f 2073 6869 6674 2062  uency to shift b
-00045030: 792e 0a20 2020 2022 2222 0a20 2020 2069  y..    """.    i
-00045040: 6620 6973 696e 7374 616e 6365 2866 7265  f isinstance(fre
-00045050: 712c 2073 7472 293a 0a20 2020 2020 2020  q, str):.       
-00045060: 2066 7265 7120 3d20 7064 2e74 7365 7269   freq = pd.tseri
-00045070: 6573 2e66 7265 7175 656e 6369 6573 2e74  es.frequencies.t
-00045080: 6f5f 6f66 6673 6574 2866 7265 7129 0a0a  o_offset(freq)..
-00045090: 2020 2020 6973 5f6f 6666 7365 7420 3d20      is_offset = 
-000450a0: 6973 696e 7374 616e 6365 2866 7265 712c  isinstance(freq,
-000450b0: 2070 642e 4461 7465 4f66 6673 6574 290a   pd.DateOffset).
-000450c0: 2020 2020 6966 2069 735f 6f66 6673 6574      if is_offset
-000450d0: 3a0a 2020 2020 2020 2020 6966 2066 7265  :.        if fre
-000450e0: 712e 6973 5f61 6e63 686f 7265 6428 2920  q.is_anchored() 
-000450f0: 6f72 206e 6f74 2068 6173 6174 7472 2866  or not hasattr(f
-00045100: 7265 712c 2022 6465 6c74 6122 293a 0a20  req, "delta"):. 
-00045110: 2020 2020 2020 2020 2020 2023 2043 616e             # Can
-00045120: 2774 2069 6e66 6572 2064 6976 6973 696f  't infer divisio
-00045130: 6e73 206f 6e20 7265 6c61 7469 7665 206f  ns on relative o
-00045140: 7220 616e 6368 6f72 6564 206f 6666 7365  r anchored offse
-00045150: 7473 2c20 6173 0a20 2020 2020 2020 2020  ts, as.         
-00045160: 2020 2023 2064 6976 6973 696f 6e73 206d     # divisions m
-00045170: 6179 206e 6f77 2073 706c 6974 2069 6465  ay now split ide
-00045180: 6e74 6963 616c 2069 6e64 6578 2076 616c  ntical index val
-00045190: 7565 2e0a 2020 2020 2020 2020 2020 2020  ue..            
-000451a0: 2320 2865 2e67 2e20 696e 6465 785f 7061  # (e.g. index_pa
-000451b0: 7274 6974 696f 6e73 203d 205b 5b31 2c20  rtitions = [[1, 
-000451c0: 322c 2033 5d2c 205b 332c 2034 2c20 355d  2, 3], [3, 4, 5]
-000451d0: 5d29 0a20 2020 2020 2020 2020 2020 2072  ]).            r
-000451e0: 6574 7572 6e20 6466 2e63 6c65 6172 5f64  eturn df.clear_d
-000451f0: 6976 6973 696f 6e73 2829 0a20 2020 2069  ivisions().    i
-00045200: 6620 6466 2e6b 6e6f 776e 5f64 6976 6973  f df.known_divis
-00045210: 696f 6e73 3a0a 2020 2020 2020 2020 6469  ions:.        di
-00045220: 7673 203d 2070 642e 5365 7269 6573 2872  vs = pd.Series(r
-00045230: 616e 6765 286c 656e 2864 662e 6469 7669  ange(len(df.divi
-00045240: 7369 6f6e 7329 292c 2069 6e64 6578 3d64  sions)), index=d
-00045250: 662e 6469 7669 7369 6f6e 7329 0a20 2020  f.divisions).   
-00045260: 2020 2020 2064 6976 6973 696f 6e73 203d       divisions =
-00045270: 2064 6976 732e 7368 6966 7428 7065 7269   divs.shift(peri
-00045280: 6f64 732c 2066 7265 713d 6672 6571 292e  ods, freq=freq).
-00045290: 696e 6465 780a 2020 2020 2020 2020 7265  index.        re
-000452a0: 7475 726e 2064 662e 5f5f 636c 6173 735f  turn df.__class_
-000452b0: 5f28 6466 2e64 6173 6b2c 2064 662e 5f6e  _(df.dask, df._n
-000452c0: 616d 652c 2064 662e 5f6d 6574 612c 2064  ame, df._meta, d
-000452d0: 6976 6973 696f 6e73 290a 2020 2020 7265  ivisions).    re
-000452e0: 7475 726e 2064 660a 0a0a 4077 7261 7073  turn df...@wraps
-000452f0: 2870 642e 746f 5f64 6174 6574 696d 6529  (pd.to_datetime)
-00045300: 0a64 6566 2074 6f5f 6461 7465 7469 6d65  .def to_datetime
-00045310: 2861 7267 2c20 6d65 7461 3d4e 6f6e 652c  (arg, meta=None,
-00045320: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00045330: 747a 5f6b 7761 7267 203d 207b 2274 7a22  tz_kwarg = {"tz"
-00045340: 3a20 2275 7463 227d 2069 6620 6b77 6172  : "utc"} if kwar
-00045350: 6773 2e67 6574 2822 7574 6322 2920 656c  gs.get("utc") el
-00045360: 7365 207b 7d0a 2020 2020 6966 206d 6574  se {}.    if met
-00045370: 6120 6973 204e 6f6e 653a 0a20 2020 2020  a is None:.     
-00045380: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00045390: 2861 7267 2c20 496e 6465 7829 3a0a 2020  (arg, Index):.  
-000453a0: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
-000453b0: 2070 642e 4461 7465 7469 6d65 496e 6465   pd.DatetimeInde
-000453c0: 7828 5b5d 2c20 2a2a 747a 5f6b 7761 7267  x([], **tz_kwarg
-000453d0: 290a 2020 2020 2020 2020 2020 2020 6d65  ).            me
-000453e0: 7461 2e6e 616d 6520 3d20 6172 672e 6e61  ta.name = arg.na
-000453f0: 6d65 0a20 2020 2020 2020 2065 6c69 6620  me.        elif 
-00045400: 6e6f 7420 2869 735f 6461 7461 6672 616d  not (is_datafram
-00045410: 655f 6c69 6b65 2861 7267 2920 6f72 2069  e_like(arg) or i
-00045420: 735f 7365 7269 6573 5f6c 696b 6528 6172  s_series_like(ar
-00045430: 6729 293a 0a20 2020 2020 2020 2020 2020  g)):.           
-00045440: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-00045450: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
-00045460: 2020 2020 2020 2020 2020 2020 2264 6173              "das
-00045470: 6b2e 6461 7461 6672 616d 652e 746f 5f64  k.dataframe.to_d
-00045480: 6174 6574 696d 6520 646f 6573 206e 6f74  atetime does not
-00045490: 2073 7570 706f 7274 2022 0a20 2020 2020   support ".     
-000454a0: 2020 2020 2020 2020 2020 2022 6e6f 6e2d             "non-
-000454b0: 696e 6465 782d 6162 6c65 2061 7267 756d  index-able argum
-000454c0: 656e 7473 2028 6c69 6b65 2073 6361 6c61  ents (like scala
-000454d0: 7273 2922 0a20 2020 2020 2020 2020 2020  rs)".           
-000454e0: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
-000454f0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00045500: 6120 3d20 6d65 7461 5f73 6572 6965 735f  a = meta_series_
-00045510: 636f 6e73 7472 7563 746f 7228 6172 6729  constructor(arg)
-00045520: 285b 7064 2e54 696d 6573 7461 6d70 2822  ([pd.Timestamp("
-00045530: 3230 3030 222c 202a 2a74 7a5f 6b77 6172  2000", **tz_kwar
-00045540: 6729 5d29 0a20 2020 2020 2020 2020 2020  g)]).           
-00045550: 206d 6574 612e 696e 6465 7820 3d20 6d65   meta.index = me
-00045560: 7461 2e69 6e64 6578 2e61 7374 7970 6528  ta.index.astype(
-00045570: 6172 672e 696e 6465 782e 6474 7970 6529  arg.index.dtype)
-00045580: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00045590: 612e 696e 6465 782e 6e61 6d65 203d 2061  a.index.name = a
-000455a0: 7267 2e69 6e64 6578 2e6e 616d 650a 2020  rg.index.name.  
-000455b0: 2020 6966 2050 414e 4441 535f 4754 5f32    if PANDAS_GT_2
-000455c0: 3030 2061 6e64 2022 696e 6665 725f 6461  00 and "infer_da
-000455d0: 7465 7469 6d65 5f66 6f72 6d61 7422 2069  tetime_format" i
-000455e0: 6e20 6b77 6172 6773 3a0a 2020 2020 2020  n kwargs:.      
-000455f0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-00045600: 0a20 2020 2020 2020 2020 2020 2022 5468  .            "Th
-00045610: 6520 6172 6775 6d65 6e74 2027 696e 6665  e argument 'infe
-00045620: 725f 6461 7465 7469 6d65 5f66 6f72 6d61  r_datetime_forma
-00045630: 7427 2069 7320 6465 7072 6563 6174 6564  t' is deprecated
-00045640: 2061 6e64 2077 696c 6c20 6265 2072 656d   and will be rem
-00045650: 6f76 6564 2069 6e20 6120 6675 7475 7265  oved in a future
-00045660: 2076 6572 7369 6f6e 2e20 220a 2020 2020   version. ".    
-00045670: 2020 2020 2020 2020 2241 2073 7472 6963          "A stric
-00045680: 7420 7665 7273 696f 6e20 6f66 2069 7420  t version of it 
-00045690: 6973 206e 6f77 2074 6865 2064 6566 6175  is now the defau
-000456a0: 6c74 2c20 7365 6520 220a 2020 2020 2020  lt, see ".      
-000456b0: 2020 2020 2020 2268 7474 7073 3a2f 2f70        "https://p
-000456c0: 616e 6461 732e 7079 6461 7461 2e6f 7267  andas.pydata.org
-000456d0: 2f70 6465 7073 2f30 3030 342d 636f 6e73  /pdeps/0004-cons
-000456e0: 6973 7465 6e74 2d74 6f2d 6461 7465 7469  istent-to-dateti
-000456f0: 6d65 2d70 6172 7369 6e67 2e68 746d 6c2e  me-parsing.html.
-00045700: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
-00045710: 596f 7520 6361 6e20 7361 6665 6c79 2072  You can safely r
-00045720: 656d 6f76 6520 7468 6973 2061 7267 756d  emove this argum
-00045730: 656e 742e 222c 0a20 2020 2020 2020 2020  ent.",.         
-00045740: 2020 2055 7365 7257 6172 6e69 6e67 2c0a     UserWarning,.
-00045750: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00045760: 2020 6b77 6172 6773 2e70 6f70 2822 696e    kwargs.pop("in
-00045770: 6665 725f 6461 7465 7469 6d65 5f66 6f72  fer_datetime_for
-00045780: 6d61 7422 290a 0a20 2020 2072 6574 7572  mat")..    retur
-00045790: 6e20 6d61 705f 7061 7274 6974 696f 6e73  n map_partitions
-000457a0: 2870 642e 746f 5f64 6174 6574 696d 652c  (pd.to_datetime,
-000457b0: 2061 7267 2c20 6d65 7461 3d6d 6574 612c   arg, meta=meta,
-000457c0: 202a 2a6b 7761 7267 7329 0a0a 0a40 7772   **kwargs)...@wr
-000457d0: 6170 7328 7064 2e74 6f5f 7469 6d65 6465  aps(pd.to_timede
-000457e0: 6c74 6129 0a64 6566 2074 6f5f 7469 6d65  lta).def to_time
-000457f0: 6465 6c74 6128 6172 672c 2075 6e69 743d  delta(arg, unit=
-00045800: 4e6f 6e65 2c20 6572 726f 7273 3d22 7261  None, errors="ra
-00045810: 6973 6522 293a 0a20 2020 206d 6574 6120  ise"):.    meta 
-00045820: 3d20 6d65 7461 5f73 6572 6965 735f 636f  = meta_series_co
-00045830: 6e73 7472 7563 746f 7228 6172 6729 285b  nstructor(arg)([
-00045840: 7064 2e54 696d 6564 656c 7461 2831 2c20  pd.Timedelta(1, 
-00045850: 756e 6974 3d75 6e69 7429 5d29 0a20 2020  unit=unit)]).   
-00045860: 2072 6574 7572 6e20 6d61 705f 7061 7274   return map_part
-00045870: 6974 696f 6e73 2870 642e 746f 5f74 696d  itions(pd.to_tim
-00045880: 6564 656c 7461 2c20 6172 672c 2075 6e69  edelta, arg, uni
-00045890: 743d 756e 6974 2c20 6572 726f 7273 3d65  t=unit, errors=e
-000458a0: 7272 6f72 732c 206d 6574 613d 6d65 7461  rrors, meta=meta
-000458b0: 290a 0a0a 6966 2068 6173 6174 7472 2870  )...if hasattr(p
-000458c0: 642c 2022 6973 6e61 2229 3a0a 0a20 2020  d, "isna"):..   
-000458d0: 2040 7772 6170 7328 7064 2e69 736e 6129   @wraps(pd.isna)
-000458e0: 0a20 2020 2064 6566 2069 736e 6128 6172  .    def isna(ar
-000458f0: 6729 3a0a 2020 2020 2020 2020 7265 7475  g):.        retu
-00045900: 726e 206d 6170 5f70 6172 7469 7469 6f6e  rn map_partition
-00045910: 7328 7064 2e69 736e 612c 2061 7267 290a  s(pd.isna, arg).
-00045920: 0a0a 6465 6620 5f72 6570 725f 6461 7461  ..def _repr_data
-00045930: 5f73 6572 6965 7328 732c 2069 6e64 6578  _series(s, index
-00045940: 293a 0a20 2020 2022 2222 4120 6865 6c70  ):.    """A help
-00045950: 6572 2066 6f72 2063 7265 6174 696e 6720  er for creating 
-00045960: 7468 6520 6060 5f72 6570 725f 6461 7461  the ``_repr_data
-00045970: 6060 2070 726f 7065 7274 7922 2222 0a20  `` property""". 
-00045980: 2020 206e 7061 7274 6974 696f 6e73 203d     npartitions =
-00045990: 206c 656e 2869 6e64 6578 2920 2d20 310a   len(index) - 1.
-000459a0: 2020 2020 6966 2069 735f 6361 7465 676f      if is_catego
-000459b0: 7269 6361 6c5f 6474 7970 6528 7329 3a0a  rical_dtype(s):.
-000459c0: 2020 2020 2020 2020 6966 2068 6173 5f6b          if has_k
-000459d0: 6e6f 776e 5f63 6174 6567 6f72 6965 7328  nown_categories(
-000459e0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-000459f0: 6474 7970 6520 3d20 2263 6174 6567 6f72  dtype = "categor
-00045a00: 795b 6b6e 6f77 6e5d 220a 2020 2020 2020  y[known]".      
-00045a10: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00045a20: 2020 2020 6474 7970 6520 3d20 2263 6174      dtype = "cat
-00045a30: 6567 6f72 795b 756e 6b6e 6f77 6e5d 220a  egory[unknown]".
-00045a40: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00045a50: 2020 6474 7970 6520 3d20 7374 7228 732e    dtype = str(s.
-00045a60: 6474 7970 6529 0a20 2020 2072 6574 7572  dtype).    retur
-00045a70: 6e20 7064 2e53 6572 6965 7328 5b64 7479  n pd.Series([dty
-00045a80: 7065 5d20 2b20 5b22 2e2e 2e22 5d20 2a20  pe] + ["..."] * 
-00045a90: 6e70 6172 7469 7469 6f6e 732c 2069 6e64  npartitions, ind
-00045aa0: 6578 3d69 6e64 6578 2c20 6e61 6d65 3d73  ex=index, name=s
-00045ab0: 2e6e 616d 6529 0a0a 0a64 6566 2068 6173  .name)...def has
-00045ac0: 5f70 6172 616c 6c65 6c5f 7479 7065 2878  _parallel_type(x
-00045ad0: 293a 0a20 2020 2022 2222 446f 6573 2074  ):.    """Does t
-00045ae0: 6869 7320 6f62 6a65 6374 2068 6176 6520  his object have 
-00045af0: 6120 6461 736b 2064 6174 6166 7261 6d65  a dask dataframe
-00045b00: 2065 7175 6976 616c 656e 743f 2222 220a   equivalent?""".
-00045b10: 2020 2020 7265 7475 726e 2067 6574 5f70      return get_p
-00045b20: 6172 616c 6c65 6c5f 7479 7065 2878 2920  arallel_type(x) 
-00045b30: 6973 206e 6f74 2053 6361 6c61 720a 0a0a  is not Scalar...
-00045b40: 6465 6620 6e65 775f 6464 5f6f 626a 6563  def new_dd_objec
-00045b50: 7428 6473 6b2c 206e 616d 652c 206d 6574  t(dsk, name, met
-00045b60: 612c 2064 6976 6973 696f 6e73 2c20 7061  a, divisions, pa
-00045b70: 7265 6e74 5f6d 6574 613d 4e6f 6e65 293a  rent_meta=None):
-00045b80: 0a20 2020 2022 2222 4765 6e65 7269 6320  .    """Generic 
-00045b90: 636f 6e73 7472 7563 746f 7220 666f 7220  constructor for 
-00045ba0: 6461 736b 2e64 6174 6166 7261 6d65 206f  dask.dataframe o
-00045bb0: 626a 6563 7473 2e0a 0a20 2020 2044 6563  bjects...    Dec
-00045bc0: 6964 6573 2074 6865 2061 7070 726f 7072  ides the appropr
-00045bd0: 6961 7465 206f 7574 7075 7420 636c 6173  iate output clas
-00045be0: 7320 6261 7365 6420 6f6e 2074 6865 2074  s based on the t
-00045bf0: 7970 6520 6f66 2060 6d65 7461 6020 7072  ype of `meta` pr
-00045c00: 6f76 6964 6564 2e0a 2020 2020 2222 220a  ovided..    """.
-00045c10: 2020 2020 6966 2068 6173 5f70 6172 616c      if has_paral
-00045c20: 6c65 6c5f 7479 7065 286d 6574 6129 3a0a  lel_type(meta):.
-00045c30: 2020 2020 2020 2020 7265 7475 726e 2067          return g
-00045c40: 6574 5f70 6172 616c 6c65 6c5f 7479 7065  et_parallel_type
-00045c50: 286d 6574 6129 2864 736b 2c20 6e61 6d65  (meta)(dsk, name
-00045c60: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
-00045c70: 7329 0a20 2020 2065 6c69 6620 6973 5f61  s).    elif is_a
-00045c80: 7272 6179 6c69 6b65 286d 6574 6129 2061  rraylike(meta) a
-00045c90: 6e64 206d 6574 612e 7368 6170 653a 0a20  nd meta.shape:. 
-00045ca0: 2020 2020 2020 2069 6d70 6f72 7420 6461         import da
-00045cb0: 736b 2e61 7272 6179 2061 7320 6461 0a0a  sk.array as da..
-00045cc0: 2020 2020 2020 2020 6368 756e 6b73 203d          chunks =
-00045cd0: 2028 286e 702e 6e61 6e2c 2920 2a20 286c   ((np.nan,) * (l
-00045ce0: 656e 2864 6976 6973 696f 6e73 2920 2d20  en(divisions) - 
-00045cf0: 3129 2c29 202b 2074 7570 6c65 280a 2020  1),) + tuple(.  
-00045d00: 2020 2020 2020 2020 2020 2864 2c29 2066            (d,) f
-00045d10: 6f72 2064 2069 6e20 6d65 7461 2e73 6861  or d in meta.sha
-00045d20: 7065 5b31 3a5d 0a20 2020 2020 2020 2029  pe[1:].        )
-00045d30: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-00045d40: 6368 756e 6b73 2920 3e20 313a 0a20 2020  chunks) > 1:.   
-00045d50: 2020 2020 2020 2020 206c 6179 6572 203d           layer =
-00045d60: 2064 736b 2e6c 6179 6572 735b 6e61 6d65   dsk.layers[name
-00045d70: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
-00045d80: 2069 7369 6e73 7461 6e63 6528 6c61 7965   isinstance(laye
-00045d90: 722c 2042 6c6f 636b 7769 7365 293a 0a20  r, Blockwise):. 
-00045da0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00045db0: 6179 6572 2e6e 6577 5f61 7865 735b 226a  ayer.new_axes["j
-00045dc0: 225d 203d 2063 6875 6e6b 735b 315d 5b30  "] = chunks[1][0
-00045dd0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00045de0: 2020 6c61 7965 722e 6f75 7470 7574 5f69    layer.output_i
-00045df0: 6e64 6963 6573 203d 206c 6179 6572 2e6f  ndices = layer.o
-00045e00: 7574 7075 745f 696e 6469 6365 7320 2b20  utput_indices + 
-00045e10: 2822 6a22 2c29 0a20 2020 2020 2020 2020  ("j",).         
-00045e20: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00045e30: 2020 2020 2020 2020 2073 7566 6669 7820           suffix 
-00045e40: 3d20 2830 2c29 202a 2028 6c65 6e28 6368  = (0,) * (len(ch
-00045e50: 756e 6b73 2920 2d20 3129 0a20 2020 2020  unks) - 1).     
-00045e60: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00045e70: 2069 6e20 7261 6e67 6528 6c65 6e28 6368   in range(len(ch
-00045e80: 756e 6b73 5b30 5d29 293a 0a20 2020 2020  unks[0])):.     
-00045e90: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00045ea0: 6179 6572 5b28 6e61 6d65 2c20 6929 202b  ayer[(name, i) +
-00045eb0: 2073 7566 6669 785d 203d 206c 6179 6572   suffix] = layer
-00045ec0: 2e70 6f70 2828 6e61 6d65 2c20 6929 290a  .pop((name, i)).
-00045ed0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-00045ee0: 612e 4172 7261 7928 6473 6b2c 206e 616d  a.Array(dsk, nam
-00045ef0: 653d 6e61 6d65 2c20 6368 756e 6b73 3d63  e=name, chunks=c
-00045f00: 6875 6e6b 732c 2064 7479 7065 3d6d 6574  hunks, dtype=met
-00045f10: 612e 6474 7970 6529 0a20 2020 2065 6c73  a.dtype).    els
-00045f20: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
-00045f30: 6e20 6765 745f 7061 7261 6c6c 656c 5f74  n get_parallel_t
-00045f40: 7970 6528 6d65 7461 2928 6473 6b2c 206e  ype(meta)(dsk, n
-00045f50: 616d 652c 206d 6574 612c 2064 6976 6973  ame, meta, divis
-00045f60: 696f 6e73 290a 0a0a 6465 6620 7061 7274  ions)...def part
-00045f70: 6974 696f 6e77 6973 655f 6772 6170 6828  itionwise_graph(
-00045f80: 6675 6e63 2c20 6c61 7965 725f 6e61 6d65  func, layer_name
-00045f90: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00045fa0: 7329 3a0a 2020 2020 2222 220a 2020 2020  s):.    """.    
-00045fb0: 4170 706c 7920 6120 6675 6e63 7469 6f6e  Apply a function
-00045fc0: 2070 6172 7469 7469 6f6e 2d77 6973 6520   partition-wise 
-00045fd0: 6163 726f 7373 2061 7267 756d 656e 7473  across arguments
-00045fe0: 2074 6f20 6372 6561 7465 206c 6179 6572   to create layer
-00045ff0: 206f 6620 6120 6772 6170 680a 0a20 2020   of a graph..   
-00046000: 2054 6869 7320 6170 706c 6965 7320 6120   This applies a 
-00046010: 6675 6e63 7469 6f6e 2c20 6060 6675 6e63  function, ``func
-00046020: 6060 2c20 696e 2061 6e20 656d 6261 7272  ``, in an embarr
-00046030: 6173 7369 6e67 6c79 2070 6172 616c 6c65  assingly paralle
-00046040: 6c20 6661 7368 696f 6e0a 2020 2020 6163  l fashion.    ac
-00046050: 726f 7373 2070 6172 7469 7469 6f6e 732f  ross partitions/
-00046060: 6368 756e 6b73 2069 6e20 7468 6520 7072  chunks in the pr
-00046070: 6f76 6964 6564 2061 7267 756d 656e 7473  ovided arguments
-00046080: 2e20 2049 7420 6861 6e64 6c65 7320 4461  .  It handles Da
-00046090: 7461 6672 616d 6573 2c0a 2020 2020 4172  taframes,.    Ar
-000460a0: 7261 7973 2c20 616e 6420 7363 616c 6172  rays, and scalar
-000460b0: 7320 736d 6f6f 7468 6c79 2c20 616e 6420  s smoothly, and 
-000460c0: 7265 6c69 6573 206f 6e20 7468 6520 6060  relies on the ``
-000460d0: 626c 6f63 6b77 6973 6560 6020 6d61 6368  blockwise`` mach
-000460e0: 696e 6572 790a 2020 2020 746f 2070 726f  inery.    to pro
-000460f0: 7669 6465 2061 206e 6963 656c 7920 7379  vide a nicely sy
-00046100: 6d62 6f6c 6963 2067 7261 7068 2e0a 0a20  mbolic graph... 
-00046110: 2020 2049 7420 6973 206d 6f73 7420 636f     It is most co
-00046120: 6d6d 6f6e 6c79 2075 7365 6420 696e 206f  mmonly used in o
-00046130: 7468 6572 2067 7261 7068 2d62 7569 6c64  ther graph-build
-00046140: 696e 6720 6675 6e63 7469 6f6e 7320 746f  ing functions to
-00046150: 2063 7265 6174 6520 7468 650a 2020 2020   create the.    
-00046160: 6170 7072 6f70 7269 6174 6520 6c61 7965  appropriate laye
-00046170: 7220 6f66 2074 6865 2072 6573 756c 7469  r of the resulti
-00046180: 6e67 2064 6174 6166 7261 6d65 2e0a 0a20  ng dataframe... 
-00046190: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-000461a0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-000461b0: 2066 756e 633a 2063 616c 6c61 626c 650a   func: callable.
-000461c0: 2020 2020 6c61 7965 725f 6e61 6d65 3a20      layer_name: 
-000461d0: 7374 720a 2020 2020 2020 2020 4465 7363  str.        Desc
-000461e0: 7269 7074 6976 6520 6e61 6d65 2066 6f72  riptive name for
-000461f0: 2074 6865 206f 7065 7261 7469 6f6e 2e20   the operation. 
-00046200: 5573 6564 2061 7320 7468 6520 6f75 7470  Used as the outp
-00046210: 7574 206e 616d 650a 2020 2020 2020 2020  ut name.        
-00046220: 696e 2074 6865 2072 6573 756c 7469 6e67  in the resulting
-00046230: 2060 6042 6c6f 636b 7769 7365 6060 2067   ``Blockwise`` g
-00046240: 7261 7068 206c 6179 6572 2e0a 2020 2020  raph layer..    
-00046250: 2a61 7267 733a 0a20 2020 202a 2a6b 7761  *args:.    **kwa
-00046260: 7267 733a 0a0a 2020 2020 5265 7475 726e  rgs:..    Return
-00046270: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
-00046280: 2020 6f75 743a 2042 6c6f 636b 7769 7365    out: Blockwise
-00046290: 2067 7261 7068 0a0a 2020 2020 4578 616d   graph..    Exam
-000462a0: 706c 6573 0a20 2020 202d 2d2d 2d2d 2d2d  ples.    -------
-000462b0: 2d0a 2020 2020 3e3e 3e20 7375 6267 7261  -.    >>> subgra
-000462c0: 7068 203d 2070 6172 7469 7469 6f6e 7769  ph = partitionwi
-000462d0: 7365 5f67 7261 7068 2866 756e 6374 696f  se_graph(functio
-000462e0: 6e2c 2078 2c20 792c 207a 3d31 3233 2920  n, x, y, z=123) 
-000462f0: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-00046300: 500a 2020 2020 3e3e 3e20 6c61 7965 7220  P.    >>> layer 
-00046310: 3d20 7061 7274 6974 696f 6e77 6973 655f  = partitionwise_
-00046320: 6772 6170 6828 6675 6e63 7469 6f6e 2c20  graph(function, 
-00046330: 6466 2c20 782c 207a 3d31 3233 2920 2023  df, x, z=123)  #
-00046340: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-00046350: 2020 2020 3e3e 3e20 6772 6170 6820 3d20      >>> graph = 
-00046360: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-00046370: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-00046380: 6e61 6d65 2c20 6c61 7965 722c 2064 6570  name, layer, dep
-00046390: 656e 6465 6e63 6965 733d 5b64 662c 2078  endencies=[df, x
-000463a0: 5d29 2020 2320 646f 6374 6573 743a 202b  ])  # doctest: +
-000463b0: 534b 4950 0a20 2020 203e 3e3e 2072 6573  SKIP.    >>> res
-000463c0: 756c 7420 3d20 6e65 775f 6464 5f6f 626a  ult = new_dd_obj
-000463d0: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
-000463e0: 206d 6574 6164 6174 612c 2064 662e 6469   metadata, df.di
-000463f0: 7669 7369 6f6e 7329 2020 2320 646f 6374  visions)  # doct
-00046400: 6573 743a 202b 534b 4950 0a0a 2020 2020  est: +SKIP..    
-00046410: 5365 6520 416c 736f 0a20 2020 202d 2d2d  See Also.    ---
-00046420: 2d2d 2d2d 2d0a 2020 2020 6d61 705f 7061  -----.    map_pa
-00046430: 7274 6974 696f 6e73 0a20 2020 2022 2222  rtitions.    """
-00046440: 0a20 2020 2070 6169 7273 203d 205b 5d0a  .    pairs = [].
-00046450: 2020 2020 6e75 6d62 6c6f 636b 7320 3d20      numblocks = 
-00046460: 7b7d 0a20 2020 2066 6f72 2061 7267 2069  {}.    for arg i
-00046470: 6e20 6172 6773 3a0a 2020 2020 2020 2020  n args:.        
-00046480: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
-00046490: 672c 205f 4672 616d 6529 3a0a 2020 2020  g, _Frame):.    
-000464a0: 2020 2020 2020 2020 7061 6972 732e 6578          pairs.ex
-000464b0: 7465 6e64 285b 6172 672e 5f6e 616d 652c  tend([arg._name,
-000464c0: 2022 6922 5d29 0a20 2020 2020 2020 2020   "i"]).         
-000464d0: 2020 206e 756d 626c 6f63 6b73 5b61 7267     numblocks[arg
-000464e0: 2e5f 6e61 6d65 5d20 3d20 2861 7267 2e6e  ._name] = (arg.n
-000464f0: 7061 7274 6974 696f 6e73 2c29 0a20 2020  partitions,).   
-00046500: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-00046510: 616e 6365 2861 7267 2c20 5363 616c 6172  ance(arg, Scalar
-00046520: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
-00046530: 6169 7273 2e65 7874 656e 6428 5b61 7267  airs.extend([arg
-00046540: 2e5f 6e61 6d65 2c20 2269 225d 290a 2020  ._name, "i"]).  
-00046550: 2020 2020 2020 2020 2020 6e75 6d62 6c6f            numblo
-00046560: 636b 735b 6172 672e 5f6e 616d 655d 203d  cks[arg._name] =
-00046570: 2028 312c 290a 2020 2020 2020 2020 656c   (1,).        el
-00046580: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
-00046590: 672c 2041 7272 6179 293a 0a20 2020 2020  g, Array):.     
-000465a0: 2020 2020 2020 2069 6620 6172 672e 6e64         if arg.nd
-000465b0: 696d 203d 3d20 313a 0a20 2020 2020 2020  im == 1:.       
-000465c0: 2020 2020 2020 2020 2070 6169 7273 2e65           pairs.e
-000465d0: 7874 656e 6428 5b61 7267 2e6e 616d 652c  xtend([arg.name,
-000465e0: 2022 6922 5d29 0a20 2020 2020 2020 2020   "i"]).         
-000465f0: 2020 2065 6c69 6620 6172 672e 6e64 696d     elif arg.ndim
-00046600: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-00046610: 2020 2020 2020 2070 6169 7273 2e65 7874         pairs.ext
-00046620: 656e 6428 5b61 7267 2e6e 616d 652c 2022  end([arg.name, "
-00046630: 225d 290a 2020 2020 2020 2020 2020 2020  "]).            
-00046640: 656c 6966 2061 7267 2e6e 6469 6d20 3d3d  elif arg.ndim ==
-00046650: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-00046660: 2020 2020 7061 6972 732e 6578 7465 6e64      pairs.extend
-00046670: 285b 6172 672e 6e61 6d65 2c20 2269 6a22  ([arg.name, "ij"
-00046680: 5d29 0a20 2020 2020 2020 2020 2020 2065  ]).            e
-00046690: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000466a0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000466b0: 4572 726f 7228 2243 616e 2774 2061 6464  Error("Can't add
-000466c0: 206d 756c 7469 2d64 696d 656e 7369 6f6e   multi-dimension
-000466d0: 616c 2061 7272 6179 2074 6f20 6461 7461  al array to data
-000466e0: 6672 616d 6573 2229 0a20 2020 2020 2020  frames").       
-000466f0: 2020 2020 206e 756d 626c 6f63 6b73 5b61       numblocks[a
-00046700: 7267 2e5f 6e61 6d65 5d20 3d20 6172 672e  rg._name] = arg.
-00046710: 6e75 6d62 6c6f 636b 730a 2020 2020 2020  numblocks.      
-00046720: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-00046730: 6528 6172 672c 2042 6c6f 636b 7769 7365  e(arg, Blockwise
-00046740: 4465 7029 3a0a 2020 2020 2020 2020 2020  Dep):.          
-00046750: 2020 6966 206c 656e 2861 7267 2e6e 756d    if len(arg.num
-00046760: 626c 6f63 6b73 2920 3d3d 2031 3a0a 2020  blocks) == 1:.  
-00046770: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00046780: 6972 732e 6578 7465 6e64 285b 6172 672c  irs.extend([arg,
-00046790: 2022 6922 5d29 0a20 2020 2020 2020 2020   "i"]).         
-000467a0: 2020 2065 6c69 6620 6c65 6e28 6172 672e     elif len(arg.
-000467b0: 6e75 6d62 6c6f 636b 7329 203d 3d20 323a  numblocks) == 2:
-000467c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000467d0: 2070 6169 7273 2e65 7874 656e 6428 5b61   pairs.extend([a
-000467e0: 7267 2c20 2269 6a22 5d29 0a20 2020 2020  rg, "ij"]).     
-000467f0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00046800: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00046810: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-00046820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046830: 2020 2066 2242 6c6f 636b 7769 7365 4465     f"BlockwiseDe
-00046840: 7020 6172 6720 7b61 7267 2172 7d20 6861  p arg {arg!r} ha
-00046850: 7320 7b6c 656e 2861 7267 2e6e 756d 626c  s {len(arg.numbl
-00046860: 6f63 6b73 297d 2064 696d 656e 7369 6f6e  ocks)} dimension
-00046870: 733b 206f 6e6c 7920 3120 6f72 2032 2061  s; only 1 or 2 a
-00046880: 7265 2073 7570 706f 7274 6564 2e22 0a20  re supported.". 
-00046890: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000468a0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000468b0: 2020 2020 2020 2020 2020 2070 6169 7273             pairs
-000468c0: 2e65 7874 656e 6428 5b61 7267 2c20 4e6f  .extend([arg, No
-000468d0: 6e65 5d29 0a20 2020 2072 6574 7572 6e20  ne]).    return 
-000468e0: 626c 6f63 6b77 6973 6528 0a20 2020 2020  blockwise(.     
-000468f0: 2020 2066 756e 632c 206c 6179 6572 5f6e     func, layer_n
-00046900: 616d 652c 2022 6922 2c20 2a70 6169 7273  ame, "i", *pairs
-00046910: 2c20 6e75 6d62 6c6f 636b 733d 6e75 6d62  , numblocks=numb
-00046920: 6c6f 636b 732c 2063 6f6e 6361 7465 6e61  locks, concatena
-00046930: 7465 3d54 7275 652c 202a 2a6b 7761 7267  te=True, **kwarg
-00046940: 730a 2020 2020 290a 0a0a 6465 6620 6d65  s.    )...def me
-00046950: 7461 5f77 6172 6e69 6e67 2864 6629 3a0a  ta_warning(df):.
-00046960: 2020 2020 2222 220a 2020 2020 5072 6f76      """.    Prov
-00046970: 6964 6520 616e 2069 6e66 6f72 6d61 7469  ide an informati
-00046980: 7665 206d 6573 7361 6765 2077 6865 6e20  ve message when 
-00046990: 7468 6520 7573 6572 2069 7320 6173 6b65  the user is aske
-000469a0: 6420 746f 2070 726f 7669 6465 206d 6574  d to provide met
-000469b0: 6164 6174 610a 2020 2020 2222 220a 2020  adata.    """.  
-000469c0: 2020 6966 2069 735f 6461 7461 6672 616d    if is_datafram
-000469d0: 655f 6c69 6b65 2864 6629 3a0a 2020 2020  e_like(df):.    
-000469e0: 2020 2020 6d65 7461 5f73 7472 203d 207b      meta_str = {
-000469f0: 6b3a 2073 7472 2876 2920 666f 7220 6b2c  k: str(v) for k,
-00046a00: 2076 2069 6e20 6466 2e64 7479 7065 732e   v in df.dtypes.
-00046a10: 746f 5f64 6963 7428 292e 6974 656d 7328  to_dict().items(
-00046a20: 297d 0a20 2020 2065 6c69 6620 6973 5f73  )}.    elif is_s
-00046a30: 6572 6965 735f 6c69 6b65 2864 6629 3a0a  eries_like(df):.
-00046a40: 2020 2020 2020 2020 6d65 7461 5f73 7472          meta_str
-00046a50: 203d 2028 6466 2e6e 616d 652c 2073 7472   = (df.name, str
-00046a60: 2864 662e 6474 7970 6529 290a 2020 2020  (df.dtype)).    
-00046a70: 656c 7365 3a0a 2020 2020 2020 2020 6d65  else:.        me
-00046a80: 7461 5f73 7472 203d 204e 6f6e 650a 2020  ta_str = None.  
-00046a90: 2020 6d73 6720 3d20 280a 2020 2020 2020    msg = (.      
-00046aa0: 2020 225c 6e59 6f75 2064 6964 206e 6f74    "\nYou did not
-00046ab0: 2070 726f 7669 6465 206d 6574 6164 6174   provide metadat
-00046ac0: 612c 2073 6f20 4461 736b 2069 7320 7275  a, so Dask is ru
-00046ad0: 6e6e 696e 6720 796f 7572 2022 0a20 2020  nning your ".   
-00046ae0: 2020 2020 2022 6675 6e63 7469 6f6e 206f       "function o
-00046af0: 6e20 6120 736d 616c 6c20 6461 7461 7365  n a small datase
-00046b00: 7420 746f 2067 7565 7373 206f 7574 7075  t to guess outpu
-00046b10: 7420 7479 7065 732e 2022 0a20 2020 2020  t types. ".     
-00046b20: 2020 2022 4974 2069 7320 706f 7373 6962     "It is possib
-00046b30: 6c65 2074 6861 7420 4461 736b 2077 696c  le that Dask wil
-00046b40: 6c20 6775 6573 7320 696e 636f 7272 6563  l guess incorrec
-00046b50: 746c 792e 5c6e 220a 2020 2020 2020 2020  tly.\n".        
-00046b60: 2254 6f20 7072 6f76 6964 6520 616e 2065  "To provide an e
-00046b70: 7870 6c69 6369 7420 6f75 7470 7574 2074  xplicit output t
-00046b80: 7970 6573 206f 7220 746f 2073 696c 656e  ypes or to silen
-00046b90: 6365 2074 6869 7320 6d65 7373 6167 652c  ce this message,
-00046ba0: 2022 0a20 2020 2020 2020 2022 706c 6561   ".        "plea
-00046bb0: 7365 2070 726f 7669 6465 2074 6865 2060  se provide the `
-00046bc0: 6d65 7461 3d60 206b 6579 776f 7264 2c20  meta=` keyword, 
-00046bd0: 6173 2064 6573 6372 6962 6564 2069 6e20  as described in 
-00046be0: 7468 6520 6d61 7020 6f72 2022 0a20 2020  the map or ".   
-00046bf0: 2020 2020 2022 6170 706c 7920 6675 6e63       "apply func
-00046c00: 7469 6f6e 2074 6861 7420 796f 7520 6172  tion that you ar
-00046c10: 6520 7573 696e 672e 220a 2020 2020 290a  e using.".    ).
-00046c20: 2020 2020 6966 206d 6574 615f 7374 723a      if meta_str:
-00046c30: 0a20 2020 2020 2020 206d 7367 202b 3d20  .        msg += 
-00046c40: 280a 2020 2020 2020 2020 2020 2020 225c  (.            "\
-00046c50: 6e22 0a20 2020 2020 2020 2020 2020 2022  n".            "
-00046c60: 2020 4265 666f 7265 3a20 2e61 7070 6c79    Before: .apply
-00046c70: 2866 756e 6329 5c6e 220a 2020 2020 2020  (func)\n".      
-00046c80: 2020 2020 2020 2220 2041 6674 6572 3a20        "  After: 
-00046c90: 202e 6170 706c 7928 6675 6e63 2c20 6d65   .apply(func, me
-00046ca0: 7461 3d25 7329 5c6e 2220 2520 7374 7228  ta=%s)\n" % str(
-00046cb0: 6d65 7461 5f73 7472 290a 2020 2020 2020  meta_str).      
-00046cc0: 2020 290a 2020 2020 7265 7475 726e 206d    ).    return m
-00046cd0: 7367 0a0a 0a64 6566 2070 7265 6669 785f  sg...def prefix_
-00046ce0: 7265 6475 6374 696f 6e28 662c 2064 6466  reduction(f, ddf
-00046cf0: 2c20 6964 656e 7469 7479 2c20 2a2a 6b77  , identity, **kw
-00046d00: 6172 6773 293a 0a20 2020 2022 2222 436f  args):.    """Co
-00046d10: 6d70 7574 6573 2074 6865 2070 7265 6669  mputes the prefi
-00046d20: 7820 7375 6d73 206f 6620 6620 6f6e 2064  x sums of f on d
-00046d30: 660a 0a20 2020 2049 6620 6466 2068 6173  f..    If df has
-00046d40: 2070 6172 7469 7469 6f6e 7320 5b50 312c   partitions [P1,
-00046d50: 2050 322c 202e 2e2e 2c20 506e 5d2c 2074   P2, ..., Pn], t
-00046d60: 6865 6e20 7265 7475 726e 7320 7468 6520  hen returns the 
-00046d70: 4461 7461 4672 616d 6520 7769 7468 0a20  DataFrame with. 
-00046d80: 2020 2070 6172 7469 7469 6f6e 7320 5b66     partitions [f
-00046d90: 2869 6465 6e74 6974 792c 2050 3129 2c0a  (identity, P1),.
-00046da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046db0: 6628 6628 6964 656e 7469 7479 2c20 5031  f(f(identity, P1
-00046dc0: 292c 2050 3229 2c0a 2020 2020 2020 2020  ), P2),.        
-00046dd0: 2020 2020 2020 2020 6628 6628 6628 6964          f(f(f(id
-00046de0: 656e 7469 7479 2c20 5031 292c 2050 3229  entity, P1), P2)
-00046df0: 2c20 5033 292c 0a20 2020 2020 2020 2020  , P3),.         
-00046e00: 2020 2020 2020 202e 2e2e 5d0a 0a20 2020         ...]..   
-00046e10: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00046e20: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066  ----------.    f
-00046e30: 203a 2063 616c 6c61 626c 650a 2020 2020   : callable.    
-00046e40: 2020 2020 616e 2061 7373 6f63 6961 7469      an associati
-00046e50: 7665 2066 756e 6374 696f 6e20 660a 2020  ve function f.  
-00046e60: 2020 6464 6620 3a20 6464 2e44 6174 6146    ddf : dd.DataF
-00046e70: 7261 6d65 0a20 2020 2069 6465 6e74 6974  rame.    identit
-00046e80: 7920 3a20 7064 2e44 6174 6146 7261 6d65  y : pd.DataFrame
-00046e90: 0a20 2020 2020 2020 2061 6e20 6964 656e  .        an iden
-00046ea0: 7469 7479 2065 6c65 6d65 6e74 206f 6620  tity element of 
-00046eb0: 662c 2074 6861 7420 6973 2066 2869 6465  f, that is f(ide
-00046ec0: 6e74 6974 792c 2064 6629 203d 2066 2864  ntity, df) = f(d
-00046ed0: 662c 2069 6465 6e74 6974 7929 203d 2064  f, identity) = d
-00046ee0: 660a 2020 2020 2222 220a 2020 2020 6473  f.    """.    ds
-00046ef0: 6b20 3d20 6469 6374 2829 0a20 2020 206e  k = dict().    n
-00046f00: 616d 6520 3d20 2270 7265 6669 785f 7265  ame = "prefix_re
-00046f10: 6475 6374 696f 6e2d 2220 2b20 746f 6b65  duction-" + toke
-00046f20: 6e69 7a65 2866 2c20 6464 662c 2069 6465  nize(f, ddf, ide
-00046f30: 6e74 6974 792c 202a 2a6b 7761 7267 7329  ntity, **kwargs)
-00046f40: 0a20 2020 206d 6574 6120 3d20 6464 662e  .    meta = ddf.
-00046f50: 5f6d 6574 610a 2020 2020 6e20 3d20 6c65  _meta.    n = le
-00046f60: 6e28 6464 662e 6469 7669 7369 6f6e 7329  n(ddf.divisions)
-00046f70: 202d 2031 0a20 2020 2064 6976 6973 696f   - 1.    divisio
-00046f80: 6e73 203d 205b 4e6f 6e65 5d20 2a20 286e  ns = [None] * (n
-00046f90: 202b 2031 290a 0a20 2020 204e 203d 2031   + 1)..    N = 1
-00046fa0: 0a20 2020 2077 6869 6c65 204e 203c 206e  .    while N < n
-00046fb0: 3a0a 2020 2020 2020 2020 4e20 2a3d 2032  :.        N *= 2
-00046fc0: 0a20 2020 2066 6f72 2069 2069 6e20 7261  .    for i in ra
-00046fd0: 6e67 6528 6e29 3a0a 2020 2020 2020 2020  nge(n):.        
-00046fe0: 6473 6b5b 286e 616d 652c 2069 2c20 312c  dsk[(name, i, 1,
-00046ff0: 2030 295d 203d 2028 6170 706c 792c 2066   0)] = (apply, f
-00047000: 2c20 5b28 6464 662e 5f6e 616d 652c 2069  , [(ddf._name, i
-00047010: 292c 2069 6465 6e74 6974 795d 2c20 6b77  ), identity], kw
-00047020: 6172 6773 290a 2020 2020 666f 7220 6920  args).    for i 
-00047030: 696e 2072 616e 6765 286e 2c20 4e29 3a0a  in range(n, N):.
-00047040: 2020 2020 2020 2020 6473 6b5b 286e 616d          dsk[(nam
-00047050: 652c 2069 2c20 312c 2030 295d 203d 2069  e, i, 1, 0)] = i
-00047060: 6465 6e74 6974 790a 0a20 2020 2064 203d  dentity..    d =
-00047070: 2031 0a20 2020 2077 6869 6c65 2064 203c   1.    while d <
-00047080: 204e 3a0a 2020 2020 2020 2020 666f 7220   N:.        for 
-00047090: 6920 696e 2072 616e 6765 2830 2c20 4e2c  i in range(0, N,
-000470a0: 2032 202a 2064 293a 0a20 2020 2020 2020   2 * d):.       
-000470b0: 2020 2020 2064 736b 5b28 6e61 6d65 2c20       dsk[(name, 
-000470c0: 6920 2b20 3220 2a20 6420 2d20 312c 2032  i + 2 * d - 1, 2
-000470d0: 202a 2064 2c20 3029 5d20 3d20 280a 2020   * d, 0)] = (.  
-000470e0: 2020 2020 2020 2020 2020 2020 2020 6170                ap
-000470f0: 706c 792c 0a20 2020 2020 2020 2020 2020  ply,.           
-00047100: 2020 2020 2066 2c0a 2020 2020 2020 2020       f,.        
-00047110: 2020 2020 2020 2020 5b28 6e61 6d65 2c20          [(name, 
-00047120: 6920 2b20 6420 2d20 312c 2064 2c20 3029  i + d - 1, d, 0)
-00047130: 2c20 286e 616d 652c 2069 202b 2032 202a  , (name, i + 2 *
-00047140: 2064 202d 2031 2c20 642c 2030 295d 2c0a   d - 1, d, 0)],.
-00047150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047160: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-00047170: 2020 2020 290a 2020 2020 2020 2020 6420      ).        d 
-00047180: 2a3d 2032 0a0a 2020 2020 6473 6b5b 286e  *= 2..    dsk[(n
-00047190: 616d 652c 204e 202d 2031 2c20 4e2c 2031  ame, N - 1, N, 1
-000471a0: 295d 203d 2069 6465 6e74 6974 790a 0a20  )] = identity.. 
-000471b0: 2020 2077 6869 6c65 2064 203e 2031 3a0a     while d > 1:.
-000471c0: 2020 2020 2020 2020 6420 2f2f 3d20 320a          d //= 2.
-000471d0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-000471e0: 2072 616e 6765 2830 2c20 4e2c 2032 202a   range(0, N, 2 *
-000471f0: 2064 293a 0a20 2020 2020 2020 2020 2020   d):.           
-00047200: 2064 736b 5b28 6e61 6d65 2c20 6920 2b20   dsk[(name, i + 
-00047210: 6420 2d20 312c 2064 2c20 3129 5d20 3d20  d - 1, d, 1)] = 
-00047220: 286e 616d 652c 2069 202b 2032 202a 2064  (name, i + 2 * d
-00047230: 202d 2031 2c20 3220 2a20 642c 2031 290a   - 1, 2 * d, 1).
-00047240: 2020 2020 2020 2020 2020 2020 6473 6b5b              dsk[
-00047250: 286e 616d 652c 2069 202b 2032 202a 2064  (name, i + 2 * d
-00047260: 202d 2031 2c20 642c 2031 295d 203d 2028   - 1, d, 1)] = (
-00047270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047280: 2061 7070 6c79 2c0a 2020 2020 2020 2020   apply,.        
-00047290: 2020 2020 2020 2020 662c 0a20 2020 2020          f,.     
-000472a0: 2020 2020 2020 2020 2020 205b 286e 616d             [(nam
-000472b0: 652c 2069 202b 2032 202a 2064 202d 2031  e, i + 2 * d - 1
-000472c0: 2c20 3220 2a20 642c 2031 292c 2028 6e61  , 2 * d, 1), (na
-000472d0: 6d65 2c20 6920 2b20 6420 2d20 312c 2064  me, i + d - 1, d
-000472e0: 2c20 3029 5d2c 0a20 2020 2020 2020 2020  , 0)],.         
-000472f0: 2020 2020 2020 206b 7761 7267 732c 0a20         kwargs,. 
-00047300: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00047310: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00047320: 286e 293a 0a20 2020 2020 2020 2064 736b  (n):.        dsk
-00047330: 5b28 6e61 6d65 2c20 6929 5d20 3d20 2861  [(name, i)] = (a
-00047340: 7070 6c79 2c20 662c 205b 286e 616d 652c  pply, f, [(name,
-00047350: 2069 2c20 312c 2031 292c 2069 6465 6e74   i, 1, 1), ident
-00047360: 6974 795d 2c20 6b77 6172 6773 290a 0a20  ity], kwargs).. 
-00047370: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-00047380: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-00047390: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
-000473a0: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-000473b0: 6573 3d5b 6464 665d 290a 2020 2020 7265  es=[ddf]).    re
-000473c0: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
-000473d0: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
-000473e0: 6d65 7461 2c20 6469 7669 7369 6f6e 7329  meta, divisions)
-000473f0: 0a0a 0a64 6566 2073 7566 6669 785f 7265  ...def suffix_re
-00047400: 6475 6374 696f 6e28 662c 2064 6466 2c20  duction(f, ddf, 
-00047410: 6964 656e 7469 7479 2c20 2a2a 6b77 6172  identity, **kwar
-00047420: 6773 293a 0a20 2020 2022 2222 436f 6d70  gs):.    """Comp
-00047430: 7574 6573 2074 6865 2073 7566 6669 7820  utes the suffix 
-00047440: 7375 6d73 206f 6620 6620 6f6e 2064 660a  sums of f on df.
-00047450: 0a20 2020 2049 6620 6466 2068 6173 2070  .    If df has p
-00047460: 6172 7469 7469 6f6e 7320 5b50 312c 2050  artitions [P1, P
-00047470: 322c 202e 2e2e 2c20 506e 5d2c 2074 6865  2, ..., Pn], the
-00047480: 6e20 7265 7475 726e 7320 7468 6520 4461  n returns the Da
-00047490: 7461 4672 616d 6520 7769 7468 0a20 2020  taFrame with.   
-000474a0: 2070 6172 7469 7469 6f6e 7320 5b66 2850   partitions [f(P
-000474b0: 312c 2066 2850 322c 202e 2e2e 6628 506e  1, f(P2, ...f(Pn
-000474c0: 2c20 6964 656e 7469 7479 292e 2e2e 2929  , identity)...))
-000474d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000474e0: 2020 6628 5032 2c20 2e2e 2e66 2850 6e2c    f(P2, ...f(Pn,
-000474f0: 2069 6465 6e74 6974 7929 2e2e 2e29 2c0a   identity)...),.
-00047500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047510: 2e2e 2e66 2850 6e2c 2069 6465 6e74 6974  ...f(Pn, identit
-00047520: 7929 2e2e 2e2c 0a20 2020 2020 2020 2020  y)...,.         
-00047530: 2020 2020 2020 202e 2e2e 5d0a 0a20 2020         ...]..   
-00047540: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00047550: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066  ----------.    f
-00047560: 203a 2063 616c 6c61 626c 650a 2020 2020   : callable.    
-00047570: 2020 2020 616e 2061 7373 6f63 6961 7469      an associati
-00047580: 7665 2066 756e 6374 696f 6e20 660a 2020  ve function f.  
-00047590: 2020 6464 6620 3a20 6464 2e44 6174 6146    ddf : dd.DataF
-000475a0: 7261 6d65 0a20 2020 2069 6465 6e74 6974  rame.    identit
-000475b0: 7920 3a20 7064 2e44 6174 6146 7261 6d65  y : pd.DataFrame
-000475c0: 0a20 2020 2020 2020 2061 6e20 6964 656e  .        an iden
-000475d0: 7469 7479 2065 6c65 6d65 6e74 206f 6620  tity element of 
-000475e0: 662c 2074 6861 7420 6973 2066 2869 6465  f, that is f(ide
-000475f0: 6e74 6974 792c 2064 6629 203d 2066 2864  ntity, df) = f(d
-00047600: 662c 2069 6465 6e74 6974 7929 203d 2064  f, identity) = d
-00047610: 660a 2020 2020 6b77 6172 6773 203a 203f  f.    kwargs : ?
-00047620: 3f0a 2020 2020 2020 2020 6b65 7977 6f72  ?.        keywor
-00047630: 6420 6172 6775 6d65 6e74 7320 6f66 2066  d arguments of f
-00047640: 203f 3f0a 2020 2020 2222 220a 2020 2020   ??.    """.    
-00047650: 6473 6b20 3d20 6469 6374 2829 0a20 2020  dsk = dict().   
-00047660: 206e 616d 6520 3d20 2273 7566 6669 785f   name = "suffix_
-00047670: 7265 6475 6374 696f 6e2d 2220 2b20 746f  reduction-" + to
-00047680: 6b65 6e69 7a65 2866 2c20 6464 662c 2069  kenize(f, ddf, i
-00047690: 6465 6e74 6974 792c 202a 2a6b 7761 7267  dentity, **kwarg
-000476a0: 7329 0a20 2020 206d 6574 6120 3d20 6464  s).    meta = dd
-000476b0: 662e 5f6d 6574 610a 2020 2020 6e20 3d20  f._meta.    n = 
-000476c0: 6c65 6e28 6464 662e 6469 7669 7369 6f6e  len(ddf.division
-000476d0: 7329 202d 2031 0a20 2020 2064 6976 6973  s) - 1.    divis
-000476e0: 696f 6e73 203d 205b 4e6f 6e65 5d20 2a20  ions = [None] * 
-000476f0: 286e 202b 2031 290a 0a20 2020 204e 203d  (n + 1)..    N =
-00047700: 2031 0a20 2020 2077 6869 6c65 204e 203c   1.    while N <
-00047710: 206e 3a0a 2020 2020 2020 2020 4e20 2a3d   n:.        N *=
-00047720: 2032 0a20 2020 2066 6f72 2069 2069 6e20   2.    for i in 
-00047730: 7261 6e67 6528 6e29 3a0a 2020 2020 2020  range(n):.      
-00047740: 2020 6473 6b5b 286e 616d 652c 2069 2c20    dsk[(name, i, 
-00047750: 312c 2030 295d 203d 2028 6170 706c 792c  1, 0)] = (apply,
-00047760: 2066 2c20 5b28 6464 662e 5f6e 616d 652c   f, [(ddf._name,
-00047770: 206e 202d 2031 202d 2069 292c 2069 6465   n - 1 - i), ide
-00047780: 6e74 6974 795d 2c20 6b77 6172 6773 290a  ntity], kwargs).
-00047790: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-000477a0: 6765 286e 2c20 4e29 3a0a 2020 2020 2020  ge(n, N):.      
-000477b0: 2020 6473 6b5b 286e 616d 652c 2069 2c20    dsk[(name, i, 
-000477c0: 312c 2030 295d 203d 2069 6465 6e74 6974  1, 0)] = identit
-000477d0: 790a 0a20 2020 2064 203d 2031 0a20 2020  y..    d = 1.   
-000477e0: 2077 6869 6c65 2064 203c 204e 3a0a 2020   while d < N:.  
-000477f0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00047800: 616e 6765 2830 2c20 4e2c 2032 202a 2064  ange(0, N, 2 * d
-00047810: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-00047820: 736b 5b28 6e61 6d65 2c20 6920 2b20 3220  sk[(name, i + 2 
-00047830: 2a20 6420 2d20 312c 2032 202a 2064 2c20  * d - 1, 2 * d, 
-00047840: 3029 5d20 3d20 280a 2020 2020 2020 2020  0)] = (.        
-00047850: 2020 2020 2020 2020 6170 706c 792c 0a20          apply,. 
-00047860: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00047870: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00047880: 2020 5b28 6e61 6d65 2c20 6920 2b20 3220    [(name, i + 2 
-00047890: 2a20 6420 2d20 312c 2064 2c20 3029 2c20  * d - 1, d, 0), 
-000478a0: 286e 616d 652c 2069 202b 2064 202d 2031  (name, i + d - 1
-000478b0: 2c20 642c 2030 295d 2c0a 2020 2020 2020  , d, 0)],.      
-000478c0: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-000478d0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-000478e0: 2020 2020 2020 2020 6420 2a3d 2032 0a0a          d *= 2..
-000478f0: 2020 2020 6473 6b5b 286e 616d 652c 204e      dsk[(name, N
-00047900: 202d 2031 2c20 4e2c 2031 295d 203d 2069   - 1, N, 1)] = i
-00047910: 6465 6e74 6974 790a 0a20 2020 2077 6869  dentity..    whi
-00047920: 6c65 2064 203e 2031 3a0a 2020 2020 2020  le d > 1:.      
-00047930: 2020 6420 2f2f 3d20 320a 2020 2020 2020    d //= 2.      
-00047940: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00047950: 2830 2c20 4e2c 2032 202a 2064 293a 0a20  (0, N, 2 * d):. 
-00047960: 2020 2020 2020 2020 2020 2064 736b 5b28             dsk[(
-00047970: 6e61 6d65 2c20 6920 2b20 6420 2d20 312c  name, i + d - 1,
-00047980: 2064 2c20 3129 5d20 3d20 286e 616d 652c   d, 1)] = (name,
-00047990: 2069 202b 2032 202a 2064 202d 2031 2c20   i + 2 * d - 1, 
-000479a0: 3220 2a20 642c 2031 290a 2020 2020 2020  2 * d, 1).      
-000479b0: 2020 2020 2020 6473 6b5b 286e 616d 652c        dsk[(name,
-000479c0: 2069 202b 2032 202a 2064 202d 2031 2c20   i + 2 * d - 1, 
-000479d0: 642c 2031 295d 203d 2028 0a20 2020 2020  d, 1)] = (.     
-000479e0: 2020 2020 2020 2020 2020 2061 7070 6c79             apply
-000479f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00047a00: 2020 662c 0a20 2020 2020 2020 2020 2020    f,.           
-00047a10: 2020 2020 205b 286e 616d 652c 2069 202b       [(name, i +
-00047a20: 2064 202d 2031 2c20 642c 2030 292c 2028   d - 1, d, 0), (
-00047a30: 6e61 6d65 2c20 6920 2b20 3220 2a20 6420  name, i + 2 * d 
-00047a40: 2d20 312c 2032 202a 2064 2c20 3129 5d2c  - 1, 2 * d, 1)],
-00047a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047a60: 206b 7761 7267 732c 0a20 2020 2020 2020   kwargs,.       
-00047a70: 2020 2020 2029 0a0a 2020 2020 666f 7220       )..    for 
-00047a80: 6920 696e 2072 616e 6765 286e 293a 0a20  i in range(n):. 
-00047a90: 2020 2020 2020 2064 736b 5b28 6e61 6d65         dsk[(name
-00047aa0: 2c20 6929 5d20 3d20 2861 7070 6c79 2c20  , i)] = (apply, 
-00047ab0: 662c 205b 286e 616d 652c 206e 202d 2031  f, [(name, n - 1
-00047ac0: 202d 2069 2c20 312c 2031 292c 2069 6465   - i, 1, 1), ide
-00047ad0: 6e74 6974 795d 2c20 6b77 6172 6773 290a  ntity], kwargs).
-00047ae0: 0a20 2020 2067 7261 7068 203d 2048 6967  .    graph = Hig
-00047af0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-00047b00: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
-00047b10: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
-00047b20: 6369 6573 3d5b 6464 665d 290a 2020 2020  cies=[ddf]).    
-00047b30: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
-00047b40: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
-00047b50: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
-00047b60: 7329 0a0a 0a64 6566 206d 6170 7365 7269  s)...def mapseri
-00047b70: 6573 2862 6173 655f 6368 756e 6b2c 2063  es(base_chunk, c
-00047b80: 6f6e 6361 745f 6d61 7029 3a0a 2020 2020  oncat_map):.    
-00047b90: 7265 7475 726e 2062 6173 655f 6368 756e  return base_chun
-00047ba0: 6b2e 6d61 7028 636f 6e63 6174 5f6d 6170  k.map(concat_map
-00047bb0: 290a 0a0a 6465 6620 6d61 7073 6572 6965  )...def mapserie
-00047bc0: 735f 636f 6d62 696e 6528 696e 6465 782c  s_combine(index,
-00047bd0: 2063 6f6e 6361 745f 7265 7375 6c74 293a   concat_result):
-00047be0: 0a20 2020 2066 696e 616c 5f73 6572 6965  .    final_serie
-00047bf0: 7320 3d20 636f 6e63 6174 5f72 6573 756c  s = concat_resul
-00047c00: 742e 736f 7274 5f69 6e64 6578 2829 0a20  t.sort_index(). 
-00047c10: 2020 2066 696e 616c 5f73 6572 6965 7320     final_series 
-00047c20: 3d20 696e 6465 782e 746f 5f73 6572 6965  = index.to_serie
-00047c30: 7328 292e 6d61 7028 6669 6e61 6c5f 7365  s().map(final_se
-00047c40: 7269 6573 290a 2020 2020 7265 7475 726e  ries).    return
-00047c50: 2066 696e 616c 5f73 6572 6965 730a 0a0a   final_series...
-00047c60: 6465 6620 7365 7269 6573 5f6d 6170 2862  def series_map(b
-00047c70: 6173 655f 7365 7269 6573 2c20 6d61 705f  ase_series, map_
-00047c80: 7365 7269 6573 293a 0a20 2020 206e 7061  series):.    npa
-00047c90: 7274 6974 696f 6e73 203d 2062 6173 655f  rtitions = base_
-00047ca0: 7365 7269 6573 2e6e 7061 7274 6974 696f  series.npartitio
-00047cb0: 6e73 0a20 2020 2073 706c 6974 5f6f 7574  ns.    split_out
-00047cc0: 203d 206d 6170 5f73 6572 6965 732e 6e70   = map_series.np
-00047cd0: 6172 7469 7469 6f6e 730a 0a20 2020 2064  artitions..    d
-00047ce0: 736b 203d 207b 7d0a 0a20 2020 2062 6173  sk = {}..    bas
-00047cf0: 655f 746f 6b65 6e5f 6b65 7920 3d20 746f  e_token_key = to
-00047d00: 6b65 6e69 7a65 2862 6173 655f 7365 7269  kenize(base_seri
-00047d10: 6573 2c20 7370 6c69 745f 6f75 7429 0a20  es, split_out). 
-00047d20: 2020 2062 6173 655f 7370 6c69 745f 7072     base_split_pr
-00047d30: 6566 6978 203d 2066 2262 6173 652d 7370  efix = f"base-sp
-00047d40: 6c69 742d 7b62 6173 655f 746f 6b65 6e5f  lit-{base_token_
-00047d50: 6b65 797d 220a 2020 2020 6261 7365 5f73  key}".    base_s
-00047d60: 6861 7264 5f70 7265 6669 7820 3d20 6622  hard_prefix = f"
-00047d70: 6261 7365 2d73 6861 7264 2d7b 6261 7365  base-shard-{base
-00047d80: 5f74 6f6b 656e 5f6b 6579 7d22 0a20 2020  _token_key}".   
-00047d90: 2066 6f72 2069 2c20 6b65 7920 696e 2065   for i, key in e
-00047da0: 6e75 6d65 7261 7465 2862 6173 655f 7365  numerate(base_se
-00047db0: 7269 6573 2e5f 5f64 6173 6b5f 6b65 7973  ries.__dask_keys
-00047dc0: 5f5f 2829 293a 0a20 2020 2020 2020 2064  __()):.        d
-00047dd0: 736b 5b28 6261 7365 5f73 706c 6974 5f70  sk[(base_split_p
-00047de0: 7265 6669 782c 2069 295d 203d 2028 6861  refix, i)] = (ha
-00047df0: 7368 5f73 6861 7264 2c20 6b65 792c 2073  sh_shard, key, s
-00047e00: 706c 6974 5f6f 7574 290a 2020 2020 2020  plit_out).      
-00047e10: 2020 666f 7220 6a20 696e 2072 616e 6765    for j in range
-00047e20: 2873 706c 6974 5f6f 7574 293a 0a20 2020  (split_out):.   
-00047e30: 2020 2020 2020 2020 2064 736b 5b28 6261           dsk[(ba
-00047e40: 7365 5f73 6861 7264 5f70 7265 6669 782c  se_shard_prefix,
-00047e50: 2030 2c20 692c 206a 295d 203d 2028 6765   0, i, j)] = (ge
-00047e60: 7469 7465 6d2c 2028 6261 7365 5f73 706c  titem, (base_spl
-00047e70: 6974 5f70 7265 6669 782c 2069 292c 206a  it_prefix, i), j
-00047e80: 290a 0a20 2020 206d 6170 5f74 6f6b 656e  )..    map_token
-00047e90: 5f6b 6579 203d 2074 6f6b 656e 697a 6528  _key = tokenize(
-00047ea0: 6d61 705f 7365 7269 6573 290a 2020 2020  map_series).    
-00047eb0: 6d61 705f 7370 6c69 745f 7072 6566 6978  map_split_prefix
-00047ec0: 203d 2066 226d 6170 2d73 706c 6974 2d7b   = f"map-split-{
-00047ed0: 6d61 705f 746f 6b65 6e5f 6b65 797d 220a  map_token_key}".
-00047ee0: 2020 2020 6d61 705f 7368 6172 645f 7072      map_shard_pr
-00047ef0: 6566 6978 203d 2066 226d 6170 2d73 6861  efix = f"map-sha
-00047f00: 7264 2d7b 6d61 705f 746f 6b65 6e5f 6b65  rd-{map_token_ke
-00047f10: 797d 220a 2020 2020 666f 7220 692c 206b  y}".    for i, k
-00047f20: 6579 2069 6e20 656e 756d 6572 6174 6528  ey in enumerate(
-00047f30: 6d61 705f 7365 7269 6573 2e5f 5f64 6173  map_series.__das
-00047f40: 6b5f 6b65 7973 5f5f 2829 293a 0a20 2020  k_keys__()):.   
-00047f50: 2020 2020 2064 736b 5b28 6d61 705f 7370       dsk[(map_sp
-00047f60: 6c69 745f 7072 6566 6978 2c20 6929 5d20  lit_prefix, i)] 
-00047f70: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00047f80: 6861 7368 5f73 6861 7264 2c0a 2020 2020  hash_shard,.    
-00047f90: 2020 2020 2020 2020 6b65 792c 0a20 2020          key,.   
-00047fa0: 2020 2020 2020 2020 2073 706c 6974 5f6f           split_o
-00047fb0: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
-00047fc0: 7370 6c69 745f 6f75 745f 6f6e 5f69 6e64  split_out_on_ind
-00047fd0: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
-00047fe0: 4e6f 6e65 2c0a 2020 2020 2020 2020 290a  None,.        ).
-00047ff0: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
-00048000: 2072 616e 6765 2873 706c 6974 5f6f 7574   range(split_out
-00048010: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-00048020: 736b 5b28 6d61 705f 7368 6172 645f 7072  sk[(map_shard_pr
-00048030: 6566 6978 2c20 302c 2069 2c20 6a29 5d20  efix, 0, i, j)] 
-00048040: 3d20 2867 6574 6974 656d 2c20 286d 6170  = (getitem, (map
-00048050: 5f73 706c 6974 5f70 7265 6669 782c 2069  _split_prefix, i
-00048060: 292c 206a 290a 0a20 2020 2074 6f6b 656e  ), j)..    token
-00048070: 5f6b 6579 203d 2074 6f6b 656e 697a 6528  _key = tokenize(
-00048080: 6261 7365 5f73 6572 6965 732c 206d 6170  base_series, map
-00048090: 5f73 6572 6965 7329 0a20 2020 206d 6170  _series).    map
-000480a0: 5f70 7265 6669 7820 3d20 6622 6d61 702d  _prefix = f"map-
-000480b0: 7365 7269 6573 2d7b 746f 6b65 6e5f 6b65  series-{token_ke
-000480c0: 797d 220a 2020 2020 666f 7220 6920 696e  y}".    for i in
-000480d0: 2072 616e 6765 286e 7061 7274 6974 696f   range(npartitio
-000480e0: 6e73 293a 0a20 2020 2020 2020 2066 6f72  ns):.        for
-000480f0: 206a 2069 6e20 7261 6e67 6528 7370 6c69   j in range(spli
-00048100: 745f 6f75 7429 3a0a 2020 2020 2020 2020  t_out):.        
-00048110: 2020 2020 6473 6b5b 286d 6170 5f70 7265      dsk[(map_pre
-00048120: 6669 782c 2069 2c20 6a29 5d20 3d20 280a  fix, i, j)] = (.
-00048130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00048140: 6d61 7073 6572 6965 732c 0a20 2020 2020  mapseries,.     
-00048150: 2020 2020 2020 2020 2020 2028 6261 7365             (base
-00048160: 5f73 6861 7264 5f70 7265 6669 782c 2030  _shard_prefix, 0
-00048170: 2c20 692c 206a 292c 0a20 2020 2020 2020  , i, j),.       
-00048180: 2020 2020 2020 2020 2028 5f63 6f6e 6361           (_conca
-00048190: 742c 205b 286d 6170 5f73 6861 7264 5f70  t, [(map_shard_p
-000481a0: 7265 6669 782c 2030 2c20 6b2c 206a 2920  refix, 0, k, j) 
-000481b0: 666f 7220 6b20 696e 2072 616e 6765 2873  for k in range(s
-000481c0: 706c 6974 5f6f 7574 295d 292c 0a20 2020  plit_out)]),.   
-000481d0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-000481e0: 6669 6e61 6c5f 7072 6566 6978 203d 2066  final_prefix = f
-000481f0: 226d 6170 2d73 6572 6965 732d 636f 6d62  "map-series-comb
-00048200: 696e 652d 7b74 6f6b 656e 5f6b 6579 7d22  ine-{token_key}"
-00048210: 0a20 2020 2066 6f72 2069 2c20 6b65 7920  .    for i, key 
-00048220: 696e 2065 6e75 6d65 7261 7465 2862 6173  in enumerate(bas
-00048230: 655f 7365 7269 6573 2e69 6e64 6578 2e5f  e_series.index._
-00048240: 5f64 6173 6b5f 6b65 7973 5f5f 2829 293a  _dask_keys__()):
-00048250: 0a20 2020 2020 2020 2064 736b 5b28 6669  .        dsk[(fi
-00048260: 6e61 6c5f 7072 6566 6978 2c20 6929 5d20  nal_prefix, i)] 
-00048270: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00048280: 6d61 7073 6572 6965 735f 636f 6d62 696e  mapseries_combin
-00048290: 652c 0a20 2020 2020 2020 2020 2020 206b  e,.            k
-000482a0: 6579 2c0a 2020 2020 2020 2020 2020 2020  ey,.            
-000482b0: 285f 636f 6e63 6174 2c20 5b28 6d61 705f  (_concat, [(map_
-000482c0: 7072 6566 6978 2c20 692c 206a 2920 666f  prefix, i, j) fo
-000482d0: 7220 6a20 696e 2072 616e 6765 2873 706c  r j in range(spl
-000482e0: 6974 5f6f 7574 295d 292c 0a20 2020 2020  it_out)]),.     
-000482f0: 2020 2029 0a0a 2020 2020 6d65 7461 203d     )..    meta =
-00048300: 206d 6170 5f73 6572 6965 732e 5f6d 6574   map_series._met
-00048310: 612e 636f 7079 2829 0a20 2020 206d 6574  a.copy().    met
-00048320: 612e 696e 6465 7820 3d20 6261 7365 5f73  a.index = base_s
-00048330: 6572 6965 732e 5f6d 6574 612e 696e 6465  eries._meta.inde
-00048340: 780a 2020 2020 6d65 7461 203d 206d 616b  x.    meta = mak
-00048350: 655f 6d65 7461 286d 6574 6129 0a0a 2020  e_meta(meta)..  
-00048360: 2020 6465 7065 6e64 656e 6369 6573 203d    dependencies =
-00048370: 205b 6261 7365 5f73 6572 6965 732c 206d   [base_series, m
-00048380: 6170 5f73 6572 6965 732c 2062 6173 655f  ap_series, base_
-00048390: 7365 7269 6573 2e69 6e64 6578 5d0a 2020  series.index].  
-000483a0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-000483b0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-000483c0: 6c6c 6563 7469 6f6e 7328 0a20 2020 2020  llections(.     
-000483d0: 2020 2066 696e 616c 5f70 7265 6669 782c     final_prefix,
-000483e0: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-000483f0: 6573 3d64 6570 656e 6465 6e63 6965 730a  es=dependencies.
-00048400: 2020 2020 290a 2020 2020 6469 7669 7369      ).    divisi
-00048410: 6f6e 7320 3d20 6c69 7374 2862 6173 655f  ons = list(base_
-00048420: 7365 7269 6573 2e64 6976 6973 696f 6e73  series.divisions
-00048430: 290a 0a20 2020 2072 6574 7572 6e20 6e65  )..    return ne
-00048440: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
-00048450: 682c 2066 696e 616c 5f70 7265 6669 782c  h, final_prefix,
-00048460: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
-00048470: 290a 0a0a 6465 6620 5f63 6f6e 7665 7274  )...def _convert
-00048480: 5f74 6f5f 6e75 6d65 7269 6328 7365 7269  _to_numeric(seri
-00048490: 6573 2c20 736b 6970 6e61 293a 0a20 2020  es, skipna):.   
-000484a0: 2069 6620 736b 6970 6e61 3a0a 2020 2020   if skipna:.    
-000484b0: 2020 2020 7265 7475 726e 2073 6572 6965      return serie
-000484c0: 732e 6472 6f70 6e61 2829 2e76 6965 7728  s.dropna().view(
-000484d0: 2269 3822 290a 0a20 2020 2023 2073 6572  "i8")..    # ser
-000484e0: 6965 732e 7669 6577 2822 6938 2229 2077  ies.view("i8") w
-000484f0: 6974 6820 7064 2e4e 6154 2070 726f 6475  ith pd.NaT produ
-00048500: 6365 7320 2d39 3232 3333 3732 3033 3638  ces -92233720368
-00048510: 3534 3737 3538 3038 2069 7320 7768 7920  54775808 is why 
-00048520: 7765 206e 6565 6420 746f 2064 6f20 7468  we need to do th
-00048530: 6973 0a20 2020 2072 6574 7572 6e20 7365  is.    return se
-00048540: 7269 6573 2e76 6965 7728 2269 3822 292e  ries.view("i8").
-00048550: 6d61 736b 2873 6572 6965 732e 6973 6e75  mask(series.isnu
-00048560: 6c6c 2829 2c20 6e70 2e6e 616e 290a 0a0a  ll(), np.nan)...
-00048570: 6465 6620 5f73 7172 745f 616e 645f 636f  def _sqrt_and_co
-00048580: 6e76 6572 745f 746f 5f74 696d 6564 656c  nvert_to_timedel
-00048590: 7461 2870 6172 7469 7469 6f6e 2c20 6178  ta(partition, ax
-000485a0: 6973 2c20 2a61 7267 732c 202a 2a6b 7761  is, *args, **kwa
-000485b0: 7267 7329 3a0a 2020 2020 6966 2061 7869  rgs):.    if axi
-000485c0: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
-000485d0: 7769 7468 2077 6172 6e69 6e67 732e 6361  with warnings.ca
-000485e0: 7463 685f 7761 726e 696e 6773 2829 3a0a  tch_warnings():.
-000485f0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00048600: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
-00048610: 6e67 7328 0a20 2020 2020 2020 2020 2020  ngs(.           
-00048620: 2020 2020 2022 6967 6e6f 7265 222c 0a20       "ignore",. 
-00048630: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00048640: 6174 6567 6f72 793d 5275 6e74 696d 6557  ategory=RuntimeW
-00048650: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
-00048660: 2020 2020 2020 2020 6d65 7373 6167 653d          message=
-00048670: 2269 6e76 616c 6964 2076 616c 7565 2065  "invalid value e
-00048680: 6e63 6f75 6e74 6572 6564 2069 6e20 6361  ncountered in ca
-00048690: 7374 222c 0a20 2020 2020 2020 2020 2020  st",.           
-000486a0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-000486b0: 6574 7572 6e20 7064 2e74 6f5f 7469 6d65  eturn pd.to_time
-000486c0: 6465 6c74 6128 4d2e 7374 6428 7061 7274  delta(M.std(part
-000486d0: 6974 696f 6e2c 2061 7869 733d 6178 6973  ition, axis=axis
-000486e0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-000486f0: 7329 290a 0a20 2020 2069 735f 6466 5f6c  s))..    is_df_l
-00048700: 696b 652c 2074 696d 655f 636f 6c73 203d  ike, time_cols =
-00048710: 206b 7761 7267 735b 2269 735f 6466 5f6c   kwargs["is_df_l
-00048720: 696b 6522 5d2c 206b 7761 7267 735b 2274  ike"], kwargs["t
-00048730: 696d 655f 636f 6c73 225d 0a0a 2020 2020  ime_cols"]..    
-00048740: 7371 7274 203d 206e 702e 7371 7274 2870  sqrt = np.sqrt(p
-00048750: 6172 7469 7469 6f6e 290a 0a20 2020 2069  artition)..    i
-00048760: 6620 6e6f 7420 6973 5f64 665f 6c69 6b65  f not is_df_like
-00048770: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00048780: 2070 642e 746f 5f74 696d 6564 656c 7461   pd.to_timedelta
-00048790: 2873 7172 7429 0a0a 2020 2020 7469 6d65  (sqrt)..    time
-000487a0: 5f63 6f6c 5f6d 6173 6b20 3d20 7371 7274  _col_mask = sqrt
-000487b0: 2e69 6e64 6578 2e69 7369 6e28 7469 6d65  .index.isin(time
-000487c0: 5f63 6f6c 7329 0a20 2020 206d 6174 6368  _cols).    match
-000487d0: 696e 675f 7661 6c73 203d 2073 7172 745b  ing_vals = sqrt[
-000487e0: 7469 6d65 5f63 6f6c 5f6d 6173 6b5d 0a20  time_col_mask]. 
-000487f0: 2020 2066 6f72 2074 696d 655f 636f 6c2c     for time_col,
-00048800: 206d 6174 6368 696e 675f 7661 6c20 696e   matching_val in
-00048810: 207a 6970 2874 696d 655f 636f 6c73 2c20   zip(time_cols, 
-00048820: 6d61 7463 6869 6e67 5f76 616c 7329 3a0a  matching_vals):.
-00048830: 2020 2020 2020 2020 7371 7274 5b74 696d          sqrt[tim
-00048840: 655f 636f 6c5d 203d 2070 642e 746f 5f74  e_col] = pd.to_t
-00048850: 696d 6564 656c 7461 286d 6174 6368 696e  imedelta(matchin
-00048860: 675f 7661 6c29 0a0a 2020 2020 7265 7475  g_val)..    retu
-00048870: 726e 2073 7172 740a 0a0a 6465 6620 5f72  rn sqrt...def _r
-00048880: 6169 7365 5f69 665f 6e6f 745f 7365 7269  aise_if_not_seri
-00048890: 6573 5f6f 725f 6461 7461 6672 616d 6528  es_or_dataframe(
-000488a0: 782c 2066 756e 636e 616d 6529 3a0a 2020  x, funcname):.  
-000488b0: 2020 2222 220a 2020 2020 5574 696c 6974    """.    Utilit
-000488c0: 7920 6675 6e63 7469 6f6e 2074 6f20 7261  y function to ra
-000488d0: 6973 6520 616e 2065 7272 6f72 2069 6620  ise an error if 
-000488e0: 616e 206f 626a 6563 7420 6973 206e 6f74  an object is not
-000488f0: 2061 2053 6572 6965 7320 6f72 2044 6174   a Series or Dat
-00048900: 6146 7261 6d65 0a20 2020 2022 2222 0a20  aFrame.    """. 
-00048910: 2020 2069 6620 6e6f 7420 6973 5f73 6572     if not is_ser
-00048920: 6965 735f 6c69 6b65 2878 2920 616e 6420  ies_like(x) and 
-00048930: 6e6f 7420 6973 5f64 6174 6166 7261 6d65  not is_dataframe
-00048940: 5f6c 696b 6528 7829 3a0a 2020 2020 2020  _like(x):.      
-00048950: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-00048960: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
-00048970: 2020 2020 2020 2020 2022 6025 7360 2069           "`%s` i
-00048980: 7320 6f6e 6c79 2073 7570 706f 7274 6564  s only supported
-00048990: 2077 6974 6820 6f62 6a65 6374 7320 7468   with objects th
-000489a0: 6174 2061 7265 2044 6174 6166 7261 6d65  at are Dataframe
-000489b0: 7320 6f72 2053 6572 6965 7322 0a20 2020  s or Series".   
-000489c0: 2020 2020 2020 2020 2025 2066 756e 636e           % funcn
-000489d0: 616d 650a 2020 2020 2020 2020 290a 0a0a  ame.        )...
-000489e0: 6465 6620 5f67 6574 6174 7472 5f6e 756d  def _getattr_num
-000489f0: 6572 6963 5f6f 6e6c 7928 2a61 7267 732c  eric_only(*args,
-00048a00: 205f 6461 736b 5f6d 6574 686f 645f 6e61   _dask_method_na
-00048a10: 6d65 2c20 2a2a 6b77 6172 6773 293a 0a20  me, **kwargs):. 
-00048a20: 2020 2077 6974 6820 6368 6563 6b5f 6e75     with check_nu
-00048a30: 6d65 7269 635f 6f6e 6c79 5f64 6570 7265  meric_only_depre
-00048a40: 6361 7469 6f6e 2829 3a0a 2020 2020 2020  cation():.      
-00048a50: 2020 7265 7475 726e 2067 6574 6174 7472    return getattr
-00048a60: 284d 2c20 5f64 6173 6b5f 6d65 7468 6f64  (M, _dask_method
-00048a70: 5f6e 616d 6529 282a 6172 6773 2c20 2a2a  _name)(*args, **
-00048a80: 6b77 6172 6773 290a                      kwargs).
+00033280: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00033290: 286d 7367 290a 2020 2020 2020 2020 2020  (msg).          
+000332a0: 2020 2020 2020 656c 6966 2069 735f 7365        elif is_se
+000332b0: 7269 6573 5f6c 696b 6528 6f74 6865 7229  ries_like(other)
+000332c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000332d0: 2020 2020 2020 2320 5370 6563 6961 6c20        # Special 
+000332e0: 6361 7365 2066 6f72 2070 642e 5365 7269  case for pd.Seri
+000332f0: 6573 2074 6f20 6176 6f69 6420 756e 7761  es to avoid unwa
+00033300: 6e74 6564 2070 6172 7469 7469 6f6e 696e  nted partitionin
+00033310: 670a 2020 2020 2020 2020 2020 2020 2020  g.              
+00033320: 2020 2020 2020 2320 6f66 206f 7468 6572        # of other
+00033330: 2e20 5765 2070 6173 7320 6974 2069 6e20  . We pass it in 
+00033340: 6173 2061 206b 7761 7267 2074 6f20 7072  as a kwarg to pr
+00033350: 6576 656e 7420 7468 6973 2e0a 2020 2020  event this..    
+00033360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033370: 6d65 7461 203d 205f 656d 756c 6174 6528  meta = _emulate(
+00033380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033390: 2020 2020 2020 2020 206f 702c 2073 656c           op, sel
+000333a0: 662c 206f 7468 6572 3d6f 7468 6572 2c20  f, other=other, 
+000333b0: 6178 6973 3d61 7869 732c 2066 696c 6c5f  axis=axis, fill_
+000333c0: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
+000333d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000333e0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+000333f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00033400: 6e20 6d61 705f 7061 7274 6974 696f 6e73  n map_partitions
+00033410: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00033420: 2020 2020 2020 2020 2020 6f70 2c0a 2020            op,.  
+00033430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033440: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00033450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033460: 2020 2020 6f74 6865 723d 6f74 6865 722c      other=other,
+00033470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033480: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
+00033490: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+000334a0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+000334b0: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
+000334c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000334d0: 696c 6c5f 7661 6c75 653d 6669 6c6c 5f76  ill_value=fill_v
+000334e0: 616c 7565 2c0a 2020 2020 2020 2020 2020  alue,.          
+000334f0: 2020 2020 2020 2020 2020 2020 2020 656e                en
+00033500: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+00033510: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00033520: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00033530: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
+00033540: 5f65 6d75 6c61 7465 286f 702c 2073 656c  _emulate(op, sel
+00033550: 662c 206f 7468 6572 2c20 6178 6973 3d61  f, other, axis=a
+00033560: 7869 732c 2066 696c 6c5f 7661 6c75 653d  xis, fill_value=
+00033570: 6669 6c6c 5f76 616c 7565 290a 2020 2020  fill_value).    
+00033580: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+00033590: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+000335a0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000335b0: 702c 0a20 2020 2020 2020 2020 2020 2020  p,.             
+000335c0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000335d0: 2020 2020 2020 2020 206f 7468 6572 2c0a           other,.
+000335e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000335f0: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
+00033600: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+00033610: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+00033620: 2020 2020 2020 6669 6c6c 5f76 616c 7565        fill_value
+00033630: 3d66 696c 6c5f 7661 6c75 652c 0a20 2020  =fill_value,.   
+00033640: 2020 2020 2020 2020 2020 2020 2065 6e66               enf
+00033650: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
+00033660: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00033670: 2029 0a0a 2020 2020 2020 2020 6d65 7468   )..        meth
+00033680: 2e5f 5f6e 616d 655f 5f20 3d20 6e61 6d65  .__name__ = name
+00033690: 0a20 2020 2020 2020 2073 6574 6174 7472  .        setattr
+000336a0: 2863 6c73 2c20 6e61 6d65 2c20 6465 7269  (cls, name, deri
+000336b0: 7665 645f 6672 6f6d 286f 7269 6769 6e61  ved_from(origina
+000336c0: 6c29 286d 6574 6829 290a 0a20 2020 2040  l)(meth))..    @
+000336d0: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
+000336e0: 6465 6620 5f62 696e 645f 636f 6d70 6172  def _bind_compar
+000336f0: 6973 6f6e 5f6d 6574 686f 6428 636c 732c  ison_method(cls,
+00033700: 206e 616d 652c 2063 6f6d 7061 7269 736f   name, compariso
+00033710: 6e2c 206f 7269 6769 6e61 6c3d 7064 2e44  n, original=pd.D
+00033720: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
+00033730: 2020 2022 2222 6269 6e64 2063 6f6d 7061     """bind compa
+00033740: 7269 736f 6e20 6d65 7468 6f64 206c 696b  rison method lik
+00033750: 6520 4461 7461 4672 616d 652e 6571 2074  e DataFrame.eq t
+00033760: 6f20 7468 6973 2063 6c61 7373 2222 220a  o this class""".
+00033770: 0a20 2020 2020 2020 2064 6566 206d 6574  .        def met
+00033780: 6828 7365 6c66 2c20 6f74 6865 722c 2061  h(self, other, a
+00033790: 7869 733d 2263 6f6c 756d 6e73 222c 206c  xis="columns", l
+000337a0: 6576 656c 3d4e 6f6e 6529 3a0a 2020 2020  evel=None):.    
+000337b0: 2020 2020 2020 2020 6966 206c 6576 656c          if level
+000337c0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000337d0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+000337e0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+000337f0: 6564 4572 726f 7228 226c 6576 656c 206d  edError("level m
+00033800: 7573 7420 6265 204e 6f6e 6522 290a 2020  ust be None").  
+00033810: 2020 2020 2020 2020 2020 6178 6973 203d            axis =
+00033820: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
+00033830: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
+00033840: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
+00033850: 656d 7769 7365 2863 6f6d 7061 7269 736f  emwise(compariso
+00033860: 6e2c 2073 656c 662c 206f 7468 6572 2c20  n, self, other, 
+00033870: 6178 6973 3d61 7869 7329 0a0a 2020 2020  axis=axis)..    
+00033880: 2020 2020 6d65 7468 2e5f 5f6e 616d 655f      meth.__name_
+00033890: 5f20 3d20 6e61 6d65 0a20 2020 2020 2020  _ = name.       
+000338a0: 2073 6574 6174 7472 2863 6c73 2c20 6e61   setattr(cls, na
+000338b0: 6d65 2c20 6465 7269 7665 645f 6672 6f6d  me, derived_from
+000338c0: 286f 7269 6769 6e61 6c29 286d 6574 6829  (original)(meth)
+000338d0: 290a 0a20 2020 2040 696e 7365 7274 5f6d  )..    @insert_m
+000338e0: 6574 615f 7061 7261 6d5f 6465 7363 7269  eta_param_descri
+000338f0: 7074 696f 6e28 7061 643d 3132 290a 2020  ption(pad=12).  
+00033900: 2020 6465 6620 6170 706c 7928 0a20 2020    def apply(.   
+00033910: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00033920: 2020 2066 756e 632c 0a20 2020 2020 2020     func,.       
+00033930: 2061 7869 733d 302c 0a20 2020 2020 2020   axis=0,.       
+00033940: 2062 726f 6164 6361 7374 3d4e 6f6e 652c   broadcast=None,
+00033950: 0a20 2020 2020 2020 2072 6177 3d46 616c  .        raw=Fal
+00033960: 7365 2c0a 2020 2020 2020 2020 7265 6475  se,.        redu
+00033970: 6365 3d4e 6f6e 652c 0a20 2020 2020 2020  ce=None,.       
+00033980: 2061 7267 733d 2829 2c0a 2020 2020 2020   args=(),.      
+00033990: 2020 6d65 7461 3d6e 6f5f 6465 6661 756c    meta=no_defaul
+000339a0: 742c 0a20 2020 2020 2020 2072 6573 756c  t,.        resul
+000339b0: 745f 7479 7065 3d4e 6f6e 652c 0a20 2020  t_type=None,.   
+000339c0: 2020 2020 202a 2a6b 7764 732c 0a20 2020       **kwds,.   
+000339d0: 2029 3a0a 2020 2020 2020 2020 2222 2250   ):.        """P
+000339e0: 6172 616c 6c65 6c20 7665 7273 696f 6e20  arallel version 
+000339f0: 6f66 2070 616e 6461 732e 4461 7461 4672  of pandas.DataFr
+00033a00: 616d 652e 6170 706c 790a 0a20 2020 2020  ame.apply..     
+00033a10: 2020 2054 6869 7320 6d69 6d69 6373 2074     This mimics t
+00033a20: 6865 2070 616e 6461 7320 7665 7273 696f  he pandas versio
+00033a30: 6e20 6578 6365 7074 2066 6f72 2074 6865  n except for the
+00033a40: 2066 6f6c 6c6f 7769 6e67 3a0a 0a20 2020   following:..   
+00033a50: 2020 2020 2031 2e20 204f 6e6c 7920 6060       1.  Only ``
+00033a60: 6178 6973 3d31 6060 2069 7320 7375 7070  axis=1`` is supp
+00033a70: 6f72 7465 6420 2861 6e64 206d 7573 7420  orted (and must 
+00033a80: 6265 2073 7065 6369 6669 6564 2065 7870  be specified exp
+00033a90: 6c69 6369 746c 7929 2e0a 2020 2020 2020  licitly)..      
+00033aa0: 2020 322e 2020 5468 6520 7573 6572 2073    2.  The user s
+00033ab0: 686f 756c 6420 7072 6f76 6964 6520 6f75  hould provide ou
+00033ac0: 7470 7574 206d 6574 6164 6174 6120 7669  tput metadata vi
+00033ad0: 6120 7468 6520 606d 6574 6160 206b 6579  a the `meta` key
+00033ae0: 776f 7264 2e0a 0a20 2020 2020 2020 2050  word...        P
+00033af0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00033b00: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00033b10: 2020 2020 2066 756e 6320 3a20 6675 6e63       func : func
+00033b20: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+00033b30: 2046 756e 6374 696f 6e20 746f 2061 7070   Function to app
+00033b40: 6c79 2074 6f20 6561 6368 2063 6f6c 756d  ly to each colum
+00033b50: 6e2f 726f 770a 2020 2020 2020 2020 6178  n/row.        ax
+00033b60: 6973 203a 207b 3020 6f72 2027 696e 6465  is : {0 or 'inde
+00033b70: 7827 2c20 3120 6f72 2027 636f 6c75 6d6e  x', 1 or 'column
+00033b80: 7327 7d2c 2064 6566 6175 6c74 2030 0a20  s'}, default 0. 
+00033b90: 2020 2020 2020 2020 2020 202d 2030 206f             - 0 o
+00033ba0: 7220 2769 6e64 6578 273a 2061 7070 6c79  r 'index': apply
+00033bb0: 2066 756e 6374 696f 6e20 746f 2065 6163   function to eac
+00033bc0: 6820 636f 6c75 6d6e 2028 4e4f 5420 5355  h column (NOT SU
+00033bd0: 5050 4f52 5445 4429 0a20 2020 2020 2020  PPORTED).       
+00033be0: 2020 2020 202d 2031 206f 7220 2763 6f6c       - 1 or 'col
+00033bf0: 756d 6e73 273a 2061 7070 6c79 2066 756e  umns': apply fun
+00033c00: 6374 696f 6e20 746f 2065 6163 6820 726f  ction to each ro
+00033c10: 770a 2020 2020 2020 2020 244d 4554 410a  w.        $META.
+00033c20: 2020 2020 2020 2020 6172 6773 203a 2074          args : t
+00033c30: 7570 6c65 0a20 2020 2020 2020 2020 2020  uple.           
+00033c40: 2050 6f73 6974 696f 6e61 6c20 6172 6775   Positional argu
+00033c50: 6d65 6e74 7320 746f 2070 6173 7320 746f  ments to pass to
+00033c60: 2066 756e 6374 696f 6e20 696e 2061 6464   function in add
+00033c70: 6974 696f 6e20 746f 2074 6865 2061 7272  ition to the arr
+00033c80: 6179 2f73 6572 6965 730a 0a20 2020 2020  ay/series..     
+00033c90: 2020 2041 6464 6974 696f 6e61 6c20 6b65     Additional ke
+00033ca0: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
+00033cb0: 7769 6c6c 2062 6520 7061 7373 6564 2061  will be passed a
+00033cc0: 7320 6b65 7977 6f72 6473 2074 6f20 7468  s keywords to th
+00033cd0: 6520 6675 6e63 7469 6f6e 0a0a 2020 2020  e function..    
+00033ce0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00033cf0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00033d00: 2020 2020 6170 706c 6965 6420 3a20 5365      applied : Se
+00033d10: 7269 6573 206f 7220 4461 7461 4672 616d  ries or DataFram
+00033d20: 650a 0a20 2020 2020 2020 2045 7861 6d70  e..        Examp
+00033d30: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
+00033d40: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
+00033d50: 2069 6d70 6f72 7420 7061 6e64 6173 2061   import pandas a
+00033d60: 7320 7064 0a20 2020 2020 2020 203e 3e3e  s pd.        >>>
+00033d70: 2069 6d70 6f72 7420 6461 736b 2e64 6174   import dask.dat
+00033d80: 6166 7261 6d65 2061 7320 6464 0a20 2020  aframe as dd.   
+00033d90: 2020 2020 203e 3e3e 2064 6620 3d20 7064       >>> df = pd
+00033da0: 2e44 6174 6146 7261 6d65 287b 2778 273a  .DataFrame({'x':
+00033db0: 205b 312c 2032 2c20 332c 2034 2c20 355d   [1, 2, 3, 4, 5]
+00033dc0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+00033dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033de0: 2027 7927 3a20 5b31 2e2c 2032 2e2c 2033   'y': [1., 2., 3
+00033df0: 2e2c 2034 2e2c 2035 2e5d 7d29 0a20 2020  ., 4., 5.]}).   
+00033e00: 2020 2020 203e 3e3e 2064 6466 203d 2064       >>> ddf = d
+00033e10: 642e 6672 6f6d 5f70 616e 6461 7328 6466  d.from_pandas(df
+00033e20: 2c20 6e70 6172 7469 7469 6f6e 733d 3229  , npartitions=2)
+00033e30: 0a0a 2020 2020 2020 2020 4170 706c 7920  ..        Apply 
+00033e40: 6120 6675 6e63 7469 6f6e 2074 6f20 726f  a function to ro
+00033e50: 772d 7769 7365 2070 6173 7369 6e67 2069  w-wise passing i
+00033e60: 6e20 6578 7472 6120 6172 6775 6d65 6e74  n extra argument
+00033e70: 7320 696e 2060 6061 7267 7360 6020 616e  s in ``args`` an
+00033e80: 640a 2020 2020 2020 2020 6060 6b77 6172  d.        ``kwar
+00033e90: 6773 6060 3a0a 0a20 2020 2020 2020 203e  gs``:..        >
+00033ea0: 3e3e 2064 6566 206d 7961 6464 2872 6f77  >> def myadd(row
+00033eb0: 2c20 612c 2062 3d31 293a 0a20 2020 2020  , a, b=1):.     
+00033ec0: 2020 202e 2e2e 2020 2020 2072 6574 7572     ...     retur
+00033ed0: 6e20 726f 772e 7375 6d28 2920 2b20 6120  n row.sum() + a 
+00033ee0: 2b20 620a 2020 2020 2020 2020 3e3e 3e20  + b.        >>> 
+00033ef0: 7265 7320 3d20 6464 662e 6170 706c 7928  res = ddf.apply(
+00033f00: 6d79 6164 642c 2061 7869 733d 312c 2061  myadd, axis=1, a
+00033f10: 7267 733d 2832 2c29 2c20 623d 312e 3529  rgs=(2,), b=1.5)
+00033f20: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+00033f30: 4950 0a0a 2020 2020 2020 2020 4279 2064  IP..        By d
+00033f40: 6566 6175 6c74 2c20 6461 736b 2074 7269  efault, dask tri
+00033f50: 6573 2074 6f20 696e 6665 7220 7468 6520  es to infer the 
+00033f60: 6f75 7470 7574 206d 6574 6164 6174 6120  output metadata 
+00033f70: 6279 2072 756e 6e69 6e67 2079 6f75 720a  by running your.
+00033f80: 2020 2020 2020 2020 7072 6f76 6964 6564          provided
+00033f90: 2066 756e 6374 696f 6e20 6f6e 2073 6f6d   function on som
+00033fa0: 6520 6661 6b65 2064 6174 612e 2054 6869  e fake data. Thi
+00033fb0: 7320 776f 726b 7320 7765 6c6c 2069 6e20  s works well in 
+00033fc0: 6d61 6e79 2063 6173 6573 2c20 6275 740a  many cases, but.
+00033fd0: 2020 2020 2020 2020 6361 6e20 736f 6d65          can some
+00033fe0: 7469 6d65 7320 6265 2065 7870 656e 7369  times be expensi
+00033ff0: 7665 2c20 6f72 2065 7665 6e20 6661 696c  ve, or even fail
+00034000: 2e20 546f 2061 766f 6964 2074 6869 732c  . To avoid this,
+00034010: 2079 6f75 2063 616e 0a20 2020 2020 2020   you can.       
+00034020: 206d 616e 7561 6c6c 7920 7370 6563 6966   manually specif
+00034030: 7920 7468 6520 6f75 7470 7574 206d 6574  y the output met
+00034040: 6164 6174 6120 7769 7468 2074 6865 2060  adata with the `
+00034050: 606d 6574 6160 6020 6b65 7977 6f72 642e  `meta`` keyword.
+00034060: 2054 6869 730a 2020 2020 2020 2020 6361   This.        ca
+00034070: 6e20 6265 2073 7065 6369 6669 6564 2069  n be specified i
+00034080: 6e20 6d61 6e79 2066 6f72 6d73 2c20 666f  n many forms, fo
+00034090: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
+000340a0: 6f6e 2073 6565 0a20 2020 2020 2020 2060  on see.        `
+000340b0: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
+000340c0: 7574 696c 732e 6d61 6b65 5f6d 6574 6160  utils.make_meta`
+000340d0: 602e 0a0a 2020 2020 2020 2020 4865 7265  `...        Here
+000340e0: 2077 6520 7370 6563 6966 7920 7468 6520   we specify the 
+000340f0: 6f75 7470 7574 2069 7320 6120 5365 7269  output is a Seri
+00034100: 6573 2077 6974 6820 6e61 6d65 2060 6027  es with name ``'
+00034110: 7827 6060 2c20 616e 6420 6474 7970 650a  x'``, and dtype.
+00034120: 2020 2020 2020 2020 6060 666c 6f61 7436          ``float6
+00034130: 3460 603a 0a0a 2020 2020 2020 2020 3e3e  4``:..        >>
+00034140: 3e20 7265 7320 3d20 6464 662e 6170 706c  > res = ddf.appl
+00034150: 7928 6d79 6164 642c 2061 7869 733d 312c  y(myadd, axis=1,
+00034160: 2061 7267 733d 2832 2c29 2c20 623d 312e   args=(2,), b=1.
+00034170: 352c 206d 6574 613d 2827 7827 2c20 2766  5, meta=('x', 'f
+00034180: 3827 2929 0a0a 2020 2020 2020 2020 496e  8'))..        In
+00034190: 2074 6865 2063 6173 6520 7768 6572 6520   the case where 
+000341a0: 7468 6520 6d65 7461 6461 7461 2064 6f65  the metadata doe
+000341b0: 736e 2774 2063 6861 6e67 652c 2079 6f75  sn't change, you
+000341c0: 2063 616e 2061 6c73 6f20 7061 7373 2069   can also pass i
+000341d0: 6e0a 2020 2020 2020 2020 7468 6520 6f62  n.        the ob
+000341e0: 6a65 6374 2069 7473 656c 6620 6469 7265  ject itself dire
+000341f0: 6374 6c79 3a0a 0a20 2020 2020 2020 203e  ctly:..        >
+00034200: 3e3e 2072 6573 203d 2064 6466 2e61 7070  >> res = ddf.app
+00034210: 6c79 286c 616d 6264 6120 726f 773a 2072  ly(lambda row: r
+00034220: 6f77 202b 2031 2c20 6178 6973 3d31 2c20  ow + 1, axis=1, 
+00034230: 6d65 7461 3d64 6466 290a 0a20 2020 2020  meta=ddf)..     
+00034240: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+00034250: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+00034260: 2020 2020 2064 6173 6b2e 4461 7461 4672       dask.DataFr
+00034270: 616d 652e 6d61 705f 7061 7274 6974 696f  ame.map_partitio
+00034280: 6e73 0a20 2020 2020 2020 2022 2222 0a0a  ns.        """..
+00034290: 2020 2020 2020 2020 6966 2062 726f 6164          if broad
+000342a0: 6361 7374 2069 7320 6e6f 7420 4e6f 6e65  cast is not None
+000342b0: 3a0a 2020 2020 2020 2020 2020 2020 7761  :.            wa
+000342c0: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
+000342d0: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
+000342e0: 6520 6062 726f 6164 6361 7374 6020 6172  e `broadcast` ar
+000342f0: 6775 6d65 6e74 2069 7320 6e6f 206c 6f6e  gument is no lon
+00034300: 6765 7220 7573 6564 2f73 7570 706f 7274  ger used/support
+00034310: 6564 2e20 220a 2020 2020 2020 2020 2020  ed. ".          
+00034320: 2020 2020 2020 2249 7420 7769 6c6c 2062        "It will b
+00034330: 6520 6472 6f70 7065 6420 696e 2061 2066  e dropped in a f
+00034340: 7574 7572 6520 7265 6c65 6173 652e 222c  uture release.",
+00034350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034360: 2063 6174 6567 6f72 793d 4675 7475 7265   category=Future
+00034370: 5761 726e 696e 672c 0a20 2020 2020 2020  Warning,.       
+00034380: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00034390: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
+000343a0: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
+000343b0: 0a20 2020 2020 2020 2070 616e 6461 735f  .        pandas_
+000343c0: 6b77 6172 6773 203d 207b 2261 7869 7322  kwargs = {"axis"
+000343d0: 3a20 6178 6973 2c20 2272 6177 223a 2072  : axis, "raw": r
+000343e0: 6177 2c20 2272 6573 756c 745f 7479 7065  aw, "result_type
+000343f0: 223a 2072 6573 756c 745f 7479 7065 7d0a  ": result_type}.
+00034400: 0a20 2020 2020 2020 206b 7764 732e 7570  .        kwds.up
+00034410: 6461 7465 2870 616e 6461 735f 6b77 6172  date(pandas_kwar
+00034420: 6773 290a 0a20 2020 2020 2020 2069 6620  gs)..        if 
+00034430: 6178 6973 203d 3d20 303a 0a20 2020 2020  axis == 0:.     
+00034440: 2020 2020 2020 206d 7367 203d 2028 0a20         msg = (. 
+00034450: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00034460: 6464 2e44 6174 6146 7261 6d65 2e61 7070  dd.DataFrame.app
+00034470: 6c79 206f 6e6c 7920 7375 7070 6f72 7473  ly only supports
+00034480: 2061 7869 733d 315c 6e22 0a20 2020 2020   axis=1\n".     
+00034490: 2020 2020 2020 2020 2020 2022 2020 5472             "  Tr
+000344a0: 793a 2064 662e 6170 706c 7928 6675 6e63  y: df.apply(func
+000344b0: 2c20 6178 6973 3d31 2922 0a20 2020 2020  , axis=1)".     
+000344c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000344d0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+000344e0: 706c 656d 656e 7465 6445 7272 6f72 286d  plementedError(m
+000344f0: 7367 290a 0a20 2020 2020 2020 2069 6620  sg)..        if 
+00034500: 6d65 7461 2069 7320 6e6f 5f64 6566 6175  meta is no_defau
+00034510: 6c74 3a0a 2020 2020 2020 2020 2020 2020  lt:.            
+00034520: 6d65 7461 203d 205f 656d 756c 6174 6528  meta = _emulate(
+00034530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034540: 204d 2e61 7070 6c79 2c20 7365 6c66 2e5f   M.apply, self._
+00034550: 6d65 7461 5f6e 6f6e 656d 7074 792c 2066  meta_nonempty, f
+00034560: 756e 632c 2061 7267 733d 6172 6773 2c20  unc, args=args, 
+00034570: 7564 663d 5472 7565 2c20 2a2a 6b77 6473  udf=True, **kwds
+00034580: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00034590: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+000345a0: 6e67 732e 7761 726e 286d 6574 615f 7761  ngs.warn(meta_wa
+000345b0: 726e 696e 6728 6d65 7461 2929 0a20 2020  rning(meta)).   
+000345c0: 2020 2020 206b 7764 732e 7570 6461 7465       kwds.update
+000345d0: 287b 2270 6172 656e 745f 6d65 7461 223a  ({"parent_meta":
+000345e0: 2073 656c 662e 5f6d 6574 617d 290a 2020   self._meta}).  
+000345f0: 2020 2020 2020 7265 7475 726e 206d 6170        return map
+00034600: 5f70 6172 7469 7469 6f6e 7328 4d2e 6170  _partitions(M.ap
+00034610: 706c 792c 2073 656c 662c 2066 756e 632c  ply, self, func,
+00034620: 2061 7267 733d 6172 6773 2c20 6d65 7461   args=args, meta
+00034630: 3d6d 6574 612c 202a 2a6b 7764 7329 0a0a  =meta, **kwds)..
+00034640: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00034650: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+00034660: 2020 2020 6465 6620 6170 706c 796d 6170      def applymap
+00034670: 2873 656c 662c 2066 756e 632c 206d 6574  (self, func, met
+00034680: 613d 225f 5f6e 6f5f 6465 6661 756c 745f  a="__no_default_
+00034690: 5f22 293a 0a20 2020 2020 2020 2072 6574  _"):.        ret
+000346a0: 7572 6e20 656c 656d 7769 7365 284d 2e61  urn elemwise(M.a
+000346b0: 7070 6c79 6d61 702c 2073 656c 662c 2066  pplymap, self, f
+000346c0: 756e 632c 206d 6574 613d 6d65 7461 290a  unc, meta=meta).
+000346d0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+000346e0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+000346f0: 0a20 2020 2064 6566 2072 6f75 6e64 2873  .    def round(s
+00034700: 656c 662c 2064 6563 696d 616c 733d 3029  elf, decimals=0)
+00034710: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00034720: 2065 6c65 6d77 6973 6528 4d2e 726f 756e   elemwise(M.roun
+00034730: 642c 2073 656c 662c 2064 6563 696d 616c  d, self, decimal
+00034740: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
+00034750: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00034760: 6d65 290a 2020 2020 6465 6620 6e75 6e69  me).    def nuni
+00034770: 7175 6528 7365 6c66 2c20 7370 6c69 745f  que(self, split_
+00034780: 6576 6572 793d 4661 6c73 652c 2064 726f  every=False, dro
+00034790: 706e 613d 5472 7565 2c20 6178 6973 3d30  pna=True, axis=0
+000347a0: 293a 0a20 2020 2020 2020 2069 6620 6178  ):.        if ax
+000347b0: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
+000347c0: 2020 2020 2023 2073 706c 6974 5f65 7665       # split_eve
+000347d0: 7279 206e 6f74 2075 7365 6420 666f 7220  ry not used for 
+000347e0: 6178 6973 3d31 0a20 2020 2020 2020 2020  axis=1.         
+000347f0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+00034800: 6d65 7461 5f6e 6f6e 656d 7074 792e 6e75  meta_nonempty.nu
+00034810: 6e69 7175 6528 6178 6973 3d61 7869 7329  nique(axis=axis)
+00034820: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00034830: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
+00034840: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
+00034850: 2020 2020 2020 2020 204d 2e6e 756e 6971           M.nuniq
+00034860: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+00034870: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
+00034880: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00034890: 6f6b 656e 3d22 7365 7269 6573 2d6e 756e  oken="series-nun
+000348a0: 6971 7565 222c 0a20 2020 2020 2020 2020  ique",.         
+000348b0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+000348c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000348d0: 2020 6472 6f70 6e61 3d64 726f 706e 612c    dropna=dropna,
+000348e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000348f0: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+00034900: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
+00034910: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00034920: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00034930: 206e 756e 6971 7565 5f6c 6973 7420 3d20   nunique_list = 
+00034940: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00034950: 2020 7365 6c66 5b63 6f6c 5d2e 6e75 6e69    self[col].nuni
+00034960: 7175 6528 7370 6c69 745f 6576 6572 793d  que(split_every=
+00034970: 7370 6c69 745f 6576 6572 792c 2064 726f  split_every, dro
+00034980: 706e 613d 6472 6f70 6e61 290a 2020 2020  pna=dropna).    
+00034990: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000349a0: 636f 6c20 696e 2073 656c 662e 636f 6c75  col in self.colu
+000349b0: 6d6e 730a 2020 2020 2020 2020 2020 2020  mns.            
+000349c0: 5d0a 2020 2020 2020 2020 2020 2020 6e61  ].            na
+000349d0: 6d65 203d 2022 7365 7269 6573 2d22 202b  me = "series-" +
+000349e0: 2074 6f6b 656e 697a 6528 2a6e 756e 6971   tokenize(*nuniq
+000349f0: 7565 5f6c 6973 7429 0a20 2020 2020 2020  ue_list).       
+00034a00: 2020 2020 2064 736b 203d 207b 0a20 2020       dsk = {.   
+00034a10: 2020 2020 2020 2020 2020 2020 2028 6e61               (na
+00034a20: 6d65 2c20 3029 3a20 280a 2020 2020 2020  me, 0): (.      
+00034a30: 2020 2020 2020 2020 2020 2020 2020 6170                ap
+00034a40: 706c 792c 0a20 2020 2020 2020 2020 2020  ply,.           
+00034a50: 2020 2020 2020 2020 2070 642e 5365 7269           pd.Seri
+00034a60: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+00034a70: 2020 2020 2020 2020 5b5b 2873 2e5f 6e61          [[(s._na
+00034a80: 6d65 2c20 3029 2066 6f72 2073 2069 6e20  me, 0) for s in 
+00034a90: 6e75 6e69 7175 655f 6c69 7374 5d5d 2c0a  nunique_list]],.
+00034aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034ab0: 2020 2020 7b22 696e 6465 7822 3a20 7365      {"index": se
+00034ac0: 6c66 2e63 6f6c 756d 6e73 7d2c 0a20 2020  lf.columns},.   
+00034ad0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00034ae0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+00034af0: 2020 2020 2020 2020 2067 7261 7068 203d           graph =
+00034b00: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
+00034b10: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
+00034b20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00034b30: 2020 6e61 6d65 2c20 6473 6b2c 2064 6570    name, dsk, dep
+00034b40: 656e 6465 6e63 6965 733d 6e75 6e69 7175  endencies=nuniqu
+00034b50: 655f 6c69 7374 0a20 2020 2020 2020 2020  e_list.         
+00034b60: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00034b70: 2072 6574 7572 6e20 5365 7269 6573 2867   return Series(g
+00034b80: 7261 7068 2c20 6e61 6d65 2c20 7365 6c66  raph, name, self
+00034b90: 2e5f 6d65 7461 2e6e 756e 6971 7565 2829  ._meta.nunique()
+00034ba0: 2c20 284e 6f6e 652c 204e 6f6e 6529 290a  , (None, None)).
+00034bb0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00034bc0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+00034bd0: 0a20 2020 2064 6566 206d 6f64 6528 7365  .    def mode(se
+00034be0: 6c66 2c20 6472 6f70 6e61 3d54 7275 652c  lf, dropna=True,
+00034bf0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+00034c00: 7365 293a 0a20 2020 2020 2020 206d 6f64  se):.        mod
+00034c10: 655f 7365 7269 6573 5f6c 6973 7420 3d20  e_series_list = 
+00034c20: 5b5d 0a20 2020 2020 2020 2066 6f72 2063  [].        for c
+00034c30: 6f6c 5f69 6e64 6578 2069 6e20 7261 6e67  ol_index in rang
+00034c40: 6528 6c65 6e28 7365 6c66 2e63 6f6c 756d  e(len(self.colum
+00034c50: 6e73 2929 3a0a 2020 2020 2020 2020 2020  ns)):.          
+00034c60: 2020 636f 6c5f 7365 7269 6573 203d 2073    col_series = s
+00034c70: 656c 662e 696c 6f63 5b3a 2c20 636f 6c5f  elf.iloc[:, col_
+00034c80: 696e 6465 785d 0a20 2020 2020 2020 2020  index].         
+00034c90: 2020 206d 6f64 655f 7365 7269 6573 203d     mode_series =
+00034ca0: 2053 6572 6965 732e 6d6f 6465 280a 2020   Series.mode(.  
+00034cb0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00034cc0: 6c5f 7365 7269 6573 2c20 6472 6f70 6e61  l_series, dropna
+00034cd0: 3d64 726f 706e 612c 2073 706c 6974 5f65  =dropna, split_e
+00034ce0: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+00034cf0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00034d00: 2020 2020 2020 2020 2020 206d 6f64 655f             mode_
+00034d10: 7365 7269 6573 5f6c 6973 742e 6170 7065  series_list.appe
+00034d20: 6e64 286d 6f64 655f 7365 7269 6573 290a  nd(mode_series).
+00034d30: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
+00034d40: 2263 6f6e 6361 742d 2220 2b20 746f 6b65  "concat-" + toke
+00034d50: 6e69 7a65 282a 6d6f 6465 5f73 6572 6965  nize(*mode_serie
+00034d60: 735f 6c69 7374 290a 0a20 2020 2020 2020  s_list)..       
+00034d70: 2064 736b 203d 207b 0a20 2020 2020 2020   dsk = {.       
+00034d80: 2020 2020 2028 6e61 6d65 2c20 3029 3a20       (name, 0): 
+00034d90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00034da0: 2020 6170 706c 792c 0a20 2020 2020 2020    apply,.       
+00034db0: 2020 2020 2020 2020 206d 6574 686f 6473           methods
+00034dc0: 2e63 6f6e 6361 742c 0a20 2020 2020 2020  .concat,.       
+00034dd0: 2020 2020 2020 2020 205b 5b28 6466 2e5f           [[(df._
+00034de0: 6e61 6d65 2c20 3029 2066 6f72 2064 6620  name, 0) for df 
+00034df0: 696e 206d 6f64 655f 7365 7269 6573 5f6c  in mode_series_l
+00034e00: 6973 745d 5d2c 0a20 2020 2020 2020 2020  ist]],.         
+00034e10: 2020 2020 2020 207b 2261 7869 7322 3a20         {"axis": 
+00034e20: 317d 2c0a 2020 2020 2020 2020 2020 2020  1},.            
+00034e30: 290a 2020 2020 2020 2020 7d0a 0a20 2020  ).        }..   
+00034e40: 2020 2020 206d 6574 6120 3d20 6d65 7468       meta = meth
+00034e50: 6f64 732e 636f 6e63 6174 285b 6466 2e5f  ods.concat([df._
+00034e60: 6d65 7461 2066 6f72 2064 6620 696e 206d  meta for df in m
+00034e70: 6f64 655f 7365 7269 6573 5f6c 6973 745d  ode_series_list]
+00034e80: 2c20 6178 6973 3d31 290a 2020 2020 2020  , axis=1).      
+00034e90: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+00034ea0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+00034eb0: 6c6c 6563 7469 6f6e 7328 0a20 2020 2020  llections(.     
+00034ec0: 2020 2020 2020 206e 616d 652c 2064 736b         name, dsk
+00034ed0: 2c20 6465 7065 6e64 656e 6369 6573 3d6d  , dependencies=m
+00034ee0: 6f64 655f 7365 7269 6573 5f6c 6973 740a  ode_series_list.
+00034ef0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00034f00: 2020 6464 6620 3d20 6e65 775f 6464 5f6f    ddf = new_dd_o
+00034f10: 626a 6563 7428 6772 6170 682c 206e 616d  bject(graph, nam
+00034f20: 652c 206d 6574 612c 2064 6976 6973 696f  e, meta, divisio
+00034f30: 6e73 3d28 4e6f 6e65 2c20 4e6f 6e65 2929  ns=(None, None))
+00034f40: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00034f50: 2064 6466 0a0a 2020 2020 4064 6572 6976   ddf..    @deriv
+00034f60: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00034f70: 7261 6d65 290a 2020 2020 6465 6620 636f  rame).    def co
+00034f80: 7628 7365 6c66 2c20 6d69 6e5f 7065 7269  v(self, min_peri
+00034f90: 6f64 733d 4e6f 6e65 2c20 6e75 6d65 7269  ods=None, numeri
+00034fa0: 635f 6f6e 6c79 3d6e 6f5f 6465 6661 756c  c_only=no_defaul
+00034fb0: 742c 2073 706c 6974 5f65 7665 7279 3d46  t, split_every=F
+00034fc0: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
+00034fd0: 6574 7572 6e20 5f63 6f76 5f63 6f72 7228  eturn _cov_corr(
+00034fe0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00034ff0: 662c 206d 696e 5f70 6572 696f 6473 2c20  f, min_periods, 
+00035000: 6e75 6d65 7269 635f 6f6e 6c79 3d6e 756d  numeric_only=num
+00035010: 6572 6963 5f6f 6e6c 792c 2073 706c 6974  eric_only, split
+00035020: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+00035030: 7279 0a20 2020 2020 2020 2029 0a0a 2020  ry.        )..  
+00035040: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00035050: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+00035060: 2020 6465 6620 636f 7272 280a 2020 2020    def corr(.    
+00035070: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00035080: 2020 6d65 7468 6f64 3d22 7065 6172 736f    method="pearso
+00035090: 6e22 2c0a 2020 2020 2020 2020 6d69 6e5f  n",.        min_
+000350a0: 7065 7269 6f64 733d 4e6f 6e65 2c0a 2020  periods=None,.  
+000350b0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+000350c0: 6c79 3d6e 6f5f 6465 6661 756c 742c 0a20  ly=no_default,. 
+000350d0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+000350e0: 7279 3d46 616c 7365 2c0a 2020 2020 293a  ry=False,.    ):
+000350f0: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
+00035100: 6f64 2021 3d20 2270 6561 7273 6f6e 223a  od != "pearson":
+00035110: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00035120: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00035130: 6445 7272 6f72 2822 4f6e 6c79 2050 6561  dError("Only Pea
+00035140: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
+00035150: 2068 6173 2062 6565 6e20 696d 706c 656d   has been implem
+00035160: 656e 7465 6422 290a 0a20 2020 2020 2020  ented")..       
+00035170: 2072 6574 7572 6e20 5f63 6f76 5f63 6f72   return _cov_cor
+00035180: 7228 0a20 2020 2020 2020 2020 2020 2073  r(.            s
+00035190: 656c 662c 206d 696e 5f70 6572 696f 6473  elf, min_periods
+000351a0: 2c20 5472 7565 2c20 6e75 6d65 7269 635f  , True, numeric_
+000351b0: 6f6e 6c79 3d6e 756d 6572 6963 5f6f 6e6c  only=numeric_onl
+000351c0: 792c 2073 706c 6974 5f65 7665 7279 3d73  y, split_every=s
+000351d0: 706c 6974 5f65 7665 7279 0a20 2020 2020  plit_every.     
+000351e0: 2020 2029 0a0a 2020 2020 6465 6620 696e     )..    def in
+000351f0: 666f 2873 656c 662c 2062 7566 3d4e 6f6e  fo(self, buf=Non
+00035200: 652c 2076 6572 626f 7365 3d46 616c 7365  e, verbose=False
+00035210: 2c20 6d65 6d6f 7279 5f75 7361 6765 3d46  , memory_usage=F
+00035220: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
+00035230: 2222 0a20 2020 2020 2020 2043 6f6e 6369  "".        Conci
+00035240: 7365 2073 756d 6d61 7279 206f 6620 6120  se summary of a 
+00035250: 4461 736b 2044 6174 6146 7261 6d65 2e0a  Dask DataFrame..
+00035260: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00035270: 2020 2020 2069 6620 6275 6620 6973 204e       if buf is N
+00035280: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00035290: 2069 6d70 6f72 7420 7379 730a 0a20 2020   import sys..   
+000352a0: 2020 2020 2020 2020 2062 7566 203d 2073           buf = s
+000352b0: 7973 2e73 7464 6f75 740a 0a20 2020 2020  ys.stdout..     
+000352c0: 2020 206c 696e 6573 203d 205b 7374 7228     lines = [str(
+000352d0: 7479 7065 2873 656c 6629 295d 0a0a 2020  type(self))]..  
+000352e0: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
+000352f0: 662e 636f 6c75 6d6e 7329 203d 3d20 303a  f.columns) == 0:
+00035300: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
+00035310: 6573 2e61 7070 656e 6428 6622 7b74 7970  es.append(f"{typ
+00035320: 6528 7365 6c66 2e69 6e64 6578 2e5f 6d65  e(self.index._me
+00035330: 7461 292e 5f5f 6e61 6d65 5f5f 7d3a 2030  ta).__name__}: 0
+00035340: 2065 6e74 7269 6573 2229 0a20 2020 2020   entries").     
+00035350: 2020 2020 2020 206c 696e 6573 2e61 7070         lines.app
+00035360: 656e 6428 6622 456d 7074 7920 7b74 7970  end(f"Empty {typ
+00035370: 6528 7365 6c66 292e 5f5f 6e61 6d65 5f5f  e(self).__name__
+00035380: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
+00035390: 6966 2050 414e 4441 535f 4754 5f31 3530  if PANDAS_GT_150
+000353a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000353b0: 2020 2320 7061 6e64 6173 2064 6174 6166    # pandas dataf
+000353c0: 7261 6d65 2073 7461 7274 6564 2061 6464  rame started add
+000353d0: 696e 6720 6120 6e65 776c 696e 6520 7768  ing a newline wh
+000353e0: 656e 2069 6e66 6f20 6973 2063 616c 6c65  en info is calle
+000353f0: 642e 0a20 2020 2020 2020 2020 2020 2020  d..             
+00035400: 2020 206c 696e 6573 2e61 7070 656e 6428     lines.append(
+00035410: 2222 290a 2020 2020 2020 2020 2020 2020  "").            
+00035420: 7075 745f 6c69 6e65 7328 6275 662c 206c  put_lines(buf, l
+00035430: 696e 6573 290a 2020 2020 2020 2020 2020  ines).          
+00035440: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+00035450: 2020 2320 4772 6f75 7020 616e 6420 6578    # Group and ex
+00035460: 6563 7574 6520 7468 6520 7265 7175 6972  ecute the requir
+00035470: 6564 2063 6f6d 7075 7461 7469 6f6e 730a  ed computations.
+00035480: 2020 2020 2020 2020 636f 6d70 7574 6174          computat
+00035490: 696f 6e73 203d 207b 7d0a 2020 2020 2020  ions = {}.      
+000354a0: 2020 6966 2076 6572 626f 7365 3a0a 2020    if verbose:.  
+000354b0: 2020 2020 2020 2020 2020 6d65 6d6f 7279            memory
+000354c0: 5f75 7361 6765 203d 2054 7275 650a 2020  _usage = True.  
+000354d0: 2020 2020 2020 2020 2020 636f 6d70 7574            comput
+000354e0: 6174 696f 6e73 2e75 7064 6174 6528 7b22  ations.update({"
+000354f0: 696e 6465 7822 3a20 7365 6c66 2e69 6e64  index": self.ind
+00035500: 6578 2c20 2263 6f75 6e74 223a 2073 656c  ex, "count": sel
+00035510: 662e 636f 756e 7428 297d 290a 2020 2020  f.count()}).    
+00035520: 2020 2020 6966 206d 656d 6f72 795f 7573      if memory_us
+00035530: 6167 653a 0a20 2020 2020 2020 2020 2020  age:.           
+00035540: 2063 6f6d 7075 7461 7469 6f6e 732e 7570   computations.up
+00035550: 6461 7465 280a 2020 2020 2020 2020 2020  date(.          
+00035560: 2020 2020 2020 7b22 6d65 6d6f 7279 5f75        {"memory_u
+00035570: 7361 6765 223a 2073 656c 662e 6d61 705f  sage": self.map_
+00035580: 7061 7274 6974 696f 6e73 284d 2e6d 656d  partitions(M.mem
+00035590: 6f72 795f 7573 6167 652c 2069 6e64 6578  ory_usage, index
+000355a0: 3d54 7275 6529 7d0a 2020 2020 2020 2020  =True)}.        
+000355b0: 2020 2020 290a 2020 2020 2020 2020 636f      ).        co
+000355c0: 6d70 7574 6174 696f 6e73 203d 2064 6963  mputations = dic
+000355d0: 7428 0a20 2020 2020 2020 2020 2020 207a  t(.            z
+000355e0: 6970 2863 6f6d 7075 7461 7469 6f6e 732e  ip(computations.
+000355f0: 6b65 7973 2829 2c20 6461 2e63 6f6d 7075  keys(), da.compu
+00035600: 7465 282a 636f 6d70 7574 6174 696f 6e73  te(*computations
+00035610: 2e76 616c 7565 7328 2929 290a 2020 2020  .values())).    
+00035620: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
+00035630: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
+00035640: 2020 2020 2020 2069 6d70 6f72 7420 7465         import te
+00035650: 7874 7772 6170 0a0a 2020 2020 2020 2020  xtwrap..        
+00035660: 2020 2020 696e 6465 7820 3d20 636f 6d70      index = comp
+00035670: 7574 6174 696f 6e73 5b22 696e 6465 7822  utations["index"
+00035680: 5d0a 2020 2020 2020 2020 2020 2020 636f  ].            co
+00035690: 756e 7473 203d 2063 6f6d 7075 7461 7469  unts = computati
+000356a0: 6f6e 735b 2263 6f75 6e74 225d 0a20 2020  ons["count"].   
+000356b0: 2020 2020 2020 2020 206c 696e 6573 2e61           lines.a
+000356c0: 7070 656e 6428 696e 6465 785f 7375 6d6d  ppend(index_summ
+000356d0: 6172 7928 696e 6465 7829 290a 2020 2020  ary(index)).    
+000356e0: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
+000356f0: 7065 6e64 2866 2244 6174 6120 636f 6c75  pend(f"Data colu
+00035700: 6d6e 7320 2874 6f74 616c 207b 6c65 6e28  mns (total {len(
+00035710: 7365 6c66 2e63 6f6c 756d 6e73 297d 2063  self.columns)} c
+00035720: 6f6c 756d 6e73 293a 2229 0a0a 2020 2020  olumns):")..    
+00035730: 2020 2020 2020 2020 6672 6f6d 2070 616e          from pan
+00035740: 6461 732e 696f 2e66 6f72 6d61 7473 2e70  das.io.formats.p
+00035750: 7269 6e74 696e 6720 696d 706f 7274 2070  rinting import p
+00035760: 7072 696e 745f 7468 696e 670a 0a20 2020  print_thing..   
+00035770: 2020 2020 2020 2020 2073 7061 6365 203d           space =
+00035780: 206d 6178 286c 656e 2870 7072 696e 745f   max(len(pprint_
+00035790: 7468 696e 6728 6b29 2920 666f 7220 6b20  thing(k)) for k 
+000357a0: 696e 2073 656c 662e 636f 6c75 6d6e 7329  in self.columns)
+000357b0: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
+000357c0: 2063 6f6c 756d 6e5f 7769 6474 6820 3d20   column_width = 
+000357d0: 6d61 7828 7370 6163 652c 2037 290a 0a20  max(space, 7).. 
+000357e0: 2020 2020 2020 2020 2020 2068 6561 6465             heade
+000357f0: 7220 3d20 280a 2020 2020 2020 2020 2020  r = (.          
+00035800: 2020 2020 2020 7465 7874 7772 6170 2e64        textwrap.d
+00035810: 6564 656e 7428 0a20 2020 2020 2020 2020  edent(.         
+00035820: 2020 2020 2020 2020 2020 2022 2222 5c0a             """\.
+00035830: 2020 2020 2020 2020 2020 2020 2023 2020               #  
+00035840: 207b 7b63 6f6c 756d 6e3a 3c7b 636f 6c75   {{column:<{colu
+00035850: 6d6e 5f77 6964 7468 7d7d 7d20 4e6f 6e2d  mn_width}}} Non-
+00035860: 4e75 6c6c 2043 6f75 6e74 2020 4474 7970  Null Count  Dtyp
+00035870: 650a 2020 2020 2020 2020 2020 2020 2d2d  e.            --
+00035880: 2d20 207b 7b75 6e64 6572 6c3a 3c7b 636f  -  {{underl:<{co
+00035890: 6c75 6d6e 5f77 6964 7468 7d7d 7d20 2d2d  lumn_width}}} --
+000358a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2020 2d2d  ------------  --
+000358b0: 2d2d 2d22 2222 0a20 2020 2020 2020 2020  ---""".         
+000358c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000358d0: 2020 2020 2020 2020 202e 666f 726d 6174           .format
+000358e0: 2863 6f6c 756d 6e5f 7769 6474 683d 636f  (column_width=co
+000358f0: 6c75 6d6e 5f77 6964 7468 290a 2020 2020  lumn_width).    
+00035900: 2020 2020 2020 2020 2020 2020 2e66 6f72              .for
+00035910: 6d61 7428 636f 6c75 6d6e 3d22 436f 6c75  mat(column="Colu
+00035920: 6d6e 222c 2075 6e64 6572 6c3d 222d 2d2d  mn", underl="---
+00035930: 2d2d 2d22 290a 2020 2020 2020 2020 2020  ---").          
+00035940: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00035950: 636f 6c75 6d6e 5f74 656d 706c 6174 6520  column_template 
+00035960: 3d20 7465 7874 7772 6170 2e64 6564 656e  = textwrap.deden
+00035970: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00035980: 2020 2022 2222 5c0a 2020 2020 2020 2020     """\.        
+00035990: 2020 2020 7b7b 693a 5e33 7d7d 2020 7b7b      {{i:^3}}  {{
+000359a0: 6e61 6d65 3a3c 7b63 6f6c 756d 6e5f 7769  name:<{column_wi
+000359b0: 6474 687d 7d7d 207b 7b63 6f75 6e74 7d7d  dth}}} {{count}}
+000359c0: 206e 6f6e 2d6e 756c 6c20 2020 2020 207b   non-null      {
+000359d0: 7b64 7479 7065 7d7d 2222 222e 666f 726d  {dtype}}""".form
+000359e0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+000359f0: 2020 2020 2020 2020 636f 6c75 6d6e 5f77          column_w
+00035a00: 6964 7468 3d63 6f6c 756d 6e5f 7769 6474  idth=column_widt
+00035a10: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
+00035a20: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00035a30: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+00035a40: 6c75 6d6e 5f69 6e66 6f20 3d20 5b0a 2020  lumn_info = [.  
+00035a50: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00035a60: 6c75 6d6e 5f74 656d 706c 6174 652e 666f  lumn_template.fo
+00035a70: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
+00035a80: 2020 2020 2020 2020 2020 693d 7070 7269            i=ppri
+00035a90: 6e74 5f74 6869 6e67 2869 292c 0a20 2020  nt_thing(i),.   
+00035aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035ab0: 206e 616d 653d 7070 7269 6e74 5f74 6869   name=pprint_thi
+00035ac0: 6e67 286e 616d 6529 2c0a 2020 2020 2020  ng(name),.      
+00035ad0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00035ae0: 756e 743d 7070 7269 6e74 5f74 6869 6e67  unt=pprint_thing
+00035af0: 2863 6f75 6e74 292c 0a20 2020 2020 2020  (count),.       
+00035b00: 2020 2020 2020 2020 2020 2020 2064 7479               dty
+00035b10: 7065 3d70 7072 696e 745f 7468 696e 6728  pe=pprint_thing(
+00035b20: 6474 7970 6529 2c0a 2020 2020 2020 2020  dtype),.        
+00035b30: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00035b40: 2020 2020 2020 2020 2020 666f 7220 692c            for i,
+00035b50: 2028 6e61 6d65 2c20 636f 756e 742c 2064   (name, count, d
+00035b60: 7479 7065 2920 696e 2065 6e75 6d65 7261  type) in enumera
+00035b70: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
+00035b80: 2020 2020 2020 2020 7a69 7028 7365 6c66          zip(self
+00035b90: 2e63 6f6c 756d 6e73 2c20 636f 756e 7473  .columns, counts
+00035ba0: 2c20 7365 6c66 2e64 7479 7065 7329 0a20  , self.dtypes). 
+00035bb0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00035bc0: 0a20 2020 2020 2020 2020 2020 205d 0a20  .            ]. 
+00035bd0: 2020 2020 2020 2020 2020 206c 696e 6573             lines
+00035be0: 2e65 7874 656e 6428 6865 6164 6572 2e73  .extend(header.s
+00035bf0: 706c 6974 2822 5c6e 2229 290a 2020 2020  plit("\n")).    
+00035c00: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00035c10: 2020 2020 2020 636f 6c75 6d6e 5f69 6e66        column_inf
+00035c20: 6f20 3d20 5b69 6e64 6578 5f73 756d 6d61  o = [index_summa
+00035c30: 7279 2873 656c 662e 636f 6c75 6d6e 732c  ry(self.columns,
+00035c40: 206e 616d 653d 2243 6f6c 756d 6e73 2229   name="Columns")
+00035c50: 5d0a 0a20 2020 2020 2020 206c 696e 6573  ]..        lines
+00035c60: 2e65 7874 656e 6428 636f 6c75 6d6e 5f69  .extend(column_i
+00035c70: 6e66 6f29 0a20 2020 2020 2020 2064 7479  nfo).        dty
+00035c80: 7065 5f63 6f75 6e74 7320 3d20 5b0a 2020  pe_counts = [.  
+00035c90: 2020 2020 2020 2020 2020 2225 7328 2564            "%s(%d
+00035ca0: 2922 2025 206b 2066 6f72 206b 2069 6e20  )" % k for k in 
+00035cb0: 736f 7274 6564 2873 656c 662e 6474 7970  sorted(self.dtyp
+00035cc0: 6573 2e76 616c 7565 5f63 6f75 6e74 7328  es.value_counts(
+00035cd0: 292e 6974 656d 7328 292c 206b 6579 3d73  ).items(), key=s
+00035ce0: 7472 290a 2020 2020 2020 2020 5d0a 2020  tr).        ].  
+00035cf0: 2020 2020 2020 6c69 6e65 732e 6170 7065        lines.appe
+00035d00: 6e64 2822 6474 7970 6573 3a20 7b7d 222e  nd("dtypes: {}".
+00035d10: 666f 726d 6174 2822 2c20 222e 6a6f 696e  format(", ".join
+00035d20: 2864 7479 7065 5f63 6f75 6e74 7329 2929  (dtype_counts)))
+00035d30: 0a0a 2020 2020 2020 2020 6966 206d 656d  ..        if mem
+00035d40: 6f72 795f 7573 6167 653a 0a20 2020 2020  ory_usage:.     
+00035d50: 2020 2020 2020 206d 656d 6f72 795f 696e         memory_in
+00035d60: 7420 3d20 636f 6d70 7574 6174 696f 6e73  t = computations
+00035d70: 5b22 6d65 6d6f 7279 5f75 7361 6765 225d  ["memory_usage"]
+00035d80: 2e73 756d 2829 0a20 2020 2020 2020 2020  .sum().         
+00035d90: 2020 206c 696e 6573 2e61 7070 656e 6428     lines.append(
+00035da0: 6622 6d65 6d6f 7279 2075 7361 6765 3a20  f"memory usage: 
+00035db0: 7b6d 656d 6f72 795f 7265 7072 286d 656d  {memory_repr(mem
+00035dc0: 6f72 795f 696e 7429 7d5c 6e22 290a 0a20  ory_int)}\n").. 
+00035dd0: 2020 2020 2020 2070 7574 5f6c 696e 6573         put_lines
+00035de0: 2862 7566 2c20 6c69 6e65 7329 0a0a 2020  (buf, lines)..  
+00035df0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00035e00: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+00035e10: 2020 6465 6620 6d65 6d6f 7279 5f75 7361    def memory_usa
+00035e20: 6765 2873 656c 662c 2069 6e64 6578 3d54  ge(self, index=T
+00035e30: 7275 652c 2064 6565 703d 4661 6c73 6529  rue, deep=False)
+00035e40: 3a0a 2020 2020 2020 2020 7265 7375 6c74  :.        result
+00035e50: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
+00035e60: 6974 696f 6e73 284d 2e6d 656d 6f72 795f  itions(M.memory_
+00035e70: 7573 6167 652c 2069 6e64 6578 3d69 6e64  usage, index=ind
+00035e80: 6578 2c20 6465 6570 3d64 6565 7029 0a20  ex, deep=deep). 
+00035e90: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00035ea0: 7265 7375 6c74 2e67 726f 7570 6279 2872  result.groupby(r
+00035eb0: 6573 756c 742e 696e 6465 7829 2e73 756d  esult.index).sum
+00035ec0: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
+00035ed0: 6e20 7265 7375 6c74 0a0a 2020 2020 6465  n result..    de
+00035ee0: 6620 7069 766f 745f 7461 626c 6528 7365  f pivot_table(se
+00035ef0: 6c66 2c20 696e 6465 783d 4e6f 6e65 2c20  lf, index=None, 
+00035f00: 636f 6c75 6d6e 733d 4e6f 6e65 2c20 7661  columns=None, va
+00035f10: 6c75 6573 3d4e 6f6e 652c 2061 6767 6675  lues=None, aggfu
+00035f20: 6e63 3d22 6d65 616e 2229 3a0a 2020 2020  nc="mean"):.    
+00035f30: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00035f40: 4372 6561 7465 2061 2073 7072 6561 6473  Create a spreads
+00035f50: 6865 6574 2d73 7479 6c65 2070 6976 6f74  heet-style pivot
+00035f60: 2074 6162 6c65 2061 7320 6120 4461 7461   table as a Data
+00035f70: 4672 616d 652e 2054 6172 6765 7420 6060  Frame. Target ``
+00035f80: 636f 6c75 6d6e 7360 600a 2020 2020 2020  columns``.      
+00035f90: 2020 6d75 7374 2068 6176 6520 6361 7465    must have cate
+00035fa0: 676f 7279 2064 7479 7065 2074 6f20 696e  gory dtype to in
+00035fb0: 6665 7220 7265 7375 6c74 2773 2060 6063  fer result's ``c
+00035fc0: 6f6c 756d 6e73 6060 2e0a 2020 2020 2020  olumns``..      
+00035fd0: 2020 6060 696e 6465 7860 602c 2060 6063    ``index``, ``c
+00035fe0: 6f6c 756d 6e73 6060 2c20 6060 7661 6c75  olumns``, ``valu
+00035ff0: 6573 6060 2061 6e64 2060 6061 6767 6675  es`` and ``aggfu
+00036000: 6e63 6060 206d 7573 7420 6265 2061 6c6c  nc`` must be all
+00036010: 2073 6361 6c61 722e 0a0a 2020 2020 2020   scalar...      
+00036020: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00036030: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00036040: 2020 2020 2020 2020 7661 6c75 6573 203a          values :
+00036050: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
+00036060: 2020 2020 636f 6c75 6d6e 2074 6f20 6167      column to ag
+00036070: 6772 6567 6174 650a 2020 2020 2020 2020  gregate.        
+00036080: 696e 6465 7820 3a20 7363 616c 6172 0a20  index : scalar. 
+00036090: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+000360a0: 6e20 746f 2062 6520 696e 6465 780a 2020  n to be index.  
+000360b0: 2020 2020 2020 636f 6c75 6d6e 7320 3a20        columns : 
+000360c0: 7363 616c 6172 0a20 2020 2020 2020 2020  scalar.         
+000360d0: 2020 2063 6f6c 756d 6e20 746f 2062 6520     column to be 
+000360e0: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
+000360f0: 6167 6766 756e 6320 3a20 7b27 6d65 616e  aggfunc : {'mean
+00036100: 272c 2027 7375 6d27 2c20 2763 6f75 6e74  ', 'sum', 'count
+00036110: 277d 2c20 6465 6661 756c 7420 276d 6561  '}, default 'mea
+00036120: 6e27 0a0a 2020 2020 2020 2020 5265 7475  n'..        Retu
+00036130: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+00036140: 2d2d 2d0a 2020 2020 2020 2020 7461 626c  ---.        tabl
+00036150: 6520 3a20 4461 7461 4672 616d 650a 2020  e : DataFrame.  
+00036160: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00036170: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+00036180: 6672 616d 652e 7265 7368 6170 6520 696d  frame.reshape im
+00036190: 706f 7274 2070 6976 6f74 5f74 6162 6c65  port pivot_table
+000361a0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000361b0: 2070 6976 6f74 5f74 6162 6c65 280a 2020   pivot_table(.  
+000361c0: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
+000361d0: 696e 6465 783d 696e 6465 782c 2063 6f6c  index=index, col
+000361e0: 756d 6e73 3d63 6f6c 756d 6e73 2c20 7661  umns=columns, va
+000361f0: 6c75 6573 3d76 616c 7565 732c 2061 6767  lues=values, agg
+00036200: 6675 6e63 3d61 6767 6675 6e63 0a20 2020  func=aggfunc.   
+00036210: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00036220: 6d65 6c74 280a 2020 2020 2020 2020 7365  melt(.        se
+00036230: 6c66 2c0a 2020 2020 2020 2020 6964 5f76  lf,.        id_v
+00036240: 6172 733d 4e6f 6e65 2c0a 2020 2020 2020  ars=None,.      
+00036250: 2020 7661 6c75 655f 7661 7273 3d4e 6f6e    value_vars=Non
+00036260: 652c 0a20 2020 2020 2020 2076 6172 5f6e  e,.        var_n
+00036270: 616d 653d 4e6f 6e65 2c0a 2020 2020 2020  ame=None,.      
+00036280: 2020 7661 6c75 655f 6e61 6d65 3d22 7661    value_name="va
+00036290: 6c75 6522 2c0a 2020 2020 2020 2020 636f  lue",.        co
+000362a0: 6c5f 6c65 7665 6c3d 4e6f 6e65 2c0a 2020  l_level=None,.  
+000362b0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+000362c0: 0a20 2020 2020 2020 2055 6e70 6976 6f74  .        Unpivot
+000362d0: 7320 6120 4461 7461 4672 616d 6520 6672  s a DataFrame fr
+000362e0: 6f6d 2077 6964 6520 666f 726d 6174 2074  om wide format t
+000362f0: 6f20 6c6f 6e67 2066 6f72 6d61 742c 0a20  o long format,. 
+00036300: 2020 2020 2020 206f 7074 696f 6e61 6c6c         optionall
+00036310: 7920 6c65 6176 696e 6720 6964 656e 7469  y leaving identi
+00036320: 6669 6572 2076 6172 6961 626c 6573 2073  fier variables s
+00036330: 6574 2e0a 0a20 2020 2020 2020 2054 6869  et...        Thi
+00036340: 7320 6675 6e63 7469 6f6e 2069 7320 7573  s function is us
+00036350: 6566 756c 2074 6f20 6d61 7373 6167 6520  eful to massage 
+00036360: 6120 4461 7461 4672 616d 6520 696e 746f  a DataFrame into
+00036370: 2061 2066 6f72 6d61 7420 7768 6572 650a   a format where.
+00036380: 2020 2020 2020 2020 6f6e 6520 6f72 206d          one or m
+00036390: 6f72 6520 636f 6c75 6d6e 7320 6172 6520  ore columns are 
+000363a0: 6964 656e 7469 6669 6572 2076 6172 6961  identifier varia
+000363b0: 626c 6573 2028 6060 6964 5f76 6172 7360  bles (``id_vars`
+000363c0: 6029 2c20 7768 696c 650a 2020 2020 2020  `), while.      
+000363d0: 2020 616c 6c20 6f74 6865 7220 636f 6c75    all other colu
+000363e0: 6d6e 732c 2063 6f6e 7369 6465 7265 6420  mns, considered 
+000363f0: 6d65 6173 7572 6564 2076 6172 6961 626c  measured variabl
+00036400: 6573 2028 6060 7661 6c75 655f 7661 7273  es (``value_vars
+00036410: 6060 292c 0a20 2020 2020 2020 2061 7265  ``),.        are
+00036420: 2022 756e 7069 766f 7465 6422 2074 6f20   "unpivoted" to 
+00036430: 7468 6520 726f 7720 6178 6973 2c20 6c65  the row axis, le
+00036440: 6176 696e 6720 6a75 7374 2074 776f 206e  aving just two n
+00036450: 6f6e 2d69 6465 6e74 6966 6965 720a 2020  on-identifier.  
+00036460: 2020 2020 2020 636f 6c75 6d6e 732c 2027        columns, '
+00036470: 7661 7269 6162 6c65 2720 616e 6420 2776  variable' and 'v
+00036480: 616c 7565 272e 0a0a 2020 2020 2020 2020  alue'...        
+00036490: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+000364a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+000364b0: 2020 2020 2020 6672 616d 6520 3a20 4461        frame : Da
+000364c0: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
+000364d0: 6964 5f76 6172 7320 3a20 7475 706c 652c  id_vars : tuple,
+000364e0: 206c 6973 742c 206f 7220 6e64 6172 7261   list, or ndarra
+000364f0: 792c 206f 7074 696f 6e61 6c0a 2020 2020  y, optional.    
+00036500: 2020 2020 2020 2020 436f 6c75 6d6e 2873          Column(s
+00036510: 2920 746f 2075 7365 2061 7320 6964 656e  ) to use as iden
+00036520: 7469 6669 6572 2076 6172 6961 626c 6573  tifier variables
+00036530: 2e0a 2020 2020 2020 2020 7661 6c75 655f  ..        value_
+00036540: 7661 7273 203a 2074 7570 6c65 2c20 6c69  vars : tuple, li
+00036550: 7374 2c20 6f72 206e 6461 7272 6179 2c20  st, or ndarray, 
+00036560: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00036570: 2020 2020 2043 6f6c 756d 6e28 7329 2074       Column(s) t
+00036580: 6f20 756e 7069 766f 742e 2049 6620 6e6f  o unpivot. If no
+00036590: 7420 7370 6563 6966 6965 642c 2075 7365  t specified, use
+000365a0: 7320 616c 6c20 636f 6c75 6d6e 7320 7468  s all columns th
+000365b0: 6174 0a20 2020 2020 2020 2020 2020 2061  at.            a
+000365c0: 7265 206e 6f74 2073 6574 2061 7320 6069  re not set as `i
+000365d0: 645f 7661 7273 602e 0a20 2020 2020 2020  d_vars`..       
+000365e0: 2076 6172 5f6e 616d 6520 3a20 7363 616c   var_name : scal
+000365f0: 6172 0a20 2020 2020 2020 2020 2020 204e  ar.            N
+00036600: 616d 6520 746f 2075 7365 2066 6f72 2074  ame to use for t
+00036610: 6865 2027 7661 7269 6162 6c65 2720 636f  he 'variable' co
+00036620: 6c75 6d6e 2e20 4966 204e 6f6e 6520 6974  lumn. If None it
+00036630: 2075 7365 730a 2020 2020 2020 2020 2020   uses.          
+00036640: 2020 6060 6672 616d 652e 636f 6c75 6d6e    ``frame.column
+00036650: 732e 6e61 6d65 6060 206f 7220 2776 6172  s.name`` or 'var
+00036660: 6961 626c 6527 2e0a 2020 2020 2020 2020  iable'..        
+00036670: 7661 6c75 655f 6e61 6d65 203a 2073 6361  value_name : sca
+00036680: 6c61 722c 2064 6566 6175 6c74 2027 7661  lar, default 'va
+00036690: 6c75 6527 0a20 2020 2020 2020 2020 2020  lue'.           
+000366a0: 204e 616d 6520 746f 2075 7365 2066 6f72   Name to use for
+000366b0: 2074 6865 2027 7661 6c75 6527 2063 6f6c   the 'value' col
+000366c0: 756d 6e2e 0a20 2020 2020 2020 2063 6f6c  umn..        col
+000366d0: 5f6c 6576 656c 203a 2069 6e74 206f 7220  _level : int or 
+000366e0: 7374 7269 6e67 2c20 6f70 7469 6f6e 616c  string, optional
+000366f0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00036700: 636f 6c75 6d6e 7320 6172 6520 6120 4d75  columns are a Mu
+00036710: 6c74 6949 6e64 6578 2074 6865 6e20 7573  ltiIndex then us
+00036720: 6520 7468 6973 206c 6576 656c 2074 6f20  e this level to 
+00036730: 6d65 6c74 2e0a 0a20 2020 2020 2020 2052  melt...        R
+00036740: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+00036750: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
+00036760: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
+00036770: 2020 2020 2055 6e70 6976 6f74 6564 2044       Unpivoted D
+00036780: 6174 6146 7261 6d65 2e0a 0a20 2020 2020  ataFrame...     
+00036790: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+000367a0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+000367b0: 2020 2020 2070 616e 6461 732e 4461 7461       pandas.Data
+000367c0: 4672 616d 652e 6d65 6c74 0a20 2020 2020  Frame.melt.     
+000367d0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+000367e0: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+000367f0: 6d65 2e72 6573 6861 7065 2069 6d70 6f72  me.reshape impor
+00036800: 7420 6d65 6c74 0a0a 2020 2020 2020 2020  t melt..        
+00036810: 7265 7475 726e 206d 656c 7428 0a20 2020  return melt(.   
+00036820: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
+00036830: 2020 2020 2020 2020 2020 2069 645f 7661             id_va
+00036840: 7273 3d69 645f 7661 7273 2c0a 2020 2020  rs=id_vars,.    
+00036850: 2020 2020 2020 2020 7661 6c75 655f 7661          value_va
+00036860: 7273 3d76 616c 7565 5f76 6172 732c 0a20  rs=value_vars,. 
+00036870: 2020 2020 2020 2020 2020 2076 6172 5f6e             var_n
+00036880: 616d 653d 7661 725f 6e61 6d65 2c0a 2020  ame=var_name,.  
+00036890: 2020 2020 2020 2020 2020 7661 6c75 655f            value_
+000368a0: 6e61 6d65 3d76 616c 7565 5f6e 616d 652c  name=value_name,
+000368b0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+000368c0: 5f6c 6576 656c 3d63 6f6c 5f6c 6576 656c  _level=col_level
+000368d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+000368e0: 2064 6566 2074 6f5f 7265 636f 7264 7328   def to_records(
+000368f0: 7365 6c66 2c20 696e 6465 783d 4661 6c73  self, index=Fals
+00036900: 652c 206c 656e 6774 6873 3d4e 6f6e 6529  e, lengths=None)
+00036910: 3a0a 2020 2020 2020 2020 6672 6f6d 2064  :.        from d
+00036920: 6173 6b2e 6461 7461 6672 616d 652e 696f  ask.dataframe.io
+00036930: 2069 6d70 6f72 7420 746f 5f72 6563 6f72   import to_recor
+00036940: 6473 0a0a 2020 2020 2020 2020 6966 206c  ds..        if l
+00036950: 656e 6774 6873 2069 7320 5472 7565 3a0a  engths is True:.
+00036960: 2020 2020 2020 2020 2020 2020 6c65 6e67              leng
+00036970: 7468 7320 3d20 7475 706c 6528 7365 6c66  ths = tuple(self
+00036980: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+00036990: 6c65 6e29 2e63 6f6d 7075 7465 2829 290a  len).compute()).
+000369a0: 0a20 2020 2020 2020 2072 6563 6f72 6473  .        records
+000369b0: 203d 2074 6f5f 7265 636f 7264 7328 7365   = to_records(se
+000369c0: 6c66 290a 0a20 2020 2020 2020 2063 6875  lf)..        chu
+000369d0: 6e6b 7320 3d20 7365 6c66 2e5f 7661 6c69  nks = self._vali
+000369e0: 6461 7465 5f63 6875 6e6b 7328 7265 636f  date_chunks(reco
+000369f0: 7264 732c 206c 656e 6774 6873 290a 2020  rds, lengths).  
+00036a00: 2020 2020 2020 7265 636f 7264 732e 5f63        records._c
+00036a10: 6875 6e6b 7320 3d20 2863 6875 6e6b 735b  hunks = (chunks[
+00036a20: 305d 2c29 0a0a 2020 2020 2020 2020 7265  0],)..        re
+00036a30: 7475 726e 2072 6563 6f72 6473 0a0a 2020  turn records..  
+00036a40: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00036a50: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+00036a60: 2020 6465 6620 746f 5f68 746d 6c28 7365    def to_html(se
+00036a70: 6c66 2c20 6d61 785f 726f 7773 3d35 293a  lf, max_rows=5):
+00036a80: 0a20 2020 2020 2020 2023 2070 642e 5365  .        # pd.Se
+00036a90: 7269 6573 2064 6f65 736e 2774 2068 6176  ries doesn't hav
+00036aa0: 6520 6874 6d6c 2072 6570 720a 2020 2020  e html repr.    
+00036ab0: 2020 2020 6461 7461 203d 2073 656c 662e      data = self.
+00036ac0: 5f72 6570 725f 6461 7461 2829 2e74 6f5f  _repr_data().to_
+00036ad0: 6874 6d6c 286d 6178 5f72 6f77 733d 6d61  html(max_rows=ma
+00036ae0: 785f 726f 7773 2c20 7368 6f77 5f64 696d  x_rows, show_dim
+00036af0: 656e 7369 6f6e 733d 4661 6c73 6529 0a20  ensions=False). 
+00036b00: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
+00036b10: 745f 7465 6d70 6c61 7465 2822 6461 7461  t_template("data
+00036b20: 6672 616d 652e 6874 6d6c 2e6a 3222 292e  frame.html.j2").
+00036b30: 7265 6e64 6572 280a 2020 2020 2020 2020  render(.        
+00036b40: 2020 2020 6461 7461 3d64 6174 612c 0a20      data=data,. 
+00036b50: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+00036b60: 7365 6c66 2e5f 6e61 6d65 2c0a 2020 2020  self._name,.    
+00036b70: 2020 2020 2020 2020 6c61 7965 7273 3d6d          layers=m
+00036b80: 6179 6265 5f70 6c75 7261 6c69 7a65 286c  aybe_pluralize(l
+00036b90: 656e 2873 656c 662e 6461 736b 2e6c 6179  en(self.dask.lay
+00036ba0: 6572 7329 2c20 2267 7261 7068 206c 6179  ers), "graph lay
+00036bb0: 6572 2229 2c0a 2020 2020 2020 2020 290a  er"),.        ).
+00036bc0: 0a20 2020 2064 6566 205f 7265 7072 5f64  .    def _repr_d
+00036bd0: 6174 6128 7365 6c66 293a 0a20 2020 2020  ata(self):.     
+00036be0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+00036bf0: 6d65 7461 0a20 2020 2020 2020 2069 6e64  meta.        ind
+00036c00: 6578 203d 2073 656c 662e 5f72 6570 725f  ex = self._repr_
+00036c10: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
+00036c20: 2020 636f 6c73 203d 206d 6574 612e 636f    cols = meta.co
+00036c30: 6c75 6d6e 730a 2020 2020 2020 2020 6966  lumns.        if
+00036c40: 206c 656e 2863 6f6c 7329 203d 3d20 303a   len(cols) == 0:
+00036c50: 0a20 2020 2020 2020 2020 2020 2073 6572  .            ser
+00036c60: 6965 735f 6466 203d 2070 642e 4461 7461  ies_df = pd.Data
+00036c70: 4672 616d 6528 5b5b 5d5d 202a 206c 656e  Frame([[]] * len
+00036c80: 2869 6e64 6578 292c 2063 6f6c 756d 6e73  (index), columns
+00036c90: 3d63 6f6c 732c 2069 6e64 6578 3d69 6e64  =cols, index=ind
+00036ca0: 6578 290a 2020 2020 2020 2020 656c 7365  ex).        else
+00036cb0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00036cc0: 7269 6573 5f64 6620 3d20 7064 2e63 6f6e  ries_df = pd.con
+00036cd0: 6361 7428 0a20 2020 2020 2020 2020 2020  cat(.           
+00036ce0: 2020 2020 205b 5f72 6570 725f 6461 7461       [_repr_data
+00036cf0: 5f73 6572 6965 7328 732c 2069 6e64 6578  _series(s, index
+00036d00: 3d69 6e64 6578 2920 666f 7220 5f2c 2073  =index) for _, s
+00036d10: 2069 6e20 6d65 7461 2e69 7465 6d73 2829   in meta.items()
+00036d20: 5d2c 2061 7869 733d 310a 2020 2020 2020  ], axis=1.      
+00036d30: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00036d40: 7265 7475 726e 2073 6572 6965 735f 6466  return series_df
+00036d50: 0a0a 2020 2020 6465 6620 5f72 6570 725f  ..    def _repr_
+00036d60: 6874 6d6c 5f28 7365 6c66 293a 0a20 2020  html_(self):.   
+00036d70: 2020 2020 2064 6174 6120 3d20 7365 6c66       data = self
+00036d80: 2e5f 7265 7072 5f64 6174 6128 292e 746f  ._repr_data().to
+00036d90: 5f68 746d 6c28 0a20 2020 2020 2020 2020  _html(.         
+00036da0: 2020 206d 6178 5f72 6f77 733d 352c 2073     max_rows=5, s
+00036db0: 686f 775f 6469 6d65 6e73 696f 6e73 3d46  how_dimensions=F
+00036dc0: 616c 7365 2c20 6e6f 7465 626f 6f6b 3d54  alse, notebook=T
+00036dd0: 7275 650a 2020 2020 2020 2020 290a 2020  rue.        ).  
+00036de0: 2020 2020 2020 7265 7475 726e 2067 6574        return get
+00036df0: 5f74 656d 706c 6174 6528 2264 6174 6166  _template("dataf
+00036e00: 7261 6d65 2e68 746d 6c2e 6a32 2229 2e72  rame.html.j2").r
+00036e10: 656e 6465 7228 0a20 2020 2020 2020 2020  ender(.         
+00036e20: 2020 2064 6174 613d 6461 7461 2c0a 2020     data=data,.  
+00036e30: 2020 2020 2020 2020 2020 6e61 6d65 3d73            name=s
+00036e40: 656c 662e 5f6e 616d 652c 0a20 2020 2020  elf._name,.     
+00036e50: 2020 2020 2020 206c 6179 6572 733d 6d61         layers=ma
+00036e60: 7962 655f 706c 7572 616c 697a 6528 6c65  ybe_pluralize(le
+00036e70: 6e28 7365 6c66 2e64 6173 6b2e 6c61 7965  n(self.dask.laye
+00036e80: 7273 292c 2022 6772 6170 6820 6c61 7965  rs), "graph laye
+00036e90: 7222 292c 0a20 2020 2020 2020 2029 0a0a  r"),.        )..
+00036ea0: 2020 2020 6465 6620 5f73 656c 6563 745f      def _select_
+00036eb0: 636f 6c75 6d6e 735f 6f72 5f69 6e64 6578  columns_or_index
+00036ec0: 2873 656c 662c 2063 6f6c 756d 6e73 5f6f  (self, columns_o
+00036ed0: 725f 696e 6465 7829 3a0a 2020 2020 2020  r_index):.      
+00036ee0: 2020 2222 220a 2020 2020 2020 2020 5061    """.        Pa
+00036ef0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00036f00: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00036f10: 2020 2020 636f 6c75 6d6e 735f 6f72 5f69      columns_or_i
+00036f20: 6e64 6578 0a20 2020 2020 2020 2020 2020  ndex.           
+00036f30: 2043 6f6c 756d 6e20 6f72 2069 6e64 6578   Column or index
+00036f40: 206e 616d 652c 206f 7220 6120 6c69 7374   name, or a list
+00036f50: 206f 6620 7468 6573 650a 0a20 2020 2020   of these..     
+00036f60: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+00036f70: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+00036f80: 2020 2064 642e 4461 7461 4672 616d 650a     dd.DataFrame.
+00036f90: 2020 2020 2020 2020 2020 2020 4461 736b              Dask
+00036fa0: 2044 6174 6146 7261 6d65 2077 6974 6820   DataFrame with 
+00036fb0: 636f 6c75 6d6e 7320 636f 7272 6573 706f  columns correspo
+00036fc0: 6e64 696e 6720 746f 2065 6163 6820 636f  nding to each co
+00036fd0: 6c75 6d6e 206f 720a 2020 2020 2020 2020  lumn or.        
+00036fe0: 2020 2020 696e 6465 7820 6c65 7665 6c20      index level 
+00036ff0: 696e 2063 6f6c 756d 6e73 5f6f 725f 696e  in columns_or_in
+00037000: 6465 782e 2020 4966 2069 6e63 6c75 6465  dex.  If include
+00037010: 642c 2074 6865 2063 6f6c 756d 6e0a 2020  d, the column.  
+00037020: 2020 2020 2020 2020 2020 636f 7272 6573            corres
+00037030: 706f 6e64 696e 6720 746f 2074 6865 2069  ponding to the i
+00037040: 6e64 6578 206c 6576 656c 2069 7320 6e61  ndex level is na
+00037050: 6d65 6420 5f69 6e64 6578 0a20 2020 2020  med _index.     
+00037060: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00037070: 2320 456e 7375 7265 2063 6f6c 756d 6e73  # Ensure columns
+00037080: 5f6f 725f 696e 6465 7820 6973 2061 206c  _or_index is a l
+00037090: 6973 740a 2020 2020 2020 2020 636f 6c75  ist.        colu
+000370a0: 6d6e 735f 6f72 5f69 6e64 6578 203d 2028  mns_or_index = (
+000370b0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+000370c0: 756d 6e73 5f6f 725f 696e 6465 780a 2020  umns_or_index.  
+000370d0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+000370e0: 6e73 7461 6e63 6528 636f 6c75 6d6e 735f  nstance(columns_
+000370f0: 6f72 5f69 6e64 6578 2c20 6c69 7374 290a  or_index, list).
+00037100: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00037110: 205b 636f 6c75 6d6e 735f 6f72 5f69 6e64   [columns_or_ind
+00037120: 6578 5d0a 2020 2020 2020 2020 290a 0a20  ex].        ).. 
+00037130: 2020 2020 2020 2063 6f6c 756d 6e5f 6e61         column_na
+00037140: 6d65 7320 3d20 5b0a 2020 2020 2020 2020  mes = [.        
+00037150: 2020 2020 6e20 666f 7220 6e20 696e 2063      n for n in c
+00037160: 6f6c 756d 6e73 5f6f 725f 696e 6465 7820  olumns_or_index 
+00037170: 6966 2073 656c 662e 5f69 735f 636f 6c75  if self._is_colu
+00037180: 6d6e 5f6c 6162 656c 5f72 6566 6572 656e  mn_label_referen
+00037190: 6365 286e 290a 2020 2020 2020 2020 5d0a  ce(n).        ].
+000371a0: 0a20 2020 2020 2020 2073 656c 6563 7465  .        selecte
+000371b0: 645f 6466 203d 2073 656c 665b 636f 6c75  d_df = self[colu
+000371c0: 6d6e 5f6e 616d 6573 5d0a 2020 2020 2020  mn_names].      
+000371d0: 2020 6966 2073 656c 662e 5f63 6f6e 7461    if self._conta
+000371e0: 696e 735f 696e 6465 785f 6e61 6d65 2863  ins_index_name(c
+000371f0: 6f6c 756d 6e73 5f6f 725f 696e 6465 7829  olumns_or_index)
+00037200: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00037210: 496e 6465 7820 6e61 6d65 2077 6173 2069  Index name was i
+00037220: 6e63 6c75 6465 640a 2020 2020 2020 2020  ncluded.        
+00037230: 2020 2020 7365 6c65 6374 6564 5f64 6620      selected_df 
+00037240: 3d20 7365 6c65 6374 6564 5f64 662e 6173  = selected_df.as
+00037250: 7369 676e 285f 696e 6465 783d 7365 6c66  sign(_index=self
+00037260: 2e69 6e64 6578 290a 0a20 2020 2020 2020  .index)..       
+00037270: 2072 6574 7572 6e20 7365 6c65 6374 6564   return selected
+00037280: 5f64 660a 0a20 2020 2064 6566 205f 6973  _df..    def _is
+00037290: 5f63 6f6c 756d 6e5f 6c61 6265 6c5f 7265  _column_label_re
+000372a0: 6665 7265 6e63 6528 7365 6c66 2c20 6b65  ference(self, ke
+000372b0: 7929 3a0a 2020 2020 2020 2020 2222 220a  y):.        """.
+000372c0: 2020 2020 2020 2020 5465 7374 2077 6865          Test whe
+000372d0: 7468 6572 2061 206b 6579 2069 7320 6120  ther a key is a 
+000372e0: 636f 6c75 6d6e 206c 6162 656c 2072 6566  column label ref
+000372f0: 6572 656e 6365 0a0a 2020 2020 2020 2020  erence..        
+00037300: 546f 2062 6520 636f 6e73 6964 6572 6564  To be considered
+00037310: 2061 2063 6f6c 756d 6e20 6c61 6265 6c20   a column label 
+00037320: 7265 6665 7265 6e63 652c 2060 6b65 7960  reference, `key`
+00037330: 206d 7573 7420 6d61 7463 6820 7468 6520   must match the 
+00037340: 6e61 6d65 206f 6620 6174 0a20 2020 2020  name of at.     
+00037350: 2020 206c 6561 7374 206f 6e65 2063 6f6c     least one col
+00037360: 756d 6e2e 0a20 2020 2020 2020 2022 2222  umn..        """
+00037370: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00037380: 280a 2020 2020 2020 2020 2020 2020 6e6f  (.            no
+00037390: 7420 6973 5f64 6173 6b5f 636f 6c6c 6563  t is_dask_collec
+000373a0: 7469 6f6e 286b 6579 290a 2020 2020 2020  tion(key).      
+000373b0: 2020 2020 2020 616e 6420 286e 702e 6973        and (np.is
+000373c0: 7363 616c 6172 286b 6579 2920 6f72 2069  scalar(key) or i
+000373d0: 7369 6e73 7461 6e63 6528 6b65 792c 2074  sinstance(key, t
+000373e0: 7570 6c65 2929 0a20 2020 2020 2020 2020  uple)).         
+000373f0: 2020 2061 6e64 206b 6579 2069 6e20 7365     and key in se
+00037400: 6c66 2e63 6f6c 756d 6e73 0a20 2020 2020  lf.columns.     
+00037410: 2020 2029 0a0a 2020 2020 4063 6c61 7373     )..    @class
+00037420: 6d65 7468 6f64 0a20 2020 2064 6566 2066  method.    def f
+00037430: 726f 6d5f 6469 6374 280a 2020 2020 2020  rom_dict(.      
+00037440: 2020 636c 732c 2064 6174 612c 202a 2c20    cls, data, *, 
+00037450: 6e70 6172 7469 7469 6f6e 732c 206f 7269  npartitions, ori
+00037460: 656e 743d 2263 6f6c 756d 6e73 222c 2064  ent="columns", d
+00037470: 7479 7065 3d4e 6f6e 652c 2063 6f6c 756d  type=None, colum
+00037480: 6e73 3d4e 6f6e 650a 2020 2020 293a 0a20  ns=None.    ):. 
+00037490: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000374a0: 2020 2043 6f6e 7374 7275 6374 2061 2044     Construct a D
+000374b0: 6173 6b20 4461 7461 4672 616d 6520 6672  ask DataFrame fr
+000374c0: 6f6d 2061 2050 7974 686f 6e20 4469 6374  om a Python Dict
+000374d0: 696f 6e61 7279 0a0a 2020 2020 2020 2020  ionary..        
+000374e0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+000374f0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00037500: 2020 6461 736b 2e64 6174 6166 7261 6d65    dask.dataframe
+00037510: 2e66 726f 6d5f 6469 6374 0a20 2020 2020  .from_dict.     
+00037520: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+00037530: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+00037540: 6d65 2e69 6f20 696d 706f 7274 2066 726f  me.io import fro
+00037550: 6d5f 6469 6374 0a0a 2020 2020 2020 2020  m_dict..        
+00037560: 7265 7475 726e 2066 726f 6d5f 6469 6374  return from_dict
+00037570: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
+00037580: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+00037590: 6e70 6172 7469 7469 6f6e 732c 0a20 2020  npartitions,.   
+000375a0: 2020 2020 2020 2020 206f 7269 656e 743d           orient=
+000375b0: 6f72 6965 6e74 2c0a 2020 2020 2020 2020  orient,.        
+000375c0: 2020 2020 6474 7970 653d 6474 7970 652c      dtype=dtype,
+000375d0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+000375e0: 756d 6e73 3d63 6f6c 756d 6e73 2c0a 2020  umns=columns,.  
+000375f0: 2020 2020 2020 2020 2020 636f 6e73 7472            constr
+00037600: 7563 746f 723d 636c 732e 5f70 6172 7469  uctor=cls._parti
+00037610: 7469 6f6e 5f74 7970 652c 0a20 2020 2020  tion_type,.     
+00037620: 2020 2029 0a0a 0a23 2062 696e 6420 6f70     )...# bind op
+00037630: 6572 6174 6f72 730a 2320 544f 444f 3a20  erators.# TODO: 
+00037640: 6479 6e61 6d69 6361 6c6c 7920 626f 756e  dynamically boun
+00037650: 6420 6f70 6572 6174 6f72 7320 6172 6520  d operators are 
+00037660: 6465 6665 6174 696e 6720 7479 7065 2061  defeating type a
+00037670: 6e6e 6f74 6174 696f 6e73 0a66 6f72 206f  nnotations.for o
+00037680: 7020 696e 205b 0a20 2020 206f 7065 7261  p in [.    opera
+00037690: 746f 722e 6162 732c 0a20 2020 206f 7065  tor.abs,.    ope
+000376a0: 7261 746f 722e 6164 642c 0a20 2020 206f  rator.add,.    o
+000376b0: 7065 7261 746f 722e 616e 645f 2c0a 2020  perator.and_,.  
+000376c0: 2020 6f70 6572 6174 6f72 2e65 712c 0a20    operator.eq,. 
+000376d0: 2020 206f 7065 7261 746f 722e 6774 2c0a     operator.gt,.
+000376e0: 2020 2020 6f70 6572 6174 6f72 2e67 652c      operator.ge,
+000376f0: 0a20 2020 206f 7065 7261 746f 722e 696e  .    operator.in
+00037700: 762c 0a20 2020 206f 7065 7261 746f 722e  v,.    operator.
+00037710: 6c74 2c0a 2020 2020 6f70 6572 6174 6f72  lt,.    operator
+00037720: 2e6c 652c 0a20 2020 206f 7065 7261 746f  .le,.    operato
+00037730: 722e 6d6f 642c 0a20 2020 206f 7065 7261  r.mod,.    opera
+00037740: 746f 722e 6d75 6c2c 0a20 2020 206f 7065  tor.mul,.    ope
+00037750: 7261 746f 722e 6e65 2c0a 2020 2020 6f70  rator.ne,.    op
+00037760: 6572 6174 6f72 2e6e 6567 2c0a 2020 2020  erator.neg,.    
+00037770: 6f70 6572 6174 6f72 2e6f 725f 2c0a 2020  operator.or_,.  
+00037780: 2020 6f70 6572 6174 6f72 2e70 6f77 2c0a    operator.pow,.
+00037790: 2020 2020 6f70 6572 6174 6f72 2e73 7562      operator.sub
+000377a0: 2c0a 2020 2020 6f70 6572 6174 6f72 2e74  ,.    operator.t
+000377b0: 7275 6564 6976 2c0a 2020 2020 6f70 6572  ruediv,.    oper
+000377c0: 6174 6f72 2e66 6c6f 6f72 6469 762c 0a20  ator.floordiv,. 
+000377d0: 2020 206f 7065 7261 746f 722e 786f 722c     operator.xor,
+000377e0: 0a5d 3a0a 2020 2020 5f46 7261 6d65 2e5f  .]:.    _Frame._
+000377f0: 6269 6e64 5f6f 7065 7261 746f 7228 6f70  bind_operator(op
+00037800: 290a 2020 2020 5363 616c 6172 2e5f 6269  ).    Scalar._bi
+00037810: 6e64 5f6f 7065 7261 746f 7228 6f70 290a  nd_operator(op).
+00037820: 0a66 6f72 206e 616d 6520 696e 205b 0a20  .for name in [. 
+00037830: 2020 2022 6164 6422 2c0a 2020 2020 2273     "add",.    "s
+00037840: 7562 222c 0a20 2020 2022 6d75 6c22 2c0a  ub",.    "mul",.
+00037850: 2020 2020 2264 6976 222c 0a20 2020 2022      "div",.    "
+00037860: 6469 7669 6465 222c 0a20 2020 2022 7472  divide",.    "tr
+00037870: 7565 6469 7622 2c0a 2020 2020 2266 6c6f  uediv",.    "flo
+00037880: 6f72 6469 7622 2c0a 2020 2020 226d 6f64  ordiv",.    "mod
+00037890: 222c 0a20 2020 2022 706f 7722 2c0a 2020  ",.    "pow",.  
+000378a0: 2020 2272 6164 6422 2c0a 2020 2020 2272    "radd",.    "r
+000378b0: 7375 6222 2c0a 2020 2020 2272 6d75 6c22  sub",.    "rmul"
+000378c0: 2c0a 2020 2020 2272 6469 7622 2c0a 2020  ,.    "rdiv",.  
+000378d0: 2020 2272 7472 7565 6469 7622 2c0a 2020    "rtruediv",.  
+000378e0: 2020 2272 666c 6f6f 7264 6976 222c 0a20    "rfloordiv",. 
+000378f0: 2020 2022 726d 6f64 222c 0a20 2020 2022     "rmod",.    "
+00037900: 7270 6f77 222c 0a5d 3a0a 2020 2020 6d65  rpow",.]:.    me
+00037910: 7468 203d 2067 6574 6174 7472 2870 642e  th = getattr(pd.
+00037920: 4461 7461 4672 616d 652c 206e 616d 6529  DataFrame, name)
+00037930: 0a20 2020 2044 6174 6146 7261 6d65 2e5f  .    DataFrame._
+00037940: 6269 6e64 5f6f 7065 7261 746f 725f 6d65  bind_operator_me
+00037950: 7468 6f64 286e 616d 652c 206d 6574 6829  thod(name, meth)
+00037960: 0a0a 2020 2020 6d65 7468 203d 2067 6574  ..    meth = get
+00037970: 6174 7472 2870 642e 5365 7269 6573 2c20  attr(pd.Series, 
+00037980: 6e61 6d65 290a 2020 2020 5365 7269 6573  name).    Series
+00037990: 2e5f 6269 6e64 5f6f 7065 7261 746f 725f  ._bind_operator_
+000379a0: 6d65 7468 6f64 286e 616d 652c 206d 6574  method(name, met
+000379b0: 6829 0a0a 666f 7220 6e61 6d65 2069 6e20  h)..for name in 
+000379c0: 5b22 6c74 222c 2022 6774 222c 2022 6c65  ["lt", "gt", "le
+000379d0: 222c 2022 6765 222c 2022 6e65 222c 2022  ", "ge", "ne", "
+000379e0: 6571 225d 3a0a 2020 2020 6d65 7468 203d  eq"]:.    meth =
+000379f0: 2067 6574 6174 7472 2870 642e 4461 7461   getattr(pd.Data
+00037a00: 4672 616d 652c 206e 616d 6529 0a20 2020  Frame, name).   
+00037a10: 2044 6174 6146 7261 6d65 2e5f 6269 6e64   DataFrame._bind
+00037a20: 5f63 6f6d 7061 7269 736f 6e5f 6d65 7468  _comparison_meth
+00037a30: 6f64 286e 616d 652c 206d 6574 6829 0a0a  od(name, meth)..
+00037a40: 2020 2020 6d65 7468 203d 2067 6574 6174      meth = getat
+00037a50: 7472 2870 642e 5365 7269 6573 2c20 6e61  tr(pd.Series, na
+00037a60: 6d65 290a 2020 2020 5365 7269 6573 2e5f  me).    Series._
+00037a70: 6269 6e64 5f63 6f6d 7061 7269 736f 6e5f  bind_comparison_
+00037a80: 6d65 7468 6f64 286e 616d 652c 206d 6574  method(name, met
+00037a90: 6829 0a0a 0a64 6566 2069 735f 6272 6f61  h)...def is_broa
+00037aa0: 6463 6173 7461 626c 6528 6466 732c 2073  dcastable(dfs, s
+00037ab0: 293a 0a20 2020 2022 2222 0a20 2020 2054  ):.    """.    T
+00037ac0: 6869 7320 5365 7269 6573 2069 7320 6272  his Series is br
+00037ad0: 6f61 6463 6173 7461 626c 6520 6167 6169  oadcastable agai
+00037ae0: 6e73 7420 616e 6f74 6865 7220 6461 7461  nst another data
+00037af0: 6672 616d 6520 696e 2074 6865 2073 6571  frame in the seq
+00037b00: 7565 6e63 650a 2020 2020 2222 220a 0a20  uence.    """.. 
+00037b10: 2020 2064 6566 2063 6f6d 7061 7265 2873     def compare(s
+00037b20: 2c20 6466 293a 0a20 2020 2020 2020 2074  , df):.        t
+00037b30: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+00037b40: 7265 7475 726e 2073 2e64 6976 6973 696f  return s.divisio
+00037b50: 6e73 203d 3d20 2864 662e 636f 6c75 6d6e  ns == (df.column
+00037b60: 732e 6d69 6e28 292c 2064 662e 636f 6c75  s.min(), df.colu
+00037b70: 6d6e 732e 6d61 7828 2929 0a20 2020 2020  mns.max()).     
+00037b80: 2020 2065 7863 6570 7420 5479 7065 4572     except TypeEr
+00037b90: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+00037ba0: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
+00037bb0: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
+00037bc0: 2020 2020 6973 696e 7374 616e 6365 2873      isinstance(s
+00037bd0: 2c20 5365 7269 6573 290a 2020 2020 2020  , Series).      
+00037be0: 2020 616e 6420 732e 6e70 6172 7469 7469    and s.npartiti
+00037bf0: 6f6e 7320 3d3d 2031 0a20 2020 2020 2020  ons == 1.       
+00037c00: 2061 6e64 2073 2e6b 6e6f 776e 5f64 6976   and s.known_div
+00037c10: 6973 696f 6e73 0a20 2020 2020 2020 2061  isions.        a
+00037c20: 6e64 2061 6e79 2863 6f6d 7061 7265 2873  nd any(compare(s
+00037c30: 2c20 6466 2920 666f 7220 6466 2069 6e20  , df) for df in 
+00037c40: 6466 7320 6966 2069 7369 6e73 7461 6e63  dfs if isinstanc
+00037c50: 6528 6466 2c20 4461 7461 4672 616d 6529  e(df, DataFrame)
+00037c60: 290a 2020 2020 290a 0a0a 6465 6620 656c  ).    )...def el
+00037c70: 656d 7769 7365 286f 702c 202a 6172 6773  emwise(op, *args
+00037c80: 2c20 6d65 7461 3d6e 6f5f 6465 6661 756c  , meta=no_defaul
+00037c90: 742c 206f 7574 3d4e 6f6e 652c 2074 7261  t, out=None, tra
+00037ca0: 6e73 666f 726d 5f64 6976 6973 696f 6e73  nsform_divisions
+00037cb0: 3d54 7275 652c 202a 2a6b 7761 7267 7329  =True, **kwargs)
+00037cc0: 3a0a 2020 2020 2222 2245 6c65 6d65 6e74  :.    """Element
+00037cd0: 7769 7365 206f 7065 7261 7469 6f6e 2066  wise operation f
+00037ce0: 6f72 2044 6173 6b20 6461 7461 6672 616d  or Dask datafram
+00037cf0: 6573 0a0a 2020 2020 5061 7261 6d65 7465  es..    Paramete
+00037d00: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+00037d10: 2d0a 2020 2020 6f70 3a20 6361 6c6c 6162  -.    op: callab
+00037d20: 6c65 0a20 2020 2020 2020 2046 756e 6374  le.        Funct
+00037d30: 696f 6e20 746f 2061 7070 6c79 2061 6372  ion to apply acr
+00037d40: 6f73 7320 696e 7075 7420 6461 7461 6672  oss input datafr
+00037d50: 616d 6573 0a20 2020 202a 6172 6773 3a20  ames.    *args: 
+00037d60: 4461 7461 4672 616d 6573 2c20 5365 7269  DataFrames, Seri
+00037d70: 6573 2c20 5363 616c 6172 732c 2041 7272  es, Scalars, Arr
+00037d80: 6179 732c 0a20 2020 2020 2020 2054 6865  ays,.        The
+00037d90: 2061 7267 756d 656e 7473 206f 6620 7468   arguments of th
+00037da0: 6520 6f70 6572 6174 696f 6e0a 2020 2020  e operation.    
+00037db0: 6d65 7461 3a20 7064 2e44 6174 6146 7261  meta: pd.DataFra
+00037dc0: 6d65 2c20 7064 2e53 6572 6965 7320 286f  me, pd.Series (o
+00037dd0: 7074 696f 6e61 6c29 0a20 2020 2020 2020  ptional).       
+00037de0: 2056 616c 6964 206d 6574 6164 6174 6120   Valid metadata 
+00037df0: 666f 7220 7468 6520 6f70 6572 6174 696f  for the operatio
+00037e00: 6e2e 2020 5769 6c6c 2065 7661 6c75 6174  n.  Will evaluat
+00037e10: 6520 6f6e 2061 2073 6d61 6c6c 2070 6965  e on a small pie
+00037e20: 6365 206f 660a 2020 2020 2020 2020 6461  ce of.        da
+00037e30: 7461 2069 6620 6e6f 7420 7072 6f76 6964  ta if not provid
+00037e40: 6564 2e0a 2020 2020 7472 616e 7366 6f72  ed..    transfor
+00037e50: 6d5f 6469 7669 7369 6f6e 733a 2062 6f6f  m_divisions: boo
+00037e60: 6c65 616e 0a20 2020 2020 2020 2049 6620  lean.        If 
+00037e70: 7468 6520 696e 7075 7420 6973 2061 2060  the input is a `
+00037e80: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
+00037e90: 496e 6465 7860 6020 7765 206e 6f72 6d61  Index`` we norma
+00037ea0: 6c6c 7920 7769 6c6c 2061 6c73 6f20 6170  lly will also ap
+00037eb0: 706c 790a 2020 2020 2020 2020 7468 6520  ply.        the 
+00037ec0: 6675 6e63 7469 6f6e 206f 6e74 6f20 7468  function onto th
+00037ed0: 6520 6469 7669 7369 6f6e 7320 616e 6420  e divisions and 
+00037ee0: 6170 706c 7920 7468 6f73 6520 7472 616e  apply those tran
+00037ef0: 7366 6f72 6d65 6420 6469 7669 7369 6f6e  sformed division
+00037f00: 730a 2020 2020 2020 2020 746f 2074 6865  s.        to the
+00037f10: 206f 7574 7075 742e 2020 596f 7520 6361   output.  You ca
+00037f20: 6e20 7061 7373 2060 6074 7261 6e73 666f  n pass ``transfo
+00037f30: 726d 5f64 6976 6973 696f 6e73 3d46 616c  rm_divisions=Fal
+00037f40: 7365 6060 2074 6f20 6f76 6572 7269 6465  se`` to override
+00037f50: 0a20 2020 2020 2020 2074 6869 7320 6265  .        this be
+00037f60: 6861 7669 6f72 0a20 2020 206f 7574 203a  havior.    out :
+00037f70: 2060 6064 6173 6b2e 6172 7261 7960 6020   ``dask.array`` 
+00037f80: 6f72 2060 604e 6f6e 6560 600a 2020 2020  or ``None``.    
+00037f90: 2020 2020 4966 206f 7574 2069 7320 6120      If out is a 
+00037fa0: 6461 736b 2e44 6174 6146 7261 6d65 2c20  dask.DataFrame, 
+00037fb0: 6461 736b 2e53 6572 6965 7320 6f72 2064  dask.Series or d
+00037fc0: 6173 6b2e 5363 616c 6172 2074 6865 6e0a  ask.Scalar then.
+00037fd0: 2020 2020 2020 2020 7468 6973 206f 7665          this ove
+00037fe0: 7277 7269 7465 7320 7468 6520 636f 6e74  rwrites the cont
+00037ff0: 656e 7473 206f 6620 6974 2077 6974 6820  ents of it with 
+00038000: 7468 6520 7265 7375 6c74 0a20 2020 202a  the result.    *
+00038010: 2a6b 7761 7267 733a 2073 6361 6c61 7273  *kwargs: scalars
+00038020: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
+00038030: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00038040: 3e3e 3e20 656c 656d 7769 7365 286f 7065  >>> elemwise(ope
+00038050: 7261 746f 722e 6164 642c 2064 662e 782c  rator.add, df.x,
+00038060: 2064 662e 7929 2020 2320 646f 6374 6573   df.y)  # doctes
+00038070: 743a 202b 534b 4950 0a20 2020 2022 2222  t: +SKIP.    """
+00038080: 0a20 2020 205f 6e61 6d65 203d 2066 756e  .    _name = fun
+00038090: 636e 616d 6528 6f70 2920 2b20 222d 2220  cname(op) + "-" 
+000380a0: 2b20 746f 6b65 6e69 7a65 286f 702c 202a  + tokenize(op, *
+000380b0: 6172 6773 2c20 2a2a 6b77 6172 6773 290a  args, **kwargs).
+000380c0: 0a20 2020 2061 7267 7320 3d20 5f6d 6179  .    args = _may
+000380d0: 6265 5f66 726f 6d5f 7061 6e64 6173 2861  be_from_pandas(a
+000380e0: 7267 7329 0a0a 2020 2020 6672 6f6d 2064  rgs)..    from d
+000380f0: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
+00038100: 6c74 6920 696d 706f 7274 205f 6d61 7962  lti import _mayb
+00038110: 655f 616c 6967 6e5f 7061 7274 6974 696f  e_align_partitio
+00038120: 6e73 0a0a 2020 2020 6172 6773 203d 205f  ns..    args = _
+00038130: 6d61 7962 655f 616c 6967 6e5f 7061 7274  maybe_align_part
+00038140: 6974 696f 6e73 2861 7267 7329 0a20 2020  itions(args).   
+00038150: 2064 6173 6b73 203d 205b 6172 6720 666f   dasks = [arg fo
+00038160: 7220 6172 6720 696e 2061 7267 7320 6966  r arg in args if
+00038170: 2069 7369 6e73 7461 6e63 6528 6172 672c   isinstance(arg,
+00038180: 2028 5f46 7261 6d65 2c20 5363 616c 6172   (_Frame, Scalar
+00038190: 2c20 4172 7261 7929 295d 0a20 2020 2064  , Array))].    d
+000381a0: 6673 203d 205b 6466 2066 6f72 2064 6620  fs = [df for df 
+000381b0: 696e 2064 6173 6b73 2069 6620 6973 696e  in dasks if isin
+000381c0: 7374 616e 6365 2864 662c 205f 4672 616d  stance(df, _Fram
+000381d0: 6529 5d0a 0a20 2020 2023 2043 6c65 616e  e)]..    # Clean
+000381e0: 2075 7020 6461 736b 2061 7272 6179 7320   up dask arrays 
+000381f0: 6966 2070 7265 7365 6e74 0a20 2020 2064  if present.    d
+00038200: 6570 7320 3d20 6461 736b 732e 636f 7079  eps = dasks.copy
+00038210: 2829 0a20 2020 2066 6f72 2069 2c20 6120  ().    for i, a 
+00038220: 696e 2065 6e75 6d65 7261 7465 2864 6173  in enumerate(das
+00038230: 6b73 293a 0a20 2020 2020 2020 2069 6620  ks):.        if 
+00038240: 6e6f 7420 6973 696e 7374 616e 6365 2861  not isinstance(a
+00038250: 2c20 4172 7261 7929 3a0a 2020 2020 2020  , Array):.      
+00038260: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
+00038270: 2020 2020 2020 2023 2045 6e73 7572 6520         # Ensure 
+00038280: 7468 6174 2074 6865 7920 6861 7665 2073  that they have s
+00038290: 696d 696c 6172 2d69 7368 2063 6875 6e6b  imilar-ish chunk
+000382a0: 2073 7472 7563 7475 7265 0a20 2020 2020   structure.     
+000382b0: 2020 2069 6620 6e6f 7420 616c 6c28 6e6f     if not all(no
+000382c0: 7420 612e 6368 756e 6b73 206f 7220 6c65  t a.chunks or le
+000382d0: 6e28 612e 6368 756e 6b73 5b30 5d29 203d  n(a.chunks[0]) =
+000382e0: 3d20 6466 2e6e 7061 7274 6974 696f 6e73  = df.npartitions
+000382f0: 2066 6f72 2064 6620 696e 2064 6673 293a   for df in dfs):
+00038300: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
+00038310: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00038320: 2020 2020 2022 5768 656e 2063 6f6d 6269       "When combi
+00038330: 6e69 6e67 2064 6173 6b20 6172 7261 7973  ning dask arrays
+00038340: 2077 6974 6820 6461 7461 6672 616d 6573   with dataframes
+00038350: 2074 6865 7920 6d75 7374 2022 0a20 2020   they must ".   
+00038360: 2020 2020 2020 2020 2020 2020 2022 6d61               "ma
+00038370: 7463 6820 6368 756e 6b69 6e67 2065 7861  tch chunking exa
+00038380: 6374 6c79 2e20 204f 7065 7261 7469 6f6e  ctly.  Operation
+00038390: 3a20 2573 2220 2520 6675 6e63 6e61 6d65  : %s" % funcname
+000383a0: 286f 7029 0a20 2020 2020 2020 2020 2020  (op).           
+000383b0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+000383c0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+000383d0: 6d73 6729 0a20 2020 2020 2020 2023 2052  msg).        # R
+000383e0: 6563 6875 6e6b 2074 6f20 6861 7665 2061  echunk to have a
+000383f0: 2073 696e 676c 6520 6368 756e 6b20 616c   single chunk al
+00038400: 6f6e 6720 616c 6c20 6f74 6865 7220 6178  ong all other ax
+00038410: 6573 0a20 2020 2020 2020 2069 6620 612e  es.        if a.
+00038420: 6e64 696d 203e 2031 3a0a 2020 2020 2020  ndim > 1:.      
+00038430: 2020 2020 2020 6120 3d20 612e 7265 6368        a = a.rech
+00038440: 756e 6b28 7b69 202b 2031 3a20 6420 666f  unk({i + 1: d fo
+00038450: 7220 692c 2064 2069 6e20 656e 756d 6572  r i, d in enumer
+00038460: 6174 6528 612e 7368 6170 655b 313a 5d29  ate(a.shape[1:])
+00038470: 7d29 0a20 2020 2020 2020 2020 2020 2064  }).            d
+00038480: 6173 6b73 5b69 5d20 3d20 610a 0a20 2020  asks[i] = a..   
+00038490: 2064 6976 6973 696f 6e73 203d 2064 6673   divisions = dfs
+000384a0: 5b30 5d2e 6469 7669 7369 6f6e 730a 2020  [0].divisions.  
+000384b0: 2020 6966 2074 7261 6e73 666f 726d 5f64    if transform_d
+000384c0: 6976 6973 696f 6e73 2061 6e64 2069 7369  ivisions and isi
+000384d0: 6e73 7461 6e63 6528 6466 735b 305d 2c20  nstance(dfs[0], 
+000384e0: 496e 6465 7829 2061 6e64 206c 656e 2864  Index) and len(d
+000384f0: 6673 2920 3d3d 2031 3a0a 2020 2020 2020  fs) == 1:.      
+00038500: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00038510: 2020 2064 6976 6973 696f 6e73 203d 206f     divisions = o
+00038520: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
+00038530: 2020 202a 5b70 642e 496e 6465 7828 6172     *[pd.Index(ar
+00038540: 672e 6469 7669 7369 6f6e 7329 2069 6620  g.divisions) if 
+00038550: 6172 6720 6973 2064 6673 5b30 5d20 656c  arg is dfs[0] el
+00038560: 7365 2061 7267 2066 6f72 2061 7267 2069  se arg for arg i
+00038570: 6e20 6172 6773 5d2c 0a20 2020 2020 2020  n args],.       
+00038580: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
+00038590: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
+000385a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000385b0: 6973 696e 7374 616e 6365 2864 6976 6973  isinstance(divis
+000385c0: 696f 6e73 2c20 7064 2e49 6e64 6578 293a  ions, pd.Index):
+000385d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000385e0: 2064 6976 6973 696f 6e73 203d 206d 6574   divisions = met
+000385f0: 686f 6473 2e74 6f6c 6973 7428 6469 7669  hods.tolist(divi
+00038600: 7369 6f6e 7329 0a20 2020 2020 2020 2065  sions).        e
+00038610: 7863 6570 7420 4578 6365 7074 696f 6e3a  xcept Exception:
+00038620: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
+00038630: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
+00038640: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00038650: 6f74 2076 616c 6964 5f64 6976 6973 696f  ot valid_divisio
+00038660: 6e73 2864 6976 6973 696f 6e73 293a 0a20  ns(divisions):. 
+00038670: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00038680: 6976 6973 696f 6e73 203d 205b 4e6f 6e65  ivisions = [None
+00038690: 5d20 2a20 2864 6673 5b30 5d2e 6e70 6172  ] * (dfs[0].npar
+000386a0: 7469 7469 6f6e 7320 2b20 3129 0a0a 2020  titions + 1)..  
+000386b0: 2020 5f69 735f 6272 6f61 6463 6173 7461    _is_broadcasta
+000386c0: 626c 6520 3d20 7061 7274 6961 6c28 6973  ble = partial(is
+000386d0: 5f62 726f 6164 6361 7374 6162 6c65 2c20  _broadcastable, 
+000386e0: 6466 7329 0a20 2020 2064 6673 203d 206c  dfs).    dfs = l
+000386f0: 6973 7428 7265 6d6f 7665 285f 6973 5f62  ist(remove(_is_b
+00038700: 726f 6164 6361 7374 6162 6c65 2c20 6466  roadcastable, df
+00038710: 7329 290a 0a20 2020 206f 7468 6572 203d  s))..    other =
+00038720: 205b 0a20 2020 2020 2020 2028 692c 2061   [.        (i, a
+00038730: 7267 290a 2020 2020 2020 2020 666f 7220  rg).        for 
+00038740: 692c 2061 7267 2069 6e20 656e 756d 6572  i, arg in enumer
+00038750: 6174 6528 6172 6773 290a 2020 2020 2020  ate(args).      
+00038760: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00038770: 6e63 6528 6172 672c 2028 5f46 7261 6d65  nce(arg, (_Frame
+00038780: 2c20 5363 616c 6172 2c20 4172 7261 7929  , Scalar, Array)
+00038790: 290a 2020 2020 5d0a 0a20 2020 2023 2061  ).    ]..    # a
+000387a0: 646a 7573 7420 7468 6520 6b65 7920 6c65  djust the key le
+000387b0: 6e67 7468 206f 6620 5363 616c 6172 0a20  ngth of Scalar. 
+000387c0: 2020 2064 736b 203d 2070 6172 7469 7469     dsk = partiti
+000387d0: 6f6e 7769 7365 5f67 7261 7068 286f 702c  onwise_graph(op,
+000387e0: 205f 6e61 6d65 2c20 2a61 7267 732c 202a   _name, *args, *
+000387f0: 2a6b 7761 7267 7329 0a0a 2020 2020 6772  *kwargs)..    gr
+00038800: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+00038810: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+00038820: 7469 6f6e 7328 5f6e 616d 652c 2064 736b  tions(_name, dsk
+00038830: 2c20 6465 7065 6e64 656e 6369 6573 3d64  , dependencies=d
+00038840: 6570 7329 0a0a 2020 2020 6966 206d 6574  eps)..    if met
+00038850: 6120 6973 206e 6f5f 6465 6661 756c 743a  a is no_default:
+00038860: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00038870: 6466 7329 203e 3d20 3220 616e 6420 6e6f  dfs) >= 2 and no
+00038880: 7420 616c 6c28 6861 7361 7474 7228 642c  t all(hasattr(d,
+00038890: 2022 6e70 6172 7469 7469 6f6e 7322 2920   "npartitions") 
+000388a0: 666f 7220 6420 696e 2064 6173 6b73 293a  for d in dasks):
+000388b0: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
+000388c0: 686f 756c 6420 6e6f 7420 6f63 6375 7220  hould not occur 
+000388d0: 696e 2063 7572 7265 6e74 2066 756e 6373  in current funcs
+000388e0: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
+000388f0: 203d 2022 656c 656d 7769 7365 2077 6974   = "elemwise wit
+00038900: 6820 3220 6f72 206d 6f72 6520 4461 7461  h 2 or more Data
+00038910: 4672 616d 6573 2061 6e64 2053 6361 6c61  Frames and Scala
+00038920: 7220 6973 206e 6f74 2073 7570 706f 7274  r is not support
+00038930: 6564 220a 2020 2020 2020 2020 2020 2020  ed".            
+00038940: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+00038950: 6e74 6564 4572 726f 7228 6d73 6729 0a20  ntedError(msg). 
+00038960: 2020 2020 2020 2023 2046 6f72 2062 726f         # For bro
+00038970: 6164 6361 7374 6162 6c65 2073 6572 6965  adcastable serie
+00038980: 732c 2075 7365 206e 6f20 726f 7773 2e0a  s, use no rows..
+00038990: 2020 2020 2020 2020 7061 7274 7320 3d20          parts = 
+000389a0: 5b0a 2020 2020 2020 2020 2020 2020 642e  [.            d.
+000389b0: 5f6d 6574 610a 2020 2020 2020 2020 2020  _meta.          
+000389c0: 2020 6966 205f 6973 5f62 726f 6164 6361    if _is_broadca
+000389d0: 7374 6162 6c65 2864 290a 2020 2020 2020  stable(d).      
+000389e0: 2020 2020 2020 656c 7365 206e 702e 656d        else np.em
+000389f0: 7074 7928 2829 2c20 6474 7970 653d 642e  pty((), dtype=d.
+00038a00: 6474 7970 6529 0a20 2020 2020 2020 2020  dtype).         
+00038a10: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00038a20: 2864 2c20 4172 7261 7929 0a20 2020 2020  (d, Array).     
+00038a30: 2020 2020 2020 2065 6c73 6520 642e 5f6d         else d._m
+00038a40: 6574 615f 6e6f 6e65 6d70 7479 0a20 2020  eta_nonempty.   
+00038a50: 2020 2020 2020 2020 2066 6f72 2064 2069           for d i
+00038a60: 6e20 6461 736b 730a 2020 2020 2020 2020  n dasks.        
+00038a70: 5d0a 2020 2020 2020 2020 7769 7468 2072  ].        with r
+00038a80: 6169 7365 5f6f 6e5f 6d65 7461 5f65 7272  aise_on_meta_err
+00038a90: 6f72 2866 756e 636e 616d 6528 6f70 2929  or(funcname(op))
+00038aa0: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
+00038ab0: 7461 203d 2070 6172 7469 616c 5f62 795f  ta = partial_by_
+00038ac0: 6f72 6465 7228 2a70 6172 7473 2c20 6675  order(*parts, fu
+00038ad0: 6e63 7469 6f6e 3d6f 702c 206f 7468 6572  nction=op, other
+00038ae0: 3d6f 7468 6572 290a 0a20 2020 2072 6573  =other)..    res
+00038af0: 756c 7420 3d20 6e65 775f 6464 5f6f 626a  ult = new_dd_obj
+00038b00: 6563 7428 6772 6170 682c 205f 6e61 6d65  ect(graph, _name
+00038b10: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
+00038b20: 7329 0a20 2020 2072 6574 7572 6e20 6861  s).    return ha
+00038b30: 6e64 6c65 5f6f 7574 286f 7574 2c20 7265  ndle_out(out, re
+00038b40: 7375 6c74 290a 0a0a 6465 6620 6861 6e64  sult)...def hand
+00038b50: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
+00038b60: 6c74 293a 0a20 2020 2022 2222 4861 6e64  lt):.    """Hand
+00038b70: 6c65 206f 7574 2070 6172 616d 6574 6572  le out parameter
+00038b80: 730a 0a20 2020 2049 6620 6f75 7420 6973  s..    If out is
+00038b90: 2061 2064 6173 6b2e 4461 7461 4672 616d   a dask.DataFram
+00038ba0: 652c 2064 6173 6b2e 5365 7269 6573 206f  e, dask.Series o
+00038bb0: 7220 6461 736b 2e53 6361 6c61 7220 7468  r dask.Scalar th
+00038bc0: 656e 0a20 2020 2074 6869 7320 6f76 6572  en.    this over
+00038bd0: 7772 6974 6573 2074 6865 2063 6f6e 7465  writes the conte
+00038be0: 6e74 7320 6f66 2069 7420 7769 7468 2074  nts of it with t
+00038bf0: 6865 2072 6573 756c 740a 2020 2020 2222  he result.    ""
+00038c00: 220a 2020 2020 6966 2069 7369 6e73 7461  ".    if isinsta
+00038c10: 6e63 6528 6f75 742c 2074 7570 6c65 293a  nce(out, tuple):
+00038c20: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00038c30: 6f75 7429 203d 3d20 313a 0a20 2020 2020  out) == 1:.     
+00038c40: 2020 2020 2020 206f 7574 203d 206f 7574         out = out
+00038c50: 5b30 5d0a 2020 2020 2020 2020 656c 6966  [0].        elif
+00038c60: 206c 656e 286f 7574 2920 3e20 313a 0a20   len(out) > 1:. 
+00038c70: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00038c80: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+00038c90: 7272 6f72 2822 5468 6520 6f75 7420 7061  rror("The out pa
+00038ca0: 7261 6d65 7465 7220 6973 206e 6f74 2066  rameter is not f
+00038cb0: 756c 6c79 2073 7570 706f 7274 6564 2229  ully supported")
+00038cc0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00038cd0: 2020 2020 2020 2020 2020 206f 7574 203d             out =
+00038ce0: 204e 6f6e 650a 0a20 2020 2023 204e 6f74   None..    # Not
+00038cf0: 6963 652c 2077 6520 7573 6520 2e5f 5f63  ice, we use .__c
+00038d00: 6c61 7373 5f5f 2061 7320 6f70 706f 7365  lass__ as oppose
+00038d10: 6420 746f 2074 7970 6528 2920 696e 206f  d to type() in o
+00038d20: 7264 6572 2074 6f20 7375 7070 6f72 740a  rder to support.
+00038d30: 2020 2020 2320 6f62 6a65 6374 2070 726f      # object pro
+00038d40: 7869 6573 2073 6565 203c 6874 7470 733a  xies see <https:
+00038d50: 2f2f 6769 7468 7562 2e63 6f6d 2f64 6173  //github.com/das
+00038d60: 6b2f 6461 736b 2f70 756c 6c2f 3639 3831  k/dask/pull/6981
+00038d70: 3e0a 2020 2020 6966 206f 7574 2069 7320  >.    if out is 
+00038d80: 6e6f 7420 4e6f 6e65 2061 6e64 206f 7574  not None and out
+00038d90: 2e5f 5f63 6c61 7373 5f5f 2021 3d20 7265  .__class__ != re
+00038da0: 7375 6c74 2e5f 5f63 6c61 7373 5f5f 3a0a  sult.__class__:.
+00038db0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00038dc0: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
+00038dd0: 2020 2020 2022 4d69 736d 6174 6368 6564       "Mismatched
+00038de0: 2074 7970 6573 2062 6574 7765 656e 2072   types between r
+00038df0: 6573 756c 7420 616e 6420 6f75 7420 7061  esult and out pa
+00038e00: 7261 6d65 7465 722e 2022 0a20 2020 2020  rameter. ".     
+00038e10: 2020 2020 2020 2022 6f75 743d 2573 2c20         "out=%s, 
+00038e20: 7265 7375 6c74 3d25 7322 2025 2028 7374  result=%s" % (st
+00038e30: 7228 7479 7065 286f 7574 2929 2c20 7374  r(type(out)), st
+00038e40: 7228 7479 7065 2872 6573 756c 7429 2929  r(type(result)))
+00038e50: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00038e60: 6966 2069 7369 6e73 7461 6e63 6528 6f75  if isinstance(ou
+00038e70: 742c 2044 6174 6146 7261 6d65 293a 0a20  t, DataFrame):. 
+00038e80: 2020 2020 2020 2069 6620 6c65 6e28 6f75         if len(ou
+00038e90: 742e 636f 6c75 6d6e 7329 2021 3d20 6c65  t.columns) != le
+00038ea0: 6e28 7265 7375 6c74 2e63 6f6c 756d 6e73  n(result.columns
+00038eb0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00038ec0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00038ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038ee0: 2022 4d69 736d 6174 6368 6564 2063 6f6c   "Mismatched col
+00038ef0: 756d 6e73 2063 6f75 6e74 2062 6574 7765  umns count betwe
+00038f00: 656e 2072 6573 756c 7420 616e 6420 6f75  en result and ou
+00038f10: 7420 7061 7261 6d65 7465 722e 2022 0a20  t parameter. ". 
+00038f20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00038f30: 6f75 743d 2573 2c20 7265 7375 6c74 3d25  out=%s, result=%
+00038f40: 7322 2025 2028 7374 7228 6c65 6e28 6f75  s" % (str(len(ou
+00038f50: 742e 636f 6c75 6d6e 7329 292c 2073 7472  t.columns)), str
+00038f60: 286c 656e 2872 6573 756c 742e 636f 6c75  (len(result.colu
+00038f70: 6d6e 7329 2929 0a20 2020 2020 2020 2020  mns))).         
+00038f80: 2020 2029 0a0a 2020 2020 6966 2069 7369     )..    if isi
+00038f90: 6e73 7461 6e63 6528 6f75 742c 2028 5365  nstance(out, (Se
+00038fa0: 7269 6573 2c20 4461 7461 4672 616d 652c  ries, DataFrame,
+00038fb0: 2053 6361 6c61 7229 293a 0a20 2020 2020   Scalar)):.     
+00038fc0: 2020 206f 7574 2e5f 6d65 7461 203d 2072     out._meta = r
+00038fd0: 6573 756c 742e 5f6d 6574 610a 2020 2020  esult._meta.    
+00038fe0: 2020 2020 6f75 742e 5f6e 616d 6520 3d20      out._name = 
+00038ff0: 7265 7375 6c74 2e5f 6e61 6d65 0a20 2020  result._name.   
+00039000: 2020 2020 206f 7574 2e64 6173 6b20 3d20       out.dask = 
+00039010: 7265 7375 6c74 2e64 6173 6b0a 0a20 2020  result.dask..   
+00039020: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00039030: 7374 616e 6365 286f 7574 2c20 5363 616c  stance(out, Scal
+00039040: 6172 293a 0a20 2020 2020 2020 2020 2020  ar):.           
+00039050: 206f 7574 2e5f 6469 7669 7369 6f6e 7320   out._divisions 
+00039060: 3d20 7265 7375 6c74 2e64 6976 6973 696f  = result.divisio
+00039070: 6e73 0a20 2020 2065 6c69 6620 6f75 7420  ns.    elif out 
+00039080: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00039090: 2020 2020 206d 7367 203d 2028 0a20 2020       msg = (.   
+000390a0: 2020 2020 2020 2020 2022 5468 6520 6f75           "The ou
+000390b0: 7420 7061 7261 6d65 7465 7220 6973 206e  t parameter is n
+000390c0: 6f74 2066 756c 6c79 2073 7570 706f 7274  ot fully support
+000390d0: 6564 2e22 0a20 2020 2020 2020 2020 2020  ed.".           
+000390e0: 2022 2052 6563 6569 7665 6420 7479 7065   " Received type
+000390f0: 2025 732c 2065 7870 6563 7465 6420 2573   %s, expected %s
+00039100: 2022 0a20 2020 2020 2020 2020 2020 2025   ".            %
+00039110: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00039120: 2020 2074 7970 656e 616d 6528 7479 7065     typename(type
+00039130: 286f 7574 2929 2c0a 2020 2020 2020 2020  (out)),.        
+00039140: 2020 2020 2020 2020 7479 7065 6e61 6d65          typename
+00039150: 2874 7970 6528 7265 7375 6c74 2929 2c0a  (type(result)),.
+00039160: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00039170: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00039180: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+00039190: 6e74 6564 4572 726f 7228 6d73 6729 0a20  ntedError(msg). 
+000391a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000391b0: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
+000391c0: 0a64 6566 205f 6d61 7962 655f 6672 6f6d  .def _maybe_from
+000391d0: 5f70 616e 6461 7328 6466 7329 3a0a 2020  _pandas(dfs):.  
+000391e0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+000391f0: 6672 616d 652e 696f 2069 6d70 6f72 7420  frame.io import 
+00039200: 6672 6f6d 5f70 616e 6461 730a 0a20 2020  from_pandas..   
+00039210: 2064 6673 203d 205b 0a20 2020 2020 2020   dfs = [.       
+00039220: 2066 726f 6d5f 7061 6e64 6173 2864 662c   from_pandas(df,
+00039230: 2031 290a 2020 2020 2020 2020 6966 2028   1).        if (
+00039240: 6973 5f73 6572 6965 735f 6c69 6b65 2864  is_series_like(d
+00039250: 6629 206f 7220 6973 5f64 6174 6166 7261  f) or is_datafra
+00039260: 6d65 5f6c 696b 6528 6466 2929 2061 6e64  me_like(df)) and
+00039270: 206e 6f74 2069 735f 6461 736b 5f63 6f6c   not is_dask_col
+00039280: 6c65 6374 696f 6e28 6466 290a 2020 2020  lection(df).    
+00039290: 2020 2020 656c 7365 2064 660a 2020 2020      else df.    
+000392a0: 2020 2020 666f 7220 6466 2069 6e20 6466      for df in df
+000392b0: 730a 2020 2020 5d0a 2020 2020 7265 7475  s.    ].    retu
+000392c0: 726e 2064 6673 0a0a 0a64 6566 2068 6173  rn dfs...def has
+000392d0: 685f 7368 6172 6428 0a20 2020 2064 662c  h_shard(.    df,
+000392e0: 206e 7061 7274 732c 2073 706c 6974 5f6f   nparts, split_o
+000392f0: 7574 5f73 6574 7570 3d4e 6f6e 652c 2073  ut_setup=None, s
+00039300: 706c 6974 5f6f 7574 5f73 6574 7570 5f6b  plit_out_setup_k
+00039310: 7761 7267 733d 4e6f 6e65 2c20 6967 6e6f  wargs=None, igno
+00039320: 7265 5f69 6e64 6578 3d46 616c 7365 0a29  re_index=False.)
+00039330: 3a0a 2020 2020 6966 2073 706c 6974 5f6f  :.    if split_o
+00039340: 7574 5f73 6574 7570 3a0a 2020 2020 2020  ut_setup:.      
+00039350: 2020 6820 3d20 7370 6c69 745f 6f75 745f    h = split_out_
+00039360: 7365 7475 7028 6466 2c20 2a2a 2873 706c  setup(df, **(spl
+00039370: 6974 5f6f 7574 5f73 6574 7570 5f6b 7761  it_out_setup_kwa
+00039380: 7267 7320 6f72 207b 7d29 290a 2020 2020  rgs or {})).    
+00039390: 656c 7365 3a0a 2020 2020 2020 2020 6820  else:.        h 
+000393a0: 3d20 6466 0a0a 2020 2020 6820 3d20 6861  = df..    h = ha
+000393b0: 7368 5f6f 626a 6563 745f 6469 7370 6174  sh_object_dispat
+000393c0: 6368 2868 2c20 696e 6465 783d 4661 6c73  ch(h, index=Fals
+000393d0: 6529 0a20 2020 2072 6574 7572 6e20 6772  e).    return gr
+000393e0: 6f75 705f 7370 6c69 745f 6469 7370 6174  oup_split_dispat
+000393f0: 6368 2864 662c 2068 2025 206e 7061 7274  ch(df, h % npart
+00039400: 732c 206e 7061 7274 732c 2069 676e 6f72  s, nparts, ignor
+00039410: 655f 696e 6465 783d 6967 6e6f 7265 5f69  e_index=ignore_i
+00039420: 6e64 6578 290a 0a0a 6465 6620 7370 6c69  ndex)...def spli
+00039430: 745f 6576 656e 6c79 2864 662c 206b 293a  t_evenly(df, k):
+00039440: 0a20 2020 2022 2222 5370 6c69 7420 6461  .    """Split da
+00039450: 7461 6672 616d 6520 696e 746f 206b 2072  taframe into k r
+00039460: 6f75 6768 6c79 2065 7175 616c 2070 6172  oughly equal par
+00039470: 7473 2222 220a 2020 2020 6469 7669 7369  ts""".    divisi
+00039480: 6f6e 7320 3d20 6e70 2e6c 696e 7370 6163  ons = np.linspac
+00039490: 6528 302c 206c 656e 2864 6629 2c20 6b20  e(0, len(df), k 
+000394a0: 2b20 3129 2e61 7374 7970 6528 696e 7429  + 1).astype(int)
+000394b0: 0a20 2020 2072 6574 7572 6e20 7b69 3a20  .    return {i: 
+000394c0: 6466 2e69 6c6f 635b 6469 7669 7369 6f6e  df.iloc[division
+000394d0: 735b 695d 203a 2064 6976 6973 696f 6e73  s[i] : divisions
+000394e0: 5b69 202b 2031 5d5d 2066 6f72 2069 2069  [i + 1]] for i i
+000394f0: 6e20 7261 6e67 6528 6b29 7d0a 0a0a 6465  n range(k)}...de
+00039500: 6620 7370 6c69 745f 6f75 745f 6f6e 5f69  f split_out_on_i
+00039510: 6e64 6578 2864 6629 3a0a 2020 2020 6820  ndex(df):.    h 
+00039520: 3d20 6466 2e69 6e64 6578 0a20 2020 2069  = df.index.    i
+00039530: 6620 6973 696e 7374 616e 6365 2868 2c20  f isinstance(h, 
+00039540: 7064 2e4d 756c 7469 496e 6465 7829 3a0a  pd.MultiIndex):.
+00039550: 2020 2020 2020 2020 6820 3d20 6d65 7461          h = meta
+00039560: 5f66 7261 6d65 5f63 6f6e 7374 7275 6374  _frame_construct
+00039570: 6f72 2864 6629 285b 5d2c 2069 6e64 6578  or(df)([], index
+00039580: 3d68 292e 7265 7365 745f 696e 6465 7828  =h).reset_index(
+00039590: 290a 2020 2020 7265 7475 726e 2068 0a0a  ).    return h..
+000395a0: 0a64 6566 2073 706c 6974 5f6f 7574 5f6f  .def split_out_o
+000395b0: 6e5f 636f 6c73 2864 662c 2063 6f6c 733d  n_cols(df, cols=
+000395c0: 4e6f 6e65 293a 0a20 2020 2072 6574 7572  None):.    retur
+000395d0: 6e20 6466 5b63 6f6c 735d 0a0a 0a40 696e  n df[cols]...@in
+000395e0: 7365 7274 5f6d 6574 615f 7061 7261 6d5f  sert_meta_param_
+000395f0: 6465 7363 7269 7074 696f 6e0a 6465 6620  description.def 
+00039600: 6170 706c 795f 636f 6e63 6174 5f61 7070  apply_concat_app
+00039610: 6c79 280a 2020 2020 6172 6773 2c0a 2020  ly(.    args,.  
+00039620: 2020 6368 756e 6b3d 4e6f 6e65 2c0a 2020    chunk=None,.  
+00039630: 2020 6167 6772 6567 6174 653d 4e6f 6e65    aggregate=None
+00039640: 2c0a 2020 2020 636f 6d62 696e 653d 4e6f  ,.    combine=No
+00039650: 6e65 2c0a 2020 2020 6d65 7461 3d6e 6f5f  ne,.    meta=no_
+00039660: 6465 6661 756c 742c 0a20 2020 2074 6f6b  default,.    tok
+00039670: 656e 3d4e 6f6e 652c 0a20 2020 2063 6875  en=None,.    chu
+00039680: 6e6b 5f6b 7761 7267 733d 4e6f 6e65 2c0a  nk_kwargs=None,.
+00039690: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
+000396a0: 6172 6773 3d4e 6f6e 652c 0a20 2020 2063  args=None,.    c
+000396b0: 6f6d 6269 6e65 5f6b 7761 7267 733d 4e6f  ombine_kwargs=No
+000396c0: 6e65 2c0a 2020 2020 7370 6c69 745f 6576  ne,.    split_ev
+000396d0: 6572 793d 4e6f 6e65 2c0a 2020 2020 7370  ery=None,.    sp
+000396e0: 6c69 745f 6f75 743d 4e6f 6e65 2c0a 2020  lit_out=None,.  
+000396f0: 2020 7370 6c69 745f 6f75 745f 7365 7475    split_out_setu
+00039700: 703d 4e6f 6e65 2c0a 2020 2020 7370 6c69  p=None,.    spli
+00039710: 745f 6f75 745f 7365 7475 705f 6b77 6172  t_out_setup_kwar
+00039720: 6773 3d4e 6f6e 652c 0a20 2020 2073 6f72  gs=None,.    sor
+00039730: 743d 4e6f 6e65 2c0a 2020 2020 6967 6e6f  t=None,.    igno
+00039740: 7265 5f69 6e64 6578 3d46 616c 7365 2c0a  re_index=False,.
+00039750: 2020 2020 2a2a 6b77 6172 6773 2c0a 293a      **kwargs,.):
+00039760: 0a20 2020 2022 2222 4170 706c 7920 6120  .    """Apply a 
+00039770: 6675 6e63 7469 6f6e 2074 6f20 626c 6f63  function to bloc
+00039780: 6b73 2c20 7468 656e 2063 6f6e 6361 742c  ks, then concat,
+00039790: 2074 6865 6e20 6170 706c 7920 6167 6169   then apply agai
+000397a0: 6e0a 0a20 2020 2050 6172 616d 6574 6572  n..    Parameter
+000397b0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+000397c0: 0a20 2020 2061 7267 7320 3a0a 2020 2020  .    args :.    
+000397d0: 2020 2020 506f 7369 7469 6f6e 616c 2061      Positional a
+000397e0: 7267 756d 656e 7473 2066 6f72 2074 6865  rguments for the
+000397f0: 2060 6368 756e 6b60 2066 756e 6374 696f   `chunk` functio
+00039800: 6e2e 2041 6c6c 2060 6461 736b 2e64 6174  n. All `dask.dat
+00039810: 6166 7261 6d65 600a 2020 2020 2020 2020  aframe`.        
+00039820: 6f62 6a65 6374 7320 7368 6f75 6c64 2062  objects should b
+00039830: 6520 7061 7274 6974 696f 6e65 6420 616e  e partitioned an
+00039840: 6420 696e 6465 7865 6420 6571 7569 7661  d indexed equiva
+00039850: 6c65 6e74 6c79 2e0a 2020 2020 6368 756e  lently..    chun
+00039860: 6b20 3a20 6675 6e63 7469 6f6e 205b 626c  k : function [bl
+00039870: 6f63 6b2d 7065 722d 6172 675d 202d 3e20  ock-per-arg] -> 
+00039880: 626c 6f63 6b0a 2020 2020 2020 2020 4675  block.        Fu
+00039890: 6e63 7469 6f6e 2074 6f20 6f70 6572 6174  nction to operat
+000398a0: 6520 6f6e 2065 6163 6820 626c 6f63 6b20  e on each block 
+000398b0: 6f66 2064 6174 610a 2020 2020 6167 6772  of data.    aggr
+000398c0: 6567 6174 6520 3a20 6675 6e63 7469 6f6e  egate : function
+000398d0: 2063 6f6e 6361 7465 6e61 7465 642d 626c   concatenated-bl
+000398e0: 6f63 6b20 2d3e 2062 6c6f 636b 0a20 2020  ock -> block.   
+000398f0: 2020 2020 2046 756e 6374 696f 6e20 746f       Function to
+00039900: 206f 7065 7261 7465 206f 6e20 7468 6520   operate on the 
+00039910: 636f 6e63 6174 656e 6174 6564 2072 6573  concatenated res
+00039920: 756c 7420 6f66 2063 6875 6e6b 0a20 2020  ult of chunk.   
+00039930: 2063 6f6d 6269 6e65 203a 2066 756e 6374   combine : funct
+00039940: 696f 6e20 636f 6e63 6174 656e 6174 6564  ion concatenated
+00039950: 2d62 6c6f 636b 202d 3e20 626c 6f63 6b2c  -block -> block,
+00039960: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00039970: 2020 4675 6e63 7469 6f6e 2074 6f20 6f70    Function to op
+00039980: 6572 6174 6520 6f6e 2069 6e74 6572 6d65  erate on interme
+00039990: 6469 6174 6520 636f 6e63 6174 656e 6174  diate concatenat
+000399a0: 6564 2072 6573 756c 7473 206f 6620 6368  ed results of ch
+000399b0: 756e 6b0a 2020 2020 2020 2020 696e 2061  unk.        in a
+000399c0: 2074 7265 652d 7265 6475 6374 696f 6e2e   tree-reduction.
+000399d0: 2049 6620 6e6f 7420 7072 6f76 6964 6564   If not provided
+000399e0: 2c20 6465 6661 756c 7473 2074 6f20 6167  , defaults to ag
+000399f0: 6772 6567 6174 652e 0a20 2020 2024 4d45  gregate..    $ME
+00039a00: 5441 0a20 2020 2074 6f6b 656e 203a 2073  TA.    token : s
+00039a10: 7472 2c20 6f70 7469 6f6e 616c 0a20 2020  tr, optional.   
+00039a20: 2020 2020 2054 6865 206e 616d 6520 746f       The name to
+00039a30: 2075 7365 2066 6f72 2074 6865 206f 7574   use for the out
+00039a40: 7075 7420 6b65 7973 2e0a 2020 2020 6368  put keys..    ch
+00039a50: 756e 6b5f 6b77 6172 6773 203a 2064 6963  unk_kwargs : dic
+00039a60: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+00039a70: 2020 2020 4b65 7977 6f72 6473 2066 6f72      Keywords for
+00039a80: 2074 6865 2063 6875 6e6b 2066 756e 6374   the chunk funct
+00039a90: 696f 6e20 6f6e 6c79 2e0a 2020 2020 6167  ion only..    ag
+00039aa0: 6772 6567 6174 655f 6b77 6172 6773 203a  gregate_kwargs :
+00039ab0: 2064 6963 742c 206f 7074 696f 6e61 6c0a   dict, optional.
+00039ac0: 2020 2020 2020 2020 4b65 7977 6f72 6473          Keywords
+00039ad0: 2066 6f72 2074 6865 2061 6767 7265 6761   for the aggrega
+00039ae0: 7465 2066 756e 6374 696f 6e20 6f6e 6c79  te function only
+00039af0: 2e0a 2020 2020 636f 6d62 696e 655f 6b77  ..    combine_kw
+00039b00: 6172 6773 203a 2064 6963 742c 206f 7074  args : dict, opt
+00039b10: 696f 6e61 6c0a 2020 2020 2020 2020 4b65  ional.        Ke
+00039b20: 7977 6f72 6473 2066 6f72 2074 6865 2063  ywords for the c
+00039b30: 6f6d 6269 6e65 2066 756e 6374 696f 6e20  ombine function 
+00039b40: 6f6e 6c79 2e0a 2020 2020 7370 6c69 745f  only..    split_
+00039b50: 6576 6572 7920 3a20 696e 742c 206f 7074  every : int, opt
+00039b60: 696f 6e61 6c0a 2020 2020 2020 2020 4772  ional.        Gr
+00039b70: 6f75 7020 7061 7274 6974 696f 6e73 2069  oup partitions i
+00039b80: 6e74 6f20 6772 6f75 7073 206f 6620 7468  nto groups of th
+00039b90: 6973 2073 697a 6520 7768 696c 6520 7065  is size while pe
+00039ba0: 7266 6f72 6d69 6e67 2061 0a20 2020 2020  rforming a.     
+00039bb0: 2020 2074 7265 652d 7265 6475 6374 696f     tree-reductio
+00039bc0: 6e2e 2049 6620 7365 7420 746f 2046 616c  n. If set to Fal
+00039bd0: 7365 2c20 6e6f 2074 7265 652d 7265 6475  se, no tree-redu
+00039be0: 6374 696f 6e20 7769 6c6c 2062 6520 7573  ction will be us
+00039bf0: 6564 2c0a 2020 2020 2020 2020 616e 6420  ed,.        and 
+00039c00: 616c 6c20 696e 7465 726d 6564 6961 7465  all intermediate
+00039c10: 7320 7769 6c6c 2062 6520 636f 6e63 6174  s will be concat
+00039c20: 656e 6174 6564 2061 6e64 2070 6173 7365  enated and passe
+00039c30: 6420 746f 2060 6061 6767 7265 6761 7465  d to ``aggregate
+00039c40: 6060 2e0a 2020 2020 2020 2020 4465 6661  ``..        Defa
+00039c50: 756c 7420 6973 2038 2e0a 2020 2020 7370  ult is 8..    sp
+00039c60: 6c69 745f 6f75 7420 3a20 696e 742c 206f  lit_out : int, o
+00039c70: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00039c80: 4e75 6d62 6572 206f 6620 6f75 7470 7574  Number of output
+00039c90: 2070 6172 7469 7469 6f6e 732e 2053 706c   partitions. Spl
+00039ca0: 6974 206f 6363 7572 7320 6166 7465 7220  it occurs after 
+00039cb0: 6669 7273 7420 6368 756e 6b20 7265 6475  first chunk redu
+00039cc0: 6374 696f 6e2e 0a20 2020 2073 706c 6974  ction..    split
+00039cd0: 5f6f 7574 5f73 6574 7570 203a 2063 616c  _out_setup : cal
+00039ce0: 6c61 626c 652c 206f 7074 696f 6e61 6c0a  lable, optional.
+00039cf0: 2020 2020 2020 2020 4966 2070 726f 7669          If provi
+00039d00: 6465 642c 2074 6869 7320 6675 6e63 7469  ded, this functi
+00039d10: 6f6e 2069 7320 6361 6c6c 6564 206f 6e20  on is called on 
+00039d20: 6561 6368 2063 6875 6e6b 2062 6566 6f72  each chunk befor
+00039d30: 6520 7065 7266 6f72 6d69 6e67 0a20 2020  e performing.   
+00039d40: 2020 2020 2074 6865 2068 6173 682d 7370       the hash-sp
+00039d50: 6c69 742e 2049 7420 7368 6f75 6c64 2072  lit. It should r
+00039d60: 6574 7572 6e20 6120 7061 6e64 6173 206f  eturn a pandas o
+00039d70: 626a 6563 742c 2077 6865 7265 2065 6163  bject, where eac
+00039d80: 6820 726f 770a 2020 2020 2020 2020 2865  h row.        (e
+00039d90: 7863 6c75 6469 6e67 2074 6865 2069 6e64  xcluding the ind
+00039da0: 6578 2920 6973 2068 6173 6865 642e 2049  ex) is hashed. I
+00039db0: 6620 6e6f 7420 7072 6f76 6964 6564 2c20  f not provided, 
+00039dc0: 7468 6520 6368 756e 6b20 6973 2068 6173  the chunk is has
+00039dd0: 6865 640a 2020 2020 2020 2020 6173 2069  hed.        as i
+00039de0: 732e 0a20 2020 2073 706c 6974 5f6f 7574  s..    split_out
+00039df0: 5f73 6574 7570 5f6b 7761 7267 7320 3a20  _setup_kwargs : 
+00039e00: 6469 6374 2c20 6f70 7469 6f6e 616c 0a20  dict, optional. 
+00039e10: 2020 2020 2020 204b 6579 776f 7264 7320         Keywords 
+00039e20: 666f 7220 7468 6520 6073 706c 6974 5f6f  for the `split_o
+00039e30: 7574 5f73 6574 7570 6020 6675 6e63 7469  ut_setup` functi
+00039e40: 6f6e 206f 6e6c 792e 0a20 2020 2073 6f72  on only..    sor
+00039e50: 7420 3a20 626f 6f6c 2c20 6465 6661 756c  t : bool, defaul
+00039e60: 7420 4e6f 6e65 0a20 2020 2020 2020 2049  t None.        I
+00039e70: 6620 616c 6c6f 7765 642c 2073 6f72 7420  f allowed, sort 
+00039e80: 7468 6520 6b65 7973 206f 6620 7468 6520  the keys of the 
+00039e90: 6f75 7470 7574 2061 6767 7265 6761 7469  output aggregati
+00039ea0: 6f6e 2e0a 2020 2020 6967 6e6f 7265 5f69  on..    ignore_i
+00039eb0: 6e64 6578 203a 2062 6f6f 6c2c 2064 6566  ndex : bool, def
+00039ec0: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
+00039ed0: 2020 2049 6620 5472 7565 2c20 646f 206e     If True, do n
+00039ee0: 6f74 2070 7265 7365 7276 6520 696e 6465  ot preserve inde
+00039ef0: 7820 7661 6c75 6573 2074 6872 6f75 6768  x values through
+00039f00: 6f75 7420 4143 4120 6f70 6572 6174 696f  out ACA operatio
+00039f10: 6e73 2e0a 2020 2020 6b77 6172 6773 203a  ns..    kwargs :
+00039f20: 0a20 2020 2020 2020 2041 6c6c 2072 656d  .        All rem
+00039f30: 6169 6e69 6e67 206b 6579 776f 7264 7320  aining keywords 
+00039f40: 7769 6c6c 2062 6520 7061 7373 6564 2074  will be passed t
+00039f50: 6f20 6060 6368 756e 6b60 602c 2060 6061  o ``chunk``, ``a
+00039f60: 6767 7265 6761 7465 6060 2c20 616e 640a  ggregate``, and.
+00039f70: 2020 2020 2020 2020 6060 636f 6d62 696e          ``combin
+00039f80: 6560 602e 0a0a 2020 2020 4578 616d 706c  e``...    Exampl
+00039f90: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
+00039fa0: 2020 2020 3e3e 3e20 6465 6620 6368 756e      >>> def chun
+00039fb0: 6b28 615f 626c 6f63 6b2c 2062 5f62 6c6f  k(a_block, b_blo
+00039fc0: 636b 293a 0a20 2020 202e 2e2e 2020 2020  ck):.    ...    
+00039fd0: 2070 6173 730a 0a20 2020 203e 3e3e 2064   pass..    >>> d
+00039fe0: 6566 2061 6767 2864 6629 3a0a 2020 2020  ef agg(df):.    
+00039ff0: 2e2e 2e20 2020 2020 7061 7373 0a0a 2020  ...     pass..  
+0003a000: 2020 3e3e 3e20 6170 706c 795f 636f 6e63    >>> apply_conc
+0003a010: 6174 5f61 7070 6c79 285b 612c 2062 5d2c  at_apply([a, b],
+0003a020: 2063 6875 6e6b 3d63 6875 6e6b 2c20 6167   chunk=chunk, ag
+0003a030: 6772 6567 6174 653d 6167 6729 2020 2320  gregate=agg)  # 
+0003a040: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
+0003a050: 2020 2022 2222 0a20 2020 2069 6620 7370     """.    if sp
+0003a060: 6c69 745f 6f75 7420 6973 204e 6f6e 653a  lit_out is None:
+0003a070: 0a20 2020 2020 2020 2073 706c 6974 5f6f  .        split_o
+0003a080: 7574 203d 2031 0a20 2020 2069 6620 6368  ut = 1.    if ch
+0003a090: 756e 6b5f 6b77 6172 6773 2069 7320 4e6f  unk_kwargs is No
+0003a0a0: 6e65 3a0a 2020 2020 2020 2020 6368 756e  ne:.        chun
+0003a0b0: 6b5f 6b77 6172 6773 203d 2064 6963 7428  k_kwargs = dict(
+0003a0c0: 290a 2020 2020 6966 2061 6767 7265 6761  ).    if aggrega
+0003a0d0: 7465 5f6b 7761 7267 7320 6973 204e 6f6e  te_kwargs is Non
+0003a0e0: 653a 0a20 2020 2020 2020 2061 6767 7265  e:.        aggre
+0003a0f0: 6761 7465 5f6b 7761 7267 7320 3d20 6469  gate_kwargs = di
+0003a100: 6374 2829 0a20 2020 2063 6875 6e6b 5f6b  ct().    chunk_k
+0003a110: 7761 7267 732e 7570 6461 7465 286b 7761  wargs.update(kwa
+0003a120: 7267 7329 0a20 2020 2061 6767 7265 6761  rgs).    aggrega
+0003a130: 7465 5f6b 7761 7267 732e 7570 6461 7465  te_kwargs.update
+0003a140: 286b 7761 7267 7329 0a0a 2020 2020 6966  (kwargs)..    if
+0003a150: 2063 6f6d 6269 6e65 2069 7320 4e6f 6e65   combine is None
+0003a160: 3a0a 2020 2020 2020 2020 6966 2063 6f6d  :.        if com
+0003a170: 6269 6e65 5f6b 7761 7267 733a 0a20 2020  bine_kwargs:.   
+0003a180: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0003a190: 616c 7565 4572 726f 7228 2260 636f 6d62  alueError("`comb
+0003a1a0: 696e 655f 6b77 6172 6773 6020 7072 6f76  ine_kwargs` prov
+0003a1b0: 6964 6564 2077 6974 6820 6e6f 2060 636f  ided with no `co
+0003a1c0: 6d62 696e 6560 2229 0a20 2020 2020 2020  mbine`").       
+0003a1d0: 2063 6f6d 6269 6e65 203d 2061 6767 7265   combine = aggre
+0003a1e0: 6761 7465 0a20 2020 2020 2020 2063 6f6d  gate.        com
+0003a1f0: 6269 6e65 5f6b 7761 7267 7320 3d20 6167  bine_kwargs = ag
+0003a200: 6772 6567 6174 655f 6b77 6172 6773 0a20  gregate_kwargs. 
+0003a210: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0003a220: 2069 6620 636f 6d62 696e 655f 6b77 6172   if combine_kwar
+0003a230: 6773 2069 7320 4e6f 6e65 3a0a 2020 2020  gs is None:.    
+0003a240: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
+0003a250: 6b77 6172 6773 203d 2064 6963 7428 290a  kwargs = dict().
+0003a260: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
+0003a270: 6b77 6172 6773 2e75 7064 6174 6528 6b77  kwargs.update(kw
+0003a280: 6172 6773 290a 0a20 2020 2069 6620 6e6f  args)..    if no
+0003a290: 7420 6973 696e 7374 616e 6365 2861 7267  t isinstance(arg
+0003a2a0: 732c 2028 7475 706c 652c 206c 6973 7429  s, (tuple, list)
+0003a2b0: 293a 0a20 2020 2020 2020 2061 7267 7320  ):.        args 
+0003a2c0: 3d20 5b61 7267 735d 0a0a 2020 2020 6466  = [args]..    df
+0003a2d0: 7320 3d20 5b61 7267 2066 6f72 2061 7267  s = [arg for arg
+0003a2e0: 2069 6e20 6172 6773 2069 6620 6973 696e   in args if isin
+0003a2f0: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
+0003a300: 6d65 295d 0a0a 2020 2020 6e70 6172 7469  me)]..    nparti
+0003a310: 7469 6f6e 7320 3d20 7b61 7267 2e6e 7061  tions = {arg.npa
+0003a320: 7274 6974 696f 6e73 2066 6f72 2061 7267  rtitions for arg
+0003a330: 2069 6e20 6466 737d 0a20 2020 2069 6620   in dfs}.    if 
+0003a340: 6c65 6e28 6e70 6172 7469 7469 6f6e 7329  len(npartitions)
+0003a350: 203e 2031 3a0a 2020 2020 2020 2020 7261   > 1:.        ra
+0003a360: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+0003a370: 416c 6c20 6172 6775 6d65 6e74 7320 6d75  All arguments mu
+0003a380: 7374 2068 6176 6520 7361 6d65 206e 756d  st have same num
+0003a390: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
+0003a3a0: 7322 290a 2020 2020 6e70 6172 7469 7469  s").    npartiti
+0003a3b0: 6f6e 7320 3d20 6e70 6172 7469 7469 6f6e  ons = npartition
+0003a3c0: 732e 706f 7028 290a 0a20 2020 2069 6620  s.pop()..    if 
+0003a3d0: 7370 6c69 745f 6576 6572 7920 6973 204e  split_every is N
+0003a3e0: 6f6e 653a 0a20 2020 2020 2020 2073 706c  one:.        spl
+0003a3f0: 6974 5f65 7665 7279 203d 2038 0a20 2020  it_every = 8.   
+0003a400: 2065 6c69 6620 7370 6c69 745f 6576 6572   elif split_ever
+0003a410: 7920 6973 2046 616c 7365 3a0a 2020 2020  y is False:.    
+0003a420: 2020 2020 7370 6c69 745f 6576 6572 7920      split_every 
+0003a430: 3d20 6e70 6172 7469 7469 6f6e 730a 2020  = npartitions.  
+0003a440: 2020 656c 6966 2073 706c 6974 5f65 7665    elif split_eve
+0003a450: 7279 203c 2032 206f 7220 6e6f 7420 6973  ry < 2 or not is
+0003a460: 696e 7374 616e 6365 2873 706c 6974 5f65  instance(split_e
+0003a470: 7665 7279 2c20 496e 7465 6772 616c 293a  very, Integral):
+0003a480: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+0003a490: 616c 7565 4572 726f 7228 2273 706c 6974  alueError("split
+0003a4a0: 5f65 7665 7279 206d 7573 7420 6265 2061  _every must be a
+0003a4b0: 6e20 696e 7465 6765 7220 3e3d 2032 2229  n integer >= 2")
+0003a4c0: 0a0a 2020 2020 746f 6b65 6e5f 6b65 7920  ..    token_key 
+0003a4d0: 3d20 746f 6b65 6e69 7a65 280a 2020 2020  = tokenize(.    
+0003a4e0: 2020 2020 746f 6b65 6e20 6f72 2028 6368      token or (ch
+0003a4f0: 756e 6b2c 2061 6767 7265 6761 7465 292c  unk, aggregate),
+0003a500: 0a20 2020 2020 2020 206d 6574 612c 0a20  .        meta,. 
+0003a510: 2020 2020 2020 2061 7267 732c 0a20 2020         args,.   
+0003a520: 2020 2020 2063 6875 6e6b 5f6b 7761 7267       chunk_kwarg
+0003a530: 732c 0a20 2020 2020 2020 2061 6767 7265  s,.        aggre
+0003a540: 6761 7465 5f6b 7761 7267 732c 0a20 2020  gate_kwargs,.   
+0003a550: 2020 2020 2063 6f6d 6269 6e65 5f6b 7761       combine_kwa
+0003a560: 7267 732c 0a20 2020 2020 2020 2073 706c  rgs,.        spl
+0003a570: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
+0003a580: 2020 7370 6c69 745f 6f75 742c 0a20 2020    split_out,.   
+0003a590: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
+0003a5a0: 6574 7570 2c0a 2020 2020 2020 2020 7370  etup,.        sp
+0003a5b0: 6c69 745f 6f75 745f 7365 7475 705f 6b77  lit_out_setup_kw
+0003a5c0: 6172 6773 2c0a 2020 2020 290a 0a20 2020  args,.    )..   
+0003a5d0: 2023 2042 6c6f 636b 7769 7365 2043 6875   # Blockwise Chu
+0003a5e0: 6e6b 204c 6179 6572 0a20 2020 2063 6875  nk Layer.    chu
+0003a5f0: 6e6b 5f6e 616d 6520 3d20 6622 7b74 6f6b  nk_name = f"{tok
+0003a600: 656e 206f 7220 6675 6e63 6e61 6d65 2863  en or funcname(c
+0003a610: 6875 6e6b 297d 2d63 6875 6e6b 2d7b 746f  hunk)}-chunk-{to
+0003a620: 6b65 6e5f 6b65 797d 220a 2020 2020 6368  ken_key}".    ch
+0003a630: 756e 6b65 6420 3d20 6d61 705f 6261 675f  unked = map_bag_
+0003a640: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+0003a650: 2020 2020 6368 756e 6b2c 0a20 2020 2020      chunk,.     
+0003a660: 2020 2023 2043 6f6e 7665 7274 205f 4672     # Convert _Fr
+0003a670: 616d 6520 636f 6c6c 6563 7469 6f6e 7320  ame collections 
+0003a680: 746f 2042 6167 0a20 2020 2020 2020 202a  to Bag.        *
+0003a690: 5b0a 2020 2020 2020 2020 2020 2020 6172  [.            ar
+0003a6a0: 672e 746f 5f62 6167 2866 6f72 6d61 743d  g.to_bag(format=
+0003a6b0: 2266 7261 6d65 2229 2069 6620 6973 696e  "frame") if isin
+0003a6c0: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
+0003a6d0: 6d65 2920 656c 7365 2061 7267 0a20 2020  me) else arg.   
+0003a6e0: 2020 2020 2020 2020 2066 6f72 2061 7267           for arg
+0003a6f0: 2069 6e20 6172 6773 0a20 2020 2020 2020   in args.       
+0003a700: 205d 2c0a 2020 2020 2020 2020 746f 6b65   ],.        toke
+0003a710: 6e3d 6368 756e 6b5f 6e61 6d65 2c0a 2020  n=chunk_name,.  
+0003a720: 2020 2020 2020 2a2a 6368 756e 6b5f 6b77        **chunk_kw
+0003a730: 6172 6773 2c0a 2020 2020 290a 0a20 2020  args,.    )..   
+0003a740: 2023 204e 4f54 453a 2060 6368 756e 6b65   # NOTE: `chunke
+0003a750: 6460 2069 7320 6e6f 7720 6120 4261 6720  d` is now a Bag 
+0003a760: 636f 6c6c 6563 7469 6f6e 2e0a 2020 2020  collection..    
+0003a770: 2320 5765 2064 6f6e 2774 2075 7365 2061  # We don't use a
+0003a780: 2044 6174 6146 7261 6d65 2063 6f6c 6c65   DataFrame colle
+0003a790: 6374 696f 6e2c 2062 6563 6175 7365 0a20  ction, because. 
+0003a7a0: 2020 2023 2074 6865 2070 6172 7469 7469     # the partiti
+0003a7b0: 6f6e 7320 6d61 7920 6e6f 7420 636f 6e74  ons may not cont
+0003a7c0: 6169 6e20 6461 7461 6672 616d 652d 6c69  ain dataframe-li
+0003a7d0: 6b65 0a20 2020 2023 206f 626a 6563 7473  ke.    # objects
+0003a7e0: 2061 6e79 6d6f 7265 2e0a 0a20 2020 2023   anymore...    #
+0003a7f0: 2042 6c6f 636b 7769 7365 2053 706c 6974   Blockwise Split
+0003a800: 204c 6179 6572 0a20 2020 2069 6620 7370   Layer.    if sp
+0003a810: 6c69 745f 6f75 7420 616e 6420 7370 6c69  lit_out and spli
+0003a820: 745f 6f75 7420 3e20 313a 0a20 2020 2020  t_out > 1:.     
+0003a830: 2020 2063 6875 6e6b 6564 203d 2063 6875     chunked = chu
+0003a840: 6e6b 6564 2e6d 6170 5f70 6172 7469 7469  nked.map_partiti
+0003a850: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+0003a860: 2068 6173 685f 7368 6172 642c 0a20 2020   hash_shard,.   
+0003a870: 2020 2020 2020 2020 2073 706c 6974 5f6f           split_o
+0003a880: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
+0003a890: 7370 6c69 745f 6f75 745f 7365 7475 702c  split_out_setup,
+0003a8a0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+0003a8b0: 6974 5f6f 7574 5f73 6574 7570 5f6b 7761  it_out_setup_kwa
+0003a8c0: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+0003a8d0: 2069 676e 6f72 655f 696e 6465 782c 0a20   ignore_index,. 
+0003a8e0: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
+0003a8f0: 3d22 7370 6c69 742d 2573 2220 2520 746f  ="split-%s" % to
+0003a900: 6b65 6e5f 6b65 792c 0a20 2020 2020 2020  ken_key,.       
+0003a910: 2029 0a0a 2020 2020 2320 4861 6e64 6c65   )..    # Handle
+0003a920: 2073 6f72 7420 6265 6861 7669 6f72 0a20   sort behavior. 
+0003a930: 2020 2069 6620 736f 7274 2069 7320 6e6f     if sort is no
+0003a940: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0003a950: 6966 2073 6f72 7420 616e 6420 7370 6c69  if sort and spli
+0003a960: 745f 6f75 7420 3e20 313a 0a20 2020 2020  t_out > 1:.     
+0003a970: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+0003a980: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+0003a990: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003a9a0: 2020 2243 616e 6e6f 7420 6775 6172 616e    "Cannot guaran
+0003a9b0: 7465 6520 736f 7274 6564 206b 6579 7320  tee sorted keys 
+0003a9c0: 666f 7220 6073 706c 6974 5f6f 7574 3e31  for `split_out>1
+0003a9d0: 602e 220a 2020 2020 2020 2020 2020 2020  `.".            
+0003a9e0: 2020 2020 2220 5472 7920 7573 696e 6720      " Try using 
+0003a9f0: 7370 6c69 745f 6f75 743d 312c 206f 7220  split_out=1, or 
+0003aa00: 6772 6f75 7069 6e67 2077 6974 6820 736f  grouping with so
+0003aa10: 7274 3d46 616c 7365 2e22 0a20 2020 2020  rt=False.".     
+0003aa20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0003aa30: 2061 6767 7265 6761 7465 5f6b 7761 7267   aggregate_kwarg
+0003aa40: 7320 3d20 6167 6772 6567 6174 655f 6b77  s = aggregate_kw
+0003aa50: 6172 6773 206f 7220 7b7d 0a20 2020 2020  args or {}.     
+0003aa60: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
+0003aa70: 7267 735b 2273 6f72 7422 5d20 3d20 736f  rgs["sort"] = so
+0003aa80: 7274 0a0a 2020 2020 2320 5472 6565 2d52  rt..    # Tree-R
+0003aa90: 6564 7563 7469 6f6e 204c 6179 6572 0a20  eduction Layer. 
+0003aaa0: 2020 2066 696e 616c 5f6e 616d 6520 3d20     final_name = 
+0003aab0: 6622 7b74 6f6b 656e 206f 7220 6675 6e63  f"{token or func
+0003aac0: 6e61 6d65 2861 6767 7265 6761 7465 297d  name(aggregate)}
+0003aad0: 2d61 6767 2d7b 746f 6b65 6e5f 6b65 797d  -agg-{token_key}
+0003aae0: 220a 2020 2020 6c61 7965 7220 3d20 4461  ".    layer = Da
+0003aaf0: 7461 4672 616d 6554 7265 6552 6564 7563  taFrameTreeReduc
+0003ab00: 7469 6f6e 280a 2020 2020 2020 2020 6669  tion(.        fi
+0003ab10: 6e61 6c5f 6e61 6d65 2c0a 2020 2020 2020  nal_name,.      
+0003ab20: 2020 6368 756e 6b65 642e 6e61 6d65 2c0a    chunked.name,.
+0003ab30: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+0003ab40: 6f6e 732c 0a20 2020 2020 2020 2070 6172  ons,.        par
+0003ab50: 7469 616c 285f 636f 6e63 6174 2c20 6967  tial(_concat, ig
+0003ab60: 6e6f 7265 5f69 6e64 6578 3d69 676e 6f72  nore_index=ignor
+0003ab70: 655f 696e 6465 7829 2c0a 2020 2020 2020  e_index),.      
+0003ab80: 2020 7061 7274 6961 6c28 636f 6d62 696e    partial(combin
+0003ab90: 652c 202a 2a63 6f6d 6269 6e65 5f6b 7761  e, **combine_kwa
+0003aba0: 7267 7329 2069 6620 636f 6d62 696e 655f  rgs) if combine_
+0003abb0: 6b77 6172 6773 2065 6c73 6520 636f 6d62  kwargs else comb
+0003abc0: 696e 652c 0a20 2020 2020 2020 2066 696e  ine,.        fin
+0003abd0: 616c 697a 655f 6675 6e63 3d70 6172 7469  alize_func=parti
+0003abe0: 616c 2861 6767 7265 6761 7465 2c20 2a2a  al(aggregate, **
+0003abf0: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
+0003ac00: 290a 2020 2020 2020 2020 6966 2061 6767  ).        if agg
+0003ac10: 7265 6761 7465 5f6b 7761 7267 730a 2020  regate_kwargs.  
+0003ac20: 2020 2020 2020 656c 7365 2061 6767 7265        else aggre
+0003ac30: 6761 7465 2c0a 2020 2020 2020 2020 7370  gate,.        sp
+0003ac40: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+0003ac50: 6576 6572 792c 0a20 2020 2020 2020 2073  every,.        s
+0003ac60: 706c 6974 5f6f 7574 3d73 706c 6974 5f6f  plit_out=split_o
+0003ac70: 7574 2069 6620 2873 706c 6974 5f6f 7574  ut if (split_out
+0003ac80: 2061 6e64 2073 706c 6974 5f6f 7574 203e   and split_out >
+0003ac90: 2031 2920 656c 7365 204e 6f6e 652c 0a20   1) else None,. 
+0003aca0: 2020 2020 2020 2074 7265 655f 6e6f 6465         tree_node
+0003acb0: 5f6e 616d 653d 6622 7b74 6f6b 656e 206f  _name=f"{token o
+0003acc0: 7220 6675 6e63 6e61 6d65 2863 6f6d 6269  r funcname(combi
+0003acd0: 6e65 297d 2d63 6f6d 6269 6e65 2d7b 746f  ne)}-combine-{to
+0003ace0: 6b65 6e5f 6b65 797d 222c 0a20 2020 2029  ken_key}",.    )
+0003acf0: 0a0a 2020 2020 6966 206d 6574 6120 6973  ..    if meta is
+0003ad00: 206e 6f5f 6465 6661 756c 743a 0a20 2020   no_default:.   
+0003ad10: 2020 2020 206d 6574 615f 6368 756e 6b20       meta_chunk 
+0003ad20: 3d20 5f65 6d75 6c61 7465 2863 6875 6e6b  = _emulate(chunk
+0003ad30: 2c20 2a61 7267 732c 2075 6466 3d54 7275  , *args, udf=Tru
+0003ad40: 652c 202a 2a63 6875 6e6b 5f6b 7761 7267  e, **chunk_kwarg
+0003ad50: 7329 0a20 2020 2020 2020 206d 6574 6120  s).        meta 
+0003ad60: 3d20 5f65 6d75 6c61 7465 280a 2020 2020  = _emulate(.    
+0003ad70: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+0003ad80: 652c 205f 636f 6e63 6174 285b 6d65 7461  e, _concat([meta
+0003ad90: 5f63 6875 6e6b 5d2c 2069 676e 6f72 655f  _chunk], ignore_
+0003ada0: 696e 6465 7829 2c20 7564 663d 5472 7565  index), udf=True
+0003adb0: 2c20 2a2a 6167 6772 6567 6174 655f 6b77  , **aggregate_kw
+0003adc0: 6172 6773 0a20 2020 2020 2020 2029 0a20  args.        ). 
+0003add0: 2020 206d 6574 6120 3d20 6d61 6b65 5f6d     meta = make_m
+0003ade0: 6574 6128 0a20 2020 2020 2020 206d 6574  eta(.        met
+0003adf0: 612c 0a20 2020 2020 2020 2069 6e64 6578  a,.        index
+0003ae00: 3d28 6765 7461 7474 7228 6d61 6b65 5f6d  =(getattr(make_m
+0003ae10: 6574 6128 6466 735b 305d 292c 2022 696e  eta(dfs[0]), "in
+0003ae20: 6465 7822 2c20 4e6f 6e65 2920 6966 2064  dex", None) if d
+0003ae30: 6673 2065 6c73 6520 4e6f 6e65 292c 0a20  fs else None),. 
+0003ae40: 2020 2020 2020 2070 6172 656e 745f 6d65         parent_me
+0003ae50: 7461 3d64 6673 5b30 5d2e 5f6d 6574 612c  ta=dfs[0]._meta,
+0003ae60: 0a20 2020 2029 0a0a 2020 2020 6772 6170  .    )..    grap
+0003ae70: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
+0003ae80: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
+0003ae90: 6f6e 7328 6669 6e61 6c5f 6e61 6d65 2c20  ons(final_name, 
+0003aea0: 6c61 7965 722c 2064 6570 656e 6465 6e63  layer, dependenc
+0003aeb0: 6965 733d 2863 6875 6e6b 6564 2c29 290a  ies=(chunked,)).
+0003aec0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
+0003aed0: 5b4e 6f6e 655d 202a 2028 2873 706c 6974  [None] * ((split
+0003aee0: 5f6f 7574 206f 7220 3129 202b 2031 290a  _out or 1) + 1).
+0003aef0: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
+0003af00: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
+0003af10: 6669 6e61 6c5f 6e61 6d65 2c20 6d65 7461  final_name, meta
+0003af20: 2c20 6469 7669 7369 6f6e 732c 2070 6172  , divisions, par
+0003af30: 656e 745f 6d65 7461 3d64 6673 5b30 5d2e  ent_meta=dfs[0].
+0003af40: 5f6d 6574 6129 0a0a 0a61 6361 203d 2061  _meta)...aca = a
+0003af50: 7070 6c79 5f63 6f6e 6361 745f 6170 706c  pply_concat_appl
+0003af60: 790a 0a0a 6465 6620 5f65 7874 7261 6374  y...def _extract
+0003af70: 5f6d 6574 6128 782c 206e 6f6e 656d 7074  _meta(x, nonempt
+0003af80: 793d 4661 6c73 6529 3a0a 2020 2020 2222  y=False):.    ""
+0003af90: 220a 2020 2020 4578 7472 6163 7420 696e  ".    Extract in
+0003afa0: 7465 726e 616c 2063 6163 6865 2064 6174  ternal cache dat
+0003afb0: 6120 2860 605f 6d65 7461 6060 2920 6672  a (``_meta``) fr
+0003afc0: 6f6d 2064 642e 4461 7461 4672 616d 6520  om dd.DataFrame 
+0003afd0: 2f20 6464 2e53 6572 6965 730a 2020 2020  / dd.Series.    
+0003afe0: 2222 220a 2020 2020 6966 2069 7369 6e73  """.    if isins
+0003aff0: 7461 6e63 6528 782c 2028 5363 616c 6172  tance(x, (Scalar
+0003b000: 2c20 5f46 7261 6d65 2929 3a0a 2020 2020  , _Frame)):.    
+0003b010: 2020 2020 7265 7475 726e 2078 2e5f 6d65      return x._me
+0003b020: 7461 5f6e 6f6e 656d 7074 7920 6966 206e  ta_nonempty if n
+0003b030: 6f6e 656d 7074 7920 656c 7365 2078 2e5f  onempty else x._
+0003b040: 6d65 7461 0a20 2020 2065 6c69 6620 6973  meta.    elif is
+0003b050: 696e 7374 616e 6365 2878 2c20 6c69 7374  instance(x, list
+0003b060: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0003b070: 6e20 5b5f 6578 7472 6163 745f 6d65 7461  n [_extract_meta
+0003b080: 285f 782c 206e 6f6e 656d 7074 7929 2066  (_x, nonempty) f
+0003b090: 6f72 205f 7820 696e 2078 5d0a 2020 2020  or _x in x].    
+0003b0a0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+0003b0b0: 782c 2074 7570 6c65 293a 0a20 2020 2020  x, tuple):.     
+0003b0c0: 2020 2072 6574 7572 6e20 7475 706c 6528     return tuple(
+0003b0d0: 5f65 7874 7261 6374 5f6d 6574 6128 5f78  _extract_meta(_x
+0003b0e0: 2c20 6e6f 6e65 6d70 7479 2920 666f 7220  , nonempty) for 
+0003b0f0: 5f78 2069 6e20 7829 0a20 2020 2065 6c69  _x in x).    eli
+0003b100: 6620 6973 696e 7374 616e 6365 2878 2c20  f isinstance(x, 
+0003b110: 6469 6374 293a 0a20 2020 2020 2020 2072  dict):.        r
+0003b120: 6573 203d 207b 7d0a 2020 2020 2020 2020  es = {}.        
+0003b130: 666f 7220 6b20 696e 2078 3a0a 2020 2020  for k in x:.    
+0003b140: 2020 2020 2020 2020 7265 735b 6b5d 203d          res[k] =
+0003b150: 205f 6578 7472 6163 745f 6d65 7461 2878   _extract_meta(x
+0003b160: 5b6b 5d2c 206e 6f6e 656d 7074 7929 0a20  [k], nonempty). 
+0003b170: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+0003b180: 730a 2020 2020 656c 6966 2069 7369 6e73  s.    elif isins
+0003b190: 7461 6e63 6528 782c 2044 656c 6179 6564  tance(x, Delayed
+0003b1a0: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+0003b1b0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0003b1c0: 2020 2020 2020 2020 2022 4361 6e6e 6f74           "Cannot
+0003b1d0: 2069 6e66 6572 2064 6174 6166 7261 6d65   infer dataframe
+0003b1e0: 206d 6574 6164 6174 6120 7769 7468 2061   metadata with a
+0003b1f0: 2060 6461 736b 2e64 656c 6179 6564 6020   `dask.delayed` 
+0003b200: 6172 6775 6d65 6e74 220a 2020 2020 2020  argument".      
+0003b210: 2020 290a 2020 2020 656c 7365 3a0a 2020    ).    else:.  
+0003b220: 2020 2020 2020 7265 7475 726e 2078 0a0a        return x..
+0003b230: 0a64 6566 205f 656d 756c 6174 6528 6675  .def _emulate(fu
+0003b240: 6e63 2c20 2a61 7267 732c 2075 6466 3d46  nc, *args, udf=F
+0003b250: 616c 7365 2c20 2a2a 6b77 6172 6773 293a  alse, **kwargs):
+0003b260: 0a20 2020 2022 2222 0a20 2020 2041 7070  .    """.    App
+0003b270: 6c79 2061 2066 756e 6374 696f 6e20 7573  ly a function us
+0003b280: 696e 6720 6172 6773 202f 206b 7761 7267  ing args / kwarg
+0003b290: 732e 2049 6620 6172 6775 6d65 6e74 7320  s. If arguments 
+0003b2a0: 636f 6e74 6169 6e20 6464 2e44 6174 6146  contain dd.DataF
+0003b2b0: 7261 6d65 202f 0a20 2020 2064 642e 5365  rame /.    dd.Se
+0003b2c0: 7269 6573 2c20 7573 696e 6720 696e 7465  ries, using inte
+0003b2d0: 726e 616c 2063 6163 6865 2028 6060 5f6d  rnal cache (``_m
+0003b2e0: 6574 6160 6029 2066 6f72 2063 616c 6375  eta``) for calcu
+0003b2f0: 6c61 7469 6f6e 0a20 2020 2022 2222 0a20  lation.    """. 
+0003b300: 2020 2077 6974 6820 7261 6973 655f 6f6e     with raise_on
+0003b310: 5f6d 6574 615f 6572 726f 7228 6675 6e63  _meta_error(func
+0003b320: 6e61 6d65 2866 756e 6329 2c20 7564 663d  name(func), udf=
+0003b330: 7564 6629 2c20 6368 6563 6b5f 6e75 6d65  udf), check_nume
+0003b340: 7269 635f 6f6e 6c79 5f64 6570 7265 6361  ric_only_depreca
+0003b350: 7469 6f6e 2829 3a0a 2020 2020 2020 2020  tion():.        
+0003b360: 7265 7475 726e 2066 756e 6328 2a5f 6578  return func(*_ex
+0003b370: 7472 6163 745f 6d65 7461 2861 7267 732c  tract_meta(args,
+0003b380: 2054 7275 6529 2c20 2a2a 5f65 7874 7261   True), **_extra
+0003b390: 6374 5f6d 6574 6128 6b77 6172 6773 2c20  ct_meta(kwargs, 
+0003b3a0: 5472 7565 2929 0a0a 0a40 696e 7365 7274  True))...@insert
+0003b3b0: 5f6d 6574 615f 7061 7261 6d5f 6465 7363  _meta_param_desc
+0003b3c0: 7269 7074 696f 6e0a 6465 6620 6d61 705f  ription.def map_
+0003b3d0: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+0003b3e0: 6675 6e63 2c0a 2020 2020 2a61 7267 732c  func,.    *args,
+0003b3f0: 0a20 2020 206d 6574 613d 6e6f 5f64 6566  .    meta=no_def
+0003b400: 6175 6c74 2c0a 2020 2020 656e 666f 7263  ault,.    enforc
+0003b410: 655f 6d65 7461 6461 7461 3d54 7275 652c  e_metadata=True,
+0003b420: 0a20 2020 2074 7261 6e73 666f 726d 5f64  .    transform_d
+0003b430: 6976 6973 696f 6e73 3d54 7275 652c 0a20  ivisions=True,. 
+0003b440: 2020 2061 6c69 676e 5f64 6174 6166 7261     align_datafra
+0003b450: 6d65 733d 5472 7565 2c0a 2020 2020 2a2a  mes=True,.    **
+0003b460: 6b77 6172 6773 2c0a 293a 0a20 2020 2022  kwargs,.):.    "
+0003b470: 2222 4170 706c 7920 5079 7468 6f6e 2066  ""Apply Python f
+0003b480: 756e 6374 696f 6e20 6f6e 2065 6163 6820  unction on each 
+0003b490: 4461 7461 4672 616d 6520 7061 7274 6974  DataFrame partit
+0003b4a0: 696f 6e2e 0a0a 2020 2020 5061 7261 6d65  ion...    Parame
+0003b4b0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+0003b4c0: 2d2d 2d0a 2020 2020 6675 6e63 203a 2066  ---.    func : f
+0003b4d0: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
+0003b4e0: 4675 6e63 7469 6f6e 2061 7070 6c69 6564  Function applied
+0003b4f0: 2074 6f20 6561 6368 2070 6172 7469 7469   to each partiti
+0003b500: 6f6e 2e0a 2020 2020 6172 6773 2c20 6b77  on..    args, kw
+0003b510: 6172 6773 203a 0a20 2020 2020 2020 2041  args :.        A
+0003b520: 7267 756d 656e 7473 2061 6e64 206b 6579  rguments and key
+0003b530: 776f 7264 7320 746f 2070 6173 7320 746f  words to pass to
+0003b540: 2074 6865 2066 756e 6374 696f 6e2e 2020   the function.  
+0003b550: 4174 206c 6561 7374 206f 6e65 206f 6620  At least one of 
+0003b560: 7468 650a 2020 2020 2020 2020 6172 6773  the.        args
+0003b570: 2073 686f 756c 6420 6265 2061 2044 6173   should be a Das
+0003b580: 6b2e 6461 7461 6672 616d 652e 2041 7267  k.dataframe. Arg
+0003b590: 756d 656e 7473 2061 6e64 206b 6579 776f  uments and keywo
+0003b5a0: 7264 7320 6d61 7920 636f 6e74 6169 6e0a  rds may contain.
+0003b5b0: 2020 2020 2020 2020 6060 5363 616c 6172          ``Scalar
+0003b5c0: 6060 2c20 6060 4465 6c61 7965 6460 6020  ``, ``Delayed`` 
+0003b5d0: 6f72 2072 6567 756c 6172 2070 7974 686f  or regular pytho
+0003b5e0: 6e20 6f62 6a65 6374 732e 2044 6174 6146  n objects. DataF
+0003b5f0: 7261 6d65 2d6c 696b 6520 6172 6773 0a20  rame-like args. 
+0003b600: 2020 2020 2020 2028 626f 7468 2064 6173         (both das
+0003b610: 6b20 616e 6420 7061 6e64 6173 2920 7769  k and pandas) wi
+0003b620: 6c6c 2062 6520 7265 7061 7274 6974 696f  ll be repartitio
+0003b630: 6e65 6420 746f 2061 6c69 676e 2028 6966  ned to align (if
+0003b640: 206e 6563 6573 7361 7279 290a 2020 2020   necessary).    
+0003b650: 2020 2020 6265 666f 7265 2061 7070 6c79      before apply
+0003b660: 696e 6720 7468 6520 6675 6e63 7469 6f6e  ing the function
+0003b670: 2028 7365 6520 6060 616c 6967 6e5f 6461   (see ``align_da
+0003b680: 7461 6672 616d 6573 6060 2074 6f20 636f  taframes`` to co
+0003b690: 6e74 726f 6c29 2e0a 2020 2020 656e 666f  ntrol)..    enfo
+0003b6a0: 7263 655f 6d65 7461 6461 7461 203a 2062  rce_metadata : b
+0003b6b0: 6f6f 6c2c 2064 6566 6175 6c74 2054 7275  ool, default Tru
+0003b6c0: 650a 2020 2020 2020 2020 5768 6574 6865  e.        Whethe
+0003b6d0: 7220 746f 2065 6e66 6f72 6365 2061 7420  r to enforce at 
+0003b6e0: 7275 6e74 696d 6520 7468 6174 2074 6865  runtime that the
+0003b6f0: 2073 7472 7563 7475 7265 206f 6620 7468   structure of th
+0003b700: 6520 4461 7461 4672 616d 650a 2020 2020  e DataFrame.    
+0003b710: 2020 2020 7072 6f64 7563 6564 2062 7920      produced by 
+0003b720: 6060 6675 6e63 6060 2061 6374 7561 6c6c  ``func`` actuall
+0003b730: 7920 6d61 7463 6865 7320 7468 6520 7374  y matches the st
+0003b740: 7275 6374 7572 6520 6f66 2060 606d 6574  ructure of ``met
+0003b750: 6160 602e 0a20 2020 2020 2020 2054 6869  a``..        Thi
+0003b760: 7320 7769 6c6c 2072 656e 616d 6520 616e  s will rename an
+0003b770: 6420 7265 6f72 6465 7220 636f 6c75 6d6e  d reorder column
+0003b780: 7320 666f 7220 6561 6368 2070 6172 7469  s for each parti
+0003b790: 7469 6f6e 2c0a 2020 2020 2020 2020 616e  tion,.        an
+0003b7a0: 6420 7769 6c6c 2072 6169 7365 2061 6e20  d will raise an 
+0003b7b0: 6572 726f 7220 6966 2074 6869 7320 646f  error if this do
+0003b7c0: 6573 6e27 7420 776f 726b 2c0a 2020 2020  esn't work,.    
+0003b7d0: 2020 2020 6275 7420 6974 2077 6f6e 2774      but it won't
+0003b7e0: 2072 6169 7365 2069 6620 6474 7970 6573   raise if dtypes
+0003b7f0: 2064 6f6e 2774 206d 6174 6368 2e0a 2020   don't match..  
+0003b800: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
+0003b810: 7369 6f6e 7320 3a20 626f 6f6c 2c20 6465  sions : bool, de
+0003b820: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
+0003b830: 2020 2057 6865 7468 6572 2074 6f20 6170     Whether to ap
+0003b840: 706c 7920 7468 6520 6675 6e63 7469 6f6e  ply the function
+0003b850: 206f 6e74 6f20 7468 6520 6469 7669 7369   onto the divisi
+0003b860: 6f6e 7320 616e 6420 6170 706c 7920 7468  ons and apply th
+0003b870: 6f73 650a 2020 2020 2020 2020 7472 616e  ose.        tran
+0003b880: 7366 6f72 6d65 6420 6469 7669 7369 6f6e  sformed division
+0003b890: 7320 746f 2074 6865 206f 7574 7075 742e  s to the output.
+0003b8a0: 0a20 2020 2061 6c69 676e 5f64 6174 6166  .    align_dataf
+0003b8b0: 7261 6d65 7320 3a20 626f 6f6c 2c20 6465  rames : bool, de
+0003b8c0: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
+0003b8d0: 2020 2057 6865 7468 6572 2074 6f20 7265     Whether to re
+0003b8e0: 7061 7274 6974 696f 6e20 4461 7461 4672  partition DataFr
+0003b8f0: 616d 652d 206f 7220 5365 7269 6573 2d6c  ame- or Series-l
+0003b900: 696b 6520 6172 6773 0a20 2020 2020 2020  ike args.       
+0003b910: 2028 626f 7468 2064 6173 6b20 616e 6420   (both dask and 
+0003b920: 7061 6e64 6173 2920 736f 2074 6865 6972  pandas) so their
+0003b930: 2064 6976 6973 696f 6e73 2061 6c69 676e   divisions align
+0003b940: 2062 6566 6f72 6520 6170 706c 7969 6e67   before applying
+0003b950: 0a20 2020 2020 2020 2074 6865 2066 756e  .        the fun
+0003b960: 6374 696f 6e2e 2054 6869 7320 7265 7175  ction. This requ
+0003b970: 6972 6573 2061 6c6c 2069 6e70 7574 7320  ires all inputs 
+0003b980: 746f 2068 6176 6520 6b6e 6f77 6e20 6469  to have known di
+0003b990: 7669 7369 6f6e 732e 0a20 2020 2020 2020  visions..       
+0003b9a0: 2053 696e 676c 652d 7061 7274 6974 696f   Single-partitio
+0003b9b0: 6e20 696e 7075 7473 2077 696c 6c20 6265  n inputs will be
+0003b9c0: 2073 706c 6974 2069 6e74 6f20 6d75 6c74   split into mult
+0003b9d0: 6970 6c65 2070 6172 7469 7469 6f6e 732e  iple partitions.
+0003b9e0: 0a0a 2020 2020 2020 2020 4966 2046 616c  ..        If Fal
+0003b9f0: 7365 2c20 616c 6c20 696e 7075 7473 206d  se, all inputs m
+0003ba00: 7573 7420 6861 7665 2065 6974 6865 7220  ust have either 
+0003ba10: 7468 6520 7361 6d65 206e 756d 6265 7220  the same number 
+0003ba20: 6f66 2070 6172 7469 7469 6f6e 730a 2020  of partitions.  
+0003ba30: 2020 2020 2020 6f72 2061 2073 696e 676c        or a singl
+0003ba40: 6520 7061 7274 6974 696f 6e2e 2053 696e  e partition. Sin
+0003ba50: 676c 652d 7061 7274 6974 696f 6e20 696e  gle-partition in
+0003ba60: 7075 7473 2077 696c 6c20 6265 2062 726f  puts will be bro
+0003ba70: 6164 6361 7374 2074 6f0a 2020 2020 2020  adcast to.      
+0003ba80: 2020 6576 6572 7920 7061 7274 6974 696f    every partitio
+0003ba90: 6e20 6f66 206d 756c 7469 2d70 6172 7469  n of multi-parti
+0003baa0: 7469 6f6e 2069 6e70 7574 732e 0a20 2020  tion inputs..   
+0003bab0: 2024 4d45 5441 0a20 2020 2022 2222 0a20   $META.    """. 
+0003bac0: 2020 206e 616d 6520 3d20 6b77 6172 6773     name = kwargs
+0003bad0: 2e70 6f70 2822 746f 6b65 6e22 2c20 4e6f  .pop("token", No
+0003bae0: 6e65 290a 2020 2020 7061 7265 6e74 5f6d  ne).    parent_m
+0003baf0: 6574 6120 3d20 6b77 6172 6773 2e70 6f70  eta = kwargs.pop
+0003bb00: 2822 7061 7265 6e74 5f6d 6574 6122 2c20  ("parent_meta", 
+0003bb10: 4e6f 6e65 290a 0a20 2020 2061 7373 6572  None)..    asser
+0003bb20: 7420 6361 6c6c 6162 6c65 2866 756e 6329  t callable(func)
+0003bb30: 0a20 2020 2069 6620 6e61 6d65 2069 7320  .    if name is 
+0003bb40: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0003bb50: 2020 746f 6b65 6e20 3d20 746f 6b65 6e69    token = tokeni
+0003bb60: 7a65 286d 6574 612c 202a 6172 6773 2c20  ze(meta, *args, 
+0003bb70: 2a2a 6b77 6172 6773 290a 2020 2020 656c  **kwargs).    el
+0003bb80: 7365 3a0a 2020 2020 2020 2020 6e61 6d65  se:.        name
+0003bb90: 203d 2066 756e 636e 616d 6528 6675 6e63   = funcname(func
+0003bba0: 290a 2020 2020 2020 2020 746f 6b65 6e20  ).        token 
+0003bbb0: 3d20 746f 6b65 6e69 7a65 2866 756e 632c  = tokenize(func,
+0003bbc0: 206d 6574 612c 202a 6172 6773 2c20 2a2a   meta, *args, **
+0003bbd0: 6b77 6172 6773 290a 2020 2020 6e61 6d65  kwargs).    name
+0003bbe0: 203d 2066 227b 6e61 6d65 7d2d 7b74 6f6b   = f"{name}-{tok
+0003bbf0: 656e 7d22 0a0a 2020 2020 6672 6f6d 2064  en}"..    from d
+0003bc00: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
+0003bc10: 6c74 6920 696d 706f 7274 205f 6d61 7962  lti import _mayb
+0003bc20: 655f 616c 6967 6e5f 7061 7274 6974 696f  e_align_partitio
+0003bc30: 6e73 0a0a 2020 2020 6966 2061 6c69 676e  ns..    if align
+0003bc40: 5f64 6174 6166 7261 6d65 733a 0a20 2020  _dataframes:.   
+0003bc50: 2020 2020 2061 7267 7320 3d20 5f6d 6179       args = _may
+0003bc60: 6265 5f66 726f 6d5f 7061 6e64 6173 2861  be_from_pandas(a
+0003bc70: 7267 7329 0a20 2020 2020 2020 2074 7279  rgs).        try
+0003bc80: 3a0a 2020 2020 2020 2020 2020 2020 6172  :.            ar
+0003bc90: 6773 203d 205f 6d61 7962 655f 616c 6967  gs = _maybe_alig
+0003bca0: 6e5f 7061 7274 6974 696f 6e73 2861 7267  n_partitions(arg
+0003bcb0: 7329 0a20 2020 2020 2020 2065 7863 6570  s).        excep
+0003bcc0: 7420 5661 6c75 6545 7272 6f72 2061 7320  t ValueError as 
+0003bcd0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0003bce0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0003bcf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003bd00: 2066 227b 657d 2e20 4966 2079 6f75 2064   f"{e}. If you d
+0003bd10: 6f6e 2774 2077 616e 7420 7468 6520 7061  on't want the pa
+0003bd20: 7274 6974 696f 6e73 2074 6f20 6265 2061  rtitions to be a
+0003bd30: 6c69 676e 6564 2c20 616e 6420 6172 6520  ligned, and are 
+0003bd40: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0003bd50: 2020 2263 616c 6c69 6e67 2060 6d61 705f    "calling `map_
+0003bd60: 7061 7274 6974 696f 6e73 6020 6469 7265  partitions` dire
+0003bd70: 6374 6c79 2c20 7061 7373 2060 616c 6967  ctly, pass `alig
+0003bd80: 6e5f 6461 7461 6672 616d 6573 3d46 616c  n_dataframes=Fal
+0003bd90: 7365 602e 220a 2020 2020 2020 2020 2020  se`.".          
+0003bda0: 2020 2920 6672 6f6d 2065 0a0a 2020 2020    ) from e..    
+0003bdb0: 6466 7320 3d20 5b64 6620 666f 7220 6466  dfs = [df for df
+0003bdc0: 2069 6e20 6172 6773 2069 6620 6973 696e   in args if isin
+0003bdd0: 7374 616e 6365 2864 662c 205f 4672 616d  stance(df, _Fram
+0003bde0: 6529 5d0a 0a20 2020 206d 6574 6120 3d20  e)]..    meta = 
+0003bdf0: 5f67 6574 5f6d 6574 615f 6d61 705f 7061  _get_meta_map_pa
+0003be00: 7274 6974 696f 6e73 2861 7267 732c 2064  rtitions(args, d
+0003be10: 6673 2c20 6675 6e63 2c20 6b77 6172 6773  fs, func, kwargs
+0003be20: 2c20 6d65 7461 2c20 7061 7265 6e74 5f6d  , meta, parent_m
+0003be30: 6574 6129 0a20 2020 2069 6620 616c 6c28  eta).    if all(
+0003be40: 6973 696e 7374 616e 6365 2861 7267 2c20  isinstance(arg, 
+0003be50: 5363 616c 6172 2920 666f 7220 6172 6720  Scalar) for arg 
+0003be60: 696e 2061 7267 7329 3a0a 2020 2020 2020  in args):.      
+0003be70: 2020 6c61 7965 7220 3d20 7b0a 2020 2020    layer = {.    
+0003be80: 2020 2020 2020 2020 286e 616d 652c 2030          (name, 0
+0003be90: 293a 2028 0a20 2020 2020 2020 2020 2020  ): (.           
+0003bea0: 2020 2020 2061 7070 6c79 2c0a 2020 2020       apply,.    
+0003beb0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+0003bec0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003bed0: 2020 2874 7570 6c65 2c20 5b28 6172 672e    (tuple, [(arg.
+0003bee0: 5f6e 616d 652c 2030 2920 666f 7220 6172  _name, 0) for ar
+0003bef0: 6720 696e 2061 7267 735d 292c 0a20 2020  g in args]),.   
+0003bf00: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
+0003bf10: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+0003bf20: 2029 0a20 2020 2020 2020 207d 0a20 2020   ).        }.   
+0003bf30: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+0003bf40: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+0003bf50: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+0003bf60: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
+0003bf70: 656e 6369 6573 3d61 7267 7329 0a20 2020  encies=args).   
+0003bf80: 2020 2020 2072 6574 7572 6e20 5363 616c       return Scal
+0003bf90: 6172 2867 7261 7068 2c20 6e61 6d65 2c20  ar(graph, name, 
+0003bfa0: 6d65 7461 290a 0a20 2020 2061 7267 7332  meta)..    args2
+0003bfb0: 203d 205b 5d0a 2020 2020 6465 7065 6e64   = [].    depend
+0003bfc0: 656e 6369 6573 203d 205b 5d0a 2020 2020  encies = [].    
+0003bfd0: 666f 7220 6172 6720 696e 2061 7267 733a  for arg in args:
+0003bfe0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0003bff0: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
+0003c000: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
+0003c010: 2061 7267 7332 2e61 7070 656e 6428 6172   args2.append(ar
+0003c020: 6729 0a20 2020 2020 2020 2020 2020 2064  g).            d
+0003c030: 6570 656e 6465 6e63 6965 732e 6170 7065  ependencies.appe
+0003c040: 6e64 2861 7267 290a 2020 2020 2020 2020  nd(arg).        
+0003c050: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
+0003c060: 2020 2020 2061 7267 203d 206e 6f72 6d61       arg = norma
+0003c070: 6c69 7a65 5f61 7267 2861 7267 290a 2020  lize_arg(arg).  
+0003c080: 2020 2020 2020 6172 6732 2c20 636f 6c6c        arg2, coll
+0003c090: 6563 7469 6f6e 7320 3d20 756e 7061 636b  ections = unpack
+0003c0a0: 5f63 6f6c 6c65 6374 696f 6e73 2861 7267  _collections(arg
+0003c0b0: 290a 2020 2020 2020 2020 6966 2063 6f6c  ).        if col
+0003c0c0: 6c65 6374 696f 6e73 3a0a 2020 2020 2020  lections:.      
+0003c0d0: 2020 2020 2020 6172 6773 322e 6170 7065        args2.appe
+0003c0e0: 6e64 2861 7267 3229 0a20 2020 2020 2020  nd(arg2).       
+0003c0f0: 2020 2020 2064 6570 656e 6465 6e63 6965       dependencie
+0003c100: 732e 6578 7465 6e64 2863 6f6c 6c65 6374  s.extend(collect
+0003c110: 696f 6e73 290a 2020 2020 2020 2020 656c  ions).        el
+0003c120: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003c130: 6172 6773 322e 6170 7065 6e64 2861 7267  args2.append(arg
+0003c140: 290a 0a20 2020 206b 7761 7267 7333 203d  )..    kwargs3 =
+0003c150: 207b 7d0a 2020 2020 7369 6d70 6c65 203d   {}.    simple =
+0003c160: 2054 7275 650a 2020 2020 666f 7220 6b2c   True.    for k,
+0003c170: 2076 2069 6e20 6b77 6172 6773 2e69 7465   v in kwargs.ite
+0003c180: 6d73 2829 3a0a 2020 2020 2020 2020 7620  ms():.        v 
+0003c190: 3d20 6e6f 726d 616c 697a 655f 6172 6728  = normalize_arg(
+0003c1a0: 7629 0a20 2020 2020 2020 2076 2c20 636f  v).        v, co
+0003c1b0: 6c6c 6563 7469 6f6e 7320 3d20 756e 7061  llections = unpa
+0003c1c0: 636b 5f63 6f6c 6c65 6374 696f 6e73 2876  ck_collections(v
+0003c1d0: 290a 2020 2020 2020 2020 6465 7065 6e64  ).        depend
+0003c1e0: 656e 6369 6573 2e65 7874 656e 6428 636f  encies.extend(co
+0003c1f0: 6c6c 6563 7469 6f6e 7329 0a20 2020 2020  llections).     
+0003c200: 2020 206b 7761 7267 7333 5b6b 5d20 3d20     kwargs3[k] = 
+0003c210: 760a 2020 2020 2020 2020 6966 2063 6f6c  v.        if col
+0003c220: 6c65 6374 696f 6e73 3a0a 2020 2020 2020  lections:.      
+0003c230: 2020 2020 2020 7369 6d70 6c65 203d 2046        simple = F
+0003c240: 616c 7365 0a0a 2020 2020 6469 7669 7369  alse..    divisi
+0003c250: 6f6e 7320 3d20 5f67 6574 5f64 6976 6973  ons = _get_divis
+0003c260: 696f 6e73 5f6d 6170 5f70 6172 7469 7469  ions_map_partiti
+0003c270: 6f6e 7328 0a20 2020 2020 2020 2061 6c69  ons(.        ali
+0003c280: 676e 5f64 6174 6166 7261 6d65 732c 2074  gn_dataframes, t
+0003c290: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
+0003c2a0: 6e73 2c20 6466 732c 2066 756e 632c 2061  ns, dfs, func, a
+0003c2b0: 7267 732c 206b 7761 7267 730a 2020 2020  rgs, kwargs.    
+0003c2c0: 290a 0a20 2020 2069 6620 6861 735f 6b65  )..    if has_ke
+0003c2d0: 7977 6f72 6428 6675 6e63 2c20 2270 6172  yword(func, "par
+0003c2e0: 7469 7469 6f6e 5f69 6e66 6f22 293a 0a20  tition_info"):. 
+0003c2f0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+0003c300: 5f69 6e66 6f20 3d20 7b0a 2020 2020 2020  _info = {.      
+0003c310: 2020 2020 2020 2869 2c29 3a20 7b22 6e75        (i,): {"nu
+0003c320: 6d62 6572 223a 2069 2c20 2264 6976 6973  mber": i, "divis
+0003c330: 696f 6e22 3a20 6469 7669 7369 6f6e 7d0a  ion": division}.
+0003c340: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0003c350: 692c 2064 6976 6973 696f 6e20 696e 2065  i, division in e
+0003c360: 6e75 6d65 7261 7465 2864 6976 6973 696f  numerate(divisio
+0003c370: 6e73 5b3a 2d31 5d29 0a20 2020 2020 2020  ns[:-1]).       
+0003c380: 207d 0a0a 2020 2020 2020 2020 6172 6773   }..        args
+0003c390: 322e 696e 7365 7274 2830 2c20 426c 6f63  2.insert(0, Bloc
+0003c3a0: 6b77 6973 6544 6570 4469 6374 2870 6172  kwiseDepDict(par
+0003c3b0: 7469 7469 6f6e 5f69 6e66 6f29 290a 2020  tition_info)).  
+0003c3c0: 2020 2020 2020 6f72 6967 5f66 756e 6320        orig_func 
+0003c3d0: 3d20 6675 6e63 0a0a 2020 2020 2020 2020  = func..        
+0003c3e0: 6465 6620 6675 6e63 2870 6172 7469 7469  def func(partiti
+0003c3f0: 6f6e 5f69 6e66 6f2c 202a 6172 6773 2c20  on_info, *args, 
+0003c400: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+0003c410: 2020 2020 2020 2072 6574 7572 6e20 6f72         return or
+0003c420: 6967 5f66 756e 6328 2a61 7267 732c 202a  ig_func(*args, *
+0003c430: 2a6b 7761 7267 732c 2070 6172 7469 7469  *kwargs, partiti
+0003c440: 6f6e 5f69 6e66 6f3d 7061 7274 6974 696f  on_info=partitio
+0003c450: 6e5f 696e 666f 290a 0a20 2020 2069 6620  n_info)..    if 
+0003c460: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+0003c470: 3a0a 2020 2020 2020 2020 6473 6b20 3d20  :.        dsk = 
+0003c480: 7061 7274 6974 696f 6e77 6973 655f 6772  partitionwise_gr
+0003c490: 6170 6828 0a20 2020 2020 2020 2020 2020  aph(.           
+0003c4a0: 2061 7070 6c79 5f61 6e64 5f65 6e66 6f72   apply_and_enfor
+0003c4b0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
+0003c4c0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+0003c4d0: 2020 2a61 7267 7332 2c0a 2020 2020 2020    *args2,.      
+0003c4e0: 2020 2020 2020 6465 7065 6e64 656e 6369        dependenci
+0003c4f0: 6573 3d64 6570 656e 6465 6e63 6965 732c  es=dependencies,
+0003c500: 0a20 2020 2020 2020 2020 2020 205f 6675  .            _fu
+0003c510: 6e63 3d66 756e 632c 0a20 2020 2020 2020  nc=func,.       
+0003c520: 2020 2020 205f 6d65 7461 3d6d 6574 612c       _meta=meta,
+0003c530: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
+0003c540: 7761 7267 7333 2c0a 2020 2020 2020 2020  wargs3,.        
+0003c550: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+0003c560: 2020 2020 6b77 6172 6773 3420 3d20 6b77      kwargs4 = kw
+0003c570: 6172 6773 2069 6620 7369 6d70 6c65 2065  args if simple e
+0003c580: 6c73 6520 6b77 6172 6773 330a 2020 2020  lse kwargs3.    
+0003c590: 2020 2020 6473 6b20 3d20 7061 7274 6974      dsk = partit
+0003c5a0: 696f 6e77 6973 655f 6772 6170 6828 0a20  ionwise_graph(. 
+0003c5b0: 2020 2020 2020 2020 2020 2066 756e 632c             func,
+0003c5c0: 206e 616d 652c 202a 6172 6773 322c 202a   name, *args2, *
+0003c5d0: 2a6b 7761 7267 7334 2c20 6465 7065 6e64  *kwargs4, depend
+0003c5e0: 656e 6369 6573 3d64 6570 656e 6465 6e63  encies=dependenc
+0003c5f0: 6965 730a 2020 2020 2020 2020 290a 0a20  ies.        ).. 
+0003c600: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+0003c610: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+0003c620: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
+0003c630: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+0003c640: 6573 3d64 6570 656e 6465 6e63 6965 7329  es=dependencies)
+0003c650: 0a20 2020 2072 6574 7572 6e20 6e65 775f  .    return new_
+0003c660: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
+0003c670: 206e 616d 652c 206d 6574 612c 2064 6976   name, meta, div
+0003c680: 6973 696f 6e73 290a 0a0a 6465 6620 5f67  isions)...def _g
+0003c690: 6574 5f64 6976 6973 696f 6e73 5f6d 6170  et_divisions_map
+0003c6a0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+0003c6b0: 2061 6c69 676e 5f64 6174 6166 7261 6d65   align_dataframe
+0003c6c0: 732c 2074 7261 6e73 666f 726d 5f64 6976  s, transform_div
+0003c6d0: 6973 696f 6e73 2c20 6466 732c 2066 756e  isions, dfs, fun
+0003c6e0: 632c 2061 7267 732c 206b 7761 7267 730a  c, args, kwargs.
+0003c6f0: 293a 0a20 2020 2022 2222 0a20 2020 2048  ):.    """.    H
+0003c700: 656c 7065 7220 746f 2067 6574 2064 6976  elper to get div
+0003c710: 6973 696f 6e73 2066 6f72 206d 6170 5f70  isions for map_p
+0003c720: 6172 7469 7469 6f6e 7320 616e 6420 6d61  artitions and ma
+0003c730: 705f 6f76 6572 6c61 7020 6f75 7470 7574  p_overlap output
+0003c740: 2e0a 2020 2020 2222 220a 2020 2020 6966  ..    """.    if
+0003c750: 2061 6c69 676e 5f64 6174 6166 7261 6d65   align_dataframe
+0003c760: 733a 0a20 2020 2020 2020 2064 6976 6973  s:.        divis
+0003c770: 696f 6e73 203d 2064 6673 5b30 5d2e 6469  ions = dfs[0].di
+0003c780: 7669 7369 6f6e 730a 2020 2020 656c 7365  visions.    else
+0003c790: 3a0a 2020 2020 2020 2020 2320 556e 616c  :.        # Unal
+0003c7a0: 6967 6e65 642c 2064 6673 2069 7320 6120  igned, dfs is a 
+0003c7b0: 6d69 7820 6f66 2031 2070 6172 7469 7469  mix of 1 partiti
+0003c7c0: 6f6e 2061 6e64 2031 2b20 7061 7274 6974  on and 1+ partit
+0003c7d0: 696f 6e20 6461 7461 6672 616d 6573 2c0a  ion dataframes,.
+0003c7e0: 2020 2020 2020 2020 2320 7573 6520 6c6f          # use lo
+0003c7f0: 6e67 6573 7420 6469 7669 7369 6f6e 7320  ngest divisions 
+0003c800: 666f 756e 640a 2020 2020 2020 2020 6469  found.        di
+0003c810: 7669 7369 6f6e 7320 3d20 6d61 7828 2864  visions = max((d
+0003c820: 2e64 6976 6973 696f 6e73 2066 6f72 2064  .divisions for d
+0003c830: 2069 6e20 6466 7329 2c20 6b65 793d 6c65   in dfs), key=le
+0003c840: 6e29 0a20 2020 2069 6620 7472 616e 7366  n).    if transf
+0003c850: 6f72 6d5f 6469 7669 7369 6f6e 7320 616e  orm_divisions an
+0003c860: 6420 6973 696e 7374 616e 6365 2864 6673  d isinstance(dfs
+0003c870: 5b30 5d2c 2049 6e64 6578 2920 616e 6420  [0], Index) and 
+0003c880: 6c65 6e28 6466 7329 203d 3d20 313a 0a20  len(dfs) == 1:. 
+0003c890: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0003c8a0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+0003c8b0: 7320 3d20 6675 6e63 280a 2020 2020 2020  s = func(.      
+0003c8c0: 2020 2020 2020 2020 2020 2a5b 7064 2e49            *[pd.I
+0003c8d0: 6e64 6578 2861 2e64 6976 6973 696f 6e73  ndex(a.divisions
+0003c8e0: 2920 6966 2061 2069 7320 6466 735b 305d  ) if a is dfs[0]
+0003c8f0: 2065 6c73 6520 6120 666f 7220 6120 696e   else a for a in
+0003c900: 2061 7267 735d 2c20 2a2a 6b77 6172 6773   args], **kwargs
+0003c910: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0003c920: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+0003c930: 696e 7374 616e 6365 2864 6976 6973 696f  instance(divisio
+0003c940: 6e73 2c20 7064 2e49 6e64 6578 293a 0a20  ns, pd.Index):. 
+0003c950: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0003c960: 6976 6973 696f 6e73 203d 206d 6574 686f  ivisions = metho
+0003c970: 6473 2e74 6f6c 6973 7428 6469 7669 7369  ds.tolist(divisi
+0003c980: 6f6e 7329 0a20 2020 2020 2020 2065 7863  ons).        exc
+0003c990: 6570 7420 4578 6365 7074 696f 6e3a 0a20  ept Exception:. 
+0003c9a0: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+0003c9b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0003c9c0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0003c9d0: 2076 616c 6964 5f64 6976 6973 696f 6e73   valid_divisions
+0003c9e0: 2864 6976 6973 696f 6e73 293a 0a20 2020  (divisions):.   
+0003c9f0: 2020 2020 2020 2020 2020 2020 2064 6976               div
+0003ca00: 6973 696f 6e73 203d 205b 4e6f 6e65 5d20  isions = [None] 
+0003ca10: 2a20 2864 6673 5b30 5d2e 6e70 6172 7469  * (dfs[0].nparti
+0003ca20: 7469 6f6e 7320 2b20 3129 0a20 2020 2072  tions + 1).    r
+0003ca30: 6574 7572 6e20 6469 7669 7369 6f6e 730a  eturn divisions.
+0003ca40: 0a0a 6465 6620 5f67 6574 5f6d 6574 615f  ..def _get_meta_
+0003ca50: 6d61 705f 7061 7274 6974 696f 6e73 2861  map_partitions(a
+0003ca60: 7267 732c 2064 6673 2c20 6675 6e63 2c20  rgs, dfs, func, 
+0003ca70: 6b77 6172 6773 2c20 6d65 7461 2c20 7061  kwargs, meta, pa
+0003ca80: 7265 6e74 5f6d 6574 6129 3a0a 2020 2020  rent_meta):.    
+0003ca90: 2222 220a 2020 2020 4865 6c70 6572 2074  """.    Helper t
+0003caa0: 6f20 6765 6e65 7261 7465 206d 6574 6164  o generate metad
+0003cab0: 6174 6120 666f 7220 6d61 705f 7061 7274  ata for map_part
+0003cac0: 6974 696f 6e73 2061 6e64 206d 6170 5f6f  itions and map_o
+0003cad0: 7665 726c 6170 206f 7574 7075 742e 0a20  verlap output.. 
+0003cae0: 2020 2022 2222 0a20 2020 206d 6574 615f     """.    meta_
+0003caf0: 696e 6465 7820 3d20 6765 7461 7474 7228  index = getattr(
+0003cb00: 6d61 6b65 5f6d 6574 6128 6466 735b 305d  make_meta(dfs[0]
+0003cb10: 292c 2022 696e 6465 7822 2c20 4e6f 6e65  ), "index", None
+0003cb20: 2920 6966 2064 6673 2065 6c73 6520 4e6f  ) if dfs else No
+0003cb30: 6e65 0a20 2020 2069 6620 7061 7265 6e74  ne.    if parent
+0003cb40: 5f6d 6574 6120 6973 204e 6f6e 6520 616e  _meta is None an
+0003cb50: 6420 6466 733a 0a20 2020 2020 2020 2070  d dfs:.        p
+0003cb60: 6172 656e 745f 6d65 7461 203d 2064 6673  arent_meta = dfs
+0003cb70: 5b30 5d2e 5f6d 6574 610a 2020 2020 6966  [0]._meta.    if
+0003cb80: 206d 6574 6120 6973 206e 6f5f 6465 6661   meta is no_defa
+0003cb90: 756c 743a 0a20 2020 2020 2020 2023 2055  ult:.        # U
+0003cba0: 7365 206e 6f6e 2d6e 6f72 6d61 6c69 7a65  se non-normalize
+0003cbb0: 6420 6b77 6172 6773 2068 6572 652c 2061  d kwargs here, a
+0003cbc0: 7320 7765 2077 616e 7420 7468 6520 7265  s we want the re
+0003cbd0: 616c 2076 616c 7565 7320 286e 6f74 0a20  al values (not. 
+0003cbe0: 2020 2020 2020 2023 2064 656c 6179 6564         # delayed
+0003cbf0: 2076 616c 7565 7329 0a20 2020 2020 2020   values).       
+0003cc00: 206d 6574 6120 3d20 5f65 6d75 6c61 7465   meta = _emulate
+0003cc10: 2866 756e 632c 202a 6172 6773 2c20 7564  (func, *args, ud
+0003cc20: 663d 5472 7565 2c20 2a2a 6b77 6172 6773  f=True, **kwargs
+0003cc30: 290a 2020 2020 2020 2020 6d65 7461 5f69  ).        meta_i
+0003cc40: 735f 656d 756c 6174 6564 203d 2054 7275  s_emulated = Tru
+0003cc50: 650a 2020 2020 656c 7365 3a0a 2020 2020  e.    else:.    
+0003cc60: 2020 2020 6d65 7461 203d 206d 616b 655f      meta = make_
+0003cc70: 6d65 7461 286d 6574 612c 2069 6e64 6578  meta(meta, index
+0003cc80: 3d6d 6574 615f 696e 6465 782c 2070 6172  =meta_index, par
+0003cc90: 656e 745f 6d65 7461 3d70 6172 656e 745f  ent_meta=parent_
+0003cca0: 6d65 7461 290a 2020 2020 2020 2020 6d65  meta).        me
+0003ccb0: 7461 5f69 735f 656d 756c 6174 6564 203d  ta_is_emulated =
+0003ccc0: 2046 616c 7365 0a0a 2020 2020 6966 206e   False..    if n
+0003ccd0: 6f74 2028 6861 735f 7061 7261 6c6c 656c  ot (has_parallel
+0003cce0: 5f74 7970 6528 6d65 7461 2920 6f72 2069  _type(meta) or i
+0003ccf0: 735f 6172 7261 796c 696b 6528 6d65 7461  s_arraylike(meta
+0003cd00: 2920 616e 6420 6d65 7461 2e73 6861 7065  ) and meta.shape
+0003cd10: 2920 616e 6420 6e6f 7420 616c 6c28 0a20  ) and not all(. 
+0003cd20: 2020 2020 2020 2069 7369 6e73 7461 6e63         isinstanc
+0003cd30: 6528 6172 672c 2053 6361 6c61 7229 2066  e(arg, Scalar) f
+0003cd40: 6f72 2061 7267 2069 6e20 6172 6773 0a20  or arg in args. 
+0003cd50: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
+0003cd60: 206e 6f74 206d 6574 615f 6973 5f65 6d75   not meta_is_emu
+0003cd70: 6c61 7465 643a 0a20 2020 2020 2020 2020  lated:.         
+0003cd80: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+0003cd90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003cda0: 2020 224d 6574 6120 6973 206e 6f74 2076    "Meta is not v
+0003cdb0: 616c 6964 2c20 606d 6170 5f70 6172 7469  alid, `map_parti
+0003cdc0: 7469 6f6e 7360 2061 6e64 2060 6d61 705f  tions` and `map_
+0003cdd0: 6f76 6572 6c61 7060 2065 7870 6563 7473  overlap` expects
+0003cde0: 206f 7574 7075 7420 746f 2062 6520 6120   output to be a 
+0003cdf0: 7061 6e64 6173 206f 626a 6563 742e 2022  pandas object. "
+0003ce00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003ce10: 2022 5472 7920 7061 7373 696e 6720 6120   "Try passing a 
+0003ce20: 7061 6e64 6173 206f 626a 6563 7420 6173  pandas object as
+0003ce30: 206d 6574 6120 6f72 2061 2064 6963 7420   meta or a dict 
+0003ce40: 6f72 2074 7570 6c65 2072 6570 7265 7365  or tuple represe
+0003ce50: 6e74 696e 6720 7468 6520 220a 2020 2020  nting the ".    
+0003ce60: 2020 2020 2020 2020 2020 2020 2228 6e61              "(na
+0003ce70: 6d65 2c20 6474 7970 6529 206f 6620 7468  me, dtype) of th
+0003ce80: 6520 636f 6c75 6d6e 732e 2049 6e20 7468  e columns. In th
+0003ce90: 6520 6675 7475 7265 2074 6865 206d 6574  e future the met
+0003cea0: 6120 796f 7520 7061 7373 6564 2077 696c  a you passed wil
+0003ceb0: 6c20 6e6f 7420 776f 726b 2e22 2c0a 2020  l not work.",.  
+0003cec0: 2020 2020 2020 2020 2020 2020 2020 4675                Fu
+0003ced0: 7475 7265 5761 726e 696e 672c 0a20 2020  tureWarning,.   
+0003cee0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0003cef0: 2020 2023 2049 6620 606d 6574 6160 2069     # If `meta` i
+0003cf00: 7320 6e6f 7420 6120 7061 6e64 6173 206f  s not a pandas o
+0003cf10: 626a 6563 742c 2074 6865 2063 6f6e 6361  bject, the conca
+0003cf20: 7465 6e61 7465 6420 7265 7375 6c74 7320  tenated results 
+0003cf30: 7769 6c6c 2062 6520 610a 2020 2020 2020  will be a.      
+0003cf40: 2020 2320 6469 6666 6572 656e 7420 7479    # different ty
+0003cf50: 7065 0a20 2020 2020 2020 206d 6574 6120  pe.        meta 
+0003cf60: 3d20 6d61 6b65 5f6d 6574 6128 5f63 6f6e  = make_meta(_con
+0003cf70: 6361 7428 5b6d 6574 615d 292c 2069 6e64  cat([meta]), ind
+0003cf80: 6578 3d6d 6574 615f 696e 6465 7829 0a0a  ex=meta_index)..
+0003cf90: 2020 2020 2320 456e 7375 7265 206d 6574      # Ensure met
+0003cfa0: 6120 6973 2065 6d70 7479 2073 6572 6965  a is empty serie
+0003cfb0: 730a 2020 2020 6d65 7461 203d 206d 616b  s.    meta = mak
+0003cfc0: 655f 6d65 7461 286d 6574 612c 2070 6172  e_meta(meta, par
+0003cfd0: 656e 745f 6d65 7461 3d70 6172 656e 745f  ent_meta=parent_
+0003cfe0: 6d65 7461 290a 0a20 2020 2072 6574 7572  meta)..    retur
+0003cff0: 6e20 6d65 7461 0a0a 0a64 6566 2061 7070  n meta...def app
+0003d000: 6c79 5f61 6e64 5f65 6e66 6f72 6365 282a  ly_and_enforce(*
+0003d010: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+0003d020: 0a20 2020 2022 2222 4170 706c 7920 6120  .    """Apply a 
+0003d030: 6675 6e63 7469 6f6e 2c20 616e 6420 656e  function, and en
+0003d040: 666f 7263 6520 7468 6520 6f75 7470 7574  force the output
+0003d050: 2074 6f20 6d61 7463 6820 6d65 7461 0a0a   to match meta..
+0003d060: 2020 2020 456e 7375 7265 7320 7468 6520      Ensures the 
+0003d070: 6f75 7470 7574 2068 6173 2074 6865 2073  output has the s
+0003d080: 616d 6520 636f 6c75 6d6e 732c 2065 7665  ame columns, eve
+0003d090: 6e20 6966 2065 6d70 7479 2e22 2222 0a20  n if empty.""". 
+0003d0a0: 2020 2066 756e 6320 3d20 6b77 6172 6773     func = kwargs
+0003d0b0: 2e70 6f70 2822 5f66 756e 6322 290a 2020  .pop("_func").  
+0003d0c0: 2020 6d65 7461 203d 206b 7761 7267 732e    meta = kwargs.
+0003d0d0: 706f 7028 225f 6d65 7461 2229 0a20 2020  pop("_meta").   
+0003d0e0: 2064 6620 3d20 6675 6e63 282a 6172 6773   df = func(*args
+0003d0f0: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
+0003d100: 6966 2069 735f 6461 7461 6672 616d 655f  if is_dataframe_
+0003d110: 6c69 6b65 2864 6629 206f 7220 6973 5f73  like(df) or is_s
+0003d120: 6572 6965 735f 6c69 6b65 2864 6629 206f  eries_like(df) o
+0003d130: 7220 6973 5f69 6e64 6578 5f6c 696b 6528  r is_index_like(
+0003d140: 6466 293a 0a20 2020 2020 2020 2069 6620  df):.        if 
+0003d150: 6e6f 7420 6c65 6e28 6466 293a 0a20 2020  not len(df):.   
+0003d160: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0003d170: 6d65 7461 0a20 2020 2020 2020 2069 6620  meta.        if 
+0003d180: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+0003d190: 6528 6466 293a 0a20 2020 2020 2020 2020  e(df):.         
+0003d1a0: 2020 2063 6865 636b 5f6d 6174 6368 696e     check_matchin
+0003d1b0: 675f 636f 6c75 6d6e 7328 6d65 7461 2c20  g_columns(meta, 
+0003d1c0: 6466 290a 2020 2020 2020 2020 2020 2020  df).            
+0003d1d0: 6320 3d20 6d65 7461 2e63 6f6c 756d 6e73  c = meta.columns
+0003d1e0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0003d1f0: 2020 2020 2020 2020 2020 2063 203d 206d             c = m
+0003d200: 6574 612e 6e61 6d65 0a20 2020 2020 2020  eta.name.       
+0003d210: 2072 6574 7572 6e20 5f72 656e 616d 6528   return _rename(
+0003d220: 632c 2064 6629 0a20 2020 2072 6574 7572  c, df).    retur
+0003d230: 6e20 6466 0a0a 0a64 6566 205f 7265 6e61  n df...def _rena
+0003d240: 6d65 2863 6f6c 756d 6e73 2c20 6466 293a  me(columns, df):
+0003d250: 0a20 2020 2022 2222 0a20 2020 2052 656e  .    """.    Ren
+0003d260: 616d 6520 636f 6c75 6d6e 7320 6f66 2070  ame columns of p
+0003d270: 642e 4461 7461 4672 616d 6520 6f72 206e  d.DataFrame or n
+0003d280: 616d 6520 6f66 2070 642e 5365 7269 6573  ame of pd.Series
+0003d290: 2e0a 2020 2020 4e6f 7420 666f 7220 6464  ..    Not for dd
+0003d2a0: 2e44 6174 6146 7261 6d65 206f 7220 6464  .DataFrame or dd
+0003d2b0: 2e53 6572 6965 732e 0a0a 2020 2020 5061  .Series...    Pa
+0003d2c0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+0003d2d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 636f 6c75  -------.    colu
+0003d2e0: 6d6e 7320 3a20 7475 706c 652c 2073 7472  mns : tuple, str
+0003d2f0: 696e 672c 2070 642e 4461 7461 4672 616d  ing, pd.DataFram
+0003d300: 6520 6f72 2070 642e 5365 7269 6573 0a20  e or pd.Series. 
+0003d310: 2020 2020 2020 2043 6f6c 756d 6e20 6e61         Column na
+0003d320: 6d65 732c 2053 6572 6965 7320 6e61 6d65  mes, Series name
+0003d330: 206f 7220 7061 6e64 6173 2069 6e73 7461   or pandas insta
+0003d340: 6e63 6520 7768 6963 6820 6861 7320 7468  nce which has th
+0003d350: 650a 2020 2020 2020 2020 7461 7267 6574  e.        target
+0003d360: 2063 6f6c 756d 6e20 6e61 6d65 7320 2f20   column names / 
+0003d370: 6e61 6d65 2e0a 2020 2020 6466 203a 2070  name..    df : p
+0003d380: 642e 4461 7461 4672 616d 6520 6f72 2070  d.DataFrame or p
+0003d390: 642e 5365 7269 6573 0a20 2020 2020 2020  d.Series.       
+0003d3a0: 2074 6172 6765 7420 4461 7461 4672 616d   target DataFram
+0003d3b0: 6520 2f20 5365 7269 6573 2074 6f20 6265  e / Series to be
+0003d3c0: 2072 656e 616d 6564 0a20 2020 2022 2222   renamed.    """
+0003d3d0: 0a20 2020 2061 7373 6572 7420 6e6f 7420  .    assert not 
+0003d3e0: 6973 696e 7374 616e 6365 2864 662c 205f  isinstance(df, _
+0003d3f0: 4672 616d 6529 0a0a 2020 2020 6966 2063  Frame)..    if c
+0003d400: 6f6c 756d 6e73 2069 7320 6e6f 5f64 6566  olumns is no_def
+0003d410: 6175 6c74 3a0a 2020 2020 2020 2020 7265  ault:.        re
+0003d420: 7475 726e 2064 660a 0a20 2020 2069 6620  turn df..    if 
+0003d430: 6973 696e 7374 616e 6365 2863 6f6c 756d  isinstance(colum
+0003d440: 6e73 2c20 4974 6572 6174 6f72 293a 0a20  ns, Iterator):. 
+0003d450: 2020 2020 2020 2063 6f6c 756d 6e73 203d         columns =
+0003d460: 206c 6973 7428 636f 6c75 6d6e 7329 0a0a   list(columns)..
+0003d470: 2020 2020 6966 2069 735f 6461 7461 6672      if is_datafr
+0003d480: 616d 655f 6c69 6b65 2864 6629 3a0a 2020  ame_like(df):.  
+0003d490: 2020 2020 2020 6966 2069 735f 6461 7461        if is_data
+0003d4a0: 6672 616d 655f 6c69 6b65 2863 6f6c 756d  frame_like(colum
+0003d4b0: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
+0003d4c0: 2063 6f6c 756d 6e73 203d 2063 6f6c 756d   columns = colum
+0003d4d0: 6e73 2e63 6f6c 756d 6e73 0a20 2020 2020  ns.columns.     
+0003d4e0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+0003d4f0: 616e 6365 2863 6f6c 756d 6e73 2c20 7064  ance(columns, pd
+0003d500: 2e49 6e64 6578 293a 0a20 2020 2020 2020  .Index):.       
+0003d510: 2020 2020 2063 6f6c 756d 6e73 203d 2070       columns = p
+0003d520: 642e 496e 6465 7828 636f 6c75 6d6e 7329  d.Index(columns)
+0003d530: 0a20 2020 2020 2020 2069 6620 280a 2020  .        if (.  
+0003d540: 2020 2020 2020 2020 2020 6c65 6e28 636f            len(co
+0003d550: 6c75 6d6e 7329 203d 3d20 6c65 6e28 6466  lumns) == len(df
+0003d560: 2e63 6f6c 756d 6e73 290a 2020 2020 2020  .columns).      
+0003d570: 2020 2020 2020 616e 6420 7479 7065 2863        and type(c
+0003d580: 6f6c 756d 6e73 2920 6973 2074 7970 6528  olumns) is type(
+0003d590: 6466 2e63 6f6c 756d 6e73 290a 2020 2020  df.columns).    
+0003d5a0: 2020 2020 2020 2020 616e 6420 636f 6c75          and colu
+0003d5b0: 6d6e 732e 6474 7970 6520 3d3d 2064 662e  mns.dtype == df.
+0003d5c0: 636f 6c75 6d6e 732e 6474 7970 650a 2020  columns.dtype.  
+0003d5d0: 2020 2020 2020 2020 2020 616e 6420 636f            and co
+0003d5e0: 6c75 6d6e 732e 6571 7561 6c73 2864 662e  lumns.equals(df.
+0003d5f0: 636f 6c75 6d6e 7329 0a20 2020 2020 2020  columns).       
+0003d600: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0003d610: 2320 6966 2074 6172 6765 7420 6973 2069  # if target is i
+0003d620: 6465 6e74 6963 616c 2c20 7265 6e61 6d65  dentical, rename
+0003d630: 2069 7320 6e6f 7420 6e65 6365 7373 6172   is not necessar
+0003d640: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
+0003d650: 7475 726e 2064 660a 2020 2020 2020 2020  turn df.        
+0003d660: 2320 6465 6570 3d46 616c 7365 2064 6f65  # deep=False doe
+0003d670: 736e 2774 2064 6f65 736e 2774 2063 6f70  sn't doesn't cop
+0003d680: 7920 616e 7920 6461 7461 2f69 6e64 6963  y any data/indic
+0003d690: 6573 2c20 736f 2074 6869 7320 6973 2063  es, so this is c
+0003d6a0: 6865 6170 0a20 2020 2020 2020 2064 6620  heap.        df 
+0003d6b0: 3d20 6466 2e63 6f70 7928 6465 6570 3d46  = df.copy(deep=F
+0003d6c0: 616c 7365 290a 2020 2020 2020 2020 6466  alse).        df
+0003d6d0: 2e63 6f6c 756d 6e73 203d 2063 6f6c 756d  .columns = colum
+0003d6e0: 6e73 0a20 2020 2020 2020 2072 6574 7572  ns.        retur
+0003d6f0: 6e20 6466 0a20 2020 2065 6c69 6620 6973  n df.    elif is
+0003d700: 5f73 6572 6965 735f 6c69 6b65 2864 6629  _series_like(df)
+0003d710: 206f 7220 6973 5f69 6e64 6578 5f6c 696b   or is_index_lik
+0003d720: 6528 6466 293a 0a20 2020 2020 2020 2069  e(df):.        i
+0003d730: 6620 6973 5f73 6572 6965 735f 6c69 6b65  f is_series_like
+0003d740: 2863 6f6c 756d 6e73 2920 6f72 2069 735f  (columns) or is_
+0003d750: 696e 6465 785f 6c69 6b65 2863 6f6c 756d  index_like(colum
+0003d760: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
+0003d770: 2063 6f6c 756d 6e73 203d 2063 6f6c 756d   columns = colum
+0003d780: 6e73 2e6e 616d 650a 2020 2020 2020 2020  ns.name.        
+0003d790: 6966 2064 662e 6e61 6d65 203d 3d20 636f  if df.name == co
+0003d7a0: 6c75 6d6e 733a 0a20 2020 2020 2020 2020  lumns:.         
+0003d7b0: 2020 2072 6574 7572 6e20 6466 0a20 2020     return df.   
+0003d7c0: 2020 2020 2072 6574 7572 6e20 6466 2e72       return df.r
+0003d7d0: 656e 616d 6528 636f 6c75 6d6e 7329 0a20  ename(columns). 
+0003d7e0: 2020 2023 206d 6170 5f70 6172 7469 7469     # map_partiti
+0003d7f0: 6f6e 206d 6179 2070 6173 7320 6f74 6865  on may pass othe
+0003d800: 7220 7479 7065 730a 2020 2020 7265 7475  r types.    retu
+0003d810: 726e 2064 660a 0a0a 6465 6620 5f72 656e  rn df...def _ren
+0003d820: 616d 655f 6461 736b 2864 662c 206e 616d  ame_dask(df, nam
+0003d830: 6573 293a 0a20 2020 2022 2222 0a20 2020  es):.    """.   
+0003d840: 2044 6573 7472 7563 7469 7665 6c79 2072   Destructively r
+0003d850: 656e 616d 6520 636f 6c75 6d6e 7320 6f66  ename columns of
+0003d860: 2064 642e 4461 7461 4672 616d 6520 6f72   dd.DataFrame or
+0003d870: 206e 616d 6520 6f66 2064 642e 5365 7269   name of dd.Seri
+0003d880: 6573 2e0a 2020 2020 4e6f 7420 666f 7220  es..    Not for 
+0003d890: 7064 2e44 6174 6146 7261 6d65 206f 7220  pd.DataFrame or 
+0003d8a0: 7064 2e53 6572 6965 732e 0a0a 2020 2020  pd.Series...    
+0003d8b0: 496e 7465 726e 616c 6c79 2075 7365 6420  Internally used 
+0003d8c0: 746f 206f 7665 7277 7269 7465 2064 642e  to overwrite dd.
+0003d8d0: 4461 7461 4672 616d 652e 636f 6c75 6d6e  DataFrame.column
+0003d8e0: 7320 616e 6420 6464 2e53 6572 6965 732e  s and dd.Series.
+0003d8f0: 6e61 6d65 0a20 2020 2057 6520 6361 6e27  name.    We can'
+0003d900: 7420 7573 6520 6d61 705f 7061 7274 6974  t use map_partit
+0003d910: 696f 6e20 6265 6361 7573 6520 6974 2061  ion because it a
+0003d920: 7070 6c69 6573 2066 756e 6374 696f 6e20  pplies function 
+0003d930: 7468 656e 2072 656e 616d 650a 0a20 2020  then rename..   
+0003d940: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0003d950: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064  ----------.    d
+0003d960: 6620 3a20 6464 2e44 6174 6146 7261 6d65  f : dd.DataFrame
+0003d970: 206f 7220 6464 2e53 6572 6965 730a 2020   or dd.Series.  
+0003d980: 2020 2020 2020 7461 7267 6574 2044 6174        target Dat
+0003d990: 6146 7261 6d65 202f 2053 6572 6965 7320  aFrame / Series 
+0003d9a0: 746f 2062 6520 7265 6e61 6d65 640a 2020  to be renamed.  
+0003d9b0: 2020 6e61 6d65 7320 3a20 7475 706c 652c    names : tuple,
+0003d9c0: 2073 7472 696e 670a 2020 2020 2020 2020   string.        
+0003d9d0: 436f 6c75 6d6e 206e 616d 6573 2f53 6572  Column names/Ser
+0003d9e0: 6965 7320 6e61 6d65 0a20 2020 2022 2222  ies name.    """
+0003d9f0: 0a0a 2020 2020 6173 7365 7274 2069 7369  ..    assert isi
+0003da00: 6e73 7461 6e63 6528 6466 2c20 5f46 7261  nstance(df, _Fra
+0003da10: 6d65 290a 2020 2020 6d65 7461 6461 7461  me).    metadata
+0003da20: 203d 205f 7265 6e61 6d65 286e 616d 6573   = _rename(names
+0003da30: 2c20 6466 2e5f 6d65 7461 290a 2020 2020  , df._meta).    
+0003da40: 6e61 6d65 203d 2066 2272 656e 616d 652d  name = f"rename-
+0003da50: 7b74 6f6b 656e 697a 6528 6466 2c20 6d65  {tokenize(df, me
+0003da60: 7461 6461 7461 297d 220a 0a20 2020 2064  tadata)}"..    d
+0003da70: 736b 203d 2070 6172 7469 7469 6f6e 7769  sk = partitionwi
+0003da80: 7365 5f67 7261 7068 285f 7265 6e61 6d65  se_graph(_rename
+0003da90: 2c20 6e61 6d65 2c20 6d65 7461 6461 7461  , name, metadata
+0003daa0: 2c20 6466 290a 2020 2020 6772 6170 6820  , df).    graph 
+0003dab0: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
+0003dac0: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
+0003dad0: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
+0003dae0: 656e 6465 6e63 6965 733d 5b64 665d 290a  endencies=[df]).
+0003daf0: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
+0003db00: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
+0003db10: 6e61 6d65 2c20 6d65 7461 6461 7461 2c20  name, metadata, 
+0003db20: 6466 2e64 6976 6973 696f 6e73 290a 0a0a  df.divisions)...
+0003db30: 6465 6620 7175 616e 7469 6c65 2864 662c  def quantile(df,
+0003db40: 2071 2c20 6d65 7468 6f64 3d22 6465 6661   q, method="defa
+0003db50: 756c 7422 293a 0a20 2020 2022 2222 4170  ult"):.    """Ap
+0003db60: 7072 6f78 696d 6174 6520 7175 616e 7469  proximate quanti
+0003db70: 6c65 7320 6f66 2053 6572 6965 732e 0a0a  les of Series...
+0003db80: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0003db90: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+0003dba0: 2020 7120 3a20 6c69 7374 2f61 7272 6179    q : list/array
+0003dbb0: 206f 6620 666c 6f61 7473 0a20 2020 2020   of floats.     
+0003dbc0: 2020 2049 7465 7261 626c 6520 6f66 206e     Iterable of n
+0003dbd0: 756d 6265 7273 2072 616e 6769 6e67 2066  umbers ranging f
+0003dbe0: 726f 6d20 3020 746f 2031 3030 2066 6f72  rom 0 to 100 for
+0003dbf0: 2074 6865 2064 6573 6972 6564 2071 7561   the desired qua
+0003dc00: 6e74 696c 6573 0a20 2020 206d 6574 686f  ntiles.    metho
+0003dc10: 6420 3a20 7b27 6465 6661 756c 7427 2c20  d : {'default', 
+0003dc20: 2774 6469 6765 7374 272c 2027 6461 736b  'tdigest', 'dask
+0003dc30: 277d 2c20 6f70 7469 6f6e 616c 0a20 2020  '}, optional.   
+0003dc40: 2020 2020 2057 6861 7420 6d65 7468 6f64       What method
+0003dc50: 2074 6f20 7573 652e 2042 7920 6465 6661   to use. By defa
+0003dc60: 756c 7420 7769 6c6c 2075 7365 2064 6173  ult will use das
+0003dc70: 6b27 7320 696e 7465 726e 616c 2063 7573  k's internal cus
+0003dc80: 746f 6d0a 2020 2020 2020 2020 616c 676f  tom.        algo
+0003dc90: 7269 7468 6d20 2860 6027 6461 736b 2760  rithm (``'dask'`
+0003dca0: 6029 2e20 2049 6620 7365 7420 746f 2060  `).  If set to `
+0003dcb0: 6027 7464 6967 6573 7427 6060 2077 696c  `'tdigest'`` wil
+0003dcc0: 6c20 7573 6520 7464 6967 6573 7420 666f  l use tdigest fo
+0003dcd0: 720a 2020 2020 2020 2020 666c 6f61 7473  r.        floats
+0003dce0: 2061 6e64 2069 6e74 7320 616e 6420 6661   and ints and fa
+0003dcf0: 6c6c 6261 636b 2074 6f20 7468 6520 6060  llback to the ``
+0003dd00: 2764 6173 6b27 6060 206f 7468 6572 7769  'dask'`` otherwi
+0003dd10: 7365 2e0a 2020 2020 2222 220a 2020 2020  se..    """.    
+0003dd20: 2320 6375 7272 656e 7420 696d 706c 656d  # current implem
+0003dd30: 656e 7461 7469 6f6e 206e 6565 6473 2071  entation needs q
+0003dd40: 2074 6f20 6265 2073 6f72 7465 6420 736f   to be sorted so
+0003dd50: 0a20 2020 2023 2073 6f72 7420 6966 2061  .    # sort if a
+0003dd60: 7272 6179 2d6c 696b 652c 206f 7468 6572  rray-like, other
+0003dd70: 7769 7365 206c 6561 7665 2069 7420 616c  wise leave it al
+0003dd80: 6f6e 650a 2020 2020 715f 6e64 6172 7261  one.    q_ndarra
+0003dd90: 7920 3d20 6e70 2e61 7272 6179 2871 290a  y = np.array(q).
+0003dda0: 2020 2020 6966 2071 5f6e 6461 7272 6179      if q_ndarray
+0003ddb0: 2e6e 6469 6d20 3e20 303a 0a20 2020 2020  .ndim > 0:.     
+0003ddc0: 2020 2071 5f6e 6461 7272 6179 2e73 6f72     q_ndarray.sor
+0003ddd0: 7428 6b69 6e64 3d22 6d65 7267 6573 6f72  t(kind="mergesor
+0003dde0: 7422 290a 2020 2020 2020 2020 7120 3d20  t").        q = 
+0003ddf0: 715f 6e64 6172 7261 790a 0a20 2020 2061  q_ndarray..    a
+0003de00: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
+0003de10: 2864 662c 2053 6572 6965 7329 0a0a 2020  (df, Series)..  
+0003de20: 2020 616c 6c6f 7765 645f 6d65 7468 6f64    allowed_method
+0003de30: 7320 3d20 5b22 6465 6661 756c 7422 2c20  s = ["default", 
+0003de40: 2264 6173 6b22 2c20 2274 6469 6765 7374  "dask", "tdigest
+0003de50: 225d 0a20 2020 2069 6620 6d65 7468 6f64  "].    if method
+0003de60: 206e 6f74 2069 6e20 616c 6c6f 7765 645f   not in allowed_
+0003de70: 6d65 7468 6f64 733a 0a20 2020 2020 2020  methods:.       
+0003de80: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0003de90: 7228 226d 6574 686f 6420 6361 6e20 6f6e  r("method can on
+0003dea0: 6c79 2062 6520 2764 6566 6175 6c74 272c  ly be 'default',
+0003deb0: 2027 6461 736b 2720 6f72 2027 7464 6967   'dask' or 'tdig
+0003dec0: 6573 7427 2229 0a0a 2020 2020 6966 206d  est'")..    if m
+0003ded0: 6574 686f 6420 3d3d 2022 6465 6661 756c  ethod == "defaul
+0003dee0: 7422 3a0a 2020 2020 2020 2020 696e 7465  t":.        inte
+0003def0: 726e 616c 5f6d 6574 686f 6420 3d20 2264  rnal_method = "d
+0003df00: 6173 6b22 0a20 2020 2065 6c73 653a 0a20  ask".    else:. 
+0003df10: 2020 2020 2020 2069 6e74 6572 6e61 6c5f         internal_
+0003df20: 6d65 7468 6f64 203d 206d 6574 686f 640a  method = method.
+0003df30: 0a20 2020 2023 2063 7572 7265 6e74 6c79  .    # currently
+0003df40: 2c20 6f6e 6c79 2053 6572 6965 7320 6861  , only Series ha
+0003df50: 7320 7175 616e 7469 6c65 206d 6574 686f  s quantile metho
+0003df60: 640a 2020 2020 6966 2069 7369 6e73 7461  d.    if isinsta
+0003df70: 6e63 6528 6466 2c20 496e 6465 7829 3a0a  nce(df, Index):.
+0003df80: 2020 2020 2020 2020 7365 7269 6573 5f74          series_t
+0003df90: 7970 203d 2064 662e 5f6d 6574 612e 746f  yp = df._meta.to
+0003dfa0: 5f73 6572 6965 7328 292e 5f63 6f6e 7374  _series()._const
+0003dfb0: 7275 6374 6f72 0a20 2020 2020 2020 206d  ructor.        m
+0003dfc0: 6574 6120 3d20 6466 2e5f 6d65 7461 5f6e  eta = df._meta_n
+0003dfd0: 6f6e 656d 7074 792e 746f 5f73 6572 6965  onempty.to_serie
+0003dfe0: 7328 292e 7175 616e 7469 6c65 2871 290a  s().quantile(q).
+0003dff0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0003e000: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
+0003e010: 696b 6528 6466 2e5f 6d65 7461 293a 0a20  ike(df._meta):. 
+0003e020: 2020 2020 2020 2020 2020 2073 6572 6965             serie
+0003e030: 735f 7479 7020 3d20 6466 2e5f 6d65 7461  s_typ = df._meta
+0003e040: 2e5f 636f 6e73 7472 7563 746f 720a 2020  ._constructor.  
+0003e050: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0003e060: 2020 2020 2020 2020 7365 7269 6573 5f74          series_t
+0003e070: 7970 203d 2064 662e 5f6d 6574 612e 5f63  yp = df._meta._c
+0003e080: 6f6e 7374 7275 6374 6f72 5f73 6c69 6365  onstructor_slice
+0003e090: 640a 2020 2020 2020 2020 6d65 7461 203d  d.        meta =
+0003e0a0: 2064 662e 5f6d 6574 615f 6e6f 6e65 6d70   df._meta_nonemp
+0003e0b0: 7479 2e71 7561 6e74 696c 6528 7129 0a0a  ty.quantile(q)..
+0003e0c0: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
+0003e0d0: 5f6c 696b 6528 6d65 7461 293a 0a20 2020  _like(meta):.   
+0003e0e0: 2020 2020 2023 2049 6e64 6578 2e71 7561       # Index.qua
+0003e0f0: 6e74 696c 6528 6c69 7374 2d6c 696b 6529  ntile(list-like)
+0003e100: 206d 7573 7420 6265 2070 642e 5365 7269   must be pd.Seri
+0003e110: 6573 2c20 6e6f 7420 7064 2e49 6e64 6578  es, not pd.Index
+0003e120: 0a20 2020 2020 2020 2064 665f 6e61 6d65  .        df_name
+0003e130: 203d 2064 662e 6e61 6d65 0a20 2020 2020   = df.name.     
+0003e140: 2020 2066 696e 616c 697a 655f 7473 6b20     finalize_tsk 
+0003e150: 3d20 6c61 6d62 6461 2074 736b 3a20 2873  = lambda tsk: (s
+0003e160: 6572 6965 735f 7479 702c 2074 736b 2c20  eries_typ, tsk, 
+0003e170: 712c 204e 6f6e 652c 2064 665f 6e61 6d65  q, None, df_name
+0003e180: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0003e190: 5f74 7970 6520 3d20 5365 7269 6573 0a20  _type = Series. 
+0003e1a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0003e1b0: 2066 696e 616c 697a 655f 7473 6b20 3d20   finalize_tsk = 
+0003e1c0: 6c61 6d62 6461 2074 736b 3a20 2867 6574  lambda tsk: (get
+0003e1d0: 6974 656d 2c20 7473 6b2c 2030 290a 2020  item, tsk, 0).  
+0003e1e0: 2020 2020 2020 7265 7475 726e 5f74 7970        return_typ
+0003e1f0: 6520 3d20 5363 616c 6172 0a20 2020 2020  e = Scalar.     
+0003e200: 2020 2071 203d 205b 715d 0a0a 2020 2020     q = [q]..    
+0003e210: 2320 7061 6e64 6173 2075 7365 7320 7175  # pandas uses qu
+0003e220: 616e 7469 6c65 2069 6e20 5b30 2c20 315d  antile in [0, 1]
+0003e230: 0a20 2020 2023 206e 756d 7079 202f 2065  .    # numpy / e
+0003e240: 7665 7279 6f6e 6520 656c 7365 2075 7365  veryone else use
+0003e250: 7320 5b30 2c20 3130 305d 0a20 2020 2071  s [0, 100].    q
+0003e260: 7320 3d20 6e70 2e61 7361 7272 6179 2871  s = np.asarray(q
+0003e270: 2920 2a20 3130 300a 2020 2020 746f 6b65  ) * 100.    toke
+0003e280: 6e20 3d20 746f 6b65 6e69 7a65 2864 662c  n = tokenize(df,
+0003e290: 2071 7329 0a0a 2020 2020 6966 206c 656e   qs)..    if len
+0003e2a0: 2871 7329 203d 3d20 303a 0a20 2020 2020  (qs) == 0:.     
+0003e2b0: 2020 206e 616d 6520 3d20 2271 7561 6e74     name = "quant
+0003e2c0: 696c 6573 2d22 202b 2074 6f6b 656e 0a20  iles-" + token. 
+0003e2d0: 2020 2020 2020 2065 6d70 7479 5f69 6e64         empty_ind
+0003e2e0: 6578 203d 2070 642e 496e 6465 7828 5b5d  ex = pd.Index([]
+0003e2f0: 2c20 6474 7970 653d 666c 6f61 7429 0a0a  , dtype=float)..
+0003e300: 2020 2020 2020 2020 7265 7475 726e 2053          return S
+0003e310: 6572 6965 7328 0a20 2020 2020 2020 2020  eries(.         
+0003e320: 2020 207b 286e 616d 652c 2030 293a 2073     {(name, 0): s
+0003e330: 6572 6965 735f 7479 7028 5b5d 2c20 6e61  eries_typ([], na
+0003e340: 6d65 3d64 662e 6e61 6d65 2c20 696e 6465  me=df.name, inde
+0003e350: 783d 656d 7074 795f 696e 6465 782c 2064  x=empty_index, d
+0003e360: 7479 7065 3d22 666c 6f61 7422 297d 2c0a  type="float")},.
+0003e370: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0003e380: 2c0a 2020 2020 2020 2020 2020 2020 6466  ,.            df
+0003e390: 2e5f 6d65 7461 2c0a 2020 2020 2020 2020  ._meta,.        
+0003e3a0: 2020 2020 5b4e 6f6e 652c 204e 6f6e 655d      [None, None]
+0003e3b0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0003e3c0: 656c 7365 3a0a 2020 2020 2020 2020 6e65  else:.        ne
+0003e3d0: 775f 6469 7669 7369 6f6e 7320 3d20 5b6e  w_divisions = [n
+0003e3e0: 702e 6d69 6e28 7129 2c20 6e70 2e6d 6178  p.min(q), np.max
+0003e3f0: 2871 295d 0a0a 2020 2020 6466 203d 2064  (q)]..    df = d
+0003e400: 662e 6472 6f70 6e61 2829 0a0a 2020 2020  f.dropna()..    
+0003e410: 6966 2069 6e74 6572 6e61 6c5f 6d65 7468  if internal_meth
+0003e420: 6f64 203d 3d20 2274 6469 6765 7374 2220  od == "tdigest" 
+0003e430: 616e 6420 280a 2020 2020 2020 2020 6e70  and (.        np
+0003e440: 2e69 7373 7562 6474 7970 6528 6466 2e64  .issubdtype(df.d
+0003e450: 7479 7065 2c20 6e70 2e66 6c6f 6174 696e  type, np.floatin
+0003e460: 6729 206f 7220 6e70 2e69 7373 7562 6474  g) or np.issubdt
+0003e470: 7970 6528 6466 2e64 7479 7065 2c20 6e70  ype(df.dtype, np
+0003e480: 2e69 6e74 6567 6572 290a 2020 2020 293a  .integer).    ):
+0003e490: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+0003e4a0: 736b 2e75 7469 6c73 2069 6d70 6f72 7420  sk.utils import 
+0003e4b0: 696d 706f 7274 5f72 6571 7569 7265 640a  import_required.
+0003e4c0: 0a20 2020 2020 2020 2069 6d70 6f72 745f  .        import_
+0003e4d0: 7265 7175 6972 6564 280a 2020 2020 2020  required(.      
+0003e4e0: 2020 2020 2020 2263 7269 636b 222c 2022        "crick", "
+0003e4f0: 6372 6963 6b20 6973 2061 2072 6571 7569  crick is a requi
+0003e500: 7265 6420 6465 7065 6e64 656e 6379 2066  red dependency f
+0003e510: 6f72 2075 7369 6e67 2074 6865 2074 2d64  or using the t-d
+0003e520: 6967 6573 7420 6d65 7468 6f64 2e22 0a20  igest method.". 
+0003e530: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0003e540: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
+0003e550: 792e 7065 7263 656e 7469 6c65 2069 6d70  y.percentile imp
+0003e560: 6f72 7420 5f70 6572 6365 6e74 696c 6573  ort _percentiles
+0003e570: 5f66 726f 6d5f 7464 6967 6573 742c 205f  _from_tdigest, _
+0003e580: 7464 6967 6573 745f 6368 756e 6b0a 0a20  tdigest_chunk.. 
+0003e590: 2020 2020 2020 206e 616d 6520 3d20 2271         name = "q
+0003e5a0: 7561 6e74 696c 6573 5f74 6469 6765 7374  uantiles_tdigest
+0003e5b0: 2d31 2d22 202b 2074 6f6b 656e 0a20 2020  -1-" + token.   
+0003e5c0: 2020 2020 2076 616c 5f64 736b 203d 207b       val_dsk = {
+0003e5d0: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
+0003e5e0: 6d65 2c20 6929 3a20 285f 7464 6967 6573  me, i): (_tdiges
+0003e5f0: 745f 6368 756e 6b2c 2028 6765 7461 7474  t_chunk, (getatt
+0003e600: 722c 206b 6579 2c20 2276 616c 7565 7322  r, key, "values"
+0003e610: 2929 0a20 2020 2020 2020 2020 2020 2066  )).            f
+0003e620: 6f72 2069 2c20 6b65 7920 696e 2065 6e75  or i, key in enu
+0003e630: 6d65 7261 7465 2864 662e 5f5f 6461 736b  merate(df.__dask
+0003e640: 5f6b 6579 735f 5f28 2929 0a20 2020 2020  _keys__()).     
+0003e650: 2020 207d 0a0a 2020 2020 2020 2020 6e61     }..        na
+0003e660: 6d65 3220 3d20 2271 7561 6e74 696c 6573  me2 = "quantiles
+0003e670: 5f74 6469 6765 7374 2d32 2d22 202b 2074  _tdigest-2-" + t
+0003e680: 6f6b 656e 0a20 2020 2020 2020 206d 6572  oken.        mer
+0003e690: 6765 5f64 736b 203d 207b 0a20 2020 2020  ge_dsk = {.     
+0003e6a0: 2020 2020 2020 2028 6e61 6d65 322c 2030         (name2, 0
+0003e6b0: 293a 2066 696e 616c 697a 655f 7473 6b28  ): finalize_tsk(
+0003e6c0: 285f 7065 7263 656e 7469 6c65 735f 6672  (_percentiles_fr
+0003e6d0: 6f6d 5f74 6469 6765 7374 2c20 7173 2c20  om_tdigest, qs, 
+0003e6e0: 736f 7274 6564 2876 616c 5f64 736b 2929  sorted(val_dsk))
+0003e6f0: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
+0003e700: 656c 7365 3a0a 2020 2020 2020 2020 6672  else:.        fr
+0003e710: 6f6d 2064 6173 6b2e 6172 7261 792e 6469  om dask.array.di
+0003e720: 7370 6174 6368 2069 6d70 6f72 7420 7065  spatch import pe
+0003e730: 7263 656e 7469 6c65 5f6c 6f6f 6b75 7020  rcentile_lookup 
+0003e740: 6173 205f 7065 7263 656e 7469 6c65 0a20  as _percentile. 
+0003e750: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+0003e760: 2e61 7272 6179 2e70 6572 6365 6e74 696c  .array.percentil
+0003e770: 6520 696d 706f 7274 206d 6572 6765 5f70  e import merge_p
+0003e780: 6572 6365 6e74 696c 6573 0a0a 2020 2020  ercentiles..    
+0003e790: 2020 2020 2320 4164 6420 3020 616e 6420      # Add 0 and 
+0003e7a0: 3130 3020 6475 7269 6e67 2063 616c 6375  100 during calcu
+0003e7b0: 6c61 7469 6f6e 2066 6f72 206d 6f72 6520  lation for more 
+0003e7c0: 726f 6275 7374 2062 6568 6176 696f 7220  robust behavior 
+0003e7d0: 2868 6f70 6566 756c 6c79 290a 2020 2020  (hopefully).    
+0003e7e0: 2020 2020 6361 6c63 5f71 7320 3d20 6e70      calc_qs = np
+0003e7f0: 2e70 6164 2871 732c 2031 2c20 6d6f 6465  .pad(qs, 1, mode
+0003e800: 3d22 636f 6e73 7461 6e74 2229 0a20 2020  ="constant").   
+0003e810: 2020 2020 2063 616c 635f 7173 5b2d 315d       calc_qs[-1]
+0003e820: 203d 2031 3030 0a20 2020 2020 2020 206e   = 100.        n
+0003e830: 616d 6520 3d20 2271 7561 6e74 696c 6573  ame = "quantiles
+0003e840: 2d31 2d22 202b 2074 6f6b 656e 0a20 2020  -1-" + token.   
+0003e850: 2020 2020 2076 616c 5f64 736b 203d 207b       val_dsk = {
+0003e860: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
+0003e870: 6d65 2c20 6929 3a20 285f 7065 7263 656e  me, i): (_percen
+0003e880: 7469 6c65 2c20 6b65 792c 2063 616c 635f  tile, key, calc_
+0003e890: 7173 290a 2020 2020 2020 2020 2020 2020  qs).            
+0003e8a0: 666f 7220 692c 206b 6579 2069 6e20 656e  for i, key in en
+0003e8b0: 756d 6572 6174 6528 6466 2e5f 5f64 6173  umerate(df.__das
+0003e8c0: 6b5f 6b65 7973 5f5f 2829 290a 2020 2020  k_keys__()).    
+0003e8d0: 2020 2020 7d0a 0a20 2020 2020 2020 206e      }..        n
+0003e8e0: 616d 6532 203d 2022 7175 616e 7469 6c65  ame2 = "quantile
+0003e8f0: 732d 322d 2220 2b20 746f 6b65 6e0a 2020  s-2-" + token.  
+0003e900: 2020 2020 2020 6d65 7267 655f 6473 6b20        merge_dsk 
+0003e910: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0003e920: 286e 616d 6532 2c20 3029 3a20 6669 6e61  (name2, 0): fina
+0003e930: 6c69 7a65 5f74 736b 280a 2020 2020 2020  lize_tsk(.      
+0003e940: 2020 2020 2020 2020 2020 280a 2020 2020            (.    
+0003e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e960: 6d65 7267 655f 7065 7263 656e 7469 6c65  merge_percentile
+0003e970: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0003e980: 2020 2020 2020 2071 732c 0a20 2020 2020         qs,.     
+0003e990: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0003e9a0: 6361 6c63 5f71 735d 202a 2064 662e 6e70  calc_qs] * df.np
+0003e9b0: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
+0003e9c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003e9d0: 6f72 7465 6428 7661 6c5f 6473 6b29 2c0a  orted(val_dsk),.
+0003e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e9f0: 2020 2020 226c 6f77 6572 222c 0a20 2020      "lower",.   
+0003ea00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ea10: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+0003ea20: 2020 2020 2020 2020 2020 2046 616c 7365             False
+0003ea30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003ea40: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0003ea50: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
+0003ea60: 6473 6b20 3d20 6d65 7267 6528 7661 6c5f  dsk = merge(val_
+0003ea70: 6473 6b2c 206d 6572 6765 5f64 736b 290a  dsk, merge_dsk).
+0003ea80: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
+0003ea90: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+0003eaa0: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
+0003eab0: 322c 2064 736b 2c20 6465 7065 6e64 656e  2, dsk, dependen
+0003eac0: 6369 6573 3d5b 6466 5d29 0a20 2020 2072  cies=[df]).    r
+0003ead0: 6574 7572 6e20 7265 7475 726e 5f74 7970  eturn return_typ
+0003eae0: 6528 6772 6170 682c 206e 616d 6532 2c20  e(graph, name2, 
+0003eaf0: 6d65 7461 2c20 6e65 775f 6469 7669 7369  meta, new_divisi
+0003eb00: 6f6e 7329 0a0a 0a64 6566 205f 636f 765f  ons)...def _cov_
+0003eb10: 636f 7272 280a 2020 2020 6466 2c0a 2020  corr(.    df,.  
+0003eb20: 2020 6d69 6e5f 7065 7269 6f64 733d 4e6f    min_periods=No
+0003eb30: 6e65 2c0a 2020 2020 636f 7272 3d46 616c  ne,.    corr=Fal
+0003eb40: 7365 2c0a 2020 2020 7363 616c 6172 3d46  se,.    scalar=F
+0003eb50: 616c 7365 2c0a 2020 2020 6e75 6d65 7269  alse,.    numeri
+0003eb60: 635f 6f6e 6c79 3d6e 6f5f 6465 6661 756c  c_only=no_defaul
+0003eb70: 742c 0a20 2020 2073 706c 6974 5f65 7665  t,.    split_eve
+0003eb80: 7279 3d46 616c 7365 2c0a 293a 0a20 2020  ry=False,.):.   
+0003eb90: 2022 2222 4461 7461 4672 616d 6520 636f   """DataFrame co
+0003eba0: 7661 7269 616e 6365 2061 6e64 2070 6561  variance and pea
+0003ebb0: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
+0003ebc0: 2e0a 0a20 2020 2043 6f6d 7075 7465 7320  ...    Computes 
+0003ebd0: 7061 6972 7769 7365 2063 6f76 6172 6961  pairwise covaria
+0003ebe0: 6e63 6520 6f72 2063 6f72 7265 6c61 7469  nce or correlati
+0003ebf0: 6f6e 206f 6620 636f 6c75 6d6e 732c 2065  on of columns, e
+0003ec00: 7863 6c75 6469 6e67 204e 412f 6e75 6c6c  xcluding NA/null
+0003ec10: 0a20 2020 2076 616c 7565 732e 0a0a 2020  .    values...  
+0003ec20: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0003ec30: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0003ec40: 6466 203a 2044 6174 6146 7261 6d65 0a20  df : DataFrame. 
+0003ec50: 2020 206d 696e 5f70 6572 696f 6473 203a     min_periods :
+0003ec60: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
+0003ec70: 2020 2020 2020 204d 696e 696d 756d 206e         Minimum n
+0003ec80: 756d 6265 7220 6f66 206f 6273 6572 7661  umber of observa
+0003ec90: 7469 6f6e 7320 7265 7175 6972 6564 2070  tions required p
+0003eca0: 6572 2070 6169 7220 6f66 2063 6f6c 756d  er pair of colum
+0003ecb0: 6e73 0a20 2020 2020 2020 2074 6f20 6861  ns.        to ha
+0003ecc0: 7665 2061 2076 616c 6964 2072 6573 756c  ve a valid resul
+0003ecd0: 742e 0a20 2020 2063 6f72 7220 3a20 626f  t..    corr : bo
+0003ece0: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
+0003ecf0: 2020 2020 2049 6620 5472 7565 2c20 636f       If True, co
+0003ed00: 6d70 7574 6520 7468 6520 5065 6172 736f  mpute the Pearso
+0003ed10: 6e20 636f 7272 656c 6174 696f 6e2e 2049  n correlation. I
+0003ed20: 6620 4661 6c73 6520 5b64 6566 6175 6c74  f False [default
+0003ed30: 5d2c 2063 6f6d 7075 7465 0a20 2020 2020  ], compute.     
+0003ed40: 2020 2074 6865 2063 6f76 6172 6961 6e63     the covarianc
+0003ed50: 652e 0a20 2020 2073 6361 6c61 7220 3a20  e..    scalar : 
+0003ed60: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
+0003ed70: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+0003ed80: 636f 6d70 7574 6520 636f 7661 7269 616e  compute covarian
+0003ed90: 6365 2062 6574 7765 656e 2074 776f 2076  ce between two v
+0003eda0: 6172 6961 626c 6573 2061 7320 6120 7363  ariables as a sc
+0003edb0: 616c 6172 2e20 4f6e 6c79 0a20 2020 2020  alar. Only.     
+0003edc0: 2020 2076 616c 6964 2069 6620 6064 6660     valid if `df`
+0003edd0: 2068 6173 2032 2063 6f6c 756d 6e73 2e20   has 2 columns. 
+0003ede0: 2049 6620 4661 6c73 6520 5b64 6566 6175   If False [defau
+0003edf0: 6c74 5d2c 2063 6f6d 7075 7465 2074 6865  lt], compute the
+0003ee00: 2065 6e74 6972 650a 2020 2020 2020 2020   entire.        
+0003ee10: 636f 7661 7269 616e 6365 2f63 6f72 7265  covariance/corre
+0003ee20: 6c61 7469 6f6e 206d 6174 7269 782e 0a20  lation matrix.. 
+0003ee30: 2020 2073 706c 6974 5f65 7665 7279 203a     split_every :
+0003ee40: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
+0003ee50: 2020 2020 2020 2047 726f 7570 2070 6172         Group par
+0003ee60: 7469 7469 6f6e 7320 696e 746f 2067 726f  titions into gro
+0003ee70: 7570 7320 6f66 2074 6869 7320 7369 7a65  ups of this size
+0003ee80: 2077 6869 6c65 2070 6572 666f 726d 696e   while performin
+0003ee90: 6720 610a 2020 2020 2020 2020 7472 6565  g a.        tree
+0003eea0: 2d72 6564 7563 7469 6f6e 2e20 4966 2073  -reduction. If s
+0003eeb0: 6574 2074 6f20 4661 6c73 652c 206e 6f20  et to False, no 
+0003eec0: 7472 6565 2d72 6564 7563 7469 6f6e 2077  tree-reduction w
+0003eed0: 696c 6c20 6265 2075 7365 642e 0a20 2020  ill be used..   
+0003eee0: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
+0003eef0: 4661 6c73 652e 0a20 2020 2022 2222 0a20  False..    """. 
+0003ef00: 2020 2069 6620 6d69 6e5f 7065 7269 6f64     if min_period
+0003ef10: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
+0003ef20: 2020 206d 696e 5f70 6572 696f 6473 203d     min_periods =
+0003ef30: 2032 0a20 2020 2065 6c69 6620 6d69 6e5f   2.    elif min_
+0003ef40: 7065 7269 6f64 7320 3c20 323a 0a20 2020  periods < 2:.   
+0003ef50: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0003ef60: 4572 726f 7228 226d 696e 5f70 6572 696f  Error("min_perio
+0003ef70: 6473 206d 7573 7420 6265 203e 3d20 3222  ds must be >= 2"
+0003ef80: 290a 0a20 2020 2069 6620 7370 6c69 745f  )..    if split_
+0003ef90: 6576 6572 7920 6973 2046 616c 7365 3a0a  every is False:.
+0003efa0: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+0003efb0: 6572 7920 3d20 6466 2e6e 7061 7274 6974  ery = df.npartit
+0003efc0: 696f 6e73 0a20 2020 2065 6c69 6620 7370  ions.    elif sp
+0003efd0: 6c69 745f 6576 6572 7920 3c20 3220 6f72  lit_every < 2 or
+0003efe0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+0003eff0: 7370 6c69 745f 6576 6572 792c 2049 6e74  split_every, Int
+0003f000: 6567 7261 6c29 3a0a 2020 2020 2020 2020  egral):.        
+0003f010: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0003f020: 2822 7370 6c69 745f 6576 6572 7920 6d75  ("split_every mu
+0003f030: 7374 2062 6520 616e 2069 6e74 6567 6572  st be an integer
+0003f040: 203e 3d20 3222 290a 0a20 2020 2023 2048   >= 2")..    # H
+0003f050: 616e 646c 6520 7365 6c65 6374 696e 6720  andle selecting 
+0003f060: 6e75 6d65 7269 6320 6461 7461 2061 6e64  numeric data and
+0003f070: 2061 7373 6f63 6961 7465 6420 6465 7072   associated depr
+0003f080: 6563 6174 696f 6e20 7761 726e 696e 670a  ecation warning.
+0003f090: 2020 2020 6d61 7962 655f 7761 726e 203d      maybe_warn =
+0003f0a0: 2046 616c 7365 0a20 2020 2069 6620 6e75   False.    if nu
+0003f0b0: 6d65 7269 635f 6f6e 6c79 2069 7320 6e6f  meric_only is no
+0003f0c0: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
+0003f0d0: 2020 6966 2050 414e 4441 535f 4754 5f32    if PANDAS_GT_2
+0003f0e0: 3030 3a0a 2020 2020 2020 2020 2020 2020  00:.            
+0003f0f0: 6e75 6d65 7269 635f 6f6e 6c79 203d 2046  numeric_only = F
+0003f100: 616c 7365 0a20 2020 2020 2020 2065 6c69  alse.        eli
+0003f110: 6620 5041 4e44 4153 5f47 545f 3135 303a  f PANDAS_GT_150:
+0003f120: 0a20 2020 2020 2020 2020 2020 206d 6179  .            may
+0003f130: 6265 5f77 6172 6e20 3d20 5472 7565 0a20  be_warn = True. 
+0003f140: 2020 2020 2020 2020 2020 206e 756d 6572             numer
+0003f150: 6963 5f6f 6e6c 7920 3d20 5472 7565 0a20  ic_only = True. 
+0003f160: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0003f170: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
+0003f180: 5f6f 6e6c 7920 3d20 5472 7565 0a0a 2020  _only = True..  
+0003f190: 2020 616c 6c5f 6e75 6d65 7269 6320 3d20    all_numeric = 
+0003f1a0: 6466 2e5f 6765 745f 6e75 6d65 7269 635f  df._get_numeric_
+0003f1b0: 6461 7461 2829 2e5f 6e61 6d65 203d 3d20  data()._name == 
+0003f1c0: 6466 2e5f 6e61 6d65 0a20 2020 2069 6620  df._name.    if 
+0003f1d0: 6d61 7962 655f 7761 726e 2061 6e64 206e  maybe_warn and n
+0003f1e0: 6f74 2061 6c6c 5f6e 756d 6572 6963 3a0a  ot all_numeric:.
+0003f1f0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+0003f200: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
+0003f210: 2020 2022 5468 6520 6465 6661 756c 7420     "The default 
+0003f220: 7661 6c75 6520 6f66 206e 756d 6572 6963  value of numeric
+0003f230: 5f6f 6e6c 7920 7769 6c6c 2062 6520 6046  _only will be `F
+0003f240: 616c 7365 6020 220a 2020 2020 2020 2020  alse` ".        
+0003f250: 2020 2020 2269 6e20 6120 6675 7475 7265      "in a future
+0003f260: 2076 6572 7369 6f6e 206f 6620 4461 736b   version of Dask
+0003f270: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
+0003f280: 4675 7475 7265 5761 726e 696e 672c 0a20  FutureWarning,. 
+0003f290: 2020 2020 2020 2029 0a0a 2020 2020 6966         )..    if
+0003f2a0: 206e 756d 6572 6963 5f6f 6e6c 7920 616e   numeric_only an
+0003f2b0: 6420 6e6f 7420 616c 6c5f 6e75 6d65 7269  d not all_numeri
+0003f2c0: 633a 0a20 2020 2020 2020 2064 6620 3d20  c:.        df = 
+0003f2d0: 6466 2e5f 6765 745f 6e75 6d65 7269 635f  df._get_numeric_
+0003f2e0: 6461 7461 2829 0a0a 2020 2020 6966 2073  data()..    if s
+0003f2f0: 6361 6c61 7220 616e 6420 6c65 6e28 6466  calar and len(df
+0003f300: 2e63 6f6c 756d 6e73 2920 213d 2032 3a0a  .columns) != 2:.
+0003f310: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0003f320: 6c75 6545 7272 6f72 2822 7363 616c 6172  lueError("scalar
+0003f330: 206f 6e6c 7920 7661 6c69 6420 666f 7220   only valid for 
+0003f340: 3220 636f 6c75 6d6e 2064 6174 6166 7261  2 column datafra
+0003f350: 6d65 2229 0a0a 2020 2020 746f 6b65 6e20  me")..    token 
+0003f360: 3d20 746f 6b65 6e69 7a65 2864 662c 206d  = tokenize(df, m
+0003f370: 696e 5f70 6572 696f 6473 2c20 7363 616c  in_periods, scal
+0003f380: 6172 2c20 7370 6c69 745f 6576 6572 7929  ar, split_every)
+0003f390: 0a0a 2020 2020 6675 6e63 6e61 6d65 203d  ..    funcname =
+0003f3a0: 2022 636f 7272 2220 6966 2063 6f72 7220   "corr" if corr 
+0003f3b0: 656c 7365 2022 636f 7622 0a20 2020 2061  else "cov".    a
+0003f3c0: 203d 2066 227b 6675 6e63 6e61 6d65 7d2d   = f"{funcname}-
+0003f3d0: 6368 756e 6b2d 7b64 662e 5f6e 616d 657d  chunk-{df._name}
+0003f3e0: 220a 2020 2020 6473 6b20 3d20 7b0a 2020  ".    dsk = {.  
+0003f3f0: 2020 2020 2020 2861 2c20 6929 3a20 285f        (a, i): (_
+0003f400: 636f 765f 636f 7272 5f63 6875 6e6b 2c20  cov_corr_chunk, 
+0003f410: 662c 2063 6f72 7229 2066 6f72 2028 692c  f, corr) for (i,
+0003f420: 2066 2920 696e 2065 6e75 6d65 7261 7465   f) in enumerate
+0003f430: 2864 662e 5f5f 6461 736b 5f6b 6579 735f  (df.__dask_keys_
+0003f440: 5f28 2929 0a20 2020 207d 0a0a 2020 2020  _()).    }..    
+0003f450: 7072 6566 6978 203d 2066 227b 6675 6e63  prefix = f"{func
+0003f460: 6e61 6d65 7d2d 636f 6d62 696e 652d 7b64  name}-combine-{d
+0003f470: 662e 5f6e 616d 657d 2d22 0a20 2020 206b  f._name}-".    k
+0003f480: 203d 2064 662e 6e70 6172 7469 7469 6f6e   = df.npartition
+0003f490: 730a 2020 2020 6220 3d20 610a 2020 2020  s.    b = a.    
+0003f4a0: 6465 7074 6820 3d20 300a 2020 2020 7768  depth = 0.    wh
+0003f4b0: 696c 6520 6b20 3e20 7370 6c69 745f 6576  ile k > split_ev
+0003f4c0: 6572 793a 0a20 2020 2020 2020 2062 203d  ery:.        b =
+0003f4d0: 2070 7265 6669 7820 2b20 7374 7228 6465   prefix + str(de
+0003f4e0: 7074 6829 0a20 2020 2020 2020 2066 6f72  pth).        for
+0003f4f0: 2070 6172 745f 692c 2069 6e64 7320 696e   part_i, inds in
+0003f500: 2065 6e75 6d65 7261 7465 2870 6172 7469   enumerate(parti
+0003f510: 7469 6f6e 5f61 6c6c 2873 706c 6974 5f65  tion_all(split_e
+0003f520: 7665 7279 2c20 7261 6e67 6528 6b29 2929  very, range(k)))
+0003f530: 3a0a 2020 2020 2020 2020 2020 2020 6473  :.            ds
+0003f540: 6b5b 2862 2c20 7061 7274 5f69 295d 203d  k[(b, part_i)] =
+0003f550: 2028 5f63 6f76 5f63 6f72 725f 636f 6d62   (_cov_corr_comb
+0003f560: 696e 652c 205b 2861 2c20 6929 2066 6f72  ine, [(a, i) for
+0003f570: 2069 2069 6e20 696e 6473 5d2c 2063 6f72   i in inds], cor
+0003f580: 7229 0a20 2020 2020 2020 206b 203d 2070  r).        k = p
+0003f590: 6172 745f 6920 2b20 310a 2020 2020 2020  art_i + 1.      
+0003f5a0: 2020 6120 3d20 620a 2020 2020 2020 2020    a = b.        
+0003f5b0: 6465 7074 6820 2b3d 2031 0a0a 2020 2020  depth += 1..    
+0003f5c0: 6e61 6d65 203d 2066 227b 6675 6e63 6e61  name = f"{funcna
+0003f5d0: 6d65 7d2d 7b74 6f6b 656e 7d22 0a20 2020  me}-{token}".   
+0003f5e0: 2064 736b 5b28 6e61 6d65 2c20 3029 5d20   dsk[(name, 0)] 
+0003f5f0: 3d20 280a 2020 2020 2020 2020 5f63 6f76  = (.        _cov
+0003f600: 5f63 6f72 725f 6167 672c 0a20 2020 2020  _corr_agg,.     
+0003f610: 2020 205b 2861 2c20 6929 2066 6f72 2069     [(a, i) for i
+0003f620: 2069 6e20 7261 6e67 6528 6b29 5d2c 0a20   in range(k)],. 
+0003f630: 2020 2020 2020 2064 662e 636f 6c75 6d6e         df.column
+0003f640: 732c 0a20 2020 2020 2020 206d 696e 5f70  s,.        min_p
+0003f650: 6572 696f 6473 2c0a 2020 2020 2020 2020  eriods,.        
+0003f660: 636f 7272 2c0a 2020 2020 2020 2020 7363  corr,.        sc
+0003f670: 616c 6172 2c0a 2020 2020 2020 2020 6466  alar,.        df
+0003f680: 2e5f 6d65 7461 2c0a 2020 2020 290a 2020  ._meta,.    ).  
+0003f690: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+0003f6a0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+0003f6b0: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
+0003f6c0: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
+0003f6d0: 733d 5b64 665d 290a 2020 2020 6966 2073  s=[df]).    if s
+0003f6e0: 6361 6c61 723a 0a20 2020 2020 2020 2072  calar:.        r
+0003f6f0: 6574 7572 6e20 5363 616c 6172 2867 7261  eturn Scalar(gra
+0003f700: 7068 2c20 6e61 6d65 2c20 2266 3822 290a  ph, name, "f8").
+0003f710: 2020 2020 6d65 7461 203d 206d 616b 655f      meta = make_
+0003f720: 6d65 7461 280a 2020 2020 2020 2020 5b28  meta(.        [(
+0003f730: 632c 2022 6638 2229 2066 6f72 2063 2069  c, "f8") for c i
+0003f740: 6e20 6466 2e63 6f6c 756d 6e73 5d2c 0a20  n df.columns],. 
+0003f750: 2020 2020 2020 2069 6e64 6578 3d6d 6574         index=met
+0003f760: 615f 7365 7269 6573 5f63 6f6e 7374 7275  a_series_constru
+0003f770: 6374 6f72 2864 6629 2864 662e 636f 6c75  ctor(df)(df.colu
+0003f780: 6d6e 7329 2c0a 2020 2020 2020 2020 7061  mns),.        pa
+0003f790: 7265 6e74 5f6d 6574 613d 6466 2e5f 6d65  rent_meta=df._me
+0003f7a0: 7461 2c0a 2020 2020 290a 2020 2020 7265  ta,.    ).    re
+0003f7b0: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
+0003f7c0: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
+0003f7d0: 6d65 7461 2c20 2864 662e 636f 6c75 6d6e  meta, (df.column
+0003f7e0: 732e 6d69 6e28 292c 2064 662e 636f 6c75  s.min(), df.colu
+0003f7f0: 6d6e 732e 6d61 7828 2929 290a 0a0a 6465  mns.max()))...de
+0003f800: 6620 5f63 6f76 5f63 6f72 725f 6368 756e  f _cov_corr_chun
+0003f810: 6b28 6466 2c20 636f 7272 3d46 616c 7365  k(df, corr=False
+0003f820: 293a 0a20 2020 2022 2222 4368 756e 6b20  ):.    """Chunk 
+0003f830: 7061 7274 206f 6620 6120 636f 7661 7269  part of a covari
+0003f840: 616e 6365 206f 7220 636f 7272 656c 6174  ance or correlat
+0003f850: 696f 6e20 636f 6d70 7574 6174 696f 6e22  ion computation"
+0003f860: 2222 0a20 2020 2073 6861 7065 203d 2028  "".    shape = (
+0003f870: 6466 2e73 6861 7065 5b31 5d2c 2064 662e  df.shape[1], df.
+0003f880: 7368 6170 655b 315d 290a 2020 2020 6466  shape[1]).    df
+0003f890: 203d 2064 662e 6173 7479 7065 2822 666c   = df.astype("fl
+0003f8a0: 6f61 7436 3422 2c20 636f 7079 3d46 616c  oat64", copy=Fal
+0003f8b0: 7365 290a 2020 2020 7375 6d73 203d 206e  se).    sums = n
+0003f8c0: 702e 7a65 726f 735f 6c69 6b65 2864 662e  p.zeros_like(df.
+0003f8d0: 7661 6c75 6573 2c20 7368 6170 653d 7368  values, shape=sh
+0003f8e0: 6170 6529 0a20 2020 2063 6f75 6e74 7320  ape).    counts 
+0003f8f0: 3d20 6e70 2e7a 6572 6f73 5f6c 696b 6528  = np.zeros_like(
+0003f900: 6466 2e76 616c 7565 732c 2073 6861 7065  df.values, shape
+0003f910: 3d73 6861 7065 290a 2020 2020 666f 7220  =shape).    for 
+0003f920: 6964 7820 696e 2072 616e 6765 286c 656e  idx in range(len
+0003f930: 2864 662e 636f 6c75 6d6e 7329 293a 0a20  (df.columns)):. 
+0003f940: 2020 2020 2020 206d 6173 6b20 3d20 6466         mask = df
+0003f950: 2e69 6c6f 635b 3a2c 2069 6478 5d2e 6e6f  .iloc[:, idx].no
+0003f960: 746e 756c 6c28 290a 2020 2020 2020 2020  tnull().        
+0003f970: 7375 6d73 5b69 6478 5d20 3d20 6466 5b6d  sums[idx] = df[m
+0003f980: 6173 6b5d 2e73 756d 2829 2e76 616c 7565  ask].sum().value
+0003f990: 730a 2020 2020 2020 2020 636f 756e 7473  s.        counts
+0003f9a0: 5b69 6478 5d20 3d20 6466 5b6d 6173 6b5d  [idx] = df[mask]
+0003f9b0: 2e63 6f75 6e74 2829 2e76 616c 7565 730a  .count().values.
+0003f9c0: 2020 2020 636f 7620 3d20 6466 2e63 6f76      cov = df.cov
+0003f9d0: 2829 2e76 616c 7565 730a 2020 2020 6474  ().values.    dt
+0003f9e0: 7970 6520 3d20 5b28 2273 756d 222c 2073  ype = [("sum", s
+0003f9f0: 756d 732e 6474 7970 6529 2c20 2822 636f  ums.dtype), ("co
+0003fa00: 756e 7422 2c20 636f 756e 7473 2e64 7479  unt", counts.dty
+0003fa10: 7065 292c 2028 2263 6f76 222c 2063 6f76  pe), ("cov", cov
+0003fa20: 2e64 7479 7065 295d 0a20 2020 2069 6620  .dtype)].    if 
+0003fa30: 636f 7272 3a0a 2020 2020 2020 2020 7769  corr:.        wi
+0003fa40: 7468 2077 6172 6e69 6e67 732e 6361 7463  th warnings.catc
+0003fa50: 685f 7761 726e 696e 6773 2872 6563 6f72  h_warnings(recor
+0003fa60: 643d 5472 7565 293a 0a20 2020 2020 2020  d=True):.       
+0003fa70: 2020 2020 2077 6172 6e69 6e67 732e 7369       warnings.si
+0003fa80: 6d70 6c65 6669 6c74 6572 2822 616c 7761  mplefilter("alwa
+0003fa90: 7973 2229 0a20 2020 2020 2020 2020 2020  ys").           
+0003faa0: 206d 7520 3d20 2873 756d 7320 2f20 636f   mu = (sums / co
+0003fab0: 756e 7473 292e 540a 2020 2020 2020 2020  unts).T.        
+0003fac0: 6d20 3d20 6e70 2e7a 6572 6f73 5f6c 696b  m = np.zeros_lik
+0003fad0: 6528 6466 2e76 616c 7565 732c 2073 6861  e(df.values, sha
+0003fae0: 7065 3d73 6861 7065 290a 2020 2020 2020  pe=shape).      
+0003faf0: 2020 6d61 736b 203d 2064 662e 6973 6e75    mask = df.isnu
+0003fb00: 6c6c 2829 2e76 616c 7565 730a 2020 2020  ll().values.    
+0003fb10: 2020 2020 666f 7220 6964 7820 696e 2072      for idx in r
+0003fb20: 616e 6765 286c 656e 2864 662e 636f 6c75  ange(len(df.colu
+0003fb30: 6d6e 7329 293a 0a20 2020 2020 2020 2020  mns)):.         
+0003fb40: 2020 2023 2041 766f 6964 2075 7369 6e67     # Avoid using
+0003fb50: 2075 6675 6e63 2e6f 7574 6572 2028 6e6f   ufunc.outer (no
+0003fb60: 7420 7375 7070 6f72 7465 6420 6279 2063  t supported by c
+0003fb70: 7570 7929 0a20 2020 2020 2020 2020 2020  upy).           
+0003fb80: 206d 755f 6469 7363 7265 7061 6e63 7920   mu_discrepancy 
+0003fb90: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+0003fba0: 2020 2020 6e70 2e73 7562 7472 6163 7428      np.subtract(
+0003fbb0: 6466 2e69 6c6f 635b 3a2c 2069 6478 5d2e  df.iloc[:, idx].
+0003fbc0: 7661 6c75 6573 5b3a 2c20 4e6f 6e65 5d2c  values[:, None],
+0003fbd0: 206d 755b 6964 785d 5b4e 6f6e 652c 203a   mu[idx][None, :
+0003fbe0: 5d29 202a 2a20 320a 2020 2020 2020 2020  ]) ** 2.        
+0003fbf0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0003fc00: 2020 6d75 5f64 6973 6372 6570 616e 6379    mu_discrepancy
+0003fc10: 5b6d 6173 6b5d 203d 206e 702e 6e61 6e0a  [mask] = np.nan.
+0003fc20: 2020 2020 2020 2020 2020 2020 6d5b 6964              m[id
+0003fc30: 785d 203d 206e 702e 6e61 6e73 756d 286d  x] = np.nansum(m
+0003fc40: 755f 6469 7363 7265 7061 6e63 792c 2061  u_discrepancy, a
+0003fc50: 7869 733d 3029 0a20 2020 2020 2020 206d  xis=0).        m
+0003fc60: 203d 206d 2e54 0a20 2020 2020 2020 2064   = m.T.        d
+0003fc70: 7479 7065 2e61 7070 656e 6428 2822 6d22  type.append(("m"
+0003fc80: 2c20 6d2e 6474 7970 6529 290a 0a20 2020  , m.dtype))..   
+0003fc90: 206f 7574 203d 207b 2273 756d 223a 2073   out = {"sum": s
+0003fca0: 756d 732c 2022 636f 756e 7422 3a20 636f  ums, "count": co
+0003fcb0: 756e 7473 2c20 2263 6f76 223a 2063 6f76  unts, "cov": cov
+0003fcc0: 202a 2028 636f 756e 7473 202d 2031 297d   * (counts - 1)}
+0003fcd0: 0a20 2020 2069 6620 636f 7272 3a0a 2020  .    if corr:.  
+0003fce0: 2020 2020 2020 6f75 745b 226d 225d 203d        out["m"] =
+0003fcf0: 206d 0a20 2020 2072 6574 7572 6e20 6f75   m.    return ou
+0003fd00: 740a 0a0a 6465 6620 5f63 6f76 5f63 6f72  t...def _cov_cor
+0003fd10: 725f 636f 6d62 696e 6528 6461 7461 5f69  r_combine(data_i
+0003fd20: 6e2c 2063 6f72 723d 4661 6c73 6529 3a0a  n, corr=False):.
+0003fd30: 2020 2020 6461 7461 203d 207b 2273 756d      data = {"sum
+0003fd40: 223a 204e 6f6e 652c 2022 636f 756e 7422  ": None, "count"
+0003fd50: 3a20 4e6f 6e65 2c20 2263 6f76 223a 204e  : None, "cov": N
+0003fd60: 6f6e 657d 0a20 2020 2069 6620 636f 7272  one}.    if corr
+0003fd70: 3a0a 2020 2020 2020 2020 6461 7461 5b22  :.        data["
+0003fd80: 6d22 5d20 3d20 4e6f 6e65 0a0a 2020 2020  m"] = None..    
+0003fd90: 666f 7220 6b20 696e 2064 6174 612e 6b65  for k in data.ke
+0003fda0: 7973 2829 3a0a 2020 2020 2020 2020 6461  ys():.        da
+0003fdb0: 7461 5b6b 5d20 3d20 5b64 5b6b 5d20 666f  ta[k] = [d[k] fo
+0003fdc0: 7220 6420 696e 2064 6174 615f 696e 5d0a  r d in data_in].
+0003fdd0: 2020 2020 2020 2020 6461 7461 5b6b 5d20          data[k] 
+0003fde0: 3d20 6e70 2e63 6f6e 6361 7465 6e61 7465  = np.concatenate
+0003fdf0: 2864 6174 615b 6b5d 292e 7265 7368 6170  (data[k]).reshap
+0003fe00: 6528 286c 656e 2864 6174 615b 6b5d 292c  e((len(data[k]),
+0003fe10: 2920 2b20 6461 7461 5b6b 5d5b 305d 2e73  ) + data[k][0].s
+0003fe20: 6861 7065 290a 0a20 2020 2073 756d 7320  hape)..    sums 
+0003fe30: 3d20 6e70 2e6e 616e 5f74 6f5f 6e75 6d28  = np.nan_to_num(
+0003fe40: 6461 7461 5b22 7375 6d22 5d29 0a20 2020  data["sum"]).   
+0003fe50: 2063 6f75 6e74 7320 3d20 6461 7461 5b22   counts = data["
+0003fe60: 636f 756e 7422 5d0a 0a20 2020 2063 756d  count"]..    cum
+0003fe70: 5f73 756d 7320 3d20 6e70 2e63 756d 7375  _sums = np.cumsu
+0003fe80: 6d28 7375 6d73 2c20 3029 0a20 2020 2063  m(sums, 0).    c
+0003fe90: 756d 5f63 6f75 6e74 7320 3d20 6e70 2e63  um_counts = np.c
+0003fea0: 756d 7375 6d28 636f 756e 7473 2c20 3029  umsum(counts, 0)
+0003feb0: 0a0a 2020 2020 7331 203d 2063 756d 5f73  ..    s1 = cum_s
+0003fec0: 756d 735b 3a2d 315d 0a20 2020 2073 3220  ums[:-1].    s2 
+0003fed0: 3d20 7375 6d73 5b31 3a5d 0a20 2020 206e  = sums[1:].    n
+0003fee0: 3120 3d20 6375 6d5f 636f 756e 7473 5b3a  1 = cum_counts[:
+0003fef0: 2d31 5d0a 2020 2020 6e32 203d 2063 6f75  -1].    n2 = cou
+0003ff00: 6e74 735b 313a 5d0a 2020 2020 7769 7468  nts[1:].    with
+0003ff10: 206e 702e 6572 7273 7461 7465 2869 6e76   np.errstate(inv
+0003ff20: 616c 6964 3d22 6967 6e6f 7265 2229 3a0a  alid="ignore"):.
+0003ff30: 2020 2020 2020 2020 6420 3d20 2873 3220          d = (s2 
+0003ff40: 2f20 6e32 2920 2d20 2873 3120 2f20 6e31  / n2) - (s1 / n1
+0003ff50: 290a 2020 2020 2020 2020 4320 3d20 6e70  ).        C = np
+0003ff60: 2e6e 616e 7375 6d28 0a20 2020 2020 2020  .nansum(.       
+0003ff70: 2020 2020 2028 6e31 202a 206e 3229 202f       (n1 * n2) /
+0003ff80: 2028 6e31 202b 206e 3229 202a 2028 6420   (n1 + n2) * (d 
+0003ff90: 2a20 642e 7472 616e 7370 6f73 6528 2830  * d.transpose((0
+0003ffa0: 2c20 322c 2031 2929 292c 2030 0a20 2020  , 2, 1))), 0.   
+0003ffb0: 2020 2020 2029 202b 206e 702e 6e61 6e73       ) + np.nans
+0003ffc0: 756d 2864 6174 615b 2263 6f76 225d 2c20  um(data["cov"], 
+0003ffd0: 3029 0a0a 2020 2020 6f75 7420 3d20 7b22  0)..    out = {"
+0003ffe0: 7375 6d22 3a20 6375 6d5f 7375 6d73 5b2d  sum": cum_sums[-
+0003fff0: 315d 2c20 2263 6f75 6e74 223a 2063 756d  1], "count": cum
+00040000: 5f63 6f75 6e74 735b 2d31 5d2c 2022 636f  _counts[-1], "co
+00040010: 7622 3a20 437d 0a0a 2020 2020 6966 2063  v": C}..    if c
+00040020: 6f72 723a 0a20 2020 2020 2020 206e 6f62  orr:.        nob
+00040030: 7320 3d20 6e70 2e77 6865 7265 2863 756d  s = np.where(cum
+00040040: 5f63 6f75 6e74 735b 2d31 5d2c 2063 756d  _counts[-1], cum
+00040050: 5f63 6f75 6e74 735b 2d31 5d2c 206e 702e  _counts[-1], np.
+00040060: 6e61 6e29 0a20 2020 2020 2020 206d 7520  nan).        mu 
+00040070: 3d20 6375 6d5f 7375 6d73 5b2d 315d 202f  = cum_sums[-1] /
+00040080: 206e 6f62 730a 2020 2020 2020 2020 636f   nobs.        co
+00040090: 756e 7473 5f6e 6120 3d20 6e70 2e77 6865  unts_na = np.whe
+000400a0: 7265 2863 6f75 6e74 732c 2063 6f75 6e74  re(counts, count
+000400b0: 732c 206e 702e 6e61 6e29 0a20 2020 2020  s, np.nan).     
+000400c0: 2020 206d 203d 206e 702e 6e61 6e73 756d     m = np.nansum
+000400d0: 2864 6174 615b 226d 225d 202b 2063 6f75  (data["m"] + cou
+000400e0: 6e74 7320 2a20 2873 756d 7320 2f20 636f  nts * (sums / co
+000400f0: 756e 7473 5f6e 6120 2d20 6d75 2920 2a2a  unts_na - mu) **
+00040100: 2032 2c20 6178 6973 3d30 290a 2020 2020   2, axis=0).    
+00040110: 2020 2020 6f75 745b 226d 225d 203d 206d      out["m"] = m
+00040120: 0a20 2020 2072 6574 7572 6e20 6f75 740a  .    return out.
+00040130: 0a0a 6465 6620 5f63 6f76 5f63 6f72 725f  ..def _cov_corr_
+00040140: 6167 6728 6461 7461 2c20 636f 6c73 2c20  agg(data, cols, 
+00040150: 6d69 6e5f 7065 7269 6f64 733d 322c 2063  min_periods=2, c
+00040160: 6f72 723d 4661 6c73 652c 2073 6361 6c61  orr=False, scala
+00040170: 723d 4661 6c73 652c 206c 696b 655f 6466  r=False, like_df
+00040180: 3d4e 6f6e 6529 3a0a 2020 2020 6f75 7420  =None):.    out 
+00040190: 3d20 5f63 6f76 5f63 6f72 725f 636f 6d62  = _cov_corr_comb
+000401a0: 696e 6528 6461 7461 2c20 636f 7272 290a  ine(data, corr).
+000401b0: 2020 2020 636f 756e 7473 203d 206f 7574      counts = out
+000401c0: 5b22 636f 756e 7422 5d0a 2020 2020 4320  ["count"].    C 
+000401d0: 3d20 6f75 745b 2263 6f76 225d 0a20 2020  = out["cov"].   
+000401e0: 2043 5b63 6f75 6e74 7320 3c20 6d69 6e5f   C[counts < min_
+000401f0: 7065 7269 6f64 735d 203d 206e 702e 6e61  periods] = np.na
+00040200: 6e0a 2020 2020 6966 2063 6f72 723a 0a20  n.    if corr:. 
+00040210: 2020 2020 2020 206d 3220 3d20 6f75 745b         m2 = out[
+00040220: 226d 225d 0a20 2020 2020 2020 2064 656e  "m"].        den
+00040230: 203d 206e 702e 7371 7274 286d 3220 2a20   = np.sqrt(m2 * 
+00040240: 6d32 2e54 290a 2020 2020 656c 7365 3a0a  m2.T).    else:.
+00040250: 2020 2020 2020 2020 6465 6e20 3d20 6e70          den = np
+00040260: 2e77 6865 7265 2863 6f75 6e74 732c 2063  .where(counts, c
+00040270: 6f75 6e74 732c 206e 702e 6e61 6e29 202d  ounts, np.nan) -
+00040280: 2031 0a20 2020 2077 6974 6820 6e70 2e65   1.    with np.e
+00040290: 7272 7374 6174 6528 696e 7661 6c69 643d  rrstate(invalid=
+000402a0: 2269 676e 6f72 6522 2c20 6469 7669 6465  "ignore", divide
+000402b0: 3d22 6967 6e6f 7265 2229 3a0a 2020 2020  ="ignore"):.    
+000402c0: 2020 2020 6d61 7420 3d20 4320 2f20 6465      mat = C / de
+000402d0: 6e0a 2020 2020 6966 2073 6361 6c61 723a  n.    if scalar:
+000402e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000402f0: 666c 6f61 7428 6d61 745b 302c 2031 5d29  float(mat[0, 1])
+00040300: 0a20 2020 2072 6574 7572 6e20 2870 642e  .    return (pd.
+00040310: 4461 7461 4672 616d 6520 6966 206c 696b  DataFrame if lik
+00040320: 655f 6466 2069 7320 4e6f 6e65 2065 6c73  e_df is None els
+00040330: 6520 6d65 7461 5f66 7261 6d65 5f63 6f6e  e meta_frame_con
+00040340: 7374 7275 6374 6f72 286c 696b 655f 6466  structor(like_df
+00040350: 2929 280a 2020 2020 2020 2020 6d61 742c  ))(.        mat,
+00040360: 2063 6f6c 756d 6e73 3d63 6f6c 732c 2069   columns=cols, i
+00040370: 6e64 6578 3d63 6f6c 730a 2020 2020 290a  ndex=cols.    ).
+00040380: 0a0a 6465 6620 7064 5f73 706c 6974 2864  ..def pd_split(d
+00040390: 662c 2070 2c20 7261 6e64 6f6d 5f73 7461  f, p, random_sta
+000403a0: 7465 3d4e 6f6e 652c 2073 6875 6666 6c65  te=None, shuffle
+000403b0: 3d46 616c 7365 293a 0a20 2020 2022 2222  =False):.    """
+000403c0: 5370 6c69 7420 4461 7461 4672 616d 6520  Split DataFrame 
+000403d0: 696e 746f 206d 756c 7469 706c 6520 7069  into multiple pi
+000403e0: 6563 6573 2070 7365 7564 6f72 616e 646f  eces pseudorando
+000403f0: 6d6c 790a 0a20 2020 203e 3e3e 2064 6620  mly..    >>> df 
+00040400: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+00040410: 2761 273a 205b 312c 2032 2c20 332c 2034  'a': [1, 2, 3, 4
+00040420: 2c20 352c 2036 5d2c 0a20 2020 202e 2e2e  , 5, 6],.    ...
+00040430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040440: 2020 2020 2762 273a 205b 322c 2033 2c20      'b': [2, 3, 
+00040450: 342c 2035 2c20 362c 2037 5d7d 290a 0a20  4, 5, 6, 7]}).. 
+00040460: 2020 203e 3e3e 2061 2c20 6220 3d20 7064     >>> a, b = pd
+00040470: 5f73 706c 6974 280a 2020 2020 2e2e 2e20  _split(.    ... 
+00040480: 2020 2020 6466 2c20 5b30 2e35 2c20 302e      df, [0.5, 0.
+00040490: 355d 2c20 7261 6e64 6f6d 5f73 7461 7465  5], random_state
+000404a0: 3d31 3233 2c20 7368 7566 666c 653d 5472  =123, shuffle=Tr
+000404b0: 7565 0a20 2020 202e 2e2e 2029 2020 2320  ue.    ... )  # 
+000404c0: 726f 7567 686c 7920 3530 2f35 3020 7370  roughly 50/50 sp
+000404d0: 6c69 740a 2020 2020 3e3e 3e20 610a 2020  lit.    >>> a.  
+000404e0: 2020 2020 2061 2020 620a 2020 2020 3320       a  b.    3 
+000404f0: 2034 2020 350a 2020 2020 3020 2031 2020   4  5.    0  1  
+00040500: 320a 2020 2020 3520 2036 2020 370a 2020  2.    5  6  7.  
+00040510: 2020 3e3e 3e20 620a 2020 2020 2020 2061    >>> b.       a
+00040520: 2020 620a 2020 2020 3120 2032 2020 330a    b.    1  2  3.
+00040530: 2020 2020 3420 2035 2020 360a 2020 2020      4  5  6.    
+00040540: 3220 2033 2020 340a 2020 2020 2222 220a  2  3  4.    """.
+00040550: 2020 2020 7020 3d20 6c69 7374 2870 290a      p = list(p).
+00040560: 2020 2020 6966 2073 6875 6666 6c65 3a0a      if shuffle:.
+00040570: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+00040580: 7369 6e73 7461 6e63 6528 7261 6e64 6f6d  sinstance(random
+00040590: 5f73 7461 7465 2c20 6e70 2e72 616e 646f  _state, np.rando
+000405a0: 6d2e 5261 6e64 6f6d 5374 6174 6529 3a0a  m.RandomState):.
+000405b0: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
+000405c0: 6f6d 5f73 7461 7465 203d 206e 702e 7261  om_state = np.ra
+000405d0: 6e64 6f6d 2e52 616e 646f 6d53 7461 7465  ndom.RandomState
+000405e0: 2872 616e 646f 6d5f 7374 6174 6529 0a20  (random_state). 
+000405f0: 2020 2020 2020 2064 6620 3d20 6466 2e73         df = df.s
+00040600: 616d 706c 6528 6672 6163 3d31 2e30 2c20  ample(frac=1.0, 
+00040610: 7261 6e64 6f6d 5f73 7461 7465 3d72 616e  random_state=ran
+00040620: 646f 6d5f 7374 6174 6529 0a20 2020 2069  dom_state).    i
+00040630: 6e64 6578 203d 2070 7365 7564 6f72 616e  ndex = pseudoran
+00040640: 646f 6d28 6c65 6e28 6466 292c 2070 2c20  dom(len(df), p, 
+00040650: 7261 6e64 6f6d 5f73 7461 7465 290a 2020  random_state).  
+00040660: 2020 7265 7475 726e 205b 6466 2e69 6c6f    return [df.ilo
+00040670: 635b 696e 6465 7820 3d3d 2069 5d20 666f  c[index == i] fo
+00040680: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+00040690: 2870 2929 5d0a 0a0a 6465 6620 5f74 616b  (p))]...def _tak
+000406a0: 655f 6c61 7374 2861 2c20 736b 6970 6e61  e_last(a, skipna
+000406b0: 3d54 7275 6529 3a0a 2020 2020 2222 220a  =True):.    """.
+000406c0: 2020 2020 7461 6b65 206c 6173 7420 726f      take last ro
+000406d0: 7720 2853 6572 6965 7329 206f 6620 4461  w (Series) of Da
+000406e0: 7461 4672 616d 6520 2f20 6c61 7374 2076  taFrame / last v
+000406f0: 616c 7565 206f 6620 5365 7269 6573 0a20  alue of Series. 
+00040700: 2020 2063 6f6e 7369 6465 7269 6e67 204e     considering N
+00040710: 614e 2e0a 0a20 2020 2050 6172 616d 6574  aN...    Paramet
+00040720: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+00040730: 2d2d 0a20 2020 2061 203a 2070 642e 4461  --.    a : pd.Da
+00040740: 7461 4672 616d 6520 6f72 2070 642e 5365  taFrame or pd.Se
+00040750: 7269 6573 0a20 2020 2073 6b69 706e 6120  ries.    skipna 
+00040760: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
+00040770: 5472 7565 0a20 2020 2020 2020 2057 6865  True.        Whe
+00040780: 7468 6572 2074 6f20 6578 636c 7564 6520  ther to exclude 
+00040790: 4e61 4e0a 0a20 2020 2022 2222 0a0a 2020  NaN..    """..  
+000407a0: 2020 6465 6620 5f6c 6173 745f 7661 6c69    def _last_vali
+000407b0: 6428 7329 3a0a 2020 2020 2020 2020 666f  d(s):.        fo
+000407c0: 7220 6920 696e 2072 616e 6765 2831 2c20  r i in range(1, 
+000407d0: 6d69 6e28 3130 2c20 6c65 6e28 7329 202b  min(10, len(s) +
+000407e0: 2031 2929 3a0a 2020 2020 2020 2020 2020   1)):.          
+000407f0: 2020 7661 6c20 3d20 732e 696c 6f63 5b2d    val = s.iloc[-
+00040800: 695d 0a20 2020 2020 2020 2020 2020 2069  i].            i
+00040810: 6620 6e6f 7420 7064 2e69 736e 756c 6c28  f not pd.isnull(
+00040820: 7661 6c29 3a0a 2020 2020 2020 2020 2020  val):.          
+00040830: 2020 2020 2020 7265 7475 726e 2076 616c        return val
+00040840: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00040850: 2020 2020 2020 2020 2020 206e 6f6e 6e75             nonnu
+00040860: 6c6c 203d 2073 5b73 2e6e 6f74 6e61 2829  ll = s[s.notna()
+00040870: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
+00040880: 206e 6f74 206e 6f6e 6e75 6c6c 2e65 6d70   not nonnull.emp
+00040890: 7479 3a0a 2020 2020 2020 2020 2020 2020  ty:.            
+000408a0: 2020 2020 7265 7475 726e 206e 6f6e 6e75      return nonnu
+000408b0: 6c6c 2e69 6c6f 635b 2d31 5d0a 2020 2020  ll.iloc[-1].    
+000408c0: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
+000408d0: 0a20 2020 2069 6620 736b 6970 6e61 2069  .    if skipna i
+000408e0: 7320 4661 6c73 653a 0a20 2020 2020 2020  s False:.       
+000408f0: 2072 6574 7572 6e20 612e 696c 6f63 5b2d   return a.iloc[-
+00040900: 315d 0a20 2020 2065 6c73 653a 0a20 2020  1].    else:.   
+00040910: 2020 2020 2023 2074 616b 6520 6c61 7374       # take last
+00040920: 2076 616c 6964 2076 616c 7565 2065 7863   valid value exc
+00040930: 6c75 6469 6e67 204e 614e 2c20 4e61 4e20  luding NaN, NaN 
+00040940: 6c6f 6361 7469 6f6e 206d 6179 2062 6520  location may be 
+00040950: 6469 6666 6572 656e 740a 2020 2020 2020  different.      
+00040960: 2020 2320 696e 2065 6163 6820 636f 6c75    # in each colu
+00040970: 6d6e 0a20 2020 2020 2020 2069 6620 6973  mn.        if is
+00040980: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
+00040990: 6129 3a0a 2020 2020 2020 2020 2020 2020  a):.            
+000409a0: 2320 6372 6561 7465 2053 6572 6965 7320  # create Series 
+000409b0: 6672 6f6d 2061 7070 726f 7072 6961 7465  from appropriate
+000409c0: 2062 6163 6b65 6e64 2064 6174 6166 7261   backend datafra
+000409d0: 6d65 206c 6962 7261 7279 0a20 2020 2020  me library.     
+000409e0: 2020 2020 2020 2073 6572 6965 735f 7479         series_ty
+000409f0: 7020 3d20 7479 7065 2861 2e69 6c6f 635b  p = type(a.iloc[
+00040a00: 303a 312c 2030 5d29 0a20 2020 2020 2020  0:1, 0]).       
+00040a10: 2020 2020 2069 6620 612e 656d 7074 793a       if a.empty:
+00040a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040a30: 2072 6574 7572 6e20 7365 7269 6573 5f74   return series_t
+00040a40: 7970 285b 5d2c 2064 7479 7065 3d22 666c  yp([], dtype="fl
+00040a50: 6f61 7422 290a 2020 2020 2020 2020 2020  oat").          
+00040a60: 2020 7265 7475 726e 2073 6572 6965 735f    return series_
+00040a70: 7479 7028 0a20 2020 2020 2020 2020 2020  typ(.           
+00040a80: 2020 2020 205b 5f6c 6173 745f 7661 6c69       [_last_vali
+00040a90: 6428 612e 696c 6f63 5b3a 2c20 695d 2920  d(a.iloc[:, i]) 
+00040aa0: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
+00040ab0: 656e 2861 2e63 6f6c 756d 6e73 2929 5d2c  en(a.columns))],
+00040ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040ad0: 2069 6e64 6578 3d61 2e63 6f6c 756d 6e73   index=a.columns
+00040ae0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00040af0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00040b00: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00040b10: 205f 6c61 7374 5f76 616c 6964 2861 290a   _last_valid(a).
+00040b20: 0a0a 6465 6620 6368 6563 6b5f 6469 7669  ..def check_divi
+00040b30: 7369 6f6e 7328 6469 7669 7369 6f6e 7329  sions(divisions)
+00040b40: 3a0a 2020 2020 6966 206e 6f74 2069 7369  :.    if not isi
+00040b50: 6e73 7461 6e63 6528 6469 7669 7369 6f6e  nstance(division
+00040b60: 732c 2028 6c69 7374 2c20 7475 706c 6529  s, (list, tuple)
+00040b70: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+00040b80: 2056 616c 7565 4572 726f 7228 224e 6577   ValueError("New
+00040b90: 2064 6976 6973 696f 6e20 6d75 7374 2062   division must b
+00040ba0: 6520 6c69 7374 206f 7220 7475 706c 6522  e list or tuple"
+00040bb0: 290a 2020 2020 6469 7669 7369 6f6e 7320  ).    divisions 
+00040bc0: 3d20 6c69 7374 2864 6976 6973 696f 6e73  = list(divisions
+00040bd0: 290a 2020 2020 6966 206c 656e 2864 6976  ).    if len(div
+00040be0: 6973 696f 6e73 2920 3d3d 2030 3a0a 2020  isions) == 0:.  
+00040bf0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00040c00: 6545 7272 6f72 2822 4e65 7720 6469 7669  eError("New divi
+00040c10: 7369 6f6e 206d 7573 7420 6e6f 7420 6265  sion must not be
+00040c20: 2065 6d70 7479 2229 0a20 2020 2069 6620   empty").    if 
+00040c30: 6469 7669 7369 6f6e 7320 213d 2073 6f72  divisions != sor
+00040c40: 7465 6428 6469 7669 7369 6f6e 7329 3a0a  ted(divisions):.
+00040c50: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00040c60: 6c75 6545 7272 6f72 2822 4e65 7720 6469  lueError("New di
+00040c70: 7669 7369 6f6e 206d 7573 7420 6265 2073  vision must be s
+00040c80: 6f72 7465 6422 290a 2020 2020 6966 206c  orted").    if l
+00040c90: 656e 2864 6976 6973 696f 6e73 5b3a 2d31  en(divisions[:-1
+00040ca0: 5d29 2021 3d20 6c65 6e28 6c69 7374 2875  ]) != len(list(u
+00040cb0: 6e69 7175 6528 6469 7669 7369 6f6e 735b  nique(divisions[
+00040cc0: 3a2d 315d 2929 293a 0a20 2020 2020 2020  :-1]))):.       
+00040cd0: 206d 7367 203d 2022 4e65 7720 6469 7669   msg = "New divi
+00040ce0: 7369 6f6e 206d 7573 7420 6265 2075 6e69  sion must be uni
+00040cf0: 7175 652c 2065 7863 6570 7420 666f 7220  que, except for 
+00040d00: 7468 6520 6c61 7374 2065 6c65 6d65 6e74  the last element
+00040d10: 220a 2020 2020 2020 2020 7261 6973 6520  ".        raise 
+00040d20: 5661 6c75 6545 7272 6f72 286d 7367 290a  ValueError(msg).
+00040d30: 0a0a 6465 6620 7265 7061 7274 6974 696f  ..def repartitio
+00040d40: 6e5f 6469 7669 7369 6f6e 7328 612c 2062  n_divisions(a, b
+00040d50: 2c20 6e61 6d65 2c20 6f75 7431 2c20 6f75  , name, out1, ou
+00040d60: 7432 2c20 666f 7263 653d 4661 6c73 6529  t2, force=False)
+00040d70: 3a0a 2020 2020 2222 2264 6173 6b20 6772  :.    """dask gr
+00040d80: 6170 6820 746f 2072 6570 6172 7469 7469  aph to repartiti
+00040d90: 6f6e 2064 6174 6166 7261 6d65 2062 7920  on dataframe by 
+00040da0: 6e65 7720 6469 7669 7369 6f6e 730a 0a20  new divisions.. 
+00040db0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00040dc0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00040dd0: 2061 203a 2074 7570 6c65 0a20 2020 2020   a : tuple.     
+00040de0: 2020 206f 6c64 2064 6976 6973 696f 6e73     old divisions
+00040df0: 0a20 2020 2062 203a 2074 7570 6c65 2c20  .    b : tuple, 
+00040e00: 6c69 7374 6d79 7079 0a20 2020 206f 7574  listmypy.    out
+00040e10: 3220 3a20 7374 720a 2020 2020 2020 2020  2 : str.        
+00040e20: 6e61 6d65 206f 6620 6e65 7720 6461 7461  name of new data
+00040e30: 6672 616d 650a 2020 2020 666f 7263 6520  frame.    force 
+00040e40: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
+00040e50: 4661 6c73 650a 2020 2020 2020 2020 416c  False.        Al
+00040e60: 6c6f 7773 2074 6865 2065 7870 616e 7369  lows the expansi
+00040e70: 6f6e 206f 6620 7468 6520 6578 6973 7469  on of the existi
+00040e80: 6e67 2064 6976 6973 696f 6e73 2e0a 2020  ng divisions..  
+00040e90: 2020 2020 2020 4966 2046 616c 7365 2074        If False t
+00040ea0: 6865 6e20 7468 6520 6e65 7720 6469 7669  hen the new divi
+00040eb0: 7369 6f6e 7320 6c6f 7765 7220 616e 6420  sions lower and 
+00040ec0: 7570 7065 7220 626f 756e 6473 206d 7573  upper bounds mus
+00040ed0: 7420 6265 0a20 2020 2020 2020 2074 6865  t be.        the
+00040ee0: 2073 616d 6520 6173 2074 6865 206f 6c64   same as the old
+00040ef0: 2064 6976 6973 696f 6e73 2e0a 0a20 2020   divisions...   
+00040f00: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
+00040f10: 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e 2066  ------.    >>> f
+00040f20: 726f 6d20 7070 7269 6e74 2069 6d70 6f72  rom pprint impor
+00040f30: 7420 7070 7269 6e74 0a20 2020 203e 3e3e  t pprint.    >>>
+00040f40: 2070 7072 696e 7428 7265 7061 7274 6974   pprint(repartit
+00040f50: 696f 6e5f 6469 7669 7369 6f6e 7328 5b31  ion_divisions([1
+00040f60: 2c20 332c 2037 5d2c 205b 312c 2034 2c20  , 3, 7], [1, 4, 
+00040f70: 362c 2037 5d2c 2027 6127 2c20 2762 272c  6, 7], 'a', 'b',
+00040f80: 2027 6327 2929 2020 2320 646f 6374 6573   'c'))  # doctes
+00040f90: 743a 202b 454c 4c49 5053 4953 0a20 2020  t: +ELLIPSIS.   
+00040fa0: 207b 2827 6227 2c20 3029 3a20 283c 6675   {('b', 0): (<fu
+00040fb0: 6e63 7469 6f6e 2062 6f75 6e64 6172 795f  nction boundary_
+00040fc0: 736c 6963 6520 6174 202e 2e2e 3e2c 2028  slice at ...>, (
+00040fd0: 2761 272c 2030 292c 2031 2c20 332c 2046  'a', 0), 1, 3, F
+00040fe0: 616c 7365 292c 0a20 2020 2020 2827 6227  alse),.     ('b'
+00040ff0: 2c20 3129 3a20 283c 6675 6e63 7469 6f6e  , 1): (<function
+00041000: 2062 6f75 6e64 6172 795f 736c 6963 6520   boundary_slice 
+00041010: 6174 202e 2e2e 3e2c 2028 2761 272c 2031  at ...>, ('a', 1
+00041020: 292c 2033 2c20 342c 2046 616c 7365 292c  ), 3, 4, False),
+00041030: 0a20 2020 2020 2827 6227 2c20 3229 3a20  .     ('b', 2): 
+00041040: 283c 6675 6e63 7469 6f6e 2062 6f75 6e64  (<function bound
+00041050: 6172 795f 736c 6963 6520 6174 202e 2e2e  ary_slice at ...
+00041060: 3e2c 2028 2761 272c 2031 292c 2034 2c20  >, ('a', 1), 4, 
+00041070: 362c 2046 616c 7365 292c 0a20 2020 2020  6, False),.     
+00041080: 2827 6227 2c20 3329 3a20 283c 6675 6e63  ('b', 3): (<func
+00041090: 7469 6f6e 2062 6f75 6e64 6172 795f 736c  tion boundary_sl
+000410a0: 6963 6520 6174 202e 2e2e 3e2c 2028 2761  ice at ...>, ('a
+000410b0: 272c 2031 292c 2036 2c20 372c 2054 7275  ', 1), 6, 7, Tru
+000410c0: 6529 2c0a 2020 2020 2028 2763 272c 2030  e),.     ('c', 0
+000410d0: 293a 2028 3c66 756e 6374 696f 6e20 636f  ): (<function co
+000410e0: 6e63 6174 2061 7420 2e2e 2e3e 2c20 5b28  ncat at ...>, [(
+000410f0: 2762 272c 2030 292c 2028 2762 272c 2031  'b', 0), ('b', 1
+00041100: 295d 292c 0a20 2020 2020 2827 6327 2c20  )]),.     ('c', 
+00041110: 3129 3a20 2827 6227 2c20 3229 2c0a 2020  1): ('b', 2),.  
+00041120: 2020 2028 2763 272c 2032 293a 2028 2762     ('c', 2): ('b
+00041130: 272c 2033 297d 0a20 2020 2022 2222 0a20  ', 3)}.    """. 
+00041140: 2020 2063 6865 636b 5f64 6976 6973 696f     check_divisio
+00041150: 6e73 2862 290a 0a20 2020 2069 6620 6c65  ns(b)..    if le
+00041160: 6e28 6229 203c 2032 3a0a 2020 2020 2020  n(b) < 2:.      
+00041170: 2020 2320 6d69 6e69 6d75 6d20 6469 7669    # minimum divi
+00041180: 7369 6f6e 2069 7320 3220 656c 656d 656e  sion is 2 elemen
+00041190: 7473 2c20 6c69 6b65 205b 302c 2030 5d0a  ts, like [0, 0].
+000411a0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+000411b0: 6c75 6545 7272 6f72 2822 4e65 7720 6469  lueError("New di
+000411c0: 7669 7369 6f6e 206d 7573 7420 6265 206c  vision must be l
+000411d0: 6f6e 6765 7220 7468 616e 2032 2065 6c65  onger than 2 ele
+000411e0: 6d65 6e74 7322 290a 0a20 2020 2069 6620  ments")..    if 
+000411f0: 666f 7263 653a 0a20 2020 2020 2020 2069  force:.        i
+00041200: 6620 615b 305d 203c 2062 5b30 5d3a 0a20  f a[0] < b[0]:. 
+00041210: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
+00041220: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00041230: 2020 2022 6c65 6674 2073 6964 6520 6f66     "left side of
+00041240: 2074 6865 206e 6577 2064 6976 6973 696f   the new divisio
+00041250: 6e20 6d75 7374 2062 6520 6571 7561 6c20  n must be equal 
+00041260: 6f72 2073 6d61 6c6c 6572 2022 0a20 2020  or smaller ".   
+00041270: 2020 2020 2020 2020 2020 2020 2022 7468               "th
+00041280: 616e 206f 6c64 2064 6976 6973 696f 6e22  an old division"
+00041290: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+000412a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000412b0: 2056 616c 7565 4572 726f 7228 6d73 6729   ValueError(msg)
+000412c0: 0a20 2020 2020 2020 2069 6620 615b 2d31  .        if a[-1
+000412d0: 5d20 3e20 625b 2d31 5d3a 0a20 2020 2020  ] > b[-1]:.     
+000412e0: 2020 2020 2020 206d 7367 203d 2028 0a20         msg = (. 
+000412f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00041300: 7269 6768 7420 7369 6465 206f 6620 7468  right side of th
+00041310: 6520 6e65 7720 6469 7669 7369 6f6e 206d  e new division m
+00041320: 7573 7420 6265 2065 7175 616c 206f 7220  ust be equal or 
+00041330: 6c61 7267 6572 2022 0a20 2020 2020 2020  larger ".       
+00041340: 2020 2020 2020 2020 2022 7468 616e 206f           "than o
+00041350: 6c64 2064 6976 6973 696f 6e22 0a20 2020  ld division".   
+00041360: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00041370: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00041380: 7565 4572 726f 7228 6d73 6729 0a20 2020  ueError(msg).   
+00041390: 2065 6c73 653a 0a20 2020 2020 2020 2069   else:.        i
+000413a0: 6620 615b 305d 2021 3d20 625b 305d 3a0a  f a[0] != b[0]:.
+000413b0: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
+000413c0: 3d20 226c 6566 7420 7369 6465 206f 6620  = "left side of 
+000413d0: 6f6c 6420 616e 6420 6e65 7720 6469 7669  old and new divi
+000413e0: 7369 6f6e 7320 6172 6520 6469 6666 6572  sions are differ
+000413f0: 656e 7422 0a20 2020 2020 2020 2020 2020  ent".           
+00041400: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00041410: 7228 6d73 6729 0a20 2020 2020 2020 2069  r(msg).        i
+00041420: 6620 615b 2d31 5d20 213d 2062 5b2d 315d  f a[-1] != b[-1]
+00041430: 3a0a 2020 2020 2020 2020 2020 2020 6d73  :.            ms
+00041440: 6720 3d20 2272 6967 6874 2073 6964 6520  g = "right side 
+00041450: 6f66 206f 6c64 2061 6e64 206e 6577 2064  of old and new d
+00041460: 6976 6973 696f 6e73 2061 7265 2064 6966  ivisions are dif
+00041470: 6665 7265 6e74 220a 2020 2020 2020 2020  ferent".        
+00041480: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00041490: 7272 6f72 286d 7367 290a 0a20 2020 2064  rror(msg)..    d
+000414a0: 6566 205f 6973 5f73 696e 676c 655f 6c61  ef _is_single_la
+000414b0: 7374 5f64 6976 2878 293a 0a20 2020 2020  st_div(x):.     
+000414c0: 2020 2022 2222 5768 6574 6865 7220 6c61     """Whether la
+000414d0: 7374 2064 6976 6973 696f 6e20 6f6e 6c79  st division only
+000414e0: 2063 6f6e 7461 696e 7320 7369 6e67 6c65   contains single
+000414f0: 206c 6162 656c 2222 220a 2020 2020 2020   label""".      
+00041500: 2020 7265 7475 726e 206c 656e 2878 2920    return len(x) 
+00041510: 3e3d 2032 2061 6e64 2078 5b2d 315d 203d  >= 2 and x[-1] =
+00041520: 3d20 785b 2d32 5d0a 0a20 2020 2063 203d  = x[-2]..    c =
+00041530: 205b 615b 305d 5d0a 2020 2020 6420 3d20   [a[0]].    d = 
+00041540: 6469 6374 2829 0a20 2020 206c 6f77 203d  dict().    low =
+00041550: 2061 5b30 5d0a 0a20 2020 2069 2c20 6a20   a[0]..    i, j 
+00041560: 3d20 312c 2031 2020 2320 696e 6469 6365  = 1, 1  # indice
+00041570: 7320 666f 7220 6f6c 642f 6e65 7720 6469  s for old/new di
+00041580: 7669 7369 6f6e 730a 2020 2020 6b20 3d20  visions.    k = 
+00041590: 3020 2023 2069 6e64 6578 2066 6f72 2074  0  # index for t
+000415a0: 656d 7020 6469 7669 7369 6f6e 730a 0a20  emp divisions.. 
+000415b0: 2020 206c 6173 745f 656c 656d 203d 205f     last_elem = _
+000415c0: 6973 5f73 696e 676c 655f 6c61 7374 5f64  is_single_last_d
+000415d0: 6976 2861 290a 0a20 2020 2023 2070 726f  iv(a)..    # pro
+000415e0: 6365 7373 2074 6872 6f75 6768 206f 6c64  cess through old
+000415f0: 2064 6976 6973 696f 6e0a 2020 2020 2320   division.    # 
+00041600: 6c65 6674 2070 6172 7420 6f66 206e 6577  left part of new
+00041610: 2064 6976 6973 696f 6e20 6361 6e20 6265   division can be
+00041620: 2070 726f 6365 7373 6564 2069 6e20 7468   processed in th
+00041630: 6973 206c 6f6f 700a 2020 2020 7768 696c  is loop.    whil
+00041640: 6520 6920 3c20 6c65 6e28 6129 2061 6e64  e i < len(a) and
+00041650: 206a 203c 206c 656e 2862 293a 0a20 2020   j < len(b):.   
+00041660: 2020 2020 2069 6620 615b 695d 203c 2062       if a[i] < b
+00041670: 5b6a 5d3a 0a20 2020 2020 2020 2020 2020  [j]:.           
+00041680: 2023 2074 7570 6c65 2069 7320 736f 6d65   # tuple is some
+00041690: 7468 696e 6720 6c69 6b65 3a0a 2020 2020  thing like:.    
+000416a0: 2020 2020 2020 2020 2320 286d 6574 686f          # (metho
+000416b0: 6473 2e62 6f75 6e64 6172 795f 736c 6963  ds.boundary_slic
+000416c0: 652c 2028 2766 726f 6d5f 7061 6e64 6173  e, ('from_pandas
+000416d0: 2d23 272c 2030 292c 2033 2c20 342c 2046  -#', 0), 3, 4, F
+000416e0: 616c 7365 2929 0a20 2020 2020 2020 2020  alse)).         
+000416f0: 2020 2064 5b28 6f75 7431 2c20 6b29 5d20     d[(out1, k)] 
+00041700: 3d20 286d 6574 686f 6473 2e62 6f75 6e64  = (methods.bound
+00041710: 6172 795f 736c 6963 652c 2028 6e61 6d65  ary_slice, (name
+00041720: 2c20 6920 2d20 3129 2c20 6c6f 772c 2061  , i - 1), low, a
+00041730: 5b69 5d2c 2046 616c 7365 290a 2020 2020  [i], False).    
+00041740: 2020 2020 2020 2020 6c6f 7720 3d20 615b          low = a[
+00041750: 695d 0a20 2020 2020 2020 2020 2020 2069  i].            i
+00041760: 202b 3d20 310a 2020 2020 2020 2020 656c   += 1.        el
+00041770: 6966 2061 5b69 5d20 3e20 625b 6a5d 3a0a  if a[i] > b[j]:.
+00041780: 2020 2020 2020 2020 2020 2020 645b 286f              d[(o
+00041790: 7574 312c 206b 295d 203d 2028 6d65 7468  ut1, k)] = (meth
+000417a0: 6f64 732e 626f 756e 6461 7279 5f73 6c69  ods.boundary_sli
+000417b0: 6365 2c20 286e 616d 652c 2069 202d 2031  ce, (name, i - 1
+000417c0: 292c 206c 6f77 2c20 625b 6a5d 2c20 4661  ), low, b[j], Fa
+000417d0: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
+000417e0: 206c 6f77 203d 2062 5b6a 5d0a 2020 2020   low = b[j].    
+000417f0: 2020 2020 2020 2020 6a20 2b3d 2031 0a20          j += 1. 
+00041800: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00041810: 2020 2020 2020 2020 2064 5b28 6f75 7431           d[(out1
+00041820: 2c20 6b29 5d20 3d20 286d 6574 686f 6473  , k)] = (methods
+00041830: 2e62 6f75 6e64 6172 795f 736c 6963 652c  .boundary_slice,
+00041840: 2028 6e61 6d65 2c20 6920 2d20 3129 2c20   (name, i - 1), 
+00041850: 6c6f 772c 2062 5b6a 5d2c 2046 616c 7365  low, b[j], False
+00041860: 290a 2020 2020 2020 2020 2020 2020 6c6f  ).            lo
+00041870: 7720 3d20 625b 6a5d 0a20 2020 2020 2020  w = b[j].       
+00041880: 2020 2020 2069 6620 6c65 6e28 6129 203d       if len(a) =
+00041890: 3d20 6920 2b20 3120 6f72 2061 5b69 5d20  = i + 1 or a[i] 
+000418a0: 3c20 615b 6920 2b20 315d 3a0a 2020 2020  < a[i + 1]:.    
+000418b0: 2020 2020 2020 2020 2020 2020 6a20 2b3d              j +=
+000418c0: 2031 0a20 2020 2020 2020 2020 2020 2069   1.            i
+000418d0: 202b 3d20 310a 2020 2020 2020 2020 632e   += 1.        c.
+000418e0: 6170 7065 6e64 286c 6f77 290a 2020 2020  append(low).    
+000418f0: 2020 2020 6b20 2b3d 2031 0a0a 2020 2020      k += 1..    
+00041900: 2320 7269 6768 7420 7061 7274 206f 6620  # right part of 
+00041910: 6e65 7720 6469 7669 7369 6f6e 2063 616e  new division can
+00041920: 2072 656d 6169 6e0a 2020 2020 6966 2061   remain.    if a
+00041930: 5b2d 315d 203c 2062 5b2d 315d 206f 7220  [-1] < b[-1] or 
+00041940: 625b 2d31 5d20 3d3d 2062 5b2d 325d 3a0a  b[-1] == b[-2]:.
+00041950: 2020 2020 2020 2020 666f 7220 5f6a 2069          for _j i
+00041960: 6e20 7261 6e67 6528 6a2c 206c 656e 2862  n range(j, len(b
+00041970: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00041980: 2320 616c 7761 7973 2075 7365 2072 6967  # always use rig
+00041990: 6874 2d6d 6f73 7420 6f66 206f 6c64 2064  ht-most of old d
+000419a0: 6976 6973 696f 6e0a 2020 2020 2020 2020  ivision.        
+000419b0: 2020 2020 2320 6265 6361 7573 6520 6974      # because it
+000419c0: 206d 6179 2063 6f6e 7461 696e 206c 6173   may contain las
+000419d0: 7420 656c 656d 656e 740a 2020 2020 2020  t element.      
+000419e0: 2020 2020 2020 6d20 3d20 6c65 6e28 6129        m = len(a)
+000419f0: 202d 2032 0a20 2020 2020 2020 2020 2020   - 2.           
+00041a00: 2064 5b28 6f75 7431 2c20 6b29 5d20 3d20   d[(out1, k)] = 
+00041a10: 286d 6574 686f 6473 2e62 6f75 6e64 6172  (methods.boundar
+00041a20: 795f 736c 6963 652c 2028 6e61 6d65 2c20  y_slice, (name, 
+00041a30: 6d29 2c20 6c6f 772c 2062 5b5f 6a5d 2c20  m), low, b[_j], 
+00041a40: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
+00041a50: 2020 206c 6f77 203d 2062 5b5f 6a5d 0a20     low = b[_j]. 
+00041a60: 2020 2020 2020 2020 2020 2063 2e61 7070             c.app
+00041a70: 656e 6428 6c6f 7729 0a20 2020 2020 2020  end(low).       
+00041a80: 2020 2020 206b 202b 3d20 310a 2020 2020       k += 1.    
+00041a90: 656c 7365 3a0a 2020 2020 2020 2020 2320  else:.        # 
+00041aa0: 6576 656e 2069 6620 6e65 7720 6469 7669  even if new divi
+00041ab0: 7369 6f6e 2069 7320 7072 6f63 6573 7365  sion is processe
+00041ac0: 6420 7468 726f 7567 682c 0a20 2020 2020  d through,.     
+00041ad0: 2020 2023 2072 6967 6874 2d6d 6f73 7420     # right-most 
+00041ae0: 656c 656d 656e 7420 6f66 206f 6c64 2064  element of old d
+00041af0: 6976 6973 696f 6e20 6361 6e20 7265 6d61  ivision can rema
+00041b00: 696e 0a20 2020 2020 2020 2069 6620 6c61  in.        if la
+00041b10: 7374 5f65 6c65 6d20 616e 6420 6920 3c20  st_elem and i < 
+00041b20: 6c65 6e28 6129 3a0a 2020 2020 2020 2020  len(a):.        
+00041b30: 2020 2020 645b 286f 7574 312c 206b 295d      d[(out1, k)]
+00041b40: 203d 2028 6d65 7468 6f64 732e 626f 756e   = (methods.boun
+00041b50: 6461 7279 5f73 6c69 6365 2c20 286e 616d  dary_slice, (nam
+00041b60: 652c 2069 202d 2031 292c 2061 5b69 5d2c  e, i - 1), a[i],
+00041b70: 2061 5b69 5d2c 2046 616c 7365 290a 2020   a[i], False).  
+00041b80: 2020 2020 2020 2020 2020 6b20 2b3d 2031            k += 1
+00041b90: 0a20 2020 2020 2020 2063 2e61 7070 656e  .        c.appen
+00041ba0: 6428 615b 2d31 5d29 0a0a 2020 2020 2320  d(a[-1])..    # 
+00041bb0: 7265 706c 6163 6520 6c61 7374 2065 6c65  replace last ele
+00041bc0: 6d65 6e74 206f 6620 7475 706c 6520 7769  ment of tuple wi
+00041bd0: 7468 2054 7275 650a 2020 2020 645b 286f  th True.    d[(o
+00041be0: 7574 312c 206b 202d 2031 295d 203d 2064  ut1, k - 1)] = d
+00041bf0: 5b28 6f75 7431 2c20 6b20 2d20 3129 5d5b  [(out1, k - 1)][
+00041c00: 3a2d 315d 202b 2028 5472 7565 2c29 0a0a  :-1] + (True,)..
+00041c10: 2020 2020 692c 206a 203d 2030 2c20 310a      i, j = 0, 1.
+00041c20: 0a20 2020 206c 6173 745f 656c 656d 203d  .    last_elem =
+00041c30: 205f 6973 5f73 696e 676c 655f 6c61 7374   _is_single_last
+00041c40: 5f64 6976 2863 290a 0a20 2020 2077 6869  _div(c)..    whi
+00041c50: 6c65 206a 203c 206c 656e 2862 293a 0a20  le j < len(b):. 
+00041c60: 2020 2020 2020 2074 6d70 203d 205b 5d0a         tmp = [].
+00041c70: 2020 2020 2020 2020 7768 696c 6520 635b          while c[
+00041c80: 695d 203c 2062 5b6a 5d3a 0a20 2020 2020  i] < b[j]:.     
+00041c90: 2020 2020 2020 2074 6d70 2e61 7070 656e         tmp.appen
+00041ca0: 6428 286f 7574 312c 2069 2929 0a20 2020  d((out1, i)).   
+00041cb0: 2020 2020 2020 2020 2069 202b 3d20 310a           i += 1.
+00041cc0: 2020 2020 2020 2020 7768 696c 6520 280a          while (.
+00041cd0: 2020 2020 2020 2020 2020 2020 6c61 7374              last
+00041ce0: 5f65 6c65 6d0a 2020 2020 2020 2020 2020  _elem.          
+00041cf0: 2020 616e 6420 635b 695d 203d 3d20 625b    and c[i] == b[
+00041d00: 2d31 5d0a 2020 2020 2020 2020 2020 2020  -1].            
+00041d10: 616e 6420 2862 5b2d 315d 2021 3d20 625b  and (b[-1] != b[
+00041d20: 2d32 5d20 6f72 206a 203d 3d20 6c65 6e28  -2] or j == len(
+00041d30: 6229 202d 2031 290a 2020 2020 2020 2020  b) - 1).        
+00041d40: 2020 2020 616e 6420 6920 3c20 6b0a 2020      and i < k.  
+00041d50: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00041d60: 2020 2020 2023 2061 7070 656e 6420 6966       # append if
+00041d70: 206c 6173 7420 7370 6c69 7420 6973 206e   last split is n
+00041d80: 6f74 2069 6e63 6c75 6465 640a 2020 2020  ot included.    
+00041d90: 2020 2020 2020 2020 746d 702e 6170 7065          tmp.appe
+00041da0: 6e64 2828 6f75 7431 2c20 6929 290a 2020  nd((out1, i)).  
+00041db0: 2020 2020 2020 2020 2020 6920 2b3d 2031            i += 1
+00041dc0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00041dd0: 746d 7029 203d 3d20 303a 0a20 2020 2020  tmp) == 0:.     
+00041de0: 2020 2020 2020 2023 2064 756d 6d79 2073         # dummy s
+00041df0: 6c69 6365 2074 6f20 7265 7475 726e 2065  lice to return e
+00041e00: 6d70 7479 2044 6174 6146 7261 6d65 206f  mpty DataFrame o
+00041e10: 7220 5365 7269 6573 2c0a 2020 2020 2020  r Series,.      
+00041e20: 2020 2020 2020 2320 7768 6963 6820 7265        # which re
+00041e30: 7461 696e 206f 7269 6769 6e61 6c20 6461  tain original da
+00041e40: 7461 2061 7474 7269 6275 7465 7320 2863  ta attributes (c
+00041e50: 6f6c 756d 6e73 202f 206e 616d 6529 0a20  olumns / name). 
+00041e60: 2020 2020 2020 2020 2020 2064 5b28 6f75             d[(ou
+00041e70: 7432 2c20 6a20 2d20 3129 5d20 3d20 286d  t2, j - 1)] = (m
+00041e80: 6574 686f 6473 2e62 6f75 6e64 6172 795f  ethods.boundary_
+00041e90: 736c 6963 652c 2028 6e61 6d65 2c20 3029  slice, (name, 0)
+00041ea0: 2c20 615b 305d 2c20 615b 305d 2c20 4661  , a[0], a[0], Fa
+00041eb0: 6c73 6529 0a20 2020 2020 2020 2065 6c69  lse).        eli
+00041ec0: 6620 6c65 6e28 746d 7029 203d 3d20 313a  f len(tmp) == 1:
+00041ed0: 0a20 2020 2020 2020 2020 2020 2064 5b28  .            d[(
+00041ee0: 6f75 7432 2c20 6a20 2d20 3129 5d20 3d20  out2, j - 1)] = 
+00041ef0: 746d 705b 305d 0a20 2020 2020 2020 2065  tmp[0].        e
+00041f00: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00041f10: 2069 6620 6e6f 7420 746d 703a 0a20 2020   if not tmp:.   
+00041f20: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00041f30: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+00041f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041f50: 2020 2022 6368 6563 6b20 666f 7220 6475     "check for du
+00041f60: 706c 6963 6174 6520 7061 7274 6974 696f  plicate partitio
+00041f70: 6e73 5c6e 6f6c 643a 5c6e 2573 5c6e 5c6e  ns\nold:\n%s\n\n
+00041f80: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00041f90: 2020 2020 2020 226e 6577 3a5c 6e25 735c        "new:\n%s\
+00041fa0: 6e5c 6e63 6f6d 6269 6e65 643a 5c6e 2573  n\ncombined:\n%s
+00041fb0: 2220 2520 2870 666f 726d 6174 2861 292c  " % (pformat(a),
+00041fc0: 2070 666f 726d 6174 2862 292c 2070 666f   pformat(b), pfo
+00041fd0: 726d 6174 2863 2929 0a20 2020 2020 2020  rmat(c)).       
+00041fe0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00041ff0: 2020 2020 2020 2064 5b28 6f75 7432 2c20         d[(out2, 
+00042000: 6a20 2d20 3129 5d20 3d20 286d 6574 686f  j - 1)] = (metho
+00042010: 6473 2e63 6f6e 6361 742c 2074 6d70 290a  ds.concat, tmp).
+00042020: 2020 2020 2020 2020 6a20 2b3d 2031 0a20          j += 1. 
+00042030: 2020 2072 6574 7572 6e20 640a 0a0a 6465     return d...de
+00042040: 6620 7265 7061 7274 6974 696f 6e5f 6672  f repartition_fr
+00042050: 6571 2864 662c 2066 7265 713d 4e6f 6e65  eq(df, freq=None
+00042060: 293a 0a20 2020 2022 2222 5265 7061 7274  ):.    """Repart
+00042070: 6974 696f 6e20 6120 7469 6d65 7365 7269  ition a timeseri
+00042080: 6573 2064 6174 6166 7261 6d65 2062 7920  es dataframe by 
+00042090: 6120 6e65 7720 6672 6571 7565 6e63 7922  a new frequency"
+000420a0: 2222 0a20 2020 2069 6620 6e6f 7420 6973  "".    if not is
+000420b0: 696e 7374 616e 6365 2864 662e 6469 7669  instance(df.divi
+000420c0: 7369 6f6e 735b 305d 2c20 7064 2e54 696d  sions[0], pd.Tim
+000420d0: 6573 7461 6d70 293a 0a20 2020 2020 2020  estamp):.       
+000420e0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+000420f0: 2822 4361 6e20 6f6e 6c79 2072 6570 6172  ("Can only repar
+00042100: 7469 7469 6f6e 206f 6e20 6672 6571 7565  tition on freque
+00042110: 6e63 7920 666f 7220 7469 6d65 7365 7269  ncy for timeseri
+00042120: 6573 2229 0a0a 2020 2020 6672 6571 203d  es")..    freq =
+00042130: 205f 6d61 705f 6672 6571 5f74 6f5f 7065   _map_freq_to_pe
+00042140: 7269 6f64 5f73 7461 7274 2866 7265 7129  riod_start(freq)
+00042150: 0a0a 2020 2020 7472 793a 0a20 2020 2020  ..    try:.     
+00042160: 2020 2073 7461 7274 203d 2064 662e 6469     start = df.di
+00042170: 7669 7369 6f6e 735b 305d 2e63 6569 6c28  visions[0].ceil(
+00042180: 6672 6571 290a 2020 2020 6578 6365 7074  freq).    except
+00042190: 2056 616c 7565 4572 726f 723a 0a20 2020   ValueError:.   
+000421a0: 2020 2020 2073 7461 7274 203d 2064 662e       start = df.
+000421b0: 6469 7669 7369 6f6e 735b 305d 0a20 2020  divisions[0].   
+000421c0: 2064 6976 6973 696f 6e73 203d 206d 6574   divisions = met
+000421d0: 686f 6473 2e74 6f6c 6973 7428 0a20 2020  hods.tolist(.   
+000421e0: 2020 2020 2070 642e 6461 7465 5f72 616e       pd.date_ran
+000421f0: 6765 2873 7461 7274 3d73 7461 7274 2c20  ge(start=start, 
+00042200: 656e 643d 6466 2e64 6976 6973 696f 6e73  end=df.divisions
+00042210: 5b2d 315d 2c20 6672 6571 3d66 7265 7129  [-1], freq=freq)
+00042220: 0a20 2020 2029 0a20 2020 2069 6620 6e6f  .    ).    if no
+00042230: 7420 6c65 6e28 6469 7669 7369 6f6e 7329  t len(divisions)
+00042240: 3a0a 2020 2020 2020 2020 6469 7669 7369  :.        divisi
+00042250: 6f6e 7320 3d20 5b64 662e 6469 7669 7369  ons = [df.divisi
+00042260: 6f6e 735b 305d 2c20 6466 2e64 6976 6973  ons[0], df.divis
+00042270: 696f 6e73 5b2d 315d 5d0a 2020 2020 656c  ions[-1]].    el
+00042280: 7365 3a0a 2020 2020 2020 2020 6469 7669  se:.        divi
+00042290: 7369 6f6e 732e 6170 7065 6e64 2864 662e  sions.append(df.
+000422a0: 6469 7669 7369 6f6e 735b 2d31 5d29 0a20  divisions[-1]). 
+000422b0: 2020 2020 2020 2069 6620 6469 7669 7369         if divisi
+000422c0: 6f6e 735b 305d 2021 3d20 6466 2e64 6976  ons[0] != df.div
+000422d0: 6973 696f 6e73 5b30 5d3a 0a20 2020 2020  isions[0]:.     
+000422e0: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+000422f0: 203d 205b 6466 2e64 6976 6973 696f 6e73   = [df.divisions
+00042300: 5b30 5d5d 202b 2064 6976 6973 696f 6e73  [0]] + divisions
+00042310: 0a0a 2020 2020 7265 7475 726e 2064 662e  ..    return df.
+00042320: 7265 7061 7274 6974 696f 6e28 6469 7669  repartition(divi
+00042330: 7369 6f6e 733d 6469 7669 7369 6f6e 7329  sions=divisions)
+00042340: 0a0a 0a64 6566 205f 6d61 705f 6672 6571  ...def _map_freq
+00042350: 5f74 6f5f 7065 7269 6f64 5f73 7461 7274  _to_period_start
+00042360: 2866 7265 7129 3a0a 2020 2020 2222 2245  (freq):.    """E
+00042370: 6e73 7572 6520 7468 6174 2074 6865 2066  nsure that the f
+00042380: 7265 7175 656e 6379 2070 6572 7461 696e  requency pertain
+00042390: 7320 746f 2074 6865 202a 2a73 7461 7274  s to the **start
+000423a0: 2a2a 206f 6620 6120 7065 7269 6f64 2e0a  ** of a period..
+000423b0: 0a20 2020 2049 6620 652e 672e 2060 6672  .    If e.g. `fr
+000423c0: 6571 3d27 4d27 602c 2074 6865 6e20 7468  eq='M'`, then th
+000423d0: 6520 6469 7669 7369 6f6e 7320 6172 653a  e divisions are:
+000423e0: 0a20 2020 2020 2020 202d 2032 3032 312d  .        - 2021-
+000423f0: 3331 2d31 2030 303a 3030 3a30 3020 2873  31-1 00:00:00 (s
+00042400: 7461 7274 206f 6620 4665 6272 7561 7279  tart of February
+00042410: 2070 6172 7469 7469 6f6e 290a 2020 2020   partition).    
+00042420: 2020 2020 2d20 3230 3231 2d32 2d32 3820      - 2021-2-28 
+00042430: 3030 3a30 303a 3030 2028 7374 6172 7420  00:00:00 (start 
+00042440: 6f66 204d 6172 6368 2070 6172 7469 7469  of March partiti
+00042450: 6f6e 290a 2020 2020 2020 2020 2d20 2e2e  on).        - ..
+00042460: 2e0a 0a20 2020 2062 7574 2074 6869 7320  ...    but this 
+00042470: 2a2a 7368 6f75 6c64 2a2a 2062 653a 0a20  **should** be:. 
+00042480: 2020 2020 2020 202d 2032 3032 312d 322d         - 2021-2-
+00042490: 3120 3030 3a30 303a 3030 2028 7374 6172  1 00:00:00 (star
+000424a0: 7420 6f66 2046 6562 7275 6172 7920 7061  t of February pa
+000424b0: 7274 6974 696f 6e29 0a20 2020 2020 2020  rtition).       
+000424c0: 202d 2032 3032 312d 332d 3120 3030 3a30   - 2021-3-1 00:0
+000424d0: 303a 3030 2028 7374 6172 7420 6f66 204d  0:00 (start of M
+000424e0: 6172 6368 2070 6172 7469 7469 6f6e 290a  arch partition).
+000424f0: 2020 2020 2020 2020 2d20 2e2e 2e0a 0a20          - ..... 
+00042500: 2020 2054 6865 7265 666f 7265 2c20 7765     Therefore, we
+00042510: 206d 6170 2060 6672 6571 3d27 4d27 6020   map `freq='M'` 
+00042520: 746f 2060 6672 6571 3d27 4d53 2760 2028  to `freq='MS'` (
+00042530: 7361 6d65 2066 6f72 2071 7561 7274 6572  same for quarter
+00042540: 2061 6e64 2079 6561 7229 2e0a 2020 2020   and year)..    
+00042550: 2222 220a 0a20 2020 2069 6620 6e6f 7420  """..    if not 
+00042560: 6973 696e 7374 616e 6365 2866 7265 712c  isinstance(freq,
+00042570: 2073 7472 293a 0a20 2020 2020 2020 2072   str):.        r
+00042580: 6574 7572 6e20 6672 6571 0a0a 2020 2020  eturn freq..    
+00042590: 6f66 6673 6574 203d 2070 642e 7473 6572  offset = pd.tser
+000425a0: 6965 732e 6672 6571 7565 6e63 6965 732e  ies.frequencies.
+000425b0: 746f 5f6f 6666 7365 7428 6672 6571 290a  to_offset(freq).
+000425c0: 2020 2020 6f66 6673 6574 5f74 7970 655f      offset_type_
+000425d0: 6e61 6d65 203d 2074 7970 6528 6f66 6673  name = type(offs
+000425e0: 6574 292e 5f5f 6e61 6d65 5f5f 0a0a 2020  et).__name__..  
+000425f0: 2020 6966 206e 6f74 206f 6666 7365 745f    if not offset_
+00042600: 7479 7065 5f6e 616d 652e 656e 6473 7769  type_name.endswi
+00042610: 7468 2822 456e 6422 293a 0a20 2020 2020  th("End"):.     
+00042620: 2020 2072 6574 7572 6e20 6672 6571 0a0a     return freq..
+00042630: 2020 2020 6e65 775f 6f66 6673 6574 203d      new_offset =
+00042640: 206f 6666 7365 745f 7479 7065 5f6e 616d   offset_type_nam
+00042650: 655b 3a20 2d6c 656e 2822 456e 6422 295d  e[: -len("End")]
+00042660: 202b 2022 4265 6769 6e22 0a20 2020 2074   + "Begin".    t
+00042670: 7279 3a0a 2020 2020 2020 2020 6e65 775f  ry:.        new_
+00042680: 6f66 6673 6574 5f74 7970 6520 3d20 6765  offset_type = ge
+00042690: 7461 7474 7228 7064 2e74 7365 7269 6573  tattr(pd.tseries
+000426a0: 2e6f 6666 7365 7473 2c20 6e65 775f 6f66  .offsets, new_of
+000426b0: 6673 6574 290a 2020 2020 2020 2020 6966  fset).        if
+000426c0: 2022 2d22 2069 6e20 6672 6571 3a0a 2020   "-" in freq:.  
+000426d0: 2020 2020 2020 2020 2020 5f2c 2061 6e63            _, anc
+000426e0: 686f 7220 3d20 6672 6571 2e73 706c 6974  hor = freq.split
+000426f0: 2822 2d22 290a 2020 2020 2020 2020 2020  ("-").          
+00042700: 2020 616e 6368 6f72 203d 2022 2d22 202b    anchor = "-" +
+00042710: 2061 6e63 686f 720a 2020 2020 2020 2020   anchor.        
+00042720: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00042730: 2020 616e 6368 6f72 203d 2022 220a 2020    anchor = "".  
+00042740: 2020 2020 2020 6e20 3d20 7374 7228 6f66        n = str(of
+00042750: 6673 6574 2e6e 2920 6966 206f 6666 7365  fset.n) if offse
+00042760: 742e 6e20 213d 2031 2065 6c73 6520 2222  t.n != 1 else ""
+00042770: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00042780: 6622 7b6e 7d7b 6e65 775f 6f66 6673 6574  f"{n}{new_offset
+00042790: 5f74 7970 652e 5f70 7265 6669 787d 7b61  _type._prefix}{a
+000427a0: 6e63 686f 727d 220a 2020 2020 6578 6365  nchor}".    exce
+000427b0: 7074 2041 7474 7269 6275 7465 4572 726f  pt AttributeErro
+000427c0: 723a 0a20 2020 2020 2020 2072 6574 7572  r:.        retur
+000427d0: 6e20 6672 6571 0a0a 0a64 6566 2072 6570  n freq...def rep
+000427e0: 6172 7469 7469 6f6e 5f73 697a 6528 6466  artition_size(df
+000427f0: 2c20 7369 7a65 293a 0a20 2020 2022 2222  , size):.    """
+00042800: 0a20 2020 2052 6570 6172 7469 7469 6f6e  .    Repartition
+00042810: 2064 6174 6166 7261 6d65 2073 6f20 7468   dataframe so th
+00042820: 6174 206e 6577 2070 6172 7469 7469 6f6e  at new partition
+00042830: 7320 6861 7665 2061 7070 726f 7869 6d61  s have approxima
+00042840: 7465 6c79 2060 7369 7a65 6020 6d65 6d6f  tely `size` memo
+00042850: 7279 2075 7361 6765 2065 6163 680a 2020  ry usage each.  
+00042860: 2020 2222 220a 2020 2020 6966 2069 7369    """.    if isi
+00042870: 6e73 7461 6e63 6528 7369 7a65 2c20 7374  nstance(size, st
+00042880: 7229 3a0a 2020 2020 2020 2020 7369 7a65  r):.        size
+00042890: 203d 2070 6172 7365 5f62 7974 6573 2873   = parse_bytes(s
+000428a0: 697a 6529 0a20 2020 2073 697a 6520 3d20  ize).    size = 
+000428b0: 696e 7428 7369 7a65 290a 0a20 2020 206d  int(size)..    m
+000428c0: 656d 5f75 7361 6765 7320 3d20 6466 2e6d  em_usages = df.m
+000428d0: 6170 5f70 6172 7469 7469 6f6e 7328 746f  ap_partitions(to
+000428e0: 7461 6c5f 6d65 6d5f 7573 6167 652c 2064  tal_mem_usage, d
+000428f0: 6565 703d 5472 7565 292e 636f 6d70 7574  eep=True).comput
+00042900: 6528 290a 0a20 2020 2023 2031 2e20 7370  e()..    # 1. sp
+00042910: 6c69 7420 6561 6368 2070 6172 7469 7469  lit each partiti
+00042920: 6f6e 2074 6861 7420 6973 206c 6172 6765  on that is large
+00042930: 7220 7468 616e 2070 6172 7469 7469 6f6e  r than partition
+00042940: 5f73 697a 650a 2020 2020 6e73 706c 6974  _size.    nsplit
+00042950: 7320 3d20 3120 2b20 6d65 6d5f 7573 6167  s = 1 + mem_usag
+00042960: 6573 202f 2f20 7369 7a65 0a20 2020 2069  es // size.    i
+00042970: 6620 6e70 2e61 6e79 286e 7370 6c69 7473  f np.any(nsplits
+00042980: 203e 2031 293a 0a20 2020 2020 2020 2073   > 1):.        s
+00042990: 706c 6974 5f6e 616d 6520 3d20 6622 7265  plit_name = f"re
+000429a0: 7061 7274 6974 696f 6e2d 7370 6c69 742d  partition-split-
+000429b0: 7b73 697a 657d 2d7b 746f 6b65 6e69 7a65  {size}-{tokenize
+000429c0: 2864 6629 7d22 0a20 2020 2020 2020 2064  (df)}".        d
+000429d0: 6620 3d20 5f73 706c 6974 5f70 6172 7469  f = _split_parti
+000429e0: 7469 6f6e 7328 6466 2c20 6e73 706c 6974  tions(df, nsplit
+000429f0: 732c 2073 706c 6974 5f6e 616d 6529 0a20  s, split_name). 
+00042a00: 2020 2020 2020 2023 2075 7064 6174 6520         # update 
+00042a10: 6d65 6d5f 7573 6167 6573 2074 6f20 6163  mem_usages to ac
+00042a20: 636f 756e 7420 666f 7220 7468 6520 7370  count for the sp
+00042a30: 6c69 7420 7061 7274 6974 696f 6e73 0a20  lit partitions. 
+00042a40: 2020 2020 2020 2073 706c 6974 5f6d 656d         split_mem
+00042a50: 5f75 7361 6765 7320 3d20 5b5d 0a20 2020  _usages = [].   
+00042a60: 2020 2020 2066 6f72 206e 2c20 7573 6167       for n, usag
+00042a70: 6520 696e 207a 6970 286e 7370 6c69 7473  e in zip(nsplits
+00042a80: 2c20 6d65 6d5f 7573 6167 6573 293a 0a20  , mem_usages):. 
+00042a90: 2020 2020 2020 2020 2020 2073 706c 6974             split
+00042aa0: 5f6d 656d 5f75 7361 6765 732e 6578 7465  _mem_usages.exte
+00042ab0: 6e64 285b 7573 6167 6520 2f20 6e5d 202a  nd([usage / n] *
+00042ac0: 206e 290a 2020 2020 2020 2020 6d65 6d5f   n).        mem_
+00042ad0: 7573 6167 6573 203d 2070 642e 5365 7269  usages = pd.Seri
+00042ae0: 6573 2873 706c 6974 5f6d 656d 5f75 7361  es(split_mem_usa
+00042af0: 6765 7329 0a0a 2020 2020 2320 322e 206e  ges)..    # 2. n
+00042b00: 6f77 2074 6861 7420 616c 6c20 7061 7274  ow that all part
+00042b10: 6974 696f 6e73 2061 7265 206c 6573 7320  itions are less 
+00042b20: 7468 616e 2073 697a 652c 2063 6f6e 6361  than size, conca
+00042b30: 7420 7468 656d 2075 7020 746f 2073 697a  t them up to siz
+00042b40: 650a 2020 2020 6173 7365 7274 206e 702e  e.    assert np.
+00042b50: 616c 6c28 6d65 6d5f 7573 6167 6573 203c  all(mem_usages <
+00042b60: 3d20 7369 7a65 290a 2020 2020 6e65 775f  = size).    new_
+00042b70: 6e70 6172 7469 7469 6f6e 7320 3d20 6c69  npartitions = li
+00042b80: 7374 286d 6170 286c 656e 2c20 6974 6572  st(map(len, iter
+00042b90: 5f63 6875 6e6b 7328 6d65 6d5f 7573 6167  _chunks(mem_usag
+00042ba0: 6573 2c20 7369 7a65 2929 290a 2020 2020  es, size))).    
+00042bb0: 6e65 775f 7061 7274 6974 696f 6e73 5f62  new_partitions_b
+00042bc0: 6f75 6e64 6172 6965 7320 3d20 6e70 2e63  oundaries = np.c
+00042bd0: 756d 7375 6d28 6e65 775f 6e70 6172 7469  umsum(new_nparti
+00042be0: 7469 6f6e 7329 0a20 2020 206e 6577 5f6e  tions).    new_n
+00042bf0: 616d 6520 3d20 6622 7265 7061 7274 6974  ame = f"repartit
+00042c00: 696f 6e2d 7b73 697a 657d 2d7b 746f 6b65  ion-{size}-{toke
+00042c10: 6e69 7a65 2864 6629 7d22 0a20 2020 2072  nize(df)}".    r
+00042c20: 6574 7572 6e20 5f72 6570 6172 7469 7469  eturn _repartiti
+00042c30: 6f6e 5f66 726f 6d5f 626f 756e 6461 7269  on_from_boundari
+00042c40: 6573 2864 662c 206e 6577 5f70 6172 7469  es(df, new_parti
+00042c50: 7469 6f6e 735f 626f 756e 6461 7269 6573  tions_boundaries
+00042c60: 2c20 6e65 775f 6e61 6d65 290a 0a0a 6465  , new_name)...de
+00042c70: 6620 746f 7461 6c5f 6d65 6d5f 7573 6167  f total_mem_usag
+00042c80: 6528 6466 2c20 696e 6465 783d 5472 7565  e(df, index=True
+00042c90: 2c20 6465 6570 3d46 616c 7365 293a 0a20  , deep=False):. 
+00042ca0: 2020 206d 656d 5f75 7361 6765 203d 2064     mem_usage = d
+00042cb0: 662e 6d65 6d6f 7279 5f75 7361 6765 2869  f.memory_usage(i
+00042cc0: 6e64 6578 3d69 6e64 6578 2c20 6465 6570  ndex=index, deep
+00042cd0: 3d64 6565 7029 0a20 2020 2069 6620 6973  =deep).    if is
+00042ce0: 5f73 6572 6965 735f 6c69 6b65 286d 656d  _series_like(mem
+00042cf0: 5f75 7361 6765 293a 0a20 2020 2020 2020  _usage):.       
+00042d00: 206d 656d 5f75 7361 6765 203d 206d 656d   mem_usage = mem
+00042d10: 5f75 7361 6765 2e73 756d 2829 0a20 2020  _usage.sum().   
+00042d20: 2072 6574 7572 6e20 6d65 6d5f 7573 6167   return mem_usag
+00042d30: 650a 0a0a 6465 6620 7265 7061 7274 6974  e...def repartit
+00042d40: 696f 6e5f 6e70 6172 7469 7469 6f6e 7328  ion_npartitions(
+00042d50: 6466 2c20 6e70 6172 7469 7469 6f6e 7329  df, npartitions)
+00042d60: 3a0a 2020 2020 2222 2252 6570 6172 7469  :.    """Reparti
+00042d70: 7469 6f6e 2064 6174 6166 7261 6d65 2074  tion dataframe t
+00042d80: 6f20 6120 736d 616c 6c65 7220 6e75 6d62  o a smaller numb
+00042d90: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
+00042da0: 2222 220a 2020 2020 6e65 775f 6e61 6d65  """.    new_name
+00042db0: 203d 2022 7265 7061 7274 6974 696f 6e2d   = "repartition-
+00042dc0: 2564 2d25 7322 2025 2028 6e70 6172 7469  %d-%s" % (nparti
+00042dd0: 7469 6f6e 732c 2074 6f6b 656e 697a 6528  tions, tokenize(
+00042de0: 6466 2929 0a20 2020 2069 6620 6466 2e6e  df)).    if df.n
+00042df0: 7061 7274 6974 696f 6e73 203d 3d20 6e70  partitions == np
+00042e00: 6172 7469 7469 6f6e 733a 0a20 2020 2020  artitions:.     
+00042e10: 2020 2072 6574 7572 6e20 6466 0a20 2020     return df.   
+00042e20: 2065 6c69 6620 6466 2e6e 7061 7274 6974   elif df.npartit
+00042e30: 696f 6e73 203e 206e 7061 7274 6974 696f  ions > npartitio
+00042e40: 6e73 3a0a 2020 2020 2020 2020 6e70 6172  ns:.        npar
+00042e50: 7469 7469 6f6e 735f 7261 7469 6f20 3d20  titions_ratio = 
+00042e60: 6466 2e6e 7061 7274 6974 696f 6e73 202f  df.npartitions /
+00042e70: 206e 7061 7274 6974 696f 6e73 0a20 2020   npartitions.   
+00042e80: 2020 2020 206e 6577 5f70 6172 7469 7469       new_partiti
+00042e90: 6f6e 735f 626f 756e 6461 7269 6573 203d  ons_boundaries =
+00042ea0: 205b 0a20 2020 2020 2020 2020 2020 2069   [.            i
+00042eb0: 6e74 286e 6577 5f70 6172 7469 7469 6f6e  nt(new_partition
+00042ec0: 5f69 6e64 6578 202a 206e 7061 7274 6974  _index * npartit
+00042ed0: 696f 6e73 5f72 6174 696f 290a 2020 2020  ions_ratio).    
+00042ee0: 2020 2020 2020 2020 666f 7220 6e65 775f          for new_
+00042ef0: 7061 7274 6974 696f 6e5f 696e 6465 7820  partition_index 
+00042f00: 696e 2072 616e 6765 286e 7061 7274 6974  in range(npartit
+00042f10: 696f 6e73 202b 2031 290a 2020 2020 2020  ions + 1).      
+00042f20: 2020 5d0a 2020 2020 2020 2020 7265 7475    ].        retu
+00042f30: 726e 205f 7265 7061 7274 6974 696f 6e5f  rn _repartition_
+00042f40: 6672 6f6d 5f62 6f75 6e64 6172 6965 7328  from_boundaries(
+00042f50: 6466 2c20 6e65 775f 7061 7274 6974 696f  df, new_partitio
+00042f60: 6e73 5f62 6f75 6e64 6172 6965 732c 206e  ns_boundaries, n
+00042f70: 6577 5f6e 616d 6529 0a20 2020 2065 6c73  ew_name).    els
+00042f80: 653a 0a20 2020 2020 2020 2023 2044 726f  e:.        # Dro
+00042f90: 7020 6475 706c 6361 7465 7320 696e 2063  p duplcates in c
+00042fa0: 6173 6520 6c61 7374 2070 6172 7469 7469  ase last partiti
+00042fb0: 6f6e 2068 6173 2073 616d 650a 2020 2020  on has same.    
+00042fc0: 2020 2020 2320 7661 6c75 6520 666f 7220      # value for 
+00042fd0: 6d69 6e20 616e 6420 6d61 7820 6469 7669  min and max divi
+00042fe0: 7369 6f6e 0a20 2020 2020 2020 206f 7269  sion.        ori
+00042ff0: 6769 6e61 6c5f 6469 7669 7369 6f6e 7320  ginal_divisions 
+00043000: 3d20 6469 7669 7369 6f6e 7320 3d20 7064  = divisions = pd
+00043010: 2e53 6572 6965 7328 6466 2e64 6976 6973  .Series(df.divis
+00043020: 696f 6e73 292e 6472 6f70 5f64 7570 6c69  ions).drop_dupli
+00043030: 6361 7465 7328 290a 2020 2020 2020 2020  cates().        
+00043040: 6966 2064 662e 6b6e 6f77 6e5f 6469 7669  if df.known_divi
+00043050: 7369 6f6e 7320 616e 6420 280a 2020 2020  sions and (.    
+00043060: 2020 2020 2020 2020 6973 5f64 6174 6574          is_datet
+00043070: 696d 6536 345f 616e 795f 6474 7970 6528  ime64_any_dtype(
+00043080: 6469 7669 7369 6f6e 732e 6474 7970 6529  divisions.dtype)
+00043090: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
+000430a0: 6973 5f6e 756d 6572 6963 5f64 7479 7065  is_numeric_dtype
+000430b0: 2864 6976 6973 696f 6e73 2e64 7479 7065  (divisions.dtype
+000430c0: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
+000430d0: 2020 2020 2020 2020 2069 6620 6973 5f64           if is_d
+000430e0: 6174 6574 696d 6536 345f 616e 795f 6474  atetime64_any_dt
+000430f0: 7970 6528 6469 7669 7369 6f6e 732e 6474  ype(divisions.dt
+00043100: 7970 6529 3a0a 2020 2020 2020 2020 2020  ype):.          
+00043110: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
+00043120: 3d20 6469 7669 7369 6f6e 732e 7661 6c75  = divisions.valu
+00043130: 6573 2e61 7374 7970 6528 2266 6c6f 6174  es.astype("float
+00043140: 3634 2229 0a0a 2020 2020 2020 2020 2020  64")..          
+00043150: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
+00043160: 696b 6528 6469 7669 7369 6f6e 7329 3a0a  ike(divisions):.
+00043170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043180: 6469 7669 7369 6f6e 7320 3d20 6469 7669  divisions = divi
+00043190: 7369 6f6e 732e 7661 6c75 6573 0a0a 2020  sions.values..  
+000431a0: 2020 2020 2020 2020 2020 6e20 3d20 6c65            n = le
+000431b0: 6e28 6469 7669 7369 6f6e 7329 0a20 2020  n(divisions).   
+000431c0: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
+000431d0: 6e73 203d 206e 702e 696e 7465 7270 280a  ns = np.interp(.
+000431e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000431f0: 783d 6e70 2e6c 696e 7370 6163 6528 302c  x=np.linspace(0,
+00043200: 206e 2c20 6e70 6172 7469 7469 6f6e 7320   n, npartitions 
+00043210: 2b20 3129 2c0a 2020 2020 2020 2020 2020  + 1),.          
+00043220: 2020 2020 2020 7870 3d6e 702e 6c69 6e73        xp=np.lins
+00043230: 7061 6365 2830 2c20 6e2c 206e 292c 0a20  pace(0, n, n),. 
+00043240: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00043250: 703d 6469 7669 7369 6f6e 732c 0a20 2020  p=divisions,.   
+00043260: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00043270: 2020 2020 2020 2069 6620 6973 5f64 6174         if is_dat
+00043280: 6574 696d 6536 345f 616e 795f 6474 7970  etime64_any_dtyp
+00043290: 6528 6f72 6967 696e 616c 5f64 6976 6973  e(original_divis
+000432a0: 696f 6e73 2e64 7479 7065 293a 0a20 2020  ions.dtype):.   
+000432b0: 2020 2020 2020 2020 2020 2020 2064 6976               div
+000432c0: 6973 696f 6e73 203d 206d 6574 686f 6473  isions = methods
+000432d0: 2e74 6f6c 6973 7428 0a20 2020 2020 2020  .tolist(.       
+000432e0: 2020 2020 2020 2020 2020 2020 2070 642e               pd.
+000432f0: 5365 7269 6573 2864 6976 6973 696f 6e73  Series(divisions
+00043300: 292e 6173 7479 7065 286f 7269 6769 6e61  ).astype(origina
+00043310: 6c5f 6469 7669 7369 6f6e 732e 6474 7970  l_divisions.dtyp
+00043320: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+00043330: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00043340: 2065 6c69 6620 6e70 2e69 7373 7562 6474   elif np.issubdt
+00043350: 7970 6528 6f72 6967 696e 616c 5f64 6976  ype(original_div
+00043360: 6973 696f 6e73 2e64 7479 7065 2c20 6e70  isions.dtype, np
+00043370: 2e69 6e74 6567 6572 293a 0a20 2020 2020  .integer):.     
+00043380: 2020 2020 2020 2020 2020 2064 6976 6973             divis
+00043390: 696f 6e73 203d 2064 6976 6973 696f 6e73  ions = divisions
+000433a0: 2e61 7374 7970 6528 6f72 6967 696e 616c  .astype(original
+000433b0: 5f64 6976 6973 696f 6e73 2e64 7479 7065  _divisions.dtype
+000433c0: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+000433d0: 6620 6973 696e 7374 616e 6365 2864 6976  f isinstance(div
+000433e0: 6973 696f 6e73 2c20 6e70 2e6e 6461 7272  isions, np.ndarr
+000433f0: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
+00043400: 2020 2020 2064 6976 6973 696f 6e73 203d       divisions =
+00043410: 2064 6976 6973 696f 6e73 2e74 6f6c 6973   divisions.tolis
+00043420: 7428 290a 0a20 2020 2020 2020 2020 2020  t()..           
+00043430: 2064 6976 6973 696f 6e73 203d 206c 6973   divisions = lis
+00043440: 7428 6469 7669 7369 6f6e 7329 0a20 2020  t(divisions).   
+00043450: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
+00043460: 6e73 5b30 5d20 3d20 6466 2e64 6976 6973  ns[0] = df.divis
+00043470: 696f 6e73 5b30 5d0a 2020 2020 2020 2020  ions[0].        
+00043480: 2020 2020 6469 7669 7369 6f6e 735b 2d31      divisions[-1
+00043490: 5d20 3d20 6466 2e64 6976 6973 696f 6e73  ] = df.divisions
+000434a0: 5b2d 315d 0a0a 2020 2020 2020 2020 2020  [-1]..          
+000434b0: 2020 2320 456e 7375 7265 2074 6865 2063    # Ensure the c
+000434c0: 6f6d 7075 7465 6420 6469 7669 7369 6f6e  omputed division
+000434d0: 7320 6172 6520 756e 6971 7565 0a20 2020  s are unique.   
+000434e0: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
+000434f0: 6e73 203d 206c 6973 7428 756e 6971 7565  ns = list(unique
+00043500: 2864 6976 6973 696f 6e73 5b3a 2d31 5d29  (divisions[:-1])
+00043510: 2920 2b20 5b64 6976 6973 696f 6e73 5b2d  ) + [divisions[-
+00043520: 315d 5d0a 2020 2020 2020 2020 2020 2020  1]].            
+00043530: 7265 7475 726e 2064 662e 7265 7061 7274  return df.repart
+00043540: 6974 696f 6e28 6469 7669 7369 6f6e 733d  ition(divisions=
+00043550: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
+00043560: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00043570: 2020 2020 2064 6976 2c20 6d6f 6420 3d20       div, mod = 
+00043580: 6469 766d 6f64 286e 7061 7274 6974 696f  divmod(npartitio
+00043590: 6e73 2c20 6466 2e6e 7061 7274 6974 696f  ns, df.npartitio
+000435a0: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
+000435b0: 6e73 706c 6974 7320 3d20 5b64 6976 5d20  nsplits = [div] 
+000435c0: 2a20 6466 2e6e 7061 7274 6974 696f 6e73  * df.npartitions
+000435d0: 0a20 2020 2020 2020 2020 2020 206e 7370  .            nsp
+000435e0: 6c69 7473 5b2d 315d 202b 3d20 6d6f 640a  lits[-1] += mod.
+000435f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00043600: 726e 205f 7370 6c69 745f 7061 7274 6974  rn _split_partit
+00043610: 696f 6e73 2864 662c 206e 7370 6c69 7473  ions(df, nsplits
+00043620: 2c20 6e65 775f 6e61 6d65 290a 0a0a 6465  , new_name)...de
+00043630: 6620 5f72 6570 6172 7469 7469 6f6e 5f66  f _repartition_f
+00043640: 726f 6d5f 626f 756e 6461 7269 6573 2864  rom_boundaries(d
+00043650: 662c 206e 6577 5f70 6172 7469 7469 6f6e  f, new_partition
+00043660: 735f 626f 756e 6461 7269 6573 2c20 6e65  s_boundaries, ne
+00043670: 775f 6e61 6d65 293a 0a20 2020 2069 6620  w_name):.    if 
+00043680: 6e6f 7420 6973 696e 7374 616e 6365 286e  not isinstance(n
+00043690: 6577 5f70 6172 7469 7469 6f6e 735f 626f  ew_partitions_bo
+000436a0: 756e 6461 7269 6573 2c20 6c69 7374 293a  undaries, list):
+000436b0: 0a20 2020 2020 2020 206e 6577 5f70 6172  .        new_par
+000436c0: 7469 7469 6f6e 735f 626f 756e 6461 7269  titions_boundari
+000436d0: 6573 203d 206c 6973 7428 6e65 775f 7061  es = list(new_pa
+000436e0: 7274 6974 696f 6e73 5f62 6f75 6e64 6172  rtitions_boundar
+000436f0: 6965 7329 0a20 2020 2069 6620 6e65 775f  ies).    if new_
+00043700: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
+00043710: 6172 6965 735b 305d 203e 2030 3a0a 2020  aries[0] > 0:.  
+00043720: 2020 2020 2020 6e65 775f 7061 7274 6974        new_partit
+00043730: 696f 6e73 5f62 6f75 6e64 6172 6965 732e  ions_boundaries.
+00043740: 696e 7365 7274 2830 2c20 3029 0a20 2020  insert(0, 0).   
+00043750: 2069 6620 6e65 775f 7061 7274 6974 696f   if new_partitio
+00043760: 6e73 5f62 6f75 6e64 6172 6965 735b 2d31  ns_boundaries[-1
+00043770: 5d20 3c20 6466 2e6e 7061 7274 6974 696f  ] < df.npartitio
+00043780: 6e73 3a0a 2020 2020 2020 2020 6e65 775f  ns:.        new_
+00043790: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
+000437a0: 6172 6965 732e 6170 7065 6e64 2864 662e  aries.append(df.
+000437b0: 6e70 6172 7469 7469 6f6e 7329 0a20 2020  npartitions).   
+000437c0: 2064 736b 203d 207b 7d0a 2020 2020 666f   dsk = {}.    fo
+000437d0: 7220 692c 2028 7374 6172 742c 2065 6e64  r i, (start, end
+000437e0: 2920 696e 2065 6e75 6d65 7261 7465 280a  ) in enumerate(.
+000437f0: 2020 2020 2020 2020 7a69 7028 6e65 775f          zip(new_
+00043800: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
+00043810: 6172 6965 732c 206e 6577 5f70 6172 7469  aries, new_parti
+00043820: 7469 6f6e 735f 626f 756e 6461 7269 6573  tions_boundaries
+00043830: 5b31 3a5d 290a 2020 2020 293a 0a20 2020  [1:]).    ):.   
+00043840: 2020 2020 2064 736b 5b6e 6577 5f6e 616d       dsk[new_nam
+00043850: 652c 2069 5d20 3d20 286d 6574 686f 6473  e, i] = (methods
+00043860: 2e63 6f6e 6361 742c 205b 2864 662e 5f6e  .concat, [(df._n
+00043870: 616d 652c 206a 2920 666f 7220 6a20 696e  ame, j) for j in
+00043880: 2072 616e 6765 2873 7461 7274 2c20 656e   range(start, en
+00043890: 6429 5d29 0a20 2020 2064 6976 6973 696f  d)]).    divisio
+000438a0: 6e73 203d 205b 6466 2e64 6976 6973 696f  ns = [df.divisio
+000438b0: 6e73 5b69 5d20 666f 7220 6920 696e 206e  ns[i] for i in n
+000438c0: 6577 5f70 6172 7469 7469 6f6e 735f 626f  ew_partitions_bo
+000438d0: 756e 6461 7269 6573 5d0a 2020 2020 6772  undaries].    gr
+000438e0: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+000438f0: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+00043900: 7469 6f6e 7328 6e65 775f 6e61 6d65 2c20  tions(new_name, 
+00043910: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
+00043920: 733d 5b64 665d 290a 2020 2020 7265 7475  s=[df]).    retu
+00043930: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
+00043940: 2867 7261 7068 2c20 6e65 775f 6e61 6d65  (graph, new_name
+00043950: 2c20 6466 2e5f 6d65 7461 2c20 6469 7669  , df._meta, divi
+00043960: 7369 6f6e 7329 0a0a 0a64 6566 205f 7370  sions)...def _sp
+00043970: 6c69 745f 7061 7274 6974 696f 6e73 2864  lit_partitions(d
+00043980: 662c 206e 7370 6c69 7473 2c20 6e65 775f  f, nsplits, new_
+00043990: 6e61 6d65 293a 0a20 2020 2022 2222 5370  name):.    """Sp
+000439a0: 6c69 7420 6120 4461 736b 2064 6174 6166  lit a Dask dataf
+000439b0: 7261 6d65 2069 6e74 6f20 6e65 7720 7061  rame into new pa
+000439c0: 7274 6974 696f 6e73 0a0a 2020 2020 5061  rtitions..    Pa
+000439d0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+000439e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6466 3a20  -------.    df: 
+000439f0: 4461 7461 4672 616d 6520 6f72 2053 6572  DataFrame or Ser
+00043a00: 6965 730a 2020 2020 6e73 706c 6974 733a  ies.    nsplits:
+00043a10: 204c 6973 745b 696e 745d 0a20 2020 2020   List[int].     
+00043a20: 2020 204e 756d 6265 7220 6f66 2074 6172     Number of tar
+00043a30: 6765 7420 6461 7461 6672 616d 6573 2066  get dataframes f
+00043a40: 6f72 2065 6163 6820 7061 7274 6974 696f  or each partitio
+00043a50: 6e0a 2020 2020 2020 2020 5468 6520 6c65  n.        The le
+00043a60: 6e67 7468 206f 6620 6e73 706c 6974 7320  ngth of nsplits 
+00043a70: 7368 6f75 6c64 2062 6520 7468 6520 7361  should be the sa
+00043a80: 6d65 2061 7320 6466 2e6e 7061 7274 6974  me as df.npartit
+00043a90: 696f 6e73 0a20 2020 206e 6577 5f6e 616d  ions.    new_nam
+00043aa0: 653a 2073 7472 0a0a 2020 2020 5365 6520  e: str..    See 
+00043ab0: 416c 736f 0a20 2020 202d 2d2d 2d2d 2d2d  Also.    -------
+00043ac0: 2d0a 2020 2020 7265 7061 7274 6974 696f  -.    repartitio
+00043ad0: 6e5f 6e70 6172 7469 7469 6f6e 730a 2020  n_npartitions.  
+00043ae0: 2020 7265 7061 7274 6974 696f 6e5f 7369    repartition_si
+00043af0: 7a65 0a20 2020 2022 2222 0a20 2020 2069  ze.    """.    i
+00043b00: 6620 6c65 6e28 6e73 706c 6974 7329 2021  f len(nsplits) !
+00043b10: 3d20 6466 2e6e 7061 7274 6974 696f 6e73  = df.npartitions
+00043b20: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+00043b30: 5661 6c75 6545 7272 6f72 2866 226e 7370  ValueError(f"nsp
+00043b40: 6c69 7473 2073 686f 756c 6420 6861 7665  lits should have
+00043b50: 206c 656e 3d7b 6466 2e6e 7061 7274 6974   len={df.npartit
+00043b60: 696f 6e73 7d22 290a 0a20 2020 2064 736b  ions}")..    dsk
+00043b70: 203d 207b 7d0a 2020 2020 7370 6c69 745f   = {}.    split_
+00043b80: 6e61 6d65 203d 2066 2273 706c 6974 2d7b  name = f"split-{
+00043b90: 746f 6b65 6e69 7a65 2864 662c 206e 7370  tokenize(df, nsp
+00043ba0: 6c69 7473 297d 220a 2020 2020 6a20 3d20  lits)}".    j = 
+00043bb0: 300a 2020 2020 666f 7220 692c 206b 2069  0.    for i, k i
+00043bc0: 6e20 656e 756d 6572 6174 6528 6e73 706c  n enumerate(nspl
+00043bd0: 6974 7329 3a0a 2020 2020 2020 2020 6966  its):.        if
+00043be0: 206b 203d 3d20 313a 0a20 2020 2020 2020   k == 1:.       
+00043bf0: 2020 2020 2064 736b 5b6e 6577 5f6e 616d       dsk[new_nam
+00043c00: 652c 206a 5d20 3d20 2864 662e 5f6e 616d  e, j] = (df._nam
+00043c10: 652c 2069 290a 2020 2020 2020 2020 2020  e, i).          
+00043c20: 2020 6a20 2b3d 2031 0a20 2020 2020 2020    j += 1.       
+00043c30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00043c40: 2020 2064 736b 5b73 706c 6974 5f6e 616d     dsk[split_nam
+00043c50: 652c 2069 5d20 3d20 2873 706c 6974 5f65  e, i] = (split_e
+00043c60: 7665 6e6c 792c 2028 6466 2e5f 6e61 6d65  venly, (df._name
+00043c70: 2c20 6929 2c20 6b29 0a20 2020 2020 2020  , i), k).       
+00043c80: 2020 2020 2066 6f72 206a 6a20 696e 2072       for jj in r
+00043c90: 616e 6765 286b 293a 0a20 2020 2020 2020  ange(k):.       
+00043ca0: 2020 2020 2020 2020 2064 736b 5b6e 6577           dsk[new
+00043cb0: 5f6e 616d 652c 206a 5d20 3d20 2867 6574  _name, j] = (get
+00043cc0: 6974 656d 2c20 2873 706c 6974 5f6e 616d  item, (split_nam
+00043cd0: 652c 2069 292c 206a 6a29 0a20 2020 2020  e, i), jj).     
+00043ce0: 2020 2020 2020 2020 2020 206a 202b 3d20             j += 
+00043cf0: 310a 0a20 2020 2064 6976 6973 696f 6e73  1..    divisions
+00043d00: 203d 205b 4e6f 6e65 5d20 2a20 2831 202b   = [None] * (1 +
+00043d10: 2073 756d 286e 7370 6c69 7473 2929 0a20   sum(nsplits)). 
+00043d20: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+00043d30: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+00043d40: 6f6c 6c65 6374 696f 6e73 286e 6577 5f6e  ollections(new_n
+00043d50: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
+00043d60: 656e 6369 6573 3d5b 6466 5d29 0a20 2020  encies=[df]).   
+00043d70: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
+00043d80: 626a 6563 7428 6772 6170 682c 206e 6577  bject(graph, new
+00043d90: 5f6e 616d 652c 2064 662e 5f6d 6574 612c  _name, df._meta,
+00043da0: 2064 6976 6973 696f 6e73 290a 0a0a 6465   divisions)...de
+00043db0: 6620 7265 7061 7274 6974 696f 6e28 6466  f repartition(df
+00043dc0: 2c20 6469 7669 7369 6f6e 733d 4e6f 6e65  , divisions=None
+00043dd0: 2c20 666f 7263 653d 4661 6c73 6529 3a0a  , force=False):.
+00043de0: 2020 2020 2222 2252 6570 6172 7469 7469      """Repartiti
+00043df0: 6f6e 2064 6174 6166 7261 6d65 2061 6c6f  on dataframe alo
+00043e00: 6e67 206e 6577 2064 6976 6973 696f 6e73  ng new divisions
+00043e10: 0a0a 2020 2020 4461 736b 2e44 6174 6146  ..    Dask.DataF
+00043e20: 7261 6d65 206f 626a 6563 7473 2061 7265  rame objects are
+00043e30: 2070 6172 7469 7469 6f6e 6564 2061 6c6f   partitioned alo
+00043e40: 6e67 2074 6865 6972 2069 6e64 6578 2e20  ng their index. 
+00043e50: 204f 6674 656e 2077 6865 6e0a 2020 2020   Often when.    
+00043e60: 6d75 6c74 6970 6c65 2064 6174 6166 7261  multiple datafra
+00043e70: 6d65 7320 696e 7465 7261 6374 2077 6520  mes interact we 
+00043e80: 6e65 6564 2074 6f20 616c 6967 6e20 7468  need to align th
+00043e90: 6573 6520 7061 7274 6974 696f 6e69 6e67  ese partitioning
+00043ea0: 732e 2020 5468 650a 2020 2020 6060 7265  s.  The.    ``re
+00043eb0: 7061 7274 6974 696f 6e60 6020 6675 6e63  partition`` func
+00043ec0: 7469 6f6e 2063 6f6e 7374 7275 6374 7320  tion constructs 
+00043ed0: 6120 6e65 7720 4461 7461 4672 616d 6520  a new DataFrame 
+00043ee0: 6f62 6a65 6374 2068 6f6c 6469 6e67 2074  object holding t
+00043ef0: 6865 2073 616d 650a 2020 2020 6461 7461  he same.    data
+00043f00: 2062 7574 2070 6172 7469 7469 6f6e 6564   but partitioned
+00043f10: 206f 6e20 6469 6666 6572 656e 7420 7661   on different va
+00043f20: 6c75 6573 2e20 2049 7420 646f 6573 2074  lues.  It does t
+00043f30: 6869 7320 6279 2070 6572 666f 726d 696e  his by performin
+00043f40: 6720 610a 2020 2020 7365 7175 656e 6365  g a.    sequence
+00043f50: 206f 6620 6060 6c6f 6360 6020 616e 6420   of ``loc`` and 
+00043f60: 6060 636f 6e63 6174 6060 2063 616c 6c73  ``concat`` calls
+00043f70: 2074 6f20 7370 6c69 7420 616e 6420 6d65   to split and me
+00043f80: 7267 6520 7468 6520 7072 6576 696f 7573  rge the previous
+00043f90: 0a20 2020 2067 656e 6572 6174 696f 6e20  .    generation 
+00043fa0: 6f66 2070 6172 7469 7469 6f6e 732e 0a0a  of partitions...
+00043fb0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00043fc0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 0a20     ----------.. 
+00043fd0: 2020 2064 6976 6973 696f 6e73 203a 206c     divisions : l
+00043fe0: 6973 740a 2020 2020 2020 2020 4c69 7374  ist.        List
+00043ff0: 206f 6620 7061 7274 6974 696f 6e73 2074   of partitions t
+00044000: 6f20 6265 2075 7365 640a 2020 2020 666f  o be used.    fo
+00044010: 7263 6520 3a20 626f 6f6c 2c20 6465 6661  rce : bool, defa
+00044020: 756c 7420 4661 6c73 650a 2020 2020 2020  ult False.      
+00044030: 2020 416c 6c6f 7773 2074 6865 2065 7870    Allows the exp
+00044040: 616e 7369 6f6e 206f 6620 7468 6520 6578  ansion of the ex
+00044050: 6973 7469 6e67 2064 6976 6973 696f 6e73  isting divisions
+00044060: 2e0a 2020 2020 2020 2020 4966 2046 616c  ..        If Fal
+00044070: 7365 2074 6865 6e20 7468 6520 6e65 7720  se then the new 
+00044080: 6469 7669 7369 6f6e 7320 6c6f 7765 7220  divisions lower 
+00044090: 616e 6420 7570 7065 7220 626f 756e 6473  and upper bounds
+000440a0: 206d 7573 7420 6265 0a20 2020 2020 2020   must be.       
+000440b0: 2074 6865 2073 616d 6520 6173 2074 6865   the same as the
+000440c0: 206f 6c64 2064 6976 6973 696f 6e73 2e0a   old divisions..
+000440d0: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
+000440e0: 2020 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020    --------..    
+000440f0: 3e3e 3e20 6466 203d 2064 662e 7265 7061  >>> df = df.repa
+00044100: 7274 6974 696f 6e28 5b30 2c20 352c 2031  rtition([0, 5, 1
+00044110: 302c 2032 305d 2920 2023 2064 6f63 7465  0, 20])  # docte
+00044120: 7374 3a20 2b53 4b49 500a 0a20 2020 2041  st: +SKIP..    A
+00044130: 6c73 6f20 776f 726b 7320 6f6e 2050 616e  lso works on Pan
+00044140: 6461 7320 6f62 6a65 6374 730a 0a20 2020  das objects..   
+00044150: 203e 3e3e 2064 6466 203d 2064 642e 7265   >>> ddf = dd.re
+00044160: 7061 7274 6974 696f 6e28 6466 2c20 5b30  partition(df, [0
+00044170: 2c20 352c 2031 302c 2032 305d 2920 2023  , 5, 10, 20])  #
+00044180: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
+00044190: 2020 2020 2222 220a 0a20 2020 2023 206e      """..    # n
+000441a0: 6f2d 6f70 2066 6173 7470 6174 6820 666f  o-op fastpath fo
+000441b0: 7220 7768 656e 2077 6520 616c 7265 6164  r when we alread
+000441c0: 7920 6861 7665 206d 6174 6368 696e 6720  y have matching 
+000441d0: 6469 7669 7369 6f6e 730a 2020 2020 6966  divisions.    if
+000441e0: 2069 735f 6461 736b 5f63 6f6c 6c65 6374   is_dask_collect
+000441f0: 696f 6e28 6466 2920 616e 6420 6466 2e64  ion(df) and df.d
+00044200: 6976 6973 696f 6e73 203d 3d20 6469 7669  ivisions == divi
+00044210: 7369 6f6e 733a 0a20 2020 2020 2020 2072  sions:.        r
+00044220: 6574 7572 6e20 6466 0a0a 2020 2020 746f  eturn df..    to
+00044230: 6b65 6e20 3d20 746f 6b65 6e69 7a65 2864  ken = tokenize(d
+00044240: 662c 2064 6976 6973 696f 6e73 290a 2020  f, divisions).  
+00044250: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00044260: 6466 2c20 5f46 7261 6d65 293a 0a20 2020  df, _Frame):.   
+00044270: 2020 2020 2074 6d70 203d 2022 7265 7061       tmp = "repa
+00044280: 7274 6974 696f 6e2d 7370 6c69 742d 2220  rtition-split-" 
+00044290: 2b20 746f 6b65 6e0a 2020 2020 2020 2020  + token.        
+000442a0: 6f75 7420 3d20 2272 6570 6172 7469 7469  out = "repartiti
+000442b0: 6f6e 2d6d 6572 6765 2d22 202b 2074 6f6b  on-merge-" + tok
+000442c0: 656e 0a20 2020 2020 2020 2064 736b 203d  en.        dsk =
+000442d0: 2072 6570 6172 7469 7469 6f6e 5f64 6976   repartition_div
+000442e0: 6973 696f 6e73 280a 2020 2020 2020 2020  isions(.        
+000442f0: 2020 2020 6466 2e64 6976 6973 696f 6e73      df.divisions
+00044300: 2c20 6469 7669 7369 6f6e 732c 2064 662e  , divisions, df.
+00044310: 5f6e 616d 652c 2074 6d70 2c20 6f75 742c  _name, tmp, out,
+00044320: 2066 6f72 6365 3d66 6f72 6365 0a20 2020   force=force.   
+00044330: 2020 2020 2029 0a20 2020 2020 2020 2067       ).        g
+00044340: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
+00044350: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+00044360: 6374 696f 6e73 286f 7574 2c20 6473 6b2c  ctions(out, dsk,
+00044370: 2064 6570 656e 6465 6e63 6965 733d 5b64   dependencies=[d
+00044380: 665d 290a 2020 2020 2020 2020 7265 7475  f]).        retu
+00044390: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
+000443a0: 2867 7261 7068 2c20 6f75 742c 2064 662e  (graph, out, df.
+000443b0: 5f6d 6574 612c 2064 6976 6973 696f 6e73  _meta, divisions
+000443c0: 290a 2020 2020 656c 6966 2069 735f 6461  ).    elif is_da
+000443d0: 7461 6672 616d 655f 6c69 6b65 2864 6629  taframe_like(df)
+000443e0: 206f 7220 6973 5f73 6572 6965 735f 6c69   or is_series_li
+000443f0: 6b65 2864 6629 3a0a 2020 2020 2020 2020  ke(df):.        
+00044400: 6e61 6d65 203d 2022 7265 7061 7274 6974  name = "repartit
+00044410: 696f 6e2d 6461 7461 6672 616d 652d 2220  ion-dataframe-" 
+00044420: 2b20 746f 6b65 6e0a 2020 2020 2020 2020  + token.        
+00044430: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
+00044440: 616d 652e 7574 696c 7320 696d 706f 7274  ame.utils import
+00044450: 2073 6861 7264 5f64 665f 6f6e 5f69 6e64   shard_df_on_ind
+00044460: 6578 0a0a 2020 2020 2020 2020 6466 7320  ex..        dfs 
+00044470: 3d20 7368 6172 645f 6466 5f6f 6e5f 696e  = shard_df_on_in
+00044480: 6465 7828 6466 2c20 6469 7669 7369 6f6e  dex(df, division
+00044490: 735b 313a 2d31 5d29 0a20 2020 2020 2020  s[1:-1]).       
+000444a0: 2064 736b 203d 207b 286e 616d 652c 2069   dsk = {(name, i
+000444b0: 293a 2064 6620 666f 7220 692c 2064 6620  ): df for i, df 
+000444c0: 696e 2065 6e75 6d65 7261 7465 2864 6673  in enumerate(dfs
+000444d0: 297d 0a20 2020 2020 2020 2072 6574 7572  )}.        retur
+000444e0: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
+000444f0: 6473 6b2c 206e 616d 652c 2064 662c 2064  dsk, name, df, d
+00044500: 6976 6973 696f 6e73 290a 2020 2020 7261  ivisions).    ra
+00044510: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00044520: 4461 7461 206d 7573 7420 6265 2044 6174  Data must be Dat
+00044530: 6146 7261 6d65 206f 7220 5365 7269 6573  aFrame or Series
+00044540: 2229 0a0a 0a64 6566 205f 7265 6475 6374  ")...def _reduct
+00044550: 696f 6e5f 6368 756e 6b28 782c 2061 6361  ion_chunk(x, aca
+00044560: 5f63 6875 6e6b 3d4e 6f6e 652c 202a 2a6b  _chunk=None, **k
+00044570: 7761 7267 7329 3a0a 2020 2020 6f20 3d20  wargs):.    o = 
+00044580: 6163 615f 6368 756e 6b28 782c 202a 2a6b  aca_chunk(x, **k
+00044590: 7761 7267 7329 0a20 2020 2023 2052 6574  wargs).    # Ret
+000445a0: 7572 6e20 6120 6461 7461 6672 616d 6520  urn a dataframe 
+000445b0: 736f 2074 6861 7420 7468 6520 636f 6e63  so that the conc
+000445c0: 6174 656e 6174 6564 2076 6572 7369 6f6e  atenated version
+000445d0: 2069 7320 616c 736f 2061 2064 6174 6166   is also a dataf
+000445e0: 7261 6d65 0a20 2020 2072 6574 7572 6e20  rame.    return 
+000445f0: 6f2e 746f 5f66 7261 6d65 2829 2e54 2069  o.to_frame().T i
+00044600: 6620 6973 5f73 6572 6965 735f 6c69 6b65  f is_series_like
+00044610: 286f 2920 656c 7365 206f 0a0a 0a64 6566  (o) else o...def
+00044620: 205f 7265 6475 6374 696f 6e5f 636f 6d62   _reduction_comb
+00044630: 696e 6528 782c 2061 6361 5f63 6f6d 6269  ine(x, aca_combi
+00044640: 6e65 3d4e 6f6e 652c 202a 2a6b 7761 7267  ne=None, **kwarg
+00044650: 7329 3a0a 2020 2020 6966 2069 7369 6e73  s):.    if isins
+00044660: 7461 6e63 6528 782c 206c 6973 7429 3a0a  tance(x, list):.
+00044670: 2020 2020 2020 2020 7820 3d20 7064 2e53          x = pd.S
+00044680: 6572 6965 7328 7829 0a20 2020 206f 203d  eries(x).    o =
+00044690: 2061 6361 5f63 6f6d 6269 6e65 2878 2c20   aca_combine(x, 
+000446a0: 2a2a 6b77 6172 6773 290a 2020 2020 2320  **kwargs).    # 
+000446b0: 5265 7475 726e 2061 2064 6174 6166 7261  Return a datafra
+000446c0: 6d65 2073 6f20 7468 6174 2074 6865 2063  me so that the c
+000446d0: 6f6e 6361 7465 6e61 7465 6420 7665 7273  oncatenated vers
+000446e0: 696f 6e20 6973 2061 6c73 6f20 6120 6461  ion is also a da
+000446f0: 7461 6672 616d 650a 2020 2020 7265 7475  taframe.    retu
+00044700: 726e 206f 2e74 6f5f 6672 616d 6528 292e  rn o.to_frame().
+00044710: 5420 6966 2069 735f 7365 7269 6573 5f6c  T if is_series_l
+00044720: 696b 6528 6f29 2065 6c73 6520 6f0a 0a0a  ike(o) else o...
+00044730: 6465 6620 5f72 6564 7563 7469 6f6e 5f61  def _reduction_a
+00044740: 6767 7265 6761 7465 2878 2c20 6163 615f  ggregate(x, aca_
+00044750: 6167 6772 6567 6174 653d 4e6f 6e65 2c20  aggregate=None, 
+00044760: 2a2a 6b77 6172 6773 293a 0a20 2020 2069  **kwargs):.    i
+00044770: 6620 6973 696e 7374 616e 6365 2878 2c20  f isinstance(x, 
+00044780: 6c69 7374 293a 0a20 2020 2020 2020 2078  list):.        x
+00044790: 203d 2070 642e 5365 7269 6573 2878 290a   = pd.Series(x).
+000447a0: 2020 2020 7265 7475 726e 2061 6361 5f61      return aca_a
+000447b0: 6767 7265 6761 7465 2878 2c20 2a2a 6b77  ggregate(x, **kw
+000447c0: 6172 6773 290a 0a0a 6465 6620 6964 786d  args)...def idxm
+000447d0: 6178 6d69 6e5f 6368 756e 6b28 782c 2066  axmin_chunk(x, f
+000447e0: 6e3d 4e6f 6e65 2c20 736b 6970 6e61 3d54  n=None, skipna=T
+000447f0: 7275 6529 3a0a 2020 2020 6d69 6e6d 6178  rue):.    minmax
+00044800: 203d 2022 6d61 7822 2069 6620 666e 203d   = "max" if fn =
+00044810: 3d20 2269 6478 6d61 7822 2065 6c73 6520  = "idxmax" else 
+00044820: 226d 696e 220a 2020 2020 6966 206c 656e  "min".    if len
+00044830: 2878 2920 3e20 303a 0a20 2020 2020 2020  (x) > 0:.       
+00044840: 2069 6478 203d 2067 6574 6174 7472 2878   idx = getattr(x
+00044850: 2c20 666e 2928 736b 6970 6e61 3d73 6b69  , fn)(skipna=ski
+00044860: 706e 6129 0a20 2020 2020 2020 2076 616c  pna).        val
+00044870: 7565 203d 2067 6574 6174 7472 2878 2c20  ue = getattr(x, 
+00044880: 6d69 6e6d 6178 2928 736b 6970 6e61 3d73  minmax)(skipna=s
+00044890: 6b69 706e 6129 0a20 2020 2065 6c73 653a  kipna).    else:
+000448a0: 0a20 2020 2020 2020 2069 6478 203d 2076  .        idx = v
+000448b0: 616c 7565 203d 206d 6574 615f 7365 7269  alue = meta_seri
+000448c0: 6573 5f63 6f6e 7374 7275 6374 6f72 2878  es_constructor(x
+000448d0: 2928 5b5d 2c20 6474 7970 653d 2269 3822  )([], dtype="i8"
+000448e0: 290a 2020 2020 6966 2069 735f 7365 7269  ).    if is_seri
+000448f0: 6573 5f6c 696b 6528 6964 7829 3a0a 2020  es_like(idx):.  
+00044900: 2020 2020 2020 7265 7475 726e 206d 6574        return met
+00044910: 615f 6672 616d 655f 636f 6e73 7472 7563  a_frame_construc
+00044920: 746f 7228 7829 287b 2269 6478 223a 2069  tor(x)({"idx": i
+00044930: 6478 2c20 2276 616c 7565 223a 2076 616c  dx, "value": val
+00044940: 7565 7d29 0a20 2020 2072 6574 7572 6e20  ue}).    return 
+00044950: 6d65 7461 5f66 7261 6d65 5f63 6f6e 7374  meta_frame_const
+00044960: 7275 6374 6f72 2878 2928 7b22 6964 7822  ructor(x)({"idx"
+00044970: 3a20 5b69 6478 5d2c 2022 7661 6c75 6522  : [idx], "value"
+00044980: 3a20 5b76 616c 7565 5d7d 290a 0a0a 6465  : [value]})...de
+00044990: 6620 6964 786d 6178 6d69 6e5f 726f 7728  f idxmaxmin_row(
+000449a0: 782c 2066 6e3d 4e6f 6e65 2c20 736b 6970  x, fn=None, skip
+000449b0: 6e61 3d54 7275 6529 3a0a 2020 2020 6d69  na=True):.    mi
+000449c0: 6e6d 6178 203d 2022 6d61 7822 2069 6620  nmax = "max" if 
+000449d0: 666e 203d 3d20 2269 6478 6d61 7822 2065  fn == "idxmax" e
+000449e0: 6c73 6520 226d 696e 220a 2020 2020 6966  lse "min".    if
+000449f0: 206c 656e 2878 2920 3e20 303a 0a20 2020   len(x) > 0:.   
+00044a00: 2020 2020 2078 203d 2078 2e73 6574 5f69       x = x.set_i
+00044a10: 6e64 6578 2822 6964 7822 290a 2020 2020  ndex("idx").    
+00044a20: 2020 2020 6964 7820 3d20 5b67 6574 6174      idx = [getat
+00044a30: 7472 2878 2e76 616c 7565 2c20 666e 2928  tr(x.value, fn)(
+00044a40: 736b 6970 6e61 3d73 6b69 706e 6129 5d0a  skipna=skipna)].
+00044a50: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
+00044a60: 5b67 6574 6174 7472 2878 2e76 616c 7565  [getattr(x.value
+00044a70: 2c20 6d69 6e6d 6178 2928 736b 6970 6e61  , minmax)(skipna
+00044a80: 3d73 6b69 706e 6129 5d0a 2020 2020 656c  =skipna)].    el
+00044a90: 7365 3a0a 2020 2020 2020 2020 6964 7820  se:.        idx 
+00044aa0: 3d20 7661 6c75 6520 3d20 6d65 7461 5f73  = value = meta_s
+00044ab0: 6572 6965 735f 636f 6e73 7472 7563 746f  eries_constructo
+00044ac0: 7228 7829 285b 5d2c 2064 7479 7065 3d22  r(x)([], dtype="
+00044ad0: 6938 2229 0a20 2020 2072 6574 7572 6e20  i8").    return 
+00044ae0: 6d65 7461 5f66 7261 6d65 5f63 6f6e 7374  meta_frame_const
+00044af0: 7275 6374 6f72 2878 2928 7b22 6964 7822  ructor(x)({"idx"
+00044b00: 3a20 6964 782c 2022 7661 6c75 6522 3a20  : idx, "value": 
+00044b10: 7661 6c75 657d 290a 0a0a 6465 6620 6964  value})...def id
+00044b20: 786d 6178 6d69 6e5f 636f 6d62 696e 6528  xmaxmin_combine(
+00044b30: 782c 2066 6e3d 4e6f 6e65 2c20 736b 6970  x, fn=None, skip
+00044b40: 6e61 3d54 7275 6529 3a0a 2020 2020 6966  na=True):.    if
+00044b50: 206c 656e 2878 2920 3c3d 2031 3a0a 2020   len(x) <= 1:.  
+00044b60: 2020 2020 2020 7265 7475 726e 2078 0a20        return x. 
+00044b70: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
+00044b80: 2020 2020 782e 6772 6f75 7062 7928 6c65      x.groupby(le
+00044b90: 7665 6c3d 3029 0a20 2020 2020 2020 202e  vel=0).        .
+00044ba0: 6170 706c 7928 6964 786d 6178 6d69 6e5f  apply(idxmaxmin_
+00044bb0: 726f 772c 2066 6e3d 666e 2c20 736b 6970  row, fn=fn, skip
+00044bc0: 6e61 3d73 6b69 706e 6129 0a20 2020 2020  na=skipna).     
+00044bd0: 2020 202e 7265 7365 745f 696e 6465 7828     .reset_index(
+00044be0: 6c65 7665 6c3d 312c 2064 726f 703d 5472  level=1, drop=Tr
+00044bf0: 7565 290a 2020 2020 290a 0a0a 6465 6620  ue).    )...def 
+00044c00: 6964 786d 6178 6d69 6e5f 6167 6728 782c  idxmaxmin_agg(x,
+00044c10: 2066 6e3d 4e6f 6e65 2c20 736b 6970 6e61   fn=None, skipna
+00044c20: 3d54 7275 652c 2073 6361 6c61 723d 4661  =True, scalar=Fa
+00044c30: 6c73 6529 3a0a 2020 2020 7265 7320 3d20  lse):.    res = 
+00044c40: 6964 786d 6178 6d69 6e5f 636f 6d62 696e  idxmaxmin_combin
+00044c50: 6528 782c 2066 6e2c 2073 6b69 706e 613d  e(x, fn, skipna=
+00044c60: 736b 6970 6e61 295b 2269 6478 225d 0a20  skipna)["idx"]. 
+00044c70: 2020 2069 6620 6c65 6e28 7265 7329 203d     if len(res) =
+00044c80: 3d20 303a 0a20 2020 2020 2020 2072 6169  = 0:.        rai
+00044c90: 7365 2056 616c 7565 4572 726f 7228 2261  se ValueError("a
+00044ca0: 7474 656d 7074 2074 6f20 6765 7420 6172  ttempt to get ar
+00044cb0: 676d 6178 206f 6620 616e 2065 6d70 7479  gmax of an empty
+00044cc0: 2073 6571 7565 6e63 6522 290a 2020 2020   sequence").    
+00044cd0: 6966 2073 6361 6c61 723a 0a20 2020 2020  if scalar:.     
+00044ce0: 2020 2072 6574 7572 6e20 7265 735b 305d     return res[0]
+00044cf0: 0a20 2020 2072 6573 2e6e 616d 6520 3d20  .    res.name = 
+00044d00: 4e6f 6e65 0a20 2020 2072 6574 7572 6e20  None.    return 
+00044d10: 7265 730a 0a0a 6465 6620 5f6d 6f64 655f  res...def _mode_
+00044d20: 6167 6772 6567 6174 6528 6466 2c20 6472  aggregate(df, dr
+00044d30: 6f70 6e61 293a 0a20 2020 2076 616c 7565  opna):.    value
+00044d40: 5f63 6f75 6e74 5f73 6572 6965 7320 3d20  _count_series = 
+00044d50: 6466 2e73 756d 2829 0a20 2020 206d 6178  df.sum().    max
+00044d60: 5f76 616c 203d 2076 616c 7565 5f63 6f75  _val = value_cou
+00044d70: 6e74 5f73 6572 6965 732e 6d61 7828 736b  nt_series.max(sk
+00044d80: 6970 6e61 3d64 726f 706e 6129 0a20 2020  ipna=dropna).   
+00044d90: 206d 6f64 655f 7365 7269 6573 203d 2028   mode_series = (
+00044da0: 0a20 2020 2020 2020 2076 616c 7565 5f63  .        value_c
+00044db0: 6f75 6e74 5f73 6572 6965 735b 7661 6c75  ount_series[valu
+00044dc0: 655f 636f 756e 745f 7365 7269 6573 203d  e_count_series =
+00044dd0: 3d20 6d61 785f 7661 6c5d 0a20 2020 2020  = max_val].     
+00044de0: 2020 202e 696e 6465 782e 746f 5f73 6572     .index.to_ser
+00044df0: 6965 7328 290a 2020 2020 2020 2020 2e73  ies().        .s
+00044e00: 6f72 745f 7661 6c75 6573 2829 0a20 2020  ort_values().   
+00044e10: 2020 2020 202e 7265 7365 745f 696e 6465       .reset_inde
+00044e20: 7828 6472 6f70 3d54 7275 6529 0a20 2020  x(drop=True).   
+00044e30: 2029 0a20 2020 2072 6574 7572 6e20 6d6f   ).    return mo
+00044e40: 6465 5f73 6572 6965 730a 0a0a 6465 6620  de_series...def 
+00044e50: 5f63 6f75 6e74 5f61 6767 7265 6761 7465  _count_aggregate
+00044e60: 2878 293a 0a20 2020 2072 6574 7572 6e20  (x):.    return 
+00044e70: 782e 7375 6d28 292e 6173 7479 7065 2822  x.sum().astype("
+00044e80: 696e 7436 3422 290a 0a0a 6465 6620 7361  int64")...def sa
+00044e90: 6665 5f68 6561 6428 6466 2c20 6e29 3a0a  fe_head(df, n):.
+00044ea0: 2020 2020 7220 3d20 4d2e 6865 6164 2864      r = M.head(d
+00044eb0: 662c 206e 290a 2020 2020 6966 206c 656e  f, n).    if len
+00044ec0: 2872 2920 213d 206e 3a0a 2020 2020 2020  (r) != n:.      
+00044ed0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+00044ee0: 0a20 2020 2020 2020 2020 2020 2066 2249  .            f"I
+00044ef0: 6e73 7566 6669 6369 656e 7420 656c 656d  nsufficient elem
+00044f00: 656e 7473 2066 6f72 2060 6865 6164 602e  ents for `head`.
+00044f10: 207b 6e7d 2065 6c65 6d65 6e74 7320 7265   {n} elements re
+00044f20: 7175 6573 7465 642c 206f 6e6c 7920 7b6c  quested, only {l
+00044f30: 656e 2872 297d 2022 0a20 2020 2020 2020  en(r)} ".       
+00044f40: 2020 2020 2022 656c 656d 656e 7473 2061       "elements a
+00044f50: 7661 696c 6162 6c65 2e20 5472 7920 7061  vailable. Try pa
+00044f60: 7373 696e 6720 6c61 7267 6572 2060 6e70  ssing larger `np
+00044f70: 6172 7469 7469 6f6e 7360 2074 6f20 6068  artitions` to `h
+00044f80: 6561 6460 2e22 0a20 2020 2020 2020 2029  ead`.".        )
+00044f90: 0a20 2020 2072 6574 7572 6e20 720a 0a0a  .    return r...
+00044fa0: 6465 6620 6d61 7962 655f 7368 6966 745f  def maybe_shift_
+00044fb0: 6469 7669 7369 6f6e 7328 6466 2c20 7065  divisions(df, pe
+00044fc0: 7269 6f64 732c 2066 7265 7129 3a0a 2020  riods, freq):.  
+00044fd0: 2020 2222 224d 6179 6265 2073 6869 6674    """Maybe shift
+00044fe0: 2064 6976 6973 696f 6e73 2062 7920 7065   divisions by pe
+00044ff0: 7269 6f64 7320 6f66 2073 697a 6520 6672  riods of size fr
+00045000: 6571 0a0a 2020 2020 5573 6564 2074 6f20  eq..    Used to 
+00045010: 7368 6966 7420 7468 6520 6469 7669 7369  shift the divisi
+00045020: 6f6e 7320 666f 7220 7468 6520 6073 6869  ons for the `shi
+00045030: 6674 6020 6d65 7468 6f64 2e20 4966 2066  ft` method. If f
+00045040: 7265 7120 6973 6e27 7420 6120 6669 7865  req isn't a fixe
+00045050: 640a 2020 2020 7369 7a65 2028 6e6f 7420  d.    size (not 
+00045060: 616e 6368 6f72 6564 206f 7220 7265 6c61  anchored or rela
+00045070: 7469 7665 292c 2074 6865 6e20 7468 6520  tive), then the 
+00045080: 6469 7669 7369 6f6e 7320 6172 6520 7368  divisions are sh
+00045090: 6966 7465 640a 2020 2020 6170 7072 6f70  ifted.    approp
+000450a0: 7269 6174 656c 792e 204f 7468 6572 7769  riately. Otherwi
+000450b0: 7365 2074 6865 2064 6976 6973 696f 6e73  se the divisions
+000450c0: 2061 7265 2063 6c65 6172 6564 2e0a 0a20   are cleared... 
+000450d0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+000450e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+000450f0: 2064 6620 3a20 6464 2e44 6174 6146 7261   df : dd.DataFra
+00045100: 6d65 2c20 6464 2e53 6572 6965 732c 206f  me, dd.Series, o
+00045110: 7220 6464 2e49 6e64 6578 0a20 2020 2070  r dd.Index.    p
+00045120: 6572 696f 6473 203a 2069 6e74 0a20 2020  eriods : int.   
+00045130: 2020 2020 2054 6865 206e 756d 6265 7220       The number 
+00045140: 6f66 2070 6572 696f 6473 2074 6f20 7368  of periods to sh
+00045150: 6966 742e 0a20 2020 2066 7265 7120 3a20  ift..    freq : 
+00045160: 4461 7465 4f66 6673 6574 2c20 7469 6d65  DateOffset, time
+00045170: 6465 6c74 612c 206f 7220 7469 6d65 2072  delta, or time r
+00045180: 756c 6520 7374 7269 6e67 0a20 2020 2020  ule string.     
+00045190: 2020 2054 6865 2066 7265 7175 656e 6379     The frequency
+000451a0: 2074 6f20 7368 6966 7420 6279 2e0a 2020   to shift by..  
+000451b0: 2020 2222 220a 2020 2020 6966 2069 7369    """.    if isi
+000451c0: 6e73 7461 6e63 6528 6672 6571 2c20 7374  nstance(freq, st
+000451d0: 7229 3a0a 2020 2020 2020 2020 6672 6571  r):.        freq
+000451e0: 203d 2070 642e 7473 6572 6965 732e 6672   = pd.tseries.fr
+000451f0: 6571 7565 6e63 6965 732e 746f 5f6f 6666  equencies.to_off
+00045200: 7365 7428 6672 6571 290a 0a20 2020 2069  set(freq)..    i
+00045210: 735f 6f66 6673 6574 203d 2069 7369 6e73  s_offset = isins
+00045220: 7461 6e63 6528 6672 6571 2c20 7064 2e44  tance(freq, pd.D
+00045230: 6174 654f 6666 7365 7429 0a20 2020 2069  ateOffset).    i
+00045240: 6620 6973 5f6f 6666 7365 743a 0a20 2020  f is_offset:.   
+00045250: 2020 2020 2069 6620 6672 6571 2e69 735f       if freq.is_
+00045260: 616e 6368 6f72 6564 2829 206f 7220 6e6f  anchored() or no
+00045270: 7420 6861 7361 7474 7228 6672 6571 2c20  t hasattr(freq, 
+00045280: 2264 656c 7461 2229 3a0a 2020 2020 2020  "delta"):.      
+00045290: 2020 2020 2020 2320 4361 6e27 7420 696e        # Can't in
+000452a0: 6665 7220 6469 7669 7369 6f6e 7320 6f6e  fer divisions on
+000452b0: 2072 656c 6174 6976 6520 6f72 2061 6e63   relative or anc
+000452c0: 686f 7265 6420 6f66 6673 6574 732c 2061  hored offsets, a
+000452d0: 730a 2020 2020 2020 2020 2020 2020 2320  s.            # 
+000452e0: 6469 7669 7369 6f6e 7320 6d61 7920 6e6f  divisions may no
+000452f0: 7720 7370 6c69 7420 6964 656e 7469 6361  w split identica
+00045300: 6c20 696e 6465 7820 7661 6c75 652e 0a20  l index value.. 
+00045310: 2020 2020 2020 2020 2020 2023 2028 652e             # (e.
+00045320: 672e 2069 6e64 6578 5f70 6172 7469 7469  g. index_partiti
+00045330: 6f6e 7320 3d20 5b5b 312c 2032 2c20 335d  ons = [[1, 2, 3]
+00045340: 2c20 5b33 2c20 342c 2035 5d5d 290a 2020  , [3, 4, 5]]).  
+00045350: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00045360: 2064 662e 636c 6561 725f 6469 7669 7369   df.clear_divisi
+00045370: 6f6e 7328 290a 2020 2020 6966 2064 662e  ons().    if df.
+00045380: 6b6e 6f77 6e5f 6469 7669 7369 6f6e 733a  known_divisions:
+00045390: 0a20 2020 2020 2020 2064 6976 7320 3d20  .        divs = 
+000453a0: 7064 2e53 6572 6965 7328 7261 6e67 6528  pd.Series(range(
+000453b0: 6c65 6e28 6466 2e64 6976 6973 696f 6e73  len(df.divisions
+000453c0: 2929 2c20 696e 6465 783d 6466 2e64 6976  )), index=df.div
+000453d0: 6973 696f 6e73 290a 2020 2020 2020 2020  isions).        
+000453e0: 6469 7669 7369 6f6e 7320 3d20 6469 7673  divisions = divs
+000453f0: 2e73 6869 6674 2870 6572 696f 6473 2c20  .shift(periods, 
+00045400: 6672 6571 3d66 7265 7129 2e69 6e64 6578  freq=freq).index
+00045410: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00045420: 6466 2e5f 5f63 6c61 7373 5f5f 2864 662e  df.__class__(df.
+00045430: 6461 736b 2c20 6466 2e5f 6e61 6d65 2c20  dask, df._name, 
+00045440: 6466 2e5f 6d65 7461 2c20 6469 7669 7369  df._meta, divisi
+00045450: 6f6e 7329 0a20 2020 2072 6574 7572 6e20  ons).    return 
+00045460: 6466 0a0a 0a40 7772 6170 7328 7064 2e74  df...@wraps(pd.t
+00045470: 6f5f 6461 7465 7469 6d65 290a 6465 6620  o_datetime).def 
+00045480: 746f 5f64 6174 6574 696d 6528 6172 672c  to_datetime(arg,
+00045490: 206d 6574 613d 4e6f 6e65 2c20 2a2a 6b77   meta=None, **kw
+000454a0: 6172 6773 293a 0a20 2020 2074 7a5f 6b77  args):.    tz_kw
+000454b0: 6172 6720 3d20 7b22 747a 223a 2022 7574  arg = {"tz": "ut
+000454c0: 6322 7d20 6966 206b 7761 7267 732e 6765  c"} if kwargs.ge
+000454d0: 7428 2275 7463 2229 2065 6c73 6520 7b7d  t("utc") else {}
+000454e0: 0a20 2020 2069 6620 6d65 7461 2069 7320  .    if meta is 
+000454f0: 4e6f 6e65 3a0a 2020 2020 2020 2020 6966  None:.        if
+00045500: 2069 7369 6e73 7461 6e63 6528 6172 672c   isinstance(arg,
+00045510: 2049 6e64 6578 293a 0a20 2020 2020 2020   Index):.       
+00045520: 2020 2020 206d 6574 6120 3d20 7064 2e44       meta = pd.D
+00045530: 6174 6574 696d 6549 6e64 6578 285b 5d2c  atetimeIndex([],
+00045540: 202a 2a74 7a5f 6b77 6172 6729 0a20 2020   **tz_kwarg).   
+00045550: 2020 2020 2020 2020 206d 6574 612e 6e61           meta.na
+00045560: 6d65 203d 2061 7267 2e6e 616d 650a 2020  me = arg.name.  
+00045570: 2020 2020 2020 656c 6966 206e 6f74 2028        elif not (
+00045580: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+00045590: 6528 6172 6729 206f 7220 6973 5f73 6572  e(arg) or is_ser
+000455a0: 6965 735f 6c69 6b65 2861 7267 2929 3a0a  ies_like(arg)):.
+000455b0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000455c0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+000455d0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000455e0: 2020 2020 2020 2022 6461 736b 2e64 6174         "dask.dat
+000455f0: 6166 7261 6d65 2e74 6f5f 6461 7465 7469  aframe.to_dateti
+00045600: 6d65 2064 6f65 7320 6e6f 7420 7375 7070  me does not supp
+00045610: 6f72 7420 220a 2020 2020 2020 2020 2020  ort ".          
+00045620: 2020 2020 2020 226e 6f6e 2d69 6e64 6578        "non-index
+00045630: 2d61 626c 6520 6172 6775 6d65 6e74 7320  -able arguments 
+00045640: 286c 696b 6520 7363 616c 6172 7329 220a  (like scalars)".
+00045650: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00045660: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00045670: 2020 2020 2020 2020 6d65 7461 203d 206d          meta = m
+00045680: 6574 615f 7365 7269 6573 5f63 6f6e 7374  eta_series_const
+00045690: 7275 6374 6f72 2861 7267 2928 5b70 642e  ructor(arg)([pd.
+000456a0: 5469 6d65 7374 616d 7028 2232 3030 3022  Timestamp("2000"
+000456b0: 2c20 2a2a 747a 5f6b 7761 7267 295d 290a  , **tz_kwarg)]).
+000456c0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+000456d0: 2e69 6e64 6578 203d 206d 6574 612e 696e  .index = meta.in
+000456e0: 6465 782e 6173 7479 7065 2861 7267 2e69  dex.astype(arg.i
+000456f0: 6e64 6578 2e64 7479 7065 290a 2020 2020  ndex.dtype).    
+00045700: 2020 2020 2020 2020 6d65 7461 2e69 6e64          meta.ind
+00045710: 6578 2e6e 616d 6520 3d20 6172 672e 696e  ex.name = arg.in
+00045720: 6465 782e 6e61 6d65 0a20 2020 2069 6620  dex.name.    if 
+00045730: 5041 4e44 4153 5f47 545f 3230 3020 616e  PANDAS_GT_200 an
+00045740: 6420 2269 6e66 6572 5f64 6174 6574 696d  d "infer_datetim
+00045750: 655f 666f 726d 6174 2220 696e 206b 7761  e_format" in kwa
+00045760: 7267 733a 0a20 2020 2020 2020 2077 6172  rgs:.        war
+00045770: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
+00045780: 2020 2020 2020 2020 2254 6865 2061 7267          "The arg
+00045790: 756d 656e 7420 2769 6e66 6572 5f64 6174  ument 'infer_dat
+000457a0: 6574 696d 655f 666f 726d 6174 2720 6973  etime_format' is
+000457b0: 2064 6570 7265 6361 7465 6420 616e 6420   deprecated and 
+000457c0: 7769 6c6c 2062 6520 7265 6d6f 7665 6420  will be removed 
+000457d0: 696e 2061 2066 7574 7572 6520 7665 7273  in a future vers
+000457e0: 696f 6e2e 2022 0a20 2020 2020 2020 2020  ion. ".         
+000457f0: 2020 2022 4120 7374 7269 6374 2076 6572     "A strict ver
+00045800: 7369 6f6e 206f 6620 6974 2069 7320 6e6f  sion of it is no
+00045810: 7720 7468 6520 6465 6661 756c 742c 2073  w the default, s
+00045820: 6565 2022 0a20 2020 2020 2020 2020 2020  ee ".           
+00045830: 2022 6874 7470 733a 2f2f 7061 6e64 6173   "https://pandas
+00045840: 2e70 7964 6174 612e 6f72 672f 7064 6570  .pydata.org/pdep
+00045850: 732f 3030 3034 2d63 6f6e 7369 7374 656e  s/0004-consisten
+00045860: 742d 746f 2d64 6174 6574 696d 652d 7061  t-to-datetime-pa
+00045870: 7273 696e 672e 6874 6d6c 2e20 220a 2020  rsing.html. ".  
+00045880: 2020 2020 2020 2020 2020 2259 6f75 2063            "You c
+00045890: 616e 2073 6166 656c 7920 7265 6d6f 7665  an safely remove
+000458a0: 2074 6869 7320 6172 6775 6d65 6e74 2e22   this argument."
+000458b0: 2c0a 2020 2020 2020 2020 2020 2020 5573  ,.            Us
+000458c0: 6572 5761 726e 696e 672c 0a20 2020 2020  erWarning,.     
+000458d0: 2020 2029 0a20 2020 2020 2020 206b 7761     ).        kwa
+000458e0: 7267 732e 706f 7028 2269 6e66 6572 5f64  rgs.pop("infer_d
+000458f0: 6174 6574 696d 655f 666f 726d 6174 2229  atetime_format")
+00045900: 0a0a 2020 2020 7265 7475 726e 206d 6170  ..    return map
+00045910: 5f70 6172 7469 7469 6f6e 7328 7064 2e74  _partitions(pd.t
+00045920: 6f5f 6461 7465 7469 6d65 2c20 6172 672c  o_datetime, arg,
+00045930: 206d 6574 613d 6d65 7461 2c20 2a2a 6b77   meta=meta, **kw
+00045940: 6172 6773 290a 0a0a 4077 7261 7073 2870  args)...@wraps(p
+00045950: 642e 746f 5f74 696d 6564 656c 7461 290a  d.to_timedelta).
+00045960: 6465 6620 746f 5f74 696d 6564 656c 7461  def to_timedelta
+00045970: 2861 7267 2c20 756e 6974 3d4e 6f6e 652c  (arg, unit=None,
+00045980: 2065 7272 6f72 733d 2272 6169 7365 2229   errors="raise")
+00045990: 3a0a 2020 2020 6d65 7461 203d 206d 6574  :.    meta = met
+000459a0: 615f 7365 7269 6573 5f63 6f6e 7374 7275  a_series_constru
+000459b0: 6374 6f72 2861 7267 2928 5b70 642e 5469  ctor(arg)([pd.Ti
+000459c0: 6d65 6465 6c74 6128 312c 2075 6e69 743d  medelta(1, unit=
+000459d0: 756e 6974 295d 290a 2020 2020 7265 7475  unit)]).    retu
+000459e0: 726e 206d 6170 5f70 6172 7469 7469 6f6e  rn map_partition
+000459f0: 7328 7064 2e74 6f5f 7469 6d65 6465 6c74  s(pd.to_timedelt
+00045a00: 612c 2061 7267 2c20 756e 6974 3d75 6e69  a, arg, unit=uni
+00045a10: 742c 2065 7272 6f72 733d 6572 726f 7273  t, errors=errors
+00045a20: 2c20 6d65 7461 3d6d 6574 6129 0a0a 0a69  , meta=meta)...i
+00045a30: 6620 6861 7361 7474 7228 7064 2c20 2269  f hasattr(pd, "i
+00045a40: 736e 6122 293a 0a0a 2020 2020 4077 7261  sna"):..    @wra
+00045a50: 7073 2870 642e 6973 6e61 290a 2020 2020  ps(pd.isna).    
+00045a60: 6465 6620 6973 6e61 2861 7267 293a 0a20  def isna(arg):. 
+00045a70: 2020 2020 2020 2072 6574 7572 6e20 6d61         return ma
+00045a80: 705f 7061 7274 6974 696f 6e73 2870 642e  p_partitions(pd.
+00045a90: 6973 6e61 2c20 6172 6729 0a0a 0a64 6566  isna, arg)...def
+00045aa0: 205f 7265 7072 5f64 6174 615f 7365 7269   _repr_data_seri
+00045ab0: 6573 2873 2c20 696e 6465 7829 3a0a 2020  es(s, index):.  
+00045ac0: 2020 2222 2241 2068 656c 7065 7220 666f    """A helper fo
+00045ad0: 7220 6372 6561 7469 6e67 2074 6865 2060  r creating the `
+00045ae0: 605f 7265 7072 5f64 6174 6160 6020 7072  `_repr_data`` pr
+00045af0: 6f70 6572 7479 2222 220a 2020 2020 6e70  operty""".    np
+00045b00: 6172 7469 7469 6f6e 7320 3d20 6c65 6e28  artitions = len(
+00045b10: 696e 6465 7829 202d 2031 0a20 2020 2069  index) - 1.    i
+00045b20: 6620 6973 696e 7374 616e 6365 2873 2e64  f isinstance(s.d
+00045b30: 7479 7065 2c20 7064 2e43 6174 6567 6f72  type, pd.Categor
+00045b40: 6963 616c 4474 7970 6529 3a0a 2020 2020  icalDtype):.    
+00045b50: 2020 2020 6966 2068 6173 5f6b 6e6f 776e      if has_known
+00045b60: 5f63 6174 6567 6f72 6965 7328 7329 3a0a  _categories(s):.
+00045b70: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+00045b80: 6520 3d20 2263 6174 6567 6f72 795b 6b6e  e = "category[kn
+00045b90: 6f77 6e5d 220a 2020 2020 2020 2020 656c  own]".        el
+00045ba0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00045bb0: 6474 7970 6520 3d20 2263 6174 6567 6f72  dtype = "categor
+00045bc0: 795b 756e 6b6e 6f77 6e5d 220a 2020 2020  y[unknown]".    
+00045bd0: 656c 7365 3a0a 2020 2020 2020 2020 6474  else:.        dt
+00045be0: 7970 6520 3d20 7374 7228 732e 6474 7970  ype = str(s.dtyp
+00045bf0: 6529 0a20 2020 2072 6574 7572 6e20 7064  e).    return pd
+00045c00: 2e53 6572 6965 7328 5b64 7479 7065 5d20  .Series([dtype] 
+00045c10: 2b20 5b22 2e2e 2e22 5d20 2a20 6e70 6172  + ["..."] * npar
+00045c20: 7469 7469 6f6e 732c 2069 6e64 6578 3d69  titions, index=i
+00045c30: 6e64 6578 2c20 6e61 6d65 3d73 2e6e 616d  ndex, name=s.nam
+00045c40: 6529 0a0a 0a64 6566 2068 6173 5f70 6172  e)...def has_par
+00045c50: 616c 6c65 6c5f 7479 7065 2878 293a 0a20  allel_type(x):. 
+00045c60: 2020 2022 2222 446f 6573 2074 6869 7320     """Does this 
+00045c70: 6f62 6a65 6374 2068 6176 6520 6120 6461  object have a da
+00045c80: 736b 2064 6174 6166 7261 6d65 2065 7175  sk dataframe equ
+00045c90: 6976 616c 656e 743f 2222 220a 2020 2020  ivalent?""".    
+00045ca0: 7265 7475 726e 2067 6574 5f70 6172 616c  return get_paral
+00045cb0: 6c65 6c5f 7479 7065 2878 2920 6973 206e  lel_type(x) is n
+00045cc0: 6f74 2053 6361 6c61 720a 0a0a 6465 6620  ot Scalar...def 
+00045cd0: 6e65 775f 6464 5f6f 626a 6563 7428 6473  new_dd_object(ds
+00045ce0: 6b2c 206e 616d 652c 206d 6574 612c 2064  k, name, meta, d
+00045cf0: 6976 6973 696f 6e73 2c20 7061 7265 6e74  ivisions, parent
+00045d00: 5f6d 6574 613d 4e6f 6e65 293a 0a20 2020  _meta=None):.   
+00045d10: 2022 2222 4765 6e65 7269 6320 636f 6e73   """Generic cons
+00045d20: 7472 7563 746f 7220 666f 7220 6461 736b  tructor for dask
+00045d30: 2e64 6174 6166 7261 6d65 206f 626a 6563  .dataframe objec
+00045d40: 7473 2e0a 0a20 2020 2044 6563 6964 6573  ts...    Decides
+00045d50: 2074 6865 2061 7070 726f 7072 6961 7465   the appropriate
+00045d60: 206f 7574 7075 7420 636c 6173 7320 6261   output class ba
+00045d70: 7365 6420 6f6e 2074 6865 2074 7970 6520  sed on the type 
+00045d80: 6f66 2060 6d65 7461 6020 7072 6f76 6964  of `meta` provid
+00045d90: 6564 2e0a 2020 2020 2222 220a 2020 2020  ed..    """.    
+00045da0: 6966 2068 6173 5f70 6172 616c 6c65 6c5f  if has_parallel_
+00045db0: 7479 7065 286d 6574 6129 3a0a 2020 2020  type(meta):.    
+00045dc0: 2020 2020 7265 7475 726e 2067 6574 5f70      return get_p
+00045dd0: 6172 616c 6c65 6c5f 7479 7065 286d 6574  arallel_type(met
+00045de0: 6129 2864 736b 2c20 6e61 6d65 2c20 6d65  a)(dsk, name, me
+00045df0: 7461 2c20 6469 7669 7369 6f6e 7329 0a20  ta, divisions). 
+00045e00: 2020 2065 6c69 6620 6973 5f61 7272 6179     elif is_array
+00045e10: 6c69 6b65 286d 6574 6129 2061 6e64 206d  like(meta) and m
+00045e20: 6574 612e 7368 6170 653a 0a20 2020 2020  eta.shape:.     
+00045e30: 2020 2069 6d70 6f72 7420 6461 736b 2e61     import dask.a
+00045e40: 7272 6179 2061 7320 6461 0a0a 2020 2020  rray as da..    
+00045e50: 2020 2020 6368 756e 6b73 203d 2028 286e      chunks = ((n
+00045e60: 702e 6e61 6e2c 2920 2a20 286c 656e 2864  p.nan,) * (len(d
+00045e70: 6976 6973 696f 6e73 2920 2d20 3129 2c29  ivisions) - 1),)
+00045e80: 202b 2074 7570 6c65 280a 2020 2020 2020   + tuple(.      
+00045e90: 2020 2020 2020 2864 2c29 2066 6f72 2064        (d,) for d
+00045ea0: 2069 6e20 6d65 7461 2e73 6861 7065 5b31   in meta.shape[1
+00045eb0: 3a5d 0a20 2020 2020 2020 2029 0a20 2020  :].        ).   
+00045ec0: 2020 2020 2069 6620 6c65 6e28 6368 756e       if len(chun
+00045ed0: 6b73 2920 3e20 313a 0a20 2020 2020 2020  ks) > 1:.       
+00045ee0: 2020 2020 206c 6179 6572 203d 2064 736b       layer = dsk
+00045ef0: 2e6c 6179 6572 735b 6e61 6d65 5d0a 2020  .layers[name].  
+00045f00: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00045f10: 6e73 7461 6e63 6528 6c61 7965 722c 2042  nstance(layer, B
+00045f20: 6c6f 636b 7769 7365 293a 0a20 2020 2020  lockwise):.     
+00045f30: 2020 2020 2020 2020 2020 206c 6179 6572             layer
+00045f40: 2e6e 6577 5f61 7865 735b 226a 225d 203d  .new_axes["j"] =
+00045f50: 2063 6875 6e6b 735b 315d 5b30 5d0a 2020   chunks[1][0].  
+00045f60: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+00045f70: 7965 722e 6f75 7470 7574 5f69 6e64 6963  yer.output_indic
+00045f80: 6573 203d 206c 6179 6572 2e6f 7574 7075  es = layer.outpu
+00045f90: 745f 696e 6469 6365 7320 2b20 2822 6a22  t_indices + ("j"
+00045fa0: 2c29 0a20 2020 2020 2020 2020 2020 2065  ,).            e
+00045fb0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00045fc0: 2020 2020 2073 7566 6669 7820 3d20 2830       suffix = (0
+00045fd0: 2c29 202a 2028 6c65 6e28 6368 756e 6b73  ,) * (len(chunks
+00045fe0: 2920 2d20 3129 0a20 2020 2020 2020 2020  ) - 1).         
+00045ff0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00046000: 7261 6e67 6528 6c65 6e28 6368 756e 6b73  range(len(chunks
+00046010: 5b30 5d29 293a 0a20 2020 2020 2020 2020  [0])):.         
+00046020: 2020 2020 2020 2020 2020 206c 6179 6572             layer
+00046030: 5b28 6e61 6d65 2c20 6929 202b 2073 7566  [(name, i) + suf
+00046040: 6669 785d 203d 206c 6179 6572 2e70 6f70  fix] = layer.pop
+00046050: 2828 6e61 6d65 2c20 6929 290a 2020 2020  ((name, i)).    
+00046060: 2020 2020 7265 7475 726e 2064 612e 4172      return da.Ar
+00046070: 7261 7928 6473 6b2c 206e 616d 653d 6e61  ray(dsk, name=na
+00046080: 6d65 2c20 6368 756e 6b73 3d63 6875 6e6b  me, chunks=chunk
+00046090: 732c 2064 7479 7065 3d6d 6574 612e 6474  s, dtype=meta.dt
+000460a0: 7970 6529 0a20 2020 2065 6c73 653a 0a20  ype).    else:. 
+000460b0: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
+000460c0: 745f 7061 7261 6c6c 656c 5f74 7970 6528  t_parallel_type(
+000460d0: 6d65 7461 2928 6473 6b2c 206e 616d 652c  meta)(dsk, name,
+000460e0: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
+000460f0: 290a 0a0a 6465 6620 7061 7274 6974 696f  )...def partitio
+00046100: 6e77 6973 655f 6772 6170 6828 6675 6e63  nwise_graph(func
+00046110: 2c20 6c61 7965 725f 6e61 6d65 2c20 2a61  , layer_name, *a
+00046120: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+00046130: 2020 2020 2222 220a 2020 2020 4170 706c      """.    Appl
+00046140: 7920 6120 6675 6e63 7469 6f6e 2070 6172  y a function par
+00046150: 7469 7469 6f6e 2d77 6973 6520 6163 726f  tition-wise acro
+00046160: 7373 2061 7267 756d 656e 7473 2074 6f20  ss arguments to 
+00046170: 6372 6561 7465 206c 6179 6572 206f 6620  create layer of 
+00046180: 6120 6772 6170 680a 0a20 2020 2054 6869  a graph..    Thi
+00046190: 7320 6170 706c 6965 7320 6120 6675 6e63  s applies a func
+000461a0: 7469 6f6e 2c20 6060 6675 6e63 6060 2c20  tion, ``func``, 
+000461b0: 696e 2061 6e20 656d 6261 7272 6173 7369  in an embarrassi
+000461c0: 6e67 6c79 2070 6172 616c 6c65 6c20 6661  ngly parallel fa
+000461d0: 7368 696f 6e0a 2020 2020 6163 726f 7373  shion.    across
+000461e0: 2070 6172 7469 7469 6f6e 732f 6368 756e   partitions/chun
+000461f0: 6b73 2069 6e20 7468 6520 7072 6f76 6964  ks in the provid
+00046200: 6564 2061 7267 756d 656e 7473 2e20 2049  ed arguments.  I
+00046210: 7420 6861 6e64 6c65 7320 4461 7461 6672  t handles Datafr
+00046220: 616d 6573 2c0a 2020 2020 4172 7261 7973  ames,.    Arrays
+00046230: 2c20 616e 6420 7363 616c 6172 7320 736d  , and scalars sm
+00046240: 6f6f 7468 6c79 2c20 616e 6420 7265 6c69  oothly, and reli
+00046250: 6573 206f 6e20 7468 6520 6060 626c 6f63  es on the ``bloc
+00046260: 6b77 6973 6560 6020 6d61 6368 696e 6572  kwise`` machiner
+00046270: 790a 2020 2020 746f 2070 726f 7669 6465  y.    to provide
+00046280: 2061 206e 6963 656c 7920 7379 6d62 6f6c   a nicely symbol
+00046290: 6963 2067 7261 7068 2e0a 0a20 2020 2049  ic graph...    I
+000462a0: 7420 6973 206d 6f73 7420 636f 6d6d 6f6e  t is most common
+000462b0: 6c79 2075 7365 6420 696e 206f 7468 6572  ly used in other
+000462c0: 2067 7261 7068 2d62 7569 6c64 696e 6720   graph-building 
+000462d0: 6675 6e63 7469 6f6e 7320 746f 2063 7265  functions to cre
+000462e0: 6174 6520 7468 650a 2020 2020 6170 7072  ate the.    appr
+000462f0: 6f70 7269 6174 6520 6c61 7965 7220 6f66  opriate layer of
+00046300: 2074 6865 2072 6573 756c 7469 6e67 2064   the resulting d
+00046310: 6174 6166 7261 6d65 2e0a 0a20 2020 2050  ataframe...    P
+00046320: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+00046330: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066 756e  --------.    fun
+00046340: 633a 2063 616c 6c61 626c 650a 2020 2020  c: callable.    
+00046350: 6c61 7965 725f 6e61 6d65 3a20 7374 720a  layer_name: str.
+00046360: 2020 2020 2020 2020 4465 7363 7269 7074          Descript
+00046370: 6976 6520 6e61 6d65 2066 6f72 2074 6865  ive name for the
+00046380: 206f 7065 7261 7469 6f6e 2e20 5573 6564   operation. Used
+00046390: 2061 7320 7468 6520 6f75 7470 7574 206e   as the output n
+000463a0: 616d 650a 2020 2020 2020 2020 696e 2074  ame.        in t
+000463b0: 6865 2072 6573 756c 7469 6e67 2060 6042  he resulting ``B
+000463c0: 6c6f 636b 7769 7365 6060 2067 7261 7068  lockwise`` graph
+000463d0: 206c 6179 6572 2e0a 2020 2020 2a61 7267   layer..    *arg
+000463e0: 733a 0a20 2020 202a 2a6b 7761 7267 733a  s:.    **kwargs:
+000463f0: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
+00046400: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6f75    -------.    ou
+00046410: 743a 2042 6c6f 636b 7769 7365 2067 7261  t: Blockwise gra
+00046420: 7068 0a0a 2020 2020 4578 616d 706c 6573  ph..    Examples
+00046430: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
+00046440: 2020 3e3e 3e20 7375 6267 7261 7068 203d    >>> subgraph =
+00046450: 2070 6172 7469 7469 6f6e 7769 7365 5f67   partitionwise_g
+00046460: 7261 7068 2866 756e 6374 696f 6e2c 2078  raph(function, x
+00046470: 2c20 792c 207a 3d31 3233 2920 2023 2064  , y, z=123)  # d
+00046480: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
+00046490: 2020 3e3e 3e20 6c61 7965 7220 3d20 7061    >>> layer = pa
+000464a0: 7274 6974 696f 6e77 6973 655f 6772 6170  rtitionwise_grap
+000464b0: 6828 6675 6e63 7469 6f6e 2c20 6466 2c20  h(function, df, 
+000464c0: 782c 207a 3d31 3233 2920 2023 2064 6f63  x, z=123)  # doc
+000464d0: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
+000464e0: 3e3e 3e20 6772 6170 6820 3d20 4869 6768  >>> graph = High
+000464f0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+00046500: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
+00046510: 2c20 6c61 7965 722c 2064 6570 656e 6465  , layer, depende
+00046520: 6e63 6965 733d 5b64 662c 2078 5d29 2020  ncies=[df, x])  
+00046530: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
+00046540: 0a20 2020 203e 3e3e 2072 6573 756c 7420  .    >>> result 
+00046550: 3d20 6e65 775f 6464 5f6f 626a 6563 7428  = new_dd_object(
+00046560: 6772 6170 682c 206e 616d 652c 206d 6574  graph, name, met
+00046570: 6164 6174 612c 2064 662e 6469 7669 7369  adata, df.divisi
+00046580: 6f6e 7329 2020 2320 646f 6374 6573 743a  ons)  # doctest:
+00046590: 202b 534b 4950 0a0a 2020 2020 5365 6520   +SKIP..    See 
+000465a0: 416c 736f 0a20 2020 202d 2d2d 2d2d 2d2d  Also.    -------
+000465b0: 2d0a 2020 2020 6d61 705f 7061 7274 6974  -.    map_partit
+000465c0: 696f 6e73 0a20 2020 2022 2222 0a20 2020  ions.    """.   
+000465d0: 2070 6169 7273 203d 205b 5d0a 2020 2020   pairs = [].    
+000465e0: 6e75 6d62 6c6f 636b 7320 3d20 7b7d 0a20  numblocks = {}. 
+000465f0: 2020 2066 6f72 2061 7267 2069 6e20 6172     for arg in ar
+00046600: 6773 3a0a 2020 2020 2020 2020 6966 2069  gs:.        if i
+00046610: 7369 6e73 7461 6e63 6528 6172 672c 205f  sinstance(arg, _
+00046620: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
+00046630: 2020 2020 7061 6972 732e 6578 7465 6e64      pairs.extend
+00046640: 285b 6172 672e 5f6e 616d 652c 2022 6922  ([arg._name, "i"
+00046650: 5d29 0a20 2020 2020 2020 2020 2020 206e  ]).            n
+00046660: 756d 626c 6f63 6b73 5b61 7267 2e5f 6e61  umblocks[arg._na
+00046670: 6d65 5d20 3d20 2861 7267 2e6e 7061 7274  me] = (arg.npart
+00046680: 6974 696f 6e73 2c29 0a20 2020 2020 2020  itions,).       
+00046690: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+000466a0: 2861 7267 2c20 5363 616c 6172 293a 0a20  (arg, Scalar):. 
+000466b0: 2020 2020 2020 2020 2020 2070 6169 7273             pairs
+000466c0: 2e65 7874 656e 6428 5b61 7267 2e5f 6e61  .extend([arg._na
+000466d0: 6d65 2c20 2269 225d 290a 2020 2020 2020  me, "i"]).      
+000466e0: 2020 2020 2020 6e75 6d62 6c6f 636b 735b        numblocks[
+000466f0: 6172 672e 5f6e 616d 655d 203d 2028 312c  arg._name] = (1,
+00046700: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
+00046710: 7369 6e73 7461 6e63 6528 6172 672c 2041  sinstance(arg, A
+00046720: 7272 6179 293a 0a20 2020 2020 2020 2020  rray):.         
+00046730: 2020 2069 6620 6172 672e 6e64 696d 203d     if arg.ndim =
+00046740: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00046750: 2020 2020 2070 6169 7273 2e65 7874 656e       pairs.exten
+00046760: 6428 5b61 7267 2e6e 616d 652c 2022 6922  d([arg.name, "i"
+00046770: 5d29 0a20 2020 2020 2020 2020 2020 2065  ]).            e
+00046780: 6c69 6620 6172 672e 6e64 696d 203d 3d20  lif arg.ndim == 
+00046790: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+000467a0: 2020 2070 6169 7273 2e65 7874 656e 6428     pairs.extend(
+000467b0: 5b61 7267 2e6e 616d 652c 2022 225d 290a  [arg.name, ""]).
+000467c0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000467d0: 2061 7267 2e6e 6469 6d20 3d3d 2032 3a0a   arg.ndim == 2:.
+000467e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000467f0: 7061 6972 732e 6578 7465 6e64 285b 6172  pairs.extend([ar
+00046800: 672e 6e61 6d65 2c20 2269 6a22 5d29 0a20  g.name, "ij"]). 
+00046810: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00046820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00046830: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00046840: 7228 2243 616e 2774 2061 6464 206d 756c  r("Can't add mul
+00046850: 7469 2d64 696d 656e 7369 6f6e 616c 2061  ti-dimensional a
+00046860: 7272 6179 2074 6f20 6461 7461 6672 616d  rray to datafram
+00046870: 6573 2229 0a20 2020 2020 2020 2020 2020  es").           
+00046880: 206e 756d 626c 6f63 6b73 5b61 7267 2e5f   numblocks[arg._
+00046890: 6e61 6d65 5d20 3d20 6172 672e 6e75 6d62  name] = arg.numb
+000468a0: 6c6f 636b 730a 2020 2020 2020 2020 656c  locks.        el
+000468b0: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
+000468c0: 672c 2042 6c6f 636b 7769 7365 4465 7029  g, BlockwiseDep)
+000468d0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000468e0: 206c 656e 2861 7267 2e6e 756d 626c 6f63   len(arg.numbloc
+000468f0: 6b73 2920 3d3d 2031 3a0a 2020 2020 2020  ks) == 1:.      
+00046900: 2020 2020 2020 2020 2020 7061 6972 732e            pairs.
+00046910: 6578 7465 6e64 285b 6172 672c 2022 6922  extend([arg, "i"
+00046920: 5d29 0a20 2020 2020 2020 2020 2020 2065  ]).            e
+00046930: 6c69 6620 6c65 6e28 6172 672e 6e75 6d62  lif len(arg.numb
+00046940: 6c6f 636b 7329 203d 3d20 323a 0a20 2020  locks) == 2:.   
+00046950: 2020 2020 2020 2020 2020 2020 2070 6169               pai
+00046960: 7273 2e65 7874 656e 6428 5b61 7267 2c20  rs.extend([arg, 
+00046970: 2269 6a22 5d29 0a20 2020 2020 2020 2020  "ij"]).         
+00046980: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00046990: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000469a0: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+000469b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000469c0: 2242 6c6f 636b 7769 7365 4465 7020 6172  "BlockwiseDep ar
+000469d0: 6720 7b61 7267 2172 7d20 6861 7320 7b6c  g {arg!r} has {l
+000469e0: 656e 2861 7267 2e6e 756d 626c 6f63 6b73  en(arg.numblocks
+000469f0: 297d 2064 696d 656e 7369 6f6e 733b 206f  )} dimensions; o
+00046a00: 6e6c 7920 3120 6f72 2032 2061 7265 2073  nly 1 or 2 are s
+00046a10: 7570 706f 7274 6564 2e22 0a20 2020 2020  upported.".     
+00046a20: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00046a30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00046a40: 2020 2020 2020 2070 6169 7273 2e65 7874         pairs.ext
+00046a50: 656e 6428 5b61 7267 2c20 4e6f 6e65 5d29  end([arg, None])
+00046a60: 0a20 2020 2072 6574 7572 6e20 626c 6f63  .    return bloc
+00046a70: 6b77 6973 6528 0a20 2020 2020 2020 2066  kwise(.        f
+00046a80: 756e 632c 206c 6179 6572 5f6e 616d 652c  unc, layer_name,
+00046a90: 2022 6922 2c20 2a70 6169 7273 2c20 6e75   "i", *pairs, nu
+00046aa0: 6d62 6c6f 636b 733d 6e75 6d62 6c6f 636b  mblocks=numblock
+00046ab0: 732c 2063 6f6e 6361 7465 6e61 7465 3d54  s, concatenate=T
+00046ac0: 7275 652c 202a 2a6b 7761 7267 730a 2020  rue, **kwargs.  
+00046ad0: 2020 290a 0a0a 6465 6620 6d65 7461 5f77    )...def meta_w
+00046ae0: 6172 6e69 6e67 2864 6629 3a0a 2020 2020  arning(df):.    
+00046af0: 2222 220a 2020 2020 5072 6f76 6964 6520  """.    Provide 
+00046b00: 616e 2069 6e66 6f72 6d61 7469 7665 206d  an informative m
+00046b10: 6573 7361 6765 2077 6865 6e20 7468 6520  essage when the 
+00046b20: 7573 6572 2069 7320 6173 6b65 6420 746f  user is asked to
+00046b30: 2070 726f 7669 6465 206d 6574 6164 6174   provide metadat
+00046b40: 610a 2020 2020 2222 220a 2020 2020 6966  a.    """.    if
+00046b50: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
+00046b60: 6b65 2864 6629 3a0a 2020 2020 2020 2020  ke(df):.        
+00046b70: 6d65 7461 5f73 7472 203d 207b 6b3a 2073  meta_str = {k: s
+00046b80: 7472 2876 2920 666f 7220 6b2c 2076 2069  tr(v) for k, v i
+00046b90: 6e20 6466 2e64 7479 7065 732e 746f 5f64  n df.dtypes.to_d
+00046ba0: 6963 7428 292e 6974 656d 7328 297d 0a20  ict().items()}. 
+00046bb0: 2020 2065 6c69 6620 6973 5f73 6572 6965     elif is_serie
+00046bc0: 735f 6c69 6b65 2864 6629 3a0a 2020 2020  s_like(df):.    
+00046bd0: 2020 2020 6d65 7461 5f73 7472 203d 2028      meta_str = (
+00046be0: 6466 2e6e 616d 652c 2073 7472 2864 662e  df.name, str(df.
+00046bf0: 6474 7970 6529 290a 2020 2020 656c 7365  dtype)).    else
+00046c00: 3a0a 2020 2020 2020 2020 6d65 7461 5f73  :.        meta_s
+00046c10: 7472 203d 204e 6f6e 650a 2020 2020 6d73  tr = None.    ms
+00046c20: 6720 3d20 280a 2020 2020 2020 2020 225c  g = (.        "\
+00046c30: 6e59 6f75 2064 6964 206e 6f74 2070 726f  nYou did not pro
+00046c40: 7669 6465 206d 6574 6164 6174 612c 2073  vide metadata, s
+00046c50: 6f20 4461 736b 2069 7320 7275 6e6e 696e  o Dask is runnin
+00046c60: 6720 796f 7572 2022 0a20 2020 2020 2020  g your ".       
+00046c70: 2022 6675 6e63 7469 6f6e 206f 6e20 6120   "function on a 
+00046c80: 736d 616c 6c20 6461 7461 7365 7420 746f  small dataset to
+00046c90: 2067 7565 7373 206f 7574 7075 7420 7479   guess output ty
+00046ca0: 7065 732e 2022 0a20 2020 2020 2020 2022  pes. ".        "
+00046cb0: 4974 2069 7320 706f 7373 6962 6c65 2074  It is possible t
+00046cc0: 6861 7420 4461 736b 2077 696c 6c20 6775  hat Dask will gu
+00046cd0: 6573 7320 696e 636f 7272 6563 746c 792e  ess incorrectly.
+00046ce0: 5c6e 220a 2020 2020 2020 2020 2254 6f20  \n".        "To 
+00046cf0: 7072 6f76 6964 6520 616e 2065 7870 6c69  provide an expli
+00046d00: 6369 7420 6f75 7470 7574 2074 7970 6573  cit output types
+00046d10: 206f 7220 746f 2073 696c 656e 6365 2074   or to silence t
+00046d20: 6869 7320 6d65 7373 6167 652c 2022 0a20  his message, ". 
+00046d30: 2020 2020 2020 2022 706c 6561 7365 2070         "please p
+00046d40: 726f 7669 6465 2074 6865 2060 6d65 7461  rovide the `meta
+00046d50: 3d60 206b 6579 776f 7264 2c20 6173 2064  =` keyword, as d
+00046d60: 6573 6372 6962 6564 2069 6e20 7468 6520  escribed in the 
+00046d70: 6d61 7020 6f72 2022 0a20 2020 2020 2020  map or ".       
+00046d80: 2022 6170 706c 7920 6675 6e63 7469 6f6e   "apply function
+00046d90: 2074 6861 7420 796f 7520 6172 6520 7573   that you are us
+00046da0: 696e 672e 220a 2020 2020 290a 2020 2020  ing.".    ).    
+00046db0: 6966 206d 6574 615f 7374 723a 0a20 2020  if meta_str:.   
+00046dc0: 2020 2020 206d 7367 202b 3d20 280a 2020       msg += (.  
+00046dd0: 2020 2020 2020 2020 2020 225c 6e22 0a20            "\n". 
+00046de0: 2020 2020 2020 2020 2020 2022 2020 4265             "  Be
+00046df0: 666f 7265 3a20 2e61 7070 6c79 2866 756e  fore: .apply(fun
+00046e00: 6329 5c6e 220a 2020 2020 2020 2020 2020  c)\n".          
+00046e10: 2020 2220 2041 6674 6572 3a20 202e 6170    "  After:  .ap
+00046e20: 706c 7928 6675 6e63 2c20 6d65 7461 3d25  ply(func, meta=%
+00046e30: 7329 5c6e 2220 2520 7374 7228 6d65 7461  s)\n" % str(meta
+00046e40: 5f73 7472 290a 2020 2020 2020 2020 290a  _str).        ).
+00046e50: 2020 2020 7265 7475 726e 206d 7367 0a0a      return msg..
+00046e60: 0a64 6566 2070 7265 6669 785f 7265 6475  .def prefix_redu
+00046e70: 6374 696f 6e28 662c 2064 6466 2c20 6964  ction(f, ddf, id
+00046e80: 656e 7469 7479 2c20 2a2a 6b77 6172 6773  entity, **kwargs
+00046e90: 293a 0a20 2020 2022 2222 436f 6d70 7574  ):.    """Comput
+00046ea0: 6573 2074 6865 2070 7265 6669 7820 7375  es the prefix su
+00046eb0: 6d73 206f 6620 6620 6f6e 2064 660a 0a20  ms of f on df.. 
+00046ec0: 2020 2049 6620 6466 2068 6173 2070 6172     If df has par
+00046ed0: 7469 7469 6f6e 7320 5b50 312c 2050 322c  titions [P1, P2,
+00046ee0: 202e 2e2e 2c20 506e 5d2c 2074 6865 6e20   ..., Pn], then 
+00046ef0: 7265 7475 726e 7320 7468 6520 4461 7461  returns the Data
+00046f00: 4672 616d 6520 7769 7468 0a20 2020 2070  Frame with.    p
+00046f10: 6172 7469 7469 6f6e 7320 5b66 2869 6465  artitions [f(ide
+00046f20: 6e74 6974 792c 2050 3129 2c0a 2020 2020  ntity, P1),.    
+00046f30: 2020 2020 2020 2020 2020 2020 6628 6628              f(f(
+00046f40: 6964 656e 7469 7479 2c20 5031 292c 2050  identity, P1), P
+00046f50: 3229 2c0a 2020 2020 2020 2020 2020 2020  2),.            
+00046f60: 2020 2020 6628 6628 6628 6964 656e 7469      f(f(f(identi
+00046f70: 7479 2c20 5031 292c 2050 3229 2c20 5033  ty, P1), P2), P3
+00046f80: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00046f90: 2020 202e 2e2e 5d0a 0a20 2020 2050 6172     ...]..    Par
+00046fa0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00046fb0: 2d2d 2d2d 2d2d 0a20 2020 2066 203a 2063  ------.    f : c
+00046fc0: 616c 6c61 626c 650a 2020 2020 2020 2020  allable.        
+00046fd0: 616e 2061 7373 6f63 6961 7469 7665 2066  an associative f
+00046fe0: 756e 6374 696f 6e20 660a 2020 2020 6464  unction f.    dd
+00046ff0: 6620 3a20 6464 2e44 6174 6146 7261 6d65  f : dd.DataFrame
+00047000: 0a20 2020 2069 6465 6e74 6974 7920 3a20  .    identity : 
+00047010: 7064 2e44 6174 6146 7261 6d65 0a20 2020  pd.DataFrame.   
+00047020: 2020 2020 2061 6e20 6964 656e 7469 7479       an identity
+00047030: 2065 6c65 6d65 6e74 206f 6620 662c 2074   element of f, t
+00047040: 6861 7420 6973 2066 2869 6465 6e74 6974  hat is f(identit
+00047050: 792c 2064 6629 203d 2066 2864 662c 2069  y, df) = f(df, i
+00047060: 6465 6e74 6974 7929 203d 2064 660a 2020  dentity) = df.  
+00047070: 2020 2222 220a 2020 2020 6473 6b20 3d20    """.    dsk = 
+00047080: 6469 6374 2829 0a20 2020 206e 616d 6520  dict().    name 
+00047090: 3d20 2270 7265 6669 785f 7265 6475 6374  = "prefix_reduct
+000470a0: 696f 6e2d 2220 2b20 746f 6b65 6e69 7a65  ion-" + tokenize
+000470b0: 2866 2c20 6464 662c 2069 6465 6e74 6974  (f, ddf, identit
+000470c0: 792c 202a 2a6b 7761 7267 7329 0a20 2020  y, **kwargs).   
+000470d0: 206d 6574 6120 3d20 6464 662e 5f6d 6574   meta = ddf._met
+000470e0: 610a 2020 2020 6e20 3d20 6c65 6e28 6464  a.    n = len(dd
+000470f0: 662e 6469 7669 7369 6f6e 7329 202d 2031  f.divisions) - 1
+00047100: 0a20 2020 2064 6976 6973 696f 6e73 203d  .    divisions =
+00047110: 205b 4e6f 6e65 5d20 2a20 286e 202b 2031   [None] * (n + 1
+00047120: 290a 0a20 2020 204e 203d 2031 0a20 2020  )..    N = 1.   
+00047130: 2077 6869 6c65 204e 203c 206e 3a0a 2020   while N < n:.  
+00047140: 2020 2020 2020 4e20 2a3d 2032 0a20 2020        N *= 2.   
+00047150: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00047160: 6e29 3a0a 2020 2020 2020 2020 6473 6b5b  n):.        dsk[
+00047170: 286e 616d 652c 2069 2c20 312c 2030 295d  (name, i, 1, 0)]
+00047180: 203d 2028 6170 706c 792c 2066 2c20 5b28   = (apply, f, [(
+00047190: 6464 662e 5f6e 616d 652c 2069 292c 2069  ddf._name, i), i
+000471a0: 6465 6e74 6974 795d 2c20 6b77 6172 6773  dentity], kwargs
+000471b0: 290a 2020 2020 666f 7220 6920 696e 2072  ).    for i in r
+000471c0: 616e 6765 286e 2c20 4e29 3a0a 2020 2020  ange(n, N):.    
+000471d0: 2020 2020 6473 6b5b 286e 616d 652c 2069      dsk[(name, i
+000471e0: 2c20 312c 2030 295d 203d 2069 6465 6e74  , 1, 0)] = ident
+000471f0: 6974 790a 0a20 2020 2064 203d 2031 0a20  ity..    d = 1. 
+00047200: 2020 2077 6869 6c65 2064 203c 204e 3a0a     while d < N:.
+00047210: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00047220: 2072 616e 6765 2830 2c20 4e2c 2032 202a   range(0, N, 2 *
+00047230: 2064 293a 0a20 2020 2020 2020 2020 2020   d):.           
+00047240: 2064 736b 5b28 6e61 6d65 2c20 6920 2b20   dsk[(name, i + 
+00047250: 3220 2a20 6420 2d20 312c 2032 202a 2064  2 * d - 1, 2 * d
+00047260: 2c20 3029 5d20 3d20 280a 2020 2020 2020  , 0)] = (.      
+00047270: 2020 2020 2020 2020 2020 6170 706c 792c            apply,
+00047280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00047290: 2066 2c0a 2020 2020 2020 2020 2020 2020   f,.            
+000472a0: 2020 2020 5b28 6e61 6d65 2c20 6920 2b20      [(name, i + 
+000472b0: 6420 2d20 312c 2064 2c20 3029 2c20 286e  d - 1, d, 0), (n
+000472c0: 616d 652c 2069 202b 2032 202a 2064 202d  ame, i + 2 * d -
+000472d0: 2031 2c20 642c 2030 295d 2c0a 2020 2020   1, d, 0)],.    
+000472e0: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
+000472f0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+00047300: 290a 2020 2020 2020 2020 6420 2a3d 2032  ).        d *= 2
+00047310: 0a0a 2020 2020 6473 6b5b 286e 616d 652c  ..    dsk[(name,
+00047320: 204e 202d 2031 2c20 4e2c 2031 295d 203d   N - 1, N, 1)] =
+00047330: 2069 6465 6e74 6974 790a 0a20 2020 2077   identity..    w
+00047340: 6869 6c65 2064 203e 2031 3a0a 2020 2020  hile d > 1:.    
+00047350: 2020 2020 6420 2f2f 3d20 320a 2020 2020      d //= 2.    
+00047360: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00047370: 6765 2830 2c20 4e2c 2032 202a 2064 293a  ge(0, N, 2 * d):
+00047380: 0a20 2020 2020 2020 2020 2020 2064 736b  .            dsk
+00047390: 5b28 6e61 6d65 2c20 6920 2b20 6420 2d20  [(name, i + d - 
+000473a0: 312c 2064 2c20 3129 5d20 3d20 286e 616d  1, d, 1)] = (nam
+000473b0: 652c 2069 202b 2032 202a 2064 202d 2031  e, i + 2 * d - 1
+000473c0: 2c20 3220 2a20 642c 2031 290a 2020 2020  , 2 * d, 1).    
+000473d0: 2020 2020 2020 2020 6473 6b5b 286e 616d          dsk[(nam
+000473e0: 652c 2069 202b 2032 202a 2064 202d 2031  e, i + 2 * d - 1
+000473f0: 2c20 642c 2031 295d 203d 2028 0a20 2020  , d, 1)] = (.   
+00047400: 2020 2020 2020 2020 2020 2020 2061 7070               app
+00047410: 6c79 2c0a 2020 2020 2020 2020 2020 2020  ly,.            
+00047420: 2020 2020 662c 0a20 2020 2020 2020 2020      f,.         
+00047430: 2020 2020 2020 205b 286e 616d 652c 2069         [(name, i
+00047440: 202b 2032 202a 2064 202d 2031 2c20 3220   + 2 * d - 1, 2 
+00047450: 2a20 642c 2031 292c 2028 6e61 6d65 2c20  * d, 1), (name, 
+00047460: 6920 2b20 6420 2d20 312c 2064 2c20 3029  i + d - 1, d, 0)
+00047470: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00047480: 2020 206b 7761 7267 732c 0a20 2020 2020     kwargs,.     
+00047490: 2020 2020 2020 2029 0a0a 2020 2020 666f         )..    fo
+000474a0: 7220 6920 696e 2072 616e 6765 286e 293a  r i in range(n):
+000474b0: 0a20 2020 2020 2020 2064 736b 5b28 6e61  .        dsk[(na
+000474c0: 6d65 2c20 6929 5d20 3d20 2861 7070 6c79  me, i)] = (apply
+000474d0: 2c20 662c 205b 286e 616d 652c 2069 2c20  , f, [(name, i, 
+000474e0: 312c 2031 292c 2069 6465 6e74 6974 795d  1, 1), identity]
+000474f0: 2c20 6b77 6172 6773 290a 0a20 2020 2067  , kwargs)..    g
+00047500: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
+00047510: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+00047520: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
+00047530: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
+00047540: 6464 665d 290a 2020 2020 7265 7475 726e  ddf]).    return
+00047550: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
+00047560: 7261 7068 2c20 6e61 6d65 2c20 6d65 7461  raph, name, meta
+00047570: 2c20 6469 7669 7369 6f6e 7329 0a0a 0a64  , divisions)...d
+00047580: 6566 2073 7566 6669 785f 7265 6475 6374  ef suffix_reduct
+00047590: 696f 6e28 662c 2064 6466 2c20 6964 656e  ion(f, ddf, iden
+000475a0: 7469 7479 2c20 2a2a 6b77 6172 6773 293a  tity, **kwargs):
+000475b0: 0a20 2020 2022 2222 436f 6d70 7574 6573  .    """Computes
+000475c0: 2074 6865 2073 7566 6669 7820 7375 6d73   the suffix sums
+000475d0: 206f 6620 6620 6f6e 2064 660a 0a20 2020   of f on df..   
+000475e0: 2049 6620 6466 2068 6173 2070 6172 7469   If df has parti
+000475f0: 7469 6f6e 7320 5b50 312c 2050 322c 202e  tions [P1, P2, .
+00047600: 2e2e 2c20 506e 5d2c 2074 6865 6e20 7265  .., Pn], then re
+00047610: 7475 726e 7320 7468 6520 4461 7461 4672  turns the DataFr
+00047620: 616d 6520 7769 7468 0a20 2020 2070 6172  ame with.    par
+00047630: 7469 7469 6f6e 7320 5b66 2850 312c 2066  titions [f(P1, f
+00047640: 2850 322c 202e 2e2e 6628 506e 2c20 6964  (P2, ...f(Pn, id
+00047650: 656e 7469 7479 292e 2e2e 2929 2c0a 2020  entity)...)),.  
+00047660: 2020 2020 2020 2020 2020 2020 2020 6628                f(
+00047670: 5032 2c20 2e2e 2e66 2850 6e2c 2069 6465  P2, ...f(Pn, ide
+00047680: 6e74 6974 7929 2e2e 2e29 2c0a 2020 2020  ntity)...),.    
+00047690: 2020 2020 2020 2020 2020 2020 2e2e 2e66              ...f
+000476a0: 2850 6e2c 2069 6465 6e74 6974 7929 2e2e  (Pn, identity)..
+000476b0: 2e2c 0a20 2020 2020 2020 2020 2020 2020  .,.             
+000476c0: 2020 202e 2e2e 5d0a 0a20 2020 2050 6172     ...]..    Par
+000476d0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+000476e0: 2d2d 2d2d 2d2d 0a20 2020 2066 203a 2063  ------.    f : c
+000476f0: 616c 6c61 626c 650a 2020 2020 2020 2020  allable.        
+00047700: 616e 2061 7373 6f63 6961 7469 7665 2066  an associative f
+00047710: 756e 6374 696f 6e20 660a 2020 2020 6464  unction f.    dd
+00047720: 6620 3a20 6464 2e44 6174 6146 7261 6d65  f : dd.DataFrame
+00047730: 0a20 2020 2069 6465 6e74 6974 7920 3a20  .    identity : 
+00047740: 7064 2e44 6174 6146 7261 6d65 0a20 2020  pd.DataFrame.   
+00047750: 2020 2020 2061 6e20 6964 656e 7469 7479       an identity
+00047760: 2065 6c65 6d65 6e74 206f 6620 662c 2074   element of f, t
+00047770: 6861 7420 6973 2066 2869 6465 6e74 6974  hat is f(identit
+00047780: 792c 2064 6629 203d 2066 2864 662c 2069  y, df) = f(df, i
+00047790: 6465 6e74 6974 7929 203d 2064 660a 2020  dentity) = df.  
+000477a0: 2020 6b77 6172 6773 203a 203f 3f0a 2020    kwargs : ??.  
+000477b0: 2020 2020 2020 6b65 7977 6f72 6420 6172        keyword ar
+000477c0: 6775 6d65 6e74 7320 6f66 2066 203f 3f0a  guments of f ??.
+000477d0: 2020 2020 2222 220a 2020 2020 6473 6b20      """.    dsk 
+000477e0: 3d20 6469 6374 2829 0a20 2020 206e 616d  = dict().    nam
+000477f0: 6520 3d20 2273 7566 6669 785f 7265 6475  e = "suffix_redu
+00047800: 6374 696f 6e2d 2220 2b20 746f 6b65 6e69  ction-" + tokeni
+00047810: 7a65 2866 2c20 6464 662c 2069 6465 6e74  ze(f, ddf, ident
+00047820: 6974 792c 202a 2a6b 7761 7267 7329 0a20  ity, **kwargs). 
+00047830: 2020 206d 6574 6120 3d20 6464 662e 5f6d     meta = ddf._m
+00047840: 6574 610a 2020 2020 6e20 3d20 6c65 6e28  eta.    n = len(
+00047850: 6464 662e 6469 7669 7369 6f6e 7329 202d  ddf.divisions) -
+00047860: 2031 0a20 2020 2064 6976 6973 696f 6e73   1.    divisions
+00047870: 203d 205b 4e6f 6e65 5d20 2a20 286e 202b   = [None] * (n +
+00047880: 2031 290a 0a20 2020 204e 203d 2031 0a20   1)..    N = 1. 
+00047890: 2020 2077 6869 6c65 204e 203c 206e 3a0a     while N < n:.
+000478a0: 2020 2020 2020 2020 4e20 2a3d 2032 0a20          N *= 2. 
+000478b0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+000478c0: 6528 6e29 3a0a 2020 2020 2020 2020 6473  e(n):.        ds
+000478d0: 6b5b 286e 616d 652c 2069 2c20 312c 2030  k[(name, i, 1, 0
+000478e0: 295d 203d 2028 6170 706c 792c 2066 2c20  )] = (apply, f, 
+000478f0: 5b28 6464 662e 5f6e 616d 652c 206e 202d  [(ddf._name, n -
+00047900: 2031 202d 2069 292c 2069 6465 6e74 6974   1 - i), identit
+00047910: 795d 2c20 6b77 6172 6773 290a 2020 2020  y], kwargs).    
+00047920: 666f 7220 6920 696e 2072 616e 6765 286e  for i in range(n
+00047930: 2c20 4e29 3a0a 2020 2020 2020 2020 6473  , N):.        ds
+00047940: 6b5b 286e 616d 652c 2069 2c20 312c 2030  k[(name, i, 1, 0
+00047950: 295d 203d 2069 6465 6e74 6974 790a 0a20  )] = identity.. 
+00047960: 2020 2064 203d 2031 0a20 2020 2077 6869     d = 1.    whi
+00047970: 6c65 2064 203c 204e 3a0a 2020 2020 2020  le d < N:.      
+00047980: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00047990: 2830 2c20 4e2c 2032 202a 2064 293a 0a20  (0, N, 2 * d):. 
+000479a0: 2020 2020 2020 2020 2020 2064 736b 5b28             dsk[(
+000479b0: 6e61 6d65 2c20 6920 2b20 3220 2a20 6420  name, i + 2 * d 
+000479c0: 2d20 312c 2032 202a 2064 2c20 3029 5d20  - 1, 2 * d, 0)] 
+000479d0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+000479e0: 2020 2020 6170 706c 792c 0a20 2020 2020      apply,.     
+000479f0: 2020 2020 2020 2020 2020 2066 2c0a 2020             f,.  
+00047a00: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
+00047a10: 6e61 6d65 2c20 6920 2b20 3220 2a20 6420  name, i + 2 * d 
+00047a20: 2d20 312c 2064 2c20 3029 2c20 286e 616d  - 1, d, 0), (nam
+00047a30: 652c 2069 202b 2064 202d 2031 2c20 642c  e, i + d - 1, d,
+00047a40: 2030 295d 2c0a 2020 2020 2020 2020 2020   0)],.          
+00047a50: 2020 2020 2020 6b77 6172 6773 2c0a 2020        kwargs,.  
+00047a60: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00047a70: 2020 2020 6420 2a3d 2032 0a0a 2020 2020      d *= 2..    
+00047a80: 6473 6b5b 286e 616d 652c 204e 202d 2031  dsk[(name, N - 1
+00047a90: 2c20 4e2c 2031 295d 203d 2069 6465 6e74  , N, 1)] = ident
+00047aa0: 6974 790a 0a20 2020 2077 6869 6c65 2064  ity..    while d
+00047ab0: 203e 2031 3a0a 2020 2020 2020 2020 6420   > 1:.        d 
+00047ac0: 2f2f 3d20 320a 2020 2020 2020 2020 666f  //= 2.        fo
+00047ad0: 7220 6920 696e 2072 616e 6765 2830 2c20  r i in range(0, 
+00047ae0: 4e2c 2032 202a 2064 293a 0a20 2020 2020  N, 2 * d):.     
+00047af0: 2020 2020 2020 2064 736b 5b28 6e61 6d65         dsk[(name
+00047b00: 2c20 6920 2b20 6420 2d20 312c 2064 2c20  , i + d - 1, d, 
+00047b10: 3129 5d20 3d20 286e 616d 652c 2069 202b  1)] = (name, i +
+00047b20: 2032 202a 2064 202d 2031 2c20 3220 2a20   2 * d - 1, 2 * 
+00047b30: 642c 2031 290a 2020 2020 2020 2020 2020  d, 1).          
+00047b40: 2020 6473 6b5b 286e 616d 652c 2069 202b    dsk[(name, i +
+00047b50: 2032 202a 2064 202d 2031 2c20 642c 2031   2 * d - 1, d, 1
+00047b60: 295d 203d 2028 0a20 2020 2020 2020 2020  )] = (.         
+00047b70: 2020 2020 2020 2061 7070 6c79 2c0a 2020         apply,.  
+00047b80: 2020 2020 2020 2020 2020 2020 2020 662c                f,
+00047b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00047ba0: 205b 286e 616d 652c 2069 202b 2064 202d   [(name, i + d -
+00047bb0: 2031 2c20 642c 2030 292c 2028 6e61 6d65   1, d, 0), (name
+00047bc0: 2c20 6920 2b20 3220 2a20 6420 2d20 312c  , i + 2 * d - 1,
+00047bd0: 2032 202a 2064 2c20 3129 5d2c 0a20 2020   2 * d, 1)],.   
+00047be0: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
+00047bf0: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+00047c00: 2029 0a0a 2020 2020 666f 7220 6920 696e   )..    for i in
+00047c10: 2072 616e 6765 286e 293a 0a20 2020 2020   range(n):.     
+00047c20: 2020 2064 736b 5b28 6e61 6d65 2c20 6929     dsk[(name, i)
+00047c30: 5d20 3d20 2861 7070 6c79 2c20 662c 205b  ] = (apply, f, [
+00047c40: 286e 616d 652c 206e 202d 2031 202d 2069  (name, n - 1 - i
+00047c50: 2c20 312c 2031 292c 2069 6465 6e74 6974  , 1, 1), identit
+00047c60: 795d 2c20 6b77 6172 6773 290a 0a20 2020  y], kwargs)..   
+00047c70: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+00047c80: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+00047c90: 6c65 6374 696f 6e73 286e 616d 652c 2064  lections(name, d
+00047ca0: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
+00047cb0: 3d5b 6464 665d 290a 2020 2020 7265 7475  =[ddf]).    retu
+00047cc0: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
+00047cd0: 2867 7261 7068 2c20 6e61 6d65 2c20 6d65  (graph, name, me
+00047ce0: 7461 2c20 6469 7669 7369 6f6e 7329 0a0a  ta, divisions)..
+00047cf0: 0a64 6566 206d 6170 7365 7269 6573 2862  .def mapseries(b
+00047d00: 6173 655f 6368 756e 6b2c 2063 6f6e 6361  ase_chunk, conca
+00047d10: 745f 6d61 7029 3a0a 2020 2020 7265 7475  t_map):.    retu
+00047d20: 726e 2062 6173 655f 6368 756e 6b2e 6d61  rn base_chunk.ma
+00047d30: 7028 636f 6e63 6174 5f6d 6170 290a 0a0a  p(concat_map)...
+00047d40: 6465 6620 6d61 7073 6572 6965 735f 636f  def mapseries_co
+00047d50: 6d62 696e 6528 696e 6465 782c 2063 6f6e  mbine(index, con
+00047d60: 6361 745f 7265 7375 6c74 293a 0a20 2020  cat_result):.   
+00047d70: 2066 696e 616c 5f73 6572 6965 7320 3d20   final_series = 
+00047d80: 636f 6e63 6174 5f72 6573 756c 742e 736f  concat_result.so
+00047d90: 7274 5f69 6e64 6578 2829 0a20 2020 2066  rt_index().    f
+00047da0: 696e 616c 5f73 6572 6965 7320 3d20 696e  inal_series = in
+00047db0: 6465 782e 746f 5f73 6572 6965 7328 292e  dex.to_series().
+00047dc0: 6d61 7028 6669 6e61 6c5f 7365 7269 6573  map(final_series
+00047dd0: 290a 2020 2020 7265 7475 726e 2066 696e  ).    return fin
+00047de0: 616c 5f73 6572 6965 730a 0a0a 6465 6620  al_series...def 
+00047df0: 7365 7269 6573 5f6d 6170 2862 6173 655f  series_map(base_
+00047e00: 7365 7269 6573 2c20 6d61 705f 7365 7269  series, map_seri
+00047e10: 6573 293a 0a20 2020 206e 7061 7274 6974  es):.    npartit
+00047e20: 696f 6e73 203d 2062 6173 655f 7365 7269  ions = base_seri
+00047e30: 6573 2e6e 7061 7274 6974 696f 6e73 0a20  es.npartitions. 
+00047e40: 2020 2073 706c 6974 5f6f 7574 203d 206d     split_out = m
+00047e50: 6170 5f73 6572 6965 732e 6e70 6172 7469  ap_series.nparti
+00047e60: 7469 6f6e 730a 0a20 2020 2064 736b 203d  tions..    dsk =
+00047e70: 207b 7d0a 0a20 2020 2062 6173 655f 746f   {}..    base_to
+00047e80: 6b65 6e5f 6b65 7920 3d20 746f 6b65 6e69  ken_key = tokeni
+00047e90: 7a65 2862 6173 655f 7365 7269 6573 2c20  ze(base_series, 
+00047ea0: 7370 6c69 745f 6f75 7429 0a20 2020 2062  split_out).    b
+00047eb0: 6173 655f 7370 6c69 745f 7072 6566 6978  ase_split_prefix
+00047ec0: 203d 2066 2262 6173 652d 7370 6c69 742d   = f"base-split-
+00047ed0: 7b62 6173 655f 746f 6b65 6e5f 6b65 797d  {base_token_key}
+00047ee0: 220a 2020 2020 6261 7365 5f73 6861 7264  ".    base_shard
+00047ef0: 5f70 7265 6669 7820 3d20 6622 6261 7365  _prefix = f"base
+00047f00: 2d73 6861 7264 2d7b 6261 7365 5f74 6f6b  -shard-{base_tok
+00047f10: 656e 5f6b 6579 7d22 0a20 2020 2066 6f72  en_key}".    for
+00047f20: 2069 2c20 6b65 7920 696e 2065 6e75 6d65   i, key in enume
+00047f30: 7261 7465 2862 6173 655f 7365 7269 6573  rate(base_series
+00047f40: 2e5f 5f64 6173 6b5f 6b65 7973 5f5f 2829  .__dask_keys__()
+00047f50: 293a 0a20 2020 2020 2020 2064 736b 5b28  ):.        dsk[(
+00047f60: 6261 7365 5f73 706c 6974 5f70 7265 6669  base_split_prefi
+00047f70: 782c 2069 295d 203d 2028 6861 7368 5f73  x, i)] = (hash_s
+00047f80: 6861 7264 2c20 6b65 792c 2073 706c 6974  hard, key, split
+00047f90: 5f6f 7574 290a 2020 2020 2020 2020 666f  _out).        fo
+00047fa0: 7220 6a20 696e 2072 616e 6765 2873 706c  r j in range(spl
+00047fb0: 6974 5f6f 7574 293a 0a20 2020 2020 2020  it_out):.       
+00047fc0: 2020 2020 2064 736b 5b28 6261 7365 5f73       dsk[(base_s
+00047fd0: 6861 7264 5f70 7265 6669 782c 2030 2c20  hard_prefix, 0, 
+00047fe0: 692c 206a 295d 203d 2028 6765 7469 7465  i, j)] = (getite
+00047ff0: 6d2c 2028 6261 7365 5f73 706c 6974 5f70  m, (base_split_p
+00048000: 7265 6669 782c 2069 292c 206a 290a 0a20  refix, i), j).. 
+00048010: 2020 206d 6170 5f74 6f6b 656e 5f6b 6579     map_token_key
+00048020: 203d 2074 6f6b 656e 697a 6528 6d61 705f   = tokenize(map_
+00048030: 7365 7269 6573 290a 2020 2020 6d61 705f  series).    map_
+00048040: 7370 6c69 745f 7072 6566 6978 203d 2066  split_prefix = f
+00048050: 226d 6170 2d73 706c 6974 2d7b 6d61 705f  "map-split-{map_
+00048060: 746f 6b65 6e5f 6b65 797d 220a 2020 2020  token_key}".    
+00048070: 6d61 705f 7368 6172 645f 7072 6566 6978  map_shard_prefix
+00048080: 203d 2066 226d 6170 2d73 6861 7264 2d7b   = f"map-shard-{
+00048090: 6d61 705f 746f 6b65 6e5f 6b65 797d 220a  map_token_key}".
+000480a0: 2020 2020 666f 7220 692c 206b 6579 2069      for i, key i
+000480b0: 6e20 656e 756d 6572 6174 6528 6d61 705f  n enumerate(map_
+000480c0: 7365 7269 6573 2e5f 5f64 6173 6b5f 6b65  series.__dask_ke
+000480d0: 7973 5f5f 2829 293a 0a20 2020 2020 2020  ys__()):.       
+000480e0: 2064 736b 5b28 6d61 705f 7370 6c69 745f   dsk[(map_split_
+000480f0: 7072 6566 6978 2c20 6929 5d20 3d20 280a  prefix, i)] = (.
+00048100: 2020 2020 2020 2020 2020 2020 6861 7368              hash
+00048110: 5f73 6861 7264 2c0a 2020 2020 2020 2020  _shard,.        
+00048120: 2020 2020 6b65 792c 0a20 2020 2020 2020      key,.       
+00048130: 2020 2020 2073 706c 6974 5f6f 7574 2c0a       split_out,.
+00048140: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+00048150: 745f 6f75 745f 6f6e 5f69 6e64 6578 2c0a  t_out_on_index,.
+00048160: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
+00048170: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00048180: 2020 2020 666f 7220 6a20 696e 2072 616e      for j in ran
+00048190: 6765 2873 706c 6974 5f6f 7574 293a 0a20  ge(split_out):. 
+000481a0: 2020 2020 2020 2020 2020 2064 736b 5b28             dsk[(
+000481b0: 6d61 705f 7368 6172 645f 7072 6566 6978  map_shard_prefix
+000481c0: 2c20 302c 2069 2c20 6a29 5d20 3d20 2867  , 0, i, j)] = (g
+000481d0: 6574 6974 656d 2c20 286d 6170 5f73 706c  etitem, (map_spl
+000481e0: 6974 5f70 7265 6669 782c 2069 292c 206a  it_prefix, i), j
+000481f0: 290a 0a20 2020 2074 6f6b 656e 5f6b 6579  )..    token_key
+00048200: 203d 2074 6f6b 656e 697a 6528 6261 7365   = tokenize(base
+00048210: 5f73 6572 6965 732c 206d 6170 5f73 6572  _series, map_ser
+00048220: 6965 7329 0a20 2020 206d 6170 5f70 7265  ies).    map_pre
+00048230: 6669 7820 3d20 6622 6d61 702d 7365 7269  fix = f"map-seri
+00048240: 6573 2d7b 746f 6b65 6e5f 6b65 797d 220a  es-{token_key}".
+00048250: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00048260: 6765 286e 7061 7274 6974 696f 6e73 293a  ge(npartitions):
+00048270: 0a20 2020 2020 2020 2066 6f72 206a 2069  .        for j i
+00048280: 6e20 7261 6e67 6528 7370 6c69 745f 6f75  n range(split_ou
+00048290: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+000482a0: 6473 6b5b 286d 6170 5f70 7265 6669 782c  dsk[(map_prefix,
+000482b0: 2069 2c20 6a29 5d20 3d20 280a 2020 2020   i, j)] = (.    
+000482c0: 2020 2020 2020 2020 2020 2020 6d61 7073              maps
+000482d0: 6572 6965 732c 0a20 2020 2020 2020 2020  eries,.         
+000482e0: 2020 2020 2020 2028 6261 7365 5f73 6861         (base_sha
+000482f0: 7264 5f70 7265 6669 782c 2030 2c20 692c  rd_prefix, 0, i,
+00048300: 206a 292c 0a20 2020 2020 2020 2020 2020   j),.           
+00048310: 2020 2020 2028 5f63 6f6e 6361 742c 205b       (_concat, [
+00048320: 286d 6170 5f73 6861 7264 5f70 7265 6669  (map_shard_prefi
+00048330: 782c 2030 2c20 6b2c 206a 2920 666f 7220  x, 0, k, j) for 
+00048340: 6b20 696e 2072 616e 6765 2873 706c 6974  k in range(split
+00048350: 5f6f 7574 295d 292c 0a20 2020 2020 2020  _out)]),.       
+00048360: 2020 2020 2029 0a0a 2020 2020 6669 6e61       )..    fina
+00048370: 6c5f 7072 6566 6978 203d 2066 226d 6170  l_prefix = f"map
+00048380: 2d73 6572 6965 732d 636f 6d62 696e 652d  -series-combine-
+00048390: 7b74 6f6b 656e 5f6b 6579 7d22 0a20 2020  {token_key}".   
+000483a0: 2066 6f72 2069 2c20 6b65 7920 696e 2065   for i, key in e
+000483b0: 6e75 6d65 7261 7465 2862 6173 655f 7365  numerate(base_se
+000483c0: 7269 6573 2e69 6e64 6578 2e5f 5f64 6173  ries.index.__das
+000483d0: 6b5f 6b65 7973 5f5f 2829 293a 0a20 2020  k_keys__()):.   
+000483e0: 2020 2020 2064 736b 5b28 6669 6e61 6c5f       dsk[(final_
+000483f0: 7072 6566 6978 2c20 6929 5d20 3d20 280a  prefix, i)] = (.
+00048400: 2020 2020 2020 2020 2020 2020 6d61 7073              maps
+00048410: 6572 6965 735f 636f 6d62 696e 652c 0a20  eries_combine,. 
+00048420: 2020 2020 2020 2020 2020 206b 6579 2c0a             key,.
+00048430: 2020 2020 2020 2020 2020 2020 285f 636f              (_co
+00048440: 6e63 6174 2c20 5b28 6d61 705f 7072 6566  ncat, [(map_pref
+00048450: 6978 2c20 692c 206a 2920 666f 7220 6a20  ix, i, j) for j 
+00048460: 696e 2072 616e 6765 2873 706c 6974 5f6f  in range(split_o
+00048470: 7574 295d 292c 0a20 2020 2020 2020 2029  ut)]),.        )
+00048480: 0a0a 2020 2020 6d65 7461 203d 206d 6170  ..    meta = map
+00048490: 5f73 6572 6965 732e 5f6d 6574 612e 636f  _series._meta.co
+000484a0: 7079 2829 0a20 2020 206d 6574 612e 696e  py().    meta.in
+000484b0: 6465 7820 3d20 6261 7365 5f73 6572 6965  dex = base_serie
+000484c0: 732e 5f6d 6574 612e 696e 6465 780a 2020  s._meta.index.  
+000484d0: 2020 6d65 7461 203d 206d 616b 655f 6d65    meta = make_me
+000484e0: 7461 286d 6574 6129 0a0a 2020 2020 6465  ta(meta)..    de
+000484f0: 7065 6e64 656e 6369 6573 203d 205b 6261  pendencies = [ba
+00048500: 7365 5f73 6572 6965 732c 206d 6170 5f73  se_series, map_s
+00048510: 6572 6965 732c 2062 6173 655f 7365 7269  eries, base_seri
+00048520: 6573 2e69 6e64 6578 5d0a 2020 2020 6772  es.index].    gr
+00048530: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+00048540: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+00048550: 7469 6f6e 7328 0a20 2020 2020 2020 2066  tions(.        f
+00048560: 696e 616c 5f70 7265 6669 782c 2064 736b  inal_prefix, dsk
+00048570: 2c20 6465 7065 6e64 656e 6369 6573 3d64  , dependencies=d
+00048580: 6570 656e 6465 6e63 6965 730a 2020 2020  ependencies.    
+00048590: 290a 2020 2020 6469 7669 7369 6f6e 7320  ).    divisions 
+000485a0: 3d20 6c69 7374 2862 6173 655f 7365 7269  = list(base_seri
+000485b0: 6573 2e64 6976 6973 696f 6e73 290a 0a20  es.divisions).. 
+000485c0: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
+000485d0: 5f6f 626a 6563 7428 6772 6170 682c 2066  _object(graph, f
+000485e0: 696e 616c 5f70 7265 6669 782c 206d 6574  inal_prefix, met
+000485f0: 612c 2064 6976 6973 696f 6e73 290a 0a0a  a, divisions)...
+00048600: 6465 6620 5f63 6f6e 7665 7274 5f74 6f5f  def _convert_to_
+00048610: 6e75 6d65 7269 6328 7365 7269 6573 2c20  numeric(series, 
+00048620: 736b 6970 6e61 293a 0a20 2020 2069 6620  skipna):.    if 
+00048630: 736b 6970 6e61 3a0a 2020 2020 2020 2020  skipna:.        
+00048640: 7265 7475 726e 2073 6572 6965 732e 6472  return series.dr
+00048650: 6f70 6e61 2829 2e76 6965 7728 2269 3822  opna().view("i8"
+00048660: 290a 0a20 2020 2023 2073 6572 6965 732e  )..    # series.
+00048670: 7669 6577 2822 6938 2229 2077 6974 6820  view("i8") with 
+00048680: 7064 2e4e 6154 2070 726f 6475 6365 7320  pd.NaT produces 
+00048690: 2d39 3232 3333 3732 3033 3638 3534 3737  -922337203685477
+000486a0: 3538 3038 2069 7320 7768 7920 7765 206e  5808 is why we n
+000486b0: 6565 6420 746f 2064 6f20 7468 6973 0a20  eed to do this. 
+000486c0: 2020 2072 6574 7572 6e20 7365 7269 6573     return series
+000486d0: 2e76 6965 7728 2269 3822 292e 6d61 736b  .view("i8").mask
+000486e0: 2873 6572 6965 732e 6973 6e75 6c6c 2829  (series.isnull()
+000486f0: 2c20 6e70 2e6e 616e 290a 0a0a 6465 6620  , np.nan)...def 
+00048700: 5f73 7172 745f 616e 645f 636f 6e76 6572  _sqrt_and_conver
+00048710: 745f 746f 5f74 696d 6564 656c 7461 2870  t_to_timedelta(p
+00048720: 6172 7469 7469 6f6e 2c20 6178 6973 2c20  artition, axis, 
+00048730: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00048740: 3a0a 2020 2020 6966 2061 7869 7320 3d3d  :.    if axis ==
+00048750: 2031 3a0a 2020 2020 2020 2020 7769 7468   1:.        with
+00048760: 2077 6172 6e69 6e67 732e 6361 7463 685f   warnings.catch_
+00048770: 7761 726e 696e 6773 2829 3a0a 2020 2020  warnings():.    
+00048780: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00048790: 2e66 696c 7465 7277 6172 6e69 6e67 7328  .filterwarnings(
+000487a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000487b0: 2022 6967 6e6f 7265 222c 0a20 2020 2020   "ignore",.     
+000487c0: 2020 2020 2020 2020 2020 2063 6174 6567             categ
+000487d0: 6f72 793d 5275 6e74 696d 6557 6172 6e69  ory=RuntimeWarni
+000487e0: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
+000487f0: 2020 2020 6d65 7373 6167 653d 2269 6e76      message="inv
+00048800: 616c 6964 2076 616c 7565 2065 6e63 6f75  alid value encou
+00048810: 6e74 6572 6564 2069 6e20 6361 7374 222c  ntered in cast",
+00048820: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00048830: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00048840: 6e20 7064 2e74 6f5f 7469 6d65 6465 6c74  n pd.to_timedelt
+00048850: 6128 4d2e 7374 6428 7061 7274 6974 696f  a(M.std(partitio
+00048860: 6e2c 2061 7869 733d 6178 6973 2c20 2a61  n, axis=axis, *a
+00048870: 7267 732c 202a 2a6b 7761 7267 7329 290a  rgs, **kwargs)).
+00048880: 0a20 2020 2069 735f 6466 5f6c 696b 652c  .    is_df_like,
+00048890: 2074 696d 655f 636f 6c73 203d 206b 7761   time_cols = kwa
+000488a0: 7267 735b 2269 735f 6466 5f6c 696b 6522  rgs["is_df_like"
+000488b0: 5d2c 206b 7761 7267 735b 2274 696d 655f  ], kwargs["time_
+000488c0: 636f 6c73 225d 0a0a 2020 2020 7371 7274  cols"]..    sqrt
+000488d0: 203d 206e 702e 7371 7274 2870 6172 7469   = np.sqrt(parti
+000488e0: 7469 6f6e 290a 0a20 2020 2069 6620 6e6f  tion)..    if no
+000488f0: 7420 6973 5f64 665f 6c69 6b65 3a0a 2020  t is_df_like:.  
+00048900: 2020 2020 2020 7265 7475 726e 2070 642e        return pd.
+00048910: 746f 5f74 696d 6564 656c 7461 2873 7172  to_timedelta(sqr
+00048920: 7429 0a0a 2020 2020 7469 6d65 5f63 6f6c  t)..    time_col
+00048930: 5f6d 6173 6b20 3d20 7371 7274 2e69 6e64  _mask = sqrt.ind
+00048940: 6578 2e69 7369 6e28 7469 6d65 5f63 6f6c  ex.isin(time_col
+00048950: 7329 0a20 2020 206d 6174 6368 696e 675f  s).    matching_
+00048960: 7661 6c73 203d 2073 7172 745b 7469 6d65  vals = sqrt[time
+00048970: 5f63 6f6c 5f6d 6173 6b5d 0a20 2020 2066  _col_mask].    f
+00048980: 6f72 2074 696d 655f 636f 6c2c 206d 6174  or time_col, mat
+00048990: 6368 696e 675f 7661 6c20 696e 207a 6970  ching_val in zip
+000489a0: 2874 696d 655f 636f 6c73 2c20 6d61 7463  (time_cols, matc
+000489b0: 6869 6e67 5f76 616c 7329 3a0a 2020 2020  hing_vals):.    
+000489c0: 2020 2020 7371 7274 5b74 696d 655f 636f      sqrt[time_co
+000489d0: 6c5d 203d 2070 642e 746f 5f74 696d 6564  l] = pd.to_timed
+000489e0: 656c 7461 286d 6174 6368 696e 675f 7661  elta(matching_va
+000489f0: 6c29 0a0a 2020 2020 7265 7475 726e 2073  l)..    return s
+00048a00: 7172 740a 0a0a 6465 6620 5f72 6169 7365  qrt...def _raise
+00048a10: 5f69 665f 6e6f 745f 7365 7269 6573 5f6f  _if_not_series_o
+00048a20: 725f 6461 7461 6672 616d 6528 782c 2066  r_dataframe(x, f
+00048a30: 756e 636e 616d 6529 3a0a 2020 2020 2222  uncname):.    ""
+00048a40: 220a 2020 2020 5574 696c 6974 7920 6675  ".    Utility fu
+00048a50: 6e63 7469 6f6e 2074 6f20 7261 6973 6520  nction to raise 
+00048a60: 616e 2065 7272 6f72 2069 6620 616e 206f  an error if an o
+00048a70: 626a 6563 7420 6973 206e 6f74 2061 2053  bject is not a S
+00048a80: 6572 6965 7320 6f72 2044 6174 6146 7261  eries or DataFra
+00048a90: 6d65 0a20 2020 2022 2222 0a20 2020 2069  me.    """.    i
+00048aa0: 6620 6e6f 7420 6973 5f73 6572 6965 735f  f not is_series_
+00048ab0: 6c69 6b65 2878 2920 616e 6420 6e6f 7420  like(x) and not 
+00048ac0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+00048ad0: 6528 7829 3a0a 2020 2020 2020 2020 7261  e(x):.        ra
+00048ae0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+00048af0: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
+00048b00: 2020 2020 2022 6025 7360 2069 7320 6f6e       "`%s` is on
+00048b10: 6c79 2073 7570 706f 7274 6564 2077 6974  ly supported wit
+00048b20: 6820 6f62 6a65 6374 7320 7468 6174 2061  h objects that a
+00048b30: 7265 2044 6174 6166 7261 6d65 7320 6f72  re Dataframes or
+00048b40: 2053 6572 6965 7322 0a20 2020 2020 2020   Series".       
+00048b50: 2020 2020 2025 2066 756e 636e 616d 650a       % funcname.
+00048b60: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
+00048b70: 5f67 6574 6174 7472 5f6e 756d 6572 6963  _getattr_numeric
+00048b80: 5f6f 6e6c 7928 2a61 7267 732c 205f 6461  _only(*args, _da
+00048b90: 736b 5f6d 6574 686f 645f 6e61 6d65 2c20  sk_method_name, 
+00048ba0: 2a2a 6b77 6172 6773 293a 0a20 2020 2077  **kwargs):.    w
+00048bb0: 6974 6820 6368 6563 6b5f 6e75 6d65 7269  ith check_numeri
+00048bc0: 635f 6f6e 6c79 5f64 6570 7265 6361 7469  c_only_deprecati
+00048bd0: 6f6e 2829 3a0a 2020 2020 2020 2020 7265  on():.        re
+00048be0: 7475 726e 2067 6574 6174 7472 284d 2c20  turn getattr(M, 
+00048bf0: 5f64 6173 6b5f 6d65 7468 6f64 5f6e 616d  _dask_method_nam
+00048c00: 6529 282a 6172 6773 2c20 2a2a 6b77 6172  e)(*args, **kwar
+00048c10: 6773 290a                                gs).
```

### Comparing `dask-2023.4.0/dask/dataframe/dispatch.py` & `dask-2023.4.1/dask/dataframe/dispatch.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/extensions.py` & `dask-2023.4.1/dask/dataframe/extensions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/groupby.py` & `dask-2023.4.1/dask/dataframe/groupby.py`

 * *Files 0% similar despite different names*

```diff
@@ -302,15 +302,15 @@
 
     @wraps(func)
     def wrapper(self, *args, **kwargs):
         if isinstance(self, DataFrameGroupBy):
             numeric_only = kwargs.get("numeric_only", no_default)
             # Prior to `pandas=1.5`, `numeric_only` support wasn't uniformly supported
             # in pandas. We don't support `numeric_only=False` in this case.
-            if not PANDAS_GT_150 and numeric_only is not no_default:
+            if not PANDAS_GT_150 and numeric_only is False:
                 raise NotImplementedError(
                     "'numeric_only=False' is not implemented in Dask."
                 )
             if PANDAS_GT_150 and not PANDAS_GT_200 and not self._all_numeric():
                 if numeric_only is no_default:
                     warnings.warn(
                         "The default value of numeric_only will be changed to False in "
@@ -340,15 +340,19 @@
                 and len(args) > 0
                 and args[0] not in NUMERIC_ONLY_NOT_IMPLEMENTED
             )
             if maybe_raise:
                 numeric_only = kwargs.get("numeric_only", no_default)
                 # Prior to `pandas=1.5`, `numeric_only` support wasn't uniformly supported
                 # in pandas. We don't support `numeric_only=False` in this case.
-                if not PANDAS_GT_150 and numeric_only is not no_default:
+                if not PANDAS_GT_150 and (
+                    numeric_only is False
+                    or numeric_only is not no_default
+                    and func.__name__ in ["corr", "cov", "cumprod", "cumsum"]
+                ):
                     raise NotImplementedError(
                         "'numeric_only=False' is not implemented in Dask."
                     )
                 if not self._all_numeric():
                     if numeric_only is False or (
                         PANDAS_GT_200 and numeric_only is no_default
                     ):
@@ -531,42 +535,48 @@
         return func(g, **kwargs)
     else:
         if isinstance(columns, (tuple, list, set, pd.Index)):
             columns = list(columns)
         return func(g[columns], **kwargs)
 
 
-def _var_chunk(df, *by):
+def _var_chunk(df, *by, numeric_only=no_default):
+    numeric_only_kwargs = (
+        {} if numeric_only is no_default else {"numeric_only": numeric_only}
+    )
     if is_series_like(df):
         df = df.to_frame()
 
     df = df.copy()
 
     g = _groupby_raise_unaligned(df, by=by)
     with check_numeric_only_deprecation():
-        x = g.sum()
+        x = g.sum(**numeric_only_kwargs)
 
     n = g[x.columns].count().rename(columns=lambda c: (c, "-count"))
 
     cols = x.columns
     df[cols] = df[cols] ** 2
 
     g2 = _groupby_raise_unaligned(df, by=by)
     with check_numeric_only_deprecation():
-        x2 = g2.sum().rename(columns=lambda c: (c, "-x2"))
+        x2 = g2.sum(**numeric_only_kwargs).rename(columns=lambda c: (c, "-x2"))
 
     return concat([x, x2, n], axis=1)
 
 
 def _var_combine(g, levels, sort=False):
     return g.groupby(level=levels, sort=sort).sum()
 
 
-def _var_agg(g, levels, ddof, sort=False):
-    g = g.groupby(level=levels, sort=sort).sum()
+def _var_agg(g, levels, ddof, sort=False, numeric_only=no_default):
+    numeric_only_kwargs = (
+        {} if numeric_only is no_default else {"numeric_only": numeric_only}
+    )
+    g = g.groupby(level=levels, sort=sort).sum(**numeric_only_kwargs)
     nc = len(g.columns)
     x = g[g.columns[: nc // 3]]
     # chunks columns are tuples (value, name), so we just keep the value part
     x2 = g[g.columns[nc // 3 : 2 * nc // 3]].rename(columns=lambda c: c[0])
     n = g[g.columns[-nc // 3 :]].rename(columns=lambda c: c[0])
 
     # TODO: replace with _finalize_var?
@@ -1960,15 +1970,20 @@
     @derived_from(pd.core.groupby.GroupBy)
     @numeric_only_not_implemented
     def mean(
         self, split_every=None, split_out=1, shuffle=None, numeric_only=no_default
     ):
         # We sometimes emit this warning ourselves. We ignore it here so users only see it once.
         with check_numeric_only_deprecation():
-            s = self.sum(split_every=split_every, split_out=split_out, shuffle=shuffle)
+            s = self.sum(
+                split_every=split_every,
+                split_out=split_out,
+                shuffle=shuffle,
+                numeric_only=numeric_only,
+            )
         c = self.count(split_every=split_every, split_out=split_out, shuffle=shuffle)
         if is_dataframe_like(s):
             c = c[s.columns]
         return s / c
 
     @derived_from(pd.core.groupby.GroupBy)
     @numeric_only_not_implemented
@@ -1982,17 +1997,20 @@
             )
 
         # FIXME: This is using a different default but it is not fully
         # understood why this is a better choice. For more context, see
         # https://github.com/dask/dask/pull/9826/files#r1072395307
         # https://github.com/dask/distributed/issues/5502
         shuffle = shuffle or config.get("dataframe.shuffle.method", None) or "tasks"
+        numeric_only_kwargs = (
+            {"numeric_only": numeric_only} if numeric_only is not no_default else {}
+        )
 
         with check_numeric_only_deprecation():
-            meta = self._meta_nonempty.median()
+            meta = self._meta_nonempty.median(**numeric_only_kwargs)
         columns = meta.name if is_series_like(meta) else meta.columns
         by = self.by if isinstance(self.by, list) else [self.by]
         return _shuffle_aggregate(
             [self.obj] + by,
             token="non-agg",
             chunk=_non_agg_chunk,
             chunk_kwargs={
@@ -2023,27 +2041,35 @@
             split_out=split_out,
             shuffle=shuffle,
         )
 
     @derived_from(pd.core.groupby.GroupBy)
     @numeric_only_not_implemented
     def var(self, ddof=1, split_every=None, split_out=1, numeric_only=no_default):
+        if not PANDAS_GT_150 and numeric_only is not no_default:
+            raise TypeError("numeric_only not supported for pandas < 1.5")
+
         if self.sort is None and split_out > 1:
             warnings.warn(SORT_SPLIT_OUT_WARNING, FutureWarning)
 
         levels = _determine_levels(self.by)
         result = aca(
             [self.obj, self.by]
             if not isinstance(self.by, list)
             else [self.obj] + self.by,
             chunk=_var_chunk,
             aggregate=_var_agg,
             combine=_var_combine,
             token=self._token_prefix + "var",
-            aggregate_kwargs={"ddof": ddof, "levels": levels},
+            aggregate_kwargs={
+                "ddof": ddof,
+                "levels": levels,
+                "numeric_only": numeric_only,
+            },
+            chunk_kwargs={"numeric_only": numeric_only},
             combine_kwargs={"levels": levels},
             split_every=split_every,
             split_out=split_out,
             split_out_setup=split_out_on_index,
             sort=self.sort,
         )
 
@@ -2053,27 +2079,39 @@
             result = result[self._slice]
 
         return result
 
     @derived_from(pd.core.groupby.GroupBy)
     @numeric_only_not_implemented
     def std(self, ddof=1, split_every=None, split_out=1, numeric_only=no_default):
+        if not PANDAS_GT_150 and numeric_only is not no_default:
+            raise TypeError("numeric_only not supported for pandas < 1.5")
         # We sometimes emit this warning ourselves. We ignore it here so users only see it once.
         with check_numeric_only_deprecation():
-            v = self.var(ddof, split_every=split_every, split_out=split_out)
+            v = self.var(
+                ddof,
+                split_every=split_every,
+                split_out=split_out,
+                numeric_only=numeric_only,
+            )
         result = map_partitions(np.sqrt, v, meta=v)
         return result
 
     @derived_from(pd.DataFrame)
     @numeric_only_not_implemented
     def corr(self, ddof=1, split_every=None, split_out=1, numeric_only=no_default):
         """Groupby correlation:
         corr(X, Y) = cov(X, Y) / (std_x * std_y)
         """
-        return self.cov(split_every=split_every, split_out=split_out, std=True)
+        return self.cov(
+            split_every=split_every,
+            split_out=split_out,
+            std=True,
+            numeric_only=numeric_only,
+        )
 
     @derived_from(pd.DataFrame)
     @numeric_only_not_implemented
     def cov(
         self, ddof=1, split_every=None, split_out=1, std=False, numeric_only=no_default
     ):
         """Groupby covariance is accomplished by
```

### Comparing `dask-2023.4.0/dask/dataframe/hyperloglog.py` & `dask-2023.4.1/dask/dataframe/hyperloglog.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/indexing.py` & `dask-2023.4.1/dask/dataframe/indexing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/__init__.py` & `dask-2023.4.1/dask/dataframe/io/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/csv.py` & `dask-2023.4.1/dask/dataframe/io/csv.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/demo.py` & `dask-2023.4.1/dask/dataframe/io/demo.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/hdf.py` & `dask-2023.4.1/dask/dataframe/io/hdf.py`

 * *Files 1% similar despite different names*

```diff
@@ -432,18 +432,18 @@
             "When assuming pre-partitioned data, data must be "
             "read in its entirety using the same chunksizes"
         )
 
     # Build metadata
     with pd.HDFStore(paths[0], mode=mode) as hdf:
         meta_key = _expand_key(key, hdf)[0]
-    try:
-        meta = pd.read_hdf(paths[0], meta_key, mode=mode, stop=0)
-    except IndexError:  # if file is empty, don't set stop
-        meta = pd.read_hdf(paths[0], meta_key, mode=mode)
+        try:
+            meta = pd.read_hdf(hdf, meta_key, stop=0)
+        except IndexError:  # if file is empty, don't set stop
+            meta = pd.read_hdf(hdf, meta_key)
     if columns is not None:
         meta = meta[columns]
 
     # Common kwargs
     if meta.ndim == 1:
         common_kwargs = {"name": meta.name, "mode": mode}
     else:
```

### Comparing `dask-2023.4.0/dask/dataframe/io/io.py` & `dask-2023.4.1/dask/dataframe/io/io.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/json.py` & `dask-2023.4.1/dask/dataframe/io/json.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/orc/arrow.py` & `dask-2023.4.1/dask/dataframe/io/orc/arrow.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/orc/core.py` & `dask-2023.4.1/dask/dataframe/io/orc/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/parquet/arrow.py` & `dask-2023.4.1/dask/dataframe/io/parquet/arrow.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/parquet/core.py` & `dask-2023.4.1/dask/dataframe/io/parquet/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/parquet/fastparquet.py` & `dask-2023.4.1/dask/dataframe/io/parquet/fastparquet.py`

 * *Files 1% similar despite different names*

```diff
@@ -7,14 +7,15 @@
 
 import numpy as np
 import pandas as pd
 import tlz as toolz
 from packaging.version import parse as parse_version
 
 from dask.core import flatten
+from dask.dataframe._compat import PANDAS_GT_201
 
 try:
     import fastparquet
     from fastparquet import ParquetFile
     from fastparquet.util import ex_from_sep, get_file_scheme, groupby_types, val_to_num
     from fastparquet.writer import make_part_file, partition_on_columns
 except ImportError:
@@ -1112,14 +1113,20 @@
         if index:
             columns += [i for i in index if i not in columns]
 
         # Extract row-groups and pre-allocate df
         rgs = pf.row_groups
         size = sum(rg.num_rows for rg in rgs)
         df, views = pf.pre_allocate(size, columns, categories, index)
+        if (
+            parse_version(fastparquet.__version__) <= parse_version("2023.02.0")
+            and PANDAS_GT_201
+            and df.columns.empty
+        ):
+            df.columns = pd.Index([], dtype=object)
         start = 0
 
         # Get a map of file names -> row-groups
         fn_rg_map = defaultdict(list)
         for rg in rgs:
             fn = pf.row_group_filename(rg)
             fn_rg_map[fn].append(rg)
```

### Comparing `dask-2023.4.0/dask/dataframe/io/parquet/utils.py` & `dask-2023.4.1/dask/dataframe/io/parquet/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/sql.py` & `dask-2023.4.1/dask/dataframe/io/sql.py`

 * *Files 1% similar despite different names*

```diff
@@ -137,25 +137,25 @@
         if meta is None:
             meta = head.iloc[:0]
 
     if divisions is None:
         if limits is None:
             # calculate max and min for given index
             q = sa.sql.select(
-                [sa.sql.func.max(index), sa.sql.func.min(index)]
+                sa.sql.func.max(index), sa.sql.func.min(index)
             ).select_from(sql.subquery())
             minmax = pd.read_sql(q, engine)
             maxi, mini = minmax.iloc[0]
             dtype = minmax.dtypes["max_1"]
         else:
             mini, maxi = limits
             dtype = pd.Series(limits).dtype
 
         if npartitions is None:
-            q = sa.sql.select([sa.sql.func.count(index)]).select_from(sql.subquery())
+            q = sa.sql.select(sa.sql.func.count(index)).select_from(sql.subquery())
             count = pd.read_sql(q, engine)["count_1"][0]
             npartitions = (
                 int(round(count * bytes_per_row / parse_bytes(bytes_per_chunk))) or 1
             )
         if dtype.kind == "M":
             divisions = methods.tolist(
                 pd.date_range(
@@ -305,17 +305,15 @@
             + "Note: Dask does not support SQLAlchemy connectables here"
         )
 
     engine_kwargs = {} if engine_kwargs is None else engine_kwargs
     engine = sa.create_engine(con, **engine_kwargs)
     m = sa.MetaData()
     if isinstance(table_name, str):
-        table_name = sa.Table(
-            table_name, m, autoload=True, autoload_with=engine, schema=schema
-        )
+        table_name = sa.Table(table_name, m, autoload_with=engine, schema=schema)
     else:
         raise TypeError(
             "`table_name` must be of type str, not " + str(type(table_name))
         )
     engine.dispose()
 
     columns = (
@@ -335,15 +333,15 @@
         if isinstance(index_col, str)
         else sa.Column(index_col.name, index_col.type)
     )
 
     if index.name not in [c.name for c in columns]:
         columns.append(index)
 
-    query = sql.select(columns).select_from(table_name)
+    query = sql.select(*columns).select_from(table_name)
 
     return read_sql_query(
         sql=query,
         con=con,
         index_col=index,
         divisions=divisions,
         npartitions=npartitions,
```

### Comparing `dask-2023.4.0/dask/dataframe/io/tests/test_csv.py` & `dask-2023.4.1/dask/dataframe/io/tests/test_csv.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/tests/test_demo.py` & `dask-2023.4.1/dask/dataframe/io/tests/test_demo.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/tests/test_hdf.py` & `dask-2023.4.1/dask/dataframe/io/tests/test_hdf.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/tests/test_io.py` & `dask-2023.4.1/dask/dataframe/io/tests/test_io.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/tests/test_json.py` & `dask-2023.4.1/dask/dataframe/io/tests/test_json.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/tests/test_orc.py` & `dask-2023.4.1/dask/dataframe/io/tests/test_orc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/tests/test_parquet.py` & `dask-2023.4.1/dask/dataframe/io/tests/test_parquet.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/io/tests/test_sql.py` & `dask-2023.4.1/dask/dataframe/io/tests/test_sql.py`

 * *Files 1% similar despite different names*

```diff
@@ -382,41 +382,39 @@
     assert_eq(data, df)
 
 
 def test_query(db):
     import sqlalchemy as sa
     from sqlalchemy import sql
 
-    s1 = sql.select([sql.column("number"), sql.column("name")]).select_from(
+    s1 = sql.select(sql.column("number"), sql.column("name")).select_from(
         sql.table("test")
     )
     out = read_sql_query(s1, db, npartitions=2, index_col="number")
     assert_eq(out, df[["name"]])
 
     s2 = (
         sql.select(
-            [
-                sa.cast(sql.column("number"), sa.types.BigInteger).label("number"),
-                sql.column("name"),
-            ]
+            sa.cast(sql.column("number"), sa.types.BigInteger).label("number"),
+            sql.column("name"),
         )
         .where(sql.column("number") >= 5)
         .select_from(sql.table("test"))
     )
 
     out = read_sql_query(s2, db, npartitions=2, index_col="number")
     assert_eq(out, df.loc[5:, ["name"]])
 
 
 def test_query_index_from_query(db):
     from sqlalchemy import sql
 
     number = sql.column("number")
     name = sql.column("name")
-    s1 = sql.select([number, name, sql.func.length(name).label("lenname")]).select_from(
+    s1 = sql.select(number, name, sql.func.length(name).label("lenname")).select_from(
         sql.table("test")
     )
     out = read_sql_query(s1, db, npartitions=2, index_col="lenname")
 
     lenname_df = df.copy()
     lenname_df["lenname"] = lenname_df["name"].str.len()
     lenname_df = lenname_df.reset_index().set_index("lenname")
@@ -430,15 +428,15 @@
         "name": pd.Series([], name="name", dtype="str"),
         "age": pd.Series([], name="age", dtype="int"),
     }
     index = pd.Index([], name="number", dtype="int")
     meta = pd.DataFrame(data, index=index)
 
     s1 = sql.select(
-        [sql.column("number"), sql.column("name"), sql.column("age")]
+        sql.column("number"), sql.column("name"), sql.column("age")
     ).select_from(sql.table("test"))
     out = read_sql_query(s1, db, npartitions=2, index_col="number", meta=meta)
     # Don't check dtype for windows https://github.com/dask/dask/issues/8620
     assert_eq(out, df[["name", "age"]], check_dtype=sys.platform != "win32")
 
 
 def test_no_character_index_without_divisions(db):
@@ -446,15 +444,15 @@
     with pytest.raises(TypeError):
         read_sql_table("test", db, npartitions=2, index_col="name", divisions=None)
 
 
 def test_read_sql(db):
     from sqlalchemy import sql
 
-    s = sql.select([sql.column("number"), sql.column("name")]).select_from(
+    s = sql.select(sql.column("number"), sql.column("name")).select_from(
         sql.table("test")
     )
     out = read_sql(s, db, npartitions=2, index_col="number")
     assert_eq(out, df[["name"]])
 
     data = read_sql_table("test", db, npartitions=2, index_col="number").compute()
     assert (data.name == df.name).all()
```

### Comparing `dask-2023.4.0/dask/dataframe/io/utils.py` & `dask-2023.4.1/dask/dataframe/io/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/methods.py` & `dask-2023.4.1/dask/dataframe/methods.py`

 * *Files 1% similar despite different names*

```diff
@@ -4,14 +4,15 @@
 import numpy as np
 import pandas as pd
 from pandas.api.types import is_extension_array_dtype
 from tlz import partition
 
 from dask.dataframe._compat import (
     PANDAS_GT_131,
+    PANDAS_GT_140,
     PANDAS_GT_200,
     check_apply_dataframe_deprecation,
     check_convert_dtype_deprecation,
     check_observed_deprecation,
 )
 
 #  preserve compatibility while moving dispatch objects
@@ -336,16 +337,17 @@
     else:  # scalar
         return x if x > y else y
 
 
 def assign(df, *pairs):
     # Only deep copy when updating an element
     # (to avoid modifying the original)
+    # Setitem never modifies an array inplace with pandas 1.4 and up
     pairs = dict(partition(2, pairs))
-    deep = bool(set(pairs) & set(df.columns))
+    deep = bool(set(pairs) & set(df.columns)) and not PANDAS_GT_140
     df = df.copy(deep=bool(deep))
     for name, val in pairs.items():
         df[name] = val
     return df
 
 
 def unique(x, series_name=None):
```

### Comparing `dask-2023.4.0/dask/dataframe/multi.py` & `dask-2023.4.1/dask/dataframe/multi.py`

 * *Files 1% similar despite different names*

```diff
@@ -56,15 +56,15 @@
 import math
 import pickle
 import warnings
 from functools import partial, wraps
 
 import numpy as np
 import pandas as pd
-from pandas.api.types import is_categorical_dtype, is_dtype_equal
+from pandas.api.types import is_dtype_equal
 from tlz import merge_sorted, unique
 
 from dask.base import is_dask_collection, tokenize
 from dask.dataframe import methods
 from dask.dataframe.core import (
     DataFrame,
     Index,
@@ -254,21 +254,21 @@
         for col in categorical_columns:
             left = None
             right = None
 
             if col in lhs:
                 left = lhs[col]
             elif col == kwargs.get("right_on", None) and left_index:
-                if is_categorical_dtype(lhs.index):
+                if isinstance(lhs.index.dtype, pd.CategoricalDtype):
                     left = lhs.index
 
             if col in rhs:
                 right = rhs[col]
             elif col == kwargs.get("left_on", None) and right_index:
-                if is_categorical_dtype(rhs.index):
+                if isinstance(rhs.index.dtype, pd.CategoricalDtype):
                     right = rhs.index
 
             dtype = "category"
             if left is not None and right is not None:
                 dtype = methods.union_categoricals(
                     [left.astype("category"), right.astype("category")]
                 ).dtype
@@ -1099,24 +1099,26 @@
         # and https://github.com/dask/dask/issues/5968.
         if is_dataframe_like(df):
             shared_columns = df.columns.intersection(meta.columns)
             needs_astype = [
                 col
                 for col in shared_columns
                 if df[col].dtype != meta[col].dtype
-                and not is_categorical_dtype(df[col].dtype)
+                and not isinstance(df[col].dtype, pd.CategoricalDtype)
             ]
 
             if needs_astype:
                 # Copy to avoid mutating the caller inplace
                 df = df.copy()
                 df[needs_astype] = df[needs_astype].astype(meta[needs_astype].dtypes)
 
         if is_series_like(df) and is_series_like(meta):
-            if not df.dtype == meta.dtype and not is_categorical_dtype(df.dtype):
+            if not df.dtype == meta.dtype and not isinstance(
+                df.dtype, pd.CategoricalDtype
+            ):
                 df = df.astype(meta.dtype)
         else:
             pass  # TODO: there are other non-covered cases here
 
         astyped_dfs.append(df)
 
         # An error will be raised if the schemas or categories don't match. In
```

### Comparing `dask-2023.4.0/dask/dataframe/numeric.py` & `dask-2023.4.1/dask/dataframe/numeric.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/optimize.py` & `dask-2023.4.1/dask/dataframe/optimize.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/partitionquantiles.py` & `dask-2023.4.1/dask/dataframe/partitionquantiles.py`

 * *Files 2% similar despite different names*

```diff
@@ -68,24 +68,19 @@
 increase the sample size for each partition.
 
 """
 import math
 
 import numpy as np
 import pandas as pd
-from pandas.api.types import (
-    is_datetime64_dtype,
-    is_datetime64tz_dtype,
-    is_integer_dtype,
-)
+from pandas.api.types import is_datetime64_dtype, is_integer_dtype
 from tlz import merge, merge_sorted, take
 
 from dask.base import tokenize
 from dask.dataframe.core import Series
-from dask.dataframe.utils import is_categorical_dtype
 from dask.utils import is_cupy_type, random_state_data
 
 
 def sample_percentiles(num_old, num_new, chunk_length, upsample=1.0, random_state=None):
     """Construct percentiles for a chunk for repartitioning.
 
     Adapt the number of total percentiles calculated based on the number
@@ -336,15 +331,17 @@
     # We assume that all values are unique, which happens in the previous
     # step `merge_and_compress_summaries`.
 
     if len(vals) == npartitions + 1:
         rv = vals
     elif len(vals) < npartitions + 1:
         # The data is under-sampled
-        if np.issubdtype(vals.dtype, np.number) and not is_categorical_dtype(dtype):
+        if np.issubdtype(vals.dtype, np.number) and not isinstance(
+            dtype, pd.CategoricalDtype
+        ):
             # Interpolate extra divisions
             q_weights = np.cumsum(weights)
             q_target = np.linspace(q_weights[0], q_weights[-1], npartitions + 1)
             rv = np.interp(q_target, q_weights, vals)
         else:
             # Distribute the empty partitions
             duplicated_index = np.linspace(
@@ -372,21 +369,24 @@
         np.maximum(right, 0, right)
         lower = np.minimum(left, right)
         trimmed = trimmed_vals[lower]
 
         rv = np.concatenate([trimmed, jumbo_vals])
         rv.sort()
 
-    if is_categorical_dtype(dtype):
+    if isinstance(dtype, pd.CategoricalDtype):
         rv = pd.Categorical.from_codes(rv, info[0], info[1])
-    elif is_datetime64tz_dtype(dtype):
+    elif isinstance(dtype, pd.DatetimeTZDtype):
         rv = pd.DatetimeIndex(rv).tz_localize(dtype.tz)
     elif "datetime64" in str(dtype):
         rv = pd.DatetimeIndex(rv, dtype=dtype)
     elif rv.dtype != dtype:
+        if is_integer_dtype(dtype) and pd.api.types.is_float_dtype(rv.dtype):
+            # pandas EA raises instead of truncating
+            rv = np.floor(rv)
         rv = pd.array(rv, dtype=dtype)
     return rv
 
 
 def percentiles_summary(df, num_old, num_new, upsample, state):
     """Summarize data using percentiles and derived weights.
 
@@ -412,26 +412,26 @@
     if length == 0:
         return ()
     random_state = np.random.RandomState(state)
     qs = sample_percentiles(num_old, num_new, length, upsample, random_state)
     data = df
     interpolation = "linear"
 
-    if is_categorical_dtype(data):
+    if isinstance(data.dtype, pd.CategoricalDtype):
         data = data.cat.codes
         interpolation = "nearest"
     elif is_datetime64_dtype(data.dtype) or is_integer_dtype(data.dtype):
         interpolation = "nearest"
 
     # FIXME: pandas quantile doesn't work with some data types (e.g. strings).
     # We fall back to an ndarray as a workaround.
     try:
         vals = data.quantile(q=qs / 100, interpolation=interpolation).values
     except (TypeError, NotImplementedError):
-        vals, _ = _percentile(array_safe(data, data.dtype), qs, interpolation)
+        vals, _ = _percentile(array_safe(data, like=data.values), qs, interpolation)
 
     if (
         is_cupy_type(data)
         and interpolation == "linear"
         and np.issubdtype(data.dtype, np.integer)
     ):
         vals = np.round(vals).astype(data.dtype)
@@ -440,15 +440,15 @@
             vals[0] = data.min()
     vals_and_weights = percentiles_to_weights(qs, vals, length)
     return vals_and_weights
 
 
 def dtype_info(df):
     info = None
-    if is_categorical_dtype(df):
+    if isinstance(df.dtype, pd.CategoricalDtype):
         data = df.values
         info = (data.categories, data.ordered)
     return df.dtype, info
 
 
 def partition_quantiles(df, npartitions, upsample=1.0, random_state=None):
     """Approximate quantiles of Series used for repartitioning"""
```

### Comparing `dask-2023.4.0/dask/dataframe/reshape.py` & `dask-2023.4.1/dask/dataframe/reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/rolling.py` & `dask-2023.4.1/dask/dataframe/rolling.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/shuffle.py` & `dask-2023.4.1/dask/dataframe/shuffle.py`

 * *Files 1% similar despite different names*

```diff
@@ -86,15 +86,15 @@
         n = divisions.size
         divisions = (
             list(divisions.iloc[: n - 1].unique()) + divisions.iloc[n - 1 :].tolist()
         )
 
     mins = mins.fillna(method="bfill")
     maxes = maxes.fillna(method="bfill")
-    if pd.api.types.is_categorical_dtype(partition_col.dtype):
+    if isinstance(partition_col.dtype, pd.CategoricalDtype):
         dtype = partition_col.dtype
         mins = mins.astype(dtype)
         maxes = maxes.astype(dtype)
 
     if mins.isna().any() or maxes.isna().any():
         presorted = False
     else:
@@ -290,15 +290,15 @@
     else:
         dtype = index.dtype
 
     if pd.isna(divisions).any() and pd.api.types.is_integer_dtype(dtype):
         # Can't construct a Series[int64] when any / all of the divisions are NaN.
         divisions = df._meta._constructor_sliced(divisions)
     elif (
-        pd.api.types.is_categorical_dtype(dtype)
+        isinstance(dtype, pd.CategoricalDtype)
         and UNKNOWN_CATEGORIES in dtype.categories
     ):
         # If categories are unknown, leave as a string dtype instead.
         divisions = df._meta._constructor_sliced(divisions)
     else:
         divisions = df._meta._constructor_sliced(divisions, dtype=dtype)
```

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_accessors.py` & `dask-2023.4.1/dask/dataframe/tests/test_accessors.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_arithmetics_reduction.py` & `dask-2023.4.1/dask/dataframe/tests/test_arithmetics_reduction.py`

 * *Files 2% similar despite different names*

```diff
@@ -7,14 +7,15 @@
 import pytest
 from pandas.api.types import is_scalar
 
 import dask.dataframe as dd
 from dask.array.numpy_compat import _numpy_125
 from dask.dataframe._compat import (
     PANDAS_GT_140,
+    PANDAS_GT_150,
     PANDAS_GT_200,
     PANDAS_VERSION,
     check_numeric_only_deprecation,
 )
 from dask.dataframe.utils import (
     assert_dask_graph,
     assert_eq,
@@ -1270,14 +1271,72 @@
 
     with check_numeric_only_deprecation():
         expected = getattr(df, func)(**kwargs)
         actual = getattr(ddf, func)(**kwargs)
         assert_eq(expected, actual)
 
 
+def test_reductions_frame_dtypes_numeric_only_supported():
+    df = pd.DataFrame(
+        {
+            "int": [1, 2, 3, 4, 5, 6, 7, 8],
+            "float": [1.0, 2.0, 3.0, 4.0, np.nan, 6.0, 7.0, 8.0],
+            "dt": [pd.NaT] + [datetime(2011, i, 1) for i in range(1, 8)],
+            "str": list("abcdefgh"),
+            "timedelta": pd.to_timedelta([1, 2, 3, 4, 5, 6, 7, np.nan]),
+            "bool": [True, False] * 4,
+        }
+    )
+
+    ddf = dd.from_pandas(df, 3)
+    funcs = ["sum"]
+
+    for func in funcs:
+        assert_eq(
+            getattr(df, func)(numeric_only=True),
+            getattr(ddf, func)(numeric_only=True),
+        )
+        with pytest.raises(
+            TypeError,
+            match="'DatetimeArray' with dtype datetime64.*|'DatetimeArray' does not implement reduction 'sum'",
+        ):
+            getattr(ddf, func)(numeric_only=False)
+
+        if PANDAS_GT_200:
+            with pytest.raises(
+                TypeError, match="'DatetimeArray' with dtype datetime64.*"
+            ):
+                getattr(ddf, func)()
+        elif PANDAS_GT_150:
+            with pytest.warns(FutureWarning, match="The default value of numeric_only"):
+                pd_result = getattr(df, func)()
+            with pytest.warns(FutureWarning, match="The default value of numeric_only"):
+                dd_result = getattr(ddf, func)()
+            assert_eq(pd_result, dd_result)
+        else:
+            with pytest.warns(FutureWarning, match="Dropping of nuisance"):
+                pd_result = getattr(df, func)()
+            with pytest.warns(FutureWarning, match="Dropping of nuisance"):
+                dd_result = getattr(ddf, func)()
+            assert_eq(pd_result, dd_result)
+
+    df_numerics = df[["int", "float", "bool"]]
+    ddf_numerics = ddf[["int", "float", "bool"]]
+
+    for func in funcs:
+        assert_eq(
+            getattr(df_numerics, func)(),
+            getattr(ddf_numerics, func)(),
+        )
+        assert_eq(
+            getattr(df_numerics, func)(numeric_only=False),
+            getattr(ddf_numerics, func)(numeric_only=False),
+        )
+
+
 def test_reductions_frame_dtypes_numeric_only():
     df = pd.DataFrame(
         {
             "int": [1, 2, 3, 4, 5, 6, 7, 8],
             "float": [1.0, 2.0, 3.0, 4.0, np.nan, 6.0, 7.0, 8.0],
             "dt": [pd.NaT] + [datetime(2011, i, 1) for i in range(1, 8)],
             "str": list("abcdefgh"),
@@ -1285,15 +1344,14 @@
             "bool": [True, False] * 4,
         }
     )
 
     ddf = dd.from_pandas(df, 3)
     kwargs = {"numeric_only": True}
     funcs = [
-        "sum",
         "prod",
         "product",
         "min",
         "max",
         "mean",
         "var",
         "std",
```

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_boolean.py` & `dask-2023.4.1/dask/dataframe/tests/test_boolean.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_categorical.py` & `dask-2023.4.1/dask/dataframe/tests/test_categorical.py`

 * *Files 4% similar despite different names*

```diff
@@ -12,15 +12,14 @@
 from dask.dataframe._compat import PANDAS_GT_150, PANDAS_GT_200, PANDAS_GT_210, tm
 from dask.dataframe._pyarrow import to_pyarrow_string
 from dask.dataframe.core import _concat
 from dask.dataframe.utils import (
     assert_eq,
     clear_known_categories,
     get_string_dtype,
-    is_categorical_dtype,
     make_meta,
     pyarrow_strings_enabled,
 )
 
 # Generate a list of categorical series and indices
 cat_series = []
 for ordered in [True, False]:
@@ -121,20 +120,15 @@
     tm.assert_frame_equal(_concat(frames5), pd.concat(frames6))
 
 
 # TODO: Remove the filterwarnings below
 @pytest.mark.parametrize(
     "numeric_only",
     [
-        pytest.param(
-            True,
-            marks=pytest.mark.xfail(
-                not PANDAS_GT_150, reason="`numeric_only` not implemented"
-            ),
-        ),
+        True,
         pytest.param(
             False,
             marks=[
                 pytest.mark.xfail(
                     PANDAS_GT_200, reason="numeric_only=False not implemented"
                 ),
                 pytest.mark.xfail(
@@ -189,26 +183,14 @@
     with ctx:
         expected = df.y.groupby(df.w).count()
     with ctx:
         result = ddf.y.groupby(ddf.w).count()
     assert_eq(result, expected)
 
 
-def test_is_categorical_dtype():
-    df = pd.DataFrame({"cat": pd.Categorical([1, 2, 3, 4]), "x": [1, 2, 3, 4]})
-
-    assert is_categorical_dtype(df["cat"])
-    assert not is_categorical_dtype(df["x"])
-
-    ddf = dd.from_pandas(df, 2)
-
-    assert is_categorical_dtype(ddf["cat"])
-    assert not is_categorical_dtype(ddf["x"])
-
-
 def test_categorize():
     # rename y to y_ to avoid pandas future warning about ambiguous
     # levels
     pdf = frames4[0]
     if pyarrow_strings_enabled():
         # we explicitly provide meta, so it has to have pyarrow strings
         pdf = to_pyarrow_string(pdf)
```

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_dataframe.py` & `dask-2023.4.1/dask/dataframe/tests/test_dataframe.py`

 * *Files 0% similar despite different names*

```diff
@@ -3173,22 +3173,30 @@
     with pytest.raises(NotImplementedError):
         ddf.apply(lambda xy: xy, axis="index")
 
 
 @pytest.mark.parametrize("convert_dtype", [None, True, False])
 def test_apply_convert_dtype(convert_dtype):
     """Make sure that explicit convert_dtype raises a warning with pandas>=2.1"""
-    df = pd.DataFrame({"x": [1, 2, 3, 4], "y": [10, 20, 30, 40]})
+    df = pd.DataFrame({"x": [2, 3, 4, 5], "y": [10, 20, 30, 40]})
     ddf = dd.from_pandas(df, npartitions=2)
     kwargs = {} if convert_dtype is None else {"convert_dtype": convert_dtype}
     should_warn = PANDAS_GT_210 and convert_dtype is not None
+
+    meta_val = ddf.x._meta_nonempty.iloc[0]
+
+    def func(x):
+        # meta check is a regression test for https://github.com/dask/dask/issues/10209
+        assert x != meta_val
+        return x + 1
+
     with _check_warning(should_warn, FutureWarning, "the convert_dtype parameter"):
-        expected = df.x.apply(lambda x: x + 1, **kwargs)
+        expected = df.x.apply(func, **kwargs)
     with _check_warning(should_warn, FutureWarning, "the convert_dtype parameter"):
-        result = ddf.x.apply(lambda x: x + 1, **kwargs, meta=expected)
+        result = ddf.x.apply(func, **kwargs, meta=expected)
     assert_eq(result, expected)
 
 
 def test_apply_warns():
     df = pd.DataFrame({"x": [1, 2, 3, 4], "y": [10, 20, 30, 40]})
     ddf = dd.from_pandas(df, npartitions=2)
 
@@ -3818,21 +3826,21 @@
     category = pd.api.types.CategoricalDtype(ordered=False)
 
     # DataFrame
     ddf2 = ddf.astype({"x": abc, "y": category, "z": "category", "other": "f8"})
 
     for col, known in [("x", True), ("y", False), ("z", False)]:
         x = getattr(ddf2, col)
-        assert pd.api.types.is_categorical_dtype(x.dtype)
+        assert isinstance(x.dtype, pd.CategoricalDtype)
         assert x.cat.known == known
 
     # Series
     for dtype, known in [("category", False), (category, False), (abc, True)]:
         dx2 = ddf.x.astype(dtype)
-        assert pd.api.types.is_categorical_dtype(dx2.dtype)
+        assert isinstance(dx2.dtype, pd.CategoricalDtype)
         assert dx2.cat.known == known
 
 
 def test_groupby_callable():
     a = pd.DataFrame({"x": [1, 2, 3, None], "y": [10, 20, 30, 40]}, index=[1, 2, 3, 4])
     b = dd.from_pandas(a, 2)
```

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_extensions.py` & `dask-2023.4.1/dask/dataframe/tests/test_extensions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_format.py` & `dask-2023.4.1/dask/dataframe/tests/test_format.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_groupby.py` & `dask-2023.4.1/dask/dataframe/tests/test_groupby.py`

 * *Files 1% similar despite different names*

```diff
@@ -3595,7 +3595,41 @@
         # Always error when `numeric_only=False`
         ctx = ctx_error
 
     # Here `numeric_only=None` means "use default value for `numeric_only`"
     kwargs = {} if numeric_only is None else {"numeric_only": numeric_only}
     with ctx:
         getattr(ddf.groupby("A"), func)(**kwargs)
+
+
+@pytest.mark.parametrize(
+    "func",
+    [
+        "min",
+        "max",
+        "sum",
+        "prod",
+        "first",
+        "last",
+        # "corr",  TODO: These will get implemented in a follow up
+        # "cov",
+        # "cumprod",
+        # "cumsum",
+        "mean",
+        "median",
+        "std",
+        "var",
+    ],
+)
+def test_groupby_numeric_only_true(func):
+    df = pd.DataFrame({"A": [1, 1, 2], "B": [3, 4, 3], "C": ["a", "b", "c"]})
+    ddf = dd.from_pandas(df, npartitions=3)
+
+    if func in ["var", "std"] and not PANDAS_GT_150:
+        with pytest.raises(TypeError, match="numeric_only not supported"):
+            getattr(ddf.groupby("A"), func)(numeric_only=True)
+        with pytest.raises(TypeError, match="got an unexpected keyword"):
+            getattr(df.groupby("A"), func)(numeric_only=True)
+    else:
+        ddf_result = getattr(ddf.groupby("A"), func)(numeric_only=True)
+        pdf_result = getattr(df.groupby("A"), func)(numeric_only=True)
+        assert_eq(ddf_result, pdf_result)
```

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_hashing.py` & `dask-2023.4.1/dask/dataframe/tests/test_hashing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_hyperloglog.py` & `dask-2023.4.1/dask/dataframe/tests/test_hyperloglog.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_indexing.py` & `dask-2023.4.1/dask/dataframe/tests/test_indexing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_merge_column_and_index.py` & `dask-2023.4.1/dask/dataframe/tests/test_merge_column_and_index.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_multi.py` & `dask-2023.4.1/dask/dataframe/tests/test_multi.py`

 * *Files 0% similar despite different names*

```diff
@@ -3,15 +3,15 @@
 import numpy as np
 import pandas as pd
 import pytest
 from pandas.api.types import is_object_dtype
 
 import dask.dataframe as dd
 from dask.base import compute_as_if_collection
-from dask.dataframe._compat import PANDAS_GT_140, PANDAS_GT_200, tm
+from dask.dataframe._compat import PANDAS_GT_140, PANDAS_GT_150, PANDAS_GT_200, tm
 from dask.dataframe.core import _Frame
 from dask.dataframe.methods import concat
 from dask.dataframe.multi import (
     _maybe_align_partitions,
     align_partitions,
     concat_indexed_dataframes,
     hash_join,
@@ -2516,14 +2516,53 @@
     ddf2 = dd.from_pandas(pdf2, 2)
     expected = pd.concat([pdf1, pdf2])
     expected["x"] = expected["x"].astype("category")
     result = dd.concat([ddf1, ddf2], ignore_order=True)
     assert_eq(result, expected)
 
 
+@pytest.mark.parametrize(
+    "dtype",
+    [
+        "Int64",
+        "Float64",
+        pytest.param(
+            "int64[pyarrow]",
+            marks=pytest.mark.skipif(
+                pa is None or not PANDAS_GT_150,
+                reason="Support for ArrowDtypes requires pyarrow and pandas>=1.5.0",
+            ),
+        ),
+        pytest.param(
+            "float64[pyarrow]",
+            marks=pytest.mark.skipif(
+                pa is None or not PANDAS_GT_150,
+                reason="Support for ArrowDtypes requires pyarrow and pandas>=1.5.0",
+            ),
+        ),
+    ],
+)
+def test_nullable_types_merge(dtype):
+    df1 = pd.DataFrame({"a": [1, 2, 3], "b": [1, 1, 3], "c": list("aab")})
+    df2 = pd.DataFrame({"a": [1, 2, 3], "e": [1, 1, 3], "f": list("aab")})
+    df1["a"] = df1["a"].astype(dtype)
+    df2["a"] = df2["a"].astype(dtype)
+
+    ddf1 = dd.from_pandas(df1, npartitions=2)
+    ddf2 = dd.from_pandas(df2, npartitions=2)
+
+    expect = df1.merge(df2, on="a")
+    actual = ddf1.merge(ddf2, on="a")
+    assert_eq(expect, actual, check_index=False)
+
+    expect = pd.merge(df1, df2, on="a")
+    actual = dd.merge(ddf1, ddf2, on="a")
+    assert_eq(expect, actual, check_index=False)
+
+
 def test_categorical_join():
     # https://github.com/dask/dask/issues/6134
     df = pd.DataFrame(
         {
             "join_col": ["a", "a", "b", "b"],
             "a": [0, 0, 10, 10],
         }
```

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_numeric.py` & `dask-2023.4.1/dask/dataframe/tests/test_numeric.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_optimize_dataframe.py` & `dask-2023.4.1/dask/dataframe/tests/test_optimize_dataframe.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_pyarrow.py` & `dask-2023.4.1/dask/dataframe/tests/test_pyarrow.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_pyarrow_compat.py` & `dask-2023.4.1/dask/dataframe/tests/test_pyarrow_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_reshape.py` & `dask-2023.4.1/dask/dataframe/tests/test_reshape.py`

 * *Files 3% similar despite different names*

```diff
@@ -133,21 +133,21 @@
     res = dd.get_dummies(ds, sparse=True)
     with ignore_numpy_bool8_deprecation():
         assert_eq(exp, res)
 
     dtype = res.compute().a.dtype
     assert dtype.fill_value == _get_dummies_dtype_default(0)
     assert dtype.subtype == _get_dummies_dtype_default
-    assert pd.api.types.is_sparse(res.a.compute())
+    assert isinstance(res.a.compute().dtype, pd.SparseDtype)
 
     exp = pd.get_dummies(s.to_frame(name="a"), sparse=True)
     res = dd.get_dummies(ds.to_frame(name="a"), sparse=True)
     with ignore_numpy_bool8_deprecation():
         assert_eq(exp, res)
-    assert pd.api.types.is_sparse(res.a_a.compute())
+    assert isinstance(res.a_a.compute().dtype, pd.SparseDtype)
 
 
 @check_pandas_issue_45618_warning
 def test_get_dummies_sparse_mix():
     df = pd.DataFrame(
         {
             "A": pd.Categorical(["a", "b", "a"], categories=["a", "b", "c"]),
@@ -160,15 +160,15 @@
     res = dd.get_dummies(ddf, sparse=True)
     with ignore_numpy_bool8_deprecation():
         assert_eq(exp, res)
 
     dtype = res.compute().A_a.dtype
     assert dtype.fill_value == _get_dummies_dtype_default(0)
     assert dtype.subtype == _get_dummies_dtype_default
-    assert pd.api.types.is_sparse(res.A_a.compute())
+    assert isinstance(res.A_a.compute().dtype, pd.SparseDtype)
 
 
 def test_get_dummies_dtype():
     df = pd.DataFrame(
         {
             "A": pd.Categorical(["a", "b", "a"], categories=["a", "b", "c"]),
             "B": [0, 0, 1],
```

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_rolling.py` & `dask-2023.4.1/dask/dataframe/tests/test_rolling.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_shuffle.py` & `dask-2023.4.1/dask/dataframe/tests/test_shuffle.py`

 * *Files 0% similar despite different names*

```diff
@@ -3,27 +3,30 @@
 import os
 import pickle
 import random
 import string
 import tempfile
 from concurrent.futures import ProcessPoolExecutor
 from copy import copy
+from datetime import date, time
+from decimal import Decimal
 from functools import partial
 from unittest import mock
 
 import numpy as np
 import pandas as pd
 import pytest
 
 import dask
 import dask.dataframe as dd
 from dask.base import compute_as_if_collection
 from dask.dataframe._compat import (
     PANDAS_GT_140,
     PANDAS_GT_150,
+    PANDAS_GT_200,
     assert_categorical_equal,
     tm,
 )
 from dask.dataframe.shuffle import (
     _calculate_divisions,
     _noop,
     maybe_buffered_partd,
@@ -31,14 +34,19 @@
     rearrange_by_column,
     rearrange_by_divisions,
     shuffle,
 )
 from dask.dataframe.utils import assert_eq, make_meta
 from dask.optimization import cull
 
+try:
+    import pyarrow as pa
+except ImportError:
+    pa = None
+
 dsk = {
     ("x", 0): pd.DataFrame({"a": [1, 2, 3], "b": [1, 4, 7]}, index=[0, 1, 3]),
     ("x", 1): pd.DataFrame({"a": [4, 5, 6], "b": [2, 5, 8]}, index=[5, 6, 8]),
     ("x", 2): pd.DataFrame({"a": [7, 8, 9], "b": [3, 6, 9]}, index=[9, 9, 9]),
 }
 meta = make_meta(
     {"a": "i8", "b": "i8"}, index=pd.Index([], "i8"), parent_meta=pd.DataFrame()
@@ -1078,14 +1086,23 @@
         assert ts1.timetuple() == ts2.timetuple()
         assert ts1.tz == ts2.tz
 
     assert_eq(df2, ddf_new_div, check_freq=False)
     assert_eq(df2, ddf.set_index("A"), check_freq=False)
 
 
+@pytest.mark.skipif(not PANDAS_GT_140, reason="EA Indexes not supported before")
+def test_set_index_ea_dtype():
+    pdf = pd.DataFrame({"a": 1, "b": pd.Series([1, 2], dtype="Int64")})
+    ddf = dd.from_pandas(pdf, npartitions=2)
+    pdf_result = pdf.set_index("b")
+    ddf_result = ddf.set_index("b")
+    assert_eq(ddf_result, pdf_result)
+
+
 @pytest.mark.parametrize("compression", [None, "ZLib"])
 def test_disk_shuffle_with_compression_option(compression):
     # test if dataframe shuffle works both with and without compression
     with dask.config.set({"dataframe.shuffle.compression": compression}):
         test_shuffle("disk")
 
 
@@ -1535,7 +1552,40 @@
 def test_calculate_divisions(pdf, expected):
     ddf = dd.from_pandas(pdf, npartitions=4)
     divisions, mins, maxes, presorted = _calculate_divisions(ddf, ddf["x"], False, 4)
     assert divisions == expected[0]
     assert mins == expected[1]
     assert maxes == expected[2]
     assert presorted == expected[3]
+
+
+@pytest.mark.skipif(pa is None, reason="Need pyarrow")
+@pytest.mark.skipif(not PANDAS_GT_200, reason="dtype support not good before 2.0")
+@pytest.mark.parametrize(
+    "data, dtype",
+    [
+        (["a", "b"], "string[pyarrow]"),
+        ([b"a", b"b"], "binary[pyarrow]"),
+        # Should probably fix upstream, https://github.com/pandas-dev/pandas/issues/52590
+        # (["a", "b"], pa.large_string()),
+        # ([b"a", b"b"], pa.large_binary()),
+        ([1, 2], "int64[pyarrow]"),
+        ([1, 2], "float64[pyarrow]"),
+        ([1, 2], "uint64[pyarrow]"),
+        ([date(2022, 1, 1), date(1999, 12, 31)], "date32[pyarrow]"),
+        (
+            [pd.Timestamp("2022-01-01"), pd.Timestamp("2023-01-02")],
+            "timestamp[ns][pyarrow]",
+        ),
+        ([Decimal("5"), Decimal("6.24")], "decimal128"),
+        ([pd.Timedelta("1 day"), pd.Timedelta("20 days")], "duration[ns][pyarrow]"),
+        ([time(12, 0), time(0, 12)], "time64[ns][pyarrow]"),
+    ],
+)
+def test_set_index_pyarrow_dtype(data, dtype):
+    if dtype == "decimal128":
+        dtype = pd.ArrowDtype(pa.decimal128(10, 2))
+    pdf = pd.DataFrame({"a": 1, "arrow_col": pd.Series(data, dtype=dtype)})
+    ddf = dd.from_pandas(pdf, npartitions=2)
+    pdf_result = pdf.set_index("arrow_col")
+    ddf_result = ddf.set_index("arrow_col")
+    assert_eq(ddf_result, pdf_result)
```

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_ufunc.py` & `dask-2023.4.1/dask/dataframe/tests/test_ufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tests/test_utils_dataframe.py` & `dask-2023.4.1/dask/dataframe/tests/test_utils_dataframe.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tseries/resample.py` & `dask-2023.4.1/dask/dataframe/tseries/resample.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/tseries/tests/test_resample.py` & `dask-2023.4.1/dask/dataframe/tseries/tests/test_resample.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dataframe/utils.py` & `dask-2023.4.1/dask/dataframe/utils.py`

 * *Files 5% similar despite different names*

```diff
@@ -8,15 +8,15 @@
 from collections.abc import Iterator, Mapping
 from contextlib import contextmanager
 from numbers import Number
 from typing import Callable, TypeVar, overload
 
 import numpy as np
 import pandas as pd
-from pandas.api.types import is_categorical_dtype, is_dtype_equal
+from pandas.api.types import is_dtype_equal
 
 from dask import config
 from dask.base import get_scheduler, is_dask_collection
 from dask.core import get_deps
 from dask.dataframe import (  # noqa: F401 register pandas extension types
     _dtypes,
     methods,
@@ -112,15 +112,15 @@
         divisions = list(divisions)
     if not len(divisions):
         yield df
     else:
         divisions = np.array(divisions)
         df = df.sort_index()
         index = df.index
-        if is_categorical_dtype(index):
+        if isinstance(index.dtype, pd.CategoricalDtype):
             index = index.as_ordered()
         indices = index.searchsorted(divisions)
         yield df.iloc[: indices[0]]
         for i in range(len(indices) - 1):
             yield df.iloc[indices[i] : indices[i + 1]]
         yield df.iloc[indices[-1] :]
 
@@ -246,15 +246,15 @@
                 for c in cats:
                     if not has_known_categories(x[c]):
                         if just_drop_unknown:
                             x[c].cat.remove_categories(UNKNOWN_CATEGORIES, inplace=True)
                         else:
                             x[c] = x[c].cat.set_categories([])
         elif isinstance(x, pd.Series):
-            if is_categorical_dtype(x.dtype) and not has_known_categories(x):
+            if isinstance(x.dtype, pd.CategoricalDtype) and not has_known_categories(x):
                 x = x.cat.set_categories([])
         if isinstance(x.index, pd.CategoricalIndex) and not has_known_categories(
             x.index
         ):
             x.index = x.index.set_categories([])
     elif isinstance(x, pd.CategoricalIndex) and not has_known_categories(x):
         x = x.set_categories([])
@@ -281,15 +281,15 @@
             if cols is None:
                 cols = mask[mask].index
             elif not mask.loc[cols].all():
                 raise ValueError("Not all columns are categoricals")
             for c in cols:
                 x[c] = x[c].cat.set_categories([UNKNOWN_CATEGORIES])
         elif isinstance(x, pd.Series):
-            if is_categorical_dtype(x.dtype):
+            if isinstance(x.dtype, pd.CategoricalDtype):
                 x = x.cat.set_categories([UNKNOWN_CATEGORIES])
         if index and isinstance(x.index, pd.CategoricalIndex):
             x.index = x.index.set_categories([UNKNOWN_CATEGORIES])
     elif isinstance(x, pd.CategoricalIndex):
         x = x.set_categories([UNKNOWN_CATEGORIES])
     return x
 
@@ -360,19 +360,19 @@
         If True, integer and floating dtypes compare equal. This is useful due
         to panda's implicit conversion of integer to floating upon encountering
         missingness, which is hard to infer statically.
     """
     eq_types = {"i", "f", "u"} if numeric_equal else set()
 
     def equal_dtypes(a, b):
-        if is_categorical_dtype(a) != is_categorical_dtype(b):
+        if isinstance(a, pd.CategoricalDtype) != isinstance(b, pd.CategoricalDtype):
             return False
         if isinstance(a, str) and a == "-" or isinstance(b, str) and b == "-":
             return False
-        if is_categorical_dtype(a) and is_categorical_dtype(b):
+        if isinstance(a, pd.CategoricalDtype) and isinstance(b, pd.CategoricalDtype):
             if UNKNOWN_CATEGORIES in a.categories or UNKNOWN_CATEGORIES in b.categories:
                 return True
             return a == b
         return (a.kind in eq_types and b.kind in eq_types) or is_dtype_equal(a, b)
 
     if not (
         is_dataframe_like(meta) or is_series_like(meta) or is_index_like(meta)
```

### Comparing `dask-2023.4.0/dask/datasets.py` & `dask-2023.4.1/dask/datasets.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/delayed.py` & `dask-2023.4.1/dask/delayed.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/diagnostics/profile.py` & `dask-2023.4.1/dask/diagnostics/profile.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/diagnostics/profile_visualize.py` & `dask-2023.4.1/dask/diagnostics/profile_visualize.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/diagnostics/progress.py` & `dask-2023.4.1/dask/diagnostics/progress.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/diagnostics/tests/test_profiler.py` & `dask-2023.4.1/dask/diagnostics/tests/test_profiler.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/diagnostics/tests/test_progress.py` & `dask-2023.4.1/dask/diagnostics/tests/test_progress.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/distributed.py` & `dask-2023.4.1/dask/distributed.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/dot.py` & `dask-2023.4.1/dask/dot.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/graph_manipulation.py` & `dask-2023.4.1/dask/graph_manipulation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/hashing.py` & `dask-2023.4.1/dask/hashing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/highlevelgraph.py` & `dask-2023.4.1/dask/highlevelgraph.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/layers.py` & `dask-2023.4.1/dask/layers.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/local.py` & `dask-2023.4.1/dask/local.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/multiprocessing.py` & `dask-2023.4.1/dask/multiprocessing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/optimization.py` & `dask-2023.4.1/dask/optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/order.py` & `dask-2023.4.1/dask/order.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/rewrite.py` & `dask-2023.4.1/dask/rewrite.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/sizeof.py` & `dask-2023.4.1/dask/sizeof.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/system.py` & `dask-2023.4.1/dask/system.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_backends.py` & `dask-2023.4.1/dask/tests/test_backends.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_base.py` & `dask-2023.4.1/dask/tests/test_base.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_cache.py` & `dask-2023.4.1/dask/tests/test_cache.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_callbacks.py` & `dask-2023.4.1/dask/tests/test_callbacks.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_ci.py` & `dask-2023.4.1/dask/tests/test_ci.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_cli.py` & `dask-2023.4.1/dask/tests/test_cli.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_config.py` & `dask-2023.4.1/dask/tests/test_config.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_context.py` & `dask-2023.4.1/dask/tests/test_context.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_core.py` & `dask-2023.4.1/dask/tests/test_core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_datasets.py` & `dask-2023.4.1/dask/tests/test_datasets.py`

 * *Files 8% similar despite different names*

```diff
@@ -36,9 +36,11 @@
 
         assert "python -m pip install mimesis" in str(info.value)
 
 
 def test_deterministic():
     pytest.importorskip("mimesis")
 
+    a = dask.datasets.make_people(seed=123)
     b = dask.datasets.make_people(seed=123)
-    assert b.take(1)[0]["name"] == ("Milda", "Ellis")
+
+    assert a.take(1)[0]["name"] == b.take(1)[0]["name"]
```

### Comparing `dask-2023.4.0/dask/tests/test_delayed.py` & `dask-2023.4.1/dask/tests/test_delayed.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_distributed.py` & `dask-2023.4.1/dask/tests/test_distributed.py`

 * *Files 6% similar despite different names*

```diff
@@ -4,15 +4,15 @@
 
 import asyncio
 import os
 import sys
 from functools import partial
 from operator import add
 
-from distributed import SchedulerPlugin, WorkerPlugin
+from distributed import Client, SchedulerPlugin, WorkerPlugin
 from distributed.utils_test import cleanup  # noqa F401
 from distributed.utils_test import client as c  # noqa F401
 from distributed.utils_test import (  # noqa F401
     cluster,
     cluster_fixture,
     gen_cluster,
     loop,
@@ -902,12 +902,74 @@
     with dask.config.set(scheduler="threads"):
         with pytest.warns(UserWarning):
             assert get_scheduler() != c.get
         with dask.config.set(scheduler=None):
             assert get_scheduler() == c.get
 
 
+@gen_cluster(config={"scheduler": "sync"}, nthreads=[])
+async def test_get_scheduler_default_client_config_interleaving(s):
+    # This test is using context managers intentionally. We should not refactor
+    # this to use it in more places to make the client closing cleaner.
+    with pytest.warns(UserWarning):
+        assert dask.base.get_scheduler() == dask.local.get_sync
+        with dask.config.set(scheduler="threads"):
+            assert dask.base.get_scheduler() == dask.threaded.get
+            client = await Client(s.address, set_as_default=False, asynchronous=True)
+            try:
+                assert dask.base.get_scheduler() == dask.threaded.get
+            finally:
+                await client.close()
+
+            client = await Client(s.address, set_as_default=True, asynchronous=True)
+            try:
+                assert dask.base.get_scheduler() == client.get
+            finally:
+                await client.close()
+            assert dask.base.get_scheduler() == dask.threaded.get
+
+            # FIXME: As soon as async with uses as_current this will be true as well
+            # async with Client(s.address, set_as_default=False, asynchronous=True) as c:
+            #     assert dask.base.get_scheduler() == c.get
+            # assert dask.base.get_scheduler() == dask.threaded.get
+
+            client = await Client(s.address, set_as_default=False, asynchronous=True)
+            try:
+                assert dask.base.get_scheduler() == dask.threaded.get
+                with client.as_current():
+                    sc = dask.base.get_scheduler()
+                    assert sc == client.get
+                assert dask.base.get_scheduler() == dask.threaded.get
+            finally:
+                await client.close()
+
+            # If it comes to a race between default and current, current wins
+            client = await Client(s.address, set_as_default=True, asynchronous=True)
+            client2 = await Client(s.address, set_as_default=False, asynchronous=True)
+            try:
+                with client2.as_current():
+                    assert dask.base.get_scheduler() == client2.get
+                assert dask.base.get_scheduler() == client.get
+            finally:
+                await client.close()
+                await client2.close()
+
+            assert dask.base.get_scheduler() == dask.threaded.get
+
+        assert dask.base.get_scheduler() == dask.local.get_sync
+
+        client = await Client(s.address, set_as_default=True, asynchronous=True)
+        try:
+            assert dask.base.get_scheduler() == client.get
+            with dask.config.set(scheduler="threads"):
+                assert dask.base.get_scheduler() == dask.threaded.get
+                with client.as_current():
+                    assert dask.base.get_scheduler() == client.get
+        finally:
+            await client.close()
+
+
 @gen_cluster(client=True)
 async def test_bag_groupby_default(c, s, a, b):
     b = db.range(100, npartitions=10)
     b2 = b.groupby(lambda x: x % 13)
     assert not any("partd" in k[0] for k in b2.dask)
```

### Comparing `dask-2023.4.0/dask/tests/test_docs.py` & `dask-2023.4.1/dask/tests/test_docs.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_dot.py` & `dask-2023.4.1/dask/tests/test_dot.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_graph_manipulation.py` & `dask-2023.4.1/dask/tests/test_graph_manipulation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_hashing.py` & `dask-2023.4.1/dask/tests/test_hashing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_highgraph.py` & `dask-2023.4.1/dask/tests/test_highgraph.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_layers.py` & `dask-2023.4.1/dask/tests/test_layers.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_local.py` & `dask-2023.4.1/dask/tests/test_local.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_multiprocessing.py` & `dask-2023.4.1/dask/tests/test_multiprocessing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_optimization.py` & `dask-2023.4.1/dask/tests/test_optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_order.py` & `dask-2023.4.1/dask/tests/test_order.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_rewrite.py` & `dask-2023.4.1/dask/tests/test_rewrite.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_sizeof.py` & `dask-2023.4.1/dask/tests/test_sizeof.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_spark_compat.py` & `dask-2023.4.1/dask/tests/test_spark_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_system.py` & `dask-2023.4.1/dask/tests/test_system.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_threaded.py` & `dask-2023.4.1/dask/tests/test_threaded.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_typing.py` & `dask-2023.4.1/dask/tests/test_typing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_utils.py` & `dask-2023.4.1/dask/tests/test_utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/tests/test_utils_test.py` & `dask-2023.4.1/dask/tests/test_utils_test.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/threaded.py` & `dask-2023.4.1/dask/threaded.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/typing.py` & `dask-2023.4.1/dask/typing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/utils.py` & `dask-2023.4.1/dask/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/utils_test.py` & `dask-2023.4.1/dask/utils_test.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/widgets/__init__.py` & `dask-2023.4.1/dask/widgets/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/widgets/templates/array.html.j2` & `dask-2023.4.1/dask/widgets/templates/array.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/widgets/templates/highlevelgraph.html.j2` & `dask-2023.4.1/dask/widgets/templates/highlevelgraph.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/widgets/templates/highlevelgraph_layer.html.j2` & `dask-2023.4.1/dask/widgets/templates/highlevelgraph_layer.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/widgets/tests/test_widgets.py` & `dask-2023.4.1/dask/widgets/tests/test_widgets.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask/widgets/widgets.py` & `dask-2023.4.1/dask/widgets/widgets.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/dask.egg-info/PKG-INFO` & `dask-2023.4.1/dask.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dask
-Version: 2023.4.0
+Version: 2023.4.1
 Summary: Parallel PyData with Task Scheduling
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD
 Project-URL: Homepage, https://github.com/dask/dask/
 Keywords: task-scheduling parallel numpy pandas pydata
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
```

### Comparing `dask-2023.4.0/dask.egg-info/SOURCES.txt` & `dask-2023.4.1/dask.egg-info/SOURCES.txt`

 * *Files 2% similar despite different names*

```diff
@@ -321,16 +321,14 @@
 docs/source/delayed-best-practices.rst
 docs/source/delayed-collections.rst
 docs/source/delayed.rst
 docs/source/deploying-cli.rst
 docs/source/deploying-cloud.rst
 docs/source/deploying-docker.rst
 docs/source/deploying-hpc.rst
-docs/source/deploying-kubernetes-helm.rst
-docs/source/deploying-kubernetes-native.rst
 docs/source/deploying-kubernetes.rst
 docs/source/deploying-python-advanced.rst
 docs/source/deploying-python.rst
 docs/source/deploying-ssh.rst
 docs/source/deploying.rst
 docs/source/deployment-considerations.rst
 docs/source/develop.rst
```

### Comparing `dask-2023.4.0/docs/Makefile` & `dask-2023.4.1/docs/Makefile`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/make.bat` & `dask-2023.4.1/docs/make.bat`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/10-minutes-to-dask.rst` & `dask-2023.4.1/docs/source/10-minutes-to-dask.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/_static/config_converter.js` & `dask-2023.4.1/docs/source/_static/config_converter.js`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/_static/dask-simple.png` & `dask-2023.4.1/docs/source/_static/dask-simple.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/_static/main-page.css` & `dask-2023.4.1/docs/source/_static/main-page.css`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/_static/profile.html` & `dask-2023.4.1/docs/source/_static/profile.html`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/_static/stacked_profile.html` & `dask-2023.4.1/docs/source/_static/stacked_profile.html`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/_static/style.css` & `dask-2023.4.1/docs/source/_static/style.css`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/_static/transpose_cyto.html` & `dask-2023.4.1/docs/source/_static/transpose_cyto.html`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/_static/yaml.min.js` & `dask-2023.4.1/docs/source/_static/yaml.min.js`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/api.rst` & `dask-2023.4.1/docs/source/api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array-api.rst` & `dask-2023.4.1/docs/source/array-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array-assignment.rst` & `dask-2023.4.1/docs/source/array-assignment.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array-best-practices.rst` & `dask-2023.4.1/docs/source/array-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array-chunks.rst` & `dask-2023.4.1/docs/source/array-chunks.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array-creation.rst` & `dask-2023.4.1/docs/source/array-creation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array-design.rst` & `dask-2023.4.1/docs/source/array-design.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array-gufunc.rst` & `dask-2023.4.1/docs/source/array-gufunc.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array-overlap.rst` & `dask-2023.4.1/docs/source/array-overlap.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array-random.rst` & `dask-2023.4.1/docs/source/array-random.rst`

 * *Files 4% similar despite different names*

```diff
@@ -1,25 +1,15 @@
 Random Number Generation
 ========================
 
 Dask's random number routines produce pseudo random numbers using combinations
 of a ``BitGenerator`` to create sequences and a ``Generator`` to use those
-sequences to sample from different statistical distributions:
+sequences to sample from different statistical distributions.
 
-    **BitGenerators**: Objects that generate random sequences. These are
-    provided by a backend library such as NumPy or CuPy and are typically
-    unsigned integer words filled with sequences of either 32 or 64 random
-    bits.
-
-    ``Generators:`` Objects that transform sequences of random bits from a
-    ``BitGenerator`` into sequences of numbers that follow a specific probability
-    distribution (such as uniform, Normal or Binomial) within a specified
-    interval.
-
-Since Dask version 2023.2.1 the ``Generator`` can be initialized with a number
+Since Dask version 2023.2.1, the ``Generator`` can be initialized with a number
 of different ``BitGenerator`` classes. It exposes many different probability
 distributions. The legacy ``RandomState`` random number routines are still
 available, but are considered frozen and will not be getting any updates.
 
 Differences with NumPy
 ----------------------
 
@@ -30,25 +20,38 @@
 - Dask tries to be backend agnostic. In other words, you can mostly use CuPy
   and NumPy interchangeably as a backend for random number generation. Any
   library providing a similar interface should also work with some effort.
 
 Notes
 -----
 
+- **BitGenerators:** Objects that generate random sequences. These are
+  provided by a backend library such as NumPy or CuPy and are typically
+  unsigned integer words filled with sequences of either 32 or 64 random
+  bits.
+
+- **Generators:** Objects that transform sequences of random bits from a
+  ``BitGenerator`` into sequences of numbers that follow a specific probability
+  distribution (such as uniform, Normal or Binomial) within a specified
+  interval.
+
 - Dask does not guarantee that the same number generator is used across versions.
   This means that numbers generated by ``dask.array.random`` by a new version may
   not be the same as the previous one, even when the same seed and distribution
   are used. As better algorithms evolve, the bit stream may change.
+
 - Dask does not guarantee parity in the generated numbers with any third party
   library. In particular, numbers generated by Dask and NumPy or CuPy will differ
   even when given the same seed and ``BitGenerator``. Dask tends to spawn ``SeedSequence``
   children to produce independent random number streams in parallel.
+
 - ``Generator.integers`` is now the canonical way to generate integer random numbers
   from a discrete uniform distribution. The `endpoint` keyword can be used to
   specify open or closed intervals. This replaces both `randint` and `random_integers`.
+
 - ``Generator.random`` is now the canonical way to generate floating-point random
   numbers, which replaces `random_sample`. The ``dask.array.random.random``
   method still uses ``RandomState`` for backwards compatibility and should be
   avoided for new code. Please use ``Generator.random`` instead.
 
 Quick Start
 -----------
```

### Comparing `dask-2023.4.0/docs/source/array-slicing.rst` & `dask-2023.4.1/docs/source/array-slicing.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array-sparse.rst` & `dask-2023.4.1/docs/source/array-sparse.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array-stack.rst` & `dask-2023.4.1/docs/source/array-stack.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array-stats.rst` & `dask-2023.4.1/docs/source/array-stats.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/array.rst` & `dask-2023.4.1/docs/source/array.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/bag-api.rst` & `dask-2023.4.1/docs/source/bag-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/bag-creation.rst` & `dask-2023.4.1/docs/source/bag-creation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/bag.rst` & `dask-2023.4.1/docs/source/bag.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/best-practices.rst` & `dask-2023.4.1/docs/source/best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/caching.rst` & `dask-2023.4.1/docs/source/caching.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/changelog.rst` & `dask-2023.4.1/docs/source/changelog.rst`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,56 @@
 Changelog
 =========
 
+.. _v2023.4.1:
+
+2023.4.1
+--------
+
+Released on April 28, 2023
+
+Enhancements
+^^^^^^^^^^^^
+- Implement ``numeric_only`` support for ``DataFrame.sum`` (:pr:`10194`) `Patrick Hoefler`_
+- Add support for ``numeric_only=True`` in ``GroupBy`` operations (:pr:`10222`) `Patrick Hoefler`_
+- Avoid deep copy in ``DataFrame.__setitem__`` for ``pandas`` 1.4 and up (:pr:`10221`) `Patrick Hoefler`_
+- Avoid calling ``Series.apply`` with ``_meta_nonempty`` (:pr:`10212`) `Patrick Hoefler`_
+- Unpin ``sqlalchemy`` and fix compatibility issues (:pr:`10140`) `Patrick Hoefler`_
+
+Bug Fixes
+^^^^^^^^^
+- Partially revert default client discovery (:pr:`10225`) `Florian Jetter`_
+- Support arrow dtypes in ``Index`` meta creation (:pr:`10170`) `Patrick Hoefler`_
+- Repartitioning raises with extension dtype when truncating floats (:pr:`10169`) `Patrick Hoefler`_
+- Adjust empty ``Index`` from ``fastparquet`` to ``object`` dtype (:pr:`10179`) `Patrick Hoefler`_
+
+Documentation
+^^^^^^^^^^^^^
+- Update Kubernetes docs (:pr:`10232`) `Jacob Tomlinson`_
+- Add ``DataFrame.reduction`` to API docs (:pr:`10229`) `James Bourbeau`_
+- Add ``DataFrame.persist`` to docs and fix links (:pr:`10231`) `Patrick Hoefler`_
+- Add documentation for ``GroupBy.transform`` (:pr:`10185`) `Irina Truong`_
+- Fix formatting in random number generation docs (:pr:`10189`) `Eray Aslan`_
+
+Maintenance
+^^^^^^^^^^^
+- Pin imageio to ``<2.28`` (:pr:`10216`) `Patrick Hoefler`_
+- Add note about ``importlib_metadata`` backport (:pr:`10207`) `James Bourbeau`_
+- Add ``xarray`` back to Python 3.11 CI builds (:pr:`10200`) `James Bourbeau`_
+- Add ``mindeps`` build with all optional dependencies (:pr:`10161`) `Charles Blackmon-Luca`_
+- Provide proper ``like`` value for ``array_safe`` in ``percentiles_summary`` (:pr:`10156`) `Charles Blackmon-Luca`_
+- Avoid re-opening hdf file multiple times in ``read_hdf`` (:pr:`10205`) `Thomas Grainger`_
+- Add merge tests on nullable columns (:pr:`10071`) `Charles Blackmon-Luca`_
+- Fix coverage configuration (:pr:`10203`) `Thomas Grainger`_
+- Remove ``is_period_dtype`` and ``is_sparse_dtype`` (:pr:`10197`) `Patrick Hoefler`_
+- Bump ``actions/checkout`` from 3.5.0 to 3.5.2 (:pr:`10201`)
+- Avoid deprecated ``is_categorical_dtype`` from `pandas` (:pr:`10180`) `Patrick Hoefler`_
+- Adjust for deprecated ``is_interval_dtype`` and ``is_datetime64tz_dtype`` (:pr:`10188`) `Patrick Hoefler`_
+
+
 .. _v2023.4.0:
 
 2023.4.0
 --------
 
 Released on April 14, 2023
```

### Comparing `dask-2023.4.0/docs/source/cli.rst` & `dask-2023.4.1/docs/source/cli.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/conf.py` & `dask-2023.4.1/docs/source/conf.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/configuration.rst` & `dask-2023.4.1/docs/source/configuration.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/custom-collections.rst` & `dask-2023.4.1/docs/source/custom-collections.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/custom-graphs.rst` & `dask-2023.4.1/docs/source/custom-graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dashboard-progress-script.py` & `dask-2023.4.1/docs/source/dashboard-progress-script.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dashboard.rst` & `dask-2023.4.1/docs/source/dashboard.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/daskcheatsheet.pdf` & `dask-2023.4.1/docs/source/daskcheatsheet.pdf`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dataframe-api.rst` & `dask-2023.4.1/docs/source/dataframe-api.rst`

 * *Files 0% similar despite different names*

```diff
@@ -84,23 +84,25 @@
     DataFrame.mul
     DataFrame.ndim
     DataFrame.ne
     DataFrame.nlargest
     DataFrame.npartitions
     DataFrame.nsmallest
     DataFrame.partitions
+    DataFrame.persist
     DataFrame.pivot_table
     DataFrame.pop
     DataFrame.pow
     DataFrame.prod
     DataFrame.quantile
     DataFrame.query
     DataFrame.radd
     DataFrame.random_split
     DataFrame.rdiv
+    DataFrame.reduction
     DataFrame.rename
     DataFrame.repartition
     DataFrame.replace
     DataFrame.resample
     DataFrame.reset_index
     DataFrame.rfloordiv
     DataFrame.rmod
@@ -432,14 +434,15 @@
    DataFrameGroupBy.cov
    DataFrameGroupBy.corr
    DataFrameGroupBy.first
    DataFrameGroupBy.last
    DataFrameGroupBy.idxmin
    DataFrameGroupBy.idxmax
    DataFrameGroupBy.rolling
+   DataFrameGroupBy.transform
 
 
 Series Groupby
 **************
 
 .. autosummary::
    :toctree: generated/
@@ -463,14 +466,15 @@
    SeriesGroupBy.sum
    SeriesGroupBy.var
    SeriesGroupBy.first
    SeriesGroupBy.last
    SeriesGroupBy.idxmin
    SeriesGroupBy.idxmax
    SeriesGroupBy.rolling
+   SeriesGroupBy.transform
 
 Custom Aggregation
 ******************
 
 .. autosummary::
    :toctree: generated/
```

### Comparing `dask-2023.4.0/docs/source/dataframe-best-practices.rst` & `dask-2023.4.1/docs/source/dataframe-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dataframe-categoricals.rst` & `dask-2023.4.1/docs/source/dataframe-categoricals.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dataframe-create.rst` & `dask-2023.4.1/docs/source/dataframe-create.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dataframe-design.rst` & `dask-2023.4.1/docs/source/dataframe-design.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dataframe-extend.rst` & `dask-2023.4.1/docs/source/dataframe-extend.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dataframe-groupby.rst` & `dask-2023.4.1/docs/source/dataframe-groupby.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dataframe-indexing.rst` & `dask-2023.4.1/docs/source/dataframe-indexing.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dataframe-joins.rst` & `dask-2023.4.1/docs/source/dataframe-joins.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dataframe-parquet.rst` & `dask-2023.4.1/docs/source/dataframe-parquet.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dataframe-sql.rst` & `dask-2023.4.1/docs/source/dataframe-sql.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/dataframe.rst` & `dask-2023.4.1/docs/source/dataframe.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/delayed-api.rst` & `dask-2023.4.1/docs/source/delayed-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/delayed-best-practices.rst` & `dask-2023.4.1/docs/source/delayed-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/delayed-collections.rst` & `dask-2023.4.1/docs/source/delayed-collections.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/delayed.rst` & `dask-2023.4.1/docs/source/delayed.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/deploying-cli.rst` & `dask-2023.4.1/docs/source/deploying-cli.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/deploying-cloud.rst` & `dask-2023.4.1/docs/source/deploying-cloud.rst`

 * *Files 5% similar despite different names*

```diff
@@ -69,8 +69,8 @@
 
 Dask previously maintained libraries for deploying Dask on
 Amazon's EC2 and Google GKE.
 Due to sporadic interest,
 and churn both within the Dask library and EC2 itself,
 these were not well maintained.
 They have since been deprecated in favor of the
-:doc:`Kubernetes and Helm <deploying-kubernetes-helm>` solution.
+:doc:`Kubernetes <deploying-kubernetes>` solutions.
```

### Comparing `dask-2023.4.0/docs/source/deploying-docker.rst` & `dask-2023.4.1/docs/source/deploying-docker.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/deploying-hpc.rst` & `dask-2023.4.1/docs/source/deploying-hpc.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/deploying-python-advanced.rst` & `dask-2023.4.1/docs/source/deploying-python-advanced.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/deploying-python.rst` & `dask-2023.4.1/docs/source/deploying-python.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/deploying-ssh.rst` & `dask-2023.4.1/docs/source/deploying-ssh.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/deploying.rst` & `dask-2023.4.1/docs/source/deploying.rst`

 * *Files 4% similar despite different names*

```diff
@@ -131,24 +131,24 @@
     Multi-tenant, secure clusters. Once configured, users can launch clusters without direct access to the underlying HPC backend.
 
 Kubernetes
 ~~~~~~~~~~
 
 See :doc:`deploying-kubernetes` for more details.
 
-- :doc:`Helm <deploying-kubernetes-helm>`
-   An easy way to stand up a long-running Dask cluster.
-- `Dask Kubernetes <https://kubernetes.dask.org/en/latest/>`_
-   For native Kubernetes integration for fast moving or ephemeral deployments.
+- `Dask Kubernetes Operator <https://kubernetes.dask.org/en/latest/operator.html>`_
+    For native Kubernetes integration for fast moving or ephemeral deployments.
 - `Dask Gateway for Kubernetes <https://gateway.dask.org/install-kube.html>`_
     Multi-tenant, secure clusters. Once configured, users can launch clusters without direct access to the underlying Kubernetes backend.
+- `Single Cluster Helm Chart <https://artifacthub.io/packages/helm/dask/dask>`_
+    Single Dask cluster and (optionally) Jupyter on deployed with Helm.
 
 Cloud
 ~~~~~
-            
+
 See :doc:`deploying-cloud` for more details.
 
 - `Dask-Yarn <https://yarn.dask.org>`_
     Deploy Dask on YARN clusters, such as are found in traditional Hadoop installations.
 - `Dask Cloud Provider <https://cloudprovider.dask.org/en/latest/>`_
     Constructing and managing ephemeral Dask clusters on AWS, DigitalOcean, GCP, Azure, and Hertzner
 - You can use `Coiled <https://coiled.io/>`_, a commercial Dask deployment option, to handle the creation and management of Dask clusters on cloud computing environments (AWS and GCP).
```

### Comparing `dask-2023.4.0/docs/source/deployment-considerations.rst` & `dask-2023.4.1/docs/source/deployment-considerations.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/develop.rst` & `dask-2023.4.1/docs/source/develop.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/diagnostics-distributed.rst` & `dask-2023.4.1/docs/source/diagnostics-distributed.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/diagnostics-local.rst` & `dask-2023.4.1/docs/source/diagnostics-local.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/ecosystem.rst` & `dask-2023.4.1/docs/source/ecosystem.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/faq.rst` & `dask-2023.4.1/docs/source/faq.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/futures.rst` & `dask-2023.4.1/docs/source/futures.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/gpu.rst` & `dask-2023.4.1/docs/source/gpu.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/graph_manipulation.rst` & `dask-2023.4.1/docs/source/graph_manipulation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/graphs.rst` & `dask-2023.4.1/docs/source/graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/graphviz.rst` & `dask-2023.4.1/docs/source/graphviz.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/high-level-graphs.rst` & `dask-2023.4.1/docs/source/high-level-graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/how-to/adaptive.rst` & `dask-2023.4.1/docs/source/how-to/adaptive.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/how-to/connect-to-remote-data.rst` & `dask-2023.4.1/docs/source/how-to/connect-to-remote-data.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/how-to/customize-initialization.rst` & `dask-2023.4.1/docs/source/how-to/customize-initialization.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/how-to/debug.rst` & `dask-2023.4.1/docs/source/how-to/debug.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/how-to/extend-sizeof.rst` & `dask-2023.4.1/docs/source/how-to/extend-sizeof.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/how-to/manage-environments.rst` & `dask-2023.4.1/docs/source/how-to/manage-environments.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/how-to/selecting-the-collection-backend.rst` & `dask-2023.4.1/docs/source/how-to/selecting-the-collection-backend.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/how-to/setup-prometheus.rst` & `dask-2023.4.1/docs/source/how-to/setup-prometheus.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/10_minutes_array_graph.png` & `dask-2023.4.1/docs/source/images/10_minutes_array_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/10_minutes_bag_graph.png` & `dask-2023.4.1/docs/source/images/10_minutes_bag_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/10_minutes_dataframe_graph.png` & `dask-2023.4.1/docs/source/images/10_minutes_dataframe_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/HHMI_Janelia_Color.png` & `dask-2023.4.1/docs/source/images/HHMI_Janelia_Color.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/array.svg` & `dask-2023.4.1/docs/source/images/array.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/async-embarrassing.gif` & `dask-2023.4.1/docs/source/images/async-embarrassing.gif`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/concurrent-futures-threaded.webp` & `dask-2023.4.1/docs/source/images/concurrent-futures-threaded.webp`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/crosstalk.svg` & `dask-2023.4.1/docs/source/images/crosstalk.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dashboard_jupyterlab.png` & `dask-2023.4.1/docs/source/images/dashboard_jupyterlab.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dashboard_link.png` & `dask-2023.4.1/docs/source/images/dashboard_link.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dashboard_memory.png` & `dask-2023.4.1/docs/source/images/dashboard_memory.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dashboard_memory_new.gif` & `dask-2023.4.1/docs/source/images/dashboard_memory_new.gif`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dashboard_progress.png` & `dask-2023.4.1/docs/source/images/dashboard_progress.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dashboard_status.png` & `dask-2023.4.1/docs/source/images/dashboard_status.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dashboard_task_processing.png` & `dask-2023.4.1/docs/source/images/dashboard_task_processing.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dashboard_task_stream_unhealthy.png` & `dask-2023.4.1/docs/source/images/dashboard_task_stream_unhealthy.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dashboard_taskstream_healthy.png` & `dask-2023.4.1/docs/source/images/dashboard_taskstream_healthy.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask-adaptive.svg` & `dask-2023.4.1/docs/source/images/dask-adaptive.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask-array.svg` & `dask-2023.4.1/docs/source/images/dask-array.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask-cluster-manager.svg` & `dask-2023.4.1/docs/source/images/dask-cluster-manager.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask-dataframe.svg` & `dask-2023.4.1/docs/source/images/dask-dataframe.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask-overview-distributed-callout.svg` & `dask-2023.4.1/docs/source/images/dask-overview-distributed-callout.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask-overview-schedulers.svg` & `dask-2023.4.1/docs/source/images/dask-overview-schedulers.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask-overview.svg` & `dask-2023.4.1/docs/source/images/dask-overview.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask_horizontal.svg` & `dask-2023.4.1/docs/source/images/dask_horizontal.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask_horizontal_black.svg` & `dask-2023.4.1/docs/source/images/dask_horizontal_black.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask_horizontal_on_blue.svg` & `dask-2023.4.1/docs/source/images/dask_horizontal_on_blue.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask_horizontal_on_pink.svg` & `dask-2023.4.1/docs/source/images/dask_horizontal_on_pink.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask_horizontal_white.svg` & `dask-2023.4.1/docs/source/images/dask_horizontal_white.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask_icon.svg` & `dask-2023.4.1/docs/source/images/dask_icon.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask_icon_black.svg` & `dask-2023.4.1/docs/source/images/dask_icon_black.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask_icon_on_pink.svg` & `dask-2023.4.1/docs/source/images/dask_icon_on_pink.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/dask_icon_white.svg` & `dask-2023.4.1/docs/source/images/dask_icon_white.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/delayed-inc-double-add.svg` & `dask-2023.4.1/docs/source/images/delayed-inc-double-add.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/distributed-overview.svg` & `dask-2023.4.1/docs/source/images/distributed-overview.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/frame-shuffle.svg` & `dask-2023.4.1/docs/source/images/frame-shuffle.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/frame-sort.svg` & `dask-2023.4.1/docs/source/images/frame-sort.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/frame.svg` & `dask-2023.4.1/docs/source/images/frame.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/gputester-msg.png` & `dask-2023.4.1/docs/source/images/gputester-msg.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/growth_of_languages.png` & `dask-2023.4.1/docs/source/images/growth_of_languages.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/growth_of_libraries.png` & `dask-2023.4.1/docs/source/images/growth_of_libraries.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/inc-add.svg` & `dask-2023.4.1/docs/source/images/inc-add.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/map-reduce-task-scheduling.svg` & `dask-2023.4.1/docs/source/images/map-reduce-task-scheduling.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/map_blocks_drop_axis.png` & `dask-2023.4.1/docs/source/images/map_blocks_drop_axis.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/merge_chunks.png` & `dask-2023.4.1/docs/source/images/merge_chunks.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/merge_chunks_false.png` & `dask-2023.4.1/docs/source/images/merge_chunks_false.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/optimize_dask1.svg` & `dask-2023.4.1/docs/source/images/optimize_dask1.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/optimize_dask2.svg` & `dask-2023.4.1/docs/source/images/optimize_dask2.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/optimize_dask3.svg` & `dask-2023.4.1/docs/source/images/optimize_dask3.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/optimize_dask4.svg` & `dask-2023.4.1/docs/source/images/optimize_dask4.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/optimize_dask5.svg` & `dask-2023.4.1/docs/source/images/optimize_dask5.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/order-failure.png` & `dask-2023.4.1/docs/source/images/order-failure.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/order-success.png` & `dask-2023.4.1/docs/source/images/order-success.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/overlap.svg` & `dask-2023.4.1/docs/source/images/overlap.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/overlapping-blocks.svg` & `dask-2023.4.1/docs/source/images/overlapping-blocks.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/overlapping-neighbors.svg` & `dask-2023.4.1/docs/source/images/overlapping-neighbors.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/pipeline.svg` & `dask-2023.4.1/docs/source/images/pipeline.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/reshape.png` & `dask-2023.4.1/docs/source/images/reshape.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/reshape_problem.png` & `dask-2023.4.1/docs/source/images/reshape_problem.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/reshape_rechunked.png` & `dask-2023.4.1/docs/source/images/reshape_rechunked.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/scaling-edges.png` & `dask-2023.4.1/docs/source/images/scaling-edges.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/scaling-nodes.png` & `dask-2023.4.1/docs/source/images/scaling-nodes.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/simple-dask.png` & `dask-2023.4.1/docs/source/images/simple-dask.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/transpose-hlg-hovertooltip.png` & `dask-2023.4.1/docs/source/images/transpose-hlg-hovertooltip.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/transpose-hlg-html-repr.png` & `dask-2023.4.1/docs/source/images/transpose-hlg-html-repr.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/transpose.svg` & `dask-2023.4.1/docs/source/images/transpose.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/transpose_opt.svg` & `dask-2023.4.1/docs/source/images/transpose_opt.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/trivial.svg` & `dask-2023.4.1/docs/source/images/trivial.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/images/unoverlapping-neighbors.svg` & `dask-2023.4.1/docs/source/images/unoverlapping-neighbors.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/index.rst` & `dask-2023.4.1/docs/source/index.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/logos.rst` & `dask-2023.4.1/docs/source/logos.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/maintainers.rst` & `dask-2023.4.1/docs/source/maintainers.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/optimize.rst` & `dask-2023.4.1/docs/source/optimize.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/order.rst` & `dask-2023.4.1/docs/source/order.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/phases-of-computation.rst` & `dask-2023.4.1/docs/source/phases-of-computation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/presentations.rst` & `dask-2023.4.1/docs/source/presentations.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/scheduler-overview.rst` & `dask-2023.4.1/docs/source/scheduler-overview.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/scheduling-policy.rst` & `dask-2023.4.1/docs/source/scheduling-policy.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/scheduling.rst` & `dask-2023.4.1/docs/source/scheduling.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/scripts/scheduling.py` & `dask-2023.4.1/docs/source/scripts/scheduling.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/shared.rst` & `dask-2023.4.1/docs/source/shared.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/spark.rst` & `dask-2023.4.1/docs/source/spark.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/spec.rst` & `dask-2023.4.1/docs/source/spec.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/support.rst` & `dask-2023.4.1/docs/source/support.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/understanding-performance.rst` & `dask-2023.4.1/docs/source/understanding-performance.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/user-interfaces.rst` & `dask-2023.4.1/docs/source/user-interfaces.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/docs/source/why.rst` & `dask-2023.4.1/docs/source/why.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.0/pyproject.toml` & `dask-2023.4.1/pyproject.toml`

 * *Files 3% similar despite different names*

```diff
@@ -26,36 +26,41 @@
 ]
 readme = "README.rst"
 urls = {Homepage = "https://github.com/dask/dask/"}
 requires-python = ">=3.8"
 dependencies = [
     # NOTE: These are tested in `continuous_integration/test_imports.sh` If
     # you modify these, make sure to change the corresponding line there.
-    "click >= 7.0",
-    "cloudpickle >= 1.1.1",
-    "fsspec >= 0.6.0",
+    "click >= 8.0",
+    "cloudpickle >= 1.5.0",
+    "fsspec >= 2021.09.0",
     "packaging >= 20.0",
     "partd >= 1.2.0",
     "pyyaml >= 5.3.1",
-    "toolz >= 0.8.2",
+    "toolz >= 0.10.0",
+    # importlib.metadata has the following bugs fixed in 3.10.9 and 3.11.1
+    # https://github.com/python/cpython/issues/99130
+    # https://github.com/python/cpython/issues/98706
+    # TODO: when Python 3.12 is support is added this could be a
+    # conditional dependency
     "importlib_metadata >= 4.13.0",
 ]
 dynamic = ["version"]
 
 [project.optional-dependencies]
 # NOTE: These are tested in `continuous_integration/test_imports.sh` If
 # you modify these, make sure to change the corresponding line there.
 array = ["numpy >= 1.21"]
 # keeping for backwards compatibility
 bag = []
 dataframe = [
     "numpy >= 1.21",
     "pandas >= 1.3",
 ]
-distributed = ["distributed == 2023.4.0"]
+distributed = ["distributed == 2023.4.1"]
 diagnostics = [
     "bokeh >= 2.4.2",
     "jinja2 >= 2.10.3",
 ]
 # keeping for backwards compatibility
 delayed = []
 complete = [
@@ -112,15 +117,15 @@
 markers = [
     "network: Test requires an internet connection",
     "slow: Skipped unless --runslow passed",
     "gpu: marks tests we want to run on GPUs",
     "skip_with_pyarrow_strings: Tests that should be skipped when pyarrow string conversion is turned on",
     "xfail_with_pyarrow_strings: Tests that should be xfailed when pyarrow string conversion is turned on",
 ]
-addopts = "-v -rsxfE --durations=10 --color=yes"
+addopts = "-v -rsxfE --durations=10 --color=yes --cov-config=pyproject.toml"
 filterwarnings = [
     # From Cython-1753
     "ignore:can't resolve:ImportWarning",
     "error:::dask[.*]",
     "error:::pandas[.*]",
     "error:::numpy[.*]",
     "error:::distributed[.*]",
```

