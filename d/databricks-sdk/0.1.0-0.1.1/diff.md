# Comparing `tmp/databricks_sdk-0.1.0-py3-none-any.whl.zip` & `tmp/databricks_sdk-0.1.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,39 +1,39 @@
-Zip file size: 205009 bytes, number of entries: 37
--rw-r--r--  2.0 unx      260 b- defN 23-Apr-20 15:59 databricks/__init__.py
--rw-r--r--  2.0 unx    12817 b- defN 23-Apr-20 15:59 databricks/sdk/__init__.py
--rw-r--r--  2.0 unx     1656 b- defN 23-Apr-20 15:59 databricks/sdk/azure.py
--rw-r--r--  2.0 unx    34099 b- defN 23-Apr-20 15:59 databricks/sdk/core.py
--rw-r--r--  2.0 unx     2616 b- defN 23-Apr-20 15:59 databricks/sdk/dbconnect.py
--rw-r--r--  2.0 unx    11147 b- defN 23-Apr-20 15:59 databricks/sdk/dbutils.py
--rw-r--r--  2.0 unx       94 b- defN 23-Apr-20 15:59 databricks/sdk/errors.py
--rw-r--r--  2.0 unx    13431 b- defN 23-Apr-20 15:59 databricks/sdk/oauth.py
--rw-r--r--  2.0 unx       22 b- defN 23-Apr-20 15:59 databricks/sdk/version.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-20 15:59 databricks/sdk/mixins/__init__.py
--rw-r--r--  2.0 unx     8909 b- defN 23-Apr-20 15:59 databricks/sdk/mixins/compute.py
--rw-r--r--  2.0 unx    12666 b- defN 23-Apr-20 15:59 databricks/sdk/mixins/dbfs.py
--rw-r--r--  2.0 unx      587 b- defN 23-Apr-20 15:59 databricks/sdk/runtime/__init__.py
--rw-r--r--  2.0 unx    11790 b- defN 23-Apr-20 15:59 databricks/sdk/runtime/stub.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-20 15:59 databricks/sdk/service/__init__.py
--rw-r--r--  2.0 unx     1296 b- defN 23-Apr-20 15:59 databricks/sdk/service/_internal.py
--rw-r--r--  2.0 unx    30457 b- defN 23-Apr-20 15:59 databricks/sdk/service/billing.py
--rw-r--r--  2.0 unx   157480 b- defN 23-Apr-20 15:59 databricks/sdk/service/catalog.py
--rw-r--r--  2.0 unx   188918 b- defN 23-Apr-20 15:59 databricks/sdk/service/compute.py
--rw-r--r--  2.0 unx    14727 b- defN 23-Apr-20 15:59 databricks/sdk/service/files.py
--rw-r--r--  2.0 unx    68249 b- defN 23-Apr-20 15:59 databricks/sdk/service/iam.py
--rw-r--r--  2.0 unx    99652 b- defN 23-Apr-20 15:59 databricks/sdk/service/jobs.py
--rw-r--r--  2.0 unx   113286 b- defN 23-Apr-20 15:59 databricks/sdk/service/ml.py
--rw-r--r--  2.0 unx    19395 b- defN 23-Apr-20 15:59 databricks/sdk/service/oauth2.py
--rw-r--r--  2.0 unx    51501 b- defN 23-Apr-20 15:59 databricks/sdk/service/pipelines.py
--rw-r--r--  2.0 unx    87514 b- defN 23-Apr-20 15:59 databricks/sdk/service/provisioning.py
--rw-r--r--  2.0 unx    24891 b- defN 23-Apr-20 15:59 databricks/sdk/service/serving.py
--rw-r--r--  2.0 unx    33670 b- defN 23-Apr-20 15:59 databricks/sdk/service/settings.py
--rw-r--r--  2.0 unx    44357 b- defN 23-Apr-20 15:59 databricks/sdk/service/sharing.py
--rw-r--r--  2.0 unx   140031 b- defN 23-Apr-20 15:59 databricks/sdk/service/sql.py
--rw-r--r--  2.0 unx    43457 b- defN 23-Apr-20 15:59 databricks/sdk/service/workspace.py
--rw-r--r--  2.0 unx    11411 b- defN 23-Apr-20 15:59 databricks_sdk-0.1.0.dist-info/LICENSE
--rw-r--r--  2.0 unx    29578 b- defN 23-Apr-20 15:59 databricks_sdk-0.1.0.dist-info/METADATA
--rw-r--r--  2.0 unx      725 b- defN 23-Apr-20 15:59 databricks_sdk-0.1.0.dist-info/NOTICE
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-20 15:59 databricks_sdk-0.1.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       11 b- defN 23-Apr-20 15:59 databricks_sdk-0.1.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3226 b- defN 23-Apr-20 15:59 databricks_sdk-0.1.0.dist-info/RECORD
-37 files, 1274018 bytes uncompressed, 199853 bytes compressed:  84.3%
+Zip file size: 205365 bytes, number of entries: 37
+-rw-r--r--  2.0 unx      260 b- defN 23-Apr-28 15:46 databricks/__init__.py
+-rw-r--r--  2.0 unx    12817 b- defN 23-Apr-28 15:46 databricks/sdk/__init__.py
+-rw-r--r--  2.0 unx     1656 b- defN 23-Apr-28 15:46 databricks/sdk/azure.py
+-rw-r--r--  2.0 unx    34311 b- defN 23-Apr-28 15:46 databricks/sdk/core.py
+-rw-r--r--  2.0 unx     2616 b- defN 23-Apr-28 15:46 databricks/sdk/dbconnect.py
+-rw-r--r--  2.0 unx    11147 b- defN 23-Apr-28 15:46 databricks/sdk/dbutils.py
+-rw-r--r--  2.0 unx       94 b- defN 23-Apr-28 15:46 databricks/sdk/errors.py
+-rw-r--r--  2.0 unx    13981 b- defN 23-Apr-28 15:46 databricks/sdk/oauth.py
+-rw-r--r--  2.0 unx       22 b- defN 23-Apr-28 15:46 databricks/sdk/version.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-28 15:46 databricks/sdk/mixins/__init__.py
+-rw-r--r--  2.0 unx     8909 b- defN 23-Apr-28 15:46 databricks/sdk/mixins/compute.py
+-rw-r--r--  2.0 unx    12666 b- defN 23-Apr-28 15:46 databricks/sdk/mixins/dbfs.py
+-rw-r--r--  2.0 unx      587 b- defN 23-Apr-28 15:46 databricks/sdk/runtime/__init__.py
+-rw-r--r--  2.0 unx    11790 b- defN 23-Apr-28 15:46 databricks/sdk/runtime/stub.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-28 15:46 databricks/sdk/service/__init__.py
+-rw-r--r--  2.0 unx     1296 b- defN 23-Apr-28 15:46 databricks/sdk/service/_internal.py
+-rw-r--r--  2.0 unx    30457 b- defN 23-Apr-28 15:46 databricks/sdk/service/billing.py
+-rw-r--r--  2.0 unx   157480 b- defN 23-Apr-28 15:46 databricks/sdk/service/catalog.py
+-rw-r--r--  2.0 unx   188918 b- defN 23-Apr-28 15:46 databricks/sdk/service/compute.py
+-rw-r--r--  2.0 unx    14727 b- defN 23-Apr-28 15:46 databricks/sdk/service/files.py
+-rw-r--r--  2.0 unx    68249 b- defN 23-Apr-28 15:46 databricks/sdk/service/iam.py
+-rw-r--r--  2.0 unx    99652 b- defN 23-Apr-28 15:46 databricks/sdk/service/jobs.py
+-rw-r--r--  2.0 unx   113286 b- defN 23-Apr-28 15:46 databricks/sdk/service/ml.py
+-rw-r--r--  2.0 unx    19395 b- defN 23-Apr-28 15:46 databricks/sdk/service/oauth2.py
+-rw-r--r--  2.0 unx    51501 b- defN 23-Apr-28 15:46 databricks/sdk/service/pipelines.py
+-rw-r--r--  2.0 unx    87514 b- defN 23-Apr-28 15:46 databricks/sdk/service/provisioning.py
+-rw-r--r--  2.0 unx    24891 b- defN 23-Apr-28 15:46 databricks/sdk/service/serving.py
+-rw-r--r--  2.0 unx    33670 b- defN 23-Apr-28 15:46 databricks/sdk/service/settings.py
+-rw-r--r--  2.0 unx    44357 b- defN 23-Apr-28 15:46 databricks/sdk/service/sharing.py
+-rw-r--r--  2.0 unx   140031 b- defN 23-Apr-28 15:46 databricks/sdk/service/sql.py
+-rw-r--r--  2.0 unx    43457 b- defN 23-Apr-28 15:46 databricks/sdk/service/workspace.py
+-rw-r--r--  2.0 unx    11411 b- defN 23-Apr-28 15:47 databricks_sdk-0.1.1.dist-info/LICENSE
+-rw-r--r--  2.0 unx    29644 b- defN 23-Apr-28 15:47 databricks_sdk-0.1.1.dist-info/METADATA
+-rw-r--r--  2.0 unx      725 b- defN 23-Apr-28 15:47 databricks_sdk-0.1.1.dist-info/NOTICE
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-28 15:47 databricks_sdk-0.1.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx       11 b- defN 23-Apr-28 15:47 databricks_sdk-0.1.1.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3226 b- defN 23-Apr-28 15:47 databricks_sdk-0.1.1.dist-info/RECORD
+37 files, 1274846 bytes uncompressed, 200209 bytes compressed:  84.3%
```

## zipnote {}

```diff
@@ -87,26 +87,26 @@
 
 Filename: databricks/sdk/service/sql.py
 Comment: 
 
 Filename: databricks/sdk/service/workspace.py
 Comment: 
 
-Filename: databricks_sdk-0.1.0.dist-info/LICENSE
+Filename: databricks_sdk-0.1.1.dist-info/LICENSE
 Comment: 
 
-Filename: databricks_sdk-0.1.0.dist-info/METADATA
+Filename: databricks_sdk-0.1.1.dist-info/METADATA
 Comment: 
 
-Filename: databricks_sdk-0.1.0.dist-info/NOTICE
+Filename: databricks_sdk-0.1.1.dist-info/NOTICE
 Comment: 
 
-Filename: databricks_sdk-0.1.0.dist-info/WHEEL
+Filename: databricks_sdk-0.1.1.dist-info/WHEEL
 Comment: 
 
-Filename: databricks_sdk-0.1.0.dist-info/top_level.txt
+Filename: databricks_sdk-0.1.1.dist-info/top_level.txt
 Comment: 
 
-Filename: databricks_sdk-0.1.0.dist-info/RECORD
+Filename: databricks_sdk-0.1.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## databricks/sdk/core.py

```diff
@@ -110,24 +110,29 @@
     return inner
 
 
 @credentials_provider('external-browser', ['host', 'auth_type'])
 def external_browser(cfg: 'Config') -> Optional[HeaderFactory]:
     if cfg.auth_type != 'external-browser':
         return None
-    if cfg.is_aws:
+    if cfg.client_id:
+        client_id = cfg.client_id
+    elif cfg.is_aws:
         client_id = 'databricks-cli'
     elif cfg.is_azure:
         # Use Azure AD app for cases when Azure CLI is not available on the machine.
         # App has to be registered as Single-page multi-tenant to support PKCE
         # TODO: temporary app ID, change it later.
         client_id = '6128a518-99a9-425b-8333-4cc94f04cacd'
     else:
         raise ValueError(f'local browser SSO is not supported')
-    oauth_client = OAuthClient(cfg.host, client_id, 'http://localhost:8020')
+    oauth_client = OAuthClient(host=cfg.host,
+                               client_id=client_id,
+                               redirect_url='http://localhost:8020',
+                               client_secret=cfg.client_secret)
     consent = oauth_client.initiate_consent()
     if not consent:
         return None
     credentials = consent.launch_external_browser()
     return credentials(cfg)
```

## databricks/sdk/oauth.py

```diff
@@ -11,14 +11,18 @@
 from datetime import datetime, timedelta
 from http.server import BaseHTTPRequestHandler, HTTPServer
 from typing import Any, Dict, List
 
 import requests
 import requests.auth
 
+# Error code for PKCE flow in Azure Active Directory, that gets additional retry.
+# See https://stackoverflow.com/a/75466778/277035 for more info
+NO_ORIGIN_FOR_SPA_CLIENT_ERROR = 'AADSTS9002327'
+
 logger = logging.getLogger(__name__)
 
 
 @dataclass
 class OidcEndpoints:
     authorization_endpoint: str # ../v1/authorize
     token_endpoint: str # ../v1/token
@@ -236,31 +240,38 @@
             raise ValueError('No code returned in callback')
         return self.exchange(query['code'], query['state'])
 
     def exchange(self, code: str, state: str) -> RefreshableCredentials:
         if self._state != state:
             raise ValueError('state mismatch')
         params = {
+            'redirect_uri': self._client.redirect_url,
             'grant_type': 'authorization_code',
-            'code': code,
             'code_verifier': self._verifier,
-            'redirect_uri': self._client.redirect_url
+            'code': code
         }
         headers = {}
-        if 'microsoft' in self._client.token_url:
-            # Tokens issued for the 'Single-Page Application' client-type may
-            # only be redeemed via cross-origin requests
-            headers = {'Origin': self._client.redirect_url}
-        token = retrieve_token(client_id=self._client.client_id,
-                               client_secret=self._client.client_secret,
-                               token_url=self._client.token_url,
-                               params=params,
-                               headers=headers,
-                               use_params=True)
-        return RefreshableCredentials(self._client, token)
+        while True:
+            try:
+                token = retrieve_token(client_id=self._client.client_id,
+                                       client_secret=self._client.client_secret,
+                                       token_url=self._client.token_url,
+                                       params=params,
+                                       headers=headers,
+                                       use_params=True)
+                return RefreshableCredentials(self._client, token)
+            except ValueError as e:
+                if NO_ORIGIN_FOR_SPA_CLIENT_ERROR in str(e):
+                    # Retry in cases of 'Single-Page Application' client-type with
+                    # 'Origin' header equal to client's redirect URL.
+                    headers['Origin'] = self._client.redirect_url
+                    msg = f'Retrying OAuth token exchange with {self._client.redirect_url} origin'
+                    logger.debug(msg)
+                    continue
+                raise e
 
 
 class OAuthClient:
     """Enables 3-legged OAuth2 flow with PKCE
 
     For a regular web app running on a server, it's recommended to use
     the Authorization Code Flow to obtain an Access Token and a Refresh
```

## databricks/sdk/version.py

```diff
@@ -1 +1 @@
-__version__ = '0.1.0'
+__version__ = '0.1.1'
```

## Comparing `databricks_sdk-0.1.0.dist-info/LICENSE` & `databricks_sdk-0.1.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `databricks_sdk-0.1.0.dist-info/METADATA` & `databricks_sdk-0.1.1.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: databricks-sdk
-Version: 0.1.0
+Version: 0.1.1
 Summary: Databricks SDK for Python (Experimental)
 Home-page: https://github.com/databricks/databricks-sdk-py
 Author: Serge Smertin
 Author-email: serge.smertin@databricks.com
 License: UNKNOWN
 Keywords: databricks sdk
 Platform: UNKNOWN
@@ -170,14 +170,16 @@
 w = WorkspaceClient(host=input('Databricks Workspace URL: '),
                     azure_workspace_resource_id=input('Azure Resource ID: '),
                     azure_tenant_id=input('AAD Tenant ID: '),
                     azure_client_id=input('AAD Client ID: '),
                     azure_client_secret=input('AAD Client Secret: '))
 ```
 
+Please see more examples in [this document](./docs/azure-ad.md).
+
 ### Overriding `.databrickscfg`
 
 For [Databricks native authentication](#databricks-native-authentication), you can override the default behavior for using `.databrickscfg` as follows:
 
 | Argument      | Description | Environment variable |
 |---------------|-------------|----------------------|
 | `profile`     | _(String)_ A connection profile specified within `.databrickscfg` to use instead of `DEFAULT`. | `DATABRICKS_CONFIG_PROFILE` |
```

## Comparing `databricks_sdk-0.1.0.dist-info/NOTICE` & `databricks_sdk-0.1.1.dist-info/NOTICE`

 * *Files identical despite different names*

## Comparing `databricks_sdk-0.1.0.dist-info/RECORD` & `databricks_sdk-0.1.1.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,16 +1,16 @@
 databricks/__init__.py,sha256=-1cBy2684NfMPosP7CE8LgIYlw8ve82AGkP1ZVp9M5A,260
 databricks/sdk/__init__.py,sha256=5hL4sD2aCGU7BHQFpEz5DmME-xk7Yp5fCdjStNpFziM,12817
 databricks/sdk/azure.py,sha256=2CljLtiyOnH-rUQcCSarbLsJd0zkil5f4vpjsSGzyxc,1656
-databricks/sdk/core.py,sha256=Lc-PwhID-UbrK463rWaynPjlG2BkJ_UqCR5lfmLD9DE,34099
+databricks/sdk/core.py,sha256=1AWSWam7aq-2xn2MNGMBVkxr1GqKNWznBEhzkrvOPOw,34311
 databricks/sdk/dbconnect.py,sha256=mAqVSDSAIjuqy4oSsDbcKLWIgqDLEnWtXPlb133YYhQ,2616
 databricks/sdk/dbutils.py,sha256=9lHGcXjRnIylWOSBFbioIym1JzVBo9of3laoXE7TvOA,11147
 databricks/sdk/errors.py,sha256=SBy7QvNgGKzEg0j-zuyNpaiuChwx93DeKbya5MNftGc,94
-databricks/sdk/oauth.py,sha256=JEl30pJQ2C912R1H30r3TvVJ9Kzbi3P24sWWaMFSTFI,13431
-databricks/sdk/version.py,sha256=IMjkMO3twhQzluVTo8Z6rE7Eg-9U79_LGKMcsWLKBkY,22
+databricks/sdk/oauth.py,sha256=0RHrbxbPvVEE_kFrSPigzgYQdqZr79aDJRE1q0IdsEs,13981
+databricks/sdk/version.py,sha256=ls1camlIoMxEZz9gSkZ1OJo-MXqHWwKPtdPbZJmwp7E,22
 databricks/sdk/mixins/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 databricks/sdk/mixins/compute.py,sha256=cCoRkkChrV9bEXq2h8WwxdWJ4sVB5dT9KazjJMSC74I,8909
 databricks/sdk/mixins/dbfs.py,sha256=nvAhP_Aem_xmB3GT0LAozAb_PjUXB5Xc9Xev9BpW5aM,12666
 databricks/sdk/runtime/__init__.py,sha256=pyEV0sUzZGyAdIi6FWOZCnih_eHfH78fHtoIE3qbQuI,587
 databricks/sdk/runtime/stub.py,sha256=2tTysaz4rBKdM1yyo0dXdo-UFdXH6PEHyu6267AaU00,11790
 databricks/sdk/service/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 databricks/sdk/service/_internal.py,sha256=Gy5f689Rg-50Md2RbHFWF6i2oZDRPDjeN-vPF6_ONlI,1296
@@ -25,13 +25,13 @@
 databricks/sdk/service/pipelines.py,sha256=9e8JdmWPEgi3gKPMmp2l2OTkrTRWLEodnfXXhaX8M3I,51501
 databricks/sdk/service/provisioning.py,sha256=8ZIAt5h1aRWzq0ffVPKJ5hf1LAsLsgD4guvbMEtYTog,87514
 databricks/sdk/service/serving.py,sha256=5IxPUhzjj8VV8yvaiDf_sTlGd07Ed7U3o1VliMVbE64,24891
 databricks/sdk/service/settings.py,sha256=rfcv96j5Y4udGKr9LzjA2jkAj8kuL8A7lXqW0NNq7Tg,33670
 databricks/sdk/service/sharing.py,sha256=N83p-0AysFO8nwnm-HUSYT5qaQUgMsvXET6lY9JaOR4,44357
 databricks/sdk/service/sql.py,sha256=geciXxYvv3Le-JHP7k_K0r4XBVw003TqXJ1oA7UzeoE,140031
 databricks/sdk/service/workspace.py,sha256=h_zgD2ElOjJq83xxs-SG6QrGP-x0zDxZHADMiqKwD4o,43457
-databricks_sdk-0.1.0.dist-info/LICENSE,sha256=afBgTZo-JsYqj4VOjnejBetMuHKcFR30YobDdpVFkqY,11411
-databricks_sdk-0.1.0.dist-info/METADATA,sha256=Q4Wfe3WjZLJEtLuoCucSb55FXELkr6o2Plso6YGwlF0,29578
-databricks_sdk-0.1.0.dist-info/NOTICE,sha256=FXJCqJfV8_zzXWjB4wgTx_iot23yvSo_d2SyCjrlleg,725
-databricks_sdk-0.1.0.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-databricks_sdk-0.1.0.dist-info/top_level.txt,sha256=7kRdatoSgU0EUurRQJ_3F1Nv4EOSHWAr6ng25tJOJKU,11
-databricks_sdk-0.1.0.dist-info/RECORD,,
+databricks_sdk-0.1.1.dist-info/LICENSE,sha256=afBgTZo-JsYqj4VOjnejBetMuHKcFR30YobDdpVFkqY,11411
+databricks_sdk-0.1.1.dist-info/METADATA,sha256=iniqjP2p8RkicUG9w6yHTl7quH3AlgEstwmolcnGDeM,29644
+databricks_sdk-0.1.1.dist-info/NOTICE,sha256=FXJCqJfV8_zzXWjB4wgTx_iot23yvSo_d2SyCjrlleg,725
+databricks_sdk-0.1.1.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+databricks_sdk-0.1.1.dist-info/top_level.txt,sha256=7kRdatoSgU0EUurRQJ_3F1Nv4EOSHWAr6ng25tJOJKU,11
+databricks_sdk-0.1.1.dist-info/RECORD,,
```

